<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>html/OpenTC_D03.3_Collection_of_internal_deliverables_Y3</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="generator" content="pdftohtml 0.36"/>
<meta name="date" content="2009-06-03T13:38:15+00:00"/>
<style type="text/css">
<!--
.xflip {
    -moz-transform: scaleX(-1);
    -webkit-transform: scaleX(-1);
    -o-transform: scaleX(-1);
    transform: scaleX(-1);
    filter: fliph;
}
.yflip {
    -moz-transform: scaleY(-1);
    -webkit-transform: scaleY(-1);
    -o-transform: scaleY(-1);
    transform: scaleY(-1);
    filter: flipv;
}
.xyflip {
    -moz-transform: scaleX(-1) scaleY(-1);
    -webkit-transform: scaleX(-1) scaleY(-1);
    -o-transform: scaleX(-1) scaleY(-1);
    transform: scaleX(-1) scaleY(-1);
    filter: fliph + flipv;
}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<!-- Page 1 -->
<a name="1"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft10{font-size:13px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
	.ft11{font-size:19px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
	.ft12{font-size:27px;font-family:CAAAAA+DejaVuSans;color:#000000;}
	.ft13{font-size:17px;font-family:CAAAAA+DejaVuSans;color:#000000;}
	.ft14{font-size:17px;font-family:DAAAAA+DejaVuSans;color:#000000;}
	.ft15{font-size:10px;font-family:DAAAAA+DejaVuSans;color:#000000;}
	.ft16{font-size:14px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
	.ft17{font-size:17px;line-height:19px;font-family:DAAAAA+DejaVuSans;color:#000000;}
	.ft18{font-size:17px;line-height:19px;font-family:CAAAAA+DejaVuSans;color:#000000;}
-->
</style>
<div id="page1-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3001.png" alt="background image"/>
<p style="position:absolute;top:137px;left:92px;white-space:nowrap" class="ft10">&#160;</p>
<p style="position:absolute;top:76px;left:91px;white-space:nowrap" class="ft11">&#160;</p>
<p style="position:absolute;top:242px;left:94px;white-space:nowrap" class="ft12"><b>D3.3&#160;Collected&#160;internal&#160;deliverables&#160;for&#160;year&#160;3</b></p>
<p style="position:absolute;top:319px;left:91px;white-space:nowrap" class="ft13"><b>Project&#160;number</b></p>
<p style="position:absolute;top:319px;left:425px;white-space:nowrap" class="ft14">IST-027635</p>
<p style="position:absolute;top:345px;left:91px;white-space:nowrap" class="ft13"><b>Project&#160;acronym</b></p>
<p style="position:absolute;top:345px;left:425px;white-space:nowrap" class="ft14">Open_TC</p>
<p style="position:absolute;top:370px;left:91px;white-space:nowrap" class="ft13"><b>Project&#160;title</b></p>
<p style="position:absolute;top:370px;left:425px;white-space:nowrap" class="ft14">Open&#160;Trusted&#160;Computing</p>
<p style="position:absolute;top:402px;left:91px;white-space:nowrap" class="ft13"><b>Deliverable&#160;type</b></p>
<p style="position:absolute;top:393px;left:425px;white-space:nowrap" class="ft17">Report,&#160;Prototype<br/>(see&#160;page&#160;87/88&#160;of&#160;Annex1)</p>
<p style="position:absolute;top:452px;left:91px;white-space:nowrap" class="ft13"><b>Deliverable&#160;reference&#160;number</b></p>
<p style="position:absolute;top:452px;left:425px;white-space:nowrap" class="ft14">IST-027635/D3.3/1.0</p>
<p style="position:absolute;top:477px;left:91px;white-space:nowrap" class="ft13"><b>Deliverable&#160;title</b></p>
<p style="position:absolute;top:477px;left:425px;white-space:nowrap" class="ft14">Collected&#160;internal&#160;deliverables&#160;for&#160;year&#160;3</p>
<p style="position:absolute;top:503px;left:91px;white-space:nowrap" class="ft13"><b>WP&#160;contributing&#160;to&#160;the&#160;deliverable</b></p>
<p style="position:absolute;top:503px;left:425px;white-space:nowrap" class="ft14">WP3</p>
<p style="position:absolute;top:528px;left:91px;white-space:nowrap" class="ft13"><b>Due&#160;date</b></p>
<p style="position:absolute;top:528px;left:425px;white-space:nowrap" class="ft14">M38&#160;(postponed&#160;to&#160;M42)</p>
<p style="position:absolute;top:554px;left:91px;white-space:nowrap" class="ft13"><b>Actual&#160;submission&#160;date</b></p>
<p style="position:absolute;top:554px;left:425px;white-space:nowrap" class="ft14">03.06.09</p>
<p style="position:absolute;top:594px;left:91px;white-space:nowrap" class="ft13"><b>Responsible&#160;Organisation</b></p>
<p style="position:absolute;top:594px;left:424px;white-space:nowrap" class="ft14">POLITO</p>
<p style="position:absolute;top:632px;left:91px;white-space:nowrap" class="ft13"><b>Authors</b></p>
<p style="position:absolute;top:632px;left:424px;white-space:nowrap" class="ft17">Emanuele&#160;Cesena,&#160;Davide&#160;Vernizzi,&#160;Gianluca&#160;<br/>Ramunno,&#160;Roberto&#160;Sassu&#160;(POL)</p>
<p style="position:absolute;top:690px;left:91px;white-space:nowrap" class="ft13"><b>Abstract</b></p>
<p style="position:absolute;top:690px;left:424px;white-space:nowrap" class="ft17">Collection&#160;of&#160;internal&#160;deliverables&#160;of&#160;WP3&#160;in&#160;<br/>year&#160;3</p>
<p style="position:absolute;top:829px;left:91px;white-space:nowrap" class="ft13"><b>Keywords</b></p>
<p style="position:absolute;top:829px;left:424px;white-space:nowrap" class="ft14">OpenTC&#160;WP3</p>
<p style="position:absolute;top:873px;left:92px;white-space:nowrap" class="ft13"><b>Dissemination&#160;level</b></p>
<p style="position:absolute;top:873px;left:423px;white-space:nowrap" class="ft14">Public</p>
<p style="position:absolute;top:898px;left:92px;white-space:nowrap" class="ft13"><b>Revision</b></p>
<p style="position:absolute;top:898px;left:423px;white-space:nowrap" class="ft14">1.0</p>
<p style="position:absolute;top:949px;left:90px;white-space:nowrap" class="ft13"><b>Instrument</b></p>
<p style="position:absolute;top:949px;left:271px;white-space:nowrap" class="ft14">IP</p>
<p style="position:absolute;top:940px;left:423px;white-space:nowrap" class="ft18"><b>Start&#160;date&#160;of&#160;the&#160;<br/>project</b></p>
<p style="position:absolute;top:949px;left:632px;white-space:nowrap" class="ft14">1</p>
<p style="position:absolute;top:949px;left:643px;white-space:nowrap" class="ft15">st</p>
<p style="position:absolute;top:949px;left:652px;white-space:nowrap" class="ft14">&#160;November&#160;2005</p>
<p style="position:absolute;top:978px;left:90px;white-space:nowrap" class="ft13"><b>Thematic&#160;Priority</b></p>
<p style="position:absolute;top:978px;left:271px;white-space:nowrap" class="ft14">IST</p>
<p style="position:absolute;top:978px;left:423px;white-space:nowrap" class="ft13"><b>Duration</b></p>
<p style="position:absolute;top:978px;left:632px;white-space:nowrap" class="ft14">42&#160;months</p>
<p style="position:absolute;top:75px;left:674px;white-space:nowrap" class="ft16">&#160;</p>
</div>
<!-- Page 2 -->
<a name="2"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft29{font-size:9px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
	.ft210{font-size:14px;font-family:DAAAAA+DejaVuSans;color:#000000;}
	.ft211{font-size:21px;font-family:CAAAAA+DejaVuSans;color:#000000;}
	.ft212{font-size:14px;font-family:EAAAAA+OpenSymbol;color:#000000;}
	.ft213{font-size:17px;font-family:DAAAAA+DejaVuSans;color:#000080;}
	.ft214{font-size:15px;font-family:DAAAAA+DejaVuSans;color:#000000;}
-->
</style>
<div id="page2-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3002.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft29">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft20">&#160;</p>
<p style="position:absolute;top:94px;left:287px;white-space:nowrap" class="ft210">Collected&#160;internal&#160;deliverables&#160;for&#160;year&#160;3</p>
<p style="position:absolute;top:94px;left:718px;white-space:nowrap" class="ft210">&#160;&#160;&#160;V&#160;1.0</p>
<p style="position:absolute;top:228px;left:85px;white-space:nowrap" class="ft211"><b>Introduction:</b></p>
<p style="position:absolute;top:291px;left:85px;white-space:nowrap" class="ft27">This&#160;Deliverable&#160;is&#160;a&#160;collection&#160;of&#160;the&#160;following&#160;internal&#160;WP3&#160;Deliverables&#160;out&#160;of&#160;the&#160;<br/>Sub-Workpackages&#160;with&#160;Nature&#160;R&#160;(Report)&#160;and&#160;P&#160;(Prototype)&#160;within&#160;the&#160;period&#160;of&#160;M25&#160;-&#160;<br/>M36:</p>
<p style="position:absolute;top:396px;left:112px;white-space:nowrap" class="ft212">●</p>
<p style="position:absolute;top:391px;left:139px;white-space:nowrap" class="ft24">D03c.3&#160;–&#160;TLS&#160;DAA&#160;enhancement&#160;specification</p>
<p style="position:absolute;top:423px;left:112px;white-space:nowrap" class="ft212">●</p>
<p style="position:absolute;top:419px;left:139px;white-space:nowrap" class="ft24">D03c.6&#160;–&#160;TLS&#160;DAA&#160;enhancement&#160;OpenSSL&#160;design</p>
<p style="position:absolute;top:451px;left:112px;white-space:nowrap" class="ft212">●</p>
<p style="position:absolute;top:447px;left:139px;white-space:nowrap" class="ft24">D03c.12&#160;–&#160;OpenSSL&#160;engine&#160;TLS&#160;DAA&#160;enhancement</p>
<p style="position:absolute;top:479px;left:112px;white-space:nowrap" class="ft212">●</p>
<p style="position:absolute;top:474px;left:139px;white-space:nowrap" class="ft27">D03c.9&#160;Enhancement&#160;of&#160;Key&#160;Management&#160;Adaptation&#160;(KMA),&#160;which&#160;also&#160;<br/>includes:</p>
<p style="position:absolute;top:526px;left:139px;white-space:nowrap" class="ft212">○</p>
<p style="position:absolute;top:521px;left:166px;white-space:nowrap" class="ft24">D03c.10&#160;Adapting&#160;IPsec&#160;configuration&#160;tools&#160;and&#160;IKE&#160;demon&#160;source</p>
<p style="position:absolute;top:554px;left:139px;white-space:nowrap" class="ft212">○</p>
<p style="position:absolute;top:549px;left:166px;white-space:nowrap" class="ft24">D03c.11&#160;PKCS#11&#160;source&#160;code&#160;and&#160;documentation</p>
<p style="position:absolute;top:611px;left:85px;white-space:nowrap" class="ft27">The&#160;source&#160;code&#160;and&#160;the&#160;binaries&#160;of&#160;these&#160;Deliverables&#160;are&#160;located&#160;on&#160;a&#160;FTP&#160;server.&#160;<br/>The&#160;link&#160;and&#160;the&#160;credentials&#160;for&#160;accessing&#160;this&#160;FTP&#160;server&#160;are&#160;being&#160;sent&#160;separately&#160;via&#160;<br/>email&#160;to&#160;both,&#160;the&#160;EC&#160;and&#160;the&#160;Reviewers.</p>
<p style="position:absolute;top:803px;left:85px;white-space:nowrap" class="ft24">If&#160;you&#160;need&#160;further&#160;information,&#160;please&#160;visit&#160;our&#160;website<a href="http://www.opentc.net/">&#160;</a></p>
<p style="position:absolute;top:803px;left:552px;white-space:nowrap" class="ft213"><a href="http://www.opentc.net/">www.opentc.net</a></p>
<p style="position:absolute;top:803px;left:687px;white-space:nowrap" class="ft24"><a href="http://www.opentc.net/">&#160;</a>or&#160;contact&#160;</p>
<p style="position:absolute;top:822px;left:85px;white-space:nowrap" class="ft24">the&#160;coordinator:</p>
<p style="position:absolute;top:860px;left:85px;white-space:nowrap" class="ft27">Technikon&#160;Forschungs-und&#160;Planungsgesellschaft&#160;mbH<br/>Burgplatz&#160;3a,&#160;9500&#160;Villach,&#160;AUSTRIA<br/>Tel.+43&#160;4242&#160;23355&#160;–0<br/>Fax.&#160;+43&#160;4242&#160;23355&#160;–77<br/>Email<a href="mailto:coordination@opentc.net">&#160;</a></p>
<p style="position:absolute;top:937px;left:136px;white-space:nowrap" class="ft213"><a href="mailto:coordination@opentc.net">coordination@opentc.net</a></p>
<p style="position:absolute;top:1033px;left:181px;white-space:nowrap" class="ft214">The&#160;information&#160;in&#160;this&#160;document&#160;is&#160;provided&#160;“as&#160;is”,&#160;and&#160;no&#160;guarantee&#160;</p>
<p style="position:absolute;top:1051px;left:174px;white-space:nowrap" class="ft214">or&#160;warranty&#160;is&#160;given&#160;that&#160;the&#160;information&#160;is&#160;fit&#160;for&#160;any&#160;particular&#160;purpose.&#160;</p>
<p style="position:absolute;top:1068px;left:203px;white-space:nowrap" class="ft214">The&#160;user&#160;thereof&#160;uses&#160;the&#160;information&#160;at&#160;its&#160;sole&#160;risk&#160;and&#160;liability.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft214">Open_TC&#160;Deliverable&#160;3.3</p>
</div>
<!-- Page 3 -->
<a name="3"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft315{font-size:27px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
	.ft316{font-size:17px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
	.ft317{font-size:17px;font-family:DAAAAA+BitstreamVeraSans;color:#000000;}
	.ft318{font-size:10px;font-family:DAAAAA+BitstreamVeraSans;color:#000000;}
	.ft319{font-size:17px;line-height:19px;font-family:DAAAAA+BitstreamVeraSans;color:#000000;}
	.ft320{font-size:17px;line-height:19px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page3-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3003.png" alt="background image"/>
<p style="position:absolute;top:139px;left:99px;white-space:nowrap" class="ft30">&#160;</p>
<p style="position:absolute;top:77px;left:99px;white-space:nowrap" class="ft31">&#160;</p>
<p style="position:absolute;top:242px;left:184px;white-space:nowrap" class="ft315"><b>D03c.3&#160;SSL/TLS&#160;DAA-enhancement&#160;</b></p>
<p style="position:absolute;top:273px;left:350px;white-space:nowrap" class="ft315"><b>specification</b></p>
<p style="position:absolute;top:351px;left:91px;white-space:nowrap" class="ft316"><b>Project&#160;number</b></p>
<p style="position:absolute;top:351px;left:425px;white-space:nowrap" class="ft317">IST-027635</p>
<p style="position:absolute;top:376px;left:91px;white-space:nowrap" class="ft316"><b>Project&#160;acronym</b></p>
<p style="position:absolute;top:376px;left:425px;white-space:nowrap" class="ft317">Open_TC</p>
<p style="position:absolute;top:402px;left:91px;white-space:nowrap" class="ft316"><b>Project&#160;title</b></p>
<p style="position:absolute;top:402px;left:425px;white-space:nowrap" class="ft317">Open&#160;Trusted&#160;Computing</p>
<p style="position:absolute;top:427px;left:91px;white-space:nowrap" class="ft316"><b>Deliverable&#160;type</b></p>
<p style="position:absolute;top:427px;left:425px;white-space:nowrap" class="ft317">Internal&#160;deliverable</p>
<p style="position:absolute;top:470px;left:91px;white-space:nowrap" class="ft316"><b>Deliverable&#160;reference&#160;number</b></p>
<p style="position:absolute;top:470px;left:425px;white-space:nowrap" class="ft317">IST-027635/D03c.3/FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:496px;left:91px;white-space:nowrap" class="ft316"><b>Deliverable&#160;title</b></p>
<p style="position:absolute;top:496px;left:425px;white-space:nowrap" class="ft317">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:521px;left:91px;white-space:nowrap" class="ft316"><b>WP&#160;contributing&#160;to&#160;the&#160;deliverable</b></p>
<p style="position:absolute;top:521px;left:425px;white-space:nowrap" class="ft317">WP03c</p>
<p style="position:absolute;top:547px;left:91px;white-space:nowrap" class="ft316"><b>Due&#160;date</b></p>
<p style="position:absolute;top:547px;left:425px;white-space:nowrap" class="ft317">Dec&#160;2006&#160;-&#160;M12</p>
<p style="position:absolute;top:572px;left:91px;white-space:nowrap" class="ft316"><b>Actual&#160;submission&#160;date</b></p>
<p style="position:absolute;top:572px;left:425px;white-space:nowrap" class="ft317">May&#160;15,&#160;2009&#160;(second&#160;revision)</p>
<p style="position:absolute;top:615px;left:91px;white-space:nowrap" class="ft316"><b>Responsible&#160;Organisation</b></p>
<p style="position:absolute;top:615px;left:424px;white-space:nowrap" class="ft317">POL</p>
<p style="position:absolute;top:647px;left:91px;white-space:nowrap" class="ft316"><b>Authors</b></p>
<p style="position:absolute;top:638px;left:424px;white-space:nowrap" class="ft319">Emanuele&#160;Cesena,&#160;Gianluca&#160;Ramunno,&#160;<br/>Davide&#160;Vernizzi&#160;(editor)</p>
<p style="position:absolute;top:676px;left:91px;white-space:nowrap" class="ft316"><b>Abstract</b></p>
<p style="position:absolute;top:676px;left:424px;white-space:nowrap" class="ft319">This&#160;deliverable&#160;specifies&#160;the&#160;enhancements&#160;<br/>to&#160;TLS&#160;protocol&#160;in&#160;order&#160;to&#160;use&#160;DAA&#160;for&#160;group&#160;<br/>authentication.</p>
<p style="position:absolute;top:892px;left:91px;white-space:nowrap" class="ft316"><b>Keywords</b></p>
<p style="position:absolute;top:892px;left:424px;white-space:nowrap" class="ft317">OPEN_TC,&#160;TPM,&#160;TLS,&#160;DAA</p>
<p style="position:absolute;top:935px;left:92px;white-space:nowrap" class="ft316"><b>Dissemination&#160;level</b></p>
<p style="position:absolute;top:935px;left:423px;white-space:nowrap" class="ft317">Public</p>
<p style="position:absolute;top:960px;left:92px;white-space:nowrap" class="ft316"><b>Revision</b></p>
<p style="position:absolute;top:960px;left:423px;white-space:nowrap" class="ft317">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:1012px;left:90px;white-space:nowrap" class="ft316"><b>Instrument</b></p>
<p style="position:absolute;top:1012px;left:271px;white-space:nowrap" class="ft317">IP</p>
<p style="position:absolute;top:1002px;left:452px;white-space:nowrap" class="ft320"><b>Start&#160;date&#160;of&#160;the&#160;<br/>project</b></p>
<p style="position:absolute;top:1012px;left:633px;white-space:nowrap" class="ft317">1</p>
<p style="position:absolute;top:1011px;left:643px;white-space:nowrap" class="ft318">st</p>
<p style="position:absolute;top:1012px;left:652px;white-space:nowrap" class="ft317">&#160;November&#160;2005</p>
<p style="position:absolute;top:1041px;left:90px;white-space:nowrap" class="ft316"><b>Thematic&#160;Priority</b></p>
<p style="position:absolute;top:1041px;left:271px;white-space:nowrap" class="ft317">IST</p>
<p style="position:absolute;top:1041px;left:452px;white-space:nowrap" class="ft316"><b>Duration</b></p>
<p style="position:absolute;top:1041px;left:633px;white-space:nowrap" class="ft317">42&#160;months</p>
<p style="position:absolute;top:75px;left:674px;white-space:nowrap" class="ft36">&#160;</p>
</div>
<!-- Page 4 -->
<a name="4"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft421{font-size:15px;font-family:DAAAAA+BitstreamVeraSans;color:#000000;}
	.ft422{font-size:24px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
	.ft423{font-size:17px;line-height:23px;font-family:DAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page4-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3004.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft49">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft40">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft421">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft421">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft422"><b>Table&#160;of&#160;Contents</b></p>
<p style="position:absolute;top:204px;left:83px;white-space:nowrap" class="ft423">1&#160;&#160;Introduction.................................................................................................................4<br/>2&#160;&#160;The&#160;Direct&#160;Anonymous&#160;Attestation&#160;(DAA)&#160;protocol.....................................................4<br/>3&#160;&#160;Using&#160;the&#160;DAA&#160;for&#160;authentication................................................................................5</p>
<p style="position:absolute;top:270px;left:92px;white-space:nowrap" class="ft419">3.1&#160;&#160;Application&#160;scenario...............................................................................................5<br/>3.2&#160;&#160;Combining&#160;TLS&#160;and&#160;DAA&#160;protocols.........................................................................6</p>
<p style="position:absolute;top:313px;left:83px;white-space:nowrap" class="ft417">4&#160;&#160;Enhancing&#160;TLS&#160;protocol&#160;(informative).........................................................................6</p>
<p style="position:absolute;top:332px;left:92px;white-space:nowrap" class="ft419">4.1&#160;&#160;TLS&#160;protocol............................................................................................................6<br/>4.2&#160;&#160;Hello&#160;extensions.....................................................................................................6<br/>4.3&#160;&#160;Supplemental&#160;data&#160;message..................................................................................9</p>
<p style="position:absolute;top:394px;left:83px;white-space:nowrap" class="ft417">5&#160;&#160;DAA-enhanced&#160;TLS&#160;(DAA-TLS)...................................................................................10</p>
<p style="position:absolute;top:413px;left:92px;white-space:nowrap" class="ft419">5.1&#160;&#160;Overview..............................................................................................................10<br/>5.2&#160;&#160;Summary&#160;of&#160;DAA-TLS&#160;capabilities&#160;and&#160;protocol&#160;flow............................................11<br/>5.3&#160;&#160;Binding&#160;between&#160;TLS&#160;channel&#160;and&#160;DAA&#160;authentication........................................13<br/>5.4&#160;&#160;Verification&#160;of&#160;the&#160;authentication.........................................................................14<br/>5.5&#160;&#160;Definition&#160;of&#160;the&#160;hello&#160;extension&#160;DAAAuthExt.......................................................14<br/>5.6&#160;&#160;Definition&#160;of&#160;the&#160;supplemental&#160;data&#160;entry&#160;&#160;DAAAuthSupplDataEntry...................16</p>
<p style="position:absolute;top:532px;left:83px;white-space:nowrap" class="ft417">6&#160;&#160;Specification&#160;of&#160;TCG&#160;TSS/TPM&#160;DAA&#160;profile&#160;for&#160;DAA-TLS.............................................18</p>
<p style="position:absolute;top:552px;left:92px;white-space:nowrap" class="ft419">6.1&#160;&#160;Profile&#160;requirements&#160;and&#160;specification.................................................................18<br/>6.2&#160;&#160;Prerequisites&#160;for&#160;using&#160;TSS&#160;functions&#160;for&#160;DAA-TLS................................................19<br/>6.3&#160;&#160;Nonce&#160;and&#160;basename&#160;generation.........................................................................19<br/>6.4&#160;&#160;DAA&#160;signature.......................................................................................................20<br/>6.5&#160;&#160;Signature&#160;verification...........................................................................................21<br/>6.6&#160;&#160;Data&#160;encoding/decoding.......................................................................................22</p>
<p style="position:absolute;top:667px;left:101px;white-space:nowrap" class="ft419">6.6.1&#160;&#160;Basic&#160;data&#160;types..............................................................................................22<br/>6.6.2&#160;&#160;Complex&#160;types.................................................................................................23</p>
<p style="position:absolute;top:705px;left:109px;white-space:nowrap" class="ft417">6.6.2.1&#160;&#160;DAA&#160;Signature&#160;(normative).........................................................................23</p>
<p style="position:absolute;top:729px;left:83px;white-space:nowrap" class="ft417">7&#160;&#160;Security&#160;considerations.............................................................................................24</p>
<p style="position:absolute;top:748px;left:92px;white-space:nowrap" class="ft419">7.1&#160;&#160;Endorsement&#160;Key&#160;(EK)&#160;exposure..........................................................................24<br/>7.2&#160;&#160;Basename&#160;and&#160;DAA&#160;signature..............................................................................24</p>
<p style="position:absolute;top:791px;left:83px;white-space:nowrap" class="ft423">8&#160;&#160;IANA&#160;considerations..................................................................................................25<br/>9&#160;&#160;Final&#160;considerations&#160;(IPsec&#160;and&#160;IKE/ISAKMP).............................................................25<br/>10&#160;&#160;List&#160;of&#160;abbreviations................................................................................................26<br/>11&#160;&#160;Referenced&#160;Documents...........................................................................................26</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft421">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft421">2/27</p>
</div>
<!-- Page 5 -->
<a name="5"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page5-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3005.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft59">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft50">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft521">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft521">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft522"><b>List&#160;of&#160;figures</b></p>
<p style="position:absolute;top:200px;left:83px;white-space:nowrap" class="ft519">Figure&#160;1:&#160;Messages&#160;exchanged&#160;during&#160;the&#160;TLS&#160;handshake&#160;protocol...............................7<br/>Figure&#160;2:&#160;Supplemental&#160;data&#160;exchange&#160;in&#160;TLS&#160;handshake&#160;protocol................................9<br/>Figure&#160;3:&#160;TLS&#160;extended&#160;to&#160;support&#160;DAA&#160;authentication&#160;(DAA-TLS)...............................12<br/>Figure&#160;4:&#160;TCG&#160;TSS/TPM&#160;DAA&#160;profile&#160;for&#160;DAA-TLS:&#160;TLS&#160;handshake&#160;and&#160;TSS&#160;calls...........19</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft521">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft521">3/27</p>
</div>
<!-- Page 6 -->
<a name="6"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft624{font-size:21px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
	.ft625{font-size:17px;line-height:28px;font-family:DAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page6-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3006.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft69">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft60">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft621">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft621">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft624"><b>1&#160;&#160;&#160;Introduction</b></p>
<p style="position:absolute;top:200px;left:83px;white-space:nowrap" class="ft619">Secure&#160;channels&#160;allow&#160;two&#160;or&#160;more&#160;entities&#160;to&#160;communicate&#160;securely&#160;over&#160;insecure&#160;<br/>networks.&#160;These&#160;channels&#160;use&#160;cryptographic&#160;primitives&#160;to&#160;provide&#160;confidentiality,&#160;<br/>integrity&#160;and&#160;authentication&#160;of&#160;network&#160;messages.&#160;Trusted&#160;Computing&#160;(TC)&#160;technology&#160;<br/>allows&#160;to&#160;extend&#160;the&#160;network&#160;protection&#160;to&#160;the&#160;peers&#160;involved&#160;in&#160;the&#160;communication.&#160;<br/>TC,&#160;in&#160;facts,&#160;allows&#160;a&#160;platform&#160;with&#160;TC-enabled&#160;hardware&#160;to&#160;provide&#160;cryptographic&#160;<br/>proofs&#160;about&#160;its&#160;behavior.&#160;By&#160;using&#160;this&#160;information,&#160;the&#160;counterpart&#160;can&#160;be&#160;<br/>guaranteed&#160;about&#160;the&#160;security&#160;of&#160;the&#160;message&#160;not&#160;only&#160;while&#160;it&#160;is&#160;transmitted,&#160;but&#160;also&#160;<br/>after&#160;it&#160;is&#160;received&#160;on&#160;the&#160;TC-platform.</p>
<p style="position:absolute;top:381px;left:83px;white-space:nowrap" class="ft624"><b>2&#160;&#160;&#160;The&#160;Direct&#160;Anonymous&#160;Attestation&#160;(DAA)&#160;protocol</b></p>
<p style="position:absolute;top:414px;left:83px;white-space:nowrap" class="ft625">Direct&#160;Anonymous&#160;Attestation&#160;(DAA)&#160;([6])&#160;is&#160;a&#160;privacy-friendly&#160;protocol&#160;that&#160;was&#160;<br/>designed&#160;to&#160;overcome&#160;the&#160;privacy&#160;issues&#160;of&#160;the&#160;Privacy&#160;CA&#160;(PCA).&#160;In&#160;particular,&#160;the&#160;<br/>main&#160;problem&#160;related&#160;to&#160;the&#160;use&#160;of&#160;a&#160;Privacy&#160;CA,&#160;is&#160;that&#160;it&#160;is&#160;possible&#160;for&#160;the&#160;privacy&#160;CA&#160;<br/>to&#160;disclose&#160;sensitive&#160;data&#160;that&#160;could&#160;allow&#160;a&#160;third&#160;party&#160;to&#160;link&#160;different&#160;remote&#160;<br/>attestations&#160;made&#160;by&#160;the&#160;same&#160;platform&#160;and,&#160;therefore,&#160;breaking&#160;the&#160;platform's&#160;<br/>privacy.&#160;DAA&#160;overcomes&#160;this&#160;problem&#160;using&#160;a&#160;zero-knowledge&#160;proof.<br/>In&#160;this&#160;section&#160;is&#160;given&#160;an&#160;overview&#160;of&#160;the&#160;DAA&#160;protocol&#160;and&#160;described&#160;how&#160;this&#160;<br/>protocol&#160;can&#160;be&#160;used&#160;to&#160;provide&#160;anonymous&#160;authentication.<br/>The&#160;DAA&#160;scheme&#160;involves&#160;four&#160;principals,&#160;three&#160;mandatory&#160;and&#160;one&#160;optional:</p>
<p style="position:absolute;top:619px;left:110px;white-space:nowrap" class="ft612">●</p>
<p style="position:absolute;top:614px;left:137px;white-space:nowrap" class="ft617">TC-platform&#160;equipped&#160;with&#160;a&#160;TPM.</p>
<p style="position:absolute;top:647px;left:110px;white-space:nowrap" class="ft612">●</p>
<p style="position:absolute;top:642px;left:137px;white-space:nowrap" class="ft617">DAA&#160;issuer.</p>
<p style="position:absolute;top:675px;left:110px;white-space:nowrap" class="ft612">●</p>
<p style="position:absolute;top:670px;left:137px;white-space:nowrap" class="ft617">Verifier.</p>
<p style="position:absolute;top:703px;left:110px;white-space:nowrap" class="ft612">●</p>
<p style="position:absolute;top:699px;left:137px;white-space:nowrap" class="ft617">A&#160;revocation&#160;authority.&#160;This&#160;last&#160;entity&#160;is&#160;optional.</p>
<p style="position:absolute;top:727px;left:83px;white-space:nowrap" class="ft619">The&#160;purpose&#160;of&#160;the&#160;DAA&#160;is&#160;to&#160;convince&#160;the&#160;verifier&#160;that&#160;a&#160;signature&#160;received&#160;from&#160;the&#160;<br/>TC-platform&#160;was&#160;made&#160;using&#160;a&#160;genuine&#160;TPM,&#160;without&#160;revealing&#160;the&#160;actual&#160;identity&#160;of&#160;<br/>the&#160;platform&#160;(in&#160;TCG&#160;architecture&#160;the&#160;identity&#160;of&#160;a&#160;platform&#160;is&#160;represented&#160;by&#160;the&#160;<br/>Endorsement&#160;Key&#160;(EK)&#160;of&#160;the&#160;TPM).<br/>The&#160;DAA&#160;is&#160;composed&#160;of&#160;two&#160;main&#160;protocols:&#160;the&#160;Join&#160;protocol&#160;and&#160;the&#160;Sign&#160;protocol.<br/>The&#160;Join&#160;protocol&#160;occurs&#160;between&#160;the&#160;platform&#160;and&#160;the&#160;issuer&#160;and&#160;results&#160;in&#160;the&#160;TC-<br/>platform&#160;receiving&#160;a&#160;DAA&#160;credential,&#160;so&#160;it&#160;can&#160;authenticate&#160;to&#160;verifiers.&#160;In&#160;details,&#160;the&#160;<br/>issuer&#160;checks&#160;that&#160;the&#160;platform&#160;is&#160;equipped&#160;with&#160;a&#160;genuine&#160;TPM&#160;and,&#160;if&#160;this&#160;is&#160;the&#160;case,&#160;<br/>issues&#160;to&#160;the&#160;TPM&#160;the&#160;DAA&#160;credentials.&#160;This&#160;protocol&#160;occurs&#160;once&#160;for&#160;a&#160;TC-platform&#160;and&#160;<br/>has&#160;to&#160;happen&#160;before&#160;it&#160;can&#160;meaningfully&#160;interact&#160;with&#160;verifiers.&#160;<br/>The&#160;Sign&#160;protocol&#160;allows&#160;a&#160;verifier&#160;to&#160;decide&#160;if&#160;a&#160;signature&#160;received&#160;from&#160;a&#160;TC-platform&#160;<br/>was&#160;made&#160;using&#160;a&#160;genuine&#160;TPM&#160;or&#160;not.&#160;Unlike&#160;with&#160;other&#160;protocols&#160;(e.g.&#160;those&#160;involving&#160;<br/>the&#160;use&#160;of&#160;an&#160;AIK),&#160;the&#160;verifier&#160;does&#160;not&#160;need&#160;to&#160;see&#160;the&#160;actual&#160;DAA&#160;credential,&#160;but&#160;the&#160;<br/>proof&#160;of&#160;the&#160;existence&#160;of&#160;the&#160;credentials&#160;is&#160;provided&#160;through&#160;a&#160;zero-knowledge&#160;proof.<br/>In&#160;detail,&#160;the&#160;DAA&#160;signature&#160;is&#160;a&#160;group&#160;signature&#160;that&#160;provides&#160;the&#160;verifier&#160;with&#160;an&#160;<br/>evidence&#160;that&#160;the&#160;platform&#160;belongs&#160;to&#160;the&#160;group&#160;of&#160;platforms&#160;that&#160;received&#160;the&#160;DAA&#160;<br/>credentials&#160;from&#160;a&#160;particular&#160;issuer.<br/>DAA&#160;provides&#160;both&#160;complete&#160;anonymity&#160;and&#160;pseudonymity.&#160;Complete&#160;anonymity&#160;<br/>means&#160;that&#160;the&#160;verifier&#160;can&#160;only&#160;verify&#160;if&#160;the&#160;platform&#160;that&#160;generated&#160;the&#160;DAA&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft621">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft621">4/27</p>
</div>
<!-- Page 7 -->
<a name="7"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft726{font-size:20px;font-family:FAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page7-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3007.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft79">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft70">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft721">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft721">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft719">signature&#160;belongs&#160;to&#160;the&#160;group&#160;of&#160;platforms&#160;that&#160;received&#160;the&#160;DAA&#160;credentials&#160;from&#160;the&#160;<br/>issuer.&#160;Therefore&#160;each&#160;issuer&#160;represents&#160;a&#160;group&#160;of&#160;platforms,&#160;but&#160;each&#160;platform&#160;can&#160;<br/>belong&#160;to&#160;different&#160;groups&#160;through&#160;DAA&#160;credentials&#160;obtained&#160;from&#160;different&#160;issuers.<br/>The&#160;pseudonymous&#160;option&#160;allows&#160;a&#160;verifier&#160;to&#160;link&#160;together&#160;different&#160;signatures&#160;made&#160;<br/>by&#160;the&#160;same&#160;platform.&#160;Notably,&#160;the&#160;verifier&#160;can&#160;recognize&#160;the&#160;pseudonym&#160;under&#160;which&#160;<br/>a&#160;particular&#160;platform&#160;made&#160;a&#160;signature&#160;and&#160;link&#160;it&#160;to&#160;previous&#160;signatures&#160;made&#160;by&#160;the&#160;<br/>same&#160;pseudonym,&#160;but&#160;it&#160;is&#160;not&#160;possible&#160;for&#160;the&#160;verifier,&#160;to&#160;link&#160;the&#160;pseudonym&#160;with&#160;the&#160;<br/>actual&#160;platform.<br/>Furthermore,&#160;the&#160;DAA&#160;signature&#160;can&#160;selectively&#160;provide&#160;a&#160;zero-knowledge&#160;proof&#160;on&#160;a&#160;<br/>subset&#160;of&#160;the&#160;attributes&#160;that&#160;belong&#160;to&#160;the&#160;DAA&#160;certificate;&#160;for&#160;instance,&#160;it&#160;is&#160;possible&#160;to&#160;<br/>prove&#160;that&#160;the&#160;expiration&#160;date&#160;of&#160;a&#160;DAA&#160;credential&#160;has&#160;not&#160;been&#160;reached,&#160;without&#160;<br/>revealing&#160;it.<br/>Finally,&#160;the&#160;DAA&#160;protocol&#160;allows&#160;to&#160;use&#160;a&#160;trusted&#160;third&#160;party&#160;as&#160;a&#160;Revocation&#160;Authority&#160;<br/>(RA).&#160;The&#160;RA&#160;can&#160;revoke&#160;the&#160;anonymity&#160;or&#160;the&#160;pseudonymity&#160;provided&#160;by&#160;the&#160;DAA&#160;<br/>credentials&#160;under&#160;particular&#160;circumstances&#160;determined&#160;by&#160;a&#160;policy.&#160;When&#160;the&#160;RA&#160;is&#160;<br/>used,&#160;the&#160;platform&#160;encrypts&#160;its&#160;identity&#160;using&#160;the&#160;public&#160;key&#160;of&#160;the&#160;RA;&#160;the&#160;verifier&#160;then&#160;<br/>can&#160;forward&#160;the&#160;encrypted&#160;identity&#160;of&#160;the&#160;platform&#160;to&#160;the&#160;revocation&#160;authority&#160;that&#160;<br/>reveals&#160;the&#160;identity&#160;of&#160;the&#160;platform&#160;if&#160;the&#160;circumstances&#160;determined&#160;by&#160;the&#160;policy&#160;<br/>apply.<br/>Note&#160;that&#160;in&#160;this&#160;version&#160;of&#160;the&#160;document,&#160;neither&#160;the&#160;attributes&#160;nor&#160;the&#160;revocation&#160;<br/>authority&#160;are&#160;used.</p>
<p style="position:absolute;top:615px;left:83px;white-space:nowrap" class="ft724"><b>3&#160;&#160;&#160;Using&#160;the&#160;DAA&#160;for&#160;authentication</b></p>
<p style="position:absolute;top:649px;left:83px;white-space:nowrap" class="ft719">It&#160;is&#160;possible&#160;to&#160;use&#160;the&#160;DAA&#160;to&#160;authenticate&#160;a&#160;platform,&#160;and&#160;therefore&#160;to&#160;authenticate&#160;<br/>its&#160;owner,&#160;while&#160;guaranteeing&#160;its&#160;privacy.&#160;In&#160;general,&#160;a&#160;TC-enabled&#160;platform&#160;receives&#160;<br/>the&#160;DAA&#160;credentials&#160;from&#160;an&#160;issuer,&#160;and&#160;many&#160;different&#160;verifiers&#160;challenge&#160;the&#160;platform&#160;<br/>to&#160;verify&#160;if&#160;it&#160;belongs&#160;to&#160;the&#160;group&#160;of&#160;platforms&#160;that&#160;received&#160;the&#160;DAA&#160;credentials&#160;from&#160;<br/>that&#160;issuer.&#160;The&#160;TPM&#160;guarantees&#160;that&#160;the&#160;DAA&#160;credentials&#160;cannot&#160;be&#160;shared&#160;with&#160;other&#160;<br/>platforms&#160;and&#160;actually&#160;belong&#160;to&#160;the&#160;platform,&#160;while&#160;the&#160;DAA&#160;protocol&#160;guarantees&#160;that&#160;<br/>it&#160;is&#160;not&#160;possible&#160;to&#160;link&#160;one&#160;challenge&#160;to&#160;the&#160;actual&#160;identity&#160;of&#160;the&#160;platform,&#160;thus&#160;<br/>preserving&#160;the&#160;privacy&#160;of&#160;the&#160;platform.<br/>The&#160;DAA&#160;signature&#160;allows&#160;a&#160;verifier&#160;to&#160;authenticate&#160;the&#160;platform&#160;that&#160;made&#160;the&#160;<br/>signature&#160;w.r.t.&#160;a&#160;group&#160;of&#160;platforms&#160;(i.e.&#160;those&#160;that&#160;received&#160;the&#160;credentials&#160;from&#160;a&#160;<br/>particular&#160;issuer),&#160;and&#160;the&#160;platform&#160;has&#160;assurance&#160;that&#160;it&#160;is&#160;not&#160;possible&#160;to&#160;link&#160;such&#160;<br/>authentication&#160;to&#160;its&#160;real&#160;identity.</p>
<p style="position:absolute;top:915px;left:83px;white-space:nowrap" class="ft726"><i><b>3.1&#160;&#160;&#160;Application&#160;scenario</b></i></p>
<p style="position:absolute;top:946px;left:83px;white-space:nowrap" class="ft719">A&#160;possible&#160;scenario&#160;for&#160;a&#160;DAA-based&#160;authentication&#160;for&#160;a&#160;service&#160;is&#160;the&#160;following:&#160;a&#160;<br/>company&#160;wants&#160;to&#160;allow&#160;access&#160;to&#160;the&#160;internal&#160;network&#160;only&#160;to&#160;authorized&#160;platforms.&#160;<br/>This&#160;requirement&#160;can&#160;be&#160;fulfilled&#160;using&#160;a&#160;TPM-enabled&#160;platform&#160;and&#160;the&#160;DAA&#160;protocol:</p>
<p style="position:absolute;top:1013px;left:110px;white-space:nowrap" class="ft717">1.&#160;The&#160;company&#160;issues&#160;a&#160;DAA&#160;certificate&#160;to&#160;each&#160;laptop&#160;before&#160;giving&#160;it&#160;to&#160;the&#160;</p>
<p style="position:absolute;top:1032px;left:137px;white-space:nowrap" class="ft717">employee.</p>
<p style="position:absolute;top:1060px;left:110px;white-space:nowrap" class="ft717">2.&#160;The&#160;company&#160;verifies&#160;that&#160;only&#160;allowed&#160;platforms&#160;(i.e.&#160;those&#160;that&#160;received&#160;a&#160;DAA&#160;</p>
<p style="position:absolute;top:1080px;left:137px;white-space:nowrap" class="ft717">certificate)&#160;access&#160;the&#160;network&#160;with&#160;a&#160;DAA&#160;challenge.</p>
<p style="position:absolute;top:1108px;left:83px;white-space:nowrap" class="ft717">In&#160;this&#160;scenario,&#160;the&#160;company&#160;is&#160;assured&#160;that&#160;only&#160;certified&#160;laptops&#160;can&#160;access&#160;the&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft721">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft721">5/27</p>
</div>
<!-- Page 8 -->
<a name="8"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft827{font-size:17px;font-family:GAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page8-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3008.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft89">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft80">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft821">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft821">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft819">network,&#160;and&#160;the&#160;employees&#160;are&#160;guaranteed&#160;that&#160;the&#160;company&#160;can&#160;not&#160;link&#160;the&#160;<br/>authentication&#160;to&#160;their&#160;specific&#160;platform.&#160;The&#160;company&#160;might&#160;also&#160;desire&#160;to&#160;link&#160;the&#160;<br/>accesses&#160;to&#160;different&#160;services&#160;provided&#160;to&#160;the&#160;remote&#160;users.&#160;In&#160;this&#160;case&#160;the&#160;<br/>pseudonymous&#160;option&#160;provided&#160;by&#160;DAA&#160;can&#160;meet&#160;the&#160;requirement.</p>
<p style="position:absolute;top:253px;left:83px;white-space:nowrap" class="ft826"><i><b>3.2&#160;&#160;&#160;Combining&#160;TLS&#160;and&#160;DAA&#160;protocols</b></i></p>
<p style="position:absolute;top:285px;left:83px;white-space:nowrap" class="ft819">An&#160;implementation&#160;of&#160;a&#160;protocol&#160;for&#160;anonymous&#160;authentication&#160;through&#160;the&#160;DAA&#160;<br/>signature&#160;is&#160;possible&#160;by&#160;enhancing&#160;the&#160;TLS&#160;protocol&#160;(see&#160;[3])&#160;to&#160;implement&#160;the&#160;<br/>concepts&#160;described&#160;in&#160;section&#160;5.&#160;Using&#160;the&#160;TLS&#160;protocol&#160;has&#160;many&#160;advantages:&#160;it&#160;is&#160;<br/>widely&#160;supported,&#160;many&#160;open&#160;source&#160;implementations&#160;are&#160;available&#160;and&#160;it&#160;is&#160;possible&#160;<br/>to&#160;extend&#160;the&#160;protocol&#160;without&#160;loosing&#160;backward&#160;compatibility.<br/>The&#160;latter&#160;point&#160;in&#160;particular&#160;is&#160;helpful&#160;because&#160;allows&#160;to&#160;design&#160;a&#160;protocol&#160;that&#160;can&#160;be&#160;<br/>used,&#160;when&#160;a&#160;TPM&#160;is&#160;available,&#160;to&#160;provide&#160;anonymous&#160;authentication,&#160;but&#160;can&#160;also&#160;<br/>work&#160;on&#160;platforms&#160;without&#160;TC-enabled&#160;hardware,&#160;thus&#160;providing&#160;classical&#160;<br/>authentication.&#160;Moreover,&#160;TLS&#160;also&#160;provides&#160;confidentiality&#160;and&#160;integrity&#160;of&#160;the&#160;<br/>messages&#160;exchanged&#160;on&#160;the&#160;channel.</p>
<p style="position:absolute;top:512px;left:83px;white-space:nowrap" class="ft824"><b>4&#160;&#160;&#160;Enhancing&#160;TLS&#160;protocol&#160;(informative)</b></p>
<p style="position:absolute;top:564px;left:83px;white-space:nowrap" class="ft826"><i><b>4.1&#160;&#160;&#160;TLS&#160;protocol</b></i></p>
<p style="position:absolute;top:595px;left:83px;white-space:nowrap" class="ft819">The&#160;Transport&#160;Layer&#160;Security&#160;(TLS)&#160;protocol&#160;implements&#160;a&#160;secure&#160;channel,&#160;namely&#160;a&#160;<br/>client/server&#160;communication&#160;guaranteeing&#160;authenticity,&#160;integrity&#160;and&#160;confidentiality&#160;of&#160;<br/>the&#160;exchanged&#160;data.&#160;Two&#160;main&#160;and&#160;subsequent&#160;phases&#160;can&#160;be&#160;identified:&#160;during&#160;the&#160;<br/>first&#160;one,&#160;a&#160;</p>
<p style="position:absolute;top:653px;left:178px;white-space:nowrap" class="ft827"><i>handshake</i></p>
<p style="position:absolute;top:653px;left:268px;white-space:nowrap" class="ft817">&#160;protocol&#160;is&#160;run&#160;by&#160;peers&#160;to&#160;authenticate&#160;themselves&#160;to&#160;each&#160;</p>
<p style="position:absolute;top:672px;left:83px;white-space:nowrap" class="ft825">other&#160;and&#160;agree&#160;on&#160;a&#160;session&#160;key;&#160;then,&#160;once&#160;the&#160;handshake&#160;is&#160;completed,&#160;the&#160;<br/>communication&#160;begins&#160;and&#160;the&#160;peers&#160;exchange&#160;messages&#160;over&#160;the&#160;established&#160;secure&#160;<br/>channel.<br/>In<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#9">&#160;Figure&#160;1&#160;</a>a&#160;diagram&#160;shows&#160;the&#160;messages&#160;exchanged&#160;by&#160;client&#160;and&#160;server&#160;during&#160;the&#160;<br/>TLS&#160;handshake.<br/>It&#160;is&#160;possible&#160;to&#160;extend&#160;the&#160;TLS&#160;handshake&#160;by&#160;defining:</p>
<p style="position:absolute;top:814px;left:110px;white-space:nowrap" class="ft825">1.&#160;extensions&#160;to&#160;the&#160;hello&#160;messages&#160;according&#160;to&#160;the&#160;framework&#160;specified&#160;in&#160;[4]<br/>2.&#160;new&#160;data&#160;units&#160;carried&#160;over&#160;an&#160;additional&#160;handshake&#160;message,&#160;called&#160;</p>
<p style="position:absolute;top:862px;left:137px;white-space:nowrap" class="ft819">supplemental&#160;data&#160;and&#160;specified&#160;in&#160;[5],&#160;which&#160;can&#160;be&#160;exchanged&#160;between&#160;client&#160;<br/>and&#160;the&#160;server&#160;in&#160;both&#160;directions&#160;</p>
<p style="position:absolute;top:909px;left:83px;white-space:nowrap" class="ft819">All&#160;definitions&#160;recalled&#160;in&#160;the&#160;following&#160;are&#160;expressed&#160;using&#160;the&#160;Presentation&#160;Language&#160;<br/>specified&#160;and&#160;used&#160;in&#160;[3].</p>
<p style="position:absolute;top:974px;left:83px;white-space:nowrap" class="ft826"><i><b>4.2&#160;&#160;&#160;Hello&#160;extensions</b></i></p>
<p style="position:absolute;top:1006px;left:83px;white-space:nowrap" class="ft819">The&#160;hello&#160;extensions&#160;consist&#160;of&#160;additional&#160;data&#160;that&#160;may&#160;be&#160;used&#160;to&#160;add&#160;functionalities&#160;<br/>to&#160;TLS&#160;and&#160;are&#160;designed&#160;to&#160;be&#160;backward&#160;compatible.&#160;Indeed&#160;the&#160;extensions&#160;must&#160;be&#160;<br/>negotiated:&#160;therefore&#160;TLS&#160;clients&#160;supporting&#160;the&#160;extensions&#160;can&#160;communicate&#160;with&#160;TLS&#160;<br/>servers&#160;not&#160;supporting&#160;them&#160;and&#160;vice&#160;versa.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft821">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft821">6/27</p>
</div>
<!-- Page 9 -->
<a name="9"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft928{font-size:17px;font-family:HAAAAA+BitstreamVeraSansMono;color:#000000;}
	.ft929{font-size:15px;font-family:GAAAAA+BitstreamVeraSans;color:#000000;}
	.ft930{font-size:17px;line-height:19px;font-family:HAAAAA+BitstreamVeraSansMono;color:#000000;}
-->
</style>
<div id="page9-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3009.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft99">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft90">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft921">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft921">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:727px;left:83px;white-space:nowrap" class="ft917">The&#160;extended&#160;client&#160;hello&#160;message&#160;definition&#160;is:&#160;</p>
<p style="position:absolute;top:764px;left:105px;white-space:nowrap" class="ft928"><b>struct&#160;{</b></p>
<p style="position:absolute;top:783px;left:158px;white-space:nowrap" class="ft930"><b>ProtocolVersion&#160;client_version;<br/>Random&#160;random;<br/>SessionID&#160;session_id;<br/>CipherSuite&#160;cipher_suites&lt;2..2^16-1&gt;;<br/>CompressionMethod&#160;compression_methods&lt;1..2^8-1&gt;;<br/>Extension&#160;client_hello_extension_list&lt;0..2^16-1&gt;;</b></p>
<p style="position:absolute;top:898px;left:105px;white-space:nowrap" class="ft928"><b>}&#160;ClientHello;</b></p>
<p style="position:absolute;top:935px;left:83px;white-space:nowrap" class="ft917">and,&#160;symmetrically,&#160;the&#160;extended&#160;server&#160;hello&#160;message&#160;definition&#160;is:</p>
<p style="position:absolute;top:972px;left:105px;white-space:nowrap" class="ft928"><b>struct&#160;{</b></p>
<p style="position:absolute;top:992px;left:158px;white-space:nowrap" class="ft930"><b>ProtocolVersion&#160;server_version;<br/>Random&#160;random;<br/>SessionID&#160;session_id;<br/>CipherSuite&#160;cipher_suite;<br/>CompressionMethod&#160;compression_method;<br/>Extension&#160;server_hello_extension_list&lt;0..2^16-1&gt;;</b></p>
<p style="position:absolute;top:1107px;left:105px;white-space:nowrap" class="ft928"><b>}&#160;ServerHello;</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft921">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft921">7/27</p>
<p style="position:absolute;top:659px;left:195px;white-space:nowrap" class="ft929"><i>Figure&#160;1:&#160;Messages&#160;exchanged&#160;during&#160;the&#160;TLS&#160;handshake&#160;protocol</i></p>
</div>
<!-- Page 10 -->
<a name="10"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page10-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3010.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft109">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft100">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft1021">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft1021">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft1017">where&#160;</p>
<p style="position:absolute;top:149px;left:140px;white-space:nowrap" class="ft1028"><b>client_hello_extensions_list</b></p>
<p style="position:absolute;top:149px;left:418px;white-space:nowrap" class="ft1017">&#160;and&#160;</p>
<p style="position:absolute;top:149px;left:460px;white-space:nowrap" class="ft1028"><b>server_hello_extension_list&#160;</b></p>
<p style="position:absolute;top:168px;left:83px;white-space:nowrap" class="ft1025">represent&#160;the&#160;new&#160;field&#160;containing&#160;a&#160;list&#160;of&#160;extensions,&#160;while&#160;the&#160;other&#160;fields&#160;have&#160;the&#160;<br/>same&#160;meaning&#160;as&#160;in&#160;the&#160;base&#160;TLS&#160;specification&#160;([3]).<br/>Each&#160;extension&#160;is&#160;defined&#160;as:</p>
<p style="position:absolute;top:253px;left:105px;white-space:nowrap" class="ft1028"><b>struct&#160;{</b></p>
<p style="position:absolute;top:272px;left:158px;white-space:nowrap" class="ft1030"><b>ExtensionType&#160;extension_type;<br/>opaque&#160;extension_data&lt;0..2^16-1&gt;;</b></p>
<p style="position:absolute;top:310px;left:105px;white-space:nowrap" class="ft1028"><b>}&#160;Extension;</b></p>
<p style="position:absolute;top:348px;left:83px;white-space:nowrap" class="ft1017">where&#160;</p>
<p style="position:absolute;top:348px;left:140px;white-space:nowrap" class="ft1028"><b>extension_type</b></p>
<p style="position:absolute;top:348px;left:279px;white-space:nowrap" class="ft1017">&#160;is&#160;(the&#160;unique&#160;identifier&#160;of)&#160;the&#160;type&#160;of&#160;the&#160;extension&#160;and&#160;</p>
<p style="position:absolute;top:367px;left:83px;white-space:nowrap" class="ft1028"><b>extension_data</b></p>
<p style="position:absolute;top:367px;left:223px;white-space:nowrap" class="ft1017">&#160;contains&#160;data&#160;specific&#160;for&#160;the&#160;particular&#160;extension&#160;type.</p>
<p style="position:absolute;top:395px;left:83px;white-space:nowrap" class="ft1017">Clients&#160;and&#160;servers&#160;using&#160;the&#160;extensions&#160;must&#160;adhere&#160;to&#160;the&#160;following&#160;rules:</p>
<p style="position:absolute;top:423px;left:110px;white-space:nowrap" class="ft1017">1.&#160;if&#160;the&#160;client&#160;wants&#160;to&#160;request&#160;the&#160;server&#160;for&#160;extended&#160;functionalities,&#160;it&#160;sends&#160;the&#160;</p>
<p style="position:absolute;top:442px;left:137px;white-space:nowrap" class="ft1017">extended&#160;client&#160;hello&#160;message&#160;instead&#160;of&#160;the&#160;standard&#160;hello&#160;message</p>
<p style="position:absolute;top:471px;left:110px;white-space:nowrap" class="ft1017">2.&#160;if&#160;the&#160;server&#160;supports&#160;the&#160;extended&#160;functionalities&#160;required&#160;by&#160;the&#160;client,&#160;it&#160;may&#160;</p>
<p style="position:absolute;top:490px;left:137px;white-space:nowrap" class="ft1019">reply&#160;with&#160;an&#160;extended&#160;server&#160;hello&#160;that&#160;contains&#160;a&#160;subset&#160;of&#160;the&#160;extensions&#160;<br/>sent&#160;by&#160;the&#160;client&#160;in&#160;order&#160;to&#160;signal&#160;to&#160;the&#160;latter&#160;which&#160;functionalities&#160;will&#160;be&#160;<br/>provided</p>
<p style="position:absolute;top:556px;left:83px;white-space:nowrap" class="ft1025">The&#160;extended&#160;server&#160;hello&#160;message&#160;can&#160;only&#160;be&#160;sent&#160;in&#160;response&#160;to&#160;a&#160;received&#160;<br/>extended&#160;client&#160;hello&#160;message&#160;and&#160;cannot&#160;contain&#160;any&#160;extension&#160;that&#160;was&#160;not&#160;<br/>previously&#160;requested&#160;by&#160;the&#160;client.&#160;The&#160;complete&#160;definition&#160;of&#160;the&#160;TLS&#160;extension&#160;<br/>framework&#160;is&#160;specified&#160;in&#160;[4].<br/>Each&#160;</p>
<p style="position:absolute;top:642px;left:129px;white-space:nowrap" class="ft1028"><b>Extension</b></p>
<p style="position:absolute;top:642px;left:218px;white-space:nowrap" class="ft1017">&#160;must&#160;be&#160;defined&#160;by&#160;explicit&#160;specification.&#160;Five&#160;new&#160;extensions&#160;are&#160;</p>
<p style="position:absolute;top:661px;left:83px;white-space:nowrap" class="ft1017">specified&#160;in&#160;[4].</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft1021">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft1021">8/27</p>
</div>
<!-- Page 11 -->
<a name="11"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page11-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3011.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft119">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft110">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft1121">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft1121">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:744px;left:83px;white-space:nowrap" class="ft1126"><i><b>4.3&#160;&#160;&#160;Supplemental&#160;data&#160;message</b></i></p>
<p style="position:absolute;top:775px;left:83px;white-space:nowrap" class="ft1125">The&#160;supplemental&#160;data&#160;is&#160;an&#160;additional&#160;message&#160;of&#160;the&#160;TLS&#160;handshake,&#160;specified&#160;in&#160;[5],&#160;<br/>to&#160;carry&#160;extra&#160;authentication&#160;and/or&#160;authorization&#160;data&#160;units&#160;for&#160;the&#160;application&#160;<br/>establishing&#160;the&#160;secure&#160;channel.<br/>Different&#160;data&#160;units,&#160;called&#160;supplemental&#160;data&#160;entries,&#160;can&#160;be&#160;transferred&#160;from&#160;server&#160;<br/>to&#160;client&#160;and&#160;vice&#160;versa:&#160;however,&#160;for&#160;each&#160;direction&#160;all&#160;supplemental&#160;data&#160;entries&#160;must&#160;<br/>be&#160;carried&#160;over&#160;a&#160;single&#160;message&#160;exchanged&#160;during&#160;the&#160;handshake,&#160;as&#160;shown&#160;in&#160;<br/><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#11">Figure&#160;2.<br/></a>The&#160;supplemental&#160;data&#160;message&#160;is&#160;defined&#160;as:</p>
<p style="position:absolute;top:965px;left:105px;white-space:nowrap" class="ft1128"><b>struct&#160;{</b></p>
<p style="position:absolute;top:984px;left:158px;white-space:nowrap" class="ft1128"><b>SupplementalDataEntry&#160;supp_data&lt;1..2^24-1&gt;;</b></p>
<p style="position:absolute;top:1003px;left:105px;white-space:nowrap" class="ft1128"><b>}&#160;SupplementalData;</b></p>
<p style="position:absolute;top:1040px;left:83px;white-space:nowrap" class="ft1117">where&#160;</p>
<p style="position:absolute;top:1040px;left:140px;white-space:nowrap" class="ft1128"><b>supp_data</b></p>
<p style="position:absolute;top:1040px;left:229px;white-space:nowrap" class="ft1117">&#160;is&#160;a&#160;list&#160;of&#160;items&#160;defined&#160;as:</p>
<p style="position:absolute;top:1077px;left:105px;white-space:nowrap" class="ft1128"><b>struct&#160;{</b></p>
<p style="position:absolute;top:1097px;left:158px;white-space:nowrap" class="ft1130"><b>SupplementalDataType&#160;supp_data_type;<br/>uint16&#160;supp_data_length;</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft1121">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft1121">9/27</p>
<p style="position:absolute;top:700px;left:198px;white-space:nowrap" class="ft1129"><i>Figure&#160;2:&#160;Supplemental&#160;data&#160;exchange&#160;in&#160;TLS&#160;handshake&#160;protocol</i></p>
</div>
<!-- Page 12 -->
<a name="12"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page12-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3012.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft129">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft120">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft1221">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft1221">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:149px;left:158px;white-space:nowrap" class="ft1228"><b>select(SupplementalDataType)&#160;{&#160;}</b></p>
<p style="position:absolute;top:168px;left:105px;white-space:nowrap" class="ft1228"><b>}&#160;SupplementalDataEntry;</b></p>
<p style="position:absolute;top:214px;left:105px;white-space:nowrap" class="ft1228"><b>enum&#160;{</b></p>
<p style="position:absolute;top:234px;left:158px;white-space:nowrap" class="ft1228"><b>(65535)</b></p>
<p style="position:absolute;top:253px;left:105px;white-space:nowrap" class="ft1228"><b>}&#160;SupplementalDataType;</b></p>
<p style="position:absolute;top:290px;left:83px;white-space:nowrap" class="ft1217">Each&#160;</p>
<p style="position:absolute;top:290px;left:129px;white-space:nowrap" class="ft1228"><b>SupplementalDataEntry</b></p>
<p style="position:absolute;top:290px;left:338px;white-space:nowrap" class="ft1217">&#160;is&#160;defined&#160;by&#160;a&#160;unique&#160;type&#160;(</p>
<p style="position:absolute;top:290px;left:580px;white-space:nowrap" class="ft1228"><b>supp_data_type</b></p>
<p style="position:absolute;top:290px;left:719px;white-space:nowrap" class="ft1217">)&#160;and&#160;</p>
<p style="position:absolute;top:309px;left:83px;white-space:nowrap" class="ft1217">includes&#160;the&#160;length&#160;(</p>
<p style="position:absolute;top:309px;left:254px;white-space:nowrap" class="ft1228"><b>supp_data_length</b></p>
<p style="position:absolute;top:309px;left:413px;white-space:nowrap" class="ft1217">)&#160;and&#160;the&#160;value&#160;</p>
<p style="position:absolute;top:328px;left:83px;white-space:nowrap" class="ft1217">(</p>
<p style="position:absolute;top:328px;left:90px;white-space:nowrap" class="ft1228"><b>select&#160;(SupplementalDataType)&#160;{&#160;}</b></p>
<p style="position:absolute;top:328px;left:418px;white-space:nowrap" class="ft1217">).</p>
<p style="position:absolute;top:356px;left:83px;white-space:nowrap" class="ft1217">If&#160;present,&#160;the&#160;</p>
<p style="position:absolute;top:356px;left:205px;white-space:nowrap" class="ft1228"><b>SupplementalData</b></p>
<p style="position:absolute;top:356px;left:364px;white-space:nowrap" class="ft1217">&#160;message&#160;must&#160;contain&#160;at&#160;least&#160;one&#160;non&#160;empty&#160;</p>
<p style="position:absolute;top:376px;left:83px;white-space:nowrap" class="ft1228"><b>SupplementalDataEntry</b></p>
<p style="position:absolute;top:376px;left:292px;white-space:nowrap" class="ft1217">&#160;which&#160;is&#160;then&#160;used&#160;by&#160;the&#160;application.</p>
<p style="position:absolute;top:404px;left:83px;white-space:nowrap" class="ft1217">Each&#160;</p>
<p style="position:absolute;top:404px;left:129px;white-space:nowrap" class="ft1228"><b>SupplementalDataEntry</b></p>
<p style="position:absolute;top:404px;left:338px;white-space:nowrap" class="ft1217">&#160;must&#160;be&#160;negotiated&#160;between&#160;client&#160;and&#160;server&#160;via&#160;</p>
<p style="position:absolute;top:423px;left:83px;white-space:nowrap" class="ft1217">specific&#160;hello&#160;extension;&#160;receiving&#160;an&#160;unexpected&#160;</p>
<p style="position:absolute;top:423px;left:498px;white-space:nowrap" class="ft1228"><b>SupplementalDataEntry</b></p>
<p style="position:absolute;top:423px;left:707px;white-space:nowrap" class="ft1217">&#160;must&#160;result&#160;</p>
<p style="position:absolute;top:442px;left:83px;white-space:nowrap" class="ft1225">in&#160;a&#160;fatal&#160;error,&#160;and&#160;the&#160;receiver&#160;must&#160;close&#160;the&#160;connection.<br/>Furthermore,&#160;supplemental&#160;data&#160;entries&#160;must&#160;not&#160;be&#160;evaluated&#160;during&#160;(and&#160;interfere&#160;<br/>with)&#160;the&#160;TLS&#160;handshake&#160;by&#160;the&#160;protocol&#160;implementation&#160;but&#160;only&#160;at&#160;the&#160;end&#160;of&#160;the&#160;<br/>handshake&#160;and&#160;by&#160;the&#160;applications.<br/>Each&#160;</p>
<p style="position:absolute;top:537px;left:129px;white-space:nowrap" class="ft1228"><b>SupplementalDataEntry</b></p>
<p style="position:absolute;top:537px;left:338px;white-space:nowrap" class="ft1217">&#160;must&#160;be&#160;defined&#160;by&#160;explicit&#160;specification.&#160;Supplemental&#160;</p>
<p style="position:absolute;top:556px;left:83px;white-space:nowrap" class="ft1219">data&#160;entries&#160;can&#160;be&#160;sent&#160;by&#160;client&#160;and/or&#160;server&#160;according&#160;to&#160;their&#160;definition.&#160;The&#160;<br/>supplemental&#160;data&#160;message&#160;must&#160;be&#160;sent&#160;by&#160;either&#160;party&#160;(client/server)&#160;to&#160;the&#160;other&#160;<br/>one&#160;according&#160;to&#160;which&#160;data&#160;entries&#160;have&#160;to&#160;be&#160;carried&#160;in&#160;each&#160;direction.</p>
<p style="position:absolute;top:641px;left:83px;white-space:nowrap" class="ft1224"><b>5&#160;&#160;&#160;DAA-enhanced&#160;TLS&#160;(DAA-TLS)</b></p>
<p style="position:absolute;top:692px;left:83px;white-space:nowrap" class="ft1226"><i><b>5.1&#160;&#160;&#160;Overview</b></i></p>
<p style="position:absolute;top:724px;left:83px;white-space:nowrap" class="ft1217">TLS&#160;supports&#160;different&#160;key&#160;exchange&#160;and&#160;authentication&#160;methods.&#160;</p>
<p style="position:absolute;top:724px;left:637px;white-space:nowrap" class="ft1228"><b>DH_anon</b></p>
<p style="position:absolute;top:724px;left:706px;white-space:nowrap" class="ft1217">&#160;key&#160;</p>
<p style="position:absolute;top:743px;left:83px;white-space:nowrap" class="ft1219">exchange&#160;implies&#160;non-authenticated&#160;(i.e.&#160;anonymous)&#160;TLS&#160;sessions.&#160;Any&#160;other&#160;key&#160;<br/>exchange&#160;algorithm,&#160;instead,&#160;implies&#160;server&#160;authentication&#160;being&#160;mandatory&#160;and&#160;client&#160;<br/>authentication&#160;being&#160;optional.<br/>Enhancing&#160;TLS&#160;with&#160;DAA&#160;leads&#160;to&#160;additional&#160;authentication&#160;methods.&#160;In&#160;this&#160;document&#160;<br/>the&#160;use&#160;of&#160;DAA&#160;is&#160;specified&#160;only&#160;for&#160;the&#160;client&#160;authentication&#160;and&#160;with&#160;</p>
<p style="position:absolute;top:829px;left:662px;white-space:nowrap" class="ft1228"><b>RSA</b></p>
<p style="position:absolute;top:829px;left:692px;white-space:nowrap" class="ft1217">&#160;key&#160;</p>
<p style="position:absolute;top:848px;left:83px;white-space:nowrap" class="ft1219">exchange&#160;method.&#160;Subsequent&#160;specifications&#160;may&#160;define&#160;further&#160;methods&#160;considering&#160;<br/>DAA&#160;also&#160;for&#160;the&#160;server&#160;authentication&#160;and&#160;other&#160;key&#160;exchange&#160;methods&#160;supported&#160;by&#160;<br/>TLS.<br/>In&#160;this&#160;specification&#160;DAA&#160;is&#160;used&#160;to&#160;add&#160;a&#160;group&#160;authentication&#160;scheme&#160;for&#160;client,&#160;with&#160;<br/>two&#160;variants:&#160;complete&#160;anonymity&#160;within&#160;the&#160;group&#160;or&#160;use&#160;of&#160;a&#160;pseudonym&#160;chosen&#160;by&#160;<br/>the&#160;verifier&#160;to&#160;let&#160;it&#160;link&#160;different&#160;client&#160;authentications&#160;made&#160;by&#160;the&#160;same&#160;platform&#160;<br/>with&#160;specific&#160;group&#160;credentials&#160;(i.e.&#160;with&#160;DAA&#160;credentials&#160;released&#160;by&#160;a&#160;specific&#160;issuer).<br/>For&#160;brevity,&#160;in&#160;the&#160;following&#160;the&#160;former&#160;variant&#160;will&#160;be&#160;referred&#160;to&#160;as&#160;DAA&#160;<br/>authentication&#160;while&#160;the&#160;latter&#160;as&#160;DAA&#160;authentication&#160;with&#160;pseudonymous&#160;(or&#160;also&#160;DAA&#160;<br/>pseudonymous&#160;authentication).<br/>Table<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#13">&#160;1&#160;</a>summarizes&#160;all&#160;possible&#160;authentication&#160;methods&#160;for&#160;a&#160;TLS&#160;implementation&#160;<br/>adherent&#160;to&#160;this&#160;specification&#160;(i.e.&#160;supporting&#160;DAA-TLS).</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft1221">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft1221">10/27</p>
</div>
<!-- Page 13 -->
<a name="13"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page13-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3013.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft139">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft130">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft1321">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft1321">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:153px;left:88px;white-space:nowrap" class="ft1317">Complete&#160;anonymous&#160;TLS&#160;session</p>
<p style="position:absolute;top:153px;left:450px;white-space:nowrap" class="ft1317">Standard&#160;TLS&#160;with&#160;</p>
<p style="position:absolute;top:153px;left:606px;white-space:nowrap" class="ft1328"><b>DH_anon</b></p>
<p style="position:absolute;top:153px;left:676px;white-space:nowrap" class="ft1317">&#160;key&#160;exchange&#160;</p>
<p style="position:absolute;top:173px;left:450px;white-space:nowrap" class="ft1317">method</p>
<p style="position:absolute;top:200px;left:88px;white-space:nowrap" class="ft1317">Server&#160;authentication&#160;only</p>
<p style="position:absolute;top:200px;left:450px;white-space:nowrap" class="ft1319">Standard&#160;TLS&#160;with&#160;all&#160;key&#160;exchange&#160;<br/>methods&#160;but&#160;</p>
<p style="position:absolute;top:219px;left:561px;white-space:nowrap" class="ft1328"><b>DH_anon</b></p>
<p style="position:absolute;top:247px;left:88px;white-space:nowrap" class="ft1317">Client&#160;and&#160;server&#160;authentication</p>
<p style="position:absolute;top:247px;left:450px;white-space:nowrap" class="ft1319">Standard&#160;TLS&#160;with&#160;all&#160;key&#160;exchange&#160;<br/>methods&#160;but&#160;</p>
<p style="position:absolute;top:266px;left:561px;white-space:nowrap" class="ft1328"><b>DH_anon</b></p>
<p style="position:absolute;top:294px;left:88px;white-space:nowrap" class="ft1319">Group&#160;authentication&#160;for&#160;client&#160;and&#160;<br/>standard&#160;RSA&#160;authentication&#160;for&#160;server&#160;</p>
<p style="position:absolute;top:294px;left:450px;white-space:nowrap" class="ft1317">DAA-enhanced&#160;TLS&#160;with&#160;</p>
<p style="position:absolute;top:294px;left:653px;white-space:nowrap" class="ft1328"><b>RSA</b></p>
<p style="position:absolute;top:294px;left:683px;white-space:nowrap" class="ft1317">&#160;key&#160;exchange&#160;</p>
<p style="position:absolute;top:313px;left:450px;white-space:nowrap" class="ft1317">method</p>
<p style="position:absolute;top:340px;left:88px;white-space:nowrap" class="ft1319">Group&#160;authentication&#160;with&#160;pseudonym&#160;for&#160;<br/>client&#160;and&#160;standard&#160;RSA&#160;authentication&#160;for&#160;<br/>server&#160;</p>
<p style="position:absolute;top:340px;left:450px;white-space:nowrap" class="ft1317">DAA-enhanced&#160;TLS&#160;with&#160;</p>
<p style="position:absolute;top:340px;left:653px;white-space:nowrap" class="ft1328"><b>RSA</b></p>
<p style="position:absolute;top:340px;left:683px;white-space:nowrap" class="ft1317">&#160;key&#160;exchange&#160;</p>
<p style="position:absolute;top:360px;left:450px;white-space:nowrap" class="ft1317">method,&#160;pseudonym&#160;specified&#160;by&#160;verifier</p>
<p style="position:absolute;top:411px;left:178px;white-space:nowrap" class="ft1329"><i>Table&#160;1:&#160;Authentication&#160;methods&#160;for&#160;DAA-TLS&#160;capable&#160;client&#160;and&#160;server</i></p>
<p style="position:absolute;top:466px;left:83px;white-space:nowrap" class="ft1319">In&#160;this&#160;document&#160;the&#160;enhancement&#160;of&#160;TLS&#160;with&#160;DAA&#160;is&#160;specified&#160;through&#160;the&#160;definition&#160;<br/>of&#160;a&#160;new&#160;hello&#160;extension&#160;and&#160;a&#160;new&#160;supplemental&#160;data&#160;entry,&#160;both&#160;expressed&#160;using&#160;the&#160;<br/>Presentation&#160;Language&#160;specified&#160;and&#160;used&#160;in&#160;[3].</p>
<p style="position:absolute;top:550px;left:83px;white-space:nowrap" class="ft1326"><i><b>5.2&#160;&#160;&#160;Summary&#160;of&#160;DAA-TLS&#160;capabilities&#160;and&#160;protocol&#160;flow</b></i></p>
<p style="position:absolute;top:582px;left:83px;white-space:nowrap" class="ft1325">DAA&#160;is&#160;composed&#160;of&#160;two&#160;main&#160;protocols:&#160;Join&#160;where&#160;the&#160;platform&#160;obtains&#160;a&#160;DAA&#160;<br/>credential&#160;from&#160;an&#160;issuer&#160;and&#160;Sign&#160;where&#160;the&#160;platform&#160;performs&#160;a&#160;DAA&#160;signature&#160;and&#160;a&#160;<br/>verifier&#160;verifies&#160;it.<br/>In&#160;this&#160;specification&#160;only&#160;the&#160;DAA&#160;Sign&#160;protocol&#160;is&#160;used&#160;to&#160;enhance&#160;TLS&#160;for&#160;client&#160;<br/>authentication.&#160;The&#160;DAA&#160;Join&#160;protocol&#160;is&#160;out&#160;of&#160;scope&#160;and&#160;not&#160;described:&#160;it&#160;is&#160;assumed&#160;<br/>as&#160;previously&#160;run&#160;to&#160;obtain&#160;the&#160;DAA&#160;credential&#160;required&#160;by&#160;DAA&#160;Sign.<br/>The&#160;enhancement&#160;defined&#160;throughout&#160;this&#160;section&#160;(Section&#160;5)&#160;is&#160;generic&#160;to&#160;support&#160;any&#160;<br/>specification&#160;of&#160;DAA;&#160;in&#160;the&#160;next&#160;sections,&#160;instead,&#160;a&#160;binding&#160;to&#160;a&#160;particular&#160;DAA&#160;<br/>specification&#160;and&#160;design&#160;(i.e.&#160;TCG&#160;TSS/TPM)&#160;is&#160;defined.<br/>In&#160;this&#160;document,&#160;the&#160;revocation&#160;of&#160;DAA&#160;credentials&#160;and&#160;revocation&#160;checking,&#160;whilst&#160;<br/>essential&#160;elements&#160;for&#160;authentication,&#160;are&#160;not&#160;considered&#160;as&#160;part&#160;of&#160;DAA-TLS&#160;and,&#160;<br/>therefore,&#160;not&#160;specified,&#160;but&#160;left&#160;to&#160;the&#160;application.<br/>The&#160;DAA&#160;Sign&#160;protocol&#160;involves&#160;a&#160;platform&#160;and&#160;a&#160;verifier;&#160;there&#160;roles&#160;are&#160;respectively&#160;<br/>mapped&#160;onto&#160;client&#160;and&#160;server&#160;TLS&#160;roles.&#160;In&#160;order&#160;to&#160;preserve&#160;its&#160;privacy,&#160;the&#160;client&#160;<br/>authenticates&#160;itself&#160;by&#160;performing&#160;a&#160;DAA&#160;signature&#160;verified&#160;by&#160;the&#160;server.<br/>The&#160;protocol&#160;flow&#160;is:</p>
<p style="position:absolute;top:943px;left:110px;white-space:nowrap" class="ft1317">1.&#160;The&#160;client&#160;starts&#160;the&#160;TLS&#160;handshake&#160;by&#160;sending&#160;the&#160;</p>
<p style="position:absolute;top:943px;left:567px;white-space:nowrap" class="ft1328"><b>ClientHello</b></p>
<p style="position:absolute;top:943px;left:677px;white-space:nowrap" class="ft1317">&#160;message.&#160;The&#160;</p>
<p style="position:absolute;top:962px;left:137px;white-space:nowrap" class="ft1319">latter&#160;MUST&#160;contain&#160;an&#160;extension&#160;to&#160;inform&#160;the&#160;server&#160;that&#160;the&#160;client&#160;is&#160;capable&#160;<br/>of&#160;using&#160;DAA&#160;for&#160;authentication.</p>
<p style="position:absolute;top:1010px;left:110px;white-space:nowrap" class="ft1317">2.&#160;If&#160;the&#160;server&#160;agrees&#160;on&#160;using&#160;DAA&#160;for&#160;client&#160;authentication,&#160;it&#160;replies&#160;to&#160;the&#160;client&#160;</p>
<p style="position:absolute;top:1029px;left:137px;white-space:nowrap" class="ft1317">with&#160;the&#160;</p>
<p style="position:absolute;top:1029px;left:210px;white-space:nowrap" class="ft1328"><b>ServerHello</b></p>
<p style="position:absolute;top:1029px;left:319px;white-space:nowrap" class="ft1317">&#160;message&#160;by&#160;sending&#160;back&#160;the&#160;same&#160;extension.&#160;In&#160;the&#160;</p>
<p style="position:absolute;top:1048px;left:137px;white-space:nowrap" class="ft1319">hello&#160;extension,&#160;the&#160;server&#160;also&#160;specifies&#160;the&#160;nonce&#160;needed&#160;for&#160;the&#160;DAA&#160;<br/>signature;&#160;moreover,&#160;if&#160;the&#160;server&#160;wants&#160;the&#160;client&#160;to&#160;use&#160;DAA&#160;authentication&#160;<br/>with&#160;pseudonymous,&#160;it&#160;MUST&#160;also&#160;specify&#160;the&#160;basename&#160;that&#160;the&#160;client&#160;MUST&#160;<br/>use&#160;while&#160;performing&#160;the&#160;DAA&#160;signature.&#160;If&#160;the&#160;client&#160;does&#160;not&#160;accept&#160;to&#160;use&#160;the&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft1321">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft1321">11/27</p>
</div>
<!-- Page 14 -->
<a name="14"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page14-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3014.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft149">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft140">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft1421">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft1421">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft1419">pseudonym,&#160;it&#160;MUST&#160;terminate&#160;the&#160;handshake.&#160;Otherwise&#160;the&#160;latter&#160;continues&#160;<br/>and&#160;the&#160;DAA&#160;authentication&#160;for&#160;client&#160;with&#160;the&#160;related&#160;variant&#160;are&#160;then&#160;agreed&#160;<br/>on.</p>
<p style="position:absolute;top:216px;left:110px;white-space:nowrap" class="ft1417">3.&#160;The&#160;server&#160;MUST&#160;also&#160;request&#160;the&#160;client&#160;authentication&#160;by&#160;sending&#160;the&#160;</p>
<p style="position:absolute;top:235px;left:137px;white-space:nowrap" class="ft1428"><b>CertificateRequest</b></p>
<p style="position:absolute;top:235px;left:316px;white-space:nowrap" class="ft1417">&#160;message.&#160;This&#160;is&#160;needed&#160;to&#160;bind&#160;the&#160;TLS&#160;session&#160;to&#160;the&#160;</p>
<p style="position:absolute;top:254px;left:137px;white-space:nowrap" class="ft1417">DAA&#160;signature.&#160;See&#160;section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#15">&#160;5.3&#160;</a>for&#160;further&#160;details.</p>
<p style="position:absolute;top:282px;left:110px;white-space:nowrap" class="ft1417">4.&#160;The&#160;client&#160;performs&#160;the&#160;DAA&#160;signature&#160;over&#160;a&#160;self-signed&#160;client&#160;certificate&#160;and&#160;</p>
<p style="position:absolute;top:302px;left:137px;white-space:nowrap" class="ft1417">sends&#160;it&#160;to&#160;the&#160;server&#160;using&#160;a&#160;</p>
<p style="position:absolute;top:302px;left:384px;white-space:nowrap" class="ft1428"><b>SupplementalDataEntry</b></p>
<p style="position:absolute;top:302px;left:593px;white-space:nowrap" class="ft1417">&#160;carried&#160;over&#160;the&#160;</p>
<p style="position:absolute;top:321px;left:137px;white-space:nowrap" class="ft1428"><b>SupplementalData</b></p>
<p style="position:absolute;top:321px;left:296px;white-space:nowrap" class="ft1417">&#160;message.&#160;It&#160;also&#160;contains&#160;all&#160;data&#160;necessary&#160;to&#160;verify&#160;the&#160;</p>
<p style="position:absolute;top:340px;left:137px;white-space:nowrap" class="ft1417">DAA&#160;signature.</p>
<p style="position:absolute;top:368px;left:110px;white-space:nowrap" class="ft1425">5.&#160;The&#160;TLS&#160;handshake&#160;protocol&#160;continues&#160;according&#160;to&#160;[3]&#160;until&#160;its&#160;completion.<br/>6.&#160;To&#160;comply&#160;with&#160;[5],&#160;any&#160;action&#160;caused&#160;by&#160;the&#160;evaluation&#160;of&#160;the&#160;data&#160;carried&#160;by&#160;</p>
<p style="position:absolute;top:416px;left:137px;white-space:nowrap" class="ft1428"><b>SupplementalData</b></p>
<p style="position:absolute;top:416px;left:296px;white-space:nowrap" class="ft1417">&#160;MUST&#160;be&#160;performed&#160;after&#160;the&#160;handshake&#160;is&#160;completed.&#160;</p>
<p style="position:absolute;top:435px;left:137px;white-space:nowrap" class="ft1419">Therefore,&#160;before&#160;accepting&#160;any&#160;data&#160;from&#160;the&#160;channel,&#160;the&#160;server&#160;MUST&#160;<br/>conclude&#160;the&#160;verification&#160;of&#160;the&#160;DAA&#160;signature&#160;over&#160;the&#160;client&#160;certificate.&#160;This&#160;<br/>operation&#160;MUST&#160;NOT&#160;happen&#160;during&#160;the&#160;handshake,&#160;but&#160;MUST&#160;take&#160;place&#160;<br/>immediately&#160;after&#160;the&#160;handshake&#160;is&#160;completed.&#160;If&#160;the&#160;verification&#160;fails,&#160;the&#160;<br/>server&#160;MUST&#160;shut&#160;down&#160;the&#160;TLS&#160;channel;&#160;otherwise&#160;the&#160;client&#160;is&#160;successfully&#160;<br/>authenticated&#160;and&#160;the&#160;data&#160;exchange&#160;over&#160;the&#160;secure&#160;channel&#160;can&#160;start.</p>
<p style="position:absolute;top:559px;left:83px;white-space:nowrap" class="ft1419">The&#160;TLS&#160;protocol&#160;extended&#160;to&#160;support&#160;the&#160;DAA&#160;authentication&#160;of&#160;the&#160;client&#160;is&#160;shown&#160;in&#160;<br/><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#14">Figure&#160;3.</a></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft1421">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft1421">12/27</p>
<p style="position:absolute;top:1094px;left:201px;white-space:nowrap" class="ft1429"><i>Figure&#160;3:&#160;TLS&#160;extended&#160;to&#160;support&#160;DAA&#160;authentication&#160;(DAA-TLS)</i></p>
</div>
<!-- Page 15 -->
<a name="15"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page15-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3015.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft159">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft150">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft1521">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft1521">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft1526"><i><b>5.3&#160;&#160;&#160;Binding&#160;between&#160;TLS&#160;channel&#160;and&#160;DAA&#160;authentication</b></i></p>
<p style="position:absolute;top:181px;left:83px;white-space:nowrap" class="ft1525">In&#160;order&#160;to&#160;complete&#160;the&#160;client&#160;authentication,&#160;it&#160;is&#160;required&#160;to&#160;provide&#160;the&#160;binding&#160;<br/>between&#160;TLS&#160;session&#160;and&#160;DAA&#160;authentication.&#160;This&#160;is&#160;done&#160;by&#160;the&#160;client&#160;by&#160;DAA-signing&#160;<br/>a&#160;client&#160;certificate.&#160;For&#160;the&#160;purposes&#160;of&#160;this&#160;specification,&#160;the&#160;client&#160;certificate&#160;must&#160;be&#160;<br/>a&#160;self-signed&#160;X.509v3&#160;certificate,&#160;DER-encoded,&#160;including&#160;all&#160;extensions&#160;required&#160;by&#160;<br/>TLS&#160;specification&#160;[3].&#160;In&#160;subsequent&#160;specifications,&#160;a&#160;format&#160;for&#160;DAA&#160;signature&#160;<br/>algorithm&#160;for&#160;X.509&#160;certificates&#160;may&#160;be&#160;defined&#160;in&#160;order&#160;to&#160;replace&#160;the&#160;self-signed&#160;<br/>client&#160;certificate&#160;with&#160;another&#160;DAA-signed.&#160;This&#160;would&#160;imply,&#160;however,&#160;a&#160;revision&#160;of&#160;the&#160;<br/>DAA-TLS&#160;protocol&#160;as&#160;defined&#160;in&#160;this&#160;document.<br/>The&#160;binding&#160;is&#160;provided&#160;as&#160;follows:</p>
<p style="position:absolute;top:372px;left:110px;white-space:nowrap" class="ft1517">1.&#160;The&#160;client&#160;MUST&#160;create&#160;a&#160;self-signed&#160;certificate&#160;with&#160;no&#160;indication&#160;about&#160;its&#160;</p>
<p style="position:absolute;top:391px;left:137px;white-space:nowrap" class="ft1517">identity&#160;(e.g.&#160;with&#160;a&#160;random&#160;distinguished&#160;name)&#160;for&#160;each&#160;TLS&#160;handshake.</p>
<p style="position:absolute;top:419px;left:110px;white-space:nowrap" class="ft1517">2.&#160;The&#160;TLS&#160;handshake&#160;enhanced&#160;with&#160;hello&#160;extensions&#160;and&#160;supplemental&#160;data&#160;must&#160;</p>
<p style="position:absolute;top:438px;left:137px;white-space:nowrap" class="ft1517">proceed&#160;as&#160;described&#160;in&#160;section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#12">&#160;5.1.</a></p>
<p style="position:absolute;top:466px;left:110px;white-space:nowrap" class="ft1517">3.&#160;The&#160;server&#160;MUST&#160;require&#160;the&#160;client&#160;authentication&#160;during&#160;the&#160;handshake&#160;by&#160;</p>
<p style="position:absolute;top:486px;left:137px;white-space:nowrap" class="ft1517">sending&#160;the&#160;</p>
<p style="position:absolute;top:486px;left:240px;white-space:nowrap" class="ft1528"><b>CertificateRequest</b></p>
<p style="position:absolute;top:486px;left:419px;white-space:nowrap" class="ft1517">&#160;message.&#160;According&#160;to&#160;[3],&#160;the&#160;server&#160;can&#160;</p>
<p style="position:absolute;top:505px;left:137px;white-space:nowrap" class="ft1519">provide&#160;a&#160;list&#160;of&#160;accepted&#160;certification&#160;authorities&#160;(CAs);&#160;in&#160;this&#160;case,&#160;the&#160;client&#160;<br/>MUST&#160;choose&#160;a&#160;certificate&#160;issued&#160;by&#160;one&#160;of&#160;these&#160;CAs.&#160;Because&#160;the&#160;client&#160;self-<br/>generates&#160;a&#160;new&#160;certificate&#160;for&#160;each&#160;TLS&#160;connection,&#160;the&#160;server&#160;MUST&#160;send&#160;the&#160;</p>
<p style="position:absolute;top:562px;left:137px;white-space:nowrap" class="ft1528"><b>CertificateRequest</b></p>
<p style="position:absolute;top:562px;left:316px;white-space:nowrap" class="ft1517">&#160;message&#160;with&#160;the&#160;field&#160;</p>
<p style="position:absolute;top:562px;left:515px;white-space:nowrap" class="ft1528"><b>certificate_authorities</b></p>
<p style="position:absolute;top:562px;left:743px;white-space:nowrap" class="ft1517">&#160;empty;&#160;</p>
<p style="position:absolute;top:582px;left:137px;white-space:nowrap" class="ft1517">therefore,&#160;according&#160;to&#160;[3],&#160;the&#160;client&#160;MAY&#160;send&#160;any&#160;certificate.</p>
<p style="position:absolute;top:610px;left:110px;white-space:nowrap" class="ft1517">4.&#160;The&#160;client&#160;must&#160;DAA-sign&#160;the&#160;certificate&#160;used&#160;for&#160;TLS&#160;client&#160;authentication.&#160;This&#160;</p>
<p style="position:absolute;top:629px;left:137px;white-space:nowrap" class="ft1519">provides&#160;the&#160;binding&#160;between&#160;the&#160;TLS&#160;session&#160;and&#160;the&#160;DAA&#160;authentication&#160;and&#160;<br/>complete&#160;the&#160;client&#160;group&#160;authentication.&#160;The&#160;DAA&#160;signature&#160;MUST&#160;be&#160;sent&#160;to&#160;<br/>the&#160;server&#160;through&#160;the&#160;</p>
<p style="position:absolute;top:667px;left:330px;white-space:nowrap" class="ft1528"><b>SupplementalData</b></p>
<p style="position:absolute;top:667px;left:489px;white-space:nowrap" class="ft1517">&#160;message&#160;while&#160;the&#160;self-signed&#160;client&#160;</p>
<p style="position:absolute;top:687px;left:137px;white-space:nowrap" class="ft1517">certificate&#160;MUST&#160;be&#160;sent&#160;to&#160;the&#160;server&#160;through&#160;the&#160;</p>
<p style="position:absolute;top:687px;left:559px;white-space:nowrap" class="ft1528"><b>Certificate</b></p>
<p style="position:absolute;top:687px;left:669px;white-space:nowrap" class="ft1517">&#160;message.</p>
<p style="position:absolute;top:715px;left:83px;white-space:nowrap" class="ft1519">The&#160;DAA&#160;protocol&#160;MAY&#160;also&#160;be&#160;used&#160;to&#160;sign&#160;other&#160;data,&#160;in&#160;addition&#160;to&#160;the&#160;self-signed&#160;<br/>client&#160;certificate&#160;used&#160;for&#160;the&#160;TLS&#160;authentication.&#160;This&#160;data,&#160;if&#160;present,&#160;depends&#160;on&#160;the&#160;<br/>context&#160;of&#160;the&#160;application.&#160;The&#160;input&#160;of&#160;the&#160;DAA-signing&#160;function&#160;must&#160;be</p>
<p style="position:absolute;top:790px;left:105px;white-space:nowrap" class="ft1528"><b>SHA1&#160;(TLS_Client_Certificate&#160;||&#160;AdditionalData)</b></p>
<p style="position:absolute;top:827px;left:83px;white-space:nowrap" class="ft1517">where&#160;</p>
<p style="position:absolute;top:827px;left:140px;white-space:nowrap" class="ft1528"><b>SHA1</b></p>
<p style="position:absolute;top:827px;left:180px;white-space:nowrap" class="ft1517">&#160;is&#160;the&#160;digest&#160;calculation&#160;using&#160;SHA-1&#160;[10]&#160;algorithm,&#160;</p>
<p style="position:absolute;top:847px;left:83px;white-space:nowrap" class="ft1528"><b>TLS_Client_Certificate</b></p>
<p style="position:absolute;top:847px;left:302px;white-space:nowrap" class="ft1517">&#160;is&#160;the&#160;self-signed&#160;certificate&#160;used&#160;for&#160;the&#160;TLS&#160;authentication&#160;</p>
<p style="position:absolute;top:866px;left:83px;white-space:nowrap" class="ft1517">and&#160;DER-encoded,&#160;</p>
<p style="position:absolute;top:866px;left:242px;white-space:nowrap" class="ft1528"><b>||</b></p>
<p style="position:absolute;top:866px;left:262px;white-space:nowrap" class="ft1517">&#160;is&#160;the&#160;concatenation&#160;operator&#160;and&#160;</p>
<p style="position:absolute;top:866px;left:553px;white-space:nowrap" class="ft1528"><b>AdditionalData</b></p>
<p style="position:absolute;top:866px;left:692px;white-space:nowrap" class="ft1517">&#160;represents&#160;</p>
<p style="position:absolute;top:885px;left:83px;white-space:nowrap" class="ft1525">any&#160;additional&#160;data&#160;the&#160;application&#160;wants&#160;to&#160;DAA-sign.<br/>An&#160;example&#160;of&#160;possible&#160;</p>
<p style="position:absolute;top:913px;left:281px;white-space:nowrap" class="ft1528"><b>AdditionalData</b></p>
<p style="position:absolute;top:913px;left:420px;white-space:nowrap" class="ft1517">&#160;to&#160;DAA-sign&#160;is&#160;an&#160;Attestation&#160;Identity&#160;Key&#160;</p>
<p style="position:absolute;top:932px;left:83px;white-space:nowrap" class="ft1519">(AIK)&#160;which&#160;can&#160;be&#160;used&#160;for&#160;a&#160;remote&#160;attestation&#160;of&#160;the&#160;configuration&#160;of&#160;the&#160;platform;&#160;<br/>in&#160;this&#160;case&#160;the&#160;AIK&#160;must&#160;be&#160;signed&#160;by&#160;the&#160;DAA&#160;to&#160;convince&#160;the&#160;verifier&#160;that&#160;the&#160;AIK&#160;<br/>was&#160;generated&#160;and&#160;is&#160;used&#160;by&#160;a&#160;genuine&#160;TPM.&#160;This&#160;document&#160;neither&#160;defines&#160;the&#160;<br/>encoding&#160;of&#160;</p>
<p style="position:absolute;top:990px;left:186px;white-space:nowrap" class="ft1528"><b>AdditionalData</b></p>
<p style="position:absolute;top:990px;left:325px;white-space:nowrap" class="ft1517">&#160;nor&#160;how&#160;it&#160;is&#160;created,&#160;but&#160;this&#160;might&#160;be&#160;specified&#160;in&#160;future&#160;</p>
<p style="position:absolute;top:1009px;left:83px;white-space:nowrap" class="ft1525">documents.<br/>If&#160;no&#160;additional&#160;data&#160;is&#160;present,&#160;the&#160;input&#160;of&#160;the&#160;DAA-signing&#160;function&#160;must&#160;be:</p>
<p style="position:absolute;top:1075px;left:105px;white-space:nowrap" class="ft1528"><b>SHA1&#160;(TLS_Client_Certificate)</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft1521">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft1521">13/27</p>
</div>
<!-- Page 16 -->
<a name="16"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page16-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3016.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft169">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft160">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft1621">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft1621">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft1619">Any&#160;additional&#160;data&#160;DAA-signed&#160;MUST&#160;be&#160;transported&#160;within&#160;the&#160;supplemental&#160;data&#160;<br/>message&#160;so&#160;that&#160;it&#160;is&#160;possible&#160;for&#160;the&#160;verifier&#160;to&#160;recompute&#160;the&#160;signed&#160;digest.</p>
<p style="position:absolute;top:214px;left:83px;white-space:nowrap" class="ft1626"><i><b>5.4&#160;&#160;&#160;Verification&#160;of&#160;the&#160;authentication</b></i></p>
<p style="position:absolute;top:246px;left:83px;white-space:nowrap" class="ft1619">The&#160;server&#160;MUST&#160;verify&#160;the&#160;authentication&#160;of&#160;the&#160;client.&#160;This&#160;is&#160;done&#160;by&#160;combining&#160;the&#160;<br/>different&#160;data&#160;exchanged&#160;during&#160;the&#160;handshake.&#160;<br/>First,&#160;the&#160;server&#160;needs&#160;to&#160;check&#160;the&#160;correctness&#160;of&#160;the&#160;DAA&#160;signature.&#160;Besides,&#160;once&#160;<br/>the&#160;DAA&#160;signature&#160;is&#160;verified,&#160;it&#160;is&#160;necessary&#160;to&#160;verify&#160;the&#160;binding&#160;between&#160;the&#160;TLS&#160;<br/>session&#160;and&#160;the&#160;DAA&#160;authentication.&#160;In&#160;order&#160;to&#160;do&#160;this,&#160;the&#160;server&#160;MUST&#160;verify&#160;that&#160;the&#160;<br/>digest&#160;signed&#160;by&#160;the&#160;client&#160;corresponds&#160;to&#160;the&#160;digest&#160;calculated&#160;over&#160;the&#160;data&#160;<br/>exchanged&#160;during&#160;the&#160;TLS&#160;handshake.&#160;This&#160;is&#160;done&#160;by&#160;repeating&#160;on&#160;the&#160;server&#160;side&#160;the&#160;<br/>operations&#160;previously&#160;done&#160;on&#160;the&#160;client&#160;side:&#160;concatenating&#160;the&#160;self-signed&#160;certificate&#160;<br/>received&#160;from&#160;the&#160;client&#160;through&#160;the&#160;</p>
<p style="position:absolute;top:409px;left:390px;white-space:nowrap" class="ft1628"><b>Certificate</b></p>
<p style="position:absolute;top:409px;left:499px;white-space:nowrap" class="ft1617">&#160;message&#160;with&#160;the&#160;additional&#160;data,&#160;if&#160;</p>
<p style="position:absolute;top:428px;left:83px;white-space:nowrap" class="ft1617">present,&#160;received&#160;from&#160;the&#160;client&#160;through&#160;the&#160;</p>
<p style="position:absolute;top:428px;left:463px;white-space:nowrap" class="ft1628"><b>SupplementalData</b></p>
<p style="position:absolute;top:428px;left:622px;white-space:nowrap" class="ft1617">&#160;message&#160;and&#160;</p>
<p style="position:absolute;top:447px;left:83px;white-space:nowrap" class="ft1625">computing&#160;the&#160;digest&#160;over&#160;these&#160;composed&#160;data.<br/>Since&#160;the&#160;</p>
<p style="position:absolute;top:475px;left:166px;white-space:nowrap" class="ft1628"><b>SupplementalData</b></p>
<p style="position:absolute;top:475px;left:325px;white-space:nowrap" class="ft1617">&#160;message&#160;is&#160;sent&#160;from&#160;client&#160;to&#160;server&#160;before&#160;the&#160;</p>
<p style="position:absolute;top:495px;left:83px;white-space:nowrap" class="ft1628"><b>Certificate&#160;</b></p>
<p style="position:absolute;top:495px;left:203px;white-space:nowrap" class="ft1617">message,&#160;the&#160;described&#160;verification&#160;can&#160;be&#160;done&#160;only&#160;after&#160;receiving&#160;the&#160;</p>
<p style="position:absolute;top:514px;left:83px;white-space:nowrap" class="ft1619">latter&#160;message.&#160;Moreover,&#160;according&#160;to&#160;[5],&#160;for&#160;security&#160;reasons&#160;the&#160;data&#160;exchanged&#160;as&#160;<br/>supplemental&#160;data&#160;MUST&#160;NOT&#160;have&#160;any&#160;effect&#160;on&#160;the&#160;handshake&#160;and&#160;MUST&#160;be&#160;<br/>evaluated&#160;only&#160;after&#160;its&#160;completion.&#160;Therefore&#160;the&#160;complete&#160;verification&#160;of&#160;the&#160;<br/>authentication&#160;MUST&#160;be&#160;performed&#160;only&#160;after&#160;the&#160;handshake&#160;is&#160;completed&#160;and&#160;the&#160;<br/>server&#160;MUST&#160;NOT&#160;accept&#160;any&#160;data&#160;from&#160;the&#160;TLS&#160;channel&#160;before&#160;the&#160;verification&#160;is&#160;<br/>finished&#160;and&#160;successful.&#160;If&#160;the&#160;verification&#160;fails&#160;the&#160;server&#160;MUST&#160;shut&#160;down&#160;the&#160;TLS&#160;<br/>channel.</p>
<p style="position:absolute;top:675px;left:83px;white-space:nowrap" class="ft1626"><i><b>5.5&#160;&#160;&#160;Definition&#160;of&#160;the&#160;hello&#160;extension&#160;DAAAuthExt</b></i></p>
<p style="position:absolute;top:707px;left:83px;white-space:nowrap" class="ft1617">This&#160;document&#160;specifies&#160;the&#160;</p>
<p style="position:absolute;top:707px;left:321px;white-space:nowrap" class="ft1628"><b>DAAAuthExt</b></p>
<p style="position:absolute;top:707px;left:420px;white-space:nowrap" class="ft1617">&#160;hello&#160;extension&#160;according&#160;to&#160;[4].&#160;This&#160;</p>
<p style="position:absolute;top:726px;left:83px;white-space:nowrap" class="ft1625">extension&#160;indicates&#160;the&#160;intention&#160;to&#160;use&#160;the&#160;DAA&#160;authentication&#160;of&#160;the&#160;TLS&#160;client.&#160;When&#160;<br/>sent&#160;by&#160;the&#160;latter,&#160;it&#160;means&#160;that&#160;the&#160;client&#160;supports&#160;the&#160;DAA&#160;authentication&#160;and&#160;wants&#160;<br/>to&#160;use&#160;it&#160;for&#160;authenticating&#160;itself;&#160;when&#160;it&#160;is&#160;sent&#160;by&#160;the&#160;server&#160;(only&#160;as&#160;response&#160;to&#160;the&#160;<br/>client),&#160;it&#160;means&#160;that&#160;the&#160;server&#160;agrees&#160;on&#160;using&#160;DAA&#160;authentication&#160;for&#160;the&#160;client.&#160;<br/>This&#160;extension&#160;is&#160;defined&#160;as:</p>
<p style="position:absolute;top:849px;left:105px;white-space:nowrap" class="ft1630"><b>enum&#160;{<br/>&#160;&#160;&#160;DAAAuthExt&#160;(XX)<br/>}&#160;ExtensionType;</b></p>
<p style="position:absolute;top:933px;left:105px;white-space:nowrap" class="ft1628"><b>struct&#160;{</b></p>
<p style="position:absolute;top:952px;left:158px;white-space:nowrap" class="ft1630"><b>ExtensionType&#160;extension_type;<br/>opaque&#160;extension_data&lt;0..2^16-1&gt;;</b></p>
<p style="position:absolute;top:991px;left:105px;white-space:nowrap" class="ft1628"><b>}&#160;Extension;</b></p>
<p style="position:absolute;top:1028px;left:83px;white-space:nowrap" class="ft1617">where&#160;the&#160;type&#160;(</p>
<p style="position:absolute;top:1028px;left:221px;white-space:nowrap" class="ft1628"><b>XX</b></p>
<p style="position:absolute;top:1028px;left:240px;white-space:nowrap" class="ft1617">)&#160;of&#160;the&#160;extension&#160;must&#160;be&#160;assigned&#160;by&#160;the&#160;IANA&#160;through&#160;the&#160;IETF&#160;</p>
<p style="position:absolute;top:1047px;left:83px;white-space:nowrap" class="ft1617">Consensus&#160;process&#160;(see&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#27">&#160;8&#160;</a>for&#160;details).&#160;The&#160;</p>
<p style="position:absolute;top:1047px;left:506px;white-space:nowrap" class="ft1628"><b>extension_data</b></p>
<p style="position:absolute;top:1047px;left:645px;white-space:nowrap" class="ft1617">&#160;is&#160;defined&#160;as:</p>
<p style="position:absolute;top:1084px;left:105px;white-space:nowrap" class="ft1630"><b>struct&#160;{<br/>&#160;&#160;&#160;uint8</b></p>
<p style="position:absolute;top:1103px;left:371px;white-space:nowrap" class="ft1628"><b>daa_tls_version;</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft1621">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft1621">14/27</p>
</div>
<!-- Page 17 -->
<a name="17"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page17-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3017.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft179">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft170">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft1721">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft1721">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:149px;left:105px;white-space:nowrap" class="ft1728"><b>&#160;&#160;&#160;DAAAuthParam</b></p>
<p style="position:absolute;top:149px;left:371px;white-space:nowrap" class="ft1728"><b>daa_auth_param&#160;&lt;0..2^7-1&gt;;</b></p>
<p style="position:absolute;top:168px;left:105px;white-space:nowrap" class="ft1728"><b>}&#160;DAAAuthExt;</b></p>
<p style="position:absolute;top:214px;left:105px;white-space:nowrap" class="ft1730"><b>struct&#160;{<br/>&#160;&#160;&#160;uint8</b></p>
<p style="position:absolute;top:234px;left:211px;white-space:nowrap" class="ft1728"><b>daa_auth_param_type;</b></p>
<p style="position:absolute;top:253px;left:105px;white-space:nowrap" class="ft1730"><b>&#160;&#160;&#160;opaque&#160;daa_auth_param_data&#160;&lt;0..2^8-1&gt;;<br/>}&#160;DAAAuthParam;</b></p>
<p style="position:absolute;top:309px;left:83px;white-space:nowrap" class="ft1717">where&#160;</p>
<p style="position:absolute;top:309px;left:140px;white-space:nowrap" class="ft1728"><b>daa_tls_version</b></p>
<p style="position:absolute;top:309px;left:289px;white-space:nowrap" class="ft1717">&#160;specifies&#160;the&#160;version&#160;of&#160;the&#160;DAA-enhancement&#160;of&#160;TLS&#160;and&#160;</p>
<p style="position:absolute;top:328px;left:83px;white-space:nowrap" class="ft1717">indicates&#160;the&#160;set&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:328px;left:280px;white-space:nowrap" class="ft1728"><b>DAAAuthParam</b></p>
<p style="position:absolute;top:328px;left:399px;white-space:nowrap" class="ft1717">&#160;to&#160;exchange&#160;and&#160;in&#160;which&#160;sequence&#160;as&#160;well&#160;as&#160;</p>
<p style="position:absolute;top:347px;left:83px;white-space:nowrap" class="ft1717">the&#160;</p>
<p style="position:absolute;top:347px;left:116px;white-space:nowrap" class="ft1728"><b>DAAAuthSupplDataEntry</b></p>
<p style="position:absolute;top:347px;left:324px;white-space:nowrap" class="ft1717">&#160;within&#160;the&#160;</p>
<p style="position:absolute;top:347px;left:417px;white-space:nowrap" class="ft1728"><b>SupplementalDataEntry</b></p>
<p style="position:absolute;top:347px;left:626px;white-space:nowrap" class="ft1717">.&#160;A&#160;DAA-enhancement&#160;</p>
<p style="position:absolute;top:367px;left:83px;white-space:nowrap" class="ft1717">conforming&#160;to&#160;this&#160;specification&#160;is&#160;identified&#160;by&#160;the&#160;value&#160;1.&#160;Each&#160;parameter&#160;</p>
<p style="position:absolute;top:386px;left:83px;white-space:nowrap" class="ft1728"><b>DAAAuthParam&#160;</b></p>
<p style="position:absolute;top:386px;left:213px;white-space:nowrap" class="ft1717">is&#160;defined&#160;by&#160;a&#160;type&#160;</p>
<p style="position:absolute;top:386px;left:381px;white-space:nowrap" class="ft1716"><b>daa_auth_param_type</b></p>
<p style="position:absolute;top:386px;left:584px;white-space:nowrap" class="ft1717">&#160;and&#160;a&#160;payload&#160;</p>
<p style="position:absolute;top:405px;left:83px;white-space:nowrap" class="ft1716"><b>daa_auth_param_data</b></p>
<p style="position:absolute;top:405px;left:286px;white-space:nowrap" class="ft1717">&#160;and&#160;must&#160;appear&#160;at&#160;most&#160;once&#160;in&#160;the&#160;list:</p>
<p style="position:absolute;top:442px;left:105px;white-space:nowrap" class="ft1730"><b>enum&#160;{<br/>&#160;&#160;&#160;daa_error&#160;(0),<br/>&#160;&#160;&#160;daa_binding_version&#160;(1),<br/>&#160;&#160;&#160;daa_nonce&#160;(2),<br/>&#160;&#160;&#160;daa_basename&#160;(3),<br/>&#160;&#160;&#160;(255)<br/>}&#160;daa_auth_param_type;</b></p>
<p style="position:absolute;top:603px;left:105px;white-space:nowrap" class="ft1730"><b>struct&#160;{<br/>&#160;&#160;&#160;uint8</b></p>
<p style="position:absolute;top:622px;left:211px;white-space:nowrap" class="ft1728"><b>daa_auth_param_type;</b></p>
<p style="position:absolute;top:642px;left:105px;white-space:nowrap" class="ft1730"><b>&#160;&#160;&#160;select&#160;(daa_auth_param_type)&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;case&#160;daa_error:&#160;</b></p>
<p style="position:absolute;top:661px;left:424px;white-space:nowrap" class="ft1728"><b>DAAError;</b></p>
<p style="position:absolute;top:680px;left:105px;white-space:nowrap" class="ft1730"><b>&#160;&#160;&#160;&#160;&#160;&#160;case&#160;daa_binding_version:&#160;DAABindingVersion;<br/>&#160;&#160;&#160;&#160;&#160;&#160;case&#160;daa_nonce:&#160;</b></p>
<p style="position:absolute;top:699px;left:424px;white-space:nowrap" class="ft1728"><b>DAANonce;</b></p>
<p style="position:absolute;top:718px;left:105px;white-space:nowrap" class="ft1728"><b>&#160;&#160;&#160;&#160;&#160;&#160;case&#160;daa_basename:&#160;</b></p>
<p style="position:absolute;top:718px;left:424px;white-space:nowrap" class="ft1728"><b>DAABasename;</b></p>
<p style="position:absolute;top:738px;left:105px;white-space:nowrap" class="ft1730"><b>&#160;&#160;&#160;}<br/>}&#160;DAAAuthParam;</b></p>
<p style="position:absolute;top:803px;left:105px;white-space:nowrap" class="ft1730"><b>struct&#160;{<br/>&#160;&#160;&#160;uint8&#160;daa_error_code;<br/>}&#160;DAAError;</b></p>
<p style="position:absolute;top:887px;left:105px;white-space:nowrap" class="ft1730"><b>struct&#160;{<br/>&#160;&#160;&#160;uint8&#160;daa_binding_version;<br/>}&#160;DAABindingVersion;</b></p>
<p style="position:absolute;top:972px;left:105px;white-space:nowrap" class="ft1730"><b>struct&#160;{<br/>&#160;&#160;&#160;uint8&#160;daa_nonce_length;<br/>&#160;&#160;&#160;opaque&#160;daa_nonce&#160;&lt;0..2^8-1&gt;;<br/>}&#160;DAANonce;</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft1721">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft1721">15/27</p>
</div>
<!-- Page 18 -->
<a name="18"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page18-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3018.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft189">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft180">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft1821">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft1821">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:149px;left:105px;white-space:nowrap" class="ft1830"><b>struct&#160;{<br/>&#160;&#160;&#160;uint8&#160;daa_basename_length;<br/>&#160;&#160;&#160;opaque&#160;daa_basename&#160;&lt;0..2^8-1&gt;;<br/>}&#160;DAABasename;</b></p>
<p style="position:absolute;top:244px;left:83px;white-space:nowrap" class="ft1817">The&#160;semantic&#160;of&#160;the&#160;different&#160;parameters&#160;which&#160;can&#160;be&#160;carried&#160;by&#160;</p>
<p style="position:absolute;top:263px;left:83px;white-space:nowrap" class="ft1828"><b>daa_auth_param_data</b></p>
<p style="position:absolute;top:263px;left:272px;white-space:nowrap" class="ft1817">&#160;is&#160;defined&#160;as&#160;follows:</p>
<p style="position:absolute;top:296px;left:110px;white-space:nowrap" class="ft1812">●</p>
<p style="position:absolute;top:291px;left:137px;white-space:nowrap" class="ft1828"><b>DAAError</b></p>
<p style="position:absolute;top:291px;left:217px;white-space:nowrap" class="ft1817">&#160;indicates&#160;an&#160;error&#160;related&#160;to&#160;the&#160;DAA&#160;extension&#160;occurred&#160;on&#160;the&#160;peer.&#160;</p>
<p style="position:absolute;top:310px;left:137px;white-space:nowrap" class="ft1817">This&#160;specification&#160;defines&#160;the&#160;following&#160;error&#160;codes:</p>
<p style="position:absolute;top:348px;left:137px;white-space:nowrap" class="ft1830"><b>enum&#160;{<br/>&#160;&#160;&#160;daa_error_disabled&#160;(1),<br/>&#160;&#160;&#160;daa_error_binding_version_not_supported&#160;(2),<br/>&#160;&#160;&#160;(255)<br/>}&#160;error_code;</b></p>
<p style="position:absolute;top:461px;left:137px;white-space:nowrap" class="ft1817">with&#160;the&#160;following&#160;semantic:</p>
<p style="position:absolute;top:490px;left:163px;white-space:nowrap" class="ft1817">1.</p>
<p style="position:absolute;top:490px;left:179px;white-space:nowrap" class="ft1816"><b>daa_error_disabled&#160;</b></p>
<p style="position:absolute;top:490px;left:361px;white-space:nowrap" class="ft1817">means&#160;the&#160;server&#160;does&#160;not&#160;accept&#160;the&#160;DAA&#160;extension&#160;</p>
<p style="position:absolute;top:509px;left:190px;white-space:nowrap" class="ft1819">for&#160;the&#160;current&#160;session&#160;(note&#160;that&#160;the&#160;server&#160;ignores&#160;the&#160;received&#160;DAA&#160;<br/>extension&#160;if&#160;it&#160;does&#160;not&#160;support&#160;it&#160;at&#160;all,&#160;but&#160;SHOULD&#160;reply&#160;with&#160;the&#160;DAA&#160;<br/>extension&#160;if&#160;it&#160;supports&#160;it,&#160;but&#160;for&#160;any&#160;reason&#160;does&#160;not&#160;want&#160;to&#160;accept&#160;it).</p>
<p style="position:absolute;top:575px;left:163px;white-space:nowrap" class="ft1817">2.</p>
<p style="position:absolute;top:575px;left:179px;white-space:nowrap" class="ft1816"><b>daa_error_binding_version_not_supported&#160;</b></p>
<p style="position:absolute;top:575px;left:572px;white-space:nowrap" class="ft1817">means&#160;the&#160;server&#160;does&#160;not&#160;</p>
<p style="position:absolute;top:595px;left:190px;white-space:nowrap" class="ft1817">support&#160;the&#160;binding&#160;version&#160;requested&#160;by&#160;the&#160;client.</p>
<p style="position:absolute;top:627px;left:110px;white-space:nowrap" class="ft1812">●</p>
<p style="position:absolute;top:623px;left:137px;white-space:nowrap" class="ft1828"><b>DAABindingVersion</b></p>
<p style="position:absolute;top:623px;left:306px;white-space:nowrap" class="ft1817">&#160;indicates&#160;a&#160;specific&#160;binding&#160;(i.e.&#160;profile)&#160;for&#160;which&#160;includes&#160;a&#160;</p>
<p style="position:absolute;top:642px;left:137px;white-space:nowrap" class="ft1819">standardized&#160;specification&#160;of&#160;DAA&#160;(like&#160;the&#160;one&#160;proposed&#160;by&#160;the&#160;TCG)&#160;and&#160;the&#160;<br/>specific&#160;relations&#160;with&#160;the&#160;DAA&#160;enhancement,&#160;including&#160;the&#160;data&#160;encoding&#160;and&#160;<br/>optionally&#160;software&#160;interfaces&#160;to&#160;be&#160;used.</p>
<p style="position:absolute;top:713px;left:110px;white-space:nowrap" class="ft1812">●</p>
<p style="position:absolute;top:709px;left:137px;white-space:nowrap" class="ft1828"><b>DAANonce</b></p>
<p style="position:absolute;top:709px;left:217px;white-space:nowrap" class="ft1817">&#160;is&#160;a&#160;DAA's&#160;own&#160;parameter,&#160;the&#160;nonce&#160;that&#160;the&#160;client&#160;must&#160;use&#160;during&#160;</p>
<p style="position:absolute;top:728px;left:137px;white-space:nowrap" class="ft1819">the&#160;DAA&#160;signature.&#160;This&#160;parameter&#160;must&#160;be&#160;always&#160;sent&#160;by&#160;the&#160;server&#160;(i.e.&#160;the&#160;<br/>DAA&#160;verifier).</p>
<p style="position:absolute;top:780px;left:110px;white-space:nowrap" class="ft1812">●</p>
<p style="position:absolute;top:775px;left:137px;white-space:nowrap" class="ft1828"><b>DAABasename</b></p>
<p style="position:absolute;top:775px;left:247px;white-space:nowrap" class="ft1817">&#160;is&#160;a&#160;DAA's&#160;own&#160;parameter,&#160;the&#160;basename&#160;that&#160;must&#160;be&#160;used&#160;</p>
<p style="position:absolute;top:794px;left:137px;white-space:nowrap" class="ft1819">during&#160;the&#160;DAA&#160;signature.&#160;If&#160;the&#160;server&#160;wants&#160;the&#160;client&#160;to&#160;have&#160;a&#160;<br/>pseudonymous,&#160;then&#160;this&#160;parameter&#160;must&#160;be&#160;present&#160;in&#160;the&#160;</p>
<p style="position:absolute;top:814px;left:638px;white-space:nowrap" class="ft1828"><b>DAAAuthExt</b></p>
<p style="position:absolute;top:814px;left:737px;white-space:nowrap" class="ft1817">&#160;server&#160;</p>
<p style="position:absolute;top:833px;left:137px;white-space:nowrap" class="ft1819">hello&#160;extension.&#160;If&#160;the&#160;server&#160;wants&#160;the&#160;client&#160;to&#160;be&#160;completely&#160;anonymous,&#160;then&#160;<br/>the&#160;server&#160;must&#160;not&#160;send&#160;the&#160;basename&#160;in&#160;its&#160;</p>
<p style="position:absolute;top:852px;left:520px;white-space:nowrap" class="ft1828"><b>DAAAuthExt</b></p>
<p style="position:absolute;top:852px;left:620px;white-space:nowrap" class="ft1817">&#160;hello&#160;extension:&#160;at&#160;</p>
<p style="position:absolute;top:871px;left:137px;white-space:nowrap" class="ft1819">the&#160;signature&#160;time&#160;the&#160;client&#160;must&#160;then&#160;use&#160;a&#160;randomly&#160;generated&#160;basename;&#160;<br/>the&#160;client&#160;must&#160;not&#160;ever&#160;send&#160;the&#160;basename&#160;in&#160;its&#160;</p>
<p style="position:absolute;top:890px;left:555px;white-space:nowrap" class="ft1828"><b>DAAAuthExt</b></p>
<p style="position:absolute;top:890px;left:655px;white-space:nowrap" class="ft1817">&#160;hello&#160;extension.</p>
<p style="position:absolute;top:937px;left:83px;white-space:nowrap" class="ft1826"><i><b>5.6&#160;&#160;&#160;Definition&#160;of&#160;the&#160;supplemental&#160;data&#160;entry&#160;</b></i></p>
<p style="position:absolute;top:959px;left:83px;white-space:nowrap" class="ft1826"><i><b>DAAAuthSupplDataEntry</b></i></p>
<p style="position:absolute;top:991px;left:83px;white-space:nowrap" class="ft1817">This&#160;document&#160;specifies&#160;the&#160;</p>
<p style="position:absolute;top:991px;left:321px;white-space:nowrap" class="ft1828"><b>DAAAuthSupplDataEntry</b></p>
<p style="position:absolute;top:991px;left:529px;white-space:nowrap" class="ft1817">&#160;supplemental&#160;data&#160;entry,&#160;</p>
<p style="position:absolute;top:1010px;left:83px;white-space:nowrap" class="ft1825">exchanged&#160;within&#160;the&#160;supplemental&#160;data&#160;message,&#160;according&#160;to&#160;[5].<br/>The&#160;supplemental&#160;data&#160;entry&#160;must&#160;transport&#160;all&#160;data&#160;needed&#160;by&#160;the&#160;server&#160;to&#160;verify&#160;the&#160;<br/>DAA&#160;signature&#160;performed&#160;by&#160;the&#160;client;&#160;therefore,&#160;if&#160;negotiated,&#160;it&#160;must&#160;only&#160;be&#160;sent&#160;by&#160;<br/>client&#160;to&#160;server&#160;and&#160;never&#160;in&#160;the&#160;opposite&#160;direction.<br/>The&#160;structure&#160;of&#160;the&#160;supplemental&#160;data&#160;entry&#160;for&#160;DAA&#160;authentication&#160;is&#160;defined&#160;as:</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft1821">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft1821">16/27</p>
</div>
<!-- Page 19 -->
<a name="19"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page19-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3019.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft199">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft190">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft1921">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft1921">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:149px;left:105px;white-space:nowrap" class="ft1930"><b>enum&#160;{<br/>&#160;&#160;&#160;DAA_auth_suppl_data_entry&#160;(XX)<br/>}&#160;&#160;SupplementalDataType;</b></p>
<p style="position:absolute;top:234px;left:105px;white-space:nowrap" class="ft1930"><b>struct&#160;{&#160;<br/>&#160;&#160;&#160;SupplementalDataType&#160;supp_data_type;<br/>&#160;&#160;&#160;uint16&#160;supp_data_length;<br/>&#160;&#160;&#160;select(SupplementalDataType)&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;case&#160;&#160;DAA_auth_suppl_data_entry:&#160;DAAAuthSupplDataEntry;<br/>&#160;&#160;&#160;}<br/>}&#160;SupplementalDataEntry;</b></p>
<p style="position:absolute;top:386px;left:83px;white-space:nowrap" class="ft1917">where&#160;the&#160;type&#160;(</p>
<p style="position:absolute;top:386px;left:221px;white-space:nowrap" class="ft1928"><b>XX</b></p>
<p style="position:absolute;top:386px;left:240px;white-space:nowrap" class="ft1917">)&#160;of&#160;the&#160;supplemental&#160;data&#160;entry&#160;must&#160;be&#160;assigned&#160;according&#160;to&#160;[5]&#160;</p>
<p style="position:absolute;top:405px;left:83px;white-space:nowrap" class="ft1917">(see&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#27">&#160;8&#160;</a>for&#160;details).&#160;The&#160;payload&#160;of&#160;the&#160;supplemental&#160;data&#160;entry,&#160;</p>
<p style="position:absolute;top:424px;left:83px;white-space:nowrap" class="ft1928"><b>DAAAuthSupplDataEntry</b></p>
<p style="position:absolute;top:424px;left:292px;white-space:nowrap" class="ft1917">,&#160;is&#160;defined&#160;as:</p>
<p style="position:absolute;top:461px;left:105px;white-space:nowrap" class="ft1930"><b>struct&#160;{<br/>&#160;&#160;&#160;DAAAuthSupplDataEntryType</b></p>
<p style="position:absolute;top:481px;left:424px;white-space:nowrap" class="ft1928"><b>daa_suppl_data_entry_type;</b></p>
<p style="position:absolute;top:500px;left:105px;white-space:nowrap" class="ft1928"><b>&#160;&#160;&#160;uint16</b></p>
<p style="position:absolute;top:500px;left:424px;white-space:nowrap" class="ft1928"><b>daa_suppl_data_entry_length;</b></p>
<p style="position:absolute;top:519px;left:105px;white-space:nowrap" class="ft1930"><b>&#160;&#160;&#160;select(DAAAuthSupplDataEntryType)&#160;{&#160;}<br/>}&#160;DAAAuthSupplDataEntry;</b></p>
<p style="position:absolute;top:575px;left:83px;white-space:nowrap" class="ft1917">where&#160;</p>
<p style="position:absolute;top:575px;left:140px;white-space:nowrap" class="ft1916"><b>daa_suppl_data_entry_length&#160;</b></p>
<p style="position:absolute;top:575px;left:415px;white-space:nowrap" class="ft1917">indicates&#160;the&#160;length&#160;of&#160;the&#160;data&#160;and&#160;</p>
<p style="position:absolute;top:594px;left:83px;white-space:nowrap" class="ft1928"><b>daa_suppl_data_entry_type</b></p>
<p style="position:absolute;top:594px;left:332px;white-space:nowrap" class="ft1917">&#160;indicates&#160;the&#160;type&#160;of&#160;the&#160;data&#160;and&#160;is&#160;defined&#160;as:</p>
<p style="position:absolute;top:631px;left:105px;white-space:nowrap" class="ft1930"><b>enum&#160;{<br/>&#160;&#160;&#160;daa_signature&#160;(0),<br/>&#160;&#160;&#160;daa_additional_signed_data&#160;(1),<br/>&#160;&#160;&#160;(255)<br/>}&#160;DAAAuthSupplDataEntryType;</b></p>
<p style="position:absolute;top:754px;left:105px;white-space:nowrap" class="ft1930"><b>struct&#160;{<br/>&#160;&#160;&#160;DAAAuthSupplDataEntryType</b></p>
<p style="position:absolute;top:774px;left:424px;white-space:nowrap" class="ft1928"><b>daa_suppl_data_entry_type;</b></p>
<p style="position:absolute;top:793px;left:105px;white-space:nowrap" class="ft1928"><b>&#160;&#160;&#160;uint16</b></p>
<p style="position:absolute;top:793px;left:424px;white-space:nowrap" class="ft1928"><b>daa_suppl_data_entry_length;</b></p>
<p style="position:absolute;top:812px;left:105px;white-space:nowrap" class="ft1930"><b>&#160;&#160;&#160;select(DAAAuthSupplDataEntryType)&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;case&#160;&#160;daa_signature:&#160;DAASignature;<br/>&#160;&#160;&#160;&#160;&#160;&#160;case&#160;&#160;daa_additional_signed_data:&#160;DAAAdditionalSignedData;<br/>&#160;&#160;&#160;}<br/>}&#160;DAAAuthSupplDataEntry;</b></p>
<p style="position:absolute;top:935px;left:105px;white-space:nowrap" class="ft1930"><b>struct&#160;{<br/>&#160;&#160;&#160;opaque&#160;daa_signature&#160;&lt;0..2^16-4&gt;;<br/>}&#160;DAASignature;</b></p>
<p style="position:absolute;top:1019px;left:105px;white-space:nowrap" class="ft1930"><b>struct&#160;{<br/>&#160;&#160;&#160;opaque&#160;daa_additional_signed_data&#160;&lt;0..2^16-4&gt;;<br/>}&#160;DAAAdditionalSignedData;</b></p>
<p style="position:absolute;top:1095px;left:83px;white-space:nowrap" class="ft1917">where:&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft1921">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft1921">17/27</p>
</div>
<!-- Page 20 -->
<a name="20"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page20-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3020.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft209">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft200">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft2021">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft2021">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:154px;left:110px;white-space:nowrap" class="ft2012">●</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft2028"><b>DAASignature</b></p>
<p style="position:absolute;top:149px;left:257px;white-space:nowrap" class="ft2017">&#160;contains&#160;the&#160;DAA&#160;signature&#160;whose&#160;encoding&#160;depends&#160;on&#160;the&#160;</p>
<p style="position:absolute;top:168px;left:137px;white-space:nowrap" class="ft2017">value&#160;of&#160;</p>
<p style="position:absolute;top:168px;left:209px;white-space:nowrap" class="ft2028"><b>DAABindingVersion</b></p>
<p style="position:absolute;top:168px;left:378px;white-space:nowrap" class="ft2017">&#160;and&#160;it&#160;is&#160;specified&#160;accordingly;</p>
<p style="position:absolute;top:201px;left:110px;white-space:nowrap" class="ft2012">●</p>
<p style="position:absolute;top:197px;left:137px;white-space:nowrap" class="ft2028"><b>DAAAdditionalSignedData</b></p>
<p style="position:absolute;top:197px;left:366px;white-space:nowrap" class="ft2017">&#160;contains&#160;the&#160;additional&#160;signed&#160;data&#160;whose&#160;encoding&#160;</p>
<p style="position:absolute;top:216px;left:137px;white-space:nowrap" class="ft2017">depends&#160;on&#160;the&#160;value&#160;of&#160;</p>
<p style="position:absolute;top:216px;left:343px;white-space:nowrap" class="ft2028"><b>DAABindingVersion</b></p>
<p style="position:absolute;top:216px;left:512px;white-space:nowrap" class="ft2017">&#160;and&#160;it&#160;is&#160;specified&#160;accordingly.</p>
<p style="position:absolute;top:262px;left:83px;white-space:nowrap" class="ft2024"><b>6&#160;&#160;&#160;Specification&#160;of&#160;TCG&#160;TSS/TPM&#160;DAA&#160;profile&#160;for&#160;DAA-TLS</b></p>
<p style="position:absolute;top:295px;left:83px;white-space:nowrap" class="ft2019">To&#160;have&#160;a&#160;complete&#160;specification&#160;for&#160;DAA-TLS&#160;it&#160;is&#160;necessary&#160;to&#160;define&#160;a&#160;DAA&#160;profile,&#160;<br/>i.e.&#160;a&#160;specific&#160;design&#160;and&#160;data&#160;format&#160;for&#160;DAA;&#160;therefore&#160;each&#160;profile&#160;must&#160;refer&#160;to&#160;a&#160;<br/>specific&#160;version&#160;of&#160;DAA&#160;protocol,&#160;standardized&#160;through&#160;a&#160;specification.&#160;The&#160;profile&#160;is&#160;<br/>build&#160;upon&#160;such&#160;base&#160;specification&#160;and&#160;must&#160;define&#160;the&#160;(sub)set&#160;of&#160;features&#160;defined&#160;in&#160;<br/>the&#160;base&#160;specification&#160;to&#160;use&#160;for&#160;DAA-TLS,&#160;data&#160;encoding/decoding,&#160;interactions&#160;with&#160;<br/>APIs&#160;(if&#160;any),&#160;and&#160;any&#160;other&#160;aspect&#160;relevant&#160;to&#160;have&#160;a&#160;complete&#160;and&#160;interoperable&#160;<br/>specification&#160;for&#160;DAA-TLS.&#160;Depending&#160;on&#160;the&#160;features&#160;selected&#160;from&#160;the&#160;base&#160;<br/>specification,&#160;when&#160;defining&#160;a&#160;new&#160;DAA&#160;profile,&#160;it&#160;might&#160;be&#160;necessary&#160;to&#160;add&#160;new&#160;types&#160;<br/>for&#160;</p>
<p style="position:absolute;top:449px;left:111px;white-space:nowrap" class="ft2028"><b>DAAAuthParam</b></p>
<p style="position:absolute;top:449px;left:231px;white-space:nowrap" class="ft2017">&#160;and&#160;</p>
<p style="position:absolute;top:449px;left:272px;white-space:nowrap" class="ft2028"><b>DAAAuthSupplDataEntry</b></p>
<p style="position:absolute;top:449px;left:481px;white-space:nowrap" class="ft2017">&#160;respectively,&#160;thus&#160;leading&#160;to&#160;a&#160;new&#160;</p>
<p style="position:absolute;top:468px;left:83px;white-space:nowrap" class="ft2019">version&#160;of&#160;DAA-TLS.<br/>In&#160;this&#160;section&#160;a&#160;DAA&#160;profile&#160;based&#160;on&#160;TCG&#160;TSS&#160;[2]&#160;and&#160;TPM&#160;[1]&#160;specifications&#160;is&#160;defined&#160;<br/>for&#160;the&#160;DAA-enhanced&#160;TLS&#160;protocol&#160;specified&#160;in&#160;Section&#160;5.&#160;This&#160;profile&#160;is&#160;identified&#160;by&#160;<br/>the&#160;value&#160;1&#160;to&#160;assign&#160;to&#160;</p>
<p style="position:absolute;top:535px;left:284px;white-space:nowrap" class="ft2028"><b>DAABindingVersion</b></p>
<p style="position:absolute;top:535px;left:453px;white-space:nowrap" class="ft2017">&#160;carried&#160;by&#160;a&#160;</p>
<p style="position:absolute;top:535px;left:562px;white-space:nowrap" class="ft2028"><b>DAAAuthParam</b></p>
<p style="position:absolute;top:535px;left:681px;white-space:nowrap" class="ft2017">.&#160;</p>
<p style="position:absolute;top:581px;left:83px;white-space:nowrap" class="ft2026"><i><b>6.1&#160;&#160;&#160;Profile&#160;requirements&#160;and&#160;specification</b></i></p>
<p style="position:absolute;top:612px;left:83px;white-space:nowrap" class="ft2025">This&#160;profile&#160;specifies&#160;that&#160;all&#160;functions&#160;and&#160;data&#160;structures&#160;related&#160;to&#160;the&#160;attributes&#160;of&#160;<br/>DAA&#160;credentials&#160;and&#160;the&#160;Anonymity&#160;Revocation&#160;Authority&#160;(ARA)&#160;defined&#160;by&#160;TSS&#160;<br/>specification&#160;[2]&#160;MUST&#160;NOT&#160;be&#160;used&#160;with&#160;DAA-TLS.&#160;Future&#160;versions&#160;of&#160;this&#160;DAA&#160;profile&#160;<br/>may&#160;specify&#160;the&#160;use&#160;of&#160;such&#160;features.<br/>This&#160;profile&#160;requires&#160;a&#160;TCG-enabled&#160;platform&#160;for&#160;the&#160;TLS&#160;client&#160;(assuming&#160;the&#160;</p>
<p style="position:absolute;top:698px;left:726px;white-space:nowrap" class="ft2027"><i>platform&#160;</i></p>
<p style="position:absolute;top:717px;left:83px;white-space:nowrap" class="ft2019">DAA&#160;role)&#160;equipped&#160;with&#160;a&#160;TPM&#160;1.2&#160;[1]&#160;and&#160;a&#160;TCG&#160;Software&#160;Stack&#160;(TSS)&#160;version&#160;1.2&#160;<br/>Errata&#160;A&#160;[2],&#160;while&#160;the&#160;TLS&#160;server&#160;(assuming&#160;the&#160;</p>
<p style="position:absolute;top:736px;left:487px;white-space:nowrap" class="ft2027"><i>verifier</i></p>
<p style="position:absolute;top:736px;left:545px;white-space:nowrap" class="ft2017">&#160;DAA&#160;role)&#160;MUST&#160;only&#160;have&#160;</p>
<p style="position:absolute;top:756px;left:83px;white-space:nowrap" class="ft2019">installed&#160;the&#160;TSS&#160;with&#160;the&#160;same&#160;version&#160;as&#160;the&#160;client.<br/>This&#160;profile&#160;defines&#160;a&#160;list&#160;of&#160;the&#160;TSS&#160;functions&#160;required&#160;for&#160;DAA-TLS;&#160;for&#160;each&#160;one,&#160;the&#160;<br/>function&#160;prototype&#160;and&#160;a&#160;summary&#160;are&#160;included.<br/>This&#160;profile&#160;also&#160;defines&#160;the&#160;data&#160;encoding/decoding&#160;rules.<br/>Both&#160;the&#160;DAA-TLS&#160;handshake&#160;messages&#160;and&#160;the&#160;interactions&#160;(i.e.&#160;the&#160;function&#160;calls)&#160;<br/>with&#160;the&#160;TSP&#160;Interface&#160;exposed&#160;by&#160;TSS&#160;are&#160;shown&#160;in&#160;the&#160;combined&#160;diagram&#160;of<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#21">&#160;Figure&#160;4.</a></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft2021">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft2021">18/27</p>
</div>
<!-- Page 21 -->
<a name="21"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page21-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3021.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft219">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft210">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft2121">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft2121">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:676px;left:83px;white-space:nowrap" class="ft2126"><i><b>6.2&#160;&#160;&#160;Prerequisites&#160;for&#160;using&#160;TSS&#160;functions&#160;for&#160;DAA-TLS</b></i></p>
<p style="position:absolute;top:708px;left:83px;white-space:nowrap" class="ft2119">The&#160;TSP&#160;Interface&#160;(TSPI)&#160;provided&#160;by&#160;TSS&#160;exposes&#160;objects&#160;whose&#160;instances&#160;can&#160;be&#160;<br/>referenced&#160;through&#160;handles.&#160;Therefore&#160;before&#160;using&#160;an&#160;object&#160;it&#160;is&#160;necessary&#160;to&#160;create&#160;<br/>it&#160;and&#160;obtain&#160;the&#160;related&#160;handle.&#160;This&#160;can&#160;be&#160;done&#160;using&#160;specific&#160;functions&#160;provided&#160;by&#160;<br/>TSPI.&#160;This&#160;profile&#160;does&#160;not&#160;specify&#160;which&#160;functions&#160;must&#160;be&#160;used:&#160;refer&#160;to&#160;the&#160;TSS&#160;<br/>specification&#160;[2].&#160;For&#160;this&#160;DAA&#160;profile,&#160;the&#160;necessary&#160;objects&#160;are:</p>
<p style="position:absolute;top:817px;left:110px;white-space:nowrap" class="ft2112">●</p>
<p style="position:absolute;top:813px;left:137px;white-space:nowrap" class="ft2117">TPM&#160;object&#160;that&#160;allows&#160;to&#160;use&#160;the&#160;chip&#160;functionalities</p>
<p style="position:absolute;top:845px;left:110px;white-space:nowrap" class="ft2112">●</p>
<p style="position:absolute;top:841px;left:137px;white-space:nowrap" class="ft2117">An&#160;object&#160;that&#160;contains&#160;information&#160;about&#160;the&#160;DAA&#160;issuer</p>
<p style="position:absolute;top:873px;left:110px;white-space:nowrap" class="ft2112">●</p>
<p style="position:absolute;top:869px;left:137px;white-space:nowrap" class="ft2117">DAA&#160;credentials</p>
<p style="position:absolute;top:897px;left:83px;white-space:nowrap" class="ft2119">Furthermore&#160;DAA-TLS&#160;requires&#160;that&#160;the&#160;platform&#160;(i.e.&#160;the&#160;TLS&#160;client)&#160;receives&#160;DAA&#160;<br/>credentials&#160;from&#160;a&#160;DAA&#160;issuer.&#160;This&#160;aspect&#160;is&#160;not&#160;covered&#160;in&#160;this&#160;document&#160;and&#160;it&#160;is&#160;<br/>supposed&#160;that&#160;such&#160;credentials&#160;are&#160;available&#160;on&#160;the&#160;client&#160;before&#160;the&#160;DAA-TLS&#160;<br/>handshake&#160;begins.</p>
<p style="position:absolute;top:1001px;left:83px;white-space:nowrap" class="ft2126"><i><b>6.3&#160;&#160;&#160;Nonce&#160;and&#160;basename&#160;generation</b></i></p>
<p style="position:absolute;top:1032px;left:83px;white-space:nowrap" class="ft2119">The&#160;DAA&#160;verifier's&#160;nonce&#160;and&#160;the&#160;basename&#160;MUST&#160;be&#160;generated&#160;by&#160;the&#160;server&#160;and&#160;sent&#160;<br/>to&#160;the&#160;client&#160;via&#160;server&#160;hello&#160;extension;&#160;they&#160;must&#160;obtained&#160;by&#160;calling&#160;the&#160;TSS&#160;function</p>
<p style="position:absolute;top:1089px;left:105px;white-space:nowrap" class="ft2128"><b>TSS_RESULT&#160;Tspi_DAA_Verifier_Init</b></p>
<p style="position:absolute;top:1108px;left:158px;white-space:nowrap" class="ft2128"><b>(</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft2121">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft2121">19/27</p>
<p style="position:absolute;top:632px;left:154px;white-space:nowrap" class="ft2129"><i>Figure&#160;4:&#160;TCG&#160;TSS/TPM&#160;DAA&#160;profile&#160;for&#160;DAA-TLS:&#160;TLS&#160;handshake&#160;and&#160;TSS&#160;calls</i></p>
</div>
<!-- Page 22 -->
<a name="22"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page22-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3022.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft229">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft220">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft2221">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft2221">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:149px;left:211px;white-space:nowrap" class="ft2228"><b>TSS_HDAA_CREDENTIAL</b></p>
<p style="position:absolute;top:149px;left:477px;white-space:nowrap" class="ft2228"><b>hDAACredential,</b></p>
<p style="position:absolute;top:149px;left:690px;white-space:nowrap" class="ft2228"><b>//&#160;in</b></p>
<p style="position:absolute;top:168px;left:211px;white-space:nowrap" class="ft2228"><b>UINT32*</b></p>
<p style="position:absolute;top:168px;left:477px;white-space:nowrap" class="ft2228"><b>nonceVerifierLength,&#160;//&#160;out</b></p>
<p style="position:absolute;top:188px;left:211px;white-space:nowrap" class="ft2228"><b>BYTE**</b></p>
<p style="position:absolute;top:188px;left:477px;white-space:nowrap" class="ft2228"><b>nonceVerifier,</b></p>
<p style="position:absolute;top:188px;left:690px;white-space:nowrap" class="ft2228"><b>//&#160;out</b></p>
<p style="position:absolute;top:207px;left:211px;white-space:nowrap" class="ft2228"><b>UINT32*</b></p>
<p style="position:absolute;top:207px;left:477px;white-space:nowrap" class="ft2228"><b>baseNameLength,</b></p>
<p style="position:absolute;top:207px;left:690px;white-space:nowrap" class="ft2228"><b>//&#160;out</b></p>
<p style="position:absolute;top:226px;left:211px;white-space:nowrap" class="ft2228"><b>BYTE**</b></p>
<p style="position:absolute;top:226px;left:477px;white-space:nowrap" class="ft2228"><b>baseName</b></p>
<p style="position:absolute;top:226px;left:690px;white-space:nowrap" class="ft2228"><b>//&#160;out</b></p>
<p style="position:absolute;top:245px;left:158px;white-space:nowrap" class="ft2228"><b>);</b></p>
<p style="position:absolute;top:282px;left:83px;white-space:nowrap" class="ft2225">where&#160;the&#160;first&#160;parameter&#160;is&#160;the&#160;handle&#160;of&#160;the&#160;DAA&#160;credential;&#160;the&#160;other&#160;parameters&#160;<br/>constitute&#160;the&#160;output&#160;of&#160;the&#160;function&#160;and&#160;represent&#160;respectively&#160;the&#160;size&#160;of&#160;the&#160;nonce,&#160;<br/>the&#160;nonce,&#160;the&#160;size&#160;of&#160;the&#160;basename&#160;and&#160;the&#160;basename.&#160;<br/>The&#160;nonce&#160;MUST&#160;be&#160;sent&#160;to&#160;the&#160;client&#160;as&#160;</p>
<p style="position:absolute;top:349px;left:423px;white-space:nowrap" class="ft2228"><b>Nonce</b></p>
<p style="position:absolute;top:349px;left:472px;white-space:nowrap" class="ft2217">&#160;as&#160;element&#160;of&#160;the&#160;list&#160;of&#160;</p>
<p style="position:absolute;top:349px;left:679px;white-space:nowrap" class="ft2228"><b>DAAAuthParam&#160;</b></p>
<p style="position:absolute;top:368px;left:83px;white-space:nowrap" class="ft2217">carried&#160;over&#160;the&#160;</p>
<p style="position:absolute;top:368px;left:221px;white-space:nowrap" class="ft2228"><b>DAAAuthExt</b></p>
<p style="position:absolute;top:368px;left:320px;white-space:nowrap" class="ft2217">&#160;server&#160;hello&#160;extension.</p>
<p style="position:absolute;top:396px;left:83px;white-space:nowrap" class="ft2217">If&#160;the&#160;basename&#160;is&#160;not&#160;returned&#160;by&#160;the&#160;function&#160;(i.e.&#160;</p>
<p style="position:absolute;top:396px;left:518px;white-space:nowrap" class="ft2228"><b>*baseNameLength</b></p>
<p style="position:absolute;top:396px;left:667px;white-space:nowrap" class="ft2217">&#160;is&#160;set&#160;to&#160;0&#160;and&#160;</p>
<p style="position:absolute;top:415px;left:83px;white-space:nowrap" class="ft2228"><b>**baseName</b></p>
<p style="position:absolute;top:415px;left:183px;white-space:nowrap" class="ft2217">&#160;to&#160;NULL),&#160;then&#160;the&#160;</p>
<p style="position:absolute;top:415px;left:345px;white-space:nowrap" class="ft2228"><b>Basename</b></p>
<p style="position:absolute;top:415px;left:424px;white-space:nowrap" class="ft2217">&#160;MUST&#160;NOT&#160;be&#160;present&#160;as&#160;element&#160;of&#160;the&#160;list&#160;</p>
<p style="position:absolute;top:435px;left:83px;white-space:nowrap" class="ft2217">of&#160;</p>
<p style="position:absolute;top:435px;left:105px;white-space:nowrap" class="ft2228"><b>DAAAuthParam</b></p>
<p style="position:absolute;top:435px;left:224px;white-space:nowrap" class="ft2217">&#160;carried&#160;over&#160;the&#160;</p>
<p style="position:absolute;top:435px;left:367px;white-space:nowrap" class="ft2228"><b>DAAAuthExt</b></p>
<p style="position:absolute;top:435px;left:466px;white-space:nowrap" class="ft2217">&#160;server&#160;hello&#160;extension.</p>
<p style="position:absolute;top:481px;left:83px;white-space:nowrap" class="ft2226"><i><b>6.4&#160;&#160;&#160;DAA&#160;signature</b></i></p>
<p style="position:absolute;top:512px;left:83px;white-space:nowrap" class="ft2219">The&#160;client&#160;MUST&#160;generate&#160;the&#160;DAA&#160;signature&#160;over&#160;the&#160;self-signed&#160;TLS&#160;client&#160;certificate&#160;<br/>and&#160;optionally&#160;over&#160;additional&#160;data;&#160;the&#160;signature&#160;MUST&#160;be&#160;sent&#160;to&#160;the&#160;server&#160;via&#160;<br/>supplemental&#160;data&#160;entry.&#160;The&#160;signature&#160;is&#160;generated&#160;by&#160;calling&#160;the&#160;TSS&#160;function</p>
<p style="position:absolute;top:588px;left:105px;white-space:nowrap" class="ft2230"><b>TSS_RESULT&#160;Tspi_TPM_DAA_Sign<br/>(</b></p>
<p style="position:absolute;top:626px;left:158px;white-space:nowrap" class="ft2228"><b>TSS_HTPM</b></p>
<p style="position:absolute;top:626px;left:424px;white-space:nowrap" class="ft2228"><b>hTPM,</b></p>
<p style="position:absolute;top:626px;left:690px;white-space:nowrap" class="ft2228"><b>//&#160;in</b></p>
<p style="position:absolute;top:645px;left:158px;white-space:nowrap" class="ft2228"><b>TSS_HDAA_CREDENTIAL</b></p>
<p style="position:absolute;top:645px;left:424px;white-space:nowrap" class="ft2228"><b>hDAACredential,</b></p>
<p style="position:absolute;top:645px;left:690px;white-space:nowrap" class="ft2228"><b>//&#160;in</b></p>
<p style="position:absolute;top:665px;left:158px;white-space:nowrap" class="ft2228"><b>TSS_HDAA_ARA_KEY</b></p>
<p style="position:absolute;top:665px;left:424px;white-space:nowrap" class="ft2228"><b>hARAKey,</b></p>
<p style="position:absolute;top:665px;left:690px;white-space:nowrap" class="ft2228"><b>//&#160;in</b></p>
<p style="position:absolute;top:684px;left:158px;white-space:nowrap" class="ft2228"><b>TSS_HHASH</b></p>
<p style="position:absolute;top:684px;left:424px;white-space:nowrap" class="ft2228"><b>hARACondition,</b></p>
<p style="position:absolute;top:684px;left:690px;white-space:nowrap" class="ft2228"><b>//&#160;in</b></p>
<p style="position:absolute;top:703px;left:158px;white-space:nowrap" class="ft2228"><b>TSS_DAA_SELECTED_ATTRIB*</b></p>
<p style="position:absolute;top:703px;left:424px;white-space:nowrap" class="ft2228"><b>revealAttributes,</b></p>
<p style="position:absolute;top:703px;left:690px;white-space:nowrap" class="ft2228"><b>//&#160;in</b></p>
<p style="position:absolute;top:722px;left:158px;white-space:nowrap" class="ft2228"><b>UINT32</b></p>
<p style="position:absolute;top:722px;left:424px;white-space:nowrap" class="ft2228"><b>verifierNonceLength,</b></p>
<p style="position:absolute;top:722px;left:690px;white-space:nowrap" class="ft2228"><b>//&#160;in</b></p>
<p style="position:absolute;top:741px;left:158px;white-space:nowrap" class="ft2228"><b>BYTE*</b></p>
<p style="position:absolute;top:741px;left:424px;white-space:nowrap" class="ft2228"><b>verifierNonce,</b></p>
<p style="position:absolute;top:741px;left:690px;white-space:nowrap" class="ft2228"><b>//&#160;in</b></p>
<p style="position:absolute;top:761px;left:158px;white-space:nowrap" class="ft2228"><b>UINT32</b></p>
<p style="position:absolute;top:761px;left:424px;white-space:nowrap" class="ft2228"><b>verifierBaseNameLength,</b></p>
<p style="position:absolute;top:761px;left:690px;white-space:nowrap" class="ft2228"><b>//&#160;in</b></p>
<p style="position:absolute;top:780px;left:158px;white-space:nowrap" class="ft2228"><b>BYTE*</b></p>
<p style="position:absolute;top:780px;left:424px;white-space:nowrap" class="ft2228"><b>verifierBaseName,</b></p>
<p style="position:absolute;top:780px;left:690px;white-space:nowrap" class="ft2228"><b>//&#160;in</b></p>
<p style="position:absolute;top:799px;left:158px;white-space:nowrap" class="ft2228"><b>TSS_HOBJECT</b></p>
<p style="position:absolute;top:799px;left:424px;white-space:nowrap" class="ft2228"><b>signData,</b></p>
<p style="position:absolute;top:799px;left:690px;white-space:nowrap" class="ft2228"><b>//&#160;in</b></p>
<p style="position:absolute;top:818px;left:158px;white-space:nowrap" class="ft2228"><b>TSS_DAA_SIGNATURE**</b></p>
<p style="position:absolute;top:818px;left:424px;white-space:nowrap" class="ft2228"><b>daaSignature</b></p>
<p style="position:absolute;top:818px;left:690px;white-space:nowrap" class="ft2228"><b>//&#160;out</b></p>
<p style="position:absolute;top:837px;left:105px;white-space:nowrap" class="ft2228"><b>);</b></p>
<p style="position:absolute;top:874px;left:83px;white-space:nowrap" class="ft2217">where&#160;the&#160;parameters&#160;are:</p>
<p style="position:absolute;top:907px;left:110px;white-space:nowrap" class="ft2212">●</p>
<p style="position:absolute;top:903px;left:137px;white-space:nowrap" class="ft2228"><b>hTPM</b></p>
<p style="position:absolute;top:903px;left:177px;white-space:nowrap" class="ft2217">&#160;is&#160;the&#160;handle&#160;of&#160;the&#160;TPM&#160;object.</p>
<p style="position:absolute;top:935px;left:110px;white-space:nowrap" class="ft2212">●</p>
<p style="position:absolute;top:931px;left:137px;white-space:nowrap" class="ft2228"><b>hDAACredential</b></p>
<p style="position:absolute;top:931px;left:277px;white-space:nowrap" class="ft2217">&#160;is&#160;the&#160;handle&#160;of&#160;the&#160;object&#160;holding&#160;the&#160;DAA&#160;credential.</p>
<p style="position:absolute;top:964px;left:110px;white-space:nowrap" class="ft2212">●</p>
<p style="position:absolute;top:959px;left:137px;white-space:nowrap" class="ft2228"><b>hARAKey</b></p>
<p style="position:absolute;top:959px;left:207px;white-space:nowrap" class="ft2217">&#160;is&#160;the&#160;handle&#160;of&#160;the&#160;Anonymity&#160;Revocation&#160;Authority&#160;(ARA)&#160;object.&#160;If&#160;it&#160;</p>
<p style="position:absolute;top:978px;left:137px;white-space:nowrap" class="ft2217">is&#160;NULL,&#160;then&#160;ARA&#160;is&#160;not&#160;used.&#160;This&#160;profile&#160;requires&#160;this&#160;parameter&#160;set&#160;to&#160;NULL.</p>
<p style="position:absolute;top:1011px;left:110px;white-space:nowrap" class="ft2212">●</p>
<p style="position:absolute;top:1006px;left:137px;white-space:nowrap" class="ft2228"><b>hARACondition</b></p>
<p style="position:absolute;top:1006px;left:267px;white-space:nowrap" class="ft2217">&#160;is&#160;the&#160;handle&#160;of&#160;the&#160;object&#160;indicating&#160;the&#160;conditions&#160;under&#160;which&#160;</p>
<p style="position:absolute;top:1026px;left:137px;white-space:nowrap" class="ft2217">ARA&#160;should&#160;reveal&#160;the&#160;pseudonym.&#160;This&#160;MUST&#160;be&#160;NULL&#160;if&#160;</p>
<p style="position:absolute;top:1026px;left:614px;white-space:nowrap" class="ft2228"><b>hARAKey</b></p>
<p style="position:absolute;top:1026px;left:683px;white-space:nowrap" class="ft2217">&#160;is&#160;NULL.&#160;This&#160;</p>
<p style="position:absolute;top:1045px;left:137px;white-space:nowrap" class="ft2217">profile&#160;requires&#160;this&#160;parameter&#160;set&#160;to&#160;NULL.</p>
<p style="position:absolute;top:1078px;left:110px;white-space:nowrap" class="ft2212">●</p>
<p style="position:absolute;top:1073px;left:137px;white-space:nowrap" class="ft2228"><b>revealAttributes</b></p>
<p style="position:absolute;top:1073px;left:296px;white-space:nowrap" class="ft2217">&#160;represents&#160;the&#160;attributes&#160;the&#160;credential&#160;owner&#160;wants&#160;to&#160;</p>
<p style="position:absolute;top:1092px;left:137px;white-space:nowrap" class="ft2217">reveal&#160;to&#160;the&#160;DAA&#160;verifier.&#160;This&#160;profile&#160;requires&#160;this&#160;parameter&#160;set&#160;to&#160;NULL.</p>
<p style="position:absolute;top:1125px;left:110px;white-space:nowrap" class="ft2212">●</p>
<p style="position:absolute;top:1120px;left:137px;white-space:nowrap" class="ft2228"><b>verifierBaseName</b></p>
<p style="position:absolute;top:1120px;left:296px;white-space:nowrap" class="ft2217">&#160;and&#160;</p>
<p style="position:absolute;top:1120px;left:338px;white-space:nowrap" class="ft2228"><b>verifierBaseNameLength</b></p>
<p style="position:absolute;top:1120px;left:557px;white-space:nowrap" class="ft2217">&#160;are&#160;respectively&#160;the&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft2221">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft2221">20/27</p>
</div>
<!-- Page 23 -->
<a name="23"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page23-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3023.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft239">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft230">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft2321">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft2321">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft2317">basename&#160;and&#160;its&#160;length.&#160;If&#160;</p>
<p style="position:absolute;top:149px;left:369px;white-space:nowrap" class="ft2328"><b>Basename</b></p>
<p style="position:absolute;top:149px;left:449px;white-space:nowrap" class="ft2317">&#160;was&#160;not&#160;present&#160;as&#160;element&#160;of&#160;the&#160;list&#160;of&#160;</p>
<p style="position:absolute;top:168px;left:137px;white-space:nowrap" class="ft2328"><b>DAAAuthParam</b></p>
<p style="position:absolute;top:168px;left:257px;white-space:nowrap" class="ft2317">,&#160;then&#160;</p>
<p style="position:absolute;top:168px;left:310px;white-space:nowrap" class="ft2328"><b>verifierBaseName</b></p>
<p style="position:absolute;top:168px;left:469px;white-space:nowrap" class="ft2317">&#160;MUST&#160;be&#160;set&#160;to&#160;NULL&#160;and&#160;</p>
<p style="position:absolute;top:188px;left:137px;white-space:nowrap" class="ft2328"><b>verifierBaseNameLength</b></p>
<p style="position:absolute;top:188px;left:356px;white-space:nowrap" class="ft2317">&#160;MUST&#160;be&#160;set&#160;to&#160;0;&#160;else&#160;the&#160;basename&#160;MUST&#160;be&#160;set&#160;to&#160;</p>
<p style="position:absolute;top:207px;left:137px;white-space:nowrap" class="ft2317">the&#160;value&#160;received&#160;by&#160;the&#160;client&#160;as&#160;</p>
<p style="position:absolute;top:207px;left:429px;white-space:nowrap" class="ft2328"><b>Basename</b></p>
<p style="position:absolute;top:207px;left:508px;white-space:nowrap" class="ft2317">&#160;element&#160;of&#160;the&#160;list&#160;of&#160;</p>
<p style="position:absolute;top:226px;left:137px;white-space:nowrap" class="ft2328"><b>DAAAuthParam</b></p>
<p style="position:absolute;top:226px;left:257px;white-space:nowrap" class="ft2317">&#160;carried&#160;over&#160;the&#160;</p>
<p style="position:absolute;top:226px;left:400px;white-space:nowrap" class="ft2328"><b>DAAAuthExt</b></p>
<p style="position:absolute;top:226px;left:499px;white-space:nowrap" class="ft2317">&#160;server&#160;hello&#160;extension.</p>
<p style="position:absolute;top:259px;left:110px;white-space:nowrap" class="ft2312">●</p>
<p style="position:absolute;top:254px;left:137px;white-space:nowrap" class="ft2328"><b>verifierNonce</b></p>
<p style="position:absolute;top:254px;left:267px;white-space:nowrap" class="ft2317">&#160;and&#160;</p>
<p style="position:absolute;top:254px;left:308px;white-space:nowrap" class="ft2328"><b>verifierNonceLength</b></p>
<p style="position:absolute;top:254px;left:497px;white-space:nowrap" class="ft2317">&#160;are&#160;respectively&#160;the&#160;nonce&#160;and&#160;its&#160;</p>
<p style="position:absolute;top:273px;left:137px;white-space:nowrap" class="ft2317">length.&#160;The&#160;nonce&#160;MUST&#160;be&#160;set&#160;to&#160;the&#160;value&#160;received&#160;by&#160;the&#160;client&#160;as&#160;</p>
<p style="position:absolute;top:273px;left:714px;white-space:nowrap" class="ft2328"><b>Nonce&#160;</b></p>
<p style="position:absolute;top:293px;left:137px;white-space:nowrap" class="ft2317">element&#160;of&#160;the&#160;list&#160;of&#160;</p>
<p style="position:absolute;top:293px;left:315px;white-space:nowrap" class="ft2328"><b>DAAAuthParam</b></p>
<p style="position:absolute;top:293px;left:434px;white-space:nowrap" class="ft2317">&#160;carried&#160;over&#160;the&#160;</p>
<p style="position:absolute;top:293px;left:577px;white-space:nowrap" class="ft2328"><b>DAAAuthExt</b></p>
<p style="position:absolute;top:293px;left:676px;white-space:nowrap" class="ft2317">&#160;server&#160;hello&#160;</p>
<p style="position:absolute;top:312px;left:137px;white-space:nowrap" class="ft2317">extension.</p>
<p style="position:absolute;top:345px;left:110px;white-space:nowrap" class="ft2312">●</p>
<p style="position:absolute;top:340px;left:137px;white-space:nowrap" class="ft2328"><b>signData</b></p>
<p style="position:absolute;top:340px;left:217px;white-space:nowrap" class="ft2317">&#160;is&#160;the&#160;handle&#160;of&#160;the&#160;object&#160;containing&#160;data&#160;to&#160;be&#160;DAA-signed&#160;to&#160;bind&#160;</p>
<p style="position:absolute;top:359px;left:137px;white-space:nowrap" class="ft2317">the&#160;TLS&#160;session&#160;to&#160;the&#160;DAA&#160;authentication;&#160;the&#160;type&#160;of&#160;the&#160;handle&#160;MUST&#160;be&#160;</p>
<p style="position:absolute;top:378px;left:137px;white-space:nowrap" class="ft2328"><b>TSS_HHASH</b></p>
<p style="position:absolute;top:378px;left:227px;white-space:nowrap" class="ft2317">;&#160;the&#160;data&#160;carried&#160;by&#160;the&#160;object&#160;MUST&#160;be&#160;the&#160;digest&#160;calculated&#160;using&#160;</p>
<p style="position:absolute;top:398px;left:137px;white-space:nowrap" class="ft2319">SHA-1&#160;algorithm&#160;over&#160;the&#160;self-signed&#160;TLS&#160;client&#160;certificate&#160;(DER-encoded)&#160;and,&#160;if&#160;<br/>present,&#160;additional&#160;data.&#160;The&#160;details&#160;of&#160;this&#160;calculation&#160;are&#160;specified&#160;in&#160;section&#160;<br/>5.3.</p>
<p style="position:absolute;top:469px;left:110px;white-space:nowrap" class="ft2312">●</p>
<p style="position:absolute;top:464px;left:137px;white-space:nowrap" class="ft2328"><b>daaSignature</b></p>
<p style="position:absolute;top:464px;left:257px;white-space:nowrap" class="ft2317">&#160;is&#160;the&#160;output&#160;of&#160;the&#160;function,&#160;i.e.&#160;the&#160;DAA&#160;signature&#160;performed&#160;by&#160;</p>
<p style="position:absolute;top:483px;left:137px;white-space:nowrap" class="ft2317">TSS/TPM&#160;with&#160;the&#160;credential&#160;handled&#160;by&#160;</p>
<p style="position:absolute;top:483px;left:472px;white-space:nowrap" class="ft2328"><b>hDAACredential</b></p>
<p style="position:absolute;top:483px;left:611px;white-space:nowrap" class="ft2317">,&#160;over&#160;</p>
<p style="position:absolute;top:483px;left:663px;white-space:nowrap" class="ft2328"><b>SignData</b></p>
<p style="position:absolute;top:483px;left:743px;white-space:nowrap" class="ft2317">&#160;using&#160;</p>
<p style="position:absolute;top:503px;left:137px;white-space:nowrap" class="ft2319">the&#160;nonce&#160;received&#160;from&#160;the&#160;server&#160;and&#160;the&#160;basename&#160;either&#160;received&#160;from&#160;the&#160;<br/>server&#160;or&#160;randomly&#160;generated&#160;by&#160;the&#160;client&#160;itself&#160;at&#160;the&#160;signature&#160;time.&#160;</p>
<p style="position:absolute;top:541px;left:137px;white-space:nowrap" class="ft2316"><b>d</b></p>
<p style="position:absolute;top:541px;left:149px;white-space:nowrap" class="ft2328"><b>aaSignature</b></p>
<p style="position:absolute;top:541px;left:259px;white-space:nowrap" class="ft2317">&#160;MUST&#160;be&#160;sent&#160;to&#160;the&#160;server&#160;as&#160;</p>
<p style="position:absolute;top:541px;left:518px;white-space:nowrap" class="ft2328"><b>DAASignature</b></p>
<p style="position:absolute;top:541px;left:638px;white-space:nowrap" class="ft2317">&#160;element&#160;of&#160;the&#160;list&#160;</p>
<p style="position:absolute;top:560px;left:137px;white-space:nowrap" class="ft2317">of&#160;</p>
<p style="position:absolute;top:560px;left:159px;white-space:nowrap" class="ft2328"><b>DAAAuthSupplDataEntry&#160;</b></p>
<p style="position:absolute;top:560px;left:377px;white-space:nowrap" class="ft2317">carried&#160;over&#160;the&#160;</p>
<p style="position:absolute;top:560px;left:515px;white-space:nowrap" class="ft2328"><b>SupplementalDataEntry</b></p>
<p style="position:absolute;top:560px;left:724px;white-space:nowrap" class="ft2317">.&#160;The&#160;</p>
<p style="position:absolute;top:579px;left:137px;white-space:nowrap" class="ft2316"><b>daaSignature&#160;</b></p>
<p style="position:absolute;top:579px;left:269px;white-space:nowrap" class="ft2317">MUST&#160;be&#160;encoded&#160;in&#160;DER&#160;format,&#160;as&#160;detailed&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#25">&#160;6.6.2.1.</a></p>
<p style="position:absolute;top:625px;left:83px;white-space:nowrap" class="ft2326"><i><b>6.5&#160;&#160;&#160;Signature&#160;verification</b></i></p>
<p style="position:absolute;top:657px;left:83px;white-space:nowrap" class="ft2319">The&#160;server&#160;MUST&#160;verify&#160;the&#160;DAA&#160;signature&#160;received&#160;from&#160;client&#160;through&#160;the&#160;<br/>supplemental&#160;data.&#160;The&#160;signature&#160;is&#160;verified&#160;by&#160;calling&#160;the&#160;TSS&#160;function</p>
<p style="position:absolute;top:704px;left:105px;white-space:nowrap" class="ft2330"><b>TSS_RESULT&#160;Tspi_DAA_VerifySignature<br/>(</b></p>
<p style="position:absolute;top:743px;left:158px;white-space:nowrap" class="ft2328"><b>TSS_HDAA_CREDENTIAL</b></p>
<p style="position:absolute;top:743px;left:424px;white-space:nowrap" class="ft2328"><b>hDAACredential,</b></p>
<p style="position:absolute;top:743px;left:690px;white-space:nowrap" class="ft2328"><b>//&#160;in</b></p>
<p style="position:absolute;top:762px;left:158px;white-space:nowrap" class="ft2328"><b>TSS_HDAA_ISSUER_KEY</b></p>
<p style="position:absolute;top:762px;left:424px;white-space:nowrap" class="ft2328"><b>hIssuerKey,</b></p>
<p style="position:absolute;top:762px;left:690px;white-space:nowrap" class="ft2328"><b>//&#160;in</b></p>
<p style="position:absolute;top:781px;left:158px;white-space:nowrap" class="ft2328"><b>TSS_HDAA_ARA_KEY</b></p>
<p style="position:absolute;top:781px;left:424px;white-space:nowrap" class="ft2328"><b>hARAKey,</b></p>
<p style="position:absolute;top:781px;left:690px;white-space:nowrap" class="ft2328"><b>//&#160;in</b></p>
<p style="position:absolute;top:800px;left:158px;white-space:nowrap" class="ft2328"><b>TSS_HHASH</b></p>
<p style="position:absolute;top:800px;left:424px;white-space:nowrap" class="ft2328"><b>hARACondition,</b></p>
<p style="position:absolute;top:800px;left:690px;white-space:nowrap" class="ft2328"><b>//&#160;in</b></p>
<p style="position:absolute;top:820px;left:158px;white-space:nowrap" class="ft2328"><b>UINT32&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</b></p>
<p style="position:absolute;top:820px;left:424px;white-space:nowrap" class="ft2328"><b>attributesLength,</b></p>
<p style="position:absolute;top:820px;left:690px;white-space:nowrap" class="ft2328"><b>//&#160;in</b></p>
<p style="position:absolute;top:839px;left:158px;white-space:nowrap" class="ft2328"><b>UINT32&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</b></p>
<p style="position:absolute;top:839px;left:424px;white-space:nowrap" class="ft2328"><b>attributesLength2,</b></p>
<p style="position:absolute;top:839px;left:690px;white-space:nowrap" class="ft2328"><b>//&#160;in</b></p>
<p style="position:absolute;top:858px;left:158px;white-space:nowrap" class="ft2328"><b>BYTE**&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</b></p>
<p style="position:absolute;top:858px;left:424px;white-space:nowrap" class="ft2328"><b>attributes,</b></p>
<p style="position:absolute;top:858px;left:690px;white-space:nowrap" class="ft2328"><b>//&#160;in</b></p>
<p style="position:absolute;top:877px;left:158px;white-space:nowrap" class="ft2328"><b>UINT32&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</b></p>
<p style="position:absolute;top:877px;left:424px;white-space:nowrap" class="ft2328"><b>verifierNonceLength,</b></p>
<p style="position:absolute;top:877px;left:690px;white-space:nowrap" class="ft2328"><b>//&#160;in</b></p>
<p style="position:absolute;top:896px;left:158px;white-space:nowrap" class="ft2328"><b>BYTE*&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</b></p>
<p style="position:absolute;top:896px;left:424px;white-space:nowrap" class="ft2328"><b>verifierNonce,</b></p>
<p style="position:absolute;top:896px;left:690px;white-space:nowrap" class="ft2328"><b>//&#160;in</b></p>
<p style="position:absolute;top:916px;left:158px;white-space:nowrap" class="ft2328"><b>UINT32&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</b></p>
<p style="position:absolute;top:916px;left:424px;white-space:nowrap" class="ft2328"><b>verifierBaseNameLength,</b></p>
<p style="position:absolute;top:916px;left:690px;white-space:nowrap" class="ft2328"><b>//&#160;in</b></p>
<p style="position:absolute;top:935px;left:158px;white-space:nowrap" class="ft2328"><b>BYTE*&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</b></p>
<p style="position:absolute;top:935px;left:424px;white-space:nowrap" class="ft2328"><b>verifierBaseName,</b></p>
<p style="position:absolute;top:935px;left:690px;white-space:nowrap" class="ft2328"><b>//&#160;in</b></p>
<p style="position:absolute;top:954px;left:158px;white-space:nowrap" class="ft2328"><b>TSS_HOBJECT&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</b></p>
<p style="position:absolute;top:954px;left:424px;white-space:nowrap" class="ft2328"><b>signData,</b></p>
<p style="position:absolute;top:954px;left:690px;white-space:nowrap" class="ft2328"><b>//&#160;in</b></p>
<p style="position:absolute;top:973px;left:158px;white-space:nowrap" class="ft2328"><b>TSS_DAA_SIGNATURE*&#160;&#160;&#160;&#160;</b></p>
<p style="position:absolute;top:973px;left:424px;white-space:nowrap" class="ft2328"><b>daaSignature,</b></p>
<p style="position:absolute;top:973px;left:690px;white-space:nowrap" class="ft2328"><b>//&#160;in</b></p>
<p style="position:absolute;top:992px;left:158px;white-space:nowrap" class="ft2328"><b>TSS_BOOL*&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</b></p>
<p style="position:absolute;top:992px;left:424px;white-space:nowrap" class="ft2328"><b>isCorrect</b></p>
<p style="position:absolute;top:992px;left:690px;white-space:nowrap" class="ft2328"><b>//&#160;out</b></p>
<p style="position:absolute;top:1012px;left:105px;white-space:nowrap" class="ft2328"><b>);</b></p>
<p style="position:absolute;top:1049px;left:83px;white-space:nowrap" class="ft2317">where&#160;the&#160;parameters&#160;are:</p>
<p style="position:absolute;top:1081px;left:110px;white-space:nowrap" class="ft2312">●</p>
<p style="position:absolute;top:1077px;left:137px;white-space:nowrap" class="ft2328"><b>hDAACredential</b></p>
<p style="position:absolute;top:1077px;left:277px;white-space:nowrap" class="ft2317">&#160;is&#160;the&#160;handle&#160;of&#160;the&#160;object&#160;holding&#160;the&#160;DAA&#160;credential.</p>
<p style="position:absolute;top:1110px;left:110px;white-space:nowrap" class="ft2312">●</p>
<p style="position:absolute;top:1105px;left:137px;white-space:nowrap" class="ft2328"><b>hIssuerKey</b></p>
<p style="position:absolute;top:1105px;left:237px;white-space:nowrap" class="ft2317">&#160;is&#160;the&#160;handle&#160;of&#160;the&#160;object&#160;holding&#160;the&#160;issuer&#160;public&#160;key.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft2321">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft2321">21/27</p>
</div>
<!-- Page 24 -->
<a name="24"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2431{font-size:18px;font-family:FAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page24-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3024.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft249">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft240">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft2421">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft2421">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:154px;left:110px;white-space:nowrap" class="ft2412">●</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft2428"><b>hARAKey</b></p>
<p style="position:absolute;top:149px;left:207px;white-space:nowrap" class="ft2417">&#160;is&#160;the&#160;handle&#160;of&#160;the&#160;Anonymity&#160;Revocation&#160;Authority&#160;(ARA)&#160;object.&#160;If&#160;it&#160;</p>
<p style="position:absolute;top:168px;left:137px;white-space:nowrap" class="ft2417">is&#160;NULL,&#160;then&#160;ARA&#160;is&#160;not&#160;used.&#160;This&#160;profile&#160;requires&#160;this&#160;parameter&#160;set&#160;to&#160;NULL.</p>
<p style="position:absolute;top:201px;left:110px;white-space:nowrap" class="ft2412">●</p>
<p style="position:absolute;top:197px;left:137px;white-space:nowrap" class="ft2428"><b>hARACondition</b></p>
<p style="position:absolute;top:197px;left:267px;white-space:nowrap" class="ft2417">&#160;is&#160;the&#160;handle&#160;of&#160;the&#160;object&#160;indicating&#160;the&#160;conditions&#160;under&#160;which&#160;</p>
<p style="position:absolute;top:216px;left:137px;white-space:nowrap" class="ft2417">ARA&#160;should&#160;reveal&#160;the&#160;pseudonym.&#160;This&#160;MUST&#160;be&#160;NULL&#160;if&#160;</p>
<p style="position:absolute;top:216px;left:614px;white-space:nowrap" class="ft2428"><b>hARAKey</b></p>
<p style="position:absolute;top:216px;left:683px;white-space:nowrap" class="ft2417">&#160;is&#160;NULL.&#160;This&#160;</p>
<p style="position:absolute;top:235px;left:137px;white-space:nowrap" class="ft2417">profile&#160;requires&#160;this&#160;parameter&#160;set&#160;to&#160;NULL.</p>
<p style="position:absolute;top:268px;left:110px;white-space:nowrap" class="ft2412">●</p>
<p style="position:absolute;top:263px;left:137px;white-space:nowrap" class="ft2428"><b>attributesLength</b></p>
<p style="position:absolute;top:263px;left:296px;white-space:nowrap" class="ft2417">,&#160;</p>
<p style="position:absolute;top:263px;left:307px;white-space:nowrap" class="ft2428"><b>attributesLength2</b></p>
<p style="position:absolute;top:263px;left:476px;white-space:nowrap" class="ft2417">&#160;and&#160;</p>
<p style="position:absolute;top:263px;left:518px;white-space:nowrap" class="ft2428"><b>attributes</b></p>
<p style="position:absolute;top:263px;left:617px;white-space:nowrap" class="ft2417">&#160;are&#160;respectively&#160;the&#160;</p>
<p style="position:absolute;top:282px;left:137px;white-space:nowrap" class="ft2419">number&#160;of&#160;attributes&#160;revealed&#160;by&#160;the&#160;owner&#160;of&#160;the&#160;DAA&#160;credential,&#160;the&#160;size&#160;in&#160;<br/>bytes&#160;of&#160;each&#160;attribute&#160;and&#160;the&#160;list&#160;of&#160;the&#160;revealed&#160;attributes.&#160;This&#160;profile&#160;<br/>requires&#160;the&#160;first&#160;two&#160;parameters&#160;set&#160;to&#160;0&#160;and&#160;the&#160;last&#160;one&#160;set&#160;to&#160;NULL</p>
<p style="position:absolute;top:354px;left:110px;white-space:nowrap" class="ft2412">●</p>
<p style="position:absolute;top:349px;left:137px;white-space:nowrap" class="ft2428"><b>verifierBaseName</b></p>
<p style="position:absolute;top:349px;left:296px;white-space:nowrap" class="ft2417">&#160;and&#160;</p>
<p style="position:absolute;top:349px;left:338px;white-space:nowrap" class="ft2428"><b>verifierBaseNameLength</b></p>
<p style="position:absolute;top:349px;left:557px;white-space:nowrap" class="ft2417">&#160;are&#160;respectively&#160;the&#160;</p>
<p style="position:absolute;top:368px;left:137px;white-space:nowrap" class="ft2417">basename&#160;and&#160;its&#160;length&#160;used&#160;for&#160;the&#160;signature.&#160;If&#160;the&#160;function&#160;</p>
<p style="position:absolute;top:387px;left:137px;white-space:nowrap" class="ft2428"><b>Tspi_DAA_VerifyInit</b></p>
<p style="position:absolute;top:387px;left:326px;white-space:nowrap" class="ft2417">&#160;previously&#160;called&#160;by&#160;the&#160;server&#160;returned&#160;a&#160;basename,&#160;</p>
<p style="position:absolute;top:407px;left:137px;white-space:nowrap" class="ft2417">then&#160;</p>
<p style="position:absolute;top:407px;left:180px;white-space:nowrap" class="ft2428"><b>verifierBaseName</b></p>
<p style="position:absolute;top:407px;left:339px;white-space:nowrap" class="ft2417">&#160;and&#160;</p>
<p style="position:absolute;top:407px;left:381px;white-space:nowrap" class="ft2428"><b>verifierBaseNameLength</b></p>
<p style="position:absolute;top:407px;left:599px;white-space:nowrap" class="ft2417">&#160;must&#160;be&#160;set&#160;to&#160;</p>
<p style="position:absolute;top:426px;left:137px;white-space:nowrap" class="ft2417">corresponding&#160;values&#160;returned&#160;by&#160;</p>
<p style="position:absolute;top:426px;left:423px;white-space:nowrap" class="ft2428"><b>Tspi_DAA_VerifyInit</b></p>
<p style="position:absolute;top:426px;left:612px;white-space:nowrap" class="ft2417">.&#160;Instead,&#160;if&#160;the&#160;latter&#160;</p>
<p style="position:absolute;top:445px;left:137px;white-space:nowrap" class="ft2417">returned&#160;NULL,&#160;then&#160;</p>
<p style="position:absolute;top:445px;left:311px;white-space:nowrap" class="ft2428"><b>verifierBaseName</b></p>
<p style="position:absolute;top:445px;left:470px;white-space:nowrap" class="ft2417">&#160;and&#160;</p>
<p style="position:absolute;top:445px;left:511px;white-space:nowrap" class="ft2428"><b>verifierBaseNameLength</b></p>
<p style="position:absolute;top:445px;left:730px;white-space:nowrap" class="ft2417">&#160;must&#160;be&#160;</p>
<p style="position:absolute;top:464px;left:137px;white-space:nowrap" class="ft2417">set&#160;respectively&#160;to&#160;NULL&#160;and&#160;0.</p>
<p style="position:absolute;top:497px;left:110px;white-space:nowrap" class="ft2412">●</p>
<p style="position:absolute;top:492px;left:137px;white-space:nowrap" class="ft2428"><b>verifierNonce</b></p>
<p style="position:absolute;top:492px;left:267px;white-space:nowrap" class="ft2417">&#160;and&#160;</p>
<p style="position:absolute;top:492px;left:308px;white-space:nowrap" class="ft2428"><b>verifierNonceLength</b></p>
<p style="position:absolute;top:492px;left:497px;white-space:nowrap" class="ft2417">&#160;are&#160;respectively&#160;the&#160;nonce&#160;and&#160;its&#160;</p>
<p style="position:absolute;top:512px;left:137px;white-space:nowrap" class="ft2419">length&#160;used&#160;for&#160;the&#160;signature&#160;and&#160;must&#160;be&#160;set&#160;to&#160;the&#160;corresponding&#160;values&#160;<br/>returned&#160;by&#160;the&#160;function&#160;</p>
<p style="position:absolute;top:531px;left:345px;white-space:nowrap" class="ft2428"><b>Tspi_DAA_VerifyInit</b></p>
<p style="position:absolute;top:531px;left:534px;white-space:nowrap" class="ft2417">&#160;previously&#160;called&#160;by&#160;the&#160;server.</p>
<p style="position:absolute;top:564px;left:110px;white-space:nowrap" class="ft2412">●</p>
<p style="position:absolute;top:559px;left:137px;white-space:nowrap" class="ft2428"><b>signData</b></p>
<p style="position:absolute;top:559px;left:217px;white-space:nowrap" class="ft2417">&#160;is&#160;the&#160;handle&#160;of&#160;the&#160;object&#160;containing&#160;data&#160;DAA-signed&#160;by&#160;the&#160;client&#160;to&#160;</p>
<p style="position:absolute;top:578px;left:137px;white-space:nowrap" class="ft2417">bind&#160;the&#160;TLS&#160;session&#160;to&#160;the&#160;DAA&#160;authentication.&#160;The&#160;type&#160;of&#160;the&#160;handle&#160;MUST&#160;be&#160;</p>
<p style="position:absolute;top:597px;left:137px;white-space:nowrap" class="ft2428"><b>TSS_HHASH</b></p>
<p style="position:absolute;top:597px;left:227px;white-space:nowrap" class="ft2417">;&#160;this&#160;object&#160;MUST&#160;be&#160;created&#160;by&#160;computing&#160;the&#160;SHA-1&#160;digest&#160;over&#160;the&#160;</p>
<p style="position:absolute;top:617px;left:137px;white-space:nowrap" class="ft2419">TLS&#160;client&#160;certificate&#160;(DER-encoded)&#160;and,&#160;if&#160;present,&#160;additional&#160;data.&#160;The&#160;details&#160;<br/>of&#160;this&#160;calculation&#160;are&#160;specified&#160;in&#160;section&#160;5.3.&#160;</p>
<p style="position:absolute;top:669px;left:110px;white-space:nowrap" class="ft2412">●</p>
<p style="position:absolute;top:664px;left:137px;white-space:nowrap" class="ft2428"><b>daaSignature</b></p>
<p style="position:absolute;top:664px;left:257px;white-space:nowrap" class="ft2417">&#160;is&#160;the&#160;actual&#160;signature&#160;to&#160;be&#160;verified,&#160;received&#160;by&#160;the&#160;client&#160;as&#160;</p>
<p style="position:absolute;top:683px;left:137px;white-space:nowrap" class="ft2428"><b>DAASignature</b></p>
<p style="position:absolute;top:683px;left:257px;white-space:nowrap" class="ft2417">&#160;element&#160;of&#160;the&#160;list&#160;of&#160;</p>
<p style="position:absolute;top:683px;left:439px;white-space:nowrap" class="ft2428"><b>DAAAuthSupplDataEntry&#160;</b></p>
<p style="position:absolute;top:683px;left:658px;white-space:nowrap" class="ft2417">carried&#160;over&#160;the&#160;</p>
<p style="position:absolute;top:702px;left:137px;white-space:nowrap" class="ft2428"><b>SupplementalDataEntry</b></p>
<p style="position:absolute;top:702px;left:346px;white-space:nowrap" class="ft2417">.&#160;The&#160;</p>
<p style="position:absolute;top:702px;left:393px;white-space:nowrap" class="ft2428"><b>DAASignature</b></p>
<p style="position:absolute;top:702px;left:512px;white-space:nowrap" class="ft2416"><b>&#160;</b></p>
<p style="position:absolute;top:702px;left:518px;white-space:nowrap" class="ft2417">MUST&#160;be&#160;decoded&#160;from&#160;DER&#160;</p>
<p style="position:absolute;top:722px;left:137px;white-space:nowrap" class="ft2417">format,&#160;as&#160;detailed&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#25">&#160;6.6.2.1.</a></p>
<p style="position:absolute;top:754px;left:110px;white-space:nowrap" class="ft2412">●</p>
<p style="position:absolute;top:750px;left:137px;white-space:nowrap" class="ft2428"><b>isCorrect</b></p>
<p style="position:absolute;top:750px;left:227px;white-space:nowrap" class="ft2417">&#160;is&#160;the&#160;function&#160;output&#160;and&#160;indicates&#160;if&#160;the&#160;verification&#160;of&#160;the&#160;DAA&#160;</p>
<p style="position:absolute;top:769px;left:137px;white-space:nowrap" class="ft2417">signature&#160;was&#160;successful.</p>
<p style="position:absolute;top:815px;left:83px;white-space:nowrap" class="ft2426"><i><b>6.6&#160;&#160;&#160;Data&#160;encoding/decoding</b></i></p>
<p style="position:absolute;top:865px;left:83px;white-space:nowrap" class="ft2431"><i><b>6.6.1&#160;&#160;&#160;Basic&#160;data&#160;types</b></i></p>
<p style="position:absolute;top:894px;left:83px;white-space:nowrap" class="ft2419">According&#160;to&#160;[2],&#160;Section&#160;4.3.4.29.10,&#160;all&#160;DAA-related&#160;data&#160;structures&#160;used&#160;as&#160;<br/>input/output&#160;to/from&#160;TSS&#160;are&#160;encoded&#160;with&#160;the&#160;big&#160;endian&#160;(or&#160;network&#160;order&#160;byte)&#160;<br/>format,&#160;with&#160;the&#160;Most&#160;Significant&#160;Byte&#160;at&#160;the&#160;far&#160;left&#160;of&#160;a&#160;multi-byte&#160;data&#160;unit&#160;(e.g.&#160;<br/>buffer&#160;or&#160;word)&#160;and&#160;the&#160;Least&#160;Significant&#160;Byte&#160;at&#160;the&#160;far&#160;right.&#160;Since&#160;data&#160;structures&#160;<br/>can&#160;contain&#160;other&#160;embedded&#160;structures&#160;but&#160;are,&#160;at&#160;the&#160;end,&#160;made&#160;up&#160;of&#160;elementary&#160;<br/>data,&#160;also&#160;the&#160;latter&#160;are&#160;encoded&#160;with&#160;the&#160;big&#160;endian&#160;format.<br/>According&#160;to&#160;[3],&#160;Section&#160;4,&#160;all&#160;data&#160;types&#160;defined&#160;using&#160;the&#160;Presentation&#160;Language&#160;for&#160;<br/>TLS&#160;(like&#160;</p>
<p style="position:absolute;top:1038px;left:159px;white-space:nowrap" class="ft2428"><b>DAAAuthExt</b></p>
<p style="position:absolute;top:1038px;left:258px;white-space:nowrap" class="ft2417">&#160;hello&#160;extension&#160;and&#160;supplemental&#160;data&#160;entry)&#160;and&#160;holding&#160;multi-</p>
<p style="position:absolute;top:1057px;left:83px;white-space:nowrap" class="ft2419">byte&#160;values&#160;are&#160;encoded&#160;with&#160;the&#160;big&#160;endian&#160;(or&#160;network&#160;order&#160;byte)&#160;format.<br/>Therefore&#160;converting&#160;elementary&#160;data&#160;as&#160;buffers&#160;or&#160;words&#160;from/to&#160;TSS&#160;encoding&#160;<br/>to/from&#160;TLS&#160;encoding&#160;does&#160;not&#160;require&#160;any&#160;adaptation&#160;of&#160;the&#160;order&#160;byte&#160;but&#160;only,&#160;if&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft2421">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft2421">22/27</p>
</div>
<!-- Page 25 -->
<a name="25"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2532{font-size:17px;font-family:FAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page25-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3025.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft259">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft250">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft2521">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft2521">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft2517">necessary,&#160;the&#160;adjustment&#160;of&#160;the&#160;length&#160;in&#160;bytes.</p>
<p style="position:absolute;top:195px;left:83px;white-space:nowrap" class="ft2531"><i><b>6.6.2&#160;&#160;&#160;Complex&#160;types</b></i></p>
<p style="position:absolute;top:243px;left:83px;white-space:nowrap" class="ft2532"><i><b>6.6.2.1&#160;&#160;&#160;DAA&#160;Signature&#160;(normative)</b></i></p>
<p style="position:absolute;top:267px;left:83px;white-space:nowrap" class="ft2517">The&#160;DAA&#160;Signature,&#160;sent&#160;by&#160;the&#160;server&#160;as&#160;</p>
<p style="position:absolute;top:267px;left:431px;white-space:nowrap" class="ft2528"><b>DAASignature</b></p>
<p style="position:absolute;top:267px;left:550px;white-space:nowrap" class="ft2517">&#160;element&#160;of&#160;the&#160;list&#160;of&#160;</p>
<p style="position:absolute;top:286px;left:83px;white-space:nowrap" class="ft2528"><b>DAAAuthSupplDataEntry</b></p>
<p style="position:absolute;top:286px;left:292px;white-space:nowrap" class="ft2517">&#160;MUST&#160;be&#160;BER-encoded&#160;according&#160;to&#160;the&#160;ASN.1&#160;definition&#160;of&#160;</p>
<p style="position:absolute;top:305px;left:83px;white-space:nowrap" class="ft2519">the&#160;Portable&#160;Data&#160;specified&#160;in&#160;the&#160;following.&#160;This&#160;definition&#160;is&#160;required&#160;in&#160;this&#160;document&#160;<br/>because&#160;in&#160;Section&#160;3.23&#160;of&#160;[2]&#160;there&#160;is&#160;lack&#160;of&#160;Portable&#160;Data&#160;definition&#160;for&#160;DAA&#160;<br/>Signature.<br/>Each&#160;member&#160;of&#160;the&#160;TSS&#160;structure&#160;must&#160;be&#160;individually&#160;re-encoded&#160;to&#160;BER&#160;and&#160;vice-<br/>versa.&#160;If&#160;the&#160;member&#160;is&#160;not&#160;an&#160;elementary&#160;data,&#160;it&#160;MUST&#160;be&#160;recursively&#160;expanded&#160;until&#160;<br/>all&#160;elementary&#160;data&#160;are&#160;exposed:&#160;then&#160;they&#160;can&#160;be&#160;re-encoded&#160;as&#160;the&#160;corresponding&#160;<br/>members&#160;for&#160;the&#160;target&#160;encoding&#160;rules.<br/>With&#160;respect&#160;to&#160;the&#160;DAA&#160;Signature&#160;structure&#160;as&#160;defined&#160;in&#160;Section&#160;3.12&#160;of&#160;[2],&#160;in&#160;the&#160;<br/>following&#160;definition&#160;the&#160;unnecessary&#160;fields&#160;are&#160;not&#160;present&#160;(including&#160;those&#160;related&#160;to&#160;<br/>the&#160;credential&#160;attributes,&#160;which&#160;are&#160;not&#160;supported&#160;in&#160;this&#160;profile):</p>
<p style="position:absolute;top:533px;left:105px;white-space:nowrap" class="ft2530"><b>DaaSignature&#160;::=&#160;SEQUENCE<br/>{</b></p>
<p style="position:absolute;top:572px;left:158px;white-space:nowrap" class="ft2528"><b>versionInfo</b></p>
<p style="position:absolute;top:572px;left:424px;white-space:nowrap" class="ft2528"><b>TssVersion,</b></p>
<p style="position:absolute;top:591px;left:158px;white-space:nowrap" class="ft2528"><b>zeta</b></p>
<p style="position:absolute;top:591px;left:424px;white-space:nowrap" class="ft2528"><b>INTEGER,</b></p>
<p style="position:absolute;top:591px;left:530px;white-space:nowrap" class="ft2528"><b>&#160;&#160;&#160;--&#160;z</b></p>
<p style="position:absolute;top:610px;left:158px;white-space:nowrap" class="ft2528"><b>capitalT</b></p>
<p style="position:absolute;top:610px;left:424px;white-space:nowrap" class="ft2528"><b>INTEGER,</b></p>
<p style="position:absolute;top:610px;left:530px;white-space:nowrap" class="ft2528"><b>&#160;&#160;&#160;--&#160;T</b></p>
<p style="position:absolute;top:629px;left:158px;white-space:nowrap" class="ft2528"><b>challenge</b></p>
<p style="position:absolute;top:629px;left:424px;white-space:nowrap" class="ft2528"><b>INTEGER,&#160;&#160;&#160;&#160;&#160;&#160;--&#160;c</b></p>
<p style="position:absolute;top:648px;left:158px;white-space:nowrap" class="ft2528"><b>nonceTpm</b></p>
<p style="position:absolute;top:648px;left:424px;white-space:nowrap" class="ft2528"><b>INTEGER,&#160;&#160;&#160;&#160;&#160;&#160;--&#160;nT</b></p>
<p style="position:absolute;top:668px;left:158px;white-space:nowrap" class="ft2528"><b>sV</b></p>
<p style="position:absolute;top:668px;left:424px;white-space:nowrap" class="ft2528"><b>INTEGER,</b></p>
<p style="position:absolute;top:668px;left:530px;white-space:nowrap" class="ft2528"><b>&#160;&#160;&#160;--&#160;sV</b></p>
<p style="position:absolute;top:687px;left:158px;white-space:nowrap" class="ft2528"><b>sF0</b></p>
<p style="position:absolute;top:687px;left:424px;white-space:nowrap" class="ft2528"><b>INTEGER,</b></p>
<p style="position:absolute;top:687px;left:530px;white-space:nowrap" class="ft2528"><b>&#160;&#160;&#160;--&#160;sF0</b></p>
<p style="position:absolute;top:706px;left:158px;white-space:nowrap" class="ft2528"><b>sF1</b></p>
<p style="position:absolute;top:706px;left:424px;white-space:nowrap" class="ft2528"><b>INTEGER,</b></p>
<p style="position:absolute;top:706px;left:530px;white-space:nowrap" class="ft2528"><b>&#160;&#160;&#160;--&#160;sF1</b></p>
<p style="position:absolute;top:725px;left:158px;white-space:nowrap" class="ft2528"><b>sE</b></p>
<p style="position:absolute;top:725px;left:424px;white-space:nowrap" class="ft2528"><b>INTEGER,</b></p>
<p style="position:absolute;top:725px;left:530px;white-space:nowrap" class="ft2528"><b>&#160;&#160;&#160;--&#160;sE</b></p>
<p style="position:absolute;top:744px;left:158px;white-space:nowrap" class="ft2528"><b>nonceVerifier</b></p>
<p style="position:absolute;top:744px;left:424px;white-space:nowrap" class="ft2528"><b>INTEGER,</b></p>
<p style="position:absolute;top:744px;left:530px;white-space:nowrap" class="ft2528"><b>&#160;&#160;&#160;--&#160;nV</b></p>
<p style="position:absolute;top:764px;left:105px;white-space:nowrap" class="ft2528"><b>}</b></p>
<p style="position:absolute;top:810px;left:105px;white-space:nowrap" class="ft2530"><b>TssVersion&#160;::=&#160;SEQUENCE<br/>{</b></p>
<p style="position:absolute;top:848px;left:158px;white-space:nowrap" class="ft2528"><b>major</b></p>
<p style="position:absolute;top:848px;left:424px;white-space:nowrap" class="ft2528"><b>INTEGER,</b></p>
<p style="position:absolute;top:848px;left:530px;white-space:nowrap" class="ft2528"><b>&#160;&#160;&#160;&#160;</b></p>
<p style="position:absolute;top:867px;left:158px;white-space:nowrap" class="ft2528"><b>minor</b></p>
<p style="position:absolute;top:867px;left:424px;white-space:nowrap" class="ft2528"><b>INTEGER,</b></p>
<p style="position:absolute;top:867px;left:530px;white-space:nowrap" class="ft2528"><b>&#160;&#160;&#160;</b></p>
<p style="position:absolute;top:886px;left:158px;white-space:nowrap" class="ft2528"><b>revMajor</b></p>
<p style="position:absolute;top:886px;left:424px;white-space:nowrap" class="ft2528"><b>INTEGER,</b></p>
<p style="position:absolute;top:886px;left:530px;white-space:nowrap" class="ft2528"><b>&#160;&#160;&#160;&#160;</b></p>
<p style="position:absolute;top:906px;left:158px;white-space:nowrap" class="ft2528"><b>revMinor</b></p>
<p style="position:absolute;top:906px;left:424px;white-space:nowrap" class="ft2528"><b>INTEGER&#160;&#160;&#160;</b></p>
<p style="position:absolute;top:925px;left:105px;white-space:nowrap" class="ft2528"><b>}</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft2521">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft2521">23/27</p>
</div>
<!-- Page 26 -->
<a name="26"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page26-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3026.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft269">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft260">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft2621">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft2621">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft2624"><b>7&#160;&#160;&#160;Security&#160;considerations</b></p>
<p style="position:absolute;top:218px;left:83px;white-space:nowrap" class="ft2626"><i><b>7.1&#160;&#160;&#160;Endorsement&#160;Key&#160;(EK)&#160;exposure</b></i></p>
<p style="position:absolute;top:250px;left:83px;white-space:nowrap" class="ft2619">TCG&#160;design&#160;([1,2])&#160;of&#160;DAA&#160;protocol&#160;gives&#160;the&#160;verifier&#160;assurance&#160;about&#160;the&#160;genuineness&#160;<br/>of&#160;the&#160;TPM&#160;making&#160;DAA&#160;signatures.&#160;By&#160;issuing&#160;the&#160;DAA&#160;credentials,&#160;the&#160;issuer&#160;<br/>guarantees&#160;that&#160;the&#160;TPM&#160;is&#160;genuine.<br/>To&#160;enforce&#160;this&#160;behavior,&#160;once&#160;the&#160;issuer&#160;verified&#160;the&#160;credentials&#160;(e.g.&#160;EK&#160;certificate)&#160;<br/>provided&#160;by&#160;the&#160;platform&#160;requesting&#160;a&#160;DAA&#160;credential,&#160;the&#160;issuer&#160;creates&#160;the&#160;latter&#160;and&#160;<br/>encrypts&#160;it&#160;with&#160;the&#160;public&#160;part&#160;of&#160;the&#160;Endorsement&#160;Key&#160;(EK)&#160;of&#160;the&#160;TPM&#160;requesting&#160;the&#160;<br/>credential.&#160;This&#160;procedure&#160;guarantees&#160;that&#160;only&#160;the&#160;TPM&#160;owning&#160;the&#160;private&#160;part&#160;of&#160;the&#160;<br/>Endorsement&#160;Key&#160;can&#160;decrypt,&#160;install&#160;and&#160;use&#160;the&#160;received&#160;DAA&#160;credential.<br/>This&#160;procedure&#160;has&#160;the&#160;drawback&#160;that&#160;the&#160;issuer&#160;gets&#160;to&#160;know&#160;the&#160;public&#160;part&#160;of&#160;the&#160;EK:&#160;<br/>being&#160;unique&#160;to&#160;every&#160;TPM,&#160;the&#160;EK&#160;can&#160;be&#160;used&#160;as&#160;a&#160;identifier&#160;to&#160;track&#160;TPM&#160;operations&#160;<br/>that&#160;involve&#160;the&#160;EK&#160;(i.e.&#160;requesting&#160;other&#160;DAA&#160;credentials&#160;or&#160;an&#160;AIK&#160;certificate).&#160;For&#160;this&#160;<br/>reason,&#160;the&#160;issuer&#160;must&#160;be&#160;a&#160;trusted&#160;third&#160;party&#160;that&#160;guarantees&#160;to&#160;the&#160;verifier&#160;that&#160;the&#160;<br/>genuineness&#160;of&#160;the&#160;TPM&#160;is&#160;checked&#160;and&#160;to&#160;the&#160;platform&#160;the&#160;sensitive&#160;data&#160;(i.e.&#160;the&#160;<br/>public&#160;part&#160;of&#160;the&#160;EK)&#160;are&#160;kept&#160;secure.<br/>While&#160;this&#160;is&#160;not&#160;a&#160;problem&#160;in&#160;the&#160;reference&#160;scenario&#160;(where&#160;the&#160;company&#160;is&#160;the&#160;<br/>issuer),&#160;it&#160;may&#160;become&#160;a&#160;problem&#160;in&#160;more&#160;open&#160;scenarios;&#160;in&#160;these&#160;latter&#160;cases,&#160;the&#160;<br/>platform&#160;must&#160;carefully&#160;choose&#160;the&#160;DAA&#160;issuer.</p>
<p style="position:absolute;top:630px;left:83px;white-space:nowrap" class="ft2626"><i><b>7.2&#160;&#160;&#160;Basename&#160;and&#160;DAA&#160;signature</b></i></p>
<p style="position:absolute;top:662px;left:83px;white-space:nowrap" class="ft2619">In&#160;some&#160;scenarios,&#160;the&#160;basename&#160;or&#160;the&#160;DAA&#160;signature&#160;may&#160;be&#160;considered&#160;sensitive&#160;<br/>data.&#160;For&#160;instance,&#160;a&#160;man&#160;in&#160;the&#160;middle&#160;can&#160;forge&#160;the&#160;basename&#160;by&#160;modifying&#160;the&#160;<br/>server&#160;hello&#160;message.&#160;In&#160;this&#160;case&#160;it&#160;can&#160;persuade&#160;the&#160;client&#160;to&#160;make&#160;a&#160;DAA&#160;signature&#160;<br/>over&#160;a&#160;chosen&#160;basename.&#160;If&#160;the&#160;basename&#160;was&#160;chosen&#160;to&#160;be&#160;fixed,&#160;it&#160;is&#160;possible&#160;for&#160;the&#160;<br/>attacker&#160;to&#160;track&#160;successive&#160;DAA&#160;signatures&#160;of&#160;the&#160;same&#160;platform&#160;over&#160;the&#160;same&#160;<br/>basename.<br/>The&#160;TLS&#160;protocol&#160;allows&#160;both&#160;the&#160;client&#160;and&#160;the&#160;server&#160;to&#160;detect&#160;the&#160;attack,&#160;but&#160;only&#160;<br/>after&#160;the&#160;DAA&#160;signature&#160;was&#160;made.&#160;This&#160;attack&#160;can&#160;be&#160;detected&#160;when&#160;the&#160;finished&#160;<br/>messages&#160;are&#160;exchanged:&#160;these&#160;messages&#160;contain&#160;the&#160;hash&#160;of&#160;all&#160;the&#160;messages&#160;<br/>exchanged&#160;during&#160;the&#160;handshake;&#160;if&#160;the&#160;attacker&#160;modified&#160;the&#160;server&#160;hello,&#160;the&#160;server&#160;<br/>will&#160;compute&#160;a&#160;hash&#160;different&#160;from&#160;the&#160;hash&#160;computed&#160;by&#160;the&#160;client,&#160;leading&#160;to&#160;the&#160;<br/>discover&#160;of&#160;the&#160;attack.<br/>Furthermore,&#160;by&#160;listening&#160;to&#160;the&#160;channel&#160;in&#160;the&#160;case&#160;of&#160;a&#160;pseudonymous&#160;<br/>authentication,&#160;an&#160;eavesdropper&#160;could&#160;be&#160;able&#160;to&#160;link&#160;together&#160;different&#160;DAA&#160;<br/>signatures&#160;generated&#160;by&#160;the&#160;same&#160;platform.&#160;Listening&#160;on&#160;the&#160;channel&#160;leads&#160;the&#160;<br/>attacker&#160;to&#160;know&#160;both&#160;the&#160;basename&#160;and&#160;the&#160;DAA&#160;signature;&#160;in&#160;the&#160;case&#160;of&#160;<br/>pseudonymity,&#160;these&#160;two&#160;data&#160;are&#160;enough&#160;to&#160;link&#160;different&#160;signatures&#160;made&#160;by&#160;the&#160;<br/>same&#160;platform.&#160;Differently&#160;from&#160;the&#160;previous&#160;attack,&#160;this&#160;attack&#160;can&#160;not&#160;be&#160;detected&#160;by&#160;<br/>the&#160;client&#160;nor&#160;the&#160;server&#160;and,&#160;hence,&#160;it&#160;puts&#160;at&#160;risk&#160;the&#160;privacy&#160;of&#160;the&#160;client.<br/>For&#160;these&#160;reasons&#160;in&#160;some&#160;scenarios,&#160;the&#160;data&#160;exchanged&#160;within&#160;the&#160;supplemental&#160;<br/>data&#160;message&#160;must&#160;be&#160;protected.&#160;[5]&#160;asserts&#160;that&#160;such&#160;protection&#160;must&#160;be&#160;provided&#160;<br/>through&#160;the&#160;use&#160;of&#160;a&#160;double&#160;handshake.&#160;The&#160;first&#160;handshake&#160;is&#160;a&#160;regular&#160;one&#160;that&#160;only&#160;<br/>aims&#160;to&#160;the&#160;creation&#160;of&#160;a&#160;secure&#160;channel.&#160;Next,&#160;within&#160;the&#160;secure&#160;channel&#160;a&#160;second&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft2621">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft2621">24/27</p>
</div>
<!-- Page 27 -->
<a name="27"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page27-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3027.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft279">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft270">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft2721">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft2721">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft2719">handshake&#160;happens;&#160;this&#160;latter&#160;handshake&#160;actually&#160;carries&#160;the&#160;hello&#160;extensions&#160;and&#160;the&#160;<br/>supplemental&#160;data&#160;necessary&#160;for&#160;the&#160;anonymous&#160;authentication.<br/>Note&#160;that&#160;in&#160;the&#160;case&#160;of&#160;a&#160;double&#160;handshake,&#160;the&#160;first&#160;handshake&#160;must&#160;be&#160;done&#160;in&#160;a&#160;<br/>way&#160;that&#160;exposes&#160;no&#160;information&#160;about&#160;the&#160;peer&#160;that&#160;must&#160;be&#160;authenticated&#160;<br/>anonymously&#160;using&#160;the&#160;DAA&#160;during&#160;the&#160;second&#160;handshake.</p>
<p style="position:absolute;top:281px;left:83px;white-space:nowrap" class="ft2724"><b>8&#160;&#160;&#160;IANA&#160;considerations</b></p>
<p style="position:absolute;top:314px;left:83px;white-space:nowrap" class="ft2719">The&#160;hello&#160;extensions&#160;and&#160;the&#160;supplemental&#160;data&#160;entries&#160;are&#160;defined&#160;by&#160;their&#160;types.&#160;The&#160;<br/>hello&#160;extensions&#160;types&#160;MUST&#160;be&#160;assigned&#160;by&#160;the&#160;IANA&#160;through&#160;a&#160;IETF&#160;consensus&#160;<br/>procedure,&#160;while&#160;the&#160;supplemental&#160;data&#160;specification&#160;allows&#160;the&#160;use&#160;of&#160;private&#160;types&#160;<br/>for&#160;the&#160;supplemental&#160;data&#160;entries.<br/>Because&#160;each&#160;supplemental&#160;data&#160;entry&#160;MUST&#160;be&#160;negotiated&#160;using&#160;the&#160;hello&#160;extensions&#160;<br/>mechanism,&#160;it&#160;is&#160;not&#160;actually&#160;possible&#160;to&#160;use&#160;the&#160;private&#160;types&#160;for&#160;the&#160;supplemental&#160;<br/>data&#160;entry&#160;defined&#160;in&#160;this&#160;document.<br/>For&#160;this&#160;reason&#160;this&#160;document&#160;does&#160;not&#160;defines&#160;the&#160;types&#160;of&#160;the&#160;hello&#160;extension&#160;nor&#160;the&#160;<br/>type&#160;of&#160;the&#160;supplemental&#160;data&#160;entry.</p>
<p style="position:absolute;top:532px;left:83px;white-space:nowrap" class="ft2724"><b>9&#160;&#160;&#160;Final&#160;considerations&#160;(IPsec&#160;and&#160;IKE/ISAKMP)</b></p>
<p style="position:absolute;top:565px;left:83px;white-space:nowrap" class="ft2719">The&#160;IKE/ISAKMP&#160;protocols&#160;are&#160;part&#160;of&#160;the&#160;IPsec&#160;protocols&#160;family&#160;and&#160;are&#160;used&#160;to&#160;<br/>authenticate&#160;the&#160;peers,&#160;to&#160;negotiate&#160;the&#160;security&#160;services&#160;and&#160;the&#160;keys.<br/>As&#160;for&#160;TLS&#160;protocol,&#160;DAA&#160;can&#160;be&#160;used&#160;to&#160;enhance&#160;the&#160;Internet&#160;Key&#160;Exchange&#160;protocol&#160;<br/>(IKEv1/ISAKMP&#160;and&#160;IKEv2)&#160;to&#160;add&#160;a&#160;group&#160;authentication&#160;scheme&#160;to&#160;preserve&#160;the&#160;<br/>platform&#160;privacy&#160;while&#160;using&#160;the&#160;security&#160;protocols&#160;of&#160;the&#160;IPsec&#160;family.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft2721">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft2721">25/27</p>
</div>
<!-- Page 28 -->
<a name="28"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page28-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3028.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft289">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft280">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft2821">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft2821">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft2824"><b>10&#160;&#160;&#160;List&#160;of&#160;abbreviations</b></p>
<p style="position:absolute;top:200px;left:83px;white-space:nowrap" class="ft2819">Listing&#160;of&#160;term&#160;definitions&#160;and&#160;abbreviations&#160;used&#160;in&#160;this&#160;document&#160;(IT&#160;expressions&#160;and&#160;<br/>terms&#160;from&#160;the&#160;application&#160;domain).</p>
<p style="position:absolute;top:258px;left:93px;white-space:nowrap" class="ft2816"><b>Abbreviation</b></p>
<p style="position:absolute;top:258px;left:301px;white-space:nowrap" class="ft2816"><b>Explanation</b></p>
<p style="position:absolute;top:277px;left:93px;white-space:nowrap" class="ft2817">AIK</p>
<p style="position:absolute;top:277px;left:301px;white-space:nowrap" class="ft2817">Attestation&#160;Identity&#160;Key</p>
<p style="position:absolute;top:297px;left:93px;white-space:nowrap" class="ft2817">ARA</p>
<p style="position:absolute;top:297px;left:301px;white-space:nowrap" class="ft2817">Anonymity&#160;Revocation&#160;Authority</p>
<p style="position:absolute;top:316px;left:93px;white-space:nowrap" class="ft2817">ASN.1</p>
<p style="position:absolute;top:316px;left:301px;white-space:nowrap" class="ft2817">Abstract&#160;Syntax&#160;Notation&#160;1</p>
<p style="position:absolute;top:335px;left:93px;white-space:nowrap" class="ft2817">BER</p>
<p style="position:absolute;top:335px;left:301px;white-space:nowrap" class="ft2817">Basic&#160;Encoding&#160;Rules</p>
<p style="position:absolute;top:354px;left:93px;white-space:nowrap" class="ft2817">CA</p>
<p style="position:absolute;top:354px;left:301px;white-space:nowrap" class="ft2817">Certification&#160;Authority</p>
<p style="position:absolute;top:374px;left:93px;white-space:nowrap" class="ft2817">DAA</p>
<p style="position:absolute;top:374px;left:301px;white-space:nowrap" class="ft2817">Direct&#160;Anonymous&#160;Attestation</p>
<p style="position:absolute;top:393px;left:93px;white-space:nowrap" class="ft2817">DER</p>
<p style="position:absolute;top:393px;left:301px;white-space:nowrap" class="ft2817">Distinguished&#160;Encoding&#160;Rules</p>
<p style="position:absolute;top:412px;left:93px;white-space:nowrap" class="ft2817">EK</p>
<p style="position:absolute;top:412px;left:301px;white-space:nowrap" class="ft2817">Endorsement&#160;Key</p>
<p style="position:absolute;top:432px;left:93px;white-space:nowrap" class="ft2817">PCA</p>
<p style="position:absolute;top:432px;left:301px;white-space:nowrap" class="ft2817">Privacy&#160;CA</p>
<p style="position:absolute;top:451px;left:93px;white-space:nowrap" class="ft2817">SHA-1</p>
<p style="position:absolute;top:451px;left:301px;white-space:nowrap" class="ft2817">Secure&#160;Hash&#160;Algorithm&#160;1</p>
<p style="position:absolute;top:470px;left:93px;white-space:nowrap" class="ft2817">TCG</p>
<p style="position:absolute;top:470px;left:301px;white-space:nowrap" class="ft2817">Trusted&#160;Computing&#160;Group</p>
<p style="position:absolute;top:489px;left:93px;white-space:nowrap" class="ft2817">TLS</p>
<p style="position:absolute;top:489px;left:301px;white-space:nowrap" class="ft2817">Transport&#160;Layer&#160;Security</p>
<p style="position:absolute;top:509px;left:93px;white-space:nowrap" class="ft2817">TPM</p>
<p style="position:absolute;top:509px;left:301px;white-space:nowrap" class="ft2817">Trusted&#160;Platform&#160;Module</p>
<p style="position:absolute;top:528px;left:93px;white-space:nowrap" class="ft2817">TSS</p>
<p style="position:absolute;top:528px;left:301px;white-space:nowrap" class="ft2817">TCG&#160;Software&#160;Stack</p>
<p style="position:absolute;top:593px;left:83px;white-space:nowrap" class="ft2824"><b>11&#160;&#160;&#160;Referenced&#160;Documents</b></p>
<p style="position:absolute;top:627px;left:83px;white-space:nowrap" class="ft2819">/1/&#160;TCG&#160;TPM&#160;Main&#160;Specification&#160;(parts&#160;1,2,3)<br/>July&#160;9,&#160;2007,<br/>Version&#160;1.2&#160;Level&#160;2&#160;Revision&#160;103</p>
<p style="position:absolute;top:703px;left:83px;white-space:nowrap" class="ft2819">/2/&#160;TCG&#160;Software&#160;Stack&#160;(TSS)&#160;Specification<br/>March&#160;7,&#160;2007,&#160;<br/>Version&#160;1.2,&#160;Level&#160;1,&#160;Errata&#160;A</p>
<p style="position:absolute;top:780px;left:83px;white-space:nowrap" class="ft2819">/3/&#160;IETF&#160;RFC&#160;4346,&#160;The&#160;Transport&#160;Layer&#160;Security&#160;(TLS)&#160;Protocol&#160;Version&#160;1.1<br/>April,&#160;2006</p>
<p style="position:absolute;top:838px;left:83px;white-space:nowrap" class="ft2819">/4/&#160;IETF&#160;RFC&#160;4366,&#160;Transport&#160;Layer&#160;Security&#160;(TLS)&#160;Extensions<br/>April,&#160;2006</p>
<p style="position:absolute;top:895px;left:83px;white-space:nowrap" class="ft2819">/5/&#160;IETF&#160;RFC&#160;4680,&#160;TLS&#160;Handshake&#160;Message&#160;for&#160;Supplemental&#160;Data<br/>September,&#160;2006</p>
<p style="position:absolute;top:953px;left:83px;white-space:nowrap" class="ft2819">/6/&#160;Direct&#160;Anonymous&#160;Attestation<br/>Ernie&#160;Brickell,&#160;Jan&#160;Camenisch,&#160;Liqun&#160;Chen<br/>CCS&#160;'04:&#160;11th&#160;ACM&#160;conference&#160;on&#160;Computer&#160;and&#160;Communications&#160;Security<br/>2004</p>
<p style="position:absolute;top:1049px;left:83px;white-space:nowrap" class="ft2819">/7/&#160;ITU-T&#160;Rec.&#160;X.208,&#160;Specification&#160;of&#160;Abstract&#160;Syntax&#160;Notation&#160;One&#160;(ASN.1)<br/>1988</p>
<p style="position:absolute;top:1107px;left:83px;white-space:nowrap" class="ft2817">/8/&#160;ITU-T&#160;Recommendation&#160;X.690,&#160;Information&#160;Technology&#160;–&#160;ASN.1&#160;encoding&#160;rules:&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft2821">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft2821">26/27</p>
</div>
<!-- Page 29 -->
<a name="29"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page29-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3029.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft299">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft290">&#160;</p>
<p style="position:absolute;top:92px;left:271px;white-space:nowrap" class="ft2921">SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft2921">FINAL&#160;|&#160;1.20</p>
<p style="position:absolute;top:149px;left:105px;white-space:nowrap" class="ft2919">Specification&#160;of&#160;Basic&#160;Encoding&#160;Rules&#160;(BER),&#160;Canonical&#160;Encoding&#160;Rules&#160;(CER)&#160;and&#160;<br/>Distinguished&#160;Encoding&#160;Rules&#160;(DER)</p>
<p style="position:absolute;top:188px;left:83px;white-space:nowrap" class="ft2917">1997</p>
<p style="position:absolute;top:226px;left:83px;white-space:nowrap" class="ft2917">/9/&#160;ITU-T&#160;Recommendation&#160;X.509,&#160;Information&#160;technology&#160;–&#160;Open&#160;Systems&#160;</p>
<p style="position:absolute;top:245px;left:105px;white-space:nowrap" class="ft2917">Interconnection&#160;–&#160;The&#160;Directory:&#160;Public-key&#160;and&#160;attribute&#160;certificate&#160;frameworks</p>
<p style="position:absolute;top:284px;left:83px;white-space:nowrap" class="ft2919">/10/&#160;IETF&#160;RFC&#160;3174,&#160;US&#160;Secure&#160;Hash&#160;Algorithm&#160;1&#160;(SHA1)<br/>September,&#160;2001</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft2921">Open_TC&#160;Deliverable&#160;03c.3</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft2921">27/27</p>
</div>
<!-- Page 30 -->
<a name="30"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page30-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3030.png" alt="background image"/>
<p style="position:absolute;top:137px;left:92px;white-space:nowrap" class="ft300">&#160;</p>
<p style="position:absolute;top:76px;left:91px;white-space:nowrap" class="ft301">&#160;</p>
<p style="position:absolute;top:242px;left:120px;white-space:nowrap" class="ft3015"><b>D03c.6&#160;OpenSSL&#160;engine/DAA&#160;enhancement&#160;</b></p>
<p style="position:absolute;top:273px;left:294px;white-space:nowrap" class="ft3015"><b>design&#160;specification</b></p>
<p style="position:absolute;top:351px;left:91px;white-space:nowrap" class="ft3016"><b>Project&#160;number</b></p>
<p style="position:absolute;top:351px;left:425px;white-space:nowrap" class="ft3017">IST-027635</p>
<p style="position:absolute;top:376px;left:91px;white-space:nowrap" class="ft3016"><b>Project&#160;acronym</b></p>
<p style="position:absolute;top:376px;left:425px;white-space:nowrap" class="ft3017">Open_TC</p>
<p style="position:absolute;top:402px;left:91px;white-space:nowrap" class="ft3016"><b>Project&#160;title</b></p>
<p style="position:absolute;top:402px;left:425px;white-space:nowrap" class="ft3017">Open&#160;Trusted&#160;Computing</p>
<p style="position:absolute;top:427px;left:91px;white-space:nowrap" class="ft3016"><b>Deliverable&#160;type</b></p>
<p style="position:absolute;top:427px;left:425px;white-space:nowrap" class="ft3017">Internal&#160;deliverable</p>
<p style="position:absolute;top:470px;left:91px;white-space:nowrap" class="ft3016"><b>Deliverable&#160;reference&#160;number</b></p>
<p style="position:absolute;top:470px;left:425px;white-space:nowrap" class="ft3017">IST-027635/D03c.6/FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:502px;left:91px;white-space:nowrap" class="ft3016"><b>Deliverable&#160;title</b></p>
<p style="position:absolute;top:493px;left:425px;white-space:nowrap" class="ft3019">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;<br/>specification</p>
<p style="position:absolute;top:534px;left:91px;white-space:nowrap" class="ft3016"><b>WP&#160;contributing&#160;to&#160;the&#160;deliverable</b></p>
<p style="position:absolute;top:534px;left:425px;white-space:nowrap" class="ft3017">WP03c</p>
<p style="position:absolute;top:560px;left:91px;white-space:nowrap" class="ft3016"><b>Due&#160;date</b></p>
<p style="position:absolute;top:560px;left:425px;white-space:nowrap" class="ft3017">Oct&#160;2007&#160;-&#160;M24</p>
<p style="position:absolute;top:585px;left:91px;white-space:nowrap" class="ft3016"><b>Actual&#160;submission&#160;date</b></p>
<p style="position:absolute;top:585px;left:425px;white-space:nowrap" class="ft3017">May&#160;15,&#160;2009&#160;(major&#160;revision)</p>
<p style="position:absolute;top:628px;left:91px;white-space:nowrap" class="ft3016"><b>Responsible&#160;Organisation</b></p>
<p style="position:absolute;top:628px;left:424px;white-space:nowrap" class="ft3017">POL</p>
<p style="position:absolute;top:660px;left:91px;white-space:nowrap" class="ft3016"><b>Authors</b></p>
<p style="position:absolute;top:651px;left:424px;white-space:nowrap" class="ft3019">Emanuele&#160;Cesena,&#160;Davide&#160;Vernizzi,&#160;Gianluca&#160;<br/>Ramunno</p>
<p style="position:absolute;top:689px;left:91px;white-space:nowrap" class="ft3016"><b>Abstract</b></p>
<p style="position:absolute;top:689px;left:424px;white-space:nowrap" class="ft3019">This&#160;deliverable&#160;describes&#160;which&#160;<br/>modifications&#160;must&#160;be&#160;done&#160;to&#160;OpenSSL&#160;in&#160;<br/>order&#160;to&#160;support&#160;the&#160;anonymous&#160;<br/>authentication&#160;made&#160;through&#160;the&#160;DAA&#160;<br/>protocol.</p>
<p style="position:absolute;top:905px;left:91px;white-space:nowrap" class="ft3016"><b>Keywords</b></p>
<p style="position:absolute;top:905px;left:424px;white-space:nowrap" class="ft3017">OPEN_TC,&#160;TPM,&#160;TLS,&#160;OpenSSL,&#160;DAA</p>
<p style="position:absolute;top:948px;left:92px;white-space:nowrap" class="ft3016"><b>Dissemination&#160;level</b></p>
<p style="position:absolute;top:948px;left:423px;white-space:nowrap" class="ft3017">Public</p>
<p style="position:absolute;top:973px;left:92px;white-space:nowrap" class="ft3016"><b>Revision</b></p>
<p style="position:absolute;top:973px;left:423px;white-space:nowrap" class="ft3017">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:1025px;left:90px;white-space:nowrap" class="ft3016"><b>Instrument</b></p>
<p style="position:absolute;top:1025px;left:271px;white-space:nowrap" class="ft3017">IP</p>
<p style="position:absolute;top:1015px;left:452px;white-space:nowrap" class="ft3020"><b>Start&#160;date&#160;of&#160;the&#160;<br/>project</b></p>
<p style="position:absolute;top:1025px;left:633px;white-space:nowrap" class="ft3017">1</p>
<p style="position:absolute;top:1025px;left:643px;white-space:nowrap" class="ft3018">st</p>
<p style="position:absolute;top:1025px;left:652px;white-space:nowrap" class="ft3017">&#160;November&#160;2005</p>
<p style="position:absolute;top:1053px;left:90px;white-space:nowrap" class="ft3016"><b>Thematic&#160;Priority</b></p>
<p style="position:absolute;top:1053px;left:271px;white-space:nowrap" class="ft3017">IST</p>
<p style="position:absolute;top:1053px;left:452px;white-space:nowrap" class="ft3016"><b>Duration</b></p>
<p style="position:absolute;top:1053px;left:633px;white-space:nowrap" class="ft3017">42&#160;months</p>
<p style="position:absolute;top:75px;left:674px;white-space:nowrap" class="ft306">&#160;</p>
</div>
<!-- Page 31 -->
<a name="31"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page31-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3031.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft319">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft310">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft3121">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft3121">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft3122"><b>Table&#160;of&#160;Contents</b></p>
<p style="position:absolute;top:204px;left:83px;white-space:nowrap" class="ft3123">1&#160;&#160;Introduction.................................................................................................................5<br/>2&#160;&#160;Architecture&#160;overview.................................................................................................5<br/>3&#160;&#160;TLS&#160;Hello&#160;Extensions&#160;and&#160;Supplemental&#160;Data.............................................................8</p>
<p style="position:absolute;top:270px;left:92px;white-space:nowrap" class="ft3117">3.1&#160;&#160;Architecture............................................................................................................8</p>
<p style="position:absolute;top:289px;left:101px;white-space:nowrap" class="ft3119">3.1.1&#160;&#160;Overview............................................................................................................8<br/>3.1.2&#160;&#160;Data&#160;Structures................................................................................................10<br/>3.1.3&#160;&#160;Workflow..........................................................................................................11</p>
<p style="position:absolute;top:347px;left:92px;white-space:nowrap" class="ft3117">3.2&#160;&#160;Application&#160;Programming&#160;Interface......................................................................13</p>
<p style="position:absolute;top:366px;left:101px;white-space:nowrap" class="ft3119">3.2.1&#160;&#160;Interface..........................................................................................................13<br/>3.2.2&#160;&#160;Application&#160;Interface........................................................................................19</p>
<p style="position:absolute;top:405px;left:92px;white-space:nowrap" class="ft3117">3.3&#160;&#160;Examples..............................................................................................................20</p>
<p style="position:absolute;top:424px;left:101px;white-space:nowrap" class="ft3119">3.3.1&#160;&#160;Hello&#160;World!.....................................................................................................20<br/>3.3.2&#160;&#160;Supplemental&#160;Data..........................................................................................22</p>
<p style="position:absolute;top:466px;left:83px;white-space:nowrap" class="ft3117">4&#160;&#160;Direct&#160;Anonymous&#160;Attestation..................................................................................24</p>
<p style="position:absolute;top:486px;left:92px;white-space:nowrap" class="ft3117">4.1&#160;&#160;Architecture..........................................................................................................24</p>
<p style="position:absolute;top:505px;left:101px;white-space:nowrap" class="ft3119">4.1.1&#160;&#160;Overview..........................................................................................................24<br/>4.1.2&#160;&#160;Data&#160;Structures................................................................................................25<br/>4.1.3&#160;&#160;Workflow..........................................................................................................27</p>
<p style="position:absolute;top:562px;left:92px;white-space:nowrap" class="ft3117">4.2&#160;&#160;Application&#160;Programming&#160;Interface......................................................................29</p>
<p style="position:absolute;top:582px;left:101px;white-space:nowrap" class="ft3117">4.2.1&#160;&#160;Application&#160;Interface........................................................................................29</p>
<p style="position:absolute;top:601px;left:92px;white-space:nowrap" class="ft3117">4.3&#160;&#160;Examples..............................................................................................................32</p>
<p style="position:absolute;top:624px;left:83px;white-space:nowrap" class="ft3117">5&#160;&#160;TLS&#160;DAA-Enhancement.............................................................................................33</p>
<p style="position:absolute;top:643px;left:92px;white-space:nowrap" class="ft3117">5.1&#160;&#160;Architecture..........................................................................................................33</p>
<p style="position:absolute;top:663px;left:101px;white-space:nowrap" class="ft3119">5.1.1&#160;&#160;Overview..........................................................................................................33<br/>5.1.2&#160;&#160;Data&#160;Structures................................................................................................34<br/>5.1.3&#160;&#160;Implementation&#160;Details....................................................................................34</p>
<p style="position:absolute;top:720px;left:109px;white-space:nowrap" class="ft3117">5.1.3.1&#160;&#160;Core.............................................................................................................34</p>
<p style="position:absolute;top:739px;left:101px;white-space:nowrap" class="ft3119">5.1.4&#160;&#160;Workflow..........................................................................................................35<br/>5.1.5&#160;&#160;Other&#160;Features.................................................................................................37</p>
<p style="position:absolute;top:778px;left:109px;white-space:nowrap" class="ft3119">5.1.5.1&#160;&#160;Support&#160;to&#160;TLS&#160;Sessions&#160;Resumption..........................................................37<br/>5.1.5.2&#160;&#160;Legacy&#160;Mode...............................................................................................37</p>
<p style="position:absolute;top:816px;left:92px;white-space:nowrap" class="ft3117">5.2&#160;&#160;Application&#160;Programming&#160;Interface......................................................................38</p>
<p style="position:absolute;top:835px;left:101px;white-space:nowrap" class="ft3117">5.2.1&#160;&#160;Application&#160;Interface........................................................................................38</p>
<p style="position:absolute;top:855px;left:92px;white-space:nowrap" class="ft3117">5.3&#160;&#160;Example...............................................................................................................39</p>
<p style="position:absolute;top:874px;left:101px;white-space:nowrap" class="ft3119">5.3.1&#160;&#160;Common&#160;Modifications.....................................................................................39<br/>5.3.2&#160;&#160;Modifications&#160;on&#160;the&#160;Client..............................................................................40<br/>5.3.3&#160;&#160;Modifications&#160;on&#160;the&#160;Server.............................................................................40<br/>5.3.4&#160;&#160;Running&#160;the&#160;commands...................................................................................41</p>
<p style="position:absolute;top:955px;left:83px;white-space:nowrap" class="ft3117">6&#160;&#160;Implementation&#160;of&#160;the&#160;Specification&#160;of&#160;TCG&#160;TSS/TPM&#160;DAA&#160;Profile&#160;for&#160;DAA-TLS.........42</p>
<p style="position:absolute;top:974px;left:92px;white-space:nowrap" class="ft3117">6.1&#160;&#160;Architecture..........................................................................................................42</p>
<p style="position:absolute;top:993px;left:101px;white-space:nowrap" class="ft3119">6.1.1&#160;&#160;Overview..........................................................................................................42<br/>6.1.2&#160;&#160;Implementation&#160;Details....................................................................................43</p>
<p style="position:absolute;top:1032px;left:109px;white-space:nowrap" class="ft3117">6.1.2.1&#160;&#160;DAA_METHOD..............................................................................................44</p>
<p style="position:absolute;top:1051px;left:101px;white-space:nowrap" class="ft3117">6.1.3&#160;&#160;Workflow..........................................................................................................46</p>
<p style="position:absolute;top:1070px;left:92px;white-space:nowrap" class="ft3117">6.2&#160;&#160;Examples..............................................................................................................48</p>
<p style="position:absolute;top:1094px;left:83px;white-space:nowrap" class="ft3123">7&#160;&#160;List&#160;of&#160;abbreviations..................................................................................................49<br/>8&#160;&#160;Referenced&#160;Documents.............................................................................................49</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft3121">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft3121">2/61</p>
</div>
<!-- Page 32 -->
<a name="32"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page32-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3032.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft329">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft320">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft3221">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft3221">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft3217">9&#160;&#160;Appendix.&#160;Code&#160;Documentation................................................................................51</p>
<p style="position:absolute;top:168px;left:92px;white-space:nowrap" class="ft3217">9.1&#160;&#160;General&#160;TLS&#160;Extensions&#160;framework......................................................................51</p>
<p style="position:absolute;top:188px;left:101px;white-space:nowrap" class="ft3219">9.1.1&#160;&#160;Patch................................................................................................................51<br/>9.1.2&#160;&#160;Core.................................................................................................................53<br/>9.1.3&#160;&#160;Interface..........................................................................................................54<br/>9.1.4&#160;&#160;Application&#160;Interface........................................................................................54</p>
<p style="position:absolute;top:264px;left:92px;white-space:nowrap" class="ft3217">9.2&#160;&#160;Direct&#160;Anonymous&#160;Attestation..............................................................................54</p>
<p style="position:absolute;top:284px;left:101px;white-space:nowrap" class="ft3219">9.2.1&#160;&#160;Implementation................................................................................................54<br/>9.2.2&#160;&#160;Method&#160;Interface..............................................................................................58<br/>9.2.3&#160;&#160;Application&#160;Interface........................................................................................60</p>
<p style="position:absolute;top:341px;left:92px;white-space:nowrap" class="ft3217">9.3&#160;&#160;TLS&#160;DAA-Enhancement.........................................................................................60</p>
<p style="position:absolute;top:360px;left:101px;white-space:nowrap" class="ft3219">9.3.1&#160;&#160;Core.................................................................................................................60<br/>9.3.2&#160;&#160;Application&#160;Interface........................................................................................60</p>
<p style="position:absolute;top:399px;left:92px;white-space:nowrap" class="ft3217">9.4&#160;&#160;Engine&#160;TPM-DAA...................................................................................................60</p>
<p style="position:absolute;top:418px;left:101px;white-space:nowrap" class="ft3219">9.4.1&#160;&#160;TSS&#160;Binding&#160;Utilities.........................................................................................60<br/>9.4.2&#160;&#160;DAA_METHOD..................................................................................................61</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft3221">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft3221">3/61</p>
</div>
<!-- Page 33 -->
<a name="33"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page33-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3033.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft339">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft330">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft3321">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft3321">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft3322"><b>List&#160;of&#160;figures</b></p>
<p style="position:absolute;top:200px;left:83px;white-space:nowrap" class="ft3319">Figure&#160;1:&#160;System&#160;Architecture&#160;Overview.........................................................................6<br/>Figure&#160;2:&#160;TLS&#160;Hello&#160;Extensions&#160;and&#160;Supplemental&#160;Data&#160;Overview..................................9<br/>Figure&#160;3:&#160;TLS&#160;Hello&#160;Extensions&#160;and&#160;Supplemental&#160;Data&#160;Data&#160;Structure........................10<br/>Figure&#160;4:&#160;TLS&#160;Hello&#160;Extensions&#160;and&#160;Supplemental&#160;Data&#160;Workflow................................12<br/>Figure&#160;5:&#160;Direct&#160;Anonymous&#160;Attestation&#160;Architecture&#160;Overview...................................24<br/>Figure&#160;6:&#160;Direct&#160;Anonymous&#160;Attestation&#160;Data&#160;Structure...............................................26<br/>Figure&#160;7:&#160;Direct&#160;Anonymous&#160;Attestation&#160;Sign&#160;Workflow................................................28<br/>Figure&#160;8:&#160;Direct&#160;Anonymous&#160;Attestation&#160;Verify&#160;Workflow..............................................29<br/>Figure&#160;9:&#160;TLS&#160;DAA-Enhancement&#160;Architecture&#160;Overview..............................................33<br/>Figure&#160;10:&#160;TLS&#160;DAA-Enhancement&#160;Workflow.................................................................36<br/>Figure&#160;11:&#160;Implementation&#160;of&#160;the&#160;specification&#160;of&#160;TCG&#160;TSS/TPM&#160;DAA&#160;profile&#160;for&#160;DAA-TLS&#160;<br/>Overview.......................................................................................................................42<br/>Figure&#160;12:&#160;TCG&#160;TSS/TPM&#160;DAA&#160;Profile&#160;for&#160;DAA-TLS&#160;Workflow..........................................47</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft3321">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft3321">4/61</p>
</div>
<!-- Page 34 -->
<a name="34"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page34-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3034.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft349">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft340">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft3421">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft3421">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft3424"><b>1&#160;&#160;&#160;Introduction</b></p>
<p style="position:absolute;top:200px;left:83px;white-space:nowrap" class="ft3419">Secure&#160;channels&#160;allow&#160;two&#160;or&#160;more&#160;entities&#160;to&#160;communicate&#160;securely&#160;over&#160;insecure&#160;<br/>networks&#160;using&#160;cryptographic&#160;primitives&#160;to&#160;provide&#160;confidentiality,&#160;integrity&#160;and&#160;<br/>authentication&#160;of&#160;network&#160;messages.&#160;Trusted&#160;Computing&#160;(TC)&#160;technology&#160;extends&#160;the&#160;<br/>network&#160;protection&#160;to&#160;the&#160;peers&#160;involved&#160;in&#160;the&#160;communication.&#160;TC,&#160;in&#160;facts,&#160;allows&#160;a&#160;<br/>platform&#160;with&#160;TC-enabled&#160;hardware&#160;to&#160;provide&#160;cryptographic&#160;proofs&#160;about&#160;its&#160;behavior.&#160;<br/>Using&#160;these&#160;information,&#160;the&#160;counterpart&#160;can&#160;be&#160;guaranteed&#160;about&#160;the&#160;security&#160;of&#160;the&#160;<br/>message&#160;not&#160;only&#160;while&#160;it&#160;is&#160;transmitted,&#160;but&#160;also&#160;after&#160;it&#160;is&#160;received&#160;on&#160;the&#160;TC-<br/>platform.<br/>Among&#160;the&#160;primitives&#160;available&#160;to&#160;a&#160;TC-platform,&#160;Direct&#160;Anonymous&#160;Attestation&#160;(DAA)&#160;<br/>[7]&#160;is&#160;a&#160;privacy-friendly&#160;protocol&#160;that&#160;was&#160;designed&#160;to&#160;overcome&#160;the&#160;privacy&#160;issues&#160;of&#160;<br/>the&#160;privacy&#160;CA.&#160;In&#160;particular,&#160;the&#160;main&#160;problem&#160;related&#160;with&#160;the&#160;use&#160;of&#160;a&#160;privacy&#160;CA,&#160;is&#160;<br/>that&#160;it&#160;is&#160;possible&#160;for&#160;the&#160;privacy&#160;CA&#160;to&#160;disclose&#160;sensitive&#160;data&#160;that&#160;could&#160;allow&#160;a&#160;third&#160;<br/>party&#160;to&#160;link&#160;different&#160;remote&#160;attestation&#160;made&#160;by&#160;the&#160;same&#160;platform&#160;and,&#160;therefore,&#160;<br/>breaking&#160;the&#160;platform's&#160;privacy.&#160;DAA&#160;overcomes&#160;this&#160;problem&#160;using&#160;a&#160;zero-knowledge&#160;<br/>proof.<br/>In&#160;[1],&#160;a&#160;TLS&#160;DAA-Enhancement&#160;is&#160;proposed&#160;to&#160;exploit&#160;DAA&#160;as&#160;a&#160;mechanism&#160;to&#160;achieve&#160;<br/>(client)&#160;anonymous&#160;authentication.&#160;Furthermore,&#160;based&#160;on&#160;the&#160;Trusted&#160;Platform&#160;<br/>Module&#160;(TPM)&#160;and&#160;Trusted&#160;Software&#160;Stack&#160;(TSS),&#160;a&#160;TCG&#160;TSS/TPM&#160;profile&#160;is&#160;specified&#160;to&#160;<br/>exploit&#160;the&#160;DAA-related&#160;functions&#160;available&#160;in&#160;the&#160;TC&#160;technology.&#160;This&#160;document&#160;<br/>describes&#160;an&#160;implementation&#160;of&#160;the&#160;TLS&#160;DAA-Enhancement,&#160;including&#160;the&#160;TCG&#160;TSS/TPM&#160;<br/>profile.</p>
<p style="position:absolute;top:648px;left:83px;white-space:nowrap" class="ft3424"><b>2&#160;&#160;&#160;Architecture&#160;overview</b></p>
<p style="position:absolute;top:682px;left:83px;white-space:nowrap" class="ft3419">The&#160;implementation&#160;of&#160;SSL/TLS&#160;DAA-enhancement&#160;as&#160;specified&#160;in&#160;[1]&#160;is&#160;organized&#160;as&#160;a&#160;<br/>set&#160;of&#160;components&#160;that&#160;act&#160;at&#160;different&#160;layers,&#160;beginning&#160;from&#160;the&#160;lower&#160;cryptographic&#160;<br/>level,&#160;up&#160;to&#160;the&#160;TLS&#160;protocol&#160;enhancement&#160;level.&#160;The&#160;design&#160;through&#160;components&#160;is&#160;<br/>motivated&#160;by:</p>
<p style="position:absolute;top:772px;left:110px;white-space:nowrap" class="ft3412">●</p>
<p style="position:absolute;top:768px;left:137px;white-space:nowrap" class="ft3419">code&#160;modularity:&#160;smaller&#160;components&#160;with&#160;a&#160;defined&#160;interface&#160;allow&#160;applications&#160;<br/>to&#160;select&#160;only&#160;the&#160;required&#160;features,&#160;avoiding&#160;unnecessary&#160;growth&#160;of&#160;their&#160;code.</p>
<p style="position:absolute;top:820px;left:110px;white-space:nowrap" class="ft3412">●</p>
<p style="position:absolute;top:815px;left:137px;white-space:nowrap" class="ft3419">future&#160;reuse:&#160;components&#160;may&#160;be&#160;shared&#160;among&#160;other&#160;applications&#160;or&#160;higher&#160;<br/>layer&#160;components&#160;that&#160;exploit&#160;the&#160;provided&#160;capabilities.</p>
<p style="position:absolute;top:867px;left:110px;white-space:nowrap" class="ft3412">●</p>
<p style="position:absolute;top:862px;left:137px;white-space:nowrap" class="ft3419">support&#160;for&#160;real-world&#160;applications:&#160;both&#160;DAA-aware&#160;and&#160;legacy&#160;applications&#160;<br/>may&#160;exploit&#160;the&#160;TLS&#160;DAA-enhancement&#160;to&#160;take&#160;advantage&#160;of&#160;the&#160;(client)&#160;<br/>anonymous&#160;authentication.</p>
<p style="position:absolute;top:934px;left:110px;white-space:nowrap" class="ft3412">●</p>
<p style="position:absolute;top:929px;left:137px;white-space:nowrap" class="ft3419">security-oriented&#160;design:&#160;code&#160;modularity&#160;and&#160;reuse,&#160;as&#160;well&#160;as&#160;best&#160;practice&#160;<br/>and&#160;policy&#160;for&#160;configuring&#160;applications,&#160;result&#160;in&#160;an&#160;added&#160;value&#160;with&#160;respect&#160;to&#160;<br/>the&#160;security&#160;provided&#160;by&#160;the&#160;code.&#160;Furthermore&#160;it&#160;is&#160;possible&#160;to&#160;expect&#160;that&#160;<br/>lower&#160;layer&#160;components&#160;may&#160;be&#160;integrated&#160;in&#160;the&#160;mainstream&#160;libraries,&#160;thus&#160;<br/>bringing&#160;the&#160;code&#160;to&#160;be&#160;publicly&#160;shared&#160;and&#160;evaluated.</p>
<p style="position:absolute;top:1034px;left:83px;white-space:nowrap" class="ft3419">OpenSSL&#160;supports&#160;engines&#160;as&#160;a&#160;way&#160;to&#160;provide&#160;alternative&#160;implementations&#160;for&#160;a&#160;<br/>cryptographic&#160;primitive,&#160;usually&#160;to&#160;exploit&#160;cryptographic&#160;hardware&#160;accelerators.&#160;<br/>Engines&#160;are&#160;used&#160;to&#160;provide&#160;two&#160;different&#160;implementations&#160;of&#160;the&#160;DAA&#160;protocol:&#160;the&#160;<br/>first&#160;one&#160;exploits&#160;the&#160;TPM/TSS&#160;capabilities,&#160;the&#160;latter&#160;is&#160;pure&#160;software&#160;and&#160;implements&#160;<br/>a&#160;newer&#160;version&#160;of&#160;the&#160;protocol&#160;[9].</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft3421">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft3421">5/61</p>
</div>
<!-- Page 35 -->
<a name="35"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3533{font-size:17px;font-family:FAAAAA+BitstreamVeraSansMono;color:#000000;}
-->
</style>
<div id="page35-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3035.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft359">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft350">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft3521">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft3521">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft3525">The&#160;whole&#160;implementation&#160;has&#160;been&#160;done&#160;and&#160;tested&#160;with&#160;OpenSSL&#160;v0.9.9,&#160;snapshot&#160;<br/>20081204.<br/><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#35">Figure&#160;1&#160;</a>presents&#160;the&#160;overall&#160;architecture.</p>
<p style="position:absolute;top:779px;left:83px;white-space:nowrap" class="ft3517">In&#160;more&#160;detail:</p>
<p style="position:absolute;top:812px;left:110px;white-space:nowrap" class="ft3512">●</p>
<p style="position:absolute;top:807px;left:137px;white-space:nowrap" class="ft3516"><b>TLS&#160;Hello&#160;Extensions&#160;and&#160;Supplemental&#160;Data&#160;(TLSEXT)&#160;</b></p>
<p style="position:absolute;top:807px;left:652px;white-space:nowrap" class="ft3517">is&#160;a&#160;framework&#160;for&#160;</p>
<p style="position:absolute;top:826px;left:137px;white-space:nowrap" class="ft3519">supporting&#160;generic&#160;TLS&#160;Hello&#160;Extensions&#160;(RFC&#160;4366)&#160;[5]&#160;and&#160;Supplemental&#160;Data&#160;<br/>(RFC&#160;4680)&#160;[6]&#160;into&#160;OpenSSL's&#160;</p>
<p style="position:absolute;top:846px;left:393px;white-space:nowrap" class="ft3533"><b>libssl</b></p>
<p style="position:absolute;top:846px;left:453px;white-space:nowrap" class="ft3517">.&#160;Both&#160;TLS&#160;Hello&#160;Extensions&#160;and&#160;</p>
<p style="position:absolute;top:865px;left:137px;white-space:nowrap" class="ft3519">Supplemental&#160;Data&#160;are&#160;needed&#160;for&#160;the&#160;TLS&#160;DAA-enhancement.&#160;The&#160;framework&#160;is&#160;<br/>intended&#160;to&#160;help&#160;developers&#160;who&#160;want&#160;to&#160;add&#160;support&#160;for&#160;new&#160;TLS&#160;Extensions&#160;<br/>into&#160;OpenSSL.&#160;This&#160;is&#160;detailed&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#37">&#160;3.</a></p>
<p style="position:absolute;top:936px;left:110px;white-space:nowrap" class="ft3512">●</p>
<p style="position:absolute;top:931px;left:137px;white-space:nowrap" class="ft3516"><b>Direct&#160;Anonymous&#160;Attestation&#160;(DAA)</b></p>
<p style="position:absolute;top:931px;left:479px;white-space:nowrap" class="ft3517">&#160;is&#160;an&#160;interface&#160;to&#160;implement&#160;the&#160;Sign&#160;</p>
<p style="position:absolute;top:951px;left:137px;white-space:nowrap" class="ft3517">and&#160;Verify&#160;algorithms&#160;of&#160;Direct&#160;Anonymous&#160;Attestation&#160;within&#160;the&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:970px;left:137px;white-space:nowrap" class="ft3533"><b>libcrypto</b></p>
<p style="position:absolute;top:970px;left:227px;white-space:nowrap" class="ft3517">.&#160;According&#160;to&#160;the&#160;original&#160;design&#160;of&#160;DAA,&#160;the&#160;interface&#160;considers&#160;the&#160;</p>
<p style="position:absolute;top:989px;left:137px;white-space:nowrap" class="ft3519">Sign&#160;algorithm&#160;as&#160;a&#160;two-parties&#160;protocol&#160;between&#160;the&#160;Host&#160;and&#160;the&#160;TPM.&#160;The&#160;<br/>interface&#160;is&#160;designed&#160;to&#160;provide&#160;DAA&#160;support&#160;in&#160;any&#160;context&#160;</p>
<p style="position:absolute;top:1008px;left:638px;white-space:nowrap" class="ft3533"><b>libcrypto&#160;</b></p>
<p style="position:absolute;top:1008px;left:737px;white-space:nowrap" class="ft3517">is&#160;</p>
<p style="position:absolute;top:1027px;left:137px;white-space:nowrap" class="ft3519">available,&#160;not&#160;only&#160;for&#160;the&#160;TLS&#160;DAA-enhancement.&#160;A&#160;default&#160;implementation&#160;is&#160;<br/>included;&#160;the&#160;use&#160;of&#160;engines&#160;allows&#160;to&#160;override&#160;the&#160;default&#160;implementation.&#160;This&#160;<br/>is&#160;detailed&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#53">&#160;4.</a></p>
<p style="position:absolute;top:1099px;left:110px;white-space:nowrap" class="ft3512">●</p>
<p style="position:absolute;top:1094px;left:137px;white-space:nowrap" class="ft3516"><b>TLS&#160;DAA-Enhancement&#160;(DAA-TLS)</b></p>
<p style="position:absolute;top:1094px;left:450px;white-space:nowrap" class="ft3517">&#160;is&#160;an&#160;implementation&#160;of&#160;the&#160;TLS&#160;DAA-</p>
<p style="position:absolute;top:1113px;left:137px;white-space:nowrap" class="ft3517">Enhancement&#160;Specification&#160;[1]&#160;to&#160;enhance&#160;OpenSSL's&#160;</p>
<p style="position:absolute;top:1113px;left:587px;white-space:nowrap" class="ft3533"><b>libssl</b></p>
<p style="position:absolute;top:1113px;left:647px;white-space:nowrap" class="ft3517">.&#160;It&#160;is&#160;build&#160;upon&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft3521">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft3521">6/61</p>
<p style="position:absolute;top:732px;left:281px;white-space:nowrap" class="ft3517">Figure&#160;1:&#160;System&#160;Architecture&#160;Overview</p>
</div>
<!-- Page 36 -->
<a name="36"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page36-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3036.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft369">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft360">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft3621">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft3621">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft3619">TLSEXT&#160;and&#160;uses&#160;primitives&#160;offered&#160;by&#160;DAA.&#160;It&#160;also&#160;provides&#160;an&#160;interface&#160;for&#160;<br/>applications&#160;that&#160;wants&#160;to&#160;take&#160;advantage&#160;of&#160;the&#160;(client)&#160;anonymous&#160;<br/>authentication.&#160;Furthermore,&#160;a&#160;special&#160;compile-time&#160;option&#160;allows&#160;building&#160;it&#160;in&#160;<br/>legacy&#160;mode,&#160;that&#160;allows&#160;unmodified&#160;applications&#160;to&#160;exploit&#160;the&#160;TLS&#160;DAA-<br/>Enhancement&#160;as&#160;well.&#160;This&#160;is&#160;detailed&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#62">&#160;5.</a></p>
<p style="position:absolute;top:259px;left:110px;white-space:nowrap" class="ft3612">●</p>
<p style="position:absolute;top:254px;left:137px;white-space:nowrap" class="ft3620"><b>Engine&#160;Implementing&#160;the&#160;Specification&#160;of&#160;TCG&#160;TSS/TPM&#160;DAA&#160;Profile&#160;<br/>(Engine&#160;TPM-DAA)&#160;</b></p>
<p style="position:absolute;top:273px;left:313px;white-space:nowrap" class="ft3617">is&#160;an&#160;OpenSSL&#160;engine&#160;that&#160;implements&#160;the&#160;TCG&#160;Profile&#160;of&#160;</p>
<p style="position:absolute;top:293px;left:137px;white-space:nowrap" class="ft3619">the&#160;TLS&#160;DAA-enhancement,&#160;according&#160;to&#160;[1].&#160;It&#160;requires&#160;a&#160;Trusted&#160;Software&#160;<br/>Stack&#160;capable&#160;of&#160;supporting&#160;the&#160;DAA&#160;protocol.&#160;As&#160;DAA-TLS&#160;is&#160;implemented&#160;<br/>within&#160;OpenSSL,&#160;the&#160;engine&#160;manages&#160;conversion&#160;between&#160;OpenSSL&#160;data&#160;<br/>structures&#160;and&#160;TSS'&#160;ones.&#160;This&#160;is&#160;detailed&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#71">&#160;6.</a></p>
<p style="position:absolute;top:383px;left:110px;white-space:nowrap" class="ft3612">●</p>
<p style="position:absolute;top:378px;left:137px;white-space:nowrap" class="ft3620"><b>Engine&#160;Implementing&#160;the&#160;Asymmetric&#160;Pairing-based&#160;DAA&#160;(Engine&#160;<br/>Miracl)&#160;</b></p>
<p style="position:absolute;top:398px;left:207px;white-space:nowrap" class="ft3617">is&#160;an&#160;OpenSSL&#160;engine&#160;that&#160;implements&#160;a&#160;purely&#160;software&#160;version&#160;of&#160;</p>
<p style="position:absolute;top:417px;left:137px;white-space:nowrap" class="ft3619">DAA,&#160;according&#160;to&#160;[9].&#160;This&#160;version&#160;is&#160;based&#160;on&#160;asymmetric&#160;pairing&#160;over&#160;elliptic&#160;<br/>curves&#160;and&#160;the&#160;engine&#160;exploits&#160;the&#160;Miracl&#160;library&#160;[10]&#160;as&#160;a&#160;software&#160;<br/>cryptographic&#160;accelerator&#160;to&#160;compute&#160;pairing.&#160;This&#160;engine&#160;is&#160;not&#160;described&#160;in&#160;<br/>more&#160;detail&#160;within&#160;this&#160;document,&#160;but&#160;it&#160;is&#160;included&#160;in&#160;the&#160;architecture&#160;to&#160;give&#160;a&#160;<br/>more&#160;comprehensive&#160;overview.&#160;Furthermore,&#160;it&#160;is&#160;part&#160;of&#160;the&#160;demonstrator&#160;of&#160;<br/>the&#160;TLS&#160;DAA-enhancement.</p>
<p style="position:absolute;top:546px;left:110px;white-space:nowrap" class="ft3612">●</p>
<p style="position:absolute;top:541px;left:137px;white-space:nowrap" class="ft3616"><b>Application&#160;layer</b></p>
<p style="position:absolute;top:541px;left:295px;white-space:nowrap" class="ft3617">&#160;is&#160;the&#160;collection&#160;of&#160;software&#160;that&#160;demonstrates&#160;the&#160;use&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:560px;left:137px;white-space:nowrap" class="ft3617">TLS&#160;DAA-enhancement.&#160;Modified&#160;versions&#160;of&#160;OpenSSL&#160;tools&#160;</p>
<p style="position:absolute;top:560px;left:634px;white-space:nowrap" class="ft3633"><b>s_client</b></p>
<p style="position:absolute;top:560px;left:713px;white-space:nowrap" class="ft3617">&#160;and&#160;</p>
<p style="position:absolute;top:579px;left:137px;white-space:nowrap" class="ft3633"><b>s_server</b></p>
<p style="position:absolute;top:579px;left:217px;white-space:nowrap" class="ft3617">&#160;are&#160;able&#160;to&#160;communicate&#160;with&#160;DAA-TLS&#160;through&#160;its&#160;interface&#160;(e.g.&#160;set&#160;</p>
<p style="position:absolute;top:599px;left:137px;white-space:nowrap" class="ft3619">platform/issuer&#160;credentials).&#160;An&#160;unmodified&#160;version&#160;of&#160;Apache&#160;web&#160;server&#160;with&#160;<br/>mod_ssl&#160;demonstrates&#160;the&#160;possibility&#160;to&#160;use&#160;the&#160;framework&#160;with&#160;legacy&#160;<br/>applications.&#160;The&#160;application&#160;layer&#160;is&#160;not&#160;described&#160;in&#160;more&#160;detail&#160;within&#160;this&#160;<br/>document,&#160;but&#160;it&#160;is&#160;included&#160;in&#160;the&#160;architecture&#160;to&#160;give&#160;a&#160;more&#160;comprehensive&#160;<br/>overview.&#160;Furthermore,&#160;it&#160;is&#160;part&#160;of&#160;the&#160;demonstrator&#160;of&#160;the&#160;TLS&#160;DAA-<br/>enhancement.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft3621">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft3621">7/61</p>
</div>
<!-- Page 37 -->
<a name="37"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3734{font-size:20px;font-family:GAAAAA+BitstreamVeraSans;color:#000000;}
	.ft3735{font-size:17px;font-family:HAAAAA+BitstreamVeraSansMono;color:#000000;}
	.ft3736{font-size:18px;font-family:GAAAAA+BitstreamVeraSans;color:#000000;}
	.ft3737{font-size:17px;line-height:19px;font-family:HAAAAA+BitstreamVeraSansMono;color:#000000;}
-->
</style>
<div id="page37-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3037.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft379">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft370">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft3721">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft3721">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft3724"><b>3&#160;&#160;&#160;TLS&#160;Hello&#160;Extensions&#160;and&#160;Supplemental&#160;Data</b></p>
<p style="position:absolute;top:218px;left:83px;white-space:nowrap" class="ft3734"><i><b>3.1&#160;&#160;&#160;Architecture</b></i></p>
<p style="position:absolute;top:250px;left:83px;white-space:nowrap" class="ft3725">This&#160;is&#160;a&#160;framework&#160;for&#160;supporting&#160;generic&#160;TLS&#160;Hello&#160;Extensions&#160;(RFC&#160;4366)&#160;[5]&#160;and&#160;<br/>Supplemental&#160;Data&#160;(RFC&#160;4680)&#160;[6].&#160;It&#160;is&#160;intended&#160;to&#160;help&#160;developers&#160;who&#160;want&#160;to&#160;add&#160;<br/>support&#160;for&#160;new&#160;TLS&#160;Extensions&#160;into&#160;OpenSSL.<br/>The&#160;framework&#160;allows&#160;to&#160;embed&#160;new&#160;TLS&#160;Extensions&#160;into&#160;the&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:316px;left:673px;white-space:nowrap" class="ft3733"><b>libssl</b></p>
<p style="position:absolute;top:316px;left:732px;white-space:nowrap" class="ft3717">;&#160;this&#160;</p>
<p style="position:absolute;top:336px;left:83px;white-space:nowrap" class="ft3719">feature&#160;becomes&#160;especially&#160;useful&#160;when&#160;it&#160;is&#160;required&#160;to&#160;exploit&#160;the&#160;framework&#160;with&#160;<br/>legacy&#160;applications&#160;not&#160;designed&#160;to&#160;support&#160;the&#160;TLS&#160;Extensions.&#160;Furthermore&#160;it&#160;is&#160;<br/>designed&#160;to&#160;let&#160;the&#160;developers&#160;define&#160;a&#160;new&#160;TLS&#160;Extension,&#160;dynamically&#160;load,&#160;create&#160;<br/>and&#160;handle&#160;it&#160;at&#160;application&#160;layer;&#160;in&#160;this&#160;last&#160;case,&#160;it&#160;is&#160;possible&#160;to&#160;support&#160;applications&#160;<br/>that&#160;were&#160;designed&#160;to&#160;support&#160;the&#160;TLS&#160;Extensions&#160;natively.<br/>The&#160;framework&#160;treats&#160;every&#160;TLS&#160;Extension&#160;as&#160;an&#160;object,&#160;with&#160;data&#160;to&#160;be&#160;exchanged&#160;<br/>during&#160;the&#160;handshake&#160;and&#160;methods&#160;that&#160;implement&#160;the&#160;extension&#160;logic.&#160;Supplemental&#160;<br/>Data&#160;are&#160;part&#160;of&#160;such&#160;objects,&#160;to&#160;adhere&#160;with&#160;RFC&#160;4680:</p>
<p style="position:absolute;top:516px;left:105px;white-space:nowrap" class="ft3737"><i><b>Information&#160;provided&#160;in&#160;a&#160;supplemental&#160;data&#160;object&#160;MUST&#160;be&#160;intended&#160;to&#160;<br/>be&#160;used&#160;exclusively&#160;by&#160;applications&#160;and&#160;protocols&#160;above&#160;the&#160;TLS&#160;<br/>protocol&#160;layer.&#160;Any&#160;such&#160;data&#160;MUST&#160;NOT&#160;need&#160;to&#160;be&#160;processed&#160;by&#160;the&#160;TLS&#160;<br/>protocol.</b></i></p>
<p style="position:absolute;top:611px;left:83px;white-space:nowrap" class="ft3719">By&#160;having&#160;this&#160;unified&#160;view&#160;for&#160;extensions,&#160;it&#160;is&#160;easy&#160;to&#160;support&#160;once&#160;fr&#160;all&#160;some&#160;of&#160;the&#160;<br/>requirements&#160;imposed&#160;by&#160;RFCs,&#160;for&#160;instance&#160;RFC&#160;4366:</p>
<p style="position:absolute;top:672px;left:132px;white-space:nowrap" class="ft3712">●</p>
<p style="position:absolute;top:667px;left:159px;white-space:nowrap" class="ft3735"><i><b>There&#160;MUST&#160;NOT&#160;be&#160;more&#160;than&#160;one&#160;extension&#160;of&#160;the&#160;same&#160;type.</b></i></p>
<p style="position:absolute;top:718px;left:132px;white-space:nowrap" class="ft3712">●</p>
<p style="position:absolute;top:713px;left:159px;white-space:nowrap" class="ft3737"><i><b>In&#160;the&#160;event&#160;that&#160;a&#160;client&#160;requests&#160;additional&#160;functionality&#160;<br/>using&#160;the&#160;extended&#160;client&#160;hello,&#160;and&#160;this&#160;functionality&#160;is&#160;not&#160;<br/>supplied&#160;by&#160;the&#160;server,&#160;the&#160;client&#160;MAY&#160;abort&#160;the&#160;handshake.</b></i></p>
<p style="position:absolute;top:806px;left:83px;white-space:nowrap" class="ft3736"><i><b>3.1.1&#160;&#160;&#160;Overview</b></i></p>
<p style="position:absolute;top:836px;left:83px;white-space:nowrap" class="ft3717">The&#160;code&#160;is&#160;organized&#160;in&#160;four&#160;main&#160;modules,&#160;as&#160;shown&#160;in<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#38">&#160;Figure&#160;2.</a></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft3721">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft3721">8/61</p>
</div>
<!-- Page 38 -->
<a name="38"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3838{font-size:17px;font-family:IAAAAA+DejaVuSansMono;color:#000000;}
-->
</style>
<div id="page38-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3038.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft389">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft380">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft3821">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft3821">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:925px;left:110px;white-space:nowrap" class="ft3812">●</p>
<p style="position:absolute;top:920px;left:137px;white-space:nowrap" class="ft3816"><b>Patch.</b></p>
<p style="position:absolute;top:920px;left:196px;white-space:nowrap" class="ft3817">&#160;The&#160;lower&#160;layer&#160;contains&#160;the&#160;changes&#160;to&#160;the&#160;existing&#160;code&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:939px;left:137px;white-space:nowrap" class="ft3817">unmodified&#160;</p>
<p style="position:absolute;top:939px;left:236px;white-space:nowrap" class="ft3838"><b>libssl</b></p>
<p style="position:absolute;top:939px;left:296px;white-space:nowrap" class="ft3817">&#160;necessary&#160;to&#160;handle&#160;TLS&#160;Extensions&#160;and&#160;support&#160;the&#160;new&#160;</p>
<p style="position:absolute;top:959px;left:137px;white-space:nowrap" class="ft3819">SupplementalData&#160;handshake&#160;message.<br/>For&#160;simplicity,&#160;the&#160;patch&#160;to&#160;the&#160;existent&#160;code&#160;is&#160;limited&#160;to&#160;single&#160;function&#160;calls,&#160;<br/>which&#160;carry&#160;out&#160;all&#160;the&#160;necessary&#160;computation.<br/>OpenSSL&#160;allows&#160;to&#160;disable&#160;all&#160;the&#160;TLS&#160;Extensions&#160;at&#160;compilation&#160;time&#160;by&#160;defining&#160;<br/>the&#160;macro&#160;</p>
<p style="position:absolute;top:1035px;left:227px;white-space:nowrap" class="ft3833"><b>OPENSSL_NO_TLSEXT</b></p>
<p style="position:absolute;top:1035px;left:396px;white-space:nowrap" class="ft3817">.&#160;This&#160;framework&#160;extends&#160;this&#160;concept&#160;supporting&#160;</p>
<p style="position:absolute;top:1055px;left:137px;white-space:nowrap" class="ft3817">the&#160;macro&#160;</p>
<p style="position:absolute;top:1055px;left:227px;white-space:nowrap" class="ft3833"><b>OPENSSL_NO_TLSEXT_GENERAL</b></p>
<p style="position:absolute;top:1055px;left:476px;white-space:nowrap" class="ft3817">&#160;which&#160;disables&#160;the&#160;framework&#160;at&#160;</p>
<p style="position:absolute;top:1074px;left:137px;white-space:nowrap" class="ft3817">compilation&#160;time.&#160;Moreover,&#160;the&#160;macro&#160;</p>
<p style="position:absolute;top:1074px;left:465px;white-space:nowrap" class="ft3833"><b>OPENSSL_NO_TLSEXT</b></p>
<p style="position:absolute;top:1074px;left:634px;white-space:nowrap" class="ft3817">&#160;automatically&#160;forces&#160;</p>
<p style="position:absolute;top:1093px;left:137px;white-space:nowrap" class="ft3833"><b>OPENSSL_NO_TLSEXT_GENERAL</b></p>
<p style="position:absolute;top:1093px;left:386px;white-space:nowrap" class="ft3817">.</p>
<p style="position:absolute;top:1126px;left:110px;white-space:nowrap" class="ft3812">●</p>
<p style="position:absolute;top:1121px;left:137px;white-space:nowrap" class="ft3816"><b>Core.</b></p>
<p style="position:absolute;top:1121px;left:186px;white-space:nowrap" class="ft3817">&#160;The&#160;middle&#160;layer&#160;contains&#160;the&#160;data&#160;structures&#160;and&#160;the&#160;core&#160;functionality.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft3821">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft3821">9/61</p>
<p style="position:absolute;top:854px;left:303px;white-space:nowrap" class="ft3817">Figure&#160;2:&#160;TLS&#160;Hello&#160;Extensions&#160;and&#160;</p>
<p style="position:absolute;top:873px;left:325px;white-space:nowrap" class="ft3817">Supplemental&#160;Data&#160;Overview</p>
</div>
<!-- Page 39 -->
<a name="39"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3939{font-size:17px;font-family:JAAAAA+BitstreamVeraSans;color:#000000;}
	.ft3940{font-size:18px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page39-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3039.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft399">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft390">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft3921">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft3921">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:154px;left:110px;white-space:nowrap" class="ft3912">●</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft3916"><b>Interface.</b></p>
<p style="position:absolute;top:149px;left:228px;white-space:nowrap" class="ft3917">&#160;The&#160;upper&#160;layer&#160;consists&#160;in&#160;the&#160;interface&#160;available&#160;to&#160;programmers&#160;to&#160;</p>
<p style="position:absolute;top:168px;left:137px;white-space:nowrap" class="ft3917">write&#160;new&#160;TLS&#160;Extensions&#160;(see&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#49">&#160;</a></p>
<p style="position:absolute;top:168px;left:461px;white-space:nowrap" class="ft3939"><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#49"><i>3.3</i></a></p>
<p style="position:absolute;top:168px;left:487px;white-space:nowrap" class="ft3917"><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#49">)</a>.</p>
<p style="position:absolute;top:201px;left:110px;white-space:nowrap" class="ft3912">●</p>
<p style="position:absolute;top:197px;left:137px;white-space:nowrap" class="ft3916"><b>Application&#160;Interface.</b></p>
<p style="position:absolute;top:197px;left:339px;white-space:nowrap" class="ft3917">&#160;This&#160;module&#160;contains&#160;portions&#160;of&#160;the&#160;Interface&#160;that&#160;are&#160;</p>
<p style="position:absolute;top:216px;left:137px;white-space:nowrap" class="ft3919">common&#160;to&#160;all&#160;the&#160;TLS&#160;Extension&#160;and&#160;are&#160;useful&#160;for&#160;the&#160;application:&#160;for&#160;instance&#160;<br/>this&#160;code&#160;offers&#160;the&#160;possibility&#160;for&#160;the&#160;client&#160;to&#160;require&#160;the&#160;use&#160;of&#160;an&#160;extension,&#160;<br/>or&#160;abort&#160;the&#160;handshake&#160;if&#160;the&#160;server&#160;ignores&#160;it).&#160;Even&#160;if&#160;this&#160;code&#160;is&#160;common&#160;to&#160;<br/>all&#160;the&#160;TLS&#160;Extension,&#160;it&#160;SHOULD&#160;NOT&#160;be&#160;directly&#160;accessed&#160;by&#160;applications,&#160;but&#160;it&#160;<br/>SHOULD&#160;be&#160;wrapped&#160;by&#160;any&#160;extension&#160;which&#160;provide&#160;such&#160;functionalities&#160;to&#160;the&#160;<br/>application&#160;layer.</p>
<p style="position:absolute;top:358px;left:83px;white-space:nowrap" class="ft3936"><i><b>3.1.2&#160;&#160;</b></i></p>
<p style="position:absolute;top:358px;left:156px;white-space:nowrap" class="ft3940"><b>Data&#160;Structures</b></p>
<p style="position:absolute;top:388px;left:83px;white-space:nowrap" class="ft3917">The&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:388px;left:199px;white-space:nowrap" class="ft3933"><b>SSL</b></p>
<p style="position:absolute;top:388px;left:229px;white-space:nowrap" class="ft3917">&#160;object&#160;is&#160;extended&#160;with&#160;a&#160;</p>
<p style="position:absolute;top:388px;left:447px;white-space:nowrap" class="ft3933"><b>STACK_OF&#160;TLSEXT_GENERAL</b></p>
<p style="position:absolute;top:388px;left:676px;white-space:nowrap" class="ft3917">.</p>
<p style="position:absolute;top:416px;left:83px;white-space:nowrap" class="ft3917">A&#160;</p>
<p style="position:absolute;top:416px;left:100px;white-space:nowrap" class="ft3933"><b>TLSEXT_GENERAL</b></p>
<p style="position:absolute;top:416px;left:239px;white-space:nowrap" class="ft3917">&#160;is&#160;an&#160;object&#160;that&#160;contains&#160;data&#160;related&#160;to&#160;a&#160;TLS&#160;Extension&#160;(in&#160;the&#160;</p>
<p style="position:absolute;top:435px;left:83px;white-space:nowrap" class="ft3919">meaning&#160;of&#160;the&#160;general&#160;framework)&#160;as&#160;well&#160;as&#160;callback&#160;functions&#160;to&#160;implement&#160;the&#160;<br/>logic&#160;of&#160;the&#160;extension.<br/><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#39">Figure&#160;3&#160;</a>gives&#160;an&#160;overall&#160;idea.</p>
<p style="position:absolute;top:903px;left:83px;white-space:nowrap" class="ft3925">The&#160;object&#160;has&#160;two&#160;parts,&#160;quite&#160;symmetric:&#160;one&#160;for&#160;the&#160;Client&#160;data&#160;and&#160;one&#160;for&#160;the&#160;<br/>Server.<br/>For&#160;what&#160;concerns&#160;data,&#160;the&#160;two&#160;parts&#160;will&#160;contains&#160;data&#160;to&#160;be&#160;sent&#160;or&#160;received&#160;<br/>depending&#160;on&#160;the&#160;object&#160;is&#160;instantiated&#160;on&#160;the&#160;client&#160;or&#160;server&#160;side.<br/>In&#160;more&#160;detail:</p>
<p style="position:absolute;top:1031px;left:110px;white-space:nowrap" class="ft3912">●</p>
<p style="position:absolute;top:1026px;left:137px;white-space:nowrap" class="ft3933"><b>type</b></p>
<p style="position:absolute;top:1026px;left:177px;white-space:nowrap" class="ft3917">&#160;is&#160;the&#160;type&#160;of&#160;the&#160;extension&#160;(it&#160;must&#160;be&#160;the&#160;same&#160;on&#160;client&#160;and&#160;server).</p>
<p style="position:absolute;top:1059px;left:110px;white-space:nowrap" class="ft3912">●</p>
<p style="position:absolute;top:1054px;left:137px;white-space:nowrap" class="ft3933"><b>client_data</b></p>
<p style="position:absolute;top:1054px;left:247px;white-space:nowrap" class="ft3917">&#160;is&#160;the&#160;payload&#160;the&#160;client&#160;will&#160;send&#160;(and&#160;the&#160;server&#160;will&#160;receive)&#160;</p>
<p style="position:absolute;top:1074px;left:137px;white-space:nowrap" class="ft3917">through&#160;the&#160;TLS&#160;Hello&#160;Extension&#160;(ClientHello&#160;handshake&#160;message).</p>
<p style="position:absolute;top:1106px;left:110px;white-space:nowrap" class="ft3912">●</p>
<p style="position:absolute;top:1102px;left:137px;white-space:nowrap" class="ft3933"><b>client_data_length</b></p>
<p style="position:absolute;top:1102px;left:316px;white-space:nowrap" class="ft3939"><i>&#160;</i></p>
<p style="position:absolute;top:1102px;left:322px;white-space:nowrap" class="ft3917">is&#160;the&#160;length&#160;of&#160;the&#160;payload.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft3921">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft3921">10/61</p>
<p style="position:absolute;top:849px;left:303px;white-space:nowrap" class="ft3919">Figure&#160;3:&#160;TLS&#160;Hello&#160;Extensions&#160;and&#160;<br/>Supplemental&#160;Data&#160;Data&#160;Structure</p>
</div>
<!-- Page 40 -->
<a name="40"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page40-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3040.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft409">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft400">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft4021">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft4021">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:154px;left:110px;white-space:nowrap" class="ft4012">●</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft4033"><b>client_supp_data</b></p>
<p style="position:absolute;top:149px;left:296px;white-space:nowrap" class="ft4039"><i>&#160;</i></p>
<p style="position:absolute;top:149px;left:302px;white-space:nowrap" class="ft4017">is&#160;a&#160;stack&#160;of&#160;</p>
<p style="position:absolute;top:149px;left:406px;white-space:nowrap" class="ft4033"><b>SUPP_DATA_ENTRY</b></p>
<p style="position:absolute;top:149px;left:555px;white-space:nowrap" class="ft4017">&#160;objects,&#160;each&#160;describing&#160;in&#160;</p>
<p style="position:absolute;top:168px;left:137px;white-space:nowrap" class="ft4019">TLV&#160;(type-length-value)&#160;format&#160;a&#160;supplemental&#160;data&#160;entry&#160;related&#160;to&#160;this&#160;<br/>extension.&#160;The&#160;client&#160;sends&#160;(and&#160;the&#160;server&#160;receives)&#160;this&#160;data&#160;through&#160;the&#160;<br/>SupplementalData&#160;handshake&#160;message.</p>
<p style="position:absolute;top:235px;left:83px;white-space:nowrap" class="ft4025">The&#160;same&#160;(but&#160;symmetric)&#160;is&#160;for&#160;server&#160;data.<br/>Callback&#160;functions&#160;(</p>
<p style="position:absolute;top:263px;left:246px;white-space:nowrap" class="ft4033"><b>client_ext_cb()</b></p>
<p style="position:absolute;top:263px;left:396px;white-space:nowrap" class="ft4017">,&#160;</p>
<p style="position:absolute;top:263px;left:406px;white-space:nowrap" class="ft4033"><b>client_supp_data_cb()</b></p>
<p style="position:absolute;top:263px;left:615px;white-space:nowrap" class="ft4017">,&#160;</p>
<p style="position:absolute;top:282px;left:83px;white-space:nowrap" class="ft4033"><b>client_finish_cb()</b></p>
<p style="position:absolute;top:282px;left:262px;white-space:nowrap" class="ft4017">,&#160;respectively&#160;for&#160;the&#160;server)&#160;are&#160;used&#160;to&#160;implement&#160;the&#160;logic&#160;of&#160;</p>
<p style="position:absolute;top:302px;left:83px;white-space:nowrap" class="ft4025">the&#160;TLS&#160;Extension.&#160;These&#160;are&#160;automatically&#160;invoked&#160;by&#160;the&#160;framework&#160;at&#160;the&#160;proper&#160;<br/>time&#160;(see&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#40">&#160;3.1.3&#160;</a>for&#160;more&#160;details)&#160;and&#160;they&#160;are&#160;only&#160;handled&#160;on&#160;the&#160;side&#160;the&#160;<br/>object&#160;is&#160;instantiated,&#160;i.e.&#160;client's&#160;callback&#160;functions&#160;are&#160;handled&#160;when&#160;the&#160;object&#160;is&#160;<br/>instantiated&#160;on&#160;the&#160;client&#160;while&#160;server's&#160;callback&#160;functions&#160;are&#160;only&#160;handled&#160;on&#160;the&#160;<br/>server.<br/>Similarly,&#160;the&#160;context&#160;data&#160;(</p>
<p style="position:absolute;top:407px;left:314px;white-space:nowrap" class="ft4033"><b>client_ctx_data</b></p>
<p style="position:absolute;top:407px;left:464px;white-space:nowrap" class="ft4017">,&#160;respectively&#160;</p>
<p style="position:absolute;top:407px;left:580px;white-space:nowrap" class="ft4033"><b>server_ctx_data</b></p>
<p style="position:absolute;top:407px;left:729px;white-space:nowrap" class="ft4017">)&#160;to&#160;</p>
<p style="position:absolute;top:426px;left:83px;white-space:nowrap" class="ft4025">exchange&#160;information&#160;from/to&#160;the&#160;callbacks,&#160;SHOULD&#160;be&#160;used&#160;only&#160;on&#160;the&#160;correct&#160;side.<br/>Finally,&#160;there&#160;are&#160;three&#160;flags:</p>
<p style="position:absolute;top:487px;left:110px;white-space:nowrap" class="ft4012">●</p>
<p style="position:absolute;top:482px;left:137px;white-space:nowrap" class="ft4033"><b>client_required</b></p>
<p style="position:absolute;top:482px;left:287px;white-space:nowrap" class="ft4017">&#160;tells&#160;if&#160;the&#160;client&#160;has&#160;to&#160;abort&#160;in&#160;case&#160;the&#160;server&#160;ignores&#160;the&#160;</p>
<p style="position:absolute;top:501px;left:137px;white-space:nowrap" class="ft4017">extension.</p>
<p style="position:absolute;top:534px;left:110px;white-space:nowrap" class="ft4012">●</p>
<p style="position:absolute;top:530px;left:137px;white-space:nowrap" class="ft4033"><b>server_send</b></p>
<p style="position:absolute;top:530px;left:247px;white-space:nowrap" class="ft4017">&#160;tells&#160;if&#160;the&#160;server&#160;should&#160;send&#160;this&#160;extension&#160;(see&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#40">&#160;3.1.3&#160;</a>for&#160;</p>
<p style="position:absolute;top:549px;left:137px;white-space:nowrap" class="ft4017">more&#160;details).</p>
<p style="position:absolute;top:582px;left:110px;white-space:nowrap" class="ft4012">●</p>
<p style="position:absolute;top:577px;left:137px;white-space:nowrap" class="ft4033"><b>received</b></p>
<p style="position:absolute;top:577px;left:217px;white-space:nowrap" class="ft4017">&#160;tells&#160;if&#160;the&#160;extension&#160;has&#160;been&#160;received.&#160;It&#160;is&#160;for&#160;internal&#160;use,&#160;both&#160;to&#160;</p>
<p style="position:absolute;top:596px;left:137px;white-space:nowrap" class="ft4017">check&#160;for&#160;duplicates&#160;and&#160;to&#160;have&#160;a&#160;list&#160;of&#160;the&#160;negotiated&#160;extensions.</p>
<p style="position:absolute;top:642px;left:83px;white-space:nowrap" class="ft4036"><i><b>3.1.3&#160;&#160;</b></i></p>
<p style="position:absolute;top:642px;left:156px;white-space:nowrap" class="ft4040"><b>Workflow</b></p>
<p style="position:absolute;top:672px;left:83px;white-space:nowrap" class="ft4019">The&#160;workflow&#160;of&#160;the&#160;framework&#160;with&#160;respect&#160;to&#160;the&#160;TLS&#160;Handshake&#160;is&#160;depicted&#160;in<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#41">&#160;Figure<br/>4.</a></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft4021">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft4021">11/61</p>
</div>
<!-- Page 41 -->
<a name="41"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page41-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3041.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft419">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft410">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft4121">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft4121">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:685px;left:110px;white-space:nowrap" class="ft4117">1.&#160;If&#160;the&#160;Client&#160;registers&#160;a&#160;</p>
<p style="position:absolute;top:685px;left:332px;white-space:nowrap" class="ft4133"><b>TLSEXT_GENERAL</b></p>
<p style="position:absolute;top:685px;left:471px;white-space:nowrap" class="ft4117">&#160;object,&#160;then&#160;it&#160;is&#160;sent&#160;as&#160;part&#160;of&#160;the&#160;TLS&#160;</p>
<p style="position:absolute;top:704px;left:137px;white-space:nowrap" class="ft4119">Hello&#160;Extension&#160;within&#160;the&#160;ClientHello&#160;handshake&#160;message.<br/>The&#160;Server,&#160;on&#160;the&#160;contrary,&#160;is&#160;supposed&#160;to&#160;register&#160;all&#160;the&#160;</p>
<p style="position:absolute;top:723px;left:627px;white-space:nowrap" class="ft4133"><b>TLSEXT_GENERAL&#160;</b></p>
<p style="position:absolute;top:742px;left:137px;white-space:nowrap" class="ft4117">objects&#160;it&#160;wants&#160;to&#160;handle</p>
<p style="position:absolute;top:770px;left:110px;white-space:nowrap" class="ft4117">2.&#160;When&#160;the&#160;Server&#160;receives&#160;the&#160;ClientHello,&#160;it&#160;parses&#160;the&#160;TLS&#160;Hello&#160;Extensions&#160;and&#160;</p>
<p style="position:absolute;top:790px;left:137px;white-space:nowrap" class="ft4117">-&#160;if&#160;any&#160;is&#160;handled&#160;by&#160;the&#160;framework&#160;-&#160;it&#160;invokes&#160;the&#160;related&#160;</p>
<p style="position:absolute;top:790px;left:635px;white-space:nowrap" class="ft4133"><b>server_ext_cb()</b></p>
<p style="position:absolute;top:790px;left:784px;white-space:nowrap" class="ft4117">.</p>
<p style="position:absolute;top:809px;left:137px;white-space:nowrap" class="ft4119">This&#160;callback&#160;is&#160;in&#160;charge&#160;of&#160;taking&#160;the&#160;decision&#160;to&#160;reply&#160;or&#160;not&#160;to&#160;the&#160;extension,&#160;<br/>by&#160;setting&#160;the&#160;flag&#160;</p>
<p style="position:absolute;top:828px;left:294px;white-space:nowrap" class="ft4133"><b>server_send</b></p>
<p style="position:absolute;top:828px;left:403px;white-space:nowrap" class="ft4117">.</p>
<p style="position:absolute;top:856px;left:110px;white-space:nowrap" class="ft4117">3.&#160;The&#160;Server&#160;replies&#160;with&#160;the&#160;ServerHello&#160;message&#160;containing&#160;the&#160;accepted&#160;TLS&#160;</p>
<p style="position:absolute;top:875px;left:137px;white-space:nowrap" class="ft4117">Hello&#160;Extensions,&#160;for&#160;which&#160;the&#160;Client&#160;invokes&#160;the&#160;</p>
<p style="position:absolute;top:875px;left:552px;white-space:nowrap" class="ft4133"><b>client_ext_cb()</b></p>
<p style="position:absolute;top:875px;left:701px;white-space:nowrap" class="ft4117">.</p>
<p style="position:absolute;top:904px;left:110px;white-space:nowrap" class="ft4117">4.&#160;The&#160;Client&#160;verifies&#160;that&#160;every&#160;extension&#160;with&#160;</p>
<p style="position:absolute;top:904px;left:509px;white-space:nowrap" class="ft4133"><b>client_required</b></p>
<p style="position:absolute;top:904px;left:658px;white-space:nowrap" class="ft4117">&#160;flag&#160;set&#160;to&#160;true&#160;</p>
<p style="position:absolute;top:923px;left:137px;white-space:nowrap" class="ft4117">has&#160;been&#160;received.&#160;If&#160;not,&#160;it&#160;aborts&#160;the&#160;handshake.</p>
<p style="position:absolute;top:951px;left:110px;white-space:nowrap" class="ft4117">5.&#160;For&#160;each&#160;extension&#160;requiring&#160;supplemental&#160;data&#160;on&#160;server&#160;side,&#160;the&#160;server&#160;calls&#160;</p>
<p style="position:absolute;top:970px;left:137px;white-space:nowrap" class="ft4117">the&#160;</p>
<p style="position:absolute;top:970px;left:170px;white-space:nowrap" class="ft4133"><b>server_supp_data_cb()</b></p>
<p style="position:absolute;top:970px;left:378px;white-space:nowrap" class="ft4117">&#160;callback&#160;function&#160;which&#160;is&#160;in&#160;charge&#160;of&#160;creating&#160;the&#160;</p>
<p style="position:absolute;top:989px;left:137px;white-space:nowrap" class="ft4117">supplemental&#160;data&#160;payload.&#160;This&#160;data&#160;is&#160;pushed&#160;within&#160;the&#160;</p>
<p style="position:absolute;top:989px;left:627px;white-space:nowrap" class="ft4133"><b>server_supp_data&#160;</b></p>
<p style="position:absolute;top:1009px;left:137px;white-space:nowrap" class="ft4117">stack.&#160;Finally,&#160;if&#160;the&#160;</p>
<p style="position:absolute;top:1009px;left:304px;white-space:nowrap" class="ft4133"><b>server_supp_data</b></p>
<p style="position:absolute;top:1009px;left:463px;white-space:nowrap" class="ft4117">&#160;stack&#160;is&#160;not&#160;empty,&#160;the&#160;server&#160;</p>
<p style="position:absolute;top:1028px;left:137px;white-space:nowrap" class="ft4117">SupplementalData&#160;handshake&#160;message&#160;is&#160;sent.</p>
<p style="position:absolute;top:1056px;left:110px;white-space:nowrap" class="ft4125">6.&#160;The&#160;handshake&#160;continues&#160;until&#160;the&#160;ServerDone&#160;message.<br/>7.&#160;For&#160;each&#160;extension&#160;requiring&#160;supplemental&#160;data&#160;on&#160;client&#160;side,&#160;the&#160;client&#160;calls&#160;</p>
<p style="position:absolute;top:1103px;left:137px;white-space:nowrap" class="ft4117">the&#160;</p>
<p style="position:absolute;top:1103px;left:170px;white-space:nowrap" class="ft4133"><b>client_supp_data_cb()</b></p>
<p style="position:absolute;top:1103px;left:378px;white-space:nowrap" class="ft4117">&#160;callback&#160;function&#160;which&#160;is&#160;in&#160;charge&#160;of&#160;creating&#160;the&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft4121">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft4121">12/61</p>
<p style="position:absolute;top:637px;left:180px;white-space:nowrap" class="ft4117">Figure&#160;4:&#160;TLS&#160;Hello&#160;Extensions&#160;and&#160;Supplemental&#160;Data&#160;Workflow</p>
</div>
<!-- Page 42 -->
<a name="42"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4241{font-size:17px;font-family:KAAAAA+CourierNewPS;color:#000000;}
	.ft4242{font-size:17px;font-family:LAAAAA+CourierNewPS;color:#000000;}
	.ft4243{font-size:17px;font-family:MAAAAA+Arial;color:#000000;}
	.ft4244{font-size:17px;line-height:18px;font-family:KAAAAA+CourierNewPS;color:#000000;}
-->
</style>
<div id="page42-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3042.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft429">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft420">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft4221">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft4221">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft4217">supplemental&#160;data&#160;payload.&#160;This&#160;data&#160;is&#160;pushed&#160;within&#160;the&#160;</p>
<p style="position:absolute;top:149px;left:627px;white-space:nowrap" class="ft4233"><b>client_supp_data&#160;</b></p>
<p style="position:absolute;top:168px;left:137px;white-space:nowrap" class="ft4217">stack.&#160;Finally,&#160;if&#160;the&#160;</p>
<p style="position:absolute;top:168px;left:304px;white-space:nowrap" class="ft4233"><b>client_supp_data</b></p>
<p style="position:absolute;top:168px;left:463px;white-space:nowrap" class="ft4217">&#160;stack&#160;is&#160;not&#160;empty,&#160;the&#160;client&#160;</p>
<p style="position:absolute;top:188px;left:137px;white-space:nowrap" class="ft4217">SupplementalData&#160;handshake&#160;message&#160;is&#160;sent.</p>
<p style="position:absolute;top:216px;left:110px;white-space:nowrap" class="ft4225">8.&#160;The&#160;handshake&#160;continues&#160;until&#160;its&#160;conclusion.<br/>9.&#160;After&#160;the&#160;handshake&#160;is&#160;terminated&#160;the&#160;Client&#160;(respectively&#160;the&#160;Server),&#160;invokes&#160;</p>
<p style="position:absolute;top:263px;left:137px;white-space:nowrap" class="ft4217">the&#160;</p>
<p style="position:absolute;top:263px;left:170px;white-space:nowrap" class="ft4233"><b>client_finish_cb()</b></p>
<p style="position:absolute;top:263px;left:349px;white-space:nowrap" class="ft4217">&#160;(respectively&#160;the&#160;</p>
<p style="position:absolute;top:263px;left:499px;white-space:nowrap" class="ft4233"><b>server_finish_cb()</b></p>
<p style="position:absolute;top:263px;left:678px;white-space:nowrap" class="ft4217">),&#160;for&#160;each&#160;</p>
<p style="position:absolute;top:282px;left:137px;white-space:nowrap" class="ft4219">negotiated&#160;extension.&#160;These&#160;callback&#160;functions&#160;are&#160;in&#160;charge&#160;of&#160;evaluating&#160;the&#160;<br/>supplemental&#160;data&#160;received.</p>
<p style="position:absolute;top:348px;left:83px;white-space:nowrap" class="ft4234"><i><b>3.2&#160;&#160;&#160;Application&#160;Programming&#160;Interface</b></i></p>
<p style="position:absolute;top:397px;left:83px;white-space:nowrap" class="ft4236"><i><b>3.2.1&#160;&#160;&#160;Interface</b></i></p>
<p style="position:absolute;top:427px;left:83px;white-space:nowrap" class="ft4217">These&#160;functions&#160;are&#160;needed&#160;by&#160;the&#160;developers&#160;that&#160;want&#160;to&#160;write&#160;new&#160;TLS&#160;Extensions.</p>
<p style="position:absolute;top:455px;left:83px;white-space:nowrap" class="ft4241"><b>TLSEXT_GENERAL* SSL_TLSEXT_GENERAL_new (int&#160;</b></p>
<p style="position:absolute;top:455px;left:519px;white-space:nowrap" class="ft4242"><i><b>type</b></i></p>
<p style="position:absolute;top:455px;left:559px;white-space:nowrap" class="ft4241"><b>)</b></p>
<p style="position:absolute;top:474px;left:137px;white-space:nowrap" class="ft4217">Creates&#160;a&#160;new&#160;extension&#160;of&#160;type&#160;</p>
<p style="position:absolute;top:474px;left:410px;white-space:nowrap" class="ft4233"><b>type</b></p>
<p style="position:absolute;top:474px;left:449px;white-space:nowrap" class="ft4217">&#160;.</p>
<p style="position:absolute;top:503px;left:137px;white-space:nowrap" class="ft4243"><b>Parameters:</b></p>
<p style="position:absolute;top:530px;left:137px;white-space:nowrap" class="ft4239"><i>type</i></p>
<p style="position:absolute;top:530px;left:174px;white-space:nowrap" class="ft4217">&#160;extension&#160;type&#160;(SHOULD&#160;be&#160;defined&#160;by&#160;IANA)&#160;</p>
<p style="position:absolute;top:559px;left:137px;white-space:nowrap" class="ft4243"><b>Returns:</b></p>
<p style="position:absolute;top:586px;left:137px;white-space:nowrap" class="ft4217">the&#160;extension&#160;created&#160;</p>
<p style="position:absolute;top:614px;left:83px;white-space:nowrap" class="ft4244"><b>SUPP_DATA_ENTRY* SSL_TLSEXT_GENERAL_client_supp_data_new (TLSEXT_GENERAL&#160;<br/>*&#160;</b></p>
<p style="position:absolute;top:633px;left:103px;white-space:nowrap" class="ft4242"><i><b>ext</b></i></p>
<p style="position:absolute;top:633px;left:133px;white-space:nowrap" class="ft4241"><b>, &#160; int&#160;</b></p>
<p style="position:absolute;top:633px;left:212px;white-space:nowrap" class="ft4242"><i><b>type</b></i></p>
<p style="position:absolute;top:633px;left:252px;white-space:nowrap" class="ft4241"><b>)</b></p>
<p style="position:absolute;top:652px;left:137px;white-space:nowrap" class="ft4217">Creates&#160;a&#160;new&#160;supplemental&#160;data&#160;entry&#160;of&#160;type&#160;</p>
<p style="position:absolute;top:652px;left:533px;white-space:nowrap" class="ft4233"><b>type</b></p>
<p style="position:absolute;top:652px;left:573px;white-space:nowrap" class="ft4217">&#160;&#160;and&#160;pushes&#160;it&#160;in&#160;the&#160;</p>
<p style="position:absolute;top:671px;left:137px;white-space:nowrap" class="ft4233"><b>Client</b></p>
<p style="position:absolute;top:671px;left:196px;white-space:nowrap" class="ft4217">&#160;&#160;stack&#160;of&#160;a&#160;TLSEXT_GENERAL&#160;object&#160;</p>
<p style="position:absolute;top:671px;left:501px;white-space:nowrap" class="ft4233"><b>ext</b></p>
<p style="position:absolute;top:671px;left:531px;white-space:nowrap" class="ft4217">&#160;.</p>
<p style="position:absolute;top:700px;left:137px;white-space:nowrap" class="ft4243"><b>Parameters:</b></p>
<p style="position:absolute;top:727px;left:137px;white-space:nowrap" class="ft4239"><i>ext</i></p>
<p style="position:absolute;top:727px;left:163px;white-space:nowrap" class="ft4217">&#160;TLSEXT_GENERAL&#160;object&#160;containing&#160;the&#160;Supplemental&#160;Data&#160;stack&#160;</p>
<p style="position:absolute;top:755px;left:137px;white-space:nowrap" class="ft4239"><i>type</i></p>
<p style="position:absolute;top:755px;left:174px;white-space:nowrap" class="ft4217">&#160;extension&#160;type&#160;(SHOULD&#160;be&#160;defined&#160;by&#160;IANA)&#160;</p>
<p style="position:absolute;top:784px;left:137px;white-space:nowrap" class="ft4243"><b>Returns:</b></p>
<p style="position:absolute;top:812px;left:137px;white-space:nowrap" class="ft4217">the&#160;supplemental&#160;data&#160;entry&#160;created&#160;</p>
<p style="position:absolute;top:840px;left:83px;white-space:nowrap" class="ft4244"><b>SUPP_DATA_ENTRY* SSL_TLSEXT_GENERAL_server_supp_data_new (TLSEXT_GENERAL&#160;<br/>*&#160;</b></p>
<p style="position:absolute;top:859px;left:103px;white-space:nowrap" class="ft4242"><i><b>ext</b></i></p>
<p style="position:absolute;top:859px;left:133px;white-space:nowrap" class="ft4241"><b>, &#160; int&#160;</b></p>
<p style="position:absolute;top:859px;left:212px;white-space:nowrap" class="ft4242"><i><b>type</b></i></p>
<p style="position:absolute;top:859px;left:252px;white-space:nowrap" class="ft4241"><b>)</b></p>
<p style="position:absolute;top:877px;left:137px;white-space:nowrap" class="ft4217">Creates&#160;a&#160;new&#160;supplemental&#160;data&#160;entry&#160;of&#160;type&#160;</p>
<p style="position:absolute;top:877px;left:533px;white-space:nowrap" class="ft4233"><b>type</b></p>
<p style="position:absolute;top:877px;left:573px;white-space:nowrap" class="ft4217">&#160;&#160;and&#160;pushes&#160;it&#160;in&#160;the&#160;</p>
<p style="position:absolute;top:896px;left:137px;white-space:nowrap" class="ft4233"><b>Server</b></p>
<p style="position:absolute;top:896px;left:196px;white-space:nowrap" class="ft4217">&#160;&#160;stack&#160;of&#160;a&#160;TLSEXT_GENERAL&#160;object&#160;</p>
<p style="position:absolute;top:896px;left:501px;white-space:nowrap" class="ft4233"><b>ext</b></p>
<p style="position:absolute;top:896px;left:531px;white-space:nowrap" class="ft4217">&#160;.</p>
<p style="position:absolute;top:925px;left:137px;white-space:nowrap" class="ft4243"><b>Parameters:</b></p>
<p style="position:absolute;top:952px;left:137px;white-space:nowrap" class="ft4239"><i>ext</i></p>
<p style="position:absolute;top:952px;left:163px;white-space:nowrap" class="ft4217">&#160;TLSEXT_GENERAL&#160;object&#160;containing&#160;the&#160;Supplemental&#160;Data&#160;stack&#160;</p>
<p style="position:absolute;top:981px;left:137px;white-space:nowrap" class="ft4239"><i>type</i></p>
<p style="position:absolute;top:981px;left:174px;white-space:nowrap" class="ft4217">&#160;extension&#160;type&#160;(SHOULD&#160;be&#160;defined&#160;by&#160;IANA)&#160;</p>
<p style="position:absolute;top:1009px;left:137px;white-space:nowrap" class="ft4243"><b>Returns:</b></p>
<p style="position:absolute;top:1037px;left:137px;white-space:nowrap" class="ft4217">the&#160;supplemental&#160;data&#160;entry&#160;created&#160;</p>
<p style="position:absolute;top:1065px;left:83px;white-space:nowrap" class="ft4241"><b>int SSL_TLSEXT_GENERAL_init_cb (TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:1065px;left:569px;white-space:nowrap" class="ft4242"><i><b>ext</b></i></p>
<p style="position:absolute;top:1065px;left:598px;white-space:nowrap" class="ft4241"><b>, &#160; void *&#160;</b></p>
<p style="position:absolute;top:1065px;left:707px;white-space:nowrap" class="ft4242"><i><b>cb_ptr</b></i></p>
<p style="position:absolute;top:1065px;left:767px;white-space:nowrap" class="ft4241"><b>)</b></p>
<p style="position:absolute;top:1084px;left:137px;white-space:nowrap" class="ft4225">Sets&#160;the&#160;init&#160;callback&#160;function&#160;for&#160;a&#160;given&#160;extension.<br/>The&#160;callback&#160;function&#160;will&#160;be&#160;executed&#160;at&#160;the&#160;moment&#160;of&#160;the&#160;initialization&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft4221">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft4221">13/61</p>
</div>
<!-- Page 43 -->
<a name="43"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page43-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3043.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft439">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft430">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft4321">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft4321">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft4317">extension.</p>
<p style="position:absolute;top:178px;left:137px;white-space:nowrap" class="ft4343"><b>Parameters:</b></p>
<p style="position:absolute;top:205px;left:137px;white-space:nowrap" class="ft4339"><i>ext</i></p>
<p style="position:absolute;top:205px;left:163px;white-space:nowrap" class="ft4317">&#160;extension&#160;to&#160;associate&#160;with&#160;the&#160;callback&#160;</p>
<p style="position:absolute;top:234px;left:137px;white-space:nowrap" class="ft4339"><i>cb_ptr</i></p>
<p style="position:absolute;top:234px;left:188px;white-space:nowrap" class="ft4317">&#160;pointer&#160;to&#160;the&#160;callback&#160;function&#160;</p>
<p style="position:absolute;top:262px;left:137px;white-space:nowrap" class="ft4343"><b>Returns:</b></p>
<p style="position:absolute;top:290px;left:137px;white-space:nowrap" class="ft4325">0&#160;success&#160;<br/>-1&#160;error&#160;</p>
<p style="position:absolute;top:346px;left:83px;white-space:nowrap" class="ft4341"><b>TLSEXT_GENERAL* SSL_TLSEXT_GENERAL_init (SSL *&#160;</b></p>
<p style="position:absolute;top:346px;left:549px;white-space:nowrap" class="ft4342"><i><b>s</b></i></p>
<p style="position:absolute;top:346px;left:559px;white-space:nowrap" class="ft4341"><b>, &#160; TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:346px;left:767px;white-space:nowrap" class="ft4342"><i><b>ext</b></i></p>
<p style="position:absolute;top:346px;left:796px;white-space:nowrap" class="ft4341"><b>)</b></p>
<p style="position:absolute;top:365px;left:137px;white-space:nowrap" class="ft4319">Initialization&#160;function&#160;that&#160;makes&#160;basic&#160;checks&#160;common&#160;to&#160;all&#160;the&#160;extension.<br/>The&#160;server&#160;extensions&#160;are&#160;enabled&#160;by&#160;default,&#160;while&#160;the&#160;client&#160;extensions&#160;are&#160;<br/>not.&#160;It&#160;SHOULD&#160;be&#160;called&#160;by&#160;the&#160;constructor&#160;of&#160;each&#160;extension.</p>
<p style="position:absolute;top:441px;left:137px;white-space:nowrap" class="ft4343"><b>Parameters:</b></p>
<p style="position:absolute;top:468px;left:137px;white-space:nowrap" class="ft4339"><i>ext</i></p>
<p style="position:absolute;top:468px;left:163px;white-space:nowrap" class="ft4317">&#160;extension&#160;to&#160;initialize&#160;</p>
<p style="position:absolute;top:497px;left:137px;white-space:nowrap" class="ft4339"><i>s</i></p>
<p style="position:absolute;top:497px;left:145px;white-space:nowrap" class="ft4317">&#160;a&#160;pointer&#160;to&#160;a&#160;SSL&#160;object&#160;</p>
<p style="position:absolute;top:525px;left:137px;white-space:nowrap" class="ft4343"><b>Returns:</b></p>
<p style="position:absolute;top:553px;left:137px;white-space:nowrap" class="ft4325">the&#160;extension&#160;success&#160;<br/>NULL&#160;error&#160;</p>
<p style="position:absolute;top:609px;left:83px;white-space:nowrap" class="ft4341"><b>TLSEXT_GENERAL* SSL_CTX_tlsext_get_extension (SSL_CTX *&#160;</b></p>
<p style="position:absolute;top:609px;left:638px;white-space:nowrap" class="ft4342"><i><b>ctx</b></i></p>
<p style="position:absolute;top:609px;left:668px;white-space:nowrap" class="ft4341"><b>, &#160; int&#160;</b></p>
<p style="position:absolute;top:609px;left:747px;white-space:nowrap" class="ft4342"><i><b>type</b></i></p>
<p style="position:absolute;top:609px;left:786px;white-space:nowrap" class="ft4341"><b>)</b></p>
<p style="position:absolute;top:628px;left:137px;white-space:nowrap" class="ft4317">Returns&#160;a&#160;pointer&#160;to&#160;an&#160;extension</p>
<p style="position:absolute;top:657px;left:137px;white-space:nowrap" class="ft4343"><b>Parameters:</b></p>
<p style="position:absolute;top:684px;left:137px;white-space:nowrap" class="ft4339"><i>ctx</i></p>
<p style="position:absolute;top:684px;left:162px;white-space:nowrap" class="ft4317">&#160;a&#160;pointer&#160;to&#160;a&#160;SSL_CTX&#160;object&#160;</p>
<p style="position:absolute;top:712px;left:137px;white-space:nowrap" class="ft4339"><i>type</i></p>
<p style="position:absolute;top:712px;left:174px;white-space:nowrap" class="ft4317">&#160;the&#160;type&#160;of&#160;the&#160;extension&#160;to&#160;be&#160;returned&#160;</p>
<p style="position:absolute;top:741px;left:137px;white-space:nowrap" class="ft4343"><b>Returns:</b></p>
<p style="position:absolute;top:768px;left:137px;white-space:nowrap" class="ft4325">the&#160;extension&#160;success&#160;<br/>NULL&#160;error&#160;</p>
<p style="position:absolute;top:825px;left:83px;white-space:nowrap" class="ft4341"><b>int SSL_TLSEXT_GENERAL_client_data (TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:825px;left:608px;white-space:nowrap" class="ft4342"><i><b>ext</b></i></p>
<p style="position:absolute;top:825px;left:638px;white-space:nowrap" class="ft4341"><b>, &#160; unsigned int&#160;</b></p>
<p style="position:absolute;top:844px;left:83px;white-space:nowrap" class="ft4342"><i><b>length</b></i></p>
<p style="position:absolute;top:844px;left:143px;white-space:nowrap" class="ft4341"><b>, &#160; unsigned char *&#160;</b></p>
<p style="position:absolute;top:844px;left:341px;white-space:nowrap" class="ft4342"><i><b>data</b></i></p>
<p style="position:absolute;top:844px;left:380px;white-space:nowrap" class="ft4341"><b>)</b></p>
<p style="position:absolute;top:862px;left:137px;white-space:nowrap" class="ft4317">Sets&#160;the&#160;client&#160;data&#160;to&#160;send&#160;within&#160;the&#160;extension&#160;</p>
<p style="position:absolute;top:862px;left:543px;white-space:nowrap" class="ft4333"><b>ext</b></p>
<p style="position:absolute;top:862px;left:573px;white-space:nowrap" class="ft4317">&#160;&#160;(Client&#160;Hello).</p>
<p style="position:absolute;top:891px;left:137px;white-space:nowrap" class="ft4343"><b>Parameters:</b></p>
<p style="position:absolute;top:918px;left:137px;white-space:nowrap" class="ft4339"><i>ext</i></p>
<p style="position:absolute;top:918px;left:163px;white-space:nowrap" class="ft4317">&#160;extension&#160;to&#160;set.&#160;It&#160;SHOULD&#160;be&#160;initialized&#160;with&#160;</p>
<p style="position:absolute;top:918px;left:554px;white-space:nowrap" class="ft4333"><b>SSL_TLSEXT_GENERAL_new()</b></p>
<p style="position:absolute;top:918px;left:793px;white-space:nowrap" class="ft4317">&#160;</p>
<p style="position:absolute;top:946px;left:137px;white-space:nowrap" class="ft4339"><i>length</i></p>
<p style="position:absolute;top:946px;left:189px;white-space:nowrap" class="ft4317">&#160;lenght&#160;of&#160;</p>
<p style="position:absolute;top:946px;left:274px;white-space:nowrap" class="ft4333"><b>data</b></p>
<p style="position:absolute;top:946px;left:313px;white-space:nowrap" class="ft4317">&#160;&#160;</p>
<p style="position:absolute;top:975px;left:137px;white-space:nowrap" class="ft4339"><i>data</i></p>
<p style="position:absolute;top:975px;left:174px;white-space:nowrap" class="ft4317">&#160;data&#160;to&#160;transmit&#160;within&#160;the&#160;extension&#160;</p>
<p style="position:absolute;top:1003px;left:137px;white-space:nowrap" class="ft4343"><b>Returns:</b></p>
<p style="position:absolute;top:1031px;left:137px;white-space:nowrap" class="ft4325">0&#160;success&#160;<br/>-1&#160;error&#160;</p>
<p style="position:absolute;top:1087px;left:83px;white-space:nowrap" class="ft4341"><b>int SSL_TLSEXT_GENERAL_client_supp_data (TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:1087px;left:658px;white-space:nowrap" class="ft4342"><i><b>ext</b></i></p>
<p style="position:absolute;top:1087px;left:687px;white-space:nowrap" class="ft4341"><b>, &#160; int&#160;</b></p>
<p style="position:absolute;top:1106px;left:83px;white-space:nowrap" class="ft4342"><i><b>type</b></i></p>
<p style="position:absolute;top:1106px;left:123px;white-space:nowrap" class="ft4341"><b>, &#160; unsigned int&#160;</b></p>
<p style="position:absolute;top:1106px;left:291px;white-space:nowrap" class="ft4342"><i><b>length</b></i></p>
<p style="position:absolute;top:1106px;left:351px;white-space:nowrap" class="ft4341"><b>, &#160; unsigned char *&#160;</b></p>
<p style="position:absolute;top:1106px;left:549px;white-space:nowrap" class="ft4342"><i><b>data</b></i></p>
<p style="position:absolute;top:1106px;left:588px;white-space:nowrap" class="ft4341"><b>)</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft4321">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft4321">14/61</p>
</div>
<!-- Page 44 -->
<a name="44"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page44-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3044.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft449">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft440">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft4421">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft4421">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft4417">Sets&#160;a&#160;client&#160;supplemental&#160;data&#160;entry&#160;related&#160;to&#160;the&#160;extension&#160;</p>
<p style="position:absolute;top:149px;left:657px;white-space:nowrap" class="ft4433"><b>ext</b></p>
<p style="position:absolute;top:149px;left:687px;white-space:nowrap" class="ft4417">&#160;.</p>
<p style="position:absolute;top:177px;left:137px;white-space:nowrap" class="ft4417">The&#160;supplemental&#160;data&#160;entry&#160;MUST&#160;be&#160;created&#160;with&#160;</p>
<p style="position:absolute;top:197px;left:137px;white-space:nowrap" class="ft4433"><b>SSL_TLSEXT_GENERAL_client_supp_data_new()</b></p>
<p style="position:absolute;top:197px;left:544px;white-space:nowrap" class="ft4417">&#160;before&#160;setting&#160;its&#160;payload.&#160;It&#160;</p>
<p style="position:absolute;top:216px;left:137px;white-space:nowrap" class="ft4417">will&#160;be&#160;transmitted&#160;within&#160;the&#160;Supplemental&#160;Data&#160;handshake&#160;message.</p>
<p style="position:absolute;top:245px;left:137px;white-space:nowrap" class="ft4443"><b>Parameters:</b></p>
<p style="position:absolute;top:272px;left:137px;white-space:nowrap" class="ft4439"><i>ext</i></p>
<p style="position:absolute;top:272px;left:163px;white-space:nowrap" class="ft4417">&#160;extension&#160;to&#160;set&#160;the&#160;supplemental&#160;data&#160;entry&#160;into&#160;</p>
<p style="position:absolute;top:300px;left:137px;white-space:nowrap" class="ft4439"><i>type</i></p>
<p style="position:absolute;top:300px;left:174px;white-space:nowrap" class="ft4417">&#160;the&#160;type&#160;of&#160;the&#160;supplemental&#160;data&#160;entry.&#160;It&#160;MUST&#160;be&#160;registered&#160;before&#160;with&#160;</p>
<p style="position:absolute;top:319px;left:137px;white-space:nowrap" class="ft4433"><b>SSL_TLSEXT_GENERAL_client_supp_data_new()</b></p>
<p style="position:absolute;top:319px;left:544px;white-space:nowrap" class="ft4417">&#160;</p>
<p style="position:absolute;top:348px;left:137px;white-space:nowrap" class="ft4439"><i>length</i></p>
<p style="position:absolute;top:348px;left:189px;white-space:nowrap" class="ft4417">&#160;lenght&#160;of&#160;</p>
<p style="position:absolute;top:348px;left:274px;white-space:nowrap" class="ft4433"><b>data</b></p>
<p style="position:absolute;top:348px;left:313px;white-space:nowrap" class="ft4417">&#160;&#160;</p>
<p style="position:absolute;top:376px;left:137px;white-space:nowrap" class="ft4439"><i>data</i></p>
<p style="position:absolute;top:376px;left:174px;white-space:nowrap" class="ft4417">&#160;data&#160;to&#160;transmit&#160;within&#160;the&#160;supplemental&#160;data&#160;</p>
<p style="position:absolute;top:404px;left:137px;white-space:nowrap" class="ft4443"><b>Returns:</b></p>
<p style="position:absolute;top:432px;left:137px;white-space:nowrap" class="ft4425">0&#160;success&#160;<br/>-1&#160;error&#160;</p>
<p style="position:absolute;top:488px;left:83px;white-space:nowrap" class="ft4441"><b>int SSL_TLSEXT_GENERAL_client_ctx_set (TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:488px;left:638px;white-space:nowrap" class="ft4442"><i><b>ext</b></i></p>
<p style="position:absolute;top:488px;left:668px;white-space:nowrap" class="ft4441"><b>, &#160; void *&#160;</b></p>
<p style="position:absolute;top:507px;left:83px;white-space:nowrap" class="ft4442"><i><b>ctx_data</b></i></p>
<p style="position:absolute;top:507px;left:163px;white-space:nowrap" class="ft4441"><b>)</b></p>
<p style="position:absolute;top:526px;left:137px;white-space:nowrap" class="ft4425">Sets&#160;the&#160;context&#160;data&#160;available&#160;to&#160;the&#160;client&#160;within&#160;the&#160;callback&#160;functions.<br/>The&#160;context&#160;data&#160;can&#160;be&#160;used&#160;to&#160;exchange&#160;data&#160;from/to&#160;the&#160;application&#160;and&#160;</p>
<p style="position:absolute;top:573px;left:137px;white-space:nowrap" class="ft4433"><b>libssl</b></p>
<p style="position:absolute;top:573px;left:196px;white-space:nowrap" class="ft4417">&#160;&#160;and&#160;is&#160;usually&#160;used&#160;within&#160;callback&#160;functions.</p>
<p style="position:absolute;top:602px;left:137px;white-space:nowrap" class="ft4443"><b>Parameters:</b></p>
<p style="position:absolute;top:629px;left:137px;white-space:nowrap" class="ft4439"><i>ext</i></p>
<p style="position:absolute;top:629px;left:163px;white-space:nowrap" class="ft4417">&#160;extension&#160;to&#160;set.&#160;It&#160;SHOULD&#160;be&#160;initialized&#160;with&#160;</p>
<p style="position:absolute;top:629px;left:554px;white-space:nowrap" class="ft4433"><b>SSL_TLSEXT_GENERAL_new()</b></p>
<p style="position:absolute;top:629px;left:793px;white-space:nowrap" class="ft4417">&#160;</p>
<p style="position:absolute;top:657px;left:137px;white-space:nowrap" class="ft4439"><i>ctx_data</i></p>
<p style="position:absolute;top:657px;left:207px;white-space:nowrap" class="ft4417">&#160;pointer&#160;to&#160;the&#160;context&#160;data.&#160;SHOULD&#160;be&#160;casted&#160;to&#160;</p>
<p style="position:absolute;top:657px;left:629px;white-space:nowrap" class="ft4433"><b>(void&#160;*)</b></p>
<p style="position:absolute;top:657px;left:709px;white-space:nowrap" class="ft4417">&#160;&#160;</p>
<p style="position:absolute;top:686px;left:137px;white-space:nowrap" class="ft4443"><b>Returns:</b></p>
<p style="position:absolute;top:714px;left:137px;white-space:nowrap" class="ft4425">0&#160;success&#160;<br/>-1&#160;error&#160;</p>
<p style="position:absolute;top:770px;left:83px;white-space:nowrap" class="ft4441"><b>void* SSL_TLSEXT_GENERAL_client_ctx_get (TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:770px;left:658px;white-space:nowrap" class="ft4442"><i><b>ext</b></i></p>
<p style="position:absolute;top:770px;left:687px;white-space:nowrap" class="ft4441"><b>)</b></p>
<p style="position:absolute;top:789px;left:137px;white-space:nowrap" class="ft4425">Returns&#160;the&#160;context&#160;data&#160;available&#160;to&#160;the&#160;client.<br/>The&#160;context&#160;data&#160;can&#160;be&#160;used&#160;to&#160;exchange&#160;data&#160;from/to&#160;the&#160;application&#160;and&#160;</p>
<p style="position:absolute;top:836px;left:137px;white-space:nowrap" class="ft4433"><b>libssl</b></p>
<p style="position:absolute;top:836px;left:196px;white-space:nowrap" class="ft4417">&#160;&#160;and&#160;is&#160;usually&#160;used&#160;within&#160;callback&#160;functions.&#160;The&#160;result&#160;need&#160;to&#160;be&#160;</p>
<p style="position:absolute;top:855px;left:137px;white-space:nowrap" class="ft4417">casted&#160;to&#160;the&#160;proper&#160;type.</p>
<p style="position:absolute;top:884px;left:137px;white-space:nowrap" class="ft4443"><b>Parameters:</b></p>
<p style="position:absolute;top:912px;left:137px;white-space:nowrap" class="ft4439"><i>ext</i></p>
<p style="position:absolute;top:912px;left:163px;white-space:nowrap" class="ft4417">&#160;extension&#160;to&#160;get&#160;from&#160;</p>
<p style="position:absolute;top:940px;left:137px;white-space:nowrap" class="ft4443"><b>Returns:</b></p>
<p style="position:absolute;top:968px;left:137px;white-space:nowrap" class="ft4417">the&#160;context&#160;data.&#160;It&#160;SHOULD&#160;be&#160;casted&#160;to&#160;the&#160;proper&#160;type&#160;</p>
<p style="position:absolute;top:996px;left:137px;white-space:nowrap" class="ft4433"><b>NULL</b></p>
<p style="position:absolute;top:996px;left:176px;white-space:nowrap" class="ft4417">&#160;&#160;error&#160;</p>
<p style="position:absolute;top:1024px;left:83px;white-space:nowrap" class="ft4441"><b>int SSL_TLSEXT_GENERAL_client_ext_cb (TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:1024px;left:628px;white-space:nowrap" class="ft4442"><i><b>ext</b></i></p>
<p style="position:absolute;top:1024px;left:658px;white-space:nowrap" class="ft4441"><b>, &#160; void *&#160;</b></p>
<p style="position:absolute;top:1043px;left:83px;white-space:nowrap" class="ft4442"><i><b>cb_ptr</b></i></p>
<p style="position:absolute;top:1043px;left:143px;white-space:nowrap" class="ft4441"><b>)</b></p>
<p style="position:absolute;top:1061px;left:137px;white-space:nowrap" class="ft4417">Sets&#160;the&#160;callback&#160;function&#160;the&#160;client&#160;will&#160;use&#160;to&#160;handle&#160;the&#160;TLS&#160;Extension&#160;</p>
<p style="position:absolute;top:1061px;left:742px;white-space:nowrap" class="ft4433"><b>ext&#160;</b></p>
<p style="position:absolute;top:1081px;left:137px;white-space:nowrap" class="ft4425">(received&#160;within&#160;the&#160;Server&#160;Hello).<br/>The&#160;callback&#160;is&#160;called&#160;immediately&#160;after&#160;receiving&#160;the&#160;Server&#160;Hello,&#160;thus&#160;before&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft4421">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft4421">15/61</p>
</div>
<!-- Page 45 -->
<a name="45"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4545{font-size:17px;line-height:19px;font-family:FAAAAA+BitstreamVeraSansMono;color:#000000;}
-->
</style>
<div id="page45-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3045.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft459">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft450">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft4521">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft4521">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft4517">receiving&#160;any&#160;further&#160;message&#160;from&#160;the&#160;server.&#160;See&#160;</p>
<p style="position:absolute;top:168px;left:137px;white-space:nowrap" class="ft4533"><b>ssl_parse_serverhello_tlsext_general()</b></p>
<p style="position:absolute;top:168px;left:514px;white-space:nowrap" class="ft4517">&#160;for&#160;more&#160;details.</p>
<p style="position:absolute;top:197px;left:137px;white-space:nowrap" class="ft4517">The&#160;callback&#160;MUST&#160;have&#160;prototype:&#160;</p>
<p style="position:absolute;top:234px;left:137px;white-space:nowrap" class="ft4533"><b>&#160;void&#160;callback(SSL&#160;*,&#160;TLSEXT_GENERAL&#160;*);</b></p>
<p style="position:absolute;top:271px;left:137px;white-space:nowrap" class="ft4517">&#160;and&#160;MAY&#160;use&#160;context&#160;data&#160;to&#160;communication&#160;with&#160;the&#160;application.</p>
<p style="position:absolute;top:299px;left:137px;white-space:nowrap" class="ft4543"><b>Parameters:</b></p>
<p style="position:absolute;top:327px;left:137px;white-space:nowrap" class="ft4539"><i>ext</i></p>
<p style="position:absolute;top:327px;left:163px;white-space:nowrap" class="ft4517">&#160;extension&#160;to&#160;set.&#160;It&#160;SHOULD&#160;be&#160;initialized&#160;with&#160;</p>
<p style="position:absolute;top:327px;left:554px;white-space:nowrap" class="ft4533"><b>SSL_TLSEXT_GENERAL_new()</b></p>
<p style="position:absolute;top:327px;left:793px;white-space:nowrap" class="ft4517">&#160;</p>
<p style="position:absolute;top:355px;left:137px;white-space:nowrap" class="ft4539"><i>cb_ptr</i></p>
<p style="position:absolute;top:355px;left:188px;white-space:nowrap" class="ft4517">&#160;pointer&#160;to&#160;the&#160;callback&#160;function&#160;</p>
<p style="position:absolute;top:384px;left:137px;white-space:nowrap" class="ft4543"><b>Returns:</b></p>
<p style="position:absolute;top:411px;left:137px;white-space:nowrap" class="ft4525">0&#160;success&#160;<br/>-1&#160;error&#160;</p>
<p style="position:absolute;top:468px;left:83px;white-space:nowrap" class="ft4541"><b>int SSL_TLSEXT_GENERAL_client_supp_data_cb (TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:468px;left:687px;white-space:nowrap" class="ft4542"><i><b>ext</b></i></p>
<p style="position:absolute;top:468px;left:717px;white-space:nowrap" class="ft4541"><b>, &#160; void&#160;</b></p>
<p style="position:absolute;top:486px;left:83px;white-space:nowrap" class="ft4541"><b>*&#160;</b></p>
<p style="position:absolute;top:486px;left:103px;white-space:nowrap" class="ft4542"><i><b>cb_ptr</b></i></p>
<p style="position:absolute;top:486px;left:163px;white-space:nowrap" class="ft4541"><b>)</b></p>
<p style="position:absolute;top:505px;left:137px;white-space:nowrap" class="ft4525">Sets&#160;the&#160;callback&#160;function&#160;the&#160;client&#160;will&#160;use&#160;to&#160;create&#160;the&#160;supplemental&#160;data&#160;<br/>entry&#160;to&#160;send&#160;within&#160;the&#160;client's&#160;Supplemental&#160;Data&#160;message.<br/>The&#160;callback&#160;is&#160;called&#160;immediately&#160;before&#160;sending&#160;the&#160;Supplemental&#160;Data&#160;<br/>message&#160;and&#160;allows&#160;to&#160;access&#160;any&#160;data&#160;received&#160;from&#160;the&#160;server&#160;(e.g.&#160;<br/>supplemental&#160;data&#160;or&#160;certificate).<br/>The&#160;callback&#160;MUST&#160;have&#160;prototype:&#160;</p>
<p style="position:absolute;top:656px;left:137px;white-space:nowrap" class="ft4533"><b>&#160;void&#160;callback(SSL&#160;*,&#160;TLSEXT_GENERAL&#160;*);</b></p>
<p style="position:absolute;top:693px;left:137px;white-space:nowrap" class="ft4517">&#160;and&#160;MAY&#160;use&#160;context&#160;data&#160;to&#160;communication&#160;with&#160;the&#160;application.</p>
<p style="position:absolute;top:722px;left:137px;white-space:nowrap" class="ft4543"><b>Parameters:</b></p>
<p style="position:absolute;top:749px;left:137px;white-space:nowrap" class="ft4539"><i>ext</i></p>
<p style="position:absolute;top:749px;left:163px;white-space:nowrap" class="ft4517">&#160;extension&#160;to&#160;set.&#160;It&#160;SHOULD&#160;be&#160;initialized&#160;with&#160;</p>
<p style="position:absolute;top:749px;left:554px;white-space:nowrap" class="ft4533"><b>SSL_TLSEXT_GENERAL_new()</b></p>
<p style="position:absolute;top:749px;left:793px;white-space:nowrap" class="ft4517">&#160;</p>
<p style="position:absolute;top:778px;left:137px;white-space:nowrap" class="ft4539"><i>cb_ptr</i></p>
<p style="position:absolute;top:778px;left:188px;white-space:nowrap" class="ft4517">&#160;pointer&#160;to&#160;the&#160;callback&#160;function&#160;</p>
<p style="position:absolute;top:806px;left:137px;white-space:nowrap" class="ft4543"><b>Returns:</b></p>
<p style="position:absolute;top:834px;left:137px;white-space:nowrap" class="ft4525">0&#160;success&#160;<br/>-1&#160;error&#160;</p>
<p style="position:absolute;top:890px;left:83px;white-space:nowrap" class="ft4541"><b>int SSL_TLSEXT_GENERAL_client_finish_cb (TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:890px;left:658px;white-space:nowrap" class="ft4542"><i><b>ext</b></i></p>
<p style="position:absolute;top:890px;left:687px;white-space:nowrap" class="ft4541"><b>, &#160; void *&#160;</b></p>
<p style="position:absolute;top:909px;left:83px;white-space:nowrap" class="ft4542"><i><b>cb_ptr</b></i></p>
<p style="position:absolute;top:909px;left:143px;white-space:nowrap" class="ft4541"><b>)</b></p>
<p style="position:absolute;top:928px;left:137px;white-space:nowrap" class="ft4525">Sets&#160;the&#160;callback&#160;function&#160;the&#160;client&#160;will&#160;use&#160;to&#160;handle&#160;the&#160;supplemental&#160;data&#160;<br/>received&#160;from&#160;the&#160;server.<br/>The&#160;callback&#160;is&#160;called&#160;at&#160;the&#160;end&#160;of&#160;the&#160;handshake,&#160;according&#160;to&#160;RFC&#160;4680:&#160;</p>
<p style="position:absolute;top:1012px;left:137px;white-space:nowrap" class="ft4545"><b>Information&#160;provided&#160;in&#160;a&#160;supplemental&#160;data&#160;object&#160;MUST&#160;be&#160;intended&#160;<br/>to&#160;be&#160;used&#160;exclusively&#160;by&#160;applications&#160;and&#160;protocols&#160;above&#160;the&#160;TLS&#160;<br/>protocol&#160;layer.&#160;&#160;Any&#160;such&#160;data&#160;MUST&#160;NOT&#160;need&#160;to&#160;be&#160;processed&#160;by&#160;the&#160;<br/>TLS&#160;protocol.</b></p>
<p style="position:absolute;top:1107px;left:137px;white-space:nowrap" class="ft4517">&#160;The&#160;callback&#160;MUST&#160;have&#160;prototype:&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft4521">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft4521">16/61</p>
</div>
<!-- Page 46 -->
<a name="46"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page46-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3046.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft469">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft460">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft4621">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft4621">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft4633"><b>&#160;void&#160;callback(SSL&#160;*,&#160;TLSEXT_GENERAL&#160;*);</b></p>
<p style="position:absolute;top:186px;left:137px;white-space:nowrap" class="ft4617">&#160;and&#160;MAY&#160;use&#160;context&#160;data&#160;to&#160;communication&#160;with&#160;the&#160;application.</p>
<p style="position:absolute;top:215px;left:137px;white-space:nowrap" class="ft4643"><b>Parameters:</b></p>
<p style="position:absolute;top:242px;left:137px;white-space:nowrap" class="ft4639"><i>ext</i></p>
<p style="position:absolute;top:242px;left:163px;white-space:nowrap" class="ft4617">&#160;extension&#160;to&#160;set.&#160;It&#160;SHOULD&#160;be&#160;initialized&#160;with&#160;</p>
<p style="position:absolute;top:242px;left:554px;white-space:nowrap" class="ft4633"><b>SSL_TLSEXT_GENERAL_new()</b></p>
<p style="position:absolute;top:242px;left:793px;white-space:nowrap" class="ft4617">&#160;</p>
<p style="position:absolute;top:271px;left:137px;white-space:nowrap" class="ft4639"><i>cb_ptr</i></p>
<p style="position:absolute;top:271px;left:188px;white-space:nowrap" class="ft4617">&#160;pointer&#160;to&#160;the&#160;callback&#160;function&#160;</p>
<p style="position:absolute;top:299px;left:137px;white-space:nowrap" class="ft4643"><b>Returns:</b></p>
<p style="position:absolute;top:327px;left:137px;white-space:nowrap" class="ft4625">0&#160;success&#160;<br/>-1&#160;error&#160;</p>
<p style="position:absolute;top:383px;left:83px;white-space:nowrap" class="ft4641"><b>int SSL_TLSEXT_GENERAL_server_data (TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:383px;left:608px;white-space:nowrap" class="ft4642"><i><b>ext</b></i></p>
<p style="position:absolute;top:383px;left:638px;white-space:nowrap" class="ft4641"><b>, &#160; unsigned int&#160;</b></p>
<p style="position:absolute;top:402px;left:83px;white-space:nowrap" class="ft4642"><i><b>length</b></i></p>
<p style="position:absolute;top:402px;left:143px;white-space:nowrap" class="ft4641"><b>, &#160; unsigned char *&#160;</b></p>
<p style="position:absolute;top:402px;left:341px;white-space:nowrap" class="ft4642"><i><b>data</b></i></p>
<p style="position:absolute;top:402px;left:380px;white-space:nowrap" class="ft4641"><b>)</b></p>
<p style="position:absolute;top:421px;left:137px;white-space:nowrap" class="ft4617">Sets&#160;the&#160;server&#160;data&#160;to&#160;send&#160;within&#160;the&#160;extension&#160;</p>
<p style="position:absolute;top:421px;left:550px;white-space:nowrap" class="ft4633"><b>ext</b></p>
<p style="position:absolute;top:421px;left:580px;white-space:nowrap" class="ft4617">&#160;&#160;(Server&#160;Hello).</p>
<p style="position:absolute;top:449px;left:137px;white-space:nowrap" class="ft4643"><b>Parameters:</b></p>
<p style="position:absolute;top:477px;left:137px;white-space:nowrap" class="ft4639"><i>ext</i></p>
<p style="position:absolute;top:477px;left:163px;white-space:nowrap" class="ft4617">&#160;extension&#160;to&#160;set.&#160;It&#160;SHOULD&#160;be&#160;initialized&#160;with&#160;</p>
<p style="position:absolute;top:477px;left:554px;white-space:nowrap" class="ft4633"><b>SSL_TLSEXT_GENERAL_new()</b></p>
<p style="position:absolute;top:477px;left:793px;white-space:nowrap" class="ft4617">&#160;</p>
<p style="position:absolute;top:505px;left:137px;white-space:nowrap" class="ft4639"><i>length</i></p>
<p style="position:absolute;top:505px;left:189px;white-space:nowrap" class="ft4617">&#160;lenght&#160;of&#160;</p>
<p style="position:absolute;top:505px;left:274px;white-space:nowrap" class="ft4633"><b>data</b></p>
<p style="position:absolute;top:505px;left:313px;white-space:nowrap" class="ft4617">&#160;&#160;</p>
<p style="position:absolute;top:533px;left:137px;white-space:nowrap" class="ft4639"><i>data</i></p>
<p style="position:absolute;top:533px;left:174px;white-space:nowrap" class="ft4617">&#160;data&#160;to&#160;transmit&#160;within&#160;the&#160;extension&#160;</p>
<p style="position:absolute;top:562px;left:137px;white-space:nowrap" class="ft4643"><b>Returns:</b></p>
<p style="position:absolute;top:589px;left:137px;white-space:nowrap" class="ft4625">0&#160;success&#160;<br/>-1&#160;error&#160;</p>
<p style="position:absolute;top:646px;left:83px;white-space:nowrap" class="ft4641"><b>int SSL_TLSEXT_GENERAL_server_supp_data (TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:646px;left:658px;white-space:nowrap" class="ft4642"><i><b>ext</b></i></p>
<p style="position:absolute;top:646px;left:687px;white-space:nowrap" class="ft4641"><b>, &#160; int&#160;</b></p>
<p style="position:absolute;top:664px;left:83px;white-space:nowrap" class="ft4642"><i><b>type</b></i></p>
<p style="position:absolute;top:664px;left:123px;white-space:nowrap" class="ft4641"><b>, &#160; unsigned int&#160;</b></p>
<p style="position:absolute;top:664px;left:291px;white-space:nowrap" class="ft4642"><i><b>length</b></i></p>
<p style="position:absolute;top:664px;left:351px;white-space:nowrap" class="ft4641"><b>, &#160; unsigned char *&#160;</b></p>
<p style="position:absolute;top:664px;left:549px;white-space:nowrap" class="ft4642"><i><b>data</b></i></p>
<p style="position:absolute;top:664px;left:588px;white-space:nowrap" class="ft4641"><b>)</b></p>
<p style="position:absolute;top:683px;left:137px;white-space:nowrap" class="ft4617">Sets&#160;a&#160;server&#160;supplemental&#160;data&#160;entry&#160;related&#160;to&#160;the&#160;extension&#160;</p>
<p style="position:absolute;top:683px;left:664px;white-space:nowrap" class="ft4633"><b>ext</b></p>
<p style="position:absolute;top:683px;left:694px;white-space:nowrap" class="ft4617">&#160;.</p>
<p style="position:absolute;top:711px;left:137px;white-space:nowrap" class="ft4617">The&#160;supplemental&#160;data&#160;entry&#160;MUST&#160;be&#160;created&#160;with&#160;</p>
<p style="position:absolute;top:730px;left:137px;white-space:nowrap" class="ft4633"><b>SSL_TLSEXT_GENERAL_server_supp_data_new()</b></p>
<p style="position:absolute;top:730px;left:544px;white-space:nowrap" class="ft4617">&#160;before&#160;setting&#160;its&#160;payload.&#160;It&#160;</p>
<p style="position:absolute;top:750px;left:137px;white-space:nowrap" class="ft4617">will&#160;be&#160;transmitted&#160;within&#160;the&#160;Supplemental&#160;Data&#160;handshake&#160;message.</p>
<p style="position:absolute;top:778px;left:137px;white-space:nowrap" class="ft4643"><b>Parameters:</b></p>
<p style="position:absolute;top:806px;left:137px;white-space:nowrap" class="ft4639"><i>ext</i></p>
<p style="position:absolute;top:806px;left:163px;white-space:nowrap" class="ft4617">&#160;extension&#160;to&#160;set&#160;the&#160;supplemental&#160;data&#160;entry&#160;into</p>
<p style="position:absolute;top:834px;left:137px;white-space:nowrap" class="ft4639"><i>type</i></p>
<p style="position:absolute;top:834px;left:174px;white-space:nowrap" class="ft4617">&#160;the&#160;type&#160;of&#160;the&#160;supplemental&#160;data&#160;entry.&#160;It&#160;MUST&#160;be&#160;registered&#160;before&#160;with&#160;</p>
<p style="position:absolute;top:853px;left:137px;white-space:nowrap" class="ft4633"><b>SSL_TLSEXT_GENERAL_server_supp_data_new()</b></p>
<p style="position:absolute;top:881px;left:137px;white-space:nowrap" class="ft4639"><i>length</i></p>
<p style="position:absolute;top:881px;left:189px;white-space:nowrap" class="ft4617">&#160;lenght&#160;of&#160;</p>
<p style="position:absolute;top:881px;left:274px;white-space:nowrap" class="ft4633"><b>data</b></p>
<p style="position:absolute;top:910px;left:137px;white-space:nowrap" class="ft4639"><i>data</i></p>
<p style="position:absolute;top:910px;left:174px;white-space:nowrap" class="ft4617">&#160;data&#160;to&#160;transmit&#160;within&#160;the&#160;supplemental&#160;data</p>
<p style="position:absolute;top:938px;left:137px;white-space:nowrap" class="ft4643"><b>Returns:</b></p>
<p style="position:absolute;top:966px;left:137px;white-space:nowrap" class="ft4625">0&#160;success<br/>-1&#160;error</p>
<p style="position:absolute;top:1022px;left:83px;white-space:nowrap" class="ft4641"><b>int SSL_TLSEXT_GENERAL_server_ctx_set (TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:1022px;left:638px;white-space:nowrap" class="ft4642"><i><b>ext</b></i></p>
<p style="position:absolute;top:1022px;left:668px;white-space:nowrap" class="ft4641"><b>, &#160; void *&#160;</b></p>
<p style="position:absolute;top:1041px;left:83px;white-space:nowrap" class="ft4642"><i><b>ctx_data</b></i></p>
<p style="position:absolute;top:1041px;left:163px;white-space:nowrap" class="ft4641"><b>)</b></p>
<p style="position:absolute;top:1060px;left:137px;white-space:nowrap" class="ft4619">Sets&#160;the&#160;context&#160;data&#160;available&#160;to&#160;the&#160;server&#160;within&#160;the&#160;callback&#160;functions.&#160;The&#160;<br/>context&#160;data&#160;can&#160;be&#160;used&#160;to&#160;exchange&#160;data&#160;from/to&#160;the&#160;application&#160;and&#160;</p>
<p style="position:absolute;top:1079px;left:734px;white-space:nowrap" class="ft4633"><b>libssl&#160;</b></p>
<p style="position:absolute;top:1098px;left:137px;white-space:nowrap" class="ft4617">and&#160;is&#160;usually&#160;used&#160;within&#160;callback&#160;functions.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft4621">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft4621">17/61</p>
</div>
<!-- Page 47 -->
<a name="47"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page47-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3047.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft479">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft470">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft4721">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft4721">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:150px;left:137px;white-space:nowrap" class="ft4743"><b>Parameters:</b></p>
<p style="position:absolute;top:177px;left:137px;white-space:nowrap" class="ft4739"><i>ext</i></p>
<p style="position:absolute;top:177px;left:163px;white-space:nowrap" class="ft4717">&#160;extension&#160;to&#160;set.&#160;It&#160;SHOULD&#160;be&#160;initialized&#160;with&#160;</p>
<p style="position:absolute;top:177px;left:554px;white-space:nowrap" class="ft4733"><b>SSL_TLSEXT_GENERAL_new()</b></p>
<p style="position:absolute;top:177px;left:793px;white-space:nowrap" class="ft4717">&#160;</p>
<p style="position:absolute;top:205px;left:137px;white-space:nowrap" class="ft4739"><i>ctx_data</i></p>
<p style="position:absolute;top:205px;left:207px;white-space:nowrap" class="ft4717">&#160;pointer&#160;to&#160;the&#160;context&#160;data.&#160;SHOULD&#160;be&#160;casted&#160;to&#160;</p>
<p style="position:absolute;top:205px;left:629px;white-space:nowrap" class="ft4733"><b>(void&#160;*)</b></p>
<p style="position:absolute;top:205px;left:709px;white-space:nowrap" class="ft4717">&#160;&#160;</p>
<p style="position:absolute;top:234px;left:137px;white-space:nowrap" class="ft4743"><b>Returns:</b></p>
<p style="position:absolute;top:262px;left:137px;white-space:nowrap" class="ft4725">0&#160;success&#160;<br/>-1&#160;error&#160;</p>
<p style="position:absolute;top:318px;left:83px;white-space:nowrap" class="ft4741"><b>void* SSL_TLSEXT_GENERAL_server_ctx_get (TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:318px;left:658px;white-space:nowrap" class="ft4742"><i><b>ext</b></i></p>
<p style="position:absolute;top:318px;left:687px;white-space:nowrap" class="ft4741"><b>)</b></p>
<p style="position:absolute;top:337px;left:137px;white-space:nowrap" class="ft4719">Returns&#160;the&#160;context&#160;data&#160;available&#160;to&#160;the&#160;server.&#160;The&#160;context&#160;data&#160;can&#160;be&#160;used&#160;<br/>to&#160;exchange&#160;data&#160;from/to&#160;the&#160;application&#160;and&#160;</p>
<p style="position:absolute;top:356px;left:518px;white-space:nowrap" class="ft4733"><b>libssl</b></p>
<p style="position:absolute;top:356px;left:578px;white-space:nowrap" class="ft4717">&#160;&#160;and&#160;is&#160;usually&#160;used&#160;within&#160;</p>
<p style="position:absolute;top:375px;left:137px;white-space:nowrap" class="ft4717">callback&#160;functions.&#160;The&#160;result&#160;need&#160;to&#160;be&#160;casted&#160;to&#160;the&#160;proper&#160;type.</p>
<p style="position:absolute;top:404px;left:137px;white-space:nowrap" class="ft4743"><b>Parameters:</b></p>
<p style="position:absolute;top:431px;left:137px;white-space:nowrap" class="ft4739"><i>ext</i></p>
<p style="position:absolute;top:431px;left:163px;white-space:nowrap" class="ft4717">&#160;extension&#160;to&#160;get&#160;from.&#160;</p>
<p style="position:absolute;top:460px;left:137px;white-space:nowrap" class="ft4743"><b>Returns:</b></p>
<p style="position:absolute;top:487px;left:137px;white-space:nowrap" class="ft4717">the&#160;context&#160;data.&#160;It&#160;SHOULD&#160;be&#160;casted&#160;to&#160;the&#160;proper&#160;type&#160;</p>
<p style="position:absolute;top:516px;left:137px;white-space:nowrap" class="ft4733"><b>NULL</b></p>
<p style="position:absolute;top:516px;left:176px;white-space:nowrap" class="ft4717">&#160;&#160;error&#160;</p>
<p style="position:absolute;top:544px;left:83px;white-space:nowrap" class="ft4741"><b>int SSL_TLSEXT_GENERAL_server_ext_cb (TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:544px;left:628px;white-space:nowrap" class="ft4742"><i><b>ext</b></i></p>
<p style="position:absolute;top:544px;left:658px;white-space:nowrap" class="ft4741"><b>, &#160; void *&#160;</b></p>
<p style="position:absolute;top:562px;left:83px;white-space:nowrap" class="ft4742"><i><b>cb_ptr</b></i></p>
<p style="position:absolute;top:562px;left:143px;white-space:nowrap" class="ft4741"><b>)</b></p>
<p style="position:absolute;top:581px;left:137px;white-space:nowrap" class="ft4717">Sets&#160;the&#160;callback&#160;function&#160;the&#160;server&#160;will&#160;use&#160;to&#160;handle&#160;the&#160;TLS&#160;Extension&#160;</p>
<p style="position:absolute;top:581px;left:749px;white-space:nowrap" class="ft4733"><b>ext&#160;</b></p>
<p style="position:absolute;top:600px;left:137px;white-space:nowrap" class="ft4719">(received&#160;within&#160;the&#160;Client&#160;Hello).<br/>The&#160;callback&#160;is&#160;called&#160;immediately&#160;after&#160;receiving&#160;the&#160;Client&#160;Hello,&#160;thus&#160;before&#160;<br/>sending&#160;the&#160;Server&#160;Hello.&#160;It&#160;is&#160;used&#160;to&#160;process&#160;the&#160;data&#160;received&#160;from&#160;the&#160;client&#160;<br/>and&#160;to&#160;create&#160;the&#160;response&#160;to&#160;send&#160;within&#160;the&#160;Server&#160;Hello.&#160;See&#160;</p>
<p style="position:absolute;top:686px;left:137px;white-space:nowrap" class="ft4733"><b>ssl_parse_clienthello_tlsext_general()</b></p>
<p style="position:absolute;top:686px;left:514px;white-space:nowrap" class="ft4717">&#160;for&#160;more&#160;details.</p>
<p style="position:absolute;top:714px;left:137px;white-space:nowrap" class="ft4717">The&#160;callback&#160;MUST&#160;have&#160;prototype:&#160;</p>
<p style="position:absolute;top:751px;left:137px;white-space:nowrap" class="ft4733"><b>&#160;void&#160;callback(SSL&#160;*,&#160;TLSEXT_GENERAL&#160;*);</b></p>
<p style="position:absolute;top:789px;left:137px;white-space:nowrap" class="ft4717">&#160;and&#160;MAY&#160;use&#160;context&#160;data&#160;to&#160;communication&#160;with&#160;the&#160;application.</p>
<p style="position:absolute;top:817px;left:137px;white-space:nowrap" class="ft4743"><b>Parameters:</b></p>
<p style="position:absolute;top:845px;left:137px;white-space:nowrap" class="ft4739"><i>ext</i></p>
<p style="position:absolute;top:845px;left:163px;white-space:nowrap" class="ft4717">&#160;extension&#160;to&#160;set.&#160;It&#160;SHOULD&#160;be&#160;initialized&#160;with&#160;</p>
<p style="position:absolute;top:845px;left:554px;white-space:nowrap" class="ft4733"><b>SSL_TLSEXT_GENERAL_new()</b></p>
<p style="position:absolute;top:845px;left:793px;white-space:nowrap" class="ft4717">&#160;</p>
<p style="position:absolute;top:873px;left:137px;white-space:nowrap" class="ft4739"><i>cb_ptr</i></p>
<p style="position:absolute;top:873px;left:188px;white-space:nowrap" class="ft4717">&#160;pointer&#160;to&#160;the&#160;callback&#160;function&#160;</p>
<p style="position:absolute;top:902px;left:137px;white-space:nowrap" class="ft4743"><b>Returns:</b></p>
<p style="position:absolute;top:929px;left:137px;white-space:nowrap" class="ft4725">0&#160;success&#160;<br/>-1&#160;error&#160;</p>
<p style="position:absolute;top:985px;left:83px;white-space:nowrap" class="ft4741"><b>int SSL_TLSEXT_GENERAL_server_supp_data_cb (TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:985px;left:687px;white-space:nowrap" class="ft4742"><i><b>ext</b></i></p>
<p style="position:absolute;top:985px;left:717px;white-space:nowrap" class="ft4741"><b>, &#160; void&#160;</b></p>
<p style="position:absolute;top:1004px;left:83px;white-space:nowrap" class="ft4741"><b>*&#160;</b></p>
<p style="position:absolute;top:1004px;left:103px;white-space:nowrap" class="ft4742"><i><b>cb_ptr</b></i></p>
<p style="position:absolute;top:1004px;left:163px;white-space:nowrap" class="ft4741"><b>)</b></p>
<p style="position:absolute;top:1023px;left:137px;white-space:nowrap" class="ft4725">Sets&#160;the&#160;callback&#160;function&#160;the&#160;server&#160;will&#160;use&#160;to&#160;create&#160;the&#160;supplemental&#160;data&#160;<br/>entry&#160;to&#160;send&#160;within&#160;the&#160;server's&#160;Supplemental&#160;Data&#160;message.<br/>The&#160;callback&#160;is&#160;called&#160;immediately&#160;before&#160;sending&#160;the&#160;Supplemental&#160;Data&#160;<br/>message.<br/>The&#160;callback&#160;MUST&#160;have&#160;prototype:&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft4721">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft4721">18/61</p>
</div>
<!-- Page 48 -->
<a name="48"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page48-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3048.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft489">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft480">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft4821">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft4821">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft4833"><b>&#160;void&#160;callback(SSL&#160;*,&#160;TLSEXT_GENERAL&#160;*);</b></p>
<p style="position:absolute;top:186px;left:137px;white-space:nowrap" class="ft4817">&#160;and&#160;MAY&#160;use&#160;context&#160;data&#160;to&#160;communication&#160;with&#160;the&#160;application.</p>
<p style="position:absolute;top:215px;left:137px;white-space:nowrap" class="ft4843"><b>Parameters:</b></p>
<p style="position:absolute;top:242px;left:137px;white-space:nowrap" class="ft4839"><i>ext</i></p>
<p style="position:absolute;top:242px;left:163px;white-space:nowrap" class="ft4817">&#160;extension&#160;to&#160;set.&#160;It&#160;SHOULD&#160;be&#160;initialized&#160;with&#160;</p>
<p style="position:absolute;top:242px;left:554px;white-space:nowrap" class="ft4833"><b>SSL_TLSEXT_GENERAL_new()</b></p>
<p style="position:absolute;top:242px;left:793px;white-space:nowrap" class="ft4817">&#160;</p>
<p style="position:absolute;top:271px;left:137px;white-space:nowrap" class="ft4839"><i>cb_ptr</i></p>
<p style="position:absolute;top:271px;left:188px;white-space:nowrap" class="ft4817">&#160;pointer&#160;to&#160;the&#160;callback&#160;function&#160;</p>
<p style="position:absolute;top:299px;left:137px;white-space:nowrap" class="ft4843"><b>Returns:</b></p>
<p style="position:absolute;top:327px;left:137px;white-space:nowrap" class="ft4825">0&#160;success&#160;<br/>-1&#160;error&#160;</p>
<p style="position:absolute;top:383px;left:83px;white-space:nowrap" class="ft4841"><b>int SSL_TLSEXT_GENERAL_server_finish_cb (TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:383px;left:658px;white-space:nowrap" class="ft4842"><i><b>ext</b></i></p>
<p style="position:absolute;top:383px;left:687px;white-space:nowrap" class="ft4841"><b>, &#160; void *&#160;</b></p>
<p style="position:absolute;top:402px;left:83px;white-space:nowrap" class="ft4842"><i><b>cb_ptr</b></i></p>
<p style="position:absolute;top:402px;left:143px;white-space:nowrap" class="ft4841"><b>)</b></p>
<p style="position:absolute;top:421px;left:137px;white-space:nowrap" class="ft4825">Sets&#160;the&#160;callback&#160;function&#160;the&#160;server&#160;will&#160;use&#160;to&#160;handle&#160;the&#160;supplemental&#160;data&#160;<br/>received&#160;from&#160;the&#160;client.<br/>The&#160;callback&#160;is&#160;called&#160;at&#160;the&#160;end&#160;of&#160;the&#160;handshake,&#160;according&#160;to&#160;RFC&#160;4680:</p>
<p style="position:absolute;top:505px;left:137px;white-space:nowrap" class="ft4845"><b>Information&#160;provided&#160;in&#160;a&#160;supplemental&#160;data&#160;object&#160;MUST&#160;be&#160;intended&#160;<br/>to&#160;be&#160;used&#160;exclusibely&#160;by&#160;applications&#160;and&#160;protocols&#160;above&#160;the&#160;TLS&#160;<br/>protocol&#160;layer.&#160;Any&#160;such&#160;data&#160;MUST&#160;NOT&#160;need&#160;to&#160;be&#160;processed&#160;by&#160;the&#160;<br/>TLS&#160;protocol.</b></p>
<p style="position:absolute;top:600px;left:137px;white-space:nowrap" class="ft4817">The&#160;callback&#160;MUST&#160;have&#160;prototype:&#160;</p>
<p style="position:absolute;top:637px;left:137px;white-space:nowrap" class="ft4833"><b>void&#160;callback(SSL&#160;*,&#160;TLSEXT_GENERAL&#160;*);</b></p>
<p style="position:absolute;top:674px;left:137px;white-space:nowrap" class="ft4817">and&#160;MAY&#160;use&#160;context&#160;data&#160;to&#160;communication&#160;with&#160;the&#160;application.</p>
<p style="position:absolute;top:703px;left:137px;white-space:nowrap" class="ft4843"><b>Parameters:</b></p>
<p style="position:absolute;top:730px;left:137px;white-space:nowrap" class="ft4839"><i>ext</i></p>
<p style="position:absolute;top:730px;left:163px;white-space:nowrap" class="ft4817">&#160;extension&#160;to&#160;set.&#160;It&#160;SHOULD&#160;be&#160;initialized&#160;with&#160;</p>
<p style="position:absolute;top:730px;left:554px;white-space:nowrap" class="ft4833"><b>SSL_TLSEXT_GENERAL_new()</b></p>
<p style="position:absolute;top:730px;left:793px;white-space:nowrap" class="ft4817">&#160;</p>
<p style="position:absolute;top:758px;left:137px;white-space:nowrap" class="ft4839"><i>cb_ptr</i></p>
<p style="position:absolute;top:758px;left:188px;white-space:nowrap" class="ft4817">&#160;pointer&#160;to&#160;the&#160;callback&#160;function&#160;</p>
<p style="position:absolute;top:787px;left:137px;white-space:nowrap" class="ft4843"><b>Returns:</b></p>
<p style="position:absolute;top:814px;left:137px;white-space:nowrap" class="ft4825">0&#160;success&#160;<br/>-1&#160;error</p>
<p style="position:absolute;top:889px;left:83px;white-space:nowrap" class="ft4836"><i><b>3.2.2&#160;&#160;&#160;Application&#160;Interface</b></i></p>
<p style="position:absolute;top:919px;left:83px;white-space:nowrap" class="ft4819">These&#160;functions&#160;are&#160;used&#160;by&#160;developers&#160;that&#160;write&#160;applications&#160;that&#160;use&#160;TLS&#160;Extensions&#160;<br/>already&#160;defined.</p>
<p style="position:absolute;top:966px;left:83px;white-space:nowrap" class="ft4841"><b>int SSL_TLSEXT_GENERAL_server_send (TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:966px;left:608px;white-space:nowrap" class="ft4842"><i><b>ext</b></i></p>
<p style="position:absolute;top:966px;left:638px;white-space:nowrap" class="ft4841"><b>)</b></p>
<p style="position:absolute;top:985px;left:137px;white-space:nowrap" class="ft4817">Instructs&#160;the&#160;server&#160;to&#160;respond&#160;with&#160;the&#160;extension&#160;</p>
<p style="position:absolute;top:985px;left:556px;white-space:nowrap" class="ft4833"><b>ext</b></p>
<p style="position:absolute;top:985px;left:586px;white-space:nowrap" class="ft4817">&#160;.</p>
<p style="position:absolute;top:1013px;left:137px;white-space:nowrap" class="ft4817">It&#160;MUST&#160;be&#160;called&#160;only&#160;if&#160;the&#160;client&#160;sent&#160;the&#160;extension&#160;</p>
<p style="position:absolute;top:1013px;left:584px;white-space:nowrap" class="ft4833"><b>ext</b></p>
<p style="position:absolute;top:1013px;left:613px;white-space:nowrap" class="ft4817">&#160;,&#160;so&#160;usually&#160;by&#160;the&#160;</p>
<p style="position:absolute;top:1032px;left:137px;white-space:nowrap" class="ft4833"><b>server_ext_callback</b></p>
<p style="position:absolute;top:1032px;left:326px;white-space:nowrap" class="ft4817">&#160;.</p>
<p style="position:absolute;top:1060px;left:137px;white-space:nowrap" class="ft4819">This&#160;fuction&#160;is&#160;part&#160;of&#160;the&#160;Application&#160;Interface,&#160;however&#160;it&#160;SHOULD&#160;only&#160;be&#160;used&#160;<br/>in&#160;a&#160;TLS&#160;Extension&#160;implementation.&#160;In&#160;any&#160;case&#160;it&#160;SHOULD&#160;at&#160;least&#160;be&#160;wrapped&#160;<br/>by&#160;the&#160;TLS&#160;Extension.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft4821">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft4821">19/61</p>
</div>
<!-- Page 49 -->
<a name="49"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page49-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3049.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft499">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft490">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft4921">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft4921">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:150px;left:137px;white-space:nowrap" class="ft4943"><b>Parameters:</b></p>
<p style="position:absolute;top:177px;left:137px;white-space:nowrap" class="ft4939"><i>ext</i></p>
<p style="position:absolute;top:177px;left:163px;white-space:nowrap" class="ft4917">&#160;extension&#160;to&#160;set.&#160;It&#160;SHOULD&#160;be&#160;initialized&#160;with&#160;</p>
<p style="position:absolute;top:177px;left:554px;white-space:nowrap" class="ft4933"><b>SSL_TLSEXT_GENERAL_new()</b></p>
<p style="position:absolute;top:177px;left:793px;white-space:nowrap" class="ft4917">&#160;</p>
<p style="position:absolute;top:206px;left:137px;white-space:nowrap" class="ft4943"><b>Returns:</b></p>
<p style="position:absolute;top:233px;left:137px;white-space:nowrap" class="ft4925">0&#160;success&#160;<br/>-1&#160;error&#160;</p>
<p style="position:absolute;top:290px;left:83px;white-space:nowrap" class="ft4941"><b>int SSL_TLSEXT_GENERAL_client_required (TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:290px;left:648px;white-space:nowrap" class="ft4942"><i><b>ext</b></i></p>
<p style="position:absolute;top:290px;left:677px;white-space:nowrap" class="ft4941"><b>)</b></p>
<p style="position:absolute;top:308px;left:137px;white-space:nowrap" class="ft4919">Forces&#160;the&#160;client&#160;to&#160;abort&#160;the&#160;handshake&#160;if&#160;the&#160;server&#160;does&#160;not&#160;reply&#160;with&#160;the&#160;<br/>extension&#160;</p>
<p style="position:absolute;top:328px;left:223px;white-space:nowrap" class="ft4933"><b>ext</b></p>
<p style="position:absolute;top:328px;left:252px;white-space:nowrap" class="ft4917">&#160;.</p>
<p style="position:absolute;top:356px;left:137px;white-space:nowrap" class="ft4919">This&#160;function&#160;is&#160;part&#160;of&#160;the&#160;Application&#160;Interface,&#160;so&#160;it&#160;SHOULD&#160;be&#160;wrapped&#160;by&#160;<br/>the&#160;TLS&#160;Extension&#160;implementation.</p>
<p style="position:absolute;top:404px;left:137px;white-space:nowrap" class="ft4943"><b>Parameters:</b></p>
<p style="position:absolute;top:431px;left:137px;white-space:nowrap" class="ft4939"><i>ext</i></p>
<p style="position:absolute;top:431px;left:163px;white-space:nowrap" class="ft4917">&#160;extension&#160;to&#160;set.&#160;It&#160;SHOULD&#160;be&#160;initialized&#160;with&#160;</p>
<p style="position:absolute;top:431px;left:554px;white-space:nowrap" class="ft4933"><b>SSL_TLSEXT_GENERAL_new()</b></p>
<p style="position:absolute;top:431px;left:793px;white-space:nowrap" class="ft4917">&#160;</p>
<p style="position:absolute;top:460px;left:137px;white-space:nowrap" class="ft4943"><b>Returns:</b></p>
<p style="position:absolute;top:487px;left:137px;white-space:nowrap" class="ft4925">0&#160;success&#160;<br/>-1&#160;error&#160;</p>
<p style="position:absolute;top:544px;left:83px;white-space:nowrap" class="ft4941"><b>void SSL_CTX_tlsext_set_enabled (SSL_CTX *&#160;</b></p>
<p style="position:absolute;top:544px;left:509px;white-space:nowrap" class="ft4942"><i><b>ctx</b></i></p>
<p style="position:absolute;top:544px;left:539px;white-space:nowrap" class="ft4941"><b>, &#160; int&#160;</b></p>
<p style="position:absolute;top:544px;left:618px;white-space:nowrap" class="ft4942"><i><b>type</b></i></p>
<p style="position:absolute;top:544px;left:658px;white-space:nowrap" class="ft4941"><b>)</b></p>
<p style="position:absolute;top:562px;left:137px;white-space:nowrap" class="ft4917">Enables&#160;an&#160;extension.</p>
<p style="position:absolute;top:591px;left:137px;white-space:nowrap" class="ft4943"><b>Parameters:</b></p>
<p style="position:absolute;top:619px;left:137px;white-space:nowrap" class="ft4939"><i>ctx</i></p>
<p style="position:absolute;top:619px;left:162px;white-space:nowrap" class="ft4917">&#160;a&#160;pointer&#160;to&#160;a&#160;SSL_CTX&#160;object&#160;</p>
<p style="position:absolute;top:647px;left:137px;white-space:nowrap" class="ft4939"><i>type</i></p>
<p style="position:absolute;top:647px;left:174px;white-space:nowrap" class="ft4917">&#160;the&#160;type&#160;of&#160;the&#160;extension&#160;to&#160;be&#160;enabled&#160;</p>
<p style="position:absolute;top:675px;left:83px;white-space:nowrap" class="ft4941"><b>void SSL_CTX_tlsext_set_disabled (SSL_CTX *&#160;</b></p>
<p style="position:absolute;top:675px;left:519px;white-space:nowrap" class="ft4942"><i><b>ctx</b></i></p>
<p style="position:absolute;top:675px;left:549px;white-space:nowrap" class="ft4941"><b>, &#160; int&#160;</b></p>
<p style="position:absolute;top:675px;left:628px;white-space:nowrap" class="ft4942"><i><b>type</b></i></p>
<p style="position:absolute;top:675px;left:668px;white-space:nowrap" class="ft4941"><b>)</b></p>
<p style="position:absolute;top:694px;left:137px;white-space:nowrap" class="ft4917">Disables&#160;an&#160;extension.</p>
<p style="position:absolute;top:722px;left:137px;white-space:nowrap" class="ft4943"><b>Parameters:</b></p>
<p style="position:absolute;top:750px;left:137px;white-space:nowrap" class="ft4939"><i>ctx</i></p>
<p style="position:absolute;top:750px;left:162px;white-space:nowrap" class="ft4917">&#160;a&#160;pointer&#160;to&#160;a&#160;SSL_CTX&#160;object</p>
<p style="position:absolute;top:778px;left:137px;white-space:nowrap" class="ft4939"><i>type</i></p>
<p style="position:absolute;top:778px;left:174px;white-space:nowrap" class="ft4917">&#160;the&#160;type&#160;of&#160;the&#160;extension&#160;to&#160;be&#160;disabled</p>
<p style="position:absolute;top:824px;left:83px;white-space:nowrap" class="ft4934"><i><b>3.3&#160;&#160;&#160;Examples</b></i></p>
<p style="position:absolute;top:856px;left:83px;white-space:nowrap" class="ft4919">This&#160;section&#160;shows&#160;how&#160;to&#160;write&#160;an&#160;extension&#160;using&#160;the&#160;General&#160;TLS&#160;Extension;&#160;in&#160;order&#160;<br/>to&#160;understand&#160;this&#160;example,&#160;it&#160;is&#160;required&#160;to&#160;be&#160;familiar&#160;with&#160;programming&#160;with&#160;<br/>OpenSSL.&#160;Two&#160;programs&#160;are&#160;needed:&#160;one&#160;to&#160;implement&#160;the&#160;logic&#160;Client-side,&#160;one&#160;<br/>Server-side.&#160;Both&#160;requires&#160;an&#160;initialization&#160;function&#160;for&#160;the&#160;TLS&#160;Extension&#160;and&#160;optionally&#160;<br/>some&#160;of&#160;the&#160;available&#160;callback&#160;functions.&#160;As&#160;mentioned&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#37">&#160;3.1,</a>&#160;this&#160;Extension&#160;<br/>can&#160;be&#160;embedded&#160;into&#160;</p>
<p style="position:absolute;top:952px;left:275px;white-space:nowrap" class="ft4933"><b>libssl</b></p>
<p style="position:absolute;top:952px;left:334px;white-space:nowrap" class="ft4917">&#160;or&#160;directly&#160;specified&#160;by&#160;the&#160;application.&#160;The&#160;latter&#160;</p>
<p style="position:absolute;top:971px;left:83px;white-space:nowrap" class="ft4919">scenario&#160;is&#160;the&#160;more&#160;appropriated&#160;for&#160;this&#160;example.<br/>Before&#160;starting&#160;to&#160;implement&#160;the&#160;&#34;Hello&#160;world!&#34;&#160;extensions,&#160;it&#160;is&#160;worth&#160;of&#160;noting&#160;that&#160;<br/>extension&#160;implemented&#160;by&#160;exploiting&#160;the&#160;General&#160;TLS&#160;Extension&#160;framework&#160;still&#160;are&#160;<br/>part&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:1038px;left:176px;white-space:nowrap" class="ft4933"><b>libssl</b></p>
<p style="position:absolute;top:1038px;left:236px;white-space:nowrap" class="ft4917">&#160;and&#160;MUST&#160;still&#160;be&#160;standardized&#160;by&#160;IANA.</p>
<p style="position:absolute;top:1084px;left:83px;white-space:nowrap" class="ft4936"><i><b>3.3.1&#160;&#160;&#160;Hello&#160;World!</b></i></p>
<p style="position:absolute;top:1114px;left:83px;white-space:nowrap" class="ft4917">The&#160;first&#160;example&#160;is&#160;a&#160;simple&#160;TLS&#160;Extension&#160;in&#160;the&#160;sense&#160;of&#160;RFC&#160;4366&#160;(i.e.&#160;without&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft4921">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft4921">20/61</p>
</div>
<!-- Page 50 -->
<a name="50"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page50-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3050.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft509">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft500">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft5021">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft5021">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft5025">supplemental&#160;data).<br/>The&#160;initialization&#160;function&#160;on&#160;Client&#160;side&#160;is:</p>
<p style="position:absolute;top:214px;left:105px;white-space:nowrap" class="ft5045"><b>void&#160;SSL_TLSEXT_TEST_client_init(SSL&#160;*&#160;s)&#160;{<br/>&#160;&#160;&#160;TLSEXT_GENERAL&#160;*&#160;e;<br/>&#160;&#160;&#160;e&#160;=&#160;SSL_TLSEXT_GENERAL_new(s,&#160;65000);<br/>&#160;&#160;&#160;SSL_TLSEXT_GENERAL_client_data(e,&#160;6,&#160;&#34;Hello\0&#34;);<br/>&#160;&#160;&#160;SSL_TLSEXT_GENERAL_client_ext_cb(e,&#160;ssl_tlsext_test_client_ext_cb);<br/>}</b></p>
<p style="position:absolute;top:348px;left:83px;white-space:nowrap" class="ft5019">It&#160;creates&#160;an&#160;extension&#160;of&#160;type&#160;65000,&#160;with&#160;payload&#160;&#34;Hello&#34;,&#160;and&#160;registers&#160;a&#160;callback&#160;<br/>function&#160;</p>
<p style="position:absolute;top:367px;left:156px;white-space:nowrap" class="ft5033"><b>ssl_tlsext_test_client_ext_cb()</b></p>
<p style="position:absolute;top:367px;left:464px;white-space:nowrap" class="ft5017">.</p>
<p style="position:absolute;top:395px;left:83px;white-space:nowrap" class="ft5017">Such&#160;initialization&#160;function&#160;has&#160;to&#160;be&#160;invoked&#160;between&#160;the&#160;creation&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:395px;left:695px;white-space:nowrap" class="ft5033"><b>SSL</b></p>
<p style="position:absolute;top:395px;left:725px;white-space:nowrap" class="ft5017">&#160;object&#160;</p>
<p style="position:absolute;top:414px;left:83px;white-space:nowrap" class="ft5019">and&#160;the&#160;connection&#160;opening.<br/>The&#160;callback&#160;function&#160;is&#160;a&#160;simple&#160;debug&#160;function,&#160;which&#160;prints&#160;out&#160;the&#160;data&#160;received&#160;<br/>from&#160;the&#160;server:</p>
<p style="position:absolute;top:499px;left:105px;white-space:nowrap" class="ft5045"><b>void&#160;ssl_tlsext_test_client_ext_cb(SSL&#160;*&#160;s,&#160;TLSEXT_GENERAL&#160;*&#160;e)&#160;{<br/>&#160;&#160;&#160;/*&#160;prints&#160;the&#160;extension&#160;received&#160;*/<br/>&#160;&#160;&#160;fprintf(stderr,&#160;&#34;TEST:&#160;%d\n&#34;,&#160;e-&gt;type);<br/>&#160;&#160;&#160;fprintf(stderr,&#160;&#34;TEST:&#160;%d\n&#34;,&#160;e-&gt;server_data_length);<br/>&#160;&#160;&#160;fprintf(stderr,&#160;&#34;TEST:&#160;%s\n&#34;,&#160;e-&gt;server_data);<br/>}</b></p>
<p style="position:absolute;top:632px;left:83px;white-space:nowrap" class="ft5019">This&#160;callback&#160;function&#160;will&#160;be&#160;executed&#160;immediately&#160;after&#160;the&#160;Client&#160;receives&#160;the&#160;<br/>ServerHello&#160;message,&#160;with&#160;the&#160;related&#160;TLS&#160;Extension.<br/>The&#160;main&#160;difference&#160;between&#160;the&#160;Client&#160;and&#160;Server&#160;implementation&#160;is&#160;that&#160;the&#160;Client&#160;<br/>sets&#160;the&#160;payload&#160;to&#160;be&#160;send&#160;through&#160;the&#160;TLS&#160;Extension&#160;within&#160;the&#160;initialization&#160;function,&#160;<br/>while&#160;the&#160;Server&#160;does&#160;it&#160;in&#160;the&#160;</p>
<p style="position:absolute;top:718px;left:337px;white-space:nowrap" class="ft5033"><b>server_ext_cb()</b></p>
<p style="position:absolute;top:718px;left:486px;white-space:nowrap" class="ft5017">.&#160;The&#160;reason&#160;for&#160;this&#160;different&#160;behavior&#160;</p>
<p style="position:absolute;top:737px;left:83px;white-space:nowrap" class="ft5019">is&#160;that&#160;the&#160;payload&#160;sent&#160;by&#160;the&#160;Server&#160;may&#160;depend&#160;on&#160;the&#160;payload&#160;sent&#160;by&#160;the&#160;Client.&#160;<br/>For&#160;simplicity&#160;the&#160;following&#160;example&#160;does&#160;not&#160;take&#160;into&#160;account&#160;the&#160;payload&#160;sent&#160;by&#160;<br/>the&#160;Client&#160;when&#160;creating&#160;the&#160;payload&#160;on&#160;the&#160;Server&#160;side.<br/>On&#160;Server&#160;side,&#160;the&#160;initialization&#160;function&#160;only&#160;describes&#160;the&#160;extension&#160;and&#160;registers&#160;<br/>the&#160;</p>
<p style="position:absolute;top:823px;left:116px;white-space:nowrap" class="ft5033"><b>server_ext_cb()</b></p>
<p style="position:absolute;top:823px;left:265px;white-space:nowrap" class="ft5017">:</p>
<p style="position:absolute;top:860px;left:105px;white-space:nowrap" class="ft5045"><b>void&#160;SSL_TLSEXT_TEST_server_init(SSL&#160;*&#160;s)&#160;{<br/>&#160;&#160;&#160;TLSEXT_GENERAL&#160;*&#160;e;<br/>&#160;&#160;&#160;e&#160;=&#160;SSL_TLSEXT_GENERAL_new(s,&#160;65000);<br/>&#160;&#160;&#160;SSL_TLSEXT_GENERAL_server_ext_cb(e,&#160;ssl_tlsext_test_server_ext_cb);<br/>}</b></p>
<p style="position:absolute;top:973px;left:83px;white-space:nowrap" class="ft5019">The&#160;following&#160;callback&#160;function&#160;prints&#160;out&#160;the&#160;data&#160;received&#160;from&#160;the&#160;Client,&#160;sets&#160;the&#160;<br/>payload&#160;to&#160;be&#160;send&#160;and&#160;enables&#160;the&#160;TLS&#160;Extension&#160;by&#160;calling&#160;the&#160;</p>
<p style="position:absolute;top:1012px;left:83px;white-space:nowrap" class="ft5033"><b>SSL_TLSEXT_GENERAL_server_send()</b></p>
<p style="position:absolute;top:1012px;left:401px;white-space:nowrap" class="ft5017">&#160;Interface&#160;function:</p>
<p style="position:absolute;top:1049px;left:105px;white-space:nowrap" class="ft5045"><b>void&#160;ssl_tlsext_test_server_ext_cb(SSL&#160;*&#160;s,&#160;TLSEXT_GENERAL&#160;*&#160;e)&#160;{<br/>&#160;&#160;&#160;/*&#160;prints&#160;the&#160;extension&#160;received&#160;*/<br/>&#160;&#160;&#160;fprintf(stderr,&#160;&#34;TEST:&#160;%d\n&#34;,&#160;e-&gt;type);<br/>&#160;&#160;&#160;fprintf(stderr,&#160;&#34;TEST:&#160;%d\n&#34;,&#160;e-&gt;client_data_length);</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5021">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft5021">21/61</p>
</div>
<!-- Page 51 -->
<a name="51"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page51-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3051.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft519">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft510">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft5121">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft5121">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:105px;white-space:nowrap" class="ft5145"><b>&#160;&#160;&#160;fprintf(stderr,&#160;&#34;TEST:&#160;%s\n&#34;,&#160;e-&gt;client_data);<br/>&#160;&#160;&#160;<br/>&#160;&#160;&#160;/*&#160;generates&#160;the&#160;response&#160;*/<br/>&#160;&#160;&#160;SSL_TLSEXT_GENERAL_server_data(e,&#160;7,&#160;&#34;World!\0&#34;);<br/>&#160;&#160;&#160;SSL_TLSEXT_GENERAL_server_send(e);<br/>}</b></p>
<p style="position:absolute;top:282px;left:83px;white-space:nowrap" class="ft5119">This&#160;callback&#160;function&#160;will&#160;be&#160;executed&#160;immediately&#160;after&#160;the&#160;Server&#160;receives&#160;the&#160;<br/>ClientHello&#160;message,&#160;with&#160;the&#160;related&#160;TLS&#160;Extension.</p>
<p style="position:absolute;top:347px;left:83px;white-space:nowrap" class="ft5136"><i><b>3.3.2&#160;&#160;&#160;Supplemental&#160;Data</b></i></p>
<p style="position:absolute;top:377px;left:83px;white-space:nowrap" class="ft5119">In&#160;this&#160;second&#160;example&#160;supplemental&#160;data&#160;are&#160;added:&#160;it&#160;is&#160;assumed&#160;that&#160;only&#160;the&#160;<br/>Server&#160;has&#160;to&#160;send&#160;supplemental&#160;data&#160;(in&#160;particular&#160;two&#160;supplemental&#160;data&#160;entries).<br/>Note&#160;that&#160;both&#160;the&#160;Client&#160;and&#160;the&#160;Server&#160;MUST&#160;define&#160;the&#160;extension,&#160;including&#160;in&#160;the&#160;<br/>definition&#160;the&#160;number&#160;and&#160;type&#160;of&#160;related&#160;supplemental&#160;data&#160;entries&#160;(which&#160;is&#160;assumed&#160;<br/>to&#160;be&#160;fixed&#160;and&#160;standardized).<br/>On&#160;Client&#160;side&#160;the&#160;initialization&#160;function&#160;is&#160;modified&#160;by&#160;describing&#160;the&#160;supplemental&#160;<br/>data&#160;entries&#160;(even&#160;if&#160;it&#160;is&#160;the&#160;Server&#160;who&#160;will&#160;send&#160;them)&#160;and&#160;registering&#160;a&#160;finish&#160;<br/>callback&#160;function&#160;to&#160;handle&#160;the&#160;data&#160;received:</p>
<p style="position:absolute;top:567px;left:105px;white-space:nowrap" class="ft5145"><b>void&#160;SSL_TLSEXT_TEST_client_init(SSL&#160;*&#160;s)&#160;{<br/>&#160;&#160;&#160;TLSEXT_GENERAL&#160;*&#160;e;<br/>&#160;&#160;&#160;e&#160;=&#160;SSL_TLSEXT_GENERAL_new(s,&#160;65000);<br/>&#160;&#160;&#160;SSL_TLSEXT_GENERAL_client_data(e,&#160;8,&#160;&#34;test-c1\0&#34;);<br/>&#160;&#160;&#160;SSL_TLSEXT_GENERAL_client_ext_cb(e,&#160;ssl_tlsext_test_client_ext_cb);</b></p>
<p style="position:absolute;top:682px;left:105px;white-space:nowrap" class="ft5145"><b>&#160;&#160;&#160;/*&#160;the&#160;server&#160;will&#160;send&#160;supplemental&#160;data&#160;*/<br/>&#160;&#160;&#160;SSL_TLSEXT_GENERAL_server_supp_data_new(e,&#160;65100);<br/>&#160;&#160;&#160;SSL_TLSEXT_GENERAL_server_supp_data_new(e,&#160;65101);<br/>&#160;&#160;&#160;SSL_TLSEXT_GENERAL_client_finish_cb(e,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ssl_tlsext_test_client_finish_cb);<br/>}</b></p>
<p style="position:absolute;top:815px;left:83px;white-space:nowrap" class="ft5117">Again,&#160;a&#160;simple&#160;debug&#160;callback&#160;function&#160;is&#160;used:</p>
<p style="position:absolute;top:852px;left:105px;white-space:nowrap" class="ft5145"><b>void&#160;ssl_tlsext_test_client_finish_cb(SSL&#160;*&#160;s,&#160;TLSEXT_GENERAL&#160;*&#160;e)&#160;{<br/>&#160;&#160;&#160;int&#160;i;<br/>&#160;&#160;&#160;SUPP_DATA_ENTRY&#160;*&#160;sd;<br/>&#160;&#160;&#160;if&#160;(e-&gt;server_supp_data)&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;for&#160;(i=0;&#160;i&lt;sk_SUPP_DATA_ENTRY_num(e-&gt;server_supp_data);&#160;i++)&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sd&#160;=&#160;sk_SUPP_DATA_ENTRY_value(e-&gt;server_supp_data,&#160;i);<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;fprintf(stderr,&#160;&#34;TEST&#160;&gt;&#160;SD&#160;%d&#160;(%d)&#160;%s\n&#34;,&#160;<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;sd-&gt;type,&#160;sd-&gt;length,&#160;sd-&gt;data);<br/>&#160;&#160;&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;}<br/>}</b></p>
<p style="position:absolute;top:1081px;left:83px;white-space:nowrap" class="ft5117">where&#160;</p>
<p style="position:absolute;top:1081px;left:140px;white-space:nowrap" class="ft5133"><b>sk_SUPP_DATA_ENTRY_num()</b></p>
<p style="position:absolute;top:1081px;left:378px;white-space:nowrap" class="ft5117">&#160;and&#160;&#160;</p>
<p style="position:absolute;top:1081px;left:425px;white-space:nowrap" class="ft5133"><b>sk_SUPP_DATA_ENTRY_value()</b></p>
<p style="position:absolute;top:1081px;left:683px;white-space:nowrap" class="ft5117">&#160;are&#160;standard&#160;</p>
<p style="position:absolute;top:1101px;left:83px;white-space:nowrap" class="ft5117">functions&#160;of&#160;the&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:1101px;left:298px;white-space:nowrap" class="ft5133"><b>STACK_OF</b></p>
<p style="position:absolute;top:1101px;left:377px;white-space:nowrap" class="ft5117">&#160;interface.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5121">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft5121">22/61</p>
</div>
<!-- Page 52 -->
<a name="52"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page52-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3052.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft529">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft520">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft5221">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft5221">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft5219">On&#160;Server&#160;side,&#160;the&#160;initialization&#160;function&#160;is&#160;modified&#160;to&#160;add&#160;the&#160;supplemental&#160;data&#160;<br/>entries&#160;and&#160;register&#160;a&#160;callback&#160;function&#160;to&#160;fill&#160;their&#160;payload:</p>
<p style="position:absolute;top:205px;left:105px;white-space:nowrap" class="ft5245"><b>void&#160;SSL_TLSEXT_TEST_server_init(SSL&#160;*&#160;s)&#160;{<br/>&#160;&#160;&#160;TLSEXT_GENERAL&#160;*&#160;e;<br/>&#160;&#160;&#160;e&#160;=&#160;SSL_TLSEXT_GENERAL_new(s,&#160;65000);<br/>&#160;&#160;&#160;SSL_TLSEXT_GENERAL_server_ext_cb(e,&#160;ssl_tlsext_test_server_ext_cb);</b></p>
<p style="position:absolute;top:301px;left:105px;white-space:nowrap" class="ft5245"><b>&#160;&#160;&#160;/*&#160;the&#160;server&#160;will&#160;send&#160;supplemental&#160;data&#160;*/<br/>&#160;&#160;&#160;SSL_TLSEXT_GENERAL_server_supp_data_new(e,&#160;65100);<br/>&#160;&#160;&#160;SSL_TLSEXT_GENERAL_server_supp_data_new(e,&#160;65101);<br/>&#160;&#160;&#160;SSL_TLSEXT_GENERAL_server_supp_data_cb(e,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ssl_tlsext_test_server_supp_data_cb);<br/>}</b></p>
<p style="position:absolute;top:435px;left:83px;white-space:nowrap" class="ft5219">And&#160;finally&#160;the&#160;Server's&#160;callback&#160;that&#160;fills&#160;the&#160;content&#160;of&#160;the&#160;supplemental&#160;data&#160;entries&#160;<br/>(it&#160;might&#160;access&#160;all&#160;data&#160;exchanged&#160;previously)&#160;is:</p>
<p style="position:absolute;top:491px;left:105px;white-space:nowrap" class="ft5245"><b>void&#160;ssl_tlsext_test_server_supp_data_cb(SSL&#160;*&#160;s,&#160;TLSEXT_GENERAL&#160;*&#160;e){<br/>&#160;&#160;&#160;SSL_TLSEXT_GENERAL_server_supp_data(e,&#160;65100,&#160;10,&#160;&#34;test-Ssd0\0&#34;);<br/>&#160;&#160;&#160;SSL_TLSEXT_GENERAL_server_supp_data(e,&#160;65101,&#160;10,&#160;&#34;test-Ssd1\0&#34;);<br/>}</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5221">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft5221">23/61</p>
</div>
<!-- Page 53 -->
<a name="53"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page53-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3053.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft539">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft530">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft5321">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft5321">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft5324"><b>4&#160;&#160;&#160;Direct&#160;Anonymous&#160;Attestation</b></p>
<p style="position:absolute;top:218px;left:83px;white-space:nowrap" class="ft5334"><i><b>4.1&#160;&#160;&#160;Architecture</b></i></p>
<p style="position:absolute;top:250px;left:83px;white-space:nowrap" class="ft5319">This&#160;is&#160;an&#160;interface&#160;to&#160;implement&#160;the&#160;Direct&#160;Anonymous&#160;Attestation&#160;(DAA)&#160;protocol&#160;<br/>[7,8,9]&#160;within&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:269px;left:278px;white-space:nowrap" class="ft5333"><b>libcrypto</b></p>
<p style="position:absolute;top:269px;left:368px;white-space:nowrap" class="ft5317">.&#160;</p>
<p style="position:absolute;top:297px;left:83px;white-space:nowrap" class="ft5319">DAA&#160;is&#160;composed&#160;by&#160;many&#160;different&#160;cryptographic&#160;algorithms:&#160;Setup,&#160;Join,&#160;Sign,&#160;Verify,&#160;<br/>Link&#160;and&#160;Rogue&#160;Tagging.&#160;Currently&#160;only&#160;the&#160;Sign&#160;and&#160;Verify&#160;algorithms&#160;are&#160;supported&#160;<br/>and,&#160;according&#160;to&#160;the&#160;original&#160;design&#160;of&#160;DAA,&#160;the&#160;Sign&#160;algorithm&#160;is&#160;considered&#160;as&#160;a&#160;two-<br/>parties&#160;protocol&#160;between&#160;the&#160;Host&#160;and&#160;the&#160;TPM.&#160;This&#160;is&#160;a&#160;common&#160;point&#160;between&#160;all&#160;<br/>versions&#160;of&#160;DAA&#160;in&#160;literature.<br/>The&#160;interface&#160;is&#160;designed&#160;to&#160;be&#160;as&#160;general&#160;as&#160;possible&#160;in&#160;order&#160;to&#160;support&#160;all&#160;DAA&#160;<br/>versions:&#160;RSA-based&#160;or&#160;Pairing-based&#160;DAA,&#160;with&#160;or&#160;without&#160;an&#160;actual&#160;(hardware)&#160;TPM.<br/>The&#160;current&#160;version&#160;provides&#160;a&#160;default&#160;dummy&#160;implementation&#160;together&#160;with&#160;the&#160;<br/>interface.&#160;Such&#160;dummy&#160;version&#160;does&#160;not&#160;implement&#160;a&#160;complete&#160;DAA&#160;protocol,&#160;but&#160;its&#160;<br/>sole&#160;purpose&#160;is&#160;to&#160;demonstrate&#160;its&#160;functionality&#160;without&#160;the&#160;need&#160;of&#160;any&#160;other&#160;software&#160;<br/>than&#160;OpenSSL.&#160;A&#160;proper&#160;DAA&#160;protocol&#160;will&#160;replace&#160;the&#160;dummy&#160;implementation&#160;in&#160;future&#160;<br/>versions.&#160;The&#160;use&#160;of&#160;OpenSSL&#160;engines&#160;allows&#160;overriding&#160;the&#160;default&#160;implementation.</p>
<p style="position:absolute;top:573px;left:83px;white-space:nowrap" class="ft5336"><i><b>4.1.1&#160;&#160;&#160;Overview</b></i></p>
<p style="position:absolute;top:603px;left:83px;white-space:nowrap" class="ft5317">The&#160;code&#160;is&#160;organized&#160;in&#160;three&#160;main&#160;modules,&#160;as&#160;shown&#160;in<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#53">&#160;Figure&#160;5.</a></p>
<p style="position:absolute;top:1114px;left:83px;white-space:nowrap" class="ft5317">In&#160;more&#160;details:</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5321">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft5321">24/61</p>
<p style="position:absolute;top:1047px;left:331px;white-space:nowrap" class="ft5317">Figure&#160;5:&#160;Direct&#160;Anonymous&#160;</p>
<p style="position:absolute;top:1066px;left:306px;white-space:nowrap" class="ft5317">Attestation&#160;Architecture&#160;Overview</p>
</div>
<!-- Page 54 -->
<a name="54"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page54-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3054.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft549">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft540">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft5421">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft5421">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:154px;left:110px;white-space:nowrap" class="ft5412">●</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft5416"><b>Implementations&#160;</b></p>
<p style="position:absolute;top:149px;left:301px;white-space:nowrap" class="ft5417">contains:</p>
<p style="position:absolute;top:182px;left:164px;white-space:nowrap" class="ft5412">■</p>
<p style="position:absolute;top:177px;left:191px;white-space:nowrap" class="ft5417">The&#160;specific&#160;implementation&#160;of&#160;the&#160;cryptographic&#160;primitives.</p>
<p style="position:absolute;top:210px;left:164px;white-space:nowrap" class="ft5412">■</p>
<p style="position:absolute;top:206px;left:191px;white-space:nowrap" class="ft5419">The&#160;specific&#160;implementation&#160;of&#160;functions&#160;to&#160;manage&#160;related&#160;data&#160;types&#160;<br/>(e.g.&#160;signature,&#160;credentials).</p>
<p style="position:absolute;top:253px;left:137px;white-space:nowrap" class="ft5419">According&#160;to&#160;OpenSSL&#160;design,&#160;the&#160;primitives&#160;are&#160;put&#160;together&#160;in&#160;a&#160;single&#160;object&#160;<br/>called&#160;DAA&#160;method&#160;(refer&#160;to&#160;the&#160;</p>
<p style="position:absolute;top:272px;left:407px;white-space:nowrap" class="ft5433"><b>DAA_METHOD</b></p>
<p style="position:absolute;top:272px;left:506px;white-space:nowrap" class="ft5417">&#160;structure,&#160;described&#160;in&#160;Section&#160;</p>
<p style="position:absolute;top:291px;left:137px;white-space:nowrap" class="ft5425"><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#54">4.1.2)</a>.&#160;<br/>Currently,&#160;a&#160;single&#160;default&#160;implementation&#160;is&#160;available.<br/>OpenSSL&#160;engines&#160;overwrite&#160;this&#160;layer.</p>
<p style="position:absolute;top:381px;left:110px;white-space:nowrap" class="ft5412">●</p>
<p style="position:absolute;top:376px;left:137px;white-space:nowrap" class="ft5416"><b>Method&#160;Interface</b></p>
<p style="position:absolute;top:376px;left:298px;white-space:nowrap" class="ft5417">&#160;is&#160;a&#160;low&#160;level&#160;interface&#160;that&#160;hides&#160;the&#160;view&#160;on&#160;the&#160;</p>
<p style="position:absolute;top:395px;left:137px;white-space:nowrap" class="ft5433"><b>DAA_METHOD</b></p>
<p style="position:absolute;top:395px;left:237px;white-space:nowrap" class="ft5417">&#160;behind&#160;a&#160;higher&#160;level&#160;object&#160;represented&#160;by&#160;the&#160;</p>
<p style="position:absolute;top:395px;left:642px;white-space:nowrap" class="ft5433"><b>DAA</b></p>
<p style="position:absolute;top:395px;left:672px;white-space:nowrap" class="ft5417">&#160;structure&#160;(refer&#160;</p>
<p style="position:absolute;top:414px;left:137px;white-space:nowrap" class="ft5417">to&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#54">&#160;4.1.2&#160;</a>for&#160;more&#160;details).&#160;This&#160;interface&#160;allows&#160;to:</p>
<p style="position:absolute;top:447px;left:164px;white-space:nowrap" class="ft5412">■</p>
<p style="position:absolute;top:443px;left:191px;white-space:nowrap" class="ft5417">Get&#160;and&#160;set&#160;the&#160;default&#160;DAA&#160;method&#160;to&#160;be&#160;used&#160;when&#160;creating&#160;new&#160;</p>
<p style="position:absolute;top:443px;left:753px;white-space:nowrap" class="ft5433"><b>DAA&#160;</b></p>
<p style="position:absolute;top:462px;left:191px;white-space:nowrap" class="ft5417">structures.</p>
<p style="position:absolute;top:495px;left:164px;white-space:nowrap" class="ft5412">■</p>
<p style="position:absolute;top:490px;left:191px;white-space:nowrap" class="ft5417">Select&#160;and&#160;use&#160;a&#160;specific&#160;DAA&#160;method&#160;for&#160;a&#160;given&#160;</p>
<p style="position:absolute;top:490px;left:605px;white-space:nowrap" class="ft5433"><b>DAA</b></p>
<p style="position:absolute;top:490px;left:635px;white-space:nowrap" class="ft5417">&#160;structure.</p>
<p style="position:absolute;top:523px;left:164px;white-space:nowrap" class="ft5412">■</p>
<p style="position:absolute;top:518px;left:191px;white-space:nowrap" class="ft5417">Access&#160;the&#160;method&#160;primitives&#160;from&#160;the&#160;</p>
<p style="position:absolute;top:518px;left:519px;white-space:nowrap" class="ft5433"><b>DAA</b></p>
<p style="position:absolute;top:518px;left:548px;white-space:nowrap" class="ft5417">&#160;structure.</p>
<p style="position:absolute;top:551px;left:164px;white-space:nowrap" class="ft5412">■</p>
<p style="position:absolute;top:546px;left:191px;white-space:nowrap" class="ft5419">According&#160;to&#160;OpenSSL&#160;design,&#160;at&#160;this&#160;layer&#160;input/output&#160;of&#160;functions&#160;are&#160;<br/>internal&#160;data&#160;structures.</p>
<p style="position:absolute;top:594px;left:137px;white-space:nowrap" class="ft5419">This&#160;interface&#160;should&#160;not&#160;directly&#160;used&#160;by&#160;an&#160;Application,&#160;but&#160;provides&#160;a&#160;first&#160;<br/>layer&#160;of&#160;separation&#160;between&#160;the&#160;Implementation&#160;layer&#160;where&#160;a&#160;structure&#160;</p>
<p style="position:absolute;top:632px;left:137px;white-space:nowrap" class="ft5433"><b>DAA_METHOD</b></p>
<p style="position:absolute;top:632px;left:237px;white-space:nowrap" class="ft5417">&#160;is&#160;instantiated&#160;and&#160;the&#160;Application&#160;Interface&#160;layer&#160;where&#160;functions&#160;</p>
<p style="position:absolute;top:651px;left:137px;white-space:nowrap" class="ft5417">need&#160;to&#160;access&#160;the&#160;method.</p>
<p style="position:absolute;top:684px;left:110px;white-space:nowrap" class="ft5412">●</p>
<p style="position:absolute;top:680px;left:137px;white-space:nowrap" class="ft5416"><b>Application&#160;Interface&#160;</b></p>
<p style="position:absolute;top:680px;left:339px;white-space:nowrap" class="ft5417">is&#160;the&#160;interface&#160;available&#160;to&#160;the&#160;applications.&#160;It&#160;provides&#160;</p>
<p style="position:absolute;top:699px;left:137px;white-space:nowrap" class="ft5417">functions&#160;to:</p>
<p style="position:absolute;top:732px;left:164px;white-space:nowrap" class="ft5412">■</p>
<p style="position:absolute;top:727px;left:191px;white-space:nowrap" class="ft5417">Created/destroy&#160;a&#160;</p>
<p style="position:absolute;top:727px;left:346px;white-space:nowrap" class="ft5433"><b>DAA</b></p>
<p style="position:absolute;top:727px;left:375px;white-space:nowrap" class="ft5417">&#160;structure.</p>
<p style="position:absolute;top:760px;left:164px;white-space:nowrap" class="ft5412">■</p>
<p style="position:absolute;top:755px;left:191px;white-space:nowrap" class="ft5417">Access/modify&#160;properties&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:755px;left:459px;white-space:nowrap" class="ft5433"><b>DAA</b></p>
<p style="position:absolute;top:755px;left:489px;white-space:nowrap" class="ft5417">&#160;structure.</p>
<p style="position:absolute;top:788px;left:164px;white-space:nowrap" class="ft5412">■</p>
<p style="position:absolute;top:783px;left:191px;white-space:nowrap" class="ft5419">Invoke&#160;cryptographic&#160;primitives&#160;of&#160;the&#160;referenced&#160;method.&#160;According&#160;to&#160;<br/>OpenSSL&#160;design,&#160;at&#160;this&#160;layer&#160;input/output&#160;of&#160;functions&#160;are&#160;buffers&#160;<br/>(notably,&#160;in&#160;this&#160;context,&#160;digests&#160;and&#160;signatures)&#160;and&#160;there&#160;is&#160;not&#160;visibility&#160;<br/>of&#160;the&#160;internal&#160;data&#160;structures&#160;used&#160;to&#160;make&#160;computation.</p>
<p style="position:absolute;top:869px;left:137px;white-space:nowrap" class="ft5417">Further&#160;details&#160;are&#160;given&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#58">&#160;4.2.</a></p>
<p style="position:absolute;top:915px;left:83px;white-space:nowrap" class="ft5436"><i><b>4.1.2&#160;&#160;&#160;Data&#160;Structures</b></i></p>
<p style="position:absolute;top:945px;left:83px;white-space:nowrap" class="ft5419">Four&#160;main&#160;data&#160;structures&#160;are&#160;involved&#160;in&#160;the&#160;DAA&#160;interface.&#160;The&#160;relationship&#160;among&#160;<br/>them&#160;is&#160;depicted&#160;in<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#55">&#160;Figure&#160;6.</a></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5421">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft5421">25/61</p>
</div>
<!-- Page 55 -->
<a name="55"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page55-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3055.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft559">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft550">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft5521">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft5521">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:653px;left:83px;white-space:nowrap" class="ft5517">In&#160;more&#160;details:</p>
<p style="position:absolute;top:686px;left:110px;white-space:nowrap" class="ft5512">●</p>
<p style="position:absolute;top:682px;left:137px;white-space:nowrap" class="ft5533"><b>DAA</b></p>
<p style="position:absolute;top:682px;left:167px;white-space:nowrap" class="ft5517">&#160;is&#160;the&#160;main&#160;data&#160;structure,&#160;available&#160;at&#160;Application&#160;Interface&#160;layer.&#160;It&#160;</p>
<p style="position:absolute;top:701px;left:137px;white-space:nowrap" class="ft5519">contains&#160;references&#160;to&#160;other&#160;structures&#160;and&#160;to&#160;two&#160;buffers&#160;to&#160;store&#160;the&#160;Verifier's&#160;<br/>nonce&#160;and&#160;basename.</p>
<p style="position:absolute;top:753px;left:110px;white-space:nowrap" class="ft5512">●</p>
<p style="position:absolute;top:748px;left:137px;white-space:nowrap" class="ft5533"><b>DAA_METHOD</b></p>
<p style="position:absolute;top:748px;left:237px;white-space:nowrap" class="ft5517">&#160;contains&#160;pointers&#160;to&#160;functions&#160;that&#160;represent&#160;the&#160;implementation&#160;of&#160;</p>
<p style="position:absolute;top:767px;left:137px;white-space:nowrap" class="ft5517">the&#160;DAA&#160;algorithms,&#160;which&#160;mainly&#160;consists&#160;of:</p>
<p style="position:absolute;top:800px;left:164px;white-space:nowrap" class="ft5512">■</p>
<p style="position:absolute;top:796px;left:191px;white-space:nowrap" class="ft5516"><b>DAA&#160;Core&#160;Functions</b></p>
<p style="position:absolute;top:796px;left:376px;white-space:nowrap" class="ft5517">:&#160;the&#160;cryptographic&#160;primitives,&#160;detailed&#160;in&#160;Section&#160;</p>
<p style="position:absolute;top:815px;left:191px;white-space:nowrap" class="ft5517"><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#56">4.1.3.</a></p>
<p style="position:absolute;top:848px;left:164px;white-space:nowrap" class="ft5512">■</p>
<p style="position:absolute;top:843px;left:191px;white-space:nowrap" class="ft5533"><b>DAA_ISSUER</b></p>
<p style="position:absolute;top:843px;left:291px;white-space:nowrap" class="ft5516"><b>&#160;Management</b></p>
<p style="position:absolute;top:843px;left:418px;white-space:nowrap" class="ft5517">:&#160;constructor/destructor&#160;and&#160;serialization&#160;</p>
<p style="position:absolute;top:862px;left:191px;white-space:nowrap" class="ft5517">functions&#160;for&#160;the&#160;</p>
<p style="position:absolute;top:862px;left:333px;white-space:nowrap" class="ft5533"><b>DAA_ISSUER</b></p>
<p style="position:absolute;top:862px;left:432px;white-space:nowrap" class="ft5517">&#160;structure&#160;(Issuer&#160;credentials).</p>
<p style="position:absolute;top:895px;left:164px;white-space:nowrap" class="ft5512">■</p>
<p style="position:absolute;top:890px;left:191px;white-space:nowrap" class="ft5533"><b>DAA_KEY</b></p>
<p style="position:absolute;top:890px;left:261px;white-space:nowrap" class="ft5516"><b>&#160;Management</b></p>
<p style="position:absolute;top:890px;left:388px;white-space:nowrap" class="ft5517">:&#160;constructor/destructor&#160;and&#160;serialization&#160;functions&#160;</p>
<p style="position:absolute;top:910px;left:191px;white-space:nowrap" class="ft5517">for&#160;the&#160;</p>
<p style="position:absolute;top:910px;left:252px;white-space:nowrap" class="ft5533"><b>DAA_KEY</b></p>
<p style="position:absolute;top:910px;left:321px;white-space:nowrap" class="ft5517">&#160;structure&#160;(Platform&#160;credentials).</p>
<p style="position:absolute;top:942px;left:164px;white-space:nowrap" class="ft5512">■</p>
<p style="position:absolute;top:938px;left:191px;white-space:nowrap" class="ft5533"><b>DAA_SIG</b></p>
<p style="position:absolute;top:938px;left:261px;white-space:nowrap" class="ft5516"><b>&#160;Management</b></p>
<p style="position:absolute;top:938px;left:388px;white-space:nowrap" class="ft5517">:&#160;constructor/destructor&#160;and&#160;serialization&#160;functions&#160;</p>
<p style="position:absolute;top:957px;left:191px;white-space:nowrap" class="ft5517">for&#160;the&#160;</p>
<p style="position:absolute;top:957px;left:252px;white-space:nowrap" class="ft5533"><b>DAA_SIG</b></p>
<p style="position:absolute;top:957px;left:321px;white-space:nowrap" class="ft5517">&#160;structure&#160;(DAA&#160;signature).</p>
<p style="position:absolute;top:990px;left:110px;white-space:nowrap" class="ft5512">●</p>
<p style="position:absolute;top:985px;left:137px;white-space:nowrap" class="ft5533"><b>DAA_KEY</b></p>
<p style="position:absolute;top:985px;left:207px;white-space:nowrap" class="ft5517">&#160;represents&#160;the&#160;Platform&#160;credentials,&#160;necessary&#160;to&#160;compute&#160;a&#160;DAA&#160;</p>
<p style="position:absolute;top:1004px;left:137px;white-space:nowrap" class="ft5519">signature.&#160;This&#160;structure&#160;is&#160;a&#160;wrapper&#160;to&#160;a&#160;specific&#160;key&#160;type,&#160;which&#160;depends&#160;on&#160;<br/>the&#160;actual&#160;implementation&#160;provided&#160;by&#160;the&#160;DAA&#160;method.</p>
<p style="position:absolute;top:1056px;left:110px;white-space:nowrap" class="ft5512">●</p>
<p style="position:absolute;top:1052px;left:137px;white-space:nowrap" class="ft5533"><b>DAA_ISSUER</b></p>
<p style="position:absolute;top:1052px;left:237px;white-space:nowrap" class="ft5517">&#160;represents&#160;the&#160;Issuer&#160;credentials,&#160;necessary&#160;to&#160;verify&#160;the&#160;</p>
<p style="position:absolute;top:1071px;left:137px;white-space:nowrap" class="ft5519">correctness&#160;of&#160;a&#160;DAA&#160;signature.&#160;This&#160;structure&#160;is&#160;a&#160;wrapper&#160;to&#160;a&#160;specific&#160;type,&#160;<br/>which&#160;depends&#160;on&#160;the&#160;actual&#160;implementation&#160;provided&#160;by&#160;the&#160;DAA&#160;method.</p>
<p style="position:absolute;top:1118px;left:83px;white-space:nowrap" class="ft5517">In&#160;order&#160;to&#160;maintain&#160;consistency&#160;inside&#160;a&#160;DAA&#160;structure,&#160;all&#160;data&#160;structure&#160;contain&#160;a&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5521">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft5521">26/61</p>
<p style="position:absolute;top:606px;left:219px;white-space:nowrap" class="ft5517">Figure&#160;6:&#160;Direct&#160;Anonymous&#160;Attestation&#160;Data&#160;Structure</p>
</div>
<!-- Page 56 -->
<a name="56"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page56-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3056.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft569">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft560">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft5621">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft5621">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft5633"><b>version</b></p>
<p style="position:absolute;top:149px;left:153px;white-space:nowrap" class="ft5617">&#160;field&#160;(not&#160;shown&#160;for&#160;simplicity&#160;in&#160;the&#160;figure).&#160;A&#160;proper&#160;implementation&#160;of&#160;a&#160;</p>
<p style="position:absolute;top:168px;left:83px;white-space:nowrap" class="ft5625">DAA&#160;method&#160;SHOULD&#160;process&#160;only&#160;data&#160;structures&#160;with&#160;its&#160;same&#160;version.<br/>Currently,&#160;this&#160;implementation&#160;defines&#160;the&#160;following&#160;versions:</p>
<p style="position:absolute;top:229px;left:110px;white-space:nowrap" class="ft5612">●</p>
<p style="position:absolute;top:225px;left:137px;white-space:nowrap" class="ft5619">The&#160;original&#160;RSA-based&#160;DAA&#160;described&#160;in&#160;[7]&#160;(purely&#160;software&#160;implementation,&#160;<br/>currently&#160;not&#160;implemented).</p>
<p style="position:absolute;top:277px;left:110px;white-space:nowrap" class="ft5612">●</p>
<p style="position:absolute;top:272px;left:137px;white-space:nowrap" class="ft5619">The&#160;TCG&#160;TSS/TPM&#160;DAA&#160;profile&#160;that&#160;exploits&#160;the&#160;RSA-based&#160;version&#160;of&#160;DAA&#160;and&#160;is&#160;<br/>specified&#160;in&#160;[1]&#160;(with&#160;actual&#160;TPM&#160;support,&#160;implemented&#160;through&#160;the&#160;engine&#160;<br/>described&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#71">&#160;6)</a>.</p>
<p style="position:absolute;top:343px;left:110px;white-space:nowrap" class="ft5612">●</p>
<p style="position:absolute;top:339px;left:137px;white-space:nowrap" class="ft5619">The&#160;symmetric&#160;pairing-based&#160;version&#160;of&#160;DAA&#160;described&#160;in&#160;[8]&#160;(purely&#160;software&#160;<br/>implementation,&#160;currently&#160;not&#160;implemented).</p>
<p style="position:absolute;top:391px;left:110px;white-space:nowrap" class="ft5612">●</p>
<p style="position:absolute;top:386px;left:137px;white-space:nowrap" class="ft5619">The&#160;asymmetric&#160;pairing-based&#160;version&#160;of&#160;DAA&#160;described&#160;in&#160;[9]&#160;(purely&#160;software&#160;<br/>implementation,&#160;currently&#160;implemented&#160;through&#160;the&#160;Miracl&#160;engine&#160;mentioned&#160;in&#160;<br/>Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#34">&#160;2)</a>.</p>
<p style="position:absolute;top:453px;left:83px;white-space:nowrap" class="ft5617">In&#160;addition&#160;to&#160;the&#160;previously&#160;described&#160;structures,&#160;a&#160;</p>
<p style="position:absolute;top:453px;left:517px;white-space:nowrap" class="ft5633"><b>DAA_SIG</b></p>
<p style="position:absolute;top:453px;left:587px;white-space:nowrap" class="ft5617">&#160;structure&#160;is&#160;defined&#160;(not&#160;</p>
<p style="position:absolute;top:472px;left:83px;white-space:nowrap" class="ft5617">shown&#160;in<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#55">&#160;Figure&#160;6&#160;</a>for&#160;simplicity).&#160;Similarly&#160;to&#160;</p>
<p style="position:absolute;top:472px;left:458px;white-space:nowrap" class="ft5633"><b>DAA_KEY</b></p>
<p style="position:absolute;top:472px;left:527px;white-space:nowrap" class="ft5617">&#160;and&#160;</p>
<p style="position:absolute;top:472px;left:569px;white-space:nowrap" class="ft5633"><b>DAA_ISSUER</b></p>
<p style="position:absolute;top:472px;left:668px;white-space:nowrap" class="ft5617">,&#160;it&#160;is&#160;a&#160;wrapper&#160;</p>
<p style="position:absolute;top:491px;left:83px;white-space:nowrap" class="ft5619">to&#160;a&#160;specific&#160;signature&#160;type,&#160;which&#160;depends&#160;on&#160;the&#160;actual&#160;implementation&#160;provided&#160;by&#160;<br/>the&#160;DAA&#160;method.&#160;As&#160;already&#160;mentioned,&#160;the&#160;</p>
<p style="position:absolute;top:510px;left:455px;white-space:nowrap" class="ft5633"><b>DAA_SIG</b></p>
<p style="position:absolute;top:510px;left:524px;white-space:nowrap" class="ft5617">&#160;structure&#160;is&#160;hidden&#160;at&#160;Application&#160;</p>
<p style="position:absolute;top:530px;left:83px;white-space:nowrap" class="ft5619">Interface&#160;layer,&#160;by&#160;encoding/decoding&#160;it&#160;into&#160;buffers.&#160;For&#160;this&#160;reason&#160;no&#160;further&#160;details&#160;<br/>are&#160;presented&#160;in&#160;the&#160;following.</p>
<p style="position:absolute;top:595px;left:83px;white-space:nowrap" class="ft5636"><i><b>4.1.3&#160;&#160;&#160;Workflow</b></i></p>
<p style="position:absolute;top:625px;left:83px;white-space:nowrap" class="ft5619">This&#160;section&#160;describes&#160;in&#160;more&#160;details&#160;the&#160;cryptographic&#160;primitives&#160;related&#160;to&#160;DAA&#160;and&#160;<br/>the&#160;workflow&#160;from&#160;the&#160;Application&#160;Interface&#160;down&#160;to&#160;the&#160;actual&#160;Implementation&#160;layer.</p>
<p style="position:absolute;top:677px;left:110px;white-space:nowrap" class="ft5612">●</p>
<p style="position:absolute;top:672px;left:137px;white-space:nowrap" class="ft5616"><b>Verifier&#160;Init</b></p>
<p style="position:absolute;top:672px;left:245px;white-space:nowrap" class="ft5617">.&#160;The&#160;Verifier&#160;generates&#160;a&#160;nonce&#160;and&#160;sets&#160;a&#160;basename.&#160;The&#160;</p>
<p style="position:absolute;top:691px;left:137px;white-space:nowrap" class="ft5617">Application&#160;Interface&#160;layer&#160;function&#160;</p>
<p style="position:absolute;top:691px;left:433px;white-space:nowrap" class="ft5633"><b>DAA_sign_verifier_init()</b></p>
<p style="position:absolute;top:691px;left:672px;white-space:nowrap" class="ft5617">&#160;directly&#160;</p>
<p style="position:absolute;top:711px;left:137px;white-space:nowrap" class="ft5617">accesses&#160;the&#160;Implementation&#160;layer&#160;primitive&#160;</p>
<p style="position:absolute;top:711px;left:511px;white-space:nowrap" class="ft5633"><b>sign_verifier_init()</b></p>
<p style="position:absolute;top:711px;left:710px;white-space:nowrap" class="ft5617">&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:730px;left:137px;white-space:nowrap" class="ft5619">method.&#160;Since&#160;both&#160;nonce&#160;and&#160;basename&#160;are&#160;buffers,&#160;there&#160;is&#160;no&#160;need&#160;for&#160;the&#160;<br/>intermediate&#160;Method&#160;Interface&#160;layer.</p>
<p style="position:absolute;top:782px;left:110px;white-space:nowrap" class="ft5612">●</p>
<p style="position:absolute;top:777px;left:137px;white-space:nowrap" class="ft5616"><b>Sign</b></p>
<p style="position:absolute;top:777px;left:179px;white-space:nowrap" class="ft5617">.&#160;The&#160;User/platform&#160;computes&#160;a&#160;DAA&#160;signature&#160;on&#160;a&#160;message&#160;digest.&#160;The&#160;</p>
<p style="position:absolute;top:796px;left:137px;white-space:nowrap" class="ft5619">workflow&#160;is&#160;summarized&#160;in<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#57">&#160;Figure&#160;7.</a>&#160;This&#160;implementation&#160;reflects&#160;the&#160;original&#160;<br/>design&#160;of&#160;DAA&#160;where&#160;the&#160;User/platform&#160;is&#160;divided&#160;into&#160;Host&#160;and&#160;TPM;&#160;note&#160;that&#160;in&#160;<br/>this&#160;context&#160;TPM&#160;does&#160;not&#160;refer&#160;to&#160;the&#160;hardware&#160;TCG's&#160;TPM,&#160;but&#160;it&#160;is&#160;used&#160;to&#160;<br/>isolate&#160;the&#160;critical&#160;component&#160;from&#160;the&#160;rest&#160;of&#160;the&#160;platform.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5621">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft5621">27/61</p>
</div>
<!-- Page 57 -->
<a name="57"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page57-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3057.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft579">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft570">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft5721">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft5721">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:683px;left:163px;white-space:nowrap" class="ft5717">1.The&#160;Application&#160;Interface&#160;layer&#160;function&#160;</p>
<p style="position:absolute;top:683px;left:510px;white-space:nowrap" class="ft5733"><b>DAA_sign()</b></p>
<p style="position:absolute;top:683px;left:610px;white-space:nowrap" class="ft5717">&#160;invokes&#160;the&#160;Method&#160;</p>
<p style="position:absolute;top:702px;left:190px;white-space:nowrap" class="ft5717">Interface&#160;layer&#160;function&#160;</p>
<p style="position:absolute;top:702px;left:388px;white-space:nowrap" class="ft5733"><b>DAA_do_sign()</b></p>
<p style="position:absolute;top:702px;left:518px;white-space:nowrap" class="ft5717">.</p>
<p style="position:absolute;top:730px;left:163px;white-space:nowrap" class="ft5717">2.The&#160;Method&#160;Interface&#160;layer&#160;function&#160;</p>
<p style="position:absolute;top:730px;left:480px;white-space:nowrap" class="ft5733"><b>DAA_do_sign()</b></p>
<p style="position:absolute;top:730px;left:609px;white-space:nowrap" class="ft5717">&#160;invokes&#160;the&#160;</p>
<p style="position:absolute;top:750px;left:190px;white-space:nowrap" class="ft5717">Implementation&#160;layer&#160;primitive&#160;</p>
<p style="position:absolute;top:750px;left:452px;white-space:nowrap" class="ft5733"><b>daa_do_sign()</b></p>
<p style="position:absolute;top:750px;left:581px;white-space:nowrap" class="ft5717">&#160;of&#160;the&#160;method.</p>
<p style="position:absolute;top:778px;left:163px;white-space:nowrap" class="ft5717">3.</p>
<p style="position:absolute;top:778px;left:179px;white-space:nowrap" class="ft5733"><b>daa_do_sign()</b></p>
<p style="position:absolute;top:778px;left:308px;white-space:nowrap" class="ft5717">&#160;actually&#160;computes&#160;the&#160;DAA&#160;signature.&#160;In&#160;order&#160;to&#160;reflect&#160;the&#160;</p>
<p style="position:absolute;top:797px;left:190px;white-space:nowrap" class="ft5717">original&#160;design&#160;in&#160;the&#160;DAA&#160;definition,&#160;&#160;</p>
<p style="position:absolute;top:797px;left:503px;white-space:nowrap" class="ft5733"><b>daa_do_sign()</b></p>
<p style="position:absolute;top:797px;left:633px;white-space:nowrap" class="ft5717">&#160;is&#160;expected&#160;to&#160;call&#160;</p>
<p style="position:absolute;top:816px;left:190px;white-space:nowrap" class="ft5717">the&#160;primitives&#160;</p>
<p style="position:absolute;top:816px;left:309px;white-space:nowrap" class="ft5733"><b>daa_sign_tpm_phase1()</b></p>
<p style="position:absolute;top:816px;left:518px;white-space:nowrap" class="ft5717">&#160;and&#160;</p>
<p style="position:absolute;top:816px;left:560px;white-space:nowrap" class="ft5733"><b>daa_sign_tpm_phase2()&#160;</b></p>
<p style="position:absolute;top:835px;left:190px;white-space:nowrap" class="ft5719">which&#160;perform&#160;the&#160;computation&#160;on&#160;the&#160;TPM&#160;side.&#160;Note&#160;that&#160;an&#160;actual&#160;<br/>implementation&#160;may&#160;avoid&#160;the&#160;definition&#160;of&#160;the&#160;two&#160;TPM&#160;primitives.</p>
<p style="position:absolute;top:883px;left:163px;white-space:nowrap" class="ft5717">4.</p>
<p style="position:absolute;top:883px;left:179px;white-space:nowrap" class="ft5733"><b>daa_do_sign()</b></p>
<p style="position:absolute;top:883px;left:308px;white-space:nowrap" class="ft5717">&#160;returns&#160;a&#160;</p>
<p style="position:absolute;top:883px;left:393px;white-space:nowrap" class="ft5733"><b>DAA_SIG</b></p>
<p style="position:absolute;top:883px;left:463px;white-space:nowrap" class="ft5717">&#160;structure.</p>
<p style="position:absolute;top:911px;left:163px;white-space:nowrap" class="ft5717">5.</p>
<p style="position:absolute;top:911px;left:179px;white-space:nowrap" class="ft5733"><b>DAA_do_sign()</b></p>
<p style="position:absolute;top:911px;left:308px;white-space:nowrap" class="ft5717">&#160;forwards&#160;the&#160;</p>
<p style="position:absolute;top:911px;left:423px;white-space:nowrap" class="ft5733"><b>DAA_SIG</b></p>
<p style="position:absolute;top:911px;left:492px;white-space:nowrap" class="ft5717">&#160;structure&#160;to&#160;the&#160;caller.</p>
<p style="position:absolute;top:939px;left:163px;white-space:nowrap" class="ft5717">6.At&#160;Application&#160;Interface&#160;layer,&#160;</p>
<p style="position:absolute;top:939px;left:430px;white-space:nowrap" class="ft5733"><b>DAA_sign()</b></p>
<p style="position:absolute;top:939px;left:530px;white-space:nowrap" class="ft5717">&#160;converts&#160;the&#160;</p>
<p style="position:absolute;top:939px;left:644px;white-space:nowrap" class="ft5733"><b>DAA_SIG</b></p>
<p style="position:absolute;top:939px;left:713px;white-space:nowrap" class="ft5717">&#160;structure&#160;</p>
<p style="position:absolute;top:958px;left:190px;white-space:nowrap" class="ft5717">in&#160;a&#160;buffer,&#160;calling&#160;the&#160;function&#160;</p>
<p style="position:absolute;top:958px;left:450px;white-space:nowrap" class="ft5733"><b>i2d_DAA_SIG()</b></p>
<p style="position:absolute;top:958px;left:579px;white-space:nowrap" class="ft5717">&#160;(which&#160;relies&#160;on&#160;a&#160;primitive&#160;</p>
<p style="position:absolute;top:978px;left:190px;white-space:nowrap" class="ft5717">at&#160;Implementation&#160;layer,&#160;not&#160;shown&#160;for&#160;simplicity&#160;in&#160;the&#160;picture).</p>
<p style="position:absolute;top:1006px;left:163px;white-space:nowrap" class="ft5717">7.Finally,&#160;</p>
<p style="position:absolute;top:1006px;left:243px;white-space:nowrap" class="ft5733"><b>DAA_sign()</b></p>
<p style="position:absolute;top:1006px;left:342px;white-space:nowrap" class="ft5717">&#160;returns&#160;the&#160;DAA&#160;signature&#160;as&#160;a&#160;buffer&#160;to&#160;the&#160;calling&#160;</p>
<p style="position:absolute;top:1025px;left:190px;white-space:nowrap" class="ft5717">application.</p>
<p style="position:absolute;top:1058px;left:110px;white-space:nowrap" class="ft5712">●</p>
<p style="position:absolute;top:1053px;left:137px;white-space:nowrap" class="ft5716"><b>Verify</b></p>
<p style="position:absolute;top:1053px;left:193px;white-space:nowrap" class="ft5717">.&#160;The&#160;Verifier&#160;checks&#160;the&#160;correctness&#160;of&#160;a&#160;DAA&#160;signature.&#160;The&#160;worklow&#160;is&#160;</p>
<p style="position:absolute;top:1072px;left:137px;white-space:nowrap" class="ft5717">summarized&#160;in<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#58">&#160;Figure&#160;8.</a></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5721">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft5721">28/61</p>
<p style="position:absolute;top:636px;left:221px;white-space:nowrap" class="ft5717">Figure&#160;7:&#160;Direct&#160;Anonymous&#160;Attestation&#160;Sign&#160;Workflow</p>
</div>
<!-- Page 58 -->
<a name="58"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page58-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3058.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft589">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft580">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft5821">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft5821">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:670px;left:163px;white-space:nowrap" class="ft5817">1.The&#160;Application&#160;Interface&#160;layer&#160;function&#160;</p>
<p style="position:absolute;top:670px;left:510px;white-space:nowrap" class="ft5833"><b>DAA_verify()</b></p>
<p style="position:absolute;top:670px;left:630px;white-space:nowrap" class="ft5817">&#160;receives&#160;in&#160;input&#160;a&#160;</p>
<p style="position:absolute;top:689px;left:190px;white-space:nowrap" class="ft5819">buffer&#160;containing&#160;the&#160;DAA&#160;signature.&#160;First&#160;it&#160;deserializes&#160;the&#160;signature&#160;into&#160;<br/>a&#160;</p>
<p style="position:absolute;top:709px;left:205px;white-space:nowrap" class="ft5833"><b>DAA_SIG</b></p>
<p style="position:absolute;top:709px;left:275px;white-space:nowrap" class="ft5817">&#160;structure,&#160;invoking&#160;</p>
<p style="position:absolute;top:709px;left:441px;white-space:nowrap" class="ft5833"><b>d2i_DAA_SIG()</b></p>
<p style="position:absolute;top:709px;left:570px;white-space:nowrap" class="ft5817">&#160;(which&#160;relies&#160;on&#160;a&#160;primitive&#160;</p>
<p style="position:absolute;top:728px;left:190px;white-space:nowrap" class="ft5817">at&#160;Implementation&#160;layer,&#160;not&#160;shown&#160;for&#160;simplicity&#160;in&#160;the&#160;picture).</p>
<p style="position:absolute;top:756px;left:163px;white-space:nowrap" class="ft5817">2.</p>
<p style="position:absolute;top:756px;left:179px;white-space:nowrap" class="ft5833"><b>DAA_verify()</b></p>
<p style="position:absolute;top:756px;left:298px;white-space:nowrap" class="ft5817">&#160;continues&#160;by&#160;invoking&#160;the&#160;Method&#160;Interface&#160;layer&#160;function&#160;</p>
<p style="position:absolute;top:775px;left:190px;white-space:nowrap" class="ft5833"><b>DAA_do_verify()</b></p>
<p style="position:absolute;top:775px;left:339px;white-space:nowrap" class="ft5817">,&#160;that&#160;accepts&#160;in&#160;input&#160;the&#160;</p>
<p style="position:absolute;top:775px;left:558px;white-space:nowrap" class="ft5833"><b>DAA_SIG</b></p>
<p style="position:absolute;top:775px;left:627px;white-space:nowrap" class="ft5817">&#160;structure.</p>
<p style="position:absolute;top:803px;left:163px;white-space:nowrap" class="ft5817">3.The&#160;Method&#160;Interface&#160;layer&#160;function&#160;</p>
<p style="position:absolute;top:803px;left:480px;white-space:nowrap" class="ft5833"><b>DAA_do_verify()</b></p>
<p style="position:absolute;top:803px;left:629px;white-space:nowrap" class="ft5817">&#160;invokes&#160;the&#160;</p>
<p style="position:absolute;top:823px;left:190px;white-space:nowrap" class="ft5817">Implementation&#160;layer&#160;primitive&#160;</p>
<p style="position:absolute;top:823px;left:452px;white-space:nowrap" class="ft5833"><b>daa_do_verify()</b></p>
<p style="position:absolute;top:823px;left:601px;white-space:nowrap" class="ft5817">&#160;of&#160;the&#160;method.</p>
<p style="position:absolute;top:851px;left:163px;white-space:nowrap" class="ft5817">4.</p>
<p style="position:absolute;top:851px;left:179px;white-space:nowrap" class="ft5833"><b>daa_do_verify()</b></p>
<p style="position:absolute;top:851px;left:328px;white-space:nowrap" class="ft5817">&#160;returns&#160;either&#160;success&#160;or&#160;failure.</p>
<p style="position:absolute;top:879px;left:163px;white-space:nowrap" class="ft5817">5.</p>
<p style="position:absolute;top:879px;left:179px;white-space:nowrap" class="ft5833"><b>DAA_do_sign()</b></p>
<p style="position:absolute;top:879px;left:308px;white-space:nowrap" class="ft5817">&#160;forwards&#160;the&#160;response&#160;to&#160;the&#160;caller.</p>
<p style="position:absolute;top:907px;left:163px;white-space:nowrap" class="ft5817">6.Finally,&#160;</p>
<p style="position:absolute;top:907px;left:243px;white-space:nowrap" class="ft5833"><b>DAA_verify()</b></p>
<p style="position:absolute;top:907px;left:362px;white-space:nowrap" class="ft5817">&#160;returns&#160;either&#160;success&#160;or&#160;failure&#160;to&#160;the&#160;calling&#160;</p>
<p style="position:absolute;top:926px;left:190px;white-space:nowrap" class="ft5817">application.</p>
<p style="position:absolute;top:972px;left:83px;white-space:nowrap" class="ft5834"><i><b>4.2&#160;&#160;&#160;Application&#160;Programming&#160;Interface</b></i></p>
<p style="position:absolute;top:1022px;left:83px;white-space:nowrap" class="ft5836"><i><b>4.2.1&#160;&#160;&#160;Application&#160;Interface</b></i></p>
<p style="position:absolute;top:1052px;left:83px;white-space:nowrap" class="ft5819">These&#160;functions&#160;are&#160;used&#160;by&#160;developers&#160;that&#160;write&#160;applications&#160;that&#160;use&#160;DAA&#160;as&#160;<br/>cryptographic&#160;protocol.</p>
<p style="position:absolute;top:1099px;left:83px;white-space:nowrap" class="ft5841"><b>DAA* DAA_new (void)</b></p>
<p style="position:absolute;top:1118px;left:137px;white-space:nowrap" class="ft5817">DAA&#160;structure&#160;constructor.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5821">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft5821">29/61</p>
<p style="position:absolute;top:623px;left:215px;white-space:nowrap" class="ft5817">Figure&#160;8:&#160;Direct&#160;Anonymous&#160;Attestation&#160;Verify&#160;Workflow</p>
</div>
<!-- Page 59 -->
<a name="59"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page59-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3059.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft599">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft590">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft5921">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft5921">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft5917">Generates&#160;a&#160;new&#160;DAA&#160;structure&#160;relying&#160;on&#160;the&#160;Method&#160;Interface&#160;layer&#160;function&#160;</p>
<p style="position:absolute;top:168px;left:137px;white-space:nowrap" class="ft5933"><b>DAA_new_method()</b></p>
<p style="position:absolute;top:168px;left:296px;white-space:nowrap" class="ft5917">.&#160;It&#160;invokes&#160;</p>
<p style="position:absolute;top:168px;left:391px;white-space:nowrap" class="ft5933"><b>DAA_new_method()</b></p>
<p style="position:absolute;top:168px;left:550px;white-space:nowrap" class="ft5917">&#160;with&#160;a&#160;NULL&#160;engine,&#160;which&#160;</p>
<p style="position:absolute;top:188px;left:137px;white-space:nowrap" class="ft5917">means&#160;the&#160;function&#160;actually&#160;returns&#160;a&#160;DAA&#160;structure&#160;with&#160;method&#160;</p>
<p style="position:absolute;top:207px;left:137px;white-space:nowrap" class="ft5933"><b>DAA_get_default_method()</b></p>
<p style="position:absolute;top:207px;left:375px;white-space:nowrap" class="ft5917">&#160;and&#160;engine&#160;ENGINE_get_default_DAA().</p>
<p style="position:absolute;top:235px;left:137px;white-space:nowrap" class="ft5919">Loading&#160;an&#160;engine&#160;(e.g.&#160;with&#160;standard&#160;-engine&#160;option&#160;of&#160;OpenSSL&#160;commands)&#160;<br/>overwrite&#160;the&#160;default&#160;method&#160;and&#160;engine,&#160;hence&#160;the&#160;result&#160;of&#160;this&#160;function&#160;is&#160;a&#160;<br/>DAA&#160;structure&#160;which&#160;is&#160;based&#160;on&#160;the&#160;loaded&#160;engine.</p>
<p style="position:absolute;top:302px;left:137px;white-space:nowrap" class="ft5943"><b>Returns:</b></p>
<p style="position:absolute;top:330px;left:137px;white-space:nowrap" class="ft5917">Pointer&#160;to&#160;the&#160;new&#160;DAA&#160;structure&#160;</p>
<p style="position:absolute;top:358px;left:83px;white-space:nowrap" class="ft5941"><b>void DAA_free (DAA *&#160;</b></p>
<p style="position:absolute;top:358px;left:291px;white-space:nowrap" class="ft5942"><i><b>daa</b></i></p>
<p style="position:absolute;top:358px;left:321px;white-space:nowrap" class="ft5941"><b>)</b></p>
<p style="position:absolute;top:376px;left:137px;white-space:nowrap" class="ft5925">DAA&#160;structure&#160;destructor.<br/>Destroys&#160;a&#160;DAA&#160;structure,&#160;by&#160;calling&#160;internal&#160;DAA_KEY&#160;and&#160;DAA_ISSUER&#160;free.</p>
<p style="position:absolute;top:433px;left:137px;white-space:nowrap" class="ft5943"><b>Parameters:</b></p>
<p style="position:absolute;top:461px;left:137px;white-space:nowrap" class="ft5939"><i>daa</i></p>
<p style="position:absolute;top:461px;left:167px;white-space:nowrap" class="ft5917">&#160;Pointer&#160;to&#160;the&#160;DAA&#160;structure&#160;</p>
<p style="position:absolute;top:489px;left:83px;white-space:nowrap" class="ft5941"><b>int DAA_get_version (const DAA *&#160;</b></p>
<p style="position:absolute;top:489px;left:410px;white-space:nowrap" class="ft5942"><i><b>daa</b></i></p>
<p style="position:absolute;top:489px;left:440px;white-space:nowrap" class="ft5941"><b>)</b></p>
<p style="position:absolute;top:508px;left:137px;white-space:nowrap" class="ft5917">Returns&#160;the&#160;binding&#160;version&#160;of&#160;the&#160;supplied&#160;DAA&#160;structure.</p>
<p style="position:absolute;top:536px;left:137px;white-space:nowrap" class="ft5943"><b>Parameters:</b></p>
<p style="position:absolute;top:564px;left:137px;white-space:nowrap" class="ft5939"><i>daa</i></p>
<p style="position:absolute;top:564px;left:167px;white-space:nowrap" class="ft5917">&#160;Pointer&#160;to&#160;the&#160;DAA&#160;structure&#160;</p>
<p style="position:absolute;top:593px;left:137px;white-space:nowrap" class="ft5943"><b>Returns:</b></p>
<p style="position:absolute;top:620px;left:137px;white-space:nowrap" class="ft5917">The&#160;DAA&#160;binding&#160;version&#160;</p>
<p style="position:absolute;top:648px;left:83px;white-space:nowrap" class="ft5941"><b>int DAA_set_nonce (unsigned int&#160;</b></p>
<p style="position:absolute;top:648px;left:400px;white-space:nowrap" class="ft5942"><i><b>nonce_len</b></i></p>
<p style="position:absolute;top:648px;left:489px;white-space:nowrap" class="ft5941"><b>, &#160; unsigned char *&#160;</b></p>
<p style="position:absolute;top:648px;left:687px;white-space:nowrap" class="ft5942"><i><b>nonce</b></i></p>
<p style="position:absolute;top:648px;left:737px;white-space:nowrap" class="ft5941"><b>, &#160; DAA&#160;</b></p>
<p style="position:absolute;top:667px;left:83px;white-space:nowrap" class="ft5941"><b>*&#160;</b></p>
<p style="position:absolute;top:667px;left:103px;white-space:nowrap" class="ft5942"><i><b>daa</b></i></p>
<p style="position:absolute;top:667px;left:133px;white-space:nowrap" class="ft5941"><b>)</b></p>
<p style="position:absolute;top:686px;left:137px;white-space:nowrap" class="ft5917">Sets&#160;the&#160;Verifier's&#160;nonce&#160;into&#160;the&#160;supplied&#160;DAA&#160;structure.</p>
<p style="position:absolute;top:714px;left:137px;white-space:nowrap" class="ft5943"><b>Parameters:</b></p>
<p style="position:absolute;top:742px;left:137px;white-space:nowrap" class="ft5939"><i>nonce_len</i></p>
<p style="position:absolute;top:742px;left:220px;white-space:nowrap" class="ft5917">&#160;Length&#160;of&#160;the&#160;buffer&#160;containing&#160;the&#160;Verifier's&#160;nonce&#160;</p>
<p style="position:absolute;top:770px;left:137px;white-space:nowrap" class="ft5939"><i>nonce</i></p>
<p style="position:absolute;top:770px;left:187px;white-space:nowrap" class="ft5917">&#160;Buffer&#160;containing&#160;the&#160;Verifier's&#160;nonce&#160;</p>
<p style="position:absolute;top:798px;left:137px;white-space:nowrap" class="ft5939"><i>daa</i></p>
<p style="position:absolute;top:798px;left:167px;white-space:nowrap" class="ft5917">&#160;Pointer&#160;to&#160;the&#160;DAA&#160;structure&#160;</p>
<p style="position:absolute;top:827px;left:137px;white-space:nowrap" class="ft5943"><b>Returns:</b></p>
<p style="position:absolute;top:854px;left:137px;white-space:nowrap" class="ft5925">1&#160;in&#160;case&#160;of&#160;success&#160;<br/>-1&#160;in&#160;case&#160;of&#160;error&#160;</p>
<p style="position:absolute;top:911px;left:83px;white-space:nowrap" class="ft5941"><b>int DAA_set_basename (unsigned int&#160;</b></p>
<p style="position:absolute;top:911px;left:430px;white-space:nowrap" class="ft5942"><i><b>basename_len</b></i></p>
<p style="position:absolute;top:911px;left:549px;white-space:nowrap" class="ft5941"><b>, &#160; unsigned char *&#160;</b></p>
<p style="position:absolute;top:929px;left:83px;white-space:nowrap" class="ft5942"><i><b>basename</b></i></p>
<p style="position:absolute;top:929px;left:163px;white-space:nowrap" class="ft5941"><b>, &#160; DAA *&#160;</b></p>
<p style="position:absolute;top:929px;left:262px;white-space:nowrap" class="ft5942"><i><b>daa</b></i></p>
<p style="position:absolute;top:929px;left:291px;white-space:nowrap" class="ft5941"><b>)</b></p>
<p style="position:absolute;top:948px;left:137px;white-space:nowrap" class="ft5917">Sets&#160;the&#160;Verifier's&#160;basename&#160;into&#160;the&#160;supplied&#160;DAA&#160;structure.</p>
<p style="position:absolute;top:977px;left:137px;white-space:nowrap" class="ft5943"><b>Parameters:</b></p>
<p style="position:absolute;top:1004px;left:137px;white-space:nowrap" class="ft5939"><i>basename_len</i></p>
<p style="position:absolute;top:1004px;left:256px;white-space:nowrap" class="ft5917">&#160;Length&#160;of&#160;the&#160;buffer&#160;containing&#160;the&#160;Verifier's&#160;basename&#160;</p>
<p style="position:absolute;top:1032px;left:137px;white-space:nowrap" class="ft5939"><i>basename</i></p>
<p style="position:absolute;top:1032px;left:223px;white-space:nowrap" class="ft5917">&#160;Buffer&#160;containing&#160;the&#160;Verifier's&#160;basename&#160;</p>
<p style="position:absolute;top:1061px;left:137px;white-space:nowrap" class="ft5939"><i>daa</i></p>
<p style="position:absolute;top:1061px;left:167px;white-space:nowrap" class="ft5917">&#160;Pointer&#160;to&#160;the&#160;DAA&#160;structure&#160;</p>
<p style="position:absolute;top:1089px;left:137px;white-space:nowrap" class="ft5943"><b>Returns:</b></p>
<p style="position:absolute;top:1117px;left:137px;white-space:nowrap" class="ft5917">1&#160;in&#160;case&#160;of&#160;success&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5921">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft5921">30/61</p>
</div>
<!-- Page 60 -->
<a name="60"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page60-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3060.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft609">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft600">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft6021">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft6021">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft6017">-1&#160;in&#160;case&#160;of&#160;error&#160;</p>
<p style="position:absolute;top:177px;left:83px;white-space:nowrap" class="ft6041"><b>int DAA_SIG_size (const DAA *&#160;</b></p>
<p style="position:absolute;top:177px;left:380px;white-space:nowrap" class="ft6042"><i><b>daa</b></i></p>
<p style="position:absolute;top:177px;left:410px;white-space:nowrap" class="ft6041"><b>)</b></p>
<p style="position:absolute;top:196px;left:137px;white-space:nowrap" class="ft6019">Returns&#160;the&#160;size&#160;(in&#160;bytes)&#160;of&#160;a&#160;DAA&#160;signature&#160;for&#160;the&#160;supplied&#160;DAA&#160;structure.<br/>Returns&#160;an&#160;upper&#160;bound&#160;to&#160;the&#160;DAA_SIG&#160;size.&#160;Useful&#160;to&#160;allocate&#160;a&#160;buffer&#160;that&#160;will&#160;<br/>contains&#160;a&#160;signature,&#160;without&#160;knowing&#160;in&#160;advantage&#160;what&#160;the&#160;signature&#160;will&#160;be.</p>
<p style="position:absolute;top:272px;left:137px;white-space:nowrap" class="ft6043"><b>Parameters:</b></p>
<p style="position:absolute;top:300px;left:137px;white-space:nowrap" class="ft6039"><i>daa</i></p>
<p style="position:absolute;top:300px;left:167px;white-space:nowrap" class="ft6017">&#160;Pointer&#160;to&#160;the&#160;DAA&#160;structure&#160;</p>
<p style="position:absolute;top:328px;left:137px;white-space:nowrap" class="ft6043"><b>Returns:</b></p>
<p style="position:absolute;top:356px;left:137px;white-space:nowrap" class="ft6017">The&#160;required&#160;size&#160;for&#160;a&#160;buffer&#160;to&#160;store&#160;a&#160;DAA_SIG&#160;structure&#160;</p>
<p style="position:absolute;top:384px;left:83px;white-space:nowrap" class="ft6041"><b>int DAA_sign_verifier_init (unsigned int *&#160;</b></p>
<p style="position:absolute;top:384px;left:509px;white-space:nowrap" class="ft6042"><i><b>nonce_len</b></i></p>
<p style="position:absolute;top:384px;left:598px;white-space:nowrap" class="ft6041"><b>, &#160; unsigned char **&#160;</b></p>
<p style="position:absolute;top:403px;left:83px;white-space:nowrap" class="ft6042"><i><b>nonce</b></i></p>
<p style="position:absolute;top:403px;left:133px;white-space:nowrap" class="ft6041"><b>, &#160; unsigned int *&#160;</b></p>
<p style="position:absolute;top:403px;left:321px;white-space:nowrap" class="ft6042"><i><b>basename_len</b></i></p>
<p style="position:absolute;top:403px;left:440px;white-space:nowrap" class="ft6041"><b>, &#160; unsigned char **&#160;</b></p>
<p style="position:absolute;top:403px;left:648px;white-space:nowrap" class="ft6042"><i><b>basename</b></i></p>
<p style="position:absolute;top:403px;left:727px;white-space:nowrap" class="ft6041"><b>, &#160; DAA&#160;</b></p>
<p style="position:absolute;top:421px;left:83px;white-space:nowrap" class="ft6041"><b>*&#160;</b></p>
<p style="position:absolute;top:421px;left:103px;white-space:nowrap" class="ft6042"><i><b>daa</b></i></p>
<p style="position:absolute;top:421px;left:133px;white-space:nowrap" class="ft6041"><b>)</b></p>
<p style="position:absolute;top:440px;left:137px;white-space:nowrap" class="ft6019">Returns&#160;the&#160;Verifier's&#160;nonce&#160;and&#160;basename&#160;and&#160;sets&#160;them&#160;within&#160;the&#160;supplied&#160;<br/>DAA&#160;structure.</p>
<p style="position:absolute;top:488px;left:137px;white-space:nowrap" class="ft6043"><b>Parameters:</b></p>
<p style="position:absolute;top:515px;left:137px;white-space:nowrap" class="ft6039"><i>nonce_len</i></p>
<p style="position:absolute;top:515px;left:220px;white-space:nowrap" class="ft6017">&#160;Pointer&#160;to&#160;a&#160;int,&#160;where&#160;the&#160;length&#160;of&#160;the&#160;Verifier's&#160;nonce&#160;buffer&#160;is&#160;</p>
<p style="position:absolute;top:535px;left:137px;white-space:nowrap" class="ft6017">returned&#160;</p>
<p style="position:absolute;top:563px;left:137px;white-space:nowrap" class="ft6039"><i>nonce</i></p>
<p style="position:absolute;top:563px;left:187px;white-space:nowrap" class="ft6017">&#160;Pointer&#160;to&#160;a&#160;buffer,&#160;where&#160;the&#160;Verifier's&#160;nonce&#160;is&#160;returned&#160;</p>
<p style="position:absolute;top:591px;left:137px;white-space:nowrap" class="ft6039"><i>basename_len</i></p>
<p style="position:absolute;top:591px;left:256px;white-space:nowrap" class="ft6017">&#160;Pointer&#160;to&#160;a&#160;int,&#160;where&#160;the&#160;length&#160;of&#160;the&#160;Verifier's&#160;basename&#160;</p>
<p style="position:absolute;top:610px;left:137px;white-space:nowrap" class="ft6017">buffer&#160;is&#160;returned&#160;</p>
<p style="position:absolute;top:638px;left:137px;white-space:nowrap" class="ft6039"><i>basename</i></p>
<p style="position:absolute;top:638px;left:223px;white-space:nowrap" class="ft6017">&#160;Pointer&#160;to&#160;a&#160;buffer,&#160;where&#160;the&#160;Verifier's&#160;basename&#160;is&#160;returned&#160;</p>
<p style="position:absolute;top:667px;left:137px;white-space:nowrap" class="ft6039"><i>daa</i></p>
<p style="position:absolute;top:667px;left:167px;white-space:nowrap" class="ft6017">&#160;Pointer&#160;to&#160;the&#160;DAA&#160;structure&#160;containing&#160;a&#160;reference&#160;to&#160;the&#160;DAA&#160;method&#160;</p>
<p style="position:absolute;top:695px;left:137px;white-space:nowrap" class="ft6043"><b>Returns:</b></p>
<p style="position:absolute;top:723px;left:137px;white-space:nowrap" class="ft6025">Pointer&#160;to&#160;the&#160;DAA_SIG&#160;structure&#160;created&#160;<br/>NULL&#160;if&#160;an&#160;error&#160;occurred&#160;</p>
<p style="position:absolute;top:779px;left:83px;white-space:nowrap" class="ft6041"><b>int DAA_sign (int&#160;</b></p>
<p style="position:absolute;top:779px;left:262px;white-space:nowrap" class="ft6042"><i><b>type</b></i></p>
<p style="position:absolute;top:779px;left:301px;white-space:nowrap" class="ft6041"><b>, &#160; const unsigned char *&#160;</b></p>
<p style="position:absolute;top:779px;left:559px;white-space:nowrap" class="ft6042"><i><b>dgst</b></i></p>
<p style="position:absolute;top:779px;left:598px;white-space:nowrap" class="ft6041"><b>, &#160; int&#160;</b></p>
<p style="position:absolute;top:779px;left:677px;white-space:nowrap" class="ft6042"><i><b>dgst_len</b></i></p>
<p style="position:absolute;top:779px;left:757px;white-space:nowrap" class="ft6041"><b>,&#160;</b></p>
<p style="position:absolute;top:798px;left:83px;white-space:nowrap" class="ft6041"><b>unsigned char *&#160;</b></p>
<p style="position:absolute;top:798px;left:242px;white-space:nowrap" class="ft6042"><i><b>sig</b></i></p>
<p style="position:absolute;top:798px;left:272px;white-space:nowrap" class="ft6041"><b>, &#160; unsigned int *&#160;</b></p>
<p style="position:absolute;top:798px;left:460px;white-space:nowrap" class="ft6042"><i><b>sig_len</b></i></p>
<p style="position:absolute;top:798px;left:529px;white-space:nowrap" class="ft6041"><b>, &#160; DAA *&#160;</b></p>
<p style="position:absolute;top:798px;left:628px;white-space:nowrap" class="ft6042"><i><b>daa</b></i></p>
<p style="position:absolute;top:798px;left:658px;white-space:nowrap" class="ft6041"><b>)</b></p>
<p style="position:absolute;top:817px;left:137px;white-space:nowrap" class="ft6019">Computes&#160;the&#160;DAA&#160;signature&#160;(buffer)&#160;of&#160;the&#160;given&#160;hash&#160;value&#160;using&#160;the&#160;DAA&#160;<br/>method&#160;supplied&#160;and&#160;returns&#160;the&#160;created&#160;signature.</p>
<p style="position:absolute;top:865px;left:137px;white-space:nowrap" class="ft6043"><b>Parameters:</b></p>
<p style="position:absolute;top:892px;left:137px;white-space:nowrap" class="ft6039"><i>type</i></p>
<p style="position:absolute;top:892px;left:174px;white-space:nowrap" class="ft6017">&#160;This&#160;parameter&#160;is&#160;ignored&#160;</p>
<p style="position:absolute;top:920px;left:137px;white-space:nowrap" class="ft6039"><i>dgst</i></p>
<p style="position:absolute;top:920px;left:173px;white-space:nowrap" class="ft6017">&#160;Buffer&#160;containing&#160;the&#160;hash&#160;value&#160;</p>
<p style="position:absolute;top:948px;left:137px;white-space:nowrap" class="ft6039"><i>dgst_len</i></p>
<p style="position:absolute;top:948px;left:206px;white-space:nowrap" class="ft6017">&#160;Length&#160;of&#160;the&#160;hash&#160;value&#160;buffer&#160;</p>
<p style="position:absolute;top:976px;left:137px;white-space:nowrap" class="ft6039"><i>sig</i></p>
<p style="position:absolute;top:976px;left:160px;white-space:nowrap" class="ft6017">&#160;Pointer&#160;to&#160;a&#160;buffer,&#160;where&#160;the&#160;DAA&#160;signature&#160;is&#160;returned&#160;</p>
<p style="position:absolute;top:1005px;left:137px;white-space:nowrap" class="ft6039"><i>sig_len</i></p>
<p style="position:absolute;top:1005px;left:194px;white-space:nowrap" class="ft6017">&#160;Pointer&#160;to&#160;a&#160;int,&#160;where&#160;the&#160;length&#160;of&#160;the&#160;DAA&#160;signature&#160;buffer&#160;is&#160;returned&#160;</p>
<p style="position:absolute;top:1033px;left:137px;white-space:nowrap" class="ft6039"><i>daa</i></p>
<p style="position:absolute;top:1033px;left:167px;white-space:nowrap" class="ft6017">&#160;Pointer&#160;to&#160;the&#160;DAA&#160;structure&#160;containing&#160;a&#160;reference&#160;to&#160;the&#160;DAA&#160;method&#160;</p>
<p style="position:absolute;top:1062px;left:137px;white-space:nowrap" class="ft6043"><b>Returns:</b></p>
<p style="position:absolute;top:1089px;left:137px;white-space:nowrap" class="ft6025">1&#160;in&#160;case&#160;of&#160;success&#160;<br/>0&#160;in&#160;case&#160;of&#160;error&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6021">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6021">31/61</p>
</div>
<!-- Page 61 -->
<a name="61"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page61-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3061.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft619">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft610">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft6121">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft6121">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft6141"><b>int DAA_verify (int&#160;</b></p>
<p style="position:absolute;top:149px;left:281px;white-space:nowrap" class="ft6142"><i><b>type</b></i></p>
<p style="position:absolute;top:149px;left:321px;white-space:nowrap" class="ft6141"><b>, &#160; const unsigned char *&#160;</b></p>
<p style="position:absolute;top:149px;left:578px;white-space:nowrap" class="ft6142"><i><b>dgst</b></i></p>
<p style="position:absolute;top:149px;left:618px;white-space:nowrap" class="ft6141"><b>, &#160; int&#160;</b></p>
<p style="position:absolute;top:149px;left:697px;white-space:nowrap" class="ft6142"><i><b>dgst_len</b></i></p>
<p style="position:absolute;top:149px;left:776px;white-space:nowrap" class="ft6141"><b>,&#160;</b></p>
<p style="position:absolute;top:168px;left:83px;white-space:nowrap" class="ft6141"><b>const unsigned char *&#160;</b></p>
<p style="position:absolute;top:168px;left:301px;white-space:nowrap" class="ft6142"><i><b>sigbuf</b></i></p>
<p style="position:absolute;top:168px;left:361px;white-space:nowrap" class="ft6141"><b>, &#160; int&#160;</b></p>
<p style="position:absolute;top:168px;left:440px;white-space:nowrap" class="ft6142"><i><b>sigbuf_len</b></i></p>
<p style="position:absolute;top:168px;left:539px;white-space:nowrap" class="ft6141"><b>, &#160; DAA *&#160;</b></p>
<p style="position:absolute;top:168px;left:638px;white-space:nowrap" class="ft6142"><i><b>daa</b></i></p>
<p style="position:absolute;top:168px;left:668px;white-space:nowrap" class="ft6141"><b>)</b></p>
<p style="position:absolute;top:187px;left:137px;white-space:nowrap" class="ft6119">Verifies&#160;that&#160;the&#160;supplied&#160;signature&#160;(buffer)&#160;is&#160;a&#160;valid&#160;DAA&#160;signature&#160;of&#160;the&#160;<br/>supplied&#160;hash&#160;value&#160;using&#160;the&#160;supplied&#160;DAA&#160;method.</p>
<p style="position:absolute;top:235px;left:137px;white-space:nowrap" class="ft6143"><b>Parameters:</b></p>
<p style="position:absolute;top:262px;left:137px;white-space:nowrap" class="ft6139"><i>type</i></p>
<p style="position:absolute;top:262px;left:174px;white-space:nowrap" class="ft6117">&#160;This&#160;parameter&#160;is&#160;ignored&#160;</p>
<p style="position:absolute;top:290px;left:137px;white-space:nowrap" class="ft6139"><i>dgst</i></p>
<p style="position:absolute;top:290px;left:173px;white-space:nowrap" class="ft6117">&#160;Buffer&#160;containing&#160;the&#160;hash&#160;value&#160;</p>
<p style="position:absolute;top:318px;left:137px;white-space:nowrap" class="ft6139"><i>dgst_len</i></p>
<p style="position:absolute;top:318px;left:206px;white-space:nowrap" class="ft6117">&#160;Length&#160;of&#160;the&#160;hash&#160;value&#160;buffer&#160;</p>
<p style="position:absolute;top:346px;left:137px;white-space:nowrap" class="ft6139"><i>sigbuf</i></p>
<p style="position:absolute;top:346px;left:187px;white-space:nowrap" class="ft6117">&#160;Buffer&#160;containing&#160;a&#160;serialized&#160;DAA&#160;signature&#160;</p>
<p style="position:absolute;top:375px;left:137px;white-space:nowrap" class="ft6139"><i>sigbuf_len</i></p>
<p style="position:absolute;top:375px;left:221px;white-space:nowrap" class="ft6117">&#160;Length&#160;of&#160;the&#160;DAA&#160;signature&#160;buffer&#160;</p>
<p style="position:absolute;top:403px;left:137px;white-space:nowrap" class="ft6139"><i>daa</i></p>
<p style="position:absolute;top:403px;left:167px;white-space:nowrap" class="ft6117">&#160;Pointer&#160;to&#160;the&#160;DAA&#160;structure&#160;containing&#160;a&#160;reference&#160;to&#160;the&#160;DAA&#160;method&#160;</p>
<p style="position:absolute;top:432px;left:137px;white-space:nowrap" class="ft6143"><b>Returns:</b></p>
<p style="position:absolute;top:459px;left:137px;white-space:nowrap" class="ft6125">1&#160;if&#160;the&#160;signature&#160;is&#160;correct&#160;<br/>0&#160;if&#160;the&#160;signature&#160;is&#160;incorrect&#160;<br/>-1&#160;in&#160;case&#160;of&#160;error</p>
<p style="position:absolute;top:562px;left:83px;white-space:nowrap" class="ft6134"><i><b>4.3&#160;&#160;&#160;Examples</b></i></p>
<p style="position:absolute;top:593px;left:83px;white-space:nowrap" class="ft6119">Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#63">&#160;5.1.3&#160;</a>provides&#160;details&#160;about&#160;the&#160;use&#160;of&#160;the&#160;DAA&#160;protocol&#160;in&#160;a&#160;TLS&#160;Extension.&#160;<br/>Such&#160;details&#160;can&#160;be&#160;used&#160;as&#160;an&#160;example&#160;showing&#160;the&#160;usage&#160;of&#160;the&#160;DAA&#160;protocol&#160;in&#160;<br/>OpenSSL.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6121">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6121">32/61</p>
</div>
<!-- Page 62 -->
<a name="62"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page62-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3062.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft629">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft620">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft6221">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft6221">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft6224"><b>5&#160;&#160;&#160;TLS&#160;DAA-Enhancement</b></p>
<p style="position:absolute;top:218px;left:83px;white-space:nowrap" class="ft6234"><i><b>5.1&#160;&#160;&#160;Architecture</b></i></p>
<p style="position:absolute;top:250px;left:83px;white-space:nowrap" class="ft6225">The&#160;TLS&#160;DAA-Enhancement&#160;(DAA-TLS)&#160;is&#160;a&#160;TLS&#160;Enhancement&#160;that&#160;implements&#160;the&#160;<br/>(client)&#160;anonymous&#160;authentication&#160;according&#160;to&#160;[1],&#160;and&#160;using&#160;the&#160;TLSEXT&#160;general&#160;<br/>framework&#160;(Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#37">&#160;3)</a>&#160;and&#160;the&#160;DAA&#160;primitives&#160;(Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#53">&#160;4)</a>.<br/>The&#160;TLSEXT&#160;general&#160;framework&#160;is&#160;used&#160;to&#160;transport&#160;a&#160;DAA-TLS&#160;Extension&#160;which&#160;carries&#160;<br/>the&#160;required&#160;messages&#160;between&#160;client&#160;and&#160;server.&#160;The&#160;DAA&#160;cryptographic&#160;primitives&#160;<br/>are&#160;used&#160;as&#160;group&#160;signature&#160;for&#160;authenticating&#160;the&#160;user&#160;anonymously.<br/>DAA-TLS&#160;is&#160;designed&#160;to&#160;rely&#160;on&#160;the&#160;underlying&#160;DAA&#160;implementation&#160;and&#160;hence&#160;to&#160;<br/>support&#160;all&#160;the&#160;DAA&#160;versions&#160;provided:&#160;RSA-based&#160;or&#160;Pairing-based&#160;DAA,&#160;with&#160;or&#160;<br/>without&#160;an&#160;actual&#160;(hardware)&#160;TPM.<br/>This&#160;code&#160;is&#160;designed&#160;to&#160;be&#160;part&#160;of&#160;the&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:450px;left:486px;white-space:nowrap" class="ft6233"><b>libssl</b></p>
<p style="position:absolute;top:450px;left:546px;white-space:nowrap" class="ft6217">&#160;library&#160;and&#160;it&#160;is&#160;compiled&#160;in&#160;it.</p>
<p style="position:absolute;top:496px;left:83px;white-space:nowrap" class="ft6236"><i><b>5.1.1&#160;&#160;&#160;Overview</b></i></p>
<p style="position:absolute;top:526px;left:83px;white-space:nowrap" class="ft6217">The&#160;code&#160;is&#160;organized&#160;in&#160;two&#160;main&#160;modules&#160;as&#160;shown&#160;in<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#62">&#160;Figure&#160;9.</a></p>
<p style="position:absolute;top:1059px;left:83px;white-space:nowrap" class="ft6217">In&#160;more&#160;details:</p>
<p style="position:absolute;top:1092px;left:110px;white-space:nowrap" class="ft6212">●</p>
<p style="position:absolute;top:1087px;left:137px;white-space:nowrap" class="ft6216"><b>Core</b></p>
<p style="position:absolute;top:1087px;left:180px;white-space:nowrap" class="ft6217">&#160;contains&#160;the&#160;core&#160;functions&#160;required&#160;by&#160;DAA-TLS.&#160;In&#160;particular&#160;among&#160;the&#160;</p>
<p style="position:absolute;top:1107px;left:137px;white-space:nowrap" class="ft6217">core&#160;functions&#160;there&#160;are&#160;the&#160;initialization&#160;function&#160;needed&#160;to&#160;activate&#160;the&#160;hello&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6221">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6221">33/61</p>
<p style="position:absolute;top:1002px;left:312px;white-space:nowrap" class="ft6217">Figure&#160;9:&#160;TLS&#160;DAA-Enhancement&#160;</p>
<p style="position:absolute;top:1021px;left:354px;white-space:nowrap" class="ft6217">Architecture&#160;Overview</p>
</div>
<!-- Page 63 -->
<a name="63"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft6346{font-size:15px;font-family:KAAAAA+CourierNewPS;color:#000000;}
	.ft6347{font-size:17px;font-family:GAAAAA+BitstreamVeraSans;color:#000000;}
	.ft6348{font-size:15px;line-height:17px;font-family:KAAAAA+CourierNewPS;color:#000000;}
-->
</style>
<div id="page63-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3063.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft639">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft630">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft6321">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft6321">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft6319">extension,&#160;the&#160;callback&#160;functions&#160;for&#160;creating&#160;and&#160;managing&#160;the&#160;exchanged&#160;data&#160;<br/>and&#160;the&#160;final&#160;callback&#160;function&#160;to&#160;verify&#160;the&#160;DAA&#160;signature.</p>
<p style="position:absolute;top:201px;left:110px;white-space:nowrap" class="ft6312">●</p>
<p style="position:absolute;top:197px;left:137px;white-space:nowrap" class="ft6316"><b>Application&#160;Interface</b></p>
<p style="position:absolute;top:197px;left:333px;white-space:nowrap" class="ft6317">&#160;is&#160;a&#160;module&#160;that&#160;allows&#160;the&#160;application&#160;to&#160;manage&#160;the&#160;</p>
<p style="position:absolute;top:216px;left:137px;white-space:nowrap" class="ft6317">behavior&#160;of&#160;the&#160;DAA-TLS&#160;Extension.&#160;Further&#160;details&#160;are&#160;given&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#67">&#160;5.2.</a></p>
<p style="position:absolute;top:262px;left:83px;white-space:nowrap" class="ft6336"><i><b>5.1.2&#160;&#160;&#160;Data&#160;Structures</b></i></p>
<p style="position:absolute;top:292px;left:83px;white-space:nowrap" class="ft6319">The&#160;TLS&#160;DAA-Enhancement&#160;saves&#160;the&#160;data&#160;needed&#160;during&#160;the&#160;TLS&#160;handshake&#160;in&#160;a&#160;data&#160;<br/>structure&#160;called&#160;</p>
<p style="position:absolute;top:311px;left:218px;white-space:nowrap" class="ft6333"><b>ssl_tlsext_daa_ctx_st</b></p>
<p style="position:absolute;top:311px;left:427px;white-space:nowrap" class="ft6317">.&#160;This&#160;structure&#160;contains&#160;the&#160;following&#160;data:</p>
<p style="position:absolute;top:348px;left:105px;white-space:nowrap" class="ft6346"><b>struct ssl_tlsext_daa_ctx_st {</b></p>
<p style="position:absolute;top:365px;left:158px;white-space:nowrap" class="ft6346"><b>DAA *daa;</b></p>
<p style="position:absolute;top:382px;left:158px;white-space:nowrap" class="ft6348"><b>unsigned int key_len;<br/>unsigned char *key_buf;</b></p>
<p style="position:absolute;top:416px;left:158px;white-space:nowrap" class="ft6348"><b>unsigned int issuer_key_len;<br/>unsigned char *issuer_key_buf;</b></p>
<p style="position:absolute;top:450px;left:105px;white-space:nowrap" class="ft6346"><b>};</b></p>
<p style="position:absolute;top:485px;left:83px;white-space:nowrap" class="ft6317">In&#160;more&#160;details:</p>
<p style="position:absolute;top:518px;left:110px;white-space:nowrap" class="ft6312">●</p>
<p style="position:absolute;top:513px;left:137px;white-space:nowrap" class="ft6316"><b>daa</b></p>
<p style="position:absolute;top:513px;left:172px;white-space:nowrap" class="ft6317">&#160;is&#160;a&#160;pointer&#160;to&#160;the&#160;</p>
<p style="position:absolute;top:513px;left:329px;white-space:nowrap" class="ft6333"><b>DAA</b></p>
<p style="position:absolute;top:513px;left:359px;white-space:nowrap" class="ft6317">&#160;structure&#160;described&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#54">&#160;4.1.2.</a></p>
<p style="position:absolute;top:546px;left:110px;white-space:nowrap" class="ft6312">●</p>
<p style="position:absolute;top:541px;left:137px;white-space:nowrap" class="ft6316"><b>key_buf</b></p>
<p style="position:absolute;top:541px;left:209px;white-space:nowrap" class="ft6317">&#160;is&#160;a&#160;buffer&#160;of&#160;</p>
<p style="position:absolute;top:541px;left:324px;white-space:nowrap" class="ft6316"><b>key_buf_len</b></p>
<p style="position:absolute;top:541px;left:433px;white-space:nowrap" class="ft6317">&#160;bytes&#160;that&#160;contains&#160;the&#160;DAA&#160;key.</p>
<p style="position:absolute;top:574px;left:110px;white-space:nowrap" class="ft6312">●</p>
<p style="position:absolute;top:570px;left:137px;white-space:nowrap" class="ft6316"><b>issuer_key_buf</b></p>
<p style="position:absolute;top:570px;left:274px;white-space:nowrap" class="ft6317">&#160;is&#160;a&#160;buffer&#160;of&#160;</p>
<p style="position:absolute;top:570px;left:389px;white-space:nowrap" class="ft6316"><b>issuer_key_buf_len</b></p>
<p style="position:absolute;top:570px;left:562px;white-space:nowrap" class="ft6317">&#160;bytes&#160;that&#160;contains&#160;the&#160;DAA&#160;</p>
<p style="position:absolute;top:589px;left:137px;white-space:nowrap" class="ft6317">Issuer&#160;public&#160;key.</p>
<p style="position:absolute;top:617px;left:83px;white-space:nowrap" class="ft6319">This&#160;structure&#160;is&#160;created&#160;during&#160;the&#160;initialization&#160;of&#160;the&#160;DAA-TLS&#160;Extension&#160;and&#160;is&#160;<br/>managed&#160;by&#160;specific&#160;functions&#160;(refer&#160;to&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#63">&#160;5.1.3&#160;</a>for&#160;more&#160;details).<br/>Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#68">&#160;5.3&#160;</a>presents&#160;an&#160;example&#160;of&#160;how&#160;to&#160;use&#160;this&#160;data&#160;structure&#160;to&#160;implement&#160;an&#160;<br/>Application&#160;that&#160;supports&#160;DAA-TLS.</p>
<p style="position:absolute;top:730px;left:83px;white-space:nowrap" class="ft6336"><i><b>5.1.3&#160;&#160;&#160;Implementation&#160;Details</b></i></p>
<p style="position:absolute;top:778px;left:83px;white-space:nowrap" class="ft6347"><i><b>5.1.3.1&#160;&#160;&#160;Core</b></i></p>
<p style="position:absolute;top:801px;left:83px;white-space:nowrap" class="ft6319">This&#160;section&#160;shows&#160;how&#160;the&#160;TLS&#160;Extensions&#160;is&#160;structured&#160;and&#160;gives&#160;details&#160;about&#160;the&#160;<br/>internals.</p>
<p style="position:absolute;top:849px;left:83px;white-space:nowrap" class="ft6341"><b>TLSEXT_GENERAL* SSL_TLSEXT_DAA_new ()</b></p>
<p style="position:absolute;top:867px;left:137px;white-space:nowrap" class="ft6325">Creates&#160;a&#160;new&#160;DAA&#160;extension.<br/>It&#160;is&#160;called&#160;by&#160;the&#160;ssl_tlsext_general_create_list()&#160;which&#160;is&#160;executed&#160;during&#160;the&#160;<br/>creation&#160;of&#160;the&#160;SSL_CTX&#160;object.<br/>It&#160;sets&#160;</p>
<p style="position:absolute;top:943px;left:192px;white-space:nowrap" class="ft6333"><b>ssl_tlsext_daa_init()</b></p>
<p style="position:absolute;top:943px;left:401px;white-space:nowrap" class="ft6317">&#160;as&#160;init&#160;callback&#160;function.&#160;</p>
<p style="position:absolute;top:971px;left:83px;white-space:nowrap" class="ft6341"><b>void ssl_tlsext_daa_client_supp_data_cb (SSL *&#160;</b></p>
<p style="position:absolute;top:971px;left:549px;white-space:nowrap" class="ft6342"><i><b>s</b></i></p>
<p style="position:absolute;top:971px;left:559px;white-space:nowrap" class="ft6341"><b>, &#160; TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:971px;left:767px;white-space:nowrap" class="ft6342"><i><b>e</b></i></p>
<p style="position:absolute;top:971px;left:776px;white-space:nowrap" class="ft6341"><b>)</b></p>
<p style="position:absolute;top:990px;left:137px;white-space:nowrap" class="ft6325">Callback&#160;function&#160;for&#160;creating&#160;the&#160;supplemental&#160;data&#160;entry&#160;on&#160;the&#160;client.<br/>It&#160;parses&#160;the&#160;data&#160;received&#160;from&#160;the&#160;server&#160;through&#160;the&#160;TLS&#160;Hello&#160;Extension&#160;that&#160;<br/>contains&#160;the&#160;nonce&#160;and&#160;the&#160;basename.<br/>Furthermore&#160;it&#160;retrieves&#160;the&#160;digest&#160;of&#160;the&#160;X509&#160;certificate&#160;used&#160;for&#160;the&#160;client&#160;<br/>authentication.<br/>It&#160;uses&#160;the&#160;nonce,&#160;the&#160;basename&#160;and&#160;the&#160;digest&#160;of&#160;the&#160;X509&#160;certificate&#160;for&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6321">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6321">34/61</p>
</div>
<!-- Page 64 -->
<a name="64"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page64-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3064.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft649">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft640">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft6421">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft6421">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft6417">making&#160;the&#160;DAA&#160;signature.</p>
<p style="position:absolute;top:178px;left:137px;white-space:nowrap" class="ft6443"><b>Parameters:</b></p>
<p style="position:absolute;top:205px;left:137px;white-space:nowrap" class="ft6439"><i>s</i></p>
<p style="position:absolute;top:205px;left:145px;white-space:nowrap" class="ft6417">&#160;a&#160;pointer&#160;to&#160;the&#160;SSL&#160;object&#160;</p>
<p style="position:absolute;top:234px;left:137px;white-space:nowrap" class="ft6439"><i>e</i></p>
<p style="position:absolute;top:234px;left:147px;white-space:nowrap" class="ft6417">&#160;a&#160;pointer&#160;to&#160;the&#160;DAA&#160;extension&#160;</p>
<p style="position:absolute;top:262px;left:83px;white-space:nowrap" class="ft6441"><b>int ssl_tlsext_daa_server_ext_cb (SSL *&#160;</b></p>
<p style="position:absolute;top:262px;left:479px;white-space:nowrap" class="ft6442"><i><b>s</b></i></p>
<p style="position:absolute;top:262px;left:489px;white-space:nowrap" class="ft6441"><b>, &#160; TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:262px;left:697px;white-space:nowrap" class="ft6442"><i><b>e</b></i></p>
<p style="position:absolute;top:262px;left:707px;white-space:nowrap" class="ft6441"><b>)</b></p>
<p style="position:absolute;top:280px;left:137px;white-space:nowrap" class="ft6419">Callback&#160;function&#160;for&#160;receiving&#160;the&#160;TLS&#160;Hello&#160;Extension&#160;on&#160;the&#160;server.<br/>It&#160;decides&#160;if&#160;the&#160;server&#160;must&#160;accept&#160;the&#160;DAA&#160;authentication&#160;or&#160;not.&#160;If&#160;the&#160;server&#160;<br/>accepts&#160;it,&#160;then&#160;it&#160;creates&#160;a&#160;TLS&#160;Hello&#160;extension&#160;to&#160;send&#160;within&#160;the&#160;server&#160;hello&#160;in&#160;<br/>response&#160;to&#160;the&#160;client&#160;request.&#160;If&#160;the&#160;DAA&#160;signature&#160;is&#160;refused,&#160;the&#160;server&#160;<br/>creates&#160;an&#160;extension&#160;that&#160;contains&#160;an&#160;error&#160;code&#160;and&#160;send&#160;it&#160;back.<br/>Furthermore&#160;it&#160;sets&#160;the&#160;callbacks&#160;needed&#160;to&#160;handle&#160;the&#160;supplemental&#160;data&#160;<br/>message&#160;that&#160;will&#160;carry&#160;the&#160;DAA&#160;signature</p>
<p style="position:absolute;top:442px;left:137px;white-space:nowrap" class="ft6443"><b>Parameters:</b></p>
<p style="position:absolute;top:470px;left:137px;white-space:nowrap" class="ft6439"><i>s</i></p>
<p style="position:absolute;top:470px;left:145px;white-space:nowrap" class="ft6417">&#160;a&#160;pointer&#160;to&#160;the&#160;SSL&#160;object&#160;</p>
<p style="position:absolute;top:498px;left:137px;white-space:nowrap" class="ft6439"><i>e</i></p>
<p style="position:absolute;top:498px;left:147px;white-space:nowrap" class="ft6417">&#160;a&#160;pointer&#160;to&#160;the&#160;DAA&#160;extension&#160;</p>
<p style="position:absolute;top:526px;left:83px;white-space:nowrap" class="ft6441"><b>int ssl_tlsext_daa_server_finish_cb (SSL *&#160;</b></p>
<p style="position:absolute;top:526px;left:509px;white-space:nowrap" class="ft6442"><i><b>s</b></i></p>
<p style="position:absolute;top:526px;left:519px;white-space:nowrap" class="ft6441"><b>, &#160; TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:526px;left:727px;white-space:nowrap" class="ft6442"><i><b>e</b></i></p>
<p style="position:absolute;top:526px;left:737px;white-space:nowrap" class="ft6441"><b>)</b></p>
<p style="position:absolute;top:545px;left:137px;white-space:nowrap" class="ft6419">Callback&#160;function&#160;for&#160;managing&#160;the&#160;supplemental&#160;data&#160;message&#160;on&#160;the&#160;server.<br/>This&#160;is&#160;executed&#160;at&#160;the&#160;end&#160;of&#160;the&#160;handshake.<br/>If&#160;the&#160;DAA&#160;signature&#160;verification&#160;fails,&#160;then&#160;the&#160;USER_CANCELLED&#160;error&#160;is&#160;<br/>returned.</p>
<p style="position:absolute;top:649px;left:137px;white-space:nowrap" class="ft6443"><b>Parameters:</b></p>
<p style="position:absolute;top:677px;left:137px;white-space:nowrap" class="ft6439"><i>s</i></p>
<p style="position:absolute;top:677px;left:145px;white-space:nowrap" class="ft6417">&#160;a&#160;pointer&#160;to&#160;the&#160;SSL&#160;object&#160;</p>
<p style="position:absolute;top:705px;left:137px;white-space:nowrap" class="ft6439"><i>e</i></p>
<p style="position:absolute;top:705px;left:147px;white-space:nowrap" class="ft6417">&#160;a&#160;pointer&#160;to&#160;the&#160;DAA&#160;extension</p>
<p style="position:absolute;top:751px;left:83px;white-space:nowrap" class="ft6436"><i><b>5.1.4&#160;&#160;&#160;Workflow</b></i></p>
<p style="position:absolute;top:781px;left:83px;white-space:nowrap" class="ft6419"><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#65">Figure&#160;10&#160;</a>gives&#160;an&#160;overview&#160;of&#160;the&#160;TLS&#160;DAA-Enhancement&#160;workflow.&#160;More&#160;details&#160;are&#160;<br/>given&#160;in&#160;the&#160;following.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6421">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6421">35/61</p>
</div>
<!-- Page 65 -->
<a name="65"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page65-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3065.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft659">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft650">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft6521">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft6521">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:608px;left:110px;white-space:nowrap" class="ft6517">1.&#160;The&#160;DAA-TLS&#160;Extension&#160;is&#160;created&#160;and&#160;initialized&#160;on&#160;both&#160;sides&#160;through&#160;</p>
<p style="position:absolute;top:627px;left:137px;white-space:nowrap" class="ft6533"><b>ssl_tlsext_daa_init()</b></p>
<p style="position:absolute;top:627px;left:346px;white-space:nowrap" class="ft6517">&#160;(see&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#72">&#160;6.1.2&#160;</a>for&#160;more&#160;details).&#160;During&#160;this&#160;</p>
<p style="position:absolute;top:646px;left:137px;white-space:nowrap" class="ft6519">operation,&#160;the&#160;client&#160;loads&#160;the&#160;DAA&#160;Platform&#160;credentials,&#160;while&#160;the&#160;server&#160;loads&#160;<br/>the&#160;Issuer&#160;credentials.&#160;These&#160;data&#160;will&#160;be&#160;used&#160;later&#160;on&#160;to&#160;make&#160;the&#160;DAA&#160;<br/>signature&#160;and&#160;to&#160;verify&#160;it.</p>
<p style="position:absolute;top:713px;left:110px;white-space:nowrap" class="ft6517">2.&#160;The&#160;client&#160;begins&#160;the&#160;TLS&#160;handshake&#160;by&#160;sending&#160;a&#160;ClientHello&#160;with&#160;the&#160;DAA-TLS&#160;</p>
<p style="position:absolute;top:732px;left:137px;white-space:nowrap" class="ft6519">Extension&#160;indicating&#160;that&#160;it&#160;wants&#160;to&#160;use&#160;the&#160;anonymous&#160;authentication.&#160;Within&#160;<br/>the&#160;extension&#160;payload,&#160;the&#160;client&#160;sends&#160;the&#160;supported&#160;version.</p>
<p style="position:absolute;top:780px;left:110px;white-space:nowrap" class="ft6517">3.&#160;If&#160;the&#160;server&#160;supports&#160;the&#160;DAA-TLS&#160;anonymous&#160;authentication,&#160;the&#160;</p>
<p style="position:absolute;top:799px;left:137px;white-space:nowrap" class="ft6533"><b>ssl_tlsext_daa_server_cb()</b></p>
<p style="position:absolute;top:799px;left:396px;white-space:nowrap" class="ft6517">&#160;callback&#160;is&#160;called.&#160;This&#160;callback&#160;decides&#160;if&#160;the&#160;</p>
<p style="position:absolute;top:818px;left:137px;white-space:nowrap" class="ft6519">server&#160;accepts&#160;to&#160;use&#160;the&#160;DAA&#160;anonymous&#160;authentication.<br/>If&#160;the&#160;server&#160;accepts&#160;the&#160;use&#160;of&#160;DAA-TLS,&#160;it&#160;calls&#160;the&#160;</p>
<p style="position:absolute;top:856px;left:137px;white-space:nowrap" class="ft6533"><b>DAA_sign_verifier_init()</b></p>
<p style="position:absolute;top:856px;left:376px;white-space:nowrap" class="ft6517">&#160;function.&#160;The&#160;</p>
<p style="position:absolute;top:856px;left:495px;white-space:nowrap" class="ft6533"><b>DAA_sign_verifier_init()</b></p>
<p style="position:absolute;top:856px;left:734px;white-space:nowrap" class="ft6517">&#160;is&#160;part&#160;</p>
<p style="position:absolute;top:876px;left:137px;white-space:nowrap" class="ft6519">of&#160;the&#160;DAA&#160;Application&#160;Interface&#160;(refer&#160;to&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#56">&#160;4.1.3&#160;</a>for&#160;details).&#160;Furthermore,&#160;<br/>since&#160;DAA-TLS&#160;requires&#160;a&#160;client&#160;authentication&#160;with&#160;a&#160;self-signed&#160;certificate&#160;<br/>(refer&#160;to&#160;[1]),&#160;the&#160;callback&#160;function&#160;disables&#160;the&#160;verification&#160;of&#160;the&#160;client&#160;<br/>certificate&#160;in&#160;OpenSSL&#160;by&#160;modifying&#160;the&#160;</p>
<p style="position:absolute;top:933px;left:471px;white-space:nowrap" class="ft6533"><b>verify_mode</b></p>
<p style="position:absolute;top:933px;left:581px;white-space:nowrap" class="ft6517">&#160;field&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:933px;left:680px;white-space:nowrap" class="ft6533"><b>SSL</b></p>
<p style="position:absolute;top:933px;left:710px;white-space:nowrap" class="ft6517">&#160;object.</p>
<p style="position:absolute;top:961px;left:110px;white-space:nowrap" class="ft6517">4.&#160;The&#160;server&#160;always&#160;replies&#160;with&#160;the&#160;ServerHello&#160;with&#160;the&#160;DAA-TLS&#160;Extension,&#160;both&#160;</p>
<p style="position:absolute;top:981px;left:137px;white-space:nowrap" class="ft6519">in&#160;case&#160;of&#160;acceptance&#160;or&#160;rejection.<br/>If&#160;the&#160;server&#160;accepts,&#160;the&#160;extension&#160;contains&#160;the&#160;Verifier's&#160;nonce&#160;and&#160;basename&#160;<br/>that&#160;must&#160;be&#160;used&#160;in&#160;the&#160;signature&#160;computation.<br/>According&#160;to&#160;[1],&#160;if&#160;the&#160;server&#160;does&#160;not&#160;accept&#160;the&#160;use&#160;of&#160;DAA-TLS,&#160;the&#160;extension&#160;<br/>contains&#160;an&#160;error&#160;code.</p>
<p style="position:absolute;top:1086px;left:110px;white-space:nowrap" class="ft6517">5.&#160;The&#160;TLS&#160;handshake&#160;continues&#160;as&#160;usually&#160;until&#160;the&#160;client&#160;needs&#160;to&#160;send&#160;the&#160;</p>
<p style="position:absolute;top:1105px;left:137px;white-space:nowrap" class="ft6517">SupplementalData&#160;message&#160;that&#160;carries&#160;the&#160;DAA&#160;signature&#160;(recall&#160;that,&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6521">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6521">36/61</p>
<p style="position:absolute;top:570px;left:266px;white-space:nowrap" class="ft6517">Figure&#160;10:&#160;TLS&#160;DAA-Enhancement&#160;Workflow</p>
</div>
<!-- Page 66 -->
<a name="66"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page66-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3066.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft669">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft660">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft6621">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft6621">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft6617">according&#160;to&#160;[1],&#160;only&#160;Client&#160;Supplemental&#160;Data&#160;are&#160;required).</p>
<p style="position:absolute;top:177px;left:110px;white-space:nowrap" class="ft6617">6.&#160;In&#160;order&#160;to&#160;prepare&#160;the&#160;data&#160;to&#160;be&#160;sent&#160;in&#160;the&#160;SupplementalData&#160;message,&#160;the&#160;</p>
<p style="position:absolute;top:197px;left:137px;white-space:nowrap" class="ft6617">client&#160;executes&#160;the&#160;</p>
<p style="position:absolute;top:197px;left:300px;white-space:nowrap" class="ft6633"><b>ssl_tlsext_daa_client_supp_data_cb()</b></p>
<p style="position:absolute;top:197px;left:658px;white-space:nowrap" class="ft6617">.&#160;This&#160;callback&#160;</p>
<p style="position:absolute;top:216px;left:137px;white-space:nowrap" class="ft6617">function&#160;calls&#160;the&#160;</p>
<p style="position:absolute;top:216px;left:285px;white-space:nowrap" class="ft6633"><b>DAA_sign()</b></p>
<p style="position:absolute;top:216px;left:384px;white-space:nowrap" class="ft6617">&#160;in&#160;order&#160;to&#160;compute&#160;the&#160;DAA&#160;signature.&#160;The&#160;</p>
<p style="position:absolute;top:235px;left:137px;white-space:nowrap" class="ft6633"><b>DAA_sign()</b></p>
<p style="position:absolute;top:235px;left:237px;white-space:nowrap" class="ft6617">&#160;is&#160;part&#160;of&#160;the&#160;DAA&#160;Application&#160;Interface&#160;(refer&#160;to&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#56">&#160;4.1.3&#160;</a>for&#160;</p>
<p style="position:absolute;top:254px;left:137px;white-space:nowrap" class="ft6619">details).&#160;According&#160;to&#160;[1],&#160;the&#160;data&#160;signed&#160;corresponds&#160;to&#160;the&#160;digest&#160;of&#160;the&#160;X509&#160;<br/>certificate&#160;used&#160;for&#160;the&#160;TLS&#160;client&#160;authentication.&#160;The&#160;callback&#160;function&#160;retrieves&#160;<br/>the&#160;certificate&#160;from&#160;the&#160;</p>
<p style="position:absolute;top:293px;left:335px;white-space:nowrap" class="ft6633"><b>SSL</b></p>
<p style="position:absolute;top:293px;left:365px;white-space:nowrap" class="ft6617">&#160;object&#160;and&#160;uses&#160;the&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:293px;left:617px;white-space:nowrap" class="ft6633"><b>X509_digest()&#160;</b></p>
<p style="position:absolute;top:312px;left:137px;white-space:nowrap" class="ft6617">function&#160;to&#160;compute&#160;the&#160;digest.</p>
<p style="position:absolute;top:340px;left:110px;white-space:nowrap" class="ft6617">7.&#160;The&#160;TLS&#160;handshake&#160;continues&#160;as&#160;usually&#160;until&#160;the&#160;server&#160;and&#160;the&#160;client&#160;exchange&#160;</p>
<p style="position:absolute;top:359px;left:137px;white-space:nowrap" class="ft6617">the&#160;Finish&#160;message.</p>
<p style="position:absolute;top:387px;left:110px;white-space:nowrap" class="ft6617">8.&#160;After&#160;the&#160;Finish&#160;message&#160;is&#160;exchanged,&#160;the&#160;server&#160;can&#160;verify&#160;the&#160;DAA&#160;signature.&#160;</p>
<p style="position:absolute;top:407px;left:137px;white-space:nowrap" class="ft6617">This&#160;is&#160;accomplished&#160;by&#160;the&#160;</p>
<p style="position:absolute;top:407px;left:372px;white-space:nowrap" class="ft6633"><b>ssl_tlsext_daa_server_finish_cb()</b></p>
<p style="position:absolute;top:407px;left:700px;white-space:nowrap" class="ft6617">.&#160;This&#160;</p>
<p style="position:absolute;top:426px;left:137px;white-space:nowrap" class="ft6617">callback&#160;function&#160;verifies&#160;the&#160;signature&#160;using&#160;the&#160;</p>
<p style="position:absolute;top:426px;left:546px;white-space:nowrap" class="ft6633"><b>DAA_sign_verify()</b></p>
<p style="position:absolute;top:426px;left:716px;white-space:nowrap" class="ft6617">&#160;function.&#160;</p>
<p style="position:absolute;top:445px;left:137px;white-space:nowrap" class="ft6617">The&#160;</p>
<p style="position:absolute;top:445px;left:173px;white-space:nowrap" class="ft6633"><b>DAA_sign_verify()</b></p>
<p style="position:absolute;top:445px;left:342px;white-space:nowrap" class="ft6617">&#160;is&#160;part&#160;of&#160;the&#160;DAA&#160;Application&#160;Interface&#160;(refer&#160;to&#160;</p>
<p style="position:absolute;top:464px;left:137px;white-space:nowrap" class="ft6619">Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#56">&#160;4.1.3&#160;</a>for&#160;details).&#160;The&#160;callback&#160;function&#160;retrieves&#160;the&#160;digest&#160;of&#160;the&#160;<br/>certificate&#160;used&#160;for&#160;the&#160;client&#160;authentication&#160;from&#160;the&#160;session&#160;data&#160;contained&#160;in&#160;<br/>the&#160;</p>
<p style="position:absolute;top:503px;left:170px;white-space:nowrap" class="ft6633"><b>SSL</b></p>
<p style="position:absolute;top:503px;left:200px;white-space:nowrap" class="ft6617">&#160;object.</p>
<p style="position:absolute;top:531px;left:110px;white-space:nowrap" class="ft6617">9.&#160;When&#160;the&#160;handshake&#160;is&#160;completed,&#160;the&#160;client&#160;and&#160;the&#160;server&#160;can&#160;exchange&#160;the&#160;</p>
<p style="position:absolute;top:550px;left:137px;white-space:nowrap" class="ft6617">application&#160;data.</p>
<p style="position:absolute;top:596px;left:83px;white-space:nowrap" class="ft6636"><i><b>5.1.5&#160;&#160;&#160;Other&#160;Features</b></i></p>
<p style="position:absolute;top:626px;left:83px;white-space:nowrap" class="ft6617">In&#160;this&#160;section&#160;some&#160;additional&#160;features&#160;of&#160;the&#160;current&#160;implementation&#160;are&#160;described.</p>
<p style="position:absolute;top:672px;left:83px;white-space:nowrap" class="ft6647"><i><b>5.1.5.1&#160;&#160;&#160;Support&#160;to&#160;TLS&#160;Sessions&#160;Resumption</b></i></p>
<p style="position:absolute;top:696px;left:83px;white-space:nowrap" class="ft6619">The&#160;current&#160;implementation&#160;supports&#160;TLS&#160;session&#160;resumption&#160;and&#160;is&#160;compatible&#160;with&#160;<br/>the&#160;OpenSSL&#160;implementation&#160;of&#160;the&#160;SessionTicket&#160;TLS&#160;Extension&#160;for&#160;session&#160;<br/>resumption&#160;without&#160;server-side&#160;state&#160;(RFC&#160;4507).<br/>If&#160;a&#160;client&#160;wants&#160;to&#160;resume&#160;a&#160;previous&#160;TLS&#160;session,&#160;it&#160;makes&#160;explicit&#160;request&#160;during&#160;the&#160;<br/>ClientHello&#160;message.&#160;If&#160;the&#160;server&#160;agrees&#160;the&#160;session&#160;resumption,&#160;then&#160;the&#160;handshake&#160;<br/>jumps&#160;to&#160;the&#160;Finish&#160;messages.&#160;From&#160;the&#160;perspective&#160;of&#160;the&#160;DAA-TLS&#160;Extension,&#160;no&#160;<br/>computation&#160;is&#160;done&#160;at&#160;all.<br/>This&#160;ClientHello&#160;message&#160;MAY&#160;still&#160;contain&#160;a&#160;DAA-TLS&#160;Extension,&#160;whose&#160;purpose&#160;is&#160;to&#160;<br/>dictate&#160;that,&#160;in&#160;case&#160;the&#160;server&#160;will&#160;refuse&#160;session&#160;resumption,&#160;the&#160;client&#160;wish&#160;to&#160;open&#160;a&#160;<br/>new&#160;TLS&#160;session&#160;with&#160;DAA&#160;enhancement.</p>
<p style="position:absolute;top:933px;left:83px;white-space:nowrap" class="ft6647"><i><b>5.1.5.2&#160;&#160;&#160;Legacy&#160;Mode</b></i></p>
<p style="position:absolute;top:957px;left:83px;white-space:nowrap" class="ft6617">The&#160;current&#160;implementation&#160;allows,&#160;at&#160;compile&#160;time,&#160;to&#160;turn&#160;the&#160;DAA&#160;enhanced&#160;</p>
<p style="position:absolute;top:957px;left:744px;white-space:nowrap" class="ft6633"><b>libssl&#160;</b></p>
<p style="position:absolute;top:976px;left:83px;white-space:nowrap" class="ft6619">into&#160;legacy&#160;mode.<br/>Legacy&#160;mode&#160;means&#160;that&#160;the&#160;DAA&#160;extension&#160;can&#160;be&#160;used&#160;even&#160;by&#160;unmodified&#160;<br/>applications,&#160;that&#160;link&#160;the&#160;DAA&#160;enhanced&#160;</p>
<p style="position:absolute;top:1023px;left:426px;white-space:nowrap" class="ft6633"><b>libssl</b></p>
<p style="position:absolute;top:1023px;left:486px;white-space:nowrap" class="ft6617">.&#160;This&#160;is&#160;an&#160;experimental&#160;feature,&#160;</p>
<p style="position:absolute;top:1042px;left:83px;white-space:nowrap" class="ft6625">which&#160;only&#160;works&#160;in&#160;Unix-like&#160;environment&#160;and&#160;has&#160;been&#160;tested&#160;with&#160;Apache+mod_ssl.<br/>The&#160;legacy&#160;mode&#160;works&#160;as&#160;follows:</p>
<p style="position:absolute;top:1103px;left:110px;white-space:nowrap" class="ft6612">●</p>
<p style="position:absolute;top:1099px;left:137px;white-space:nowrap" class="ft6617">On&#160;client&#160;side,&#160;the&#160;DAA-TLS&#160;Extension&#160;is&#160;activated&#160;by&#160;default.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6621">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6621">37/61</p>
</div>
<!-- Page 67 -->
<a name="67"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page67-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3067.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft679">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft670">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft6721">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft6721">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:154px;left:110px;white-space:nowrap" class="ft6712">●</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft6719">On&#160;client&#160;side,&#160;the&#160;DAA&#160;Platform&#160;credentials&#160;are&#160;assumed&#160;to&#160;be&#160;stored&#160;in&#160;a&#160;file&#160;<br/>specified&#160;in&#160;a&#160;system&#160;variable&#160;called&#160;</p>
<p style="position:absolute;top:168px;left:443px;white-space:nowrap" class="ft6733"><b>DAA_LEGACY_CRED</b></p>
<p style="position:absolute;top:168px;left:592px;white-space:nowrap" class="ft6717">.&#160;If&#160;such&#160;variable&#160;is&#160;not&#160;</p>
<p style="position:absolute;top:188px;left:137px;white-space:nowrap" class="ft6717">defined,&#160;the&#160;default&#160;location&#160;</p>
<p style="position:absolute;top:188px;left:377px;white-space:nowrap" class="ft6733"><b>/usr/local/daatoolkit/etc/daa/daa_cred.bin&#160;</b></p>
<p style="position:absolute;top:207px;left:137px;white-space:nowrap" class="ft6717">is&#160;used</p>
<p style="position:absolute;top:207px;left:196px;white-space:nowrap" class="ft6733"><b>.</b></p>
<p style="position:absolute;top:240px;left:110px;white-space:nowrap" class="ft6712">●</p>
<p style="position:absolute;top:235px;left:137px;white-space:nowrap" class="ft6719">On&#160;server&#160;side,&#160;the&#160;DAA&#160;Issuer&#160;credentials&#160;are&#160;assumed&#160;to&#160;be&#160;stored&#160;in&#160;&#160;a&#160;file&#160;<br/>specified&#160;in&#160;a&#160;system&#160;variable&#160;called&#160;</p>
<p style="position:absolute;top:254px;left:443px;white-space:nowrap" class="ft6733"><b>DAA_LEGACY_ISSUER</b></p>
<p style="position:absolute;top:254px;left:612px;white-space:nowrap" class="ft6717">.&#160;If&#160;such&#160;variable&#160;is&#160;not&#160;</p>
<p style="position:absolute;top:273px;left:137px;white-space:nowrap" class="ft6717">defined,&#160;the&#160;default&#160;location&#160;</p>
<p style="position:absolute;top:293px;left:137px;white-space:nowrap" class="ft6733"><b>/usr/local/daatoolkit/etc/daa/daa_issuer.bin</b></p>
<p style="position:absolute;top:293px;left:575px;white-space:nowrap" class="ft6717">&#160;is&#160;used.</p>
<p style="position:absolute;top:321px;left:83px;white-space:nowrap" class="ft6725">The&#160;application&#160;MUST&#160;support&#160;and&#160;load&#160;a&#160;(self-signed)&#160;client&#160;certificate.<br/>In&#160;addition&#160;it&#160;MAY&#160;load&#160;a&#160;DAA&#160;capable&#160;engine.</p>
<p style="position:absolute;top:395px;left:83px;white-space:nowrap" class="ft6734"><i><b>5.2&#160;&#160;&#160;Application&#160;Programming&#160;Interface</b></i></p>
<p style="position:absolute;top:445px;left:83px;white-space:nowrap" class="ft6736"><i><b>5.2.1&#160;&#160;&#160;Application&#160;Interface</b></i></p>
<p style="position:absolute;top:474px;left:83px;white-space:nowrap" class="ft6717">These&#160;functions&#160;are&#160;used&#160;by&#160;the&#160;developers&#160;that&#160;write&#160;applications&#160;that&#160;use&#160;TLS-DAA.</p>
<p style="position:absolute;top:503px;left:83px;white-space:nowrap" class="ft6741"><b>TLSEXT_GENERAL* ssl_tlsext_daa_init (SSL *&#160;</b></p>
<p style="position:absolute;top:503px;left:509px;white-space:nowrap" class="ft6742"><i><b>s</b></i></p>
<p style="position:absolute;top:503px;left:519px;white-space:nowrap" class="ft6741"><b>, &#160; TLSEXT_GENERAL *&#160;</b></p>
<p style="position:absolute;top:503px;left:727px;white-space:nowrap" class="ft6742"><i><b>ext</b></i></p>
<p style="position:absolute;top:503px;left:757px;white-space:nowrap" class="ft6741"><b>)</b></p>
<p style="position:absolute;top:521px;left:137px;white-space:nowrap" class="ft6719">Initializes&#160;a&#160;DAA&#160;extension<br/>The&#160;initialization&#160;calls&#160;the&#160;SSL_TLSEXT_GENERAL_init.&#160;Then&#160;it&#160;verifies&#160;whether&#160;<br/>the&#160;extension&#160;is&#160;created&#160;on&#160;the&#160;client&#160;or&#160;on&#160;the&#160;server&#160;and&#160;sets&#160;the&#160;callback&#160;<br/>functions&#160;accordingly.</p>
<p style="position:absolute;top:617px;left:137px;white-space:nowrap" class="ft6743"><b>Parameters:</b></p>
<p style="position:absolute;top:644px;left:137px;white-space:nowrap" class="ft6739"><i>s</i></p>
<p style="position:absolute;top:644px;left:145px;white-space:nowrap" class="ft6717">&#160;a&#160;pointer&#160;to&#160;the&#160;SSL&#160;object&#160;</p>
<p style="position:absolute;top:672px;left:137px;white-space:nowrap" class="ft6739"><i>ext</i></p>
<p style="position:absolute;top:672px;left:163px;white-space:nowrap" class="ft6717">&#160;a&#160;pointer&#160;to&#160;the&#160;DAA&#160;extension&#160;to&#160;be&#160;initialized&#160;</p>
<p style="position:absolute;top:701px;left:83px;white-space:nowrap" class="ft6741"><b>void SSL_CTX_tlsext_daa_set_enabled (SSL_CTX *&#160;</b></p>
<p style="position:absolute;top:701px;left:549px;white-space:nowrap" class="ft6742"><i><b>ctx</b></i></p>
<p style="position:absolute;top:701px;left:578px;white-space:nowrap" class="ft6741"><b>)</b></p>
<p style="position:absolute;top:719px;left:137px;white-space:nowrap" class="ft6725">Enable&#160;the&#160;DAA&#160;extension.<br/>This&#160;is&#160;a&#160;wrapper&#160;for&#160;the&#160;</p>
<p style="position:absolute;top:747px;left:343px;white-space:nowrap" class="ft6733"><b>SSL_CTX_tlsext_set_enabled()</b></p>
<p style="position:absolute;top:747px;left:621px;white-space:nowrap" class="ft6717">&#160;where&#160;the&#160;type&#160;is&#160;</p>
<p style="position:absolute;top:767px;left:137px;white-space:nowrap" class="ft6717">fixed&#160;to&#160;TLSEXT_TYPE_daa.</p>
<p style="position:absolute;top:795px;left:137px;white-space:nowrap" class="ft6743"><b>Parameters:</b></p>
<p style="position:absolute;top:823px;left:137px;white-space:nowrap" class="ft6739"><i>ctx</i></p>
<p style="position:absolute;top:823px;left:162px;white-space:nowrap" class="ft6717">&#160;a&#160;pointer&#160;to&#160;a&#160;SSL_CTX&#160;object&#160;</p>
<p style="position:absolute;top:851px;left:83px;white-space:nowrap" class="ft6741"><b>void SSL_CTX_tlsext_daa_set_disabled (SSL_CTX *&#160;</b></p>
<p style="position:absolute;top:851px;left:559px;white-space:nowrap" class="ft6742"><i><b>ctx</b></i></p>
<p style="position:absolute;top:851px;left:588px;white-space:nowrap" class="ft6741"><b>)</b></p>
<p style="position:absolute;top:870px;left:137px;white-space:nowrap" class="ft6725">Disable&#160;the&#160;DAA&#160;extension.<br/>This&#160;is&#160;a&#160;wrapper&#160;for&#160;the&#160;</p>
<p style="position:absolute;top:898px;left:343px;white-space:nowrap" class="ft6733"><b>SSL_CTX_tlsext_set_enabled()</b></p>
<p style="position:absolute;top:898px;left:621px;white-space:nowrap" class="ft6717">&#160;where&#160;the&#160;type&#160;is&#160;</p>
<p style="position:absolute;top:917px;left:137px;white-space:nowrap" class="ft6717">fixed&#160;to&#160;TLSEXT_TYPE_daa.</p>
<p style="position:absolute;top:946px;left:137px;white-space:nowrap" class="ft6743"><b>Parameters:</b></p>
<p style="position:absolute;top:973px;left:137px;white-space:nowrap" class="ft6739"><i>ctx</i></p>
<p style="position:absolute;top:973px;left:162px;white-space:nowrap" class="ft6717">&#160;a&#160;pointer&#160;to&#160;a&#160;SSL_CTX&#160;object&#160;</p>
<p style="position:absolute;top:1001px;left:83px;white-space:nowrap" class="ft6741"><b>void SSL_CTX_tlsext_daa_client_set_key (SSL_CTX *&#160;</b></p>
<p style="position:absolute;top:1001px;left:578px;white-space:nowrap" class="ft6742"><i><b>ctx</b></i></p>
<p style="position:absolute;top:1001px;left:608px;white-space:nowrap" class="ft6741"><b>, &#160; unsigned int&#160;</b></p>
<p style="position:absolute;top:1020px;left:83px;white-space:nowrap" class="ft6742"><i><b>len</b></i></p>
<p style="position:absolute;top:1020px;left:113px;white-space:nowrap" class="ft6741"><b>, &#160; unsigned char *&#160;</b></p>
<p style="position:absolute;top:1020px;left:311px;white-space:nowrap" class="ft6742"><i><b>buf</b></i></p>
<p style="position:absolute;top:1020px;left:341px;white-space:nowrap" class="ft6741"><b>)</b></p>
<p style="position:absolute;top:1039px;left:137px;white-space:nowrap" class="ft6719">Sets&#160;on&#160;the&#160;client&#160;the&#160;DAA&#160;credential&#160;for&#160;signing.<br/>This&#160;is&#160;used&#160;by&#160;the&#160;application&#160;to&#160;set&#160;the&#160;DAA&#160;credential&#160;in&#160;the&#160;SSL_CTX&#160;object.&#160;<br/>This&#160;must&#160;happen&#160;before&#160;the&#160;SSL&#160;object&#160;is&#160;created.</p>
<p style="position:absolute;top:1115px;left:137px;white-space:nowrap" class="ft6743"><b>Parameters:</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6721">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6721">38/61</p>
</div>
<!-- Page 68 -->
<a name="68"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page68-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3068.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft689">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft680">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft6821">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft6821">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft6839"><i>ctx</i></p>
<p style="position:absolute;top:149px;left:162px;white-space:nowrap" class="ft6817">&#160;a&#160;pointer&#160;to&#160;a&#160;SSL_CTX&#160;object&#160;</p>
<p style="position:absolute;top:177px;left:137px;white-space:nowrap" class="ft6839"><i>len</i></p>
<p style="position:absolute;top:177px;left:162px;white-space:nowrap" class="ft6817">&#160;size&#160;of&#160;</p>
<p style="position:absolute;top:177px;left:225px;white-space:nowrap" class="ft6833"><b>buf</b></p>
<p style="position:absolute;top:177px;left:255px;white-space:nowrap" class="ft6817">&#160;&#160;</p>
<p style="position:absolute;top:206px;left:137px;white-space:nowrap" class="ft6839"><i>buf</i></p>
<p style="position:absolute;top:206px;left:163px;white-space:nowrap" class="ft6817">&#160;DAA&#160;credential&#160;</p>
<p style="position:absolute;top:234px;left:83px;white-space:nowrap" class="ft6841"><b>void SSL_CTX_tlsext_daa_client_set_issuer_key (SSL_CTX *&#160;</b></p>
<p style="position:absolute;top:234px;left:648px;white-space:nowrap" class="ft6842"><i><b>ctx</b></i></p>
<p style="position:absolute;top:234px;left:677px;white-space:nowrap" class="ft6841"><b>, &#160; unsigned&#160;</b></p>
<p style="position:absolute;top:253px;left:83px;white-space:nowrap" class="ft6841"><b>int&#160;</b></p>
<p style="position:absolute;top:253px;left:123px;white-space:nowrap" class="ft6842"><i><b>len</b></i></p>
<p style="position:absolute;top:253px;left:153px;white-space:nowrap" class="ft6841"><b>, &#160; unsigned char *&#160;</b></p>
<p style="position:absolute;top:253px;left:351px;white-space:nowrap" class="ft6842"><i><b>buf</b></i></p>
<p style="position:absolute;top:253px;left:380px;white-space:nowrap" class="ft6841"><b>)</b></p>
<p style="position:absolute;top:271px;left:137px;white-space:nowrap" class="ft6819">Sets&#160;on&#160;the&#160;client&#160;the&#160;DAA&#160;Issuer&#160;public&#160;key.<br/>This&#160;is&#160;used&#160;by&#160;the&#160;application&#160;to&#160;set&#160;the&#160;DAA&#160;credential&#160;in&#160;the&#160;SSL_CTX&#160;object.&#160;<br/>This&#160;must&#160;happen&#160;before&#160;the&#160;SSL&#160;object&#160;is&#160;created.</p>
<p style="position:absolute;top:347px;left:137px;white-space:nowrap" class="ft6843"><b>Parameters:</b></p>
<p style="position:absolute;top:375px;left:137px;white-space:nowrap" class="ft6839"><i>ctx</i></p>
<p style="position:absolute;top:375px;left:162px;white-space:nowrap" class="ft6817">&#160;a&#160;pointer&#160;to&#160;a&#160;SSL_CTX&#160;object&#160;</p>
<p style="position:absolute;top:403px;left:137px;white-space:nowrap" class="ft6839"><i>len</i></p>
<p style="position:absolute;top:403px;left:162px;white-space:nowrap" class="ft6817">&#160;size&#160;of&#160;</p>
<p style="position:absolute;top:403px;left:225px;white-space:nowrap" class="ft6833"><b>buf</b></p>
<p style="position:absolute;top:403px;left:255px;white-space:nowrap" class="ft6817">&#160;&#160;</p>
<p style="position:absolute;top:431px;left:137px;white-space:nowrap" class="ft6839"><i>buf</i></p>
<p style="position:absolute;top:431px;left:163px;white-space:nowrap" class="ft6817">&#160;DAA&#160;Issuer&#160;public&#160;key&#160;</p>
<p style="position:absolute;top:459px;left:83px;white-space:nowrap" class="ft6841"><b>void SSL_CTX_tlsext_daa_server_set_issuer_key (SSL_CTX *&#160;</b></p>
<p style="position:absolute;top:459px;left:648px;white-space:nowrap" class="ft6842"><i><b>ctx</b></i></p>
<p style="position:absolute;top:459px;left:677px;white-space:nowrap" class="ft6841"><b>, &#160; unsigned&#160;</b></p>
<p style="position:absolute;top:478px;left:83px;white-space:nowrap" class="ft6841"><b>int&#160;</b></p>
<p style="position:absolute;top:478px;left:123px;white-space:nowrap" class="ft6842"><i><b>len</b></i></p>
<p style="position:absolute;top:478px;left:153px;white-space:nowrap" class="ft6841"><b>, &#160; unsigned char *&#160;</b></p>
<p style="position:absolute;top:478px;left:351px;white-space:nowrap" class="ft6842"><i><b>buf</b></i></p>
<p style="position:absolute;top:478px;left:380px;white-space:nowrap" class="ft6841"><b>)</b></p>
<p style="position:absolute;top:497px;left:137px;white-space:nowrap" class="ft6819">Sets&#160;on&#160;the&#160;server&#160;the&#160;DAA&#160;Issuer&#160;public&#160;key.<br/>This&#160;is&#160;used&#160;by&#160;the&#160;application&#160;to&#160;set&#160;the&#160;DAA&#160;credential&#160;in&#160;the&#160;SSL_CTX&#160;object.&#160;<br/>This&#160;must&#160;happen&#160;before&#160;the&#160;SSL&#160;object&#160;is&#160;created.</p>
<p style="position:absolute;top:573px;left:137px;white-space:nowrap" class="ft6843"><b>Parameters:</b></p>
<p style="position:absolute;top:600px;left:137px;white-space:nowrap" class="ft6839"><i>ctx</i></p>
<p style="position:absolute;top:600px;left:162px;white-space:nowrap" class="ft6817">&#160;a&#160;pointer&#160;to&#160;a&#160;SSL_CTX&#160;object</p>
<p style="position:absolute;top:628px;left:137px;white-space:nowrap" class="ft6839"><i>len</i></p>
<p style="position:absolute;top:628px;left:162px;white-space:nowrap" class="ft6817">&#160;size&#160;of&#160;</p>
<p style="position:absolute;top:628px;left:225px;white-space:nowrap" class="ft6833"><b>buf</b></p>
<p style="position:absolute;top:657px;left:137px;white-space:nowrap" class="ft6839"><i>buf</i></p>
<p style="position:absolute;top:657px;left:163px;white-space:nowrap" class="ft6817">&#160;DAA&#160;Issuer&#160;public&#160;key</p>
<p style="position:absolute;top:703px;left:83px;white-space:nowrap" class="ft6834"><i><b>5.3&#160;&#160;&#160;Example</b></i></p>
<p style="position:absolute;top:734px;left:83px;white-space:nowrap" class="ft6817">This&#160;example&#160;is&#160;based&#160;on&#160;the&#160;commands&#160;</p>
<p style="position:absolute;top:734px;left:427px;white-space:nowrap" class="ft6833"><b>s_client</b></p>
<p style="position:absolute;top:734px;left:506px;white-space:nowrap" class="ft6817">&#160;and&#160;</p>
<p style="position:absolute;top:734px;left:548px;white-space:nowrap" class="ft6833"><b>s_server</b></p>
<p style="position:absolute;top:734px;left:627px;white-space:nowrap" class="ft6817">&#160;provided&#160;by&#160;</p>
<p style="position:absolute;top:754px;left:83px;white-space:nowrap" class="ft6819">OpenSSL.&#160;This&#160;section&#160;shows&#160;how&#160;to&#160;modify&#160;the&#160;code&#160;of&#160;the&#160;commands&#160;in&#160;order&#160;to&#160;<br/>support&#160;the&#160;DAA-TLS&#160;protocol&#160;without&#160;relying&#160;on&#160;the&#160;legacy&#160;mode.<br/>This&#160;example&#160;is&#160;based&#160;on&#160;the&#160;DAA-TLS&#160;Extension&#160;described&#160;in&#160;this&#160;section,&#160;but&#160;the&#160;<br/>skeleton&#160;and&#160;the&#160;basic&#160;concepts&#160;can&#160;be&#160;used&#160;with&#160;any&#160;extension&#160;defined&#160;in&#160;OpenSSL.<br/>The&#160;modifications&#160;are&#160;minimal&#160;and&#160;only&#160;affect&#160;the&#160;initialization&#160;phase&#160;where&#160;the&#160;<br/>parameters&#160;of&#160;the&#160;connection&#160;are&#160;decided.&#160;After&#160;the&#160;parameters&#160;are&#160;set&#160;up,&#160;the&#160;code&#160;<br/>for&#160;creating&#160;the&#160;TLS&#160;channel&#160;remains&#160;unchanged&#160;and&#160;the&#160;application&#160;manages&#160;the&#160;<br/>connection&#160;as&#160;without&#160;the&#160;DAA-TLS&#160;Extension.</p>
<p style="position:absolute;top:952px;left:83px;white-space:nowrap" class="ft6836"><i><b>5.3.1&#160;&#160;&#160;Common&#160;Modifications</b></i></p>
<p style="position:absolute;top:982px;left:83px;white-space:nowrap" class="ft6825">Both&#160;client&#160;and&#160;server&#160;must&#160;include&#160;the&#160;header&#160;file&#160;of&#160;the&#160;extension&#160;DAA-TLS.<br/>The&#160;following&#160;line&#160;must&#160;be&#160;added&#160;at&#160;the&#160;beginning&#160;of&#160;the&#160;code:</p>
<p style="position:absolute;top:1047px;left:105px;white-space:nowrap" class="ft6833"><b>#include&#160;&lt;openssl/t1_daa.h&gt;</b></p>
<p style="position:absolute;top:1084px;left:83px;white-space:nowrap" class="ft6817">According&#160;to&#160;OpenSSL&#160;design,&#160;an&#160;application&#160;should&#160;create&#160;a&#160;</p>
<p style="position:absolute;top:1084px;left:593px;white-space:nowrap" class="ft6833"><b>SSL_CTX</b></p>
<p style="position:absolute;top:1084px;left:663px;white-space:nowrap" class="ft6817">&#160;structure,&#160;set&#160;</p>
<p style="position:absolute;top:1104px;left:83px;white-space:nowrap" class="ft6817">default&#160;values&#160;for&#160;the&#160;SSL/TLS&#160;connection&#160;it&#160;wishes&#160;to&#160;open,&#160;then&#160;it&#160;creates&#160;the&#160;</p>
<p style="position:absolute;top:1104px;left:742px;white-space:nowrap" class="ft6833"><b>SSL&#160;</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6821">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6821">39/61</p>
</div>
<!-- Page 69 -->
<a name="69"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page69-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3069.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft699">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft690">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft6921">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft6921">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft6925">structure&#160;from&#160;the&#160;previously&#160;generated&#160;context.<br/>In&#160;general,&#160;an&#160;application&#160;will&#160;have&#160;the&#160;following&#160;skeleton:</p>
<p style="position:absolute;top:215px;left:105px;white-space:nowrap" class="ft6946"><b>ctx = SSL_CTX_new();</b></p>
<p style="position:absolute;top:258px;left:105px;white-space:nowrap" class="ft6946"><b>/* Functions that set flags and options in the SSL_CTX */</b></p>
<p style="position:absolute;top:302px;left:105px;white-space:nowrap" class="ft6946"><b>ssl = SSL_new(ctx);</b></p>
<p style="position:absolute;top:337px;left:83px;white-space:nowrap" class="ft6919">The&#160;DAA-TLS&#160;Extension&#160;offers&#160;some&#160;API&#160;functions&#160;that&#160;allow&#160;to&#160;modify&#160;its&#160;behavior.&#160;<br/>These&#160;functions&#160;set&#160;data,&#160;flags&#160;and&#160;options&#160;in&#160;the&#160;context&#160;data&#160;of&#160;the&#160;extension.&#160;The&#160;</p>
<p style="position:absolute;top:375px;left:83px;white-space:nowrap" class="ft6933"><b>SSL_new()</b></p>
<p style="position:absolute;top:375px;left:173px;white-space:nowrap" class="ft6917">&#160;function&#160;will&#160;use&#160;such&#160;data&#160;to&#160;initialize&#160;the&#160;DAA-TLS&#160;Extension.</p>
<p style="position:absolute;top:404px;left:83px;white-space:nowrap" class="ft6917">In&#160;the&#160;following&#160;it&#160;is&#160;assumed&#160;that&#160;</p>
<p style="position:absolute;top:404px;left:369px;white-space:nowrap" class="ft6933"><b>ctx</b></p>
<p style="position:absolute;top:404px;left:399px;white-space:nowrap" class="ft6917">&#160;is&#160;the&#160;</p>
<p style="position:absolute;top:404px;left:455px;white-space:nowrap" class="ft6933"><b>SSL_CTX</b></p>
<p style="position:absolute;top:404px;left:525px;white-space:nowrap" class="ft6917">&#160;structure&#160;created&#160;through&#160;the&#160;</p>
<p style="position:absolute;top:423px;left:83px;white-space:nowrap" class="ft6933"><b>SSL_CTX_new()</b></p>
<p style="position:absolute;top:423px;left:213px;white-space:nowrap" class="ft6917">&#160;function&#160;and&#160;all&#160;proposed&#160;modifications&#160;are&#160;located&#160;in&#160;the&#160;code&#160;before&#160;</p>
<p style="position:absolute;top:442px;left:83px;white-space:nowrap" class="ft6917">the&#160;creation&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:442px;left:242px;white-space:nowrap" class="ft6933"><b>SSL</b></p>
<p style="position:absolute;top:442px;left:272px;white-space:nowrap" class="ft6917">&#160;structure.</p>
<p style="position:absolute;top:488px;left:83px;white-space:nowrap" class="ft6936"><i><b>5.3.2&#160;&#160;&#160;Modifications&#160;on&#160;the&#160;Client</b></i></p>
<p style="position:absolute;top:518px;left:83px;white-space:nowrap" class="ft6925">The&#160;client&#160;must&#160;enable&#160;the&#160;support&#160;for&#160;the&#160;DAA-TLS&#160;Extension.&#160;A&#160;switch&#160;passed&#160;in&#160;input&#160;<br/>on&#160;the&#160;command&#160;line&#160;enables&#160;the&#160;DAA-TLS&#160;Extension.&#160;This&#160;switch&#160;also&#160;specifies&#160;the&#160;file&#160;<br/>that&#160;contains&#160;the&#160;DAA&#160;key.<br/>Currently,&#160;</p>
<p style="position:absolute;top:585px;left:171px;white-space:nowrap" class="ft6933"><b>s_client</b></p>
<p style="position:absolute;top:585px;left:251px;white-space:nowrap" class="ft6917">&#160;supports&#160;a&#160;command&#160;line&#160;option&#160;</p>
<p style="position:absolute;top:585px;left:528px;white-space:nowrap" class="ft6933"><b>-daa</b></p>
<p style="position:absolute;top:585px;left:568px;white-space:nowrap" class="ft6917">,&#160;which&#160;enables&#160;the&#160;DAA-TLS&#160;</p>
<p style="position:absolute;top:604px;left:83px;white-space:nowrap" class="ft6925">Extension&#160;and&#160;expects&#160;the&#160;name&#160;of&#160;a&#160;file&#160;containing&#160;the&#160;platform&#160;credentials&#160;as&#160;<br/>parameter.<br/>Within&#160;the&#160;code,&#160;the&#160;option&#160;</p>
<p style="position:absolute;top:651px;left:314px;white-space:nowrap" class="ft6933"><b>-daa&#160;</b></p>
<p style="position:absolute;top:651px;left:364px;white-space:nowrap" class="ft6917">triggers&#160;the&#160;following&#160;events:&#160;setting&#160;the&#160;value&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:670px;left:83px;white-space:nowrap" class="ft6917">integer&#160;value&#160;</p>
<p style="position:absolute;top:670px;left:198px;white-space:nowrap" class="ft6933"><b>daa</b></p>
<p style="position:absolute;top:670px;left:228px;white-space:nowrap" class="ft6917">&#160;to&#160;1,&#160;and&#160;loading&#160;the&#160;content&#160;of&#160;the&#160;specified&#160;file&#160;into&#160;a&#160;buffer&#160;</p>
<p style="position:absolute;top:670px;left:749px;white-space:nowrap" class="ft6933"><b>buf</b></p>
<p style="position:absolute;top:670px;left:779px;white-space:nowrap" class="ft6917">&#160;of&#160;</p>
<p style="position:absolute;top:690px;left:83px;white-space:nowrap" class="ft6917">length&#160;</p>
<p style="position:absolute;top:690px;left:141px;white-space:nowrap" class="ft6933"><b>len</b></p>
<p style="position:absolute;top:690px;left:171px;white-space:nowrap" class="ft6917">.</p>
<p style="position:absolute;top:718px;left:83px;white-space:nowrap" class="ft6917">The&#160;DAA-TLS&#160;Extension&#160;is&#160;then&#160;enabled&#160;using&#160;the&#160;following&#160;function:</p>
<p style="position:absolute;top:755px;left:105px;white-space:nowrap" class="ft6945"><b>if&#160;(daa)&#160;{<br/>&#160;&#160;&#160;SSL_CTX_tlsext_daa_set_enabled(ctx);<br/>}</b></p>
<p style="position:absolute;top:830px;left:83px;white-space:nowrap" class="ft6919">After&#160;the&#160;extension&#160;is&#160;enabled,&#160;it&#160;is&#160;possible&#160;to&#160;set&#160;the&#160;DAA&#160;Platform&#160;credentials&#160;using&#160;<br/>the&#160;function</p>
<p style="position:absolute;top:887px;left:105px;white-space:nowrap" class="ft6933"><b>SSL_CTX_tlsext_daa_client_set_key(ctx,&#160;len,&#160;buf);</b></p>
<p style="position:absolute;top:924px;left:83px;white-space:nowrap" class="ft6917">where&#160;</p>
<p style="position:absolute;top:924px;left:140px;white-space:nowrap" class="ft6933"><b>buf</b></p>
<p style="position:absolute;top:924px;left:170px;white-space:nowrap" class="ft6917">&#160;is&#160;a&#160;buffer&#160;of&#160;</p>
<p style="position:absolute;top:924px;left:285px;white-space:nowrap" class="ft6933"><b>len</b></p>
<p style="position:absolute;top:924px;left:314px;white-space:nowrap" class="ft6917">&#160;bytes&#160;that&#160;contains&#160;the&#160;DAA&#160;Platform&#160;credentials&#160;.&#160;</p>
<p style="position:absolute;top:970px;left:83px;white-space:nowrap" class="ft6936"><i><b>5.3.3&#160;&#160;&#160;Modifications&#160;on&#160;the&#160;Server</b></i></p>
<p style="position:absolute;top:1000px;left:83px;white-space:nowrap" class="ft6925">The&#160;server&#160;does&#160;not&#160;need&#160;to&#160;enable&#160;the&#160;support&#160;for&#160;the&#160;DAA-TLS&#160;Extension&#160;since&#160;the&#160;<br/>library&#160;enables&#160;by&#160;default&#160;the&#160;extensions&#160;on&#160;the&#160;server.<br/>Currently,&#160;</p>
<p style="position:absolute;top:1047px;left:171px;white-space:nowrap" class="ft6933"><b>s_server</b></p>
<p style="position:absolute;top:1047px;left:251px;white-space:nowrap" class="ft6917">&#160;supports&#160;a&#160;command&#160;line&#160;option&#160;</p>
<p style="position:absolute;top:1047px;left:528px;white-space:nowrap" class="ft6933"><b>-daa_issuer</b></p>
<p style="position:absolute;top:1047px;left:638px;white-space:nowrap" class="ft6917">&#160;to&#160;specify&#160;the&#160;name&#160;</p>
<p style="position:absolute;top:1066px;left:83px;white-space:nowrap" class="ft6919">of&#160;a&#160;file&#160;containing&#160;the&#160;DAA&#160;Issuer&#160;credentials&#160;as&#160;the&#160;following&#160;parameter.&#160;Within&#160;the&#160;<br/>code,&#160;this&#160;parameter&#160;forces&#160;to&#160;load&#160;the&#160;issuer&#160;credential&#160;from&#160;the&#160;specified&#160;file&#160;into&#160;a&#160;<br/>buffer&#160;</p>
<p style="position:absolute;top:1105px;left:138px;white-space:nowrap" class="ft6933"><b>buf</b></p>
<p style="position:absolute;top:1105px;left:168px;white-space:nowrap" class="ft6917">&#160;of&#160;length&#160;</p>
<p style="position:absolute;top:1105px;left:252px;white-space:nowrap" class="ft6933"><b>len</b></p>
<p style="position:absolute;top:1105px;left:282px;white-space:nowrap" class="ft6917">.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6921">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6921">40/61</p>
</div>
<!-- Page 70 -->
<a name="70"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page70-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3070.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft709">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft700">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft7021">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft7021">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft7017">After&#160;the&#160;</p>
<p style="position:absolute;top:149px;left:162px;white-space:nowrap" class="ft7033"><b>SSL_CTX</b></p>
<p style="position:absolute;top:149px;left:231px;white-space:nowrap" class="ft7017">&#160;object&#160;was&#160;created,&#160;it&#160;is&#160;possible&#160;to&#160;set&#160;the&#160;DAA&#160;Issuer&#160;credentials&#160;as&#160;</p>
<p style="position:absolute;top:168px;left:83px;white-space:nowrap" class="ft7017">shown&#160;in&#160;the&#160;following:</p>
<p style="position:absolute;top:205px;left:105px;white-space:nowrap" class="ft7045"><b>ctx&#160;=&#160;SSL_CTX_new();<br/>SSL_CTX_tlsext_daa_server_set_issuer_key(ctx,&#160;len,&#160;buf);</b></p>
<p style="position:absolute;top:262px;left:83px;white-space:nowrap" class="ft7017">where&#160;</p>
<p style="position:absolute;top:262px;left:140px;white-space:nowrap" class="ft7033"><b>buf</b></p>
<p style="position:absolute;top:262px;left:170px;white-space:nowrap" class="ft7017">&#160;is&#160;a&#160;buffer&#160;of&#160;</p>
<p style="position:absolute;top:262px;left:285px;white-space:nowrap" class="ft7033"><b>len</b></p>
<p style="position:absolute;top:262px;left:314px;white-space:nowrap" class="ft7017">&#160;bytes&#160;that&#160;contains&#160;the&#160;DAA&#160;Issuer&#160;key.</p>
<p style="position:absolute;top:290px;left:83px;white-space:nowrap" class="ft7017">In&#160;addition,&#160;</p>
<p style="position:absolute;top:290px;left:182px;white-space:nowrap" class="ft7033"><b>s_server</b></p>
<p style="position:absolute;top:290px;left:261px;white-space:nowrap" class="ft7017">&#160;supports&#160;a&#160;command&#160;line&#160;option&#160;</p>
<p style="position:absolute;top:290px;left:539px;white-space:nowrap" class="ft7033"><b>-no_daa</b></p>
<p style="position:absolute;top:290px;left:609px;white-space:nowrap" class="ft7017">&#160;to&#160;disable&#160;the&#160;DAA-TLS&#160;</p>
<p style="position:absolute;top:309px;left:83px;white-space:nowrap" class="ft7017">Extension.&#160;Within&#160;the&#160;code,&#160;this&#160;parameter&#160;sets&#160;to&#160;1&#160;the&#160;value&#160;of&#160;an&#160;integer&#160;variable&#160;</p>
<p style="position:absolute;top:328px;left:83px;white-space:nowrap" class="ft7033"><b>no_daa</b></p>
<p style="position:absolute;top:328px;left:143px;white-space:nowrap" class="ft7017">.&#160;It&#160;is&#160;then&#160;possible&#160;to&#160;disable&#160;the&#160;DAA-TLS&#160;Extension&#160;using&#160;the&#160;function:</p>
<p style="position:absolute;top:366px;left:105px;white-space:nowrap" class="ft7045"><b>if&#160;(no_daa)&#160;{<br/>&#160;&#160;&#160;SSL_CTX_tlsext_daa_set_disabled(ctx);<br/>}</b></p>
<p style="position:absolute;top:459px;left:83px;white-space:nowrap" class="ft7036"><i><b>5.3.4&#160;&#160;&#160;Running&#160;the&#160;commands</b></i></p>
<p style="position:absolute;top:489px;left:83px;white-space:nowrap" class="ft7025">Before&#160;running&#160;the&#160;commands,&#160;the&#160;DAA&#160;credential&#160;must&#160;be&#160;generated.&#160;Since&#160;this&#160;<br/>example&#160;relies&#160;on&#160;the&#160;dummy&#160;implementation,&#160;it&#160;is&#160;sufficient&#160;to&#160;used&#160;empty&#160;files&#160;for,&#160;<br/>both,&#160;the&#160;DAA&#160;Issuer&#160;credentials&#160;and&#160;the&#160;DAA&#160;Platform&#160;credentials.<br/>The&#160;command&#160;line&#160;for&#160;a&#160;server&#160;that&#160;supports&#160;the&#160;DAA-TLS&#160;is:</p>
<p style="position:absolute;top:592px;left:105px;white-space:nowrap" class="ft7033"><b>./openssl&#160;s_server</b></p>
<p style="position:absolute;top:612px;left:158px;white-space:nowrap" class="ft7033"><b>-daa_issuer&#160;/usr/local/daatoolkit/etc/daa/daa_issuer.bin</b></p>
<p style="position:absolute;top:649px;left:83px;white-space:nowrap" class="ft7017">where&#160;the&#160;option&#160;</p>
<p style="position:absolute;top:649px;left:230px;white-space:nowrap" class="ft7033"><b>-daa_issuer</b></p>
<p style="position:absolute;top:649px;left:339px;white-space:nowrap" class="ft7017">&#160;is&#160;used&#160;to&#160;specify&#160;the&#160;name&#160;of&#160;a&#160;file&#160;containing&#160;the&#160;</p>
<p style="position:absolute;top:668px;left:83px;white-space:nowrap" class="ft7017">Issuer&#160;credentials&#160;(</p>
<p style="position:absolute;top:668px;left:241px;white-space:nowrap" class="ft7033"><b>/usr/local/daatoolkit/etc/daa/daa_issuer.bin</b></p>
<p style="position:absolute;top:668px;left:679px;white-space:nowrap" class="ft7017">&#160;in&#160;the&#160;example&#160;</p>
<p style="position:absolute;top:687px;left:83px;white-space:nowrap" class="ft7025">above).<br/>The&#160;command&#160;line&#160;for&#160;a&#160;client&#160;that&#160;supports&#160;the&#160;DAA-TLS&#160;is:</p>
<p style="position:absolute;top:752px;left:105px;white-space:nowrap" class="ft7033"><b>./openssl&#160;s_client&#160;-tls1&#160;-cert&#160;client.pem</b></p>
<p style="position:absolute;top:772px;left:158px;white-space:nowrap" class="ft7033"><b>-daa&#160;/usr/local/daatoolkit/etc/daa/daa_cred.bin</b></p>
<p style="position:absolute;top:809px;left:83px;white-space:nowrap" class="ft7017">where&#160;</p>
<p style="position:absolute;top:809px;left:140px;white-space:nowrap" class="ft7033"><b>-tls1</b></p>
<p style="position:absolute;top:809px;left:189px;white-space:nowrap" class="ft7017">&#160;forces&#160;the&#160;use&#160;of&#160;TLS&#160;channel&#160;(SSL&#160;does&#160;not&#160;support&#160;extensions),&#160;</p>
<p style="position:absolute;top:809px;left:738px;white-space:nowrap" class="ft7033"><b>-cert&#160;</b></p>
<p style="position:absolute;top:828px;left:83px;white-space:nowrap" class="ft7017">specifies&#160;a&#160;client&#160;(self-signed)&#160;certificate&#160;to&#160;use&#160;during&#160;the&#160;handshake&#160;</p>
<p style="position:absolute;top:828px;left:666px;white-space:nowrap" class="ft7033"><b>-daa</b></p>
<p style="position:absolute;top:828px;left:706px;white-space:nowrap" class="ft7017">&#160;enables&#160;the&#160;</p>
<p style="position:absolute;top:847px;left:83px;white-space:nowrap" class="ft7019">DAA-TLS&#160;Extension&#160;and&#160;loads&#160;the&#160;platform&#160;credentials&#160;from&#160;the&#160;specified&#160;file&#160;<br/>(</p>
<p style="position:absolute;top:866px;left:90px;white-space:nowrap" class="ft7033"><b>/usr/local/daatoolkit/etc/daa/daa_cred.bin</b></p>
<p style="position:absolute;top:866px;left:507px;white-space:nowrap" class="ft7017">&#160;in&#160;the&#160;example&#160;above).</p>
<p style="position:absolute;top:894px;left:83px;white-space:nowrap" class="ft7017">It&#160;is&#160;also&#160;possible&#160;to&#160;run&#160;OpenSSL&#160;s_server&#160;with&#160;the&#160;DAA-TLS&#160;disabled:</p>
<p style="position:absolute;top:932px;left:105px;white-space:nowrap" class="ft7033"><b>./openssl&#160;s_server&#160;-no_daa</b></p>
<p style="position:absolute;top:969px;left:83px;white-space:nowrap" class="ft7017">In&#160;this&#160;case&#160;the&#160;server&#160;will&#160;not&#160;respond&#160;to&#160;DAA-TLS&#160;Extension&#160;requests.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft7021">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft7021">41/61</p>
</div>
<!-- Page 71 -->
<a name="71"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page71-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3071.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft719">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft710">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft7121">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft7121">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft7124"><b>6&#160;&#160;&#160;Implementation&#160;of&#160;the&#160;Specification&#160;of&#160;TCG&#160;TSS/TPM&#160;</b></p>
<p style="position:absolute;top:192px;left:101px;white-space:nowrap" class="ft7124"><b>DAA&#160;Profile&#160;for&#160;DAA-TLS</b></p>
<p style="position:absolute;top:243px;left:83px;white-space:nowrap" class="ft7134"><i><b>6.1&#160;&#160;&#160;Architecture</b></i></p>
<p style="position:absolute;top:274px;left:83px;white-space:nowrap" class="ft7125">The&#160;majority&#160;of&#160;the&#160;code&#160;presented&#160;in&#160;this&#160;section&#160;is&#160;implemented&#160;in&#160;an&#160;OpenSSL&#160;<br/>engine&#160;which&#160;overloads&#160;the&#160;functions&#160;offered&#160;by&#160;OpenSSL&#160;in&#160;the&#160;default&#160;DAA&#160;<br/>implementation.<br/>For&#160;actually&#160;making&#160;and&#160;verifying&#160;the&#160;DAA&#160;signature&#160;the&#160;engine&#160;makes&#160;use&#160;of&#160;the&#160;<br/>functions&#160;offered&#160;by&#160;a&#160;Trusted&#160;Software&#160;Stack&#160;(TSS).<br/>Next&#160;to&#160;the&#160;engine,&#160;also&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:388px;left:366px;white-space:nowrap" class="ft7133"><b>libcrypto</b></p>
<p style="position:absolute;top:388px;left:456px;white-space:nowrap" class="ft7117">&#160;DAA-enhanced&#160;and&#160;a&#160;Trusted&#160;Software&#160;</p>
<p style="position:absolute;top:408px;left:83px;white-space:nowrap" class="ft7117">Stack&#160;(TSS)&#160;are&#160;required.&#160;Furthermore,&#160;the&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:408px;left:522px;white-space:nowrap" class="ft7133"><b>libssl</b></p>
<p style="position:absolute;top:408px;left:582px;white-space:nowrap" class="ft7117">&#160;enhanced&#160;with&#160;the&#160;</p>
<p style="position:absolute;top:427px;left:83px;white-space:nowrap" class="ft7119">framework&#160;for&#160;general&#160;extension&#160;is&#160;required&#160;in&#160;order&#160;to&#160;correctly&#160;run&#160;protocol&#160;between&#160;<br/>client&#160;and&#160;server.</p>
<p style="position:absolute;top:492px;left:83px;white-space:nowrap" class="ft7136"><i><b>6.1.1&#160;&#160;&#160;Overview</b></i></p>
<p style="position:absolute;top:522px;left:83px;white-space:nowrap" class="ft7119"><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#71">Figure&#160;11&#160;</a>shows&#160;how&#160;the&#160;OpenSSL&#160;engine&#160;is&#160;internally&#160;organized&#160;and&#160;how&#160;it&#160;interacts&#160;<br/>with&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:541px;left:203px;white-space:nowrap" class="ft7133"><b>libcrypto</b></p>
<p style="position:absolute;top:541px;left:293px;white-space:nowrap" class="ft7117">&#160;and&#160;the&#160;TSS.&#160;Refer&#160;to&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#72">&#160;6.1.2&#160;</a>for&#160;more&#160;details.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft7121">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft7121">42/61</p>
<p style="position:absolute;top:1071px;left:224px;white-space:nowrap" class="ft7117">Figure&#160;11:&#160;Implementation&#160;of&#160;the&#160;specification&#160;of&#160;TCG&#160;</p>
<p style="position:absolute;top:1090px;left:268px;white-space:nowrap" class="ft7117">TSS/TPM&#160;DAA&#160;profile&#160;for&#160;DAA-TLS&#160;Overview</p>
</div>
<!-- Page 72 -->
<a name="72"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page72-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3072.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft729">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft720">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft7221">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft7221">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft7217">In&#160;more&#160;details:</p>
<p style="position:absolute;top:182px;left:110px;white-space:nowrap" class="ft7212">●</p>
<p style="position:absolute;top:177px;left:137px;white-space:nowrap" class="ft7216"><b>Engine&#160;Core</b></p>
<p style="position:absolute;top:177px;left:249px;white-space:nowrap" class="ft7217">.&#160;This&#160;module&#160;layer&#160;contains&#160;all&#160;functions&#160;required&#160;by&#160;OpenSSL&#160;and&#160;</p>
<p style="position:absolute;top:197px;left:137px;white-space:nowrap" class="ft7219">needed&#160;to&#160;manage&#160;the&#160;engine.&#160;These&#160;functions&#160;are,&#160;for&#160;instance,&#160;used&#160;to&#160;create&#160;<br/>and&#160;initialize&#160;the&#160;engine&#160;or&#160;to&#160;destroy&#160;it.</p>
<p style="position:absolute;top:249px;left:110px;white-space:nowrap" class="ft7212">●</p>
<p style="position:absolute;top:244px;left:137px;white-space:nowrap" class="ft7216"><b>TSS&#160;Binding&#160;Utilities</b></p>
<p style="position:absolute;top:244px;left:328px;white-space:nowrap" class="ft7217">.&#160;This&#160;module&#160;allows&#160;the&#160;engine&#160;to&#160;share&#160;data&#160;with&#160;the&#160;</p>
<p style="position:absolute;top:263px;left:137px;white-space:nowrap" class="ft7219">Trusted&#160;Software&#160;Stack.&#160;These&#160;functions&#160;are&#160;used&#160;to&#160;translate&#160;the&#160;representation&#160;<br/>of&#160;internal&#160;data&#160;structures&#160;(e.g.&#160;DAA&#160;signature)&#160;from&#160;OpenSSL&#160;to&#160;TSS&#160;and&#160;vice&#160;<br/>versa.</p>
<p style="position:absolute;top:334px;left:110px;white-space:nowrap" class="ft7212">●</p>
<p style="position:absolute;top:330px;left:137px;white-space:nowrap" class="ft7216"><b>DAA_METHOD</b></p>
<p style="position:absolute;top:330px;left:266px;white-space:nowrap" class="ft7217">.&#160;This&#160;overrides&#160;the&#160;default&#160;DAA&#160;method&#160;provided&#160;by&#160;OpenSSL.&#160;</p>
<p style="position:absolute;top:349px;left:137px;white-space:nowrap" class="ft7217">This&#160;method&#160;contains:</p>
<p style="position:absolute;top:382px;left:164px;white-space:nowrap" class="ft7212">■</p>
<p style="position:absolute;top:377px;left:191px;white-space:nowrap" class="ft7216"><b>DAA&#160;Core&#160;Functions</b></p>
<p style="position:absolute;top:377px;left:376px;white-space:nowrap" class="ft7217">.&#160;This&#160;module&#160;implements&#160;the&#160;code&#160;to&#160;make&#160;and&#160;</p>
<p style="position:absolute;top:396px;left:191px;white-space:nowrap" class="ft7219">verify&#160;the&#160;DAA&#160;signature.&#160;This&#160;code&#160;relies&#160;on&#160;the&#160;TSS&#160;to&#160;make&#160;the&#160;actual&#160;<br/>signature&#160;and&#160;verification&#160;and&#160;it&#160;is&#160;called&#160;by&#160;the&#160;TLS&#160;Extension&#160;that&#160;<br/>implements&#160;the&#160;protocol.&#160;More&#160;details&#160;are&#160;given&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#72">&#160;6.1.2.</a></p>
<p style="position:absolute;top:468px;left:164px;white-space:nowrap" class="ft7212">■</p>
<p style="position:absolute;top:463px;left:191px;white-space:nowrap" class="ft7216"><b>DAA_KEY&#160;Management</b></p>
<p style="position:absolute;top:463px;left:402px;white-space:nowrap" class="ft7217">.&#160;This&#160;module&#160;is&#160;in&#160;charge&#160;of&#160;loading&#160;the&#160;</p>
<p style="position:absolute;top:482px;left:191px;white-space:nowrap" class="ft7219">DAA_KEY&#160;structure&#160;(platform&#160;credentials),&#160;needed&#160;to&#160;compute&#160;signatures.&#160;<br/>According&#160;to&#160;the&#160;design&#160;described&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#54">&#160;4.1.2,</a>&#160;the&#160;application&#160;loads&#160;<br/>the&#160;key&#160;in&#160;a&#160;buffer.&#160;This&#160;module&#160;expects&#160;the&#160;buffer&#160;containing&#160;the&#160;data&#160;<br/>encoded&#160;according&#160;to&#160;the&#160;TSS&#160;specification&#160;[3];&#160;hence,&#160;the&#160;engine&#160;passes&#160;<br/>the&#160;keys&#160;to&#160;the&#160;TSS&#160;which&#160;decodes&#160;and&#160;loads&#160;them&#160;into&#160;the&#160;appropriate&#160;<br/>internal&#160;data&#160;structure.</p>
<p style="position:absolute;top:611px;left:164px;white-space:nowrap" class="ft7212">■</p>
<p style="position:absolute;top:606px;left:191px;white-space:nowrap" class="ft7216"><b>DAA_ISSUER&#160;Management</b></p>
<p style="position:absolute;top:606px;left:434px;white-space:nowrap" class="ft7217">.&#160;This&#160;module&#160;is&#160;in&#160;charge&#160;of&#160;loading&#160;the&#160;</p>
<p style="position:absolute;top:626px;left:191px;white-space:nowrap" class="ft7219">DAA_ISSUER&#160;structure&#160;(Issuer&#160;credentials),&#160;needed&#160;to&#160;verify&#160;signatures.&#160;<br/>According&#160;to&#160;the&#160;design&#160;described&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#54">&#160;4.1.2,</a>&#160;the&#160;application&#160;loads&#160;<br/>the&#160;Issuer&#160;credentials&#160;in&#160;a&#160;buffer.&#160;This&#160;module&#160;expects&#160;the&#160;buffer&#160;<br/>containing&#160;the&#160;data&#160;encoded&#160;according&#160;to&#160;the&#160;TSS&#160;specification&#160;[3];&#160;<br/>hence,&#160;the&#160;engine&#160;passes&#160;the&#160;keys&#160;to&#160;the&#160;TSS&#160;which&#160;decodes&#160;and&#160;loads&#160;<br/>them&#160;into&#160;the&#160;appropriate&#160;internal&#160;data&#160;structure.</p>
<p style="position:absolute;top:754px;left:164px;white-space:nowrap" class="ft7212">■</p>
<p style="position:absolute;top:750px;left:191px;white-space:nowrap" class="ft7216"><b>DAA_SIG&#160;Management</b></p>
<p style="position:absolute;top:750px;left:398px;white-space:nowrap" class="ft7217">.&#160;This&#160;module&#160;manages&#160;the&#160;DAA&#160;signatures.&#160;It&#160;</p>
<p style="position:absolute;top:769px;left:191px;white-space:nowrap" class="ft7219">allows&#160;to&#160;create&#160;and&#160;destroy&#160;a&#160;signature&#160;and&#160;to&#160;encode&#160;and&#160;decode&#160;it&#160;in&#160;<br/>and&#160;from&#160;network&#160;format.&#160;Since&#160;TSS&#160;specification&#160;[3]&#160;does&#160;not&#160;describe&#160;<br/>how&#160;to&#160;encode&#160;the&#160;DAA&#160;signature,&#160;this&#160;module&#160;relies&#160;on&#160;the&#160;DER-encoding&#160;<br/>provided&#160;by&#160;OpenSSL.</p>
<p style="position:absolute;top:859px;left:110px;white-space:nowrap" class="ft7212">●</p>
<p style="position:absolute;top:855px;left:137px;white-space:nowrap" class="ft7216"><b>Application&#160;Interface</b></p>
<p style="position:absolute;top:855px;left:333px;white-space:nowrap" class="ft7217">.&#160;This&#160;layer&#160;allows&#160;the&#160;engine&#160;to&#160;offer&#160;a&#160;control&#160;interface&#160;</p>
<p style="position:absolute;top:874px;left:137px;white-space:nowrap" class="ft7219">to&#160;the&#160;application.&#160;Currently,&#160;it&#160;is&#160;not&#160;used&#160;by&#160;this&#160;engine,&#160;but&#160;it&#160;is&#160;described&#160;for&#160;<br/>a&#160;more&#160;complete&#160;overview.&#160;It&#160;could&#160;be&#160;used&#160;in&#160;a&#160;future&#160;implementation&#160;for&#160;<br/>operations&#160;such&#160;as&#160;setting&#160;the&#160;TPM&#160;owner's&#160;password.</p>
<p style="position:absolute;top:941px;left:83px;white-space:nowrap" class="ft7217">Beside&#160;the&#160;engine,&#160;also&#160;other&#160;components&#160;are&#160;required:</p>
<p style="position:absolute;top:973px;left:110px;white-space:nowrap" class="ft7212">●</p>
<p style="position:absolute;top:969px;left:137px;white-space:nowrap" class="ft7216"><b>libcrypto</b></p>
<p style="position:absolute;top:969px;left:220px;white-space:nowrap" class="ft7217">&#160;is&#160;a&#160;version&#160;of&#160;OpenSSL&#160;libcrypto&#160;library&#160;that&#160;supports&#160;the&#160;DAA&#160;</p>
<p style="position:absolute;top:988px;left:137px;white-space:nowrap" class="ft7217">cryptographic&#160;primitives&#160;as&#160;described&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#53">&#160;4.</a></p>
<p style="position:absolute;top:1021px;left:110px;white-space:nowrap" class="ft7212">●</p>
<p style="position:absolute;top:1016px;left:137px;white-space:nowrap" class="ft7216"><b>TSS</b></p>
<p style="position:absolute;top:1016px;left:173px;white-space:nowrap" class="ft7217">&#160;is&#160;a&#160;library&#160;that&#160;implements&#160;the&#160;functions&#160;of&#160;the&#160;Trusted&#160;Software&#160;Stack&#160;as&#160;</p>
<p style="position:absolute;top:1035px;left:137px;white-space:nowrap" class="ft7217">described&#160;in&#160;[3].</p>
<p style="position:absolute;top:1081px;left:83px;white-space:nowrap" class="ft7236"><i><b>6.1.2&#160;&#160;&#160;Implementation&#160;Details</b></i></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft7221">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft7221">43/61</p>
</div>
<!-- Page 73 -->
<a name="73"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page73-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3073.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft739">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft730">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft7321">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft7321">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft7347"><i><b>6.1.2.1&#160;&#160;&#160;DAA_METHOD</b></i></p>
<p style="position:absolute;top:173px;left:83px;white-space:nowrap" class="ft7319">This&#160;sections&#160;shows&#160;how&#160;the&#160;engine&#160;for&#160;implementing&#160;the&#160;specification&#160;of&#160;TCG&#160;TSS/TPM&#160;<br/>DAA&#160;Profile&#160;for&#160;DAA-TLS&#160;is&#160;structured.&#160;Furthermore&#160;this&#160;section&#160;provides&#160;some&#160;details&#160;<br/>about&#160;the&#160;TSS&#160;functions&#160;that&#160;are&#160;called&#160;by&#160;the&#160;engine.</p>
<p style="position:absolute;top:239px;left:83px;white-space:nowrap" class="ft7341"><b>int daatcg_sign_verifier_init (int *&#160;</b></p>
<p style="position:absolute;top:239px;left:450px;white-space:nowrap" class="ft7342"><i><b>nonce_len</b></i></p>
<p style="position:absolute;top:239px;left:539px;white-space:nowrap" class="ft7341"><b>, &#160; unsigned char **&#160;</b></p>
<p style="position:absolute;top:239px;left:747px;white-space:nowrap" class="ft7342"><i><b>nonce</b></i></p>
<p style="position:absolute;top:239px;left:796px;white-space:nowrap" class="ft7341"><b>,&#160;</b></p>
<p style="position:absolute;top:258px;left:83px;white-space:nowrap" class="ft7341"><b>int *&#160;</b></p>
<p style="position:absolute;top:258px;left:143px;white-space:nowrap" class="ft7342"><i><b>basename_len</b></i></p>
<p style="position:absolute;top:258px;left:262px;white-space:nowrap" class="ft7341"><b>, &#160; unsigned char **&#160;</b></p>
<p style="position:absolute;top:258px;left:470px;white-space:nowrap" class="ft7342"><i><b>basename</b></i></p>
<p style="position:absolute;top:258px;left:549px;white-space:nowrap" class="ft7341"><b>, &#160; DAA *&#160;</b></p>
<p style="position:absolute;top:258px;left:648px;white-space:nowrap" class="ft7342"><i><b>daa</b></i></p>
<p style="position:absolute;top:258px;left:677px;white-space:nowrap" class="ft7341"><b>)</b></p>
<p style="position:absolute;top:277px;left:137px;white-space:nowrap" class="ft7319">The&#160;DAA&#160;Verifier&#160;initializes&#160;her&#160;nonce&#160;and&#160;basename.<br/>The&#160;basename&#160;can&#160;be&#160;NULL&#160;(and&#160;its&#160;length&#160;0),&#160;which&#160;means&#160;that&#160;no&#160;Verifier's&#160;<br/>basename&#160;is&#160;needed.<br/>Relies&#160;on&#160;the&#160;TSS&#160;function&#160;Tspi_DAA_Verifier_Init(),&#160;then&#160;converts&#160;Verifier's&#160;<br/>nonce&#160;and&#160;basename&#160;into&#160;the&#160;internal&#160;DAA&#160;structure.</p>
<p style="position:absolute;top:400px;left:137px;white-space:nowrap" class="ft7343"><b>Parameters:</b></p>
<p style="position:absolute;top:428px;left:137px;white-space:nowrap" class="ft7339"><i>nonce_len</i></p>
<p style="position:absolute;top:428px;left:220px;white-space:nowrap" class="ft7317">&#160;Pointer&#160;to&#160;the&#160;nonce&#160;length&#160;</p>
<p style="position:absolute;top:456px;left:137px;white-space:nowrap" class="ft7339"><i>nonce</i></p>
<p style="position:absolute;top:456px;left:187px;white-space:nowrap" class="ft7317">&#160;Pointer&#160;to&#160;the&#160;nonce&#160;buffer&#160;</p>
<p style="position:absolute;top:484px;left:137px;white-space:nowrap" class="ft7339"><i>basename_len</i></p>
<p style="position:absolute;top:484px;left:256px;white-space:nowrap" class="ft7317">&#160;Pointer&#160;to&#160;the&#160;basename&#160;length&#160;</p>
<p style="position:absolute;top:512px;left:137px;white-space:nowrap" class="ft7339"><i>basename</i></p>
<p style="position:absolute;top:512px;left:223px;white-space:nowrap" class="ft7317">&#160;Pointer&#160;to&#160;the&#160;basename&#160;buffer&#160;</p>
<p style="position:absolute;top:541px;left:137px;white-space:nowrap" class="ft7339"><i>daa</i></p>
<p style="position:absolute;top:541px;left:167px;white-space:nowrap" class="ft7317">&#160;DAA&#160;structure&#160;reference&#160;</p>
<p style="position:absolute;top:569px;left:137px;white-space:nowrap" class="ft7343"><b>Returns:</b></p>
<p style="position:absolute;top:597px;left:137px;white-space:nowrap" class="ft7325">0&#160;in&#160;case&#160;of&#160;success&#160;<br/>1&#160;in&#160;case&#160;of&#160;error&#160;</p>
<p style="position:absolute;top:653px;left:83px;white-space:nowrap" class="ft7341"><b>DAA_SIG* daatcg_do_sign (const unsigned char *&#160;</b></p>
<p style="position:absolute;top:653px;left:549px;white-space:nowrap" class="ft7342"><i><b>dgst</b></i></p>
<p style="position:absolute;top:653px;left:588px;white-space:nowrap" class="ft7341"><b>, &#160; int&#160;</b></p>
<p style="position:absolute;top:653px;left:668px;white-space:nowrap" class="ft7342"><i><b>dgst_len</b></i></p>
<p style="position:absolute;top:653px;left:747px;white-space:nowrap" class="ft7341"><b>,&#160;</b></p>
<p style="position:absolute;top:672px;left:83px;white-space:nowrap" class="ft7341"><b>DAA *&#160;</b></p>
<p style="position:absolute;top:672px;left:143px;white-space:nowrap" class="ft7342"><i><b>daa</b></i></p>
<p style="position:absolute;top:672px;left:173px;white-space:nowrap" class="ft7341"><b>)</b></p>
<p style="position:absolute;top:691px;left:137px;white-space:nowrap" class="ft7319">Computes&#160;a&#160;DAA&#160;signature&#160;on&#160;a&#160;given&#160;digest.<br/>Converts&#160;the&#160;digest&#160;to&#160;a&#160;TSS_OBJECT_TYPE_HASH,&#160;then&#160;calls&#160;the&#160;TSS&#160;function&#160;<br/>Tspi_TPM_DAA_Sign(),&#160;finally&#160;convert&#160;the&#160;resulting&#160;signature&#160;to&#160;the&#160;internal&#160;<br/>OpenSSL&#160;format.</p>
<p style="position:absolute;top:786px;left:137px;white-space:nowrap" class="ft7343"><b>Parameters:</b></p>
<p style="position:absolute;top:813px;left:137px;white-space:nowrap" class="ft7339"><i>dgst</i></p>
<p style="position:absolute;top:813px;left:173px;white-space:nowrap" class="ft7317">&#160;Digest&#160;to&#160;be&#160;signed&#160;</p>
<p style="position:absolute;top:841px;left:137px;white-space:nowrap" class="ft7339"><i>dgst_len</i></p>
<p style="position:absolute;top:841px;left:206px;white-space:nowrap" class="ft7317">&#160;Length&#160;of&#160;the&#160;digest&#160;</p>
<p style="position:absolute;top:870px;left:137px;white-space:nowrap" class="ft7339"><i>daa</i></p>
<p style="position:absolute;top:870px;left:167px;white-space:nowrap" class="ft7317">&#160;DAA&#160;structure&#160;reference&#160;</p>
<p style="position:absolute;top:898px;left:137px;white-space:nowrap" class="ft7343"><b>Returns:</b></p>
<p style="position:absolute;top:926px;left:137px;white-space:nowrap" class="ft7325">DAA&#160;signature&#160;on&#160;dgst&#160;(in&#160;OpenSSL&#160;format)&#160;<br/>NULL&#160;in&#160;case&#160;of&#160;error&#160;</p>
<p style="position:absolute;top:982px;left:83px;white-space:nowrap" class="ft7341"><b>int daatcg_do_verify (const unsigned char *&#160;</b></p>
<p style="position:absolute;top:982px;left:519px;white-space:nowrap" class="ft7342"><i><b>dgst</b></i></p>
<p style="position:absolute;top:982px;left:559px;white-space:nowrap" class="ft7341"><b>, &#160; int&#160;</b></p>
<p style="position:absolute;top:982px;left:638px;white-space:nowrap" class="ft7342"><i><b>dgst_len</b></i></p>
<p style="position:absolute;top:982px;left:717px;white-space:nowrap" class="ft7341"><b>, &#160; const&#160;</b></p>
<p style="position:absolute;top:1001px;left:83px;white-space:nowrap" class="ft7341"><b>DAA_SIG *&#160;</b></p>
<p style="position:absolute;top:1001px;left:182px;white-space:nowrap" class="ft7342"><i><b>sig</b></i></p>
<p style="position:absolute;top:1001px;left:212px;white-space:nowrap" class="ft7341"><b>, &#160; DAA *&#160;</b></p>
<p style="position:absolute;top:1001px;left:311px;white-space:nowrap" class="ft7342"><i><b>daa</b></i></p>
<p style="position:absolute;top:1001px;left:341px;white-space:nowrap" class="ft7341"><b>)</b></p>
<p style="position:absolute;top:1020px;left:137px;white-space:nowrap" class="ft7319">Verifies&#160;a&#160;DAA&#160;signature.<br/>Converts&#160;the&#160;digest&#160;to&#160;a&#160;TSS_OBJECT_TYPE_HASH,&#160;then&#160;calls&#160;the&#160;TSS&#160;function&#160;<br/>Tspi_DAA_VerifySignature().</p>
<p style="position:absolute;top:1096px;left:137px;white-space:nowrap" class="ft7343"><b>Parameters:</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft7321">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft7321">44/61</p>
</div>
<!-- Page 74 -->
<a name="74"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page74-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3074.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft749">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft740">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft7421">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft7421">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft7439"><i>dgst</i></p>
<p style="position:absolute;top:149px;left:173px;white-space:nowrap" class="ft7417">&#160;Digest&#160;to&#160;be&#160;signed&#160;</p>
<p style="position:absolute;top:177px;left:137px;white-space:nowrap" class="ft7439"><i>dgst_len</i></p>
<p style="position:absolute;top:177px;left:206px;white-space:nowrap" class="ft7417">&#160;Length&#160;of&#160;the&#160;digest&#160;</p>
<p style="position:absolute;top:206px;left:137px;white-space:nowrap" class="ft7439"><i>sig</i></p>
<p style="position:absolute;top:206px;left:160px;white-space:nowrap" class="ft7417">&#160;DAA&#160;signature&#160;</p>
<p style="position:absolute;top:234px;left:137px;white-space:nowrap" class="ft7439"><i>daa</i></p>
<p style="position:absolute;top:234px;left:167px;white-space:nowrap" class="ft7417">&#160;DAA&#160;structure&#160;reference&#160;</p>
<p style="position:absolute;top:263px;left:137px;white-space:nowrap" class="ft7443"><b>Returns:</b></p>
<p style="position:absolute;top:290px;left:137px;white-space:nowrap" class="ft7425">1&#160;f&#160;the&#160;signature&#160;is&#160;correct&#160;<br/>0&#160;if&#160;the&#160;verification&#160;failed&#160;</p>
<p style="position:absolute;top:346px;left:83px;white-space:nowrap" class="ft7441"><b>DAA_KEY* daatcg_key_new (void)</b></p>
<p style="position:absolute;top:365px;left:137px;white-space:nowrap" class="ft7425">DAA_KEY&#160;(platform&#160;credential)&#160;constructor.<br/>Relies&#160;on&#160;the&#160;TSS&#160;function&#160;Tspi_Context_CreateObject().</p>
<p style="position:absolute;top:422px;left:137px;white-space:nowrap" class="ft7443"><b>Returns:</b></p>
<p style="position:absolute;top:449px;left:137px;white-space:nowrap" class="ft7417">a&#160;new&#160;DAA_KEY&#160;(platform&#160;credential)&#160;structure.&#160;</p>
<p style="position:absolute;top:478px;left:83px;white-space:nowrap" class="ft7441"><b>void daatcg_key_free (DAA_KEY *&#160;</b></p>
<p style="position:absolute;top:478px;left:400px;white-space:nowrap" class="ft7442"><i><b>daa</b></i></p>
<p style="position:absolute;top:478px;left:430px;white-space:nowrap" class="ft7441"><b>)</b></p>
<p style="position:absolute;top:496px;left:137px;white-space:nowrap" class="ft7419">DAA_KEY&#160;(platform&#160;credential)&#160;destructor.<br/>Does&#160;not&#160;free&#160;memory&#160;allocated&#160;by&#160;the&#160;TSS:&#160;this&#160;is&#160;automatically&#160;done&#160;when&#160;the&#160;<br/>TSS&#160;context&#160;is&#160;closed.</p>
<p style="position:absolute;top:572px;left:137px;white-space:nowrap" class="ft7443"><b>Parameters:</b></p>
<p style="position:absolute;top:600px;left:137px;white-space:nowrap" class="ft7439"><i>daa</i></p>
<p style="position:absolute;top:600px;left:167px;white-space:nowrap" class="ft7417">&#160;the&#160;DAA_KEY&#160;(platform&#160;credential)&#160;structure.&#160;</p>
<p style="position:absolute;top:628px;left:83px;white-space:nowrap" class="ft7441"><b>DAA_KEY* d2i_daatcg_key (DAA_KEY **&#160;</b></p>
<p style="position:absolute;top:628px;left:440px;white-space:nowrap" class="ft7442"><i><b>a</b></i></p>
<p style="position:absolute;top:628px;left:450px;white-space:nowrap" class="ft7441"><b>, &#160; const unsigned char **&#160;</b></p>
<p style="position:absolute;top:628px;left:717px;white-space:nowrap" class="ft7442"><i><b>in</b></i></p>
<p style="position:absolute;top:628px;left:737px;white-space:nowrap" class="ft7441"><b>,&#160;</b></p>
<p style="position:absolute;top:647px;left:83px;white-space:nowrap" class="ft7441"><b>long&#160;</b></p>
<p style="position:absolute;top:647px;left:133px;white-space:nowrap" class="ft7442"><i><b>len</b></i></p>
<p style="position:absolute;top:647px;left:163px;white-space:nowrap" class="ft7441"><b>)</b></p>
<p style="position:absolute;top:665px;left:137px;white-space:nowrap" class="ft7419">DAA_KEY&#160;(platform&#160;credential)&#160;deserialization:&#160;read&#160;a&#160;DAA_KEY&#160;from&#160;a&#160;buffer.<br/>Relies&#160;on&#160;the&#160;TSS&#160;function&#160;Tspi_SetAttribData().&#160;The&#160;buffer&#160;contains&#160;credential&#160;<br/>serialized&#160;according&#160;to&#160;the&#160;TSS&#160;Specifications.</p>
<p style="position:absolute;top:742px;left:137px;white-space:nowrap" class="ft7443"><b>Parameters:</b></p>
<p style="position:absolute;top:769px;left:137px;white-space:nowrap" class="ft7439"><i>a</i></p>
<p style="position:absolute;top:769px;left:147px;white-space:nowrap" class="ft7417">&#160;Pointer&#160;to&#160;the&#160;DAA_KEY&#160;(platform&#160;credential)&#160;structure.&#160;</p>
<p style="position:absolute;top:797px;left:137px;white-space:nowrap" class="ft7439"><i>in</i></p>
<p style="position:absolute;top:797px;left:152px;white-space:nowrap" class="ft7417">&#160;Pointer&#160;to&#160;the&#160;buffer.&#160;</p>
<p style="position:absolute;top:825px;left:137px;white-space:nowrap" class="ft7439"><i>len</i></p>
<p style="position:absolute;top:825px;left:162px;white-space:nowrap" class="ft7417">&#160;Buffer&#160;length.&#160;</p>
<p style="position:absolute;top:854px;left:137px;white-space:nowrap" class="ft7443"><b>Returns:</b></p>
<p style="position:absolute;top:882px;left:137px;white-space:nowrap" class="ft7417">the&#160;DAA_KEY&#160;(platform&#160;credential)&#160;structure.&#160;</p>
<p style="position:absolute;top:910px;left:83px;white-space:nowrap" class="ft7441"><b>int i2d_daatcg_key (const DAA_KEY *&#160;</b></p>
<p style="position:absolute;top:910px;left:440px;white-space:nowrap" class="ft7442"><i><b>a</b></i></p>
<p style="position:absolute;top:910px;left:450px;white-space:nowrap" class="ft7441"><b>, &#160; unsigned char **&#160;</b></p>
<p style="position:absolute;top:910px;left:658px;white-space:nowrap" class="ft7442"><i><b>out</b></i></p>
<p style="position:absolute;top:910px;left:687px;white-space:nowrap" class="ft7441"><b>)</b></p>
<p style="position:absolute;top:928px;left:137px;white-space:nowrap" class="ft7425">DAA_KEY&#160;(platform&#160;credential)&#160;serialization:&#160;converts&#160;a&#160;DAA_KEY&#160;to&#160;a&#160;buffer.<br/>Not&#160;implemented.&#160;Actually&#160;not&#160;needed&#160;by&#160;the&#160;TLS-DAA&#160;Extension.</p>
<p style="position:absolute;top:985px;left:137px;white-space:nowrap" class="ft7443"><b>Parameters:</b></p>
<p style="position:absolute;top:1013px;left:137px;white-space:nowrap" class="ft7439"><i>a</i></p>
<p style="position:absolute;top:1013px;left:147px;white-space:nowrap" class="ft7417">&#160;the&#160;DAA_KEY&#160;(platform&#160;credential)&#160;structure.&#160;</p>
<p style="position:absolute;top:1041px;left:137px;white-space:nowrap" class="ft7439"><i>out</i></p>
<p style="position:absolute;top:1041px;left:164px;white-space:nowrap" class="ft7417">&#160;Pointer&#160;to&#160;the&#160;buffer.&#160;</p>
<p style="position:absolute;top:1070px;left:137px;white-space:nowrap" class="ft7443"><b>Returns:</b></p>
<p style="position:absolute;top:1097px;left:137px;white-space:nowrap" class="ft7417">the&#160;buffer&#160;length.&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft7421">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft7421">45/61</p>
</div>
<!-- Page 75 -->
<a name="75"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page75-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3075.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft759">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft750">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft7521">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft7521">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft7541"><b>DAA_ISSUER* daatcg_issuer_new (void)</b></p>
<p style="position:absolute;top:168px;left:137px;white-space:nowrap" class="ft7525">DAA_ISSUER&#160;(issuer&#160;credential)&#160;constructor.<br/>Relies&#160;on&#160;the&#160;TSS&#160;function&#160;Tspi_Context_CreateObject().</p>
<p style="position:absolute;top:225px;left:137px;white-space:nowrap" class="ft7543"><b>Returns:</b></p>
<p style="position:absolute;top:252px;left:137px;white-space:nowrap" class="ft7517">a&#160;new&#160;DAA_ISSUER&#160;(issuer&#160;credential)&#160;structure.&#160;</p>
<p style="position:absolute;top:280px;left:83px;white-space:nowrap" class="ft7541"><b>void daatcg_issuer_free (DAA_ISSUER *&#160;</b></p>
<p style="position:absolute;top:280px;left:460px;white-space:nowrap" class="ft7542"><i><b>daa</b></i></p>
<p style="position:absolute;top:280px;left:489px;white-space:nowrap" class="ft7541"><b>)</b></p>
<p style="position:absolute;top:299px;left:137px;white-space:nowrap" class="ft7519">DAA_ISSUER&#160;(issuer&#160;credential)&#160;destructor.<br/>Does&#160;not&#160;free&#160;memory&#160;allocated&#160;by&#160;the&#160;TSS:&#160;this&#160;is&#160;automatically&#160;done&#160;when&#160;the&#160;<br/>TSS&#160;context&#160;is&#160;closed.</p>
<p style="position:absolute;top:375px;left:137px;white-space:nowrap" class="ft7543"><b>Parameters:</b></p>
<p style="position:absolute;top:403px;left:137px;white-space:nowrap" class="ft7539"><i>daa</i></p>
<p style="position:absolute;top:403px;left:167px;white-space:nowrap" class="ft7517">&#160;the&#160;DAA_ISSUER&#160;(issuer&#160;credential)&#160;structure.&#160;</p>
<p style="position:absolute;top:431px;left:83px;white-space:nowrap" class="ft7541"><b>DAA_ISSUER* d2i_daatcg_issuer (DAA_ISSUER **&#160;</b></p>
<p style="position:absolute;top:431px;left:529px;white-space:nowrap" class="ft7542"><i><b>a</b></i></p>
<p style="position:absolute;top:431px;left:539px;white-space:nowrap" class="ft7541"><b>, &#160; const unsigned char **&#160;</b></p>
<p style="position:absolute;top:450px;left:83px;white-space:nowrap" class="ft7542"><i><b>in</b></i></p>
<p style="position:absolute;top:450px;left:103px;white-space:nowrap" class="ft7541"><b>, &#160; long&#160;</b></p>
<p style="position:absolute;top:450px;left:192px;white-space:nowrap" class="ft7542"><i><b>len</b></i></p>
<p style="position:absolute;top:450px;left:222px;white-space:nowrap" class="ft7541"><b>)</b></p>
<p style="position:absolute;top:468px;left:137px;white-space:nowrap" class="ft7519">DAA_ISSUER&#160;(issuer&#160;credential)&#160;deserialization:&#160;reads&#160;a&#160;DAA_ISSUER&#160;from&#160;a&#160;<br/>buffer.<br/>Relies&#160;on&#160;the&#160;TSS&#160;function&#160;Tspi_SetAttribData().&#160;The&#160;buffer&#160;contains&#160;credential&#160;<br/>serialized&#160;according&#160;to&#160;the&#160;TSS&#160;Specifications.</p>
<p style="position:absolute;top:564px;left:137px;white-space:nowrap" class="ft7543"><b>Parameters:</b></p>
<p style="position:absolute;top:591px;left:137px;white-space:nowrap" class="ft7539"><i>a</i></p>
<p style="position:absolute;top:591px;left:147px;white-space:nowrap" class="ft7517">&#160;Pointer&#160;to&#160;the&#160;DAA_ISSUER&#160;(issuer&#160;credential)&#160;structure.&#160;</p>
<p style="position:absolute;top:619px;left:137px;white-space:nowrap" class="ft7539"><i>in</i></p>
<p style="position:absolute;top:619px;left:152px;white-space:nowrap" class="ft7517">&#160;Pointer&#160;to&#160;the&#160;buffer.&#160;</p>
<p style="position:absolute;top:647px;left:137px;white-space:nowrap" class="ft7539"><i>len</i></p>
<p style="position:absolute;top:647px;left:162px;white-space:nowrap" class="ft7517">&#160;Buffer&#160;length.&#160;</p>
<p style="position:absolute;top:676px;left:137px;white-space:nowrap" class="ft7543"><b>Returns:</b></p>
<p style="position:absolute;top:704px;left:137px;white-space:nowrap" class="ft7517">the&#160;DAA_ISSUER&#160;(issuer&#160;credential)&#160;structure.&#160;</p>
<p style="position:absolute;top:732px;left:83px;white-space:nowrap" class="ft7541"><b>int i2d_daatcg_issuer (const DAA_ISSUER *&#160;</b></p>
<p style="position:absolute;top:732px;left:499px;white-space:nowrap" class="ft7542"><i><b>a</b></i></p>
<p style="position:absolute;top:732px;left:509px;white-space:nowrap" class="ft7541"><b>, &#160; unsigned char **&#160;</b></p>
<p style="position:absolute;top:732px;left:717px;white-space:nowrap" class="ft7542"><i><b>out</b></i></p>
<p style="position:absolute;top:732px;left:747px;white-space:nowrap" class="ft7541"><b>)</b></p>
<p style="position:absolute;top:750px;left:137px;white-space:nowrap" class="ft7525">DAA_ISSUER&#160;(issuer&#160;credential)&#160;serialization:&#160;converts&#160;a&#160;DAA_ISSUER&#160;to&#160;a&#160;buffer.<br/>Not&#160;implemented.&#160;Actually&#160;not&#160;needed&#160;by&#160;the&#160;TLS-DAA&#160;Extension.</p>
<p style="position:absolute;top:807px;left:137px;white-space:nowrap" class="ft7543"><b>Parameters:</b></p>
<p style="position:absolute;top:835px;left:137px;white-space:nowrap" class="ft7539"><i>a</i></p>
<p style="position:absolute;top:835px;left:147px;white-space:nowrap" class="ft7517">&#160;the&#160;DAA_ISSUER&#160;(issuer&#160;credential)&#160;structure.&#160;</p>
<p style="position:absolute;top:863px;left:137px;white-space:nowrap" class="ft7539"><i>out</i></p>
<p style="position:absolute;top:863px;left:164px;white-space:nowrap" class="ft7517">&#160;Pointer&#160;to&#160;the&#160;buffer.&#160;</p>
<p style="position:absolute;top:892px;left:137px;white-space:nowrap" class="ft7543"><b>Returns:</b></p>
<p style="position:absolute;top:919px;left:137px;white-space:nowrap" class="ft7517">the&#160;buffer&#160;length.</p>
<p style="position:absolute;top:965px;left:83px;white-space:nowrap" class="ft7536"><i><b>6.1.3&#160;&#160;&#160;Workflow</b></i></p>
<p style="position:absolute;top:995px;left:83px;white-space:nowrap" class="ft7519">The&#160;workflow&#160;of&#160;the&#160;usage&#160;of&#160;the&#160;engine&#160;for&#160;implementing&#160;the&#160;specification&#160;of&#160;TCG&#160;<br/>TSS/TPM&#160;DAA&#160;Profile&#160;for&#160;DAA-TLS&#160;is&#160;depicted&#160;in<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#76">&#160;Figure&#160;12.</a></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft7521">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft7521">46/61</p>
</div>
<!-- Page 76 -->
<a name="76"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page76-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3076.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft769">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft760">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft7621">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft7621">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:607px;left:110px;white-space:nowrap" class="ft7617">1.&#160;Both&#160;client&#160;and&#160;server&#160;initialize&#160;the&#160;respective&#160;engines&#160;by&#160;calling&#160;the&#160;engine&#160;</p>
<p style="position:absolute;top:626px;left:137px;white-space:nowrap" class="ft7617">initialization&#160;function.</p>
<p style="position:absolute;top:655px;left:110px;white-space:nowrap" class="ft7617">2.&#160;After&#160;the&#160;engine&#160;is&#160;initialized,&#160;the&#160;extension&#160;is&#160;created&#160;and&#160;initialized&#160;through&#160;</p>
<p style="position:absolute;top:674px;left:137px;white-space:nowrap" class="ft7633"><b>ssl_tlsext_daa_init()</b></p>
<p style="position:absolute;top:674px;left:346px;white-space:nowrap" class="ft7617">&#160;(see&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#72">&#160;6.1.2&#160;</a>for&#160;more&#160;details).&#160;During&#160;this&#160;</p>
<p style="position:absolute;top:693px;left:137px;white-space:nowrap" class="ft7619">operation,&#160;the&#160;client&#160;loads&#160;the&#160;DAA&#160;Platform&#160;credentials,&#160;while&#160;the&#160;server&#160;loads&#160;<br/>the&#160;DAA&#160;Issuer&#160;credentials.&#160;These&#160;data&#160;will&#160;be&#160;used&#160;later&#160;on&#160;to&#160;make&#160;the&#160;DAA&#160;<br/>signature&#160;and&#160;to&#160;verify&#160;it.</p>
<p style="position:absolute;top:760px;left:110px;white-space:nowrap" class="ft7617">3.&#160;The&#160;client&#160;begins&#160;the&#160;TLS&#160;handshake&#160;by&#160;sending&#160;a&#160;ClientHello&#160;with&#160;the&#160;DAA-TLS&#160;</p>
<p style="position:absolute;top:779px;left:137px;white-space:nowrap" class="ft7619">Extension&#160;indicating&#160;that&#160;it&#160;wants&#160;to&#160;use&#160;the&#160;anonymous&#160;authentication.&#160;<br/>According&#160;to&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#64">&#160;5.1.4,</a>&#160;it&#160;sets&#160;a&#160;proper&#160;version.</p>
<p style="position:absolute;top:826px;left:110px;white-space:nowrap" class="ft7617">4.&#160;If&#160;the&#160;server&#160;agrees&#160;on&#160;using&#160;the&#160;DAA&#160;anonymous&#160;authentication,&#160;the&#160;</p>
<p style="position:absolute;top:845px;left:137px;white-space:nowrap" class="ft7633"><b>ssl_tlsext_daa_server_cb&#160;callback()</b></p>
<p style="position:absolute;top:845px;left:485px;white-space:nowrap" class="ft7617">&#160;is&#160;called.&#160;This&#160;callback&#160;function&#160;calls&#160;</p>
<p style="position:absolute;top:865px;left:137px;white-space:nowrap" class="ft7617">the&#160;</p>
<p style="position:absolute;top:865px;left:170px;white-space:nowrap" class="ft7633"><b>Tspi_DAA_Verifier_Init()</b></p>
<p style="position:absolute;top:865px;left:408px;white-space:nowrap" class="ft7617">&#160;function&#160;offered&#160;by&#160;the&#160;TSS&#160;in&#160;order&#160;to&#160;obtain&#160;a&#160;</p>
<p style="position:absolute;top:884px;left:137px;white-space:nowrap" class="ft7617">nonce&#160;and&#160;the&#160;basename&#160;for&#160;the&#160;DAA&#160;signature.</p>
<p style="position:absolute;top:912px;left:110px;white-space:nowrap" class="ft7617">5.&#160;The&#160;server&#160;replies&#160;with&#160;the&#160;ServerHello&#160;with&#160;the&#160;DAA-TLS&#160;Extension.&#160;The&#160;</p>
<p style="position:absolute;top:931px;left:137px;white-space:nowrap" class="ft7619">extension&#160;contains&#160;the&#160;Verifier's&#160;nonce&#160;and&#160;basename&#160;that&#160;must&#160;be&#160;used&#160;in&#160;the&#160;<br/>signature&#160;computation.</p>
<p style="position:absolute;top:979px;left:110px;white-space:nowrap" class="ft7617">6.&#160;The&#160;TLS&#160;handshake&#160;continues&#160;as&#160;usually&#160;until&#160;the&#160;client&#160;needs&#160;to&#160;send&#160;the&#160;</p>
<p style="position:absolute;top:998px;left:137px;white-space:nowrap" class="ft7617">SupplementalData&#160;message&#160;that&#160;carries&#160;the&#160;DAA&#160;signature.</p>
<p style="position:absolute;top:1026px;left:110px;white-space:nowrap" class="ft7617">7.&#160;In&#160;order&#160;to&#160;send&#160;the&#160;SupplementalData&#160;message,&#160;the&#160;client&#160;executes&#160;the&#160;</p>
<p style="position:absolute;top:1045px;left:137px;white-space:nowrap" class="ft7633"><b>ssl_tlsext_daa_client_supp_data_cb()</b></p>
<p style="position:absolute;top:1045px;left:495px;white-space:nowrap" class="ft7617">.&#160;This&#160;callback&#160;function&#160;computes&#160;the&#160;</p>
<p style="position:absolute;top:1064px;left:137px;white-space:nowrap" class="ft7617">DAA&#160;signature&#160;relying&#160;on&#160;the&#160;</p>
<p style="position:absolute;top:1064px;left:382px;white-space:nowrap" class="ft7633"><b>Tspi_TPM_DAA_Sign()</b></p>
<p style="position:absolute;top:1064px;left:570px;white-space:nowrap" class="ft7617">&#160;function&#160;offered&#160;by&#160;the&#160;TSS.&#160;</p>
<p style="position:absolute;top:1084px;left:137px;white-space:nowrap" class="ft7617">This&#160;signature&#160;is&#160;sent&#160;through&#160;the&#160;SupplementalData&#160;message.</p>
<p style="position:absolute;top:1112px;left:110px;white-space:nowrap" class="ft7617">8.&#160;The&#160;TLS&#160;handshake&#160;continues&#160;as&#160;usually&#160;until&#160;the&#160;server&#160;and&#160;the&#160;client&#160;exchange&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft7621">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft7621">47/61</p>
<p style="position:absolute;top:569px;left:204px;white-space:nowrap" class="ft7617">Figure&#160;12:&#160;TCG&#160;TSS/TPM&#160;DAA&#160;Profile&#160;for&#160;DAA-TLS&#160;Workflow</p>
</div>
<!-- Page 77 -->
<a name="77"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page77-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3077.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft779">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft770">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft7721">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft7721">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft7717">the&#160;Finish&#160;message.</p>
<p style="position:absolute;top:177px;left:110px;white-space:nowrap" class="ft7717">9.&#160;After&#160;the&#160;Finish&#160;message&#160;is&#160;exchanged,&#160;the&#160;server&#160;can&#160;verify&#160;the&#160;DAA&#160;signature.&#160;</p>
<p style="position:absolute;top:197px;left:137px;white-space:nowrap" class="ft7717">This&#160;is&#160;accomplished&#160;by&#160;the&#160;</p>
<p style="position:absolute;top:197px;left:372px;white-space:nowrap" class="ft7733"><b>ssl_tlsext_daa_server_finish_cb()</b></p>
<p style="position:absolute;top:197px;left:700px;white-space:nowrap" class="ft7717">.&#160;This&#160;</p>
<p style="position:absolute;top:216px;left:137px;white-space:nowrap" class="ft7717">callback&#160;function&#160;verifies&#160;the&#160;signature&#160;relying&#160;on&#160;the&#160;</p>
<p style="position:absolute;top:235px;left:137px;white-space:nowrap" class="ft7733"><b>Tspi_DAA_VerifySignature()</b></p>
<p style="position:absolute;top:235px;left:396px;white-space:nowrap" class="ft7717">&#160;function&#160;of&#160;the&#160;TSS.</p>
<p style="position:absolute;top:263px;left:110px;white-space:nowrap" class="ft7717">10.When&#160;the&#160;handshake&#160;is&#160;completed,&#160;the&#160;client&#160;and&#160;the&#160;server&#160;can&#160;exchange&#160;the&#160;</p>
<p style="position:absolute;top:282px;left:137px;white-space:nowrap" class="ft7717">application&#160;data.</p>
<p style="position:absolute;top:311px;left:110px;white-space:nowrap" class="ft7717">11.Finally,&#160;when&#160;the&#160;application&#160;ends,&#160;the&#160;TLS&#160;channel&#160;is&#160;closed&#160;and&#160;the&#160;engine&#160;</p>
<p style="position:absolute;top:330px;left:137px;white-space:nowrap" class="ft7717">shutdown.</p>
<p style="position:absolute;top:376px;left:83px;white-space:nowrap" class="ft7734"><i><b>6.2&#160;&#160;&#160;Examples</b></i></p>
<p style="position:absolute;top:408px;left:83px;white-space:nowrap" class="ft7725">Before&#160;running&#160;the&#160;commands,&#160;the&#160;DAA&#160;credential&#160;must&#160;be&#160;generated.&#160;Such&#160;creation&#160;is&#160;<br/>not&#160;covered&#160;by&#160;this&#160;document.&#160;For&#160;further&#160;information,&#160;refer&#160;to&#160;[11].<br/>This&#160;example&#160;is&#160;based&#160;on&#160;the&#160;commands&#160;</p>
<p style="position:absolute;top:455px;left:427px;white-space:nowrap" class="ft7733"><b>s_client</b></p>
<p style="position:absolute;top:455px;left:506px;white-space:nowrap" class="ft7717">&#160;and&#160;</p>
<p style="position:absolute;top:455px;left:548px;white-space:nowrap" class="ft7733"><b>s_server</b></p>
<p style="position:absolute;top:455px;left:627px;white-space:nowrap" class="ft7717">&#160;provided&#160;by&#160;</p>
<p style="position:absolute;top:474px;left:83px;white-space:nowrap" class="ft7725">OpenSSL.&#160;<br/>Both&#160;commands&#160;support&#160;dynamic&#160;loading&#160;of&#160;engines&#160;through&#160;the&#160;</p>
<p style="position:absolute;top:502px;left:628px;white-space:nowrap" class="ft7733"><b>-engine</b></p>
<p style="position:absolute;top:502px;left:698px;white-space:nowrap" class="ft7717">&#160;command&#160;</p>
<p style="position:absolute;top:522px;left:83px;white-space:nowrap" class="ft7725">line&#160;option.<br/>The&#160;examples&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#70">&#160;5.3.4,</a>&#160;can&#160;be&#160;adapted&#160;to&#160;use&#160;the&#160;TPM-DAA&#160;engine&#160;in&#160;a&#160;<br/>straightforward&#160;way.<br/>The&#160;server&#160;runs:</p>
<p style="position:absolute;top:634px;left:105px;white-space:nowrap" class="ft7733"><b>./openssl&#160;s_server&#160;-engine&#160;tpmdaa</b></p>
<p style="position:absolute;top:653px;left:158px;white-space:nowrap" class="ft7733"><b>-daa_issuer&#160;/usr/local/daatoolkit/etc/daa/daa_issuer.bin</b></p>
<p style="position:absolute;top:690px;left:83px;white-space:nowrap" class="ft7717">The&#160;client&#160;runs:</p>
<p style="position:absolute;top:728px;left:105px;white-space:nowrap" class="ft7733"><b>./openssl&#160;s_client&#160;-tls1&#160;-cert&#160;client.pem&#160;-engine&#160;tpmdaa&#160;</b></p>
<p style="position:absolute;top:747px;left:158px;white-space:nowrap" class="ft7733"><b>-daa&#160;/usr/local/daatoolkit/etc/daa/daa_key.bin</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft7721">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft7721">48/61</p>
</div>
<!-- Page 78 -->
<a name="78"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page78-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3078.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft789">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft780">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft7821">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft7821">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft7824"><b>7&#160;&#160;&#160;List&#160;of&#160;abbreviations</b></p>
<p style="position:absolute;top:200px;left:83px;white-space:nowrap" class="ft7819">Listing&#160;of&#160;term&#160;definitions&#160;and&#160;abbreviations&#160;used&#160;in&#160;this&#160;document&#160;(IT&#160;expressions&#160;and&#160;<br/>terms&#160;from&#160;the&#160;application&#160;domain).</p>
<p style="position:absolute;top:258px;left:93px;white-space:nowrap" class="ft7816"><b>Abbreviation</b></p>
<p style="position:absolute;top:258px;left:301px;white-space:nowrap" class="ft7816"><b>Explanation</b></p>
<p style="position:absolute;top:277px;left:93px;white-space:nowrap" class="ft7817">CA</p>
<p style="position:absolute;top:277px;left:301px;white-space:nowrap" class="ft7817">Certification&#160;Authority</p>
<p style="position:absolute;top:297px;left:93px;white-space:nowrap" class="ft7817">DAA</p>
<p style="position:absolute;top:297px;left:301px;white-space:nowrap" class="ft7817">Direct&#160;Anonymous&#160;Attestation</p>
<p style="position:absolute;top:316px;left:93px;white-space:nowrap" class="ft7817">DER</p>
<p style="position:absolute;top:316px;left:301px;white-space:nowrap" class="ft7817">Distinguished&#160;Encoding&#160;Rules</p>
<p style="position:absolute;top:335px;left:93px;white-space:nowrap" class="ft7817">TCG</p>
<p style="position:absolute;top:335px;left:301px;white-space:nowrap" class="ft7817">Trusted&#160;Computing&#160;Group</p>
<p style="position:absolute;top:354px;left:93px;white-space:nowrap" class="ft7817">TLS</p>
<p style="position:absolute;top:354px;left:301px;white-space:nowrap" class="ft7817">Transport&#160;Layer&#160;Security</p>
<p style="position:absolute;top:374px;left:93px;white-space:nowrap" class="ft7817">TPM</p>
<p style="position:absolute;top:374px;left:301px;white-space:nowrap" class="ft7817">Trusted&#160;Platform&#160;Module</p>
<p style="position:absolute;top:393px;left:93px;white-space:nowrap" class="ft7817">TSS</p>
<p style="position:absolute;top:393px;left:301px;white-space:nowrap" class="ft7817">TCG&#160;Software&#160;Stack</p>
<p style="position:absolute;top:458px;left:83px;white-space:nowrap" class="ft7824"><b>8&#160;&#160;&#160;Referenced&#160;Documents</b></p>
<p style="position:absolute;top:492px;left:83px;white-space:nowrap" class="ft7817">/1/&#160;OpenTC&#160;D03c.3&#160;SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:530px;left:83px;white-space:nowrap" class="ft7819">/2/&#160;TCG&#160;TPM&#160;Main&#160;Specification&#160;(parts&#160;1,2,3)<br/>July&#160;9,&#160;2007,<br/>Version&#160;1.2&#160;Level&#160;2&#160;Revision&#160;103</p>
<p style="position:absolute;top:607px;left:83px;white-space:nowrap" class="ft7819">/3/&#160;TCG&#160;Software&#160;Stack&#160;(TSS)&#160;Specification<br/>March&#160;7,&#160;2007,&#160;<br/>Version&#160;1.2,&#160;Level&#160;1,&#160;Errata&#160;A</p>
<p style="position:absolute;top:684px;left:83px;white-space:nowrap" class="ft7819">/4/&#160;IETF&#160;RFC&#160;4346,&#160;The&#160;Transport&#160;Layer&#160;Security&#160;(TLS)&#160;Protocol&#160;Version&#160;1.1<br/>April,&#160;2006</p>
<p style="position:absolute;top:741px;left:83px;white-space:nowrap" class="ft7819">/5/&#160;IETF&#160;RFC&#160;4366,&#160;Transport&#160;Layer&#160;Security&#160;(TLS)&#160;Extensions<br/>April,&#160;2006</p>
<p style="position:absolute;top:799px;left:83px;white-space:nowrap" class="ft7819">/6/&#160;IETF&#160;RFC&#160;4680,&#160;TLS&#160;Handshake&#160;Message&#160;for&#160;Supplemental&#160;Data<br/>September,&#160;2006</p>
<p style="position:absolute;top:856px;left:83px;white-space:nowrap" class="ft7819">/7/&#160;Direct&#160;Anonymous&#160;Attestation<br/>Ernie&#160;Brickell,&#160;Jan&#160;Camenisch,&#160;Liqun&#160;Chen<br/>CCS&#160;'04:&#160;11th&#160;ACM&#160;conference&#160;on&#160;Computer&#160;and&#160;Communications&#160;Security<br/>2004</p>
<p style="position:absolute;top:952px;left:83px;white-space:nowrap" class="ft7817">/8/&#160;Simplified&#160;Security&#160;Notions&#160;of&#160;Direct&#160;Anonymous&#160;Attestation&#160;and&#160;a&#160;Concrete&#160;</p>
<p style="position:absolute;top:972px;left:105px;white-space:nowrap" class="ft7819">Scheme&#160;from&#160;Pairings<br/>Ernie&#160;Brickell,&#160;Liqun&#160;Chen,&#160;Jiangtao&#160;Li<br/>Trust08<br/>2008</p>
<p style="position:absolute;top:1068px;left:83px;white-space:nowrap" class="ft7817">/9/&#160;Pairings&#160;in&#160;Trusted&#160;Computing</p>
<p style="position:absolute;top:1087px;left:105px;white-space:nowrap" class="ft7819">Liqun&#160;Chen,&#160;Paul&#160;Morrissey,&#160;Nigel&#160;P.&#160;Smart<br/>Pairing&#160;2008</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft7821">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft7821">49/61</p>
</div>
<!-- Page 79 -->
<a name="79"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page79-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3079.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft799">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft790">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft7921">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft7921">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:105px;white-space:nowrap" class="ft7917">2008</p>
<p style="position:absolute;top:188px;left:83px;white-space:nowrap" class="ft7917">/10/&#160;Miracl&#160;–&#160;Multiprecision&#160;Integer&#160;and&#160;Rational&#160;Arithmetic&#160;C/C++&#160;Library&#160;</p>
<p style="position:absolute;top:207px;left:105px;white-space:nowrap" class="ft7919">(http://ftp.computing.dcu.ie/pub/crypto/miracl.zip)<br/>Mike&#160;Scott<br/>2007</p>
<p style="position:absolute;top:284px;left:83px;white-space:nowrap" class="ft7917">/11/&#160;OpenTC&#160;D03c.12&#160;OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;</p>
<p style="position:absolute;top:303px;left:105px;white-space:nowrap" class="ft7917">documentation</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft7921">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft7921">50/61</p>
</div>
<!-- Page 80 -->
<a name="80"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page80-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3080.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft809">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft800">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft8021">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft8021">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft8024"><b>9&#160;&#160;&#160;Appendix.&#160;Code&#160;Documentation</b></p>
<p style="position:absolute;top:218px;left:83px;white-space:nowrap" class="ft8034"><i><b>9.1&#160;&#160;&#160;General&#160;TLS&#160;Extensions&#160;framework</b></i></p>
<p style="position:absolute;top:250px;left:83px;white-space:nowrap" class="ft8019">General&#160;framework&#160;for&#160;TLS&#160;Extensions&#160;(RFC&#160;4366)&#160;and&#160;Supplemental&#160;Data&#160;(RFC&#160;4680)&#160;<br/>support.&#160;</p>
<p style="position:absolute;top:315px;left:83px;white-space:nowrap" class="ft8036"><i><b>9.1.1&#160;&#160;&#160;Patch</b></i></p>
<p style="position:absolute;top:345px;left:83px;white-space:nowrap" class="ft8041"><b>unsigned char* ssl_add_clienthello_tlsext_general (SSL *&#160;</b></p>
<p style="position:absolute;top:345px;left:648px;white-space:nowrap" class="ft8042"><i><b>s</b></i></p>
<p style="position:absolute;top:345px;left:658px;white-space:nowrap" class="ft8041"><b>, &#160; unsigned&#160;</b></p>
<p style="position:absolute;top:364px;left:83px;white-space:nowrap" class="ft8041"><b>char *&#160;</b></p>
<p style="position:absolute;top:364px;left:153px;white-space:nowrap" class="ft8042"><i><b>p</b></i></p>
<p style="position:absolute;top:364px;left:163px;white-space:nowrap" class="ft8041"><b>, &#160; unsigned char *&#160;</b></p>
<p style="position:absolute;top:364px;left:361px;white-space:nowrap" class="ft8042"><i><b>limit</b></i></p>
<p style="position:absolute;top:364px;left:410px;white-space:nowrap" class="ft8041"><b>)</b></p>
<p style="position:absolute;top:382px;left:137px;white-space:nowrap" class="ft8017">Processes&#160;the&#160;extensions&#160;within&#160;the&#160;SSL&#160;object&#160;</p>
<p style="position:absolute;top:382px;left:530px;white-space:nowrap" class="ft8033"><b>s</b></p>
<p style="position:absolute;top:382px;left:540px;white-space:nowrap" class="ft8017">&#160;&#160;and&#160;appends&#160;their&#160;content&#160;to&#160;</p>
<p style="position:absolute;top:402px;left:137px;white-space:nowrap" class="ft8017">the&#160;buffer&#160;</p>
<p style="position:absolute;top:402px;left:224px;white-space:nowrap" class="ft8033"><b>p</b></p>
<p style="position:absolute;top:402px;left:234px;white-space:nowrap" class="ft8017">&#160;,&#160;thus&#160;generating&#160;the&#160;payload&#160;for&#160;the&#160;Client&#160;Hello&#160;message.</p>
<p style="position:absolute;top:430px;left:137px;white-space:nowrap" class="ft8017">This&#160;is&#160;a&#160;patch&#160;to&#160;ssl_add_clienthello_tlsext()&#160;(</p>
<p style="position:absolute;top:430px;left:516px;white-space:nowrap" class="ft8033"><b>libssl</b></p>
<p style="position:absolute;top:430px;left:576px;white-space:nowrap" class="ft8017">&#160;),&#160;from&#160;which&#160;inherits&#160;the&#160;</p>
<p style="position:absolute;top:449px;left:137px;white-space:nowrap" class="ft8017">prototype.&#160;:&#160;include&#160;within&#160;</p>
<p style="position:absolute;top:449px;left:359px;white-space:nowrap" class="ft8033"><b>libssl</b></p>
<p style="position:absolute;top:449px;left:419px;white-space:nowrap" class="ft8017">&#160;.&#160;</p>
<p style="position:absolute;top:477px;left:83px;white-space:nowrap" class="ft8041"><b>unsigned char* ssl_add_serverhello_tlsext_general (SSL *&#160;</b></p>
<p style="position:absolute;top:477px;left:648px;white-space:nowrap" class="ft8042"><i><b>s</b></i></p>
<p style="position:absolute;top:477px;left:658px;white-space:nowrap" class="ft8041"><b>, &#160; unsigned&#160;</b></p>
<p style="position:absolute;top:496px;left:83px;white-space:nowrap" class="ft8041"><b>char *&#160;</b></p>
<p style="position:absolute;top:496px;left:153px;white-space:nowrap" class="ft8042"><i><b>p</b></i></p>
<p style="position:absolute;top:496px;left:163px;white-space:nowrap" class="ft8041"><b>, &#160; unsigned char *&#160;</b></p>
<p style="position:absolute;top:496px;left:361px;white-space:nowrap" class="ft8042"><i><b>limit</b></i></p>
<p style="position:absolute;top:496px;left:410px;white-space:nowrap" class="ft8041"><b>)</b></p>
<p style="position:absolute;top:515px;left:137px;white-space:nowrap" class="ft8017">Processes&#160;the&#160;extensions&#160;within&#160;the&#160;SSL&#160;object&#160;</p>
<p style="position:absolute;top:515px;left:530px;white-space:nowrap" class="ft8033"><b>s</b></p>
<p style="position:absolute;top:515px;left:540px;white-space:nowrap" class="ft8017">&#160;&#160;and&#160;appends&#160;their&#160;content&#160;to&#160;</p>
<p style="position:absolute;top:534px;left:137px;white-space:nowrap" class="ft8017">the&#160;buffer&#160;</p>
<p style="position:absolute;top:534px;left:224px;white-space:nowrap" class="ft8033"><b>p</b></p>
<p style="position:absolute;top:534px;left:234px;white-space:nowrap" class="ft8017">&#160;,&#160;thus&#160;generating&#160;the&#160;payload&#160;for&#160;the&#160;Server&#160;Hello&#160;message.</p>
<p style="position:absolute;top:562px;left:137px;white-space:nowrap" class="ft8017">This&#160;is&#160;a&#160;patch&#160;to&#160;ssl_add_serverhello_tlsext()&#160;(</p>
<p style="position:absolute;top:562px;left:523px;white-space:nowrap" class="ft8033"><b>libssl</b></p>
<p style="position:absolute;top:562px;left:583px;white-space:nowrap" class="ft8017">&#160;),&#160;from&#160;which&#160;inherits&#160;the&#160;</p>
<p style="position:absolute;top:581px;left:137px;white-space:nowrap" class="ft8017">prototype.&#160;:&#160;include&#160;within&#160;</p>
<p style="position:absolute;top:581px;left:359px;white-space:nowrap" class="ft8033"><b>libssl</b></p>
<p style="position:absolute;top:581px;left:419px;white-space:nowrap" class="ft8017">&#160;.&#160;</p>
<p style="position:absolute;top:609px;left:83px;white-space:nowrap" class="ft8041"><b>int ssl_parse_clienthello_tlsext_general (SSL *&#160;</b></p>
<p style="position:absolute;top:609px;left:559px;white-space:nowrap" class="ft8042"><i><b>s</b></i></p>
<p style="position:absolute;top:609px;left:569px;white-space:nowrap" class="ft8041"><b>, &#160; unsigned short&#160;</b></p>
<p style="position:absolute;top:609px;left:757px;white-space:nowrap" class="ft8042"><i><b>type</b></i></p>
<p style="position:absolute;top:609px;left:796px;white-space:nowrap" class="ft8041"><b>,&#160;</b></p>
<p style="position:absolute;top:628px;left:83px;white-space:nowrap" class="ft8041"><b>unsigned short&#160;</b></p>
<p style="position:absolute;top:628px;left:232px;white-space:nowrap" class="ft8042"><i><b>size</b></i></p>
<p style="position:absolute;top:628px;left:272px;white-space:nowrap" class="ft8041"><b>, &#160; unsigned char *&#160;</b></p>
<p style="position:absolute;top:628px;left:470px;white-space:nowrap" class="ft8042"><i><b>data</b></i></p>
<p style="position:absolute;top:628px;left:509px;white-space:nowrap" class="ft8041"><b>)</b></p>
<p style="position:absolute;top:647px;left:137px;white-space:nowrap" class="ft8019">Handles&#160;an&#160;extension&#160;received&#160;in&#160;the&#160;Client&#160;Hello&#160;message&#160;and&#160;specified&#160;in&#160;TLV&#160;<br/>format&#160;(</p>
<p style="position:absolute;top:666px;left:204px;white-space:nowrap" class="ft8033"><b>type</b></p>
<p style="position:absolute;top:666px;left:243px;white-space:nowrap" class="ft8017">&#160;,&#160;</p>
<p style="position:absolute;top:666px;left:259px;white-space:nowrap" class="ft8033"><b>size</b></p>
<p style="position:absolute;top:666px;left:299px;white-space:nowrap" class="ft8017">&#160;,&#160;</p>
<p style="position:absolute;top:666px;left:315px;white-space:nowrap" class="ft8033"><b>data</b></p>
<p style="position:absolute;top:666px;left:354px;white-space:nowrap" class="ft8017">&#160;),&#160;pushes&#160;it&#160;to&#160;the&#160;stack&#160;of&#160;received&#160;extensions&#160;and&#160;</p>
<p style="position:absolute;top:685px;left:137px;white-space:nowrap" class="ft8025">calls&#160;the&#160;related&#160;callback&#160;function.<br/>This&#160;is&#160;a&#160;patch&#160;to&#160;ssl_parse_clienthello_tlsext()&#160;(</p>
<p style="position:absolute;top:713px;left:532px;white-space:nowrap" class="ft8033"><b>libssl</b></p>
<p style="position:absolute;top:713px;left:591px;white-space:nowrap" class="ft8017">&#160;),&#160;from&#160;which&#160;inherits&#160;the&#160;</p>
<p style="position:absolute;top:733px;left:137px;white-space:nowrap" class="ft8017">prototype.&#160;:&#160;include&#160;within&#160;</p>
<p style="position:absolute;top:733px;left:359px;white-space:nowrap" class="ft8033"><b>libssl</b></p>
<p style="position:absolute;top:733px;left:419px;white-space:nowrap" class="ft8017">&#160;.&#160;:&#160;MUST&#160;be&#160;the&#160;last&#160;extension&#160;type&#160;to&#160;parse.&#160;</p>
<p style="position:absolute;top:761px;left:83px;white-space:nowrap" class="ft8041"><b>int ssl_parse_serverhello_tlsext_general (SSL *&#160;</b></p>
<p style="position:absolute;top:761px;left:559px;white-space:nowrap" class="ft8042"><i><b>s</b></i></p>
<p style="position:absolute;top:761px;left:569px;white-space:nowrap" class="ft8041"><b>, &#160; unsigned short&#160;</b></p>
<p style="position:absolute;top:761px;left:757px;white-space:nowrap" class="ft8042"><i><b>type</b></i></p>
<p style="position:absolute;top:761px;left:796px;white-space:nowrap" class="ft8041"><b>,&#160;</b></p>
<p style="position:absolute;top:779px;left:83px;white-space:nowrap" class="ft8041"><b>unsigned short&#160;</b></p>
<p style="position:absolute;top:779px;left:232px;white-space:nowrap" class="ft8042"><i><b>size</b></i></p>
<p style="position:absolute;top:779px;left:272px;white-space:nowrap" class="ft8041"><b>, &#160; unsigned char *&#160;</b></p>
<p style="position:absolute;top:779px;left:470px;white-space:nowrap" class="ft8042"><i><b>data</b></i></p>
<p style="position:absolute;top:779px;left:509px;white-space:nowrap" class="ft8041"><b>)</b></p>
<p style="position:absolute;top:798px;left:137px;white-space:nowrap" class="ft8019">Handles&#160;an&#160;extension&#160;received&#160;in&#160;the&#160;Server&#160;Hello&#160;message&#160;and&#160;specified&#160;in&#160;TLV&#160;<br/>format&#160;(</p>
<p style="position:absolute;top:817px;left:204px;white-space:nowrap" class="ft8033"><b>type</b></p>
<p style="position:absolute;top:817px;left:243px;white-space:nowrap" class="ft8017">&#160;,&#160;</p>
<p style="position:absolute;top:817px;left:259px;white-space:nowrap" class="ft8033"><b>size</b></p>
<p style="position:absolute;top:817px;left:299px;white-space:nowrap" class="ft8017">&#160;,&#160;</p>
<p style="position:absolute;top:817px;left:315px;white-space:nowrap" class="ft8033"><b>data</b></p>
<p style="position:absolute;top:817px;left:354px;white-space:nowrap" class="ft8017">&#160;),&#160;pushes&#160;it&#160;to&#160;the&#160;stack&#160;of&#160;received&#160;General&#160;</p>
<p style="position:absolute;top:837px;left:137px;white-space:nowrap" class="ft8025">Extensions&#160;and&#160;calls&#160;the&#160;related&#160;callback&#160;function.<br/>This&#160;is&#160;a&#160;patch&#160;to&#160;ssl_parse_serverhello_tlsext()&#160;(</p>
<p style="position:absolute;top:865px;left:539px;white-space:nowrap" class="ft8033"><b>libssl</b></p>
<p style="position:absolute;top:865px;left:598px;white-space:nowrap" class="ft8017">&#160;),&#160;from&#160;which&#160;inherits&#160;</p>
<p style="position:absolute;top:884px;left:137px;white-space:nowrap" class="ft8017">the&#160;prototype.&#160;:&#160;include&#160;within&#160;</p>
<p style="position:absolute;top:884px;left:392px;white-space:nowrap" class="ft8033"><b>libssl</b></p>
<p style="position:absolute;top:884px;left:451px;white-space:nowrap" class="ft8017">&#160;.&#160;:&#160;MUST&#160;be&#160;the&#160;last&#160;extension&#160;type&#160;to&#160;</p>
<p style="position:absolute;top:903px;left:137px;white-space:nowrap" class="ft8017">parse.&#160;</p>
<p style="position:absolute;top:931px;left:83px;white-space:nowrap" class="ft8041"><b>int ssl_parse_serverhello_tlsext_general_required (SSL *&#160;</b></p>
<p style="position:absolute;top:931px;left:648px;white-space:nowrap" class="ft8042"><i><b>s</b></i></p>
<p style="position:absolute;top:931px;left:658px;white-space:nowrap" class="ft8041"><b>)</b></p>
<p style="position:absolute;top:950px;left:83px;white-space:nowrap" class="ft8017">Checks&#160;for&#160;required&#160;extensions.</p>
<p style="position:absolute;top:978px;left:137px;white-space:nowrap" class="ft8025">This&#160;function&#160;is&#160;used&#160;by&#160;the&#160;client&#160;to&#160;verify&#160;if&#160;any&#160;extension&#160;flagged&#160;as&#160;&#34;required&#34;&#160;<br/>was&#160;not&#160;received&#160;from&#160;the&#160;server.&#160;In&#160;this&#160;case&#160;the&#160;handshake&#160;is&#160;aborted.<br/>This&#160;is&#160;a&#160;patch&#160;to&#160;ssl_parse_serverhello_tlsext()&#160;(</p>
<p style="position:absolute;top:1026px;left:539px;white-space:nowrap" class="ft8033"><b>libssl</b></p>
<p style="position:absolute;top:1026px;left:598px;white-space:nowrap" class="ft8017">&#160;).</p>
<p style="position:absolute;top:1054px;left:137px;white-space:nowrap" class="ft8017">RFC&#160;4366:&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft8021">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft8021">51/61</p>
</div>
<!-- Page 81 -->
<a name="81"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page81-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3081.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft819">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft810">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft8121">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft8121">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft8145"><b>In&#160;the&#160;event&#160;that&#160;a&#160;client&#160;requests&#160;additional&#160;functionality&#160;using&#160;<br/>the&#160;extended&#160;client&#160;hello,&#160;and&#160;this&#160;functionality&#160;is&#160;not&#160;supplied&#160;<br/>by&#160;the&#160;server,&#160;the&#160;client&#160;MAY&#160;abort&#160;the&#160;handshake.</b></p>
<p style="position:absolute;top:225px;left:137px;white-space:nowrap" class="ft8119">If&#160;the&#160;client&#160;does&#160;not&#160;want&#160;to&#160;abort&#160;the&#160;handshake,&#160;it&#160;has&#160;not&#160;to&#160;flag&#160;the&#160;<br/>extension&#160;as&#160;required.&#160;</p>
<p style="position:absolute;top:272px;left:83px;white-space:nowrap" class="ft8141"><b>int ssl3_get_server_supp_data (SSL *&#160;</b></p>
<p style="position:absolute;top:272px;left:450px;white-space:nowrap" class="ft8142"><i><b>s</b></i></p>
<p style="position:absolute;top:272px;left:460px;white-space:nowrap" class="ft8141"><b>)</b></p>
<p style="position:absolute;top:291px;left:137px;white-space:nowrap" class="ft8125">Receives&#160;the&#160;server&#160;SupplementalData&#160;handshake&#160;message&#160;(if&#160;any).<br/>This&#160;is&#160;a&#160;patch&#160;to&#160;ssl3_connect()&#160;(</p>
<p style="position:absolute;top:319px;left:414px;white-space:nowrap" class="ft8133"><b>libssl</b></p>
<p style="position:absolute;top:319px;left:474px;white-space:nowrap" class="ft8117">&#160;).</p>
<p style="position:absolute;top:347px;left:137px;white-space:nowrap" class="ft8125">Differences&#160;between&#160;ssl3_get_server_supp_data()&#160;and&#160;<br/>ssl3_get_client_supp_data():<br/>1.</p>
<p style="position:absolute;top:394px;left:190px;white-space:nowrap" class="ft8117">Condition&#160;to&#160;select&#160;the&#160;extensions&#160;pool:</p>
<p style="position:absolute;top:414px;left:190px;white-space:nowrap" class="ft8133"><b>(ext-&gt;received&#160;==&#160;1)</b></p>
<p style="position:absolute;top:414px;left:389px;white-space:nowrap" class="ft8117">&#160;&#160;vs&#160;</p>
<p style="position:absolute;top:414px;left:423px;white-space:nowrap" class="ft8133"><b>(ext-&gt;server_send&#160;==&#160;1)</b></p>
<p style="position:absolute;top:414px;left:651px;white-space:nowrap" class="ft8117">&#160;.</p>
<p style="position:absolute;top:442px;left:137px;white-space:nowrap" class="ft8117">2.</p>
<p style="position:absolute;top:442px;left:190px;white-space:nowrap" class="ft8117">Supplemental&#160;data&#160;entry&#160;pool:&#160;</p>
<p style="position:absolute;top:461px;left:190px;white-space:nowrap" class="ft8133"><b>ext-&gt;client_supp_data</b></p>
<p style="position:absolute;top:461px;left:399px;white-space:nowrap" class="ft8117">&#160;&#160;vs&#160;</p>
<p style="position:absolute;top:461px;left:433px;white-space:nowrap" class="ft8133"><b>ext-&gt;server_supp_data</b></p>
<p style="position:absolute;top:461px;left:641px;white-space:nowrap" class="ft8117">&#160;.</p>
<p style="position:absolute;top:489px;left:137px;white-space:nowrap" class="ft8117">3.</p>
<p style="position:absolute;top:489px;left:190px;white-space:nowrap" class="ft8117">Parameters&#160;of&#160;</p>
<p style="position:absolute;top:489px;left:311px;white-space:nowrap" class="ft8133"><b>s-&gt;method-&gt;ssl_get_message</b></p>
<p style="position:absolute;top:489px;left:570px;white-space:nowrap" class="ft8117">&#160;.</p>
<p style="position:absolute;top:517px;left:137px;white-space:nowrap" class="ft8117">4.</p>
<p style="position:absolute;top:517px;left:190px;white-space:nowrap" class="ft8117">Call&#160;to&#160;</p>
<p style="position:absolute;top:517px;left:248px;white-space:nowrap" class="ft8133"><b>ssl3_get_server_supp_data()</b></p>
<p style="position:absolute;top:517px;left:516px;white-space:nowrap" class="ft8117">&#160;vs&#160;</p>
<p style="position:absolute;top:537px;left:137px;white-space:nowrap" class="ft8133"><b>ssl3_get_client_supp_data()</b></p>
<p style="position:absolute;top:537px;left:405px;white-space:nowrap" class="ft8117">.&#160;</p>
<p style="position:absolute;top:565px;left:83px;white-space:nowrap" class="ft8141"><b>int ssl3_send_client_supp_data (SSL *&#160;</b></p>
<p style="position:absolute;top:565px;left:460px;white-space:nowrap" class="ft8142"><i><b>s</b></i></p>
<p style="position:absolute;top:565px;left:470px;white-space:nowrap" class="ft8141"><b>)</b></p>
<p style="position:absolute;top:584px;left:137px;white-space:nowrap" class="ft8125">Sends&#160;the&#160;client&#160;SupplementalData&#160;handshake&#160;message&#160;(if&#160;any).<br/>This&#160;is&#160;a&#160;patch&#160;to&#160;ssl3_connect()&#160;(</p>
<p style="position:absolute;top:612px;left:414px;white-space:nowrap" class="ft8133"><b>libssl</b></p>
<p style="position:absolute;top:612px;left:474px;white-space:nowrap" class="ft8117">&#160;).</p>
<p style="position:absolute;top:640px;left:137px;white-space:nowrap" class="ft8125">Differences&#160;between&#160;ssl3_send_client_supp_data()&#160;and&#160;<br/>ssl3_send_server_supp_data():<br/>1.</p>
<p style="position:absolute;top:687px;left:190px;white-space:nowrap" class="ft8117">Condition&#160;to&#160;select&#160;the&#160;extensions&#160;pool:</p>
<p style="position:absolute;top:707px;left:190px;white-space:nowrap" class="ft8133"><b>(ext-&gt;received&#160;==&#160;1)</b></p>
<p style="position:absolute;top:707px;left:389px;white-space:nowrap" class="ft8117">&#160;&#160;vs&#160;</p>
<p style="position:absolute;top:707px;left:423px;white-space:nowrap" class="ft8133"><b>(ext-&gt;server_send&#160;==&#160;1)</b></p>
<p style="position:absolute;top:707px;left:651px;white-space:nowrap" class="ft8117">&#160;.</p>
<p style="position:absolute;top:735px;left:137px;white-space:nowrap" class="ft8117">2.</p>
<p style="position:absolute;top:735px;left:190px;white-space:nowrap" class="ft8117">Supplemental&#160;data&#160;entry&#160;pool:</p>
<p style="position:absolute;top:754px;left:190px;white-space:nowrap" class="ft8133"><b>ext-&gt;client_supp_data</b></p>
<p style="position:absolute;top:754px;left:399px;white-space:nowrap" class="ft8117">&#160;&#160;vs&#160;</p>
<p style="position:absolute;top:754px;left:433px;white-space:nowrap" class="ft8133"><b>ext&gt;server_supp_data</b></p>
<p style="position:absolute;top:754px;left:631px;white-space:nowrap" class="ft8117">&#160;.</p>
<p style="position:absolute;top:782px;left:137px;white-space:nowrap" class="ft8117">3.</p>
<p style="position:absolute;top:782px;left:190px;white-space:nowrap" class="ft8117">The&#160;callback&#160;to&#160;invoke:&#160;</p>
<p style="position:absolute;top:782px;left:386px;white-space:nowrap" class="ft8133"><b>ext-&gt;client_supp_data_callback()</b></p>
<p style="position:absolute;top:782px;left:704px;white-space:nowrap" class="ft8117">&#160;&#160;vs</p>
<p style="position:absolute;top:801px;left:190px;white-space:nowrap" class="ft8133"><b>ext-&gt;server_supp_data_callback</b></p>
<p style="position:absolute;top:801px;left:488px;white-space:nowrap" class="ft8117">&#160;.&#160;</p>
<p style="position:absolute;top:830px;left:83px;white-space:nowrap" class="ft8141"><b>int ssl_tlsext_general_client_finish_cb (SSL *&#160;</b></p>
<p style="position:absolute;top:830px;left:549px;white-space:nowrap" class="ft8142"><i><b>s</b></i></p>
<p style="position:absolute;top:830px;left:559px;white-space:nowrap" class="ft8141"><b>)</b></p>
<p style="position:absolute;top:848px;left:137px;white-space:nowrap" class="ft8125">Invokes&#160;the&#160;client&#160;finish&#160;callback&#160;for&#160;each&#160;negotiated&#160;extension.<br/>This&#160;is&#160;a&#160;patch&#160;to&#160;ssl3_connect()&#160;(</p>
<p style="position:absolute;top:876px;left:414px;white-space:nowrap" class="ft8133"><b>libssl</b></p>
<p style="position:absolute;top:876px;left:474px;white-space:nowrap" class="ft8117">&#160;).</p>
<p style="position:absolute;top:905px;left:137px;white-space:nowrap" class="ft8117">The&#160;callbacks&#160;are&#160;invoked&#160;at&#160;the&#160;end&#160;of&#160;the&#160;handshake,&#160;according&#160;to&#160;RFC&#160;4680:&#160;</p>
<p style="position:absolute;top:942px;left:137px;white-space:nowrap" class="ft8145"><b>Information&#160;provided&#160;in&#160;a&#160;supplemental&#160;data&#160;object&#160;MUST&#160;be&#160;intended&#160;<br/>to&#160;be&#160;used&#160;exclusibely&#160;by&#160;applications&#160;and&#160;protocols&#160;above&#160;the&#160;TLS&#160;<br/>protocol&#160;layer.&#160;&#160;Any&#160;such&#160;data&#160;MUST&#160;NOT&#160;need&#160;to&#160;be&#160;processed&#160;by&#160;the&#160;<br/>TLS&#160;protocol.</b></p>
<p style="position:absolute;top:1036px;left:83px;white-space:nowrap" class="ft8141"><b>int ssl3_send_server_supp_data (SSL *&#160;</b></p>
<p style="position:absolute;top:1036px;left:460px;white-space:nowrap" class="ft8142"><i><b>s</b></i></p>
<p style="position:absolute;top:1036px;left:470px;white-space:nowrap" class="ft8141"><b>)</b></p>
<p style="position:absolute;top:1055px;left:137px;white-space:nowrap" class="ft8125">Sends&#160;the&#160;server&#160;SupplementalData&#160;handshake&#160;message&#160;(if&#160;any).<br/>This&#160;is&#160;a&#160;patch&#160;to&#160;ssl3_accept()&#160;(</p>
<p style="position:absolute;top:1083px;left:404px;white-space:nowrap" class="ft8133"><b>libssl</b></p>
<p style="position:absolute;top:1083px;left:463px;white-space:nowrap" class="ft8117">&#160;).</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft8121">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft8121">52/61</p>
</div>
<!-- Page 82 -->
<a name="82"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page82-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3082.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft829">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft820">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft8221">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft8221">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft8225">Differences&#160;between&#160;ssl3_send_client_supp_data()&#160;and&#160;<br/>ssl3_send_server_supp_data():<br/>1.</p>
<p style="position:absolute;top:197px;left:190px;white-space:nowrap" class="ft8217">Condition&#160;to&#160;select&#160;the&#160;extensions&#160;pool:</p>
<p style="position:absolute;top:216px;left:190px;white-space:nowrap" class="ft8233"><b>(ext-&gt;received&#160;==&#160;1)</b></p>
<p style="position:absolute;top:216px;left:389px;white-space:nowrap" class="ft8217">&#160;&#160;vs&#160;</p>
<p style="position:absolute;top:216px;left:423px;white-space:nowrap" class="ft8233"><b>(ext-&gt;server_send&#160;==&#160;1)</b></p>
<p style="position:absolute;top:216px;left:651px;white-space:nowrap" class="ft8217">&#160;.</p>
<p style="position:absolute;top:244px;left:137px;white-space:nowrap" class="ft8217">2.</p>
<p style="position:absolute;top:244px;left:190px;white-space:nowrap" class="ft8217">Supplemental&#160;data&#160;entry&#160;pool:</p>
<p style="position:absolute;top:263px;left:190px;white-space:nowrap" class="ft8233"><b>ext-&gt;client_supp_data</b></p>
<p style="position:absolute;top:263px;left:399px;white-space:nowrap" class="ft8217">&#160;&#160;vs&#160;</p>
<p style="position:absolute;top:263px;left:433px;white-space:nowrap" class="ft8233"><b>ext-&gt;server_supp_data</b></p>
<p style="position:absolute;top:263px;left:641px;white-space:nowrap" class="ft8217">&#160;.</p>
<p style="position:absolute;top:291px;left:137px;white-space:nowrap" class="ft8217">3.</p>
<p style="position:absolute;top:291px;left:190px;white-space:nowrap" class="ft8217">The&#160;callback&#160;to&#160;invoke:&#160;</p>
<p style="position:absolute;top:291px;left:386px;white-space:nowrap" class="ft8233"><b>ext-&gt;client_supp_data_callback()</b></p>
<p style="position:absolute;top:291px;left:704px;white-space:nowrap" class="ft8217">&#160;&#160;vs</p>
<p style="position:absolute;top:311px;left:190px;white-space:nowrap" class="ft8233"><b>ext-&gt;server_supp_data_callback</b></p>
<p style="position:absolute;top:311px;left:488px;white-space:nowrap" class="ft8217">&#160;.&#160;</p>
<p style="position:absolute;top:339px;left:83px;white-space:nowrap" class="ft8241"><b>int ssl3_get_client_supp_data (SSL *&#160;</b></p>
<p style="position:absolute;top:339px;left:450px;white-space:nowrap" class="ft8242"><i><b>s</b></i></p>
<p style="position:absolute;top:339px;left:460px;white-space:nowrap" class="ft8241"><b>)</b></p>
<p style="position:absolute;top:357px;left:137px;white-space:nowrap" class="ft8225">Receives&#160;the&#160;client&#160;SupplementalData&#160;handshake&#160;message&#160;(if&#160;any).<br/>This&#160;is&#160;a&#160;patch&#160;to&#160;ssl3_accept()&#160;(</p>
<p style="position:absolute;top:386px;left:404px;white-space:nowrap" class="ft8233"><b>libssl</b></p>
<p style="position:absolute;top:386px;left:463px;white-space:nowrap" class="ft8217">&#160;).</p>
<p style="position:absolute;top:414px;left:137px;white-space:nowrap" class="ft8225">Differences&#160;between&#160;ssl3_get_server_supp_data()&#160;and&#160;<br/>ssl3_get_client_supp_data():<br/>1.</p>
<p style="position:absolute;top:461px;left:190px;white-space:nowrap" class="ft8217">Condition&#160;to&#160;select&#160;the&#160;extensions&#160;pool:</p>
<p style="position:absolute;top:480px;left:190px;white-space:nowrap" class="ft8233"><b>(ext-&gt;received&#160;==&#160;1)</b></p>
<p style="position:absolute;top:480px;left:389px;white-space:nowrap" class="ft8217">&#160;&#160;vs&#160;</p>
<p style="position:absolute;top:480px;left:423px;white-space:nowrap" class="ft8233"><b>(ext-&gt;server_send&#160;==&#160;1)</b></p>
<p style="position:absolute;top:480px;left:651px;white-space:nowrap" class="ft8217">&#160;.</p>
<p style="position:absolute;top:509px;left:137px;white-space:nowrap" class="ft8217">2.</p>
<p style="position:absolute;top:509px;left:190px;white-space:nowrap" class="ft8217">Supplemental&#160;data&#160;entry&#160;pool:</p>
<p style="position:absolute;top:528px;left:190px;white-space:nowrap" class="ft8233"><b>ext-&gt;client_supp_data</b></p>
<p style="position:absolute;top:528px;left:399px;white-space:nowrap" class="ft8217">&#160;&#160;vs&#160;</p>
<p style="position:absolute;top:528px;left:433px;white-space:nowrap" class="ft8233"><b>ext-&gt;server_supp_data</b></p>
<p style="position:absolute;top:528px;left:641px;white-space:nowrap" class="ft8217">&#160;.</p>
<p style="position:absolute;top:556px;left:137px;white-space:nowrap" class="ft8217">3.</p>
<p style="position:absolute;top:556px;left:190px;white-space:nowrap" class="ft8217">Parameters&#160;of&#160;</p>
<p style="position:absolute;top:556px;left:311px;white-space:nowrap" class="ft8233"><b>s-&gt;method-&gt;ssl_get_message</b></p>
<p style="position:absolute;top:556px;left:570px;white-space:nowrap" class="ft8217">&#160;.</p>
<p style="position:absolute;top:584px;left:137px;white-space:nowrap" class="ft8217">4.</p>
<p style="position:absolute;top:584px;left:190px;white-space:nowrap" class="ft8217">Call&#160;to&#160;</p>
<p style="position:absolute;top:584px;left:248px;white-space:nowrap" class="ft8233"><b>ssl3_get_server_supp_data()</b></p>
<p style="position:absolute;top:584px;left:516px;white-space:nowrap" class="ft8217">&#160;vs&#160;</p>
<p style="position:absolute;top:603px;left:190px;white-space:nowrap" class="ft8233"><b>ssl3_get_client_supp_data()</b></p>
<p style="position:absolute;top:603px;left:458px;white-space:nowrap" class="ft8217">.&#160;</p>
<p style="position:absolute;top:632px;left:83px;white-space:nowrap" class="ft8241"><b>int ssl_tlsext_general_server_finish_cb (SSL *&#160;</b></p>
<p style="position:absolute;top:632px;left:549px;white-space:nowrap" class="ft8242"><i><b>s</b></i></p>
<p style="position:absolute;top:632px;left:559px;white-space:nowrap" class="ft8241"><b>)</b></p>
<p style="position:absolute;top:650px;left:137px;white-space:nowrap" class="ft8225">Invokes&#160;the&#160;server&#160;finish&#160;callback&#160;for&#160;each&#160;negotiated&#160;extension.<br/>This&#160;is&#160;a&#160;patch&#160;to&#160;ssl3_accept()&#160;(</p>
<p style="position:absolute;top:679px;left:404px;white-space:nowrap" class="ft8233"><b>libssl</b></p>
<p style="position:absolute;top:679px;left:463px;white-space:nowrap" class="ft8217">&#160;).</p>
<p style="position:absolute;top:707px;left:137px;white-space:nowrap" class="ft8217">The&#160;callbacks&#160;are&#160;invoked&#160;at&#160;the&#160;end&#160;of&#160;the&#160;handshake,&#160;according&#160;to&#160;RFC&#160;4680:</p>
<p style="position:absolute;top:744px;left:137px;white-space:nowrap" class="ft8245"><b>Information&#160;provided&#160;in&#160;a&#160;supplemental&#160;data&#160;object&#160;MUST&#160;be&#160;intended&#160;<br/>to&#160;be&#160;used&#160;exclusively&#160;by&#160;applications&#160;and&#160;protocols&#160;above&#160;the&#160;TLS&#160;<br/>protocol&#160;layer.&#160;&#160;Any&#160;such&#160;data&#160;MUST&#160;NOT&#160;need&#160;to&#160;be&#160;processed&#160;by&#160;the&#160;<br/>TLS&#160;protocol.</b></p>
<p style="position:absolute;top:839px;left:83px;white-space:nowrap" class="ft8241"><b>void ssl_tlsext_general_init_list (SSL *&#160;</b></p>
<p style="position:absolute;top:839px;left:489px;white-space:nowrap" class="ft8242"><i><b>s</b></i></p>
<p style="position:absolute;top:839px;left:499px;white-space:nowrap" class="ft8241"><b>)</b></p>
<p style="position:absolute;top:857px;left:137px;white-space:nowrap" class="ft8225">Runs&#160;the&#160;init&#160;function&#160;for&#160;each&#160;extension&#160;within&#160;the&#160;SSL_CTX&#160;object.<br/>If&#160;the&#160;init&#160;function&#160;returns&#160;not&#160;NULL,&#160;the&#160;initialized&#160;extension&#160;is&#160;pushed&#160;into&#160;the&#160;<br/>stack&#160;of&#160;extensions&#160;available&#160;for&#160;this&#160;TLS&#160;connection.<br/>This&#160;is&#160;called&#160;by&#160;SSL_new&#160;()</p>
<p style="position:absolute;top:962px;left:137px;white-space:nowrap" class="ft8243"><b>Parameters:</b></p>
<p style="position:absolute;top:989px;left:137px;white-space:nowrap" class="ft8239"><i>s</i></p>
<p style="position:absolute;top:989px;left:145px;white-space:nowrap" class="ft8217">&#160;a&#160;pointer&#160;to&#160;a&#160;SSL&#160;object&#160;</p>
<p style="position:absolute;top:1035px;left:83px;white-space:nowrap" class="ft8236"><i><b>9.1.2&#160;&#160;&#160;Core</b></i></p>
<p style="position:absolute;top:1065px;left:83px;white-space:nowrap" class="ft8241"><b>void SSL_TLSEXT_GENERAL_free (TLSEXT_GENERAL * e)</b></p>
<p style="position:absolute;top:1084px;left:137px;white-space:nowrap" class="ft8217">Destructor&#160;of&#160;a&#160;TLSEXT_GENERAL&#160;object.&#160;It&#160;is&#160;called&#160;by&#160;the&#160;stack&#160;destructor.</p>
<p style="position:absolute;top:1112px;left:83px;white-space:nowrap" class="ft8241"><b>void SSL_SUPP_DATA_ENTRY_free (SUPP_DATA_ENTRY * sd)</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft8221">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft8221">53/61</p>
</div>
<!-- Page 83 -->
<a name="83"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page83-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3083.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft839">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft830">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft8321">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft8321">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft8317">Destructor&#160;of&#160;a&#160;SUPP_DATA_ENTRY&#160;object.&#160;It&#160;is&#160;called&#160;by&#160;the&#160;stack&#160;destructor.</p>
<p style="position:absolute;top:195px;left:83px;white-space:nowrap" class="ft8336"><i><b>9.1.3&#160;&#160;&#160;Interface</b></i></p>
<p style="position:absolute;top:225px;left:83px;white-space:nowrap" class="ft8317">These&#160;functions&#160;are&#160;detailed&#160;in&#160;Section&#160;3.2.1.</p>
<p style="position:absolute;top:271px;left:83px;white-space:nowrap" class="ft8336"><i><b>9.1.4&#160;&#160;&#160;Application&#160;Interface</b></i></p>
<p style="position:absolute;top:301px;left:83px;white-space:nowrap" class="ft8317">These&#160;functions&#160;are&#160;detailed&#160;in&#160;Section&#160;3.2.2.</p>
<p style="position:absolute;top:347px;left:83px;white-space:nowrap" class="ft8334"><i><b>9.2&#160;&#160;&#160;Direct&#160;Anonymous&#160;Attestation</b></i></p>
<p style="position:absolute;top:397px;left:83px;white-space:nowrap" class="ft8336"><i><b>9.2.1&#160;&#160;&#160;Implementation</b></i></p>
<p style="position:absolute;top:427px;left:83px;white-space:nowrap" class="ft8341"><b>DAA_SIG* daa1_sig_new (void)</b></p>
<p style="position:absolute;top:445px;left:137px;white-space:nowrap" class="ft8325">DAA_SIG&#160;constructor&#160;for&#160;OpenSSL&#160;DAA-1&#160;method.<br/>Relies&#160;on&#160;DAA1_SIG_new().</p>
<p style="position:absolute;top:502px;left:137px;white-space:nowrap" class="ft8343"><b>Returns:</b></p>
<p style="position:absolute;top:530px;left:137px;white-space:nowrap" class="ft8317">Pointer&#160;to&#160;a&#160;new&#160;DAA_SIG&#160;structure.&#160;</p>
<p style="position:absolute;top:558px;left:83px;white-space:nowrap" class="ft8341"><b>void daa1_sig_free (DAA_SIG *&#160;</b></p>
<p style="position:absolute;top:558px;left:380px;white-space:nowrap" class="ft8342"><i><b>daa</b></i></p>
<p style="position:absolute;top:558px;left:410px;white-space:nowrap" class="ft8341"><b>)</b></p>
<p style="position:absolute;top:577px;left:137px;white-space:nowrap" class="ft8325">DAA_SIG&#160;destructor&#160;for&#160;OpenSSL&#160;DAA-1&#160;method.<br/>Relies&#160;on&#160;DAA1_SIG_free().</p>
<p style="position:absolute;top:634px;left:137px;white-space:nowrap" class="ft8343"><b>Parameters:</b></p>
<p style="position:absolute;top:661px;left:137px;white-space:nowrap" class="ft8339"><i>daa</i></p>
<p style="position:absolute;top:661px;left:167px;white-space:nowrap" class="ft8317">&#160;Pointer&#160;to&#160;the&#160;DAA_SIG&#160;structure.&#160;</p>
<p style="position:absolute;top:689px;left:83px;white-space:nowrap" class="ft8341"><b>DAA_SIG* d2i_daa1_sig (DAA_SIG **&#160;</b></p>
<p style="position:absolute;top:689px;left:420px;white-space:nowrap" class="ft8342"><i><b>a</b></i></p>
<p style="position:absolute;top:689px;left:430px;white-space:nowrap" class="ft8341"><b>, &#160; const unsigned char **&#160;</b></p>
<p style="position:absolute;top:689px;left:697px;white-space:nowrap" class="ft8342"><i><b>in</b></i></p>
<p style="position:absolute;top:689px;left:717px;white-space:nowrap" class="ft8341"><b>, &#160; long&#160;</b></p>
<p style="position:absolute;top:708px;left:83px;white-space:nowrap" class="ft8342"><i><b>len</b></i></p>
<p style="position:absolute;top:708px;left:113px;white-space:nowrap" class="ft8341"><b>)</b></p>
<p style="position:absolute;top:726px;left:137px;white-space:nowrap" class="ft8325">DAA_SIG&#160;deserialization&#160;for&#160;OpenSSL&#160;DAA-1&#160;method:&#160;reads&#160;a&#160;DAA_SIG&#160;from&#160;a&#160;<br/>buffer.<br/>Relies&#160;on&#160;d2i_DAA1_SIG().</p>
<p style="position:absolute;top:803px;left:137px;white-space:nowrap" class="ft8343"><b>Parameters:</b></p>
<p style="position:absolute;top:830px;left:137px;white-space:nowrap" class="ft8339"><i>a</i></p>
<p style="position:absolute;top:830px;left:147px;white-space:nowrap" class="ft8317">&#160;Pointer&#160;to&#160;the&#160;DAA_SIG&#160;structure.&#160;</p>
<p style="position:absolute;top:858px;left:137px;white-space:nowrap" class="ft8339"><i>in</i></p>
<p style="position:absolute;top:858px;left:152px;white-space:nowrap" class="ft8317">&#160;Pointer&#160;to&#160;the&#160;buffer.&#160;</p>
<p style="position:absolute;top:886px;left:137px;white-space:nowrap" class="ft8339"><i>len</i></p>
<p style="position:absolute;top:886px;left:162px;white-space:nowrap" class="ft8317">&#160;Buffer&#160;length.&#160;</p>
<p style="position:absolute;top:915px;left:137px;white-space:nowrap" class="ft8343"><b>Returns:</b></p>
<p style="position:absolute;top:943px;left:137px;white-space:nowrap" class="ft8317">Pointer&#160;to&#160;the&#160;DAA_SIG&#160;structure.&#160;</p>
<p style="position:absolute;top:971px;left:83px;white-space:nowrap" class="ft8341"><b>int i2d_daa1_sig (const DAA_SIG *&#160;</b></p>
<p style="position:absolute;top:971px;left:420px;white-space:nowrap" class="ft8342"><i><b>a</b></i></p>
<p style="position:absolute;top:971px;left:430px;white-space:nowrap" class="ft8341"><b>, &#160; unsigned char **&#160;</b></p>
<p style="position:absolute;top:971px;left:638px;white-space:nowrap" class="ft8342"><i><b>out</b></i></p>
<p style="position:absolute;top:971px;left:668px;white-space:nowrap" class="ft8341"><b>)</b></p>
<p style="position:absolute;top:990px;left:137px;white-space:nowrap" class="ft8325">DAA_SIG&#160;serialization&#160;for&#160;OpenSSL&#160;DAA-1&#160;method:&#160;converts&#160;a&#160;DAA_SIG&#160;to&#160;a&#160;<br/>buffer.<br/>Relies&#160;on&#160;i2d_DAA1_SIG().</p>
<p style="position:absolute;top:1066px;left:137px;white-space:nowrap" class="ft8343"><b>Parameters:</b></p>
<p style="position:absolute;top:1093px;left:137px;white-space:nowrap" class="ft8339"><i>a</i></p>
<p style="position:absolute;top:1093px;left:147px;white-space:nowrap" class="ft8317">&#160;Pointer&#160;to&#160;the&#160;DAA_SIG&#160;structure.&#160;</p>
<p style="position:absolute;top:1121px;left:137px;white-space:nowrap" class="ft8339"><i>out</i></p>
<p style="position:absolute;top:1121px;left:164px;white-space:nowrap" class="ft8317">&#160;Pointer&#160;to&#160;the&#160;buffer.&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft8321">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft8321">54/61</p>
</div>
<!-- Page 84 -->
<a name="84"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page84-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3084.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft849">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft840">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft8421">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft8421">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:150px;left:137px;white-space:nowrap" class="ft8443"><b>Returns:</b></p>
<p style="position:absolute;top:177px;left:137px;white-space:nowrap" class="ft8417">The&#160;buffer&#160;length.&#160;</p>
<p style="position:absolute;top:205px;left:83px;white-space:nowrap" class="ft8441"><b>int daa1_sig_size (const DAA *&#160;</b></p>
<p style="position:absolute;top:205px;left:390px;white-space:nowrap" class="ft8442"><i><b>daa</b></i></p>
<p style="position:absolute;top:205px;left:420px;white-space:nowrap" class="ft8441"><b>)</b></p>
<p style="position:absolute;top:224px;left:137px;white-space:nowrap" class="ft8419">DAA_SIG&#160;size&#160;for&#160;OpenSSL&#160;DAA-1&#160;method.<br/>Returns&#160;an&#160;upper&#160;bound&#160;to&#160;the&#160;DAA_SIG&#160;size.&#160;Useful&#160;to&#160;allocate&#160;a&#160;buffer&#160;that&#160;will&#160;<br/>contains&#160;a&#160;signature,&#160;without&#160;knowing&#160;in&#160;advantage&#160;what&#160;the&#160;signature&#160;will&#160;be.</p>
<p style="position:absolute;top:300px;left:137px;white-space:nowrap" class="ft8443"><b>Parameters:</b></p>
<p style="position:absolute;top:328px;left:137px;white-space:nowrap" class="ft8439"><i>daa</i></p>
<p style="position:absolute;top:328px;left:167px;white-space:nowrap" class="ft8417">&#160;Pointer&#160;to&#160;the&#160;DAA&#160;structure.&#160;</p>
<p style="position:absolute;top:356px;left:137px;white-space:nowrap" class="ft8443"><b>Returns:</b></p>
<p style="position:absolute;top:384px;left:137px;white-space:nowrap" class="ft8417">The&#160;DAA_SIG&#160;size.&#160;</p>
<p style="position:absolute;top:412px;left:83px;white-space:nowrap" class="ft8441"><b>DAA_SIG* daa3_sig_new (void)</b></p>
<p style="position:absolute;top:431px;left:137px;white-space:nowrap" class="ft8425">DAA_SIG&#160;constructor&#160;for&#160;OpenSSL&#160;DAA-3&#160;method.<br/>Relies&#160;on&#160;DAA3_SIG_new().</p>
<p style="position:absolute;top:488px;left:137px;white-space:nowrap" class="ft8443"><b>Returns:</b></p>
<p style="position:absolute;top:515px;left:137px;white-space:nowrap" class="ft8417">Pointer&#160;to&#160;a&#160;new&#160;DAA_SIG&#160;structure.&#160;</p>
<p style="position:absolute;top:543px;left:83px;white-space:nowrap" class="ft8441"><b>void daa3_sig_free (DAA_SIG *&#160;</b></p>
<p style="position:absolute;top:543px;left:380px;white-space:nowrap" class="ft8442"><i><b>daa</b></i></p>
<p style="position:absolute;top:543px;left:410px;white-space:nowrap" class="ft8441"><b>)</b></p>
<p style="position:absolute;top:562px;left:137px;white-space:nowrap" class="ft8425">DAA_SIG&#160;destructor&#160;for&#160;OpenSSL&#160;DAA-3&#160;method.<br/>Relies&#160;on&#160;DAA3_SIG_free().</p>
<p style="position:absolute;top:619px;left:137px;white-space:nowrap" class="ft8443"><b>Parameters:</b></p>
<p style="position:absolute;top:646px;left:137px;white-space:nowrap" class="ft8439"><i>daa</i></p>
<p style="position:absolute;top:646px;left:167px;white-space:nowrap" class="ft8417">&#160;Pointer&#160;to&#160;the&#160;DAA_SIG&#160;structure.&#160;</p>
<p style="position:absolute;top:674px;left:83px;white-space:nowrap" class="ft8441"><b>DAA_SIG* d2i_daa3_sig (DAA_SIG **&#160;</b></p>
<p style="position:absolute;top:674px;left:420px;white-space:nowrap" class="ft8442"><i><b>a</b></i></p>
<p style="position:absolute;top:674px;left:430px;white-space:nowrap" class="ft8441"><b>, &#160; const unsigned char **&#160;</b></p>
<p style="position:absolute;top:674px;left:697px;white-space:nowrap" class="ft8442"><i><b>in</b></i></p>
<p style="position:absolute;top:674px;left:717px;white-space:nowrap" class="ft8441"><b>, &#160; long&#160;</b></p>
<p style="position:absolute;top:693px;left:83px;white-space:nowrap" class="ft8442"><i><b>len</b></i></p>
<p style="position:absolute;top:693px;left:113px;white-space:nowrap" class="ft8441"><b>)</b></p>
<p style="position:absolute;top:712px;left:137px;white-space:nowrap" class="ft8425">DAA_SIG&#160;deserialization&#160;for&#160;OpenSSL&#160;DAA-3&#160;method:&#160;reads&#160;a&#160;DAA_SIG&#160;from&#160;a&#160;<br/>buffer.<br/>Relies&#160;on&#160;d2i_DAA3_SIG().</p>
<p style="position:absolute;top:788px;left:137px;white-space:nowrap" class="ft8443"><b>Parameters:</b></p>
<p style="position:absolute;top:815px;left:137px;white-space:nowrap" class="ft8439"><i>a</i></p>
<p style="position:absolute;top:815px;left:147px;white-space:nowrap" class="ft8417">&#160;Pointer&#160;to&#160;the&#160;DAA_SIG&#160;structure.&#160;</p>
<p style="position:absolute;top:844px;left:137px;white-space:nowrap" class="ft8439"><i>in</i></p>
<p style="position:absolute;top:844px;left:152px;white-space:nowrap" class="ft8417">&#160;Pointer&#160;to&#160;the&#160;buffer.&#160;</p>
<p style="position:absolute;top:872px;left:137px;white-space:nowrap" class="ft8439"><i>len</i></p>
<p style="position:absolute;top:872px;left:162px;white-space:nowrap" class="ft8417">&#160;Buffer&#160;length.&#160;</p>
<p style="position:absolute;top:901px;left:137px;white-space:nowrap" class="ft8443"><b>Returns:</b></p>
<p style="position:absolute;top:928px;left:137px;white-space:nowrap" class="ft8417">Pointer&#160;to&#160;the&#160;DAA_SIG&#160;structure.&#160;</p>
<p style="position:absolute;top:956px;left:83px;white-space:nowrap" class="ft8441"><b>int i2d_daa3_sig (const DAA_SIG *&#160;</b></p>
<p style="position:absolute;top:956px;left:420px;white-space:nowrap" class="ft8442"><i><b>a</b></i></p>
<p style="position:absolute;top:956px;left:430px;white-space:nowrap" class="ft8441"><b>, &#160; unsigned char **&#160;</b></p>
<p style="position:absolute;top:956px;left:638px;white-space:nowrap" class="ft8442"><i><b>out</b></i></p>
<p style="position:absolute;top:956px;left:668px;white-space:nowrap" class="ft8441"><b>)</b></p>
<p style="position:absolute;top:975px;left:137px;white-space:nowrap" class="ft8425">DAA_SIG&#160;serialization&#160;for&#160;OpenSSL&#160;DAA-3&#160;method:&#160;converts&#160;a&#160;DAA_SIG&#160;to&#160;a&#160;<br/>buffer.<br/>Relies&#160;on&#160;i2d_DAA3_SIG().</p>
<p style="position:absolute;top:1051px;left:137px;white-space:nowrap" class="ft8443"><b>Parameters:</b></p>
<p style="position:absolute;top:1078px;left:137px;white-space:nowrap" class="ft8439"><i>a</i></p>
<p style="position:absolute;top:1078px;left:147px;white-space:nowrap" class="ft8417">&#160;Pointer&#160;to&#160;the&#160;DAA_SIG&#160;structure.&#160;</p>
<p style="position:absolute;top:1107px;left:137px;white-space:nowrap" class="ft8439"><i>out</i></p>
<p style="position:absolute;top:1107px;left:164px;white-space:nowrap" class="ft8417">&#160;Pointer&#160;to&#160;the&#160;buffer.&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft8421">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft8421">55/61</p>
</div>
<!-- Page 85 -->
<a name="85"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page85-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3085.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft859">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft850">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft8521">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft8521">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:150px;left:137px;white-space:nowrap" class="ft8543"><b>Returns:</b></p>
<p style="position:absolute;top:177px;left:137px;white-space:nowrap" class="ft8517">The&#160;buffer&#160;length.&#160;</p>
<p style="position:absolute;top:205px;left:83px;white-space:nowrap" class="ft8541"><b>int daa3_sig_size (const DAA *&#160;</b></p>
<p style="position:absolute;top:205px;left:390px;white-space:nowrap" class="ft8542"><i><b>daa</b></i></p>
<p style="position:absolute;top:205px;left:420px;white-space:nowrap" class="ft8541"><b>)</b></p>
<p style="position:absolute;top:224px;left:137px;white-space:nowrap" class="ft8519">DAA_SIG&#160;size&#160;for&#160;OpenSSL&#160;DAA-3&#160;method.<br/>Returns&#160;an&#160;upper&#160;bound&#160;to&#160;the&#160;DAA_SIG&#160;size.&#160;Useful&#160;to&#160;allocate&#160;a&#160;buffer&#160;that&#160;will&#160;<br/>contains&#160;a&#160;signature,&#160;without&#160;knowing&#160;in&#160;advantage&#160;what&#160;the&#160;signature&#160;will&#160;be.</p>
<p style="position:absolute;top:300px;left:137px;white-space:nowrap" class="ft8543"><b>Parameters:</b></p>
<p style="position:absolute;top:328px;left:137px;white-space:nowrap" class="ft8539"><i>daa</i></p>
<p style="position:absolute;top:328px;left:167px;white-space:nowrap" class="ft8517">&#160;Pointer&#160;to&#160;the&#160;DAA&#160;structure.&#160;</p>
<p style="position:absolute;top:356px;left:137px;white-space:nowrap" class="ft8543"><b>Returns:</b></p>
<p style="position:absolute;top:384px;left:137px;white-space:nowrap" class="ft8517">The&#160;DAA_SIG&#160;size.&#160;</p>
<p style="position:absolute;top:412px;left:83px;white-space:nowrap" class="ft8541"><b>int daa3_sign_verifier_init (int *&#160;</b></p>
<p style="position:absolute;top:412px;left:430px;white-space:nowrap" class="ft8542"><i><b>nonce_len</b></i></p>
<p style="position:absolute;top:412px;left:519px;white-space:nowrap" class="ft8541"><b>, &#160; unsigned char **&#160;</b></p>
<p style="position:absolute;top:412px;left:727px;white-space:nowrap" class="ft8542"><i><b>nonce</b></i></p>
<p style="position:absolute;top:412px;left:776px;white-space:nowrap" class="ft8541"><b>,&#160;</b></p>
<p style="position:absolute;top:431px;left:83px;white-space:nowrap" class="ft8541"><b>int *&#160;</b></p>
<p style="position:absolute;top:431px;left:143px;white-space:nowrap" class="ft8542"><i><b>basename_len</b></i></p>
<p style="position:absolute;top:431px;left:262px;white-space:nowrap" class="ft8541"><b>, &#160; unsigned char **&#160;</b></p>
<p style="position:absolute;top:431px;left:470px;white-space:nowrap" class="ft8542"><i><b>basename</b></i></p>
<p style="position:absolute;top:431px;left:549px;white-space:nowrap" class="ft8541"><b>, &#160; DAA *&#160;</b></p>
<p style="position:absolute;top:431px;left:648px;white-space:nowrap" class="ft8542"><i><b>daa</b></i></p>
<p style="position:absolute;top:431px;left:677px;white-space:nowrap" class="ft8541"><b>)</b></p>
<p style="position:absolute;top:449px;left:137px;white-space:nowrap" class="ft8525">The&#160;DAA&#160;Verifier&#160;initializes&#160;her&#160;nonce&#160;and&#160;basename.<br/>The&#160;basename&#160;can&#160;be&#160;NULL&#160;(and&#160;its&#160;length&#160;0),&#160;which&#160;means&#160;that&#160;no&#160;Verifier's&#160;<br/>basename&#160;is&#160;needed.<br/>This&#160;fake&#160;implementation&#160;output&#160;fixed&#160;nonce&#160;and&#160;basename.</p>
<p style="position:absolute;top:554px;left:137px;white-space:nowrap" class="ft8543"><b>Parameters:</b></p>
<p style="position:absolute;top:581px;left:137px;white-space:nowrap" class="ft8539"><i>nonce_len</i></p>
<p style="position:absolute;top:581px;left:220px;white-space:nowrap" class="ft8517">&#160;Pointer&#160;to&#160;the&#160;nonce&#160;length&#160;</p>
<p style="position:absolute;top:609px;left:137px;white-space:nowrap" class="ft8539"><i>nonce</i></p>
<p style="position:absolute;top:609px;left:187px;white-space:nowrap" class="ft8517">&#160;Pointer&#160;to&#160;the&#160;nonce&#160;buffer&#160;</p>
<p style="position:absolute;top:637px;left:137px;white-space:nowrap" class="ft8539"><i>basename_len</i></p>
<p style="position:absolute;top:637px;left:256px;white-space:nowrap" class="ft8517">&#160;Pointer&#160;to&#160;the&#160;basename&#160;length&#160;</p>
<p style="position:absolute;top:666px;left:137px;white-space:nowrap" class="ft8539"><i>basename</i></p>
<p style="position:absolute;top:666px;left:223px;white-space:nowrap" class="ft8517">&#160;Pointer&#160;to&#160;the&#160;basename&#160;buffer&#160;</p>
<p style="position:absolute;top:694px;left:137px;white-space:nowrap" class="ft8539"><i>daa</i></p>
<p style="position:absolute;top:694px;left:167px;white-space:nowrap" class="ft8517">&#160;DAA&#160;structure&#160;reference&#160;</p>
<p style="position:absolute;top:723px;left:137px;white-space:nowrap" class="ft8543"><b>Returns:</b></p>
<p style="position:absolute;top:750px;left:137px;white-space:nowrap" class="ft8525">0&#160;in&#160;case&#160;of&#160;success&#160;<br/>1&#160;in&#160;case&#160;of&#160;error&#160;</p>
<p style="position:absolute;top:806px;left:83px;white-space:nowrap" class="ft8541"><b>DAA_SIG* daafake_sig_new (void)</b></p>
<p style="position:absolute;top:825px;left:137px;white-space:nowrap" class="ft8525">DAA_SIG&#160;constructor&#160;for&#160;OpenSSL&#160;DAA-FAKE&#160;method.<br/>Relies&#160;on&#160;DAAFAKE_SIG_new().</p>
<p style="position:absolute;top:882px;left:137px;white-space:nowrap" class="ft8543"><b>Returns:</b></p>
<p style="position:absolute;top:910px;left:137px;white-space:nowrap" class="ft8517">Pointer&#160;to&#160;a&#160;new&#160;DAA_SIG&#160;structure.&#160;</p>
<p style="position:absolute;top:938px;left:137px;white-space:nowrap" class="ft8541"><b>void daafake_sig_free (DAA_SIG *&#160;</b></p>
<p style="position:absolute;top:938px;left:463px;white-space:nowrap" class="ft8542"><i><b>daa</b></i></p>
<p style="position:absolute;top:938px;left:493px;white-space:nowrap" class="ft8541"><b>)</b></p>
<p style="position:absolute;top:956px;left:137px;white-space:nowrap" class="ft8525">DAA_SIG&#160;destructor&#160;for&#160;OpenSSL&#160;DAA-FAKE&#160;method.<br/>Relies&#160;on&#160;DAAFAKE_SIG_free().</p>
<p style="position:absolute;top:1013px;left:137px;white-space:nowrap" class="ft8543"><b>Parameters:</b></p>
<p style="position:absolute;top:1041px;left:137px;white-space:nowrap" class="ft8539"><i>daa</i></p>
<p style="position:absolute;top:1041px;left:167px;white-space:nowrap" class="ft8517">&#160;Pointer&#160;to&#160;the&#160;DAA_SIG&#160;structure.&#160;</p>
<p style="position:absolute;top:1069px;left:83px;white-space:nowrap" class="ft8541"><b>DAA_SIG* d2i_daafake_sig (DAA_SIG **&#160;</b></p>
<p style="position:absolute;top:1069px;left:450px;white-space:nowrap" class="ft8542"><i><b>a</b></i></p>
<p style="position:absolute;top:1069px;left:460px;white-space:nowrap" class="ft8541"><b>, &#160; const unsigned char **&#160;</b></p>
<p style="position:absolute;top:1069px;left:727px;white-space:nowrap" class="ft8542"><i><b>in</b></i></p>
<p style="position:absolute;top:1069px;left:747px;white-space:nowrap" class="ft8541"><b>,&#160;</b></p>
<p style="position:absolute;top:1088px;left:83px;white-space:nowrap" class="ft8541"><b>long&#160;</b></p>
<p style="position:absolute;top:1088px;left:133px;white-space:nowrap" class="ft8542"><i><b>len</b></i></p>
<p style="position:absolute;top:1088px;left:163px;white-space:nowrap" class="ft8541"><b>)</b></p>
<p style="position:absolute;top:1106px;left:137px;white-space:nowrap" class="ft8517">DAA_SIG&#160;deserialization&#160;for&#160;OpenSSL&#160;DAA-FAKE&#160;method:&#160;reads&#160;a&#160;DAA_SIG&#160;from&#160;a&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft8521">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft8521">56/61</p>
</div>
<!-- Page 86 -->
<a name="86"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page86-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3086.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft869">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft860">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft8621">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft8621">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft8625">buffer.<br/>Relies&#160;on&#160;d2i_DAAFAKE_SIG().</p>
<p style="position:absolute;top:206px;left:137px;white-space:nowrap" class="ft8643"><b>Parameters:</b></p>
<p style="position:absolute;top:234px;left:137px;white-space:nowrap" class="ft8639"><i>a</i></p>
<p style="position:absolute;top:234px;left:147px;white-space:nowrap" class="ft8617">&#160;Pointer&#160;to&#160;the&#160;DAA_SIG&#160;structure.&#160;</p>
<p style="position:absolute;top:262px;left:137px;white-space:nowrap" class="ft8639"><i>in</i></p>
<p style="position:absolute;top:262px;left:152px;white-space:nowrap" class="ft8617">&#160;Pointer&#160;to&#160;the&#160;buffer.&#160;</p>
<p style="position:absolute;top:290px;left:137px;white-space:nowrap" class="ft8639"><i>len</i></p>
<p style="position:absolute;top:290px;left:162px;white-space:nowrap" class="ft8617">&#160;Buffer&#160;length.&#160;</p>
<p style="position:absolute;top:319px;left:137px;white-space:nowrap" class="ft8643"><b>Returns:</b></p>
<p style="position:absolute;top:346px;left:137px;white-space:nowrap" class="ft8617">Pointer&#160;to&#160;the&#160;DAA_SIG&#160;structure.&#160;</p>
<p style="position:absolute;top:374px;left:83px;white-space:nowrap" class="ft8641"><b>int i2d_daafake_sig (const DAA_SIG *&#160;</b></p>
<p style="position:absolute;top:374px;left:450px;white-space:nowrap" class="ft8642"><i><b>a</b></i></p>
<p style="position:absolute;top:374px;left:460px;white-space:nowrap" class="ft8641"><b>, &#160; unsigned char **&#160;</b></p>
<p style="position:absolute;top:374px;left:668px;white-space:nowrap" class="ft8642"><i><b>out</b></i></p>
<p style="position:absolute;top:374px;left:697px;white-space:nowrap" class="ft8641"><b>)</b></p>
<p style="position:absolute;top:393px;left:137px;white-space:nowrap" class="ft8625">DAA_SIG&#160;serialization&#160;for&#160;OpenSSL&#160;DAA-FAKE&#160;method:&#160;converts&#160;a&#160;DAA_SIG&#160;to&#160;a&#160;<br/>buffer.<br/>Relies&#160;on&#160;i2d_DAAFAKE_SIG().</p>
<p style="position:absolute;top:469px;left:137px;white-space:nowrap" class="ft8643"><b>Parameters:</b></p>
<p style="position:absolute;top:497px;left:137px;white-space:nowrap" class="ft8639"><i>a</i></p>
<p style="position:absolute;top:497px;left:147px;white-space:nowrap" class="ft8617">&#160;Pointer&#160;to&#160;the&#160;DAA_SIG&#160;structure.&#160;</p>
<p style="position:absolute;top:525px;left:137px;white-space:nowrap" class="ft8639"><i>out</i></p>
<p style="position:absolute;top:525px;left:164px;white-space:nowrap" class="ft8617">&#160;Pointer&#160;to&#160;the&#160;buffer.&#160;</p>
<p style="position:absolute;top:554px;left:137px;white-space:nowrap" class="ft8643"><b>Returns:</b></p>
<p style="position:absolute;top:581px;left:137px;white-space:nowrap" class="ft8617">The&#160;buffer&#160;length.&#160;</p>
<p style="position:absolute;top:609px;left:83px;white-space:nowrap" class="ft8641"><b>int daafake_sig_size (const DAA *&#160;</b></p>
<p style="position:absolute;top:609px;left:420px;white-space:nowrap" class="ft8642"><i><b>daa</b></i></p>
<p style="position:absolute;top:609px;left:450px;white-space:nowrap" class="ft8641"><b>)</b></p>
<p style="position:absolute;top:628px;left:137px;white-space:nowrap" class="ft8619">DAA_SIG&#160;size&#160;for&#160;OpenSSL&#160;DAA-FAKE&#160;method.<br/>Returns&#160;an&#160;upper&#160;bound&#160;to&#160;the&#160;DAA_SIG&#160;size.&#160;Useful&#160;to&#160;allocate&#160;a&#160;buffer&#160;that&#160;will&#160;<br/>contains&#160;a&#160;signature,&#160;without&#160;knowing&#160;in&#160;advantage&#160;what&#160;the&#160;signature&#160;will&#160;be.</p>
<p style="position:absolute;top:704px;left:137px;white-space:nowrap" class="ft8643"><b>Parameters:</b></p>
<p style="position:absolute;top:731px;left:137px;white-space:nowrap" class="ft8639"><i>daa</i></p>
<p style="position:absolute;top:731px;left:167px;white-space:nowrap" class="ft8617">&#160;Pointer&#160;to&#160;the&#160;DAA&#160;structure.&#160;</p>
<p style="position:absolute;top:760px;left:137px;white-space:nowrap" class="ft8643"><b>Returns:</b></p>
<p style="position:absolute;top:788px;left:137px;white-space:nowrap" class="ft8617">The&#160;DAA_SIG&#160;size.&#160;</p>
<p style="position:absolute;top:816px;left:83px;white-space:nowrap" class="ft8641"><b>int daafake_sign_verifier_init (int *&#160;</b></p>
<p style="position:absolute;top:816px;left:460px;white-space:nowrap" class="ft8642"><i><b>nonce_len</b></i></p>
<p style="position:absolute;top:816px;left:549px;white-space:nowrap" class="ft8641"><b>, &#160; unsigned char **&#160;</b></p>
<p style="position:absolute;top:835px;left:83px;white-space:nowrap" class="ft8642"><i><b>nonce</b></i></p>
<p style="position:absolute;top:835px;left:133px;white-space:nowrap" class="ft8641"><b>, &#160; int *&#160;</b></p>
<p style="position:absolute;top:835px;left:232px;white-space:nowrap" class="ft8642"><i><b>basename_len</b></i></p>
<p style="position:absolute;top:835px;left:351px;white-space:nowrap" class="ft8641"><b>, &#160; unsigned char **&#160;</b></p>
<p style="position:absolute;top:835px;left:559px;white-space:nowrap" class="ft8642"><i><b>basename</b></i></p>
<p style="position:absolute;top:835px;left:638px;white-space:nowrap" class="ft8641"><b>, &#160; DAA *&#160;</b></p>
<p style="position:absolute;top:835px;left:737px;white-space:nowrap" class="ft8642"><i><b>daa</b></i></p>
<p style="position:absolute;top:835px;left:767px;white-space:nowrap" class="ft8641"><b>)</b></p>
<p style="position:absolute;top:853px;left:137px;white-space:nowrap" class="ft8625">The&#160;DAA&#160;Verifier&#160;initializes&#160;her&#160;nonce&#160;and&#160;basename.<br/>The&#160;basename&#160;can&#160;be&#160;NULL&#160;(and&#160;its&#160;length&#160;0),&#160;which&#160;means&#160;that&#160;no&#160;Verifier's&#160;<br/>basename&#160;is&#160;needed.<br/>This&#160;fake&#160;implementation&#160;output&#160;fixed&#160;nonce&#160;and&#160;basename.</p>
<p style="position:absolute;top:958px;left:137px;white-space:nowrap" class="ft8643"><b>Parameters:</b></p>
<p style="position:absolute;top:985px;left:137px;white-space:nowrap" class="ft8639"><i>nonce_len</i></p>
<p style="position:absolute;top:985px;left:220px;white-space:nowrap" class="ft8617">&#160;Pointer&#160;to&#160;the&#160;nonce&#160;length&#160;</p>
<p style="position:absolute;top:1013px;left:137px;white-space:nowrap" class="ft8639"><i>nonce</i></p>
<p style="position:absolute;top:1013px;left:187px;white-space:nowrap" class="ft8617">&#160;Pointer&#160;to&#160;the&#160;nonce&#160;buffer&#160;</p>
<p style="position:absolute;top:1041px;left:137px;white-space:nowrap" class="ft8639"><i>basename_len</i></p>
<p style="position:absolute;top:1041px;left:256px;white-space:nowrap" class="ft8617">&#160;Pointer&#160;to&#160;the&#160;basename&#160;length&#160;</p>
<p style="position:absolute;top:1069px;left:137px;white-space:nowrap" class="ft8639"><i>basename</i></p>
<p style="position:absolute;top:1069px;left:223px;white-space:nowrap" class="ft8617">&#160;Pointer&#160;to&#160;the&#160;basename&#160;buffer&#160;</p>
<p style="position:absolute;top:1098px;left:137px;white-space:nowrap" class="ft8639"><i>daa</i></p>
<p style="position:absolute;top:1098px;left:167px;white-space:nowrap" class="ft8617">&#160;DAA&#160;structure&#160;reference&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft8621">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft8621">57/61</p>
</div>
<!-- Page 87 -->
<a name="87"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page87-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3087.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft879">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft870">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft8721">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft8721">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:150px;left:137px;white-space:nowrap" class="ft8743"><b>Returns:</b></p>
<p style="position:absolute;top:177px;left:137px;white-space:nowrap" class="ft8725">0&#160;in&#160;case&#160;of&#160;success&#160;<br/>1&#160;in&#160;case&#160;of&#160;error&#160;</p>
<p style="position:absolute;top:234px;left:83px;white-space:nowrap" class="ft8741"><b>DAA_SIG* daafake_do_sign (const unsigned char *&#160;</b></p>
<p style="position:absolute;top:234px;left:559px;white-space:nowrap" class="ft8742"><i><b>dgst</b></i></p>
<p style="position:absolute;top:234px;left:598px;white-space:nowrap" class="ft8741"><b>, &#160; int&#160;</b></p>
<p style="position:absolute;top:234px;left:677px;white-space:nowrap" class="ft8742"><i><b>dgst_len</b></i></p>
<p style="position:absolute;top:234px;left:757px;white-space:nowrap" class="ft8741"><b>,&#160;</b></p>
<p style="position:absolute;top:252px;left:83px;white-space:nowrap" class="ft8741"><b>DAA *&#160;</b></p>
<p style="position:absolute;top:252px;left:143px;white-space:nowrap" class="ft8742"><i><b>daa</b></i></p>
<p style="position:absolute;top:252px;left:173px;white-space:nowrap" class="ft8741"><b>)</b></p>
<p style="position:absolute;top:271px;left:137px;white-space:nowrap" class="ft8719">Computes&#160;a&#160;DAA&#160;signature&#160;on&#160;a&#160;given&#160;digest.<br/>This&#160;fake&#160;implementation&#160;returns&#160;a&#160;BIGNUM&#160;containing&#160;the&#160;bitstream&#160;of&#160;the&#160;<br/>supplied&#160;digest.</p>
<p style="position:absolute;top:347px;left:137px;white-space:nowrap" class="ft8743"><b>Parameters:</b></p>
<p style="position:absolute;top:375px;left:137px;white-space:nowrap" class="ft8739"><i>dgst</i></p>
<p style="position:absolute;top:375px;left:173px;white-space:nowrap" class="ft8717">&#160;Digest&#160;to&#160;be&#160;signed&#160;</p>
<p style="position:absolute;top:403px;left:137px;white-space:nowrap" class="ft8739"><i>dgst_len</i></p>
<p style="position:absolute;top:403px;left:206px;white-space:nowrap" class="ft8717">&#160;Length&#160;of&#160;the&#160;digest&#160;</p>
<p style="position:absolute;top:431px;left:137px;white-space:nowrap" class="ft8739"><i>daa</i></p>
<p style="position:absolute;top:431px;left:167px;white-space:nowrap" class="ft8717">&#160;DAA&#160;structure&#160;reference&#160;</p>
<p style="position:absolute;top:460px;left:137px;white-space:nowrap" class="ft8743"><b>Returns:</b></p>
<p style="position:absolute;top:487px;left:137px;white-space:nowrap" class="ft8725">DAA&#160;signature&#160;on&#160;dgst&#160;(in&#160;OpenSSL&#160;format)&#160;<br/>NULL&#160;in&#160;case&#160;of&#160;error&#160;</p>
<p style="position:absolute;top:544px;left:83px;white-space:nowrap" class="ft8741"><b>int daafake_do_verify (const unsigned char *&#160;</b></p>
<p style="position:absolute;top:544px;left:529px;white-space:nowrap" class="ft8742"><i><b>dgst</b></i></p>
<p style="position:absolute;top:544px;left:569px;white-space:nowrap" class="ft8741"><b>, &#160; int&#160;</b></p>
<p style="position:absolute;top:544px;left:648px;white-space:nowrap" class="ft8742"><i><b>dgst_len</b></i></p>
<p style="position:absolute;top:544px;left:727px;white-space:nowrap" class="ft8741"><b>,&#160;</b></p>
<p style="position:absolute;top:562px;left:83px;white-space:nowrap" class="ft8741"><b>const DAA_SIG *&#160;</b></p>
<p style="position:absolute;top:562px;left:242px;white-space:nowrap" class="ft8742"><i><b>daasig</b></i></p>
<p style="position:absolute;top:562px;left:301px;white-space:nowrap" class="ft8741"><b>, &#160; DAA *&#160;</b></p>
<p style="position:absolute;top:562px;left:400px;white-space:nowrap" class="ft8742"><i><b>daa</b></i></p>
<p style="position:absolute;top:562px;left:430px;white-space:nowrap" class="ft8741"><b>)</b></p>
<p style="position:absolute;top:581px;left:137px;white-space:nowrap" class="ft8725">Verifies&#160;a&#160;DAA&#160;signature.<br/>This&#160;fake&#160;implementation&#160;checks&#160;whether&#160;the&#160;signature&#160;and&#160;digest&#160;are&#160;equal.</p>
<p style="position:absolute;top:638px;left:137px;white-space:nowrap" class="ft8743"><b>Parameters:</b></p>
<p style="position:absolute;top:665px;left:137px;white-space:nowrap" class="ft8739"><i>dgst</i></p>
<p style="position:absolute;top:665px;left:173px;white-space:nowrap" class="ft8717">&#160;Digest&#160;to&#160;be&#160;signed&#160;</p>
<p style="position:absolute;top:693px;left:137px;white-space:nowrap" class="ft8739"><i>dgst_len</i></p>
<p style="position:absolute;top:693px;left:206px;white-space:nowrap" class="ft8717">&#160;Length&#160;of&#160;the&#160;digest&#160;</p>
<p style="position:absolute;top:722px;left:137px;white-space:nowrap" class="ft8739"><i>daasig</i></p>
<p style="position:absolute;top:722px;left:191px;white-space:nowrap" class="ft8717">&#160;DAA&#160;signature&#160;</p>
<p style="position:absolute;top:750px;left:137px;white-space:nowrap" class="ft8739"><i>daa</i></p>
<p style="position:absolute;top:750px;left:167px;white-space:nowrap" class="ft8717">&#160;DAA&#160;structure&#160;reference&#160;</p>
<p style="position:absolute;top:779px;left:137px;white-space:nowrap" class="ft8743"><b>Returns:</b></p>
<p style="position:absolute;top:806px;left:137px;white-space:nowrap" class="ft8725">1&#160;f&#160;the&#160;signature&#160;is&#160;correct&#160;<br/>0&#160;if&#160;the&#160;verification&#160;failed&#160;</p>
<p style="position:absolute;top:862px;left:83px;white-space:nowrap" class="ft8741"><b>const DAA_METHOD* DAA_OpenSSL (void)</b></p>
<p style="position:absolute;top:881px;left:137px;white-space:nowrap" class="ft8717">Returns&#160;DAAFAKE&#160;as&#160;the&#160;default&#160;OpenSSL&#160;DAA&#160;method.&#160;</p>
<p style="position:absolute;top:927px;left:83px;white-space:nowrap" class="ft8736"><i><b>9.2.2&#160;&#160;&#160;Method&#160;Interface</b></i></p>
<p style="position:absolute;top:957px;left:83px;white-space:nowrap" class="ft8741"><b>DAA* DAA_new_method (ENGINE *&#160;</b></p>
<p style="position:absolute;top:957px;left:380px;white-space:nowrap" class="ft8742"><i><b>engine</b></i></p>
<p style="position:absolute;top:957px;left:440px;white-space:nowrap" class="ft8741"><b>)</b></p>
<p style="position:absolute;top:976px;left:137px;white-space:nowrap" class="ft8717">Returns&#160;a&#160;new&#160;DAA&#160;structure,&#160;possibly&#160;from&#160;a&#160;supplied&#160;engine.&#160;</p>
<p style="position:absolute;top:1004px;left:137px;white-space:nowrap" class="ft8743"><b>Parameters:</b></p>
<p style="position:absolute;top:1032px;left:137px;white-space:nowrap" class="ft8739"><i>engine</i></p>
<p style="position:absolute;top:1032px;left:193px;white-space:nowrap" class="ft8717">&#160;Pointer&#160;to&#160;the&#160;engine&#160;supporting&#160;DAA,&#160;or&#160;NULL&#160;</p>
<p style="position:absolute;top:1061px;left:137px;white-space:nowrap" class="ft8743"><b>Returns:</b></p>
<p style="position:absolute;top:1088px;left:137px;white-space:nowrap" class="ft8717">Pointer&#160;to&#160;the&#160;new&#160;DAA&#160;structure&#160;</p>
<p style="position:absolute;top:1116px;left:83px;white-space:nowrap" class="ft8741"><b>int DAA_set_method (DAA *&#160;</b></p>
<p style="position:absolute;top:1116px;left:341px;white-space:nowrap" class="ft8742"><i><b>daa</b></i></p>
<p style="position:absolute;top:1116px;left:371px;white-space:nowrap" class="ft8741"><b>, &#160; const DAA_METHOD *&#160;</b></p>
<p style="position:absolute;top:1116px;left:598px;white-space:nowrap" class="ft8742"><i><b>meth</b></i></p>
<p style="position:absolute;top:1116px;left:638px;white-space:nowrap" class="ft8741"><b>)</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft8721">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft8721">58/61</p>
</div>
<!-- Page 88 -->
<a name="88"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page88-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3088.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft889">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft880">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft8821">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft8821">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft8817">Associates&#160;the&#160;supplied&#160;DAA&#160;structure&#160;with&#160;the&#160;supplied&#160;DAA&#160;method.&#160;</p>
<p style="position:absolute;top:178px;left:137px;white-space:nowrap" class="ft8843"><b>Parameters:</b></p>
<p style="position:absolute;top:205px;left:137px;white-space:nowrap" class="ft8839"><i>daa</i></p>
<p style="position:absolute;top:205px;left:167px;white-space:nowrap" class="ft8817">&#160;Pointer&#160;to&#160;the&#160;DAA&#160;structure&#160;</p>
<p style="position:absolute;top:234px;left:137px;white-space:nowrap" class="ft8839"><i>meth</i></p>
<p style="position:absolute;top:234px;left:180px;white-space:nowrap" class="ft8817">&#160;Pointer&#160;to&#160;the&#160;DAA_METHOD&#160;structure&#160;</p>
<p style="position:absolute;top:262px;left:137px;white-space:nowrap" class="ft8843"><b>Returns:</b></p>
<p style="position:absolute;top:290px;left:137px;white-space:nowrap" class="ft8817">1&#160;in&#160;case&#160;of&#160;success&#160;</p>
<p style="position:absolute;top:318px;left:83px;white-space:nowrap" class="ft8841"><b>const DAA_METHOD* DAA_get_default_method (void)</b></p>
<p style="position:absolute;top:337px;left:137px;white-space:nowrap" class="ft8817">Gets&#160;the&#160;default&#160;DAA&#160;method.&#160;</p>
<p style="position:absolute;top:365px;left:137px;white-space:nowrap" class="ft8843"><b>Returns:</b></p>
<p style="position:absolute;top:393px;left:137px;white-space:nowrap" class="ft8817">Pointer&#160;to&#160;the&#160;default&#160;DAA_METHOD&#160;structure&#160;</p>
<p style="position:absolute;top:421px;left:83px;white-space:nowrap" class="ft8841"><b>void DAA_set_default_method (const DAA_METHOD *&#160;</b></p>
<p style="position:absolute;top:421px;left:559px;white-space:nowrap" class="ft8842"><i><b>meth</b></i></p>
<p style="position:absolute;top:421px;left:598px;white-space:nowrap" class="ft8841"><b>)</b></p>
<p style="position:absolute;top:440px;left:137px;white-space:nowrap" class="ft8817">Sets&#160;the&#160;default&#160;DAA&#160;method.&#160;</p>
<p style="position:absolute;top:468px;left:137px;white-space:nowrap" class="ft8843"><b>Parameters:</b></p>
<p style="position:absolute;top:496px;left:137px;white-space:nowrap" class="ft8839"><i>meth</i></p>
<p style="position:absolute;top:496px;left:180px;white-space:nowrap" class="ft8817">&#160;The&#160;method&#160;to&#160;set&#160;as&#160;default&#160;</p>
<p style="position:absolute;top:524px;left:83px;white-space:nowrap" class="ft8841"><b>const DAA_METHOD* DAA_OpenSSL (void)</b></p>
<p style="position:absolute;top:543px;left:137px;white-space:nowrap" class="ft8817">Returns&#160;the&#160;default&#160;OpenSSL&#160;DAA&#160;method.&#160;</p>
<p style="position:absolute;top:571px;left:137px;white-space:nowrap" class="ft8843"><b>Returns:</b></p>
<p style="position:absolute;top:599px;left:137px;white-space:nowrap" class="ft8825">Pointer&#160;to&#160;a&#160;DAA_METHOD&#160;structure<br/>Returns&#160;DAAFAKE&#160;as&#160;the&#160;default&#160;OpenSSL&#160;DAA&#160;method.&#160;</p>
<p style="position:absolute;top:655px;left:83px;white-space:nowrap" class="ft8841"><b>DAA_SIG* DAA_do_sign (const unsigned char *&#160;</b></p>
<p style="position:absolute;top:655px;left:519px;white-space:nowrap" class="ft8842"><i><b>dgst</b></i></p>
<p style="position:absolute;top:655px;left:559px;white-space:nowrap" class="ft8841"><b>, &#160; int&#160;</b></p>
<p style="position:absolute;top:655px;left:638px;white-space:nowrap" class="ft8842"><i><b>dgst_len</b></i></p>
<p style="position:absolute;top:655px;left:717px;white-space:nowrap" class="ft8841"><b>, &#160; DAA *&#160;</b></p>
<p style="position:absolute;top:674px;left:83px;white-space:nowrap" class="ft8842"><i><b>daa</b></i></p>
<p style="position:absolute;top:674px;left:113px;white-space:nowrap" class="ft8841"><b>)</b></p>
<p style="position:absolute;top:693px;left:137px;white-space:nowrap" class="ft8819">Computes&#160;the&#160;DAA&#160;signature&#160;(DAA_SIG&#160;structure)&#160;of&#160;the&#160;given&#160;hash&#160;value&#160;using&#160;<br/>the&#160;DAA&#160;method&#160;supplied&#160;and&#160;returns&#160;the&#160;created&#160;signature.</p>
<p style="position:absolute;top:741px;left:137px;white-space:nowrap" class="ft8843"><b>Parameters:</b></p>
<p style="position:absolute;top:768px;left:137px;white-space:nowrap" class="ft8839"><i>dgst</i></p>
<p style="position:absolute;top:768px;left:173px;white-space:nowrap" class="ft8817">&#160;Buffer&#160;containing&#160;the&#160;hash&#160;value&#160;</p>
<p style="position:absolute;top:796px;left:137px;white-space:nowrap" class="ft8839"><i>dgst_len</i></p>
<p style="position:absolute;top:796px;left:206px;white-space:nowrap" class="ft8817">&#160;Length&#160;of&#160;the&#160;hash&#160;value&#160;buffer&#160;</p>
<p style="position:absolute;top:824px;left:137px;white-space:nowrap" class="ft8839"><i>daa</i></p>
<p style="position:absolute;top:824px;left:167px;white-space:nowrap" class="ft8817">&#160;Pointer&#160;to&#160;the&#160;DAA&#160;structure&#160;containing&#160;a&#160;reference&#160;to&#160;the&#160;DAA&#160;method&#160;</p>
<p style="position:absolute;top:853px;left:137px;white-space:nowrap" class="ft8843"><b>Returns:</b></p>
<p style="position:absolute;top:881px;left:137px;white-space:nowrap" class="ft8825">Pointer&#160;to&#160;the&#160;DAA_SIG&#160;structure&#160;created&#160;<br/>NULL&#160;if&#160;an&#160;error&#160;occurred&#160;</p>
<p style="position:absolute;top:937px;left:83px;white-space:nowrap" class="ft8841"><b>int DAA_do_verify (const unsigned char *&#160;</b></p>
<p style="position:absolute;top:937px;left:489px;white-space:nowrap" class="ft8842"><i><b>dgst</b></i></p>
<p style="position:absolute;top:937px;left:529px;white-space:nowrap" class="ft8841"><b>, &#160; int&#160;</b></p>
<p style="position:absolute;top:937px;left:608px;white-space:nowrap" class="ft8842"><i><b>dgst_len</b></i></p>
<p style="position:absolute;top:937px;left:687px;white-space:nowrap" class="ft8841"><b>, &#160; const&#160;</b></p>
<p style="position:absolute;top:956px;left:83px;white-space:nowrap" class="ft8841"><b>DAA_SIG *&#160;</b></p>
<p style="position:absolute;top:956px;left:182px;white-space:nowrap" class="ft8842"><i><b>sig</b></i></p>
<p style="position:absolute;top:956px;left:212px;white-space:nowrap" class="ft8841"><b>, &#160; DAA *&#160;</b></p>
<p style="position:absolute;top:956px;left:311px;white-space:nowrap" class="ft8842"><i><b>daa</b></i></p>
<p style="position:absolute;top:956px;left:341px;white-space:nowrap" class="ft8841"><b>)</b></p>
<p style="position:absolute;top:974px;left:137px;white-space:nowrap" class="ft8819">Verifies&#160;that&#160;the&#160;supplied&#160;signature&#160;(DAA_SIG&#160;structure)&#160;is&#160;a&#160;valid&#160;DAA&#160;signature&#160;<br/>of&#160;the&#160;supplied&#160;hash&#160;value&#160;using&#160;the&#160;supplied&#160;DAA&#160;method.</p>
<p style="position:absolute;top:1022px;left:137px;white-space:nowrap" class="ft8843"><b>Parameters:</b></p>
<p style="position:absolute;top:1050px;left:137px;white-space:nowrap" class="ft8839"><i>dgst</i></p>
<p style="position:absolute;top:1050px;left:173px;white-space:nowrap" class="ft8817">&#160;Buffer&#160;containing&#160;the&#160;hash&#160;value&#160;</p>
<p style="position:absolute;top:1078px;left:137px;white-space:nowrap" class="ft8839"><i>dgst_len</i></p>
<p style="position:absolute;top:1078px;left:206px;white-space:nowrap" class="ft8817">&#160;Length&#160;of&#160;the&#160;hash&#160;value&#160;buffer&#160;</p>
<p style="position:absolute;top:1106px;left:137px;white-space:nowrap" class="ft8839"><i>sig</i></p>
<p style="position:absolute;top:1106px;left:160px;white-space:nowrap" class="ft8817">&#160;Pointer&#160;to&#160;the&#160;DAA_SIG&#160;structure&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft8821">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft8821">59/61</p>
</div>
<!-- Page 89 -->
<a name="89"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page89-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3089.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft899">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft890">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft8921">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft8921">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft8939"><i>daa</i></p>
<p style="position:absolute;top:149px;left:167px;white-space:nowrap" class="ft8917">&#160;Pointer&#160;to&#160;the&#160;DAA&#160;structure&#160;containing&#160;a&#160;reference&#160;to&#160;the&#160;DAA&#160;method&#160;</p>
<p style="position:absolute;top:178px;left:137px;white-space:nowrap" class="ft8943"><b>Returns:</b></p>
<p style="position:absolute;top:205px;left:137px;white-space:nowrap" class="ft8925">1&#160;if&#160;the&#160;signature&#160;is&#160;correct&#160;<br/>0&#160;if&#160;the&#160;signature&#160;is&#160;incorrect&#160;<br/>-1&#160;in&#160;case&#160;of&#160;error&#160;</p>
<p style="position:absolute;top:308px;left:83px;white-space:nowrap" class="ft8936"><i><b>9.2.3&#160;&#160;&#160;Application&#160;Interface</b></i></p>
<p style="position:absolute;top:338px;left:83px;white-space:nowrap" class="ft8917">These&#160;functions&#160;are&#160;detailed&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#58">&#160;4.2.1.</a></p>
<p style="position:absolute;top:384px;left:83px;white-space:nowrap" class="ft8934"><i><b>9.3&#160;&#160;&#160;TLS&#160;DAA-Enhancement</b></i></p>
<p style="position:absolute;top:433px;left:83px;white-space:nowrap" class="ft8936"><i><b>9.3.1&#160;&#160;&#160;Core</b></i></p>
<p style="position:absolute;top:463px;left:83px;white-space:nowrap" class="ft8917">These&#160;functions&#160;are&#160;detailed&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#63">&#160;5.1.3.1.</a></p>
<p style="position:absolute;top:509px;left:83px;white-space:nowrap" class="ft8936"><i><b>9.3.2&#160;&#160;&#160;Application&#160;Interface</b></i></p>
<p style="position:absolute;top:539px;left:83px;white-space:nowrap" class="ft8917">These&#160;functions&#160;are&#160;detailed&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#67">&#160;5.2.1.</a></p>
<p style="position:absolute;top:585px;left:83px;white-space:nowrap" class="ft8934"><i><b>9.4&#160;&#160;&#160;Engine&#160;TPM-DAA</b></i></p>
<p style="position:absolute;top:635px;left:83px;white-space:nowrap" class="ft8936"><i><b>9.4.1&#160;&#160;&#160;TSS&#160;Binding&#160;Utilities</b></i></p>
<p style="position:absolute;top:666px;left:83px;white-space:nowrap" class="ft8941"><b>BYTE* bi_export_dynamic (TSS_HCONTEXT&#160;</b></p>
<p style="position:absolute;top:666px;left:460px;white-space:nowrap" class="ft8942"><i><b>tsp</b></i></p>
<p style="position:absolute;top:666px;left:489px;white-space:nowrap" class="ft8941"><b>, &#160; BIGNUM const *&#160;</b></p>
<p style="position:absolute;top:666px;left:677px;white-space:nowrap" class="ft8942"><i><b>op1</b></i></p>
<p style="position:absolute;top:666px;left:707px;white-space:nowrap" class="ft8941"><b>,&#160;</b></p>
<p style="position:absolute;top:685px;left:83px;white-space:nowrap" class="ft8941"><b>unsigned int&#160;</b></p>
<p style="position:absolute;top:685px;left:212px;white-space:nowrap" class="ft8942"><i><b>obuf_bytes</b></i></p>
<p style="position:absolute;top:685px;left:311px;white-space:nowrap" class="ft8941"><b>)</b></p>
<p style="position:absolute;top:704px;left:137px;white-space:nowrap" class="ft8919">Converts&#160;an&#160;OpenSSL&#160;BIGNUM&#160;in&#160;a&#160;BYTE&#160;buffer.<br/>Allocates&#160;a&#160;buffer&#160;of&#160;the&#160;requested&#160;size&#160;and&#160;pads&#160;with&#160;0&#160;the&#160;unused&#160;bytes.<br/>Is&#160;a&#160;TSS&#160;context&#160;is&#160;available,&#160;uses&#160;calloc_tspi()&#160;to&#160;allocate&#160;memory&#160;within&#160;the&#160;<br/>TSS&#160;context;&#160;the&#160;memory&#160;is&#160;deallocated&#160;when&#160;the&#160;context&#160;is&#160;closed.</p>
<p style="position:absolute;top:808px;left:137px;white-space:nowrap" class="ft8943"><b>Parameters:</b></p>
<p style="position:absolute;top:835px;left:137px;white-space:nowrap" class="ft8939"><i>tsp</i></p>
<p style="position:absolute;top:835px;left:162px;white-space:nowrap" class="ft8917">&#160;TSS&#160;context&#160;</p>
<p style="position:absolute;top:864px;left:137px;white-space:nowrap" class="ft8939"><i>op1</i></p>
<p style="position:absolute;top:864px;left:168px;white-space:nowrap" class="ft8917">&#160;The&#160;BIGNUM&#160;to&#160;convert&#160;</p>
<p style="position:absolute;top:892px;left:137px;white-space:nowrap" class="ft8939"><i>obuf_bytes</i></p>
<p style="position:absolute;top:892px;left:227px;white-space:nowrap" class="ft8917">&#160;The&#160;number&#160;of&#160;bytes&#160;to&#160;allocate&#160;</p>
<p style="position:absolute;top:921px;left:137px;white-space:nowrap" class="ft8943"><b>Returns:</b></p>
<p style="position:absolute;top:948px;left:137px;white-space:nowrap" class="ft8917">The&#160;buffer&#160;containing&#160;the&#160;BIGNUM&#160;representation&#160;</p>
<p style="position:absolute;top:976px;left:83px;white-space:nowrap" class="ft8941"><b>TSS_DAA_SIGNATURE* ossl2tss_DAA_SIG (TSS_HCONTEXT&#160;</b></p>
<p style="position:absolute;top:976px;left:578px;white-space:nowrap" class="ft8942"><i><b>tsp</b></i></p>
<p style="position:absolute;top:976px;left:608px;white-space:nowrap" class="ft8941"><b>, &#160; DAA1_SIG *&#160;</b></p>
<p style="position:absolute;top:995px;left:83px;white-space:nowrap" class="ft8942"><i><b>daasig</b></i></p>
<p style="position:absolute;top:995px;left:143px;white-space:nowrap" class="ft8941"><b>)</b></p>
<p style="position:absolute;top:1014px;left:137px;white-space:nowrap" class="ft8919">Converts&#160;a&#160;DAA&#160;signature&#160;from&#160;the&#160;OpenSSL&#160;internal&#160;form&#160;to&#160;the&#160;TSS&#160;form&#160;<br/>TSS_DAA_SIGNATURE.<br/>Uses&#160;calloc_tspi()&#160;to&#160;allocate&#160;memory&#160;within&#160;the&#160;TSS&#160;context.&#160;The&#160;memory&#160;is&#160;<br/>deallocated&#160;when&#160;the&#160;context&#160;is&#160;closed.</p>
<p style="position:absolute;top:1109px;left:137px;white-space:nowrap" class="ft8943"><b>Parameters:</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft8921">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft8921">60/61</p>
</div>
<!-- Page 90 -->
<a name="90"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page90-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3090.png" alt="background image"/>
<p style="position:absolute;top:128px;left:97px;white-space:nowrap" class="ft909">&#160;</p>
<p style="position:absolute;top:85px;left:96px;white-space:nowrap" class="ft900">&#160;</p>
<p style="position:absolute;top:92px;left:212px;white-space:nowrap" class="ft9021">OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:92px;left:673px;white-space:nowrap" class="ft9021">FINAL&#160;|&#160;2.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft9039"><i>tsp</i></p>
<p style="position:absolute;top:149px;left:162px;white-space:nowrap" class="ft9017">&#160;TSS&#160;context&#160;</p>
<p style="position:absolute;top:177px;left:137px;white-space:nowrap" class="ft9039"><i>daasig</i></p>
<p style="position:absolute;top:177px;left:191px;white-space:nowrap" class="ft9017">&#160;DAA&#160;signature&#160;(in&#160;OpenSSL&#160;internal&#160;form)&#160;</p>
<p style="position:absolute;top:206px;left:137px;white-space:nowrap" class="ft9043"><b>Returns:</b></p>
<p style="position:absolute;top:234px;left:137px;white-space:nowrap" class="ft9017">DAA&#160;signature&#160;(in&#160;TSS&#160;form)&#160;</p>
<p style="position:absolute;top:262px;left:83px;white-space:nowrap" class="ft9041"><b>DAA1_SIG* tss2ossl_DAA_SIG (DAA1_SIG **&#160;</b></p>
<p style="position:absolute;top:262px;left:479px;white-space:nowrap" class="ft9042"><i><b>daasig</b></i></p>
<p style="position:absolute;top:262px;left:539px;white-space:nowrap" class="ft9041"><b>, &#160; TSS_DAA_SIGNATURE *&#160;</b></p>
<p style="position:absolute;top:280px;left:83px;white-space:nowrap" class="ft9042"><i><b>daaSignature</b></i></p>
<p style="position:absolute;top:280px;left:202px;white-space:nowrap" class="ft9041"><b>)</b></p>
<p style="position:absolute;top:299px;left:137px;white-space:nowrap" class="ft9019">Converts&#160;a&#160;DAA&#160;signature&#160;from&#160;the&#160;TSS&#160;form&#160;TSS_DAA_SIGNATURE&#160;to&#160;the&#160;<br/>OpenSSL&#160;internal&#160;form.</p>
<p style="position:absolute;top:347px;left:137px;white-space:nowrap" class="ft9043"><b>Parameters:</b></p>
<p style="position:absolute;top:375px;left:137px;white-space:nowrap" class="ft9039"><i>daasig</i></p>
<p style="position:absolute;top:375px;left:191px;white-space:nowrap" class="ft9017">&#160;Pointer&#160;to&#160;DAA&#160;signature&#160;(in&#160;OpenSSL&#160;internal&#160;form)</p>
<p style="position:absolute;top:403px;left:137px;white-space:nowrap" class="ft9039"><i>daaSignature</i></p>
<p style="position:absolute;top:403px;left:247px;white-space:nowrap" class="ft9017">&#160;DAA&#160;signature&#160;(in&#160;TSS&#160;form)</p>
<p style="position:absolute;top:431px;left:137px;white-space:nowrap" class="ft9043"><b>Returns:</b></p>
<p style="position:absolute;top:459px;left:137px;white-space:nowrap" class="ft9017">DAA&#160;signature&#160;(in&#160;OpenSSL&#160;internal&#160;form)</p>
<p style="position:absolute;top:487px;left:83px;white-space:nowrap" class="ft9041"><b>void print_error (char *&#160;</b></p>
<p style="position:absolute;top:487px;left:331px;white-space:nowrap" class="ft9042"><i><b>str</b></i></p>
<p style="position:absolute;top:487px;left:361px;white-space:nowrap" class="ft9041"><b>, &#160; TSS_RESULT&#160;</b></p>
<p style="position:absolute;top:487px;left:509px;white-space:nowrap" class="ft9042"><i><b>result</b></i></p>
<p style="position:absolute;top:487px;left:569px;white-space:nowrap" class="ft9041"><b>)</b></p>
<p style="position:absolute;top:506px;left:137px;white-space:nowrap" class="ft9017">Outputs&#160;an&#160;error&#160;message.</p>
<p style="position:absolute;top:535px;left:137px;white-space:nowrap" class="ft9043"><b>Parameters:</b></p>
<p style="position:absolute;top:562px;left:137px;white-space:nowrap" class="ft9039"><i>str</i></p>
<p style="position:absolute;top:562px;left:159px;white-space:nowrap" class="ft9017">&#160;The&#160;name&#160;of&#160;the&#160;TSS&#160;function&#160;generating&#160;the&#160;error.</p>
<p style="position:absolute;top:590px;left:137px;white-space:nowrap" class="ft9039"><i>result</i></p>
<p style="position:absolute;top:590px;left:184px;white-space:nowrap" class="ft9017">&#160;The&#160;error&#160;result.</p>
<p style="position:absolute;top:636px;left:83px;white-space:nowrap" class="ft9036"><i><b>9.4.2&#160;&#160;&#160;DAA_METHOD</b></i></p>
<p style="position:absolute;top:666px;left:83px;white-space:nowrap" class="ft9017">These&#160;functions&#160;are&#160;detailed&#160;in&#160;Section<a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#73">&#160;6.1.2.1.</a></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft9021">Open_TC&#160;Deliverable&#160;D03c.6</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft9021">61/61</p>
</div>
<!-- Page 91 -->
<a name="91"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page91-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3091.png" alt="background image"/>
<p style="position:absolute;top:137px;left:92px;white-space:nowrap" class="ft910">&#160;</p>
<p style="position:absolute;top:76px;left:91px;white-space:nowrap" class="ft911">&#160;</p>
<p style="position:absolute;top:242px;left:111px;white-space:nowrap" class="ft9115"><b>D03c.12&#160;OpenSSL&#160;engine/DAA&#160;enhancement&#160;</b></p>
<p style="position:absolute;top:273px;left:202px;white-space:nowrap" class="ft9115"><b>source&#160;code&#160;and&#160;documentation</b></p>
<p style="position:absolute;top:351px;left:91px;white-space:nowrap" class="ft9116"><b>Project&#160;number</b></p>
<p style="position:absolute;top:351px;left:425px;white-space:nowrap" class="ft9117">IST-027635</p>
<p style="position:absolute;top:376px;left:91px;white-space:nowrap" class="ft9116"><b>Project&#160;acronym</b></p>
<p style="position:absolute;top:376px;left:425px;white-space:nowrap" class="ft9117">Open_TC</p>
<p style="position:absolute;top:402px;left:91px;white-space:nowrap" class="ft9116"><b>Project&#160;title</b></p>
<p style="position:absolute;top:402px;left:425px;white-space:nowrap" class="ft9117">Open&#160;Trusted&#160;Computing</p>
<p style="position:absolute;top:427px;left:91px;white-space:nowrap" class="ft9116"><b>Deliverable&#160;type</b></p>
<p style="position:absolute;top:427px;left:425px;white-space:nowrap" class="ft9117">Internal&#160;deliverable</p>
<p style="position:absolute;top:470px;left:91px;white-space:nowrap" class="ft9116"><b>Deliverable&#160;reference&#160;number</b></p>
<p style="position:absolute;top:470px;left:425px;white-space:nowrap" class="ft9117">IST-027635/D03c.12/FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:502px;left:91px;white-space:nowrap" class="ft9116"><b>Deliverable&#160;title</b></p>
<p style="position:absolute;top:493px;left:425px;white-space:nowrap" class="ft9119">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;<br/>code&#160;and&#160;documentation</p>
<p style="position:absolute;top:534px;left:91px;white-space:nowrap" class="ft9116"><b>WP&#160;contributing&#160;to&#160;the&#160;deliverable</b></p>
<p style="position:absolute;top:534px;left:425px;white-space:nowrap" class="ft9117">WP03c</p>
<p style="position:absolute;top:560px;left:91px;white-space:nowrap" class="ft9116"><b>Due&#160;date</b></p>
<p style="position:absolute;top:560px;left:425px;white-space:nowrap" class="ft9117">Oct&#160;2008&#160;-&#160;M36</p>
<p style="position:absolute;top:585px;left:91px;white-space:nowrap" class="ft9116"><b>Actual&#160;submission&#160;date</b></p>
<p style="position:absolute;top:585px;left:425px;white-space:nowrap" class="ft9117">May&#160;15,&#160;2009&#160;</p>
<p style="position:absolute;top:628px;left:91px;white-space:nowrap" class="ft9116"><b>Responsible&#160;Organisation</b></p>
<p style="position:absolute;top:628px;left:424px;white-space:nowrap" class="ft9117">POL</p>
<p style="position:absolute;top:660px;left:91px;white-space:nowrap" class="ft9116"><b>Authors</b></p>
<p style="position:absolute;top:651px;left:424px;white-space:nowrap" class="ft9119">Emanuele&#160;Cesena,&#160;Davide&#160;Vernizzi,&#160;Gianluca&#160;<br/>Ramunno</p>
<p style="position:absolute;top:689px;left:91px;white-space:nowrap" class="ft9116"><b>Abstract</b></p>
<p style="position:absolute;top:689px;left:424px;white-space:nowrap" class="ft9119">This&#160;companion&#160;document&#160;describes&#160;the&#160;<br/>procedures&#160;for&#160;building,&#160;installing&#160;and&#160;testing&#160;<br/>the&#160;toolkit&#160;with&#160;DAA-enhancement&#160;(group&#160;<br/>authentication)&#160;for&#160;TLS&#160;implemented&#160;upon&#160;<br/>OpenSSL.</p>
<p style="position:absolute;top:905px;left:91px;white-space:nowrap" class="ft9116"><b>Keywords</b></p>
<p style="position:absolute;top:905px;left:424px;white-space:nowrap" class="ft9117">OPEN_TC,&#160;TPM,&#160;TLS,&#160;OpenSSL,&#160;DAA</p>
<p style="position:absolute;top:948px;left:92px;white-space:nowrap" class="ft9116"><b>Dissemination&#160;level</b></p>
<p style="position:absolute;top:948px;left:423px;white-space:nowrap" class="ft9117">Public</p>
<p style="position:absolute;top:973px;left:92px;white-space:nowrap" class="ft9116"><b>Revision</b></p>
<p style="position:absolute;top:973px;left:423px;white-space:nowrap" class="ft9117">FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:1025px;left:90px;white-space:nowrap" class="ft9116"><b>Instrument</b></p>
<p style="position:absolute;top:1025px;left:271px;white-space:nowrap" class="ft9117">IP</p>
<p style="position:absolute;top:1015px;left:452px;white-space:nowrap" class="ft9120"><b>Start&#160;date&#160;of&#160;the&#160;<br/>project</b></p>
<p style="position:absolute;top:1025px;left:633px;white-space:nowrap" class="ft9117">1</p>
<p style="position:absolute;top:1025px;left:643px;white-space:nowrap" class="ft9118">st</p>
<p style="position:absolute;top:1025px;left:652px;white-space:nowrap" class="ft9117">&#160;November&#160;2005</p>
<p style="position:absolute;top:1053px;left:90px;white-space:nowrap" class="ft9116"><b>Thematic&#160;Priority</b></p>
<p style="position:absolute;top:1053px;left:271px;white-space:nowrap" class="ft9117">IST</p>
<p style="position:absolute;top:1053px;left:452px;white-space:nowrap" class="ft9116"><b>Duration</b></p>
<p style="position:absolute;top:1053px;left:633px;white-space:nowrap" class="ft9117">42&#160;months</p>
<p style="position:absolute;top:75px;left:674px;white-space:nowrap" class="ft916">&#160;</p>
</div>
<!-- Page 92 -->
<a name="92"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page92-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3092.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft929">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft920">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft9221">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft9222"><b>Table&#160;of&#160;Contents</b></p>
<p style="position:absolute;top:204px;left:83px;white-space:nowrap" class="ft9223">1&#160;&#160;Introduction.................................................................................................................3<br/>2&#160;&#160;Prerequisites...............................................................................................................4<br/>3&#160;&#160;Structure&#160;of&#160;the&#160;Package.............................................................................................5<br/>4&#160;&#160;OpenSSL&#160;with&#160;DAA&#160;Support.........................................................................................6</p>
<p style="position:absolute;top:294px;left:92px;white-space:nowrap" class="ft9219">4.1&#160;&#160;Building&#160;from&#160;the&#160;Source........................................................................................6<br/>4.2&#160;&#160;Testing&#160;the&#160;Plain&#160;OpenSSL......................................................................................6<br/>4.3&#160;&#160;Testing&#160;the&#160;DAA-TLS&#160;Extension..............................................................................7</p>
<p style="position:absolute;top:355px;left:83px;white-space:nowrap" class="ft9217">5&#160;&#160;Trousers&#160;with&#160;DAA&#160;support..........................................................................................9</p>
<p style="position:absolute;top:375px;left:92px;white-space:nowrap" class="ft9219">5.1&#160;&#160;Building&#160;from&#160;the&#160;source........................................................................................9<br/>5.2&#160;&#160;Configuring&#160;the&#160;DAA-Enhanced&#160;Trousers..............................................................10<br/>5.3&#160;&#160;Testing&#160;the&#160;Installation&#160;and&#160;Creating&#160;DAA&#160;Credentials.........................................11</p>
<p style="position:absolute;top:436px;left:83px;white-space:nowrap" class="ft9217">6&#160;&#160;Engine&#160;TPM-DAA........................................................................................................14</p>
<p style="position:absolute;top:456px;left:92px;white-space:nowrap" class="ft9219">6.1&#160;&#160;Building&#160;from&#160;the&#160;source......................................................................................14<br/>6.2&#160;&#160;Testing&#160;the&#160;DAA-TLS&#160;Extension,&#160;TCG&#160;TSS/TPM&#160;Profile..........................................14</p>
<p style="position:absolute;top:498px;left:83px;white-space:nowrap" class="ft9217">7&#160;&#160;Engine&#160;Miracl.............................................................................................................16</p>
<p style="position:absolute;top:518px;left:92px;white-space:nowrap" class="ft9219">7.1&#160;&#160;Building&#160;from&#160;the&#160;source......................................................................................16<br/>7.2&#160;&#160;Creating&#160;DAA&#160;Credentials&#160;for&#160;Engine&#160;Miracl..........................................................16<br/>7.3&#160;&#160;Testing&#160;the&#160;DAA-TLS&#160;Extension,&#160;with&#160;Pairing-based&#160;DAA......................................17</p>
<p style="position:absolute;top:579px;left:83px;white-space:nowrap" class="ft9217">8&#160;&#160;Legacy&#160;Mode:&#160;Apache&#160;Web&#160;Server............................................................................18</p>
<p style="position:absolute;top:599px;left:92px;white-space:nowrap" class="ft9219">8.1&#160;&#160;Rebuilding&#160;OpenSSL&#160;with&#160;DAA&#160;Support&#160;in&#160;Legacy&#160;Mode.......................................19<br/>8.2&#160;&#160;Installing&#160;and&#160;Configuring&#160;Apache&#160;Web&#160;Server.....................................................20<br/>8.3&#160;&#160;Testing&#160;the&#160;Advanced&#160;Scenario............................................................................20</p>
<p style="position:absolute;top:661px;left:83px;white-space:nowrap" class="ft9223">9&#160;&#160;List&#160;of&#160;abbreviations..................................................................................................23<br/>10&#160;&#160;Referenced&#160;Documents...........................................................................................23</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft9221">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft9221">2/24</p>
</div>
<!-- Page 93 -->
<a name="93"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page93-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3093.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft939">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft930">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft9321">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft9324"><b>1&#160;&#160;&#160;Introduction</b></p>
<p style="position:absolute;top:200px;left:83px;white-space:nowrap" class="ft9319">Secure&#160;channels&#160;allow&#160;two&#160;or&#160;more&#160;entities&#160;to&#160;communicate&#160;securely&#160;over&#160;insecure&#160;<br/>networks&#160;using&#160;cryptographic&#160;primitives&#160;to&#160;provide&#160;confidentiality,&#160;integrity&#160;and&#160;<br/>authentication&#160;of&#160;network&#160;messages.&#160;Trusted&#160;Computing&#160;(TC)&#160;technology&#160;allows&#160;<br/>extending&#160;the&#160;network&#160;protection&#160;to&#160;the&#160;peers&#160;involved&#160;in&#160;the&#160;communication.&#160;TC,&#160;in&#160;<br/>facts,&#160;allows&#160;a&#160;platform&#160;with&#160;TC-enabled&#160;hardware&#160;to&#160;provide&#160;cryptographic&#160;proofs&#160;<br/>about&#160;its&#160;behavior.&#160;Using&#160;this&#160;information,&#160;the&#160;counterpart&#160;can&#160;have&#160;assurance&#160;about&#160;<br/>the&#160;security&#160;of&#160;the&#160;message&#160;not&#160;only&#160;while&#160;it&#160;is&#160;transmitted,&#160;but&#160;also&#160;after&#160;it&#160;is&#160;received&#160;<br/>on&#160;the&#160;TC-platform.<br/>Among&#160;the&#160;primitives&#160;available&#160;to&#160;a&#160;TC-platform,&#160;Direct&#160;Anonymous&#160;Attestation&#160;(DAA)&#160;<br/>[7]&#160;is&#160;a&#160;privacy-friendly&#160;protocol&#160;that&#160;was&#160;designed&#160;to&#160;overcome&#160;the&#160;privacy&#160;issues&#160;of&#160;<br/>the&#160;Privacy&#160;CA.&#160;In&#160;particular,&#160;the&#160;main&#160;problem&#160;related&#160;to&#160;the&#160;use&#160;of&#160;that&#160;particular&#160;CA,&#160;<br/>is&#160;that&#160;the&#160;latter&#160;can&#160;disclose&#160;sensitive&#160;data&#160;that&#160;could&#160;allow&#160;a&#160;third&#160;party&#160;to&#160;link&#160;<br/>different&#160;remote&#160;attestation&#160;made&#160;by&#160;the&#160;same&#160;platform,&#160;&#160;thus&#160;breaking&#160;the&#160;platform's&#160;<br/>privacy.&#160;DAA&#160;overcomes&#160;this&#160;problem&#160;using&#160;a&#160;zero-knowledge&#160;proof.<br/>In&#160;[1],&#160;a&#160;TLS&#160;DAA-Enhancement&#160;is&#160;proposed&#160;to&#160;exploit&#160;DAA&#160;as&#160;a&#160;mechanism&#160;to&#160;achieve&#160;<br/>(client)&#160;anonymous&#160;authentication.&#160;Furthermore,&#160;based&#160;on&#160;the&#160;Trusted&#160;Platform&#160;<br/>Module&#160;(TPM)&#160;and&#160;Trusted&#160;Software&#160;Stack&#160;(TSS),&#160;a&#160;TCG&#160;TSS/TPM&#160;profile&#160;is&#160;specified&#160;to&#160;<br/>exploit&#160;the&#160;DAA-related&#160;functions&#160;available&#160;in&#160;the&#160;TC&#160;technology.&#160;In&#160;[2]&#160;the&#160;design&#160;for&#160;<br/>an&#160;implementation&#160;(made&#160;using&#160;OpenSSL)&#160;of&#160;the&#160;TLS&#160;DAA-Enhancement&#160;is&#160;given,&#160;<br/>including&#160;the&#160;TCG&#160;TSS/TPM&#160;profile.<br/>This&#160;document&#160;describes&#160;in&#160;detail&#160;how&#160;to&#160;configure,&#160;install&#160;and&#160;test&#160;the&#160;implementation&#160;<br/>of&#160;the&#160;design&#160;specified&#160;in&#160;[2],&#160;i.e.&#160;the&#160;software&#160;whose&#160;this&#160;document&#160;is&#160;companion.&#160;In&#160;<br/>the&#160;sequel,&#160;DAA&#160;Toolkit&#160;refers&#160;to&#160;the&#160;set&#160;of&#160;programs&#160;released.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft9321">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft9321">3/24</p>
</div>
<!-- Page 94 -->
<a name="94"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page94-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3094.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft949">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft940">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft9421">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft9424"><b>2&#160;&#160;&#160;Prerequisites</b></p>
<p style="position:absolute;top:200px;left:83px;white-space:nowrap" class="ft9419">DAA&#160;Toolkit&#160;package&#160;requires&#160;TPM&#160;1.2&#160;with&#160;the&#160;EK&#160;certificate&#160;embedded;&#160;it&#160;has&#160;been&#160;<br/>tested&#160;with&#160;OpenSuSE&#160;11.1&#160;running&#160;on&#160;platforms&#160;equipped&#160;with&#160;the&#160;Infineon&#160;TPM&#160;only&#160;<br/>(HP&#160;Compaq&#160;nx6325&#160;and&#160;nw8440).&#160;Many&#160;TPM&#160;vendors&#160;do&#160;not&#160;provide&#160;the&#160;EK&#160;<br/>certificate;&#160;the&#160;DAA&#160;operations&#160;do&#160;not&#160;work&#160;on&#160;platforms&#160;equipped&#160;with&#160;such&#160;TPMs.&#160;<br/>Platforms&#160;with&#160;more&#160;recent&#160;revisions&#160;of&#160;Infineon&#160;TPMs&#160;(requiring&#160;authorization&#160;for&#160;NV&#160;<br/>access)&#160;may&#160;not&#160;work&#160;as&#160;well.<br/>In&#160;addition&#160;to&#160;a&#160;default&#160;installation,&#160;the&#160;following&#160;packages&#160;are&#160;required&#160;to&#160;build&#160;the&#160;<br/>DAA&#160;Toolkit:</p>
<p style="position:absolute;top:377px;left:110px;white-space:nowrap" class="ft9412">●</p>
<p style="position:absolute;top:372px;left:137px;white-space:nowrap" class="ft9417">autoconf</p>
<p style="position:absolute;top:405px;left:110px;white-space:nowrap" class="ft9412">●</p>
<p style="position:absolute;top:400px;left:137px;white-space:nowrap" class="ft9417">automake</p>
<p style="position:absolute;top:433px;left:110px;white-space:nowrap" class="ft9412">●</p>
<p style="position:absolute;top:428px;left:137px;white-space:nowrap" class="ft9417">gcc</p>
<p style="position:absolute;top:461px;left:110px;white-space:nowrap" class="ft9412">●</p>
<p style="position:absolute;top:457px;left:137px;white-space:nowrap" class="ft9417">gcc-c++</p>
<p style="position:absolute;top:489px;left:110px;white-space:nowrap" class="ft9412">●</p>
<p style="position:absolute;top:485px;left:137px;white-space:nowrap" class="ft9417">gtk2-devel</p>
<p style="position:absolute;top:518px;left:110px;white-space:nowrap" class="ft9412">●</p>
<p style="position:absolute;top:513px;left:137px;white-space:nowrap" class="ft9417">libtool</p>
<p style="position:absolute;top:546px;left:110px;white-space:nowrap" class="ft9412">●</p>
<p style="position:absolute;top:541px;left:137px;white-space:nowrap" class="ft9417">trousers</p>
<p style="position:absolute;top:569px;left:83px;white-space:nowrap" class="ft9417">It&#160;is&#160;assumed&#160;that&#160;Trousers&#160;is&#160;already&#160;installed&#160;(and&#160;the&#160;daemon&#160;</p>
<p style="position:absolute;top:569px;left:623px;white-space:nowrap" class="ft9433"><b>tcsd</b></p>
<p style="position:absolute;top:569px;left:662px;white-space:nowrap" class="ft9417">)&#160;running,&#160;and&#160;</p>
<p style="position:absolute;top:589px;left:83px;white-space:nowrap" class="ft9419">TPM&#160;Ownership&#160;has&#160;already&#160;been&#160;taken&#160;using&#160;ASCII&#160;encoding&#160;for&#160;the&#160;secrets&#160;(e.g.&#160;using&#160;<br/>Trousers&#160;tpm-tools).<br/>The&#160;installation&#160;procedure&#160;has&#160;been&#160;tested&#160;on&#160;a&#160;system&#160;where&#160;the&#160;following&#160;packages&#160;<br/>(that&#160;could&#160;interfere&#160;with&#160;DAA&#160;Toolkit)&#160;were&#160;installed:</p>
<p style="position:absolute;top:688px;left:110px;white-space:nowrap" class="ft9412">●</p>
<p style="position:absolute;top:683px;left:137px;white-space:nowrap" class="ft9417">openssl-devel</p>
<p style="position:absolute;top:716px;left:110px;white-space:nowrap" class="ft9412">●</p>
<p style="position:absolute;top:712px;left:137px;white-space:nowrap" class="ft9417">trousers-devel</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft9421">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft9421">4/24</p>
</div>
<!-- Page 95 -->
<a name="95"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page95-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3095.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft959">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft950">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft9521">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft9524"><b>3&#160;&#160;&#160;Structure&#160;of&#160;the&#160;Package</b></p>
<p style="position:absolute;top:200px;left:83px;white-space:nowrap" class="ft9517">The&#160;DAA&#160;Toolkit&#160;package&#160;contains&#160;the&#160;following&#160;directories:</p>
<p style="position:absolute;top:233px;left:110px;white-space:nowrap" class="ft9512">●</p>
<p style="position:absolute;top:229px;left:137px;white-space:nowrap" class="ft9533"><b>openssl-daa</b></p>
<p style="position:absolute;top:229px;left:247px;white-space:nowrap" class="ft9517">,&#160;contains&#160;OpenSSL&#160;v0.9.9&#160;Snapshot&#160;20081210&#160;and&#160;a&#160;patch&#160;to&#160;</p>
<p style="position:absolute;top:248px;left:137px;white-space:nowrap" class="ft9517">support&#160;DAA,&#160;TLSEXT&#160;and&#160;TLS-DAA&#160;as&#160;described&#160;in&#160;[2].</p>
<p style="position:absolute;top:281px;left:110px;white-space:nowrap" class="ft9512">●</p>
<p style="position:absolute;top:276px;left:137px;white-space:nowrap" class="ft9533"><b>trousers-daa</b></p>
<p style="position:absolute;top:276px;left:257px;white-space:nowrap" class="ft9517">,&#160;contains&#160;Trousers&#160;0.3.0&#160;CVS-20070701,&#160;the&#160;associated&#160;testsuite,&#160;</p>
<p style="position:absolute;top:295px;left:137px;white-space:nowrap" class="ft9517">and&#160;patches&#160;to&#160;support&#160;DAA.&#160;In&#160;addition,&#160;a&#160;program&#160;</p>
<p style="position:absolute;top:295px;left:570px;white-space:nowrap" class="ft9533"><b>getcert3</b></p>
<p style="position:absolute;top:295px;left:650px;white-space:nowrap" class="ft9517">&#160;to&#160;extract&#160;the&#160;EK&#160;</p>
<p style="position:absolute;top:314px;left:137px;white-space:nowrap" class="ft9519">certificate&#160;is&#160;available;&#160;the&#160;certificate&#160;is&#160;necessary&#160;to&#160;properly&#160;configure&#160;<br/>Trousers.&#160;The&#160;patches&#160;and&#160;</p>
<p style="position:absolute;top:334px;left:362px;white-space:nowrap" class="ft9533"><b>getcert3</b></p>
<p style="position:absolute;top:334px;left:442px;white-space:nowrap" class="ft9517">&#160;were&#160;written&#160;by&#160;Hal&#160;Finney.</p>
<p style="position:absolute;top:366px;left:110px;white-space:nowrap" class="ft9512">●</p>
<p style="position:absolute;top:362px;left:137px;white-space:nowrap" class="ft9533"><b>engine-tpm-daa</b></p>
<p style="position:absolute;top:362px;left:277px;white-space:nowrap" class="ft9517">,&#160;contains&#160;an&#160;engine&#160;which&#160;uses&#160;TSS/TPM&#160;capabilities&#160;for&#160;DAA.&#160;It&#160;</p>
<p style="position:absolute;top:381px;left:137px;white-space:nowrap" class="ft9517">implements&#160;the&#160;TCG&#160;TSS/TPM&#160;Profile&#160;defined&#160;in&#160;[1].</p>
<p style="position:absolute;top:414px;left:110px;white-space:nowrap" class="ft9512">●</p>
<p style="position:absolute;top:409px;left:137px;white-space:nowrap" class="ft9533"><b>engine-miracl-daa</b></p>
<p style="position:absolute;top:409px;left:306px;white-space:nowrap" class="ft9517">,&#160;contains&#160;an&#160;engine&#160;which&#160;uses&#160;MIRACL&#160;[11]&#160;cryptographic&#160;</p>
<p style="position:absolute;top:428px;left:137px;white-space:nowrap" class="ft9519">library&#160;to&#160;implement&#160;an&#160;advanced&#160;(pairing-based)&#160;version&#160;of&#160;the&#160;DAA&#160;protocol,&#160;<br/>described&#160;in&#160;[10].</p>
<p style="position:absolute;top:480px;left:110px;white-space:nowrap" class="ft9512">●</p>
<p style="position:absolute;top:476px;left:137px;white-space:nowrap" class="ft9533"><b>apache-daa</b></p>
<p style="position:absolute;top:476px;left:237px;white-space:nowrap" class="ft9517">,&#160;contains&#160;a&#160;version&#160;of&#160;</p>
<p style="position:absolute;top:476px;left:425px;white-space:nowrap" class="ft9533"><b>apache+mod_ssl</b></p>
<p style="position:absolute;top:476px;left:564px;white-space:nowrap" class="ft9517">&#160;recompiled&#160;for&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:495px;left:137px;white-space:nowrap" class="ft9517">v0.9.9.&#160;This&#160;will&#160;demonstrate&#160;the&#160;use&#160;of&#160;DAA&#160;Toolkit&#160;with&#160;legacy&#160;applications.</p>
<p style="position:absolute;top:523px;left:83px;white-space:nowrap" class="ft9519">In&#160;the&#160;sequel&#160;it&#160;is&#160;assumed&#160;that&#160;the&#160;DAA&#160;Toolkit&#160;tarball&#160;has&#160;been&#160;extracted&#160;into&#160;a&#160;<br/>temporary&#160;directory&#160;</p>
<p style="position:absolute;top:542px;left:255px;white-space:nowrap" class="ft9516"><b>TEMPDIR</b></p>
<p style="position:absolute;top:542px;left:338px;white-space:nowrap" class="ft9517">,&#160;where&#160;</p>
<p style="position:absolute;top:542px;left:405px;white-space:nowrap" class="ft9516"><b>TEMPDIR&#160;</b></p>
<p style="position:absolute;top:542px;left:495px;white-space:nowrap" class="ft9517">is&#160;a&#160;full&#160;path&#160;including&#160;the&#160;“/”&#160;root&#160;</p>
<p style="position:absolute;top:562px;left:83px;white-space:nowrap" class="ft9525">directory.<br/>Furthermore,&#160;the&#160;DAA&#160;Toolkit&#160;will&#160;be&#160;installed&#160;in&#160;the&#160;system&#160;under&#160;the&#160;</p>
<p style="position:absolute;top:609px;left:83px;white-space:nowrap" class="ft9533"><b>/usr/local/daatoolkit</b></p>
<p style="position:absolute;top:609px;left:292px;white-space:nowrap" class="ft9517">&#160;location.</p>
<p style="position:absolute;top:637px;left:83px;white-space:nowrap" class="ft9517">After&#160;compilation&#160;and&#160;installation&#160;of&#160;the&#160;whole&#160;DAA&#160;Toolkit,&#160;all&#160;the&#160;content&#160;of&#160;</p>
<p style="position:absolute;top:637px;left:724px;white-space:nowrap" class="ft9516"><b>TEMPDIR&#160;</b></p>
<p style="position:absolute;top:656px;left:83px;white-space:nowrap" class="ft9519">can&#160;be&#160;removed&#160;still&#160;allowing&#160;to&#160;use&#160;the&#160;installed&#160;programs.&#160;Moreover,&#160;in&#160;order&#160;to&#160;<br/>cleanly&#160;uninstall&#160;the&#160;DAA&#160;Toolkit&#160;it&#160;is&#160;sufficient&#160;to&#160;delete&#160;the&#160;content&#160;of&#160;</p>
<p style="position:absolute;top:695px;left:83px;white-space:nowrap" class="ft9533"><b>/usr/local/daatoolkit</b></p>
<p style="position:absolute;top:695px;left:292px;white-space:nowrap" class="ft9517">.&#160;Only&#160;apache&#160;needs&#160;to&#160;be&#160;uninstalled.</p>
<p style="position:absolute;top:723px;left:83px;white-space:nowrap" class="ft9517">Superuser&#160;privileges&#160;are&#160;required&#160;at&#160;some&#160;steps&#160;(usually&#160;</p>
<p style="position:absolute;top:723px;left:558px;white-space:nowrap" class="ft9533"><b>make&#160;install</b></p>
<p style="position:absolute;top:723px;left:677px;white-space:nowrap" class="ft9517">&#160;command).&#160;For&#160;</p>
<p style="position:absolute;top:742px;left:83px;white-space:nowrap" class="ft9517">simplicity&#160;it&#160;is&#160;assumed&#160;that&#160;the&#160;whole&#160;process&#160;is&#160;performed&#160;under&#160;the&#160;'root'&#160;account.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft9521">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft9521">5/24</p>
</div>
<!-- Page 96 -->
<a name="96"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page96-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3096.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft969">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft960">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft9621">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft9624"><b>4&#160;&#160;&#160;OpenSSL&#160;with&#160;DAA&#160;Support</b></p>
<p style="position:absolute;top:200px;left:83px;white-space:nowrap" class="ft9625">In&#160;this&#160;section&#160;OpenSSL&#160;will&#160;be&#160;patched&#160;to&#160;support&#160;DAA,&#160;TLSEXT&#160;and&#160;DAA-TLS&#160;(refer&#160;to&#160;<br/>[2]&#160;for&#160;more&#160;details).&#160;A&#160;test&#160;to&#160;verify&#160;the&#160;correctness&#160;of&#160;the&#160;installation&#160;follows.<br/>The&#160;working&#160;directory&#160;is&#160;</p>
<p style="position:absolute;top:248px;left:288px;white-space:nowrap" class="ft9633"><b>TEMPDIR/openssl-daa</b></p>
<p style="position:absolute;top:248px;left:477px;white-space:nowrap" class="ft9617">,&#160;and&#160;installed&#160;files&#160;go&#160;under&#160;</p>
<p style="position:absolute;top:267px;left:83px;white-space:nowrap" class="ft9633"><b>/usr/local/daatoolkit</b></p>
<p style="position:absolute;top:267px;left:292px;white-space:nowrap" class="ft9617">.</p>
<p style="position:absolute;top:313px;left:83px;white-space:nowrap" class="ft9634"><i><b>4.1&#160;&#160;&#160;Building&#160;from&#160;the&#160;Source</b></i></p>
<p style="position:absolute;top:345px;left:110px;white-space:nowrap" class="ft9617">1.&#160;Unpack&#160;the&#160;source&#160;</p>
<p style="position:absolute;top:345px;left:297px;white-space:nowrap" class="ft9633"><b>openssl-SNAP-20081204.tar.gz</b></p>
<p style="position:absolute;top:345px;left:575px;white-space:nowrap" class="ft9617">:</p>
<p style="position:absolute;top:382px;left:159px;white-space:nowrap" class="ft9645"><b>cd&#160;TEMPDIR/openssl-daa<br/>tar&#160;-xvvzf&#160;openssl-SNAP-20081204.tar.gz</b></p>
<p style="position:absolute;top:438px;left:110px;white-space:nowrap" class="ft9617">2.&#160;Apply&#160;the&#160;DAA-TLS&#160;patch&#160;(which&#160;includes&#160;TLSEXT&#160;framework,&#160;DAA&#160;primitives&#160;and&#160;</p>
<p style="position:absolute;top:457px;left:137px;white-space:nowrap" class="ft9617">DAA-TLS&#160;Extension):</p>
<p style="position:absolute;top:494px;left:159px;white-space:nowrap" class="ft9645"><b>cd&#160;openssl-SNAP-20081204<br/>patch&#160;-p1&#160;&lt;&#160;../openssl_daa_tls_patch.diff</b></p>
<p style="position:absolute;top:551px;left:110px;white-space:nowrap" class="ft9617">3.&#160;Prepare&#160;OpenSSL:</p>
<p style="position:absolute;top:588px;left:159px;white-space:nowrap" class="ft9633"><b>./config&#160;--prefix=/usr/local/daatoolkit&#160;-shared</b></p>
<p style="position:absolute;top:625px;left:110px;white-space:nowrap" class="ft9617">4.&#160;Compile&#160;and&#160;install</p>
<p style="position:absolute;top:662px;left:159px;white-space:nowrap" class="ft9645"><b>make<br/>make&#160;install</b></p>
<p style="position:absolute;top:718px;left:110px;white-space:nowrap" class="ft9617">5.&#160;Copy&#160;server&#160;and&#160;client&#160;certificates&#160;into&#160;the&#160;</p>
<p style="position:absolute;top:718px;left:495px;white-space:nowrap" class="ft9633"><b>bin</b></p>
<p style="position:absolute;top:718px;left:525px;white-space:nowrap" class="ft9617">&#160;directory&#160;within&#160;the&#160;installation&#160;</p>
<p style="position:absolute;top:737px;left:137px;white-space:nowrap" class="ft9617">path.&#160;These&#160;files&#160;are&#160;needed&#160;by&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:737px;left:483px;white-space:nowrap" class="ft9633"><b>s_server</b></p>
<p style="position:absolute;top:737px;left:563px;white-space:nowrap" class="ft9617">&#160;and&#160;</p>
<p style="position:absolute;top:737px;left:605px;white-space:nowrap" class="ft9633"><b>s_client</b></p>
<p style="position:absolute;top:737px;left:684px;white-space:nowrap" class="ft9617">&#160;commands.</p>
<p style="position:absolute;top:766px;left:137px;white-space:nowrap" class="ft9619">It&#160;is&#160;also&#160;possible&#160;to&#160;generate&#160;and/or&#160;use&#160;different&#160;certificates&#160;(while&#160;the&#160;client&#160;<br/>certificate&#160;should&#160;be&#160;a&#160;self-signed&#160;certificate&#160;that&#160;will&#160;be&#160;used&#160;by&#160;the&#160;DAA-TLS&#160;<br/>Extension).</p>
<p style="position:absolute;top:841px;left:159px;white-space:nowrap" class="ft9645"><b>cd&#160;apps<br/>cp&#160;server.pem&#160;client.pem&#160;/usr/local/daatoolkit/bin<br/>cd&#160;../..</b></p>
<p style="position:absolute;top:934px;left:83px;white-space:nowrap" class="ft9634"><i><b>4.2&#160;&#160;&#160;Testing&#160;the&#160;Plain&#160;OpenSSL</b></i></p>
<p style="position:absolute;top:966px;left:110px;white-space:nowrap" class="ft9617">1.&#160;Move&#160;to&#160;the&#160;</p>
<p style="position:absolute;top:966px;left:241px;white-space:nowrap" class="ft9633"><b>bin</b></p>
<p style="position:absolute;top:966px;left:271px;white-space:nowrap" class="ft9617">&#160;directory&#160;within&#160;the&#160;installation&#160;path:</p>
<p style="position:absolute;top:1003px;left:159px;white-space:nowrap" class="ft9633"><b>cd&#160;/usr/local/daatoolkit/bin</b></p>
<p style="position:absolute;top:1040px;left:110px;white-space:nowrap" class="ft9617">2.&#160;Begin&#160;by&#160;testing&#160;plain&#160;OpenSSL&#160;commands,&#160;without&#160;the&#160;DAA-TLS&#160;Extension.</p>
<p style="position:absolute;top:1059px;left:137px;white-space:nowrap" class="ft9617">Run&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:1059px;left:255px;white-space:nowrap" class="ft9616"><b>s_server</b></p>
<p style="position:absolute;top:1059px;left:332px;white-space:nowrap" class="ft9617">:</p>
<p style="position:absolute;top:1097px;left:159px;white-space:nowrap" class="ft9633"><b>./openssl&#160;s_server</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft9621">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft9621">6/24</p>
</div>
<!-- Page 97 -->
<a name="97"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page97-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3097.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft979">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft970">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft9721">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:149px;left:110px;white-space:nowrap" class="ft9717">3.&#160;In&#160;another&#160;shell&#160;window,&#160;in&#160;the&#160;same&#160;working&#160;directory,&#160;run&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:149px;left:715px;white-space:nowrap" class="ft9733"><b>s_client</b></p>
<p style="position:absolute;top:149px;left:795px;white-space:nowrap" class="ft9717">:</p>
<p style="position:absolute;top:186px;left:159px;white-space:nowrap" class="ft9733"><b>./openssl&#160;s_client&#160;-tls1&#160;[-cert&#160;client.pem]</b></p>
<p style="position:absolute;top:223px;left:137px;white-space:nowrap" class="ft9717">The&#160;command&#160;line&#160;option&#160;</p>
<p style="position:absolute;top:223px;left:354px;white-space:nowrap" class="ft9733"><b>-tls1</b></p>
<p style="position:absolute;top:223px;left:403px;white-space:nowrap" class="ft9717">&#160;forces&#160;the&#160;use&#160;of&#160;TLSv1&#160;protocol;&#160;the&#160;normal&#160;</p>
<p style="position:absolute;top:243px;left:137px;white-space:nowrap" class="ft9719">behavior&#160;of&#160;OpenSSL&#160;would&#160;be&#160;to&#160;open&#160;a&#160;SSLv3&#160;connection&#160;and&#160;eventually&#160;<br/>switch&#160;to&#160;TLSv1&#160;protocol&#160;if&#160;the&#160;server&#160;requires&#160;it.<br/>The&#160;default&#160;behavior&#160;is&#160;not&#160;suitable&#160;for&#160;testing&#160;the&#160;extensions&#160;since&#160;they&#160;are&#160;<br/>only&#160;defined&#160;for&#160;the&#160;TLS&#160;protocol.&#160;Optionally,&#160;one&#160;can&#160;specify&#160;a&#160;client&#160;certificate&#160;<br/>with&#160;the&#160;</p>
<p style="position:absolute;top:319px;left:210px;white-space:nowrap" class="ft9733"><b>-cert</b></p>
<p style="position:absolute;top:319px;left:260px;white-space:nowrap" class="ft9717">&#160;command&#160;line&#160;option&#160;to&#160;trigger&#160;the&#160;TLS&#160;client&#160;authentication.</p>
<p style="position:absolute;top:348px;left:110px;white-space:nowrap" class="ft9717">4.&#160;Type&#160;something&#160;in&#160;either&#160;window&#160;and&#160;verify&#160;that&#160;the&#160;transmission&#160;between&#160;</p>
<p style="position:absolute;top:367px;left:137px;white-space:nowrap" class="ft9717">client&#160;and&#160;server&#160;succeeded.</p>
<p style="position:absolute;top:395px;left:110px;white-space:nowrap" class="ft9717">5.&#160;Stop&#160;the&#160;client&#160;and&#160;the&#160;server&#160;by&#160;pressing&#160;CTRL+C&#160;and&#160;close&#160;the&#160;second&#160;shell&#160;</p>
<p style="position:absolute;top:414px;left:137px;white-space:nowrap" class="ft9717">window.</p>
<p style="position:absolute;top:460px;left:83px;white-space:nowrap" class="ft9734"><i><b>4.3&#160;&#160;&#160;Testing&#160;the&#160;DAA-TLS&#160;Extension</b></i></p>
<p style="position:absolute;top:492px;left:110px;white-space:nowrap" class="ft9717">1.&#160;Create&#160;dummy&#160;credentials.&#160;The&#160;default&#160;dummy&#160;DAA&#160;implementation,&#160;included&#160;in&#160;</p>
<p style="position:absolute;top:511px;left:137px;white-space:nowrap" class="ft9719">OpenSSL&#160;only&#160;for&#160;testing&#160;purpose,&#160;actually&#160;does&#160;not&#160;use&#160;credentials,&#160;but&#160;<br/>requires&#160;files&#160;to&#160;be&#160;present.&#160;These&#160;files&#160;will&#160;be&#160;substituted&#160;with&#160;actual&#160;DAA&#160;<br/>credentials&#160;in&#160;the&#160;sequel:</p>
<p style="position:absolute;top:587px;left:159px;white-space:nowrap" class="ft9745"><b>mkdir&#160;-p&#160;/usr/local/daatoolkit/etc/daa/<br/>touch&#160;/usr/local/daatoolkit/etc/daa/daa_issuer.bin<br/>touch&#160;/usr/local/daatoolkit/etc/daa/daa_cred.bin</b></p>
<p style="position:absolute;top:662px;left:110px;white-space:nowrap" class="ft9717">2.&#160;Move&#160;to&#160;the&#160;</p>
<p style="position:absolute;top:662px;left:241px;white-space:nowrap" class="ft9733"><b>bin</b></p>
<p style="position:absolute;top:662px;left:271px;white-space:nowrap" class="ft9717">&#160;directory&#160;within&#160;the&#160;installation&#160;path:</p>
<p style="position:absolute;top:699px;left:159px;white-space:nowrap" class="ft9733"><b>cd&#160;/usr/local/daatoolkit/bin</b></p>
<p style="position:absolute;top:736px;left:110px;white-space:nowrap" class="ft9717">3.&#160;Run&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:736px;left:255px;white-space:nowrap" class="ft9733"><b>s_server</b></p>
<p style="position:absolute;top:736px;left:334px;white-space:nowrap" class="ft9717">&#160;specifying,&#160;via&#160;the&#160;command&#160;line&#160;option&#160;</p>
<p style="position:absolute;top:736px;left:676px;white-space:nowrap" class="ft9733"><b>-daa_issuer</b></p>
<p style="position:absolute;top:736px;left:785px;white-space:nowrap" class="ft9717">,&#160;</p>
<p style="position:absolute;top:755px;left:137px;white-space:nowrap" class="ft9719">the&#160;name&#160;of&#160;the&#160;file&#160;containing&#160;the&#160;DAA&#160;Issuer&#160;credentials&#160;needed&#160;to&#160;verify&#160;the&#160;<br/>DAA&#160;signature:</p>
<p style="position:absolute;top:812px;left:159px;white-space:nowrap" class="ft9733"><b>./openssl&#160;s_server&#160;\</b></p>
<p style="position:absolute;top:831px;left:211px;white-space:nowrap" class="ft9733"><b>-daa_issuer&#160;/usr/local/daatoolkit/etc/daa/daa_issuer.bin</b></p>
<p style="position:absolute;top:868px;left:110px;white-space:nowrap" class="ft9717">4.&#160;In&#160;another&#160;shell&#160;window,&#160;in&#160;the&#160;same&#160;working&#160;directory,&#160;run&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:868px;left:715px;white-space:nowrap" class="ft9733"><b>s_client</b></p>
<p style="position:absolute;top:868px;left:795px;white-space:nowrap" class="ft9717">:</p>
<p style="position:absolute;top:905px;left:159px;white-space:nowrap" class="ft9733"><b>./openssl&#160;s_client&#160;-tls1&#160;-cert&#160;client.pem&#160;\</b></p>
<p style="position:absolute;top:924px;left:211px;white-space:nowrap" class="ft9733"><b>-daa&#160;/usr/local/daatoolkit/etc/daa/daa_cred.bin</b></p>
<p style="position:absolute;top:961px;left:137px;white-space:nowrap" class="ft9717">The&#160;command&#160;line&#160;option&#160;</p>
<p style="position:absolute;top:961px;left:354px;white-space:nowrap" class="ft9733"><b>-cert</b></p>
<p style="position:absolute;top:961px;left:403px;white-space:nowrap" class="ft9717">&#160;is&#160;now&#160;mandatory&#160;since&#160;the&#160;TLS&#160;DAA-</p>
<p style="position:absolute;top:981px;left:137px;white-space:nowrap" class="ft9725">Enhancement&#160;[1]&#160;requires&#160;the&#160;client&#160;authentication&#160;through&#160;a&#160;(self-signed)&#160;client&#160;<br/>certificate.&#160;Currently,&#160;if&#160;the&#160;client&#160;certificate&#160;is&#160;not&#160;set,&#160;the&#160;client&#160;does&#160;not&#160;send&#160;<br/>any&#160;certificate&#160;and&#160;the&#160;server&#160;closes&#160;the&#160;handshake&#160;with&#160;an&#160;error&#160;message.<br/>The&#160;command&#160;line&#160;option&#160;</p>
<p style="position:absolute;top:1047px;left:354px;white-space:nowrap" class="ft9733"><b>-daa</b></p>
<p style="position:absolute;top:1047px;left:393px;white-space:nowrap" class="ft9717">&#160;enables&#160;the&#160;DAA-TLS&#160;Extension&#160;on&#160;the&#160;client&#160;and&#160;</p>
<p style="position:absolute;top:1066px;left:137px;white-space:nowrap" class="ft9719">accepts&#160;as&#160;argument&#160;the&#160;name&#160;of&#160;the&#160;file&#160;containing&#160;the&#160;DAA&#160;Platform's&#160;<br/>credential&#160;necessary&#160;to&#160;compute&#160;the&#160;DAA&#160;signature.</p>
<p style="position:absolute;top:1114px;left:110px;white-space:nowrap" class="ft9717">5.&#160;The&#160;connection&#160;is&#160;established.&#160;Some&#160;debug&#160;messages&#160;[DBG]&#160;DAA-TLS&#160;show&#160;that&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft9721">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft9721">7/24</p>
</div>
<!-- Page 98 -->
<a name="98"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page98-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3098.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft989">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft980">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft9821">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft9819">the&#160;DAA-TLS&#160;Extension&#160;is&#160;actually&#160;used&#160;(compare&#160;the&#160;output&#160;of&#160;the&#160;two&#160;<br/>commands&#160;with&#160;the&#160;one&#160;in&#160;the&#160;previous&#160;section),&#160;i.e.&#160;the&#160;anonymous&#160;<br/>authentication&#160;has&#160;been&#160;performed.</p>
<p style="position:absolute;top:216px;left:110px;white-space:nowrap" class="ft9817">6.&#160;Type&#160;something&#160;in&#160;either&#160;window&#160;and&#160;verify&#160;that&#160;the&#160;transmission&#160;between&#160;</p>
<p style="position:absolute;top:235px;left:137px;white-space:nowrap" class="ft9817">client&#160;and&#160;server&#160;succeeded.</p>
<p style="position:absolute;top:263px;left:110px;white-space:nowrap" class="ft9817">7.&#160;Stop&#160;the&#160;client&#160;and&#160;the&#160;server&#160;by&#160;pressing&#160;CTRL+C&#160;and&#160;close&#160;the&#160;second&#160;shell&#160;</p>
<p style="position:absolute;top:282px;left:137px;white-space:nowrap" class="ft9817">window.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft9821">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft9821">8/24</p>
</div>
<!-- Page 99 -->
<a name="99"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page99-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3099.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft999">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft990">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft9921">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft9924"><b>5&#160;&#160;&#160;Trousers&#160;with&#160;DAA&#160;support</b></p>
<p style="position:absolute;top:200px;left:83px;white-space:nowrap" class="ft9925">In&#160;this&#160;section&#160;a&#160;proper&#160;version&#160;of&#160;Trousers&#160;will&#160;be&#160;patched&#160;to&#160;support&#160;DAA.&#160;The&#160;<br/>associated&#160;testsuite&#160;is&#160;run&#160;to&#160;verify&#160;the&#160;correctness&#160;of&#160;the&#160;installation.&#160;As&#160;a&#160;side&#160;effect&#160;<br/>of&#160;the&#160;test,&#160;DAA&#160;credentials&#160;will&#160;be&#160;generated&#160;to&#160;be&#160;used&#160;in&#160;the&#160;following.<br/>The&#160;working&#160;directory&#160;is&#160;</p>
<p style="position:absolute;top:267px;left:288px;white-space:nowrap" class="ft9933"><b>TEMPDIR/trousers-daa</b></p>
<p style="position:absolute;top:267px;left:487px;white-space:nowrap" class="ft9917">,&#160;and&#160;installed&#160;files&#160;go&#160;under&#160;</p>
<p style="position:absolute;top:286px;left:83px;white-space:nowrap" class="ft9933"><b>/usr/local/daatoolkit</b></p>
<p style="position:absolute;top:286px;left:292px;white-space:nowrap" class="ft9917">.</p>
<p style="position:absolute;top:332px;left:83px;white-space:nowrap" class="ft9934"><i><b>5.1&#160;&#160;&#160;Building&#160;from&#160;the&#160;source</b></i></p>
<p style="position:absolute;top:364px;left:110px;white-space:nowrap" class="ft9917">1.&#160;You&#160;MUST&#160;have&#160;the&#160;ownership&#160;of&#160;the&#160;TPM&#160;before&#160;continuing.</p>
<p style="position:absolute;top:392px;left:137px;white-space:nowrap" class="ft9917">It&#160;is&#160;also&#160;necessary&#160;to&#160;shut&#160;down&#160;Trousers:</p>
<p style="position:absolute;top:429px;left:159px;white-space:nowrap" class="ft9933"><b>service&#160;tcsd&#160;stop</b></p>
<p style="position:absolute;top:466px;left:110px;white-space:nowrap" class="ft9917">2.&#160;Unpack&#160;the&#160;two&#160;tarballs&#160;containing&#160;Trousers&#160;and&#160;the&#160;testsuite&#160;(CVS&#160;version&#160;</p>
<p style="position:absolute;top:486px;left:137px;white-space:nowrap" class="ft9917">dated&#160;2007-07-01):</p>
<p style="position:absolute;top:523px;left:159px;white-space:nowrap" class="ft9945"><b>cd&#160;TEMPDIR/trousers-daa<br/>tar&#160;-xvvzf&#160;trousers-20070701.tar.gz<br/>tar&#160;-xvvzf&#160;testsuite-20070701.tar.gz</b></p>
<p style="position:absolute;top:598px;left:110px;white-space:nowrap" class="ft9917">3.&#160;Apply&#160;Hal&#160;Finney's&#160;DAA&#160;patches:</p>
<p style="position:absolute;top:626px;left:159px;white-space:nowrap" class="ft9945"><b>cd&#160;trousers&#160;<br/>patch&#160;-p1&#160;&lt;&#160;../trousers_daa_patch.diff<br/>cd&#160;../testsuite<br/>patch&#160;-p1&#160;&lt;&#160;../testsuite_daa_patch.diff<br/>cd&#160;..</b></p>
<p style="position:absolute;top:740px;left:110px;white-space:nowrap" class="ft9917">4.&#160;Compile&#160;and&#160;install&#160;Trousers:</p>
<p style="position:absolute;top:768px;left:159px;white-space:nowrap" class="ft9945"><b>cd&#160;trousers<br/>sh&#160;boostrap.sh<br/>CFLAGS=&#34;-Wno-error=format&#34;&#160;./configure&#160;--enable-loadkey2&#160;\<br/>&#160;</b></p>
<p style="position:absolute;top:826px;left:211px;white-space:nowrap" class="ft9933"><b>--enable-debug&#160;--prefix=/usr/local/daatoolkit&#160;\</b></p>
<p style="position:absolute;top:845px;left:159px;white-space:nowrap" class="ft9933"><b>&#160;</b></p>
<p style="position:absolute;top:845px;left:211px;white-space:nowrap" class="ft9933"><b>--with-openssl=/usr/local/daatoolkit&#160;</b></p>
<p style="position:absolute;top:864px;left:159px;white-space:nowrap" class="ft9945"><b>make&#160;<br/>make&#160;install<br/>cd&#160;..</b></p>
<p style="position:absolute;top:940px;left:137px;white-space:nowrap" class="ft9917">Trousers&#160;is&#160;compiled&#160;in&#160;debug&#160;mode&#160;(</p>
<p style="position:absolute;top:940px;left:450px;white-space:nowrap" class="ft9933"><b>--enable-debug</b></p>
<p style="position:absolute;top:940px;left:589px;white-space:nowrap" class="ft9917">&#160;option)&#160;to&#160;better&#160;follow&#160;</p>
<p style="position:absolute;top:959px;left:137px;white-space:nowrap" class="ft9919">what&#160;happens&#160;at&#160;the&#160;TSS/TPM&#160;level.&#160;In&#160;particular&#160;when&#160;the&#160;TPM&#160;will&#160;do&#160;DAA-<br/>related&#160;computations,&#160;the&#160;debug&#160;mode&#160;allows&#160;following&#160;the&#160;process&#160;evolution&#160;<br/>step&#160;by&#160;step.</p>
<p style="position:absolute;top:1025px;left:110px;white-space:nowrap" class="ft9917">5.&#160;Compile&#160;the&#160;testsuite</p>
<p style="position:absolute;top:1063px;left:159px;white-space:nowrap" class="ft9945"><b>export&#160;CFLAGS=&#34;-I/usr/local/daatoolkit/include<br/>&#160;</b></p>
<p style="position:absolute;top:1082px;left:211px;white-space:nowrap" class="ft9933"><b>-L/usr/local/daatoolkit/lib&#160;-lcrypto&#34;</b></p>
<p style="position:absolute;top:1101px;left:159px;white-space:nowrap" class="ft9945"><b>cd&#160;testsuite/tcg/common<br/>make</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft9921">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft9921">9/24</p>
</div>
<!-- Page 100 -->
<a name="100"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page100-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3100.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft1009">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft1000">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft10021">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:149px;left:159px;white-space:nowrap" class="ft10045"><b>cd&#160;../highlevel/daa<br/>make</b></p>
<p style="position:absolute;top:205px;left:137px;white-space:nowrap" class="ft10019">Since&#160;the&#160;compilation&#160;of&#160;the&#160;whole&#160;testsuite&#160;is&#160;not&#160;completely&#160;working,&#160;only&#160;the&#160;<br/>DAA&#160;testsuite,&#160;which&#160;depends&#160;upon&#160;</p>
<p style="position:absolute;top:225px;left:437px;white-space:nowrap" class="ft10033"><b>common</b></p>
<p style="position:absolute;top:225px;left:496px;white-space:nowrap" class="ft10017">,&#160;is&#160;compiled.</p>
<p style="position:absolute;top:253px;left:110px;white-space:nowrap" class="ft10017">6.&#160;Reset&#160;the&#160;environment</p>
<p style="position:absolute;top:290px;left:159px;white-space:nowrap" class="ft10045"><b>export&#160;CFLAGS=&#34;&#34;<br/>cd&#160;../../../..</b></p>
<p style="position:absolute;top:364px;left:83px;white-space:nowrap" class="ft10034"><i><b>5.2&#160;&#160;&#160;Configuring&#160;the&#160;DAA-Enhanced&#160;Trousers</b></i></p>
<p style="position:absolute;top:396px;left:110px;white-space:nowrap" class="ft10017">1.&#160;Compile&#160;</p>
<p style="position:absolute;top:396px;left:210px;white-space:nowrap" class="ft10033"><b>getcert3</b></p>
<p style="position:absolute;top:396px;left:290px;white-space:nowrap" class="ft10017">,&#160;which&#160;extracts&#160;the&#160;EK&#160;certificate&#160;from&#160;the&#160;TPM.</p>
<p style="position:absolute;top:424px;left:137px;white-space:nowrap" class="ft10019">Note&#160;that&#160;this&#160;program&#160;is&#160;not&#160;installed&#160;under&#160;the&#160;installation&#160;path,&#160;so&#160;it&#160;will&#160;be&#160;<br/>removed&#160;when&#160;deleting&#160;the&#160;source&#160;package&#160;tree.</p>
<p style="position:absolute;top:480px;left:159px;white-space:nowrap" class="ft10045"><b>cd&#160;TEMPDIR/trousers-daa<br/>export&#160;LD_LIBRARY_PATH=/usr/local/daatoolkit/lib&#160;<br/>gcc&#160;-o&#160;getcert3&#160;getcert3.c&#160;-Itrousers/include&#160;\<br/>&#160;-L/usr/local/daatoolkit/lib&#160;-ltspi&#160;-lcrypto</b></p>
<p style="position:absolute;top:575px;left:110px;white-space:nowrap" class="ft10017">2.&#160;Run&#160;the&#160;tcsd&#160;daemon.&#160;This&#160;must&#160;be&#160;done&#160;in&#160;an&#160;independent&#160;root&#160;shell&#160;window:</p>
<p style="position:absolute;top:612px;left:158px;white-space:nowrap" class="ft10045"><b>export&#160;LD_LIBRARY_PATH=/usr/local/daatoolkit/lib<br/>cd&#160;/usr/local/daatoolkit/sbin<br/>./tcsd&#160;-f</b></p>
<p style="position:absolute;top:687px;left:110px;white-space:nowrap" class="ft10017">3.&#160;Run&#160;getcert3,&#160;which&#160;extracts&#160;the&#160;EK&#160;certificate&#160;from&#160;the&#160;TPM:</p>
<p style="position:absolute;top:725px;left:158px;white-space:nowrap" class="ft10033"><b>./getcert3&#160;ek.cert</b></p>
<p style="position:absolute;top:762px;left:110px;white-space:nowrap" class="ft10025">4.&#160;Stop&#160;the&#160;tcsd&#160;daemon.&#160;Press&#160;CTRL-C&#160;in&#160;the&#160;related&#160;window.<br/>5.&#160;Take&#160;a&#160;look&#160;at&#160;the&#160;certificate&#160;data&#160;(using&#160;the&#160;standard&#160;OpenSSL):</p>
<p style="position:absolute;top:827px;left:158px;white-space:nowrap" class="ft10033"><b>openssl&#160;x509&#160;-text&#160;-noout&#160;-inform&#160;DER&#160;-in&#160;ek.cert</b></p>
<p style="position:absolute;top:864px;left:110px;white-space:nowrap" class="ft10017">6.&#160;Save&#160;the&#160;EK&#160;certificate&#160;within&#160;the&#160;installation&#160;path:</p>
<p style="position:absolute;top:901px;left:159px;white-space:nowrap" class="ft10033"><b>cp&#160;ek.cert&#160;/usr/local/daatoolkit/etc/</b></p>
<p style="position:absolute;top:938px;left:110px;white-space:nowrap" class="ft10017">7.&#160;Edit&#160;the&#160;Trousers'&#160;configuration&#160;file:</p>
<p style="position:absolute;top:975px;left:159px;white-space:nowrap" class="ft10033"><b>/usr/local/daatoolkit/etc/tcsd.conf</b></p>
<p style="position:absolute;top:1012px;left:137px;white-space:nowrap" class="ft10017">and&#160;set&#160;(by&#160;uncommenting&#160;and&#160;completing&#160;the&#160;line):</p>
<p style="position:absolute;top:1041px;left:159px;white-space:nowrap" class="ft10033"><b>endorsement_cred&#160;=&#160;/usr/local/daatoolkit/etc/ek.cert</b></p>
<p style="position:absolute;top:1078px;left:110px;white-space:nowrap" class="ft10017">8.&#160;Prepare&#160;the&#160;proper&#160;file&#160;for&#160;PS&#160;database&#160;(this&#160;step&#160;is&#160;needed&#160;because&#160;the&#160;</p>
<p style="position:absolute;top:1097px;left:137px;white-space:nowrap" class="ft10017">ownership&#160;is&#160;already&#160;taken).</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft10021">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft10021">10/24</p>
</div>
<!-- Page 101 -->
<a name="101"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page101-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3101.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft1019">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft1010">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft10121">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft10117">1.&#160;Alternative&#160;if&#160;SRK&#160;password&#160;is&#160;not&#160;null:</p>
<p style="position:absolute;top:186px;left:186px;white-space:nowrap" class="ft10133"><b>cp&#160;trousers/dist/system.data.auth&#160;\</b></p>
<p style="position:absolute;top:205px;left:265px;white-space:nowrap" class="ft10133"><b>/usr/local/daatoolkit/var/lib/tpm/system.data</b></p>
<p style="position:absolute;top:243px;left:137px;white-space:nowrap" class="ft10117">2.&#160;Alternative&#160;if&#160;SRK&#160;password&#160;set&#160;to&#160;null&#160;or&#160;to&#160;WELL_KNOWN_SECRET:</p>
<p style="position:absolute;top:280px;left:186px;white-space:nowrap" class="ft10133"><b>cp&#160;trousers/dist/system.data.noauth&#160;\</b></p>
<p style="position:absolute;top:299px;left:265px;white-space:nowrap" class="ft10133"><b>/usr/local/daatoolkit/var/lib/tpm/system.data</b></p>
<p style="position:absolute;top:336px;left:110px;white-space:nowrap" class="ft10117">9.&#160;Run&#160;the&#160;tcsd&#160;daemon.</p>
<p style="position:absolute;top:364px;left:137px;white-space:nowrap" class="ft10117">Open&#160;an&#160;independent&#160;root&#160;shell&#160;window&#160;and&#160;run&#160;the&#160;commands:</p>
<p style="position:absolute;top:401px;left:159px;white-space:nowrap" class="ft10145"><b>export&#160;LD_LIBRARY_PATH=/usr/local/daatoolkit/lib<br/>cd&#160;/usr/local/daatoolkit/sbin<br/>./tcsd&#160;-f</b></p>
<p style="position:absolute;top:477px;left:137px;white-space:nowrap" class="ft10119">Since&#160;Trousers&#160;is&#160;required&#160;for&#160;the&#160;whole&#160;demonstration&#160;described&#160;in&#160;this&#160;<br/>document,&#160;this&#160;shell&#160;window&#160;MUST&#160;remain&#160;open&#160;with&#160;the&#160;tcsd&#160;daemon&#160;running&#160;<br/>(the&#160;option&#160;</p>
<p style="position:absolute;top:515px;left:234px;white-space:nowrap" class="ft10133"><b>-f</b></p>
<p style="position:absolute;top:515px;left:254px;white-space:nowrap" class="ft10117">&#160;starts&#160;the&#160;daemon&#160;in&#160;foreground&#160;and&#160;is&#160;useful&#160;for&#160;testing&#160;</p>
<p style="position:absolute;top:534px;left:137px;white-space:nowrap" class="ft10117">purposes).</p>
<p style="position:absolute;top:580px;left:83px;white-space:nowrap" class="ft10134"><i><b>5.3&#160;&#160;&#160;Testing&#160;the&#160;Installation&#160;and&#160;Creating&#160;DAA&#160;Credentials</b></i></p>
<p style="position:absolute;top:612px;left:83px;white-space:nowrap" class="ft10125">As&#160;already&#160;mentioned,&#160;in&#160;this&#160;section&#160;commands&#160;from&#160;the&#160;testsuite&#160;are&#160;run&#160;to&#160;verify&#160;<br/>the&#160;correct&#160;installation&#160;of&#160;Trousers,&#160;with&#160;DAA&#160;support.<br/>As&#160;a&#160;side&#160;effect,&#160;these&#160;commands&#160;will&#160;produce&#160;DAA&#160;Issuer&#160;and&#160;Platform&#160;credentials,&#160;<br/>that&#160;will&#160;be&#160;stored&#160;for&#160;future&#160;usage.<br/>The&#160;use&#160;of&#160;the&#160;command&#160;line&#160;tool&#160;</p>
<p style="position:absolute;top:707px;left:366px;white-space:nowrap" class="ft10133"><b>time</b></p>
<p style="position:absolute;top:707px;left:406px;white-space:nowrap" class="ft10117">&#160;prepended&#160;to&#160;all&#160;following&#160;commands&#160;is&#160;</p>
<p style="position:absolute;top:726px;left:83px;white-space:nowrap" class="ft10119">optional&#160;but&#160;its&#160;usage&#160;is&#160;interesting&#160;because&#160;it&#160;gives&#160;information&#160;on&#160;the&#160;time&#160;needed&#160;<br/>for&#160;the&#160;computation&#160;(sometimes&#160;tens&#160;of&#160;seconds):&#160;this&#160;demonstrates&#160;that&#160;DAA&#160;is&#160;a&#160;very&#160;<br/>expensive&#160;cryptographic&#160;operation.<br/>It&#160;is&#160;possible&#160;to&#160;run&#160;the&#160;commands&#160;more&#160;than&#160;once,&#160;in&#160;order&#160;to&#160;create&#160;multiple&#160;Issuer&#160;<br/>and/or&#160;Platform&#160;credentials.<br/>Note&#160;that&#160;these&#160;programs&#160;are&#160;not&#160;installed&#160;under&#160;the&#160;installation&#160;path,&#160;so&#160;they&#160;will&#160;be&#160;<br/>removed&#160;when&#160;deleting&#160;the&#160;source&#160;package&#160;tree.</p>
<p style="position:absolute;top:887px;left:110px;white-space:nowrap" class="ft10117">1.&#160;Prepare&#160;to&#160;test:</p>
<p style="position:absolute;top:925px;left:159px;white-space:nowrap" class="ft10145"><b>cd&#160;TEMPDIR/trousers-daa<br/>cd&#160;testsuite/tcg/highlevel/daa<br/>export&#160;LD_LIBRARY_PATH=/usr/local/daatoolkit/lib<br/>export&#160;TESTSUITE_OWNER_SECRET=xxxxxx</b></p>
<p style="position:absolute;top:1019px;left:137px;white-space:nowrap" class="ft10117">where&#160;</p>
<p style="position:absolute;top:1019px;left:194px;white-space:nowrap" class="ft10133"><b>xxxxxx</b></p>
<p style="position:absolute;top:1019px;left:253px;white-space:nowrap" class="ft10117">&#160;must&#160;be&#160;substituted&#160;with&#160;the&#160;TPM&#160;owner&#160;secret.</p>
<p style="position:absolute;top:1047px;left:110px;white-space:nowrap" class="ft10117">2.&#160;Create&#160;the&#160;DAA&#160;Issuer&#160;credentials:</p>
<p style="position:absolute;top:1084px;left:159px;white-space:nowrap" class="ft10133"><b>time&#160;./Tspi_DAA_Issuer_GenerateKey&#160;&#34;IssuerBaseName&#34;&#160;\</b></p>
<p style="position:absolute;top:1104px;left:211px;white-space:nowrap" class="ft10133"><b>authkeys.bin&#160;tpm_daa_issuer.bin&#160;skissuer.bin&#160;prfissuer.bin</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft10121">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft10121">11/24</p>
</div>
<!-- Page 102 -->
<a name="102"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page102-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3102.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft1029">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft1020">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft10221">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft10217">where&#160;</p>
<p style="position:absolute;top:149px;left:194px;white-space:nowrap" class="ft10233"><b>IssuerBaseName</b></p>
<p style="position:absolute;top:149px;left:333px;white-space:nowrap" class="ft10217">&#160;is&#160;a&#160;string&#160;containing&#160;the&#160;Issuer&#160;base&#160;name,&#160;</p>
<p style="position:absolute;top:168px;left:137px;white-space:nowrap" class="ft10233"><b>authkeys.bin</b></p>
<p style="position:absolute;top:168px;left:257px;white-space:nowrap" class="ft10217">&#160;is&#160;the&#160;file&#160;to&#160;store&#160;the&#160;authentication&#160;keys,&#160;</p>
<p style="position:absolute;top:168px;left:618px;white-space:nowrap" class="ft10233"><b>tpm_daa_issuer.bin&#160;</b></p>
<p style="position:absolute;top:188px;left:137px;white-space:nowrap" class="ft10217">is&#160;the&#160;file&#160;to&#160;store&#160;the&#160;DAA&#160;Issuer&#160;credentials&#160;(public&#160;key),&#160;</p>
<p style="position:absolute;top:188px;left:620px;white-space:nowrap" class="ft10233"><b>skissuer.bin</b></p>
<p style="position:absolute;top:188px;left:739px;white-space:nowrap" class="ft10217">&#160;is&#160;the&#160;</p>
<p style="position:absolute;top:207px;left:137px;white-space:nowrap" class="ft10217">file&#160;to&#160;store&#160;the&#160;DAA&#160;Issuer&#160;private&#160;key&#160;and&#160;</p>
<p style="position:absolute;top:207px;left:499px;white-space:nowrap" class="ft10233"><b>prfissuer.bin</b></p>
<p style="position:absolute;top:207px;left:629px;white-space:nowrap" class="ft10217">&#160;is&#160;the&#160;file&#160;to&#160;store&#160;</p>
<p style="position:absolute;top:226px;left:137px;white-space:nowrap" class="ft10225">the&#160;proof&#160;of&#160;correctness&#160;of&#160;the&#160;DAA&#160;Issuer&#160;credentials.<br/>The&#160;most&#160;important&#160;file&#160;for&#160;the&#160;following&#160;is&#160;</p>
<p style="position:absolute;top:254px;left:495px;white-space:nowrap" class="ft10233"><b>tpm_daa_issuer.bin</b></p>
<p style="position:absolute;top:254px;left:674px;white-space:nowrap" class="ft10217">,&#160;that&#160;will&#160;be&#160;</p>
<p style="position:absolute;top:273px;left:137px;white-space:nowrap" class="ft10217">needed&#160;to&#160;verify&#160;DAA&#160;signatures.</p>
<p style="position:absolute;top:302px;left:110px;white-space:nowrap" class="ft10217">3.&#160;Optionally,&#160;for&#160;testing,&#160;verify&#160;the&#160;correctness&#160;of&#160;the&#160;DAA&#160;Issuer&#160;credentials,&#160;</p>
<p style="position:absolute;top:321px;left:137px;white-space:nowrap" class="ft10219">given&#160;the&#160;related&#160;proof&#160;of&#160;correctness.&#160;This&#160;operation&#160;should&#160;be&#160;done&#160;once&#160;by&#160;<br/>any&#160;user&#160;(and&#160;verifier)&#160;that&#160;receives&#160;the&#160;DAA&#160;Issuer&#160;credentials.&#160;</p>
<p style="position:absolute;top:377px;left:159px;white-space:nowrap" class="ft10233"><b>time&#160;./Tspi_DAA_IssuerKeyVerify&#160;tpm_daa_issuer.bin&#160;prfissuer.bin</b></p>
<p style="position:absolute;top:414px;left:110px;white-space:nowrap" class="ft10217">4.&#160;Perform&#160;a&#160;DAA&#160;Join.&#160;This&#160;will&#160;create&#160;the&#160;DAA&#160;Platform&#160;credential.</p>
<p style="position:absolute;top:451px;left:159px;white-space:nowrap" class="ft10233"><b>time&#160;./Tspi_DAA_Join&#160;authkeys.bin&#160;tpm_daa_issuer.bin&#160;\</b></p>
<p style="position:absolute;top:471px;left:211px;white-space:nowrap" class="ft10233"><b>skissuer.bin&#160;tpm_daa_cred.bin</b></p>
<p style="position:absolute;top:508px;left:137px;white-space:nowrap" class="ft10217">where&#160;</p>
<p style="position:absolute;top:508px;left:194px;white-space:nowrap" class="ft10233"><b>authkeys.bin</b></p>
<p style="position:absolute;top:508px;left:313px;white-space:nowrap" class="ft10217">&#160;contains&#160;the&#160;authentication&#160;keys,&#160;</p>
<p style="position:absolute;top:508px;left:600px;white-space:nowrap" class="ft10233"><b>tpm_daa_issuer.bin&#160;</b></p>
<p style="position:absolute;top:527px;left:137px;white-space:nowrap" class="ft10217">the&#160;Issuer&#160;credential,&#160;</p>
<p style="position:absolute;top:527px;left:318px;white-space:nowrap" class="ft10233"><b>skissuer.bin</b></p>
<p style="position:absolute;top:527px;left:437px;white-space:nowrap" class="ft10217">&#160;the&#160;Issuer&#160;private&#160;key.&#160;Finally&#160;</p>
<p style="position:absolute;top:546px;left:137px;white-space:nowrap" class="ft10233"><b>tpm_daa_cred.bin</b></p>
<p style="position:absolute;top:546px;left:296px;white-space:nowrap" class="ft10217">&#160;is&#160;the&#160;file&#160;to&#160;store&#160;the&#160;generated&#160;DAA&#160;Platform&#160;credentials.&#160;</p>
<p style="position:absolute;top:574px;left:137px;white-space:nowrap" class="ft10217">The&#160;file&#160;</p>
<p style="position:absolute;top:574px;left:204px;white-space:nowrap" class="ft10233"><b>tpm_daa_cred.bin</b></p>
<p style="position:absolute;top:574px;left:363px;white-space:nowrap" class="ft10217">&#160;is&#160;necessary&#160;to&#160;compute&#160;a&#160;DAA&#160;signature.&#160;Note&#160;that&#160;</p>
<p style="position:absolute;top:593px;left:137px;white-space:nowrap" class="ft10219">part&#160;of&#160;this&#160;credential&#160;is&#160;bound&#160;to&#160;the&#160;TPM,&#160;i.e.&#160;the&#160;TPM&#160;owner&#160;secret&#160;will&#160;be&#160;<br/>necessary&#160;to&#160;access&#160;this&#160;credential.</p>
<p style="position:absolute;top:641px;left:110px;white-space:nowrap" class="ft10217">5.&#160;Optionally,&#160;for&#160;testing,&#160;compute&#160;a&#160;DAA&#160;signatures&#160;on&#160;a&#160;input&#160;string.&#160;The&#160;</p>
<p style="position:absolute;top:660px;left:137px;white-space:nowrap" class="ft10217">command&#160;also&#160;verifies&#160;the&#160;correctness&#160;of&#160;the&#160;signature.</p>
<p style="position:absolute;top:697px;left:159px;white-space:nowrap" class="ft10233"><b>time&#160;./Tspi_DAA_SignData&#160;tpm_daa_issuer.bin&#160;tpm_daa_cred.bin&#160;\</b></p>
<p style="position:absolute;top:716px;left:211px;white-space:nowrap" class="ft10233"><b>&#34;data&#160;to&#160;sign&#34;</b></p>
<p style="position:absolute;top:753px;left:137px;white-space:nowrap" class="ft10217">where&#160;</p>
<p style="position:absolute;top:753px;left:194px;white-space:nowrap" class="ft10233"><b>tpm_daa_issuer.bin</b></p>
<p style="position:absolute;top:753px;left:373px;white-space:nowrap" class="ft10217">&#160;is&#160;the&#160;DAA&#160;Issuer&#160;credentials&#160;necessary&#160;to&#160;the&#160;</p>
<p style="position:absolute;top:772px;left:137px;white-space:nowrap" class="ft10217">verification,&#160;</p>
<p style="position:absolute;top:772px;left:240px;white-space:nowrap" class="ft10233"><b>tpm_daa_cred.bin</b></p>
<p style="position:absolute;top:772px;left:399px;white-space:nowrap" class="ft10217">&#160;is&#160;the&#160;DAA&#160;Platform&#160;credentials&#160;used&#160;to&#160;compute&#160;</p>
<p style="position:absolute;top:792px;left:137px;white-space:nowrap" class="ft10217">the&#160;DAA&#160;signature&#160;and&#160;</p>
<p style="position:absolute;top:792px;left:330px;white-space:nowrap" class="ft10233"><b>data&#160;to&#160;sign</b></p>
<p style="position:absolute;top:792px;left:449px;white-space:nowrap" class="ft10217">&#160;is&#160;the&#160;input&#160;string&#160;that&#160;is&#160;signed.</p>
<p style="position:absolute;top:820px;left:110px;white-space:nowrap" class="ft10217">6.&#160;Optionally,&#160;for&#160;testing,&#160;compute&#160;a&#160;DAA&#160;signature&#160;over&#160;an&#160;AIK.&#160;This&#160;program&#160;</p>
<p style="position:absolute;top:839px;left:137px;white-space:nowrap" class="ft10219">automatically&#160;generates&#160;a&#160;new&#160;AIK,&#160;DAA-signs&#160;it&#160;and&#160;verifies&#160;the&#160;signature.&#160;It&#160;<br/>requires&#160;the&#160;SRK&#160;secret.<br/>Signing&#160;AIKs&#160;is&#160;one&#160;of&#160;the&#160;most&#160;important&#160;usage&#160;of&#160;DAA&#160;in&#160;the&#160;TC&#160;context,&#160;<br/>however&#160;it&#160;is&#160;not&#160;further&#160;addressed&#160;in&#160;this&#160;document.</p>
<p style="position:absolute;top:943px;left:159px;white-space:nowrap" class="ft10245"><b>export&#160;TESTSUITE_SRK_SECRET=xxxxxx<br/>time&#160;./Tspi_DAA_SignKey&#160;tpm_daa_issuer.bin&#160;tpm_daa_cred.bin</b></p>
<p style="position:absolute;top:999px;left:137px;white-space:nowrap" class="ft10217">where&#160;</p>
<p style="position:absolute;top:999px;left:194px;white-space:nowrap" class="ft10233"><b>tpm_daa_issuer.bin</b></p>
<p style="position:absolute;top:999px;left:373px;white-space:nowrap" class="ft10217">&#160;is&#160;the&#160;DAA&#160;Issuer&#160;credentials&#160;necessary&#160;to&#160;the&#160;</p>
<p style="position:absolute;top:1018px;left:137px;white-space:nowrap" class="ft10217">verification,&#160;</p>
<p style="position:absolute;top:1018px;left:240px;white-space:nowrap" class="ft10233"><b>tpm_daa_cred.bin</b></p>
<p style="position:absolute;top:1018px;left:399px;white-space:nowrap" class="ft10217">&#160;is&#160;the&#160;DAA&#160;Platform&#160;credentials&#160;used&#160;to&#160;compute&#160;</p>
<p style="position:absolute;top:1038px;left:137px;white-space:nowrap" class="ft10217">the&#160;DAA&#160;signature.</p>
<p style="position:absolute;top:1066px;left:110px;white-space:nowrap" class="ft10217">7.&#160;Finally&#160;save&#160;the&#160;created&#160;DAA&#160;credentials&#160;to&#160;</p>
<p style="position:absolute;top:1066px;left:500px;white-space:nowrap" class="ft10233"><b>/usr/local/daatoolkit/etc/daa&#160;</b></p>
<p style="position:absolute;top:1085px;left:137px;white-space:nowrap" class="ft10217">for&#160;future&#160;usage:</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft10221">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft10221">12/24</p>
</div>
<!-- Page 103 -->
<a name="103"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page103-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3103.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft1039">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft1030">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft10321">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:149px;left:159px;white-space:nowrap" class="ft10345"><b>cp&#160;tpm_daa_issuer.bin&#160;/usr/local/daatoolkit/etc/daa<br/>cp&#160;tpm_daa_cred.bin&#160;/usr/local/daatoolkit/etc/daa<br/>cd&#160;../../../..</b></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft10321">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft10321">13/24</p>
</div>
<!-- Page 104 -->
<a name="104"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page104-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3104.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft1049">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft1040">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft10421">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft10424"><b>6&#160;&#160;&#160;Engine&#160;TPM-DAA</b></p>
<p style="position:absolute;top:200px;left:83px;white-space:nowrap" class="ft10425">In&#160;this&#160;section&#160;an&#160;Engine&#160;TPM-DAA&#160;is&#160;built&#160;and&#160;installed.&#160;This&#160;is&#160;then&#160;used&#160;in&#160;<br/>conjunction&#160;with&#160;OpenSSL&#160;to&#160;implement&#160;the&#160;TCG&#160;TPM/TSS&#160;Profile&#160;of&#160;the&#160;TLS&#160;DAA-<br/>Enhancement&#160;[1].<br/>The&#160;working&#160;directory&#160;is&#160;</p>
<p style="position:absolute;top:267px;left:288px;white-space:nowrap" class="ft10433"><b>TEMPDIR/engine-tpm-daa</b></p>
<p style="position:absolute;top:267px;left:507px;white-space:nowrap" class="ft10417">,&#160;and&#160;installed&#160;files&#160;go&#160;under&#160;</p>
<p style="position:absolute;top:286px;left:83px;white-space:nowrap" class="ft10433"><b>/usr/local/daatoolkit</b></p>
<p style="position:absolute;top:286px;left:292px;white-space:nowrap" class="ft10417">.</p>
<p style="position:absolute;top:332px;left:83px;white-space:nowrap" class="ft10434"><i><b>6.1&#160;&#160;&#160;Building&#160;from&#160;the&#160;source</b></i></p>
<p style="position:absolute;top:364px;left:110px;white-space:nowrap" class="ft10417">1.&#160;Unpack&#160;the&#160;source&#160;code:</p>
<p style="position:absolute;top:401px;left:159px;white-space:nowrap" class="ft10445"><b>cd&#160;TEMPDIR/engine-tpm-daa<br/>tar&#160;-xvvzf&#160;engine-tpm-daa-1.0.0.tar.gz</b></p>
<p style="position:absolute;top:457px;left:110px;white-space:nowrap" class="ft10417">2.&#160;Compile&#160;and&#160;install&#160;the&#160;engine:</p>
<p style="position:absolute;top:494px;left:159px;white-space:nowrap" class="ft10445"><b>cd&#160;engine-tpm-daa-1.0.0<br/>./configure&#160;--with-ssl=/usr/local/daatoolkit&#160;\</b></p>
<p style="position:absolute;top:533px;left:211px;white-space:nowrap" class="ft10445"><b>--with-tss=/usr/local/daatoolkit&#160;\<br/>--libdir=/usr/local/daatoolkit/lib/engines</b></p>
<p style="position:absolute;top:571px;left:159px;white-space:nowrap" class="ft10445"><b>make<br/>make&#160;install<br/>cd&#160;..</b></p>
<p style="position:absolute;top:665px;left:83px;white-space:nowrap" class="ft10434"><i><b>6.2&#160;&#160;&#160;Testing&#160;the&#160;DAA-TLS&#160;Extension,&#160;TCG&#160;TSS/TPM&#160;Profile</b></i></p>
<p style="position:absolute;top:696px;left:110px;white-space:nowrap" class="ft10417">1.&#160;Link&#160;the&#160;TPM-related&#160;credentials:</p>
<p style="position:absolute;top:733px;left:159px;white-space:nowrap" class="ft10445"><b>cd&#160;/usr/local/daatoolkit/etc/daa/<br/>rm&#160;daa_*<br/>ln&#160;-s&#160;tpm_daa_cred.bin&#160;daa_cred.bin<br/>ln&#160;-s&#160;tpm_daa_issuer.bin&#160;daa_issuer.bin</b></p>
<p style="position:absolute;top:828px;left:110px;white-space:nowrap" class="ft10417">2.&#160;Move&#160;to&#160;the&#160;</p>
<p style="position:absolute;top:828px;left:241px;white-space:nowrap" class="ft10433"><b>bin</b></p>
<p style="position:absolute;top:828px;left:271px;white-space:nowrap" class="ft10417">&#160;directory&#160;within&#160;the&#160;installation&#160;path:</p>
<p style="position:absolute;top:865px;left:159px;white-space:nowrap" class="ft10433"><b>cd&#160;/usr/local/daatoolkit/bin</b></p>
<p style="position:absolute;top:902px;left:110px;white-space:nowrap" class="ft10417">3.&#160;Run&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:902px;left:255px;white-space:nowrap" class="ft10433"><b>s_server</b></p>
<p style="position:absolute;top:902px;left:334px;white-space:nowrap" class="ft10417">&#160;specifying&#160;the&#160;usage&#160;of&#160;the&#160;Engine&#160;TPM-DAA&#160;via&#160;the&#160;</p>
<p style="position:absolute;top:921px;left:137px;white-space:nowrap" class="ft10417">command&#160;line&#160;option&#160;</p>
<p style="position:absolute;top:921px;left:318px;white-space:nowrap" class="ft10433"><b>-engine&#160;tpmdaa</b></p>
<p style="position:absolute;top:921px;left:457px;white-space:nowrap" class="ft10417">:</p>
<p style="position:absolute;top:958px;left:159px;white-space:nowrap" class="ft10445"><b>export&#160;LD_LIBRARY_PATH=/usr/local/daatoolkit/lib<br/>./openssl&#160;s_server&#160;-engine&#160;tpmdaa&#160;\&#160;</b></p>
<p style="position:absolute;top:997px;left:211px;white-space:nowrap" class="ft10433"><b>-daa_issuer&#160;/usr/local/daatoolkit/etc/daa/daa_issuer.bin</b></p>
<p style="position:absolute;top:1034px;left:110px;white-space:nowrap" class="ft10417">4.&#160;In&#160;another&#160;shell&#160;window,&#160;in&#160;the&#160;same&#160;working&#160;directory,&#160;run&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:1034px;left:715px;white-space:nowrap" class="ft10433"><b>s_client&#160;</b></p>
<p style="position:absolute;top:1053px;left:137px;white-space:nowrap" class="ft10417">specifying&#160;the&#160;usage&#160;of&#160;the&#160;Engine&#160;TPM-DAA&#160;via&#160;the&#160;command&#160;line&#160;option&#160;</p>
<p style="position:absolute;top:1072px;left:137px;white-space:nowrap" class="ft10433"><b>-engine&#160;tpmdaa</b></p>
<p style="position:absolute;top:1072px;left:277px;white-space:nowrap" class="ft10417">.&#160;</p>
<p style="position:absolute;top:1101px;left:137px;white-space:nowrap" class="ft10419">Note&#160;that&#160;on&#160;the&#160;client&#160;side&#160;the&#160;TPM&#160;owner&#160;secret&#160;is&#160;required&#160;to&#160;access&#160;the&#160;DAA&#160;<br/>Platform&#160;credentials.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft10421">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft10421">14/24</p>
</div>
<!-- Page 105 -->
<a name="105"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page105-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3105.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft1059">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft1050">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft10521">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:149px;left:159px;white-space:nowrap" class="ft10545"><b>export&#160;LD_LIBRARY_PATH=/usr/local/daatoolkit/lib<br/>export&#160;TESTSUITE_OWNER_SECRET=xxxxxx<br/>./openssl&#160;s_client&#160;-tls1&#160;-cert&#160;client.pem&#160;-engine&#160;tpmdaa&#160;\</b></p>
<p style="position:absolute;top:207px;left:211px;white-space:nowrap" class="ft10533"><b>-daa&#160;/usr/local/daatoolkit/etc/daa/daa_cred.bin</b></p>
<p style="position:absolute;top:244px;left:137px;white-space:nowrap" class="ft10517">where&#160;</p>
<p style="position:absolute;top:244px;left:194px;white-space:nowrap" class="ft10533"><b>xxxxxx</b></p>
<p style="position:absolute;top:244px;left:253px;white-space:nowrap" class="ft10517">&#160;must&#160;be&#160;substituted&#160;with&#160;the&#160;TPM&#160;owner&#160;secret.</p>
<p style="position:absolute;top:272px;left:110px;white-space:nowrap" class="ft10517">5.&#160;The&#160;connection&#160;is&#160;established.&#160;Additional&#160;debug&#160;messages&#160;from&#160;the&#160;TSS&#160;notify&#160;</p>
<p style="position:absolute;top:291px;left:137px;white-space:nowrap" class="ft10517">the&#160;progress&#160;of&#160;the&#160;TPM&#160;DAA-Sign&#160;operation&#160;on&#160;the&#160;client&#160;side.</p>
<p style="position:absolute;top:319px;left:110px;white-space:nowrap" class="ft10517">6.&#160;Type&#160;something&#160;in&#160;either&#160;window&#160;and&#160;verify&#160;that&#160;the&#160;transmission&#160;between&#160;</p>
<p style="position:absolute;top:339px;left:137px;white-space:nowrap" class="ft10517">client&#160;and&#160;server&#160;succeeded.</p>
<p style="position:absolute;top:367px;left:110px;white-space:nowrap" class="ft10517">7.&#160;Stop&#160;the&#160;client&#160;and&#160;the&#160;server&#160;by&#160;pressing&#160;CTRL+C&#160;and&#160;close&#160;the&#160;second&#160;shell&#160;</p>
<p style="position:absolute;top:386px;left:137px;white-space:nowrap" class="ft10517">window.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft10521">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft10521">15/24</p>
</div>
<!-- Page 106 -->
<a name="106"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft10649{font-size:17px;font-family:FAAAAA+BitstreamVeraSansMono;color:#0000ff;}
-->
</style>
<div id="page106-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3106.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft1069">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft1060">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft10621">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft10624"><b>7&#160;&#160;&#160;Engine&#160;Miracl</b></p>
<p style="position:absolute;top:200px;left:83px;white-space:nowrap" class="ft10625">In&#160;this&#160;section&#160;an&#160;Engine&#160;Miracl&#160;is&#160;built&#160;and&#160;installed.&#160;This&#160;is&#160;then&#160;used&#160;in&#160;conjunction&#160;<br/>with&#160;OpenSSL&#160;to&#160;show&#160;an&#160;advanced&#160;use&#160;of&#160;TLS&#160;DAA-Enhancement&#160;[1]&#160;with&#160;pairing-<br/>based&#160;DAA&#160;[10].<br/>In&#160;order&#160;to&#160;generate&#160;credentials&#160;suitable&#160;for&#160;the&#160;demonstration,&#160;a&#160;program&#160;<br/>implementing&#160;a&#160;complete&#160;run&#160;of&#160;the&#160;full&#160;DAA&#160;protocol&#160;(Setup,&#160;Join,&#160;Sign&#160;and&#160;Verify)&#160;is&#160;<br/>also&#160;installed.<br/>The&#160;working&#160;directory&#160;is&#160;</p>
<p style="position:absolute;top:334px;left:288px;white-space:nowrap" class="ft10633"><b>TEMPDIR/engine-miracl-daa</b></p>
<p style="position:absolute;top:334px;left:536px;white-space:nowrap" class="ft10617">,&#160;and&#160;installed&#160;files&#160;go&#160;under&#160;</p>
<p style="position:absolute;top:353px;left:83px;white-space:nowrap" class="ft10633"><b>/usr/local/daatoolkit</b></p>
<p style="position:absolute;top:353px;left:292px;white-space:nowrap" class="ft10617">.</p>
<p style="position:absolute;top:381px;left:83px;white-space:nowrap" class="ft10619">Note&#160;that&#160;MIRACL&#160;is&#160;NOT&#160;free&#160;software&#160;and&#160;for&#160;commercial&#160;use&#160;a&#160;license&#160;is&#160;required.&#160;<br/>Check&#160;the&#160;file&#160;</p>
<p style="position:absolute;top:400px;left:202px;white-space:nowrap" class="ft10633"><b>first.txt</b></p>
<p style="position:absolute;top:400px;left:292px;white-space:nowrap" class="ft10617">&#160;distributed&#160;with&#160;MIRACL&#160;for&#160;additional&#160;details.</p>
<p style="position:absolute;top:446px;left:83px;white-space:nowrap" class="ft10634"><i><b>7.1&#160;&#160;&#160;Building&#160;from&#160;the&#160;source</b></i></p>
<p style="position:absolute;top:478px;left:110px;white-space:nowrap" class="ft10617">1.&#160;Unpack&#160;the&#160;source&#160;code:</p>
<p style="position:absolute;top:515px;left:159px;white-space:nowrap" class="ft10645"><b>cd&#160;TEMPDIR/engine-miracl-daa<br/>tar&#160;-xvvzf&#160;engine-miracl-daa-1.0.0.tar.gz</b></p>
<p style="position:absolute;top:571px;left:110px;white-space:nowrap" class="ft10617">2.&#160;This&#160;engine&#160;expects&#160;a&#160;full&#160;MIRACL&#160;distribution&#160;withing&#160;the&#160;</p>
<p style="position:absolute;top:571px;left:619px;white-space:nowrap" class="ft10633"><b>miracl/</b></p>
<p style="position:absolute;top:571px;left:689px;white-space:nowrap" class="ft10617">&#160;directory.</p>
<p style="position:absolute;top:600px;left:137px;white-space:nowrap" class="ft10625">MIRACL&#160;is&#160;not&#160;distributed&#160;as&#160;part&#160;of&#160;the&#160;Engine&#160;Miracl&#160;for&#160;license&#160;reasons:&#160;<br/>MIRACL&#160;is&#160;not&#160;free&#160;software.<br/>1.&#160;Download&#160;</p>
<p style="position:absolute;top:647px;left:252px;white-space:nowrap" class="ft10633"><b>miracl.zip</b></p>
<p style="position:absolute;top:647px;left:351px;white-space:nowrap" class="ft10617">&#160;from:</p>
<p style="position:absolute;top:684px;left:186px;white-space:nowrap" class="ft10649"><a href="http://www.shamus.ie/index.php?page=Downloads"><b>http://www.shamus.ie/index.php?page=Downloads</b></a></p>
<p style="position:absolute;top:721px;left:164px;white-space:nowrap" class="ft10617">OR&#160;use&#160;</p>
<p style="position:absolute;top:721px;left:229px;white-space:nowrap" class="ft10633"><b>miracl.zip</b></p>
<p style="position:absolute;top:721px;left:328px;white-space:nowrap" class="ft10617">&#160;in&#160;the&#160;distribution&#160;directory.</p>
<p style="position:absolute;top:749px;left:137px;white-space:nowrap" class="ft10617">2.&#160;Unpack&#160;and&#160;build&#160;MIRACL&#160;(refer&#160;to&#160;the&#160;documentation&#160;file&#160;</p>
<p style="position:absolute;top:749px;left:648px;white-space:nowrap" class="ft10633"><b>linux.txt&#160;</b></p>
<p style="position:absolute;top:768px;left:164px;white-space:nowrap" class="ft10617">distributed&#160;with&#160;MIRACL&#160;for&#160;additional&#160;details):</p>
<p style="position:absolute;top:806px;left:186px;white-space:nowrap" class="ft10645"><b>cd&#160;engine-miracl-daa-1.0.0/miracl<br/>unzip&#160;-j&#160;-aa&#160;-L&#160;-o&#160;../../miracl.zip<br/>bash&#160;linux<br/>cd&#160;..</b></p>
<p style="position:absolute;top:900px;left:110px;white-space:nowrap" class="ft10617">3.&#160;Compile&#160;and&#160;install&#160;the&#160;engine:</p>
<p style="position:absolute;top:937px;left:159px;white-space:nowrap" class="ft10633"><b>./configure&#160;--with-ssl=/usr/local/daatoolkit&#160;\</b></p>
<p style="position:absolute;top:957px;left:211px;white-space:nowrap" class="ft10645"><b>--prefix=/usr/local/daatoolkit&#160;\<br/>--libdir=/usr/local/daatoolkit/lib/engines</b></p>
<p style="position:absolute;top:995px;left:159px;white-space:nowrap" class="ft10645"><b>make<br/>make&#160;install<br/>cd&#160;..</b></p>
<p style="position:absolute;top:1088px;left:83px;white-space:nowrap" class="ft10634"><i><b>7.2&#160;&#160;&#160;Creating&#160;DAA&#160;Credentials&#160;for&#160;Engine&#160;Miracl</b></i></p>
<p style="position:absolute;top:1120px;left:110px;white-space:nowrap" class="ft10617">1.&#160;Move&#160;to&#160;the&#160;</p>
<p style="position:absolute;top:1120px;left:241px;white-space:nowrap" class="ft10633"><b>bin</b></p>
<p style="position:absolute;top:1120px;left:271px;white-space:nowrap" class="ft10617">&#160;directory&#160;within&#160;the&#160;installation&#160;path:</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft10621">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft10621">16/24</p>
</div>
<!-- Page 107 -->
<a name="107"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page107-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3107.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft1079">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft1070">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft10721">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:149px;left:159px;white-space:nowrap" class="ft10733"><b>cd&#160;/usr/local/daatoolkit/bin</b></p>
<p style="position:absolute;top:186px;left:110px;white-space:nowrap" class="ft10717">2.&#160;Run&#160;the&#160;</p>
<p style="position:absolute;top:186px;left:207px;white-space:nowrap" class="ft10733"><b>daacred</b></p>
<p style="position:absolute;top:186px;left:277px;white-space:nowrap" class="ft10717">&#160;program,&#160;which&#160;shows&#160;a&#160;complete&#160;run&#160;of&#160;the&#160;full&#160;DAA&#160;protocol&#160;</p>
<p style="position:absolute;top:205px;left:137px;white-space:nowrap" class="ft10719">(Setup,&#160;Join,&#160;Sign&#160;and&#160;Verify)&#160;with&#160;random&#160;parameters&#160;and&#160;save&#160;Issuer&#160;<br/>credentials&#160;in&#160;</p>
<p style="position:absolute;top:225px;left:254px;white-space:nowrap" class="ft10733"><b>mr_daa_issuer.bin</b></p>
<p style="position:absolute;top:225px;left:423px;white-space:nowrap" class="ft10717">&#160;and&#160;Platform&#160;credentials&#160;in&#160;</p>
<p style="position:absolute;top:244px;left:137px;white-space:nowrap" class="ft10733"><b>mr_daa_cred.bin</b></p>
<p style="position:absolute;top:244px;left:287px;white-space:nowrap" class="ft10717">:</p>
<p style="position:absolute;top:281px;left:159px;white-space:nowrap" class="ft10745"><b>export&#160;LD_LIBRARY_PATH=/usr/local/daatoolkit/lib<br/>./daacred</b></p>
<p style="position:absolute;top:337px;left:110px;white-space:nowrap" class="ft10717">3.&#160;Copy&#160;the&#160;generated&#160;credentials&#160;to&#160;</p>
<p style="position:absolute;top:337px;left:426px;white-space:nowrap" class="ft10733"><b>/usr/local/daatoolkit/etc/daa</b></p>
<p style="position:absolute;top:337px;left:714px;white-space:nowrap" class="ft10717">&#160;for&#160;future&#160;</p>
<p style="position:absolute;top:356px;left:137px;white-space:nowrap" class="ft10717">usage:</p>
<p style="position:absolute;top:394px;left:159px;white-space:nowrap" class="ft10745"><b>cp&#160;mr_daa_issuer.bin&#160;/usr/local/daatoolkit/etc/daa<br/>cp&#160;mr_daa_cred.bin&#160;/usr/local/daatoolkit/etc/daa</b></p>
<p style="position:absolute;top:468px;left:83px;white-space:nowrap" class="ft10734"><i><b>7.3&#160;&#160;&#160;Testing&#160;the&#160;DAA-TLS&#160;Extension,&#160;with&#160;Pairing-based&#160;DAA</b></i></p>
<p style="position:absolute;top:499px;left:110px;white-space:nowrap" class="ft10717">1.&#160;Link&#160;the&#160;Miracl-related&#160;credentials:</p>
<p style="position:absolute;top:536px;left:159px;white-space:nowrap" class="ft10745"><b>cd&#160;/usr/local/daatoolkit/etc/daa/<br/>rm&#160;daa_*<br/>ln&#160;-s&#160;mr_daa_cred.bin&#160;daa_cred.bin<br/>ln&#160;-s&#160;mr_daa_issuer.bin&#160;daa_issuer.bin</b></p>
<p style="position:absolute;top:631px;left:110px;white-space:nowrap" class="ft10717">2.&#160;Move&#160;to&#160;the&#160;</p>
<p style="position:absolute;top:631px;left:241px;white-space:nowrap" class="ft10733"><b>bin</b></p>
<p style="position:absolute;top:631px;left:271px;white-space:nowrap" class="ft10717">&#160;directory&#160;within&#160;the&#160;installation&#160;path:</p>
<p style="position:absolute;top:668px;left:159px;white-space:nowrap" class="ft10733"><b>cd&#160;/usr/local/daatoolkit/bin</b></p>
<p style="position:absolute;top:705px;left:110px;white-space:nowrap" class="ft10717">3.&#160;Run&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:705px;left:255px;white-space:nowrap" class="ft10733"><b>s_server</b></p>
<p style="position:absolute;top:705px;left:334px;white-space:nowrap" class="ft10717">&#160;specifying&#160;the&#160;usage&#160;of&#160;the&#160;Engine&#160;Miracl&#160;via&#160;the&#160;</p>
<p style="position:absolute;top:724px;left:137px;white-space:nowrap" class="ft10717">command&#160;line&#160;option&#160;</p>
<p style="position:absolute;top:724px;left:318px;white-space:nowrap" class="ft10733"><b>-engine&#160;miracl</b></p>
<p style="position:absolute;top:724px;left:457px;white-space:nowrap" class="ft10717">:</p>
<p style="position:absolute;top:762px;left:159px;white-space:nowrap" class="ft10745"><b>export&#160;LD_LIBRARY_PATH=/usr/local/daatoolkit/lib<br/>./openssl&#160;s_server&#160;-engine&#160;miracl&#160;\&#160;</b></p>
<p style="position:absolute;top:800px;left:211px;white-space:nowrap" class="ft10733"><b>-daa_issuer&#160;/usr/local/daatoolkit/etc/daa/daa_issuer.bin</b></p>
<p style="position:absolute;top:837px;left:110px;white-space:nowrap" class="ft10717">4.&#160;In&#160;another&#160;shell&#160;window,&#160;in&#160;the&#160;same&#160;working&#160;directory,&#160;run&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:837px;left:715px;white-space:nowrap" class="ft10733"><b>s_client&#160;</b></p>
<p style="position:absolute;top:856px;left:137px;white-space:nowrap" class="ft10717">specifying&#160;the&#160;usage&#160;of&#160;the&#160;Engine&#160;Miracl&#160;via&#160;the&#160;command&#160;line&#160;option&#160;</p>
<p style="position:absolute;top:856px;left:726px;white-space:nowrap" class="ft10733"><b>-engine&#160;</b></p>
<p style="position:absolute;top:875px;left:137px;white-space:nowrap" class="ft10733"><b>miracl</b></p>
<p style="position:absolute;top:875px;left:197px;white-space:nowrap" class="ft10717">:</p>
<p style="position:absolute;top:913px;left:159px;white-space:nowrap" class="ft10745"><b>export&#160;LD_LIBRARY_PATH=/usr/local/daatoolkit/lib<br/>./openssl&#160;s_client&#160;-tls1&#160;-cert&#160;client.pem&#160;-engine&#160;miracl</b></p>
<p style="position:absolute;top:951px;left:211px;white-space:nowrap" class="ft10733"><b>-daa&#160;/usr/local/daatoolkit/etc/daa/daa_cred.bin</b></p>
<p style="position:absolute;top:988px;left:110px;white-space:nowrap" class="ft10717">5.&#160;The&#160;connection&#160;is&#160;established.&#160;Additional&#160;debug&#160;messages&#160;show&#160;the&#160;engine&#160;is&#160;</p>
<p style="position:absolute;top:1007px;left:137px;white-space:nowrap" class="ft10717">working.</p>
<p style="position:absolute;top:1035px;left:110px;white-space:nowrap" class="ft10717">6.&#160;Type&#160;something&#160;in&#160;either&#160;window&#160;and&#160;verify&#160;that&#160;the&#160;transmission&#160;between&#160;</p>
<p style="position:absolute;top:1055px;left:137px;white-space:nowrap" class="ft10717">client&#160;and&#160;server&#160;succeeded.</p>
<p style="position:absolute;top:1083px;left:110px;white-space:nowrap" class="ft10717">7.&#160;Stop&#160;the&#160;client&#160;and&#160;the&#160;server&#160;by&#160;pressing&#160;CTRL+C&#160;and&#160;close&#160;the&#160;second&#160;shell&#160;</p>
<p style="position:absolute;top:1102px;left:137px;white-space:nowrap" class="ft10717">window.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft10721">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft10721">17/24</p>
</div>
<!-- Page 108 -->
<a name="108"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page108-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3108.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft1089">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft1080">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft10821">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft10824"><b>8&#160;&#160;&#160;Legacy&#160;Mode:&#160;Apache&#160;Web&#160;Server</b></p>
<p style="position:absolute;top:200px;left:83px;white-space:nowrap" class="ft10825">This&#160;section&#160;presents&#160;an&#160;advanced&#160;usage&#160;scenario&#160;for&#160;the&#160;TLS&#160;DAA-Enhancement&#160;with&#160;<br/>legacy&#160;applications,&#160;namely&#160;Apache&#160;web&#160;server&#160;and&#160;a&#160;web&#160;browser.&#160;An&#160;HTTPS&#160;<br/>connection&#160;will&#160;be&#160;established&#160;where&#160;a&#160;DAA-TLS&#160;Extension&#160;is&#160;expected&#160;during&#160;the&#160;TLS&#160;<br/>handshake.&#160;For&#160;simplicity&#160;we&#160;refer&#160;to&#160;this&#160;as&#160;HTTPS&#160;DAA-Enhanced&#160;connection&#160;in&#160;the&#160;<br/>sequel.<br/>In&#160;order&#160;to&#160;work&#160;with&#160;legacy,&#160;i.e.&#160;unmodified,&#160;applications&#160;the&#160;TLS&#160;DAA-Enhancement&#160;<br/>supports&#160;the&#160;so&#160;called&#160;Legacy&#160;Mode.&#160;As&#160;detailed&#160;in&#160;[2],&#160;when&#160;the&#160;TLS&#160;DAA-<br/>Enhancement&#160;is&#160;compiled&#160;in&#160;Legacy&#160;Mode,&#160;it&#160;automatically&#160;enables&#160;the&#160;DAA-TLS&#160;<br/>Extension&#160;on&#160;both&#160;client&#160;and&#160;server&#160;and&#160;sets&#160;default&#160;values&#160;for&#160;the&#160;name&#160;of&#160;the&#160;files&#160;<br/>containing&#160;DAA&#160;Issuer&#160;and&#160;Platform&#160;credentials.<br/>In&#160;more&#160;detail,&#160;two&#160;roles&#160;participate&#160;in&#160;the&#160;following&#160;scenario:&#160;a&#160;Server&#160;and&#160;a&#160;Client.<br/>The&#160;Server&#160;runs&#160;an&#160;unmodified&#160;version&#160;of&#160;Apache&#160;web&#160;server&#160;listening&#160;on&#160;the&#160;standard&#160;<br/>HTTPS&#160;port,&#160;which&#160;relies&#160;on&#160;the&#160;OpenSSL&#160;with&#160;TLS&#160;DAA-Enhancement&#160;in&#160;Legacy&#160;Mode&#160;<br/>for&#160;HTTPS&#160;DAA-Enhanced&#160;connections:&#160;when&#160;the&#160;HTTPS&#160;channel&#160;is&#160;opened,&#160;i.e.&#160;the&#160;TLS&#160;<br/>handshake&#160;takes&#160;place,&#160;a&#160;DAA-TLS&#160;Extension&#160;is&#160;expected&#160;from&#160;the&#160;Client.<br/>The&#160;Client&#160;runs&#160;a&#160;web&#160;browser&#160;(in&#160;the&#160;example&#160;below&#160;Firefox,&#160;but&#160;any&#160;browser&#160;can&#160;<br/>indifferently&#160;be&#160;used)&#160;and&#160;an&#160;instance&#160;of&#160;the&#160;Apache&#160;web&#160;server&#160;acting&#160;as&#160;a&#160;reverse&#160;<br/>proxy&#160;and&#160;listening&#160;for&#160;HTTP&#160;connections&#160;on&#160;port&#160;8080.&#160;The&#160;proxy&#160;is&#160;needed&#160;since&#160;the&#160;<br/>majority&#160;of&#160;the&#160;browsers&#160;do&#160;not&#160;rely&#160;on&#160;OpenSSL&#160;for&#160;establishing&#160;HTTPS&#160;connections&#160;<br/>(for&#160;instance&#160;Firefox&#160;relies&#160;on&#160;NSS&#160;library),&#160;while&#160;the&#160;TLS&#160;DAA-Enhancement&#160;is&#160;<br/>designed&#160;for&#160;OpenSSL.&#160;For&#160;the&#160;purpose&#160;of&#160;this&#160;demonstration&#160;browser&#160;and&#160;proxy&#160;are&#160;<br/>seen&#160;as&#160;a&#160;unique&#160;entity,&#160;namely&#160;the&#160;Client,&#160;but&#160;the&#160;proxy&#160;actually&#160;establishes&#160;the&#160;<br/>HTTPS&#160;DAA-Enhanced&#160;connection&#160;with&#160;the&#160;Server.<br/>It&#160;is&#160;important&#160;to&#160;note&#160;that:</p>
<p style="position:absolute;top:720px;left:110px;white-space:nowrap" class="ft10812">●</p>
<p style="position:absolute;top:715px;left:137px;white-space:nowrap" class="ft10819">Both&#160;Client&#160;and&#160;Server&#160;can&#160;coexist&#160;on&#160;a&#160;single&#160;machine,&#160;provided&#160;that&#160;Apache&#160;<br/>web&#160;server&#160;spawns&#160;at&#160;least&#160;two&#160;child&#160;processes&#160;(one&#160;will&#160;act&#160;as&#160;proxy&#160;on&#160;the&#160;<br/>Client,&#160;the&#160;other&#160;as&#160;web&#160;server&#160;on&#160;the&#160;Server).&#160;The&#160;HTTPS&#160;DAA-Enhanced&#160;<br/>connection&#160;will&#160;take&#160;place&#160;over&#160;the&#160;loopback&#160;network&#160;interface&#160;(localhost).&#160;For&#160;<br/>simplicity,&#160;in&#160;this&#160;demonstration&#160;a&#160;single&#160;machine&#160;is&#160;used&#160;both&#160;for&#160;Client&#160;and&#160;<br/>Server;&#160;it&#160;is&#160;straightforward&#160;to&#160;adapt&#160;the&#160;procedure&#160;if&#160;two&#160;machines&#160;are&#160;<br/>available.&#160;</p>
<p style="position:absolute;top:863px;left:110px;white-space:nowrap" class="ft10812">●</p>
<p style="position:absolute;top:859px;left:137px;white-space:nowrap" class="ft10819">RPM&#160;packages&#160;with&#160;Apache&#160;web&#160;server&#160;are&#160;actually&#160;provided.&#160;These&#160;are&#160;<br/>generated&#160;from&#160;the&#160;OpenSuSE&#160;11.1&#160;original&#160;Apache&#160;package.&#160;Apache&#160;web&#160;<br/>server&#160;is&#160;“unmodified”&#160;in&#160;the&#160;sense&#160;that&#160;it&#160;is&#160;only&#160;recompiled&#160;against&#160;OpenSSL&#160;<br/>v0.9.9,&#160;while&#160;in&#160;the&#160;original&#160;OpenSuSE&#160;packages&#160;Apache&#160;is&#160;compiled&#160;against&#160;<br/>OpenSSL&#160;v0.9.8;&#160;actually&#160;a&#160;patch&#160;is&#160;needed&#160;because&#160;of&#160;small&#160;changes&#160;in&#160;the&#160;<br/>OpenSSL&#160;API&#160;that&#160;are&#160;included&#160;in&#160;the&#160;main&#160;Apache&#160;source&#160;tree&#160;since&#160;a&#160;newer&#160;<br/>version&#160;than&#160;the&#160;one&#160;currently&#160;used&#160;by&#160;OpenSuSE&#160;11.1.&#160;However&#160;all&#160;these&#160;<br/>modifications&#160;are&#160;only&#160;needed&#160;to&#160;support&#160;OpenSSL&#160;v0.9.9,&#160;and&#160;they&#160;are&#160;<br/>independent&#160;from&#160;the&#160;TLS&#160;DAA-Enhancement.&#160;This&#160;is&#160;because,&#160;in&#160;this&#160;context,&#160;<br/>Apache&#160;is&#160;considered&#160;“unmodified”.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft10821">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft10821">18/24</p>
</div>
<!-- Page 109 -->
<a name="109"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page109-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3109.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft1099">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft1090">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft10921">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:154px;left:110px;white-space:nowrap" class="ft10912">●</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft10919">In&#160;the&#160;Client,&#160;the&#160;proxy&#160;is&#160;actually&#160;a&#160;reverse&#160;proxy,&#160;which&#160;is&#160;not&#160;the&#160;usual&#160;way&#160;of&#160;<br/>using&#160;a&#160;proxy&#160;(forward&#160;proxy)&#160;for&#160;HTTPS&#160;connections;&#160;moreover&#160;a&#160;reverse&#160;proxy&#160;<br/>is&#160;usually&#160;installed&#160;in&#160;the&#160;neighborhood&#160;of&#160;the&#160;server,&#160;not&#160;on&#160;the&#160;client.&#160;As&#160;<br/>already&#160;mentioned&#160;the&#160;proxy&#160;is&#160;a&#160;trick&#160;whose&#160;only&#160;purpose&#160;is&#160;to&#160;achieve&#160;a&#160;Client&#160;<br/>which&#160;makes&#160;HTTPS&#160;connections&#160;with&#160;OpenSSL&#160;to&#160;use&#160;the&#160;DAA&#160;enhancement,&#160;<br/>while&#160;standard&#160;browsers&#160;do&#160;not.</p>
<p style="position:absolute;top:273px;left:83px;white-space:nowrap" class="ft10919">The&#160;remaining&#160;of&#160;this&#160;section&#160;is&#160;organized&#160;as&#160;follows:&#160;first&#160;recompile&#160;OpenSSL&#160;and&#160;in&#160;<br/>particular&#160;the&#160;TLS&#160;DAA-Enhancement&#160;in&#160;Legacy&#160;Mode;&#160;then&#160;install&#160;and&#160;properly&#160;<br/>configure&#160;Apache&#160;web&#160;server,&#160;as&#160;web&#160;server&#160;on&#160;the&#160;Server&#160;and&#160;as&#160;reverse&#160;proxy&#160;on&#160;the&#160;<br/>Client;&#160;finally&#160;test&#160;the&#160;connection&#160;with&#160;a&#160;web&#160;browser</p>
<p style="position:absolute;top:377px;left:83px;white-space:nowrap" class="ft10934"><i><b>8.1&#160;&#160;&#160;Rebuilding&#160;OpenSSL&#160;with&#160;DAA&#160;Support&#160;in&#160;Legacy&#160;Mode</b></i></p>
<p style="position:absolute;top:409px;left:110px;white-space:nowrap" class="ft10917">1.&#160;Return&#160;into&#160;the&#160;</p>
<p style="position:absolute;top:409px;left:268px;white-space:nowrap" class="ft10933"><b>openssl-daa</b></p>
<p style="position:absolute;top:409px;left:377px;white-space:nowrap" class="ft10917">&#160;directory.&#160;Here&#160;it&#160;is&#160;assumed&#160;that&#160;OpenSSL&#160;with&#160;</p>
<p style="position:absolute;top:428px;left:137px;white-space:nowrap" class="ft10917">DAA&#160;support&#160;has&#160;already&#160;been&#160;installed:</p>
<p style="position:absolute;top:465px;left:159px;white-space:nowrap" class="ft10933"><b>cd&#160;TEMPDIR/openssl-daa/openssl-SNAP-20081204</b></p>
<p style="position:absolute;top:502px;left:110px;white-space:nowrap" class="ft10917">2.&#160;Prepare&#160;OpenSSL:</p>
<p style="position:absolute;top:539px;left:159px;white-space:nowrap" class="ft10933"><b>./config&#160;--prefix=/usr/local/daatoolkit&#160;-shared&#160;\</b></p>
<p style="position:absolute;top:558px;left:211px;white-space:nowrap" class="ft10933"><b>-DTLSEXT_DAA_LEGACY_MODE</b></p>
<p style="position:absolute;top:595px;left:137px;white-space:nowrap" class="ft10917">where&#160;the&#160;option&#160;</p>
<p style="position:absolute;top:595px;left:284px;white-space:nowrap" class="ft10933"><b>-DTLSEXT_DAA_LEGACY_MODE</b></p>
<p style="position:absolute;top:595px;left:522px;white-space:nowrap" class="ft10917">&#160;enables&#160;the&#160;Legacy&#160;Mode&#160;at&#160;the&#160;</p>
<p style="position:absolute;top:615px;left:137px;white-space:nowrap" class="ft10917">next&#160;compilation.</p>
<p style="position:absolute;top:643px;left:110px;white-space:nowrap" class="ft10917">3.&#160;Recompile&#160;and&#160;install:</p>
<p style="position:absolute;top:680px;left:159px;white-space:nowrap" class="ft10945"><b>make&#160;clean<br/>make<br/>make&#160;install</b></p>
<p style="position:absolute;top:755px;left:110px;white-space:nowrap" class="ft10917">4.&#160;Verify&#160;that&#160;the&#160;installation&#160;was&#160;correct&#160;by&#160;running&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:755px;left:634px;white-space:nowrap" class="ft10933"><b>s_server</b></p>
<p style="position:absolute;top:755px;left:713px;white-space:nowrap" class="ft10917">&#160;and&#160;</p>
<p style="position:absolute;top:775px;left:137px;white-space:nowrap" class="ft10933"><b>s_client</b></p>
<p style="position:absolute;top:775px;left:217px;white-space:nowrap" class="ft10917">&#160;as&#160;done&#160;in&#160;the&#160;previous&#160;sections.&#160;Since&#160;Legacy&#160;Mode&#160;automatically&#160;</p>
<p style="position:absolute;top:794px;left:137px;white-space:nowrap" class="ft10919">enables&#160;the&#160;DAA-TLS&#160;Extension&#160;and&#160;sets&#160;the&#160;name&#160;of&#160;the&#160;files&#160;containing&#160;the&#160;<br/>DAA&#160;Issuer&#160;and&#160;Platform&#160;credentials,&#160;it&#160;is&#160;sufficient&#160;to&#160;run&#160;the&#160;commands&#160;without&#160;<br/>DAA-related&#160;command&#160;line&#160;options.&#160;The&#160;following&#160;example&#160;uses&#160;the&#160;Engine&#160;<br/>Miracl&#160;(but&#160;any&#160;other&#160;similar&#160;example&#160;can&#160;be&#160;done&#160;as&#160;well).</p>
<p style="position:absolute;top:880px;left:164px;white-space:nowrap" class="ft10917">1.&#160;Link&#160;the&#160;Miracl-related&#160;credentials:</p>
<p style="position:absolute;top:917px;left:191px;white-space:nowrap" class="ft10945"><b>cd&#160;/usr/local/daatoolkit/etc/daa/<br/>rm&#160;daa_*<br/>ln&#160;-s&#160;mr_daa_cred.bin&#160;daa_cred.bin<br/>ln&#160;-s&#160;mr_daa_issuer.bin&#160;daa_issuer.bin</b></p>
<p style="position:absolute;top:1011px;left:164px;white-space:nowrap" class="ft10917">2.&#160;Move&#160;to&#160;the&#160;</p>
<p style="position:absolute;top:1011px;left:294px;white-space:nowrap" class="ft10933"><b>bin</b></p>
<p style="position:absolute;top:1011px;left:324px;white-space:nowrap" class="ft10917">&#160;directory&#160;within&#160;the&#160;installation&#160;path:</p>
<p style="position:absolute;top:1048px;left:191px;white-space:nowrap" class="ft10933"><b>cd&#160;/usr/local/daatoolkit/bin</b></p>
<p style="position:absolute;top:1086px;left:164px;white-space:nowrap" class="ft10917">3.&#160;Run&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:1086px;left:308px;white-space:nowrap" class="ft10933"><b>s_server</b></p>
<p style="position:absolute;top:1086px;left:387px;white-space:nowrap" class="ft10917">&#160;specifying&#160;the&#160;usage&#160;of&#160;the&#160;Engine&#160;Miracl&#160;via&#160;the&#160;</p>
<p style="position:absolute;top:1105px;left:191px;white-space:nowrap" class="ft10917">command&#160;line&#160;option&#160;</p>
<p style="position:absolute;top:1105px;left:371px;white-space:nowrap" class="ft10933"><b>-engine&#160;miracl</b></p>
<p style="position:absolute;top:1105px;left:510px;white-space:nowrap" class="ft10917">:</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft10921">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft10921">19/24</p>
</div>
<!-- Page 110 -->
<a name="110"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page110-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3110.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft1109">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft1100">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft11021">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:149px;left:191px;white-space:nowrap" class="ft11045"><b>export&#160;LD_LIBRARY_PATH=/usr/local/daatoolkit/lib<br/>./openssl&#160;s_server&#160;-engine&#160;miracl</b></p>
<p style="position:absolute;top:205px;left:164px;white-space:nowrap" class="ft11017">4.&#160;In&#160;another&#160;shell&#160;window,&#160;in&#160;the&#160;same&#160;working&#160;directory,&#160;run&#160;OpenSSL&#160;</p>
<p style="position:absolute;top:225px;left:191px;white-space:nowrap" class="ft11033"><b>s_client</b></p>
<p style="position:absolute;top:225px;left:270px;white-space:nowrap" class="ft11017">&#160;specifying&#160;the&#160;usage&#160;of&#160;the&#160;Engine&#160;Miracl&#160;via&#160;the&#160;command&#160;line&#160;</p>
<p style="position:absolute;top:244px;left:191px;white-space:nowrap" class="ft11017">option&#160;</p>
<p style="position:absolute;top:244px;left:248px;white-space:nowrap" class="ft11033"><b>-engine&#160;miracl</b></p>
<p style="position:absolute;top:244px;left:387px;white-space:nowrap" class="ft11017">:</p>
<p style="position:absolute;top:281px;left:191px;white-space:nowrap" class="ft11045"><b>export&#160;LD_LIBRARY_PATH=/usr/local/daatoolkit/lib<br/>./openssl&#160;s_client&#160;-tls1&#160;-cert&#160;client.pem&#160;-engine&#160;miracl</b></p>
<p style="position:absolute;top:337px;left:164px;white-space:nowrap" class="ft11017">5.&#160;Type&#160;something&#160;in&#160;either&#160;window&#160;and&#160;verify&#160;that&#160;the&#160;transmission&#160;</p>
<p style="position:absolute;top:356px;left:191px;white-space:nowrap" class="ft11017">between&#160;client&#160;and&#160;server&#160;succeeded.</p>
<p style="position:absolute;top:385px;left:164px;white-space:nowrap" class="ft11017">6.&#160;Stop&#160;the&#160;client&#160;and&#160;the&#160;server&#160;by&#160;pressing&#160;CTRL+C&#160;and&#160;close&#160;the&#160;second&#160;</p>
<p style="position:absolute;top:404px;left:191px;white-space:nowrap" class="ft11017">shell&#160;window.</p>
<p style="position:absolute;top:450px;left:83px;white-space:nowrap" class="ft11034"><i><b>8.2&#160;&#160;&#160;Installing&#160;and&#160;Configuring&#160;Apache&#160;Web&#160;Server</b></i></p>
<p style="position:absolute;top:481px;left:110px;white-space:nowrap" class="ft11017">1.&#160;Move&#160;to&#160;the&#160;</p>
<p style="position:absolute;top:481px;left:241px;white-space:nowrap" class="ft11033"><b>apache-daa</b></p>
<p style="position:absolute;top:481px;left:341px;white-space:nowrap" class="ft11017">&#160;directory:</p>
<p style="position:absolute;top:519px;left:159px;white-space:nowrap" class="ft11033"><b>cd&#160;TEMPDIR/apache-daa</b></p>
<p style="position:absolute;top:556px;left:110px;white-space:nowrap" class="ft11017">2.&#160;Install&#160;Apache2&#160;RPM&#160;packages&#160;(it&#160;is&#160;assumed&#160;that&#160;Apache2&#160;is&#160;not&#160;already&#160;</p>
<p style="position:absolute;top:575px;left:137px;white-space:nowrap" class="ft11017">installed&#160;in&#160;the&#160;system):</p>
<p style="position:absolute;top:612px;left:159px;white-space:nowrap" class="ft11033"><b>rpm&#160;-i&#160;--nodeps&#160;*.rpm</b></p>
<p style="position:absolute;top:649px;left:110px;white-space:nowrap" class="ft11017">3.&#160;Copy&#160;the&#160;configuration&#160;files&#160;for&#160;the&#160;virtual&#160;host&#160;in&#160;</p>
<p style="position:absolute;top:649px;left:550px;white-space:nowrap" class="ft11033"><b>/etc/apache2/vhosts.d</b></p>
<p style="position:absolute;top:649px;left:759px;white-space:nowrap" class="ft11017">:&#160;</p>
<p style="position:absolute;top:668px;left:137px;white-space:nowrap" class="ft11033"><b>proxy.conf</b></p>
<p style="position:absolute;top:668px;left:237px;white-space:nowrap" class="ft11017">&#160;for&#160;the&#160;Client&#160;proxy,&#160;</p>
<p style="position:absolute;top:668px;left:413px;white-space:nowrap" class="ft11033"><b>ssl.conf</b></p>
<p style="position:absolute;top:668px;left:492px;white-space:nowrap" class="ft11017">&#160;for&#160;the&#160;Server:</p>
<p style="position:absolute;top:705px;left:159px;white-space:nowrap" class="ft11033"><b>cp&#160;proxy.conf&#160;ssl.conf&#160;/etc/apache2/vhosts.d</b></p>
<p style="position:absolute;top:742px;left:110px;white-space:nowrap" class="ft11017">4.&#160;Enable&#160;Proxy&#160;SSL&#160;support,&#160;according&#160;to&#160;OpenSuSE&#160;methodology:</p>
<p style="position:absolute;top:780px;left:159px;white-space:nowrap" class="ft11045"><b>a2enmod&#160;proxy<br/>a2enmod&#160;proxy_http<br/>a2enmod&#160;ssl<br/>a2enflag&#160;SSL</b></p>
<p style="position:absolute;top:874px;left:110px;white-space:nowrap" class="ft11017">5.&#160;Generate&#160;certificates&#160;for&#160;the&#160;Server,&#160;according&#160;to&#160;OpenSuSE&#160;methodology:</p>
<p style="position:absolute;top:911px;left:159px;white-space:nowrap" class="ft11033"><b>gensslcert</b></p>
<p style="position:absolute;top:948px;left:110px;white-space:nowrap" class="ft11017">6.&#160;Finally&#160;start&#160;Apache.&#160;Note&#160;that&#160;it&#160;is&#160;necessary&#160;to&#160;specify&#160;the&#160;library&#160;path&#160;to&#160;let&#160;</p>
<p style="position:absolute;top:968px;left:137px;white-space:nowrap" class="ft11017">Apache&#160;find&#160;the&#160;OpenSSL&#160;libraries&#160;with&#160;DAA&#160;support&#160;(</p>
<p style="position:absolute;top:968px;left:581px;white-space:nowrap" class="ft11033"><b>libssl</b></p>
<p style="position:absolute;top:968px;left:640px;white-space:nowrap" class="ft11017">&#160;and&#160;</p>
<p style="position:absolute;top:968px;left:682px;white-space:nowrap" class="ft11033"><b>libcrypto</b></p>
<p style="position:absolute;top:968px;left:771px;white-space:nowrap" class="ft11017">):</p>
<p style="position:absolute;top:1005px;left:159px;white-space:nowrap" class="ft11045"><b>export&#160;LD_LIBRARY_PATH=/usr/local/daatoolkit/lib<br/>rcapache2&#160;start</b></p>
<p style="position:absolute;top:1079px;left:83px;white-space:nowrap" class="ft11034"><i><b>8.3&#160;&#160;&#160;Testing&#160;the&#160;Advanced&#160;Scenario</b></i></p>
<p style="position:absolute;top:1110px;left:110px;white-space:nowrap" class="ft11017">1.&#160;Open&#160;a&#160;web&#160;browser,&#160;for&#160;instance&#160;Firefox.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft11021">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft11021">20/24</p>
</div>
<!-- Page 111 -->
<a name="111"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page111-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3111.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft1119">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft1110">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft11121">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:149px;left:110px;white-space:nowrap" class="ft11117">2.&#160;In&#160;an&#160;independent&#160;shell&#160;window,&#160;monitor&#160;the&#160;Apache&#160;log:</p>
<p style="position:absolute;top:186px;left:159px;white-space:nowrap" class="ft11133"><b>tail&#160;-F&#160;/var/log/apache2/*</b></p>
<p style="position:absolute;top:223px;left:110px;white-space:nowrap" class="ft11117">3.&#160;Connect&#160;to&#160;the&#160;Server&#160;via&#160;HTTP,&#160;to&#160;check&#160;that&#160;Apache&#160;is&#160;working&#160;properly.&#160;Type&#160;</p>
<p style="position:absolute;top:243px;left:137px;white-space:nowrap" class="ft11117">in&#160;the&#160;URL&#160;bar:</p>
<p style="position:absolute;top:280px;left:159px;white-space:nowrap" class="ft11133"><b>http://localhost/</b></p>
<p style="position:absolute;top:317px;left:110px;white-space:nowrap" class="ft11117">4.&#160;Connect&#160;to&#160;the&#160;Server&#160;via&#160;HTTPS.&#160;Again&#160;this&#160;is&#160;to&#160;check&#160;that&#160;Apache&#160;is&#160;working&#160;</p>
<p style="position:absolute;top:336px;left:137px;white-space:nowrap" class="ft11119">properly&#160;and&#160;this&#160;connection&#160;is&#160;not&#160;an&#160;HTTPS&#160;DAA-Enhanced&#160;connection.&#160;Type&#160;in&#160;<br/>the&#160;URL&#160;bar&#160;(please&#160;note&#160;the&#160;final&#160;'s'&#160;of&#160;the&#160;prefix&#160;'https'):</p>
<p style="position:absolute;top:392px;left:159px;white-space:nowrap" class="ft11133"><b>https://localhost/</b></p>
<p style="position:absolute;top:429px;left:110px;white-space:nowrap" class="ft11117">5.&#160;Let&#160;the&#160;browser&#160;contact&#160;the&#160;proxy.&#160;This&#160;forces&#160;the&#160;proxy&#160;(which&#160;is&#160;a&#160;component&#160;</p>
<p style="position:absolute;top:448px;left:137px;white-space:nowrap" class="ft11119">of&#160;the&#160;Client&#160;in&#160;this&#160;demonstration)&#160;to&#160;open&#160;a&#160;HTTPS&#160;DAA-Enhanced&#160;connection&#160;<br/>to&#160;the&#160;Server.&#160;Type&#160;in&#160;the&#160;URL&#160;bar&#160;(please&#160;note&#160;that&#160;the&#160;prefix&#160;is&#160;again&#160;'http'):</p>
<p style="position:absolute;top:505px;left:159px;white-space:nowrap" class="ft11133"><b>http://localhost:8080/</b></p>
<p style="position:absolute;top:542px;left:137px;white-space:nowrap" class="ft11119">In&#160;the&#160;monitoring&#160;shell&#160;window&#160;debug&#160;messages&#160;show&#160;that&#160;the&#160;TLS-DAA&#160;<br/>Extension&#160;is&#160;enabled.&#160;Note&#160;that&#160;Apache&#160;prints&#160;the&#160;debug&#160;messages&#160;of&#160;the&#160;TLS-<br/>DAA&#160;Extension&#160;only&#160;after&#160;it&#160;has&#160;been&#160;stopped;&#160;therefore&#160;in&#160;order&#160;to&#160;see&#160;the&#160;<br/>debug&#160;log,&#160;run:</p>
<p style="position:absolute;top:637px;left:159px;white-space:nowrap" class="ft11133"><b>rcapache2&#160;stop</b></p>
<p style="position:absolute;top:674px;left:83px;white-space:nowrap" class="ft11119">Steps&#160;from&#160;3&#160;to&#160;5&#160;can&#160;be&#160;repeated&#160;to&#160;experiment&#160;with&#160;the&#160;engines.&#160;In&#160;order&#160;to&#160;test&#160;the&#160;<br/>TPM-DAA&#160;Engine&#160;before&#160;repeating&#160;those&#160;steps&#160;it&#160;is&#160;necessary&#160;to&#160;perform&#160;the&#160;following&#160;<br/>operations.</p>
<p style="position:absolute;top:740px;left:110px;white-space:nowrap" class="ft11117">1.&#160;Link&#160;the&#160;TPM-related&#160;credentials:</p>
<p style="position:absolute;top:777px;left:159px;white-space:nowrap" class="ft11145"><b>cd&#160;/usr/local/daatoolkit/etc/daa/<br/>rm&#160;daa_*<br/>ln&#160;-s&#160;tpm_daa_cred.bin&#160;daa_cred.bin<br/>ln&#160;-s&#160;tpm_daa_issuer.bin&#160;daa_issuer.bin</b></p>
<p style="position:absolute;top:872px;left:110px;white-space:nowrap" class="ft11117">2.&#160;Edit&#160;the&#160;following&#160;file&#160;which&#160;contains&#160;global&#160;directives&#160;to&#160;configure&#160;</p>
<p style="position:absolute;top:872px;left:692px;white-space:nowrap" class="ft11133"><b>mod_ssl</b></p>
<p style="position:absolute;top:872px;left:761px;white-space:nowrap" class="ft11117">:</p>
<p style="position:absolute;top:909px;left:159px;white-space:nowrap" class="ft11133"><b>/etc/apache2/ssl-global.conf</b></p>
<p style="position:absolute;top:946px;left:137px;white-space:nowrap" class="ft11117">and&#160;add&#160;a&#160;line&#160;soon&#160;after&#160;the&#160;tag&#160;</p>
<p style="position:absolute;top:946px;left:414px;white-space:nowrap" class="ft11133"><b>&lt;IfModule&#160;mod_ssl.c&gt;</b></p>
<p style="position:absolute;top:946px;left:613px;white-space:nowrap" class="ft11117">&#160;with&#160;the&#160;</p>
<p style="position:absolute;top:965px;left:137px;white-space:nowrap" class="ft11133"><b>SSLCryptoDevice</b></p>
<p style="position:absolute;top:965px;left:287px;white-space:nowrap" class="ft11117">&#160;directive&#160;that&#160;allows&#160;specifying&#160;the&#160;</p>
<p style="position:absolute;top:965px;left:586px;white-space:nowrap" class="ft11133"><b>tpmdaa</b></p>
<p style="position:absolute;top:965px;left:646px;white-space:nowrap" class="ft11117">&#160;engine:</p>
<p style="position:absolute;top:1003px;left:159px;white-space:nowrap" class="ft11133"><b>SSLCryptoDevice&#160;tpmdaa</b></p>
<p style="position:absolute;top:1040px;left:110px;white-space:nowrap" class="ft11117">3.&#160;Restart&#160;Apache</p>
<p style="position:absolute;top:1077px;left:159px;white-space:nowrap" class="ft11133"><b>rcapache2&#160;restart</b></p>
<p style="position:absolute;top:1114px;left:83px;white-space:nowrap" class="ft11117">The&#160;experiment&#160;will&#160;take&#160;some&#160;time&#160;while&#160;TPM&#160;executes&#160;DAA&#160;operations.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft11121">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft11121">21/24</p>
</div>
<!-- Page 112 -->
<a name="112"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page112-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3112.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft1129">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft1120">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft11221">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft11217">The&#160;case&#160;for&#160;the&#160;Miracl&#160;Engine&#160;is&#160;analogous.</p>
<p style="position:absolute;top:177px;left:110px;white-space:nowrap" class="ft11217">1.&#160;Link&#160;the&#160;Miracl&#160;-related&#160;credentials:</p>
<p style="position:absolute;top:214px;left:159px;white-space:nowrap" class="ft11245"><b>cd&#160;/usr/local/daatoolkit/etc/daa/<br/>rm&#160;daa_*<br/>ln&#160;-s&#160;mr_daa_cred.bin&#160;daa_cred.bin<br/>ln&#160;-s&#160;mr_daa_issuer.bin&#160;daa_issuer.bin</b></p>
<p style="position:absolute;top:309px;left:110px;white-space:nowrap" class="ft11217">2.&#160;Edit&#160;the&#160;following&#160;file&#160;which&#160;contains&#160;global&#160;directives&#160;to&#160;configure&#160;</p>
<p style="position:absolute;top:309px;left:692px;white-space:nowrap" class="ft11233"><b>mod_ssl</b></p>
<p style="position:absolute;top:309px;left:761px;white-space:nowrap" class="ft11217">:</p>
<p style="position:absolute;top:346px;left:159px;white-space:nowrap" class="ft11233"><b>/etc/apache2/ssl-global.conf</b></p>
<p style="position:absolute;top:383px;left:137px;white-space:nowrap" class="ft11217">and&#160;add&#160;a&#160;line&#160;soon&#160;after&#160;the&#160;tag&#160;</p>
<p style="position:absolute;top:383px;left:414px;white-space:nowrap" class="ft11233"><b>&lt;IfModule&#160;mod_ssl.c&gt;</b></p>
<p style="position:absolute;top:383px;left:613px;white-space:nowrap" class="ft11217">&#160;with&#160;the&#160;</p>
<p style="position:absolute;top:403px;left:137px;white-space:nowrap" class="ft11233"><b>SSLCryptoDevice</b></p>
<p style="position:absolute;top:403px;left:287px;white-space:nowrap" class="ft11217">&#160;directive&#160;that&#160;allows&#160;specifying&#160;the&#160;</p>
<p style="position:absolute;top:403px;left:586px;white-space:nowrap" class="ft11233"><b>miracl</b></p>
<p style="position:absolute;top:403px;left:646px;white-space:nowrap" class="ft11217">&#160;engine:</p>
<p style="position:absolute;top:440px;left:159px;white-space:nowrap" class="ft11233"><b>SSLCryptoDevice&#160;miracl</b></p>
<p style="position:absolute;top:477px;left:110px;white-space:nowrap" class="ft11217">3.&#160;Restart&#160;Apache:</p>
<p style="position:absolute;top:514px;left:159px;white-space:nowrap" class="ft11233"><b>rcapache2&#160;restart</b></p>
<p style="position:absolute;top:551px;left:83px;white-space:nowrap" class="ft11219">Note&#160;that&#160;either&#160;'SSLCryptoDevice&#160;miracl'&#160;or&#160;'SSLCryptoDevice&#160;tpmdaa'&#160;can&#160;be&#160;present&#160;<br/>in&#160;the&#160;file,&#160;not&#160;both&#160;of&#160;them.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft11221">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft11221">22/24</p>
</div>
<!-- Page 113 -->
<a name="113"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page113-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3113.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft1139">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft1130">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft11321">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft11324"><b>9&#160;&#160;&#160;List&#160;of&#160;abbreviations</b></p>
<p style="position:absolute;top:200px;left:83px;white-space:nowrap" class="ft11319">Listing&#160;of&#160;term&#160;definitions&#160;and&#160;abbreviations&#160;used&#160;in&#160;this&#160;document&#160;(IT&#160;expressions&#160;and&#160;<br/>terms&#160;from&#160;the&#160;application&#160;domain).</p>
<p style="position:absolute;top:258px;left:93px;white-space:nowrap" class="ft11316"><b>Abbreviation</b></p>
<p style="position:absolute;top:258px;left:301px;white-space:nowrap" class="ft11316"><b>Explanation</b></p>
<p style="position:absolute;top:277px;left:93px;white-space:nowrap" class="ft11317">AIK</p>
<p style="position:absolute;top:277px;left:301px;white-space:nowrap" class="ft11317">Attestation&#160;Identity&#160;Key</p>
<p style="position:absolute;top:297px;left:93px;white-space:nowrap" class="ft11317">EK</p>
<p style="position:absolute;top:297px;left:301px;white-space:nowrap" class="ft11317">Endorsement&#160;Key</p>
<p style="position:absolute;top:316px;left:93px;white-space:nowrap" class="ft11317">DAA</p>
<p style="position:absolute;top:316px;left:301px;white-space:nowrap" class="ft11317">Direct&#160;Anonymous&#160;Attestation</p>
<p style="position:absolute;top:335px;left:93px;white-space:nowrap" class="ft11317">SRK</p>
<p style="position:absolute;top:335px;left:301px;white-space:nowrap" class="ft11317">Storage&#160;Root&#160;Key</p>
<p style="position:absolute;top:354px;left:93px;white-space:nowrap" class="ft11317">TCG</p>
<p style="position:absolute;top:354px;left:301px;white-space:nowrap" class="ft11317">Trusted&#160;Computing&#160;Group</p>
<p style="position:absolute;top:374px;left:93px;white-space:nowrap" class="ft11317">TLS</p>
<p style="position:absolute;top:374px;left:301px;white-space:nowrap" class="ft11317">Transport&#160;Layer&#160;Security</p>
<p style="position:absolute;top:393px;left:93px;white-space:nowrap" class="ft11317">TPM</p>
<p style="position:absolute;top:393px;left:301px;white-space:nowrap" class="ft11317">Trusted&#160;Platform&#160;Module</p>
<p style="position:absolute;top:412px;left:93px;white-space:nowrap" class="ft11317">TSS</p>
<p style="position:absolute;top:412px;left:301px;white-space:nowrap" class="ft11317">TCG&#160;Software&#160;Stack</p>
<p style="position:absolute;top:478px;left:83px;white-space:nowrap" class="ft11324"><b>10&#160;&#160;&#160;Referenced&#160;Documents</b></p>
<p style="position:absolute;top:511px;left:83px;white-space:nowrap" class="ft11317">/1/&#160;OpenTC&#160;D03c.3&#160;SSL/TLS&#160;DAA-enhancement&#160;specification</p>
<p style="position:absolute;top:549px;left:83px;white-space:nowrap" class="ft11317">/2/&#160;OpenTC&#160;OpenSSL&#160;engine/DAA&#160;enhancement&#160;design&#160;specification</p>
<p style="position:absolute;top:588px;left:83px;white-space:nowrap" class="ft11319">/3/&#160;TCG&#160;TPM&#160;Main&#160;Specification&#160;(parts&#160;1,2,3)<br/>July&#160;9,&#160;2007,<br/>Version&#160;1.2&#160;Level&#160;2&#160;Revision&#160;103</p>
<p style="position:absolute;top:665px;left:83px;white-space:nowrap" class="ft11319">/4/&#160;TCG&#160;Software&#160;Stack&#160;(TSS)&#160;Specification<br/>March&#160;7,&#160;2007,&#160;<br/>Version&#160;1.2,&#160;Level&#160;1,&#160;Errata&#160;A</p>
<p style="position:absolute;top:741px;left:83px;white-space:nowrap" class="ft11319">/5/&#160;IETF&#160;RFC&#160;4346,&#160;The&#160;Transport&#160;Layer&#160;Security&#160;(TLS)&#160;Protocol&#160;Version&#160;1.1<br/>April,&#160;2006</p>
<p style="position:absolute;top:799px;left:83px;white-space:nowrap" class="ft11319">/6/&#160;IETF&#160;RFC&#160;4366,&#160;Transport&#160;Layer&#160;Security&#160;(TLS)&#160;Extensions<br/>April,&#160;2006</p>
<p style="position:absolute;top:857px;left:83px;white-space:nowrap" class="ft11319">/7/&#160;IETF&#160;RFC&#160;4680,&#160;TLS&#160;Handshake&#160;Message&#160;for&#160;Supplemental&#160;Data<br/>September,&#160;2006</p>
<p style="position:absolute;top:914px;left:83px;white-space:nowrap" class="ft11319">/8/&#160;Direct&#160;Anonymous&#160;Attestation<br/>Ernie&#160;Brickell,&#160;Jan&#160;Camenisch,&#160;Liqun&#160;Chen<br/>CCS&#160;'04:&#160;11th&#160;ACM&#160;conference&#160;on&#160;Computer&#160;and&#160;Communications&#160;Security<br/>2004</p>
<p style="position:absolute;top:1010px;left:83px;white-space:nowrap" class="ft11317">/9/&#160;Simplified&#160;Security&#160;Notions&#160;of&#160;Direct&#160;Anonymous&#160;Attestation&#160;and&#160;a&#160;Concrete&#160;</p>
<p style="position:absolute;top:1029px;left:105px;white-space:nowrap" class="ft11319">Scheme&#160;from&#160;Pairings<br/>Ernie&#160;Brickell,&#160;Liqun&#160;Chen,&#160;Jiangtao&#160;Li<br/>Trust08<br/>2008</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft11321">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft11321">23/24</p>
</div>
<!-- Page 114 -->
<a name="114"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page114-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3114.png" alt="background image"/>
<p style="position:absolute;top:128px;left:87px;white-space:nowrap" class="ft1149">&#160;</p>
<p style="position:absolute;top:85px;left:87px;white-space:nowrap" class="ft1140">&#160;</p>
<p style="position:absolute;top:92px;left:186px;white-space:nowrap" class="ft11421">OpenSSL&#160;engine/DAA&#160;enhancement&#160;source&#160;code&#160;and&#160;documentation&#160;&#160;FINAL&#160;|&#160;1.00</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft11417">/10/&#160;Pairings&#160;in&#160;Trusted&#160;Computing</p>
<p style="position:absolute;top:168px;left:105px;white-space:nowrap" class="ft11419">Liqun&#160;Chen,&#160;Paul&#160;Morrissey,&#160;Nigel&#160;P.&#160;Smart<br/>Pairing&#160;2008<br/>2008</p>
<p style="position:absolute;top:245px;left:83px;white-space:nowrap" class="ft11417">/11/&#160;Miracl&#160;–&#160;Multiprecision&#160;Integer&#160;and&#160;Rational&#160;Arithmetic&#160;C/C++&#160;Library&#160;</p>
<p style="position:absolute;top:264px;left:105px;white-space:nowrap" class="ft11419">(http://ftp.computing.dcu.ie/pub/crypto/miracl.zip)<br/>Mike&#160;Scott<br/>2007</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft11421">Open_TC&#160;Deliverable&#160;03c.12</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft11421">24/24</p>
</div>
<!-- Page 115 -->
<a name="115"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page115-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3115.png" alt="background image"/>
<p style="position:absolute;top:137px;left:92px;white-space:nowrap" class="ft1150">&#160;</p>
<p style="position:absolute;top:76px;left:91px;white-space:nowrap" class="ft1151">&#160;</p>
<p style="position:absolute;top:242px;left:129px;white-space:nowrap" class="ft11515"><b>D03c.9&#160;Enhancement&#160;of&#160;Key&#160;Management&#160;</b></p>
<p style="position:absolute;top:273px;left:311px;white-space:nowrap" class="ft11515"><b>Adaptation&#160;(KMA)</b></p>
<p style="position:absolute;top:305px;left:143px;white-space:nowrap" class="ft11515"><b>service&#160;source&#160;code&#160;and&#160;documentation</b></p>
<p style="position:absolute;top:382px;left:91px;white-space:nowrap" class="ft11516"><b>Project&#160;number</b></p>
<p style="position:absolute;top:382px;left:425px;white-space:nowrap" class="ft11517">IST-&#160;027635</p>
<p style="position:absolute;top:408px;left:91px;white-space:nowrap" class="ft11516"><b>Project&#160;acronym</b></p>
<p style="position:absolute;top:408px;left:425px;white-space:nowrap" class="ft11517">Open_TC</p>
<p style="position:absolute;top:433px;left:91px;white-space:nowrap" class="ft11516"><b>Project&#160;title</b></p>
<p style="position:absolute;top:433px;left:425px;white-space:nowrap" class="ft11517">Open&#160;Trusted&#160;Computing</p>
<p style="position:absolute;top:459px;left:91px;white-space:nowrap" class="ft11516"><b>Deliverable&#160;type</b></p>
<p style="position:absolute;top:459px;left:425px;white-space:nowrap" class="ft11517">Internal&#160;document</p>
<p style="position:absolute;top:502px;left:91px;white-space:nowrap" class="ft11516"><b>Deliverable&#160;reference&#160;number</b></p>
<p style="position:absolute;top:502px;left:425px;white-space:nowrap" class="ft11517">IST-027635/D03c.9/FINAL&#160;1.10</p>
<p style="position:absolute;top:534px;left:91px;white-space:nowrap" class="ft11516"><b>Deliverable&#160;title</b></p>
<p style="position:absolute;top:524px;left:425px;white-space:nowrap" class="ft11519">Key&#160;Management&#160;Adaptation&#160;(KMA)&#160;service&#160;<br/>source&#160;code&#160;and&#160;documentation</p>
<p style="position:absolute;top:566px;left:91px;white-space:nowrap" class="ft11516"><b>WP&#160;contributing&#160;to&#160;the&#160;deliverable</b></p>
<p style="position:absolute;top:566px;left:425px;white-space:nowrap" class="ft11517">WP3</p>
<p style="position:absolute;top:591px;left:91px;white-space:nowrap" class="ft11516"><b>Due&#160;date</b></p>
<p style="position:absolute;top:591px;left:425px;white-space:nowrap" class="ft11517">Apr&#160;2008&#160;-&#160;M30</p>
<p style="position:absolute;top:617px;left:91px;white-space:nowrap" class="ft11516"><b>Actual&#160;submission&#160;date</b></p>
<p style="position:absolute;top:617px;left:425px;white-space:nowrap" class="ft11517">May&#160;2009&#160;(revised&#160;version)</p>
<p style="position:absolute;top:660px;left:91px;white-space:nowrap" class="ft11516"><b>Responsible&#160;Organisation</b></p>
<p style="position:absolute;top:660px;left:424px;white-space:nowrap" class="ft11517">Politecnico&#160;di&#160;Torino</p>
<p style="position:absolute;top:685px;left:91px;white-space:nowrap" class="ft11516"><b>Authors</b></p>
<p style="position:absolute;top:685px;left:424px;white-space:nowrap" class="ft11517">Gianluca&#160;Ramunno&#160;and&#160;Roberto&#160;Sassu&#160;(POL)</p>
<p style="position:absolute;top:708px;left:91px;white-space:nowrap" class="ft11516"><b>Abstract</b></p>
<p style="position:absolute;top:708px;left:424px;white-space:nowrap" class="ft11519">Key&#160;and&#160;data&#160;Management&#160;Adaptation&#160;layer&#160;<br/>(KMA),&#160;formerly&#160;“High-level&#160;Key&#160;Manager&#160;<br/>service”,&#160;is&#160;intended&#160;to&#160;be&#160;a&#160;software&#160;system&#160;<br/>built&#160;upon&#160;TPM&#160;and&#160;TSS,&#160;whose&#160;goals&#160;are&#160;<br/>protecting&#160;keys&#160;and&#160;other&#160;sensitive&#160;data&#160;for&#160;<br/>generic&#160;applications&#160;and&#160;services&#160;and&#160;<br/>binding&#160;the&#160;access&#160;to&#160;the&#160;protected&#160;<br/>information&#160;to&#160;the&#160;integrity&#160;of&#160;the&#160;system.<br/>This&#160;document&#160;describes&#160;the&#160;procedures&#160;for&#160;<br/>building,&#160;installing&#160;and&#160;configuring&#160;KMA&#160;<br/>version&#160;1.0.&#160;This&#160;deliverable&#160;also&#160;includes&#160;<br/>D03c.10&#160;and&#160;D03c.11.</p>
<p style="position:absolute;top:959px;left:91px;white-space:nowrap" class="ft11516"><b>Keywords</b></p>
<p style="position:absolute;top:959px;left:424px;white-space:nowrap" class="ft11517">Open_TC,&#160;KMA,&#160;TPM,&#160;TSS</p>
<p style="position:absolute;top:1002px;left:92px;white-space:nowrap" class="ft11516"><b>Dissemination&#160;level</b></p>
<p style="position:absolute;top:1002px;left:423px;white-space:nowrap" class="ft11517">Public</p>
<p style="position:absolute;top:1028px;left:92px;white-space:nowrap" class="ft11516"><b>Revision</b></p>
<p style="position:absolute;top:1028px;left:423px;white-space:nowrap" class="ft11517">FINAL&#160;1.10</p>
<p style="position:absolute;top:1079px;left:90px;white-space:nowrap" class="ft11516"><b>Instrument</b></p>
<p style="position:absolute;top:1079px;left:271px;white-space:nowrap" class="ft11517">IP</p>
<p style="position:absolute;top:1069px;left:452px;white-space:nowrap" class="ft11520"><b>Start&#160;date&#160;of&#160;the&#160;<br/>project</b></p>
<p style="position:absolute;top:1079px;left:633px;white-space:nowrap" class="ft11517">1</p>
<p style="position:absolute;top:1079px;left:643px;white-space:nowrap" class="ft11518">st</p>
<p style="position:absolute;top:1079px;left:652px;white-space:nowrap" class="ft11517">&#160;November&#160;2005</p>
<p style="position:absolute;top:1108px;left:90px;white-space:nowrap" class="ft11516"><b>Thematic&#160;Priority</b></p>
<p style="position:absolute;top:1108px;left:271px;white-space:nowrap" class="ft11517">IST</p>
<p style="position:absolute;top:1108px;left:452px;white-space:nowrap" class="ft11516"><b>Duration</b></p>
<p style="position:absolute;top:1108px;left:633px;white-space:nowrap" class="ft11517">42&#160;months</p>
<p style="position:absolute;top:75px;left:674px;white-space:nowrap" class="ft1156">&#160;</p>
</div>
<!-- Page 116 -->
<a name="116"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft11650{font-size:12px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
-->
</style>
<div id="page116-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3116.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1169">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft11650">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft11621">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:186px;left:85px;white-space:nowrap" class="ft11622"><b>Table&#160;of&#160;Contents</b></p>
<p style="position:absolute;top:223px;left:85px;white-space:nowrap" class="ft11619">&#160;1&#160;Introduction................................................................................................................4<br/>&#160;2&#160;Building&#160;and&#160;installing&#160;KMA........................................................................................5</p>
<p style="position:absolute;top:262px;left:94px;white-space:nowrap" class="ft11619">&#160;2.1&#160;Important&#160;notes&#160;(to&#160;read&#160;carefully&#160;before&#160;building&#160;or&#160;using&#160;KMA)..........................5<br/>&#160;2.2&#160;Introduction...........................................................................................................5<br/>&#160;2.3&#160;KMA&#160;package&#160;dependencies&#160;(prerequisites)..........................................................6</p>
<p style="position:absolute;top:319px;left:102px;white-space:nowrap" class="ft11617">&#160;2.3.1&#160;Prerequisites.....................................................................................................6</p>
<p style="position:absolute;top:338px;left:94px;white-space:nowrap" class="ft11617">&#160;2.4&#160;KMA&#160;building&#160;procedure.........................................................................................7</p>
<p style="position:absolute;top:358px;left:102px;white-space:nowrap" class="ft11617">&#160;2.4.1&#160;Building&#160;from&#160;the&#160;source&#160;tarball........................................................................7</p>
<p style="position:absolute;top:377px;left:94px;white-space:nowrap" class="ft11617">&#160;2.5&#160;Creating&#160;a&#160;openSUSE&#160;repository&#160;with&#160;KMA&#160;RPMS...................................................8</p>
<p style="position:absolute;top:396px;left:102px;white-space:nowrap" class="ft11619">&#160;2.5.1&#160;Using&#160;the&#160;distributed&#160;tarball&#160;with&#160;RPMS............................................................8<br/>&#160;2.5.2&#160;Using&#160;the&#160;RPMS&#160;built&#160;as&#160;described&#160;in&#160;the&#160;section&#160;2.4.1.....................................9</p>
<p style="position:absolute;top:434px;left:94px;white-space:nowrap" class="ft11617">&#160;2.6&#160;Installation.............................................................................................................9</p>
<p style="position:absolute;top:454px;left:102px;white-space:nowrap" class="ft11619">&#160;2.6.1&#160;Adding&#160;the&#160;KMA&#160;repository................................................................................9<br/>&#160;2.6.2&#160;Set&#160;the&#160;packages&#160;to&#160;install................................................................................9<br/>&#160;2.6.3&#160;Alternative&#160;installation....................................................................................10<br/>&#160;2.6.4&#160;Do&#160;not&#160;reboot..................................................................................................10</p>
<p style="position:absolute;top:530px;left:85px;white-space:nowrap" class="ft11617">&#160;3&#160;Preliminary&#160;steps......................................................................................................10</p>
<p style="position:absolute;top:550px;left:94px;white-space:nowrap" class="ft11619">&#160;3.1&#160;Configuration&#160;of&#160;the&#160;TPM&#160;emulator......................................................................10<br/>&#160;3.2&#160;Generation&#160;of&#160;the&#160;initram&#160;disk.............................................................................11<br/>&#160;3.3&#160;TrustedGRUB&#160;modifications.................................................................................11</p>
<p style="position:absolute;top:607px;left:85px;white-space:nowrap" class="ft11617">&#160;4&#160;Configuration............................................................................................................12</p>
<p style="position:absolute;top:626px;left:94px;white-space:nowrap" class="ft11619">&#160;4.1&#160;Preliminary&#160;steps.................................................................................................12<br/>&#160;4.2&#160;Creation&#160;of&#160;the&#160;file&#160;/etc/kma/boot.conf.................................................................12<br/>&#160;4.3&#160;Creation&#160;of&#160;the&#160;file&#160;/etc/kma/signed_binaries.......................................................13<br/>&#160;4.4&#160;Configuration&#160;of&#160;the&#160;protected&#160;filesystem............................................................14<br/>&#160;4.5&#160;Creation&#160;of&#160;the&#160;file&#160;/etc/kma/checkfilelist.............................................................16<br/>&#160;4.6&#160;MasterKey&#160;generation&#160;and&#160;NV&#160;storage&#160;configuration&#160;(only&#160;for&#160;TPM&#160;v1.2)............17<br/>&#160;4.7&#160;First&#160;boot&#160;in&#160;learning&#160;mode..................................................................................18</p>
<p style="position:absolute;top:761px;left:102px;white-space:nowrap" class="ft11619">&#160;4.7.1&#160;Checking&#160;the&#160;filesystem&#160;configuration............................................................18<br/>&#160;4.7.2&#160;Discovering&#160;kernel&#160;modules............................................................................19<br/>&#160;4.7.3&#160;Discovering&#160;applications&#160;that&#160;need&#160;direct&#160;access&#160;to&#160;devices..........................19<br/>&#160;4.7.4&#160;Certifying&#160;binaries...........................................................................................19<br/>&#160;4.7.5&#160;Importing&#160;unprotected&#160;files&#160;in&#160;the&#160;eCryptfs&#160;filesystem....................................19<br/>&#160;4.7.6&#160;Learning&#160;activity&#160;of&#160;certified&#160;applications........................................................20<br/>&#160;4.7.7&#160;Reviewing&#160;the&#160;libraries&#160;loading&#160;and&#160;direct&#160;access&#160;detected............................20</p>
<p style="position:absolute;top:895px;left:94px;white-space:nowrap" class="ft11619">&#160;4.8&#160;Reboot&#160;in&#160;enforcing&#160;mode....................................................................................20<br/>&#160;4.9&#160;Sealing.................................................................................................................20<br/>&#160;4.10&#160;Unsealing...........................................................................................................21<br/>&#160;4.11&#160;Using&#160;KMA..........................................................................................................21<br/>&#160;4.12&#160;Maintenance&#160;procedures....................................................................................23</p>
<p style="position:absolute;top:991px;left:102px;white-space:nowrap" class="ft11619">&#160;4.12.1&#160;Software&#160;update&#160;and&#160;new&#160;certified&#160;applications............................................23<br/>&#160;4.12.2&#160;Adding&#160;to&#160;the&#160;database&#160;/etc/kma/logs/mmap_list&#160;non&#160;discovered&#160;libraries...25<br/>&#160;4.12.3&#160;Adding&#160;to&#160;the&#160;database&#160;/etc/kma/logs/directaccess_list&#160;the&#160;processes&#160;that&#160;<br/>require&#160;direct&#160;access&#160;to&#160;devices................................................................................26<br/>&#160;4.12.4&#160;Allowing&#160;new&#160;or&#160;updated&#160;modules&#160;to&#160;be&#160;loaded&#160;in&#160;the&#160;kernel&#160;......................26<br/>&#160;4.12.5&#160;Updating&#160;the&#160;system&#160;–&#160;a&#160;file&#160;included&#160;in&#160;/etc/kma/checkfilelist&#160;is&#160;changed...27<br/>&#160;4.12.6&#160;Updating&#160;filesystem&#160;policies..........................................................................27</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft11621">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft11621">2/35</p>
</div>
<!-- Page 117 -->
<a name="117"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page117-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3117.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1179">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft11750">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft11721">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:102px;white-space:nowrap" class="ft11717">&#160;4.12.7&#160;Restoring&#160;access&#160;to&#160;a&#160;renamed&#160;or&#160;a&#160;moved&#160;eCryptfs&#160;file..............................27</p>
<p style="position:absolute;top:168px;left:85px;white-space:nowrap" class="ft11719">&#160;5&#160;Removing&#160;KMA.........................................................................................................27<br/>&#160;6&#160;List&#160;of&#160;all&#160;command&#160;used&#160;with&#160;parameters...............................................................28<br/>&#160;7&#160;Workarounds............................................................................................................30<br/>&#160;8&#160;PKCS#11&#160;library&#160;configuration.................................................................................30</p>
<p style="position:absolute;top:245px;left:94px;white-space:nowrap" class="ft11719">&#160;8.1&#160;Token&#160;configuration&#160;–&#160;Administrator&#160;side.............................................................30<br/>&#160;8.2&#160;Token&#160;configuration&#160;–&#160;User&#160;side...........................................................................32<br/>&#160;8.3&#160;Install&#160;software&#160;token&#160;in&#160;Firefox...........................................................................33<br/>&#160;8.4&#160;Test&#160;and&#160;use&#160;the&#160;software&#160;token&#160;with&#160;Firefox......................................................34</p>
<p style="position:absolute;top:322px;left:85px;white-space:nowrap" class="ft11719">&#160;9&#160;Glossary....................................................................................................................34<br/>&#160;10&#160;List&#160;of&#160;Abbreviations...............................................................................................35<br/>&#160;11&#160;Related&#160;Work..........................................................................................................35</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft11721">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft11721">3/35</p>
</div>
<!-- Page 118 -->
<a name="118"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft11851{font-size:17px;font-family:FAAAAA+CourierNewPSMT;color:#000000;}
-->
</style>
<div id="page118-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3118.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1189">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft11850">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft11821">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:186px;left:85px;white-space:nowrap" class="ft11840"><b>&#160;1&#160;&#160;Introduction</b></p>
<p style="position:absolute;top:216px;left:85px;white-space:nowrap" class="ft11825">Key&#160;and&#160;data&#160;Management&#160;Adaptation&#160;layer&#160;(KMA),&#160;formerly&#160;“High-level&#160;Key&#160;Manager&#160;<br/>service”,&#160;is&#160;a&#160;software&#160;system&#160;built&#160;upon&#160;TPM&#160;[1]&#160;and&#160;TSS&#160;[3],&#160;whose&#160;goals&#160;are&#160;<br/>protecting&#160;keys&#160;and&#160;other&#160;sensitive&#160;data&#160;for&#160;generic&#160;applications&#160;and&#160;services&#160;and&#160;<br/>binding&#160;the&#160;access&#160;to&#160;the&#160;protected&#160;information&#160;to&#160;the&#160;integrity&#160;of&#160;the&#160;system.<br/>Specific&#160;objectives&#160;for&#160;KMA&#160;are:</p>
<p style="position:absolute;top:335px;left:112px;white-space:nowrap" class="ft11812">●</p>
<p style="position:absolute;top:330px;left:139px;white-space:nowrap" class="ft11819">access&#160;to&#160;protected&#160;data&#160;granted&#160;only&#160;if&#160;the&#160;integrity&#160;of&#160;system&#160;and&#160;the&#160;<br/>application/service&#160;requiring&#160;the&#160;access&#160;are&#160;verified;</p>
<p style="position:absolute;top:382px;left:112px;white-space:nowrap" class="ft11812">●</p>
<p style="position:absolute;top:378px;left:139px;white-space:nowrap" class="ft11819">(optional)&#160;access&#160;to&#160;protected&#160;data&#160;granted&#160;only&#160;if&#160;the&#160;system&#160;and&#160;the&#160;<br/>application/service&#160;have&#160;specific&#160;values&#160;for&#160;selected&#160;run-time&#160;properties&#160;(e.g.&#160;<br/>the&#160;user&#160;currently&#160;logged&#160;in);</p>
<p style="position:absolute;top:449px;left:112px;white-space:nowrap" class="ft11812">●</p>
<p style="position:absolute;top:444px;left:139px;white-space:nowrap" class="ft11819">isolation&#160;between&#160;protected&#160;data&#160;of&#160;different&#160;applications/services&#160;at&#160;run-time&#160;<br/>to&#160;prevent&#160;that,&#160;if&#160;an&#160;application&#160;gets&#160;compromised&#160;(e.g.&#160;because&#160;of&#160;a&#160;flaw)&#160;and&#160;<br/>the&#160;protected&#160;data&#160;can&#160;be&#160;accessed&#160;in&#160;memory&#160;by&#160;an&#160;attacker,&#160;the&#160;protected&#160;<br/>data&#160;of&#160;all&#160;other&#160;applications/services&#160;can&#160;be&#160;accessed&#160;by&#160;the&#160;attacker;</p>
<p style="position:absolute;top:534px;left:112px;white-space:nowrap" class="ft11812">●</p>
<p style="position:absolute;top:530px;left:139px;white-space:nowrap" class="ft11817">data&#160;protection&#160;robust&#160;against&#160;off-line&#160;attacks&#160;to&#160;the&#160;storage&#160;device;</p>
<p style="position:absolute;top:563px;left:112px;white-space:nowrap" class="ft11812">●</p>
<p style="position:absolute;top:558px;left:139px;white-space:nowrap" class="ft11819">generic&#160;protection&#160;mechanism&#160;for&#160;data&#160;files&#160;that&#160;does&#160;not&#160;require&#160;any&#160;<br/>modification&#160;to&#160;the&#160;application/service&#160;at&#160;build&#160;time,&#160;in&#160;order&#160;to&#160;use&#160;KMA&#160;with&#160;<br/>standard&#160;distributions;</p>
<p style="position:absolute;top:629px;left:112px;white-space:nowrap" class="ft11812">●</p>
<p style="position:absolute;top:625px;left:139px;white-space:nowrap" class="ft11819">support&#160;for&#160;the&#160;access&#160;to&#160;TPM&#160;keys&#160;bound&#160;to&#160;system/application&#160;integrity&#160;and&#160;<br/>properties,&#160;requiring&#160;minimal&#160;modifications&#160;at&#160;build&#160;time&#160;for&#160;application&#160;directly&#160;<br/>using&#160;the&#160;TPM&#160;keys;</p>
<p style="position:absolute;top:696px;left:112px;white-space:nowrap" class="ft11812">●</p>
<p style="position:absolute;top:691px;left:139px;white-space:nowrap" class="ft11819">seamless&#160;upgrade&#160;of&#160;the&#160;operating&#160;system&#160;and&#160;the&#160;protected&#160;applications&#160;while&#160;<br/>keeping&#160;the&#160;data&#160;protection;</p>
<p style="position:absolute;top:743px;left:112px;white-space:nowrap" class="ft11812">●</p>
<p style="position:absolute;top:739px;left:139px;white-space:nowrap" class="ft11819">support&#160;for&#160;platforms&#160;with&#160;a&#160;single&#160;operating&#160;systems&#160;running&#160;or&#160;(optionally)&#160;full&#160;<br/>virtual&#160;machines;</p>
<p style="position:absolute;top:786px;left:85px;white-space:nowrap" class="ft11817">This&#160;is&#160;the&#160;companion&#160;document&#160;for&#160;</p>
<p style="position:absolute;top:788px;left:388px;white-space:nowrap" class="ft11851">D03c.9_KMA_source_code_and_RPMS.zip</p>
<p style="position:absolute;top:786px;left:735px;white-space:nowrap" class="ft11817">,&#160;the&#160;</p>
<p style="position:absolute;top:806px;left:85px;white-space:nowrap" class="ft11819">tarball&#160;including&#160;source&#160;code&#160;and&#160;binary&#160;RPM&#160;packages.&#160;This&#160;document&#160;describes&#160;the&#160;<br/>procedures&#160;for&#160;building,&#160;installing,&#160;configuring&#160;KMA&#160;version&#160;1.0.&#160;Among&#160;the&#160;examples&#160;<br/>it&#160;includes&#160;the&#160;configurations&#160;to&#160;make&#160;secure&#160;the&#160;following&#160;applications:&#160;OpenSSH&#160;<br/>(client&#160;and&#160;server),&#160;an&#160;implementation&#160;of&#160;SSH&#160;[2]&#160;protocol,&#160;tools&#160;for&#160;Ipsec&#160;configuration&#160;<br/>(i.e.&#160;setkey)&#160;and&#160;racoon&#160;the&#160;implementation&#160;of&#160;the&#160;IKE&#160;protocol,&#160;subversion&#160;client&#160;<br/>(svn),&#160;other&#160;applications&#160;like&#160;the&#160;editor&#160;nano.&#160;In&#160;addition&#160;the&#160;configuration&#160;for&#160;<br/>OpenCryptoki&#160;is&#160;included,&#160;an&#160;existing&#160;software&#160;implementation&#160;of&#160;a&#160;PKCS#11&#160;<br/>cryptographic&#160;device&#160;which&#160;has&#160;been&#160;updated&#160;to&#160;support&#160;multiple&#160;“tokens”.&#160;For&#160;this&#160;<br/>reason&#160;this&#160;deliverable&#160;actually&#160;incorporate&#160;an&#160;updated&#160;version&#160;of&#160;D03c.4&#160;as&#160;well&#160;as&#160;<br/>D03c.10&#160;and&#160;D03c.11.<br/>With&#160;respect&#160;to&#160;the&#160;first&#160;version&#160;of&#160;KMA&#160;delivered&#160;as&#160;D03c.4&#160;[4],&#160;this&#160;final&#160;version&#160;of&#160;<br/>KMA&#160;prototype&#160;has&#160;been&#160;improved&#160;with&#160;mechanisms&#160;that&#160;avoid&#160;any&#160;modification&#160;of&#160;<br/>applications&#160;to&#160;protect,&#160;allowing&#160;to&#160;secure&#160;arbitrary&#160;applications&#160;or&#160;services.&#160;It&#160;now&#160;<br/>includes&#160;the&#160;shared&#160;libraries&#160;used&#160;by&#160;applications&#160;for&#160;integrity&#160;checks.&#160;With&#160;the&#160;<br/>experience&#160;of&#160;the&#160;previous&#160;prototype&#160;and&#160;its&#160;enhancement,&#160;the&#160;overall&#160;KMA&#160;<br/>architecture/prototype&#160;was&#160;redesigned&#160;and&#160;to&#160;be&#160;more&#160;efficient,&#160;flexible&#160;and&#160;robust.&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft11821">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft11821">4/35</p>
</div>
<!-- Page 119 -->
<a name="119"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page119-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3119.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1199">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft11950">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft11921">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:85px;white-space:nowrap" class="ft11925">The&#160;new&#160;prototype&#160;supports&#160;flexible&#160;access&#160;rights&#160;for&#160;the&#160;protected&#160;folders.&#160;These&#160;<br/>rights&#160;are&#160;controlled&#160;by&#160;the&#160;administrator&#160;and&#160;enforced&#160;by&#160;KMA&#160;throughout&#160;the&#160;lifetime&#160;<br/>of&#160;the&#160;boot&#160;session.&#160;We&#160;also&#160;added&#160;access&#160;control&#160;for&#160;critical&#160;devices&#160;(physical&#160;<br/>memory&#160;and&#160;hard&#160;disk).&#160;Some&#160;critical&#160;components&#160;running&#160;in&#160;user&#160;space&#160;in&#160;the&#160;<br/>previous&#160;prototype&#160;have&#160;been&#160;redesigned&#160;and&#160;moved&#160;to&#160;kernel&#160;space:&#160;eCryptFS&#160;was&#160;<br/>extended&#160;to&#160;work&#160;with&#160;KMA,&#160;and&#160;we&#160;implemented&#160;a&#160;Mandatory&#160;Access&#160;Control&#160;(MAC)&#160;<br/>subsystem&#160;based&#160;on&#160;Linux&#160;SMAC.<br/>This&#160;version&#160;of&#160;KMA&#160;consists&#160;of&#160;five&#160;main&#160;components:</p>
<p style="position:absolute;top:325px;left:112px;white-space:nowrap" class="ft11912">●</p>
<p style="position:absolute;top:321px;left:139px;white-space:nowrap" class="ft11917">Mandatory&#160;Access&#160;Control,&#160;which&#160;is&#160;intended&#160;as&#160;an&#160;enhancement&#160;of&#160;SMACK;</p>
<p style="position:absolute;top:353px;left:112px;white-space:nowrap" class="ft11912">●</p>
<p style="position:absolute;top:349px;left:139px;white-space:nowrap" class="ft11917">EcryptFS&#160;filesystem&#160;with&#160;some&#160;modifications&#160;to&#160;adapt&#160;it&#160;to&#160;other&#160;components;</p>
<p style="position:absolute;top:381px;left:112px;white-space:nowrap" class="ft11912">●</p>
<p style="position:absolute;top:377px;left:139px;white-space:nowrap" class="ft11919">Policy&#160;module&#160;which&#160;is&#160;used&#160;by&#160;other&#160;components&#160;to&#160;verify&#160;if&#160;a&#160;process&#160;can&#160;<br/>access&#160;a&#160;resource;</p>
<p style="position:absolute;top:429px;left:112px;white-space:nowrap" class="ft11912">●</p>
<p style="position:absolute;top:424px;left:139px;white-space:nowrap" class="ft11919">Binary&#160;signature&#160;runtime&#160;verification&#160;to&#160;verify&#160;the&#160;integrity&#160;of&#160;certified&#160;<br/>applications;</p>
<p style="position:absolute;top:476px;left:112px;white-space:nowrap" class="ft11912">●</p>
<p style="position:absolute;top:472px;left:139px;white-space:nowrap" class="ft11917">kernel&#160;services&#160;for&#160;TPM.</p>
<p style="position:absolute;top:518px;left:85px;white-space:nowrap" class="ft11940"><b>&#160;2&#160;&#160;Building&#160;and&#160;installing&#160;KMA</b></p>
<p style="position:absolute;top:566px;left:92px;white-space:nowrap" class="ft11916"><b>&#160;2.1&#160;&#160;Important&#160;notes&#160;(to&#160;read&#160;carefully&#160;before&#160;building&#160;or&#160;using&#160;KMA)</b></p>
<p style="position:absolute;top:594px;left:85px;white-space:nowrap" class="ft11919">KMA&#160;version&#160;1.0&#160;includes&#160;patches&#160;applied&#160;to&#160;the&#160;Linux&#160;kernel&#160;and&#160;it&#160;requires&#160;the&#160;<br/>installation&#160;of&#160;the&#160;boot&#160;loader&#160;TrustedGRUB&#160;which&#160;may&#160;result&#160;in&#160;a&#160;platform&#160;not&#160;booting&#160;<br/>anymore,&#160;if&#160;something&#160;fails.&#160;The&#160;passwords&#160;in&#160;this&#160;version&#160;are&#160;input&#160;in&#160;clear&#160;text.&#160;With&#160;<br/>respect&#160;of&#160;the&#160;first&#160;prototype&#160;of&#160;KMA,&#160;this&#160;version&#160;has&#160;been&#160;deeply&#160;tested&#160;&#160;and&#160;used&#160;on&#160;<br/>daily&#160;basis&#160;with&#160;a&#160;development&#160;machine:&#160;it&#160;resulted&#160;in&#160;a&#160;stable&#160;system.&#160;However&#160;<br/>security&#160;tests&#160;have&#160;not&#160;yet&#160;been&#160;executed&#160;and&#160;no&#160;formal&#160;proof&#160;made&#160;yet.&#160;Finally&#160;until&#160;<br/>the&#160;user&#160;does&#160;not&#160;get&#160;familiar&#160;with&#160;the&#160;system&#160;and&#160;all&#160;precautions&#160;are&#160;taken&#160;(like&#160;<br/>backing&#160;up&#160;the&#160;bound&#160;MasterKey),&#160;there&#160;exist&#160;the&#160;risk&#160;that&#160;in&#160;case&#160;of&#160;problems&#160;the&#160;<br/>protected&#160;data&#160;can&#160;be&#160;irreversibly&#160;lost.&#160;.</p>
<p style="position:absolute;top:776px;left:85px;white-space:nowrap" class="ft11920"><b>For&#160;all&#160;aforementioned&#160;reasons,&#160;KMA&#160;version&#160;1.0&#160;must&#160;be&#160;still&#160;considered&#160;as&#160;<br/>preliminary&#160;and&#160;experimental&#160;software:&#160;it&#160;should&#160;not&#160;be&#160;installed&#160;on&#160;<br/>platforms&#160;in&#160;production&#160;while&#160;it&#160;should&#160;be&#160;only&#160;installed&#160;on&#160;testing&#160;platforms&#160;<br/>by&#160;experienced&#160;users.</b></p>
<p style="position:absolute;top:880px;left:92px;white-space:nowrap" class="ft11916"><b>&#160;2.2&#160;&#160;Introduction</b></p>
<p style="position:absolute;top:908px;left:85px;white-space:nowrap" class="ft11917">KMA&#160;version&#160;1.0&#160;is&#160;distributed&#160;in&#160;two&#160;forms:</p>
<p style="position:absolute;top:941px;left:112px;white-space:nowrap" class="ft11912">●</p>
<p style="position:absolute;top:936px;left:139px;white-space:nowrap" class="ft11917">a&#160;tarball&#160;</p>
<p style="position:absolute;top:938px;left:213px;white-space:nowrap" class="ft11951">pol-kma-sources.tar.bz2</p>
<p style="position:absolute;top:936px;left:441px;white-space:nowrap" class="ft11917">&#160;including&#160;source&#160;code&#160;and&#160;scripts&#160;for&#160;</p>
<p style="position:absolute;top:956px;left:139px;white-space:nowrap" class="ft11917">building</p>
<p style="position:absolute;top:989px;left:112px;white-space:nowrap" class="ft11912">●</p>
<p style="position:absolute;top:985px;left:139px;white-space:nowrap" class="ft11917">a&#160;tarball&#160;</p>
<p style="position:absolute;top:986px;left:213px;white-space:nowrap" class="ft11951">pol-kma-rpms.tar.bz2</p>
<p style="position:absolute;top:985px;left:411px;white-space:nowrap" class="ft11917">&#160;including&#160;RPM&#160;packages&#160;with&#160;binaries&#160;only&#160;for&#160;</p>
<p style="position:absolute;top:1005px;left:139px;white-space:nowrap" class="ft11917">direct&#160;installation</p>
<p style="position:absolute;top:1033px;left:85px;white-space:nowrap" class="ft11917">Both&#160;have&#160;to&#160;be&#160;extracted&#160;from&#160;the&#160;tarball&#160;</p>
<p style="position:absolute;top:1035px;left:442px;white-space:nowrap" class="ft11951">D03c.9_KMA_source_code_and_RPMS.zip&#160;</p>
<p style="position:absolute;top:1053px;left:85px;white-space:nowrap" class="ft11925">associated&#160;to&#160;this&#160;document.<br/>Two&#160;procedures&#160;will&#160;be&#160;specified:</p>
<p style="position:absolute;top:1114px;left:112px;white-space:nowrap" class="ft11912">●</p>
<p style="position:absolute;top:1110px;left:139px;white-space:nowrap" class="ft11917">building&#160;RPMs&#160;packages&#160;with&#160;binaries&#160;from&#160;the&#160;source&#160;tarball&#160;and&#160;installing&#160;KMA&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft11921">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft11921">5/35</p>
</div>
<!-- Page 120 -->
<a name="120"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft12052{font-size:15px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page120-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3120.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1209">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft12050">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft12021">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:139px;white-space:nowrap" class="ft12017">from&#160;the&#160;newly&#160;generated&#160;RPM&#160;packages</p>
<p style="position:absolute;top:182px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:177px;left:139px;white-space:nowrap" class="ft12017">installing&#160;KMA&#160;directly&#160;from&#160;the&#160;provided&#160;RPM&#160;binary&#160;packages</p>
<p style="position:absolute;top:205px;left:85px;white-space:nowrap" class="ft12019">Before&#160;installing&#160;KMA&#160;packages,&#160;some&#160;prerequisites&#160;must&#160;be&#160;met.&#160;To&#160;build&#160;KMA&#160;there&#160;<br/>are&#160;also&#160;additional&#160;requirements.&#160;In&#160;the&#160;following&#160;subsection&#160;all&#160;prerequisites&#160;are&#160;<br/>listed,&#160;indicating&#160;whether&#160;they&#160;are&#160;required&#160;for&#160;installing&#160;only&#160;or&#160;also&#160;for&#160;building.</p>
<p style="position:absolute;top:290px;left:92px;white-space:nowrap" class="ft12016"><b>&#160;2.3&#160;&#160;KMA&#160;package&#160;dependencies&#160;(prerequisites)</b></p>
<p style="position:absolute;top:318px;left:85px;white-space:nowrap" class="ft12019">The&#160;prerequisites&#160;are&#160;mostly&#160;expressed&#160;in&#160;terms&#160;of&#160;software&#160;packages&#160;to&#160;be&#160;installed.&#160;<br/>For&#160;each&#160;package&#160;(or&#160;group&#160;of&#160;packages),&#160;it&#160;is&#160;indicated&#160;if&#160;the&#160;package&#160;is&#160;required&#160;<br/>when&#160;</p>
<p style="position:absolute;top:357px;left:135px;white-space:nowrap" class="ft12027"><i>building</i></p>
<p style="position:absolute;top:357px;left:201px;white-space:nowrap" class="ft12017">&#160;KMA&#160;or&#160;when&#160;</p>
<p style="position:absolute;top:357px;left:320px;white-space:nowrap" class="ft12027"><i>installing</i></p>
<p style="position:absolute;top:357px;left:395px;white-space:nowrap" class="ft12017">&#160;it.</p>
<p style="position:absolute;top:403px;left:85px;white-space:nowrap" class="ft12052"><b>&#160;2.3.1&#160;&#160;Prerequisites</b></p>
<p style="position:absolute;top:434px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:429px;left:139px;white-space:nowrap" class="ft12019">a&#160;hardware&#160;platform&#160;with&#160;TPM&#160;1.1&#160;or&#160;1.2&#160;and&#160;ownership&#160;correctly&#160;taken;&#160;<br/>currently&#160;it&#160;has&#160;been&#160;tested&#160;only&#160;on&#160;HP&#160;Compaq&#160;nw8000,&#160;nx6325&#160;and&#160;HP&#160;<br/>dc7700&#160;platforms&#160;[installing]</p>
<p style="position:absolute;top:500px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:496px;left:139px;white-space:nowrap" class="ft12017">a&#160;specific&#160;Linux&#160;distribution&#160;and&#160;version&#160;installed,&#160;</p>
<p style="position:absolute;top:497px;left:554px;white-space:nowrap" class="ft12051">openSUSE 11.1</p>
<p style="position:absolute;top:496px;left:683px;white-space:nowrap" class="ft12017">,&#160;with&#160;a&#160;</p>
<p style="position:absolute;top:516px;left:139px;white-space:nowrap" class="ft12017">specific&#160;SUSE&#160;Linux&#160;kernel,&#160;version&#160;</p>
<p style="position:absolute;top:518px;left:433px;white-space:nowrap" class="ft12051">2.6.27.21</p>
<p style="position:absolute;top:516px;left:522px;white-space:nowrap" class="ft12017">:&#160;with&#160;future&#160;versions&#160;of&#160;the&#160;Linux&#160;</p>
<p style="position:absolute;top:536px;left:139px;white-space:nowrap" class="ft12017">kernel&#160;KMA&#160;v.&#160;1.0&#160;might&#160;not&#160;work&#160;[building,&#160;installing]</p>
<p style="position:absolute;top:569px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:565px;left:139px;white-space:nowrap" class="ft12019">a&#160;file&#160;system&#160;(e.g.&#160;ext3)&#160;supporting&#160;the&#160;extended&#160;attributes&#160;which&#160;must&#160;be&#160;<br/>enabled&#160;to&#160;make&#160;KMA&#160;work&#160;[installing]</p>
<p style="position:absolute;top:617px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:612px;left:139px;white-space:nowrap" class="ft12017">superuser&#160;privileges,&#160;i.e.&#160;access&#160;to&#160;root&#160;account&#160;[building,&#160;installing]</p>
<p style="position:absolute;top:645px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:640px;left:139px;white-space:nowrap" class="ft12017">packages&#160;required&#160;for&#160;kernel&#160;development&#160;(gcc,&#160;make,&#160;etc.)[building]</p>
<p style="position:absolute;top:673px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:668px;left:139px;white-space:nowrap" class="ft12017">kernel-source&#160;[building]</p>
<p style="position:absolute;top:701px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:697px;left:139px;white-space:nowrap" class="ft12017">kernel-source&#160;(source&#160;package)&#160;[building]</p>
<p style="position:absolute;top:729px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:725px;left:139px;white-space:nowrap" class="ft12017">sparse&#160;[building]</p>
<p style="position:absolute;top:758px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:753px;left:139px;white-space:nowrap" class="ft12017">createrepo&#160;[building,&#160;installing]</p>
<p style="position:absolute;top:786px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:781px;left:139px;white-space:nowrap" class="ft12017">trousers-devel&#160;[building]&#160;</p>
<p style="position:absolute;top:814px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:809px;left:139px;white-space:nowrap" class="ft12017">trustedgrub&#160;[installing]</p>
<p style="position:absolute;top:842px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:838px;left:139px;white-space:nowrap" class="ft12017">openCryptoki&#160;(source&#160;package)&#160;[building]</p>
<p style="position:absolute;top:870px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:866px;left:139px;white-space:nowrap" class="ft12017">MozillaFirefox&#160;(source&#160;package)&#160;[building]</p>
<p style="position:absolute;top:899px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:894px;left:139px;white-space:nowrap" class="ft12017">libica&#160;[building]</p>
<p style="position:absolute;top:927px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:922px;left:139px;white-space:nowrap" class="ft12017">libgnomeui-devel&#160;[building]</p>
<p style="position:absolute;top:955px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:950px;left:139px;white-space:nowrap" class="ft12017">libidl-devel&#160;[building]</p>
<p style="position:absolute;top:983px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:979px;left:139px;white-space:nowrap" class="ft12017">mozilla-xulrunner190-devel&#160;[building]</p>
<p style="position:absolute;top:1011px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:1007px;left:139px;white-space:nowrap" class="ft12017">orbit-devel&#160;[building]</p>
<p style="position:absolute;top:1040px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:1035px;left:139px;white-space:nowrap" class="ft12017">update-desktop-files&#160;[building]</p>
<p style="position:absolute;top:1068px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:1063px;left:139px;white-space:nowrap" class="ft12017">trousers&#160;[installing]</p>
<p style="position:absolute;top:1096px;left:112px;white-space:nowrap" class="ft12012">●</p>
<p style="position:absolute;top:1091px;left:139px;white-space:nowrap" class="ft12017">tpm-tools&#160;[installing]</p>
<p style="position:absolute;top:1120px;left:85px;white-space:nowrap" class="ft12017">In&#160;order&#160;to&#160;use&#160;the&#160;sample&#160;configuration&#160;files&#160;without&#160;any&#160;modifications,&#160;the&#160;packages&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft12021">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft12021">6/35</p>
</div>
<!-- Page 121 -->
<a name="121"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft12153{font-size:17px;font-family:FAAAAA+CourierNewPSMT;color:#000080;}
	.ft12154{font-size:17px;line-height:18px;font-family:FAAAAA+CourierNewPSMT;color:#000080;}
	.ft12155{font-size:17px;line-height:18px;font-family:FAAAAA+CourierNewPSMT;color:#000000;}
-->
</style>
<div id="page121-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3121.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1219">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft12150">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft12121">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:85px;white-space:nowrap" class="ft12119">nano,&#160;subversion,&#160;ipsec-tools&#160;are&#160;also&#160;required&#160;for&#160;the&#160;configuration&#160;phase&#160;of&#160;KMA.&#160;<br/>With&#160;hand-crafted&#160;configuration&#160;files&#160;or&#160;with&#160;sample&#160;configuration&#160;files&#160;amended&#160;with&#160;<br/>deletion&#160;of&#160;entries&#160;for&#160;nano,&#160;subversion&#160;and&#160;ipsec-tools,&#160;these&#160;packages&#160;do&#160;not&#160;require&#160;<br/>to&#160;be&#160;installed.</p>
<p style="position:absolute;top:253px;left:92px;white-space:nowrap" class="ft12116"><b>&#160;2.4&#160;&#160;KMA&#160;building&#160;procedure</b></p>
<p style="position:absolute;top:299px;left:85px;white-space:nowrap" class="ft12152"><b>&#160;2.4.1&#160;&#160;Building&#160;from&#160;the&#160;source&#160;tarball</b></p>
<p style="position:absolute;top:325px;left:112px;white-space:nowrap" class="ft12117">1.&#160;Copy&#160;the&#160;distributed&#160;tarball&#160;with&#160;source&#160;code&#160;(</p>
<p style="position:absolute;top:327px;left:524px;white-space:nowrap" class="ft12151">pol-kma-sources.tar.bz2</p>
<p style="position:absolute;top:325px;left:752px;white-space:nowrap" class="ft12117">)&#160;to&#160;a&#160;</p>
<p style="position:absolute;top:346px;left:139px;white-space:nowrap" class="ft12117">temporary&#160;directory&#160;(</p>
<p style="position:absolute;top:347px;left:317px;white-space:nowrap" class="ft12151">TEMPDIR</p>
<p style="position:absolute;top:346px;left:386px;white-space:nowrap" class="ft12117">,&#160;where&#160;“</p>
<p style="position:absolute;top:347px;left:462px;white-space:nowrap" class="ft12151">TEMPDIR</p>
<p style="position:absolute;top:346px;left:531px;white-space:nowrap" class="ft12117">”&#160;</p>
<p style="position:absolute;top:346px;left:545px;white-space:nowrap" class="ft12116"><b>is&#160;a&#160;full&#160;path&#160;including&#160;the&#160;</b></p>
<p style="position:absolute;top:366px;left:139px;white-space:nowrap" class="ft12116"><b>root&#160;“/”&#160;of&#160;the&#160;file&#160;system</b></p>
<p style="position:absolute;top:366px;left:380px;white-space:nowrap" class="ft12117">),&#160;enter&#160;this&#160;directory&#160;and&#160;extract&#160;the&#160;content&#160;from&#160;</p>
<p style="position:absolute;top:385px;left:139px;white-space:nowrap" class="ft12125">the&#160;tarball&#160;with&#160;the&#160;following&#160;command;<br/>1.</p>
<p style="position:absolute;top:415px;left:166px;white-space:nowrap" class="ft12151">tar jxf pol-kma-sources.tar.bz2 -C TEMPDIR</p>
<p style="position:absolute;top:443px;left:112px;white-space:nowrap" class="ft12117">2.&#160;Enable&#160;the&#160;repository&#160;&#160;“</p>
<p style="position:absolute;top:444px;left:336px;white-space:nowrap" class="ft12151">openSUSE-11.1-Source</p>
<p style="position:absolute;top:443px;left:534px;white-space:nowrap" class="ft12117">”</p>
<p style="position:absolute;top:472px;left:139px;white-space:nowrap" class="ft12125">1.&#160;Go&#160;to&#160;YaST/Software&#160;Repositories<br/>2.&#160;Click&#160;the&#160;item&#160;“</p>
<p style="position:absolute;top:502px;left:294px;white-space:nowrap" class="ft12151">openSUSE-11.1-Source</p>
<p style="position:absolute;top:500px;left:492px;white-space:nowrap" class="ft12117">”&#160;and&#160;check&#160;the&#160;box&#160;“Enabled”</p>
<p style="position:absolute;top:529px;left:139px;white-space:nowrap" class="ft12117">3.&#160;Press&#160;the&#160;OK&#160;button&#160;to&#160;confirm</p>
<p style="position:absolute;top:558px;left:112px;white-space:nowrap" class="ft12117">3.&#160;Execute&#160;these&#160;commands&#160;to&#160;download&#160;required&#160;packages:</p>
<p style="position:absolute;top:586px;left:139px;white-space:nowrap" class="ft12117">1.</p>
<p style="position:absolute;top:587px;left:166px;white-space:nowrap" class="ft12151">zypper si &lt;source packages listed in the section 2.3.1&gt;;</p>
<p style="position:absolute;top:615px;left:139px;white-space:nowrap" class="ft12117">2.</p>
<p style="position:absolute;top:617px;left:166px;white-space:nowrap" class="ft12151">zypper install &lt;packages listed in the section 2.3.1&gt;;</p>
<p style="position:absolute;top:644px;left:139px;white-space:nowrap" class="ft12117">3.</p>
<p style="position:absolute;top:646px;left:166px;white-space:nowrap" class="ft12151">wget&#160;</p>
<p style="position:absolute;top:664px;left:166px;white-space:nowrap" class="ft12154"><a href="http://mozilla.isohunt.com/firefox/releases/3.0.8/linux-i686/en-US/firefox-3.0.8.tar.bz2">http://mozilla.mirrors.easynews.com/mozilla/firefox/releases/3.0<br/>.10/linux-i686/en-US/firefox-3.0.10.tar.bz2</a></p>
<p style="position:absolute;top:683px;left:592px;white-space:nowrap" class="ft12151"><a href="http://mozilla.isohunt.com/firefox/releases/3.0.8/linux-i686/en-US/firefox-3.0.8.tar.bz2">&#160;-P</a>&#160;</p>
<p style="position:absolute;top:702px;left:166px;white-space:nowrap" class="ft12151">/usr/src/packages/SOURCES</p>
<p style="position:absolute;top:729px;left:139px;white-space:nowrap" class="ft12117">4.</p>
<p style="position:absolute;top:731px;left:166px;white-space:nowrap" class="ft12155">wget http://download.berlios.de/tpm-<br/>emulator/tpm_emulator-0.5.1.tar.gz -P /usr/src/packages/SOURCES</p>
<p style="position:absolute;top:777px;left:112px;white-space:nowrap" class="ft12117">4.&#160;Enter&#160;the&#160;</p>
<p style="position:absolute;top:779px;left:221px;white-space:nowrap" class="ft12151">/usr/src</p>
<p style="position:absolute;top:777px;left:300px;white-space:nowrap" class="ft12117">&#160;directory&#160;and&#160;take&#160;note&#160;of&#160;the&#160;kernel&#160;source&#160;directory&#160;and&#160;</p>
<p style="position:absolute;top:798px;left:139px;white-space:nowrap" class="ft12117">the&#160;version;</p>
<p style="position:absolute;top:826px;left:112px;white-space:nowrap" class="ft12117">5.&#160;From&#160;the&#160;TEMPDIR/pol-kma-filemac-1.0</p>
<p style="position:absolute;top:827px;left:464px;white-space:nowrap" class="ft12151">&#160;</p>
<p style="position:absolute;top:826px;left:474px;white-space:nowrap" class="ft12117">path&#160;enter&#160;the&#160;directory&#160;</p>
<p style="position:absolute;top:846px;left:139px;white-space:nowrap" class="ft12117">“</p>
<p style="position:absolute;top:848px;left:148px;white-space:nowrap" class="ft12151">build/config/i386</p>
<p style="position:absolute;top:846px;left:316px;white-space:nowrap" class="ft12117">”;</p>
<p style="position:absolute;top:875px;left:112px;white-space:nowrap" class="ft12117">6.&#160;Execute&#160;the&#160;command:&#160;</p>
<p style="position:absolute;top:877px;left:336px;white-space:nowrap" class="ft12151">cp kma.full.default-&lt;kernel-version&gt; kma</p>
<p style="position:absolute;top:875px;left:732px;white-space:nowrap" class="ft12117">;</p>
<p style="position:absolute;top:905px;left:112px;white-space:nowrap" class="ft12117">7.&#160;From&#160;the&#160;TEMPDIR/pol-kma-filemac-1.0&#160;path&#160;enter&#160;the&#160;directory&#160;“</p>
<p style="position:absolute;top:906px;left:682px;white-space:nowrap" class="ft12151">build”</p>
<p style="position:absolute;top:905px;left:741px;white-space:nowrap" class="ft12117">;</p>
<p style="position:absolute;top:934px;left:112px;white-space:nowrap" class="ft12117">8.&#160;Edit&#160;the&#160;file&#160;“</p>
<p style="position:absolute;top:935px;left:248px;white-space:nowrap" class="ft12151">generate_packages.sh</p>
<p style="position:absolute;top:934px;left:446px;white-space:nowrap" class="ft12117">”&#160;and&#160;replace&#160;the&#160;value&#160;of&#160;the&#160;variable&#160;</p>
<p style="position:absolute;top:954px;left:139px;white-space:nowrap" class="ft12117">“</p>
<p style="position:absolute;top:956px;left:148px;white-space:nowrap" class="ft12151">KERNELDIR</p>
<p style="position:absolute;top:954px;left:237px;white-space:nowrap" class="ft12117">”&#160;with&#160;the&#160;full&#160;path&#160;of&#160;installed&#160;kernel&#160;sources;</p>
<p style="position:absolute;top:983px;left:112px;white-space:nowrap" class="ft12117">9.&#160;Execute&#160;the&#160;script&#160;</p>
<p style="position:absolute;top:985px;left:295px;white-space:nowrap" class="ft12151">generate_packages.sh</p>
<p style="position:absolute;top:983px;left:493px;white-space:nowrap" class="ft12117">&#160;without&#160;any&#160;parameter;</p>
<p style="position:absolute;top:1013px;left:112px;white-space:nowrap" class="ft12117">10.From&#160;the&#160;TEMPDIR/pol-kma-filemac-1.0&#160;path&#160;enter&#160;the&#160;directory&#160;“</p>
<p style="position:absolute;top:1014px;left:682px;white-space:nowrap" class="ft12151">dist”</p>
<p style="position:absolute;top:1013px;left:731px;white-space:nowrap" class="ft12117">;</p>
<p style="position:absolute;top:1042px;left:112px;white-space:nowrap" class="ft12117">11.Edit&#160;(if&#160;the&#160;case)&#160;the&#160;file&#160;“</p>
<p style="position:absolute;top:1043px;left:352px;white-space:nowrap" class="ft12151">packages_list</p>
<p style="position:absolute;top:1042px;left:480px;white-space:nowrap" class="ft12117">”&#160;and&#160;add&#160;the&#160;list&#160;of&#160;“spec”&#160;files&#160;to&#160;</p>
<p style="position:absolute;top:1062px;left:139px;white-space:nowrap" class="ft12125">build;&#160;these&#160;are&#160;currently&#160;used:<br/>1.&#160;kernel-kma-2.6.27.21.spec<br/>2.&#160;kernel-kma-source.spec</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft12121">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft12121">7/35</p>
</div>
<!-- Page 122 -->
<a name="122"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page122-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3122.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1229">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft12250">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft12221">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:139px;white-space:nowrap" class="ft12225">3.&#160;kma-boot.spec<br/>4.&#160;kma-utils.spec<br/>5.&#160;libtpm11.spec<br/>6.&#160;libtpm12.spec<br/>7.&#160;opencryptoki_kma.spec<br/>8.&#160;firefox-bin.spec<br/>9.&#160;tpm_emulator.spec</p>
<p style="position:absolute;top:346px;left:112px;white-space:nowrap" class="ft12217">12.Execute&#160;the&#160;script&#160;“</p>
<p style="position:absolute;top:348px;left:303px;white-space:nowrap" class="ft12251">buildkma.sh</p>
<p style="position:absolute;top:346px;left:412px;white-space:nowrap" class="ft12217">”;&#160;if&#160;a&#160;package&#160;cannot&#160;be&#160;compiled&#160;because&#160;of&#160;</p>
<p style="position:absolute;top:367px;left:139px;white-space:nowrap" class="ft12219">a&#160;missing&#160;dependence,&#160;fix&#160;the&#160;issues&#160;and&#160;restart&#160;the&#160;script&#160;from&#160;the&#160;point&#160;it&#160;was&#160;<br/>interrupted&#160;using&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:387px;left:408px;white-space:nowrap" class="ft12251">./buildkma –-resume &lt;spec failed&gt;</p>
<p style="position:absolute;top:415px;left:112px;white-space:nowrap" class="ft12217">13.The&#160;build&#160;of&#160;tpm_emulator.spec&#160;fails.&#160;Execute&#160;these&#160;steps:</p>
<p style="position:absolute;top:443px;left:139px;white-space:nowrap" class="ft12217">1.&#160;The&#160;package&#160;kernel-kma-source&#160;and&#160;kernel-kma&#160;must&#160;be&#160;generated&#160;before&#160;</p>
<p style="position:absolute;top:462px;left:166px;white-space:nowrap" class="ft12217">the&#160;TPM&#160;emulator</p>
<p style="position:absolute;top:491px;left:139px;white-space:nowrap" class="ft12217">2.&#160;Execute&#160;</p>
<p style="position:absolute;top:492px;left:238px;white-space:nowrap" class="ft12251">rpm -Uhvi /usr/src/packages/RPMS/i586/kernel-kma-source-</p>
<p style="position:absolute;top:511px;left:166px;white-space:nowrap" class="ft12251">&lt;kernel version&gt;-&lt;kma version&gt;kma.i586.rpm</p>
<p style="position:absolute;top:539px;left:139px;white-space:nowrap" class="ft12217">3.&#160;Execute&#160;</p>
<p style="position:absolute;top:540px;left:238px;white-space:nowrap" class="ft12251">rpm -Uhvi /usr/src/packages/RPMS/i586/kernel-kma-&lt;kernel&#160;</p>
<p style="position:absolute;top:559px;left:166px;white-space:nowrap" class="ft12251">version&gt;-&lt;kma version&gt;kma.i586.rpm –nodeps</p>
<p style="position:absolute;top:586px;left:139px;white-space:nowrap" class="ft12217">4.&#160;Execute&#160;</p>
<p style="position:absolute;top:588px;left:238px;white-space:nowrap" class="ft12251">rpm -Uhvi /usr/src/packages/RPMS/i586/kernel-kma-base-</p>
<p style="position:absolute;top:607px;left:166px;white-space:nowrap" class="ft12251">&lt;kernel version&gt;-&lt;kma version&gt;kma.i586.rpm –nodeps</p>
<p style="position:absolute;top:634px;left:139px;white-space:nowrap" class="ft12217">5.&#160;Execute&#160;</p>
<p style="position:absolute;top:636px;left:238px;white-space:nowrap" class="ft12251">uname -r</p>
<p style="position:absolute;top:634px;left:317px;white-space:nowrap" class="ft12217">&#160;and&#160;take&#160;the&#160;string&#160;after&#160;the&#160;last&#160;“</p>
<p style="position:absolute;top:636px;left:606px;white-space:nowrap" class="ft12251">-</p>
<p style="position:absolute;top:634px;left:616px;white-space:nowrap" class="ft12217">”&#160;(it&#160;can&#160;be&#160;</p>
<p style="position:absolute;top:636px;left:713px;white-space:nowrap" class="ft12251">default,&#160;</p>
<p style="position:absolute;top:656px;left:166px;white-space:nowrap" class="ft12251">pae, xen</p>
<p style="position:absolute;top:655px;left:245px;white-space:nowrap" class="ft12217">),&#160;which&#160;is&#160;called&#160;kernel&#160;flavor</p>
<p style="position:absolute;top:684px;left:139px;white-space:nowrap" class="ft12217">6.&#160;Edit&#160;the&#160;file&#160;tpm_emulator.spec&#160;and&#160;search&#160;for&#160;the&#160;line:</p>
<p style="position:absolute;top:712px;left:166px;white-space:nowrap" class="ft12217">1.</p>
<p style="position:absolute;top:714px;left:193px;white-space:nowrap" class="ft12251">%define flavors_to_build kma default pae</p>
<p style="position:absolute;top:741px;left:139px;white-space:nowrap" class="ft12217">7.&#160;Modify&#160;this&#160;line&#160;as&#160;follow:</p>
<p style="position:absolute;top:770px;left:166px;white-space:nowrap" class="ft12217">1.</p>
<p style="position:absolute;top:771px;left:193px;white-space:nowrap" class="ft12251">%define flavors_to_build kma &lt;your kernel flavor&gt;</p>
<p style="position:absolute;top:770px;left:678px;white-space:nowrap" class="ft12217">;</p>
<p style="position:absolute;top:799px;left:139px;white-space:nowrap" class="ft12217">8.&#160;Execute&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:800px;left:358px;white-space:nowrap" class="ft12251">./buildkma.sh --resume tpm_emulator.spec</p>
<p style="position:absolute;top:828px;left:112px;white-space:nowrap" class="ft12217">14.Get&#160;the&#160;newly&#160;generated&#160;RPM&#160;packages&#160;from&#160;the&#160;directory&#160;</p>
<p style="position:absolute;top:849px;left:139px;white-space:nowrap" class="ft12251">/usr/src/packages/RPMS/i586</p>
<p style="position:absolute;top:847px;left:407px;white-space:nowrap" class="ft12217">.</p>
<p style="position:absolute;top:895px;left:92px;white-space:nowrap" class="ft12216"><b>&#160;2.5&#160;&#160;Creating&#160;a&#160;openSUSE&#160;repository&#160;with&#160;KMA&#160;RPMS</b></p>
<p style="position:absolute;top:941px;left:85px;white-space:nowrap" class="ft12252"><b>&#160;2.5.1&#160;&#160;Using&#160;the&#160;distributed&#160;tarball&#160;with&#160;RPMS</b></p>
<p style="position:absolute;top:967px;left:112px;white-space:nowrap" class="ft12217">1.&#160;Copy&#160;the&#160;distributed&#160;tarball&#160;with&#160;rpms&#160;(</p>
<p style="position:absolute;top:969px;left:466px;white-space:nowrap" class="ft12251">pol-kma-rpms.tar.bz2</p>
<p style="position:absolute;top:967px;left:664px;white-space:nowrap" class="ft12217">)&#160;to&#160;a&#160;temporary&#160;</p>
<p style="position:absolute;top:987px;left:139px;white-space:nowrap" class="ft12217">directory&#160;(</p>
<p style="position:absolute;top:989px;left:225px;white-space:nowrap" class="ft12251">TEMPDIR</p>
<p style="position:absolute;top:987px;left:294px;white-space:nowrap" class="ft12217">,&#160;where&#160;“</p>
<p style="position:absolute;top:989px;left:370px;white-space:nowrap" class="ft12251">TEMPDIR</p>
<p style="position:absolute;top:987px;left:439px;white-space:nowrap" class="ft12217">”&#160;</p>
<p style="position:absolute;top:987px;left:453px;white-space:nowrap" class="ft12216"><b>is&#160;a&#160;full&#160;path&#160;including&#160;the&#160;root&#160;“/”&#160;of&#160;</b></p>
<p style="position:absolute;top:1008px;left:139px;white-space:nowrap" class="ft12216"><b>the&#160;file&#160;system</b></p>
<p style="position:absolute;top:1008px;left:278px;white-space:nowrap" class="ft12217">),&#160;enter&#160;this&#160;directory&#160;and&#160;extract&#160;the&#160;content&#160;from&#160;the&#160;tarball&#160;</p>
<p style="position:absolute;top:1027px;left:139px;white-space:nowrap" class="ft12225">with&#160;the&#160;following&#160;command;<br/>1.&#160;tar&#160;jxf&#160;pol-kma-rpms.tar.bz2</p>
<p style="position:absolute;top:1083px;left:112px;white-space:nowrap" class="ft12217">2.&#160;Execute&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:1085px;left:331px;white-space:nowrap" class="ft12251">createrepo</p>
<p style="position:absolute;top:1083px;left:430px;white-space:nowrap" class="ft12217">&#160;</p>
<p style="position:absolute;top:1085px;left:435px;white-space:nowrap" class="ft12251">TEMPDIR/RPMS</p>
<p style="position:absolute;top:1083px;left:554px;white-space:nowrap" class="ft12217">;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft12221">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft12221">8/35</p>
</div>
<!-- Page 123 -->
<a name="123"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page123-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3123.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1239">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft12350">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft12321">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:85px;white-space:nowrap" class="ft12352"><b>&#160;2.5.2&#160;&#160;Using&#160;the&#160;RPMS&#160;built&#160;as&#160;described&#160;in&#160;the&#160;section&#160;2.4.1</b></p>
<p style="position:absolute;top:175px;left:112px;white-space:nowrap" class="ft12325">1.&#160;Create&#160;a&#160;new&#160;directory&#160;called&#160;TEMPDIR;<br/>2.&#160;Copy&#160;the&#160;directory&#160;</p>
<p style="position:absolute;top:205px;left:298px;white-space:nowrap" class="ft12351">/usr/src/packages/RPMS&#160;</p>
<p style="position:absolute;top:204px;left:526px;white-space:nowrap" class="ft12317">to&#160;TEMPDIR,&#160;executing&#160;the&#160;</p>
<p style="position:absolute;top:224px;left:139px;white-space:nowrap" class="ft12317">command&#160;</p>
<p style="position:absolute;top:226px;left:227px;white-space:nowrap" class="ft12351">cp -R /usr/src/packages/RPMS TEMPDIR</p>
<p style="position:absolute;top:224px;left:583px;white-space:nowrap" class="ft12317">;</p>
<p style="position:absolute;top:253px;left:112px;white-space:nowrap" class="ft12317">3.&#160;Execute&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:255px;left:331px;white-space:nowrap" class="ft12351">createrepo TEMPDIR/RPMS</p>
<p style="position:absolute;top:253px;left:559px;white-space:nowrap" class="ft12317">;</p>
<p style="position:absolute;top:300px;left:92px;white-space:nowrap" class="ft12316"><b>&#160;2.6&#160;&#160;Installation</b></p>
<p style="position:absolute;top:329px;left:85px;white-space:nowrap" class="ft12319">Two&#160;alternative&#160;methods&#160;for&#160;installation&#160;are&#160;described&#160;in&#160;the&#160;following.&#160;Both&#160;of&#160;them&#160;<br/>require&#160;that&#160;Yast&#160;is&#160;configured&#160;with&#160;the&#160;KMA&#160;repository&#160;containing&#160;the&#160;packages&#160;just&#160;<br/>created&#160;or&#160;unpacked.</p>
<p style="position:absolute;top:404px;left:85px;white-space:nowrap" class="ft12352"><b>&#160;2.6.1&#160;&#160;Adding&#160;the&#160;KMA&#160;repository</b></p>
<p style="position:absolute;top:431px;left:112px;white-space:nowrap" class="ft12325">1.&#160;Open&#160;YaST/Software&#160;repositories;<br/>2.&#160;Click&#160;on&#160;“Add”;<br/>3.&#160;Select&#160;“Local&#160;Directory”;<br/>4.&#160;Type&#160;“</p>
<p style="position:absolute;top:517px;left:194px;white-space:nowrap" class="ft12351">/&lt;pathname of TEMPDIR&gt;/RPMS</p>
<p style="position:absolute;top:515px;left:461px;white-space:nowrap" class="ft12317">”&#160;in&#160;the&#160;field&#160;“</p>
<p style="position:absolute;top:517px;left:577px;white-space:nowrap" class="ft12351">Path to Directory</p>
<p style="position:absolute;top:515px;left:745px;white-space:nowrap" class="ft12317">”&#160;and&#160;</p>
<p style="position:absolute;top:535px;left:139px;white-space:nowrap" class="ft12317">an&#160;identifier&#160;in&#160;the&#160;field&#160;“</p>
<p style="position:absolute;top:537px;left:347px;white-space:nowrap" class="ft12351">Repository Name</p>
<p style="position:absolute;top:535px;left:495px;white-space:nowrap" class="ft12317">”.</p>
<p style="position:absolute;top:583px;left:85px;white-space:nowrap" class="ft12352"><b>&#160;2.6.2&#160;&#160;Set&#160;the&#160;packages&#160;to&#160;install</b></p>
<p style="position:absolute;top:609px;left:112px;white-space:nowrap" class="ft12325">1.&#160;Open/YaST/Software&#160;Management<br/>2.&#160;From&#160;the&#160;“Filter”&#160;field&#160;select&#160;“Repositories”<br/>3.&#160;From&#160;the&#160;list&#160;of&#160;repositories&#160;select&#160;the&#160;KMA&#160;repository<br/>4.&#160;From&#160;the&#160;package&#160;list,&#160;at&#160;the&#160;right&#160;of&#160;the&#160;screen,&#160;select&#160;these&#160;packages:</p>
<p style="position:absolute;top:727px;left:112px;white-space:nowrap" class="ft12312">●</p>
<p style="position:absolute;top:724px;left:139px;white-space:nowrap" class="ft12351">kernel-kma</p>
<p style="position:absolute;top:722px;left:238px;white-space:nowrap" class="ft12317">:&#160;</p>
<p style="position:absolute;top:722px;left:249px;white-space:nowrap" class="ft12316"><b>REQUIRED</b></p>
<p style="position:absolute;top:756px;left:112px;white-space:nowrap" class="ft12312">●</p>
<p style="position:absolute;top:753px;left:139px;white-space:nowrap" class="ft12351">kernel-kma-base</p>
<p style="position:absolute;top:751px;left:288px;white-space:nowrap" class="ft12317">:&#160;</p>
<p style="position:absolute;top:751px;left:299px;white-space:nowrap" class="ft12316"><b>REQUIRED</b></p>
<p style="position:absolute;top:785px;left:112px;white-space:nowrap" class="ft12312">●</p>
<p style="position:absolute;top:782px;left:139px;white-space:nowrap" class="ft12351">kernel-kma-extra</p>
<p style="position:absolute;top:781px;left:298px;white-space:nowrap" class="ft12317">:&#160;</p>
<p style="position:absolute;top:781px;left:308px;white-space:nowrap" class="ft12316"><b>REQUIRED</b></p>
<p style="position:absolute;top:814px;left:112px;white-space:nowrap" class="ft12312">●</p>
<p style="position:absolute;top:811px;left:139px;white-space:nowrap" class="ft12351">kernel-kma-source</p>
<p style="position:absolute;top:810px;left:308px;white-space:nowrap" class="ft12327"><i>:&#160;</i></p>
<p style="position:absolute;top:810px;left:318px;white-space:nowrap" class="ft12316"><b>REQUIRED&#160;</b></p>
<p style="position:absolute;top:810px;left:419px;white-space:nowrap" class="ft12317">to&#160;build&#160;additional&#160;kernel&#160;modules&#160;from&#160;</p>
<p style="position:absolute;top:830px;left:139px;white-space:nowrap" class="ft12317">scratch</p>
<p style="position:absolute;top:863px;left:112px;white-space:nowrap" class="ft12312">●</p>
<p style="position:absolute;top:860px;left:139px;white-space:nowrap" class="ft12351">kma-utils</p>
<p style="position:absolute;top:858px;left:228px;white-space:nowrap" class="ft12317">:&#160;</p>
<p style="position:absolute;top:858px;left:239px;white-space:nowrap" class="ft12316"><b>REQUIRED</b></p>
<p style="position:absolute;top:892px;left:112px;white-space:nowrap" class="ft12312">●</p>
<p style="position:absolute;top:889px;left:139px;white-space:nowrap" class="ft12351">kma-boot</p>
<p style="position:absolute;top:888px;left:218px;white-space:nowrap" class="ft12317">:&#160;</p>
<p style="position:absolute;top:888px;left:229px;white-space:nowrap" class="ft12316"><b>REQUIRED</b></p>
<p style="position:absolute;top:921px;left:112px;white-space:nowrap" class="ft12312">●</p>
<p style="position:absolute;top:918px;left:139px;white-space:nowrap" class="ft12351">libtpm11</p>
<p style="position:absolute;top:917px;left:218px;white-space:nowrap" class="ft12317">:&#160;</p>
<p style="position:absolute;top:917px;left:229px;white-space:nowrap" class="ft12316"><b>REQUIRED</b></p>
<p style="position:absolute;top:917px;left:324px;white-space:nowrap" class="ft12317">&#160;</p>
<p style="position:absolute;top:917px;left:330px;white-space:nowrap" class="ft12316"><b>ONLY</b></p>
<p style="position:absolute;top:917px;left:380px;white-space:nowrap" class="ft12317">&#160;if&#160;the&#160;TPM&#160;version&#160;is&#160;1.1b</p>
<p style="position:absolute;top:951px;left:112px;white-space:nowrap" class="ft12312">●</p>
<p style="position:absolute;top:948px;left:139px;white-space:nowrap" class="ft12351">libtpm12</p>
<p style="position:absolute;top:946px;left:218px;white-space:nowrap" class="ft12317">:&#160;</p>
<p style="position:absolute;top:946px;left:229px;white-space:nowrap" class="ft12316"><b>REQUIRED</b></p>
<p style="position:absolute;top:946px;left:324px;white-space:nowrap" class="ft12317">&#160;</p>
<p style="position:absolute;top:946px;left:330px;white-space:nowrap" class="ft12316"><b>ONLY</b></p>
<p style="position:absolute;top:946px;left:380px;white-space:nowrap" class="ft12317">&#160;if&#160;the&#160;TPM&#160;version&#160;is&#160;1.2</p>
<p style="position:absolute;top:980px;left:112px;white-space:nowrap" class="ft12312">●</p>
<p style="position:absolute;top:977px;left:139px;white-space:nowrap" class="ft12351">tpm_emulator</p>
<p style="position:absolute;top:975px;left:258px;white-space:nowrap" class="ft12317">:&#160;</p>
<p style="position:absolute;top:975px;left:269px;white-space:nowrap" class="ft12316"><b>REQUIRED</b></p>
<p style="position:absolute;top:975px;left:364px;white-space:nowrap" class="ft12317">&#160;</p>
<p style="position:absolute;top:975px;left:369px;white-space:nowrap" class="ft12316"><b>ONLY</b></p>
<p style="position:absolute;top:975px;left:420px;white-space:nowrap" class="ft12317">&#160;if&#160;the&#160;platform&#160;doesn't&#160;have&#160;an&#160;hardware&#160;TPM&#160;</p>
<p style="position:absolute;top:996px;left:139px;white-space:nowrap" class="ft12317">(the&#160;package&#160;</p>
<p style="position:absolute;top:997px;left:253px;white-space:nowrap" class="ft12351">libtpm11</p>
<p style="position:absolute;top:996px;left:332px;white-space:nowrap" class="ft12317">&#160;is&#160;required)</p>
<p style="position:absolute;top:1029px;left:112px;white-space:nowrap" class="ft12312">●</p>
<p style="position:absolute;top:1026px;left:139px;white-space:nowrap" class="ft12351">tpm_emulator-kmp-kma</p>
<p style="position:absolute;top:1025px;left:337px;white-space:nowrap" class="ft12317">:&#160;</p>
<p style="position:absolute;top:1025px;left:348px;white-space:nowrap" class="ft12316"><b>REQUIRED</b></p>
<p style="position:absolute;top:1025px;left:443px;white-space:nowrap" class="ft12317">&#160;</p>
<p style="position:absolute;top:1025px;left:449px;white-space:nowrap" class="ft12316"><b>ONLY</b></p>
<p style="position:absolute;top:1025px;left:499px;white-space:nowrap" class="ft12317">&#160;if&#160;the&#160;platform&#160;doesn't&#160;have&#160;an&#160;</p>
<p style="position:absolute;top:1045px;left:139px;white-space:nowrap" class="ft12317">hardware&#160;TPM</p>
<p style="position:absolute;top:1078px;left:112px;white-space:nowrap" class="ft12312">●</p>
<p style="position:absolute;top:1075px;left:139px;white-space:nowrap" class="ft12351">tpm_emulator-kmp-&lt;your current kernel flavor&gt;</p>
<p style="position:absolute;top:1073px;left:585px;white-space:nowrap" class="ft12317">:&#160;</p>
<p style="position:absolute;top:1073px;left:596px;white-space:nowrap" class="ft12316"><b>REQUIRED</b></p>
<p style="position:absolute;top:1073px;left:691px;white-space:nowrap" class="ft12317">&#160;</p>
<p style="position:absolute;top:1073px;left:696px;white-space:nowrap" class="ft12316"><b>ONLY</b></p>
<p style="position:absolute;top:1073px;left:746px;white-space:nowrap" class="ft12317">&#160;if&#160;the&#160;</p>
<p style="position:absolute;top:1093px;left:139px;white-space:nowrap" class="ft12317">platform&#160;doesn't&#160;have&#160;an&#160;hardware&#160;TPM</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft12321">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft12321">9/35</p>
</div>
<!-- Page 124 -->
<a name="124"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page124-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3124.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1249">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft12450">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft12421">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:153px;left:112px;white-space:nowrap" class="ft12412">●</p>
<p style="position:absolute;top:151px;left:139px;white-space:nowrap" class="ft12451">openCryptoki_kma</p>
<p style="position:absolute;top:149px;left:298px;white-space:nowrap" class="ft12417">:&#160;</p>
<p style="position:absolute;top:149px;left:308px;white-space:nowrap" class="ft12416"><b>OPTIONAL</b></p>
<p style="position:absolute;top:149px;left:403px;white-space:nowrap" class="ft12417">&#160;to&#160;use&#160;PKCS#11&#160;software&#160;token&#160;protected&#160;by&#160;</p>
<p style="position:absolute;top:169px;left:139px;white-space:nowrap" class="ft12417">KMA</p>
<p style="position:absolute;top:202px;left:112px;white-space:nowrap" class="ft12412">●</p>
<p style="position:absolute;top:199px;left:139px;white-space:nowrap" class="ft12451">openCryptoki_kma-32bit</p>
<p style="position:absolute;top:197px;left:357px;white-space:nowrap" class="ft12417">:&#160;</p>
<p style="position:absolute;top:197px;left:368px;white-space:nowrap" class="ft12416"><b>OPTIONAL</b></p>
<p style="position:absolute;top:197px;left:462px;white-space:nowrap" class="ft12417">&#160;to&#160;use&#160;PKCS#11&#160;software&#160;token&#160;</p>
<p style="position:absolute;top:218px;left:139px;white-space:nowrap" class="ft12417">protected&#160;by&#160;KMA</p>
<p style="position:absolute;top:250px;left:112px;white-space:nowrap" class="ft12412">●</p>
<p style="position:absolute;top:247px;left:139px;white-space:nowrap" class="ft12451">MozillaFirefox-bin</p>
<p style="position:absolute;top:246px;left:317px;white-space:nowrap" class="ft12417">:&#160;</p>
<p style="position:absolute;top:246px;left:328px;white-space:nowrap" class="ft12416"><b>REQUIRED</b></p>
<p style="position:absolute;top:246px;left:423px;white-space:nowrap" class="ft12417">&#160;</p>
<p style="position:absolute;top:246px;left:429px;white-space:nowrap" class="ft12416"><b>ONLY</b></p>
<p style="position:absolute;top:246px;left:479px;white-space:nowrap" class="ft12417">&#160;if&#160;one&#160;of&#160;the&#160;packages&#160;openCryptoki&#160;or&#160;</p>
<p style="position:absolute;top:266px;left:139px;white-space:nowrap" class="ft12417">openCryptoki_kma&#160;is&#160;installed.</p>
<p style="position:absolute;top:312px;left:85px;white-space:nowrap" class="ft12452"><b>&#160;2.6.3&#160;&#160;Alternative&#160;installation</b></p>
<p style="position:absolute;top:339px;left:85px;white-space:nowrap" class="ft12419">This&#160;alternative&#160;path&#160;for&#160;the&#160;installation&#160;can&#160;be&#160;used&#160;if&#160;there&#160;is&#160;the&#160;need&#160;to&#160;change&#160;the&#160;<br/>default&#160;kernel&#160;configuration&#160;with&#160;regards&#160;to&#160;modules&#160;and&#160;if&#160;additional&#160;modules&#160;need&#160;to&#160;<br/>be&#160;built.</p>
<p style="position:absolute;top:405px;left:112px;white-space:nowrap" class="ft12417">1.&#160;Install&#160;all&#160;required&#160;packages&#160;(the&#160;</p>
<p style="position:absolute;top:407px;left:416px;white-space:nowrap" class="ft12451">kernel-kma-source</p>
<p style="position:absolute;top:405px;left:585px;white-space:nowrap" class="ft12417">&#160;must&#160;be&#160;included)&#160;as&#160;</p>
<p style="position:absolute;top:426px;left:139px;white-space:nowrap" class="ft12417">described&#160;in&#160;the&#160;section&#160;2.6.2&#160;except:&#160;</p>
<p style="position:absolute;top:427px;left:457px;white-space:nowrap" class="ft12451">kernel-kma</p>
<p style="position:absolute;top:426px;left:556px;white-space:nowrap" class="ft12417">,&#160;</p>
<p style="position:absolute;top:427px;left:566px;white-space:nowrap" class="ft12451">kernel-kma-base</p>
<p style="position:absolute;top:426px;left:715px;white-space:nowrap" class="ft12417">,&#160;</p>
<p style="position:absolute;top:427px;left:725px;white-space:nowrap" class="ft12451">kernel-</p>
<p style="position:absolute;top:448px;left:139px;white-space:nowrap" class="ft12451">kma-extra, tpm_emulator, tpm_emulator-kma-kma</p>
<p style="position:absolute;top:446px;left:585px;white-space:nowrap" class="ft12417">.&#160;Ignore&#160;package&#160;</p>
<p style="position:absolute;top:466px;left:139px;white-space:nowrap" class="ft12417">dependencies.</p>
<p style="position:absolute;top:494px;left:112px;white-space:nowrap" class="ft12417">2.&#160;Copy&#160;the&#160;predefined&#160;kernel&#160;configuration&#160;file&#160;“</p>
<p style="position:absolute;top:496px;left:524px;white-space:nowrap" class="ft12451">.config</p>
<p style="position:absolute;top:494px;left:593px;white-space:nowrap" class="ft12417">”&#160;from&#160;the&#160;directory&#160;</p>
<p style="position:absolute;top:516px;left:139px;white-space:nowrap" class="ft12451">/usr/src/linux-&lt;kernel version&gt;-&lt;kma version&gt;kma-obj/i386/kma</p>
<p style="position:absolute;top:515px;left:743px;white-space:nowrap" class="ft12417">&#160;to&#160;</p>
<p style="position:absolute;top:536px;left:139px;white-space:nowrap" class="ft12451">/usr/src/linux-&lt;kernel version&gt;-&lt;kma version&gt;kma</p>
<p style="position:absolute;top:535px;left:614px;white-space:nowrap" class="ft12417">;</p>
<p style="position:absolute;top:564px;left:112px;white-space:nowrap" class="ft12417">3.&#160;Enter&#160;the&#160;directory&#160;</p>
<p style="position:absolute;top:566px;left:301px;white-space:nowrap" class="ft12451">/usr/src/linux-&lt;kernel version&gt;-&lt;kma version&gt;kma</p>
<p style="position:absolute;top:564px;left:776px;white-space:nowrap" class="ft12417">;</p>
<p style="position:absolute;top:593px;left:112px;white-space:nowrap" class="ft12417">4.&#160;Execute&#160;</p>
<p style="position:absolute;top:595px;left:211px;white-space:nowrap" class="ft12451">make menuconfig</p>
<p style="position:absolute;top:593px;left:360px;white-space:nowrap" class="ft12417">&#160;to&#160;edit&#160;the&#160;kernel&#160;configurations;</p>
<p style="position:absolute;top:623px;left:112px;white-space:nowrap" class="ft12417">5.&#160;Execute&#160;</p>
<p style="position:absolute;top:624px;left:211px;white-space:nowrap" class="ft12451">make all</p>
<p style="position:absolute;top:623px;left:290px;white-space:nowrap" class="ft12417">;</p>
<p style="position:absolute;top:652px;left:112px;white-space:nowrap" class="ft12417">6.&#160;Execute&#160;</p>
<p style="position:absolute;top:653px;left:211px;white-space:nowrap" class="ft12451">make modules_install</p>
<p style="position:absolute;top:652px;left:409px;white-space:nowrap" class="ft12417">;</p>
<p style="position:absolute;top:681px;left:112px;white-space:nowrap" class="ft12417">7.&#160;Execute&#160;</p>
<p style="position:absolute;top:683px;left:211px;white-space:nowrap" class="ft12451">cp arch/x86/boot/bzImage /boot/vmlinuz-&lt;kernel version&gt;-&lt;kma&#160;</p>
<p style="position:absolute;top:703px;left:139px;white-space:nowrap" class="ft12451">version&gt;kma</p>
<p style="position:absolute;top:701px;left:248px;white-space:nowrap" class="ft12417">;</p>
<p style="position:absolute;top:731px;left:112px;white-space:nowrap" class="ft12417">8.&#160;Execute&#160;</p>
<p style="position:absolute;top:732px;left:211px;white-space:nowrap" class="ft12451">cp .config /boot/config-&lt;kernel version&gt;-&lt;kma version&gt;kma</p>
<p style="position:absolute;top:731px;left:775px;white-space:nowrap" class="ft12417">;</p>
<p style="position:absolute;top:760px;left:112px;white-space:nowrap" class="ft12417">9.&#160;Execute&#160;</p>
<p style="position:absolute;top:761px;left:211px;white-space:nowrap" class="ft12451">cp System.map /boot/System.map-&lt;kernel version&gt;-&lt;kma&#160;</p>
<p style="position:absolute;top:782px;left:139px;white-space:nowrap" class="ft12451">version&gt;kma</p>
<p style="position:absolute;top:780px;left:248px;white-space:nowrap" class="ft12417">;</p>
<p style="position:absolute;top:809px;left:112px;white-space:nowrap" class="ft12417">10.If&#160;required&#160;unpack&#160;the&#160;tpm_emulator&#160;tarball&#160;from&#160;/</p>
<p style="position:absolute;top:811px;left:557px;white-space:nowrap" class="ft12451">usr/src/packages/SOURCES&#160;</p>
<p style="position:absolute;top:830px;left:139px;white-space:nowrap" class="ft12417">and&#160;follow&#160;the&#160;standard&#160;procedure&#160;to&#160;compile&#160;and&#160;install&#160;this&#160;software.</p>
<p style="position:absolute;top:876px;left:85px;white-space:nowrap" class="ft12452"><b>&#160;2.6.4&#160;&#160;Do&#160;not&#160;reboot</b></p>
<p style="position:absolute;top:902px;left:85px;white-space:nowrap" class="ft12417">Even&#160;if&#160;Yast&#160;proposes&#160;to&#160;reboot,&#160;this&#160;operation&#160;must&#160;not&#160;be&#160;done&#160;at&#160;this&#160;point.</p>
<p style="position:absolute;top:940px;left:85px;white-space:nowrap" class="ft12440"><b>&#160;3&#160;&#160;Preliminary&#160;steps</b></p>
<p style="position:absolute;top:987px;left:92px;white-space:nowrap" class="ft12416"><b>&#160;3.1&#160;&#160;Configuration&#160;of&#160;the&#160;TPM&#160;emulator</b></p>
<p style="position:absolute;top:1016px;left:85px;white-space:nowrap" class="ft12419">If&#160;the&#160;platform&#160;has&#160;not&#160;an&#160;hardware&#160;TPM,&#160;the&#160;TPM&#160;emulator&#160;is&#160;required&#160;in&#160;order&#160;to&#160;use&#160;<br/>KMA.&#160;It&#160;must&#160;be&#160;configured&#160;using&#160;the&#160;packages&#160;Trousers&#160;and&#160;TPM&#160;tools.&#160;In&#160;the&#160;first&#160;run&#160;<br/>of&#160;this&#160;software&#160;these&#160;commands&#160;must&#160;be&#160;executed&#160;with&#160;the&#160;root&#160;privilege:</p>
<p style="position:absolute;top:1082px;left:112px;white-space:nowrap" class="ft12417">1.</p>
<p style="position:absolute;top:1084px;left:139px;white-space:nowrap" class="ft12451">modprobe tpmd_dev</p>
<p style="position:absolute;top:1082px;left:308px;white-space:nowrap" class="ft12417">&#160;(executing&#160;the&#160;kernel-side&#160;portion&#160;of&#160;the&#160;TPM&#160;emulator)</p>
<p style="position:absolute;top:1111px;left:112px;white-space:nowrap" class="ft12417">2.</p>
<p style="position:absolute;top:1113px;left:139px;white-space:nowrap" class="ft12451">tpmd clear</p>
<p style="position:absolute;top:1111px;left:238px;white-space:nowrap" class="ft12417">&#160;(executing&#160;the&#160;user-side&#160;portion&#160;of&#160;the&#160;TPM&#160;emulator)</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft12421">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft12421">10/35</p>
</div>
<!-- Page 125 -->
<a name="125"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft12556{font-size:17px;font-family:HAAAAA+CourierNewPS;color:#000000;}
-->
</style>
<div id="page125-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3125.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1259">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft12550">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft12521">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:112px;white-space:nowrap" class="ft12517">3.</p>
<p style="position:absolute;top:151px;left:139px;white-space:nowrap" class="ft12551">service tcsd start</p>
<p style="position:absolute;top:149px;left:317px;white-space:nowrap" class="ft12517">&#160;(executing&#160;the&#160;trouser&#160;daemon)</p>
<p style="position:absolute;top:178px;left:112px;white-space:nowrap" class="ft12517">4.</p>
<p style="position:absolute;top:180px;left:139px;white-space:nowrap" class="ft12551">tpm_takeownership</p>
<p style="position:absolute;top:178px;left:308px;white-space:nowrap" class="ft12517">&#160;(taking&#160;the&#160;ownership&#160;of&#160;the&#160;software&#160;TPM)</p>
<p style="position:absolute;top:207px;left:85px;white-space:nowrap" class="ft12519">If&#160;a&#160;hardware&#160;TPM&#160;is&#160;present&#160;in&#160;the&#160;platform,&#160;the&#160;requirement&#160;is&#160;that&#160;the&#160;ownership&#160;is&#160;<br/>taken&#160;and&#160;the&#160;Administrator&#160;has&#160;the&#160;knowledge&#160;of&#160;the&#160;owner&#160;password&#160;(which&#160;must&#160;be&#160;<br/>encoded&#160;with&#160;ASCII&#160;characters).&#160;The&#160;Administrator&#160;must&#160;decide&#160;if&#160;he/she&#160;wants&#160;to&#160;<br/>input&#160;a&#160;blank&#160;SRK&#160;password&#160;or&#160;input&#160;a&#160;not&#160;null&#160;one.&#160;In&#160;the&#160;latter&#160;case,&#160;the&#160;user&#160;is&#160;<br/>required&#160;to&#160;input&#160;the&#160;SRK&#160;password&#160;at&#160;every&#160;boot&#160;and&#160;the&#160;variable&#160;</p>
<p style="position:absolute;top:286px;left:641px;white-space:nowrap" class="ft12551">srk_ask=yes</p>
<p style="position:absolute;top:284px;left:750px;white-space:nowrap" class="ft12517">&#160;must&#160;</p>
<p style="position:absolute;top:304px;left:85px;white-space:nowrap" class="ft12517">be&#160;set&#160;in&#160;the&#160;configuration&#160;file&#160;</p>
<p style="position:absolute;top:306px;left:339px;white-space:nowrap" class="ft12551">/etc/kma/boot.conf</p>
<p style="position:absolute;top:304px;left:518px;white-space:nowrap" class="ft12517">&#160;(see&#160;section&#160;4.2).</p>
<p style="position:absolute;top:334px;left:85px;white-space:nowrap" class="ft12520"><b>IMPORTANT&#160;NOTE:&#160;at&#160;every&#160;subsequent&#160;reboot,&#160;for&#160;both&#160;configuring&#160;and&#160;<br/>using&#160;the&#160;system,&#160;the&#160;following&#160;commands&#160;must&#160;be&#160;executed:</b></p>
<p style="position:absolute;top:381px;left:112px;white-space:nowrap" class="ft12516"><b>1.&#160;(only&#160;if&#160;the&#160;TPM&#160;emulator&#160;is&#160;used)&#160;</b></p>
<p style="position:absolute;top:383px;left:462px;white-space:nowrap" class="ft12556"><b>modprobe tpmd_dev</b></p>
<p style="position:absolute;top:410px;left:112px;white-space:nowrap" class="ft12516"><b>2.&#160;(only&#160;if&#160;the&#160;TPM&#160;emulator&#160;is&#160;used)&#160;</b></p>
<p style="position:absolute;top:412px;left:462px;white-space:nowrap" class="ft12556"><b>tpmd</b></p>
<p style="position:absolute;top:440px;left:112px;white-space:nowrap" class="ft12516"><b>3.</b></p>
<p style="position:absolute;top:441px;left:139px;white-space:nowrap" class="ft12556"><b>service tcsd start</b></p>
<p style="position:absolute;top:487px;left:92px;white-space:nowrap" class="ft12516"><b>&#160;3.2&#160;&#160;Generation&#160;of&#160;the&#160;initram&#160;disk</b></p>
<p style="position:absolute;top:515px;left:85px;white-space:nowrap" class="ft12519">After&#160;all&#160;packages&#160;are&#160;installed,&#160;the&#160;initram&#160;disk&#160;must&#160;be&#160;generated&#160;another&#160;time&#160;<br/>because&#160;the&#160;proper&#160;TPM&#160;kernel&#160;module&#160;must&#160;be&#160;loaded&#160;before&#160;the&#160;KMA&#160;script&#160;is&#160;<br/>executed.&#160;These&#160;steps&#160;must&#160;be&#160;performed:</p>
<p style="position:absolute;top:582px;left:112px;white-space:nowrap" class="ft12517">1.&#160;Edit&#160;the&#160;file&#160;</p>
<p style="position:absolute;top:583px;left:239px;white-space:nowrap" class="ft12551">/etc/sysconfig/kma</p>
<p style="position:absolute;top:582px;left:417px;white-space:nowrap" class="ft12517">;</p>
<p style="position:absolute;top:611px;left:112px;white-space:nowrap" class="ft12517">2.&#160;Specify&#160;the&#160;TPM&#160;kernel&#160;module&#160;name&#160;as&#160;value&#160;of&#160;the&#160;variable&#160;</p>
<p style="position:absolute;top:611px;left:652px;white-space:nowrap" class="ft12527"><i>“</i></p>
<p style="position:absolute;top:613px;left:661px;white-space:nowrap" class="ft12551">TPM_MODULE</p>
<p style="position:absolute;top:611px;left:760px;white-space:nowrap" class="ft12527"><i>”</i></p>
<p style="position:absolute;top:611px;left:768px;white-space:nowrap" class="ft12517">.&#160;</p>
<p style="position:absolute;top:631px;left:139px;white-space:nowrap" class="ft12525">Acceptable&#160;values:<br/>1.&#160;&#160;TPM&#160;emulator:&#160;</p>
<p style="position:absolute;top:659px;left:297px;white-space:nowrap" class="ft12527"><i>“</i></p>
<p style="position:absolute;top:661px;left:305px;white-space:nowrap" class="ft12551">tpmd_dev</p>
<p style="position:absolute;top:659px;left:384px;white-space:nowrap" class="ft12527"><i>”</i></p>
<p style="position:absolute;top:659px;left:393px;white-space:nowrap" class="ft12517">;</p>
<p style="position:absolute;top:689px;left:139px;white-space:nowrap" class="ft12517">2.&#160;Infineon&#160;TPM:&#160;“</p>
<p style="position:absolute;top:690px;left:292px;white-space:nowrap" class="ft12551">tpm_infineon</p>
<p style="position:absolute;top:689px;left:411px;white-space:nowrap" class="ft12517">”;</p>
<p style="position:absolute;top:718px;left:139px;white-space:nowrap" class="ft12517">3.&#160;Atmel&#160;TPM:&#160;“</p>
<p style="position:absolute;top:719px;left:274px;white-space:nowrap" class="ft12551">tpm_atmel</p>
<p style="position:absolute;top:718px;left:363px;white-space:nowrap" class="ft12517">”;</p>
<p style="position:absolute;top:747px;left:139px;white-space:nowrap" class="ft12517">4.&#160;NSC&#160;TPM:&#160;“</p>
<p style="position:absolute;top:749px;left:260px;white-space:nowrap" class="ft12551">tpm_nsc</p>
<p style="position:absolute;top:747px;left:329px;white-space:nowrap" class="ft12517">”;</p>
<p style="position:absolute;top:776px;left:112px;white-space:nowrap" class="ft12517">3.&#160;If&#160;there&#160;is&#160;the&#160;need&#160;to&#160;change&#160;the&#160;standard&#160;configuration&#160;of&#160;the&#160;initram&#160;disk,&#160;</p>
<p style="position:absolute;top:796px;left:139px;white-space:nowrap" class="ft12517">edit&#160;the&#160;file&#160;/lib/mkinitrd/scripts/boot-kma.sh;</p>
<p style="position:absolute;top:824px;left:112px;white-space:nowrap" class="ft12517">4.&#160;Add&#160;to&#160;the&#160;line&#160;which&#160;starts&#160;with&#160;“#%modules:&#160;“&#160;the&#160;kernel&#160;modules&#160;that&#160;are&#160;</p>
<p style="position:absolute;top:843px;left:139px;white-space:nowrap" class="ft12517">required&#160;to&#160;mount&#160;specific&#160;filesystems&#160;listed&#160;in&#160;</p>
<p style="position:absolute;top:845px;left:532px;white-space:nowrap" class="ft12551">/etc/fstab</p>
<p style="position:absolute;top:843px;left:631px;white-space:nowrap" class="ft12517">&#160;or&#160;the&#160;removable&#160;</p>
<p style="position:absolute;top:863px;left:139px;white-space:nowrap" class="ft12517">device&#160;where&#160;the&#160;MasterKey&#160;will&#160;be&#160;stored;</p>
<p style="position:absolute;top:891px;left:112px;white-space:nowrap" class="ft12517">5.&#160;Currently&#160;there&#160;is&#160;an&#160;issue&#160;that&#160;mkinitrd&#160;does&#160;not&#160;recognize&#160;the&#160;new&#160;installed&#160;</p>
<p style="position:absolute;top:911px;left:139px;white-space:nowrap" class="ft12517">scripts.&#160;Execute&#160;the&#160;command&#160;“</p>
<p style="position:absolute;top:912px;left:405px;white-space:nowrap" class="ft12551">ls /lib/mkinitrd/scripts</p>
<p style="position:absolute;top:911px;left:642px;white-space:nowrap" class="ft12517">”</p>
<p style="position:absolute;top:940px;left:112px;white-space:nowrap" class="ft12517">6.&#160;Generate&#160;the&#160;new&#160;initrd&#160;with&#160;the&#160;command&#160;(to&#160;insert&#160;the&#160;right&#160;file&#160;names&#160;see&#160;</p>
<p style="position:absolute;top:959px;left:139px;white-space:nowrap" class="ft12517">the&#160;content&#160;of&#160;the&#160;directory&#160;</p>
<p style="position:absolute;top:961px;left:373px;white-space:nowrap" class="ft12551">/boot</p>
<p style="position:absolute;top:959px;left:423px;white-space:nowrap" class="ft12517">):</p>
<p style="position:absolute;top:992px;left:155px;white-space:nowrap" class="ft12512">●</p>
<p style="position:absolute;top:989px;left:182px;white-space:nowrap" class="ft12551">mkinitrd -k &#160;/boot/vmlinuz-&lt;kernel_version&gt;-&lt;kma_version&gt;kma -i&#160;</p>
<p style="position:absolute;top:1007px;left:182px;white-space:nowrap" class="ft12555">/boot/initrd-&lt;kernel_version&gt;-&lt;kma_version&gt;kma -M&#160;<br/>/boot/System.map-&lt;kernel_version&gt;-&lt;kma_version&gt;kma</p>
<p style="position:absolute;top:1072px;left:92px;white-space:nowrap" class="ft12516"><b>&#160;3.3&#160;&#160;TrustedGRUB&#160;modifications</b></p>
<p style="position:absolute;top:1100px;left:85px;white-space:nowrap" class="ft12519">To&#160;simplify&#160;the&#160;management&#160;of&#160;the&#160;KMA&#160;it&#160;is&#160;useful&#160;to&#160;create&#160;three&#160;different&#160;entries&#160;in&#160;<br/>the&#160;TrustedGRUB&#160;menu:</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft12521">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft12521">11/35</p>
</div>
<!-- Page 126 -->
<a name="126"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page126-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3126.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1269">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft12650">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft12621">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:153px;left:112px;white-space:nowrap" class="ft12612">●</p>
<p style="position:absolute;top:149px;left:139px;white-space:nowrap" class="ft12619">One&#160;that&#160;executes&#160;the&#160;KMA&#160;in&#160;enforcing&#160;mode&#160;(this&#160;is&#160;created&#160;by&#160;the&#160;kernel-kma&#160;<br/>RPM&#160;package&#160;during&#160;the&#160;installation;&#160;add&#160;the&#160;extra&#160;parameter&#160;in&#160;the&#160;kernel&#160;<br/>command&#160;line:&#160;</p>
<p style="position:absolute;top:189px;left:267px;white-space:nowrap" class="ft12651">kma_mode=enabled</p>
<p style="position:absolute;top:187px;left:426px;white-space:nowrap" class="ft12617">&#160;and&#160;add&#160;the&#160;string&#160;“</p>
<p style="position:absolute;top:189px;left:597px;white-space:nowrap" class="ft12651">ENABLED</p>
<p style="position:absolute;top:187px;left:667px;white-space:nowrap" class="ft12617">”&#160;in&#160;the&#160;entry&#160;</p>
<p style="position:absolute;top:208px;left:139px;white-space:nowrap" class="ft12617">name);</p>
<p style="position:absolute;top:240px;left:112px;white-space:nowrap" class="ft12612">●</p>
<p style="position:absolute;top:236px;left:139px;white-space:nowrap" class="ft12619">One&#160;that&#160;executes&#160;the&#160;KMA&#160;in&#160;learning&#160;mode&#160;(add&#160;the&#160;extra&#160;parameter&#160;in&#160;the&#160;<br/>kernel&#160;command&#160;line:&#160;</p>
<p style="position:absolute;top:257px;left:324px;white-space:nowrap" class="ft12651">kma_mode=learning&#160;</p>
<p style="position:absolute;top:255px;left:503px;white-space:nowrap" class="ft12617">and&#160;add&#160;the&#160;string&#160;“</p>
<p style="position:absolute;top:257px;left:669px;white-space:nowrap" class="ft12651">LEARNING</p>
<p style="position:absolute;top:255px;left:748px;white-space:nowrap" class="ft12617">”&#160;in&#160;</p>
<p style="position:absolute;top:275px;left:139px;white-space:nowrap" class="ft12617">the&#160;entry&#160;name);</p>
<p style="position:absolute;top:308px;left:112px;white-space:nowrap" class="ft12612">●</p>
<p style="position:absolute;top:303px;left:139px;white-space:nowrap" class="ft12619">One&#160;that&#160;executes&#160;the&#160;KMA&#160;in&#160;disabled&#160;mode&#160;(add&#160;the&#160;extra&#160;parameter&#160;in&#160;the&#160;<br/>kernel&#160;command&#160;line:&#160;</p>
<p style="position:absolute;top:324px;left:324px;white-space:nowrap" class="ft12651">kma_mode=disabled&#160;</p>
<p style="position:absolute;top:323px;left:503px;white-space:nowrap" class="ft12617">and&#160;add&#160;the&#160;string&#160;“</p>
<p style="position:absolute;top:324px;left:669px;white-space:nowrap" class="ft12651">DISABLED</p>
<p style="position:absolute;top:323px;left:748px;white-space:nowrap" class="ft12617">”&#160;in&#160;</p>
<p style="position:absolute;top:343px;left:139px;white-space:nowrap" class="ft12617">the&#160;entry&#160;name);</p>
<p style="position:absolute;top:371px;left:85px;white-space:nowrap" class="ft12617">To&#160;create&#160;the&#160;new&#160;entries:</p>
<p style="position:absolute;top:399px;left:112px;white-space:nowrap" class="ft12625">1.&#160;Go&#160;to&#160;YaST/System/Boot&#160;loader;<br/>2.&#160;Click&#160;on&#160;the&#160;existent&#160;KMA&#160;entry;<br/>3.&#160;Click&#160;the&#160;button&#160;“Add”&#160;and&#160;select&#160;“Clone&#160;Selected&#160;Section”;<br/>4.&#160;In&#160;the&#160;field&#160;“Section&#160;name”&#160;add&#160;the&#160;string&#160;previously&#160;suggested;<br/>5.&#160;In&#160;the&#160;field&#160;“Optional&#160;Kernel&#160;Command&#160;line&#160;parameter”&#160;add&#160;to&#160;the&#160;end&#160;the&#160;</p>
<p style="position:absolute;top:531px;left:139px;white-space:nowrap" class="ft12617">parameter&#160;listed&#160;before.</p>
<p style="position:absolute;top:559px;left:85px;white-space:nowrap" class="ft12619">Note&#160;that&#160;the&#160;original&#160;entry&#160;for&#160;KMA&#160;created&#160;by&#160;installing&#160;the&#160;packages&#160;and&#160;used&#160;as&#160;<br/>source&#160;for&#160;cloning,&#160;must&#160;be&#160;never&#160;used&#160;and&#160;can&#160;therefore&#160;be&#160;deleted.</p>
<p style="position:absolute;top:625px;left:85px;white-space:nowrap" class="ft12640"><b>&#160;4&#160;&#160;Configuration</b></p>
<p style="position:absolute;top:673px;left:92px;white-space:nowrap" class="ft12616"><b>&#160;4.1&#160;&#160;Preliminary&#160;steps</b></p>
<p style="position:absolute;top:701px;left:85px;white-space:nowrap" class="ft12617">The&#160;package&#160;“</p>
<p style="position:absolute;top:703px;left:205px;white-space:nowrap" class="ft12651">kma-boot</p>
<p style="position:absolute;top:701px;left:284px;white-space:nowrap" class="ft12617">”&#160;when&#160;installed&#160;copies&#160;sample&#160;configuration&#160;files&#160;to&#160;the&#160;</p>
<p style="position:absolute;top:703px;left:755px;white-space:nowrap" class="ft12651">/etc/</p>
<p style="position:absolute;top:723px;left:85px;white-space:nowrap" class="ft12651">kma/sample_config&#160;</p>
<p style="position:absolute;top:721px;left:263px;white-space:nowrap" class="ft12617">directory.&#160;The&#160;Administrator&#160;can&#160;edit&#160;those&#160;files&#160;and&#160;after&#160;must&#160;</p>
<p style="position:absolute;top:742px;left:85px;white-space:nowrap" class="ft12617">place&#160;the&#160;final&#160;version&#160;of&#160;them&#160;in&#160;the&#160;</p>
<p style="position:absolute;top:743px;left:396px;white-space:nowrap" class="ft12651">/etc/kma</p>
<p style="position:absolute;top:742px;left:475px;white-space:nowrap" class="ft12617">&#160;directory.&#160;In&#160;particular&#160;the&#160;files&#160;stored&#160;</p>
<p style="position:absolute;top:762px;left:85px;white-space:nowrap" class="ft12617">in&#160;</p>
<p style="position:absolute;top:763px;left:106px;white-space:nowrap" class="ft12651">/etc/kma/sample_config</p>
<p style="position:absolute;top:762px;left:323px;white-space:nowrap" class="ft12617">&#160;can&#160;be&#160;copied&#160;and&#160;used&#160;as&#160;they&#160;are;&#160;the&#160;files&#160;stored&#160;in&#160;</p>
<p style="position:absolute;top:784px;left:85px;white-space:nowrap" class="ft12651">/etc/kma/sample_config/user1</p>
<p style="position:absolute;top:782px;left:362px;white-space:nowrap" class="ft12617">&#160;require&#160;the&#160;creation&#160;of&#160;the&#160;user&#160;</p>
<p style="position:absolute;top:784px;left:632px;white-space:nowrap" class="ft12651">user1</p>
<p style="position:absolute;top:782px;left:682px;white-space:nowrap" class="ft12617">&#160;with&#160;</p>
<p style="position:absolute;top:784px;left:728px;white-space:nowrap" class="ft12651">UID=1000&#160;</p>
<p style="position:absolute;top:802px;left:85px;white-space:nowrap" class="ft12617">and&#160;</p>
<p style="position:absolute;top:804px;left:122px;white-space:nowrap" class="ft12651">GID=100</p>
<p style="position:absolute;top:802px;left:191px;white-space:nowrap" class="ft12617">,&#160;to&#160;be&#160;used&#160;as&#160;they&#160;are.&#160;If&#160;UID&#160;an&#160;GID&#160;for&#160;</p>
<p style="position:absolute;top:804px;left:538px;white-space:nowrap" class="ft12651">user1</p>
<p style="position:absolute;top:802px;left:587px;white-space:nowrap" class="ft12617">&#160;are&#160;different,&#160;then&#160;the&#160;</p>
<p style="position:absolute;top:823px;left:85px;white-space:nowrap" class="ft12617">sample&#160;files&#160;must&#160;be&#160;updated.&#160;In&#160;particular&#160;the&#160;content&#160;of&#160;the&#160;file&#160;</p>
<p style="position:absolute;top:843px;left:85px;white-space:nowrap" class="ft12651">/etc/kma/sample_config/user1/template.conf.user1</p>
<p style="position:absolute;top:842px;left:560px;white-space:nowrap" class="ft12617">&#160;must&#160;be&#160;appended&#160;to&#160;the&#160;file&#160;</p>
<p style="position:absolute;top:864px;left:85px;white-space:nowrap" class="ft12651">/etc/kma/template.conf</p>
<p style="position:absolute;top:862px;left:303px;white-space:nowrap" class="ft12617">.</p>
<p style="position:absolute;top:909px;left:92px;white-space:nowrap" class="ft12616"><b>&#160;4.2&#160;&#160;Creation&#160;of&#160;the&#160;file&#160;/etc/kma/boot.conf</b></p>
<p style="position:absolute;top:937px;left:85px;white-space:nowrap" class="ft12619">This&#160;file&#160;is&#160;used&#160;to&#160;set&#160;some&#160;variables&#160;that&#160;affect&#160;the&#160;behaviour&#160;of&#160;the&#160;KMA&#160;script&#160;<br/>placed&#160;in&#160;the&#160;initram&#160;disk.</p>
<p style="position:absolute;top:989px;left:112px;white-space:nowrap" class="ft12612">●</p>
<p style="position:absolute;top:986px;left:139px;white-space:nowrap" class="ft12651">srk_ask=[yes/no]</p>
<p style="position:absolute;top:985px;left:298px;white-space:nowrap" class="ft12617">:&#160;defines&#160;if&#160;the&#160;SRK&#160;password&#160;must&#160;be&#160;asked&#160;to&#160;execute&#160;KMA&#160;</p>
<p style="position:absolute;top:1005px;left:139px;white-space:nowrap" class="ft12619">commands&#160;on&#160;TPM,&#160;and&#160;during&#160;the&#160;normal&#160;unsealing&#160;procedure&#160;at&#160;every&#160;boot;&#160;<br/>this&#160;variable&#160;must&#160;set&#160;to&#160;'no'&#160;if&#160;the&#160;SRK&#160;is&#160;set&#160;to&#160;the&#160;well-known&#160;secret&#160;(i.e.&#160;<br/>during&#160;the&#160;TPM&#160;take&#160;ownership&#160;operation)&#160;and&#160;'yes'&#160;if&#160;the&#160;SRK&#160;password&#160;is&#160;set;&#160;<br/>the&#160;default&#160;value&#160;is&#160;'no',&#160;if&#160;the&#160;variable&#160;is&#160;absent;</p>
<p style="position:absolute;top:1095px;left:112px;white-space:nowrap" class="ft12612">●</p>
<p style="position:absolute;top:1093px;left:139px;white-space:nowrap" class="ft12651">BLOBDEV=[pathname]</p>
<p style="position:absolute;top:1091px;left:317px;white-space:nowrap" class="ft12617">:&#160;defines&#160;the&#160;external&#160;device&#160;(the&#160;partition)&#160;where&#160;to&#160;save&#160;</p>
<p style="position:absolute;top:1111px;left:139px;white-space:nowrap" class="ft12617">the&#160;MasterKey;&#160;it&#160;must&#160;be&#160;present&#160;only&#160;if&#160;the&#160;MasterKey&#160;is&#160;not&#160;stored&#160;on&#160;the&#160;root&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft12621">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft12621">12/35</p>
</div>
<!-- Page 127 -->
<a name="127"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page127-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3127.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1279">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft12750">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft12721">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:139px;white-space:nowrap" class="ft12717">file&#160;system&#160;but&#160;on&#160;an&#160;external&#160;device;</p>
<p style="position:absolute;top:182px;left:112px;white-space:nowrap" class="ft12712">●</p>
<p style="position:absolute;top:179px;left:139px;white-space:nowrap" class="ft12751">BLOBDEV_FSTYPE=[fs type]</p>
<p style="position:absolute;top:177px;left:377px;white-space:nowrap" class="ft12717">:&#160;defines&#160;the&#160;filesystem&#160;type&#160;of&#160;the&#160;partition&#160;</p>
<p style="position:absolute;top:197px;left:139px;white-space:nowrap" class="ft12717">selected;&#160;it&#160;must&#160;be&#160;present&#160;only&#160;if&#160;</p>
<p style="position:absolute;top:199px;left:433px;white-space:nowrap" class="ft12751">BLOBDEV</p>
<p style="position:absolute;top:197px;left:502px;white-space:nowrap" class="ft12717">&#160;is&#160;present;</p>
<p style="position:absolute;top:231px;left:112px;white-space:nowrap" class="ft12712">●</p>
<p style="position:absolute;top:228px;left:139px;white-space:nowrap" class="ft12751">MOUNTPOINT=[pathname]</p>
<p style="position:absolute;top:227px;left:347px;white-space:nowrap" class="ft12717">:&#160;defines&#160;the&#160;pathname&#160;where&#160;the&#160;protected&#160;filesystem&#160;</p>
<p style="position:absolute;top:247px;left:139px;white-space:nowrap" class="ft12717">will&#160;be&#160;mounted;&#160;the&#160;pathname&#160;is&#160;considered&#160;after&#160;all&#160;filesystem&#160;listed&#160;in&#160;</p>
<p style="position:absolute;top:248px;left:749px;white-space:nowrap" class="ft12751">/etc/</p>
<p style="position:absolute;top:269px;left:139px;white-space:nowrap" class="ft12751">fstab</p>
<p style="position:absolute;top:267px;left:189px;white-space:nowrap" class="ft12717">&#160;are&#160;mounted;&#160;this&#160;is&#160;the&#160;only&#160;mandatory&#160;variable.</p>
<p style="position:absolute;top:314px;left:92px;white-space:nowrap" class="ft12716"><b>&#160;4.3&#160;&#160;Creation&#160;of&#160;the&#160;file&#160;/etc/kma/signed_binaries</b></p>
<p style="position:absolute;top:343px;left:85px;white-space:nowrap" class="ft12719">This&#160;file&#160;describes&#160;what&#160;applications&#160;must&#160;be&#160;certified&#160;by&#160;the&#160;Administrator,&#160;in&#160;order&#160;to&#160;<br/>use&#160;the&#160;protected&#160;filesystem&#160;or&#160;to&#160;directly&#160;access&#160;devices.&#160;Each&#160;application&#160;will&#160;be&#160;<br/>associated&#160;to&#160;a&#160;“</p>
<p style="position:absolute;top:383px;left:225px;white-space:nowrap" class="ft12751">TAG</p>
<p style="position:absolute;top:381px;left:254px;white-space:nowrap" class="ft12717">”:&#160;this&#160;is&#160;a&#160;property&#160;introduced&#160;by&#160;KMA&#160;to&#160;distinguish&#160;between&#160;</p>
<p style="position:absolute;top:401px;left:85px;white-space:nowrap" class="ft12725">binary&#160;executables&#160;(identified&#160;by&#160;means&#160;of&#160;their&#160;SHA1&#160;digest),&#160;its&#160;values&#160;are&#160;four&#160;<br/>characters&#160;long&#160;and&#160;it&#160;is&#160;used&#160;when&#160;setting&#160;policies.<br/>The&#160;format&#160;of&#160;this&#160;file&#160;is:</p>
<p style="position:absolute;top:477px;left:85px;white-space:nowrap" class="ft12751">&lt;pathname&gt;&#160;&lt;Authority ID&gt;&#160;&#160;&lt;value&gt;</p>
<p style="position:absolute;top:505px;left:85px;white-space:nowrap" class="ft12717">where:</p>
<p style="position:absolute;top:537px;left:112px;white-space:nowrap" class="ft12712">●</p>
<p style="position:absolute;top:534px;left:139px;white-space:nowrap" class="ft12751">pathname</p>
<p style="position:absolute;top:533px;left:218px;white-space:nowrap" class="ft12717">:&#160;the&#160;file&#160;to&#160;certify;</p>
<p style="position:absolute;top:567px;left:112px;white-space:nowrap" class="ft12712">●</p>
<p style="position:absolute;top:564px;left:139px;white-space:nowrap" class="ft12751">Authority ID</p>
<p style="position:absolute;top:562px;left:258px;white-space:nowrap" class="ft12717">:&#160;is&#160;the&#160;property&#160;associated&#160;to&#160;the&#160;file.&#160;Currently&#160;only&#160;the&#160;TAG&#160;is&#160;</p>
<p style="position:absolute;top:582px;left:139px;white-space:nowrap" class="ft12717">associated&#160;to&#160;a&#160;binary&#160;and&#160;the&#160;identifier&#160;is&#160;always&#160;zero;</p>
<p style="position:absolute;top:615px;left:112px;white-space:nowrap" class="ft12712">●</p>
<p style="position:absolute;top:612px;left:139px;white-space:nowrap" class="ft12751">value</p>
<p style="position:absolute;top:610px;left:189px;white-space:nowrap" class="ft12717">:&#160;the&#160;TAG&#160;value&#160;associated&#160;to&#160;the&#160;binary&#160;file:&#160;it&#160;must&#160;be&#160;unique.</p>
<p style="position:absolute;top:640px;left:85px;white-space:nowrap" class="ft12717">The&#160;utility&#160;</p>
<p style="position:absolute;top:641px;left:173px;white-space:nowrap" class="ft12751">certbin</p>
<p style="position:absolute;top:640px;left:243px;white-space:nowrap" class="ft12717">&#160;creates&#160;the&#160;extended&#160;attribute&#160;“</p>
<p style="position:absolute;top:641px;left:516px;white-space:nowrap" class="ft12751">kma_sign</p>
<p style="position:absolute;top:640px;left:595px;white-space:nowrap" class="ft12717">”,&#160;whose&#160;content&#160;is&#160;</p>
<p style="position:absolute;top:660px;left:85px;white-space:nowrap" class="ft12719">protected&#160;for&#160;confidentiality&#160;and&#160;integrity&#160;using&#160;the&#160;MasterKey,&#160;for&#160;each&#160;file&#160;listed&#160;and&#160;<br/>appends&#160;this&#160;to&#160;the&#160;file&#160;itself.&#160;This&#160;is&#160;a&#160;configuration&#160;example:</p>
<p style="position:absolute;top:707px;left:85px;white-space:nowrap" class="ft12751">/usr/bin/ssh</p>
<p style="position:absolute;top:707px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:707px;left:511px;white-space:nowrap" class="ft12751">0001</p>
<p style="position:absolute;top:726px;left:85px;white-space:nowrap" class="ft12751">/usr/sbin/sshd</p>
<p style="position:absolute;top:726px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:726px;left:511px;white-space:nowrap" class="ft12751">0002</p>
<p style="position:absolute;top:745px;left:85px;white-space:nowrap" class="ft12751">/usr/sbin/racoon</p>
<p style="position:absolute;top:745px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:745px;left:511px;white-space:nowrap" class="ft12751">0003</p>
<p style="position:absolute;top:763px;left:85px;white-space:nowrap" class="ft12751">/usr/sbin/setkey</p>
<p style="position:absolute;top:763px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:763px;left:511px;white-space:nowrap" class="ft12751">0004</p>
<p style="position:absolute;top:782px;left:85px;white-space:nowrap" class="ft12751">/usr/bin/ssh-keygen</p>
<p style="position:absolute;top:782px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:782px;left:511px;white-space:nowrap" class="ft12751">0005</p>
<p style="position:absolute;top:801px;left:85px;white-space:nowrap" class="ft12751">/usr/bin/nano</p>
<p style="position:absolute;top:801px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:801px;left:511px;white-space:nowrap" class="ft12751">0006</p>
<p style="position:absolute;top:819px;left:85px;white-space:nowrap" class="ft12751">/bin/ls</p>
<p style="position:absolute;top:819px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:819px;left:511px;white-space:nowrap" class="ft12751">0007</p>
<p style="position:absolute;top:838px;left:85px;white-space:nowrap" class="ft12751">/bin/rm</p>
<p style="position:absolute;top:838px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:838px;left:511px;white-space:nowrap" class="ft12751">0008</p>
<p style="position:absolute;top:857px;left:85px;white-space:nowrap" class="ft12751">/usr/bin/svn</p>
<p style="position:absolute;top:857px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:857px;left:511px;white-space:nowrap" class="ft12751">0009</p>
<p style="position:absolute;top:875px;left:85px;white-space:nowrap" class="ft12751">/usr/sbin/smartd</p>
<p style="position:absolute;top:875px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:875px;left:511px;white-space:nowrap" class="ft12751">0010</p>
<p style="position:absolute;top:894px;left:85px;white-space:nowrap" class="ft12751">/sbin/swapon</p>
<p style="position:absolute;top:894px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:894px;left:511px;white-space:nowrap" class="ft12751">0011</p>
<p style="position:absolute;top:913px;left:85px;white-space:nowrap" class="ft12751">/lib/udev/edd_id</p>
<p style="position:absolute;top:913px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:913px;left:511px;white-space:nowrap" class="ft12751">0012</p>
<p style="position:absolute;top:931px;left:85px;white-space:nowrap" class="ft12751">/lib/udev/scsi_id</p>
<p style="position:absolute;top:931px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:931px;left:511px;white-space:nowrap" class="ft12751">0013</p>
<p style="position:absolute;top:950px;left:85px;white-space:nowrap" class="ft12751">/lib/udev/ata_id</p>
<p style="position:absolute;top:950px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:950px;left:511px;white-space:nowrap" class="ft12751">0014</p>
<p style="position:absolute;top:969px;left:85px;white-space:nowrap" class="ft12751">/lib/udev/vol_id</p>
<p style="position:absolute;top:969px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:969px;left:511px;white-space:nowrap" class="ft12751">0015</p>
<p style="position:absolute;top:988px;left:85px;white-space:nowrap" class="ft12751">/usr/sbin/dmidecode</p>
<p style="position:absolute;top:988px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:988px;left:511px;white-space:nowrap" class="ft12751">0016</p>
<p style="position:absolute;top:1006px;left:85px;white-space:nowrap" class="ft12751">/opt/firefox/firefox-bin</p>
<p style="position:absolute;top:1006px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:1006px;left:511px;white-space:nowrap" class="ft12751">0017</p>
<p style="position:absolute;top:1025px;left:85px;white-space:nowrap" class="ft12751">/usr/sbin/pkcsconf</p>
<p style="position:absolute;top:1025px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:1025px;left:511px;white-space:nowrap" class="ft12751">0018</p>
<p style="position:absolute;top:1043px;left:85px;white-space:nowrap" class="ft12751">/opt/thunderbird/thunderbird-bin&#160;</p>
<p style="position:absolute;top:1043px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:1043px;left:511px;white-space:nowrap" class="ft12751">0019</p>
<p style="position:absolute;top:1062px;left:85px;white-space:nowrap" class="ft12751">/usr/bin/Xorg&#160;</p>
<p style="position:absolute;top:1062px;left:458px;white-space:nowrap" class="ft12751">0</p>
<p style="position:absolute;top:1062px;left:511px;white-space:nowrap" class="ft12751">0020</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft12721">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft12721">13/35</p>
</div>
<!-- Page 128 -->
<a name="128"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page128-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3128.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1289">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft12850">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft12821">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:92px;white-space:nowrap" class="ft12816"><b>&#160;4.4&#160;&#160;Configuration&#160;of&#160;the&#160;protected&#160;filesystem</b></p>
<p style="position:absolute;top:177px;left:85px;white-space:nowrap" class="ft12825">The&#160;purpose&#160;of&#160;KMA&#160;is&#160;to&#160;securely&#160;store&#160;applications'&#160;data&#160;files&#160;in&#160;order&#160;to&#160;prevent&#160;off-<br/>line&#160;attacks&#160;and&#160;to&#160;restrict&#160;accesses&#160;only&#160;to&#160;authorized&#160;subjects,&#160;whose&#160;properties&#160;are&#160;<br/>verified&#160;by&#160;the&#160;kernel,&#160;trusted&#160;by&#160;assumption.&#160;To&#160;achieve&#160;this&#160;goal,&#160;the&#160;directories&#160;<br/>used&#160;by&#160;applications&#160;and&#160;their&#160;content&#160;are&#160;moved&#160;to&#160;an&#160;cryptographic&#160;filesystem,&#160;the&#160;<br/>access&#160;is&#160;restricted&#160;by&#160;a&#160;Mandatory&#160;Access&#160;Control&#160;module&#160;that&#160;resides&#160;in&#160;the&#160;kernel&#160;<br/>and&#160;symbolic&#160;links&#160;are&#160;created&#160;in&#160;old&#160;locations&#160;in&#160;order&#160;to&#160;preserve&#160;the&#160;pathname.&#160;New&#160;<br/>directories&#160;created&#160;in&#160;the&#160;cryptographic&#160;filesystem&#160;are&#160;called&#160;protected&#160;directories.<br/>The&#160;Mandatory&#160;Access&#160;Control&#160;has&#160;these&#160;goals:</p>
<p style="position:absolute;top:349px;left:112px;white-space:nowrap" class="ft12817">1.&#160;restrict&#160;accesses&#160;on&#160;files&#160;and&#160;directories&#160;in&#160;the&#160;cryptographic&#160;filesystem&#160;</p>
<p style="position:absolute;top:368px;left:139px;white-space:nowrap" class="ft12817">depending&#160;on&#160;policies&#160;written&#160;by&#160;the&#160;Administrator;</p>
<p style="position:absolute;top:396px;left:112px;white-space:nowrap" class="ft12817">2.&#160;forbid&#160;the&#160;creation&#160;of&#160;symbolic&#160;links&#160;in&#160;the&#160;cryptographic&#160;filesystem:&#160;all&#160;files&#160;</p>
<p style="position:absolute;top:415px;left:139px;white-space:nowrap" class="ft12817">must&#160;be&#160;encrypted&#160;and&#160;should&#160;not&#160;point&#160;to&#160;others&#160;in&#160;a&#160;unencrypted&#160;filesystem;</p>
<p style="position:absolute;top:444px;left:112px;white-space:nowrap" class="ft12817">3.&#160;protect&#160;symbolic&#160;links&#160;that&#160;replaced&#160;original&#160;application&#160;directories:&#160;the&#160;goal&#160;is&#160;</p>
<p style="position:absolute;top:463px;left:139px;white-space:nowrap" class="ft12819">to&#160;force&#160;the&#160;application&#160;to&#160;access&#160;the&#160;cryptographic&#160;filesystem&#160;when&#160;refers&#160;to&#160;<br/>old&#160;pathnames.</p>
<p style="position:absolute;top:510px;left:85px;white-space:nowrap" class="ft12817">Before&#160;writing&#160;the&#160;policy&#160;for&#160;an&#160;application,&#160;the&#160;Administrator&#160;must:</p>
<p style="position:absolute;top:538px;left:112px;white-space:nowrap" class="ft12825">1.&#160;Assign&#160;a&#160;tag&#160;to&#160;the&#160;application&#160;(described&#160;in&#160;the&#160;section&#160;4.3);<br/>2.&#160;Examine&#160;the&#160;behaviour&#160;of&#160;the&#160;application&#160;(single&#160;process,&#160;multiple&#160;processes,&#160;</p>
<p style="position:absolute;top:586px;left:139px;white-space:nowrap" class="ft12817">multi&#160;thread);</p>
<p style="position:absolute;top:614px;left:112px;white-space:nowrap" class="ft12817">3.&#160;Examine&#160;the&#160;application&#160;data&#160;model&#160;(i.e.&#160;build&#160;a&#160;list&#160;of&#160;files&#160;and&#160;directories&#160;</p>
<p style="position:absolute;top:633px;left:139px;white-space:nowrap" class="ft12817">used);</p>
<p style="position:absolute;top:661px;left:85px;white-space:nowrap" class="ft12819">Then,&#160;for&#160;discovered&#160;directories&#160;the&#160;directory&#160;policy&#160;must&#160;be&#160;added&#160;to&#160;the&#160;file&#160;<br/>“</p>
<p style="position:absolute;top:682px;left:94px;white-space:nowrap" class="ft12851">/etc/kma/template.conf</p>
<p style="position:absolute;top:681px;left:312px;white-space:nowrap" class="ft12817">”.&#160;</p>
<p style="position:absolute;top:710px;left:85px;white-space:nowrap" class="ft12817">The&#160;first&#160;two&#160;elements&#160;are:</p>
<p style="position:absolute;top:743px;left:112px;white-space:nowrap" class="ft12812">●</p>
<p style="position:absolute;top:738px;left:139px;white-space:nowrap" class="ft12817">Protected&#160;directory&#160;pathname&#160;in&#160;the&#160;cryptographic&#160;filesystem&#160;</p>
<p style="position:absolute;top:769px;left:139px;white-space:nowrap" class="ft12812">○</p>
<p style="position:absolute;top:766px;left:166px;white-space:nowrap" class="ft12851">directory &lt;pathname&gt; {&#160;</p>
<p style="position:absolute;top:799px;left:112px;white-space:nowrap" class="ft12812">●</p>
<p style="position:absolute;top:794px;left:139px;white-space:nowrap" class="ft12819">The&#160;discovered&#160;directory&#160;pathname&#160;that&#160;will&#160;be&#160;replaced&#160;with&#160;a&#160;symbolic&#160;link&#160;to&#160;<br/>the&#160;protected&#160;directory</p>
<p style="position:absolute;top:845px;left:139px;white-space:nowrap" class="ft12812">○</p>
<p style="position:absolute;top:842px;left:166px;white-space:nowrap" class="ft12851">bounddir &lt;pathname&gt;</p>
<p style="position:absolute;top:869px;left:85px;white-space:nowrap" class="ft12820"><b>NOTE:&#160;the&#160;pathname&#160;specified&#160;in&#160;the&#160;“bounddir”&#160;parameter&#160;in&#160;the&#160;policy&#160;<br/>statement&#160;must&#160;follow&#160;these&#160;rules:</b></p>
<p style="position:absolute;top:917px;left:112px;white-space:nowrap" class="ft12816"><b>1.&#160;The&#160;pathname&#160;of&#160;the&#160;parent&#160;directory&#160;must&#160;exist&#160;at&#160;the&#160;time&#160;the&#160;</b></p>
<p style="position:absolute;top:936px;left:139px;white-space:nowrap" class="ft12820"><b>system&#160;is&#160;booted&#160;in&#160;learning&#160;mode&#160;(executing&#160;the&#160;procedure&#160;described&#160;<br/>in&#160;the&#160;sections&#160;4.7&#160;until&#160;4.10&#160;is&#160;recommended);</b></p>
<p style="position:absolute;top:983px;left:112px;white-space:nowrap" class="ft12816"><b>2.&#160;Components&#160;of&#160;the&#160;pathname&#160;of&#160;the&#160;parent&#160;must&#160;be&#160;directories&#160;(trees&#160;</b></p>
<p style="position:absolute;top:1002px;left:139px;white-space:nowrap" class="ft12816"><b>with&#160;symbolic&#160;links&#160;are&#160;not&#160;allowed).</b></p>
<p style="position:absolute;top:1031px;left:85px;white-space:nowrap" class="ft12819">These&#160;following&#160;parameters&#160;are&#160;used&#160;to&#160;set&#160;correct&#160;permissions&#160;for&#160;the&#160;protected&#160;<br/>directory:</p>
<p style="position:absolute;top:1074px;left:112px;white-space:nowrap" class="ft12812">●</p>
<p style="position:absolute;top:1069px;left:139px;white-space:nowrap" class="ft12817">POSIX&#160;permission</p>
<p style="position:absolute;top:1100px;left:139px;white-space:nowrap" class="ft12812">○</p>
<p style="position:absolute;top:1097px;left:166px;white-space:nowrap" class="ft12851">permission &lt;mask&gt;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft12821">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft12821">14/35</p>
</div>
<!-- Page 129 -->
<a name="129"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page129-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3129.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1299">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft12950">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft12921">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:153px;left:112px;white-space:nowrap" class="ft12912">●</p>
<p style="position:absolute;top:149px;left:139px;white-space:nowrap" class="ft12917">User&#160;and&#160;group&#160;owner</p>
<p style="position:absolute;top:180px;left:139px;white-space:nowrap" class="ft12912">○</p>
<p style="position:absolute;top:177px;left:166px;white-space:nowrap" class="ft12951">owner &lt;uid:gid&gt;</p>
<p style="position:absolute;top:205px;left:85px;white-space:nowrap" class="ft12919">Then&#160;subjects&#160;allowed&#160;to&#160;access&#160;the&#160;directory&#160;must&#160;be&#160;defined&#160;using&#160;the&#160;parameter&#160;<br/>“</p>
<p style="position:absolute;top:226px;left:94px;white-space:nowrap" class="ft12951">access_mask</p>
<p style="position:absolute;top:224px;left:203px;white-space:nowrap" class="ft12917">”.&#160;&#160;The&#160;term&#160;subject&#160;refers&#160;to&#160;a&#160;process&#160;with&#160;a&#160;set&#160;of&#160;properties&#160;for&#160;</p>
<p style="position:absolute;top:244px;left:85px;white-space:nowrap" class="ft12919">example&#160;the&#160;effective&#160;UID&#160;or&#160;the&#160;KMA&#160;introduced&#160;TAG.&#160;These&#160;properties&#160;are&#160;used&#160;as&#160;<br/>access&#160;control&#160;criteria&#160;for&#160;accessing&#160;the&#160;protected&#160;filesystem:&#160;each&#160;policy&#160;specifies&#160;the&#160;<br/>values&#160;that&#160;a&#160;subject&#160;must&#160;have&#160;at&#160;the&#160;time&#160;it&#160;opens&#160;a&#160;file&#160;or&#160;a&#160;directory.&#160;Currently&#160;<br/>these&#160;are&#160;the&#160;properties&#160;defined:</p>
<p style="position:absolute;top:335px;left:112px;white-space:nowrap" class="ft12912">●</p>
<p style="position:absolute;top:332px;left:139px;white-space:nowrap" class="ft12951">TAG</p>
<p style="position:absolute;top:330px;left:169px;white-space:nowrap" class="ft12917">;</p>
<p style="position:absolute;top:364px;left:112px;white-space:nowrap" class="ft12912">●</p>
<p style="position:absolute;top:361px;left:139px;white-space:nowrap" class="ft12951">effective user identifier</p>
<p style="position:absolute;top:360px;left:387px;white-space:nowrap" class="ft12917">&#160;(the&#160;current&#160;user&#160;privilege&#160;that&#160;can&#160;be&#160;modified&#160;</p>
<p style="position:absolute;top:380px;left:139px;white-space:nowrap" class="ft12917">by&#160;the&#160;application&#160;itself&#160;by&#160;invoking&#160;the&#160;system&#160;call&#160;</p>
<p style="position:absolute;top:381px;left:570px;white-space:nowrap" class="ft12951">setuid()</p>
<p style="position:absolute;top:380px;left:650px;white-space:nowrap" class="ft12917">).</p>
<p style="position:absolute;top:409px;left:85px;white-space:nowrap" class="ft12919">While&#160;the&#160;effective&#160;UID&#160;is&#160;stored&#160;in&#160;a&#160;standard&#160;kernel&#160;structure&#160;associated&#160;to&#160;the&#160;<br/>process,&#160;the&#160;TAG&#160;is&#160;extracted&#160;from&#160;the&#160;extended&#160;attribute&#160;by&#160;a&#160;KMA&#160;kernel&#160;module&#160;<br/>that&#160;decrypts&#160;the&#160;content,&#160;verifies&#160;if&#160;the&#160;SHA1&#160;of&#160;the&#160;executable&#160;bound&#160;matches&#160;this&#160;<br/>read&#160;from&#160;the&#160;payload&#160;and&#160;verifies&#160;the&#160;integrity&#160;of&#160;the&#160;latter&#160;using&#160;the&#160;MasterKey.<br/>The&#160;object&#160;that&#160;permits&#160;to&#160;specify&#160;values&#160;that&#160;a&#160;subject&#160;must&#160;have&#160;for&#160;the&#160;defined&#160;<br/>properties&#160;to&#160;access&#160;the&#160;protected&#160;filesystem&#160;is&#160;called&#160;“</p>
<p style="position:absolute;top:516px;left:547px;white-space:nowrap" class="ft12951">access vector</p>
<p style="position:absolute;top:514px;left:675px;white-space:nowrap" class="ft12917">”.</p>
<p style="position:absolute;top:543px;left:85px;white-space:nowrap" class="ft12917">An&#160;example&#160;is:</p>
<p style="position:absolute;top:571px;left:85px;white-space:nowrap" class="ft12951">|TAG(4 characters)|UID(5 characters)|</p>
<p style="position:absolute;top:599px;left:85px;white-space:nowrap" class="ft12917">General&#160;case&#160;(when&#160;N&#160;properties&#160;are&#160;defined):</p>
<p style="position:absolute;top:627px;left:85px;white-space:nowrap" class="ft12951">|Property#1 value|Property#2 value|...|Property#N value|</p>
<p style="position:absolute;top:655px;left:85px;white-space:nowrap" class="ft12925">Acceptable&#160;values&#160;depend&#160;on&#160;the&#160;property,&#160;but&#160;a&#160;special&#160;symbol&#160;(i.e.&#160;a&#160;“wild&#160;card”)&#160;<br/>has&#160;been&#160;defined&#160;to&#160;represent&#160;“all&#160;possible&#160;values”.&#160;In&#160;order&#160;to&#160;specify&#160;that&#160;all&#160;values&#160;<br/>are&#160;allowed&#160;for&#160;a&#160;property&#160;the&#160;relative&#160;field&#160;of&#160;the&#160;access&#160;vector&#160;must&#160;be&#160;filled&#160;with&#160;a&#160;<br/>string&#160;of&#160;the&#160;character&#160;“X”.<br/>This&#160;is&#160;the&#160;complete&#160;directory&#160;policy&#160;of&#160;a&#160;protected&#160;directory:</p>
<p style="position:absolute;top:769px;left:85px;white-space:nowrap" class="ft12951">directory /system/ssh {</p>
<p style="position:absolute;top:788px;left:138px;white-space:nowrap" class="ft12951">bounddir /etc/ssh</p>
<p style="position:absolute;top:806px;left:138px;white-space:nowrap" class="ft12955">permission 755<br/>owner 0:0</p>
<p style="position:absolute;top:844px;left:138px;white-space:nowrap" class="ft12955">access_mask |XXXX|XXXXX|<br/>declarevar UID=00000</p>
<p style="position:absolute;top:881px;left:138px;white-space:nowrap" class="ft12951">policyfile /root/etc/kma/ssh_system_config</p>
<p style="position:absolute;top:900px;left:85px;white-space:nowrap" class="ft12951">}</p>
<p style="position:absolute;top:937px;left:85px;white-space:nowrap" class="ft12917">Parameters:</p>
<p style="position:absolute;top:970px;left:112px;white-space:nowrap" class="ft12912">●</p>
<p style="position:absolute;top:967px;left:139px;white-space:nowrap" class="ft12951">directory</p>
<p style="position:absolute;top:965px;left:228px;white-space:nowrap" class="ft12917">:&#160;is&#160;the&#160;pathname&#160;of&#160;the&#160;new&#160;directory&#160;will&#160;be&#160;created&#160;in&#160;the&#160;</p>
<p style="position:absolute;top:985px;left:139px;white-space:nowrap" class="ft12917">protected&#160;filesystem;</p>
<p style="position:absolute;top:1018px;left:112px;white-space:nowrap" class="ft12912">●</p>
<p style="position:absolute;top:1015px;left:139px;white-space:nowrap" class="ft12951">bounddir</p>
<p style="position:absolute;top:1014px;left:218px;white-space:nowrap" class="ft12917">:&#160;is&#160;the&#160;old&#160;pathname&#160;of&#160;the&#160;directory&#160;to&#160;protect;</p>
<p style="position:absolute;top:1047px;left:112px;white-space:nowrap" class="ft12912">●</p>
<p style="position:absolute;top:1045px;left:139px;white-space:nowrap" class="ft12951">permission</p>
<p style="position:absolute;top:1043px;left:238px;white-space:nowrap" class="ft12917">:&#160;POSIX&#160;permission&#160;mask;</p>
<p style="position:absolute;top:1077px;left:112px;white-space:nowrap" class="ft12912">●</p>
<p style="position:absolute;top:1074px;left:139px;white-space:nowrap" class="ft12951">owner</p>
<p style="position:absolute;top:1072px;left:189px;white-space:nowrap" class="ft12917">:&#160;userID:groupID&#160;identifiers;</p>
<p style="position:absolute;top:1106px;left:112px;white-space:nowrap" class="ft12912">●</p>
<p style="position:absolute;top:1103px;left:139px;white-space:nowrap" class="ft12951">access_mask</p>
<p style="position:absolute;top:1101px;left:248px;white-space:nowrap" class="ft12917">:&#160;access&#160;vector&#160;allowed&#160;to&#160;read/write/execute&#160;in&#160;the&#160;protected;&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft12921">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft12921">15/35</p>
</div>
<!-- Page 130 -->
<a name="130"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft13057{font-size:17px;font-family:IAAAAA+ArialUnicodeMS;color:#000000;}
-->
</style>
<div id="page130-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3130.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1309">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft13050">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft13021">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:139px;white-space:nowrap" class="ft13019">directory;&#160;may&#160;be&#160;used&#160;multiple&#160;times&#160;to&#160;grant&#160;the&#160;permission&#160;to&#160;different&#160;<br/>subjects;</p>
<p style="position:absolute;top:201px;left:112px;white-space:nowrap" class="ft13012">●</p>
<p style="position:absolute;top:198px;left:139px;white-space:nowrap" class="ft13051">declarevar</p>
<p style="position:absolute;top:196px;left:238px;white-space:nowrap" class="ft13017">:&#160;this&#160;parameter&#160;is&#160;used&#160;to&#160;define&#160;some&#160;variables&#160;which&#160;value&#160;will&#160;be&#160;</p>
<p style="position:absolute;top:217px;left:139px;white-space:nowrap" class="ft13017">replaced&#160;in&#160;the&#160;policy&#160;file;</p>
<p style="position:absolute;top:249px;left:112px;white-space:nowrap" class="ft13012">●</p>
<p style="position:absolute;top:246px;left:139px;white-space:nowrap" class="ft13051">policyfile</p>
<p style="position:absolute;top:245px;left:238px;white-space:nowrap" class="ft13017">:&#160;pathname&#160;of&#160;the&#160;file&#160;policy&#160;that&#160;must&#160;have&#160;the&#160;prefix&#160;“</p>
<p style="position:absolute;top:246px;left:701px;white-space:nowrap" class="ft13051">/root/</p>
<p style="position:absolute;top:245px;left:761px;white-space:nowrap" class="ft13017">”&#160;</p>
<p style="position:absolute;top:265px;left:139px;white-space:nowrap" class="ft13017">(because&#160;this&#160;file&#160;is&#160;read&#160;within&#160;the&#160;initram&#160;disk);</p>
<p style="position:absolute;top:293px;left:85px;white-space:nowrap" class="ft13017">The&#160;policy&#160;file&#160;determines&#160;for&#160;each&#160;file&#160;in&#160;the&#160;protected&#160;directory:</p>
<p style="position:absolute;top:326px;left:112px;white-space:nowrap" class="ft13012">●</p>
<p style="position:absolute;top:321px;left:139px;white-space:nowrap" class="ft13017">subjects&#160;allowed&#160;to&#160;create&#160;(access&#160;vector&#160;followed&#160;by&#160;the&#160;character&#160;“c”)</p>
<p style="position:absolute;top:354px;left:112px;white-space:nowrap" class="ft13012">●</p>
<p style="position:absolute;top:350px;left:139px;white-space:nowrap" class="ft13019">subjects&#160;allowed&#160;to&#160;access&#160;(access&#160;vector&#160;followed&#160;by&#160;the&#160;type&#160;of&#160;operation&#160;<br/>granted)</p>
<p style="position:absolute;top:397px;left:85px;white-space:nowrap" class="ft13025">depending&#160;on&#160;its&#160;name.&#160;Subjects&#160;with&#160;create&#160;permission&#160;have&#160;read,&#160;write,&#160;append&#160;<br/>permission:&#160;it&#160;is&#160;not&#160;necessary&#160;to&#160;specify&#160;an&#160;access&#160;policy&#160;for&#160;them.&#160;&#160;The&#160;“*”&#160;character&#160;<br/>is&#160;used&#160;to&#160;define&#160;the&#160;default&#160;policy,&#160;which&#160;must&#160;be&#160;specified&#160;as&#160;last&#160;statement&#160;for&#160;files&#160;<br/>which&#160;name&#160;does&#160;not&#160;match&#160;any&#160;of&#160;other&#160;listed.&#160;If&#160;the&#160;default&#160;policy&#160;is&#160;not&#160;present,&#160;<br/>files&#160;with&#160;name&#160;not&#160;listed&#160;cannot&#160;be&#160;created&#160;under&#160;the&#160;protected&#160;directory.&#160;<br/>An&#160;example&#160;can&#160;be:</p>
<p style="position:absolute;top:530px;left:85px;white-space:nowrap" class="ft13051">file id_rsa {</p>
<p style="position:absolute;top:549px;left:138px;white-space:nowrap" class="ft13051">|0005|$UID|000|</p>
<p style="position:absolute;top:549px;left:351px;white-space:nowrap" class="ft13051">c</p>
<p style="position:absolute;top:568px;left:138px;white-space:nowrap" class="ft13051">|0001|$UID|000|</p>
<p style="position:absolute;top:568px;left:351px;white-space:nowrap" class="ft13051">r</p>
<p style="position:absolute;top:586px;left:85px;white-space:nowrap" class="ft13051">}</p>
<p style="position:absolute;top:624px;left:85px;white-space:nowrap" class="ft13017">Parameters:</p>
<p style="position:absolute;top:657px;left:112px;white-space:nowrap" class="ft13012">●</p>
<p style="position:absolute;top:654px;left:139px;white-space:nowrap" class="ft13051">file</p>
<p style="position:absolute;top:650px;left:179px;white-space:nowrap" class="ft13057">:</p>
<p style="position:absolute;top:652px;left:183px;white-space:nowrap" class="ft13017">&#160;contains&#160;the&#160;filename&#160;of&#160;the&#160;file&#160;will&#160;be&#160;created</p>
<p style="position:absolute;top:695px;left:112px;white-space:nowrap" class="ft13012">●</p>
<p style="position:absolute;top:692px;left:139px;white-space:nowrap" class="ft13051">&lt;access vector&gt;</p>
<p style="position:absolute;top:688px;left:288px;white-space:nowrap" class="ft13057">:&#160;</p>
<p style="position:absolute;top:690px;left:297px;white-space:nowrap" class="ft13017">if&#160;followed&#160;by&#160;the&#160;letter&#160;'c'&#160;it&#160;means&#160;that&#160;the&#160;subject&#160;is&#160;</p>
<p style="position:absolute;top:711px;left:139px;white-space:nowrap" class="ft13017">allowed&#160;to&#160;create;&#160;if&#160;followed&#160;by&#160;'</p>
<p style="position:absolute;top:712px;left:414px;white-space:nowrap" class="ft13051">r</p>
<p style="position:absolute;top:711px;left:424px;white-space:nowrap" class="ft13017">',&#160;'</p>
<p style="position:absolute;top:712px;left:443px;white-space:nowrap" class="ft13051">w</p>
<p style="position:absolute;top:711px;left:453px;white-space:nowrap" class="ft13017">',&#160;'</p>
<p style="position:absolute;top:712px;left:473px;white-space:nowrap" class="ft13051">x</p>
<p style="position:absolute;top:711px;left:483px;white-space:nowrap" class="ft13017">',&#160;'</p>
<p style="position:absolute;top:712px;left:502px;white-space:nowrap" class="ft13051">a</p>
<p style="position:absolute;top:711px;left:512px;white-space:nowrap" class="ft13017">'&#160;or&#160;a&#160;combination,&#160;these&#160;are&#160;</p>
<p style="position:absolute;top:731px;left:139px;white-space:nowrap" class="ft13019">respectively&#160;the&#160;read/write/execute/append&#160;permissions&#160;granted&#160;to&#160;subjects&#160;<br/>with&#160;this&#160;access&#160;vector.&#160;Multiple&#160;access&#160;vectors&#160;can&#160;be&#160;defined&#160;in&#160;the&#160;same&#160;<br/>policy.</p>
<p style="position:absolute;top:816px;left:92px;white-space:nowrap" class="ft13016"><b>&#160;4.5&#160;&#160;Creation&#160;of&#160;the&#160;file&#160;/etc/kma/checkfilelist</b></p>
<p style="position:absolute;top:844px;left:85px;white-space:nowrap" class="ft13019">Contains&#160;the&#160;list&#160;of&#160;files&#160;that&#160;will&#160;be&#160;measured&#160;at&#160;boot&#160;and&#160;which&#160;SHA1&#160;extends&#160;the&#160;<br/>PCR#13&#160;of&#160;the&#160;TPM.&#160;Typically&#160;these&#160;are&#160;the&#160;files&#160;measured:</p>
<p style="position:absolute;top:894px;left:112px;white-space:nowrap" class="ft13012">●</p>
<p style="position:absolute;top:891px;left:139px;white-space:nowrap" class="ft13051">/etc/fstab</p>
<p style="position:absolute;top:922px;left:112px;white-space:nowrap" class="ft13012">●</p>
<p style="position:absolute;top:919px;left:139px;white-space:nowrap" class="ft13051">/etc/kma/boot.conf</p>
<p style="position:absolute;top:950px;left:112px;white-space:nowrap" class="ft13012">●</p>
<p style="position:absolute;top:947px;left:139px;white-space:nowrap" class="ft13051">/etc/kma/template.conf (and the files whose pathname is specified&#160;</p>
<p style="position:absolute;top:966px;left:139px;white-space:nowrap" class="ft13051">in the policyfile parameter)</p>
<p style="position:absolute;top:996px;left:112px;white-space:nowrap" class="ft13012">●</p>
<p style="position:absolute;top:994px;left:139px;white-space:nowrap" class="ft13051">/etc/kma/logs/mmap_list (introduced in section 4.7.6)</p>
<p style="position:absolute;top:1024px;left:112px;white-space:nowrap" class="ft13012">●</p>
<p style="position:absolute;top:1021px;left:139px;white-space:nowrap" class="ft13051">/etc/kma/logs/directaccess_list (introduced in section 4.7.6)</p>
<p style="position:absolute;top:1052px;left:112px;white-space:nowrap" class="ft13012">●</p>
<p style="position:absolute;top:1049px;left:139px;white-space:nowrap" class="ft13051">/etc/kma/logs/modules_list (introduced in section 4.7.2)</p>
<p style="position:absolute;top:1080px;left:112px;white-space:nowrap" class="ft13012">●</p>
<p style="position:absolute;top:1077px;left:139px;white-space:nowrap" class="ft13051">/etc/kma/signed_binaries</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft13021">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft13021">16/35</p>
</div>
<!-- Page 131 -->
<a name="131"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page131-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3131.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1319">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft13150">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft13121">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:92px;white-space:nowrap" class="ft13120"><b>&#160;4.6&#160;&#160;MasterKey&#160;generation&#160;and&#160;NV&#160;storage&#160;configuration&#160;(only&#160;for&#160;TPM&#160;<br/>v1.2)</b></p>
<p style="position:absolute;top:196px;left:85px;white-space:nowrap" class="ft13119">The&#160;last&#160;task&#160;to&#160;execute&#160;before&#160;booting&#160;the&#160;KMA&#160;kernel&#160;in&#160;learning&#160;mode&#160;is&#160;to&#160;setup&#160;a&#160;<br/>new&#160;MasterKey:&#160;this&#160;is&#160;done&#160;by&#160;executing&#160;these&#160;steps:</p>
<p style="position:absolute;top:244px;left:112px;white-space:nowrap" class="ft13117">1.&#160;Be&#160;sure&#160;that&#160;the&#160;TPM&#160;driver&#160;is&#160;loaded:&#160;execute&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:263px;left:139px;white-space:nowrap" class="ft13151">modprobe &lt;your TPM module&gt;</p>
<p style="position:absolute;top:291px;left:139px;white-space:nowrap" class="ft13117">1.&#160;For&#160;the&#160;TPM&#160;emulator&#160;run&#160;the&#160;additional&#160;command&#160;</p>
<p style="position:absolute;top:292px;left:590px;white-space:nowrap" class="ft13151">tpmd</p>
<p style="position:absolute;top:320px;left:112px;white-space:nowrap" class="ft13117">2.&#160;Be&#160;sure&#160;that&#160;Trousers&#160;daemon&#160;is&#160;not&#160;running:&#160;execute&#160;the&#160;command</p>
<p style="position:absolute;top:341px;left:139px;white-space:nowrap" class="ft13151">service tcsd stop</p>
<p style="position:absolute;top:339px;left:308px;white-space:nowrap" class="ft13117">;</p>
<p style="position:absolute;top:368px;left:112px;white-space:nowrap" class="ft13117">3.&#160;Execute&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:370px;left:331px;white-space:nowrap" class="ft13151">init_masterkey.sh</p>
<p style="position:absolute;top:368px;left:499px;white-space:nowrap" class="ft13117">&#160;without&#160;any&#160;parameter;</p>
<p style="position:absolute;top:398px;left:112px;white-space:nowrap" class="ft13117">4.&#160;Restart&#160;Trousers&#160;daemon&#160;for&#160;the&#160;next&#160;steps:&#160;execute&#160;the&#160;command</p>
<p style="position:absolute;top:418px;left:139px;white-space:nowrap" class="ft13151">service tcsd start</p>
<p style="position:absolute;top:417px;left:317px;white-space:nowrap" class="ft13117">.</p>
<p style="position:absolute;top:446px;left:85px;white-space:nowrap" class="ft13119">This&#160;operation&#160;may&#160;require&#160;to&#160;plug&#160;an&#160;external&#160;device,&#160;before&#160;saving&#160;the&#160;new&#160;<br/>MasterKey;&#160;otherwise&#160;this&#160;will&#160;be&#160;saved&#160;in&#160;the&#160;default&#160;path&#160;</p>
<p style="position:absolute;top:467px;left:576px;white-space:nowrap" class="ft13151">/etc/kma/keys</p>
<p style="position:absolute;top:465px;left:705px;white-space:nowrap" class="ft13117">.</p>
<p style="position:absolute;top:495px;left:85px;white-space:nowrap" class="ft13117">A&#160;new&#160;MasterKey&#160;is&#160;randomly&#160;generated&#160;using&#160;the&#160;device&#160;“</p>
<p style="position:absolute;top:496px;left:576px;white-space:nowrap" class="ft13151">/dev/urandom</p>
<p style="position:absolute;top:495px;left:695px;white-space:nowrap" class="ft13117">”&#160;and&#160;a&#160;new&#160;</p>
<p style="position:absolute;top:515px;left:85px;white-space:nowrap" class="ft13125">TPM&#160;wrapping&#160;key&#160;is&#160;created&#160;to&#160;encrypt&#160;it.&#160;&#160;In&#160;order&#160;to&#160;protect&#160;the&#160;unwrapping&#160;<br/>operation&#160;the&#160;Administrator&#160;must&#160;set,&#160;for&#160;this&#160;TPM&#160;key,&#160;a&#160;password:&#160;the&#160;knowledge&#160;of&#160;<br/>this&#160;secret&#160;allows&#160;an&#160;user&#160;to&#160;boot&#160;the&#160;system&#160;in&#160;learning&#160;mode,&#160;to&#160;access&#160;all&#160;data&#160;in&#160;<br/>the&#160;protected&#160;filesystem&#160;and&#160;to&#160;certify&#160;binaries.<br/>For&#160;platforms&#160;with&#160;TPM&#160;1.2&#160;it&#160;is&#160;available&#160;a&#160;feature&#160;that&#160;permits&#160;to&#160;check&#160;the&#160;“version”&#160;<br/>of&#160;the&#160;sealed&#160;blob&#160;containing&#160;the&#160;MasterKey.&#160;This&#160;is&#160;useful&#160;in&#160;the&#160;following&#160;case:&#160;the&#160;<br/>Administrator&#160;creates&#160;a&#160;new&#160;sealed&#160;blob&#160;when&#160;a&#160;component&#160;in&#160;the&#160;measurement&#160;list&#160;<br/>changes;&#160;if&#160;an&#160;attacker&#160;has&#160;a&#160;copy&#160;of&#160;the&#160;old&#160;sealed&#160;blob&#160;and&#160;he&#160;knowns&#160;exactly&#160;the&#160;<br/>previous&#160;state&#160;of&#160;the&#160;changed&#160;component,&#160;he&#160;will&#160;be&#160;able&#160;to&#160;use&#160;the&#160;MasterKey&#160;with&#160;<br/>the&#160;old&#160;configuration,&#160;which&#160;may&#160;be&#160;replaced&#160;due&#160;to&#160;a&#160;discovered&#160;vulnerability.&#160;<br/>In&#160;order&#160;to&#160;avoid&#160;this&#160;situation&#160;the&#160;Administrator&#160;must&#160;attach&#160;an&#160;unique&#160;label&#160;to&#160;the&#160;<br/>MasterKey,&#160;during&#160;the&#160;generation&#160;process&#160;and&#160;stores&#160;the&#160;same&#160;label&#160;in&#160;a&#160;portion&#160;of&#160;the&#160;<br/>NV&#160;storage&#160;of&#160;the&#160;TPM.<br/>During&#160;the&#160;boot,&#160;the&#160;kernel&#160;module&#160;which&#160;performs&#160;the&#160;unsealing&#160;reads&#160;the&#160;label&#160;<br/>stored&#160;within&#160;the&#160;MasterKey&#160;and&#160;compares&#160;it&#160;with&#160;the&#160;one&#160;read&#160;from&#160;the&#160;TPM.&#160;If&#160;they&#160;<br/>are&#160;different,&#160;the&#160;kernel&#160;module&#160;forbids&#160;the&#160;access&#160;to&#160;the&#160;MasterKey&#160;and&#160;the&#160;system&#160;<br/>must&#160;be&#160;rebooted.<br/>When&#160;the&#160;Administrator&#160;updates&#160;the&#160;sealed&#160;blob&#160;he&#160;writes&#160;a&#160;new&#160;label&#160;with&#160;the&#160;<br/>MasterKey&#160;and&#160;in&#160;the&#160;NV&#160;storage:&#160;this&#160;way&#160;old&#160;sealed&#160;blobs&#160;cannot&#160;be&#160;used.<br/>If&#160;the&#160;utility&#160;</p>
<p style="position:absolute;top:926px;left:186px;white-space:nowrap" class="ft13151">init_masterkey.sh</p>
<p style="position:absolute;top:925px;left:354px;white-space:nowrap" class="ft13117">&#160;finds&#160;a&#160;compatible&#160;TPM,&#160;it&#160;asks&#160;to&#160;the&#160;Administrator&#160;</p>
<p style="position:absolute;top:945px;left:85px;white-space:nowrap" class="ft13125">the&#160;label&#160;to&#160;append&#160;to&#160;the&#160;MasterKey;&#160;otherwise&#160;the&#160;feature&#160;will&#160;be&#160;disabled.&#160;For&#160;now,&#160;<br/>the&#160;size&#160;is&#160;hard&#160;coded&#160;and&#160;must&#160;be&#160;exactly&#160;10&#160;characters&#160;long.<br/>In&#160;order&#160;to&#160;define&#160;and&#160;protect&#160;the&#160;NV&#160;storage&#160;portion&#160;these&#160;steps&#160;must&#160;be&#160;performed:</p>
<p style="position:absolute;top:1020px;left:112px;white-space:nowrap" class="ft13117">1.&#160;Execute&#160;the&#160;command:&#160;</p>
<p style="position:absolute;top:1022px;left:336px;white-space:nowrap" class="ft13151">kma_define_nv</p>
<p style="position:absolute;top:1050px;left:139px;white-space:nowrap" class="ft13125">1.&#160;Enter&#160;the&#160;TPM&#160;owner&#160;password;<br/>2.&#160;Enter&#160;the&#160;secret&#160;will&#160;be&#160;used&#160;to&#160;protect&#160;this&#160;portion&#160;from&#160;writes;</p>
<p style="position:absolute;top:1106px;left:112px;white-space:nowrap" class="ft13117">2.&#160;Execute&#160;the&#160;command:&#160;</p>
<p style="position:absolute;top:1108px;left:336px;white-space:nowrap" class="ft13151">kma_write_nv</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft13121">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft13121">17/35</p>
</div>
<!-- Page 132 -->
<a name="132"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page132-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3132.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1329">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft13250">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft13221">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:139px;white-space:nowrap" class="ft13225">1.&#160;Enter&#160;the&#160;secret&#160;set&#160;for&#160;the&#160;portion&#160;of&#160;the&#160;NV&#160;storage;<br/>2.&#160;Enter&#160;the&#160;same&#160;label&#160;appended&#160;to&#160;the&#160;MasterKey&#160;when&#160;the&#160;utility&#160;</p>
<p style="position:absolute;top:198px;left:166px;white-space:nowrap" class="ft13251">init_masterkey.sh</p>
<p style="position:absolute;top:196px;left:335px;white-space:nowrap" class="ft13217">&#160;was&#160;executed.</p>
<p style="position:absolute;top:226px;left:85px;white-space:nowrap" class="ft13219">In&#160;case&#160;of&#160;the&#160;error&#160;TSS_E_NV_AREA_EXIST&#160;is&#160;displayed,&#160;it&#160;means&#160;that&#160;the&#160;index&#160;has&#160;<br/>already&#160;defined.&#160;At&#160;the&#160;moment&#160;it&#160;is&#160;not&#160;possible&#160;to&#160;define&#160;an&#160;alternate&#160;address&#160;of&#160;the&#160;<br/>TPM&#160;where&#160;to&#160;place&#160;the&#160;label:&#160;the&#160;Administrator&#160;must&#160;move&#160;data&#160;in&#160;the&#160;existent&#160;index&#160;<br/>to&#160;another&#160;and&#160;call&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:285px;left:367px;white-space:nowrap" class="ft13251">kma_release_nv</p>
<p style="position:absolute;top:283px;left:505px;white-space:nowrap" class="ft13217">&#160;to&#160;release&#160;the&#160;space.&#160;Then&#160;the&#160;</p>
<p style="position:absolute;top:303px;left:85px;white-space:nowrap" class="ft13219">steps&#160;described&#160;above&#160;must&#160;be&#160;re-executed.<br/>In&#160;order&#160;to&#160;verify&#160;if&#160;the&#160;label&#160;has&#160;correctly&#160;written&#160;in&#160;the&#160;NV&#160;storage&#160;the&#160;Administrator&#160;<br/>can&#160;execute&#160;the&#160;utility&#160;</p>
<p style="position:absolute;top:352px;left:276px;white-space:nowrap" class="ft13251">kma_read_nv</p>
<p style="position:absolute;top:351px;left:385px;white-space:nowrap" class="ft13217">&#160;without&#160;any&#160;parameter.&#160;The&#160;utility&#160;asks&#160;to&#160;insert&#160;</p>
<p style="position:absolute;top:371px;left:85px;white-space:nowrap" class="ft13225">the&#160;label&#160;10&#160;character&#160;long&#160;must&#160;be&#160;inserted.<br/>After&#160;the&#160;script&#160;has&#160;been&#160;executed,&#160;these&#160;files&#160;are&#160;created&#160;under&#160;the&#160;path&#160;</p>
<p style="position:absolute;top:420px;left:85px;white-space:nowrap" class="ft13251">/etc/kma/keys</p>
<p style="position:absolute;top:418px;left:214px;white-space:nowrap" class="ft13217">:</p>
<p style="position:absolute;top:448px;left:112px;white-space:nowrap" class="ft13217">1.</p>
<p style="position:absolute;top:449px;left:139px;white-space:nowrap" class="ft13251">masterkey.key</p>
<p style="position:absolute;top:448px;left:268px;white-space:nowrap" class="ft13217">:&#160;TPM&#160;wrapping&#160;key,&#160;private&#160;portion;</p>
<p style="position:absolute;top:477px;left:112px;white-space:nowrap" class="ft13217">2.</p>
<p style="position:absolute;top:479px;left:139px;white-space:nowrap" class="ft13251">masterkey.pem</p>
<p style="position:absolute;top:477px;left:268px;white-space:nowrap" class="ft13217">:&#160;TPM&#160;wrapping&#160;key,&#160;public&#160;portion;</p>
<p style="position:absolute;top:506px;left:112px;white-space:nowrap" class="ft13217">3.</p>
<p style="position:absolute;top:508px;left:139px;white-space:nowrap" class="ft13251">masterkey.blob</p>
<p style="position:absolute;top:506px;left:278px;white-space:nowrap" class="ft13217">:&#160;MasterKey&#160;blob&#160;bound&#160;to&#160;the&#160;TPM&#160;wrapping&#160;key.</p>
<p style="position:absolute;top:553px;left:92px;white-space:nowrap" class="ft13216"><b>&#160;4.7&#160;&#160;First&#160;boot&#160;in&#160;learning&#160;mode</b></p>
<p style="position:absolute;top:582px;left:85px;white-space:nowrap" class="ft13219">The&#160;KMA-enabled&#160;kernel&#160;should&#160;be&#160;started&#160;for&#160;the&#160;first&#160;time&#160;in&#160;learning&#160;mode&#160;in&#160;order&#160;<br/>to:</p>
<p style="position:absolute;top:629px;left:112px;white-space:nowrap" class="ft13225">1.&#160;Check&#160;the&#160;filesystem&#160;configuration;<br/>2.&#160;Discover&#160;kernel&#160;modules&#160;loaded&#160;and&#160;identify&#160;what&#160;are&#160;necessary&#160;for&#160;the&#160;system&#160;</p>
<p style="position:absolute;top:676px;left:139px;white-space:nowrap" class="ft13217">to&#160;work&#160;correctly;</p>
<p style="position:absolute;top:705px;left:112px;white-space:nowrap" class="ft13225">3.&#160;Discover&#160;applications&#160;that&#160;need&#160;direct&#160;access&#160;to&#160;devices;<br/>4.&#160;Certify&#160;applications;<br/>5.&#160;Importing&#160;existent&#160;data&#160;files&#160;of&#160;certified&#160;applications&#160;&#160;<br/>6.&#160;Discover&#160;and&#160;measure&#160;libraries&#160;used&#160;by&#160;certified&#160;applications.</p>
<p style="position:absolute;top:817px;left:85px;white-space:nowrap" class="ft13219">The&#160;following&#160;sub&#160;paragraphs&#160;describe&#160;how&#160;to&#160;set&#160;up&#160;correctly&#160;the&#160;KMA&#160;before&#160;it&#160;is&#160;<br/>executed&#160;in&#160;enforcing&#160;mode.<br/>To&#160;boot&#160;the&#160;system&#160;in&#160;learning&#160;mode&#160;select&#160;the&#160;proper&#160;entry&#160;in&#160;the&#160;TrustedGRUB&#160;<br/>menu.</p>
<p style="position:absolute;top:930px;left:85px;white-space:nowrap" class="ft13252"><b>&#160;4.7.1&#160;&#160;Checking&#160;the&#160;filesystem&#160;configuration</b></p>
<p style="position:absolute;top:957px;left:85px;white-space:nowrap" class="ft13219">The&#160;ecryptfs&#160;filesystem&#160;is&#160;mounted&#160;in&#160;the&#160;initram&#160;disk.&#160;The&#160;mount&#160;parameter&#160;<br/>“</p>
<p style="position:absolute;top:978px;left:94px;white-space:nowrap" class="ft13251">kmatemplate=</p>
<p style="position:absolute;top:976px;left:213px;white-space:nowrap" class="ft13217">”&#160;introduced&#160;by&#160;KMA&#160;is&#160;used&#160;to&#160;specify&#160;the&#160;corresponding&#160;filesystem&#160;</p>
<p style="position:absolute;top:996px;left:85px;white-space:nowrap" class="ft13219">policy&#160;to&#160;be&#160;loaded.&#160;During&#160;the&#160;learning&#160;phase&#160;the&#160;Administrator&#160;must&#160;verify&#160;if&#160;the&#160;<br/>syntax&#160;is&#160;correct.&#160;To&#160;do&#160;this&#160;operation&#160;he&#160;must&#160;perform&#160;the&#160;command&#160;“</p>
<p style="position:absolute;top:1017px;left:677px;white-space:nowrap" class="ft13251">dmesg | more</p>
<p style="position:absolute;top:1015px;left:796px;white-space:nowrap" class="ft13217">”&#160;</p>
<p style="position:absolute;top:1036px;left:85px;white-space:nowrap" class="ft13217">and&#160;check&#160;these&#160;lines:</p>
<p style="position:absolute;top:1064px;left:85px;white-space:nowrap" class="ft13255">KMA learning mode enabled<br/>Inserted auth tok with sig [2d8f66ccb71c579f] into the user session&#160;</p>
<p style="position:absolute;top:1101px;left:85px;white-space:nowrap" class="ft13255">keyring<br/>mask: |XXXX|XXXXX|XXX|, access: 7</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft13221">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft13221">18/35</p>
</div>
<!-- Page 133 -->
<a name="133"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page133-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3133.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1339">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft13350">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft13321">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:85px;white-space:nowrap" class="ft13351">name UID - value 00000</p>
<p style="position:absolute;top:168px;left:85px;white-space:nowrap" class="ft13355">mask: |0006|00000|000|, access: -1<br/>mask: |0006|XXXXX|000|, access: 6</p>
<p style="position:absolute;top:205px;left:85px;white-space:nowrap" class="ft13355">mask: |0001|XXXXX|000|, access: 4<br/>Info: added file ssh_config</p>
<p style="position:absolute;top:242px;left:85px;white-space:nowrap" class="ft13319">If&#160;an&#160;error&#160;is&#160;encountered,&#160;the&#160;following&#160;message&#160;appears&#160;and&#160;the&#160;Administrator&#160;must&#160;<br/>recheck&#160;the&#160;policy&#160;files:</p>
<p style="position:absolute;top:290px;left:85px;white-space:nowrap" class="ft13351">Failed to initialize protected filesystem</p>
<p style="position:absolute;top:308px;left:85px;white-space:nowrap" class="ft13319">The&#160;Administrator&#160;must&#160;fix&#160;the&#160;files&#160;by&#160;booting&#160;the&#160;KMA&#160;in&#160;“disabled”&#160;mode&#160;and&#160;then&#160;<br/>must&#160;recheck&#160;the&#160;configuration&#160;in&#160;learning&#160;mode.</p>
<p style="position:absolute;top:374px;left:85px;white-space:nowrap" class="ft13352"><b>&#160;4.7.2&#160;&#160;Discovering&#160;kernel&#160;modules</b></p>
<p style="position:absolute;top:400px;left:85px;white-space:nowrap" class="ft13319">The&#160;Administrator&#160;must&#160;detect&#160;which&#160;kernel&#160;modules&#160;will&#160;be&#160;allowed&#160;to&#160;load&#160;when&#160;the&#160;<br/>KMA&#160;is&#160;executed&#160;in&#160;enforcing&#160;mode&#160;and&#160;must&#160;check&#160;if&#160;they&#160;contain&#160;malicious&#160;code.&#160;<br/>When&#160;the&#160;system&#160;is&#160;started&#160;in&#160;learning&#160;mode&#160;some&#160;modules&#160;are&#160;loaded&#160;automatically&#160;<br/>when&#160;initializing&#160;devices.&#160;Others&#160;must&#160;be&#160;manually&#160;inserted&#160;by&#160;the&#160;Administrator&#160;using&#160;<br/>the&#160;command&#160;</p>
<p style="position:absolute;top:479px;left:205px;white-space:nowrap" class="ft13351">insmod</p>
<p style="position:absolute;top:477px;left:265px;white-space:nowrap" class="ft13317">&#160;or&#160;</p>
<p style="position:absolute;top:479px;left:292px;white-space:nowrap" class="ft13351">modprobe</p>
<p style="position:absolute;top:477px;left:371px;white-space:nowrap" class="ft13317">.&#160;Then,&#160;when&#160;all&#160;required&#160;modules&#160;are&#160;loaded,&#160;the&#160;</p>
<p style="position:absolute;top:497px;left:85px;white-space:nowrap" class="ft13319">Administrator&#160;can&#160;review&#160;the&#160;list&#160;and&#160;the&#160;digest&#160;of&#160;every&#160;item&#160;by&#160;executing&#160;the&#160;<br/>command&#160;</p>
<p style="position:absolute;top:518px;left:173px;white-space:nowrap" class="ft13351">kma_modules_db /etc/kma/logs/modules_list&#160;</p>
<p style="position:absolute;top:517px;left:589px;white-space:nowrap" class="ft13317">and&#160;typing&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:538px;left:85px;white-space:nowrap" class="ft13351">view&lt;ENTER&gt;</p>
<p style="position:absolute;top:537px;left:194px;white-space:nowrap" class="ft13317">.&#160;To&#160;exit&#160;the&#160;application&#160;type&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:538px;left:557px;white-space:nowrap" class="ft13351">quit&lt;ENTER&gt;</p>
<p style="position:absolute;top:537px;left:666px;white-space:nowrap" class="ft13317">.</p>
<p style="position:absolute;top:584px;left:85px;white-space:nowrap" class="ft13352"><b>&#160;4.7.3&#160;&#160;Discovering&#160;applications&#160;that&#160;need&#160;direct&#160;access&#160;to&#160;devices</b></p>
<p style="position:absolute;top:610px;left:85px;white-space:nowrap" class="ft13317">The&#160;Administrator&#160;can&#160;discover&#160;them&#160;by&#160;prompting&#160;the&#160;command:&#160;</p>
<p style="position:absolute;top:612px;left:639px;white-space:nowrap" class="ft13351">dmesg | grep&#160;</p>
<p style="position:absolute;top:632px;left:85px;white-space:nowrap" class="ft13351">“signed”</p>
<p style="position:absolute;top:631px;left:164px;white-space:nowrap" class="ft13317">.&#160;This&#160;type&#160;of&#160;message&#160;will&#160;be&#160;displayed:&#160;</p>
<p style="position:absolute;top:632px;left:505px;white-space:nowrap" class="ft13351">“KMA direct access: process X&#160;</p>
<p style="position:absolute;top:653px;left:85px;white-space:nowrap" class="ft13351">needs to be signed”</p>
<p style="position:absolute;top:651px;left:273px;white-space:nowrap" class="ft13317">.&#160;If&#160;the&#160;Administrator&#160;wants&#160;to&#160;allow&#160;an&#160;application&#160;to&#160;access&#160;</p>
<p style="position:absolute;top:671px;left:85px;white-space:nowrap" class="ft13317">directly&#160;a&#160;device&#160;he&#160;must&#160;add&#160;a&#160;new&#160;record&#160;in&#160;the&#160;file&#160;</p>
<p style="position:absolute;top:673px;left:533px;white-space:nowrap" class="ft13351">/etc/kma/signed_binaries.</p>
<p style="position:absolute;top:700px;left:85px;white-space:nowrap" class="ft13320"><b>NOTE:&#160;the&#160;process&#160;name&#160;specified&#160;in&#160;the&#160;log&#160;message&#160;may&#160;be&#160;incomplete:&#160;to&#160;<br/>find&#160;the&#160;full&#160;pathname&#160;of&#160;the&#160;binary&#160;executable&#160;this&#160;command&#160;should&#160;be&#160;<br/>performed:&#160;find&#160;/&#160;-name&#160;“&lt;part&#160;of&#160;the&#160;process&#160;name&gt;*”.</b></p>
<p style="position:absolute;top:785px;left:85px;white-space:nowrap" class="ft13352"><b>&#160;4.7.4&#160;&#160;Certifying&#160;binaries</b></p>
<p style="position:absolute;top:812px;left:85px;white-space:nowrap" class="ft13317">The&#160;Administrator&#160;after&#160;having&#160;verified&#160;binaries&#160;listed&#160;in&#160;the&#160;file&#160;</p>
<p style="position:absolute;top:832px;left:85px;white-space:nowrap" class="ft13351">/etc/kma/signed_binaries</p>
<p style="position:absolute;top:831px;left:323px;white-space:nowrap" class="ft13317">&#160;executes&#160;the&#160;utility&#160;</p>
<p style="position:absolute;top:832px;left:493px;white-space:nowrap" class="ft13351">certbin</p>
<p style="position:absolute;top:831px;left:562px;white-space:nowrap" class="ft13317">.&#160;The&#160;syntax&#160;is:</p>
<p style="position:absolute;top:863px;left:112px;white-space:nowrap" class="ft13312">●</p>
<p style="position:absolute;top:860px;left:139px;white-space:nowrap" class="ft13351">certbin --list /etc/kma/signed_binaries;</p>
<p style="position:absolute;top:888px;left:85px;white-space:nowrap" class="ft13317">If&#160;the&#160;message&#160;“</p>
<p style="position:absolute;top:889px;left:221px;white-space:nowrap" class="ft13351">hashing of &lt;filename&gt; failed</p>
<p style="position:absolute;top:888px;left:499px;white-space:nowrap" class="ft13317">”&#160;appears&#160;the&#160;Administrator&#160;must&#160;</p>
<p style="position:absolute;top:908px;left:85px;white-space:nowrap" class="ft13317">recheck&#160;the&#160;file&#160;</p>
<p style="position:absolute;top:910px;left:218px;white-space:nowrap" class="ft13351">/etc/kma/signed_binaries</p>
<p style="position:absolute;top:908px;left:456px;white-space:nowrap" class="ft13317">&#160;and&#160;correct&#160;the&#160;path&#160;of&#160;the&#160;not&#160;found&#160;</p>
<p style="position:absolute;top:928px;left:85px;white-space:nowrap" class="ft13319">executable(s).&#160;A&#160;requirement&#160;for&#160;booting&#160;the&#160;KMA&#160;in&#160;enforcing&#160;mode&#160;is&#160;that&#160;the&#160;<br/>mentioned&#160;file&#160;contains&#160;valid&#160;pathnames&#160;and&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:949px;left:584px;white-space:nowrap" class="ft13351">certbin</p>
<p style="position:absolute;top:948px;left:653px;white-space:nowrap" class="ft13317">&#160;is&#160;executed:&#160;this&#160;</p>
<p style="position:absolute;top:968px;left:85px;white-space:nowrap" class="ft13319">is&#160;necessary&#160;in&#160;order&#160;to&#160;prevent&#160;that&#160;certified&#160;binaries&#160;are&#160;replaced&#160;by&#160;others&#160;<br/>unsigned,&#160;when&#160;KMA&#160;is&#160;not&#160;loaded,&#160;and&#160;users&#160;execute&#160;them&#160;without&#160;being&#160;noticed.</p>
<p style="position:absolute;top:1033px;left:85px;white-space:nowrap" class="ft13352"><b>&#160;4.7.5&#160;&#160;Importing&#160;unprotected&#160;files&#160;in&#160;the&#160;eCryptfs&#160;filesystem</b></p>
<p style="position:absolute;top:1060px;left:85px;white-space:nowrap" class="ft13319">During&#160;the&#160;previous&#160;boot&#160;(the&#160;first&#160;one&#160;in&#160;learning&#160;mode)&#160;the&#160;KMA&#160;creates&#160;protected&#160;<br/>directories&#160;in&#160;the&#160;eCryptfs&#160;filesystem&#160;as&#160;specified&#160;in&#160;the&#160;file&#160;</p>
<p style="position:absolute;top:1081px;left:582px;white-space:nowrap" class="ft13351">/etc/kma/template.conf</p>
<p style="position:absolute;top:1079px;left:800px;white-space:nowrap" class="ft13317">,&#160;</p>
<p style="position:absolute;top:1099px;left:85px;white-space:nowrap" class="ft13317">renames&#160;directories&#160;specified&#160;in&#160;the&#160;parameter&#160;“</p>
<p style="position:absolute;top:1101px;left:489px;white-space:nowrap" class="ft13351">bounddir</p>
<p style="position:absolute;top:1099px;left:568px;white-space:nowrap" class="ft13317">”&#160;in&#160;the&#160;unprotected&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft13321">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft13321">19/35</p>
</div>
<!-- Page 134 -->
<a name="134"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page134-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3134.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1349">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft13450">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft13421">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:85px;white-space:nowrap" class="ft13417">filesystem&#160;by&#160;adding&#160;the&#160;suffix&#160;“</p>
<p style="position:absolute;top:151px;left:354px;white-space:nowrap" class="ft13451">_save</p>
<p style="position:absolute;top:149px;left:403px;white-space:nowrap" class="ft13417">”&#160;and&#160;creates&#160;instead&#160;symbolic&#160;links&#160;to&#160;the&#160;</p>
<p style="position:absolute;top:169px;left:85px;white-space:nowrap" class="ft13417">protected&#160;directories&#160;with&#160;the&#160;old&#160;name;&#160;the&#160;KMA&#160;script&#160;creates&#160;the&#160;file&#160;</p>
<p style="position:absolute;top:190px;left:85px;white-space:nowrap" class="ft13451">/etc/kma/files_saved</p>
<p style="position:absolute;top:188px;left:283px;white-space:nowrap" class="ft13417">&#160;that&#160;contains&#160;records&#160;with&#160;the&#160;renamed&#160;directory&#160;in&#160;the&#160;</p>
<p style="position:absolute;top:209px;left:85px;white-space:nowrap" class="ft13419">unprotected&#160;filesystem&#160;and&#160;the&#160;directory&#160;in&#160;the&#160;protected&#160;filesystem&#160;where&#160;existent&#160;<br/>files&#160;would&#160;be&#160;copied.&#160;An&#160;example&#160;file&#160;ready&#160;to&#160;use&#160;is&#160;provided&#160;in&#160;</p>
<p style="position:absolute;top:249px;left:85px;white-space:nowrap" class="ft13451">/etc/kma/sample_config</p>
<p style="position:absolute;top:247px;left:303px;white-space:nowrap" class="ft13417">.&#160;The&#160;Administrator&#160;decides,&#160;for&#160;all&#160;directories,&#160;what&#160;files&#160;to&#160;</p>
<p style="position:absolute;top:267px;left:85px;white-space:nowrap" class="ft13417">copy&#160;to&#160;protected&#160;locations&#160;and&#160;executes&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:269px;left:553px;white-space:nowrap" class="ft13451">kma_makesecure.sh</p>
<p style="position:absolute;top:267px;left:721px;white-space:nowrap" class="ft13417">&#160;by&#160;</p>
<p style="position:absolute;top:288px;left:85px;white-space:nowrap" class="ft13417">specifying&#160;as&#160;parameters&#160;the&#160;file&#160;</p>
<p style="position:absolute;top:289px;left:362px;white-space:nowrap" class="ft13451">/etc/kma/files_saved</p>
<p style="position:absolute;top:288px;left:560px;white-space:nowrap" class="ft13417">&#160;and&#160;a&#160;output&#160;file&#160;that&#160;will&#160;</p>
<p style="position:absolute;top:308px;left:85px;white-space:nowrap" class="ft13419">contain&#160;the&#160;full&#160;pathname&#160;of&#160;all&#160;files&#160;saved&#160;in&#160;the&#160;eCryptfs&#160;filesystem&#160;and&#160;the&#160;relative&#160;<br/>SHA1&#160;digests.&#160;This&#160;command&#160;automatically&#160;copies&#160;files&#160;from&#160;directories&#160;in&#160;the&#160;<br/>unprotected&#160;filesystem&#160;to&#160;the&#160;protected&#160;one.&#160;The&#160;file&#160;specified&#160;as&#160;second&#160;parameter&#160;of&#160;<br/>the&#160;script&#160;can&#160;be&#160;included&#160;in&#160;the&#160;measurement&#160;list&#160;and&#160;it&#160;can&#160;be&#160;used&#160;by&#160;users&#160;to&#160;<br/>verify&#160;their&#160;original&#160;files&#160;are&#160;not&#160;modified.</p>
<p style="position:absolute;top:431px;left:85px;white-space:nowrap" class="ft13452"><b>&#160;4.7.6&#160;&#160;Learning&#160;activity&#160;of&#160;certified&#160;applications</b></p>
<p style="position:absolute;top:457px;left:85px;white-space:nowrap" class="ft13425">At&#160;this&#160;point&#160;rebooting&#160;again&#160;in&#160;learning&#160;mode&#160;is&#160;highly&#160;recommended&#160;to&#160;discover&#160;<br/>libraries&#160;and&#160;access&#160;to&#160;devices&#160;in&#160;case&#160;of&#160;system&#160;services.&#160;In&#160;other&#160;cases&#160;is&#160;sufficient&#160;<br/>to&#160;run&#160;the&#160;desired&#160;application&#160;and&#160;to&#160;use&#160;it&#160;for&#160;a&#160;while&#160;to&#160;ensure&#160;all&#160;libraries&#160;required&#160;<br/>have&#160;been&#160;loaded.<br/>The&#160;kernel&#160;writes&#160;discovered&#160;libraries&#160;and&#160;device&#160;accesses&#160;respectively&#160;in&#160;files&#160;</p>
<p style="position:absolute;top:564px;left:85px;white-space:nowrap" class="ft13451">/etc/kma/logs/mmap_list</p>
<p style="position:absolute;top:562px;left:313px;white-space:nowrap" class="ft13417">&#160;and&#160;</p>
<p style="position:absolute;top:564px;left:354px;white-space:nowrap" class="ft13451">/etc/kma/logs/directaccess_list</p>
<p style="position:absolute;top:562px;left:661px;white-space:nowrap" class="ft13417">.</p>
<p style="position:absolute;top:610px;left:85px;white-space:nowrap" class="ft13452"><b>&#160;4.7.7&#160;&#160;Reviewing&#160;the&#160;libraries&#160;loading&#160;and&#160;direct&#160;access&#160;detected</b></p>
<p style="position:absolute;top:636px;left:85px;white-space:nowrap" class="ft13417">The&#160;Administrator&#160;run&#160;these&#160;utilities:</p>
<p style="position:absolute;top:664px;left:112px;white-space:nowrap" class="ft13417">1.</p>
<p style="position:absolute;top:666px;left:139px;white-space:nowrap" class="ft13451">kma_mmap_db /etc/kma/logs/mmap_list</p>
<p style="position:absolute;top:664px;left:486px;white-space:nowrap" class="ft13417">&#160;to&#160;review&#160;all&#160;libraries&#160;mapped&#160;in&#160;</p>
<p style="position:absolute;top:684px;left:139px;white-space:nowrap" class="ft13417">memory&#160;by&#160;certified&#160;applications;</p>
<p style="position:absolute;top:713px;left:112px;white-space:nowrap" class="ft13417">2.</p>
<p style="position:absolute;top:714px;left:139px;white-space:nowrap" class="ft13451">kma_directaccess_db /etc/kma/logs/directaccess_list</p>
<p style="position:absolute;top:713px;left:644px;white-space:nowrap" class="ft13417">&#160;to&#160;review&#160;direct&#160;</p>
<p style="position:absolute;top:733px;left:139px;white-space:nowrap" class="ft13417">accesses&#160;to&#160;devices&#160;performed&#160;by&#160;certified&#160;applications.</p>
<p style="position:absolute;top:779px;left:92px;white-space:nowrap" class="ft13416"><b>&#160;4.8&#160;&#160;Reboot&#160;in&#160;enforcing&#160;mode</b></p>
<p style="position:absolute;top:807px;left:85px;white-space:nowrap" class="ft13419">As&#160;final&#160;part&#160;of&#160;the&#160;configuration&#160;phase&#160;a&#160;reboot&#160;cycle&#160;must&#160;be&#160;executed:&#160;the&#160;KMA&#160;<br/>enable&#160;kernel&#160;is&#160;executed&#160;in&#160;enforcing&#160;mode&#160;by&#160;selecting&#160;the&#160;proper&#160;entry&#160;in&#160;the&#160;<br/>TrustedGRUB&#160;menu.</p>
<p style="position:absolute;top:892px;left:92px;white-space:nowrap" class="ft13416"><b>&#160;4.9&#160;&#160;Sealing</b></p>
<p style="position:absolute;top:920px;left:85px;white-space:nowrap" class="ft13419">The&#160;MasterKey&#160;is&#160;sealed&#160;when&#160;the&#160;KMA&#160;enabled&#160;kernel&#160;is&#160;executed&#160;in&#160;enforcing&#160;mode&#160;<br/>and&#160;when&#160;the&#160;blob&#160;is&#160;not&#160;present&#160;in&#160;the&#160;default&#160;path&#160;or&#160;in&#160;a&#160;removable&#160;device.&#160;This&#160;<br/>procedure&#160;asks&#160;the&#160;Administrator&#160;password&#160;set&#160;by&#160;the&#160;</p>
<p style="position:absolute;top:960px;left:540px;white-space:nowrap" class="ft13451">init_masterkey.sh</p>
<p style="position:absolute;top:958px;left:708px;white-space:nowrap" class="ft13417">&#160;utility&#160;and&#160;</p>
<p style="position:absolute;top:979px;left:85px;white-space:nowrap" class="ft13419">permits&#160;to&#160;modify&#160;it&#160;if&#160;needed.&#160;If&#160;a&#160;TPM&#160;v1.2&#160;is&#160;detected,&#160;the&#160;kernel&#160;module&#160;which&#160;<br/>performs&#160;the&#160;operation&#160;&#160;compares&#160;the&#160;label&#160;read&#160;from&#160;the&#160;NV&#160;storage&#160;and&#160;the&#160;one&#160;<br/>extracted&#160;from&#160;the&#160;MasterKey&#160;and&#160;alerts&#160;the&#160;Administrator&#160;if&#160;they&#160;are&#160;different.&#160;Lastly&#160;<br/>the&#160;file&#160;</p>
<p style="position:absolute;top:1038px;left:148px;white-space:nowrap" class="ft13451">blobfile</p>
<p style="position:absolute;top:1036px;left:227px;white-space:nowrap" class="ft13417">&#160;will&#160;be&#160;created&#160;in&#160;the&#160;default&#160;path&#160;</p>
<p style="position:absolute;top:1038px;left:518px;white-space:nowrap" class="ft13451">/etc/kma/keys</p>
<p style="position:absolute;top:1036px;left:647px;white-space:nowrap" class="ft13417">&#160;or&#160;in&#160;an&#160;external&#160;</p>
<p style="position:absolute;top:1057px;left:85px;white-space:nowrap" class="ft13419">device.&#160;The&#160;system&#160;reboots&#160;and&#160;at&#160;this&#160;point&#160;the&#160;KMA&#160;is&#160;suitable&#160;for&#160;use&#160;by&#160;regular&#160;<br/>users&#160;of&#160;the&#160;platform.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft13421">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft13421">20/35</p>
</div>
<!-- Page 135 -->
<a name="135"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page135-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3135.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1359">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft13550">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft13521">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:92px;white-space:nowrap" class="ft13516"><b>&#160;4.10&#160;&#160;Unsealing</b></p>
<p style="position:absolute;top:177px;left:85px;white-space:nowrap" class="ft13519">During&#160;the&#160;normal&#160;system&#160;start&#160;up&#160;in&#160;enforcing&#160;mode&#160;a&#160;kernel&#160;module&#160;tries&#160;to&#160;unseal&#160;<br/>the&#160;MasterKey&#160;after&#160;TPM&#160;registers&#160;are&#160;extended&#160;with&#160;all&#160;measurements.&#160;If&#160;a&#160;TPM&#160;v1.2&#160;<br/>is&#160;detected&#160;this&#160;module&#160;compares&#160;the&#160;label&#160;extracted&#160;from&#160;the&#160;MasterKey&#160;with&#160;this&#160;<br/>read&#160;from&#160;the&#160;NV&#160;storage.&#160;If&#160;the&#160;unsealing&#160;or&#160;the&#160;label&#160;check&#160;fail,&#160;KMA&#160;will&#160;not&#160;be&#160;<br/>activated&#160;and&#160;the&#160;system&#160;reboots:&#160;the&#160;system&#160;must&#160;be&#160;booted&#160;in&#160;learning&#160;mode&#160;to&#160;fix&#160;<br/>the&#160;label&#160;(but&#160;the&#160;Administrator&#160;password&#160;is&#160;required)&#160;or&#160;with&#160;KMA&#160;completely&#160;<br/>disabled.</p>
<p style="position:absolute;top:339px;left:92px;white-space:nowrap" class="ft13516"><b>&#160;4.11&#160;&#160;Using&#160;KMA</b></p>
<p style="position:absolute;top:367px;left:85px;white-space:nowrap" class="ft13519">After&#160;the&#160;system&#160;completed&#160;the&#160;boot&#160;cycle,&#160;regular&#160;users&#160;can&#160;log&#160;into&#160;the&#160;platform&#160;and&#160;<br/>start&#160;to&#160;save&#160;theirs&#160;files&#160;in&#160;the&#160;protected&#160;filesystem.&#160;Thanks&#160;to&#160;symlinks&#160;users&#160;continue&#160;<br/>to&#160;use&#160;previous&#160;directories,&#160;with&#160;the&#160;difference&#160;that&#160;the&#160;files&#160;effectively&#160;reside&#160;in&#160;the&#160;<br/>cryptographic&#160;filesystem&#160;and&#160;the&#160;access&#160;is&#160;restricted&#160;depending&#160;on&#160;the&#160;policies&#160;written&#160;<br/>by&#160;the&#160;Administrator.&#160;An&#160;user&#160;can&#160;know&#160;how&#160;to&#160;access&#160;a&#160;directory&#160;or&#160;a&#160;file&#160;in&#160;the&#160;<br/>cryptographic&#160;filesystem&#160;by&#160;using&#160;the&#160;utility&#160;“</p>
<p style="position:absolute;top:464px;left:464px;white-space:nowrap" class="ft13551">kma_policy.sh</p>
<p style="position:absolute;top:463px;left:592px;white-space:nowrap" class="ft13517">”.&#160;The&#160;syntax&#160;is:</p>
<p style="position:absolute;top:492px;left:85px;white-space:nowrap" class="ft13551">kma_policy.sh &lt;pathname of the symlink&gt;</p>
<p style="position:absolute;top:539px;left:85px;white-space:nowrap" class="ft13517">An&#160;example&#160;of&#160;execution&#160;of&#160;this&#160;command&#160;is:</p>
<p style="position:absolute;top:567px;left:85px;white-space:nowrap" class="ft13555">Directory: /root/.ssh<br/>&#160; &#160; &#160; &#160; USER: root, Application: all</p>
<p style="position:absolute;top:642px;left:85px;white-space:nowrap" class="ft13551">Policy file: /etc/kma/ssh_users_config</p>
<p style="position:absolute;top:679px;left:85px;white-space:nowrap" class="ft13555">File: id_rsa<br/>&#160; &#160; &#160; &#160; User: root, Application: /usr/bin/ssh-keygen, Permissions: Create</p>
<p style="position:absolute;top:716px;left:85px;white-space:nowrap" class="ft13551">&#160; &#160; &#160; &#160; User: root, Application: /usr/bin/ssh, Permissions: Read</p>
<p style="position:absolute;top:754px;left:85px;white-space:nowrap" class="ft13555">File: id_rsa.pub<br/>&#160; &#160; &#160; &#160; User: root, Application: /usr/bin/ssh-keygen, Permissions: Create</p>
<p style="position:absolute;top:791px;left:85px;white-space:nowrap" class="ft13551">&#160; &#160; &#160; &#160; User: root, Application: all, Permissions: Read</p>
<p style="position:absolute;top:829px;left:85px;white-space:nowrap" class="ft13555">File: known_hosts<br/>&#160; &#160; &#160; &#160; User: root, Application: /usr/bin/ssh, Permissions: Create</p>
<p style="position:absolute;top:866px;left:85px;white-space:nowrap" class="ft13555">&#160; &#160; &#160; &#160; User: root, Application: /usr/bin/ssh, Permissions: Read, Write,&#160;<br/>Append</p>
<p style="position:absolute;top:922px;left:85px;white-space:nowrap" class="ft13551">File: authorized_keys</p>
<p style="position:absolute;top:941px;left:85px;white-space:nowrap" class="ft13555">&#160; &#160; &#160; &#160; User: root, Application: /usr/bin/nano, Permissions: Create<br/>&#160; &#160; &#160; &#160; User: root, Application: /usr/sbin/sshd, Permissions: Read</p>
<p style="position:absolute;top:978px;left:85px;white-space:nowrap" class="ft13551">&#160; &#160; &#160; &#160; User: root, Application: /usr/bin/nano, Permissions: Read, Write</p>
<p style="position:absolute;top:1025px;left:85px;white-space:nowrap" class="ft13517">When&#160;a&#160;user&#160;tries&#160;to&#160;access&#160;a&#160;file&#160;he&#160;can&#160;encounter&#160;these&#160;types&#160;of&#160;errors:</p>
<p style="position:absolute;top:1053px;left:112px;white-space:nowrap" class="ft13517">1.</p>
<p style="position:absolute;top:1055px;left:139px;white-space:nowrap" class="ft13551">“&lt;command&gt;: cannot open directory/file &lt;name&gt;: Permission denied“.&#160;</p>
<p style="position:absolute;top:1073px;left:139px;white-space:nowrap" class="ft13525">Possible&#160;causes:<br/>1.&#160;The&#160;user&#160;has&#160;not&#160;sufficient&#160;privileges&#160;(POSIX)&#160;to&#160;open&#160;the&#160;file/directory;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft13521">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft13521">21/35</p>
</div>
<!-- Page 136 -->
<a name="136"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft13658{font-size:17px;line-height:20px;font-family:FAAAAA+CourierNewPSMT;color:#000000;}
-->
</style>
<div id="page136-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3136.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1369">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft13650">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft13621">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:139px;white-space:nowrap" class="ft13617">2.&#160;The&#160;KMA&#160;policy&#160;for&#160;the&#160;file/directory&#160;forbids&#160;this&#160;user/process&#160;to&#160;access&#160;the&#160;</p>
<p style="position:absolute;top:168px;left:166px;white-space:nowrap" class="ft13617">file</p>
<p style="position:absolute;top:196px;left:112px;white-space:nowrap" class="ft13617">2.</p>
<p style="position:absolute;top:198px;left:139px;white-space:nowrap" class="ft13651">“&lt;command&gt;: cannot open directory/file &lt;name&gt;: Input/Output Error”</p>
<p style="position:absolute;top:196px;left:793px;white-space:nowrap" class="ft13617">.&#160;</p>
<p style="position:absolute;top:217px;left:139px;white-space:nowrap" class="ft13625">Possible&#160;causes:<br/>1.&#160;The&#160;file&#160;has&#160;been&#160;moved&#160;from&#160;the&#160;original&#160;position&#160;at&#160;the&#160;time&#160;of&#160;creation;<br/>2.&#160;The&#160;file&#160;has&#160;been&#160;encrypted&#160;with&#160;another&#160;key</p>
<p style="position:absolute;top:301px;left:112px;white-space:nowrap" class="ft13617">3.&#160;Abnormal&#160;program&#160;termination&#160;and&#160;</p>
<p style="position:absolute;top:303px;left:438px;white-space:nowrap" class="ft13651">“Killed”</p>
<p style="position:absolute;top:301px;left:518px;white-space:nowrap" class="ft13617">&#160;message.&#160;&#160;Possible&#160;causes:</p>
<p style="position:absolute;top:330px;left:139px;white-space:nowrap" class="ft13617">1.&#160;The&#160;application&#160;ran&#160;tried&#160;to&#160;map&#160;a&#160;library&#160;not&#160;authorized</p>
<p style="position:absolute;top:359px;left:112px;white-space:nowrap" class="ft13617">4.</p>
<p style="position:absolute;top:360px;left:139px;white-space:nowrap" class="ft13651">“FATAL: Error inserting &lt;module name&gt; ... Invalid module format”</p>
<p style="position:absolute;top:359px;left:773px;white-space:nowrap" class="ft13617">.&#160;</p>
<p style="position:absolute;top:379px;left:139px;white-space:nowrap" class="ft13625">Possible&#160;causes:<br/>1.&#160;The&#160;module&#160;has&#160;been&#160;compiled&#160;with&#160;another&#160;kernel<br/>2.&#160;The&#160;module&#160;is&#160;not&#160;in&#160;the&#160;database&#160;of&#160;allowed&#160;modules&#160;list</p>
<p style="position:absolute;top:463px;left:85px;white-space:nowrap" class="ft13617">If&#160;the&#160;system&#160;returns&#160;“</p>
<p style="position:absolute;top:465px;left:272px;white-space:nowrap" class="ft13651">Permission denied</p>
<p style="position:absolute;top:463px;left:440px;white-space:nowrap" class="ft13617">”&#160;or&#160;if&#160;a&#160;system&#160;service&#160;failed&#160;to&#160;start,&#160;the&#160;</p>
<p style="position:absolute;top:484px;left:85px;white-space:nowrap" class="ft13617">user&#160;can&#160;check&#160;the&#160;reason&#160;by&#160;executing&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:485px;left:541px;white-space:nowrap" class="ft13651">dmesg</p>
<p style="position:absolute;top:484px;left:591px;white-space:nowrap" class="ft13617">&#160;and&#160;seeing&#160;error&#160;</p>
<p style="position:absolute;top:504px;left:85px;white-space:nowrap" class="ft13617">messages.&#160;A&#160;typical&#160;error&#160;message&#160;is:</p>
<p style="position:absolute;top:532px;left:85px;white-space:nowrap" class="ft13651">Denying access: kdesvn[4856] -&gt; &#160;&lt;filename&gt; - reason: permission 1 not&#160;</p>
<p style="position:absolute;top:551px;left:85px;white-space:nowrap" class="ft13651">allowed to subject |XXXX|01000|</p>
<p style="position:absolute;top:579px;left:85px;white-space:nowrap" class="ft13619">The&#160;permission&#160;requested&#160;is&#160;reported&#160;with&#160;decimal&#160;notation.&#160;&#160;The&#160;access&#160;vector&#160;<br/>contains&#160;the&#160;actual&#160;values&#160;of&#160;the&#160;properties&#160;</p>
<p style="position:absolute;top:599px;left:451px;white-space:nowrap" class="ft13651">|TAG|effective UID|</p>
<p style="position:absolute;top:598px;left:639px;white-space:nowrap" class="ft13617">.&#160;&#160;If&#160;the&#160;value&#160;in&#160;the&#160;</p>
<p style="position:absolute;top:618px;left:85px;white-space:nowrap" class="ft13617">TAG&#160;field&#160;is&#160;“</p>
<p style="position:absolute;top:620px;left:192px;white-space:nowrap" class="ft13651">XXXX</p>
<p style="position:absolute;top:618px;left:232px;white-space:nowrap" class="ft13617">”&#160;this&#160;means&#160;that&#160;the&#160;application&#160;is&#160;not&#160;certified&#160;or&#160;that&#160;the&#160;</p>
<p style="position:absolute;top:638px;left:85px;white-space:nowrap" class="ft13625">verification&#160;of&#160;the&#160;certification&#160;failed&#160;because&#160;for&#160;example&#160;the&#160;binary&#160;of&#160;the&#160;application&#160;<br/>has&#160;been&#160;updated.&#160;In&#160;the&#160;second&#160;situation&#160;the&#160;maintenance&#160;procedure&#160;in&#160;the&#160;section&#160;<br/>4.12.1&#160;must&#160;be&#160;executed&#160;by&#160;the&#160;Administrator.<br/>The&#160;“</p>
<p style="position:absolute;top:706px;left:130px;white-space:nowrap" class="ft13651">Permission denied</p>
<p style="position:absolute;top:705px;left:298px;white-space:nowrap" class="ft13617">”&#160;error&#160;is&#160;also&#160;displayed&#160;when&#160;an&#160;user&#160;tries&#160;to&#160;create&#160;a&#160;new&#160;</p>
<p style="position:absolute;top:725px;left:85px;white-space:nowrap" class="ft13619">file&#160;with&#160;an&#160;application&#160;not&#160;listed&#160;in&#160;the&#160;policy&#160;file.&#160;The&#160;detailed&#160;message&#160;in&#160;the&#160;system&#160;<br/>log&#160;is:</p>
<p style="position:absolute;top:773px;left:85px;white-space:nowrap" class="ft13651">Found policy create for id_rsa</p>
<p style="position:absolute;top:791px;left:85px;white-space:nowrap" class="ft13655">Denying create: bash[3990] with mask |XXXX|00000| is not allowed to&#160;<br/>create the file &lt;filename&gt;</p>
<p style="position:absolute;top:847px;left:85px;white-space:nowrap" class="ft13617">The&#160;“</p>
<p style="position:absolute;top:849px;left:130px;white-space:nowrap" class="ft13651">Input/Output Error</p>
<p style="position:absolute;top:847px;left:308px;white-space:nowrap" class="ft13617">”&#160;issue&#160;depends&#160;on&#160;the&#160;fact&#160;that&#160;eCryptfs&#160;files&#160;cannot&#160;be&#160;</p>
<p style="position:absolute;top:867px;left:85px;white-space:nowrap" class="ft13619">moved&#160;from&#160;their&#160;original&#160;location&#160;after&#160;they&#160;are&#160;created.&#160;This&#160;feature&#160;is&#160;necessary&#160;for&#160;<br/>the&#160;correct&#160;behaviour&#160;of&#160;the&#160;Mandatory&#160;Access&#160;Control&#160;that&#160;apply&#160;policies&#160;on&#160;files&#160;and&#160;<br/>directories&#160;depending&#160;on&#160;their&#160;pathname.&#160;In&#160;order&#160;to&#160;enforce&#160;the&#160;position,&#160;a&#160;KMA&#160;patch&#160;<br/>has&#160;been&#160;inserted&#160;in&#160;the&#160;eCryptfs&#160;code&#160;that&#160;appends&#160;in&#160;the&#160;header&#160;of&#160;each&#160;file&#160;a&#160;keyed&#160;<br/>digest&#160;of&#160;the&#160;file&#160;name&#160;and&#160;the&#160;parent&#160;directories&#160;until&#160;the&#160;root&#160;using&#160;the&#160;File&#160;<br/>Encryption&#160;Key&#160;(FEK)&#160;as&#160;key.&#160;The&#160;move&#160;operation&#160;is&#160;always&#160;denied&#160;when&#160;the&#160;MAC&#160;is&#160;<br/>active;&#160;this&#160;can&#160;be&#160;done&#160;when&#160;another&#160;kernel&#160;is&#160;loaded&#160;or&#160;when&#160;the&#160;KMA&#160;is&#160;not&#160;in&#160;<br/>enforcing&#160;mode.&#160;The&#160;next&#160;time&#160;a&#160;moved&#160;file&#160;is&#160;accessed,&#160;eCryptfs&#160;returns&#160;I/O&#160;error.&#160;A&#160;<br/>detailed&#160;error&#160;message&#160;is&#160;written&#160;in&#160;the&#160;system&#160;log&#160;and&#160;it's&#160;like&#160;this:</p>
<p style="position:absolute;top:1049px;left:85px;white-space:nowrap" class="ft13658">ecryptfs_parse_packet_set: Error: file /system/ssh/sshd_config in the&#160;<br/>protected filesystem has been moved from the original position</p>
<p style="position:absolute;top:1068px;left:699px;white-space:nowrap" class="ft13617">.</p>
<p style="position:absolute;top:1097px;left:85px;white-space:nowrap" class="ft13619">Another&#160;error&#160;may&#160;be&#160;encountered&#160;when&#160;the&#160;user&#160;tries&#160;to&#160;run&#160;a&#160;certified&#160;application&#160;<br/>which&#160;is&#160;not&#160;correctly&#160;configured.&#160;The&#160;application&#160;is&#160;terminated&#160;and&#160;the&#160;system&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft13621">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft13621">22/35</p>
</div>
<!-- Page 137 -->
<a name="137"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page137-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3137.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1379">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft13750">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft13721">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:85px;white-space:nowrap" class="ft13717">prompts&#160;the&#160;message&#160;“</p>
<p style="position:absolute;top:151px;left:280px;white-space:nowrap" class="ft13751">Killed</p>
<p style="position:absolute;top:149px;left:339px;white-space:nowrap" class="ft13717">”.&#160;The&#160;maintenance&#160;procedure&#160;described&#160;in&#160;the&#160;section&#160;</p>
<p style="position:absolute;top:169px;left:85px;white-space:nowrap" class="ft13725">4.12.1&#160;must&#160;be&#160;followed&#160;to&#160;solve&#160;the&#160;issue.<br/>The&#160;error&#160;</p>
<p style="position:absolute;top:199px;left:167px;white-space:nowrap" class="ft13751">“FATAL: Error inserting &lt;module name&gt; ... Invalid module format”&#160;</p>
<p style="position:absolute;top:218px;left:85px;white-space:nowrap" class="ft13717">may&#160;happen&#160;when&#160;the&#160;root&#160;user&#160;tries&#160;to&#160;load&#160;a&#160;module&#160;using&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:219px;left:712px;white-space:nowrap" class="ft13751">insmod</p>
<p style="position:absolute;top:218px;left:772px;white-space:nowrap" class="ft13717">&#160;or&#160;</p>
<p style="position:absolute;top:239px;left:85px;white-space:nowrap" class="ft13751">modprobe</p>
<p style="position:absolute;top:238px;left:164px;white-space:nowrap" class="ft13717">.&#160;If&#160;the&#160;module&#160;is&#160;not&#160;present&#160;in&#160;the&#160;database&#160;of&#160;allowed&#160;modules&#160;or&#160;it&#160;has&#160;</p>
<p style="position:absolute;top:258px;left:85px;white-space:nowrap" class="ft13719">been&#160;modified&#160;(there's&#160;a&#160;module&#160;with&#160;the&#160;same&#160;name&#160;but&#160;with&#160;different&#160;digest)&#160;the&#160;<br/>kernel&#160;denies&#160;the&#160;operation&#160;and&#160;prompts&#160;in&#160;the&#160;system&#160;log&#160;this&#160;message:</p>
<p style="position:absolute;top:306px;left:85px;white-space:nowrap" class="ft13751">Cannot load module &lt;module name&gt;: not found in the database or wrong&#160;</p>
<p style="position:absolute;top:324px;left:85px;white-space:nowrap" class="ft13751">digest</p>
<p style="position:absolute;top:370px;left:92px;white-space:nowrap" class="ft13716"><b>&#160;4.12&#160;&#160;Maintenance&#160;procedures</b></p>
<p style="position:absolute;top:416px;left:85px;white-space:nowrap" class="ft13752"><b>&#160;4.12.1&#160;&#160;Software&#160;update&#160;and&#160;new&#160;certified&#160;applications</b></p>
<p style="position:absolute;top:443px;left:85px;white-space:nowrap" class="ft13719">Adding&#160;new&#160;certified&#160;applications&#160;or&#160;updating&#160;the&#160;existent&#160;ones&#160;is&#160;a&#160;critical&#160;process&#160;<br/>because&#160;the&#160;configuration&#160;created&#160;during&#160;the&#160;learning&#160;process&#160;may&#160;change:&#160;in&#160;case&#160;of&#160;<br/>new&#160;certified&#160;applications&#160;the&#160;database&#160;of&#160;mapped&#160;libraries&#160;will&#160;include&#160;new&#160;libraries,&#160;<br/>the&#160;database&#160;of&#160;direct&#160;accesses&#160;to&#160;devices&#160;may&#160;include&#160;new&#160;rules;&#160;in&#160;case&#160;of&#160;updated&#160;<br/>packages,&#160;the&#160;libraries&#160;used&#160;by&#160;certified&#160;applications&#160;may&#160;change&#160;and&#160;their&#160;new&#160;<br/>digests&#160;must&#160;be&#160;written&#160;in&#160;the&#160;database.<br/>Another&#160;aspect&#160;is&#160;that&#160;the&#160;update&#160;operation&#160;is&#160;not&#160;possible&#160;when&#160;KMA&#160;is&#160;started&#160;in&#160;<br/>enforcing&#160;mode:&#160;if&#160;the&#160;application&#160;set&#160;to&#160;be&#160;updated&#160;has&#160;been&#160;already&#160;executed,&#160;its&#160;<br/>libraries&#160;are&#160;accessible&#160;only&#160;in&#160;read-only&#160;mode&#160;and&#160;cannot&#160;be&#160;replaced.<br/>Lastly&#160;when&#160;installing&#160;or&#160;updating&#160;a&#160;RPM&#160;package,&#160;multiple&#160;executables&#160;may&#160;be&#160;<br/>involved&#160;in&#160;this&#160;procedure&#160;(for&#160;example&#160;for&#160;the&#160;package&#160;</p>
<p style="position:absolute;top:654px;left:552px;white-space:nowrap" class="ft13751">openssh</p>
<p style="position:absolute;top:653px;left:621px;white-space:nowrap" class="ft13717">&#160;the&#160;certified&#160;</p>
<p style="position:absolute;top:673px;left:85px;white-space:nowrap" class="ft13717">applications&#160;are&#160;</p>
<p style="position:absolute;top:674px;left:222px;white-space:nowrap" class="ft13751">/usr/bin/ssh</p>
<p style="position:absolute;top:673px;left:341px;white-space:nowrap" class="ft13717">,&#160;</p>
<p style="position:absolute;top:674px;left:352px;white-space:nowrap" class="ft13751">/usr/sbin/sshd</p>
<p style="position:absolute;top:673px;left:490px;white-space:nowrap" class="ft13717">,&#160;</p>
<p style="position:absolute;top:674px;left:501px;white-space:nowrap" class="ft13751">/usr/bin/ssh-keygen</p>
<p style="position:absolute;top:673px;left:689px;white-space:nowrap" class="ft13717">);</p>
<p style="position:absolute;top:702px;left:85px;white-space:nowrap" class="ft13719">The&#160;Administrator&#160;must&#160;follow&#160;these&#160;steps&#160;to&#160;perform&#160;the&#160;system&#160;update&#160;or&#160;to&#160;add&#160;a&#160;<br/>new&#160;certified&#160;application:</p>
<p style="position:absolute;top:750px;left:112px;white-space:nowrap" class="ft13725">1.&#160;Start&#160;the&#160;system&#160;in&#160;learning&#160;mode;<br/>2.&#160;Perform&#160;the&#160;system&#160;update&#160;or&#160;install&#160;the&#160;new&#160;application;</p>
<p style="position:absolute;top:806px;left:139px;white-space:nowrap" class="ft13717">1.&#160;For&#160;a&#160;new&#160;installed&#160;application&#160;add&#160;the&#160;executable&#160;to&#160;the&#160;file&#160;</p>
<p style="position:absolute;top:827px;left:166px;white-space:nowrap" class="ft13751">/etc/kma/signed_binaries</p>
<p style="position:absolute;top:825px;left:404px;white-space:nowrap" class="ft13717">&#160;(see&#160;section&#160;4.3)</p>
<p style="position:absolute;top:854px;left:139px;white-space:nowrap" class="ft13717">2.&#160;For&#160;a&#160;new&#160;installed&#160;application&#160;build&#160;the&#160;filesystem&#160;configuration&#160;and&#160;add&#160;</p>
<p style="position:absolute;top:874px;left:166px;white-space:nowrap" class="ft13717">new&#160;files&#160;to&#160;the&#160;measurements&#160;file&#160;list&#160;</p>
<p style="position:absolute;top:875px;left:488px;white-space:nowrap" class="ft13751">/etc/kma/checkfilelist</p>
<p style="position:absolute;top:874px;left:706px;white-space:nowrap" class="ft13717">&#160;(it&#160;may&#160;be&#160;</p>
<p style="position:absolute;top:894px;left:166px;white-space:nowrap" class="ft13719">not&#160;necessary&#160;in&#160;case&#160;of&#160;the&#160;application&#160;only&#160;need&#160;to&#160;access&#160;directly&#160;to&#160;a&#160;<br/>device)&#160;(see&#160;sections&#160;4.4&#160;and&#160;4.5);</p>
<p style="position:absolute;top:941px;left:112px;white-space:nowrap" class="ft13717">3.&#160;Execute&#160;the&#160;utility&#160;</p>
<p style="position:absolute;top:943px;left:296px;white-space:nowrap" class="ft13751">init_masterkey.sh</p>
<p style="position:absolute;top:941px;left:464px;white-space:nowrap" class="ft13717">&#160;(stop&#160;Trousers:&#160;</p>
<p style="position:absolute;top:943px;left:599px;white-space:nowrap" class="ft13751">service tcsd stop</p>
<p style="position:absolute;top:941px;left:767px;white-space:nowrap" class="ft13717">);</p>
<p style="position:absolute;top:970px;left:139px;white-space:nowrap" class="ft13725">1.&#160;Delete&#160;the&#160;old&#160;MasterKey&#160;(confirm&#160;when&#160;requested);<br/>2.&#160;Enter&#160;the&#160;Administrator&#160;password&#160;(and&#160;the&#160;SRK&#160;password,&#160;if&#160;requested);<br/>3.&#160;Set&#160;a&#160;new&#160;label&#160;(TPM&#160;v1.2&#160;only);</p>
<p style="position:absolute;top:1055px;left:112px;white-space:nowrap" class="ft13717">4.&#160;Execute&#160;the&#160;utility&#160;</p>
<p style="position:absolute;top:1057px;left:296px;white-space:nowrap" class="ft13751">kma_write_nv&#160;</p>
<p style="position:absolute;top:1055px;left:424px;white-space:nowrap" class="ft13717">(TPM&#160;v1.2&#160;only&#160;-&#160;start&#160;Trousers:&#160;</p>
<p style="position:absolute;top:1057px;left:689px;white-space:nowrap" class="ft13751">service tcsd&#160;</p>
<p style="position:absolute;top:1077px;left:139px;white-space:nowrap" class="ft13751">start</p>
<p style="position:absolute;top:1075px;left:189px;white-space:nowrap" class="ft13717">);</p>
<p style="position:absolute;top:1105px;left:139px;white-space:nowrap" class="ft13717">1.&#160;Enter&#160;the&#160;secret&#160;associated&#160;to&#160;the&#160;NV&#160;storage&#160;portion;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft13721">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft13721">23/35</p>
</div>
<!-- Page 138 -->
<a name="138"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page138-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3138.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1389">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft13850">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft13821">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:139px;white-space:nowrap" class="ft13817">2.&#160;Write&#160;the&#160;same&#160;label&#160;specified&#160;when&#160;updating&#160;the&#160;MasterKey;</p>
<p style="position:absolute;top:177px;left:112px;white-space:nowrap" class="ft13817">5.&#160;Execute&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:179px;left:331px;white-space:nowrap" class="ft13851">certbin --list /etc/kma/signed_binaries</p>
<p style="position:absolute;top:177px;left:717px;white-space:nowrap" class="ft13817">;</p>
<p style="position:absolute;top:206px;left:112px;white-space:nowrap" class="ft13817">6.&#160;Execute&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:208px;left:331px;white-space:nowrap" class="ft13851">kma_directaccess_db&#160;</p>
<p style="position:absolute;top:228px;left:139px;white-space:nowrap" class="ft13851">/etc/kma/logs/directaccess_list</p>
<p style="position:absolute;top:227px;left:446px;white-space:nowrap" class="ft13817">&#160;and&#160;delete&#160;records&#160;containing&#160;the&#160;tag&#160;of&#160;</p>
<p style="position:absolute;top:247px;left:139px;white-space:nowrap" class="ft13817">updated&#160;applications;</p>
<p style="position:absolute;top:275px;left:112px;white-space:nowrap" class="ft13817">7.&#160;Restart&#160;the&#160;system&#160;in&#160;learning&#160;mode&#160;(only&#160;needed&#160;for&#160;new&#160;applications&#160;installed&#160;</p>
<p style="position:absolute;top:294px;left:139px;white-space:nowrap" class="ft13825">for&#160;which&#160;a&#160;filesystem&#160;configuration&#160;has&#160;been&#160;created)<br/>1.&#160;Execute&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:324px;left:358px;white-space:nowrap" class="ft13851">kma_makesecure.sh /etc/kma/files_saved&#160;</p>
<p style="position:absolute;top:344px;left:166px;white-space:nowrap" class="ft13851">&lt;created filelist&gt;</p>
<p style="position:absolute;top:343px;left:344px;white-space:nowrap" class="ft13817">&#160;to&#160;import&#160;application's&#160;files&#160;to&#160;the&#160;protected&#160;</p>
<p style="position:absolute;top:363px;left:166px;white-space:nowrap" class="ft13819">filesystem;&#160;if&#160;the&#160;file&#160;specified&#160;as&#160;first&#160;parameter&#160;does&#160;not&#160;exist&#160;this&#160;step&#160;can&#160;<br/>be&#160;skipped;</p>
<p style="position:absolute;top:410px;left:112px;white-space:nowrap" class="ft13825">8.&#160;Execute&#160;the&#160;application;<br/>9.&#160;Execute&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:440px;left:331px;white-space:nowrap" class="ft13851">kma_mmap_db /etc/kma/logs/mmap_list</p>
<p style="position:absolute;top:439px;left:677px;white-space:nowrap" class="ft13817">:</p>
<p style="position:absolute;top:468px;left:139px;white-space:nowrap" class="ft13825">1.&#160;The&#160;utility&#160;notifies&#160;if&#160;there&#160;are&#160;duplicate&#160;entries&#160;with&#160;different&#160;digest;<br/>2.&#160;Specify&#160;the&#160;correct&#160;entry:&#160;the&#160;Administrator&#160;must&#160;investigate&#160;the&#160;current&#160;</p>
<p style="position:absolute;top:515px;left:166px;white-space:nowrap" class="ft13817">digest&#160;value,&#160;by&#160;executing&#160;in&#160;another&#160;shell&#160;the&#160;command:&#160;</p>
<p style="position:absolute;top:517px;left:650px;white-space:nowrap" class="ft13851">sha1sum &lt;path of&#160;</p>
<p style="position:absolute;top:537px;left:166px;white-space:nowrap" class="ft13851">the loadable item in the filesystem&gt;</p>
<p style="position:absolute;top:535px;left:523px;white-space:nowrap" class="ft13817">;</p>
<p style="position:absolute;top:565px;left:139px;white-space:nowrap" class="ft13817">3.&#160;Type&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:566px;left:332px;white-space:nowrap" class="ft13851">verify</p>
<p style="position:absolute;top:565px;left:391px;white-space:nowrap" class="ft13817">:</p>
<p style="position:absolute;top:594px;left:166px;white-space:nowrap" class="ft13817">1.&#160;For&#160;each&#160;loadable&#160;item&#160;in&#160;the&#160;list&#160;the&#160;program&#160;verifies&#160;if&#160;the&#160;digest&#160;of&#160;a&#160;</p>
<p style="position:absolute;top:613px;left:193px;white-space:nowrap" class="ft13817">loadable&#160;item&#160;is&#160;changed;</p>
<p style="position:absolute;top:641px;left:166px;white-space:nowrap" class="ft13817">2.&#160;If&#160;a&#160;loadable&#160;item&#160;is&#160;changed&#160;the&#160;program&#160;requests&#160;to&#160;update&#160;the&#160;value&#160;</p>
<p style="position:absolute;top:661px;left:193px;white-space:nowrap" class="ft13817">stored&#160;in&#160;the&#160;database;</p>
<p style="position:absolute;top:689px;left:139px;white-space:nowrap" class="ft13817">4.&#160;Write&#160;changes&#160;by&#160;executing&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:690px;left:523px;white-space:nowrap" class="ft13851">write</p>
<p style="position:absolute;top:689px;left:572px;white-space:nowrap" class="ft13817">&#160;followed&#160;by&#160;the&#160;new&#160;</p>
<p style="position:absolute;top:709px;left:166px;white-space:nowrap" class="ft13817">filename;</p>
<p style="position:absolute;top:737px;left:139px;white-space:nowrap" class="ft13817">5.&#160;Replace&#160;the&#160;</p>
<p style="position:absolute;top:739px;left:270px;white-space:nowrap" class="ft13851">/etc/kma/logs/mmap_list</p>
<p style="position:absolute;top:737px;left:498px;white-space:nowrap" class="ft13817">&#160;file&#160;with&#160;the&#160;new&#160;file&#160;created;</p>
<p style="position:absolute;top:766px;left:112px;white-space:nowrap" class="ft13817">10.&#160;Execute&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:768px;left:336px;white-space:nowrap" class="ft13851">kma_directaccess_list&#160;</p>
<p style="position:absolute;top:788px;left:139px;white-space:nowrap" class="ft13851">/etc/kma/logs/directaccess_list</p>
<p style="position:absolute;top:787px;left:446px;white-space:nowrap" class="ft13817">&#160;to&#160;review&#160;direct&#160;accesses&#160;to&#160;devices&#160;</p>
<p style="position:absolute;top:807px;left:139px;white-space:nowrap" class="ft13817">performed&#160;by&#160;certified&#160;applications;</p>
<p style="position:absolute;top:835px;left:112px;white-space:nowrap" class="ft13817">11.&#160;Check&#160;for&#160;invalid&#160;eCryptfs&#160;files&#160;by&#160;executing&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:837px;left:634px;white-space:nowrap" class="ft13851">dmesg | grep&#160;</p>
<p style="position:absolute;top:857px;left:139px;white-space:nowrap" class="ft13851">ecryptfs</p>
<p style="position:absolute;top:855px;left:218px;white-space:nowrap" class="ft13817">&#160;(the&#160;</p>
<p style="position:absolute;top:857px;left:263px;white-space:nowrap" class="ft13851">rpm</p>
<p style="position:absolute;top:855px;left:292px;white-space:nowrap" class="ft13817">&#160;utility,&#160;when&#160;updating&#160;a&#160;package,&#160;creates&#160;a&#160;new&#160;copy&#160;of&#160;</p>
<p style="position:absolute;top:876px;left:139px;white-space:nowrap" class="ft13819">existent&#160;files&#160;by&#160;adding&#160;a&#160;random&#160;string&#160;as&#160;suffix&#160;of&#160;the&#160;name&#160;for&#160;avoiding&#160;<br/>collisions,&#160;then&#160;renames&#160;the&#160;others&#160;with&#160;the&#160;extension&#160;</p>
<p style="position:absolute;top:896px;left:594px;white-space:nowrap" class="ft13851">.rpmnew</p>
<p style="position:absolute;top:895px;left:663px;white-space:nowrap" class="ft13817">&#160;and&#160;lastly&#160;</p>
<p style="position:absolute;top:915px;left:139px;white-space:nowrap" class="ft13825">deletes&#160;the&#160;suffix&#160;from&#160;the&#160;firsts);<br/>1.&#160;Copy&#160;temporarily&#160;invalid&#160;files&#160;to&#160;a&#160;backup&#160;directory&#160;in&#160;the&#160;unprotected&#160;</p>
<p style="position:absolute;top:963px;left:166px;white-space:nowrap" class="ft13817">filesystem,&#160;delete&#160;it&#160;and&#160;recreate&#160;them&#160;in&#160;the&#160;original&#160;location;</p>
<p style="position:absolute;top:991px;left:112px;white-space:nowrap" class="ft13817">12.&#160;Start&#160;the&#160;system&#160;in&#160;enforcing&#160;mode,&#160;and&#160;execute&#160;the&#160;sealing&#160;procedure.</p>
<p style="position:absolute;top:1019px;left:85px;white-space:nowrap" class="ft13819">NOTE:&#160;steps&#160;9.4&#160;and&#160;9.5&#160;are&#160;required&#160;only&#160;if&#160;one&#160;or&#160;more&#160;entries&#160;in&#160;the&#160;database&#160;of&#160;<br/>mapped&#160;libraries&#160;are&#160;updated&#160;(in&#160;case&#160;of&#160;duplicated&#160;entries&#160;or&#160;a&#160;loadable&#160;items&#160;<br/>modified).&#160;If&#160;the&#160;database&#160;is&#160;not&#160;correctly&#160;updated&#160;during&#160;the&#160;boot&#160;process&#160;this&#160;<br/>message&#160;may&#160;be&#160;displayed&#160;and&#160;the&#160;system&#160;is&#160;not&#160;able&#160;to&#160;boot:</p>
<p style="position:absolute;top:1105px;left:85px;white-space:nowrap" class="ft13851">Error: duplicated entry /lib/libvolume_id.so.1.0.1, digests:</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft13821">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft13821">24/35</p>
</div>
<!-- Page 139 -->
<a name="139"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page139-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3139.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1399">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft13950">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft13921">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:85px;white-space:nowrap" class="ft13951">526350333ecb1804ec946761f90e985574cdc1ed</p>
<p style="position:absolute;top:168px;left:85px;white-space:nowrap" class="ft13951">bc605ced62d035fddf4d095f4b38b0198f9d17e1</p>
<p style="position:absolute;top:186px;left:85px;white-space:nowrap" class="ft13919">In&#160;case&#160;of&#160;a&#160;library&#160;or&#160;an&#160;application&#160;is&#160;updated&#160;and&#160;the&#160;learning&#160;process&#160;has&#160;not&#160;been&#160;<br/>executed&#160;the&#160;certified&#160;application&#160;stop&#160;working&#160;and&#160;in&#160;the&#160;system&#160;log&#160;is&#160;present&#160;a&#160;<br/>similar&#160;message:</p>
<p style="position:absolute;top:253px;left:85px;white-space:nowrap" class="ft13951">Error: sshd[2120] tried to mmap the loadable /lib/libz.so.1.2.3: library&#160;</p>
<p style="position:absolute;top:272px;left:85px;white-space:nowrap" class="ft13951">has been modified</p>
<p style="position:absolute;top:299px;left:85px;white-space:nowrap" class="ft13919">Running&#160;steps&#160;listed&#160;at&#160;point&#160;9&#160;is&#160;useful&#160;to&#160;detect&#160;if&#160;a&#160;library&#160;used&#160;by&#160;a&#160;certified&#160;<br/>application&#160;is&#160;changed.</p>
<p style="position:absolute;top:365px;left:85px;white-space:nowrap" class="ft13952"><b>&#160;4.12.2&#160;&#160;Adding&#160;to&#160;the&#160;database&#160;/etc/kma/logs/mmap_list&#160;non&#160;discovered&#160;libraries</b></p>
<p style="position:absolute;top:391px;left:85px;white-space:nowrap" class="ft13919">It&#160;may&#160;happen&#160;that&#160;a&#160;library&#160;has&#160;not&#160;discovered&#160;in&#160;the&#160;learning&#160;phase,&#160;for&#160;example&#160;<br/>because&#160;some&#160;libraries&#160;are&#160;loaded&#160;only&#160;if&#160;a&#160;particular&#160;function&#160;of&#160;the&#160;application&#160;is&#160;<br/>activated.&#160;If&#160;a&#160;certified&#160;application&#160;tries&#160;to&#160;mmap&#160;a&#160;library&#160;that&#160;doesn't&#160;exist&#160;in&#160;the&#160;<br/>database&#160;it&#160;will&#160;be&#160;killed&#160;by&#160;the&#160;kernel.&#160;The&#160;user&#160;can&#160;verify&#160;the&#160;operation&#160;that&#160;caused&#160;<br/>the&#160;termination&#160;of&#160;the&#160;process&#160;by&#160;seeing&#160;the&#160;system&#160;log&#160;by&#160;prompting&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:489px;left:85px;white-space:nowrap" class="ft13951">dmesg</p>
<p style="position:absolute;top:487px;left:135px;white-space:nowrap" class="ft13917">.</p>
<p style="position:absolute;top:516px;left:85px;white-space:nowrap" class="ft13917">An&#160;example&#160;of&#160;an&#160;error&#160;message&#160;is:</p>
<p style="position:absolute;top:545px;left:85px;white-space:nowrap" class="ft13955">Error: sshd[2134] tried to mmap the loadable /lib/libz.so.1.2.3: item not&#160;<br/>found in the list</p>
<p style="position:absolute;top:591px;left:85px;white-space:nowrap" class="ft13917">or</p>
<p style="position:absolute;top:619px;left:85px;white-space:nowrap" class="ft13955">Error: sshd[2134] tried to mmap the loadable /lib/libz.so.1.2.3: tag&#160;<br/>kma0002 not in the list of allowed tags</p>
<p style="position:absolute;top:666px;left:85px;white-space:nowrap" class="ft13919">In&#160;the&#160;first&#160;case&#160;the&#160;library&#160;specified&#160;has&#160;not&#160;been&#160;discovered&#160;by&#160;any&#160;certified&#160;<br/>application.&#160;In&#160;the&#160;second&#160;one,&#160;the&#160;library&#160;has&#160;been&#160;discovered&#160;by&#160;other&#160;certified&#160;<br/>applications.<br/>The&#160;Administrator,&#160;after&#160;having&#160;verified&#160;the&#160;library,&#160;can&#160;include&#160;it&#160;in&#160;the&#160;database&#160;by&#160;<br/>executing&#160;these&#160;steps:</p>
<p style="position:absolute;top:780px;left:112px;white-space:nowrap" class="ft13917">1.&#160;Execute&#160;the&#160;utility&#160;</p>
<p style="position:absolute;top:781px;left:296px;white-space:nowrap" class="ft13951">init_masterkey.sh</p>
<p style="position:absolute;top:780px;left:464px;white-space:nowrap" class="ft13917">&#160;(stop&#160;Trousers:&#160;</p>
<p style="position:absolute;top:781px;left:599px;white-space:nowrap" class="ft13951">service tcsd stop</p>
<p style="position:absolute;top:780px;left:767px;white-space:nowrap" class="ft13917">);</p>
<p style="position:absolute;top:809px;left:139px;white-space:nowrap" class="ft13925">1.&#160;Delete&#160;the&#160;old&#160;MasterKey&#160;(confirm&#160;when&#160;requested);<br/>2.&#160;Enter&#160;the&#160;Administrator&#160;password&#160;(and&#160;the&#160;SRK&#160;password,&#160;if&#160;requested);<br/>3.&#160;Set&#160;a&#160;new&#160;label&#160;(TPM&#160;v1.2&#160;only);</p>
<p style="position:absolute;top:893px;left:112px;white-space:nowrap" class="ft13917">2.&#160;Execute&#160;the&#160;utility&#160;</p>
<p style="position:absolute;top:895px;left:296px;white-space:nowrap" class="ft13951">kma_write_nv&#160;</p>
<p style="position:absolute;top:893px;left:424px;white-space:nowrap" class="ft13917">(TPM&#160;v1.2&#160;only&#160;-&#160;start&#160;Trousers:&#160;</p>
<p style="position:absolute;top:895px;left:689px;white-space:nowrap" class="ft13951">service tcsd&#160;</p>
<p style="position:absolute;top:915px;left:139px;white-space:nowrap" class="ft13951">start</p>
<p style="position:absolute;top:914px;left:189px;white-space:nowrap" class="ft13917">);</p>
<p style="position:absolute;top:943px;left:139px;white-space:nowrap" class="ft13925">1.&#160;Enter&#160;the&#160;secret&#160;associated&#160;to&#160;the&#160;NV&#160;storage&#160;portion;<br/>2.&#160;Type&#160;the&#160;same&#160;label&#160;specified&#160;when&#160;updating&#160;the&#160;MasterKey;</p>
<p style="position:absolute;top:999px;left:112px;white-space:nowrap" class="ft13917">3.&#160;Execute&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:1001px;left:331px;white-space:nowrap" class="ft13951">kma_mmap_db /etc/kma/logs/mmap_list</p>
<p style="position:absolute;top:999px;left:677px;white-space:nowrap" class="ft13917">;</p>
<p style="position:absolute;top:1029px;left:139px;white-space:nowrap" class="ft13917">1.&#160;At&#160;the&#160;prompt&#160;type&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:1030px;left:449px;white-space:nowrap" class="ft13951">add</p>
<p style="position:absolute;top:1029px;left:479px;white-space:nowrap" class="ft13917">;</p>
<p style="position:absolute;top:1058px;left:139px;white-space:nowrap" class="ft13925">2.&#160;Specify&#160;the&#160;file&#160;to&#160;include;<br/>3.&#160;Specify&#160;the&#160;TAG&#160;of&#160;the&#160;application&#160;that&#160;is&#160;allowed&#160;to&#160;map&#160;it;<br/>4.&#160;Type&#160;the&#160;command&#160;write&#160;followed&#160;by&#160;the&#160;new&#160;file&#160;name&#160;containing&#160;the&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft13921">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft13921">25/35</p>
</div>
<!-- Page 140 -->
<a name="140"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft14059{font-size:15px;line-height:17px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page140-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3140.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1409">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft14050">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft14021">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:166px;white-space:nowrap" class="ft14017">updated&#160;database;</p>
<p style="position:absolute;top:177px;left:112px;white-space:nowrap" class="ft14017">4.&#160;Replace&#160;the&#160;file&#160;/</p>
<p style="position:absolute;top:179px;left:279px;white-space:nowrap" class="ft14051">etc/kma/logs/mmapped_list</p>
<p style="position:absolute;top:177px;left:526px;white-space:nowrap" class="ft14017">&#160;with&#160;the&#160;new&#160;file&#160;created;</p>
<p style="position:absolute;top:206px;left:112px;white-space:nowrap" class="ft14017">5.&#160;Restart&#160;the&#160;sealing&#160;procedure&#160;by&#160;rebooting&#160;the&#160;system&#160;in&#160;enforcing&#160;mode.</p>
<p style="position:absolute;top:235px;left:85px;white-space:nowrap" class="ft14019">If&#160;there&#160;are&#160;too&#160;many&#160;libraries&#160;to&#160;add&#160;another&#160;possibility&#160;is&#160;to&#160;execute&#160;the&#160;steps&#160;<br/>described&#160;in&#160;the&#160;section&#160;4.12.1&#160;without&#160;the&#160;point&#160;4.</p>
<p style="position:absolute;top:300px;left:85px;white-space:nowrap" class="ft14059"><b>&#160;4.12.3&#160;&#160;Adding&#160;to&#160;the&#160;database&#160;/etc/kma/logs/directaccess_list&#160;the&#160;processes&#160;that&#160;<br/>require&#160;direct&#160;access&#160;to&#160;devices</b></p>
<p style="position:absolute;top:344px;left:85px;white-space:nowrap" class="ft14019">The&#160;Administrator&#160;during&#160;the&#160;learning&#160;mode&#160;defines&#160;what&#160;processes&#160;will&#160;be&#160;allowed&#160;to&#160;<br/>access&#160;devices.&#160;When&#160;the&#160;system&#160;is&#160;executed&#160;in&#160;enforcing&#160;mode,&#160;non-authorized&#160;tasks&#160;<br/>cannot&#160;access&#160;protected&#160;devices.&#160;Each&#160;attempt&#160;is&#160;recorded&#160;by&#160;the&#160;kernel&#160;that&#160;displays&#160;<br/>a&#160;message&#160;(and&#160;records&#160;in&#160;the&#160;system&#160;log)&#160;like&#160;this:</p>
<p style="position:absolute;top:430px;left:85px;white-space:nowrap" class="ft14051">Error: process fdisk[1428] is not authorized to access dev/sdx</p>
<p style="position:absolute;top:457px;left:85px;white-space:nowrap" class="ft14019">If&#160;the&#160;Administrator&#160;wants&#160;to&#160;authorize&#160;the&#160;application&#160;to&#160;directly&#160;access&#160;a&#160;device,&#160;<br/>he/she&#160;must&#160;execute&#160;the&#160;procedure&#160;for&#160;new&#160;certified&#160;applications&#160;described&#160;in&#160;the&#160;<br/>section&#160;4.12.1.</p>
<p style="position:absolute;top:542px;left:85px;white-space:nowrap" class="ft14052"><b>&#160;4.12.4&#160;&#160;Allowing&#160;new&#160;or&#160;updated&#160;modules&#160;to&#160;be&#160;loaded&#160;in&#160;the&#160;kernel&#160;</b></p>
<p style="position:absolute;top:568px;left:85px;white-space:nowrap" class="ft14019">Following&#160;steps&#160;need&#160;to&#160;be&#160;performed&#160;by&#160;the&#160;Administrator&#160;in&#160;order&#160;to&#160;add&#160;extra&#160;<br/>modules&#160;to&#160;database&#160;or&#160;to&#160;fix&#160;the&#160;case&#160;of&#160;duplicated&#160;entries:</p>
<p style="position:absolute;top:616px;left:112px;white-space:nowrap" class="ft14017">1.&#160;Execute&#160;the&#160;utility&#160;</p>
<p style="position:absolute;top:617px;left:296px;white-space:nowrap" class="ft14051">init_masterkey.sh</p>
<p style="position:absolute;top:616px;left:464px;white-space:nowrap" class="ft14017">;</p>
<p style="position:absolute;top:645px;left:139px;white-space:nowrap" class="ft14025">1.&#160;Delete&#160;the&#160;old&#160;MasterKey&#160;(confirm&#160;when&#160;requested);<br/>2.&#160;Enter&#160;the&#160;Administrator&#160;password&#160;(and&#160;the&#160;SRK&#160;password,&#160;if&#160;requested);<br/>3.&#160;Set&#160;a&#160;new&#160;label&#160;(TPM&#160;v1.2&#160;only);</p>
<p style="position:absolute;top:730px;left:112px;white-space:nowrap" class="ft14017">2.&#160;Execute&#160;the&#160;utility&#160;</p>
<p style="position:absolute;top:731px;left:296px;white-space:nowrap" class="ft14051">kma_write_nv&#160;</p>
<p style="position:absolute;top:730px;left:424px;white-space:nowrap" class="ft14017">(TPM&#160;v1.2&#160;only&#160;-&#160;start&#160;Trousers:&#160;</p>
<p style="position:absolute;top:731px;left:689px;white-space:nowrap" class="ft14051">service tcsd&#160;</p>
<p style="position:absolute;top:752px;left:139px;white-space:nowrap" class="ft14051">start</p>
<p style="position:absolute;top:750px;left:189px;white-space:nowrap" class="ft14017">);</p>
<p style="position:absolute;top:779px;left:139px;white-space:nowrap" class="ft14025">1.&#160;Enter&#160;the&#160;secret&#160;associated&#160;to&#160;the&#160;NV&#160;storage&#160;portion;<br/>2.&#160;Type&#160;the&#160;same&#160;label&#160;specified&#160;when&#160;updating&#160;the&#160;MasterKey;</p>
<p style="position:absolute;top:836px;left:112px;white-space:nowrap" class="ft14025">3.&#160;Reboot&#160;the&#160;system&#160;in&#160;learning&#160;mode;<br/>4.&#160;Execute&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:865px;left:331px;white-space:nowrap" class="ft14051">insmod &lt;kernel module file&gt;</p>
<p style="position:absolute;top:864px;left:598px;white-space:nowrap" class="ft14017">&#160;or&#160;</p>
<p style="position:absolute;top:865px;left:626px;white-space:nowrap" class="ft14051">modprobe &lt;kernel&#160;</p>
<p style="position:absolute;top:886px;left:139px;white-space:nowrap" class="ft14051">module name&gt;</p>
<p style="position:absolute;top:884px;left:258px;white-space:nowrap" class="ft14017">&#160;for&#160;each&#160;module&#160;to&#160;add&#160;to&#160;the&#160;database;</p>
<p style="position:absolute;top:913px;left:112px;white-space:nowrap" class="ft14017">5.&#160;Review&#160;the&#160;database&#160;of&#160;modules&#160;by&#160;executing&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:915px;left:647px;white-space:nowrap" class="ft14051">kma_modules_db /</p>
<p style="position:absolute;top:935px;left:139px;white-space:nowrap" class="ft14051">etc/kma/logs/modules_list</p>
<p style="position:absolute;top:934px;left:387px;white-space:nowrap" class="ft14017">;</p>
<p style="position:absolute;top:963px;left:139px;white-space:nowrap" class="ft14017">1.&#160;If&#160;there&#160;are&#160;duplicate&#160;entries,&#160;the&#160;utility&#160;asks&#160;to&#160;update&#160;the&#160;digest&#160;value&#160;of&#160;</p>
<p style="position:absolute;top:982px;left:166px;white-space:nowrap" class="ft14017">the&#160;module;</p>
<p style="position:absolute;top:1010px;left:139px;white-space:nowrap" class="ft14017">2.&#160;If&#160;the&#160;database&#160;has&#160;been&#160;modified,&#160;type&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:1012px;left:622px;white-space:nowrap" class="ft14051">write</p>
<p style="position:absolute;top:1010px;left:672px;white-space:nowrap" class="ft14017">&#160;followed&#160;by&#160;a&#160;</p>
<p style="position:absolute;top:1030px;left:166px;white-space:nowrap" class="ft14017">filename;</p>
<p style="position:absolute;top:1059px;left:112px;white-space:nowrap" class="ft14017">6.&#160;Replace&#160;the&#160;file&#160;</p>
<p style="position:absolute;top:1060px;left:273px;white-space:nowrap" class="ft14051">/etc/kma/logs/modules_list</p>
<p style="position:absolute;top:1059px;left:531px;white-space:nowrap" class="ft14017">&#160;with&#160;the&#160;new&#160;file&#160;just&#160;created;</p>
<p style="position:absolute;top:1088px;left:112px;white-space:nowrap" class="ft14017">7.&#160;Reboot&#160;the&#160;system&#160;in&#160;enforcing&#160;mode&#160;and&#160;restart&#160;the&#160;sealing&#160;procedure.</p>
<p style="position:absolute;top:1116px;left:85px;white-space:nowrap" class="ft14017">In&#160;case&#160;of&#160;duplicated&#160;entries&#160;KMA&#160;will&#160;not&#160;be&#160;able&#160;to&#160;boot&#160;and&#160;it&#160;displays&#160;this&#160;message&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft14021">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft14021">26/35</p>
</div>
<!-- Page 141 -->
<a name="141"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page141-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3141.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1419">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft14150">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft14121">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:85px;white-space:nowrap" class="ft14117">during&#160;the&#160;boot&#160;process:</p>
<p style="position:absolute;top:177px;left:85px;white-space:nowrap" class="ft14151">Error: duplicated entry &lt;module name&gt;, digests:</p>
<p style="position:absolute;top:196px;left:85px;white-space:nowrap" class="ft14155">526350333ecb1804ec946761f90e985574cdc1ed<br/>bc605ced62d035fddf4d095f4b38b0198f9d17e1</p>
<p style="position:absolute;top:261px;left:85px;white-space:nowrap" class="ft14116"><b>Note:&#160;in&#160;case&#160;of&#160;kernel&#160;update&#160;a&#160;recommended&#160;is&#160;deleting&#160;the&#160;file&#160;</b></p>
<p style="position:absolute;top:282px;left:85px;white-space:nowrap" class="ft14156"><b>/etc/kma/logs/modules_list</b></p>
<p style="position:absolute;top:281px;left:343px;white-space:nowrap" class="ft14116"><b>&#160;before&#160;executing&#160;the&#160;procedure&#160;described&#160;</b></p>
<p style="position:absolute;top:301px;left:85px;white-space:nowrap" class="ft14116"><b>above.</b></p>
<p style="position:absolute;top:347px;left:85px;white-space:nowrap" class="ft14152"><b>&#160;4.12.5&#160;&#160;Updating&#160;the&#160;system&#160;–&#160;a&#160;file&#160;included&#160;in&#160;/etc/kma/checkfilelist&#160;is&#160;changed</b></p>
<p style="position:absolute;top:373px;left:85px;white-space:nowrap" class="ft14119">If&#160;one&#160;file&#160;of&#160;the&#160;list&#160;is&#160;changed,&#160;the&#160;sealing&#160;of&#160;the&#160;MasterKey&#160;must&#160;be&#160;restarted&#160;in&#160;<br/>order&#160;to&#160;include&#160;in&#160;the&#160;sealed&#160;blob&#160;the&#160;updated&#160;PCRs.&#160;The&#160;Administrator&#160;must&#160;execute&#160;<br/>the&#160;steps&#160;1-2&#160;in&#160;the&#160;section&#160;4.12.4,&#160;start&#160;the&#160;utility&#160;</p>
<p style="position:absolute;top:413px;left:508px;white-space:nowrap" class="ft14151">init_masterkey.sh</p>
<p style="position:absolute;top:412px;left:676px;white-space:nowrap" class="ft14117">&#160;and&#160;reboot&#160;the&#160;</p>
<p style="position:absolute;top:432px;left:85px;white-space:nowrap" class="ft14119">system&#160;in&#160;enforcing&#160;mode.&#160;If&#160;the&#160;MasterKey&#160;bound&#160;blob&#160;is&#160;present,&#160;the&#160;Administrator&#160;<br/>can&#160;seal&#160;the&#160;same&#160;MasterKey&#160;and&#160;KMA&#160;can&#160;work&#160;without&#160;doing&#160;extra&#160;steps;&#160;otherwise&#160;<br/>if&#160;the&#160;bound&#160;blob&#160;has&#160;been&#160;deleted,&#160;the&#160;MasterKey&#160;</p>
<p style="position:absolute;top:471px;left:510px;white-space:nowrap" class="ft14116"><b>WILL&#160;NOT&#160;BE&#160;RECOVERABLE</b></p>
<p style="position:absolute;top:471px;left:770px;white-space:nowrap" class="ft14117">,&#160;a&#160;</p>
<p style="position:absolute;top:490px;left:85px;white-space:nowrap" class="ft14117">new&#160;key&#160;should&#160;be&#160;generated&#160;and&#160;all&#160;data&#160;saved&#160;in&#160;the&#160;protected&#160;filesystem&#160;</p>
<p style="position:absolute;top:490px;left:721px;white-space:nowrap" class="ft14116"><b>WILL&#160;BE&#160;</b></p>
<p style="position:absolute;top:509px;left:85px;white-space:nowrap" class="ft14116"><b>LOST</b></p>
<p style="position:absolute;top:509px;left:133px;white-space:nowrap" class="ft14117">.&#160;The&#160;bound&#160;blob&#160;needs&#160;therefore&#160;to&#160;be&#160;backed&#160;up.</p>
<p style="position:absolute;top:555px;left:85px;white-space:nowrap" class="ft14152"><b>&#160;4.12.6&#160;&#160;Updating&#160;filesystem&#160;policies</b></p>
<p style="position:absolute;top:582px;left:85px;white-space:nowrap" class="ft14119">The&#160;Administrator&#160;may&#160;decide&#160;to&#160;revoke&#160;the&#160;access&#160;to&#160;an&#160;application,&#160;for&#160;example&#160;<br/>because&#160;a&#160;vulnerability&#160;has&#160;been&#160;discovered.&#160;The&#160;file&#160;</p>
<p style="position:absolute;top:602px;left:531px;white-space:nowrap" class="ft14151">/etc/kma/template.conf</p>
<p style="position:absolute;top:601px;left:749px;white-space:nowrap" class="ft14117">&#160;or&#160;</p>
<p style="position:absolute;top:621px;left:85px;white-space:nowrap" class="ft14117">another&#160;file&#160;containing&#160;policies&#160;changes&#160;and,&#160;if&#160;the&#160;pathname&#160;has&#160;been&#160;included&#160;in&#160;</p>
<p style="position:absolute;top:642px;left:85px;white-space:nowrap" class="ft14151">/etc/kma/checkfilelist</p>
<p style="position:absolute;top:640px;left:303px;white-space:nowrap" class="ft14117">,&#160;the&#160;same&#160;procedure&#160;described&#160;in&#160;section&#160;4.12.5&#160;must&#160;be&#160;</p>
<p style="position:absolute;top:661px;left:85px;white-space:nowrap" class="ft14117">followed.</p>
<p style="position:absolute;top:707px;left:85px;white-space:nowrap" class="ft14152"><b>&#160;4.12.7&#160;&#160;Restoring&#160;access&#160;to&#160;a&#160;renamed&#160;or&#160;a&#160;moved&#160;eCryptfs&#160;file</b></p>
<p style="position:absolute;top:733px;left:85px;white-space:nowrap" class="ft14119">This&#160;issue&#160;can&#160;be&#160;solved&#160;by&#160;the&#160;Administrator&#160;that&#160;can&#160;decide&#160;if&#160;the&#160;file&#160;will&#160;be&#160;made&#160;<br/>available&#160;to&#160;regular&#160;users&#160;by&#160;executing&#160;the&#160;following&#160;steps:</p>
<p style="position:absolute;top:781px;left:112px;white-space:nowrap" class="ft14125">1.&#160;Execute&#160;steps&#160;1-2&#160;in&#160;the&#160;section&#160;4.12.4;<br/>2.&#160;Reboot&#160;the&#160;system&#160;in&#160;learning&#160;mode;<br/>3.&#160;Inspects&#160;all&#160;files&#160;moved&#160;from&#160;their&#160;regular&#160;position&#160;by&#160;executing&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:858px;left:139px;white-space:nowrap" class="ft14151">dmesg | grep ecryptfs</p>
<p style="position:absolute;top:856px;left:347px;white-space:nowrap" class="ft14117">.&#160;The&#160;Administrator&#160;must&#160;inspect&#160;this&#160;type&#160;of&#160;message:</p>
<p style="position:absolute;top:885px;left:139px;white-space:nowrap" class="ft14117">1.</p>
<p style="position:absolute;top:887px;left:166px;white-space:nowrap" class="ft14158">ecryptfs_parse_packet_set: Error: file /system/ssh/sshd_config&#160;<br/>in the protected filesystem has been moved from the original&#160;<br/>position</p>
<p style="position:absolute;top:924px;left:245px;white-space:nowrap" class="ft14117">;</p>
<p style="position:absolute;top:954px;left:112px;white-space:nowrap" class="ft14117">4.&#160;Copy&#160;temporarily&#160;invalid&#160;files&#160;to&#160;a&#160;backup&#160;directory&#160;in&#160;the&#160;unprotected&#160;</p>
<p style="position:absolute;top:973px;left:139px;white-space:nowrap" class="ft14117">filesystem,&#160;delete&#160;and&#160;recreate&#160;them&#160;in&#160;the&#160;original&#160;location.</p>
<p style="position:absolute;top:1001px;left:112px;white-space:nowrap" class="ft14117">5.&#160;Restart&#160;the&#160;sealing&#160;procedure.</p>
<p style="position:absolute;top:1047px;left:85px;white-space:nowrap" class="ft14140"><b>&#160;5&#160;&#160;Removing&#160;KMA</b></p>
<p style="position:absolute;top:1077px;left:85px;white-space:nowrap" class="ft14119">In&#160;order&#160;to&#160;remove&#160;the&#160;KMA&#160;software&#160;these&#160;steps&#160;must&#160;be&#160;performed&#160;by&#160;the&#160;<br/>Administrator:</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft14121">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft14121">27/35</p>
</div>
<!-- Page 142 -->
<a name="142"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page142-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3142.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1429">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft14250">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft14221">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:112px;white-space:nowrap" class="ft14217">1.&#160;Reboot&#160;the&#160;system&#160;in&#160;learning&#160;mode&#160;in&#160;order&#160;to&#160;access&#160;all&#160;saved&#160;data&#160;in&#160;the&#160;</p>
<p style="position:absolute;top:168px;left:139px;white-space:nowrap" class="ft14217">protected&#160;filesystem;</p>
<p style="position:absolute;top:196px;left:112px;white-space:nowrap" class="ft14217">2.&#160;Execute&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:198px;left:331px;white-space:nowrap" class="ft14251">kma_makeinsecure.sh</p>
<p style="position:absolute;top:196px;left:519px;white-space:nowrap" class="ft14217">:&#160;this&#160;copies&#160;all&#160;protected&#160;</p>
<p style="position:absolute;top:217px;left:139px;white-space:nowrap" class="ft14219">directories&#160;to&#160;the&#160;unprotected&#160;filesystem&#160;by&#160;removing&#160;symlinks&#160;and&#160;creating&#160;<br/>instead&#160;directories&#160;with&#160;the&#160;same&#160;name</p>
<p style="position:absolute;top:264px;left:112px;white-space:nowrap" class="ft14225">3.&#160;Open&#160;YaST/Software&#160;Management;<br/>4.&#160;Select&#160;the&#160;entry&#160;“</p>
<p style="position:absolute;top:294px;left:285px;white-space:nowrap" class="ft14251">Repositories</p>
<p style="position:absolute;top:292px;left:404px;white-space:nowrap" class="ft14217">”&#160;from&#160;the&#160;tab&#160;“</p>
<p style="position:absolute;top:294px;left:535px;white-space:nowrap" class="ft14251">Filter</p>
<p style="position:absolute;top:292px;left:594px;white-space:nowrap" class="ft14217">”;</p>
<p style="position:absolute;top:321px;left:112px;white-space:nowrap" class="ft14225">5.&#160;Select&#160;the&#160;KMA&#160;repository&#160;from&#160;the&#160;repositories&#160;list;<br/>6.&#160;Remove&#160;all&#160;packages&#160;from&#160;this&#160;repository;<br/>7.&#160;Reinstall&#160;the&#160;</p>
<p style="position:absolute;top:379px;left:248px;white-space:nowrap" class="ft14251">openCryptoki</p>
<p style="position:absolute;top:378px;left:367px;white-space:nowrap" class="ft14217">&#160;and&#160;the&#160;</p>
<p style="position:absolute;top:379px;left:441px;white-space:nowrap" class="ft14251">firefox</p>
<p style="position:absolute;top:378px;left:510px;white-space:nowrap" class="ft14217">&#160;packages&#160;included&#160;in&#160;the&#160;</p>
<p style="position:absolute;top:398px;left:139px;white-space:nowrap" class="ft14217">openSUSE&#160;distribution.</p>
<p style="position:absolute;top:444px;left:85px;white-space:nowrap" class="ft14240"><b>&#160;6&#160;&#160;List&#160;of&#160;all&#160;command&#160;used&#160;with&#160;parameters</b></p>
<p style="position:absolute;top:479px;left:112px;white-space:nowrap" class="ft14212">●</p>
<p style="position:absolute;top:476px;left:139px;white-space:nowrap" class="ft14251">init_masterkey.sh &lt;destination directory&gt;</p>
<p style="position:absolute;top:474px;left:545px;white-space:nowrap" class="ft14217">:&#160;generates&#160;the&#160;MasterKey,&#160;</p>
<p style="position:absolute;top:495px;left:139px;white-space:nowrap" class="ft14219">eventually&#160;appends&#160;a&#160;label&#160;to&#160;the&#160;former,&#160;creates&#160;a&#160;blob&#160;of&#160;them&#160;by&#160;using&#160;a&#160;<br/>newly&#160;generated&#160;TPM&#160;wrapping&#160;key;</p>
<p style="position:absolute;top:546px;left:112px;white-space:nowrap" class="ft14212">●</p>
<p style="position:absolute;top:544px;left:139px;white-space:nowrap" class="ft14251">certbin --list &lt;signed files list&gt;&#160;</p>
<p style="position:absolute;top:542px;left:486px;white-space:nowrap" class="ft14217">:&#160;certifies&#160;a&#160;list&#160;of&#160;binaries;</p>
<p style="position:absolute;top:576px;left:112px;white-space:nowrap" class="ft14212">●</p>
<p style="position:absolute;top:573px;left:139px;white-space:nowrap" class="ft14251">kma_mmap_db &lt;mmap file list&gt;</p>
<p style="position:absolute;top:571px;left:416px;white-space:nowrap" class="ft14217">:&#160;used&#160;to&#160;inspect&#160;libraries&#160;mapped&#160;by&#160;certified&#160;</p>
<p style="position:absolute;top:591px;left:139px;white-space:nowrap" class="ft14217">applications&#160;or&#160;to&#160;modify&#160;this&#160;list.&#160;Commands:</p>
<p style="position:absolute;top:623px;left:139px;white-space:nowrap" class="ft14212">○</p>
<p style="position:absolute;top:620px;left:166px;white-space:nowrap" class="ft14251">view</p>
<p style="position:absolute;top:652px;left:166px;white-space:nowrap" class="ft14212">■</p>
<p style="position:absolute;top:649px;left:193px;white-space:nowrap" class="ft14251">tag</p>
<p style="position:absolute;top:648px;left:223px;white-space:nowrap" class="ft14217">:&#160;display&#160;all&#160;libraries&#160;mapped&#160;by&#160;each&#160;tag</p>
<p style="position:absolute;top:681px;left:166px;white-space:nowrap" class="ft14212">■</p>
<p style="position:absolute;top:678px;left:193px;white-space:nowrap" class="ft14251">libraries</p>
<p style="position:absolute;top:677px;left:282px;white-space:nowrap" class="ft14217">:&#160;display&#160;all&#160;tags&#160;that&#160;use&#160;each&#160;library</p>
<p style="position:absolute;top:709px;left:139px;white-space:nowrap" class="ft14212">○</p>
<p style="position:absolute;top:706px;left:166px;white-space:nowrap" class="ft14251">add</p>
<p style="position:absolute;top:738px;left:166px;white-space:nowrap" class="ft14212">■</p>
<p style="position:absolute;top:735px;left:193px;white-space:nowrap" class="ft14251">library</p>
<p style="position:absolute;top:734px;left:263px;white-space:nowrap" class="ft14217">:&#160;a&#160;new&#160;library&#160;to&#160;be&#160;included&#160;in&#160;the&#160;list</p>
<p style="position:absolute;top:768px;left:166px;white-space:nowrap" class="ft14212">■</p>
<p style="position:absolute;top:765px;left:193px;white-space:nowrap" class="ft14251">tag</p>
<p style="position:absolute;top:763px;left:223px;white-space:nowrap" class="ft14217">:&#160;the&#160;tag&#160;allowed&#160;to&#160;use&#160;this&#160;library</p>
<p style="position:absolute;top:795px;left:139px;white-space:nowrap" class="ft14212">○</p>
<p style="position:absolute;top:793px;left:166px;white-space:nowrap" class="ft14251">verify</p>
<p style="position:absolute;top:825px;left:166px;white-space:nowrap" class="ft14212">■</p>
<p style="position:absolute;top:820px;left:193px;white-space:nowrap" class="ft14217">used&#160;to&#160;compare&#160;all&#160;digests&#160;stored&#160;in&#160;the&#160;database&#160;with&#160;actual&#160;values</p>
<p style="position:absolute;top:851px;left:139px;white-space:nowrap" class="ft14212">○</p>
<p style="position:absolute;top:848px;left:166px;white-space:nowrap" class="ft14251">write</p>
<p style="position:absolute;top:881px;left:166px;white-space:nowrap" class="ft14212">■</p>
<p style="position:absolute;top:878px;left:193px;white-space:nowrap" class="ft14251">&lt;filename&gt;</p>
<p style="position:absolute;top:876px;left:292px;white-space:nowrap" class="ft14217">:&#160;writes&#160;the&#160;modifications&#160;to&#160;a&#160;file&#160;called&#160;filename</p>
<p style="position:absolute;top:909px;left:139px;white-space:nowrap" class="ft14212">○</p>
<p style="position:absolute;top:906px;left:166px;white-space:nowrap" class="ft14251">quit</p>
<p style="position:absolute;top:938px;left:112px;white-space:nowrap" class="ft14212">●</p>
<p style="position:absolute;top:935px;left:139px;white-space:nowrap" class="ft14251">kma_directaccess_db &lt;directaccess list&gt;</p>
<p style="position:absolute;top:933px;left:525px;white-space:nowrap" class="ft14217">:&#160;used&#160;to&#160;inspect&#160;direct&#160;accesses&#160;</p>
<p style="position:absolute;top:954px;left:139px;white-space:nowrap" class="ft14217">to&#160;devices&#160;by&#160;certified&#160;applications.&#160;Commands:</p>
<p style="position:absolute;top:985px;left:139px;white-space:nowrap" class="ft14212">○</p>
<p style="position:absolute;top:982px;left:166px;white-space:nowrap" class="ft14251">view</p>
<p style="position:absolute;top:1014px;left:166px;white-space:nowrap" class="ft14212">■</p>
<p style="position:absolute;top:1009px;left:193px;white-space:nowrap" class="ft14217">view&#160;the&#160;list&#160;of&#160;current&#160;rules&#160;</p>
<p style="position:absolute;top:1041px;left:139px;white-space:nowrap" class="ft14212">○</p>
<p style="position:absolute;top:1038px;left:166px;white-space:nowrap" class="ft14251">add</p>
<p style="position:absolute;top:1070px;left:166px;white-space:nowrap" class="ft14212">■</p>
<p style="position:absolute;top:1067px;left:193px;white-space:nowrap" class="ft14251">tag</p>
<p style="position:absolute;top:1066px;left:223px;white-space:nowrap" class="ft14217">:&#160;certified&#160;application</p>
<p style="position:absolute;top:1099px;left:166px;white-space:nowrap" class="ft14212">■</p>
<p style="position:absolute;top:1096px;left:193px;white-space:nowrap" class="ft14251">&lt;device name&gt;</p>
<p style="position:absolute;top:1095px;left:322px;white-space:nowrap" class="ft14217">:&#160;pathname&#160;of&#160;the&#160;device&#160;that&#160;the&#160;certified&#160;application&#160;will&#160;</p>
<p style="position:absolute;top:1115px;left:193px;white-space:nowrap" class="ft14217">access</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft14221">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft14221">28/35</p>
</div>
<!-- Page 143 -->
<a name="143"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page143-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3143.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1439">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft14350">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft14321">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:153px;left:166px;white-space:nowrap" class="ft14312">■</p>
<p style="position:absolute;top:151px;left:193px;white-space:nowrap" class="ft14351">&lt;permission&gt;</p>
<p style="position:absolute;top:149px;left:312px;white-space:nowrap" class="ft14317">:&#160;type&#160;of&#160;operation&#160;the&#160;certified&#160;application&#160;is&#160;allowed&#160;to&#160;</p>
<p style="position:absolute;top:169px;left:193px;white-space:nowrap" class="ft14317">perform</p>
<p style="position:absolute;top:201px;left:139px;white-space:nowrap" class="ft14312">○</p>
<p style="position:absolute;top:198px;left:166px;white-space:nowrap" class="ft14351">modify</p>
<p style="position:absolute;top:230px;left:166px;white-space:nowrap" class="ft14312">■</p>
<p style="position:absolute;top:227px;left:193px;white-space:nowrap" class="ft14351">&lt;entry identifier&gt;</p>
<p style="position:absolute;top:225px;left:371px;white-space:nowrap" class="ft14317">:&#160;cardinal&#160;number&#160;that&#160;identifies&#160;an&#160;element&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:246px;left:193px;white-space:nowrap" class="ft14317">list;&#160;it&#160;can&#160;be&#160;seen&#160;by&#160;executing&#160;the&#160;command&#160;view</p>
<p style="position:absolute;top:278px;left:166px;white-space:nowrap" class="ft14312">■</p>
<p style="position:absolute;top:275px;left:193px;white-space:nowrap" class="ft14351">tag</p>
<p style="position:absolute;top:274px;left:223px;white-space:nowrap" class="ft14317">:&#160;certified&#160;application</p>
<p style="position:absolute;top:308px;left:166px;white-space:nowrap" class="ft14312">■</p>
<p style="position:absolute;top:305px;left:193px;white-space:nowrap" class="ft14351">&lt;device name&gt;</p>
<p style="position:absolute;top:303px;left:322px;white-space:nowrap" class="ft14317">:&#160;pathname&#160;of&#160;the&#160;device&#160;that&#160;the&#160;certified&#160;application&#160;will&#160;</p>
<p style="position:absolute;top:323px;left:193px;white-space:nowrap" class="ft14317">access</p>
<p style="position:absolute;top:356px;left:166px;white-space:nowrap" class="ft14312">■</p>
<p style="position:absolute;top:353px;left:193px;white-space:nowrap" class="ft14351">&lt;permission&gt;</p>
<p style="position:absolute;top:351px;left:312px;white-space:nowrap" class="ft14317">:&#160;type&#160;of&#160;operation&#160;allowed&#160;to&#160;the&#160;certified&#160;application</p>
<p style="position:absolute;top:384px;left:139px;white-space:nowrap" class="ft14312">○</p>
<p style="position:absolute;top:381px;left:166px;white-space:nowrap" class="ft14351">delete</p>
<p style="position:absolute;top:413px;left:166px;white-space:nowrap" class="ft14312">■</p>
<p style="position:absolute;top:410px;left:193px;white-space:nowrap" class="ft14351">&lt;entry identifier&gt;</p>
<p style="position:absolute;top:408px;left:371px;white-space:nowrap" class="ft14317">:&#160;cardinal&#160;number&#160;that&#160;identifies&#160;an&#160;element&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:430px;left:193px;white-space:nowrap" class="ft14351">list</p>
<p style="position:absolute;top:429px;left:233px;white-space:nowrap" class="ft14317">:&#160;it&#160;can&#160;be&#160;seen&#160;by&#160;executing&#160;the&#160;command&#160;view</p>
<p style="position:absolute;top:461px;left:139px;white-space:nowrap" class="ft14312">○</p>
<p style="position:absolute;top:458px;left:166px;white-space:nowrap" class="ft14351">write</p>
<p style="position:absolute;top:490px;left:166px;white-space:nowrap" class="ft14312">■</p>
<p style="position:absolute;top:487px;left:193px;white-space:nowrap" class="ft14351">&lt;filename&gt;</p>
<p style="position:absolute;top:486px;left:292px;white-space:nowrap" class="ft14317">:&#160;writes&#160;the&#160;modifications&#160;to&#160;a&#160;file&#160;called&#160;filename</p>
<p style="position:absolute;top:518px;left:139px;white-space:nowrap" class="ft14312">○</p>
<p style="position:absolute;top:515px;left:166px;white-space:nowrap" class="ft14351">quit</p>
<p style="position:absolute;top:547px;left:112px;white-space:nowrap" class="ft14312">●</p>
<p style="position:absolute;top:544px;left:139px;white-space:nowrap" class="ft14351">kma_modules_db &lt;modules list&gt;</p>
<p style="position:absolute;top:543px;left:426px;white-space:nowrap" class="ft14317">:&#160;used&#160;to&#160;review&#160;the&#160;list&#160;of&#160;modules&#160;will&#160;be&#160;</p>
<p style="position:absolute;top:563px;left:139px;white-space:nowrap" class="ft14317">allowed&#160;to&#160;load&#160;when&#160;the&#160;KMA&#160;is&#160;executed&#160;in&#160;enforcing&#160;mode&#160;and&#160;their&#160;digest</p>
<p style="position:absolute;top:594px;left:139px;white-space:nowrap" class="ft14312">○</p>
<p style="position:absolute;top:592px;left:166px;white-space:nowrap" class="ft14351">view</p>
<p style="position:absolute;top:624px;left:166px;white-space:nowrap" class="ft14312">■</p>
<p style="position:absolute;top:619px;left:193px;white-space:nowrap" class="ft14317">display&#160;the&#160;list&#160;of&#160;modules</p>
<p style="position:absolute;top:650px;left:139px;white-space:nowrap" class="ft14312">○</p>
<p style="position:absolute;top:647px;left:166px;white-space:nowrap" class="ft14351">delete</p>
<p style="position:absolute;top:680px;left:166px;white-space:nowrap" class="ft14312">■</p>
<p style="position:absolute;top:677px;left:193px;white-space:nowrap" class="ft14351">&lt;entry number&gt;</p>
<p style="position:absolute;top:675px;left:332px;white-space:nowrap" class="ft14317">:&#160;cardinal&#160;number&#160;that&#160;identifies&#160;an&#160;element&#160;of&#160;the&#160;list:&#160;it&#160;</p>
<p style="position:absolute;top:695px;left:193px;white-space:nowrap" class="ft14317">can&#160;be&#160;seen&#160;by&#160;executing&#160;the&#160;command&#160;view</p>
<p style="position:absolute;top:727px;left:139px;white-space:nowrap" class="ft14312">○</p>
<p style="position:absolute;top:724px;left:166px;white-space:nowrap" class="ft14351">write</p>
<p style="position:absolute;top:756px;left:166px;white-space:nowrap" class="ft14312">■</p>
<p style="position:absolute;top:753px;left:193px;white-space:nowrap" class="ft14351">&lt;filename&gt;</p>
<p style="position:absolute;top:751px;left:292px;white-space:nowrap" class="ft14317">:&#160;writes&#160;a&#160;modified&#160;database&#160;to&#160;a&#160;file&#160;called&#160;filename</p>
<p style="position:absolute;top:785px;left:112px;white-space:nowrap" class="ft14312">●</p>
<p style="position:absolute;top:782px;left:139px;white-space:nowrap" class="ft14351">kma_makesecure.sh &lt;file list&gt; &lt;output file&gt;</p>
<p style="position:absolute;top:781px;left:565px;white-space:nowrap" class="ft14317">:&#160;used&#160;to&#160;copy&#160;files&#160;from&#160;the&#160;</p>
<p style="position:absolute;top:801px;left:139px;white-space:nowrap" class="ft14317">unprotected&#160;filesystem&#160;to&#160;the&#160;protected&#160;one;</p>
<p style="position:absolute;top:834px;left:139px;white-space:nowrap" class="ft14312">○</p>
<p style="position:absolute;top:831px;left:166px;white-space:nowrap" class="ft14351">file list</p>
<p style="position:absolute;top:829px;left:255px;white-space:nowrap" class="ft14317">:&#160;by&#160;default&#160;</p>
<p style="position:absolute;top:831px;left:355px;white-space:nowrap" class="ft14351">/etc/kma/files_saved</p>
<p style="position:absolute;top:829px;left:553px;white-space:nowrap" class="ft14317">;</p>
<p style="position:absolute;top:863px;left:139px;white-space:nowrap" class="ft14312">○</p>
<p style="position:absolute;top:860px;left:166px;white-space:nowrap" class="ft14351">output file</p>
<p style="position:absolute;top:858px;left:275px;white-space:nowrap" class="ft14317">:&#160;filename&#160;that&#160;will&#160;be&#160;created&#160;and&#160;will&#160;contain&#160;files&#160;effectively&#160;</p>
<p style="position:absolute;top:879px;left:166px;white-space:nowrap" class="ft14317">copied&#160;in&#160;the&#160;protected&#160;filesystem&#160;and&#160;the&#160;relative&#160;SHA1.</p>
<p style="position:absolute;top:911px;left:112px;white-space:nowrap" class="ft14312">●</p>
<p style="position:absolute;top:908px;left:139px;white-space:nowrap" class="ft14351">kma_makeinsecure.sh</p>
<p style="position:absolute;top:907px;left:327px;white-space:nowrap" class="ft14317">:&#160;used&#160;to&#160;restore&#160;the&#160;original&#160;configuration&#160;before&#160;the&#160;</p>
<p style="position:absolute;top:927px;left:139px;white-space:nowrap" class="ft14319">KMA&#160;installation:&#160;deletes&#160;symlinks,&#160;replaces&#160;them&#160;with&#160;directories&#160;having&#160;the&#160;<br/>same&#160;name&#160;and&#160;copies&#160;to&#160;files&#160;from&#160;the&#160;protected&#160;filesystem;</p>
<p style="position:absolute;top:979px;left:112px;white-space:nowrap" class="ft14312">●</p>
<p style="position:absolute;top:976px;left:139px;white-space:nowrap" class="ft14351">kma_policy.sh &lt;path of symlink&gt;</p>
<p style="position:absolute;top:975px;left:446px;white-space:nowrap" class="ft14317">:&#160;used&#160;to&#160;show&#160;the&#160;policy&#160;associated&#160;to&#160;a&#160;</p>
<p style="position:absolute;top:995px;left:139px;white-space:nowrap" class="ft14317">protected&#160;directory</p>
<p style="position:absolute;top:1028px;left:112px;white-space:nowrap" class="ft14312">●</p>
<p style="position:absolute;top:1025px;left:139px;white-space:nowrap" class="ft14351">kma_define_nv</p>
<p style="position:absolute;top:1023px;left:268px;white-space:nowrap" class="ft14317">:&#160;defines&#160;a&#160;new&#160;space&#160;in&#160;the&#160;NV&#160;storage&#160;of&#160;the&#160;TPM&#160;(only&#160;v1.2)&#160;</p>
<p style="position:absolute;top:1043px;left:139px;white-space:nowrap" class="ft14319">starting&#160;at&#160;index&#160;0x00011136&#160;and&#160;set&#160;a&#160;secret&#160;to&#160;protect&#160;the&#160;write&#160;operation;&#160;<br/>the&#160;owner's&#160;password&#160;is&#160;required</p>
<p style="position:absolute;top:1095px;left:112px;white-space:nowrap" class="ft14312">●</p>
<p style="position:absolute;top:1092px;left:139px;white-space:nowrap" class="ft14351">kma_write_nv</p>
<p style="position:absolute;top:1091px;left:258px;white-space:nowrap" class="ft14317">:&#160;writes&#160;10&#160;bytes&#160;inserted&#160;by&#160;the&#160;Administrator&#160;to&#160;the&#160;defined&#160;</p>
<p style="position:absolute;top:1111px;left:139px;white-space:nowrap" class="ft14317">space&#160;in&#160;the&#160;NV&#160;storage,&#160;after&#160;prompting&#160;the&#160;secret&#160;set</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft14321">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft14321">29/35</p>
</div>
<!-- Page 144 -->
<a name="144"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page144-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3144.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1449">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft14450">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft14421">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:153px;left:112px;white-space:nowrap" class="ft14412">●</p>
<p style="position:absolute;top:151px;left:139px;white-space:nowrap" class="ft14451">kma_read_nv</p>
<p style="position:absolute;top:149px;left:248px;white-space:nowrap" class="ft14417">:&#160;reads&#160;10&#160;bytes&#160;from&#160;the&#160;index&#160;0x00011136&#160;of&#160;the&#160;NV&#160;storage&#160;</p>
<p style="position:absolute;top:169px;left:139px;white-space:nowrap" class="ft14417">without&#160;requiring&#160;any&#160;authorization</p>
<p style="position:absolute;top:202px;left:112px;white-space:nowrap" class="ft14412">●</p>
<p style="position:absolute;top:199px;left:139px;white-space:nowrap" class="ft14451">kma_release_nv</p>
<p style="position:absolute;top:197px;left:278px;white-space:nowrap" class="ft14417">:&#160;releases&#160;the&#160;space&#160;defined&#160;in&#160;the&#160;NV&#160;starting&#160;at&#160;index&#160;</p>
<p style="position:absolute;top:218px;left:139px;white-space:nowrap" class="ft14417">0x00011136;&#160;the&#160;owner&#160;password&#160;is&#160;required.</p>
<p style="position:absolute;top:264px;left:85px;white-space:nowrap" class="ft14440"><b>&#160;7&#160;&#160;Workarounds</b></p>
<p style="position:absolute;top:294px;left:85px;white-space:nowrap" class="ft14417">Subversion:</p>
<p style="position:absolute;top:327px;left:112px;white-space:nowrap" class="ft14412">●</p>
<p style="position:absolute;top:322px;left:139px;white-space:nowrap" class="ft14417">Problem:&#160;if&#160;the&#160;</p>
<p style="position:absolute;top:324px;left:266px;white-space:nowrap" class="ft14451">$HOME/.subversion</p>
<p style="position:absolute;top:322px;left:434px;white-space:nowrap" class="ft14417">&#160;directory&#160;has&#160;not&#160;been&#160;initialized&#160;before&#160;the&#160;</p>
<p style="position:absolute;top:342px;left:139px;white-space:nowrap" class="ft14417">KMA&#160;installation,&#160;</p>
<p style="position:absolute;top:344px;left:282px;white-space:nowrap" class="ft14451">svn</p>
<p style="position:absolute;top:342px;left:312px;white-space:nowrap" class="ft14417">&#160;is&#160;unable&#160;to&#160;setup&#160;the&#160;directory&#160;tree;</p>
<p style="position:absolute;top:376px;left:112px;white-space:nowrap" class="ft14412">●</p>
<p style="position:absolute;top:372px;left:139px;white-space:nowrap" class="ft14417">Solution:&#160;the&#160;user&#160;must&#160;create&#160;the&#160;directory&#160;</p>
<p style="position:absolute;top:373px;left:508px;white-space:nowrap" class="ft14451">$HOME/auth/svn.simple</p>
<p style="position:absolute;top:372px;left:716px;white-space:nowrap" class="ft14417">&#160;before&#160;</p>
<p style="position:absolute;top:392px;left:139px;white-space:nowrap" class="ft14417">using&#160;the&#160;</p>
<p style="position:absolute;top:393px;left:221px;white-space:nowrap" class="ft14451">svn</p>
<p style="position:absolute;top:392px;left:251px;white-space:nowrap" class="ft14417">&#160;utility,&#160;in&#160;order&#160;store&#160;its&#160;passwords&#160;in&#160;the&#160;protected&#160;filesystem.</p>
<p style="position:absolute;top:439px;left:85px;white-space:nowrap" class="ft14440"><b>&#160;8&#160;&#160;PKCS#11&#160;library&#160;configuration</b></p>
<p style="position:absolute;top:469px;left:85px;white-space:nowrap" class="ft14417">A&#160;modified&#160;version&#160;of&#160;the&#160;library&#160;</p>
<p style="position:absolute;top:471px;left:357px;white-space:nowrap" class="ft14451">openCryptoki</p>
<p style="position:absolute;top:469px;left:476px;white-space:nowrap" class="ft14417">&#160;is&#160;distributed&#160;together&#160;with&#160;the&#160;KMA&#160;</p>
<p style="position:absolute;top:489px;left:85px;white-space:nowrap" class="ft14419">software.&#160;This&#160;allows&#160;using&#160;software&#160;tokens&#160;together&#160;with&#160;the&#160;protection&#160;offered&#160;by&#160;<br/>KMA.<br/>In&#160;a&#160;KMA-enabled&#160;system&#160;tokens&#160;are&#160;saved&#160;in&#160;the&#160;cryptographic&#160;filesystem;&#160;accesses&#160;<br/>to&#160;data&#160;files&#160;are&#160;controlled&#160;by&#160;the&#160;KMA&#160;mandatory&#160;access&#160;control&#160;mechanism&#160;and&#160;are&#160;<br/>granted&#160;depending&#160;on&#160;the&#160;policies&#160;configured&#160;by&#160;the&#160;Administrator.&#160;He&#160;decides,&#160;<br/>depending&#160;on&#160;the&#160;users&#160;of&#160;the&#160;platform,&#160;the&#160;applications&#160;installed&#160;and&#160;the&#160;security&#160;<br/>requirements&#160;he&#160;wants&#160;to&#160;apply,&#160;how&#160;many&#160;tokens&#160;will&#160;be&#160;assigned&#160;to&#160;each&#160;user&#160;and&#160;<br/>how&#160;they&#160;will&#160;be&#160;accessed.&#160;Typical&#160;configurations&#160;are:</p>
<p style="position:absolute;top:665px;left:112px;white-space:nowrap" class="ft14412">●</p>
<p style="position:absolute;top:661px;left:139px;white-space:nowrap" class="ft14419">One&#160;token&#160;assigned&#160;to&#160;each&#160;user,&#160;accessible&#160;to&#160;all&#160;or&#160;a&#160;subset&#160;of&#160;PKCS#11&#160;<br/>enabled&#160;applications;</p>
<p style="position:absolute;top:713px;left:112px;white-space:nowrap" class="ft14412">●</p>
<p style="position:absolute;top:708px;left:139px;white-space:nowrap" class="ft14419">Two&#160;tokens:&#160;one&#160;for&#160;applications&#160;that&#160;require&#160;an&#160;high&#160;security&#160;level&#160;and&#160;one&#160;for&#160;<br/>all&#160;other&#160;applications;</p>
<p style="position:absolute;top:760px;left:112px;white-space:nowrap" class="ft14412">●</p>
<p style="position:absolute;top:756px;left:139px;white-space:nowrap" class="ft14417">Multiple&#160;tokens.</p>
<p style="position:absolute;top:802px;left:92px;white-space:nowrap" class="ft14416"><b>&#160;8.1&#160;&#160;Token&#160;configuration&#160;–&#160;Administrator&#160;side</b></p>
<p style="position:absolute;top:830px;left:85px;white-space:nowrap" class="ft14417">The&#160;data&#160;backend&#160;of&#160;each&#160;token&#160;is&#160;stored&#160;in&#160;a&#160;directory&#160;under&#160;the&#160;path&#160;</p>
<p style="position:absolute;top:851px;left:85px;white-space:nowrap" class="ft14451">/var/lib/openCryptoki/swtok</p>
<p style="position:absolute;top:849px;left:353px;white-space:nowrap" class="ft14417">.&#160;The&#160;Administrator&#160;must&#160;define&#160;the&#160;directory&#160;name&#160;</p>
<p style="position:absolute;top:870px;left:85px;white-space:nowrap" class="ft14419">and&#160;a&#160;filesystem&#160;policy&#160;which&#160;will&#160;be&#160;valid&#160;for&#160;all&#160;users.&#160;These&#160;steps&#160;must&#160;be&#160;<br/>performed&#160;(as&#160;alternative&#160;for&#160;the&#160;steps&#160;in&#160;the&#160;following&#160;which&#160;require&#160;manual&#160;editing&#160;of&#160;<br/>configuration&#160;files,&#160;it&#160;is&#160;possible&#160;to&#160;append&#160;the&#160;content&#160;of&#160;the&#160;files&#160;with&#160;suffix&#160;&#34;.pkcs11&#34;&#160;<br/>present&#160;in&#160;</p>
<p style="position:absolute;top:929px;left:174px;white-space:nowrap" class="ft14451">/etc/kma/sample_config</p>
<p style="position:absolute;top:927px;left:392px;white-space:nowrap" class="ft14417">&#160;to&#160;the&#160;files&#160;with&#160;the&#160;same&#160;name&#160;in&#160;</p>
<p style="position:absolute;top:929px;left:685px;white-space:nowrap" class="ft14451">/etc/kma</p>
<p style="position:absolute;top:927px;left:764px;white-space:nowrap" class="ft14417">):</p>
<p style="position:absolute;top:956px;left:112px;white-space:nowrap" class="ft14425">1.&#160;Start&#160;the&#160;system&#160;in&#160;learning&#160;mode;<br/>2.&#160;Install&#160;these&#160;packages&#160;from&#160;the&#160;configured&#160;KMA&#160;repository:&#160;</p>
<p style="position:absolute;top:986px;left:635px;white-space:nowrap" class="ft14451">openCryptoki_kma</p>
<p style="position:absolute;top:985px;left:794px;white-space:nowrap" class="ft14417">,&#160;</p>
<p style="position:absolute;top:1006px;left:139px;white-space:nowrap" class="ft14451">openCryptoki_kma-32bit</p>
<p style="position:absolute;top:1005px;left:357px;white-space:nowrap" class="ft14417">,&#160;</p>
<p style="position:absolute;top:1006px;left:368px;white-space:nowrap" class="ft14451">MozillaFirefox-bin</p>
<p style="position:absolute;top:1005px;left:546px;white-space:nowrap" class="ft14417">;&#160;confirm&#160;the&#160;deletion&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:1025px;left:139px;white-space:nowrap" class="ft14417">existent&#160;packages&#160;if&#160;installed:&#160;</p>
<p style="position:absolute;top:1027px;left:392px;white-space:nowrap" class="ft14451">openCryptoki</p>
<p style="position:absolute;top:1025px;left:510px;white-space:nowrap" class="ft14417">,&#160;</p>
<p style="position:absolute;top:1027px;left:521px;white-space:nowrap" class="ft14451">openCryptoki-32bit</p>
<p style="position:absolute;top:1025px;left:699px;white-space:nowrap" class="ft14417">,&#160;</p>
<p style="position:absolute;top:1047px;left:139px;white-space:nowrap" class="ft14451">MozillaFirefox</p>
<p style="position:absolute;top:1045px;left:278px;white-space:nowrap" class="ft14417">;</p>
<p style="position:absolute;top:1075px;left:139px;white-space:nowrap" class="ft14417">1.&#160;Add&#160;these&#160;records&#160;in&#160;the&#160;file&#160;</p>
<p style="position:absolute;top:1076px;left:405px;white-space:nowrap" class="ft14451">/etc/kma/signed_binaries</p>
<p style="position:absolute;top:1075px;left:643px;white-space:nowrap" class="ft14417">:</p>
<p style="position:absolute;top:1104px;left:166px;white-space:nowrap" class="ft14417">1.</p>
<p style="position:absolute;top:1105px;left:193px;white-space:nowrap" class="ft14451">/opt/firefox-&lt;version&gt;/firefox-bin</p>
<p style="position:absolute;top:1105px;left:564px;white-space:nowrap" class="ft14451">0</p>
<p style="position:absolute;top:1105px;left:617px;white-space:nowrap" class="ft14451">&lt;TAG&gt;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft14421">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft14421">30/35</p>
</div>
<!-- Page 145 -->
<a name="145"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page145-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3145.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1459">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft14550">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft14521">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:166px;white-space:nowrap" class="ft14517">2.</p>
<p style="position:absolute;top:151px;left:193px;white-space:nowrap" class="ft14551">/usr/sbin/pkcsconf</p>
<p style="position:absolute;top:151px;left:564px;white-space:nowrap" class="ft14551">0</p>
<p style="position:absolute;top:151px;left:617px;white-space:nowrap" class="ft14551">&lt;TAG&gt;</p>
<p style="position:absolute;top:178px;left:139px;white-space:nowrap" class="ft14517">2.&#160;Define&#160;the&#160;filesystem&#160;policy&#160;for&#160;each&#160;token&#160;as&#160;described&#160;in&#160;the&#160;section&#160;4.4.&#160;It&#160;</p>
<p style="position:absolute;top:197px;left:166px;white-space:nowrap" class="ft14525">is&#160;recommended&#160;to&#160;assign&#160;at&#160;least&#160;one&#160;token&#160;to&#160;each&#160;user&#160;of&#160;the&#160;platform:<br/>1.&#160;Directory&#160;policy&#160;in&#160;</p>
<p style="position:absolute;top:227px;left:349px;white-space:nowrap" class="ft14551">/etc/kma/template.conf</p>
<p style="position:absolute;top:226px;left:567px;white-space:nowrap" class="ft14517">:&#160;the&#160;Administrator&#160;</p>
<p style="position:absolute;top:246px;left:193px;white-space:nowrap" class="ft14525">configures&#160;a&#160;protected&#160;directory&#160;for&#160;each&#160;token&#160;will&#160;be&#160;created.&#160;Each&#160;<br/>statement&#160;must&#160;contain:&#160;<br/>1.</p>
<p style="position:absolute;top:295px;left:220px;white-space:nowrap" class="ft14551">directory /system/opencryptoki/swtok/&lt;token dirname&gt; {</p>
<p style="position:absolute;top:322px;left:193px;white-space:nowrap" class="ft14517">2.</p>
<p style="position:absolute;top:324px;left:220px;white-space:nowrap" class="ft14551">bounddir&#160;/var/lib/opencryptoki/swtok/&lt;token dirname&gt;</p>
<p style="position:absolute;top:352px;left:193px;white-space:nowrap" class="ft14517">3.</p>
<p style="position:absolute;top:353px;left:220px;white-space:nowrap" class="ft14551">permission 775</p>
<p style="position:absolute;top:381px;left:193px;white-space:nowrap" class="ft14517">4.</p>
<p style="position:absolute;top:383px;left:220px;white-space:nowrap" class="ft14551">owner 0:&lt;GID of the pkcs11 group&gt;</p>
<p style="position:absolute;top:410px;left:193px;white-space:nowrap" class="ft14517">5.</p>
<p style="position:absolute;top:412px;left:220px;white-space:nowrap" class="ft14551">access_mask |&lt;tag of pkcsconf&gt;|&lt;UID&gt;|</p>
<p style="position:absolute;top:439px;left:193px;white-space:nowrap" class="ft14517">6.</p>
<p style="position:absolute;top:441px;left:220px;white-space:nowrap" class="ft14551">access_mask |&lt;tag of firefox&gt;|&lt;UID&gt;|</p>
<p style="position:absolute;top:469px;left:193px;white-space:nowrap" class="ft14517">7.</p>
<p style="position:absolute;top:470px;left:220px;white-space:nowrap" class="ft14551">policyfile /root/etc/kma/pkcs11_users_config</p>
<p style="position:absolute;top:498px;left:193px;white-space:nowrap" class="ft14517">8.</p>
<p style="position:absolute;top:500px;left:220px;white-space:nowrap" class="ft14551">}</p>
<p style="position:absolute;top:527px;left:166px;white-space:nowrap" class="ft14517">2.&#160;File&#160;policy&#160;</p>
<p style="position:absolute;top:529px;left:281px;white-space:nowrap" class="ft14551">/root/etc/kma/pkcs11_users_config</p>
<p style="position:absolute;top:556px;left:193px;white-space:nowrap" class="ft14517">1.</p>
<p style="position:absolute;top:558px;left:220px;white-space:nowrap" class="ft14551">file * {</p>
<p style="position:absolute;top:586px;left:193px;white-space:nowrap" class="ft14517">2.</p>
<p style="position:absolute;top:587px;left:220px;white-space:nowrap" class="ft14551">|XXXX|$UID|</p>
<p style="position:absolute;top:587px;left:404px;white-space:nowrap" class="ft14551">c</p>
<p style="position:absolute;top:615px;left:193px;white-space:nowrap" class="ft14517">3.</p>
<p style="position:absolute;top:617px;left:220px;white-space:nowrap" class="ft14551">|XXXX|$UID|</p>
<p style="position:absolute;top:617px;left:404px;white-space:nowrap" class="ft14551">rw</p>
<p style="position:absolute;top:644px;left:193px;white-space:nowrap" class="ft14517">4.</p>
<p style="position:absolute;top:646px;left:220px;white-space:nowrap" class="ft14551">}</p>
<p style="position:absolute;top:673px;left:112px;white-space:nowrap" class="ft14517">3.&#160;Set&#160;the&#160;</p>
<p style="position:absolute;top:675px;left:204px;white-space:nowrap" class="ft14551">pkcsslotd</p>
<p style="position:absolute;top:673px;left:293px;white-space:nowrap" class="ft14517">&#160;service&#160;to&#160;be&#160;executed&#160;at&#160;system&#160;startup:</p>
<p style="position:absolute;top:703px;left:139px;white-space:nowrap" class="ft14517">1.&#160;Open&#160;</p>
<p style="position:absolute;top:704px;left:216px;white-space:nowrap" class="ft14551">YaST/System/System Services (Runlevel)</p>
<p style="position:absolute;top:703px;left:592px;white-space:nowrap" class="ft14517">;</p>
<p style="position:absolute;top:732px;left:139px;white-space:nowrap" class="ft14517">2.&#160;Select&#160;the&#160;entry&#160;</p>
<p style="position:absolute;top:734px;left:304px;white-space:nowrap" class="ft14551">pkcsslotd</p>
<p style="position:absolute;top:732px;left:393px;white-space:nowrap" class="ft14517">;</p>
<p style="position:absolute;top:761px;left:139px;white-space:nowrap" class="ft14517">3.&#160;Click&#160;on&#160;the&#160;button&#160;</p>
<p style="position:absolute;top:763px;left:329px;white-space:nowrap" class="ft14551">Enable;</p>
<p style="position:absolute;top:790px;left:139px;white-space:nowrap" class="ft14517">4.&#160;Confirm&#160;the&#160;operation;</p>
<p style="position:absolute;top:819px;left:112px;white-space:nowrap" class="ft14517">4.&#160;Execute&#160;the&#160;utility&#160;</p>
<p style="position:absolute;top:820px;left:296px;white-space:nowrap" class="ft14551">init_masterkey.sh</p>
<p style="position:absolute;top:819px;left:464px;white-space:nowrap" class="ft14517">&#160;(stop&#160;Trousers:&#160;</p>
<p style="position:absolute;top:820px;left:599px;white-space:nowrap" class="ft14551">service tcsd stop</p>
<p style="position:absolute;top:819px;left:767px;white-space:nowrap" class="ft14517">);</p>
<p style="position:absolute;top:848px;left:139px;white-space:nowrap" class="ft14525">1.&#160;Delete&#160;the&#160;old&#160;MasterKey&#160;(confirm&#160;when&#160;requested);<br/>2.&#160;Enter&#160;the&#160;Administrator&#160;password&#160;(and&#160;the&#160;SRK&#160;password,&#160;if&#160;requested);<br/>3.&#160;Set&#160;a&#160;new&#160;label&#160;(TPM&#160;v1.2&#160;only);</p>
<p style="position:absolute;top:933px;left:112px;white-space:nowrap" class="ft14517">5.&#160;Execute&#160;the&#160;utility&#160;</p>
<p style="position:absolute;top:934px;left:296px;white-space:nowrap" class="ft14551">kma_write_nv</p>
<p style="position:absolute;top:933px;left:414px;white-space:nowrap" class="ft14517">&#160;(TPM&#160;v1.2&#160;only&#160;-&#160;start&#160;Trousers:&#160;</p>
<p style="position:absolute;top:934px;left:684px;white-space:nowrap" class="ft14551">service tcsd&#160;</p>
<p style="position:absolute;top:954px;left:139px;white-space:nowrap" class="ft14551">start</p>
<p style="position:absolute;top:953px;left:189px;white-space:nowrap" class="ft14517">);</p>
<p style="position:absolute;top:982px;left:139px;white-space:nowrap" class="ft14525">1.&#160;Enter&#160;the&#160;secret&#160;associated&#160;to&#160;the&#160;NV&#160;storage&#160;portion;<br/>2.&#160;Write&#160;the&#160;same&#160;label&#160;specified&#160;when&#160;updating&#160;the&#160;MasterKey;</p>
<p style="position:absolute;top:1038px;left:112px;white-space:nowrap" class="ft14517">6.&#160;Certify&#160;the&#160;new&#160;applications&#160;installed&#160;by&#160;executing&#160;the&#160;command:&#160;</p>
<p style="position:absolute;top:1067px;left:139px;white-space:nowrap" class="ft14517">1.</p>
<p style="position:absolute;top:1068px;left:166px;white-space:nowrap" class="ft14551">certbin --list /etc/kma/signed_binaries&#160;</p>
<p style="position:absolute;top:1096px;left:112px;white-space:nowrap" class="ft14517">7.&#160;Execute&#160;the&#160;learning&#160;of&#160;</p>
<p style="position:absolute;top:1097px;left:337px;white-space:nowrap" class="ft14551">firefox</p>
<p style="position:absolute;top:1096px;left:407px;white-space:nowrap" class="ft14517">:&#160;the&#160;operations&#160;described&#160;in&#160;the&#160;section&#160;8.3&#160;</p>
<p style="position:absolute;top:1116px;left:139px;white-space:nowrap" class="ft14517">“</p>
<p style="position:absolute;top:1118px;left:148px;white-space:nowrap" class="ft14551">Installing software token in firefox</p>
<p style="position:absolute;top:1116px;left:504px;white-space:nowrap" class="ft14517">”&#160;must&#160;be&#160;performed&#160;with&#160;root&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft14521">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft14521">31/35</p>
</div>
<!-- Page 146 -->
<a name="146"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page146-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3146.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1469">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft14650">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft14621">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:139px;white-space:nowrap" class="ft14617">privilege;</p>
<p style="position:absolute;top:177px;left:112px;white-space:nowrap" class="ft14617">8.&#160;Execute&#160;the&#160;utility&#160;</p>
<p style="position:absolute;top:179px;left:296px;white-space:nowrap" class="ft14651">pkcsconf</p>
<p style="position:absolute;top:177px;left:375px;white-space:nowrap" class="ft14617">&#160;without&#160;parameters:&#160;it&#160;server&#160;just&#160;for&#160;KMA&#160;to&#160;learn&#160;</p>
<p style="position:absolute;top:197px;left:139px;white-space:nowrap" class="ft14617">about&#160;the&#160;libraries&#160;the&#160;utility&#160;depends&#160;on</p>
<p style="position:absolute;top:199px;left:477px;white-space:nowrap" class="ft14651">;</p>
<p style="position:absolute;top:227px;left:112px;white-space:nowrap" class="ft14617">9.&#160;Create&#160;the&#160;</p>
<p style="position:absolute;top:228px;left:232px;white-space:nowrap" class="ft14651">/etc/kma/pkcs11_mapping</p>
<p style="position:absolute;top:227px;left:460px;white-space:nowrap" class="ft14617">&#160;file:</p>
<p style="position:absolute;top:256px;left:139px;white-space:nowrap" class="ft14625">1.&#160;Assign&#160;a&#160;different&#160;profile&#160;name&#160;to&#160;each&#160;token&#160;assigned&#160;to&#160;a&#160;user;&#160;<br/>2.&#160;For&#160;each&#160;user&#160;and&#160;profile&#160;write&#160;as&#160;many&#160;records&#160;as&#160;the&#160;access&#160;vectors&#160;listed&#160;</p>
<p style="position:absolute;top:303px;left:166px;white-space:nowrap" class="ft14625">in&#160;the&#160;directory&#160;policy&#160;like&#160;this:&#160;<br/>1.</p>
<p style="position:absolute;top:333px;left:193px;white-space:nowrap" class="ft14651">PROFILE_NAME</p>
<p style="position:absolute;top:333px;left:351px;white-space:nowrap" class="ft14651">access vector</p>
<p style="position:absolute;top:333px;left:511px;white-space:nowrap" class="ft14651">token_directory&#160;</p>
<p style="position:absolute;top:361px;left:112px;white-space:nowrap" class="ft14617">10.Review&#160;libraries&#160;loaded&#160;by&#160;the&#160;new&#160;certified&#160;applications,&#160;executing&#160;the&#160;</p>
<p style="position:absolute;top:380px;left:139px;white-space:nowrap" class="ft14617">command&#160;</p>
<p style="position:absolute;top:382px;left:227px;white-space:nowrap" class="ft14651">kma_mmap_db /etc/kma/logs/mmap_list</p>
<p style="position:absolute;top:380px;left:573px;white-space:nowrap" class="ft14617">&#160;(for&#160;all&#160;details&#160;see&#160;step&#160;9&#160;in&#160;</p>
<p style="position:absolute;top:400px;left:139px;white-space:nowrap" class="ft14625">section&#160;4.12.1):<br/>1.&#160;Type&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:430px;left:332px;white-space:nowrap" class="ft14651">verify</p>
<p style="position:absolute;top:428px;left:391px;white-space:nowrap" class="ft14617">;</p>
<p style="position:absolute;top:458px;left:139px;white-space:nowrap" class="ft14617">2.&#160;Replace&#160;the&#160;database&#160;</p>
<p style="position:absolute;top:459px;left:352px;white-space:nowrap" class="ft14651">/etc/kma/logs/mmap_list</p>
<p style="position:absolute;top:458px;left:579px;white-space:nowrap" class="ft14617">&#160;if&#160;modified;</p>
<p style="position:absolute;top:487px;left:112px;white-space:nowrap" class="ft14617">11.Restart&#160;the&#160;system&#160;in&#160;learning&#160;mode</p>
<p style="position:absolute;top:515px;left:139px;white-space:nowrap" class="ft14617">1.&#160;Execute&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:517px;left:358px;white-space:nowrap" class="ft14651">dmesg | more</p>
<p style="position:absolute;top:515px;left:477px;white-space:nowrap" class="ft14617">&#160;and&#160;verify&#160;that&#160;the&#160;message&#160;“</p>
<p style="position:absolute;top:517px;left:729px;white-space:nowrap" class="ft14651">Failed&#160;</p>
<p style="position:absolute;top:537px;left:166px;white-space:nowrap" class="ft14651">to initialize protected filesystem</p>
<p style="position:absolute;top:535px;left:503px;white-space:nowrap" class="ft14617">”&#160;doesn't&#160;appear;</p>
<p style="position:absolute;top:565px;left:139px;white-space:nowrap" class="ft14617">2.&#160;In&#160;case&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:566px;left:284px;white-space:nowrap" class="ft14651">openCryptoki</p>
<p style="position:absolute;top:565px;left:402px;white-space:nowrap" class="ft14617">&#160;library&#160;has&#160;previously&#160;installed&#160;and&#160;tokens&#160;</p>
<p style="position:absolute;top:585px;left:166px;white-space:nowrap" class="ft14617">were&#160;created&#160;start&#160;the&#160;command&#160;</p>
<p style="position:absolute;top:586px;left:444px;white-space:nowrap" class="ft14651">kma_makesecure.sh&#160;</p>
<p style="position:absolute;top:605px;left:166px;white-space:nowrap" class="ft14651">/etc/kma/files_saved &lt;output file&gt;;</p>
<p style="position:absolute;top:633px;left:112px;white-space:nowrap" class="ft14617">12.Add&#160;each&#160;user&#160;allowed&#160;to&#160;access&#160;the&#160;PKCS#11&#160;library&#160;in&#160;the&#160;“</p>
<p style="position:absolute;top:634px;left:649px;white-space:nowrap" class="ft14651">pkcs11</p>
<p style="position:absolute;top:633px;left:709px;white-space:nowrap" class="ft14617">”&#160;group&#160;</p>
<p style="position:absolute;top:653px;left:139px;white-space:nowrap" class="ft14617">(modify&#160;the&#160;file&#160;</p>
<p style="position:absolute;top:655px;left:270px;white-space:nowrap" class="ft14651">/etc/groups</p>
<p style="position:absolute;top:653px;left:379px;white-space:nowrap" class="ft14617">&#160;with&#160;superuser&#160;privileges);</p>
<p style="position:absolute;top:682px;left:112px;white-space:nowrap" class="ft14617">13.Add&#160;created&#160;filesystem&#160;policy&#160;files&#160;to&#160;</p>
<p style="position:absolute;top:684px;left:450px;white-space:nowrap" class="ft14651">/etc/kma/checkfilelist</p>
<p style="position:absolute;top:712px;left:139px;white-space:nowrap" class="ft14617">1.</p>
<p style="position:absolute;top:713px;left:166px;white-space:nowrap" class="ft14651">/etc/kma/pkcs11_users_config</p>
<p style="position:absolute;top:741px;left:139px;white-space:nowrap" class="ft14617">2.</p>
<p style="position:absolute;top:742px;left:166px;white-space:nowrap" class="ft14651">/etc/kma/pkcs11_mapping</p>
<p style="position:absolute;top:770px;left:112px;white-space:nowrap" class="ft14617">14.Restart&#160;the&#160;sealing&#160;procedure,&#160;i.e.&#160;reboot&#160;in&#160;enforcing&#160;mode&#160;and&#160;after&#160;the&#160;</p>
<p style="position:absolute;top:789px;left:139px;white-space:nowrap" class="ft14617">sealing&#160;is&#160;done,&#160;reboot&#160;again&#160;in&#160;enforcing&#160;mode.</p>
<p style="position:absolute;top:835px;left:92px;white-space:nowrap" class="ft14616"><b>&#160;8.2&#160;&#160;Token&#160;configuration&#160;–&#160;User&#160;side</b></p>
<p style="position:absolute;top:864px;left:85px;white-space:nowrap" class="ft14619">Each&#160;user&#160;is&#160;assigned&#160;a&#160;number&#160;of&#160;tokens,&#160;depending&#160;on&#160;the&#160;filesystem&#160;policy&#160;defined&#160;<br/>by&#160;the&#160;Administrator.&#160;To&#160;easy&#160;identify&#160;a&#160;particular&#160;token&#160;a&#160;profile&#160;name&#160;is&#160;assigned.&#160;<br/>The&#160;user&#160;can&#160;discover&#160;and&#160;setup&#160;its&#160;tokens&#160;by&#160;running&#160;the&#160;utility&#160;</p>
<p style="position:absolute;top:904px;left:624px;white-space:nowrap" class="ft14651">kma_pkcs11_conf</p>
<p style="position:absolute;top:902px;left:773px;white-space:nowrap" class="ft14617">.</p>
<p style="position:absolute;top:931px;left:85px;white-space:nowrap" class="ft14619">The&#160;initialization&#160;consists&#160;of&#160;setting&#160;two&#160;passwords&#160;(PINs&#160;in&#160;PKCS#11&#160;slang):&#160;the&#160;first&#160;<br/>one&#160;is&#160;called&#160;Security&#160;Officer&#160;(SO)&#160;PIN&#160;(the&#160;hardcoded&#160;default&#160;PIN&#160;will&#160;be&#160;changed)&#160;and&#160;<br/>allows&#160;access&#160;to&#160;token&#160;administration&#160;functions,&#160;otherwise&#160;the&#160;User&#160;PIN&#160;allows&#160;the&#160;<br/>access&#160;to&#160;the&#160;token's&#160;data.&#160;When&#160;a&#160;software&#160;token&#160;is&#160;initialized&#160;a&#160;master&#160;key&#160;for&#160;each&#160;<br/>PIN&#160;is&#160;generated&#160;in&#160;order&#160;to&#160;protect&#160;the&#160;objects&#160;stored&#160;in&#160;that&#160;software&#160;device.&#160;A&#160;<br/>typical&#160;output&#160;of&#160;the&#160;script&#160;is:</p>
<p style="position:absolute;top:1060px;left:89px;white-space:nowrap" class="ft14656"><b>Entry ID&#160;Profile name&#160;Dirname</b></p>
<p style="position:absolute;top:1060px;left:491px;white-space:nowrap" class="ft14656"><b>Pathname</b></p>
<p style="position:absolute;top:1096px;left:89px;white-space:nowrap" class="ft14651">1</p>
<p style="position:absolute;top:1096px;left:177px;white-space:nowrap" class="ft14651">DEFAULT</p>
<p style="position:absolute;top:1096px;left:308px;white-space:nowrap" class="ft14651">root.token1</p>
<p style="position:absolute;top:1096px;left:491px;white-space:nowrap" class="ft14651">/opt/firefox-3.0.10/firefox-bin</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft14621">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft14621">32/35</p>
</div>
<!-- Page 147 -->
<a name="147"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page147-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3147.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1479">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft14750">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft14721">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:153px;left:89px;white-space:nowrap" class="ft14751">2</p>
<p style="position:absolute;top:153px;left:177px;white-space:nowrap" class="ft14751">DEFAULT</p>
<p style="position:absolute;top:153px;left:308px;white-space:nowrap" class="ft14751">root.token1</p>
<p style="position:absolute;top:153px;left:491px;white-space:nowrap" class="ft14751">/usr/sbin/pkcsconf</p>
<p style="position:absolute;top:213px;left:85px;white-space:nowrap" class="ft14719">The&#160;first&#160;column&#160;specifies&#160;a&#160;cardinal&#160;number&#160;to&#160;identify&#160;the&#160;record,&#160;the&#160;second&#160;column&#160;<br/>specifies&#160;the&#160;profile&#160;name&#160;assigned&#160;to&#160;each&#160;user's&#160;token,&#160;the&#160;third&#160;contains&#160;the&#160;target&#160;<br/>directory&#160;in&#160;the&#160;path&#160;</p>
<p style="position:absolute;top:253px;left:260px;white-space:nowrap" class="ft14751">/var/lib/opencryptoki/swtok</p>
<p style="position:absolute;top:252px;left:527px;white-space:nowrap" class="ft14717">,&#160;the&#160;fourth&#160;specifies&#160;the&#160;</p>
<p style="position:absolute;top:272px;left:85px;white-space:nowrap" class="ft14725">application&#160;allowed&#160;to&#160;use&#160;it.<br/>Conditions&#160;necessary&#160;for&#160;using&#160;a&#160;token&#160;are:</p>
<p style="position:absolute;top:328px;left:112px;white-space:nowrap" class="ft14725">1.&#160;the&#160;platform&#160;is&#160;running&#160;the&#160;KMA&#160;services&#160;;<br/>2.&#160;the&#160;integrity&#160;of&#160;the&#160;platform&#160;has&#160;been&#160;verified&#160;by&#160;the&#160;unsealing&#160;procedure;<br/>3.&#160;the&#160;application&#160;accessing&#160;it&#160;is&#160;certified;<br/>4.&#160;the&#160;filesystem&#160;policy&#160;of&#160;the&#160;token&#160;directory&#160;has&#160;been&#160;defined&#160;by&#160;the&#160;</p>
<p style="position:absolute;top:432px;left:139px;white-space:nowrap" class="ft14717">Administrator&#160;and&#160;it&#160;is&#160;enforced.</p>
<p style="position:absolute;top:460px;left:85px;white-space:nowrap" class="ft14717">Steps&#160;executed&#160;by&#160;the&#160;user:</p>
<p style="position:absolute;top:489px;left:112px;white-space:nowrap" class="ft14717">1.&#160;start&#160;the&#160;initialization&#160;script&#160;</p>
<p style="position:absolute;top:490px;left:372px;white-space:nowrap" class="ft14751">kma_pkcs11_conf;</p>
<p style="position:absolute;top:518px;left:112px;white-space:nowrap" class="ft14717">2.&#160;select&#160;the&#160;token&#160;by&#160;typing&#160;its&#160;identification&#160;number&#160;(select&#160;one&#160;entry&#160;for&#160;each&#160;</p>
<p style="position:absolute;top:537px;left:139px;white-space:nowrap" class="ft14725">profile)<br/>1.&#160;NOTE:&#160;if&#160;the&#160;token&#160;is&#160;already&#160;initialized&#160;the&#160;user&#160;is&#160;asked&#160;if&#160;he/she&#160;want&#160;to&#160;</p>
<p style="position:absolute;top:584px;left:166px;white-space:nowrap" class="ft14719">reinitialize&#160;it.&#160;In&#160;that&#160;case&#160;it's&#160;possible&#160;reinitialize&#160;typing&#160;YES&#160;(in&#160;capital&#160;<br/>letters)&#160;and&#160;pressing&#160;&lt;ENTER&gt;.&#160;If&#160;you&#160;do&#160;not&#160;want&#160;to&#160;reinitialize&#160;the&#160;token&#160;<br/>type&#160;NO&#160;and&#160;then&#160;press&#160;&lt;ENTER&gt;,&#160;the&#160;procedure&#160;will&#160;finish&#160;at&#160;this&#160;step.</p>
<p style="position:absolute;top:651px;left:112px;white-space:nowrap" class="ft14717">3.&#160;set&#160;a&#160;new&#160;label&#160;for&#160;this&#160;soft-token</p>
<p style="position:absolute;top:679px;left:139px;white-space:nowrap" class="ft14717">1.&#160;insert&#160;the&#160;default&#160;SO&#160;PIN&#160;</p>
<p style="position:absolute;top:679px;left:375px;white-space:nowrap" class="ft14716"><b>87654321</b></p>
<p style="position:absolute;top:679px;left:467px;white-space:nowrap" class="ft14717">&#160;upon&#160;request&#160;and&#160;press&#160;&lt;ENTER&gt;</p>
<p style="position:absolute;top:707px;left:139px;white-space:nowrap" class="ft14717">2.&#160;insert&#160;a&#160;label&#160;that&#160;identifies&#160;this&#160;token&#160;and&#160;press&#160;&lt;ENTER&gt;</p>
<p style="position:absolute;top:736px;left:112px;white-space:nowrap" class="ft14717">4.&#160;change&#160;the&#160;SO&#160;PIN</p>
<p style="position:absolute;top:764px;left:139px;white-space:nowrap" class="ft14717">1.&#160;insert&#160;the&#160;default&#160;SO&#160;PIN&#160;</p>
<p style="position:absolute;top:764px;left:375px;white-space:nowrap" class="ft14716"><b>87654321</b></p>
<p style="position:absolute;top:764px;left:467px;white-space:nowrap" class="ft14717">&#160;upon&#160;request&#160;and&#160;press&#160;&lt;ENTER&gt;</p>
<p style="position:absolute;top:792px;left:139px;white-space:nowrap" class="ft14725">2.&#160;insert&#160;a&#160;new&#160;SO&#160;PIN&#160;upon&#160;request&#160;and&#160;press&#160;&lt;ENTER&gt;<br/>3.&#160;re-insert&#160;the&#160;SO&#160;PIN&#160;upon&#160;request&#160;and&#160;press&#160;&lt;ENTER&gt;</p>
<p style="position:absolute;top:848px;left:112px;white-space:nowrap" class="ft14717">5.&#160;set&#160;the&#160;User&#160;PIN</p>
<p style="position:absolute;top:877px;left:139px;white-space:nowrap" class="ft14725">1.&#160;insert&#160;the&#160;chosen&#160;SO&#160;PIN&#160;upon&#160;request&#160;and&#160;press&#160;&lt;ENTER&gt;<br/>2.&#160;insert&#160;a&#160;new&#160;User&#160;PIN&#160;upon&#160;request&#160;and&#160;press&#160;&lt;ENTER&gt;<br/>3.&#160;re-insert&#160;the&#160;User&#160;PIN&#160;upon&#160;request&#160;and&#160;press&#160;&lt;ENTER&gt;</p>
<p style="position:absolute;top:961px;left:112px;white-space:nowrap" class="ft14717">6.&#160;set&#160;up&#160;the&#160;user&#160;file&#160;</p>
<p style="position:absolute;top:963px;left:300px;white-space:nowrap" class="ft14751">$HOME/.profile</p>
<p style="position:absolute;top:961px;left:438px;white-space:nowrap" class="ft14717">&#160;by&#160;adding&#160;the&#160;line&#160;at&#160;the&#160;end&#160;(this&#160;will&#160;be&#160;</p>
<p style="position:absolute;top:981px;left:139px;white-space:nowrap" class="ft14725">valid&#160;at&#160;the&#160;next&#160;user&#160;login):<br/>1.</p>
<p style="position:absolute;top:1011px;left:166px;white-space:nowrap" class="ft14751">export TOKENPROFILE=&lt;profile to use&gt;</p>
<p style="position:absolute;top:1010px;left:523px;white-space:nowrap" class="ft14717">&#160;(e.g.&#160;DEFAULT)</p>
<p style="position:absolute;top:1057px;left:92px;white-space:nowrap" class="ft14716"><b>&#160;8.3&#160;&#160;Install&#160;software&#160;token&#160;in&#160;Firefox</b></p>
<p style="position:absolute;top:1085px;left:112px;white-space:nowrap" class="ft14725">1.&#160;start&#160;Mozilla&#160;Firefox;<br/>2.&#160;click&#160;on&#160;the&#160;“Edit”&#160;button&#160;and&#160;select&#160;“Preferences”,&#160;a&#160;window&#160;with&#160;that&#160;title&#160;will&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft14721">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft14721">33/35</p>
</div>
<!-- Page 148 -->
<a name="148"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page148-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3148.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1489">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft14850">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft14821">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:139px;white-space:nowrap" class="ft14817">be&#160;opened;</p>
<p style="position:absolute;top:177px;left:112px;white-space:nowrap" class="ft14817">3.&#160;select&#160;the&#160;tab&#160;“Advanced/Encryption”&#160;and&#160;then&#160;click&#160;on&#160;the&#160;button&#160;“Security&#160;</p>
<p style="position:absolute;top:196px;left:139px;white-space:nowrap" class="ft14817">Devices”,&#160;a&#160;window&#160;called&#160;“Device&#160;Manager”&#160;will&#160;be&#160;opened;</p>
<p style="position:absolute;top:225px;left:112px;white-space:nowrap" class="ft14825">4.&#160;click&#160;on&#160;the&#160;button&#160;“Load”,&#160;a&#160;box&#160;called&#160;“New&#160;PKCS#11&#160;Module”&#160;will&#160;be&#160;opened;<br/>5.&#160;change&#160;the&#160;default&#160;Module&#160;Name&#160;(e.g.&#160;into&#160;“KMA-protected”);</p>
<p style="position:absolute;top:281px;left:139px;white-space:nowrap" class="ft14817">1.&#160;insert&#160;in&#160;the&#160;“Module&#160;filename”&#160;field&#160;the&#160;string&#160;</p>
<p style="position:absolute;top:302px;left:166px;white-space:nowrap" class="ft14851">/usr/lib/pkcs11/PKCS11_API.so&#160;</p>
<p style="position:absolute;top:300px;left:463px;white-space:nowrap" class="ft14817">[or&#160;search&#160;it&#160;using&#160;the&#160;button&#160;Browse]</p>
<p style="position:absolute;top:329px;left:139px;white-space:nowrap" class="ft14817">2.&#160;confirm&#160;the&#160;operation&#160;clicking&#160;OK&#160;in&#160;order&#160;to&#160;close&#160;the&#160;windows</p>
<p style="position:absolute;top:376px;left:92px;white-space:nowrap" class="ft14816"><b>&#160;8.4&#160;&#160;Test&#160;and&#160;use&#160;the&#160;software&#160;token&#160;with&#160;Firefox</b></p>
<p style="position:absolute;top:404px;left:112px;white-space:nowrap" class="ft14825">1.&#160;start&#160;Mozilla&#160;Firefox;<br/>2.&#160;click&#160;on&#160;the&#160;“Edit”&#160;button&#160;and&#160;select&#160;“Preferences”,&#160;a&#160;window&#160;with&#160;that&#160;title&#160;will&#160;</p>
<p style="position:absolute;top:451px;left:139px;white-space:nowrap" class="ft14817">be&#160;opened;</p>
<p style="position:absolute;top:479px;left:112px;white-space:nowrap" class="ft14817">3.&#160;select&#160;the&#160;tab&#160;“Advanced/Encryption”&#160;and&#160;then&#160;click&#160;on&#160;the&#160;button&#160;“Security&#160;</p>
<p style="position:absolute;top:499px;left:139px;white-space:nowrap" class="ft14817">Devices”,&#160;a&#160;window&#160;called&#160;“Device&#160;Manager”&#160;will&#160;be&#160;opened;</p>
<p style="position:absolute;top:527px;left:112px;white-space:nowrap" class="ft14817">4.&#160;click&#160;on&#160;the&#160;label&#160;previously&#160;entered&#160;(e.g.&#160;“KMA-protected”)&#160;and&#160;the&#160;on&#160;“IBM&#160;OS&#160;</p>
<p style="position:absolute;top:546px;left:139px;white-space:nowrap" class="ft14817">PKCS#11”;</p>
<p style="position:absolute;top:574px;left:112px;white-space:nowrap" class="ft14817">5.&#160;Then&#160;click&#160;on&#160;the&#160;button&#160;“Log&#160;in”&#160;and&#160;use&#160;the&#160;user&#160;PIN:&#160;if&#160;the&#160;login&#160;is&#160;successful,&#160;</p>
<p style="position:absolute;top:593px;left:139px;white-space:nowrap" class="ft14819">this&#160;means&#160;that&#160;the&#160;software&#160;token&#160;is&#160;working&#160;properly;&#160;it&#160;can&#160;be&#160;used&#160;for&#160;<br/>instance&#160;to&#160;create&#160;an&#160;asymmetric&#160;key&#160;pair&#160;and&#160;make&#160;a&#160;request&#160;for&#160;an&#160;X.509&#160;<br/>certificate;</p>
<p style="position:absolute;top:660px;left:112px;white-space:nowrap" class="ft14817">6.&#160;Use&#160;the&#160;standard&#160;</p>
<p style="position:absolute;top:662px;left:286px;white-space:nowrap" class="ft14851">pkcsconf</p>
<p style="position:absolute;top:660px;left:366px;white-space:nowrap" class="ft14817">&#160;(shipped&#160;with&#160;</p>
<p style="position:absolute;top:662px;left:488px;white-space:nowrap" class="ft14851">openCryptoki</p>
<p style="position:absolute;top:660px;left:607px;white-space:nowrap" class="ft14817">)&#160;to&#160;perform&#160;the&#160;</p>
<p style="position:absolute;top:680px;left:139px;white-space:nowrap" class="ft14817">management&#160;of&#160;the&#160;software&#160;token&#160;(see&#160;the&#160;related&#160;documentation&#160;for&#160;details).</p>
<p style="position:absolute;top:727px;left:85px;white-space:nowrap" class="ft14840"><b>&#160;9&#160;&#160;Glossary</b></p>
<p style="position:absolute;top:761px;left:112px;white-space:nowrap" class="ft14812">●</p>
<p style="position:absolute;top:758px;left:139px;white-space:nowrap" class="ft14851">Property</p>
<p style="position:absolute;top:756px;left:218px;white-space:nowrap" class="ft14817">:&#160;this&#160;is&#160;an&#160;information&#160;associated&#160;to&#160;a&#160;process&#160;or&#160;a&#160;system&#160;component&#160;</p>
<p style="position:absolute;top:777px;left:139px;white-space:nowrap" class="ft14817">that&#160;permits&#160;to&#160;identify&#160;it&#160;or&#160;to&#160;know&#160;its&#160;status;</p>
<p style="position:absolute;top:809px;left:112px;white-space:nowrap" class="ft14812">●</p>
<p style="position:absolute;top:806px;left:139px;white-space:nowrap" class="ft14851">Access vector</p>
<p style="position:absolute;top:805px;left:268px;white-space:nowrap" class="ft14817">:&#160;this&#160;is&#160;an&#160;object&#160;which&#160;stores&#160;properties&#160;values:&#160;each&#160;field&#160;is&#160;</p>
<p style="position:absolute;top:825px;left:139px;white-space:nowrap" class="ft14819">bound&#160;to&#160;a&#160;specific&#160;property&#160;(for&#160;example&#160;field&#160;0&#160;is&#160;bound&#160;to&#160;the&#160;&#34;TAG&#34;&#160;property,&#160;<br/>field&#160;1&#160;is&#160;bound&#160;to&#160;the&#160;&#34;UID&#34;&#160;property);</p>
<p style="position:absolute;top:877px;left:112px;white-space:nowrap" class="ft14812">●</p>
<p style="position:absolute;top:874px;left:139px;white-space:nowrap" class="ft14851">Access vector permission</p>
<p style="position:absolute;top:873px;left:377px;white-space:nowrap" class="ft14817">:&#160;this&#160;describes&#160;allowed&#160;operations&#160;that&#160;a&#160;subject&#160;</p>
<p style="position:absolute;top:893px;left:139px;white-space:nowrap" class="ft14819">identified&#160;by&#160;the&#160;access&#160;vector&#160;can&#160;do&#160;to&#160;a&#160;file&#160;(or&#160;a&#160;generic&#160;object):&#160;&#34;r&#34;&#160;for&#160;read,&#160;<br/>&#34;w&#34;&#160;for&#160;write,&#160;&#34;x&#34;&#160;for&#160;execution,&#160;&#34;a&#34;&#160;for&#160;append&#160;permission&#160;(combinations&#160;of&#160;<br/>these&#160;are&#160;possible);</p>
<p style="position:absolute;top:964px;left:112px;white-space:nowrap" class="ft14812">●</p>
<p style="position:absolute;top:961px;left:139px;white-space:nowrap" class="ft14851">Label</p>
<p style="position:absolute;top:959px;left:189px;white-space:nowrap" class="ft14817">:&#160;this&#160;element&#160;associated&#160;to&#160;an&#160;object&#160;(file&#160;or&#160;directory)&#160;contains&#160;a&#160;set&#160;of&#160;</p>
<p style="position:absolute;top:980px;left:139px;white-space:nowrap" class="ft14817">access&#160;vectors&#160;with&#160;their&#160;relative&#160;access&#160;vector&#160;permission;</p>
<p style="position:absolute;top:1012px;left:112px;white-space:nowrap" class="ft14812">●</p>
<p style="position:absolute;top:1009px;left:139px;white-space:nowrap" class="ft14851">Directory policy</p>
<p style="position:absolute;top:1008px;left:298px;white-space:nowrap" class="ft14817">:&#160;this&#160;is&#160;an&#160;object&#160;that&#160;contains&#160;the&#160;label&#160;associated&#160;to&#160;the&#160;</p>
<p style="position:absolute;top:1028px;left:139px;white-space:nowrap" class="ft14819">directory,&#160;the&#160;pathname&#160;of&#160;the&#160;file&#160;policy&#160;and&#160;other&#160;parameters&#160;used&#160;for&#160;<br/>management;</p>
<p style="position:absolute;top:1080px;left:112px;white-space:nowrap" class="ft14812">●</p>
<p style="position:absolute;top:1077px;left:139px;white-space:nowrap" class="ft14851">Protected directory</p>
<p style="position:absolute;top:1075px;left:327px;white-space:nowrap" class="ft14817">:&#160;this&#160;is&#160;a&#160;directory&#160;with&#160;a&#160;directory&#160;policy&#160;defined;</p>
<p style="position:absolute;top:1109px;left:112px;white-space:nowrap" class="ft14812">●</p>
<p style="position:absolute;top:1106px;left:139px;white-space:nowrap" class="ft14851">File policy</p>
<p style="position:absolute;top:1105px;left:248px;white-space:nowrap" class="ft14817">:&#160;set&#160;of&#160;labels&#160;to&#160;be&#160;applied&#160;for&#160;existent&#160;or&#160;newly&#160;created&#160;files&#160;in&#160;a&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft14821">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft14821">34/35</p>
</div>
<!-- Page 149 -->
<a name="149"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page149-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D03.3_Collection_of_internal_deliverables_Y3149.png" alt="background image"/>
<p style="position:absolute;top:126px;left:85px;white-space:nowrap" class="ft1499">&#160;</p>
<p style="position:absolute;top:85px;left:85px;white-space:nowrap" class="ft14950">&#160;</p>
<p style="position:absolute;top:91px;left:184px;white-space:nowrap" class="ft14921">WP03c.9&#160;Enhancement&#160;KMA&#160;service&#160;source&#160;code&#160;and&#160;documentation&#160;FINAL&#160;1.10</p>
<p style="position:absolute;top:149px;left:139px;white-space:nowrap" class="ft14917">protected&#160;directory.</p>
<p style="position:absolute;top:195px;left:85px;white-space:nowrap" class="ft14940"><b>&#160;10&#160;&#160;List&#160;of&#160;Abbreviations</b></p>
<p style="position:absolute;top:225px;left:85px;white-space:nowrap" class="ft14919">Listing&#160;of&#160;term&#160;definitions&#160;and&#160;abbreviations&#160;used&#160;in&#160;this&#160;document&#160;(IT&#160;expressions&#160;and&#160;<br/>terms&#160;from&#160;the&#160;application&#160;domain).</p>
<p style="position:absolute;top:273px;left:95px;white-space:nowrap" class="ft14916"><b>Abbreviation</b></p>
<p style="position:absolute;top:273px;left:302px;white-space:nowrap" class="ft14916"><b>Explanation</b></p>
<p style="position:absolute;top:292px;left:95px;white-space:nowrap" class="ft14917">KMA</p>
<p style="position:absolute;top:292px;left:302px;white-space:nowrap" class="ft14917">Key&#160;and&#160;data&#160;Management&#160;Adaptation&#160;layer</p>
<p style="position:absolute;top:311px;left:95px;white-space:nowrap" class="ft14917">SRK</p>
<p style="position:absolute;top:311px;left:302px;white-space:nowrap" class="ft14917">Storage&#160;Root&#160;Key</p>
<p style="position:absolute;top:330px;left:95px;white-space:nowrap" class="ft14917">NV&#160;storage</p>
<p style="position:absolute;top:330px;left:302px;white-space:nowrap" class="ft14917">Non&#160;Volatile&#160;storage</p>
<p style="position:absolute;top:350px;left:95px;white-space:nowrap" class="ft14917">TCG</p>
<p style="position:absolute;top:350px;left:302px;white-space:nowrap" class="ft14917">Trusted&#160;Computing&#160;Group</p>
<p style="position:absolute;top:369px;left:95px;white-space:nowrap" class="ft14917">TPM</p>
<p style="position:absolute;top:369px;left:302px;white-space:nowrap" class="ft14917">Trusted&#160;Platform&#160;Module</p>
<p style="position:absolute;top:388px;left:95px;white-space:nowrap" class="ft14917">TSS</p>
<p style="position:absolute;top:388px;left:302px;white-space:nowrap" class="ft14917">TCG&#160;Software&#160;Stack</p>
<p style="position:absolute;top:454px;left:85px;white-space:nowrap" class="ft14940"><b>&#160;11&#160;&#160;Related&#160;Work</b></p>
<p style="position:absolute;top:484px;left:85px;white-space:nowrap" class="ft14919">/1/&#160;TCG&#160;TPM&#160;Main&#160;Specification&#160;(parts&#160;1,2,3)<br/>July&#160;9,&#160;2007,<br/>Version&#160;1.2&#160;Level&#160;2&#160;Revision&#160;103</p>
<p style="position:absolute;top:561px;left:85px;white-space:nowrap" class="ft14919">/2/&#160;IETF&#160;RFC&#160;4251,&#160;The&#160;Secure&#160;Shell&#160;(SSH)&#160;Protocol&#160;Architecture<br/>January,&#160;2006</p>
<p style="position:absolute;top:618px;left:85px;white-space:nowrap" class="ft14919">/3/&#160;TCG&#160;Software&#160;Stack&#160;(TSS)&#160;Specification<br/>March&#160;7,&#160;2007,<br/>Version&#160;1.2,&#160;Level&#160;1,&#160;Errata&#160;A</p>
<p style="position:absolute;top:695px;left:85px;white-space:nowrap" class="ft14919">/4/&#160;OpenTC&#160;IST-027635/D03c.4/FINAL&#160;2.00<br/>Key&#160;Management&#160;Adaptation&#160;(KMA)&#160;service&#160;source&#160;code&#160;and&#160;documentation</p>
<p style="position:absolute;top:772px;left:85px;white-space:nowrap" class="ft14919">/5/&#160;OpenTC&#160;D03c.10&#160;deliverable<br/>Adapting&#160;IPsec&#160;configuration&#160;tools&#160;and&#160;IKE&#160;demon&#160;source&#160;code&#160;and&#160;document</p>
<p style="position:absolute;top:829px;left:85px;white-space:nowrap" class="ft14919">/6/&#160;OpenTC&#160;D03c.11&#160;deliverable<br/>PKCS#11&#160;source&#160;code&#160;and&#160;documentation</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft14921">Open_TC&#160;Deliverable&#160;03c.9</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft14921">35/35</p>
</div>
<hr/>
<a name="outline"></a><h1>Document Outline</h1>
<ul>
<li>D03c.3_TLS_DAA_enhancement_specification_v1.20.pdf
<ul>
<li>D03c.3_TLS_DAA_enhancement_specification_v1.20.pdf
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#6">1 &#160;Introduction</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#6">2 &#160;The Direct Anonymous Attestation (DAA) protocol</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#7">3 &#160;Using the DAA for authentication</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#7">3.1 &#160;Application scenario</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#8">3.2 &#160;Combining TLS and DAA protocols</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#8">4 &#160;Enhancing TLS protocol (informative)</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#8">4.1 &#160;TLS protocol</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#8">4.2 &#160;Hello extensions</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#11">4.3 &#160;Supplemental data message</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#12">5 &#160;DAA-enhanced TLS (DAA-TLS)</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#12">5.1 &#160;Overview</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#13">5.2 &#160;Summary of DAA-TLS capabilities and protocol flow</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#15">5.3 &#160;Binding between TLS channel and DAA authentication</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#16">5.4 &#160;Verification of the authentication</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#16">5.5 &#160;Definition of the hello extension DAAAuthExt</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#18">5.6 &#160;Definition of the supplemental data entry &#160;DAAAuthSupplDataEntry</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#20">6 &#160;Specification of TCG TSS/TPM DAA profile for DAA-TLS</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#20">6.1 &#160;Profile requirements and specification</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#21">6.2 &#160;Prerequisites for using TSS functions for DAA-TLS</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#21">6.3 &#160;Nonce and basename generation</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#22">6.4 &#160;DAA signature</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#23">6.5 &#160;Signature verification</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#24">6.6 &#160;Data encoding/decoding</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#24">6.6.1 &#160;Basic data types</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#25">6.6.2 &#160;Complex types</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#25">6.6.2.1 &#160;DAA Signature (normative)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#26">7 &#160;Security considerations</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#26">7.1 &#160;Endorsement Key (EK) exposure</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#26">7.2 &#160;Basename and DAA signature</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#27">8 &#160;IANA considerations</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#27">9 &#160;Final considerations (IPsec and IKE/ISAKMP)</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#28">10 &#160;List of abbreviations</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#28">11 &#160;Referenced Documents</a></li>
</ul>
</li>
</ul>
</li>
<li>D03c.6_TLS_DAA_enhancement_OpenSSL_design_v2.00.pdf
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#34">1 &#160;Introduction</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#34">2 &#160;Architecture overview</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#37">3 &#160;TLS Hello Extensions and Supplemental Data</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#37">3.1 &#160;Architecture</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#37">3.1.1 &#160;Overview</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#39">3.1.2 &#160;Data Structures</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#40">3.1.3 &#160;Workflow</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#42">3.2 &#160;Application Programming Interface</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#42">3.2.1 &#160;Interface</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#48">3.2.2 &#160;Application Interface</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#49">3.3 &#160;Examples</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#49">3.3.1 &#160;Hello World!</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#51">3.3.2 &#160;Supplemental Data</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#53">4 &#160;Direct Anonymous Attestation</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#53">4.1 &#160;Architecture</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#53">4.1.1 &#160;Overview</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#54">4.1.2 &#160;Data Structures</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#56">4.1.3 &#160;Workflow</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#58">4.2 &#160;Application Programming Interface</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#58">4.2.1 &#160;Application Interface</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#61">4.3 &#160;Examples</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#62">5 &#160;TLS DAA-Enhancement</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#62">5.1 &#160;Architecture</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#62">5.1.1 &#160;Overview</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#63">5.1.2 &#160;Data Structures</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#63">5.1.3 &#160;Implementation Details</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#63">5.1.3.1 &#160;Core</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#64">5.1.4 &#160;Workflow</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#66">5.1.5 &#160;Other Features</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#66">5.1.5.1 &#160;Support to TLS Sessions Resumption</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#66">5.1.5.2 &#160;Legacy Mode</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#67">5.2 &#160;Application Programming Interface</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#67">5.2.1 &#160;Application Interface</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#68">5.3 &#160;Example</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#68">5.3.1 &#160;Common Modifications</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#69">5.3.2 &#160;Modifications on the Client</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#69">5.3.3 &#160;Modifications on the Server</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#70">5.3.4 &#160;Running the commands</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#71">6 &#160;Implementation of the Specification of TCG TSS/TPM DAA Profile for DAA-TLS</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#71">6.1 &#160;Architecture</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#71">6.1.1 &#160;Overview</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#72">6.1.2 &#160;Implementation Details</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#73">6.1.2.1 &#160;DAA_METHOD</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#75">6.1.3 &#160;Workflow</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#77">6.2 &#160;Examples</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#78">7 &#160;List of abbreviations</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#78">8 &#160;Referenced Documents</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#80">9 &#160;Appendix. Code Documentation</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#80">9.1 &#160;General TLS Extensions framework</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#80">9.1.1 &#160;Patch</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#82">9.1.2 &#160;Core</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#83">9.1.3 &#160;Interface</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#83">9.1.4 &#160;Application Interface</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#83">9.2 &#160;Direct Anonymous Attestation</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#83">9.2.1 &#160;Implementation</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#87">9.2.2 &#160;Method Interface</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#89">9.2.3 &#160;Application Interface</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#89">9.3 &#160;TLS DAA-Enhancement</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#89">9.3.1 &#160;Core</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#89">9.3.2 &#160;Application Interface</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#89">9.4 &#160;Engine TPM-DAA</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#89">9.4.1 &#160;TSS Binding Utilities</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#90">9.4.2 &#160;DAA_METHOD</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>D03c.12_OpenSSL_engine_TLS_DAA_enhancement.pdf
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#93">1 &#160;Introduction</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#94">2 &#160;Prerequisites</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#95">3 &#160;Structure of the Package</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#96">4 &#160;OpenSSL with DAA Support</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#96">4.1 &#160;Building from the Source</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#96">4.2 &#160;Testing the Plain OpenSSL</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#97">4.3 &#160;Testing the DAA-TLS Extension</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#99">5 &#160;Trousers with DAA support</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#99">5.1 &#160;Building from the source</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#100">5.2 &#160;Configuring the DAA-Enhanced Trousers</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#101">5.3 &#160;Testing the Installation and Creating DAA Credentials</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#104">6 &#160;Engine TPM-DAA</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#104">6.1 &#160;Building from the source</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#104">6.2 &#160;Testing the DAA-TLS Extension, TCG TSS/TPM Profile</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#106">7 &#160;Engine Miracl</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#106">7.1 &#160;Building from the source</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#106">7.2 &#160;Creating DAA Credentials for Engine Miracl</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#107">7.3 &#160;Testing the DAA-TLS Extension, with Pairing-based DAA</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#108">8 &#160;Legacy Mode: Apache Web Server</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#109">8.1 &#160;Rebuilding OpenSSL with DAA Support in Legacy Mode</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#110">8.2 &#160;Installing and Configuring Apache Web Server</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#110">8.3 &#160;Testing the Advanced Scenario</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#113">9 &#160;List of abbreviations</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#113">10 &#160;Referenced Documents</a></li>
</ul>
</li>
<li>D03c.9_KMA_Documentation.pdf
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#118">&#160;1 Introduction</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#119">&#160;2 Building and installing KMA</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#119">&#160;2.1 Important notes (to read carefully before building or using KMA)</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#119">&#160;2.2 Introduction</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#120">&#160;2.3 KMA package dependencies (prerequisites)</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#120">&#160;2.3.1 Prerequisites</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#121">&#160;2.4 KMA building procedure</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#121">&#160;2.4.1 Building from the source tarball</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#122">&#160;2.5 Creating a openSUSE repository with KMA RPMS</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#122">&#160;2.5.1 Using the distributed tarball with RPMS</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#123">&#160;2.5.2 Using the RPMS built as described in the section 2.4.1</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#123">&#160;2.6 Installation</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#123">&#160;2.6.1 Adding the KMA repository</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#123">&#160;2.6.2 Set the packages to install</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#124">&#160;2.6.3 Alternative installation</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#124">&#160;2.6.4 Do not reboot</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#124">&#160;3 Preliminary steps</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#124">&#160;3.1 Configuration of the TPM emulator</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#125">&#160;3.2 Generation of the initram disk</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#125">&#160;3.3 TrustedGRUB modifications</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#126">&#160;4 Configuration</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#126">&#160;4.1 Preliminary steps</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#126">&#160;4.2 Creation of the file /etc/kma/boot.conf</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#127">&#160;4.3 Creation of the file /etc/kma/signed_binaries</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#128">&#160;4.4 Configuration of the protected filesystem</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#130">&#160;4.5 Creation of the file /etc/kma/checkfilelist</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#131">&#160;4.6 MasterKey generation and NV storage configuration (only for TPM v1.2)</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#132">&#160;4.7 First boot in learning mode</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#132">&#160;4.7.1 Checking the filesystem configuration</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#133">&#160;4.7.2 Discovering kernel modules</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#133">&#160;4.7.3 Discovering applications that need direct access to devices</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#133">&#160;4.7.4 Certifying binaries</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#133">&#160;4.7.5 Importing unprotected files in the eCryptfs filesystem</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#134">&#160;4.7.6 Learning activity of certified applications</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#134">&#160;4.7.7 Reviewing the libraries loading and direct access detected</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#134">&#160;4.8 Reboot in enforcing mode</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#134">&#160;4.9 Sealing</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#135">&#160;4.10 Unsealing</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#135">&#160;4.11 Using KMA</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#137">&#160;4.12 Maintenance procedures</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#137">&#160;4.12.1 Software update and new certified applications</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#139">&#160;4.12.2 Adding to the database /etc/kma/logs/mmap_list non discovered libraries</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#140">&#160;4.12.3 Adding to the database /etc/kma/logs/directaccess_list the processes that require direct access to devices</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#140">&#160;4.12.4 Allowing new or updated modules to be loaded in the kernel&#160;</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#141">&#160;4.12.5 Updating the system – a file included in /etc/kma/checkfilelist is changed</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#141">&#160;4.12.6 Updating filesystem policies</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#141">&#160;4.12.7 Restoring access to a renamed or a moved eCryptfs file</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#141">&#160;5 Removing KMA</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#142">&#160;6 List of all command used with parameters</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#144">&#160;7 Workarounds</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#144">&#160;8 PKCS#11 library configuration</a>
<ul>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#144">&#160;8.1 Token configuration – Administrator side</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#146">&#160;8.2 Token configuration – User side</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#147">&#160;8.3 Install software token in Firefox</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#148">&#160;8.4 Test and use the software token with Firefox</a></li>
</ul>
</li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#148">&#160;9 Glossary</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#149">&#160;10 List of Abbreviations</a></li>
<li><a href="OpenTC_D03.3_Collection_of_internal_deliverables_Y3.html#149">&#160;11 Related Work</a></li>
</ul>
</li>
</ul>
</body>
</html>
