<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>D06.1</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="generator" content="pdftohtml 0.36"/>
<meta name="author" content="Angelika Holzweber"/>
<meta name="keywords" content="WP6"/>
<meta name="date" content="2007-04-11T08:00:15+00:00"/>
<style type="text/css">
<!--
.xflip {
    -moz-transform: scaleX(-1);
    -webkit-transform: scaleX(-1);
    -o-transform: scaleX(-1);
    transform: scaleX(-1);
    filter: fliph;
}
.yflip {
    -moz-transform: scaleY(-1);
    -webkit-transform: scaleY(-1);
    -o-transform: scaleY(-1);
    transform: scaleY(-1);
    filter: flipv;
}
.xyflip {
    -moz-transform: scaleX(-1) scaleY(-1);
    -webkit-transform: scaleX(-1) scaleY(-1);
    -o-transform: scaleX(-1) scaleY(-1);
    transform: scaleX(-1) scaleY(-1);
    filter: fliph + flipv;
}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<!-- Page 1 -->
<a name="1"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft10{font-size:13px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
	.ft11{font-size:19px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
	.ft12{font-size:27px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
	.ft13{font-size:17px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
	.ft14{font-size:17px;font-family:DAAAAA+BitstreamVeraSans;color:#000000;}
	.ft15{font-size:10px;font-family:DAAAAA+BitstreamVeraSans;color:#000000;}
	.ft16{font-size:14px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
	.ft17{font-size:17px;line-height:19px;font-family:DAAAAA+BitstreamVeraSans;color:#000000;}
	.ft18{font-size:17px;line-height:28px;font-family:DAAAAA+BitstreamVeraSans;color:#000000;}
	.ft19{font-size:17px;line-height:19px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page1-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables001.png" alt="background image"/>
<p style="position:absolute;top:137px;left:92px;white-space:nowrap" class="ft10">&#160;</p>
<p style="position:absolute;top:76px;left:91px;white-space:nowrap" class="ft11">&#160;</p>
<p style="position:absolute;top:233px;left:141px;white-space:nowrap" class="ft12"><b>D6.1: Collection&#160;of all&#160;SWP deliverables&#160;</b></p>
<p style="position:absolute;top:265px;left:88px;white-space:nowrap" class="ft12"><b>(with nature=R)&#160;produced&#160;during&#160;months 1-12&#160;</b></p>
<p style="position:absolute;top:342px;left:91px;white-space:nowrap" class="ft13"><b>Project number</b></p>
<p style="position:absolute;top:342px;left:425px;white-space:nowrap" class="ft14">IST-027635</p>
<p style="position:absolute;top:367px;left:91px;white-space:nowrap" class="ft13"><b>Project acronym</b></p>
<p style="position:absolute;top:367px;left:425px;white-space:nowrap" class="ft14">Open_TC</p>
<p style="position:absolute;top:393px;left:91px;white-space:nowrap" class="ft13"><b>Project title</b></p>
<p style="position:absolute;top:393px;left:425px;white-space:nowrap" class="ft14">Open Trusted Computing</p>
<p style="position:absolute;top:418px;left:91px;white-space:nowrap" class="ft13"><b>Deliverable&#160;type</b></p>
<p style="position:absolute;top:418px;left:425px;white-space:nowrap" class="ft14">Main Deliverable</p>
<p style="position:absolute;top:462px;left:91px;white-space:nowrap" class="ft13"><b>Deliverable&#160;reference number</b></p>
<p style="position:absolute;top:462px;left:425px;white-space:nowrap" class="ft14">IST-027635/D6.1/PUBLIC&#160;| 1.10</p>
<p style="position:absolute;top:493px;left:91px;white-space:nowrap" class="ft13"><b>Deliverable&#160;title</b></p>
<p style="position:absolute;top:484px;left:425px;white-space:nowrap" class="ft17">Collection&#160;of all SWP deliverables&#160;(with&#160;<br/>nature=R)&#160;produced during months 1-12</p>
<p style="position:absolute;top:525px;left:91px;white-space:nowrap" class="ft13"><b>WP&#160;contributing&#160;to the deliverable</b></p>
<p style="position:absolute;top:525px;left:425px;white-space:nowrap" class="ft14">WP6</p>
<p style="position:absolute;top:551px;left:91px;white-space:nowrap" class="ft13"><b>Due&#160;date</b></p>
<p style="position:absolute;top:551px;left:425px;white-space:nowrap" class="ft14">Apr&#160;2007</p>
<p style="position:absolute;top:576px;left:91px;white-space:nowrap" class="ft13"><b>Actual&#160;submission&#160;date</b></p>
<p style="position:absolute;top:576px;left:425px;white-space:nowrap" class="ft14">Apr&#160;2007</p>
<p style="position:absolute;top:619px;left:91px;white-space:nowrap" class="ft13"><b>Responsible Organisation</b></p>
<p style="position:absolute;top:619px;left:424px;white-space:nowrap" class="ft14">POL</p>
<p style="position:absolute;top:661px;left:91px;white-space:nowrap" class="ft13"><b>Authors</b></p>
<p style="position:absolute;top:642px;left:424px;white-space:nowrap" class="ft17">See the cover page of each&#160;included internal&#160;<br/>deliverable</p>
<p style="position:absolute;top:699px;left:91px;white-space:nowrap" class="ft13"><b>Abstract</b></p>
<p style="position:absolute;top:699px;left:424px;white-space:nowrap" class="ft17">Collection of all internal deliverables (with&#160;<br/>nature=R) produced during months&#160;1-12:</p>
<p style="position:absolute;top:747px;left:427px;white-space:nowrap" class="ft14">D06a.1:&#160;Preliminary&#160;DRM system&#160;</p>
<p style="position:absolute;top:766px;left:497px;white-space:nowrap" class="ft14">specification</p>
<p style="position:absolute;top:794px;left:427px;white-space:nowrap" class="ft18">D06e.1: MFA&#160;Requirements&#160;and Specification<br/>D06e.3: Intermediate MFA System&#160;</p>
<p style="position:absolute;top:842px;left:497px;white-space:nowrap" class="ft14">Specification</p>
<p style="position:absolute;top:870px;left:430px;white-space:nowrap" class="ft14">NOTE: a&#160;general explanation&#160;section has&#160;</p>
<p style="position:absolute;top:889px;left:488px;white-space:nowrap" class="ft17">been added and sections 1, 3.6.1,&#160;<br/>3.6.2 of D06a.1 have been updated</p>
<p style="position:absolute;top:940px;left:91px;white-space:nowrap" class="ft13"><b>Keywords</b></p>
<p style="position:absolute;top:983px;left:92px;white-space:nowrap" class="ft13"><b>Dissemination&#160;level</b></p>
<p style="position:absolute;top:983px;left:423px;white-space:nowrap" class="ft14">Public</p>
<p style="position:absolute;top:1008px;left:92px;white-space:nowrap" class="ft13"><b>Revision</b></p>
<p style="position:absolute;top:1008px;left:423px;white-space:nowrap" class="ft14">PUBLIC&#160;| 1.10</p>
<p style="position:absolute;top:1059px;left:90px;white-space:nowrap" class="ft13"><b>Instrument</b></p>
<p style="position:absolute;top:1059px;left:271px;white-space:nowrap" class="ft14">IP</p>
<p style="position:absolute;top:1050px;left:452px;white-space:nowrap" class="ft19"><b>Start&#160;date of&#160;the&#160;<br/>project</b></p>
<p style="position:absolute;top:1059px;left:633px;white-space:nowrap" class="ft14">1</p>
<p style="position:absolute;top:1060px;left:643px;white-space:nowrap" class="ft15">st</p>
<p style="position:absolute;top:1059px;left:652px;white-space:nowrap" class="ft14">&#160;November 2005</p>
<p style="position:absolute;top:1088px;left:90px;white-space:nowrap" class="ft13"><b>Thematic&#160;Priority</b></p>
<p style="position:absolute;top:1088px;left:271px;white-space:nowrap" class="ft14">IST</p>
<p style="position:absolute;top:1088px;left:452px;white-space:nowrap" class="ft13"><b>Duration</b></p>
<p style="position:absolute;top:1088px;left:633px;white-space:nowrap" class="ft14">42 months</p>
<p style="position:absolute;top:75px;left:674px;white-space:nowrap" class="ft16">&#160;</p>
</div>
<!-- Page 2 -->
<a name="2"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft210{font-size:21px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
	.ft211{font-size:20px;font-family:EAAAAA+BitstreamVeraSans;color:#000000;}
	.ft212{font-size:14px;font-family:FAAAAA+OpenSymbol;color:#000000;}
-->
</style>
<div id="page2-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables002.png" alt="background image"/>
<p style="position:absolute;top:137px;left:92px;white-space:nowrap" class="ft20">&#160;</p>
<p style="position:absolute;top:76px;left:91px;white-space:nowrap" class="ft21">&#160;</p>
<p style="position:absolute;top:188px;left:85px;white-space:nowrap" class="ft210"><b>1&#160;Introduction</b></p>
<p style="position:absolute;top:221px;left:85px;white-space:nowrap" class="ft27">This section has&#160;been added on&#160;request from&#160;the EC reviewers. Its&#160;purpose is to clarify&#160;<br/>the relationships between Workpackage&#160;2 and Workpackage&#160;6, namely&#160;how the&#160;<br/>requirements set&#160;in the former&#160;have impact&#160;on&#160;the latter. In&#160;particular this section&#160;<br/>explains&#160;which elements from&#160;Trusted Computing (TC) technology are used in WP6 to&#160;<br/>meet the requirements&#160;specified in WP2.</p>
<p style="position:absolute;top:344px;left:85px;white-space:nowrap" class="ft210"><b>2&#160;&#160;Workpackage 6's&#160;context and purpose</b></p>
<p style="position:absolute;top:377px;left:85px;white-space:nowrap" class="ft27">WP6 is related to applications&#160;that make use of Trusted Computing and virtualisation&#160;<br/>technologies&#160;to reach&#160;security goals&#160;difficult to&#160;achieve using other technologies or&#160;<br/>obtainable at a&#160;higher&#160;price.&#160;The foundations of such&#160;technologies are hardware&#160;and&#160;<br/>software&#160;components:&#160;(1) the Trusted Platform&#160;Module (TPM) which&#160;is a low cost&#160;chip&#160;<br/>shipped with most&#160;of recent platforms&#160;together with the (2) new generation of Intel&#160;<br/>and AMD processors&#160;and chipsets that&#160;provide hardware assistance&#160;for virtualisation&#160;<br/>and hardware&#160;support for&#160;the platform&#160;integrity protection and measurement and (3)&#160;<br/>open source&#160;Virtual Machine Monitors&#160;(VMM) like Xen and Fiasco,&#160;an implementation&#160;<br/>of L4&#160;micro-kernel family.<br/>Since&#160;the core&#160;workpackages&#160;(WP3 to WP5) are&#160;in charge to&#160;design and develop a&#160;<br/>security&#160;framework (OpenTC) based on the mentioned technologies, WP6's&#160;purpose&#160;is&#160;<br/>to&#160;show which security benefits&#160;can&#160;be achieved using such framework&#160;in different&#160;<br/>application areas.<br/>Moreover&#160;two of five WP6&#160;applications&#160;are special cases:&#160;Encryption File Service (EFS,&#160;<br/>in Sub-workpackage 6.d) and MultiFactor&#160;Authentication&#160;(MFA, Sub-workpackage&#160;6.e)&#160;<br/>are&#160;applications&#160;that show&#160;the use of the technology but&#160;they can&#160;be also&#160;considered&#160;<br/>as&#160;components&#160;to be shipped with the framework.</p>
<p style="position:absolute;top:740px;left:85px;white-space:nowrap" class="ft210"><b>3&#160;&#160;Use of TC technology&#160;in Sub-workpackages 6.a&#160;and 6.e</b></p>
<p style="position:absolute;top:791px;left:85px;white-space:nowrap" class="ft211"><i><b>3.1&#160;SWP06.a:&#160;Interoperable DRM&#160;solution&#160;based on&#160;MPEG-21</b></i></p>
<p style="position:absolute;top:822px;left:85px;white-space:nowrap" class="ft24">This subsection applies&#160;to the following internal deliverable:</p>
<p style="position:absolute;top:854px;left:85px;white-space:nowrap" class="ft212">–</p>
<p style="position:absolute;top:851px;left:112px;white-space:nowrap" class="ft24">D06a.1 Preliminary&#160;DRM system&#160;specification&#160;(included in main deliverable D6.1)</p>
<p style="position:absolute;top:879px;left:85px;white-space:nowrap" class="ft27">The objective of this Sub-workpackage&#160;is to design and develop a&#160;DRM system capable&#160;<br/>to&#160;balance the rights and obligations of all involved stakeholders&#160;(i.e. the end user and&#160;<br/>the content provider) to support&#160;a more&#160;fair use of DRM. Some relevant requirements&#160;<br/>for&#160;the stakeholders are:</p>
<p style="position:absolute;top:968px;left:85px;white-space:nowrap" class="ft212">–</p>
<p style="position:absolute;top:965px;left:112px;white-space:nowrap" class="ft27">(content&#160;provider) guarantee that&#160;the user's&#160;system&#160;will play the multimedia&#160;<br/>content&#160;only in accordance&#160;with the terms&#160;of the license</p>
<p style="position:absolute;top:1016px;left:85px;white-space:nowrap" class="ft212">–</p>
<p style="position:absolute;top:1013px;left:112px;white-space:nowrap" class="ft27">(user) support&#160;for user rights&#160;for playing the content on different devices, sharing&#160;<br/>the content among&#160;a limited number of&#160;close&#160;users and re-selling the content</p>
<p style="position:absolute;top:1063px;left:85px;white-space:nowrap" class="ft212">–</p>
<p style="position:absolute;top:1060px;left:112px;white-space:nowrap" class="ft27">(user) user is in&#160;control&#160;of his platform:&#160;no hidden software&#160;needs to&#160;be installed by&#160;<br/>the content provider to&#160;protect the content from&#160;unauthorized uses</p>
<p style="position:absolute;top:75px;left:674px;white-space:nowrap" class="ft26">&#160;</p>
</div>
<!-- Page 3 -->
<a name="3"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page3-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables003.png" alt="background image"/>
<p style="position:absolute;top:137px;left:92px;white-space:nowrap" class="ft30">&#160;</p>
<p style="position:absolute;top:76px;left:91px;white-space:nowrap" class="ft31">&#160;</p>
<p style="position:absolute;top:170px;left:85px;white-space:nowrap" class="ft37">One key element to&#160;meet&#160;these requirements is the support&#160;for&#160;interoperable (i.e.&#160;<br/>standard)&#160;formats&#160;for both encrypted contents and licenses. Instead, the technological&#160;<br/>elements provided by OpenTC framework&#160;to satisfy&#160;the mentioned requirements&#160;are:</p>
<p style="position:absolute;top:239px;left:85px;white-space:nowrap" class="ft312">–</p>
<p style="position:absolute;top:237px;left:112px;white-space:nowrap" class="ft37">open design and open source&#160;system:&#160;this allows the inspection by the users'&#160;<br/>community&#160;to verify that hidden components are&#160;not present (see for&#160;example the&#160;<br/>case&#160;of like the Sony rootkit)</p>
<p style="position:absolute;top:306px;left:85px;white-space:nowrap" class="ft312">–</p>
<p style="position:absolute;top:303px;left:112px;white-space:nowrap" class="ft37">TPM&#160;on the user platform&#160;for collecting the integrity measurements&#160;of the platform&#160;<br/>and software&#160;components;&#160;these measurements will be used for</p>
<p style="position:absolute;top:354px;left:138px;white-space:nowrap" class="ft312">–</p>
<p style="position:absolute;top:351px;left:165px;white-space:nowrap" class="ft37">remote attestation&#160;performed by the content&#160;provider&#160;to check the integrity&#160;<br/>of the user's&#160;platform&#160;before sending the decryption keys</p>
<p style="position:absolute;top:402px;left:138px;white-space:nowrap" class="ft312">–</p>
<p style="position:absolute;top:399px;left:165px;white-space:nowrap" class="ft37">secure storage&#160;for keys and other relevant&#160;data&#160;which are&#160;bound to&#160;a good&#160;<br/>status&#160;of the user's&#160;platform&#160;(sealing), represented by specific sets&#160;of&#160;<br/>measurements</p>
<p style="position:absolute;top:469px;left:85px;white-space:nowrap" class="ft312">–</p>
<p style="position:absolute;top:466px;left:112px;white-space:nowrap" class="ft37">isolation provided by virtualisation&#160;for separating the DRM code and the player&#160;into&#160;<br/>protected&#160;containers, to&#160;guarantee that license parsing&#160;and content&#160;decryption&#160;are&#160;<br/>performed separately in&#160;secure environments</p>
<p style="position:absolute;top:536px;left:85px;white-space:nowrap" class="ft312">–</p>
<p style="position:absolute;top:533px;left:112px;white-space:nowrap" class="ft34">cryptographic&#160;services and support&#160;for PKI</p>
<p style="position:absolute;top:561px;left:85px;white-space:nowrap" class="ft37">For&#160;further&#160;details about&#160;the technical requirements from&#160;other workpackages,&#160;namely&#160;<br/>properties and services&#160;provided by OpenTC framework to&#160;this&#160;application,&#160;see main&#160;<br/>deliverable D02.2 (the updated version of D02.1), section 11.2.1.</p>
<p style="position:absolute;top:646px;left:85px;white-space:nowrap" class="ft311"><i><b>3.2&#160;SWP06.e:&#160;MultiFactor&#160;Authentication (MFA)</b></i></p>
<p style="position:absolute;top:677px;left:85px;white-space:nowrap" class="ft34">This subsection applies&#160;to the following internal deliverables:</p>
<p style="position:absolute;top:708px;left:85px;white-space:nowrap" class="ft312">–</p>
<p style="position:absolute;top:705px;left:112px;white-space:nowrap" class="ft34">D06e.1 MFA Requirements and Specification&#160;(included in main deliverable D6.1)</p>
<p style="position:absolute;top:737px;left:85px;white-space:nowrap" class="ft312">–</p>
<p style="position:absolute;top:734px;left:112px;white-space:nowrap" class="ft34">D06e.2 MFA Intermediate Specification (included in main deliverable D6.1)</p>
<p style="position:absolute;top:765px;left:85px;white-space:nowrap" class="ft312">–</p>
<p style="position:absolute;top:762px;left:112px;white-space:nowrap" class="ft34">D06e.3 MFA Concept Prototype&#160;(included in main deliverable D6.2)</p>
<p style="position:absolute;top:791px;left:85px;white-space:nowrap" class="ft37">The objective of this Sub-workpackage&#160;is to design and develop a&#160;MultiFactor&#160;<br/>Authentication&#160;(MFA) system&#160;for client-server&#160;applications,&#160;namely a system&#160;that&#160;<br/>provides an additional factor&#160;for&#160;making the authentication&#160;stronger when accessing a&#160;<br/>service through a&#160;network.<br/>This is an application&#160;of TC technology but not an end-user one: it is instead&#160;a&#160;<br/>subsystem&#160;that can&#160;be integrated in other systems&#160;or frameworks&#160;like OpenTC to&#160;<br/>enhance&#160;the robustness&#160;of the authentication.<br/>For&#160;instance, the usual password-based authentication&#160;scheme for a&#160;user,&#160;cannot&#160;be&#160;<br/>considered robust,&#160;even though performed through a robust&#160;protocol.&#160;In&#160;fact the&#160;<br/>passwords&#160;can&#160;be stoled through a social&#160;engineering attack&#160;no matter&#160;which is the&#160;<br/>robustness&#160;of the authentication&#160;system. MFA&#160;can&#160;be used to increase the&#160;<br/>The requirements&#160;for the parties involved in&#160;a&#160;networked interaction&#160;(client and&#160;<br/>server) for&#160;having a&#160;more robust&#160;authentication&#160;mechanism are&#160;</p>
<p style="position:absolute;top:1079px;left:85px;white-space:nowrap" class="ft312">–</p>
<p style="position:absolute;top:1077px;left:112px;white-space:nowrap" class="ft37">the use of an additional factor&#160;based on the TPM to implement the platform&#160;<br/>authentication;&#160;</p>
<p style="position:absolute;top:75px;left:674px;white-space:nowrap" class="ft36">&#160;</p>
</div>
<!-- Page 4 -->
<a name="4"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page4-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables004.png" alt="background image"/>
<p style="position:absolute;top:137px;left:92px;white-space:nowrap" class="ft40">&#160;</p>
<p style="position:absolute;top:76px;left:91px;white-space:nowrap" class="ft41">&#160;</p>
<p style="position:absolute;top:173px;left:138px;white-space:nowrap" class="ft412">–</p>
<p style="position:absolute;top:170px;left:165px;white-space:nowrap" class="ft44">only&#160;users&#160;from registered client platforms&#160;can access&#160;a&#160;service&#160;</p>
<p style="position:absolute;top:201px;left:138px;white-space:nowrap" class="ft412">–</p>
<p style="position:absolute;top:198px;left:165px;white-space:nowrap" class="ft47">the user can&#160;can&#160;verify the identity&#160;integrity&#160;of the platform&#160;providing &#160;the&#160;<br/>service</p>
<p style="position:absolute;top:249px;left:85px;white-space:nowrap" class="ft412">–</p>
<p style="position:absolute;top:246px;left:112px;white-space:nowrap" class="ft44">seamless&#160;integration into existing systems&#160;and authentication&#160;subsystems</p>
<p style="position:absolute;top:275px;left:85px;white-space:nowrap" class="ft47">MFA&#160;is designed to&#160;be a&#160;general&#160;purpose&#160;subsystem that&#160;can&#160;be used with a&#160;variety&#160;<br/>systems.&#160;However there are specific&#160;uses&#160;for OpenTC. Given the the high level of&#160;<br/>assurance&#160;that OpenTC should provide, MFA&#160;can be used as&#160;component&#160;of OpenTC&#160;<br/>framework&#160;for allowing its remote&#160;management&#160;only from&#160;a registered workstations.&#160;<br/>However it can also&#160;be used completely contained within an OpenTC framework&#160;<br/>running on single physical&#160;platform&#160;for&#160;accessing&#160;network services&#160;provided by some&#160;<br/>Virtual Machines to&#160;other Virtual Machines.<br/>The technological&#160;elements&#160;provided by OpenTC framework&#160;to satisfy&#160;such&#160;<br/>requirements are:</p>
<p style="position:absolute;top:459px;left:85px;white-space:nowrap" class="ft412">–</p>
<p style="position:absolute;top:456px;left:112px;white-space:nowrap" class="ft47">TPM&#160;on the client&#160;for performing the signature&#160;over a random&#160;challenge with a&#160;<br/>protected&#160;key to&#160;authenticate&#160;the user's&#160;platform</p>
<p style="position:absolute;top:507px;left:85px;white-space:nowrap" class="ft412">–</p>
<p style="position:absolute;top:504px;left:112px;white-space:nowrap" class="ft47">TPM&#160;on the server&#160;for locally encrypting the MFA policy database&#160;and bind it to&#160;a&#160;<br/>good&#160;status&#160;of the platform&#160;(sealing)</p>
<p style="position:absolute;top:555px;left:85px;white-space:nowrap" class="ft412">–</p>
<p style="position:absolute;top:552px;left:112px;white-space:nowrap" class="ft47">isolation provided by virtualisation&#160;for separating the security critical&#160;service for&#160;<br/>remote&#160;management&#160;service&#160;-&#160;for&#160;instance&#160;sshd for management from&#160;a remote&#160;<br/>console&#160;-&#160;which is security critical&#160;from the other applications&#160;and services&#160;</p>
<p style="position:absolute;top:619px;left:85px;white-space:nowrap" class="ft47">For&#160;further&#160;details about&#160;the MFA&#160;see D02.2 (the updated version of D02.1), section&#160;<br/>11.6.<br/>The Concept Prototype&#160;(see internal deliverable D6e.2) is an example to experiment&#160;<br/>and show&#160;that is possible to add a&#160;further authentication&#160;based on the TPM to&#160;an&#160;<br/>existing network applications&#160;(like ssh/sshd)&#160;and authentication&#160;framework (like Linux&#160;<br/>PAM).&#160;Therefore only part&#160;of the planned features/capabilities&#160;have been included in&#160;<br/>this preliminary prototype:&#160;for instance&#160;the mutual authentication&#160;has not&#160;been&#160;<br/>implemented.<br/>The final prototype,&#160;instead will be a featured component that&#160;will provide an API&#160;for&#160;<br/>remote&#160;access&#160;to&#160;the service;&#160;the preliminary specification of such&#160;API&#160;has been as&#160;<br/>“MFA&#160;intermediate&#160;specifications”&#160;(see internal deliverable D6e.3).</p>
<p style="position:absolute;top:875px;left:85px;white-space:nowrap" class="ft410"><b>4&#160;List&#160;of&#160;abbreviations</b></p>
<p style="position:absolute;top:908px;left:85px;white-space:nowrap" class="ft47">Listing of term definitions and abbreviations&#160;used in the overview documents and&#160;<br/>architectural&#160;design specification (IT&#160;expressions&#160;and terms&#160;from the application&#160;<br/>domain).</p>
<p style="position:absolute;top:985px;left:95px;white-space:nowrap" class="ft43"><b>Abbreviation</b></p>
<p style="position:absolute;top:985px;left:302px;white-space:nowrap" class="ft43"><b>Explanation</b></p>
<p style="position:absolute;top:1004px;left:95px;white-space:nowrap" class="ft44">API</p>
<p style="position:absolute;top:1004px;left:302px;white-space:nowrap" class="ft44">Application&#160;Programming&#160;Interface</p>
<p style="position:absolute;top:1024px;left:95px;white-space:nowrap" class="ft44">DRM</p>
<p style="position:absolute;top:1024px;left:302px;white-space:nowrap" class="ft44">Digital Right Management</p>
<p style="position:absolute;top:1043px;left:95px;white-space:nowrap" class="ft44">MFA</p>
<p style="position:absolute;top:1043px;left:302px;white-space:nowrap" class="ft44">MultiFactor&#160;Authentication</p>
<p style="position:absolute;top:1062px;left:95px;white-space:nowrap" class="ft44">PKI</p>
<p style="position:absolute;top:1062px;left:302px;white-space:nowrap" class="ft44">Public&#160;Key Infrastructure</p>
<p style="position:absolute;top:1081px;left:95px;white-space:nowrap" class="ft44">WP</p>
<p style="position:absolute;top:1081px;left:302px;white-space:nowrap" class="ft44">Workpackage</p>
<p style="position:absolute;top:1101px;left:95px;white-space:nowrap" class="ft44">SWP</p>
<p style="position:absolute;top:1101px;left:302px;white-space:nowrap" class="ft44">Sub-Workpackage</p>
<p style="position:absolute;top:1120px;left:95px;white-space:nowrap" class="ft44">TC</p>
<p style="position:absolute;top:1120px;left:302px;white-space:nowrap" class="ft44">Trusted Computing</p>
<p style="position:absolute;top:75px;left:674px;white-space:nowrap" class="ft46">&#160;</p>
</div>
<!-- Page 5 -->
<a name="5"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft513{font-size:17px;font-family:DAAAAA+BitstreamVeraSans;color:#0000ff;}
	.ft514{font-size:17px;line-height:19px;font-family:DAAAAA+BitstreamVeraSans;color:#0000ff;}
-->
</style>
<div id="page5-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables005.png" alt="background image"/>
<p style="position:absolute;top:137px;left:92px;white-space:nowrap" class="ft50">&#160;</p>
<p style="position:absolute;top:76px;left:91px;white-space:nowrap" class="ft51">&#160;</p>
<p style="position:absolute;top:216px;left:85px;white-space:nowrap" class="ft510"><b>5&#160;Referenced&#160;Documents</b></p>
<p style="position:absolute;top:268px;left:85px;white-space:nowrap" class="ft54">/1/&#160;PAM</p>
<p style="position:absolute;top:288px;left:85px;white-space:nowrap" class="ft514">http://www.kernel.org/pub/linux/libs/pam/Linux-PAM-html/Linux-<br/><a href="http://msdn.microsoft.com/">PAM_ADG.html</a></p>
<p style="position:absolute;top:307px;left:85px;white-space:nowrap" class="ft513">&#160;&#160;</p>
<p style="position:absolute;top:307px;left:209px;white-space:nowrap" class="ft513"><a href="http://msdn.microsoft.com/">http://msdn.microsoft.com</a></p>
<p style="position:absolute;top:307px;left:209px;white-space:nowrap" class="ft513"><a href="http://msdn.microsoft.com/">&#160;&#160;</a></p>
<p style="position:absolute;top:326px;left:85px;white-space:nowrap" class="ft54">Version 0.99.6.0, 5. August&#160;2006.</p>
<p style="position:absolute;top:364px;left:85px;white-space:nowrap" class="ft54">/2/&#160;OpenTC: D02.2 Requirements Definition and Specification (April 2007)</p>
<p style="position:absolute;top:75px;left:674px;white-space:nowrap" class="ft56">&#160;</p>
</div>
<!-- Page 6 -->
<a name="6"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page6-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables006.png" alt="background image"/>
<p style="position:absolute;top:137px;left:92px;white-space:nowrap" class="ft60">&#160;</p>
<p style="position:absolute;top:76px;left:91px;white-space:nowrap" class="ft61">&#160;</p>
<p style="position:absolute;top:188px;left:101px;white-space:nowrap" class="ft62"><b>WP06a Preliminary&#160;DRM system specification</b></p>
<p style="position:absolute;top:265px;left:91px;white-space:nowrap" class="ft63"><b>Project number</b></p>
<p style="position:absolute;top:265px;left:425px;white-space:nowrap" class="ft64">IST-027635</p>
<p style="position:absolute;top:291px;left:91px;white-space:nowrap" class="ft63"><b>Project acronym</b></p>
<p style="position:absolute;top:291px;left:425px;white-space:nowrap" class="ft64">Open_TC</p>
<p style="position:absolute;top:316px;left:91px;white-space:nowrap" class="ft63"><b>Project title</b></p>
<p style="position:absolute;top:316px;left:425px;white-space:nowrap" class="ft64">Open Trusted Computing</p>
<p style="position:absolute;top:342px;left:91px;white-space:nowrap" class="ft63"><b>Deliverable&#160;type</b></p>
<p style="position:absolute;top:342px;left:425px;white-space:nowrap" class="ft64">&#160;Internal document</p>
<p style="position:absolute;top:385px;left:91px;white-space:nowrap" class="ft63"><b>Deliverable&#160;reference number</b></p>
<p style="position:absolute;top:385px;left:425px;white-space:nowrap" class="ft64">IST-027635/D06a.1/FINAL&#160;| 1.10</p>
<p style="position:absolute;top:410px;left:91px;white-space:nowrap" class="ft63"><b>Deliverable&#160;title</b></p>
<p style="position:absolute;top:410px;left:425px;white-space:nowrap" class="ft64">Preliminary&#160;DRM system&#160;specification</p>
<p style="position:absolute;top:436px;left:91px;white-space:nowrap" class="ft63"><b>WP&#160;contributing&#160;to the deliverable</b></p>
<p style="position:absolute;top:436px;left:425px;white-space:nowrap" class="ft64">WP6</p>
<p style="position:absolute;top:461px;left:91px;white-space:nowrap" class="ft63"><b>Due&#160;date</b></p>
<p style="position:absolute;top:461px;left:425px;white-space:nowrap" class="ft64">Apr&#160;2007</p>
<p style="position:absolute;top:487px;left:91px;white-space:nowrap" class="ft63"><b>Actual&#160;submission&#160;date</b></p>
<p style="position:absolute;top:487px;left:425px;white-space:nowrap" class="ft64">Apr&#160;2007</p>
<p style="position:absolute;top:530px;left:91px;white-space:nowrap" class="ft63"><b>Responsible Organisation</b></p>
<p style="position:absolute;top:530px;left:424px;white-space:nowrap" class="ft64">LDV,Lehrstuhl für Datenverarbeitung, TUM</p>
<p style="position:absolute;top:555px;left:91px;white-space:nowrap" class="ft63"><b>Authors</b></p>
<p style="position:absolute;top:555px;left:424px;white-space:nowrap" class="ft64">Florian Schreiner, Chun Hui Suen</p>
<p style="position:absolute;top:578px;left:91px;white-space:nowrap" class="ft63"><b>Abstract</b></p>
<p style="position:absolute;top:794px;left:91px;white-space:nowrap" class="ft63"><b>Keywords</b></p>
<p style="position:absolute;top:794px;left:424px;white-space:nowrap" class="ft64">DRM, fair, interoperable, MPEG-21</p>
<p style="position:absolute;top:837px;left:92px;white-space:nowrap" class="ft63"><b>Dissemination&#160;level</b></p>
<p style="position:absolute;top:837px;left:423px;white-space:nowrap" class="ft64">Public</p>
<p style="position:absolute;top:862px;left:92px;white-space:nowrap" class="ft63"><b>Revision</b></p>
<p style="position:absolute;top:862px;left:423px;white-space:nowrap" class="ft64">FINAL&#160;| 1.10</p>
<p style="position:absolute;top:913px;left:90px;white-space:nowrap" class="ft63"><b>Instrument</b></p>
<p style="position:absolute;top:913px;left:271px;white-space:nowrap" class="ft64">IP</p>
<p style="position:absolute;top:904px;left:452px;white-space:nowrap" class="ft69"><b>Start&#160;date of&#160;the&#160;<br/>project</b></p>
<p style="position:absolute;top:913px;left:633px;white-space:nowrap" class="ft64">1</p>
<p style="position:absolute;top:913px;left:643px;white-space:nowrap" class="ft65">st</p>
<p style="position:absolute;top:913px;left:652px;white-space:nowrap" class="ft64">&#160;November 2005</p>
<p style="position:absolute;top:942px;left:90px;white-space:nowrap" class="ft63"><b>Thematic&#160;Priority</b></p>
<p style="position:absolute;top:942px;left:271px;white-space:nowrap" class="ft64">IST</p>
<p style="position:absolute;top:942px;left:452px;white-space:nowrap" class="ft63"><b>Duration</b></p>
<p style="position:absolute;top:942px;left:633px;white-space:nowrap" class="ft64">42 months</p>
<p style="position:absolute;top:75px;left:674px;white-space:nowrap" class="ft66">&#160;</p>
</div>
<!-- Page 7 -->
<a name="7"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft715{font-size:9px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
	.ft716{font-size:15px;font-family:DAAAAA+BitstreamVeraSans;color:#000000;}
	.ft717{font-size:24px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page7-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables007.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft715">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft70">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft716">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft716">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft717"><b>Table of Contents</b></p>
<p style="position:absolute;top:188px;left:85px;white-space:nowrap" class="ft77">1&#160;.Introduction...............................................................................................................&#160;5<br/>2&#160;.Use Cases..................................................................................................................&#160;5</p>
<p style="position:absolute;top:226px;left:94px;white-space:nowrap" class="ft77">2.1&#160;Overview................................................................................................................&#160;5<br/>2.2&#160;Description of Use Cases........................................................................................&#160;6</p>
<p style="position:absolute;top:265px;left:85px;white-space:nowrap" class="ft74">3&#160;.Design Specifications...............................................................................................&#160;13</p>
<p style="position:absolute;top:284px;left:94px;white-space:nowrap" class="ft77">3.1&#160;Architecture..........................................................................................................&#160;13<br/>3.2&#160;Player&#160;API.............................................................................................................&#160;13</p>
<p style="position:absolute;top:322px;left:102px;white-space:nowrap" class="ft77">3.2.1&#160;Registration.....................................................................................................&#160;13<br/>3.2.2&#160;Content Key Handling......................................................................................&#160;14<br/>3.2.3&#160;Legacy&#160;Player Application................................................................................&#160;14</p>
<p style="position:absolute;top:380px;left:94px;white-space:nowrap" class="ft77">3.3&#160;Manager&#160;API.........................................................................................................&#160;15<br/>3.4&#160;Application&#160;loader................................................................................................&#160;15<br/>3.5&#160;Core Manager.......................................................................................................&#160;15<br/>3.6&#160;License Manager..................................................................................................&#160;15</p>
<p style="position:absolute;top:457px;left:102px;white-space:nowrap" class="ft77">3.6.1&#160;License Interpreter..........................................................................................&#160;16<br/>3.6.2&#160;License Translation&#160;Manager&#160;..........................................................................&#160;16</p>
<p style="position:absolute;top:495px;left:94px;white-space:nowrap" class="ft77">3.7&#160;State&#160;Management...............................................................................................&#160;17<br/>3.8&#160;Sealed store.........................................................................................................&#160;18</p>
<p style="position:absolute;top:534px;left:102px;white-space:nowrap" class="ft77">3.8.1&#160;Key store.........................................................................................................&#160;18<br/>3.8.2&#160;License store...................................................................................................&#160;18</p>
<p style="position:absolute;top:572px;left:94px;white-space:nowrap" class="ft77">3.9&#160;Utility library.........................................................................................................&#160;18<br/>3.1&#160;0OS Services........................................................................................................&#160;19</p>
<p style="position:absolute;top:610px;left:85px;white-space:nowrap" class="ft74">4&#160;.Component&#160;Interaction............................................................................................&#160;20</p>
<p style="position:absolute;top:630px;left:94px;white-space:nowrap" class="ft77">4.1&#160;Functional parts&#160;of the DRM Core&#160;........................................................................&#160;20<br/>4.2&#160;Sequence diagram...............................................................................................&#160;21<br/>4.3&#160;DRM system&#160;and XEN/L4 virtualization environments..........................................&#160;22</p>
<p style="position:absolute;top:687px;left:102px;white-space:nowrap" class="ft77">4.3.1&#160;DRM components&#160;and compartments..............................................................&#160;22<br/>4.3.2&#160;Interfaces&#160;between compartments..................................................................&#160;23</p>
<p style="position:absolute;top:726px;left:85px;white-space:nowrap" class="ft77">5&#160;.Requirements from&#160;other&#160;Partners...........................................................................24<br/>6&#160;.Technical&#160;API&#160;Specification......................................................................................&#160;25</p>
<p style="position:absolute;top:764px;left:94px;white-space:nowrap" class="ft74">6.1&#160;External Interfaces...............................................................................................&#160;25</p>
<p style="position:absolute;top:783px;left:102px;white-space:nowrap" class="ft77">6.1.1&#160;class&#160;PlayerInterface........................................................................................&#160;25<br/>6.1.2&#160;class&#160;ManagementInterface.............................................................................&#160;26<br/>6.1.3&#160;class&#160;Utility......................................................................................................&#160;26</p>
<p style="position:absolute;top:841px;left:94px;white-space:nowrap" class="ft74">6.2&#160;Internal Interfaces................................................................................................&#160;27</p>
<p style="position:absolute;top:860px;left:102px;white-space:nowrap" class="ft77">6.2.1&#160;Class&#160;DatabaseManager..................................................................................&#160;27<br/>6.2.2&#160;Class&#160;InterpreterInterface................................................................................&#160;28<br/>6.2.3&#160;class&#160;SystemState...........................................................................................&#160;29<br/>6.2.4&#160;class&#160;CoreManager..........................................................................................&#160;29<br/>6.2.5&#160;class&#160;LicenseManager......................................................................................&#160;29<br/>6.2.6&#160;class&#160;LicenseTranslationManager....................................................................&#160;30<br/>6.2.7&#160;class&#160;StateManager.........................................................................................&#160;31</p>
<p style="position:absolute;top:994px;left:94px;white-space:nowrap" class="ft74">6.3&#160;Helper Classes......................................................................................................&#160;32</p>
<p style="position:absolute;top:1014px;left:102px;white-space:nowrap" class="ft77">6.3.1&#160;class&#160;ItemReference........................................................................................&#160;32<br/>6.3.2&#160;class&#160;ItemState................................................................................................&#160;32<br/>6.3.3&#160;class&#160;Key..........................................................................................................&#160;32<br/>6.3.4&#160;class&#160;License....................................................................................................&#160;33<br/>6.3.5&#160;class&#160;PlayerState.............................................................................................&#160;33<br/>6.3.6&#160;class&#160;REL..........................................................................................................&#160;34</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft716">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft716">2/39</p>
</div>
<!-- Page 8 -->
<a name="8"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page8-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables008.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft815">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft80">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft816">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft816">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft87">7&#160;.Annex A&#160;: C++ Header definition.............................................................................&#160;36<br/>8&#160;.Glossary&#160;of Abbreviations........................................................................................&#160;38<br/>9&#160;.References...............................................................................................................&#160;39</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft816">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft816">3/39</p>
</div>
<!-- Page 9 -->
<a name="9"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page9-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables009.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft915">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft90">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft916">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft916">FINAL |&#160;1.10</p>
<p style="position:absolute;top:169px;left:85px;white-space:nowrap" class="ft917"><b>List&#160;of figures</b></p>
<p style="position:absolute;top:206px;left:85px;white-space:nowrap" class="ft97">Figure 1: System Overview...........................................................................................&#160;13<br/>Figure 2: License Translation........................................................................................&#160;17<br/>Figure 3: Internal and external components&#160;of DRM Core............................................&#160;20<br/>Figure 4: Sequence diagram&#160;for media&#160;playback.........................................................&#160;21<br/>Figure 5: Virtualization of the DRM Core.......................................................................22<br/>Figure 6: Interface Chain..............................................................................................&#160;23</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft916">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft916">4/39</p>
</div>
<!-- Page 10 -->
<a name="10"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1018{font-size:18px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page10-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables010.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1015">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft100">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft1016">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft1016">FINAL |&#160;1.10</p>
<p style="position:absolute;top:169px;left:85px;white-space:nowrap" class="ft1018"><b>1.&#160;Introduction</b></p>
<p style="position:absolute;top:199px;left:94px;white-space:nowrap" class="ft107">This&#160;document collects&#160;the preliminary&#160;specifications&#160;of a DRM system&#160;to be&#160;<br/>developed as&#160;sample application&#160;for the OpenTC framework. These specifications&#160;<br/>define the scope of system,&#160;describe its functional requirements&#160;and its&#160;design. The&#160;<br/>design sections of&#160;this document&#160;are mainly focused&#160;on the definition of the system&#160;<br/>architecture by depicting the system modules, the function of each&#160;of them&#160;and the&#160;<br/>related interactions.&#160;<br/>The formats&#160;for the data&#160;exchanged between the external modules,&#160;like the &#160;between&#160;<br/>the OpenTC Player&#160;and DRM Core, have not yet been defined. Moreover the&#160;<br/>interactions&#160;with the services&#160;provided by OpenTC framework are&#160;just&#160;outlined and&#160;<br/>exposed&#160;in terms of&#160;requirements,&#160;since the definition of the interfaces&#160;to those&#160;<br/>services is still an&#160;ongoing activity&#160;within the workpackages&#160;three to&#160;five. The exact&#160;<br/>details of these interactions&#160;and definition&#160;of the formats&#160;for the data exchanged&#160;<br/>between the components&#160;of the DRM system will be included in&#160;the final&#160;<br/>specifications.<br/>The principal scope of the OpenTC DRM system&#160;will be the protection&#160;of multimedia&#160;<br/>content. Generalization of the DRM system&#160;for the protection of other contents,&#160;such&#160;<br/>as&#160;personal&#160;data,&#160;secret information&#160;or&#160;medical&#160;records&#160;of the patients, would be&#160;<br/>possible &#160;through extension of&#160;the OpenTC DRM system.&#160;However, specific&#160;<br/>implementation&#160;of such generalization will not be implemented in this&#160;sub-<br/>workpackage.<br/>This&#160;document is organized into 9 sections.&#160;Section 2 describes the functional&#160;<br/>requirements&#160;in terms&#160;of use cases&#160;while sections&#160;3 and 4 include the design&#160;<br/>specifications&#160;of the system.&#160;Section 5 shows&#160;the requirements&#160;for this application&#160;<br/>within the OpenTC System. Section 6 describes a&#160;preliminary&#160;API&#160;used to&#160;access&#160;the&#160;<br/>DRM Core, and its key functions. Section 7 is a normative&#160;API&#160;definition in C++, while&#160;<br/>sections 8 and 9 provide glossary&#160;and references&#160;to the terms and technologies used&#160;<br/>in the DRM system.</p>
<p style="position:absolute;top:771px;left:85px;white-space:nowrap" class="ft1010"><b>2.&#160;Use Cases</b></p>
<p style="position:absolute;top:823px;left:85px;white-space:nowrap" class="ft1011"><i><b>2.1&#160;Overview</b></i></p>
<p style="position:absolute;top:855px;left:85px;white-space:nowrap" class="ft108">The Interoperable DRM system application scenario&#160;describes a&#160;DRM system that&#160;is&#160;<br/>based on Trusted Computing and MPEG-21 for protecting multimedia content. The&#160;<br/>system&#160;can&#160;be divided in 2 main parts:&#160;the DRM Core and the secure application.&#160;<br/>The DRM-core is an operating system&#160;component that&#160;handles the content licenses&#160;<br/>and the content keys. It&#160;exposes&#160;this&#160;functionality &#160;through an application&#160;<br/>programming&#160;interface (DRM Core-API)&#160;to&#160;applications.&#160;The DRM-core&#160;is responsible&#160;<br/>for&#160;parsing licenses, deciding on whether access&#160;to requested content&#160;is allowed and&#160;<br/>managing the content keys.<br/>The secure application&#160;in&#160;the simplest&#160;case&#160;a media&#160;player. The application&#160;uses the&#160;<br/>DRM Core-API&#160;provided by the DRM-core to&#160;gain access&#160;to&#160;protected content. After&#160;a&#160;<br/>verification&#160;process,&#160;the application&#160;receives&#160;the content key from the DRM Core and&#160;<br/>is able to render&#160;the content.<br/>The user can&#160;perform&#160;different actions&#160;with the secure&#160;application.&#160;Every action&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1016">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft1016">5/39</p>
</div>
<!-- Page 11 -->
<a name="11"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1119{font-size:17px;line-height:27px;font-family:DAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page11-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables011.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1115">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft110">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft1116">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft1116">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft117">triggers a&#160;process&#160;between the application&#160;and the DRM Core. For&#160;the DRM system&#160;we&#160;<br/>differentiate&#160;between these 5 main actions:</p>
<p style="position:absolute;top:201px;left:85px;white-space:nowrap" class="ft1112">–</p>
<p style="position:absolute;top:198px;left:112px;white-space:nowrap" class="ft114">Initialization of the system</p>
<p style="position:absolute;top:230px;left:85px;white-space:nowrap" class="ft1112">–</p>
<p style="position:absolute;top:227px;left:112px;white-space:nowrap" class="ft114">Download content</p>
<p style="position:absolute;top:258px;left:85px;white-space:nowrap" class="ft1112">–</p>
<p style="position:absolute;top:255px;left:112px;white-space:nowrap" class="ft114">View / Play Content</p>
<p style="position:absolute;top:287px;left:85px;white-space:nowrap" class="ft1112">–</p>
<p style="position:absolute;top:284px;left:112px;white-space:nowrap" class="ft114">Renew License</p>
<p style="position:absolute;top:315px;left:85px;white-space:nowrap" class="ft1112">–</p>
<p style="position:absolute;top:312px;left:112px;white-space:nowrap" class="ft114">Transfer&#160;License</p>
<p style="position:absolute;top:341px;left:85px;white-space:nowrap" class="ft117">In the following sections these different use cases&#160;are&#160;explained in detail. They&#160;<br/>describe step by step, what happens&#160;when the user&#160;intends&#160;to perform an&#160;action.&#160;</p>
<p style="position:absolute;top:397px;left:85px;white-space:nowrap" class="ft1111"><i><b>2.2&#160;Description&#160;of&#160;Use Cases</b></i></p>
<p style="position:absolute;top:453px;left:89px;white-space:nowrap" class="ft114">Use Case&#160;Unique ID</p>
<p style="position:absolute;top:453px;left:451px;white-space:nowrap" class="ft114">/ UC 10 /</p>
<p style="position:absolute;top:480px;left:89px;white-space:nowrap" class="ft114">Title</p>
<p style="position:absolute;top:480px;left:455px;white-space:nowrap" class="ft114">Initialization of the system</p>
<p style="position:absolute;top:508px;left:89px;white-space:nowrap" class="ft114">Description</p>
<p style="position:absolute;top:508px;left:451px;white-space:nowrap" class="ft117">The administrator&#160;initializes&#160;the DRM&#160;<br/>System within the OpenTC framework.</p>
<p style="position:absolute;top:554px;left:89px;white-space:nowrap" class="ft114">Actors</p>
<p style="position:absolute;top:554px;left:451px;white-space:nowrap" class="ft114">Administrator</p>
<p style="position:absolute;top:582px;left:89px;white-space:nowrap" class="ft114">Preconditions</p>
<p style="position:absolute;top:582px;left:451px;white-space:nowrap" class="ft114">The OpenTC framework&#160;was started.</p>
<p style="position:absolute;top:609px;left:89px;white-space:nowrap" class="ft114">Postconditions</p>
<p style="position:absolute;top:609px;left:451px;white-space:nowrap" class="ft114">The DRM Core was&#160;initialized.</p>
<p style="position:absolute;top:637px;left:89px;white-space:nowrap" class="ft1119">Comment<br/>Normal&#160;Flow</p>
<p style="position:absolute;top:664px;left:478px;white-space:nowrap" class="ft114">1.&#160;The Administrator&#160;installs a&#160;DRM-</p>
<p style="position:absolute;top:684px;left:505px;white-space:nowrap" class="ft117">Core and starts&#160;it in a separate&#160;<br/>compartment.</p>
<p style="position:absolute;top:722px;left:478px;white-space:nowrap" class="ft114">2.&#160;The Administrator&#160;installs user&#160;</p>
<p style="position:absolute;top:741px;left:505px;white-space:nowrap" class="ft117">space&#160;applications,&#160;that can&#160;be&#160;<br/>executed in&#160;the secure&#160;<br/>environment for rendering of the&#160;<br/>content.</p>
<p style="position:absolute;top:818px;left:478px;white-space:nowrap" class="ft114">3.&#160;The administrator&#160;establishes the&#160;</p>
<p style="position:absolute;top:837px;left:505px;white-space:nowrap" class="ft114">following requirements:</p>
<p style="position:absolute;top:859px;left:505px;white-space:nowrap" class="ft1112">•</p>
<p style="position:absolute;top:856px;left:532px;white-space:nowrap" class="ft117">Trusted I/O Channels: We need&#160;<br/>a secure audio and video&#160;output&#160;<br/>path for rendering content.</p>
<p style="position:absolute;top:917px;left:505px;white-space:nowrap" class="ft1112">•</p>
<p style="position:absolute;top:914px;left:532px;white-space:nowrap" class="ft117">Access&#160;to&#160;the trusted&#160;services&#160;<br/>from the compartment,&#160;<br/>especially to&#160;the DRM Core and&#160;<br/>the TSS Stack.&#160;Access&#160;to&#160;the&#160;<br/>Core will be limited by its&#160;API.</p>
<p style="position:absolute;top:1013px;left:505px;white-space:nowrap" class="ft1112">•</p>
<p style="position:absolute;top:1011px;left:532px;white-space:nowrap" class="ft117">Ability to display an application&#160;<br/>in a&#160;Window-System,&#160;which is&#160;<br/>started&#160;in the secure&#160;<br/>environment. An efficient&#160;<br/>method for video&#160;rendering&#160;<br/>should also&#160;be supported&#160;in a&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1116">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft1116">6/39</p>
</div>
<!-- Page 12 -->
<a name="12"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page12-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables012.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1215">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft120">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft1216">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft1216">FINAL |&#160;1.10</p>
<p style="position:absolute;top:155px;left:532px;white-space:nowrap" class="ft127">secure manner (for example&#160;<br/>Overlay).&#160;</p>
<p style="position:absolute;top:197px;left:505px;white-space:nowrap" class="ft1212">•</p>
<p style="position:absolute;top:194px;left:532px;white-space:nowrap" class="ft127">Integrity&#160;measurement of all&#160;<br/>applications&#160;and plugIns&#160;that&#160;<br/>can be used to reproduce&#160;<br/>content in&#160;a&#160;secure way.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1216">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft1216">7/39</p>
</div>
<!-- Page 13 -->
<a name="13"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page13-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables013.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1315">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft130">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft1316">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft1316">FINAL |&#160;1.10</p>
<p style="position:absolute;top:155px;left:89px;white-space:nowrap" class="ft134">Use Case&#160;Unique ID</p>
<p style="position:absolute;top:155px;left:451px;white-space:nowrap" class="ft134">/ UC 20 /</p>
<p style="position:absolute;top:183px;left:89px;white-space:nowrap" class="ft134">Title</p>
<p style="position:absolute;top:183px;left:455px;white-space:nowrap" class="ft134">Download&#160;content</p>
<p style="position:absolute;top:210px;left:89px;white-space:nowrap" class="ft134">Description</p>
<p style="position:absolute;top:210px;left:451px;white-space:nowrap" class="ft134">The user downloads&#160;a content.</p>
<p style="position:absolute;top:238px;left:89px;white-space:nowrap" class="ft134">Actors</p>
<p style="position:absolute;top:238px;left:451px;white-space:nowrap" class="ft134">User</p>
<p style="position:absolute;top:265px;left:89px;white-space:nowrap" class="ft134">Preconditions</p>
<p style="position:absolute;top:265px;left:451px;white-space:nowrap" class="ft137">The &#160;OpenTC framework&#160;was started&#160;and&#160;<br/>the DRM Core is running in&#160;a&#160;secure&#160;<br/>environment.</p>
<p style="position:absolute;top:331px;left:89px;white-space:nowrap" class="ft134">Postconditions</p>
<p style="position:absolute;top:331px;left:451px;white-space:nowrap" class="ft137">The content&#160;keys and the license are kept&#160;<br/>secure in the sealed storage.</p>
<p style="position:absolute;top:378px;left:89px;white-space:nowrap" class="ft1319">Comment<br/>Normal&#160;Flow</p>
<p style="position:absolute;top:406px;left:478px;white-space:nowrap" class="ft134">1.&#160;The user downloads&#160;a container&#160;file&#160;</p>
<p style="position:absolute;top:425px;left:505px;white-space:nowrap" class="ft137">either from a&#160;provider&#160;or another&#160;<br/>user. The file consists&#160;of the&#160;<br/>multimedia&#160;content. The&#160;<br/>downloading and the storage&#160;can&#160;<br/>be unsecured, because&#160;the data is&#160;<br/>always&#160;encrypted.&#160;<br/>The license can&#160;also&#160;be transferred&#160;<br/>in this step. It&#160;doesn't&#160;need to be&#160;<br/>protected, since it is signed by the&#160;<br/>content provider.</p>
<p style="position:absolute;top:617px;left:478px;white-space:nowrap" class="ft134">2.&#160;The user initializes the secure&#160;</p>
<p style="position:absolute;top:636px;left:505px;white-space:nowrap" class="ft134">environment.</p>
<p style="position:absolute;top:655px;left:478px;white-space:nowrap" class="ft134">3.&#160;The user starts&#160;the player&#160;</p>
<p style="position:absolute;top:674px;left:505px;white-space:nowrap" class="ft137">application&#160;for the retrieval of the&#160;<br/>content keys.</p>
<p style="position:absolute;top:713px;left:478px;white-space:nowrap" class="ft134">4.&#160;The player application&#160;establishes a&#160;</p>
<p style="position:absolute;top:732px;left:505px;white-space:nowrap" class="ft137">secured connection to&#160;the provider&#160;<br/>for exchanging the content keys.</p>
<p style="position:absolute;top:770px;left:478px;white-space:nowrap" class="ft134">5.&#160;The DRM Core starts&#160;a&#160;mutual&#160;</p>
<p style="position:absolute;top:790px;left:505px;white-space:nowrap" class="ft137">authentication&#160;round. The keys may&#160;<br/>only&#160;be transferred when the&#160;<br/>existence of a&#160;trusted DRM-core&#160;<br/>within a secure environment is&#160;<br/>detected at&#160;the receiver side, thus&#160;<br/>the download procedure&#160;may start&#160;<br/>after a successful&#160;authentication.&#160;<br/>The authentication is planned to&#160;be&#160;<br/>based on remote attestation&#160;and&#160;<br/>generation of attestation&#160;identity&#160;<br/>keys&#160;(AIKs)&#160;by the TPM.</p>
<p style="position:absolute;top:1001px;left:478px;white-space:nowrap" class="ft134">6.&#160;The DRM Core exchanges the&#160;</p>
<p style="position:absolute;top:1020px;left:505px;white-space:nowrap" class="ft137">content keys. The keys are&#160;<br/>managed by the DRM-core,&#160;which&#160;<br/>stores&#160;them&#160;in a central&#160;key store&#160;<br/>along with a&#160;Digital Item&#160;Identifier&#160;<br/>(DII).&#160;The same identifier resides&#160;in&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1316">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft1316">8/39</p>
</div>
<!-- Page 14 -->
<a name="14"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page14-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables014.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1415">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft140">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft1416">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft1416">FINAL |&#160;1.10</p>
<p style="position:absolute;top:155px;left:505px;white-space:nowrap" class="ft147">the license within the content&#160;<br/>container. The content key&#160;<br/>download&#160;procedure may&#160;be&#160;<br/>separate&#160;to the content download&#160;<br/>procedure, but&#160;always takes&#160;place&#160;<br/>under the DRM-core's&#160;control.</p>
<p style="position:absolute;top:270px;left:478px;white-space:nowrap" class="ft144">7.&#160;The license for&#160;the content&#160;is&#160;</p>
<p style="position:absolute;top:290px;left:505px;white-space:nowrap" class="ft147">checked and preprocessed.&#160;The&#160;<br/>important&#160;information&#160;of the license&#160;<br/>is stored in the sealed store.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1416">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft1416">9/39</p>
</div>
<!-- Page 15 -->
<a name="15"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page15-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables015.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1515">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft150">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft1516">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft1516">FINAL |&#160;1.10</p>
<p style="position:absolute;top:183px;left:89px;white-space:nowrap" class="ft154">Use Case&#160;Unique ID</p>
<p style="position:absolute;top:183px;left:452px;white-space:nowrap" class="ft154">/ UC 30 /</p>
<p style="position:absolute;top:211px;left:89px;white-space:nowrap" class="ft154">Title</p>
<p style="position:absolute;top:211px;left:456px;white-space:nowrap" class="ft154">View / Play content</p>
<p style="position:absolute;top:238px;left:89px;white-space:nowrap" class="ft154">Description</p>
<p style="position:absolute;top:238px;left:452px;white-space:nowrap" class="ft157">The user tells the player&#160;that he wants to&#160;<br/>view the content&#160;of a protected file.</p>
<p style="position:absolute;top:285px;left:89px;white-space:nowrap" class="ft154">Actors</p>
<p style="position:absolute;top:285px;left:452px;white-space:nowrap" class="ft154">User</p>
<p style="position:absolute;top:313px;left:89px;white-space:nowrap" class="ft154">Preconditions</p>
<p style="position:absolute;top:313px;left:452px;white-space:nowrap" class="ft157">The OpenTC framework was&#160;started&#160;and&#160;<br/>the player&#160;application&#160;and DRM Core are&#160;<br/>running in a&#160;secure environment.</p>
<p style="position:absolute;top:379px;left:89px;white-space:nowrap" class="ft1519">Postconditions<br/>Comment<br/>Normal&#160;Flow</p>
<p style="position:absolute;top:434px;left:479px;white-space:nowrap" class="ft154">1.&#160;The user starts&#160;a player&#160;application,&#160;</p>
<p style="position:absolute;top:453px;left:506px;white-space:nowrap" class="ft157">which runs in the secure&#160;<br/>environment.</p>
<p style="position:absolute;top:491px;left:479px;white-space:nowrap" class="ft154">2.&#160;The user triggers&#160;the application&#160;to&#160;</p>
<p style="position:absolute;top:511px;left:506px;white-space:nowrap" class="ft157">access&#160;a protected&#160;media&#160;file for&#160;<br/>rendering.&#160;</p>
<p style="position:absolute;top:549px;left:479px;white-space:nowrap" class="ft154">3.&#160;The player&#160;application&#160;registers&#160;</p>
<p style="position:absolute;top:568px;left:506px;white-space:nowrap" class="ft157">with the DRM-Core. Then it asks&#160;the&#160;<br/>DRM-core&#160;through the API&#160;to&#160;enable&#160;<br/>access&#160;to&#160;the protected&#160;information&#160;<br/>by handing out the content key&#160;<br/>from&#160;the key store.</p>
<p style="position:absolute;top:664px;left:479px;white-space:nowrap" class="ft154">4.&#160;The Core is presented with the&#160;</p>
<p style="position:absolute;top:683px;left:506px;white-space:nowrap" class="ft157">content's&#160;license from&#160;the&#160;<br/>container&#160;file along with the&#160;<br/>requested action&#160;(e.g. play,&#160;print,&#160;<br/>modify etc.) and decides&#160;on&#160;<br/>whether&#160;access&#160;is granted or&#160;not. If&#160;<br/>yes, the DII is used to query the&#160;<br/>key store for&#160;the content&#160;key. The&#160;<br/>key store itself is an&#160;encrypted file&#160;<br/>and is protected&#160;by sealing its&#160;key&#160;<br/>to&#160;a trusted system&#160;configuration.&#160;<br/>Thus, the core&#160;can only access&#160;the&#160;<br/>key store when the system&#160;is in a&#160;<br/>known trusted state.&#160;</p>
<p style="position:absolute;top:933px;left:479px;white-space:nowrap" class="ft154">5.&#160;Then the DRM-Core hands out the&#160;</p>
<p style="position:absolute;top:952px;left:506px;white-space:nowrap" class="ft157">content&#160;key to&#160;the application.&#160;It&#160;<br/>poses&#160;no threat since the system&#160;<br/>and the player&#160;application&#160;are&#160;<br/>trusted.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1516">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft1516">10/39</p>
</div>
<!-- Page 16 -->
<a name="16"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page16-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables016.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1615">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft160">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft1616">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft1616">FINAL |&#160;1.10</p>
<p style="position:absolute;top:155px;left:89px;white-space:nowrap" class="ft164">Use Case&#160;Unique ID</p>
<p style="position:absolute;top:155px;left:451px;white-space:nowrap" class="ft164">/ UC 40 /</p>
<p style="position:absolute;top:183px;left:89px;white-space:nowrap" class="ft164">Title</p>
<p style="position:absolute;top:183px;left:454px;white-space:nowrap" class="ft164">Renew License</p>
<p style="position:absolute;top:210px;left:89px;white-space:nowrap" class="ft164">Description</p>
<p style="position:absolute;top:210px;left:451px;white-space:nowrap" class="ft167">Generally licenses are&#160;valid until a&#160;final&#160;<br/>date. After this&#160;date, the license expires&#160;<br/>and the user has&#160;to renew his license from&#160;<br/>a license server.</p>
<p style="position:absolute;top:295px;left:89px;white-space:nowrap" class="ft164">Actors</p>
<p style="position:absolute;top:295px;left:451px;white-space:nowrap" class="ft164">User</p>
<p style="position:absolute;top:323px;left:89px;white-space:nowrap" class="ft164">Preconditions</p>
<p style="position:absolute;top:323px;left:451px;white-space:nowrap" class="ft167">The OpenTC framework&#160;was started&#160;and&#160;<br/>the DRM Core is running in&#160;a&#160;secure&#160;<br/>environment.</p>
<p style="position:absolute;top:389px;left:89px;white-space:nowrap" class="ft164">Postconditions</p>
<p style="position:absolute;top:389px;left:451px;white-space:nowrap" class="ft167">New license is stored securely in&#160;the&#160;<br/>sealed storage.</p>
<p style="position:absolute;top:436px;left:89px;white-space:nowrap" class="ft1619">Comment<br/>Normal&#160;Flow</p>
<p style="position:absolute;top:463px;left:478px;white-space:nowrap" class="ft164">1.&#160;The user triggers the license&#160;</p>
<p style="position:absolute;top:482px;left:505px;white-space:nowrap" class="ft167">renewal and the player&#160;application&#160;<br/>connects&#160;to the content provider.&#160;</p>
<p style="position:absolute;top:521px;left:478px;white-space:nowrap" class="ft164">2.&#160;The DRM-Core performs&#160;an&#160;</p>
<p style="position:absolute;top:540px;left:505px;white-space:nowrap" class="ft167">authentication&#160;procedure similar&#160;to&#160;<br/>that in the download procedure.</p>
<p style="position:absolute;top:578px;left:478px;white-space:nowrap" class="ft164">3.&#160;The player application&#160;replaces the&#160;</p>
<p style="position:absolute;top:598px;left:505px;white-space:nowrap" class="ft164">existing license by a new one.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1616">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft1616">11/39</p>
</div>
<!-- Page 17 -->
<a name="17"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page17-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables017.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1715">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft170">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft1716">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft1716">FINAL |&#160;1.10</p>
<p style="position:absolute;top:155px;left:89px;white-space:nowrap" class="ft174">Use Case&#160;Unique ID</p>
<p style="position:absolute;top:155px;left:451px;white-space:nowrap" class="ft174">/ UC 50 /</p>
<p style="position:absolute;top:183px;left:89px;white-space:nowrap" class="ft174">Title</p>
<p style="position:absolute;top:183px;left:455px;white-space:nowrap" class="ft174">Transfer License</p>
<p style="position:absolute;top:210px;left:89px;white-space:nowrap" class="ft174">Description</p>
<p style="position:absolute;top:210px;left:451px;white-space:nowrap" class="ft177">Licenses are transferred&#160;to other&#160;<br/>computers&#160;or are&#160;translated to&#160;other DRM-<br/>Systems.</p>
<p style="position:absolute;top:276px;left:89px;white-space:nowrap" class="ft174">Actors</p>
<p style="position:absolute;top:276px;left:451px;white-space:nowrap" class="ft174">User</p>
<p style="position:absolute;top:304px;left:89px;white-space:nowrap" class="ft174">Preconditions</p>
<p style="position:absolute;top:304px;left:451px;white-space:nowrap" class="ft177">The OpenTC framework&#160;was started&#160;and&#160;<br/>the DRM Core is running in&#160;a&#160;secure&#160;<br/>environment. Manager application&#160;and&#160;<br/>target DRM system&#160;are running in&#160;a&#160;<br/>secure environment.</p>
<p style="position:absolute;top:408px;left:89px;white-space:nowrap" class="ft174">Postconditions</p>
<p style="position:absolute;top:408px;left:451px;white-space:nowrap" class="ft177">Transferred license is stored&#160;secure in&#160;<br/>target DRM system.</p>
<p style="position:absolute;top:455px;left:89px;white-space:nowrap" class="ft1719">Comment<br/>Normal&#160;Flow</p>
<p style="position:absolute;top:482px;left:478px;white-space:nowrap" class="ft177">1.&#160;The user initiates&#160;a transfer.<br/>2.&#160;Then the Manager application&#160;</p>
<p style="position:absolute;top:521px;left:505px;white-space:nowrap" class="ft177">establishes a&#160;secure and&#160;<br/>authenticated&#160;connection between&#160;<br/>the two&#160;systems.&#160;The license and&#160;<br/>content key are transmitted&#160;<br/>securely. A similar&#160;authentication&#160;<br/>procedure as&#160;in the download&#160;and&#160;<br/>renew license use case&#160; is required.</p>
<p style="position:absolute;top:655px;left:478px;white-space:nowrap" class="ft174">3.&#160;In case&#160;a different DRM system&#160;</p>
<p style="position:absolute;top:674px;left:505px;white-space:nowrap" class="ft177">needs to&#160;be supported, the existing&#160;<br/>license must be translated by the&#160;<br/>DRM Core. The translation&#160;may&#160;also&#160;<br/>require a re-encryption&#160;of the&#160;<br/>content. Furthermore,&#160;the&#160;<br/>translated license has&#160;to be signed&#160;<br/>by the DRM Core, which will use the&#160;<br/>TPM to&#160;enable trust to&#160;its signature.</p>
<p style="position:absolute;top:828px;left:478px;white-space:nowrap" class="ft174">4.&#160;The player application&#160;transmits&#160;</p>
<p style="position:absolute;top:847px;left:505px;white-space:nowrap" class="ft177">the content&#160;itself. This&#160;is not a&#160;<br/>security problem, since&#160;the&#160;<br/>transferred data&#160;is always&#160;<br/>encrypted.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1716">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft1716">12/39</p>
</div>
<!-- Page 18 -->
<a name="18"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1820{font-size:18px;font-family:EAAAAA+BitstreamVeraSans;color:#000000;}
	.ft1821{font-size:18px;font-family:GAAAAA+ArialMT;color:#000000;}
	.ft1822{font-size:15px;font-family:GAAAAA+ArialMT;color:#000000;}
	.ft1823{font-size:12px;font-family:GAAAAA+ArialMT;color:#000000;}
	.ft1824{font-size:18px;font-family:GAAAAA+ArialMT;color:#ffffff;}
	.ft1825{font-size:18px;line-height:27px;font-family:GAAAAA+ArialMT;color:#000000;}
-->
</style>
<div id="page18-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables018.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1815">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft180">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft1816">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft1816">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft1810"><b>3.&#160;Design&#160;Specifications</b></p>
<p style="position:absolute;top:202px;left:85px;white-space:nowrap" class="ft1811"><i><b>3.1&#160;Architecture</b></i></p>
<p style="position:absolute;top:234px;left:85px;white-space:nowrap" class="ft187">The&#160;diagram&#160;below&#160;shows&#160;the&#160;major&#160;components&#160;which&#160;make&#160;up&#160;the&#160;OpenTC&#160;DRM&#160;<br/>system.&#160;The&#160;entire&#160;system&#160;can&#160;be&#160;divided&#160;into&#160;3&#160;sections,&#160;namely&#160;applications&#160;running&#160;<br/>in&#160;userspace,&#160;the&#160;DRM&#160;Core&#160;which&#160;is&#160;running&#160;in&#160;a&#160;secure&#160;compartment,&#160;and&#160;security&#160;<br/>services&#160;&#160;&#160;provided&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;operating&#160;&#160;&#160;system&#160;&#160;&#160;and&#160;&#160;&#160;compartment&#160;&#160;&#160;management.&#160;&#160;The&#160;<br/>precise&#160;separation&#160;of&#160;the&#160;system&#160;components&#160;among&#160;different&#160;secured&#160;compartments&#160;<br/>is&#160;&#160;&#160;explained&#160;&#160;&#160;in&#160;&#160;&#160;section&#160;<a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#27">&#160;4.3.&#160;</a>&#160;&#160;The&#160;&#160;&#160;following&#160;&#160;&#160;sections&#160;&#160;&#160;will&#160;&#160;&#160;explain&#160;&#160;&#160;the&#160;&#160;&#160;individual&#160;<br/>components&#160;of the system&#160;in detail.</p>
<p style="position:absolute;top:864px;left:85px;white-space:nowrap" class="ft1811"><i><b>3.2&#160;Player API</b></i></p>
<p style="position:absolute;top:914px;left:85px;white-space:nowrap" class="ft1820"><i><b>3.2.1&#160;Registration</b></i></p>
<p style="position:absolute;top:944px;left:85px;white-space:nowrap" class="ft187">Each Player&#160;who wants&#160;to access&#160;a protected&#160;content must register with the DRM Core&#160;<br/>first. During Registration&#160;a mutual authentication&#160;is performed,&#160;so that&#160;the Player&#160;and&#160;<br/>DRM Core validate the integrity and security status&#160;of the other party.&#160;<br/>Additionally, the Core gets&#160;some information&#160;about the player, e.g. the version&#160;number&#160;<br/>or&#160;process&#160;information,&#160;so&#160;that the Core can&#160;distinguish between multiple Players&#160;on&#160;<br/>the same machine. After the authentication&#160;the capability&#160;negotiation follows,&#160;where&#160;<br/>the Core&#160;negotiates&#160;a common&#160;rule set with the Player instance. This rule set&#160;defines&#160;<br/>the REL commands,&#160;that&#160;both, Player and Core,&#160;have a&#160;common&#160;understanding of. This&#160;<br/>mechanism&#160;enables the Core&#160;to discover,&#160;which commands&#160;the player supports&#160;and in&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1816">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft1816">13/39</p>
<p style="position:absolute;top:809px;left:345px;white-space:nowrap" class="ft1816">Figure&#160;1: System&#160;Overview</p>
<p style="position:absolute;top:570px;left:534px;white-space:nowrap" class="ft1821">License&#160;</p>
<p style="position:absolute;top:597px;left:531px;white-space:nowrap" class="ft1821">Manager</p>
<p style="position:absolute;top:624px;left:537px;white-space:nowrap" class="ft1822">(License&#160;</p>
<p style="position:absolute;top:647px;left:522px;white-space:nowrap" class="ft1822">Interpretation</p>
<p style="position:absolute;top:670px;left:520px;white-space:nowrap" class="ft1822">&amp;&#160;Translation)</p>
<p style="position:absolute;top:526px;left:299px;white-space:nowrap" class="ft1821">Player&#160;</p>
<p style="position:absolute;top:553px;left:313px;white-space:nowrap" class="ft1821">API</p>
<p style="position:absolute;top:526px;left:411px;white-space:nowrap" class="ft1821">Manager</p>
<p style="position:absolute;top:553px;left:433px;white-space:nowrap" class="ft1821">API</p>
<p style="position:absolute;top:591px;left:428px;white-space:nowrap" class="ft1821">Core</p>
<p style="position:absolute;top:618px;left:411px;white-space:nowrap" class="ft1821">Manager</p>
<p style="position:absolute;top:649px;left:278px;white-space:nowrap" class="ft1822">Sealed storage</p>
<p style="position:absolute;top:671px;left:283px;white-space:nowrap" class="ft1822">(Key/License&#160;</p>
<p style="position:absolute;top:692px;left:308px;white-space:nowrap" class="ft1822">Store)</p>
<p style="position:absolute;top:655px;left:403px;white-space:nowrap" class="ft1821">Application</p>
<p style="position:absolute;top:683px;left:419px;white-space:nowrap" class="ft1821">Loader</p>
<p style="position:absolute;top:788px;left:280px;white-space:nowrap" class="ft1823">Sealing</p>
<p style="position:absolute;top:788px;left:460px;white-space:nowrap" class="ft1823">Secure Time</p>
<p style="position:absolute;top:788px;left:568px;white-space:nowrap" class="ft1823">Attestation</p>
<p style="position:absolute;top:787px;left:660px;white-space:nowrap" class="ft1823">Crypto.&#160;Lib.</p>
<p style="position:absolute;top:788px;left:351px;white-space:nowrap" class="ft1823">Measurement</p>
<p style="position:absolute;top:451px;left:227px;white-space:nowrap" class="ft1824">Player</p>
<p style="position:absolute;top:424px;left:411px;white-space:nowrap" class="ft1824">Manager</p>
<p style="position:absolute;top:452px;left:431px;white-space:nowrap" class="ft1824">GUI</p>
<p style="position:absolute;top:451px;left:629px;white-space:nowrap" class="ft1824">I/O</p>
<p style="position:absolute;top:782px;left:157px;white-space:nowrap" class="ft1821">OS-Services</p>
<p style="position:absolute;top:558px;left:164px;white-space:nowrap" class="ft1825">DRM<br/>Core</p>
<p style="position:absolute;top:407px;left:160px;white-space:nowrap" class="ft1821">Userspace&#160;Applications</p>
<p style="position:absolute;top:521px;left:515px;white-space:nowrap" class="ft1821">Utility&#160;Library</p>
<p style="position:absolute;top:590px;left:303px;white-space:nowrap" class="ft1821">State&#160;</p>
<p style="position:absolute;top:618px;left:274px;white-space:nowrap" class="ft1821">Management</p>
</div>
<!-- Page 19 -->
<a name="19"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page19-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables019.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1915">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft190">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft1916">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft1916">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft197">what&#160;way the Core can control&#160;the Player.&#160;<br/>This restriction&#160;description&#160;can be done by using the subset of REL commands&#160;related&#160;<br/>to&#160;representing conditions&#160;on operations, time and state.&#160;This&#160;allows&#160;a well defined&#160;<br/>command&#160;set&#160;to be used, without defining a new standard.&#160;The specific&#160;command&#160;set&#160;<br/>is not defined in this&#160;preliminary&#160;document.&#160;<br/>After successful&#160;registration,&#160;the player&#160;is considered trustworthy&#160;to handle the&#160;<br/>protected&#160;content in&#160;a&#160;correct&#160;and predictable way.</p>
<p style="position:absolute;top:331px;left:85px;white-space:nowrap" class="ft1920"><i><b>3.2.2&#160;Content&#160;Key&#160;Handling</b></i></p>
<p style="position:absolute;top:360px;left:85px;white-space:nowrap" class="ft197">After a&#160;successful registration&#160;the player can&#160;request the content key for a particular&#160;<br/>protected&#160;content. This triggers&#160;a process&#160;of&#160;retrieving the associated&#160;license(s) of the&#160;<br/>selected content and interpretation&#160;of &#160;this&#160;license. The Core then comes&#160;to the&#160;<br/>decision if the player&#160;is allowed to access&#160;the content or&#160;not. This&#160;“Result” is described&#160;<br/>in a XML&#160;format&#160;similar&#160;to the MPEG-21 REL and is transmitted&#160;to the Player.<br/>If the Result is positive and the Player is generally allowed to access&#160;the content.&#160;<br/>Together with a positive Result,&#160;the Core also&#160;transmits&#160;the content key so&#160;that&#160;the&#160;<br/>Player&#160;can decrypt&#160;the content.<br/>Furthermore&#160;the Result may&#160;contain several additional conditions, which&#160;have to be&#160;<br/>enforced&#160;during the process&#160;of rendering. The content provider can&#160;define these&#160;<br/>conditions to&#160;specify in what way&#160;the content&#160;can be rendered. An example condition&#160;<br/>would be that&#160;the player should play&#160;only the first 10 seconds&#160;of a song.&#160;The player&#160;<br/>has&#160;to understand&#160;these conditions&#160;in order to&#160;be able to enforce it correctly.&#160;<br/>The capabilities of the player for these conditions are negotiated during the&#160;<br/>registration,&#160;so the Core knows&#160;which&#160;conditions&#160;the player is able to enforce.&#160;For&#160;<br/>example during the registration,&#160;the player informs&#160;the core,&#160;that&#160;he&#160;is able to enforce&#160;<br/>the rule “play only the first x&#160;seconds” and the Core saves&#160;this&#160;property in&#160;an&#160;internal&#160;<br/>storage.&#160;When a&#160;license is validated and this rule should be applied for the value 10,&#160;<br/>then the Core generates&#160;a Result, which contains&#160;the rule that states&#160;“play only the&#160;<br/>first 10 seconds”.&#160;<br/>Decryption Modules&#160;are needed, when the Player receives a&#160;positive Result and then&#160;<br/>wants&#160;to decrypt&#160;a specific&#160;content. Generally&#160;every content&#160;can use its own&#160;<br/>encryption algorithm depending on the producer of the content. If the Player wants&#160;to&#160;<br/>decrypt&#160;these contents,&#160;he needs&#160;access&#160;to&#160;all corresponding&#160;encryption&#160;libraries. This&#160;<br/>functionality&#160;is provided by the Utility Library,&#160;which the player can&#160;use to&#160;get access&#160;<br/>to&#160;a corresponding implementation of the encryption&#160;algorithm. The Utility Library&#160;is a&#160;<br/>part&#160;of the API&#160;and provides&#160;a standardised interface for essential algorithms. The&#160;<br/>mechanism&#160;within the Utility&#160;Library&#160;is explained in&#160;section<a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#23">&#160;3.9.</a></p>
<p style="position:absolute;top:961px;left:85px;white-space:nowrap" class="ft1920"><i><b>3.2.3&#160;Legacy&#160;Player&#160;Application</b></i></p>
<p style="position:absolute;top:991px;left:85px;white-space:nowrap" class="ft197">All specifications&#160;in&#160;the API&#160;are standardized and can&#160;be used by the player&#160;<br/>applications.&#160;Generally the Player&#160;should be compatible to the DRM-System to know&#160;<br/>the API&#160;of the core and how to&#160;handle content. Legacy&#160;players,&#160;which&#160;cannot&#160;access&#160;<br/>the API&#160;directly,&#160;are also&#160;supported&#160;by our&#160;architecture. Players&#160;of that&#160;kind are not&#160;<br/>aware&#160;of the DRM Core, but&#160;maybe favored by users for&#160;whatever&#160;reason. These cases&#160;<br/>are&#160;handled by an&#160;IO-Socket interface, in&#160;which the handling of license authentication&#160;<br/>and interpretation&#160;occurs&#160;transparent&#160;to the application.&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1916">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft1916">14/39</p>
</div>
<!-- Page 20 -->
<a name="20"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2026{font-size:17px;font-family:HAAAAA+CourierNewPSMT;color:#000000;}
-->
</style>
<div id="page20-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables020.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2015">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft200">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft2016">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft2016">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft207">For&#160;the player,&#160;the whole process&#160;is similar&#160;to a normal&#160;file access.&#160;The player&#160;only has&#160;<br/>to&#160;support the content’s&#160;type and be connected to the IO-Socket through a plug-in.&#160;<br/>The player&#160;receives the unprotected&#160;content from&#160;the socket&#160;and can&#160;render it. The IO-<br/>socket&#160;in this case&#160;converts&#160;and forwards&#160;requests&#160;through the API&#160;to the DRM Core.&#160;<br/>Since&#160;all applications,&#160;including the legacy&#160;ones, run in the secured environment,&#160;<br/>handing out the content key or the decrypted&#160;content itself is no problem, since it is&#160;<br/>guaranteed that&#160;the applications&#160;cannot&#160;compromise&#160;it.</p>
<p style="position:absolute;top:313px;left:85px;white-space:nowrap" class="ft2011"><i><b>3.3&#160;Manager API</b></i></p>
<p style="position:absolute;top:344px;left:85px;white-space:nowrap" class="ft207">Manager&#160;API&#160;provides an&#160;interface to&#160;management features&#160;of the DRM Core, such as&#160;<br/>inserting new licenses into the DRM Core&#160;and requesting for&#160;attestation&#160;keys.&#160;The&#160;<br/>Manager&#160;GUI&#160;uses&#160;this&#160;API&#160;(defined in&#160;</p>
<p style="position:absolute;top:384px;left:402px;white-space:nowrap" class="ft2026">ManagementInterface</p>
<p style="position:absolute;top:383px;left:590px;white-space:nowrap" class="ft204">), so that&#160;playback&#160;and&#160;</p>
<p style="position:absolute;top:403px;left:85px;white-space:nowrap" class="ft204">administrative functions of the DRM Core are clearly separated.</p>
<p style="position:absolute;top:449px;left:85px;white-space:nowrap" class="ft2011"><i><b>3.4&#160;Application loader</b></i></p>
<p style="position:absolute;top:481px;left:85px;white-space:nowrap" class="ft207">The initial loading of the DRM Core needs to be done in a secure manner. This should&#160;<br/>be handled by the compartment&#160;and device manager, which will check the integrity of&#160;<br/>the compartment&#160;image before loading the DRM Core. In&#160;addition to&#160;the main image, a&#160;<br/>secure persistent storage&#160;is used to provide secure storage&#160;for the DRM Core, that will&#160;<br/>be discussed&#160;in sections<a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#27">&#160;4.3.1</a><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#28">&#160;and&#160;4.3.2.</a></p>
<p style="position:absolute;top:604px;left:85px;white-space:nowrap" class="ft2011"><i><b>3.5&#160;Core&#160;Manager</b></i></p>
<p style="position:absolute;top:636px;left:85px;white-space:nowrap" class="ft207">The central component&#160;of the system&#160;is the Core Manager. It's&#160;tasks&#160;are the central&#160;<br/>management of the different parts&#160;of the DRM-Core. It coordinates&#160;the requests&#160;from&#160;<br/>the application&#160;layer and forwards&#160;them to the appropriate components.&#160;It&#160;also&#160;<br/>contains&#160;the error handling e.g. fail over, treatment&#160;of invalid data,&#160;error&#160;logging and&#160;<br/>exception handling.</p>
<p style="position:absolute;top:758px;left:85px;white-space:nowrap" class="ft2011"><i><b>3.6&#160;License Manager</b></i></p>
<p style="position:absolute;top:790px;left:85px;white-space:nowrap" class="ft207">The core&#160;manager implements the interface to&#160;the Player&#160;and Manager GUI, and&#160;<br/>coordinates&#160;the management and enforcement&#160;of licenses. When the player&#160;wants to&#160;<br/>decrypt&#160;a protected content&#160;for a&#160;particular action,&#160;it sends&#160;a request&#160;to the core&#160;<br/>manager,&#160;with a&#160;reference to the protected content&#160;and the request&#160;parameters.&#160;This&#160;<br/>request&#160;contains&#160;the rights and the corresponding license, which have to be verified. A&#160;<br/>request&#160;may&#160;also consist&#160;of multiple licenses.&#160;<br/>Upon request from&#160;the player, the DRM Core makes the appropriate query to the&#160;key /&#160;<br/>license storage, and sends the complete request to&#160;the license manager. In this case&#160;<br/>the License Interpreter&#160;has to&#160;verify each license and determine if the right may be&#160;<br/>granted over&#160;the content.<br/>Depending on the license type, this is performed by the appropriate&#160;license&#160;<br/>interpreter,&#160;generating an&#160;internal representation&#160;of the license. When the license is&#160;<br/>positively&#160;authorized, the content key is retrieved from&#160;the key storage&#160;and returned&#160;<br/>to&#160;the player with appropriate player restriction&#160;description.<br/>When this player restriction needs&#160;to be adapted, or if a license is requested, then the&#160;<br/>query is passed to&#160;the license translation&#160;manager.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft2016">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft2016">15/39</p>
</div>
<!-- Page 21 -->
<a name="21"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page21-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables021.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2115">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft210">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft2116">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft2116">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft2120"><i><b>3.6.1&#160;License&#160;Interpreter</b></i></p>
<p style="position:absolute;top:181px;left:85px;white-space:nowrap" class="ft217">The licenses, that&#160;are stored&#160;in&#160;the&#160;sealed storage&#160;are&#160;in an XML&#160;format.&#160;Before these&#160;<br/>licenses&#160;can be interpreted, license parsing needs to&#160;be carried&#160;out. This&#160;process&#160;maps&#160;<br/>a&#160;license into&#160;an internal representation&#160;suitable for interpretation.<br/>The parsing process&#160;takes place in two steps.&#160;First,&#160;the formal integrity of the received&#160;<br/>data&#160;is validated, for e.g. XML-formatted licenses&#160;this&#160;includes&#160;schema- or&#160;DTD-&#160;<br/>validation.&#160;<br/>In the second step the authenticity&#160;and integrity&#160;of the data&#160;must&#160;be validated. The&#160;<br/>most&#160;utilized approach&#160;is using digital signatures&#160;on the license, like XML&#160;dsig,&#160;<br/>together with X509 based certification chains.&#160;To leave the possibility to&#160;extend the&#160;<br/>concept&#160;to&#160;new formats,&#160;the signature&#160;checking uses the utility&#160;library&#160;as plug-in&#160;<br/>architecture&#160;for the verification.<br/>After the parsing of the license, the interpretation&#160;can&#160;be performed. In this&#160;process&#160;<br/>the internal representation&#160;of the license is matched against&#160;the operation request&#160;<br/>from&#160;the player application.&#160;The matching returns either a&#160;positive or&#160;negative result.&#160;<br/>A&#160;positive result implies&#160;that the player&#160;application&#160;is allowed to decrypt&#160;and render&#160;<br/>the specified content. However,&#160;depending on&#160;the license, a&#160;positive result may&#160;also&#160;<br/>include additional restrictions&#160;which the player must&#160;support and enforce.<br/>The&#160;OpenTC&#160;license&#160;model&#160;strives&#160;to&#160;support&#160;the&#160;&#160;concept&#160;&#160;of&#160;a&#160;“fair”&#160;DRM&#160;system&#160;as&#160;<br/>well,&#160;meaning&#160;that&#160;the&#160;resulting&#160;systems&#160;will&#160;be&#160;beneficial&#160;not&#160;only&#160;for&#160;the&#160;content&#160;<br/>provider,&#160;but&#160;also&#160;the&#160;consumer&#160;of&#160;a&#160;content.&#160;It&#160;is&#160;thus&#160;planned&#160;that&#160;all&#160;participants&#160;in&#160;<br/>the&#160;&#160;&#160;system&#160;&#160;&#160;will&#160;&#160;&#160;be&#160;&#160;&#160;treated&#160;&#160;&#160;equally,&#160;&#160;&#160;so&#160;&#160;&#160;that&#160;&#160;&#160;every&#160;&#160;&#160;participant&#160;&#160;&#160;can&#160;&#160;&#160;either&#160;&#160;&#160;act&#160;&#160;&#160;like&#160;&#160;&#160;a&#160;<br/>content&#160;consumer&#160;or&#160;a&#160;content&#160;provider.&#160;A&#160;content&#160;provider&#160;can&#160;use&#160;the&#160;system&#160;to&#160;<br/>protect&#160;his own creation&#160;against any misuse.<br/>Nevertheless&#160;the&#160;content&#160;provider&#160;can&#160;still&#160;decide&#160;to&#160;restrict&#160;the&#160;usage&#160;of&#160;the&#160;content&#160;<br/>in&#160;&#160;&#160;an&#160;&#160;&#160;“unfair”&#160;&#160;&#160;way.&#160;&#160;&#160;This&#160;&#160;&#160;decision&#160;&#160;&#160;isn't&#160;&#160;&#160;based&#160;&#160;&#160;on&#160;&#160;&#160;a&#160;&#160;technical&#160;&#160;&#160;problem,&#160;&#160;&#160;but&#160;&#160;&#160;rather&#160;&#160;&#160;a&#160;<br/>consequence&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;business&#160;&#160;&#160;model.&#160;&#160;&#160;In&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;&#160;&#160;have&#160;&#160;&#160;a&#160;&#160;&#160;fair&#160;&#160;&#160;usage&#160;&#160;&#160;of&#160;&#160;&#160;DRM,&#160;&#160;&#160;each&#160;<br/>participant&#160;has&#160;to&#160;consider&#160;carefully&#160;its&#160;business&#160;model.&#160;The&#160;business&#160;model&#160;should&#160;<br/>provide&#160;different&#160;added-value&#160;to&#160;the&#160;user,&#160;by&#160;granting&#160;additional&#160;rights&#160;to&#160;the&#160;user.&#160;We&#160;<br/>foresee the following rights, which would support&#160;a “fairer” usage of DRM:&#160;</p>
<p style="position:absolute;top:786px;left:112px;white-space:nowrap" class="ft2112">●</p>
<p style="position:absolute;top:783px;left:139px;white-space:nowrap" class="ft214">copy&#160;</p>
<p style="position:absolute;top:814px;left:112px;white-space:nowrap" class="ft2112">●</p>
<p style="position:absolute;top:811px;left:139px;white-space:nowrap" class="ft214">burn</p>
<p style="position:absolute;top:843px;left:112px;white-space:nowrap" class="ft2112">●</p>
<p style="position:absolute;top:840px;left:139px;white-space:nowrap" class="ft214">sell</p>
<p style="position:absolute;top:868px;left:85px;white-space:nowrap" class="ft217">With&#160;the&#160;right&#160;to&#160;“copy”&#160;the&#160;consumer&#160;can&#160;create&#160;a&#160;limited&#160;amount&#160;of&#160;private&#160;copies.&#160;<br/>By&#160;&#160;&#160;transferring&#160;&#160;&#160;these&#160;&#160;&#160;copies,&#160;&#160;&#160;the&#160;&#160;&#160;content&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;shared&#160;&#160;&#160;with&#160;&#160;&#160;a&#160;&#160;&#160;small&#160;&#160;&#160;number&#160;&#160;&#160;of&#160;<br/>OpenTC&#160;&#160;&#160;devices,&#160;&#160;&#160;which&#160;&#160;&#160;belong&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;domain&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;user.&#160;&#160;&#160;This&#160;&#160;&#160;domain&#160;&#160;&#160;has&#160;&#160;&#160;to&#160;&#160;&#160;be&#160;<br/>defined beforehand, with a&#160;specified maximum&#160;number of devices.&#160;<br/>In&#160;the&#160;same&#160;way,&#160;the&#160;right&#160;“burn”&#160;grants&#160;the&#160;user&#160;to&#160;save&#160;the&#160;content&#160;on&#160;a&#160;disc.&#160;“Sell”&#160;<br/>means,&#160;that&#160;a&#160;consumer&#160;can&#160;sell&#160;the&#160;content&#160;to&#160;another&#160;user.&#160;With&#160;these&#160;technical&#160;<br/>possibilities, the DRM works almost&#160;transparently&#160;to the consumer.</p>
<p style="position:absolute;top:1039px;left:85px;white-space:nowrap" class="ft2120"><i><b>3.6.2&#160;License&#160;Translation&#160;Manager&#160;</b></i></p>
<p style="position:absolute;top:1069px;left:85px;white-space:nowrap" class="ft217">In order&#160;to support&#160;interoperability&#160;between different systems,&#160;we propose&#160;to&#160;include a&#160;<br/>license translation&#160;system,&#160;to support&#160;the translation&#160;of licenses&#160;between different&#160;<br/>license description schemes,&#160;e.g. Open Mobile Alliance (OMA) REL, Digital Video&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft2116">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft2116">16/39</p>
</div>
<!-- Page 22 -->
<a name="22"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2227{font-size:17px;font-family:IAAAAA+TrebuchetMS;color:#000000;}
	.ft2228{font-size:14px;font-family:IAAAAA+TrebuchetMS;color:#000000;}
	.ft2229{font-size:19px;font-family:IAAAAA+TrebuchetMS;color:#000000;}
	.ft2230{font-size:17px;line-height:20px;font-family:IAAAAA+TrebuchetMS;color:#000000;}
-->
</style>
<div id="page22-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables022.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2215">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft220">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft2216">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft2216">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft228">Broadcast&#160;Content Protection&#160;or Content Management DVB-CPCM. This&#160;allows&#160;content&#160;<br/>to&#160;be received from or&#160;exported to&#160;foreign DRM systems&#160;or&#160;to external devices&#160;which&#160;<br/>do not&#160;support&#160;the MPEG-21 REL&#160;license format.<br/>This&#160;enables&#160;a&#160;seamless&#160;experience&#160;for&#160;the&#160;user,&#160;by&#160;allowing&#160;multimedia&#160;content&#160;to&#160;<br/>easily move between different interoperable systems&#160;and devices.<br/>The parsing of the license to be translated is first performed,&#160;which creates&#160;an&#160;internal&#160;<br/>representation of the license. This&#160;is then handed to&#160;the translation&#160;engine with the&#160;<br/>required translation&#160;requirements,&#160;such as&#160;target&#160;license language and profile.<br/>Requirements&#160;for the translation&#160;system&#160;are:</p>
<p style="position:absolute;top:363px;left:112px;white-space:nowrap" class="ft2212">●</p>
<p style="position:absolute;top:360px;left:139px;white-space:nowrap" class="ft224">Element name translation&#160;/ adaptation</p>
<p style="position:absolute;top:391px;left:112px;white-space:nowrap" class="ft2212">●</p>
<p style="position:absolute;top:388px;left:139px;white-space:nowrap" class="ft224">Restructuring&#160;of license elements&#160;to a&#160;legal structure&#160;in the other language</p>
<p style="position:absolute;top:420px;left:112px;white-space:nowrap" class="ft2212">●</p>
<p style="position:absolute;top:417px;left:139px;white-space:nowrap" class="ft224">Contractive&#160;translation&#160;of unsupported elements</p>
<p style="position:absolute;top:445px;left:85px;white-space:nowrap" class="ft227"><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#22">Figure&#160;2&#160;sho</a>ws&#160;the translation&#160;between two license languages. Element renaming can&#160;<br/>be handled trivially, but restructuring and contractive translation&#160;(where an&#160;alternative&#160;<br/>description must&#160;be generated that&#160;best&#160;matches&#160;the original element) of elements&#160;<br/>not&#160;found in the original language, will require intelligent&#160;rules for such&#160;<br/>transformation.&#160;<br/>The proposed solution is to&#160;use an expert system&#160;architecture&#160;to transform&#160;a&#160;<br/>knowledge representation of&#160;the original license into another&#160;license language.&#160;<br/>Transformation&#160;rules&#160;can be built&#160;to translate&#160;the element names, make appropriate&#160;<br/>contractive&#160;translation of&#160;elements&#160;which are not&#160;found in&#160;the target&#160;language, and an&#160;<br/>output phase which generates&#160;the output license in a different structure.</p>
<p style="position:absolute;top:1053px;left:85px;white-space:nowrap" class="ft2211"><i><b>3.7&#160;State Management</b></i></p>
<p style="position:absolute;top:1085px;left:85px;white-space:nowrap" class="ft227">The State Manager is responsible for&#160;managing system and license-related states.&#160;<br/>System&#160;states&#160;are a general&#160;framework to&#160;access&#160;information&#160;related to the DRM&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft2216">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft2216">17/39</p>
<p style="position:absolute;top:989px;left:338px;white-space:nowrap" class="ft2216">Figure&#160;2: License&#160;Translation</p>
<p style="position:absolute;top:764px;left:281px;white-space:nowrap" class="ft2227">grant</p>
<p style="position:absolute;top:766px;left:585px;white-space:nowrap" class="ft2227">agreement</p>
<p style="position:absolute;top:839px;left:194px;white-space:nowrap" class="ft2227">play</p>
<p style="position:absolute;top:838px;left:294px;white-space:nowrap" class="ft2227">print</p>
<p style="position:absolute;top:833px;left:394px;white-space:nowrap" class="ft2228">Tim&#160;e&#160;</p>
<p style="position:absolute;top:849px;left:383px;white-space:nowrap" class="ft2228">condition</p>
<p style="position:absolute;top:840px;left:560px;white-space:nowrap" class="ft2227">play</p>
<p style="position:absolute;top:841px;left:665px;white-space:nowrap" class="ft2227">print</p>
<p style="position:absolute;top:890px;left:558px;white-space:nowrap" class="ft2228">Tim&#160;e&#160;</p>
<p style="position:absolute;top:907px;left:539px;white-space:nowrap" class="ft2228">condition&#160;</p>
<p style="position:absolute;top:903px;left:605px;white-space:nowrap" class="ft2229">*</p>
<p style="position:absolute;top:890px;left:665px;white-space:nowrap" class="ft2228">Tim&#160;e&#160;</p>
<p style="position:absolute;top:906px;left:647px;white-space:nowrap" class="ft2228">condition&#160;</p>
<p style="position:absolute;top:902px;left:713px;white-space:nowrap" class="ft2229">*</p>
<p style="position:absolute;top:686px;left:388px;white-space:nowrap" class="ft2227">E&#160;lement&#160;rename</p>
<p style="position:absolute;top:934px;left:222px;white-space:nowrap" class="ft2230">R&#160;es&#160;tructure&#160;&amp;&#160;<br/>contractive&#160;trans&#160;lation</p>
</div>
<!-- Page 23 -->
<a name="23"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page23-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables023.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2315">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft230">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft2316">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft2316">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft237">system&#160;(such as&#160;current player capabilities&#160;and credentials) and machine-related&#160;<br/>parameters&#160;(such&#160;as time and location).&#160;License-related states&#160;are used to store&#160;<br/>persistent information&#160;needed for license interpretation&#160;(such as&#160;playback&#160;counter).</p>
<p style="position:absolute;top:236px;left:85px;white-space:nowrap" class="ft2311"><i><b>3.8&#160;Sealed&#160;</b></i></p>
<p style="position:absolute;top:238px;left:217px;white-space:nowrap" class="ft233"><b>store</b></p>
<p style="position:absolute;top:267px;left:85px;white-space:nowrap" class="ft234">The sealed store&#160;consists&#160;of&#160;two parts:&#160;the key store&#160;and the license store.&#160;</p>
<p style="position:absolute;top:314px;left:85px;white-space:nowrap" class="ft2320"><i><b>3.8.1&#160;Key&#160;store</b></i></p>
<p style="position:absolute;top:344px;left:85px;white-space:nowrap" class="ft237">A&#160;particularly important&#160;component of the core&#160;is the key store.&#160;The key store&#160;contains&#160;<br/>the keys&#160;which are&#160;used to&#160;access&#160;(namely decrypt)&#160;the protected content&#160;in the&#160;<br/>system.&#160;The DRM Core ensures that&#160;a content&#160;key is given out only when a&#160;requested&#160;<br/>action&#160;is allowed by the license. The key store&#160;is organised as a&#160;table which contains&#160;<br/>keys and unique content&#160;identifiers.&#160;The same&#160;identifiers are&#160;used in&#160;the licenses to&#160;<br/>reference content.&#160;Respective technologies are&#160;part of the MPEG-21 standard.&#160;The key&#160;<br/>store&#160;is implemented as&#160;a secure database,&#160;which is decrypted&#160;by the core&#160;when a&#160;<br/>secure environment&#160;is established. This&#160;is done with the help of the TPM, which&#160;seals&#160;<br/>the key storage&#160;master&#160;key, so that&#160;it can only be accessed&#160;when the system is in a&#160;<br/>secure state.&#160;The core&#160;itself is thus&#160;only able to retrieve the master&#160;key when the&#160;<br/>system&#160;has&#160;not been compromised.</p>
<p style="position:absolute;top:582px;left:85px;white-space:nowrap" class="ft2320"><i><b>3.8.2&#160;License&#160;store</b></i></p>
<p style="position:absolute;top:612px;left:85px;white-space:nowrap" class="ft237">As&#160;described previously, License Interpretation Manager relies on an&#160;internal&#160;<br/>representation of licenses.&#160;The structure&#160;of this Internal license store&#160;is similar&#160;to the&#160;<br/>structure&#160;defined in MPEG-21. To&#160;speed up the evaluation of licenses by the License&#160;<br/>Interpretation&#160;Manager, each single syntactic&#160;object&#160;of a license, namely principal,&#160;<br/>digital item, grant and condition, is mapped to a&#160;specific internal object&#160;representation&#160;<br/>that&#160;is optimized for the evaluation process.&#160;The internal storage&#160;offers some&#160;basic&#160;<br/>search&#160;methods on&#160;the storage&#160;objects&#160;for selecting certain items based on different&#160;<br/>criteria&#160;or for&#160;matching two items against&#160;each other. The license is also stored&#160;in&#160;the&#160;<br/>secure database,&#160;to protect&#160;against any&#160;unauthorized change to the license outside of&#160;<br/>the DRM Core.&#160;Regarding the semantic&#160;of the stored&#160;elements,&#160;we strictly&#160;use values&#160;<br/>from&#160;the RDD-Standard issued within the MPEG-21 framework.</p>
<p style="position:absolute;top:850px;left:85px;white-space:nowrap" class="ft2311"><i><b>3.9&#160;Utility library</b></i></p>
<p style="position:absolute;top:882px;left:85px;white-space:nowrap" class="ft237">In order&#160;to support&#160;an extensible DRM system,&#160;a utility library&#160;is provided to both the&#160;<br/>player application&#160;and the DRM Core. This&#160;utility&#160;library&#160;provides a&#160;centralized&#160;<br/>mechanism&#160;in which&#160;new tools&#160;for decoding, encryption, decryption, signing, and so&#160;<br/>on, can&#160;be retrieved and made available.<br/>The Player Application&#160;can&#160;request a&#160;decryption&#160;tool from&#160;the Utility library&#160;to be able&#160;<br/>to&#160;decode&#160;the content.&#160;The DRM Core may&#160;also&#160;need cryptographic&#160;tools,&#160;for signature&#160;<br/>verification&#160;or&#160;self-signing generated licenses (for instance, in the case&#160;of license&#160;<br/>translation&#160;from&#160;another DRM system).<br/>The Utility&#160;library&#160;follows the concept&#160;of MPEG-21 IPMP&#160;tools, in which tools&#160;for specific&#160;<br/>functions can&#160;be identified and automatically&#160;retrieved for the target&#160;platform.&#160;This&#160;<br/>allows&#160;the DRM Core and player to&#160;support&#160;new media (new codecs)&#160;and licenses (new&#160;<br/>cryptographic&#160;tools) when newer tools&#160;become&#160;available.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft2316">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft2316">18/39</p>
</div>
<!-- Page 24 -->
<a name="24"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page24-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables024.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2415">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft240">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft2416">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft2416">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft247">An important&#160;security aspect&#160;is that&#160;this utility library&#160;itself must&#160;be verified&#160;<br/>beforehand, and must&#160;run within a secured environment. Mechanism to&#160;verify the&#160;<br/>integrity of the retrieved tools,&#160;such as&#160;tool signing, must&#160;be implemented to&#160;ensure&#160;<br/>that&#160;no security weakness&#160;is exposed through the new tool.</p>
<p style="position:absolute;top:255px;left:85px;white-space:nowrap" class="ft2411"><i><b>3.10&#160;OS&#160;Services</b></i></p>
<p style="position:absolute;top:287px;left:85px;white-space:nowrap" class="ft247">The necessary&#160;OS services&#160;required by the DRM Core are secure&#160;time, sealing,&#160;<br/>compartment&#160;measurement, attestation,&#160;cryptographic&#160;libraries.&#160;Secure time&#160;<br/>mechanism&#160;provides&#160;a trustworthy&#160;source&#160;of time, on which time-related license&#160;<br/>conditions can&#160;be verified.<br/>Sealing of the license and key stores&#160;of the DRM Core, and measurement of the DRM&#160;<br/>Core compartment&#160;should be performed&#160;by the OS compartment&#160;manager, prior&#160;to the&#160;<br/>starting&#160;of the DRM Core&#160;compartment.<br/>Services to&#160;aid the attestation&#160;of the DRM Core to&#160;services&#160;on the Internet, such&#160;as&#160;the&#160;<br/>generation&#160;of AIK&#160;keys, need to&#160;be provided by the underlying OS.<br/>Standard&#160;cryptographic&#160;libraries&#160;are also&#160;necessary&#160;in order to&#160;perform&#160;decryption and&#160;<br/>hash&#160;operations&#160;as&#160;required by the DRM Core and Player&#160;application.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft2416">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft2416">19/39</p>
</div>
<!-- Page 25 -->
<a name="25"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2531{font-size:12px;font-family:IAAAAA+TrebuchetMS;color:#000000;}
-->
</style>
<div id="page25-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables025.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2515">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft250">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft2516">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft2516">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft2510"><b>4.&#160;Component&#160;Interaction</b></p>
<p style="position:absolute;top:203px;left:85px;white-space:nowrap" class="ft2511"><i><b>4.1&#160;Functional&#160;parts&#160;of&#160;the&#160;DRM Core&#160;</b></i></p>
<p style="position:absolute;top:725px;left:85px;white-space:nowrap" class="ft257">The DRM Core consists&#160;of five key functional parts:&#160;The Core Manager,&#160;License&#160;<br/>Manager,&#160;License Translation&#160;Manager, State&#160;Manager and Database&#160;Manager. The&#160;<br/>Database&#160;Manager is a&#160;component that&#160;provides&#160;the access&#160;to&#160;the sealed storage.&#160;<br/><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#25">Figure&#160;3&#160;shows</a>&#160;the inter-relations of the different modules.<br/>The Core Manager provides the API's&#160;to&#160;the user level applications.&#160;The Core Manager&#160;<br/>is directly connected to&#160;the License Manager, the State Manager and the Database&#160;<br/>Manager.&#160;<br/>The License Manager can&#160;process&#160;licenses and then decides to which component&#160;the&#160;<br/>license should be forwarded.&#160;If a license shall be interpreted, he uses the License&#160;<br/>Interpreter, which parses&#160;the license and compares&#160;it to a&#160;given set of conditions. The&#160;<br/>License Translation&#160;Manager is used, if a license has&#160;to be converted to&#160;or from&#160;other&#160;<br/>DRM-Systems.&#160;The Manager can&#160;either import or&#160;export a&#160;license from another&#160;<br/>compatible system.&#160;<br/>The State Manager contains&#160;the current states&#160;of the applications&#160;and contents.&#160;It&#160;<br/>monitors&#160;all players&#160;that are&#160;connected to the DRM Core and provides state&#160;<br/>information&#160;about&#160;players,&#160;system&#160;and digital items.&#160;<br/>The Database&#160;Manager has&#160;a connection to&#160;the key store&#160;and the license store.&#160;The&#160;<br/>Core Manager&#160;can request&#160;specific&#160;keys and licenses from the Database&#160;Manager,&#160;<br/>which are then retrieved from the key store&#160;or&#160;the license store.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft2516">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft2516">20/39</p>
<p style="position:absolute;top:673px;left:234px;white-space:nowrap" class="ft2516">Figure&#160;3:&#160;Internal and&#160;external&#160;components&#160;of&#160;DRM&#160;Core</p>
<p style="position:absolute;top:357px;left:415px;white-space:nowrap" class="ft2531">C&#160;ore&#160;M&#160;anager</p>
<p style="position:absolute;top:325px;left:359px;white-space:nowrap" class="ft2531">Player&#160;Interface</p>
<p style="position:absolute;top:325px;left:457px;white-space:nowrap" class="ft2531">Manager&#160;Interface</p>
<p style="position:absolute;top:261px;left:353px;white-space:nowrap" class="ft2531">OpenTC&#160;&#160;Player</p>
<p style="position:absolute;top:261px;left:476px;white-space:nowrap" class="ft2531">Manager&#160;GUI</p>
<p style="position:absolute;top:500px;left:530px;white-space:nowrap" class="ft2531">Database&#160;Manager</p>
<p style="position:absolute;top:430px;left:542px;white-space:nowrap" class="ft2531">S&#160;tate&#160;M&#160;anager</p>
<p style="position:absolute;top:423px;left:317px;white-space:nowrap" class="ft2531">License</p>
<p style="position:absolute;top:437px;left:314px;white-space:nowrap" class="ft2531">Manager</p>
<p style="position:absolute;top:497px;left:315px;white-space:nowrap" class="ft2531">License&#160;</p>
<p style="position:absolute;top:511px;left:308px;white-space:nowrap" class="ft2531">Translation</p>
<p style="position:absolute;top:525px;left:314px;white-space:nowrap" class="ft2531">Manager</p>
<p style="position:absolute;top:504px;left:411px;white-space:nowrap" class="ft2531">License</p>
<p style="position:absolute;top:518px;left:405px;white-space:nowrap" class="ft2531">Interpreter</p>
<p style="position:absolute;top:641px;left:529px;white-space:nowrap" class="ft2531">S&#160;ealed&#160;&amp;&#160;encrypted</p>
<p style="position:absolute;top:655px;left:561px;white-space:nowrap" class="ft2531">storage</p>
<p style="position:absolute;top:524px;left:555px;white-space:nowrap" class="ft2531">Key&#160;store</p>
<p style="position:absolute;top:559px;left:545px;white-space:nowrap" class="ft2531">License&#160;store</p>
<p style="position:absolute;top:311px;left:583px;white-space:nowrap" class="ft2531">DR&#160;M&#160;&#160;C&#160;ore</p>
<p style="position:absolute;top:261px;left:210px;white-space:nowrap" class="ft2531">Utility&#160;Library</p>
</div>
<!-- Page 26 -->
<a name="26"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page26-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables026.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2615">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft260">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft2616">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft2616">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft2611"><i><b>4.2&#160;Sequence diagram</b></i></p>
<p style="position:absolute;top:183px;left:85px;white-space:nowrap" class="ft267"><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#26">Figure&#160;4&#160;shows</a>&#160;the sequence diagram&#160;for interaction&#160;between the player and different&#160;<br/>components&#160;within the DRM Core. The player application&#160;first performs&#160;an initial&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft2616">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft2616">21/39</p>
<p style="position:absolute;top:1127px;left:266px;white-space:nowrap" class="ft2616">Figure&#160;4: Sequence diagram&#160;for&#160;media&#160;playback</p>
</div>
<!-- Page 27 -->
<a name="27"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2732{font-size:17px;font-family:Courier;color:#000000;}
	.ft2733{font-size:18px;font-family:IAAAAA+TrebuchetMS;color:#000000;}
-->
</style>
<div id="page27-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables027.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2715">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft270">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft2716">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft2716">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft277">handshake with the DRM Core by reporting its&#160;playback&#160;capabilities,&#160;and receives as&#160;a&#160;<br/>response a&#160;</p>
<p style="position:absolute;top:175px;left:181px;white-space:nowrap" class="ft2732">PlayerID,</p>
<p style="position:absolute;top:170px;left:270px;white-space:nowrap" class="ft274">&#160;which the DRM Core uses to&#160;identify different players&#160;</p>
<p style="position:absolute;top:190px;left:85px;white-space:nowrap" class="ft277">connected to&#160;the core. Upon the player requesting to decrypt&#160;a digital item, the core&#160;<br/>manager&#160;handles the request and calls&#160;the appropriate&#160;modules&#160;within the DRM Core&#160;<br/>to&#160;process&#160;the request. Upon success,&#160;the content key is retrieved and returned to the&#160;<br/>player.</p>
<p style="position:absolute;top:294px;left:85px;white-space:nowrap" class="ft2711"><i><b>4.3&#160;DRM&#160;system&#160;and XEN/L4&#160;virtualization&#160;environments</b></i></p>
<p style="position:absolute;top:344px;left:85px;white-space:nowrap" class="ft2720"><i><b>4.3.1&#160;DRM&#160;components&#160;and compartments</b></i></p>
<p style="position:absolute;top:820px;left:85px;white-space:nowrap" class="ft277">In order&#160;to take advantage&#160;of the secure&#160;application&#160;isolation&#160;provided by the&#160;<br/>virtualization&#160;framework in OpenTC, higher security&#160;can be achieved by separating the&#160;<br/>player application&#160;and DRM Core into separate&#160;compartments.&#160;F<a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#27">igure&#160;5&#160;</a>shows&#160;virtual&#160;<br/>machine partitioning of different components.&#160;The DRM Core as&#160;described in section 3&#160;<br/>runs in a protected&#160;compartment,&#160;while the OpenTC Player runs in a different&#160;<br/>protected&#160;compartment.&#160;Since the information&#160;traffic&#160;between the DRM Core and&#160;<br/>player is not high, this is not a&#160;big performance&#160;penalty. The hypervisor,&#160;and OS&#160;<br/>components&#160;such as&#160;kernel and drivers&#160;are not described in this document. Sealed&#160;<br/>storage&#160;protects&#160;the key and license stores&#160;d<a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#23">escribed in sections&#160;3.8.1&#160;and&#160;3.8.2.&#160;<br/></a>For&#160;the rendering of the content, the player&#160;needs access&#160;to device&#160;drivers/kernel&#160;<br/>modules. This&#160;access&#160;is controlled by security&#160;policies which&#160;only allows&#160;<br/>communication&#160;with signed device drivers/kernel modules in the service compartment.&#160;<br/>This enforces&#160;the secure output path criteria.&#160;The DRM Core has&#160;access&#160;to a&#160;secure&#160;<br/>storage&#160;provided by the service compartment.&#160;Sealing is used to encrypt&#160;this storage,&#160;<br/>such&#160;that the DRM Core can only access&#160;it when the OS and the DRM Core&#160;are not&#160;<br/>modified.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft2716">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft2716">22/39</p>
<p style="position:absolute;top:784px;left:297px;white-space:nowrap" class="ft2716">Figure&#160;5: Virtualization&#160;of&#160;the&#160;DRM&#160;Core</p>
<p style="position:absolute;top:398px;left:404px;white-space:nowrap" class="ft2733">Hypervisor</p>
<p style="position:absolute;top:730px;left:204px;white-space:nowrap" class="ft2733">S&#160;ervice</p>
<p style="position:absolute;top:751px;left:180px;white-space:nowrap" class="ft2733">C&#160;ompartment</p>
<p style="position:absolute;top:730px;left:338px;white-space:nowrap" class="ft2733">Protected</p>
<p style="position:absolute;top:751px;left:317px;white-space:nowrap" class="ft2733">C&#160;ompartment1</p>
<p style="position:absolute;top:730px;left:479px;white-space:nowrap" class="ft2733">Protected</p>
<p style="position:absolute;top:751px;left:459px;white-space:nowrap" class="ft2733">C&#160;ompartment2</p>
<p style="position:absolute;top:730px;left:610px;white-space:nowrap" class="ft2733">Unprotected</p>
<p style="position:absolute;top:751px;left:605px;white-space:nowrap" class="ft2733">C&#160;ompartment</p>
<p style="position:absolute;top:517px;left:634px;white-space:nowrap" class="ft2733">kernel</p>
<p style="position:absolute;top:656px;left:206px;white-space:nowrap" class="ft2733">S&#160;ealed</p>
<p style="position:absolute;top:678px;left:204px;white-space:nowrap" class="ft2733">storage</p>
<p style="position:absolute;top:585px;left:355px;white-space:nowrap" class="ft2733">DR&#160;M</p>
<p style="position:absolute;top:607px;left:356px;white-space:nowrap" class="ft2733">C&#160;ore</p>
<p style="position:absolute;top:585px;left:489px;white-space:nowrap" class="ft2733">S&#160;ecure</p>
<p style="position:absolute;top:607px;left:474px;white-space:nowrap" class="ft2733">Application</p>
<p style="position:absolute;top:517px;left:209px;white-space:nowrap" class="ft2733">kernel</p>
<p style="position:absolute;top:517px;left:351px;white-space:nowrap" class="ft2733">kernel</p>
<p style="position:absolute;top:517px;left:493px;white-space:nowrap" class="ft2733">kernel</p>
<p style="position:absolute;top:577px;left:206px;white-space:nowrap" class="ft2733">S&#160;igned</p>
<p style="position:absolute;top:598px;left:207px;white-space:nowrap" class="ft2733">drivers</p>
</div>
<!-- Page 28 -->
<a name="28"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2834{font-size:17px;line-height:19px;font-family:IAAAAA+TrebuchetMS;color:#000000;}
-->
</style>
<div id="page28-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables028.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2815">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft280">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft2816">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft2816">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft2820"><i><b>4.3.2&#160;Interfaces&#160;between&#160;compartments</b></i></p>
<p style="position:absolute;top:337px;left:85px;white-space:nowrap" class="ft287">A&#160;generic&#160;way to&#160;achieve communication&#160;between two&#160;compartments&#160;is&#160;the&#160;definition&#160;<br/>of a&#160;network&#160;RPC between them. This&#160;form is used for the connection&#160;from the secured&#160;<br/>application to&#160;the DRM Core. The security policy of the channel can&#160;be defined via&#160;an&#160;<br/>interface&#160;from&#160;the operating system.&#160;Furthermore some&#160;rules&#160;of the license may&#160;have&#160;<br/>to&#160;be applied, e.g. the content may&#160;not be rendered at the same&#160;time in&#160;more&#160;than&#160;<br/>one player application.&#160;This&#160;RPC standard&#160;will not be defined in this preliminary&#160;<br/>specification, but will be based on a&#160;standard&#160;RPC protocol,&#160;with a&#160;similar&#160;API&#160;as&#160;<br/>described i<a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#18">n section&#160;3.2.<br/></a>The interface&#160;between the DRM Core and secure sealed storage&#160;is implicit,&#160;in that it is&#160;<br/>achieved by mounting secure mount points within the compartment&#160;of the DRM Core.&#160;<br/>This is controlled by the compartment&#160;and device manager&#160;in service compartment.&#160;<br/>The sealed storage&#160;is used for the storage&#160;of the licenses and the content&#160;keys.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft2816">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft2816">23/39</p>
<p style="position:absolute;top:300px;left:354px;white-space:nowrap" class="ft2816">Figure&#160;6:&#160;Interface Chain</p>
<p style="position:absolute;top:231px;left:231px;white-space:nowrap" class="ft2827">S&#160;ealed</p>
<p style="position:absolute;top:251px;left:229px;white-space:nowrap" class="ft2827">storage</p>
<p style="position:absolute;top:231px;left:417px;white-space:nowrap" class="ft2827">DR&#160;M&#160;&#160;</p>
<p style="position:absolute;top:251px;left:420px;white-space:nowrap" class="ft2827">C&#160;ore</p>
<p style="position:absolute;top:231px;left:601px;white-space:nowrap" class="ft2827">S&#160;ecure</p>
<p style="position:absolute;top:251px;left:587px;white-space:nowrap" class="ft2827">Application</p>
<p style="position:absolute;top:205px;left:313px;white-space:nowrap" class="ft2834">M&#160;ounted<br/>directory</p>
<p style="position:absolute;top:205px;left:502px;white-space:nowrap" class="ft2834">Network<br/>R&#160;PC</p>
</div>
<!-- Page 29 -->
<a name="29"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page29-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables029.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2915">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft290">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft2916">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft2916">FINAL |&#160;1.10</p>
<p style="position:absolute;top:169px;left:85px;white-space:nowrap" class="ft2910"><b>5.&#160;Requirements&#160;from&#160;other Partners</b></p>
<p style="position:absolute;top:202px;left:85px;white-space:nowrap" class="ft297">The secure application&#160;is generally a media&#160;player&#160;that uses the DRM Core-API&#160;to&#160;<br/>render&#160;protected content. The application&#160;needs to&#160;be secure, because&#160;it is allowed to&#160;<br/>decrypt&#160;the content.&#160;To maintain the security&#160;of the system,&#160;the player&#160;application&#160;<br/>should run in a separate&#160;compartment,&#160;whose&#160;integrity&#160;and authenticity were checked&#160;<br/>before its execution.&#160;<br/>Furthermore&#160;the DRM system&#160;expects&#160;the presence&#160;of an underlying trusted system&#160;<br/>and requires&#160;the following services from&#160;it:</p>
<p style="position:absolute;top:358px;left:112px;white-space:nowrap" class="ft2912">●</p>
<p style="position:absolute;top:355px;left:139px;white-space:nowrap" class="ft293"><b>Secure&#160;Environment.</b></p>
<p style="position:absolute;top:355px;left:334px;white-space:nowrap" class="ft294">&#160;The DRM Core and the media&#160;player&#160;application&#160;may&#160;</p>
<p style="position:absolute;top:374px;left:139px;white-space:nowrap" class="ft297">only execute&#160;when a secured environment is present. Thus, the underlying&#160;<br/>system&#160;must provide:</p>
<p style="position:absolute;top:425px;left:197px;white-space:nowrap" class="ft2912">●</p>
<p style="position:absolute;top:422px;left:224px;white-space:nowrap" class="ft297">Memory&#160;isolation and protection of processes&#160;running in the secure&#160;<br/>environment.</p>
<p style="position:absolute;top:472px;left:197px;white-space:nowrap" class="ft2912">●</p>
<p style="position:absolute;top:469px;left:224px;white-space:nowrap" class="ft297">Secure audio and video output paths&#160;to certified (signed) hardware&#160;<br/>drivers and/or&#160;hardware.&#160;No unauthorized application&#160;or&#160;service&#160;<br/>should be able to read&#160;from this output path. Optionally cryptographic&#160;<br/>protection&#160;between the driver and the hardware&#160;can&#160;also be applied&#160;<br/>when supported by the hardware.&#160;</p>
<p style="position:absolute;top:578px;left:197px;white-space:nowrap" class="ft2912">●</p>
<p style="position:absolute;top:575px;left:224px;white-space:nowrap" class="ft297">A&#160;means&#160;to measure&#160;the integrity of the DRM system&#160;and associated&#160;<br/>applications.&#160;This implies the existence of a&#160;method&#160;for measuring&#160;<br/>applications&#160;before they are loaded and executed.&#160;</p>
<p style="position:absolute;top:645px;left:112px;white-space:nowrap" class="ft2912">●</p>
<p style="position:absolute;top:642px;left:139px;white-space:nowrap" class="ft293"><b>Cryptographic services.</b></p>
<p style="position:absolute;top:642px;left:360px;white-space:nowrap" class="ft294">&#160;The DRM Core requires several cryptographic&#160;</p>
<p style="position:absolute;top:661px;left:139px;white-space:nowrap" class="ft294">services&#160;which have to&#160;be provided by the underlying system:</p>
<p style="position:absolute;top:692px;left:197px;white-space:nowrap" class="ft2912">●</p>
<p style="position:absolute;top:689px;left:224px;white-space:nowrap" class="ft297">A&#160;Trusted Software Stack&#160;(TSS), supporting AIK&#160;generation and&#160;<br/>sealing. AIKs&#160;are required for authentication/remote&#160;attestation&#160;<br/>purposes,&#160;while sealing is used to lock cryptographic&#160;keys&#160;to specific&#160;<br/>system&#160;configurations. The core&#160;can thus ensure that content&#160;keys&#160;<br/>are&#160;only accessible when the systems&#160;integrity&#160;is ensured.</p>
<p style="position:absolute;top:798px;left:197px;white-space:nowrap" class="ft2912">●</p>
<p style="position:absolute;top:795px;left:224px;white-space:nowrap" class="ft297">Sealed Storage.&#160;The DRM Core will use sealed storage&#160;for&#160;its license&#160;<br/>and key databases.</p>
<p style="position:absolute;top:845px;left:197px;white-space:nowrap" class="ft2912">●</p>
<p style="position:absolute;top:842px;left:224px;white-space:nowrap" class="ft297">A&#160;system-wide database&#160;of certificates&#160;of root&#160;certification&#160;authorities,&#160;<br/>along with services to&#160;verify certificates.</p>
<p style="position:absolute;top:893px;left:112px;white-space:nowrap" class="ft2912">●</p>
<p style="position:absolute;top:890px;left:139px;white-space:nowrap" class="ft293"><b>Central policy management.</b></p>
<p style="position:absolute;top:890px;left:402px;white-space:nowrap" class="ft294">&#160;Operation&#160;of the DRM Core and the media&#160;</p>
<p style="position:absolute;top:910px;left:139px;white-space:nowrap" class="ft297">player application&#160;will be subject to&#160;an operation policy of whatever kind. It&#160;<br/>would be beneficial if the underlying system can&#160;provide a system-wide policy&#160;<br/>management facility, so&#160;that DRM-related configuration can&#160;be seamlessly&#160;<br/>integrated&#160;into the management tool.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft2916">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft2916">24/39</p>
</div>
<!-- Page 30 -->
<a name="30"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3035{font-size:17px;font-family:KAAAAA+Tahoma;color:#000000;}
	.ft3036{font-size:17px;font-family:LAAAAA+Tahoma;color:#000000;}
	.ft3037{font-size:17px;font-family:Courier;color:#000000;}
	.ft3038{font-size:17px;line-height:19px;font-family:KAAAAA+Tahoma;color:#000000;}
	.ft3039{font-size:17px;line-height:21px;font-family:KAAAAA+Tahoma;color:#000000;}
-->
</style>
<div id="page30-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables030.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3015">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft300">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft3016">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft3016">FINAL |&#160;1.10</p>
<p style="position:absolute;top:169px;left:85px;white-space:nowrap" class="ft3018"><b>6.&#160;Technical&#160;API&#160;Specification</b></p>
<p style="position:absolute;top:199px;left:85px;white-space:nowrap" class="ft307">This section describes the API&#160;of critical&#160;classes&#160;and interfaces&#160;within the DRM Core.&#160;<br/>This specification&#160;is based on the C++ language. Namespace&#160;used for the project is&#160;<br/>defined to&#160;be&#160;</p>
<p style="position:absolute;top:242px;left:200px;white-space:nowrap" class="ft3032">de_tum_ldv_opentc.</p>
<p style="position:absolute;top:276px;left:85px;white-space:nowrap" class="ft3011"><i><b>6.1&#160;External&#160;Interfaces</b></i></p>
<p style="position:absolute;top:308px;left:85px;white-space:nowrap" class="ft3038">Class&#160;interfaces&#160;which&#160;are&#160;to&#160;be&#160;accessed&#160;/&#160;called&#160;from&#160;outside&#160;the&#160;DRM&#160;Core&#160;are&#160;defined&#160;in&#160;this&#160;<br/>section.</p>
<p style="position:absolute;top:365px;left:85px;white-space:nowrap" class="ft3020"><i><b>6.1.1&#160;class&#160;PlayerInterface</b></i></p>
<p style="position:absolute;top:395px;left:85px;white-space:nowrap" class="ft3035">This&#160;class&#160;provides the&#160;main&#160;external interface to the&#160;OpenTC&#160;player.&#160;It is&#160;defined&#160;</p>
<p style="position:absolute;top:402px;left:687px;white-space:nowrap" class="ft3032">virtual</p>
<p style="position:absolute;top:395px;left:756px;white-space:nowrap" class="ft3035">&#160;and is&#160;</p>
<p style="position:absolute;top:417px;left:85px;white-space:nowrap" class="ft3035">implemented&#160;by the&#160;</p>
<p style="position:absolute;top:423px;left:236px;white-space:nowrap" class="ft3032">CoreManager</p>
<p style="position:absolute;top:417px;left:345px;white-space:nowrap" class="ft3035">&#160;class.</p>
<p style="position:absolute;top:462px;left:85px;white-space:nowrap" class="ft3032">6.1.1.1</p>
<p style="position:absolute;top:462px;left:171px;white-space:nowrap" class="ft3032">playerInit()</p>
<p style="position:absolute;top:476px;left:85px;white-space:nowrap" class="ft3035">Function:</p>
<p style="position:absolute;top:477px;left:246px;white-space:nowrap" class="ft3035">Initialize&#160;the player&#160;with&#160;an&#160;XML description&#160;of the&#160;</p>
<p style="position:absolute;top:483px;left:617px;white-space:nowrap" class="ft3032">playercapabilities</p>
<p style="position:absolute;top:518px;left:85px;white-space:nowrap" class="ft3035">Parameter:</p>
<p style="position:absolute;top:538px;left:85px;white-space:nowrap" class="ft3036"><b>Name</b></p>
<p style="position:absolute;top:538px;left:296px;white-space:nowrap" class="ft3036"><b>Type</b></p>
<p style="position:absolute;top:538px;left:459px;white-space:nowrap" class="ft3036"><b>Description</b></p>
<p style="position:absolute;top:564px;left:83px;white-space:nowrap" class="ft3032">playerCapabilities</p>
<p style="position:absolute;top:564px;left:297px;white-space:nowrap" class="ft3032">string</p>
<p style="position:absolute;top:558px;left:459px;white-space:nowrap" class="ft3035">XML&#160;string&#160;describing&#160;player capabilities</p>
<p style="position:absolute;top:599px;left:85px;white-space:nowrap" class="ft3035">Return&#160;value:</p>
<p style="position:absolute;top:620px;left:296px;white-space:nowrap" class="ft3036"><b>Type</b></p>
<p style="position:absolute;top:620px;left:459px;white-space:nowrap" class="ft3036"><b>Description</b></p>
<p style="position:absolute;top:646px;left:297px;white-space:nowrap" class="ft3032">int</p>
<p style="position:absolute;top:639px;left:459px;white-space:nowrap" class="ft3039">integer&#160;identifier representing&#160;the&#160;particular&#160;<br/>player</p>
<p style="position:absolute;top:704px;left:85px;white-space:nowrap" class="ft3032">6.1.1.2</p>
<p style="position:absolute;top:704px;left:171px;white-space:nowrap" class="ft3032">getDecryptionKey()</p>
<p style="position:absolute;top:719px;left:84px;white-space:nowrap" class="ft3035">Function:</p>
<p style="position:absolute;top:720px;left:245px;white-space:nowrap" class="ft3038">Get&#160;content&#160;key&#160;from&#160;the&#160;DRM&#160;Core.&#160;This&#160;is&#160;the main&#160;operation&#160;used by the&#160;<br/>player&#160;application&#160;to&#160;inform&#160;the&#160;DRM&#160;Core&#160;of&#160;a start&#160;of&#160;an digital item&#160;<br/>operation&#160;(e.g.&#160;“Play”)&#160;and to obtain&#160;the&#160;appropriate content key.</p>
<p style="position:absolute;top:799px;left:85px;white-space:nowrap" class="ft3035">Parameter:</p>
<p style="position:absolute;top:819px;left:85px;white-space:nowrap" class="ft3036"><b>Name</b></p>
<p style="position:absolute;top:819px;left:296px;white-space:nowrap" class="ft3036"><b>Type</b></p>
<p style="position:absolute;top:819px;left:459px;white-space:nowrap" class="ft3036"><b>Description</b></p>
<p style="position:absolute;top:845px;left:83px;white-space:nowrap" class="ft3032">playerID</p>
<p style="position:absolute;top:845px;left:297px;white-space:nowrap" class="ft3032">int</p>
<p style="position:absolute;top:839px;left:459px;white-space:nowrap" class="ft3039">integer&#160;identifier representing&#160;the&#160;particular&#160;<br/>player from&#160;</p>
<p style="position:absolute;top:867px;left:548px;white-space:nowrap" class="ft3032">playerInit()</p>
<p style="position:absolute;top:888px;left:83px;white-space:nowrap" class="ft3032">item</p>
<p style="position:absolute;top:888px;left:297px;white-space:nowrap" class="ft3032">ItemReference</p>
<p style="position:absolute;top:882px;left:459px;white-space:nowrap" class="ft3035">Reference&#160;to&#160;digital&#160;item</p>
<p style="position:absolute;top:923px;left:85px;white-space:nowrap" class="ft3035">Return&#160;value:</p>
<p style="position:absolute;top:930px;left:296px;white-space:nowrap" class="ft3037"><i>none</i></p>
<p style="position:absolute;top:967px;left:85px;white-space:nowrap" class="ft3032">6.1.1.3</p>
<p style="position:absolute;top:967px;left:171px;white-space:nowrap" class="ft3032">getSupportedREL()</p>
<p style="position:absolute;top:982px;left:85px;white-space:nowrap" class="ft3035">Function:</p>
<p style="position:absolute;top:982px;left:255px;white-space:nowrap" class="ft3035">Query the&#160;DRM&#160;Core&#160;for supported&#160;REL languages</p>
<p style="position:absolute;top:1022px;left:85px;white-space:nowrap" class="ft3035">Parameter:</p>
<p style="position:absolute;top:1022px;left:293px;white-space:nowrap" class="ft3035">none</p>
<p style="position:absolute;top:1062px;left:85px;white-space:nowrap" class="ft3035">Return&#160;value:</p>
<p style="position:absolute;top:1082px;left:296px;white-space:nowrap" class="ft3036"><b>Type</b></p>
<p style="position:absolute;top:1082px;left:459px;white-space:nowrap" class="ft3036"><b>Description</b></p>
<p style="position:absolute;top:1108px;left:297px;white-space:nowrap" class="ft3032">list&lt;REL&gt;</p>
<p style="position:absolute;top:1102px;left:459px;white-space:nowrap" class="ft3035">List of languages&#160;supported by the&#160;Core</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft3016">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft3016">25/39</p>
</div>
<!-- Page 31 -->
<a name="31"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page31-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables031.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3115">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft310">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft3116">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft3116">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft3120"><i><b>6.1.2&#160;class&#160;ManagementInterface</b></i></p>
<p style="position:absolute;top:181px;left:85px;white-space:nowrap" class="ft3138">This&#160;class&#160;provides&#160;a&#160;second&#160;external&#160;interface&#160;for&#160;administrative&#160;functions&#160;to&#160;the&#160;DRM&#160;Core,&#160;such&#160;<br/>as&#160;license management&#160;and&#160;controlling&#160;attestation.</p>
<p style="position:absolute;top:244px;left:85px;white-space:nowrap" class="ft3132">6.1.2.1</p>
<p style="position:absolute;top:244px;left:171px;white-space:nowrap" class="ft3132">insertLicense()</p>
<p style="position:absolute;top:259px;left:84px;white-space:nowrap" class="ft3135">Function:</p>
<p style="position:absolute;top:260px;left:245px;white-space:nowrap" class="ft3138">insert&#160;a&#160;signed license&#160;from a&#160;mutually&#160;attested source into&#160;the DRM Core&#160;<br/>for a particular&#160;digital&#160;item</p>
<p style="position:absolute;top:319px;left:85px;white-space:nowrap" class="ft3135">Parameter:</p>
<p style="position:absolute;top:339px;left:85px;white-space:nowrap" class="ft3136"><b>Name</b></p>
<p style="position:absolute;top:339px;left:296px;white-space:nowrap" class="ft3136"><b>Type</b></p>
<p style="position:absolute;top:339px;left:459px;white-space:nowrap" class="ft3136"><b>Description</b></p>
<p style="position:absolute;top:366px;left:83px;white-space:nowrap" class="ft3132">license</p>
<p style="position:absolute;top:366px;left:297px;white-space:nowrap" class="ft3132">string</p>
<p style="position:absolute;top:359px;left:459px;white-space:nowrap" class="ft3135">XML&#160;string&#160;of license</p>
<p style="position:absolute;top:387px;left:83px;white-space:nowrap" class="ft3132">relType</p>
<p style="position:absolute;top:387px;left:297px;white-space:nowrap" class="ft3132">REL</p>
<p style="position:absolute;top:381px;left:459px;white-space:nowrap" class="ft3135">REL language identifier</p>
<p style="position:absolute;top:408px;left:83px;white-space:nowrap" class="ft3132">item</p>
<p style="position:absolute;top:408px;left:297px;white-space:nowrap" class="ft3132">ItemReference</p>
<p style="position:absolute;top:402px;left:459px;white-space:nowrap" class="ft3135">Reference&#160;to&#160;digital&#160;item</p>
<p style="position:absolute;top:443px;left:85px;white-space:nowrap" class="ft3135">Return&#160;value:</p>
<p style="position:absolute;top:443px;left:298px;white-space:nowrap" class="ft3135">none</p>
<p style="position:absolute;top:487px;left:85px;white-space:nowrap" class="ft3132">6.1.2.2</p>
<p style="position:absolute;top:487px;left:171px;white-space:nowrap" class="ft3132">getAttestationKey()</p>
<p style="position:absolute;top:502px;left:85px;white-space:nowrap" class="ft3135">Function:</p>
<p style="position:absolute;top:502px;left:255px;white-space:nowrap" class="ft3135">Obtain an&#160;attestation key to download&#160;trusted&#160;content&#160;from&#160;a trusted&#160;</p>
<p style="position:absolute;top:522px;left:85px;white-space:nowrap" class="ft3135">source</p>
<p style="position:absolute;top:561px;left:85px;white-space:nowrap" class="ft3135">Parameter:</p>
<p style="position:absolute;top:582px;left:85px;white-space:nowrap" class="ft3136"><b>Name</b></p>
<p style="position:absolute;top:582px;left:296px;white-space:nowrap" class="ft3136"><b>Type</b></p>
<p style="position:absolute;top:582px;left:459px;white-space:nowrap" class="ft3136"><b>Description</b></p>
<p style="position:absolute;top:608px;left:83px;white-space:nowrap" class="ft3132">playerID</p>
<p style="position:absolute;top:608px;left:297px;white-space:nowrap" class="ft3132">int</p>
<p style="position:absolute;top:602px;left:459px;white-space:nowrap" class="ft3139">integer&#160;identifier representing&#160;the&#160;particular&#160;<br/>player from&#160;</p>
<p style="position:absolute;top:630px;left:548px;white-space:nowrap" class="ft3132">playerInit()</p>
<p style="position:absolute;top:651px;left:83px;white-space:nowrap" class="ft3132">relType</p>
<p style="position:absolute;top:651px;left:297px;white-space:nowrap" class="ft3132">REL</p>
<p style="position:absolute;top:645px;left:459px;white-space:nowrap" class="ft3135">REL language identifier</p>
<p style="position:absolute;top:672px;left:83px;white-space:nowrap" class="ft3132">serverURL</p>
<p style="position:absolute;top:672px;left:297px;white-space:nowrap" class="ft3132">string</p>
<p style="position:absolute;top:666px;left:459px;white-space:nowrap" class="ft3135">URL string&#160;of&#160;attestation server</p>
<p style="position:absolute;top:707px;left:85px;white-space:nowrap" class="ft3135">Return&#160;value:</p>
<p style="position:absolute;top:728px;left:296px;white-space:nowrap" class="ft3136"><b>Type</b></p>
<p style="position:absolute;top:728px;left:459px;white-space:nowrap" class="ft3136"><b>Description</b></p>
<p style="position:absolute;top:754px;left:297px;white-space:nowrap" class="ft3132">Key</p>
<p style="position:absolute;top:748px;left:459px;white-space:nowrap" class="ft3135">Attestation key</p>
<p style="position:absolute;top:787px;left:85px;white-space:nowrap" class="ft3120"><i><b>6.1.3&#160;class&#160;Utility</b></i></p>
<p style="position:absolute;top:817px;left:85px;white-space:nowrap" class="ft317">This is a utility class&#160;which provides a common&#160;mechanism for downloading tools for&#160;<br/>commonly&#160;used functions,&#160;such as&#160;decryption&#160;and decoding, for both&#160;the DRM Core&#160;<br/>and player.&#160;</p>
<p style="position:absolute;top:887px;left:85px;white-space:nowrap" class="ft3132">6.1.3.1</p>
<p style="position:absolute;top:887px;left:171px;white-space:nowrap" class="ft3132">getTool()</p>
<p style="position:absolute;top:902px;left:83px;white-space:nowrap" class="ft3135">Function:</p>
<p style="position:absolute;top:902px;left:244px;white-space:nowrap" class="ft3138">Function&#160;to retrieve a specific&#160;tool for a specific&#160;platform and&#160;application,&#160;<br/>using&#160;a unique&#160;XML tool description</p>
<p style="position:absolute;top:962px;left:85px;white-space:nowrap" class="ft3135">Parameter:</p>
<p style="position:absolute;top:982px;left:85px;white-space:nowrap" class="ft3136"><b>Name</b></p>
<p style="position:absolute;top:982px;left:296px;white-space:nowrap" class="ft3136"><b>Type</b></p>
<p style="position:absolute;top:982px;left:459px;white-space:nowrap" class="ft3136"><b>Description</b></p>
<p style="position:absolute;top:1008px;left:83px;white-space:nowrap" class="ft3132">toolDescription</p>
<p style="position:absolute;top:1008px;left:297px;white-space:nowrap" class="ft3132">string</p>
<p style="position:absolute;top:1002px;left:459px;white-space:nowrap" class="ft3135">XML&#160;tool description&#160;(based on&#160;MPEG-IPMP)</p>
<p style="position:absolute;top:1043px;left:85px;white-space:nowrap" class="ft3135">Return&#160;value:</p>
<p style="position:absolute;top:1064px;left:296px;white-space:nowrap" class="ft3136"><b>Type</b></p>
<p style="position:absolute;top:1064px;left:459px;white-space:nowrap" class="ft3136"><b>Description</b></p>
<p style="position:absolute;top:1090px;left:297px;white-space:nowrap" class="ft3132">function ptr</p>
<p style="position:absolute;top:1083px;left:459px;white-space:nowrap" class="ft3135">pointer&#160;to&#160;tool&#160;function</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft3116">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft3116">26/39</p>
</div>
<!-- Page 32 -->
<a name="32"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page32-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables032.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3215">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft320">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft3216">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft3216">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft3211"><i><b>6.2&#160;Internal Interfaces</b></i></p>
<p style="position:absolute;top:183px;left:85px;white-space:nowrap" class="ft3238">This&#160;&#160;&#160;section&#160;&#160;&#160;defines&#160;&#160;&#160;class&#160;&#160;&#160;interfaces&#160;&#160;&#160;used&#160;&#160;&#160;between&#160;&#160;&#160;important&#160;&#160;&#160;modules&#160;&#160;&#160;within&#160;&#160;&#160;the&#160;&#160;&#160;DRM&#160;&#160;&#160;Core,&#160;<br/>supporting a&#160;more&#160;modular approach.</p>
<p style="position:absolute;top:241px;left:85px;white-space:nowrap" class="ft3220"><i><b>6.2.1&#160;Class&#160;DatabaseManager</b></i></p>
<p style="position:absolute;top:271px;left:85px;white-space:nowrap" class="ft3238">This&#160;is&#160;an&#160;internal&#160;interface&#160;used&#160;to&#160;connect&#160;to&#160;the&#160;secure&#160;database&#160;supporting&#160;the&#160;DRM&#160;Core.&#160;It&#160;is&#160;<br/>used&#160;for&#160;persistent&#160;secure&#160;storage&#160;of&#160;licenses,&#160;states&#160;(of&#160;digital&#160;items)&#160;and&#160;&#160;content&#160;keys&#160;for&#160;the&#160;<br/>respective&#160;digital&#160;items.</p>
<p style="position:absolute;top:354px;left:85px;white-space:nowrap" class="ft3232">6.2.1.1</p>
<p style="position:absolute;top:354px;left:171px;white-space:nowrap" class="ft3232">getLicense()</p>
<p style="position:absolute;top:369px;left:85px;white-space:nowrap" class="ft3235">Function:</p>
<p style="position:absolute;top:369px;left:245px;white-space:nowrap" class="ft3235">Retrieve license&#160;for&#160;a&#160;particular digital item</p>
<p style="position:absolute;top:408px;left:85px;white-space:nowrap" class="ft3235">Parameter:</p>
<p style="position:absolute;top:429px;left:85px;white-space:nowrap" class="ft3236"><b>Name</b></p>
<p style="position:absolute;top:429px;left:296px;white-space:nowrap" class="ft3236"><b>Type</b></p>
<p style="position:absolute;top:429px;left:459px;white-space:nowrap" class="ft3236"><b>Description</b></p>
<p style="position:absolute;top:455px;left:83px;white-space:nowrap" class="ft3232">item</p>
<p style="position:absolute;top:455px;left:297px;white-space:nowrap" class="ft3232">ItemReference</p>
<p style="position:absolute;top:449px;left:459px;white-space:nowrap" class="ft3235">Reference&#160;to&#160;digital&#160;item</p>
<p style="position:absolute;top:490px;left:85px;white-space:nowrap" class="ft3235">Return&#160;value:</p>
<p style="position:absolute;top:510px;left:296px;white-space:nowrap" class="ft3236"><b>Type</b></p>
<p style="position:absolute;top:510px;left:459px;white-space:nowrap" class="ft3236"><b>Description</b></p>
<p style="position:absolute;top:536px;left:297px;white-space:nowrap" class="ft3232">License</p>
<p style="position:absolute;top:530px;left:459px;white-space:nowrap" class="ft3235">License&#160;object</p>
<p style="position:absolute;top:575px;left:85px;white-space:nowrap" class="ft3232">6.2.1.2</p>
<p style="position:absolute;top:575px;left:171px;white-space:nowrap" class="ft3232">setState()</p>
<p style="position:absolute;top:590px;left:85px;white-space:nowrap" class="ft3235">Function:</p>
<p style="position:absolute;top:590px;left:245px;white-space:nowrap" class="ft3235">Save state for a particular&#160;digital&#160;item</p>
<p style="position:absolute;top:630px;left:85px;white-space:nowrap" class="ft3235">Parameter:</p>
<p style="position:absolute;top:650px;left:85px;white-space:nowrap" class="ft3236"><b>Name</b></p>
<p style="position:absolute;top:650px;left:296px;white-space:nowrap" class="ft3236"><b>Type</b></p>
<p style="position:absolute;top:650px;left:459px;white-space:nowrap" class="ft3236"><b>Description</b></p>
<p style="position:absolute;top:676px;left:83px;white-space:nowrap" class="ft3232">item</p>
<p style="position:absolute;top:676px;left:297px;white-space:nowrap" class="ft3232">ItemReference</p>
<p style="position:absolute;top:670px;left:459px;white-space:nowrap" class="ft3235">Reference&#160;to&#160;digital&#160;item</p>
<p style="position:absolute;top:698px;left:83px;white-space:nowrap" class="ft3232">state</p>
<p style="position:absolute;top:698px;left:297px;white-space:nowrap" class="ft3232">ItemState</p>
<p style="position:absolute;top:692px;left:459px;white-space:nowrap" class="ft3235">Item state to modify</p>
<p style="position:absolute;top:732px;left:85px;white-space:nowrap" class="ft3235">Return&#160;value:</p>
<p style="position:absolute;top:732px;left:297px;white-space:nowrap" class="ft3235">none</p>
<p style="position:absolute;top:776px;left:85px;white-space:nowrap" class="ft3232">6.2.1.3</p>
<p style="position:absolute;top:776px;left:171px;white-space:nowrap" class="ft3232">deleteLicense()</p>
<p style="position:absolute;top:791px;left:84px;white-space:nowrap" class="ft3235">Function:</p>
<p style="position:absolute;top:792px;left:245px;white-space:nowrap" class="ft3235">delete license&#160;for&#160;a particular digital&#160;item&#160;(and&#160;all corresponding&#160;states and&#160;</p>
<p style="position:absolute;top:812px;left:247px;white-space:nowrap" class="ft3235">keys)</p>
<p style="position:absolute;top:851px;left:85px;white-space:nowrap" class="ft3235">Parameter:</p>
<p style="position:absolute;top:871px;left:85px;white-space:nowrap" class="ft3236"><b>Name</b></p>
<p style="position:absolute;top:871px;left:296px;white-space:nowrap" class="ft3236"><b>Type</b></p>
<p style="position:absolute;top:871px;left:459px;white-space:nowrap" class="ft3236"><b>Description</b></p>
<p style="position:absolute;top:897px;left:83px;white-space:nowrap" class="ft3232">item</p>
<p style="position:absolute;top:897px;left:297px;white-space:nowrap" class="ft3232">ItemReference</p>
<p style="position:absolute;top:891px;left:459px;white-space:nowrap" class="ft3235">Reference&#160;to&#160;digital&#160;item</p>
<p style="position:absolute;top:932px;left:85px;white-space:nowrap" class="ft3235">Return&#160;value:</p>
<p style="position:absolute;top:932px;left:296px;white-space:nowrap" class="ft3235">none</p>
<p style="position:absolute;top:976px;left:85px;white-space:nowrap" class="ft3232">6.2.1.4</p>
<p style="position:absolute;top:976px;left:171px;white-space:nowrap" class="ft3232">getItemState()</p>
<p style="position:absolute;top:991px;left:86px;white-space:nowrap" class="ft3235">Function:</p>
<p style="position:absolute;top:991px;left:245px;white-space:nowrap" class="ft3235">Retrieve the&#160;state for a particular&#160;digital&#160;item</p>
<p style="position:absolute;top:1031px;left:85px;white-space:nowrap" class="ft3235">Parameter:</p>
<p style="position:absolute;top:1051px;left:85px;white-space:nowrap" class="ft3236"><b>Name</b></p>
<p style="position:absolute;top:1051px;left:296px;white-space:nowrap" class="ft3236"><b>Type</b></p>
<p style="position:absolute;top:1051px;left:459px;white-space:nowrap" class="ft3236"><b>Description</b></p>
<p style="position:absolute;top:1077px;left:83px;white-space:nowrap" class="ft3232">item</p>
<p style="position:absolute;top:1077px;left:297px;white-space:nowrap" class="ft3232">ItemReference</p>
<p style="position:absolute;top:1071px;left:459px;white-space:nowrap" class="ft3235">Reference&#160;to&#160;digital&#160;item</p>
<p style="position:absolute;top:1112px;left:85px;white-space:nowrap" class="ft3235">Return&#160;value:</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft3216">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft3216">27/39</p>
</div>
<!-- Page 33 -->
<a name="33"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page33-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables033.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3315">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft330">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft3316">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft3316">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:296px;white-space:nowrap" class="ft3336"><b>Type</b></p>
<p style="position:absolute;top:151px;left:459px;white-space:nowrap" class="ft3336"><b>Description</b></p>
<p style="position:absolute;top:177px;left:297px;white-space:nowrap" class="ft3332">ItemState</p>
<p style="position:absolute;top:171px;left:459px;white-space:nowrap" class="ft3335">Item state retrieved</p>
<p style="position:absolute;top:216px;left:85px;white-space:nowrap" class="ft3332">6.2.1.5</p>
<p style="position:absolute;top:216px;left:171px;white-space:nowrap" class="ft3332">getDecryptionKey()</p>
<p style="position:absolute;top:231px;left:86px;white-space:nowrap" class="ft3335">Function:</p>
<p style="position:absolute;top:231px;left:245px;white-space:nowrap" class="ft3335">Retrieve content key for a particular digital&#160;item</p>
<p style="position:absolute;top:270px;left:85px;white-space:nowrap" class="ft3335">Parameter:</p>
<p style="position:absolute;top:291px;left:85px;white-space:nowrap" class="ft3336"><b>Name</b></p>
<p style="position:absolute;top:291px;left:296px;white-space:nowrap" class="ft3336"><b>Type</b></p>
<p style="position:absolute;top:291px;left:459px;white-space:nowrap" class="ft3336"><b>Description</b></p>
<p style="position:absolute;top:317px;left:83px;white-space:nowrap" class="ft3332">item</p>
<p style="position:absolute;top:317px;left:297px;white-space:nowrap" class="ft3332">ItemReference</p>
<p style="position:absolute;top:311px;left:459px;white-space:nowrap" class="ft3335">Reference&#160;to&#160;digital&#160;item</p>
<p style="position:absolute;top:352px;left:85px;white-space:nowrap" class="ft3335">Return&#160;value:</p>
<p style="position:absolute;top:372px;left:296px;white-space:nowrap" class="ft3336"><b>Type</b></p>
<p style="position:absolute;top:372px;left:459px;white-space:nowrap" class="ft3336"><b>Description</b></p>
<p style="position:absolute;top:398px;left:297px;white-space:nowrap" class="ft3332">Key</p>
<p style="position:absolute;top:392px;left:459px;white-space:nowrap" class="ft3335">content&#160;key</p>
<p style="position:absolute;top:432px;left:85px;white-space:nowrap" class="ft3320"><i><b>6.2.2&#160;Class&#160;InterpreterInterface</b></i></p>
<p style="position:absolute;top:462px;left:85px;white-space:nowrap" class="ft3338">This&#160;is&#160;an&#160;internal&#160;interface&#160;used&#160;for&#160;every&#160;module&#160;which&#160;works&#160;as&#160;a&#160;license&#160;interpreter&#160;(to&#160;parse&#160;<br/>and&#160;decide&#160;if&#160;a&#160;player&#160;is&#160;allowed&#160;to&#160;play,&#160;and&#160;under&#160;what&#160;conditions)&#160;This&#160;is&#160;implemented&#160;by&#160;the&#160;</p>
<p style="position:absolute;top:508px;left:85px;white-space:nowrap" class="ft3332">MPEG21Interpreter&#160;</p>
<p style="position:absolute;top:502px;left:263px;white-space:nowrap" class="ft3335">class&#160;which&#160;provides&#160;interpretation&#160;for&#160;MPEG-21&#160;licenses.</p>
<p style="position:absolute;top:546px;left:85px;white-space:nowrap" class="ft3332">6.2.2.1</p>
<p style="position:absolute;top:546px;left:171px;white-space:nowrap" class="ft3332">interpretLicense()</p>
<p style="position:absolute;top:561px;left:84px;white-space:nowrap" class="ft3335">Function:</p>
<p style="position:absolute;top:562px;left:246px;white-space:nowrap" class="ft3338">Interpret license&#160;from&#160;a generic license&#160;object,&#160;given the&#160;entire authorization&#160;<br/>request&#160;parameters. When&#160;positively authorized,&#160;a&#160;player restriction&#160;<br/>description&#160;is returned as string,&#160;otherwise&#160;an exception&#160;is raised.</p>
<p style="position:absolute;top:641px;left:85px;white-space:nowrap" class="ft3335">Parameter:</p>
<p style="position:absolute;top:661px;left:85px;white-space:nowrap" class="ft3336"><b>Name</b></p>
<p style="position:absolute;top:661px;left:296px;white-space:nowrap" class="ft3336"><b>Type</b></p>
<p style="position:absolute;top:661px;left:459px;white-space:nowrap" class="ft3336"><b>Description</b></p>
<p style="position:absolute;top:687px;left:83px;white-space:nowrap" class="ft3332">licenseGroup</p>
<p style="position:absolute;top:687px;left:297px;white-space:nowrap" class="ft3332">list&lt;License&gt;</p>
<p style="position:absolute;top:681px;left:459px;white-space:nowrap" class="ft3335">List of all&#160;license objects to interpret&#160;together</p>
<p style="position:absolute;top:709px;left:83px;white-space:nowrap" class="ft3332">item</p>
<p style="position:absolute;top:709px;left:297px;white-space:nowrap" class="ft3332">ItemReference</p>
<p style="position:absolute;top:703px;left:459px;white-space:nowrap" class="ft3335">Reference&#160;to&#160;digital&#160;item</p>
<p style="position:absolute;top:730px;left:83px;white-space:nowrap" class="ft3332">state</p>
<p style="position:absolute;top:730px;left:297px;white-space:nowrap" class="ft3332">ItemState</p>
<p style="position:absolute;top:724px;left:459px;white-space:nowrap" class="ft3335">Item state</p>
<p style="position:absolute;top:752px;left:83px;white-space:nowrap" class="ft3332">system</p>
<p style="position:absolute;top:752px;left:297px;white-space:nowrap" class="ft3332">SystemState</p>
<p style="position:absolute;top:746px;left:459px;white-space:nowrap" class="ft3335">System state</p>
<p style="position:absolute;top:773px;left:83px;white-space:nowrap" class="ft3332">operation</p>
<p style="position:absolute;top:773px;left:297px;white-space:nowrap" class="ft3332">string</p>
<p style="position:absolute;top:767px;left:459px;white-space:nowrap" class="ft3335">Operation taken on&#160;Digital&#160;Item</p>
<p style="position:absolute;top:808px;left:85px;white-space:nowrap" class="ft3335">Return&#160;value:</p>
<p style="position:absolute;top:828px;left:296px;white-space:nowrap" class="ft3336"><b>Type</b></p>
<p style="position:absolute;top:828px;left:459px;white-space:nowrap" class="ft3336"><b>Description</b></p>
<p style="position:absolute;top:855px;left:297px;white-space:nowrap" class="ft3332">string</p>
<p style="position:absolute;top:848px;left:459px;white-space:nowrap" class="ft3335">XML&#160;string&#160;of playback restriction&#160;description</p>
<p style="position:absolute;top:893px;left:85px;white-space:nowrap" class="ft3332">6.2.2.2</p>
<p style="position:absolute;top:893px;left:171px;white-space:nowrap" class="ft3332">getSupportedLanguage()</p>
<p style="position:absolute;top:908px;left:86px;white-space:nowrap" class="ft3335">Function:</p>
<p style="position:absolute;top:909px;left:245px;white-space:nowrap" class="ft3335">Query the&#160;interpretation&#160;module&#160;for&#160;the supported&#160;REL language in&#160;run-time.</p>
<p style="position:absolute;top:948px;left:85px;white-space:nowrap" class="ft3335">Parameter:</p>
<p style="position:absolute;top:948px;left:294px;white-space:nowrap" class="ft3335">none</p>
<p style="position:absolute;top:988px;left:85px;white-space:nowrap" class="ft3335">Return&#160;value:</p>
<p style="position:absolute;top:1008px;left:296px;white-space:nowrap" class="ft3336"><b>Type</b></p>
<p style="position:absolute;top:1008px;left:459px;white-space:nowrap" class="ft3336"><b>Description</b></p>
<p style="position:absolute;top:1034px;left:297px;white-space:nowrap" class="ft3332">REL</p>
<p style="position:absolute;top:1028px;left:459px;white-space:nowrap" class="ft3335">supported REL language</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft3316">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft3316">28/39</p>
</div>
<!-- Page 34 -->
<a name="34"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page34-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables034.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3415">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft340">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft3416">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft3416">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft3420"><i><b>6.2.3&#160;class&#160;SystemState</b></i></p>
<p style="position:absolute;top:181px;left:85px;white-space:nowrap" class="ft3438">This&#160;class&#160;is&#160;an&#160;extraction&#160;of&#160;the&#160;possible&#160;system&#160;states,&#160;such&#160;as&#160;secure&#160;time,&#160;platform&#160;and&#160;owner&#160;<br/>credentials.</p>
<p style="position:absolute;top:244px;left:85px;white-space:nowrap" class="ft3432">6.2.3.1</p>
<p style="position:absolute;top:244px;left:171px;white-space:nowrap" class="ft3432">checkSysteState()</p>
<p style="position:absolute;top:259px;left:85px;white-space:nowrap" class="ft3435">Function:</p>
<p style="position:absolute;top:260px;left:244px;white-space:nowrap" class="ft3435">Query&#160;a&#160;particular system&#160;state</p>
<p style="position:absolute;top:299px;left:85px;white-space:nowrap" class="ft3435">Parameter:</p>
<p style="position:absolute;top:320px;left:85px;white-space:nowrap" class="ft3436"><b>Name</b></p>
<p style="position:absolute;top:320px;left:296px;white-space:nowrap" class="ft3436"><b>Type</b></p>
<p style="position:absolute;top:320px;left:459px;white-space:nowrap" class="ft3436"><b>Description</b></p>
<p style="position:absolute;top:346px;left:83px;white-space:nowrap" class="ft3432">state</p>
<p style="position:absolute;top:346px;left:297px;white-space:nowrap" class="ft3432">string</p>
<p style="position:absolute;top:339px;left:459px;white-space:nowrap" class="ft3435">String ID&#160;of state to retrieve</p>
<p style="position:absolute;top:380px;left:85px;white-space:nowrap" class="ft3435">Return&#160;value:</p>
<p style="position:absolute;top:401px;left:296px;white-space:nowrap" class="ft3436"><b>Type</b></p>
<p style="position:absolute;top:401px;left:459px;white-space:nowrap" class="ft3436"><b>Description</b></p>
<p style="position:absolute;top:427px;left:297px;white-space:nowrap" class="ft3432">string</p>
<p style="position:absolute;top:421px;left:459px;white-space:nowrap" class="ft3435">Value&#160;of system&#160;state</p>
<p style="position:absolute;top:460px;left:85px;white-space:nowrap" class="ft3420"><i><b>6.2.4&#160;class&#160;CoreManager</b></i></p>
<p style="position:absolute;top:490px;left:85px;white-space:nowrap" class="ft3435">This&#160;class&#160;is&#160;inherited&#160;from&#160;&#160;</p>
<p style="position:absolute;top:496px;left:298px;white-space:nowrap" class="ft3432">PlayerInterface</p>
<p style="position:absolute;top:490px;left:446px;white-space:nowrap" class="ft3435">&#160;&#160;and&#160;&#160;</p>
<p style="position:absolute;top:496px;left:489px;white-space:nowrap" class="ft3432">ManagementInterface</p>
<p style="position:absolute;top:490px;left:677px;white-space:nowrap" class="ft3435">,&#160;and&#160;implements&#160;</p>
<p style="position:absolute;top:512px;left:85px;white-space:nowrap" class="ft3435">the&#160;</p>
<p style="position:absolute;top:518px;left:116px;white-space:nowrap" class="ft3432">PlayerInterface&#160;&#160;</p>
<p style="position:absolute;top:512px;left:276px;white-space:nowrap" class="ft3435">and</p>
<p style="position:absolute;top:518px;left:303px;white-space:nowrap" class="ft3432">&#160;&#160;ManagementInterface.</p>
<p style="position:absolute;top:512px;left:513px;white-space:nowrap" class="ft3435">&#160;It&#160;is&#160;the&#160;main&#160;entry&#160;point&#160;for&#160;both&#160;the&#160;</p>
<p style="position:absolute;top:533px;left:85px;white-space:nowrap" class="ft3435">OpenTC&#160;player and&#160;Manager GUI.</p>
<p style="position:absolute;top:571px;left:85px;white-space:nowrap" class="ft3420"><i><b>6.2.5&#160;class&#160;LicenseManager</b></i></p>
<p style="position:absolute;top:601px;left:85px;white-space:nowrap" class="ft3438">This&#160;&#160;&#160;is&#160;&#160;&#160;a&#160;&#160;&#160;manager&#160;&#160;&#160;class&#160;&#160;&#160;to&#160;&#160;&#160;a&#160;&#160;&#160;license&#160;&#160;&#160;management&#160;&#160;&#160;module,&#160;&#160;&#160;which&#160;&#160;&#160;handles&#160;&#160;&#160;interpretation&#160;&#160;&#160;and&#160;<br/>translation of&#160;licenses,&#160;in&#160;different&#160;REL&#160;languages.</p>
<p style="position:absolute;top:664px;left:85px;white-space:nowrap" class="ft3432">6.2.5.1</p>
<p style="position:absolute;top:664px;left:171px;white-space:nowrap" class="ft3432">interpretLicense()</p>
<p style="position:absolute;top:679px;left:85px;white-space:nowrap" class="ft3435">Function:</p>
<p style="position:absolute;top:680px;left:245px;white-space:nowrap" class="ft3435">Interpret&#160;the license&#160;given the&#160;full&#160;authorization&#160;request&#160;parameters.</p>
<p style="position:absolute;top:719px;left:85px;white-space:nowrap" class="ft3435">Parameter:</p>
<p style="position:absolute;top:739px;left:85px;white-space:nowrap" class="ft3436"><b>Name</b></p>
<p style="position:absolute;top:739px;left:296px;white-space:nowrap" class="ft3436"><b>Type</b></p>
<p style="position:absolute;top:739px;left:459px;white-space:nowrap" class="ft3436"><b>Description</b></p>
<p style="position:absolute;top:765px;left:83px;white-space:nowrap" class="ft3432">licenseGroup</p>
<p style="position:absolute;top:765px;left:297px;white-space:nowrap" class="ft3432">list&lt;License&gt;</p>
<p style="position:absolute;top:759px;left:459px;white-space:nowrap" class="ft3435">List of all&#160;license objects to interpret&#160;together</p>
<p style="position:absolute;top:787px;left:83px;white-space:nowrap" class="ft3432">item</p>
<p style="position:absolute;top:787px;left:297px;white-space:nowrap" class="ft3432">ItemReference</p>
<p style="position:absolute;top:781px;left:459px;white-space:nowrap" class="ft3435">Reference&#160;to&#160;digital&#160;item</p>
<p style="position:absolute;top:808px;left:83px;white-space:nowrap" class="ft3432">operation</p>
<p style="position:absolute;top:808px;left:297px;white-space:nowrap" class="ft3432">string</p>
<p style="position:absolute;top:802px;left:459px;white-space:nowrap" class="ft3435">Operation taken on&#160;Digital&#160;Item</p>
<p style="position:absolute;top:843px;left:85px;white-space:nowrap" class="ft3435">Return&#160;value:</p>
<p style="position:absolute;top:864px;left:296px;white-space:nowrap" class="ft3436"><b>Type</b></p>
<p style="position:absolute;top:864px;left:459px;white-space:nowrap" class="ft3436"><b>Description</b></p>
<p style="position:absolute;top:890px;left:297px;white-space:nowrap" class="ft3432">string</p>
<p style="position:absolute;top:884px;left:459px;white-space:nowrap" class="ft3435">XML&#160;string&#160;of playback restriction&#160;description</p>
<p style="position:absolute;top:904px;left:85px;white-space:nowrap" class="ft3435">Exceptions:</p>
<p style="position:absolute;top:925px;left:194px;white-space:nowrap" class="ft3436"><b>Type</b></p>
<p style="position:absolute;top:925px;left:459px;white-space:nowrap" class="ft3436"><b>Description</b></p>
<p style="position:absolute;top:951px;left:192px;white-space:nowrap" class="ft3432">ERROR_LICENSE_INVALID</p>
<p style="position:absolute;top:945px;left:459px;white-space:nowrap" class="ft3435">License&#160;is invalid</p>
<p style="position:absolute;top:972px;left:192px;white-space:nowrap" class="ft3432">ERROR_OPERATION_DISALLOWED</p>
<p style="position:absolute;top:966px;left:459px;white-space:nowrap" class="ft3435">Operation is&#160;completely&#160;not allowed</p>
<p style="position:absolute;top:1031px;left:85px;white-space:nowrap" class="ft3432">6.2.5.2</p>
<p style="position:absolute;top:1031px;left:171px;white-space:nowrap" class="ft3432">translateLicense()</p>
<p style="position:absolute;top:1046px;left:84px;white-space:nowrap" class="ft3435">Function:</p>
<p style="position:absolute;top:1046px;left:245px;white-space:nowrap" class="ft3435">Translate the&#160;license&#160;into another REL language,&#160;with a&#160;restriction&#160;</p>
<p style="position:absolute;top:1066px;left:246px;white-space:nowrap" class="ft3435">description&#160;string&#160;(describing&#160;the capabilities&#160;of the&#160;target player)</p>
<p style="position:absolute;top:1106px;left:85px;white-space:nowrap" class="ft3435">Parameter:</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft3416">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft3416">29/39</p>
</div>
<!-- Page 35 -->
<a name="35"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page35-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables035.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3515">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft350">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft3516">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft3516">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft3536"><b>Name</b></p>
<p style="position:absolute;top:151px;left:296px;white-space:nowrap" class="ft3536"><b>Type</b></p>
<p style="position:absolute;top:151px;left:459px;white-space:nowrap" class="ft3536"><b>Description</b></p>
<p style="position:absolute;top:177px;left:83px;white-space:nowrap" class="ft3532">sourceLicense</p>
<p style="position:absolute;top:177px;left:297px;white-space:nowrap" class="ft3532">License</p>
<p style="position:absolute;top:171px;left:459px;white-space:nowrap" class="ft3535">Input&#160;license object&#160;to&#160;be translated</p>
<p style="position:absolute;top:199px;left:83px;white-space:nowrap" class="ft3532">targetLicenseLang</p>
<p style="position:absolute;top:199px;left:297px;white-space:nowrap" class="ft3532">REL</p>
<p style="position:absolute;top:192px;left:459px;white-space:nowrap" class="ft3535">REL language to translate to</p>
<p style="position:absolute;top:220px;left:83px;white-space:nowrap" class="ft3532">targetRestrictions</p>
<p style="position:absolute;top:220px;left:297px;white-space:nowrap" class="ft3532">string</p>
<p style="position:absolute;top:214px;left:459px;white-space:nowrap" class="ft3535">XML&#160;string&#160;of output license</p>
<p style="position:absolute;top:255px;left:85px;white-space:nowrap" class="ft3535">Return&#160;value:</p>
<p style="position:absolute;top:275px;left:296px;white-space:nowrap" class="ft3536"><b>Type</b></p>
<p style="position:absolute;top:275px;left:459px;white-space:nowrap" class="ft3536"><b>Description</b></p>
<p style="position:absolute;top:301px;left:297px;white-space:nowrap" class="ft3532">License</p>
<p style="position:absolute;top:295px;left:459px;white-space:nowrap" class="ft3535">License&#160;object&#160;after translation</p>
<p style="position:absolute;top:340px;left:85px;white-space:nowrap" class="ft3532">6.2.5.3</p>
<p style="position:absolute;top:340px;left:171px;white-space:nowrap" class="ft3532">getSupportSourceLanguages()</p>
<p style="position:absolute;top:355px;left:87px;white-space:nowrap" class="ft3535">Function:</p>
<p style="position:absolute;top:355px;left:245px;white-space:nowrap" class="ft3535">Query for all&#160;supported input&#160;REL languages</p>
<p style="position:absolute;top:395px;left:85px;white-space:nowrap" class="ft3535">Parameter:</p>
<p style="position:absolute;top:395px;left:297px;white-space:nowrap" class="ft3535">none</p>
<p style="position:absolute;top:435px;left:85px;white-space:nowrap" class="ft3535">Return&#160;value:</p>
<p style="position:absolute;top:455px;left:296px;white-space:nowrap" class="ft3536"><b>Type</b></p>
<p style="position:absolute;top:455px;left:459px;white-space:nowrap" class="ft3536"><b>Description</b></p>
<p style="position:absolute;top:481px;left:297px;white-space:nowrap" class="ft3532">REL</p>
<p style="position:absolute;top:475px;left:459px;white-space:nowrap" class="ft3535">supported input&#160;REL language</p>
<p style="position:absolute;top:520px;left:85px;white-space:nowrap" class="ft3532">6.2.5.4</p>
<p style="position:absolute;top:520px;left:171px;white-space:nowrap" class="ft3532">getSupportTargetLanguages()</p>
<p style="position:absolute;top:534px;left:86px;white-space:nowrap" class="ft3535">Function:</p>
<p style="position:absolute;top:535px;left:246px;white-space:nowrap" class="ft3535">Query&#160;for&#160;all&#160;supported&#160;output&#160;REL languages</p>
<p style="position:absolute;top:574px;left:85px;white-space:nowrap" class="ft3535">Parameter:</p>
<p style="position:absolute;top:575px;left:299px;white-space:nowrap" class="ft3535">none</p>
<p style="position:absolute;top:614px;left:85px;white-space:nowrap" class="ft3535">Return&#160;value:</p>
<p style="position:absolute;top:635px;left:296px;white-space:nowrap" class="ft3536"><b>Type</b></p>
<p style="position:absolute;top:635px;left:459px;white-space:nowrap" class="ft3536"><b>Description</b></p>
<p style="position:absolute;top:661px;left:297px;white-space:nowrap" class="ft3532">REL</p>
<p style="position:absolute;top:655px;left:459px;white-space:nowrap" class="ft3535">supported output&#160;REL&#160;language</p>
<p style="position:absolute;top:694px;left:85px;white-space:nowrap" class="ft3520"><i><b>6.2.6&#160;class&#160;LicenseTranslationManager</b></i></p>
<p style="position:absolute;top:744px;left:85px;white-space:nowrap" class="ft3538">This&#160;is&#160;a&#160;manager&#160;class&#160;to&#160;handle&#160;translation&#160;of&#160;licenses&#160;to&#160;different&#160;REL&#160;languages,&#160;under&#160;given&#160;<br/>constrains.</p>
<p style="position:absolute;top:807px;left:85px;white-space:nowrap" class="ft3532">6.2.6.1</p>
<p style="position:absolute;top:807px;left:171px;white-space:nowrap" class="ft3532">translateLicense()</p>
<p style="position:absolute;top:822px;left:85px;white-space:nowrap" class="ft3535">Function:</p>
<p style="position:absolute;top:823px;left:245px;white-space:nowrap" class="ft3535">Translate license&#160;to another supported&#160;REL&#160;language</p>
<p style="position:absolute;top:862px;left:85px;white-space:nowrap" class="ft3535">Parameter:</p>
<p style="position:absolute;top:883px;left:85px;white-space:nowrap" class="ft3536"><b>Name</b></p>
<p style="position:absolute;top:883px;left:296px;white-space:nowrap" class="ft3536"><b>Type</b></p>
<p style="position:absolute;top:883px;left:459px;white-space:nowrap" class="ft3536"><b>Description</b></p>
<p style="position:absolute;top:909px;left:83px;white-space:nowrap" class="ft3532">sourceLicense</p>
<p style="position:absolute;top:909px;left:297px;white-space:nowrap" class="ft3532">License</p>
<p style="position:absolute;top:903px;left:459px;white-space:nowrap" class="ft3535">Input&#160;license object&#160;to&#160;be translated</p>
<p style="position:absolute;top:930px;left:83px;white-space:nowrap" class="ft3532">targetLicenseLang</p>
<p style="position:absolute;top:930px;left:297px;white-space:nowrap" class="ft3532">REL</p>
<p style="position:absolute;top:924px;left:459px;white-space:nowrap" class="ft3535">REL language to translate to</p>
<p style="position:absolute;top:952px;left:83px;white-space:nowrap" class="ft3532">targetRestrictions</p>
<p style="position:absolute;top:952px;left:297px;white-space:nowrap" class="ft3532">string</p>
<p style="position:absolute;top:945px;left:459px;white-space:nowrap" class="ft3535">XML&#160;string&#160;of output license</p>
<p style="position:absolute;top:986px;left:85px;white-space:nowrap" class="ft3535">Return&#160;value:</p>
<p style="position:absolute;top:1007px;left:296px;white-space:nowrap" class="ft3536"><b>Type</b></p>
<p style="position:absolute;top:1007px;left:459px;white-space:nowrap" class="ft3536"><b>Description</b></p>
<p style="position:absolute;top:1033px;left:297px;white-space:nowrap" class="ft3532">License</p>
<p style="position:absolute;top:1027px;left:459px;white-space:nowrap" class="ft3535">License&#160;object&#160;after translation</p>
<p style="position:absolute;top:1071px;left:85px;white-space:nowrap" class="ft3532">6.2.6.2</p>
<p style="position:absolute;top:1071px;left:171px;white-space:nowrap" class="ft3532">getSupportSourceLanguages()</p>
<p style="position:absolute;top:1086px;left:85px;white-space:nowrap" class="ft3535">Function:</p>
<p style="position:absolute;top:1087px;left:245px;white-space:nowrap" class="ft3535">Query for all&#160;supported REL languages</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft3516">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft3516">30/39</p>
</div>
<!-- Page 36 -->
<a name="36"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page36-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables036.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3615">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft360">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft3616">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft3616">FINAL |&#160;1.10</p>
<p style="position:absolute;top:150px;left:85px;white-space:nowrap" class="ft3635">Parameter:</p>
<p style="position:absolute;top:151px;left:298px;white-space:nowrap" class="ft3635">none</p>
<p style="position:absolute;top:190px;left:85px;white-space:nowrap" class="ft3635">Return&#160;value:</p>
<p style="position:absolute;top:211px;left:296px;white-space:nowrap" class="ft3636"><b>Type</b></p>
<p style="position:absolute;top:211px;left:459px;white-space:nowrap" class="ft3636"><b>Description</b></p>
<p style="position:absolute;top:237px;left:297px;white-space:nowrap" class="ft3632">list&lt;REL&gt;</p>
<p style="position:absolute;top:231px;left:459px;white-space:nowrap" class="ft3635">List of all&#160;supported source REL languages</p>
<p style="position:absolute;top:270px;left:85px;white-space:nowrap" class="ft3620"><i><b>6.2.7&#160;class&#160;StateManager</b></i></p>
<p style="position:absolute;top:320px;left:85px;white-space:nowrap" class="ft3635">This&#160;is a manager class&#160;to&#160;handle user&#160;states(limits&#160;for&#160;operations)&#160;for each&#160;digital items.</p>
<p style="position:absolute;top:364px;left:85px;white-space:nowrap" class="ft3632">6.2.7.1</p>
<p style="position:absolute;top:364px;left:171px;white-space:nowrap" class="ft3632">checkLimit()</p>
<p style="position:absolute;top:378px;left:86px;white-space:nowrap" class="ft3635">Function:</p>
<p style="position:absolute;top:379px;left:245px;white-space:nowrap" class="ft3635">Retrieve limit&#160;for a particular&#160;operation&#160;on&#160;a&#160;particular digital item</p>
<p style="position:absolute;top:418px;left:85px;white-space:nowrap" class="ft3635">Parameter:</p>
<p style="position:absolute;top:439px;left:85px;white-space:nowrap" class="ft3636"><b>Name</b></p>
<p style="position:absolute;top:439px;left:296px;white-space:nowrap" class="ft3636"><b>Type</b></p>
<p style="position:absolute;top:439px;left:459px;white-space:nowrap" class="ft3636"><b>Description</b></p>
<p style="position:absolute;top:465px;left:83px;white-space:nowrap" class="ft3632">item</p>
<p style="position:absolute;top:465px;left:297px;white-space:nowrap" class="ft3632">ItemReference</p>
<p style="position:absolute;top:459px;left:459px;white-space:nowrap" class="ft3635">Reference&#160;to&#160;digital&#160;item</p>
<p style="position:absolute;top:486px;left:83px;white-space:nowrap" class="ft3632">operation</p>
<p style="position:absolute;top:486px;left:297px;white-space:nowrap" class="ft3632">string</p>
<p style="position:absolute;top:480px;left:459px;white-space:nowrap" class="ft3635">Operation taken on&#160;Digital&#160;Item</p>
<p style="position:absolute;top:521px;left:85px;white-space:nowrap" class="ft3635">Return&#160;value:</p>
<p style="position:absolute;top:542px;left:296px;white-space:nowrap" class="ft3636"><b>Type</b></p>
<p style="position:absolute;top:542px;left:459px;white-space:nowrap" class="ft3636"><b>Description</b></p>
<p style="position:absolute;top:568px;left:297px;white-space:nowrap" class="ft3632">int</p>
<p style="position:absolute;top:561px;left:459px;white-space:nowrap" class="ft3635">limit&#160;for&#160;operation</p>
<p style="position:absolute;top:626px;left:85px;white-space:nowrap" class="ft3632">6.2.7.2</p>
<p style="position:absolute;top:626px;left:171px;white-space:nowrap" class="ft3632">decrementLimit()</p>
<p style="position:absolute;top:641px;left:85px;white-space:nowrap" class="ft3635">Function:</p>
<p style="position:absolute;top:641px;left:245px;white-space:nowrap" class="ft3635">Decrease limit&#160;for a particular&#160;operation&#160;on&#160;a&#160;particular digital item</p>
<p style="position:absolute;top:681px;left:85px;white-space:nowrap" class="ft3635">Parameter:</p>
<p style="position:absolute;top:701px;left:85px;white-space:nowrap" class="ft3636"><b>Name</b></p>
<p style="position:absolute;top:701px;left:296px;white-space:nowrap" class="ft3636"><b>Type</b></p>
<p style="position:absolute;top:701px;left:459px;white-space:nowrap" class="ft3636"><b>Description</b></p>
<p style="position:absolute;top:727px;left:83px;white-space:nowrap" class="ft3632">item</p>
<p style="position:absolute;top:727px;left:297px;white-space:nowrap" class="ft3632">ItemReference</p>
<p style="position:absolute;top:721px;left:459px;white-space:nowrap" class="ft3635">Reference&#160;to&#160;digital&#160;item</p>
<p style="position:absolute;top:749px;left:83px;white-space:nowrap" class="ft3632">operation</p>
<p style="position:absolute;top:749px;left:297px;white-space:nowrap" class="ft3632">string</p>
<p style="position:absolute;top:743px;left:459px;white-space:nowrap" class="ft3635">Operation taken on&#160;Digital&#160;Item</p>
<p style="position:absolute;top:783px;left:85px;white-space:nowrap" class="ft3635">Return&#160;value:</p>
<p style="position:absolute;top:804px;left:296px;white-space:nowrap" class="ft3636"><b>Type</b></p>
<p style="position:absolute;top:804px;left:459px;white-space:nowrap" class="ft3636"><b>Description</b></p>
<p style="position:absolute;top:830px;left:297px;white-space:nowrap" class="ft3632">int</p>
<p style="position:absolute;top:824px;left:459px;white-space:nowrap" class="ft3635">new limit&#160;after&#160;decrement</p>
<p style="position:absolute;top:869px;left:85px;white-space:nowrap" class="ft3632">6.2.7.3</p>
<p style="position:absolute;top:869px;left:171px;white-space:nowrap" class="ft3632">getSystemState()</p>
<p style="position:absolute;top:884px;left:87px;white-space:nowrap" class="ft3635">Function:</p>
<p style="position:absolute;top:884px;left:298px;white-space:nowrap" class="ft3635">Get a&#160;particular&#160;system state</p>
<p style="position:absolute;top:923px;left:85px;white-space:nowrap" class="ft3635">Parameter:</p>
<p style="position:absolute;top:944px;left:85px;white-space:nowrap" class="ft3636"><b>Name</b></p>
<p style="position:absolute;top:944px;left:296px;white-space:nowrap" class="ft3636"><b>Type</b></p>
<p style="position:absolute;top:944px;left:459px;white-space:nowrap" class="ft3636"><b>Description</b></p>
<p style="position:absolute;top:970px;left:83px;white-space:nowrap" class="ft3632">state</p>
<p style="position:absolute;top:970px;left:297px;white-space:nowrap" class="ft3632">string</p>
<p style="position:absolute;top:964px;left:459px;white-space:nowrap" class="ft3635">String ID of state to retrieve</p>
<p style="position:absolute;top:1005px;left:85px;white-space:nowrap" class="ft3635">Return&#160;value:</p>
<p style="position:absolute;top:1025px;left:296px;white-space:nowrap" class="ft3636"><b>Type</b></p>
<p style="position:absolute;top:1025px;left:459px;white-space:nowrap" class="ft3636"><b>Description</b></p>
<p style="position:absolute;top:1051px;left:297px;white-space:nowrap" class="ft3632">string</p>
<p style="position:absolute;top:1045px;left:459px;white-space:nowrap" class="ft3635">value&#160;of state</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft3616">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft3616">31/39</p>
</div>
<!-- Page 37 -->
<a name="37"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page37-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables037.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3715">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft370">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft3716">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft3716">FINAL |&#160;1.10</p>
<p style="position:absolute;top:169px;left:85px;white-space:nowrap" class="ft373"><b>6.3&#160;Helper&#160;Classes</b></p>
<p style="position:absolute;top:197px;left:85px;white-space:nowrap" class="ft374">This section defines commonly&#160;used helper classes.</p>
<p style="position:absolute;top:244px;left:85px;white-space:nowrap" class="ft3720"><i><b>6.3.1&#160;class&#160;ItemReference</b></i></p>
<p style="position:absolute;top:273px;left:85px;white-space:nowrap" class="ft374">Class&#160;to encapsulate the reference to&#160;a particular&#160;digital item. Contains&#160;the fields:</p>
<p style="position:absolute;top:303px;left:111px;white-space:nowrap" class="ft3712">●</p>
<p style="position:absolute;top:305px;left:138px;white-space:nowrap" class="ft3732">int DI</p>
<p style="position:absolute;top:322px;left:111px;white-space:nowrap" class="ft3712">●</p>
<p style="position:absolute;top:324px;left:138px;white-space:nowrap" class="ft3732">string URL</p>
<p style="position:absolute;top:357px;left:85px;white-space:nowrap" class="ft3720"><i><b>6.3.2&#160;class&#160;ItemState</b></i></p>
<p style="position:absolute;top:387px;left:85px;white-space:nowrap" class="ft374">Class&#160;to encapsulate a&#160;single state object</p>
<p style="position:absolute;top:417px;left:111px;white-space:nowrap" class="ft3712">●</p>
<p style="position:absolute;top:419px;left:138px;white-space:nowrap" class="ft3732">int item_ID</p>
<p style="position:absolute;top:435px;left:111px;white-space:nowrap" class="ft3712">●</p>
<p style="position:absolute;top:437px;left:138px;white-space:nowrap" class="ft3732">string state</p>
<p style="position:absolute;top:471px;left:85px;white-space:nowrap" class="ft3720"><i><b>6.3.3&#160;class&#160;Key</b></i></p>
<p style="position:absolute;top:501px;left:85px;white-space:nowrap" class="ft374">Class&#160;to represent a content&#160;key of generic type</p>
<p style="position:absolute;top:532px;left:85px;white-space:nowrap" class="ft3732">6.3.3.1</p>
<p style="position:absolute;top:532px;left:171px;white-space:nowrap" class="ft3732">Key()</p>
<p style="position:absolute;top:547px;left:87px;white-space:nowrap" class="ft3735">Function:</p>
<p style="position:absolute;top:548px;left:298px;white-space:nowrap" class="ft3735">Construct&#160;the key object&#160;of&#160;a particular type and length</p>
<p style="position:absolute;top:587px;left:85px;white-space:nowrap" class="ft3735">Parameter:</p>
<p style="position:absolute;top:607px;left:85px;white-space:nowrap" class="ft3736"><b>Name</b></p>
<p style="position:absolute;top:607px;left:296px;white-space:nowrap" class="ft3736"><b>Type</b></p>
<p style="position:absolute;top:607px;left:459px;white-space:nowrap" class="ft3736"><b>Description</b></p>
<p style="position:absolute;top:633px;left:83px;white-space:nowrap" class="ft3732">keyLength</p>
<p style="position:absolute;top:633px;left:297px;white-space:nowrap" class="ft3732">int</p>
<p style="position:absolute;top:627px;left:459px;white-space:nowrap" class="ft3735">Length&#160;of key in&#160;bytes</p>
<p style="position:absolute;top:655px;left:83px;white-space:nowrap" class="ft3732">keyType</p>
<p style="position:absolute;top:655px;left:297px;white-space:nowrap" class="ft3732">int</p>
<p style="position:absolute;top:649px;left:459px;white-space:nowrap" class="ft3739">integer&#160;key&#160;type based on&#160;the KeyType&#160;<br/>enumeration&#160;definition.&#160;<a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#37">(See&#160;6.3.3)</a></p>
<p style="position:absolute;top:696px;left:83px;white-space:nowrap" class="ft3732">key</p>
<p style="position:absolute;top:696px;left:297px;white-space:nowrap" class="ft3732">char*</p>
<p style="position:absolute;top:690px;left:459px;white-space:nowrap" class="ft3735">binary&#160;data to store in&#160;Key&#160;object</p>
<p style="position:absolute;top:735px;left:85px;white-space:nowrap" class="ft3732">6.3.3.2</p>
<p style="position:absolute;top:735px;left:171px;white-space:nowrap" class="ft3732">getKey()</p>
<p style="position:absolute;top:750px;left:87px;white-space:nowrap" class="ft3735">Function:</p>
<p style="position:absolute;top:750px;left:298px;white-space:nowrap" class="ft3735">Retrieve&#160;binary&#160;data of the&#160;key</p>
<p style="position:absolute;top:789px;left:85px;white-space:nowrap" class="ft3735">Parameter:</p>
<p style="position:absolute;top:790px;left:255px;white-space:nowrap" class="ft3735">none</p>
<p style="position:absolute;top:829px;left:85px;white-space:nowrap" class="ft3735">Return&#160;value:</p>
<p style="position:absolute;top:850px;left:296px;white-space:nowrap" class="ft3736"><b>Type</b></p>
<p style="position:absolute;top:850px;left:459px;white-space:nowrap" class="ft3736"><b>Description</b></p>
<p style="position:absolute;top:876px;left:297px;white-space:nowrap" class="ft3732">char*</p>
<p style="position:absolute;top:870px;left:459px;white-space:nowrap" class="ft3735">binary&#160;data of Key</p>
<p style="position:absolute;top:915px;left:85px;white-space:nowrap" class="ft3732">6.3.3.3</p>
<p style="position:absolute;top:915px;left:171px;white-space:nowrap" class="ft3732">getKeyType()</p>
<p style="position:absolute;top:929px;left:87px;white-space:nowrap" class="ft3735">Function:</p>
<p style="position:absolute;top:930px;left:298px;white-space:nowrap" class="ft3735">Retrieve&#160;the key type</p>
<p style="position:absolute;top:969px;left:85px;white-space:nowrap" class="ft3735">Parameter:</p>
<p style="position:absolute;top:969px;left:255px;white-space:nowrap" class="ft3735">none</p>
<p style="position:absolute;top:1009px;left:85px;white-space:nowrap" class="ft3735">Return&#160;value:</p>
<p style="position:absolute;top:1030px;left:296px;white-space:nowrap" class="ft3736"><b>Type</b></p>
<p style="position:absolute;top:1030px;left:459px;white-space:nowrap" class="ft3736"><b>Description</b></p>
<p style="position:absolute;top:1056px;left:297px;white-space:nowrap" class="ft3732">int</p>
<p style="position:absolute;top:1050px;left:459px;white-space:nowrap" class="ft3739">integer&#160;representing&#160;key&#160;type based on&#160;the&#160;<br/>KeyType enumeration&#160;definition.&#160;(See&#160;6.4.3.4)</p>
<p style="position:absolute;top:1113px;left:85px;white-space:nowrap" class="ft3732">6.3.3.4</p>
<p style="position:absolute;top:1113px;left:171px;white-space:nowrap" class="ft3732">KeyType enumeration</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft3716">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft3716">32/39</p>
</div>
<!-- Page 38 -->
<a name="38"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page38-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables038.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3815">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft380">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft3816">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft3816">FINAL |&#160;1.10</p>
<p style="position:absolute;top:151px;left:296px;white-space:nowrap" class="ft3836"><b>Name</b></p>
<p style="position:absolute;top:151px;left:459px;white-space:nowrap" class="ft3836"><b>Description</b></p>
<p style="position:absolute;top:177px;left:297px;white-space:nowrap" class="ft3832">KEY_DES64</p>
<p style="position:absolute;top:171px;left:459px;white-space:nowrap" class="ft3835">DES&#160;64-bit key</p>
<p style="position:absolute;top:199px;left:297px;white-space:nowrap" class="ft3832">KEY_AES128&#160;</p>
<p style="position:absolute;top:192px;left:459px;white-space:nowrap" class="ft3835">AES&#160;128-bit&#160;key</p>
<p style="position:absolute;top:220px;left:297px;white-space:nowrap" class="ft3832">KEY_AES256&#160;</p>
<p style="position:absolute;top:214px;left:459px;white-space:nowrap" class="ft3835">AES&#160;256-bit&#160;key</p>
<p style="position:absolute;top:259px;left:85px;white-space:nowrap" class="ft3832">6.3.3.5</p>
<p style="position:absolute;top:259px;left:171px;white-space:nowrap" class="ft3832">getLength()</p>
<p style="position:absolute;top:273px;left:87px;white-space:nowrap" class="ft3835">Function:</p>
<p style="position:absolute;top:274px;left:298px;white-space:nowrap" class="ft3835">Retrieve&#160;the key length</p>
<p style="position:absolute;top:313px;left:85px;white-space:nowrap" class="ft3835">Parameter:</p>
<p style="position:absolute;top:313px;left:255px;white-space:nowrap" class="ft3835">none</p>
<p style="position:absolute;top:353px;left:85px;white-space:nowrap" class="ft3835">Return&#160;value:</p>
<p style="position:absolute;top:374px;left:296px;white-space:nowrap" class="ft3836"><b>Type</b></p>
<p style="position:absolute;top:374px;left:459px;white-space:nowrap" class="ft3836"><b>Description</b></p>
<p style="position:absolute;top:400px;left:297px;white-space:nowrap" class="ft3832">int</p>
<p style="position:absolute;top:394px;left:459px;white-space:nowrap" class="ft3835">length&#160;of&#160;key&#160;(in&#160;bytes)</p>
<p style="position:absolute;top:433px;left:85px;white-space:nowrap" class="ft3820"><i><b>6.3.4&#160;class&#160;License</b></i></p>
<p style="position:absolute;top:463px;left:85px;white-space:nowrap" class="ft3835">Class&#160;to&#160;represent licenses&#160;of generic type</p>
<p style="position:absolute;top:506px;left:85px;white-space:nowrap" class="ft3832">6.3.4.1</p>
<p style="position:absolute;top:506px;left:171px;white-space:nowrap" class="ft3832">License()</p>
<p style="position:absolute;top:521px;left:87px;white-space:nowrap" class="ft3835">Function:</p>
<p style="position:absolute;top:522px;left:298px;white-space:nowrap" class="ft3835">Construct&#160;the license&#160;object</p>
<p style="position:absolute;top:561px;left:85px;white-space:nowrap" class="ft3835">Parameter:</p>
<p style="position:absolute;top:582px;left:85px;white-space:nowrap" class="ft3836"><b>Name</b></p>
<p style="position:absolute;top:582px;left:296px;white-space:nowrap" class="ft3836"><b>Type</b></p>
<p style="position:absolute;top:582px;left:459px;white-space:nowrap" class="ft3836"><b>Description</b></p>
<p style="position:absolute;top:608px;left:83px;white-space:nowrap" class="ft3832">rel</p>
<p style="position:absolute;top:608px;left:297px;white-space:nowrap" class="ft3832">REL</p>
<p style="position:absolute;top:602px;left:459px;white-space:nowrap" class="ft3835">REL language of license</p>
<p style="position:absolute;top:629px;left:83px;white-space:nowrap" class="ft3832">text</p>
<p style="position:absolute;top:629px;left:297px;white-space:nowrap" class="ft3832">string</p>
<p style="position:absolute;top:623px;left:459px;white-space:nowrap" class="ft3835">XML&#160;string&#160;of license</p>
<p style="position:absolute;top:668px;left:85px;white-space:nowrap" class="ft3832">6.3.4.2</p>
<p style="position:absolute;top:668px;left:171px;white-space:nowrap" class="ft3832">isRELType()</p>
<p style="position:absolute;top:683px;left:87px;white-space:nowrap" class="ft3835">Function:</p>
<p style="position:absolute;top:683px;left:298px;white-space:nowrap" class="ft3835">Check if&#160;license is&#160;of a particular&#160;type</p>
<p style="position:absolute;top:722px;left:85px;white-space:nowrap" class="ft3835">Parameter:</p>
<p style="position:absolute;top:743px;left:85px;white-space:nowrap" class="ft3836"><b>Name</b></p>
<p style="position:absolute;top:743px;left:296px;white-space:nowrap" class="ft3836"><b>Type</b></p>
<p style="position:absolute;top:743px;left:459px;white-space:nowrap" class="ft3836"><b>Description</b></p>
<p style="position:absolute;top:769px;left:83px;white-space:nowrap" class="ft3832">type</p>
<p style="position:absolute;top:769px;left:297px;white-space:nowrap" class="ft3832">string</p>
<p style="position:absolute;top:763px;left:459px;white-space:nowrap" class="ft3835">Name&#160;of&#160;REL language to check with</p>
<p style="position:absolute;top:804px;left:85px;white-space:nowrap" class="ft3835">Return&#160;value:</p>
<p style="position:absolute;top:824px;left:296px;white-space:nowrap" class="ft3836"><b>Type</b></p>
<p style="position:absolute;top:824px;left:459px;white-space:nowrap" class="ft3836"><b>Description</b></p>
<p style="position:absolute;top:850px;left:297px;white-space:nowrap" class="ft3832">string</p>
<p style="position:absolute;top:844px;left:459px;white-space:nowrap" class="ft3835">pointer&#160;to&#160;tool&#160;function</p>
<p style="position:absolute;top:889px;left:85px;white-space:nowrap" class="ft3832">6.3.4.3</p>
<p style="position:absolute;top:889px;left:171px;white-space:nowrap" class="ft3832">getString()</p>
<p style="position:absolute;top:904px;left:87px;white-space:nowrap" class="ft3835">Function:</p>
<p style="position:absolute;top:904px;left:298px;white-space:nowrap" class="ft3835">Retrieve&#160;string&#160;representation of&#160;license</p>
<p style="position:absolute;top:944px;left:85px;white-space:nowrap" class="ft3835">Parameter:</p>
<p style="position:absolute;top:944px;left:255px;white-space:nowrap" class="ft3835">none</p>
<p style="position:absolute;top:983px;left:85px;white-space:nowrap" class="ft3835">Return&#160;value:</p>
<p style="position:absolute;top:1004px;left:296px;white-space:nowrap" class="ft3836"><b>Type</b></p>
<p style="position:absolute;top:1004px;left:459px;white-space:nowrap" class="ft3836"><b>Description</b></p>
<p style="position:absolute;top:1030px;left:297px;white-space:nowrap" class="ft3832">string</p>
<p style="position:absolute;top:1024px;left:459px;white-space:nowrap" class="ft3835">string&#160;representation&#160;of&#160;license</p>
<p style="position:absolute;top:1063px;left:85px;white-space:nowrap" class="ft3820"><i><b>6.3.5&#160;class&#160;PlayerState</b></i></p>
<p style="position:absolute;top:1093px;left:85px;white-space:nowrap" class="ft3835">Class&#160;to&#160;store&#160;data related&#160;to&#160;player initialized&#160;and authenticated by the&#160;DRM&#160;Core</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft3816">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft3816">33/39</p>
</div>
<!-- Page 39 -->
<a name="39"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page39-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables039.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3915">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft390">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft3916">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft3916">FINAL |&#160;1.10</p>
<p style="position:absolute;top:154px;left:85px;white-space:nowrap" class="ft3932">6.3.5.1</p>
<p style="position:absolute;top:154px;left:171px;white-space:nowrap" class="ft3932">PlayerState()</p>
<p style="position:absolute;top:169px;left:87px;white-space:nowrap" class="ft3935">Function:</p>
<p style="position:absolute;top:170px;left:298px;white-space:nowrap" class="ft3935">Construct&#160;the object</p>
<p style="position:absolute;top:209px;left:85px;white-space:nowrap" class="ft3935">Parameter:</p>
<p style="position:absolute;top:230px;left:85px;white-space:nowrap" class="ft3936"><b>Name</b></p>
<p style="position:absolute;top:230px;left:296px;white-space:nowrap" class="ft3936"><b>Type</b></p>
<p style="position:absolute;top:230px;left:459px;white-space:nowrap" class="ft3936"><b>Description</b></p>
<p style="position:absolute;top:256px;left:83px;white-space:nowrap" class="ft3932">id</p>
<p style="position:absolute;top:256px;left:297px;white-space:nowrap" class="ft3932">int</p>
<p style="position:absolute;top:250px;left:459px;white-space:nowrap" class="ft3939">integer&#160;identifier representing&#160;the&#160;particular&#160;<br/>player from&#160;</p>
<p style="position:absolute;top:277px;left:548px;white-space:nowrap" class="ft3932">playerInit()</p>
<p style="position:absolute;top:316px;left:85px;white-space:nowrap" class="ft3932">6.3.5.2</p>
<p style="position:absolute;top:316px;left:171px;white-space:nowrap" class="ft3932">getPlayerID()</p>
<p style="position:absolute;top:330px;left:87px;white-space:nowrap" class="ft3935">Function:</p>
<p style="position:absolute;top:331px;left:298px;white-space:nowrap" class="ft3935">Retrieve&#160;the player&#160;ID&#160;issued to the&#160;player</p>
<p style="position:absolute;top:370px;left:85px;white-space:nowrap" class="ft3935">Parameter:</p>
<p style="position:absolute;top:370px;left:255px;white-space:nowrap" class="ft3935">none</p>
<p style="position:absolute;top:410px;left:85px;white-space:nowrap" class="ft3935">Return&#160;value:</p>
<p style="position:absolute;top:431px;left:296px;white-space:nowrap" class="ft3936"><b>Type</b></p>
<p style="position:absolute;top:431px;left:459px;white-space:nowrap" class="ft3936"><b>Description</b></p>
<p style="position:absolute;top:457px;left:297px;white-space:nowrap" class="ft3932">int</p>
<p style="position:absolute;top:451px;left:459px;white-space:nowrap" class="ft3939">integer&#160;identifier representing&#160;the&#160;particular&#160;<br/>player from&#160;</p>
<p style="position:absolute;top:478px;left:548px;white-space:nowrap" class="ft3932">playerInit()</p>
<p style="position:absolute;top:517px;left:85px;white-space:nowrap" class="ft3932">6.3.5.3</p>
<p style="position:absolute;top:517px;left:171px;white-space:nowrap" class="ft3932">getPlayerState()</p>
<p style="position:absolute;top:532px;left:87px;white-space:nowrap" class="ft3935">Function:</p>
<p style="position:absolute;top:532px;left:298px;white-space:nowrap" class="ft3935">Retrieve&#160;a&#160;particular player&#160;state</p>
<p style="position:absolute;top:572px;left:85px;white-space:nowrap" class="ft3935">Parameter:</p>
<p style="position:absolute;top:592px;left:85px;white-space:nowrap" class="ft3936"><b>Name</b></p>
<p style="position:absolute;top:592px;left:296px;white-space:nowrap" class="ft3936"><b>Type</b></p>
<p style="position:absolute;top:592px;left:459px;white-space:nowrap" class="ft3936"><b>Description</b></p>
<p style="position:absolute;top:618px;left:83px;white-space:nowrap" class="ft3932">state</p>
<p style="position:absolute;top:618px;left:297px;white-space:nowrap" class="ft3932">string</p>
<p style="position:absolute;top:612px;left:459px;white-space:nowrap" class="ft3935">player state to retrieve</p>
<p style="position:absolute;top:653px;left:85px;white-space:nowrap" class="ft3935">Return&#160;value:</p>
<p style="position:absolute;top:674px;left:296px;white-space:nowrap" class="ft3936"><b>Type</b></p>
<p style="position:absolute;top:674px;left:459px;white-space:nowrap" class="ft3936"><b>Description</b></p>
<p style="position:absolute;top:700px;left:297px;white-space:nowrap" class="ft3932">string</p>
<p style="position:absolute;top:693px;left:459px;white-space:nowrap" class="ft3935">value&#160;of player&#160;state</p>
<p style="position:absolute;top:738px;left:85px;white-space:nowrap" class="ft3932">6.3.5.4</p>
<p style="position:absolute;top:738px;left:171px;white-space:nowrap" class="ft3932">setPlayerState()</p>
<p style="position:absolute;top:753px;left:87px;white-space:nowrap" class="ft3935">Function:</p>
<p style="position:absolute;top:753px;left:298px;white-space:nowrap" class="ft3935">Set a particular&#160;player state</p>
<p style="position:absolute;top:793px;left:85px;white-space:nowrap" class="ft3935">Parameter:</p>
<p style="position:absolute;top:813px;left:85px;white-space:nowrap" class="ft3936"><b>Name</b></p>
<p style="position:absolute;top:813px;left:296px;white-space:nowrap" class="ft3936"><b>Type</b></p>
<p style="position:absolute;top:813px;left:459px;white-space:nowrap" class="ft3936"><b>Description</b></p>
<p style="position:absolute;top:839px;left:83px;white-space:nowrap" class="ft3932">state</p>
<p style="position:absolute;top:839px;left:297px;white-space:nowrap" class="ft3932">string</p>
<p style="position:absolute;top:833px;left:459px;white-space:nowrap" class="ft3935">player state to modify</p>
<p style="position:absolute;top:861px;left:83px;white-space:nowrap" class="ft3932">value</p>
<p style="position:absolute;top:861px;left:297px;white-space:nowrap" class="ft3932">string</p>
<p style="position:absolute;top:855px;left:459px;white-space:nowrap" class="ft3935">value&#160;of player&#160;state</p>
<p style="position:absolute;top:896px;left:85px;white-space:nowrap" class="ft3935">Return&#160;value:</p>
<p style="position:absolute;top:902px;left:425px;white-space:nowrap" class="ft3937"><i>none</i></p>
<p style="position:absolute;top:936px;left:85px;white-space:nowrap" class="ft3920"><i><b>6.3.6&#160;class&#160;REL</b></i></p>
<p style="position:absolute;top:966px;left:85px;white-space:nowrap" class="ft3935">Class&#160;to&#160;represent a&#160;particular REL language type.</p>
<p style="position:absolute;top:1009px;left:85px;white-space:nowrap" class="ft3932">6.3.6.1</p>
<p style="position:absolute;top:1009px;left:171px;white-space:nowrap" class="ft3932">REL()</p>
<p style="position:absolute;top:1024px;left:87px;white-space:nowrap" class="ft3935">Function:</p>
<p style="position:absolute;top:1024px;left:298px;white-space:nowrap" class="ft3935">Constructor using&#160;a&#160;string&#160;descriptor</p>
<p style="position:absolute;top:1064px;left:85px;white-space:nowrap" class="ft3935">Parameter:</p>
<p style="position:absolute;top:1084px;left:85px;white-space:nowrap" class="ft3936"><b>Name</b></p>
<p style="position:absolute;top:1084px;left:296px;white-space:nowrap" class="ft3936"><b>Type</b></p>
<p style="position:absolute;top:1084px;left:459px;white-space:nowrap" class="ft3936"><b>Description</b></p>
<p style="position:absolute;top:1110px;left:83px;white-space:nowrap" class="ft3932">language</p>
<p style="position:absolute;top:1110px;left:297px;white-space:nowrap" class="ft3932">string</p>
<p style="position:absolute;top:1104px;left:459px;white-space:nowrap" class="ft3935">Name&#160;of&#160;REL language</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft3916">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft3916">34/39</p>
</div>
<!-- Page 40 -->
<a name="40"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page40-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables040.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft4015">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft400">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft4016">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft4016">FINAL |&#160;1.10</p>
<p style="position:absolute;top:174px;left:85px;white-space:nowrap" class="ft4032">6.3.6.2</p>
<p style="position:absolute;top:174px;left:171px;white-space:nowrap" class="ft4032">getName()</p>
<p style="position:absolute;top:189px;left:87px;white-space:nowrap" class="ft4035">Function:</p>
<p style="position:absolute;top:190px;left:298px;white-space:nowrap" class="ft4035">&#160;Retrieve string name&#160;of REL&#160;language</p>
<p style="position:absolute;top:229px;left:85px;white-space:nowrap" class="ft4035">Parameter:</p>
<p style="position:absolute;top:229px;left:255px;white-space:nowrap" class="ft4035">none</p>
<p style="position:absolute;top:269px;left:85px;white-space:nowrap" class="ft4035">Return&#160;value:</p>
<p style="position:absolute;top:290px;left:296px;white-space:nowrap" class="ft4036"><b>Type</b></p>
<p style="position:absolute;top:290px;left:459px;white-space:nowrap" class="ft4036"><b>Description</b></p>
<p style="position:absolute;top:316px;left:297px;white-space:nowrap" class="ft4032">string</p>
<p style="position:absolute;top:309px;left:459px;white-space:nowrap" class="ft4035">Name&#160;of&#160;REL language</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft4016">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft4016">35/39</p>
</div>
<!-- Page 41 -->
<a name="41"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4140{font-size:12px;font-family:Courier;color:#000000;}
	.ft4141{font-size:12px;line-height:13px;font-family:Courier;color:#000000;}
-->
</style>
<div id="page41-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables041.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft4115">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft410">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft4116">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft4116">FINAL |&#160;1.10</p>
<p style="position:absolute;top:169px;left:85px;white-space:nowrap" class="ft4110"><b>7.&#160;Annex A : C++ Header&#160;definition</b></p>
<p style="position:absolute;top:219px;left:85px;white-space:nowrap" class="ft4140">class PlayerInterface {</p>
<p style="position:absolute;top:246px;left:85px;white-space:nowrap" class="ft4140">public:</p>
<p style="position:absolute;top:259px;left:170px;white-space:nowrap" class="ft4141">virtual int &#160; playerInit(const std::string&amp; playerCapabilities) = 0;<br/>virtual void getDecryptionKey(int playerID, const ItemReference&amp; item,&#160;<br/>const std::string&amp; operation, std::string&amp; playbackRestriction,Key&amp; key) = 0;<br/>virtual const std::list&lt;REL&gt; getSupportedREL() = 0;</p>
<p style="position:absolute;top:314px;left:85px;white-space:nowrap" class="ft4140">};</p>
<p style="position:absolute;top:341px;left:85px;white-space:nowrap" class="ft4140">class ManagementInterface {</p>
<p style="position:absolute;top:354px;left:170px;white-space:nowrap" class="ft4141">virtual void &#160;insertLicense(const std::string&amp; license, const REL&amp; relType,&#160;<br/>const ItemReference&amp; item) = 0;<br/>virtual void getAttestationKey(int playerID, const REL&amp; relType,&#160;<br/>const std::string&amp; serverURL, Key&amp; key) = 0;//TODO - change Key&amp;</p>
<p style="position:absolute;top:409px;left:85px;white-space:nowrap" class="ft4140">};</p>
<p style="position:absolute;top:436px;left:85px;white-space:nowrap" class="ft4140">class Utility {</p>
<p style="position:absolute;top:449px;left:170px;white-space:nowrap" class="ft4141">public:<br/>void* getTool(std::string toolDescription);</p>
<p style="position:absolute;top:477px;left:85px;white-space:nowrap" class="ft4140">};</p>
<p style="position:absolute;top:504px;left:85px;white-space:nowrap" class="ft4141">class DatabaseManager {<br/>public:</p>
<p style="position:absolute;top:531px;left:170px;white-space:nowrap" class="ft4141">DatabaseManager();<br/>const License getLicense(const ItemReference&amp; item);<br/>void setLicense(const ItemReference&amp; item,const License&amp; license,const ItemState&amp;&#160;</p>
<p style="position:absolute;top:571px;left:85px;white-space:nowrap" class="ft4140">state);</p>
<p style="position:absolute;top:585px;left:170px;white-space:nowrap" class="ft4141">void setState(const ItemReference&amp; item,const ItemState&amp; state);<br/>void deleteLicense(const ItemReference&amp; item);<br/>ItemState getItemState(const ItemReference&amp; item);<br/>const Key getDecryptionKey(const ItemReference&amp; item);</p>
<p style="position:absolute;top:639px;left:85px;white-space:nowrap" class="ft4140">};</p>
<p style="position:absolute;top:667px;left:85px;white-space:nowrap" class="ft4141">class InterpreterInterface{<br/>public:</p>
<p style="position:absolute;top:694px;left:170px;white-space:nowrap" class="ft4141">virtual std::string interpretLicense(std::list&lt;License&gt; licenseGroup,&#160;<br/>const ItemReference&amp; item, const ItemState&amp; state,const SystemState&amp; system,&#160;<br/>const std::string&amp; operation) = 0;<br/>virtual const REL&amp; getSupportedLanguage() &#160;= 0;</p>
<p style="position:absolute;top:748px;left:85px;white-space:nowrap" class="ft4140">};</p>
<p style="position:absolute;top:775px;left:85px;white-space:nowrap" class="ft4140">class SystemState {</p>
<p style="position:absolute;top:789px;left:170px;white-space:nowrap" class="ft4140">std::string checkSysteState(const std::string&amp; state);</p>
<p style="position:absolute;top:802px;left:85px;white-space:nowrap" class="ft4140">};</p>
<p style="position:absolute;top:829px;left:85px;white-space:nowrap" class="ft4140">class CoreManager : public PlayerInterface, public ManagementInterface &#160;{</p>
<p style="position:absolute;top:843px;left:170px;white-space:nowrap" class="ft4141">LicenseManager licManager;<br/>DatabaseManager dbManager;</p>
<p style="position:absolute;top:870px;left:85px;white-space:nowrap" class="ft4140">public:</p>
<p style="position:absolute;top:884px;left:170px;white-space:nowrap" class="ft4141">CoreManager();<br/>int &#160; playerInit(const std::string&amp; playerCapabilities);<br/>void insertLicense(const std::string&amp; license, const REL&amp; relType,&#160;<br/>const ItemReference&amp; item);<br/>void getDecryptionKey(int playerID, const ItemReference&amp; item,&#160;<br/>const std::string&amp; operation, std::string&amp; playbackRestriction,Key&amp; key)&#160;<br/>throw ( std::exception );<br/>void getAttestationKey(int playerID, const REL&amp; relType,&#160;<br/>const std::string&amp; serverURL, Key&amp; key);<br/>const std::list&lt;REL&gt; getSupportedREL();</p>
<p style="position:absolute;top:1020px;left:85px;white-space:nowrap" class="ft4140">};</p>
<p style="position:absolute;top:1047px;left:85px;white-space:nowrap" class="ft4140">class LicenseManager{</p>
<p style="position:absolute;top:1060px;left:170px;white-space:nowrap" class="ft4140">MPEG21Interpreter mpeg21Interpreter;</p>
<p style="position:absolute;top:1074px;left:85px;white-space:nowrap" class="ft4140">public:</p>
<p style="position:absolute;top:1087px;left:170px;white-space:nowrap" class="ft4141">std::string interpretLicense(const std::list&lt;License&gt;&amp; licenseGroup,&#160;<br/>const ItemReference&amp; item, const std::string&amp; operation)&#160;<br/>throw(ERROR_LICENSE_INVALID,ERROR_OPERATION_DISALLOWED);</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft4116">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft4116">36/39</p>
</div>
<!-- Page 42 -->
<a name="42"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page42-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables042.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft4215">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft420">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft4216">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft4216">FINAL |&#160;1.10</p>
<p style="position:absolute;top:154px;left:170px;white-space:nowrap" class="ft4241">License translateLicense(License sourceLicense, const REL&amp; targetLicenseLang,&#160;<br/>const std::string&amp; targetRestrictions);<br/>const REL&amp; getSupportSourceLanguages();<br/>const REL&amp; getSupportTargetLanguages();</p>
<p style="position:absolute;top:208px;left:85px;white-space:nowrap" class="ft4240">};</p>
<p style="position:absolute;top:235px;left:85px;white-space:nowrap" class="ft4241">class LicenseTranslationManager{<br/>public:</p>
<p style="position:absolute;top:262px;left:170px;white-space:nowrap" class="ft4241">License translateLicense(License sourceLicense, const REL&amp; targetLicenseLang,&#160;<br/>const std::string&amp; targetRestrictions);<br/>const std::list&lt;REL&gt; getSupportSourceLanguages();</p>
<p style="position:absolute;top:303px;left:85px;white-space:nowrap" class="ft4240">};</p>
<p style="position:absolute;top:330px;left:85px;white-space:nowrap" class="ft4240">class StateManager {</p>
<p style="position:absolute;top:344px;left:170px;white-space:nowrap" class="ft4241">int checkLimit(const ItemReference&amp; item, const std::string&amp; operation);<br/>int decrementLimit(const ItemReference&amp; item, const std::string&amp; operation);<br/>std::string&amp; getSystemState(std::string state);</p>
<p style="position:absolute;top:384px;left:85px;white-space:nowrap" class="ft4240">};</p>
<p style="position:absolute;top:411px;left:85px;white-space:nowrap" class="ft4241">class ItemReference {<br/>public:</p>
<p style="position:absolute;top:439px;left:170px;white-space:nowrap" class="ft4241">int DI;<br/>std::string URL;</p>
<p style="position:absolute;top:466px;left:85px;white-space:nowrap" class="ft4240">};</p>
<p style="position:absolute;top:493px;left:85px;white-space:nowrap" class="ft4241">class ItemState {<br/>public:</p>
<p style="position:absolute;top:520px;left:170px;white-space:nowrap" class="ft4241">int item_ID;<br/>std::string state;</p>
<p style="position:absolute;top:547px;left:85px;white-space:nowrap" class="ft4240">};</p>
<p style="position:absolute;top:574px;left:85px;white-space:nowrap" class="ft4241">class Key{<br/>private:</p>
<p style="position:absolute;top:601px;left:170px;white-space:nowrap" class="ft4241">int keyLength;<br/>int keyType;<br/>const char *data;</p>
<p style="position:absolute;top:642px;left:85px;white-space:nowrap" class="ft4240">public:</p>
<p style="position:absolute;top:656px;left:170px;white-space:nowrap" class="ft4241">Key(int keyLength, int keyType, const char *key);<br/>const char* getKey() const;<br/>int getKeyType() const;<br/>int getLength() const;<br/>enum { KEY_DES64, KEY_AES128 , KEY_AES256 };</p>
<p style="position:absolute;top:724px;left:85px;white-space:nowrap" class="ft4240">};</p>
<p style="position:absolute;top:751px;left:85px;white-space:nowrap" class="ft4240">class License{</p>
<p style="position:absolute;top:764px;left:170px;white-space:nowrap" class="ft4241">private:<br/>std::string RELtext;<br/>REL relType;</p>
<p style="position:absolute;top:805px;left:85px;white-space:nowrap" class="ft4240">public:</p>
<p style="position:absolute;top:819px;left:170px;white-space:nowrap" class="ft4241">License(const REL&amp; rel, const std::string&amp; text);<br/>bool isRELType(std::string type) const;<br/>bool isRELType(REL type) const;<br/>const std::string&amp; getString() const;</p>
<p style="position:absolute;top:873px;left:85px;white-space:nowrap" class="ft4240">};</p>
<p style="position:absolute;top:900px;left:85px;white-space:nowrap" class="ft4241">class PlayerState {<br/>private:</p>
<p style="position:absolute;top:927px;left:170px;white-space:nowrap" class="ft4240">int playerID;</p>
<p style="position:absolute;top:941px;left:85px;white-space:nowrap" class="ft4240">public:</p>
<p style="position:absolute;top:954px;left:170px;white-space:nowrap" class="ft4241">PlayerState(int id);<br/>int getPlayerID();<br/>std::string checkPlayerState(const std::string&amp; state);</p>
<p style="position:absolute;top:995px;left:85px;white-space:nowrap" class="ft4240">};</p>
<p style="position:absolute;top:1022px;left:85px;white-space:nowrap" class="ft4240">class REL {</p>
<p style="position:absolute;top:1036px;left:170px;white-space:nowrap" class="ft4240">std::string RELName;</p>
<p style="position:absolute;top:1050px;left:85px;white-space:nowrap" class="ft4240">public:</p>
<p style="position:absolute;top:1063px;left:170px;white-space:nowrap" class="ft4241">REL();<br/>REL(std::string language);<br/>const std::string&amp; getName() const;</p>
<p style="position:absolute;top:1104px;left:85px;white-space:nowrap" class="ft4240">};</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft4216">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft4216">37/39</p>
</div>
<!-- Page 43 -->
<a name="43"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4342{font-size:17px;font-family:NAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page43-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables043.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft4315">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft430">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft4316">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft4316">FINAL |&#160;1.10</p>
<p style="position:absolute;top:185px;left:85px;white-space:nowrap" class="ft4310"><b>8.&#160;Glossary&#160;of&#160;Abbreviations</b></p>
<p style="position:absolute;top:222px;left:213px;white-space:nowrap" class="ft4342"><i>Abbreviation</i></p>
<p style="position:absolute;top:222px;left:578px;white-space:nowrap" class="ft4342"><i>Explanation</i></p>
<p style="position:absolute;top:250px;left:251px;white-space:nowrap" class="ft433"><b>API</b></p>
<p style="position:absolute;top:250px;left:451px;white-space:nowrap" class="ft434">Application&#160;programming interface</p>
<p style="position:absolute;top:277px;left:256px;white-space:nowrap" class="ft433"><b>DI</b></p>
<p style="position:absolute;top:277px;left:451px;white-space:nowrap" class="ft434">Digital&#160;Item</p>
<p style="position:absolute;top:305px;left:253px;white-space:nowrap" class="ft433"><b>DII</b></p>
<p style="position:absolute;top:305px;left:451px;white-space:nowrap" class="ft434">Digital&#160;Item Identifier</p>
<p style="position:absolute;top:332px;left:245px;white-space:nowrap" class="ft433"><b>DRM</b></p>
<p style="position:absolute;top:332px;left:451px;white-space:nowrap" class="ft434">Digital&#160;Rights&#160;Management</p>
<p style="position:absolute;top:360px;left:217px;white-space:nowrap" class="ft433"><b>DVB-CPCM</b></p>
<p style="position:absolute;top:360px;left:451px;white-space:nowrap" class="ft437">Digital&#160;Video Broadcast&#160;– Copy Protection&#160;<br/>and Content Management</p>
<p style="position:absolute;top:407px;left:246px;white-space:nowrap" class="ft433"><b>dsig</b></p>
<p style="position:absolute;top:407px;left:451px;white-space:nowrap" class="ft434">Digital&#160;signature</p>
<p style="position:absolute;top:434px;left:247px;white-space:nowrap" class="ft433"><b>DTD</b></p>
<p style="position:absolute;top:434px;left:451px;white-space:nowrap" class="ft434">Document Type Definition</p>
<p style="position:absolute;top:462px;left:249px;white-space:nowrap" class="ft433"><b>GUI</b></p>
<p style="position:absolute;top:462px;left:451px;white-space:nowrap" class="ft434">Graphical User Interface</p>
<p style="position:absolute;top:489px;left:253px;white-space:nowrap" class="ft433"><b>I/O</b></p>
<p style="position:absolute;top:489px;left:451px;white-space:nowrap" class="ft434">Input / Output</p>
<p style="position:absolute;top:517px;left:243px;white-space:nowrap" class="ft433"><b>IPMP</b></p>
<p style="position:absolute;top:517px;left:451px;white-space:nowrap" class="ft437">Intellectual Property&#160;Management and&#160;<br/>Protection</p>
<p style="position:absolute;top:563px;left:239px;white-space:nowrap" class="ft433"><b>MPEG</b></p>
<p style="position:absolute;top:563px;left:451px;white-space:nowrap" class="ft434">Motion Pictures Experts Group</p>
<p style="position:absolute;top:591px;left:244px;white-space:nowrap" class="ft433"><b>OMA</b></p>
<p style="position:absolute;top:591px;left:451px;white-space:nowrap" class="ft434">Open Mobile Alliance</p>
<p style="position:absolute;top:618px;left:230px;white-space:nowrap" class="ft433"><b>OpenTC</b></p>
<p style="position:absolute;top:618px;left:451px;white-space:nowrap" class="ft434">Open Trusted Computing</p>
<p style="position:absolute;top:646px;left:253px;white-space:nowrap" class="ft433"><b>OS</b></p>
<p style="position:absolute;top:646px;left:451px;white-space:nowrap" class="ft434">Operating System</p>
<p style="position:absolute;top:673px;left:246px;white-space:nowrap" class="ft433"><b>RDD</b></p>
<p style="position:absolute;top:673px;left:451px;white-space:nowrap" class="ft434">Rights&#160;Data&#160;Dictionary</p>
<p style="position:absolute;top:701px;left:249px;white-space:nowrap" class="ft433"><b>REL</b></p>
<p style="position:absolute;top:701px;left:451px;white-space:nowrap" class="ft434">Rights&#160;Expression&#160;Language</p>
<p style="position:absolute;top:729px;left:246px;white-space:nowrap" class="ft433"><b>TPM</b></p>
<p style="position:absolute;top:729px;left:451px;white-space:nowrap" class="ft434">Trusted Platform&#160;Module</p>
<p style="position:absolute;top:756px;left:248px;white-space:nowrap" class="ft433"><b>TSS</b></p>
<p style="position:absolute;top:756px;left:451px;white-space:nowrap" class="ft434">Trusted Software Stack</p>
<p style="position:absolute;top:784px;left:253px;white-space:nowrap" class="ft433"><b>UC</b></p>
<p style="position:absolute;top:784px;left:451px;white-space:nowrap" class="ft434">Use Case</p>
<p style="position:absolute;top:811px;left:246px;white-space:nowrap" class="ft433"><b>XML</b></p>
<p style="position:absolute;top:811px;left:451px;white-space:nowrap" class="ft434">Extensible Markup Language</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft4316">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft4316">38/39</p>
</div>
<!-- Page 44 -->
<a name="44"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4443{font-size:14px;font-family:GAAAAA+ArialMT;color:#000000;}
-->
</style>
<div id="page44-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables044.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft4415">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft440">&#160;</p>
<p style="position:absolute;top:92px;left:253px;white-space:nowrap" class="ft4416">D06a.1 Preliminary&#160;DRM&#160;System Specification</p>
<p style="position:absolute;top:92px;left:675px;white-space:nowrap" class="ft4416">FINAL |&#160;1.10</p>
<p style="position:absolute;top:169px;left:85px;white-space:nowrap" class="ft4410"><b>9.&#160;References</b></p>
<p style="position:absolute;top:202px;left:112px;white-space:nowrap" class="ft444">[1]&#160;MPEG: MPEG-21 Multimedia&#160;Framework&#160;Part&#160;1: Vision, Technologies and&#160;</p>
<p style="position:absolute;top:222px;left:139px;white-space:nowrap" class="ft444">Strategy.&#160;Reference: ISO/IEC TR 21000-1:2004. From&#160;ISO/IEC JTC 1.29.17.11.</p>
<p style="position:absolute;top:249px;left:112px;white-space:nowrap" class="ft444">[2]&#160;MPEG: MPEG-21 Multimedia&#160;Framework&#160;Part&#160;3: Digital Item Identification.&#160;</p>
<p style="position:absolute;top:269px;left:139px;white-space:nowrap" class="ft444">Reference:&#160;ISO/IEC TR&#160;21000-3:2003. From&#160;ISO/IEC JTC&#160;1.29.17.03.</p>
<p style="position:absolute;top:296px;left:112px;white-space:nowrap" class="ft444">[3]&#160;MPEG: MPEG-21 Multimedia&#160;Framework&#160;Part&#160;4: Intellectual Property&#160;</p>
<p style="position:absolute;top:315px;left:139px;white-space:nowrap" class="ft447">Management and Protection&#160;Components. Reference:&#160;ISO/IEC TR&#160;21000-4. From&#160;<br/>ISO/IEC JTC 1.29.17.04.</p>
<p style="position:absolute;top:362px;left:112px;white-space:nowrap" class="ft444">[4]&#160;MPEG: MPEG-21 Multimedia&#160;Framework&#160;Part&#160;5: Rights Expression&#160;Language.&#160;</p>
<p style="position:absolute;top:382px;left:139px;white-space:nowrap" class="ft444">Reference:&#160;ISO/IEC FDIS&#160;21000-5:2004. From&#160;ISO/IEC JTC 1/SC 29/WG 11.</p>
<p style="position:absolute;top:409px;left:112px;white-space:nowrap" class="ft444">[5]&#160;MPEG: MPEG-21 Multimedia&#160;Framework&#160;Part&#160;6: Rights Data&#160;Dictionary.&#160;</p>
<p style="position:absolute;top:428px;left:139px;white-space:nowrap" class="ft444">Reference:&#160;ISO/IEC TR&#160;21000-6:2004. From&#160;ISO/IEC JTC&#160;1.29.17.06.</p>
<p style="position:absolute;top:456px;left:112px;white-space:nowrap" class="ft444">[6]&#160;Open Mobile Alliance (2005): DRM Specification&#160;Candidate Version 2.0.&#160;</p>
<p style="position:absolute;top:476px;left:139px;white-space:nowrap" class="ft4443"><a href="http://www.openmobilealliance.org/release_program/drm_v2_0.html">http://www.openmobilealliance.org/release_program/drm_v2_0.html</a></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft4416">Open_TC Deliverable&#160;D06a.1</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft4416">39/39</p>
</div>
<!-- Page 45 -->
<a name="45"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page45-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables045.png" alt="background image"/>
<p style="position:absolute;top:137px;left:92px;white-space:nowrap" class="ft450">&#160;</p>
<p style="position:absolute;top:76px;left:91px;white-space:nowrap" class="ft451">&#160;</p>
<p style="position:absolute;top:242px;left:109px;white-space:nowrap" class="ft452"><b>D06e.1&#160;MFA Requirements and Specification</b></p>
<p style="position:absolute;top:319px;left:91px;white-space:nowrap" class="ft453"><b>Project&#160;number</b></p>
<p style="position:absolute;top:319px;left:425px;white-space:nowrap" class="ft454">IST-027635</p>
<p style="position:absolute;top:345px;left:91px;white-space:nowrap" class="ft453"><b>Project&#160;acronym</b></p>
<p style="position:absolute;top:345px;left:425px;white-space:nowrap" class="ft454">Open_TC</p>
<p style="position:absolute;top:370px;left:91px;white-space:nowrap" class="ft453"><b>Project&#160;title</b></p>
<p style="position:absolute;top:370px;left:425px;white-space:nowrap" class="ft454">Open Trusted Computing</p>
<p style="position:absolute;top:396px;left:91px;white-space:nowrap" class="ft453"><b>Deliverable type</b></p>
<p style="position:absolute;top:396px;left:425px;white-space:nowrap" class="ft454">Internal deliverable</p>
<p style="position:absolute;top:439px;left:91px;white-space:nowrap" class="ft453"><b>Deliverable reference&#160;number</b></p>
<p style="position:absolute;top:439px;left:425px;white-space:nowrap" class="ft454">IST-027635/D06e.1/FINAL&#160;| 1.00</p>
<p style="position:absolute;top:464px;left:91px;white-space:nowrap" class="ft453"><b>Deliverable title</b></p>
<p style="position:absolute;top:464px;left:425px;white-space:nowrap" class="ft454">MFA Requirements &#160;and &#160;Specification</p>
<p style="position:absolute;top:490px;left:91px;white-space:nowrap" class="ft453"><b>WP contributing to the&#160;deliverable</b></p>
<p style="position:absolute;top:490px;left:425px;white-space:nowrap" class="ft454">WP06e.1</p>
<p style="position:absolute;top:515px;left:91px;white-space:nowrap" class="ft453"><b>Due date</b></p>
<p style="position:absolute;top:515px;left:425px;white-space:nowrap" class="ft454">Apr 2006 - M06</p>
<p style="position:absolute;top:541px;left:91px;white-space:nowrap" class="ft453"><b>Actual submission&#160;date</b></p>
<p style="position:absolute;top:541px;left:425px;white-space:nowrap" class="ft454">Sept 12, 2006&#160;</p>
<p style="position:absolute;top:584px;left:91px;white-space:nowrap" class="ft453"><b>Responsible&#160;Organisation</b></p>
<p style="position:absolute;top:584px;left:424px;white-space:nowrap" class="ft454">INTEK</p>
<p style="position:absolute;top:609px;left:91px;white-space:nowrap" class="ft453"><b>Authors</b></p>
<p style="position:absolute;top:609px;left:424px;white-space:nowrap" class="ft454">Irina&#160;Beliakova,&#160;Vladimir&#160;Bashmakov</p>
<p style="position:absolute;top:632px;left:91px;white-space:nowrap" class="ft453"><b>Abstract</b></p>
<p style="position:absolute;top:632px;left:424px;white-space:nowrap" class="ft457">The goal of this application&#160;is to demonstrate&#160;<br/>the secure access&#160;to remote&#160;server that in&#160;<br/>addition to “what-you-know” information&#160;<br/>(password)&#160;requires&#160;the&#160;platform&#160;<br/>authentication through the use of&#160;TPM</p>
<p style="position:absolute;top:847px;left:91px;white-space:nowrap" class="ft453"><b>Keywords</b></p>
<p style="position:absolute;top:847px;left:424px;white-space:nowrap" class="ft454">MFA,&#160;OPEN_TC, TPM</p>
<p style="position:absolute;top:891px;left:92px;white-space:nowrap" class="ft453"><b>Dissemination level</b></p>
<p style="position:absolute;top:891px;left:423px;white-space:nowrap" class="ft454">Public</p>
<p style="position:absolute;top:916px;left:92px;white-space:nowrap" class="ft453"><b>Revision</b></p>
<p style="position:absolute;top:916px;left:423px;white-space:nowrap" class="ft454">FINAL&#160;| 1.00</p>
<p style="position:absolute;top:967px;left:90px;white-space:nowrap" class="ft453"><b>Instrument</b></p>
<p style="position:absolute;top:967px;left:271px;white-space:nowrap" class="ft454">IP</p>
<p style="position:absolute;top:958px;left:452px;white-space:nowrap" class="ft459"><b>Start&#160;date of&#160;the&#160;<br/>project</b></p>
<p style="position:absolute;top:967px;left:633px;white-space:nowrap" class="ft454">1</p>
<p style="position:absolute;top:967px;left:643px;white-space:nowrap" class="ft455">st</p>
<p style="position:absolute;top:967px;left:652px;white-space:nowrap" class="ft454">&#160;November 2005</p>
<p style="position:absolute;top:996px;left:90px;white-space:nowrap" class="ft453"><b>Thematic&#160;Priority</b></p>
<p style="position:absolute;top:996px;left:271px;white-space:nowrap" class="ft454">IST</p>
<p style="position:absolute;top:996px;left:452px;white-space:nowrap" class="ft453"><b>Duration</b></p>
<p style="position:absolute;top:996px;left:633px;white-space:nowrap" class="ft454">42 months</p>
<p style="position:absolute;top:75px;left:674px;white-space:nowrap" class="ft456">&#160;</p>
</div>
<!-- Page 46 -->
<a name="46"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page46-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables046.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft4615">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft460">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft4616">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft4616">FINAL |&#160;1.00</p>
<p style="position:absolute;top:167px;left:328px;white-space:nowrap" class="ft4617"><b>Table&#160;of Contents</b></p>
<p style="position:absolute;top:200px;left:105px;white-space:nowrap" class="ft467">1 &#160;Introduction&#160;...........................................................................................................&#160;5<br/>2 &#160;Threat&#160;analysis........................................................................................................&#160;5<br/>3 &#160;Functional requirements.........................................................................................&#160;7</p>
<p style="position:absolute;top:257px;left:116px;white-space:nowrap" class="ft467">3.1 &#160;Roles&#160;and Actors................................................................................................&#160;7<br/>3.2 &#160;Use cases...........................................................................................................&#160;8</p>
<p style="position:absolute;top:296px;left:118px;white-space:nowrap" class="ft464">3.2.1 &#160;Client/server Installation&#160;of MFA components................................................&#160;8</p>
<p style="position:absolute;top:315px;left:108px;white-space:nowrap" class="ft467">3.2.2 &#160;Client Initialization..........................................................................................&#160;10<br/>3.2.3 &#160;Platform&#160;registration.......................................................................................&#160;11<br/>3.2.4 &#160;Platform&#160;unregistration...................................................................................&#160;12<br/>3.2.5 &#160;User Registration............................................................................................&#160;13<br/>3.2.6 &#160;Client logon....................................................................................................&#160;14<br/>3.2.7 &#160;Client logoff....................................................................................................&#160;15<br/>3.2.8 &#160;User/platform&#160;authentication..........................................................................&#160;16<br/>3.2.9 &#160;Using a&#160;remote server secure application/service..........................................&#160;17<br/>3.2.10 &#160;Server policy&#160;configuration...........................................................................&#160;18<br/>3.2.11 &#160;Platform&#160;registration&#160;on the server...............................................................19<br/>3.2.12 &#160;Server logon session....................................................................................&#160;20</p>
<p style="position:absolute;top:526px;left:105px;white-space:nowrap" class="ft464">4 &#160; High level design.................................................................................................&#160;21</p>
<p style="position:absolute;top:545px;left:116px;white-space:nowrap" class="ft467">4.1 &#160;Client operations..............................................................................................&#160;21<br/>4.2 &#160;Server functionality..........................................................................................&#160;21<br/>4.3 &#160; MFA&#160;system architecture................................................................................&#160;23</p>
<p style="position:absolute;top:603px;left:105px;white-space:nowrap" class="ft467">5 &#160;Required services&#160;from sublayers.........................................................................&#160;24<br/>6 &#160; Environment requirements&#160;.................................................................................&#160;24<br/>7 &#160; Platform&#160;requirements.........................................................................................&#160;25<br/>8 &#160;List&#160;of abbreviations..............................................................................................&#160;25<br/>9 &#160;Referenced Documents.........................................................................................&#160;25</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft4616">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft4616">2/25</p>
</div>
<!-- Page 47 -->
<a name="47"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page47-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables047.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft4715">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft470">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft4716">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft4716">FINAL |&#160;1.00</p>
<p style="position:absolute;top:167px;left:352px;white-space:nowrap" class="ft4717"><b>List&#160;of figures</b></p>
<p style="position:absolute;top:200px;left:105px;white-space:nowrap" class="ft474">Figure 1: MFA system&#160;architecture...........................................................................&#160;22</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft4716">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft4716">3/25</p>
</div>
<!-- Page 48 -->
<a name="48"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4844{font-size:14px;font-family:EAAAAA+OpenSymbol;color:#000000;}
	.ft4845{font-size:17px;font-family:FAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page48-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables048.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft4815">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft480">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft4816">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft4816">FINAL |&#160;1.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft4810"><b>1&#160;Introduction&#160;</b></p>
<p style="position:absolute;top:200px;left:83px;white-space:nowrap" class="ft487">The TPM MultiFactor&#160;Authentication&#160;(MFA) system&#160;is an application&#160;of the Trusted&#160;<br/>Computing technology&#160;and shows the benefits&#160;of such technology for ensuring that&#160;<br/>only a user who&#160;owns a registered platform&#160;equipped with a TPM may&#160;have access&#160;to&#160;<br/>the remote computer&#160;resources.&#160;<br/>As&#160;long as&#160;an authorized system&#160;is used to&#160;access&#160;corporate&#160;resources,&#160;the entire&#160;<br/>infrastructure&#160;can&#160;be thought of as&#160;protected. Even if&#160;somebody's&#160;credentials have&#160;<br/>been stolen, the intruder will have to operate from&#160;a trusted corporate&#160;platform&#160;to gain&#160;<br/>the access&#160;to the resources.<br/>The multifactor&#160;authentication,&#160;including both the user and TPM-based&#160;platform&#160;<br/>authentication, covers&#160;up these threats.&#160;The access&#160;to the network&#160;is granted only if&#160;<br/>both elements - user and platform&#160;-&#160;are&#160;successfully authenticated.<br/>This document contains&#160;the MFA requirements and high level architecture specification&#160;<br/>for&#160;a preliminary&#160;release&#160;of the MFA&#160;system.</p>
<p style="position:absolute;top:504px;left:83px;white-space:nowrap" class="ft4810"><b>2&#160;Threat&#160;analysis</b></p>
<p style="position:absolute;top:537px;left:83px;white-space:nowrap" class="ft484">Different&#160;threat&#160;types could be categorized by the general attacker&#160;goal:&#160;</p>
<p style="position:absolute;top:568px;left:110px;white-space:nowrap" class="ft4844">●</p>
<p style="position:absolute;top:565px;left:137px;white-space:nowrap" class="ft483"><b>Spoofing</b></p>
<p style="position:absolute;top:565px;left:220px;white-space:nowrap" class="ft484">.&#160;</p>
<p style="position:absolute;top:565px;left:231px;white-space:nowrap" class="ft4845"><i>Spoofing</i></p>
<p style="position:absolute;top:565px;left:303px;white-space:nowrap" class="ft484">&#160;is the attempt&#160;to gain access&#160;to a&#160;system by using a false&#160;</p>
<p style="position:absolute;top:585px;left:137px;white-space:nowrap" class="ft487">identity. This can&#160;be accomplished by using stolen user&#160;credentials or&#160;a false IP&#160;<br/>address.&#160;After the attacker&#160;successfully gains access&#160;as a&#160;legitimate&#160;user&#160;or&#160;<br/>host,&#160;the elevation&#160;of privileges or&#160;abuse using authorization can&#160;begin.&#160;</p>
<p style="position:absolute;top:655px;left:110px;white-space:nowrap" class="ft4844">●</p>
<p style="position:absolute;top:652px;left:137px;white-space:nowrap" class="ft483"><b>Tampering</b></p>
<p style="position:absolute;top:652px;left:237px;white-space:nowrap" class="ft484">.&#160;</p>
<p style="position:absolute;top:652px;left:248px;white-space:nowrap" class="ft4845"><i>Tampering</i></p>
<p style="position:absolute;top:652px;left:337px;white-space:nowrap" class="ft484">&#160;is the unauthorized modification of data,&#160;for&#160;example as&#160;</p>
<p style="position:absolute;top:671px;left:137px;white-space:nowrap" class="ft484">it flows over a&#160;network&#160;between two&#160;computers.&#160;</p>
<p style="position:absolute;top:702px;left:110px;white-space:nowrap" class="ft4844">●</p>
<p style="position:absolute;top:699px;left:137px;white-space:nowrap" class="ft483"><b>Repudiation</b></p>
<p style="position:absolute;top:699px;left:250px;white-space:nowrap" class="ft484">.&#160;</p>
<p style="position:absolute;top:699px;left:261px;white-space:nowrap" class="ft4845"><i>Repudiation</i></p>
<p style="position:absolute;top:699px;left:360px;white-space:nowrap" class="ft484">&#160;is the ability&#160;of users&#160;(legitimate&#160;or otherwise) to&#160;</p>
<p style="position:absolute;top:719px;left:137px;white-space:nowrap" class="ft487">deny that they performed&#160;specific actions&#160;or&#160;transactions.&#160;Without adequate&#160;<br/>auditing, the repudiation attacks&#160;are difficult to&#160;prove.&#160;</p>
<p style="position:absolute;top:769px;left:110px;white-space:nowrap" class="ft4844">●</p>
<p style="position:absolute;top:766px;left:137px;white-space:nowrap" class="ft483"><b>Information&#160;disclosure</b></p>
<p style="position:absolute;top:766px;left:348px;white-space:nowrap" class="ft484">.&#160;</p>
<p style="position:absolute;top:766px;left:358px;white-space:nowrap" class="ft4845"><i>Information&#160;disclosure</i></p>
<p style="position:absolute;top:766px;left:543px;white-space:nowrap" class="ft484">&#160;is the unwanted exposure&#160;of&#160;</p>
<p style="position:absolute;top:786px;left:137px;white-space:nowrap" class="ft487">private data.&#160;For&#160;example, a&#160;user views the contents&#160;of a table or file he&#160;or&#160;she&#160;<br/>is not authorized to open or&#160;monitors&#160;data passed&#160;in a&#160;plain text over a&#160;network.&#160;<br/>Some examples of information&#160;disclosure vulnerabilities include the use of&#160;<br/>hidden form fields, comments&#160;embedded in Web pages that&#160;contain database&#160;<br/>connection&#160;strings and connection details&#160;and weak&#160;exception handling that can&#160;<br/>lead to internal system&#160;level details being revealed to&#160;the client.&#160;Any of this&#160;<br/>information&#160;can&#160;be very&#160;useful to&#160;the attacker.&#160;</p>
<p style="position:absolute;top:932px;left:110px;white-space:nowrap" class="ft4844">●</p>
<p style="position:absolute;top:929px;left:137px;white-space:nowrap" class="ft483"><b>Denial of service</b></p>
<p style="position:absolute;top:929px;left:293px;white-space:nowrap" class="ft484">.&#160;</p>
<p style="position:absolute;top:929px;left:304px;white-space:nowrap" class="ft4845"><i>Denial of&#160;service</i></p>
<p style="position:absolute;top:929px;left:442px;white-space:nowrap" class="ft484">&#160;is the process&#160;of making a system&#160;or&#160;</p>
<p style="position:absolute;top:949px;left:137px;white-space:nowrap" class="ft487">application unavailable. For&#160;example, a denial of service attack&#160;might be&#160;<br/>accomplished by bombarding a server with requests&#160;to consume&#160;all available&#160;<br/>system&#160;resources&#160;or&#160;by passing it malformed&#160;input data&#160;that&#160;can&#160;make an&#160;<br/>application process&#160;crash.</p>
<p style="position:absolute;top:1037px;left:110px;white-space:nowrap" class="ft4844">●</p>
<p style="position:absolute;top:1034px;left:137px;white-space:nowrap" class="ft483"><b>Elevation&#160;of privilege</b></p>
<p style="position:absolute;top:1034px;left:336px;white-space:nowrap" class="ft484">.&#160;</p>
<p style="position:absolute;top:1034px;left:346px;white-space:nowrap" class="ft4845"><i>Elevation of privilege&#160;</i></p>
<p style="position:absolute;top:1034px;left:526px;white-space:nowrap" class="ft484">occurs&#160;when a user with limited&#160;</p>
<p style="position:absolute;top:1054px;left:137px;white-space:nowrap" class="ft487">privileges&#160;assumes&#160;the identity of a&#160;privileged user&#160;to gain privileged access&#160;to&#160;<br/>an application. For&#160;example, an attacker&#160;with limited privileges&#160;might elevate&#160;<br/>his or&#160;her privilege level to compromise&#160;and take control&#160;of a&#160;highly privileged&#160;<br/>and trusted process&#160;or account.&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft4816">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft4816">4/25</p>
</div>
<!-- Page 49 -->
<a name="49"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4946{font-size:17px;font-family:Symbol;color:#000000;}
-->
</style>
<div id="page49-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables049.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft4915">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft490">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft4916">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft4916">FINAL |&#160;1.00</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft497">Each threat&#160;category&#160;has&#160;a corresponding set of&#160;countermeasure techniques that&#160;<br/>should be used to reduce the risk of attacks.&#160;These countermeasures&#160;are summarized&#160;<br/>in the following table:</p>
<p style="position:absolute;top:248px;left:86px;white-space:nowrap" class="ft494">Threat</p>
<p style="position:absolute;top:248px;left:229px;white-space:nowrap" class="ft494">Typical&#160;Countermeasures</p>
<p style="position:absolute;top:273px;left:86px;white-space:nowrap" class="ft497">Spoofing the&#160;<br/>user identity</p>
<p style="position:absolute;top:275px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:273px;left:283px;white-space:nowrap" class="ft494">Use strong&#160;authentication&#160;&#160;</p>
<p style="position:absolute;top:295px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:292px;left:283px;white-space:nowrap" class="ft494">Do not store&#160;secrets&#160;in plain text</p>
<p style="position:absolute;top:314px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:312px;left:283px;white-space:nowrap" class="ft497">Do not pass&#160;credentials&#160;in plain text over&#160;the wire&#160;<br/>authentication&#160;</p>
<p style="position:absolute;top:353px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:350px;left:283px;white-space:nowrap" class="ft497">Protect&#160;authentication&#160;cookies&#160;with Secure Sockets Layer&#160;<br/>(SSL)</p>
<p style="position:absolute;top:395px;left:86px;white-space:nowrap" class="ft497">Tampering with&#160;<br/>data</p>
<p style="position:absolute;top:398px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:395px;left:283px;white-space:nowrap" class="ft494">Use data&#160;hashing and signing</p>
<p style="position:absolute;top:417px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:414px;left:283px;white-space:nowrap" class="ft494">Use digital signatures</p>
<p style="position:absolute;top:437px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:434px;left:283px;white-space:nowrap" class="ft494">Use strong&#160;authorization</p>
<p style="position:absolute;top:456px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:453px;left:283px;white-space:nowrap" class="ft494">Use tamper-resistant&#160;protocols&#160;across&#160;communication&#160;links</p>
<p style="position:absolute;top:476px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:473px;left:283px;white-space:nowrap" class="ft497">Secure communication&#160;links with protocols&#160;that&#160;provide&#160;<br/>message integrity</p>
<p style="position:absolute;top:517px;left:86px;white-space:nowrap" class="ft494">Repudiation</p>
<p style="position:absolute;top:521px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:517px;left:283px;white-space:nowrap" class="ft4946">&#160;</p>
<p style="position:absolute;top:518px;left:287px;white-space:nowrap" class="ft494">Create secure audit trails</p>
<p style="position:absolute;top:542px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:538px;left:283px;white-space:nowrap" class="ft4946">&#160;</p>
<p style="position:absolute;top:539px;left:287px;white-space:nowrap" class="ft494">Use digital signatures</p>
<p style="position:absolute;top:564px;left:86px;white-space:nowrap" class="ft497">Information&#160;<br/>disclosure</p>
<p style="position:absolute;top:567px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:564px;left:283px;white-space:nowrap" class="ft494">Use strong&#160;authorization</p>
<p style="position:absolute;top:587px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:584px;left:283px;white-space:nowrap" class="ft494">Use strong&#160;encryption</p>
<p style="position:absolute;top:606px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:603px;left:283px;white-space:nowrap" class="ft497">Secure communication&#160;links with protocols&#160;that&#160;provide&#160;<br/>message confidentiality</p>
<p style="position:absolute;top:645px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:642px;left:283px;white-space:nowrap" class="ft494">Do not store&#160;secrets&#160;(for&#160;example, passwords)&#160;in plain text</p>
<p style="position:absolute;top:667px;left:86px;white-space:nowrap" class="ft494">Denial of service</p>
<p style="position:absolute;top:670px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:667px;left:283px;white-space:nowrap" class="ft494">Use resource&#160;and bandwidth throttling techniques</p>
<p style="position:absolute;top:690px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:687px;left:283px;white-space:nowrap" class="ft494">Validate&#160;and filter&#160;input</p>
<p style="position:absolute;top:712px;left:86px;white-space:nowrap" class="ft497">Elevation of&#160;<br/>privilege</p>
<p style="position:absolute;top:715px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:712px;left:283px;white-space:nowrap" class="ft494">Follow the principle of least privilege</p>
<p style="position:absolute;top:734px;left:256px;white-space:nowrap" class="ft4944">●</p>
<p style="position:absolute;top:731px;left:283px;white-space:nowrap" class="ft497">Use least privileged service accounts&#160;to&#160;run processes&#160;and&#160;<br/>access&#160;resources</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft4916">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft4916">5/25</p>
</div>
<!-- Page 50 -->
<a name="50"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft5047{font-size:20px;font-family:HAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page50-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables050.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft5015">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft500">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft5016">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft5016">FINAL |&#160;1.00</p>
<p style="position:absolute;top:195px;left:83px;white-space:nowrap" class="ft5010"><b>3&#160;Functional&#160;requirements</b></p>
<p style="position:absolute;top:247px;left:83px;white-space:nowrap" class="ft5047"><i><b>3.1&#160;Roles and Actors</b></i></p>
<p style="position:absolute;top:281px;left:110px;white-space:nowrap" class="ft5044">●</p>
<p style="position:absolute;top:278px;left:137px;white-space:nowrap" class="ft503"><b>User:</b></p>
<p style="position:absolute;top:278px;left:187px;white-space:nowrap" class="ft504">&#160;&#160;the&#160;entity&#160;that&#160;performs&#160;the&#160;requests&#160;for&#160;using&#160;the&#160;remote&#160;services&#160;and&#160;</p>
<p style="position:absolute;top:298px;left:137px;white-space:nowrap" class="ft507">wants&#160;to&#160;be&#160;authenticated.&#160;In&#160;some&#160;scenarios&#160;the&#160;user&#160;and&#160;the&#160;administrator&#160;<br/>may&#160;be the same&#160;person.</p>
<p style="position:absolute;top:348px;left:110px;white-space:nowrap" class="ft5044">●</p>
<p style="position:absolute;top:345px;left:137px;white-space:nowrap" class="ft503"><b>Administrator:</b></p>
<p style="position:absolute;top:345px;left:273px;white-space:nowrap" class="ft504">&#160;&#160;the&#160;system&#160;administrator&#160;on&#160;the&#160;server/client&#160;side&#160;installs&#160;the&#160;</p>
<p style="position:absolute;top:364px;left:137px;white-space:nowrap" class="ft504">software&#160;and performs&#160;all system&#160;operations.</p>
<p style="position:absolute;top:396px;left:110px;white-space:nowrap" class="ft5044">●</p>
<p style="position:absolute;top:393px;left:137px;white-space:nowrap" class="ft503"><b>Authentication:</b></p>
<p style="position:absolute;top:393px;left:282px;white-space:nowrap" class="ft504">&#160;&#160;in&#160;&#160;&#160;computer&#160;&#160;&#160;security&#160;&#160;&#160;authentication&#160;&#160;&#160;is&#160;&#160;&#160;the&#160;&#160;&#160;process&#160;&#160;&#160;of&#160;</p>
<p style="position:absolute;top:412px;left:137px;white-space:nowrap" class="ft507">attempting&#160;to&#160;verify&#160;the&#160;identity&#160;of&#160;the&#160;sender&#160;of&#160;a&#160;communication&#160;such&#160;as&#160;a&#160;<br/>request&#160;to log in. The sender&#160;being authenticated may&#160;be a&#160;person.&#160;</p>
<p style="position:absolute;top:463px;left:110px;white-space:nowrap" class="ft5044">●</p>
<p style="position:absolute;top:460px;left:137px;white-space:nowrap" class="ft503"><b>MFA:</b></p>
<p style="position:absolute;top:460px;left:185px;white-space:nowrap" class="ft504">&#160;&#160;Multifactor&#160;Authentication.&#160;&#160;The&#160;general&#160;idea&#160;of&#160;a&#160;MFA&#160;architecture&#160;is&#160;to&#160;</p>
<p style="position:absolute;top:479px;left:137px;white-space:nowrap" class="ft507">use&#160;several&#160;types&#160;of&#160;credentials&#160;to&#160;authenticate&#160;the&#160;user&#160;during&#160;the&#160;logon&#160;to&#160;<br/>remote&#160;server&#160;computers&#160;in&#160;order&#160;to&#160;enforce&#160;a&#160;strong&#160;authentication&#160;security.&#160;In&#160;<br/>our&#160;&#160;&#160;case&#160;&#160;&#160;MFA&#160;&#160;&#160;is&#160;&#160;&#160;two-factor&#160;&#160;&#160;authentication&#160;&#160;&#160;system:&#160;&#160;&#160;user&#160;&#160;&#160;identity&#160;&#160;&#160;and&#160;&#160;&#160;TPM-<br/>equipped platform&#160;identity.</p>
<p style="position:absolute;top:568px;left:110px;white-space:nowrap" class="ft5044">●</p>
<p style="position:absolute;top:565px;left:137px;white-space:nowrap" class="ft503"><b>Login:</b></p>
<p style="position:absolute;top:565px;left:195px;white-space:nowrap" class="ft504">&#160;&#160;login&#160;&#160;&#160;is&#160;&#160;&#160;the&#160;&#160;&#160;process&#160;&#160;&#160;of&#160;&#160;&#160;receiving&#160;&#160;&#160;access&#160;&#160;&#160;to&#160;&#160;&#160;a&#160;&#160;&#160;computer&#160;&#160;&#160;system</p>
<p style="position:absolute;top:565px;left:777px;white-space:nowrap" class="ft5013">&#160;</p>
<p style="position:absolute;top:565px;left:789px;white-space:nowrap" class="ft504">by&#160;</p>
<p style="position:absolute;top:584px;left:137px;white-space:nowrap" class="ft507">identification&#160;of&#160;the&#160;user&#160;in&#160;order&#160;to&#160;obtain&#160;credential&#160;to&#160;permit&#160;access.&#160;It&#160;is&#160;an&#160;<br/>integral&#160;part&#160;of&#160;computer&#160;security&#160;procedure.&#160;Logon&#160;to&#160;system&#160;with&#160;multifactor&#160;<br/>authentication&#160;uses&#160;two&#160;credentials:&#160;user&#160;password&#160;and&#160;TPM-equipped&#160;platform&#160;<br/>identity to&#160;permit access&#160;to&#160;resources.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5016">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft5016">6/25</p>
</div>
<!-- Page 51 -->
<a name="51"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft5148{font-size:18px;font-family:HAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page51-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables051.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft5115">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft510">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft5116">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft5116">FINAL |&#160;1.00</p>
<p style="position:absolute;top:186px;left:83px;white-space:nowrap" class="ft5147"><i><b>3.2&#160;Use cases</b></i></p>
<p style="position:absolute;top:236px;left:90px;white-space:nowrap" class="ft5148"><i><b>3.2.1&#160;Client/server&#160;Installation of MFA components</b></i></p>
<p style="position:absolute;top:289px;left:88px;white-space:nowrap" class="ft513"><b>Use&#160;case unique&#160;ID</b></p>
<p style="position:absolute;top:289px;left:451px;white-space:nowrap" class="ft514">/UC 10/</p>
<p style="position:absolute;top:317px;left:88px;white-space:nowrap" class="ft513"><b>Title</b></p>
<p style="position:absolute;top:317px;left:451px;white-space:nowrap" class="ft517">Client/server Installation&#160;of MFA&#160;<br/>components</p>
<p style="position:absolute;top:363px;left:88px;white-space:nowrap" class="ft513"><b>Authors</b></p>
<p style="position:absolute;top:363px;left:451px;white-space:nowrap" class="ft517">Irina&#160;Beliakova,&#160;Vladimir&#160;Bashmakov<br/>&#160;(INTEK)</p>
<p style="position:absolute;top:410px;left:88px;white-space:nowrap" class="ft513"><b>Use&#160;case revision&#160;number</b></p>
<p style="position:absolute;top:410px;left:451px;white-space:nowrap" class="ft514">01</p>
<p style="position:absolute;top:438px;left:86px;white-space:nowrap" class="ft513"><b>Use&#160;case&#160;revision date</b></p>
<p style="position:absolute;top:438px;left:451px;white-space:nowrap" class="ft514">2006-11-15&#160;</p>
<p style="position:absolute;top:465px;left:88px;white-space:nowrap" class="ft513"><b>Short description/purpose(s)</b></p>
<p style="position:absolute;top:465px;left:451px;white-space:nowrap" class="ft517">The client and server components&#160;are&#160;<br/>installed on two&#160;systems&#160;by the system&#160;<br/>administrator.&#160;After&#160;the installation is&#160;<br/>completed the user&#160;has access&#160;to the&#160;<br/>client&#160;computer components&#160;and the&#160;<br/>system&#160;administrator&#160;has&#160;access&#160;to server&#160;<br/>computer&#160;components.</p>
<p style="position:absolute;top:608px;left:88px;white-space:nowrap" class="ft513"><b>Roles</b></p>
<p style="position:absolute;top:608px;left:451px;white-space:nowrap" class="ft514">Administrator</p>
<p style="position:absolute;top:635px;left:88px;white-space:nowrap" class="ft513"><b>Includes</b></p>
<p style="position:absolute;top:638px;left:478px;white-space:nowrap" class="ft5144">●</p>
<p style="position:absolute;top:635px;left:505px;white-space:nowrap" class="ft517">An installed and running Open_TC&#160;<br/>framework&#160;on the client and server&#160;<br/>platform.</p>
<p style="position:absolute;top:705px;left:478px;white-space:nowrap" class="ft5144">●</p>
<p style="position:absolute;top:702px;left:505px;white-space:nowrap" class="ft517">Multifactor&#160;authentication&#160;services&#160;<br/>require fully a implemented Trusted&#160;<br/>Software&#160;Stack (TSS) for Linux&#160;<br/>according to&#160;TCG specification.&#160;TSS&#160;<br/>stack&#160;must&#160;support basic&#160;TCG&#160;<br/>functionality&#160;including the&#160;<br/>generation&#160;of Attestation&#160;Identities&#160;<br/>Keys&#160;(AIK), extending and retrieving&#160;<br/>the values&#160;of the TPM&#160;Platform&#160;<br/>Configuration&#160;Registers&#160;(PCRs).</p>
<p style="position:absolute;top:907px;left:478px;white-space:nowrap" class="ft5144">●</p>
<p style="position:absolute;top:904px;left:505px;white-space:nowrap" class="ft517">The security services&#160;such as&#160;<br/>OpenSSL.</p>
<p style="position:absolute;top:954px;left:478px;white-space:nowrap" class="ft5144">●</p>
<p style="position:absolute;top:951px;left:505px;white-space:nowrap" class="ft514">Crypto/PKI&#160;services.</p>
<p style="position:absolute;top:983px;left:478px;white-space:nowrap" class="ft5144">●</p>
<p style="position:absolute;top:980px;left:505px;white-space:nowrap" class="ft517">OpenTC Certificate&#160;Authority (CA) to&#160;<br/>provide the cryptographic&#160;certificate&#160;<br/>infrastructure.</p>
<p style="position:absolute;top:1055px;left:88px;white-space:nowrap" class="ft513"><b>Preconditions</b></p>
<p style="position:absolute;top:1055px;left:451px;white-space:nowrap" class="ft514">(none)</p>
<p style="position:absolute;top:1083px;left:88px;white-space:nowrap" class="ft513"><b>Postcondition</b></p>
<p style="position:absolute;top:1083px;left:451px;white-space:nowrap" class="ft517">The demo&#160;applications&#160;of the OTC security&#160;<br/>architecture&#160;can&#160;be used.&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5116">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft5116">7/25</p>
</div>
<!-- Page 52 -->
<a name="52"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page52-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables052.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft5215">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft520">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft5216">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft5216">FINAL |&#160;1.00</p>
<p style="position:absolute;top:182px;left:88px;white-space:nowrap" class="ft523"><b>Normal&#160;Flow</b></p>
<p style="position:absolute;top:182px;left:451px;white-space:nowrap" class="ft527">The administrator&#160;executes and completes&#160;<br/>the installation&#160;procedure.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5216">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft5216">8/25</p>
</div>
<!-- Page 53 -->
<a name="53"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page53-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables053.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft5315">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft530">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft5316">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft5316">FINAL |&#160;1.00</p>
<p style="position:absolute;top:186px;left:90px;white-space:nowrap" class="ft5348"><i><b>3.2.2&#160;Client Initialization</b></i></p>
<p style="position:absolute;top:240px;left:88px;white-space:nowrap" class="ft533"><b>Use&#160;case unique&#160;ID&#160;</b></p>
<p style="position:absolute;top:240px;left:450px;white-space:nowrap" class="ft534">/UC 100/</p>
<p style="position:absolute;top:267px;left:88px;white-space:nowrap" class="ft533"><b>Title</b></p>
<p style="position:absolute;top:267px;left:450px;white-space:nowrap" class="ft534">Client initialization</p>
<p style="position:absolute;top:295px;left:88px;white-space:nowrap" class="ft533"><b>Authors</b></p>
<p style="position:absolute;top:295px;left:450px;white-space:nowrap" class="ft537">Irina Beliakova, Vladimir Bashmakov&#160;<br/>(INTEK)&#160;</p>
<p style="position:absolute;top:341px;left:88px;white-space:nowrap" class="ft533"><b>Use&#160;case revision&#160;number</b></p>
<p style="position:absolute;top:341px;left:450px;white-space:nowrap" class="ft534">01</p>
<p style="position:absolute;top:369px;left:88px;white-space:nowrap" class="ft533"><b>Use&#160;case revision&#160;date</b></p>
<p style="position:absolute;top:369px;left:450px;white-space:nowrap" class="ft534">2006-01-16</p>
<p style="position:absolute;top:396px;left:88px;white-space:nowrap" class="ft533"><b>Short description/purpose(s)</b></p>
<p style="position:absolute;top:396px;left:450px;white-space:nowrap" class="ft537">The administrator&#160;starts&#160;the utility to&#160;<br/>initialize the TPM and create&#160;an AIK.</p>
<p style="position:absolute;top:443px;left:88px;white-space:nowrap" class="ft533"><b>Roles</b></p>
<p style="position:absolute;top:443px;left:450px;white-space:nowrap" class="ft534">Administrator</p>
<p style="position:absolute;top:471px;left:88px;white-space:nowrap" class="ft533"><b>Preconditions</b></p>
<p style="position:absolute;top:471px;left:450px;white-space:nowrap" class="ft537">This&#160;TPM platform&#160;has not been initialized&#160;<br/>before; UC 10 should be done before this&#160;<br/>action.</p>
<p style="position:absolute;top:537px;left:88px;white-space:nowrap" class="ft533"><b>Postcondition</b></p>
<p style="position:absolute;top:537px;left:450px;white-space:nowrap" class="ft537">Initialized platform&#160;can be used to&#160;log on&#160;<br/>into&#160;the remote server.</p>
<p style="position:absolute;top:583px;left:88px;white-space:nowrap" class="ft533"><b>Normal&#160;Flow</b></p>
<p style="position:absolute;top:583px;left:477px;white-space:nowrap" class="ft534">1.&#160;The authorized administrator&#160;</p>
<p style="position:absolute;top:603px;left:504px;white-space:nowrap" class="ft537">invokes the initialize utility&#160;<br/>to take the TPM ownership.</p>
<p style="position:absolute;top:641px;left:477px;white-space:nowrap" class="ft534">2.&#160;An AIK&#160;is created inside the local&#160;</p>
<p style="position:absolute;top:660px;left:504px;white-space:nowrap" class="ft534">repository.&#160;</p>
<p style="position:absolute;top:679px;left:477px;white-space:nowrap" class="ft534">3.&#160;A request&#160;for an AIK&#160;certificate is&#160;</p>
<p style="position:absolute;top:699px;left:504px;white-space:nowrap" class="ft537">built and sent&#160;to the OpenTC&#160;<br/>Privacy&#160;CA.</p>
<p style="position:absolute;top:737px;left:477px;white-space:nowrap" class="ft534">4.&#160;The AIK&#160;is activated&#160;and the AIK&#160;</p>
<p style="position:absolute;top:756px;left:504px;white-space:nowrap" class="ft534">certificate&#160;is being retrieved.</p>
<p style="position:absolute;top:775px;left:477px;white-space:nowrap" class="ft534">5.&#160;OpenTC Privacy&#160;CA holds&#160;the copy&#160;</p>
<p style="position:absolute;top:795px;left:504px;white-space:nowrap" class="ft537">of this&#160;certificate&#160;for the&#160;<br/>authentication&#160;purposes,&#160;and the&#160;<br/>platform&#160;as&#160;the unique identifier.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5316">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:773px;white-space:nowrap" class="ft5316">9/25</p>
</div>
<!-- Page 54 -->
<a name="54"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page54-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables054.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft5415">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft540">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft5416">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft5416">FINAL |&#160;1.00</p>
<p style="position:absolute;top:186px;left:90px;white-space:nowrap" class="ft5448"><i><b>3.2.3&#160;Platform&#160;registration</b></i></p>
<p style="position:absolute;top:240px;left:86px;white-space:nowrap" class="ft543"><b>Use&#160;case&#160;unique ID&#160;</b></p>
<p style="position:absolute;top:240px;left:454px;white-space:nowrap" class="ft544">/UC 110/</p>
<p style="position:absolute;top:267px;left:86px;white-space:nowrap" class="ft543"><b>Title</b></p>
<p style="position:absolute;top:267px;left:454px;white-space:nowrap" class="ft544">Platform&#160;registration</p>
<p style="position:absolute;top:304px;left:86px;white-space:nowrap" class="ft543"><b>Authors</b></p>
<p style="position:absolute;top:295px;left:454px;white-space:nowrap" class="ft547">Irina&#160;Beliakova,&#160;Vladimir&#160;Bashmakov&#160;<br/>(INTEK)&#160;&#160;</p>
<p style="position:absolute;top:341px;left:86px;white-space:nowrap" class="ft543"><b>Use&#160;case&#160;revision number</b></p>
<p style="position:absolute;top:341px;left:454px;white-space:nowrap" class="ft544">01</p>
<p style="position:absolute;top:369px;left:86px;white-space:nowrap" class="ft543"><b>Use&#160;case&#160;revision date</b></p>
<p style="position:absolute;top:369px;left:454px;white-space:nowrap" class="ft544">2006-01-16</p>
<p style="position:absolute;top:406px;left:86px;white-space:nowrap" class="ft543"><b>Short&#160;description/purpose(s)</b></p>
<p style="position:absolute;top:396px;left:454px;white-space:nowrap" class="ft547">The administrator&#160;registers&#160;the TPM-<br/>equipped platform&#160;with remote&#160;server.&#160;</p>
<p style="position:absolute;top:462px;left:86px;white-space:nowrap" class="ft543"><b>Rationale</b></p>
<p style="position:absolute;top:443px;left:454px;white-space:nowrap" class="ft547">In a&#160;physically&#160;separated&#160;environment&#160;<br/>this is similar&#160;to registering a&#160;computing&#160;<br/>platform&#160;from a&#160;network.</p>
<p style="position:absolute;top:509px;left:86px;white-space:nowrap" class="ft543"><b>Roles</b></p>
<p style="position:absolute;top:509px;left:454px;white-space:nowrap" class="ft544">Administrator&#160;(client/server)&#160;&#160;</p>
<p style="position:absolute;top:537px;left:86px;white-space:nowrap" class="ft543"><b>Preconditions</b></p>
<p style="position:absolute;top:537px;left:454px;white-space:nowrap" class="ft544">UC 100 should be done before this&#160;action</p>
<p style="position:absolute;top:574px;left:86px;white-space:nowrap" class="ft543"><b>Postcondition</b></p>
<p style="position:absolute;top:564px;left:454px;white-space:nowrap" class="ft547">User from&#160;the client trusted&#160;platform&#160;can&#160;<br/>remote&#160;log on to&#160;the server&#160;</p>
<p style="position:absolute;top:678px;left:86px;white-space:nowrap" class="ft543"><b>Normal Flow</b></p>
<p style="position:absolute;top:611px;left:481px;white-space:nowrap" class="ft544">&#160;1.&#160;The administrator&#160;invokes&#160;the&#160;</p>
<p style="position:absolute;top:630px;left:508px;white-space:nowrap" class="ft544">platform&#160;registration&#160;utility.&#160;</p>
<p style="position:absolute;top:649px;left:481px;white-space:nowrap" class="ft544">&#160;2.&#160;The system&#160;authenticates&#160;the&#160;</p>
<p style="position:absolute;top:668px;left:508px;white-space:nowrap" class="ft544">administrator.</p>
<p style="position:absolute;top:688px;left:481px;white-space:nowrap" class="ft544">&#160;3.&#160;The administrator&#160;selects&#160;the&#160;</p>
<p style="position:absolute;top:707px;left:508px;white-space:nowrap" class="ft544">server&#160;to register&#160;to.</p>
<p style="position:absolute;top:726px;left:481px;white-space:nowrap" class="ft544">&#160;4.&#160;The system&#160;registers&#160;the TPM&#160;</p>
<p style="position:absolute;top:745px;left:508px;white-space:nowrap" class="ft547">platform&#160;credentials,&#160;created in&#160;UC&#160;<br/>100, with selected remote server.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5416">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft5416">10/25</p>
</div>
<!-- Page 55 -->
<a name="55"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page55-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables055.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft5515">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft550">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft5516">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft5516">FINAL |&#160;1.00</p>
<p style="position:absolute;top:186px;left:90px;white-space:nowrap" class="ft5548"><i><b>3.2.4&#160;Platform&#160;unregistration</b></i></p>
<p style="position:absolute;top:249px;left:86px;white-space:nowrap" class="ft553"><b>Use&#160;case&#160;unique ID&#160;</b></p>
<p style="position:absolute;top:249px;left:454px;white-space:nowrap" class="ft554">/UC 120/</p>
<p style="position:absolute;top:276px;left:86px;white-space:nowrap" class="ft553"><b>Title</b></p>
<p style="position:absolute;top:276px;left:454px;white-space:nowrap" class="ft554">Platform&#160;unregistration</p>
<p style="position:absolute;top:313px;left:86px;white-space:nowrap" class="ft553"><b>Authors</b></p>
<p style="position:absolute;top:304px;left:454px;white-space:nowrap" class="ft557">Irina&#160;Beliakova,&#160;Vladimir&#160;Bashmakov&#160;<br/>(INTEK)&#160;&#160;</p>
<p style="position:absolute;top:350px;left:86px;white-space:nowrap" class="ft553"><b>Use&#160;case&#160;revision number</b></p>
<p style="position:absolute;top:350px;left:454px;white-space:nowrap" class="ft554">01</p>
<p style="position:absolute;top:378px;left:86px;white-space:nowrap" class="ft553"><b>Use&#160;case&#160;revision date</b></p>
<p style="position:absolute;top:378px;left:454px;white-space:nowrap" class="ft554">2006-01-16</p>
<p style="position:absolute;top:415px;left:86px;white-space:nowrap" class="ft553"><b>Short&#160;description/purpose(s)</b></p>
<p style="position:absolute;top:405px;left:454px;white-space:nowrap" class="ft557">The administrator&#160;unregisters&#160;the TPM-<br/>equipped platform&#160;with remote&#160;server.&#160;</p>
<p style="position:absolute;top:471px;left:86px;white-space:nowrap" class="ft553"><b>Rationale</b></p>
<p style="position:absolute;top:452px;left:454px;white-space:nowrap" class="ft557">In a&#160;physically&#160;separated&#160;environment&#160;<br/>this is similar&#160;to unregistering a&#160;<br/>computing platform&#160;from a&#160;network.</p>
<p style="position:absolute;top:518px;left:86px;white-space:nowrap" class="ft553"><b>Roles</b></p>
<p style="position:absolute;top:518px;left:454px;white-space:nowrap" class="ft554">Administrator&#160;(client/server)&#160;&#160;</p>
<p style="position:absolute;top:546px;left:86px;white-space:nowrap" class="ft553"><b>Preconditions</b></p>
<p style="position:absolute;top:546px;left:454px;white-space:nowrap" class="ft554">UC 110 has been done before this action</p>
<p style="position:absolute;top:592px;left:86px;white-space:nowrap" class="ft553"><b>Postcondition</b></p>
<p style="position:absolute;top:573px;left:454px;white-space:nowrap" class="ft557">User from&#160;the client trusted&#160;platform&#160;<br/>cannot&#160;remote log on anymore&#160;to the&#160;<br/>server&#160;</p>
<p style="position:absolute;top:716px;left:86px;white-space:nowrap" class="ft553"><b>Normal Flow</b></p>
<p style="position:absolute;top:639px;left:481px;white-space:nowrap" class="ft554">&#160;5.&#160;The administrator&#160;invokes&#160;the&#160;</p>
<p style="position:absolute;top:658px;left:508px;white-space:nowrap" class="ft554">platform&#160;unregistration&#160;utility.&#160;</p>
<p style="position:absolute;top:677px;left:481px;white-space:nowrap" class="ft554">&#160;6.&#160;The system&#160;authenticates&#160;the&#160;</p>
<p style="position:absolute;top:697px;left:508px;white-space:nowrap" class="ft554">administrator.</p>
<p style="position:absolute;top:716px;left:481px;white-space:nowrap" class="ft554">&#160;7.&#160;The administrator&#160;selects&#160;the&#160;</p>
<p style="position:absolute;top:735px;left:508px;white-space:nowrap" class="ft554">server&#160;to register&#160;to.</p>
<p style="position:absolute;top:754px;left:481px;white-space:nowrap" class="ft554">&#160;8.&#160;The system&#160;unregisters&#160;the TPM&#160;</p>
<p style="position:absolute;top:773px;left:508px;white-space:nowrap" class="ft557">platform&#160;credentials,&#160;registered in&#160;<br/>UC 110, with selected&#160;remote&#160;<br/>server.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5516">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft5516">11/25</p>
</div>
<!-- Page 56 -->
<a name="56"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page56-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables056.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft5615">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft560">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft5616">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft5616">FINAL |&#160;1.00</p>
<p style="position:absolute;top:186px;left:90px;white-space:nowrap" class="ft5648"><i><b>3.2.5&#160;User&#160;Registration</b></i></p>
<p style="position:absolute;top:235px;left:83px;white-space:nowrap" class="ft567">The possibility of a&#160;new user registration&#160;relies solely on the existing infrastructure&#160;on&#160;<br/>the client and remote server.&#160;The MFA&#160;system does&#160;not intend to interfere in any way&#160;<br/>the security practices&#160;existing in the infrastructure.<br/>On the server the user rights&#160;and access&#160;policy&#160;are controlled by the operational&#160;<br/>system.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5616">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft5616">12/25</p>
</div>
<!-- Page 57 -->
<a name="57"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page57-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables057.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft5715">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft570">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft5716">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft5716">FINAL |&#160;1.00</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft574">&#160;</p>
<p style="position:absolute;top:195px;left:90px;white-space:nowrap" class="ft5748"><i><b>3.2.6&#160;Client logon</b></i></p>
<p style="position:absolute;top:249px;left:88px;white-space:nowrap" class="ft573"><b>Use&#160;case unique&#160;ID</b></p>
<p style="position:absolute;top:249px;left:450px;white-space:nowrap" class="ft574">/UC 200/</p>
<p style="position:absolute;top:276px;left:88px;white-space:nowrap" class="ft573"><b>Title</b></p>
<p style="position:absolute;top:276px;left:450px;white-space:nowrap" class="ft574">Client logon</p>
<p style="position:absolute;top:304px;left:88px;white-space:nowrap" class="ft573"><b>Authors</b></p>
<p style="position:absolute;top:304px;left:450px;white-space:nowrap" class="ft577">Irina&#160;Beliakova,&#160;Vladimir&#160;Bashmakov&#160;<br/>(INTEK)&#160;</p>
<p style="position:absolute;top:350px;left:88px;white-space:nowrap" class="ft573"><b>Use&#160;case revision&#160;number</b></p>
<p style="position:absolute;top:350px;left:450px;white-space:nowrap" class="ft574">01</p>
<p style="position:absolute;top:378px;left:88px;white-space:nowrap" class="ft573"><b>Use&#160;case revision&#160;date</b></p>
<p style="position:absolute;top:378px;left:450px;white-space:nowrap" class="ft574">2006-01-16&#160;</p>
<p style="position:absolute;top:405px;left:88px;white-space:nowrap" class="ft573"><b>Short description/purpose(s)</b></p>
<p style="position:absolute;top:405px;left:450px;white-space:nowrap" class="ft574">The user wishes&#160;to use a remote service.</p>
<p style="position:absolute;top:433px;left:88px;white-space:nowrap" class="ft573"><b>Roles</b></p>
<p style="position:absolute;top:433px;left:450px;white-space:nowrap" class="ft574">User</p>
<p style="position:absolute;top:460px;left:88px;white-space:nowrap" class="ft573"><b>Includes</b></p>
<p style="position:absolute;top:460px;left:450px;white-space:nowrap" class="ft574">/UC 220/ User&#160;Authentication</p>
<p style="position:absolute;top:488px;left:88px;white-space:nowrap" class="ft573"><b>Preconditions</b></p>
<p style="position:absolute;top:488px;left:477px;white-space:nowrap" class="ft574">1.&#160;The client user is going to&#160;log on&#160;</p>
<p style="position:absolute;top:507px;left:504px;white-space:nowrap" class="ft577">from&#160;the client&#160;computer already&#160;<br/>registered.</p>
<p style="position:absolute;top:546px;left:477px;white-space:nowrap" class="ft574">2.&#160;/UC 400/ should be done before this&#160;</p>
<p style="position:absolute;top:565px;left:504px;white-space:nowrap" class="ft574">action</p>
<p style="position:absolute;top:592px;left:88px;white-space:nowrap" class="ft573"><b>Normal&#160;Flow</b></p>
<p style="position:absolute;top:592px;left:477px;white-space:nowrap" class="ft574">1.&#160;The user</p>
<p style="position:absolute;top:592px;left:576px;white-space:nowrap" class="ft573"><b>&#160;</b></p>
<p style="position:absolute;top:592px;left:582px;white-space:nowrap" class="ft574">notifies the local system&#160;</p>
<p style="position:absolute;top:612px;left:504px;white-space:nowrap" class="ft577">(client) that&#160;s/he wishes to&#160;use a&#160;<br/>service running in&#160;a&#160;remote&#160;<br/>computer.</p>
<p style="position:absolute;top:669px;left:477px;white-space:nowrap" class="ft574">2.&#160;The user enters&#160;the user name and&#160;</p>
<p style="position:absolute;top:688px;left:504px;white-space:nowrap" class="ft577">name or&#160;address&#160;of the remote&#160;<br/>server&#160;running the wanted service.</p>
<p style="position:absolute;top:727px;left:477px;white-space:nowrap" class="ft574">3.&#160;According to&#160;the security&#160;policy the&#160;</p>
<p style="position:absolute;top:746px;left:504px;white-space:nowrap" class="ft577">remote&#160;system authenticates&#160;the&#160;<br/>user (see /UC 220/).</p>
<p style="position:absolute;top:784px;left:477px;white-space:nowrap" class="ft574">4.&#160;A&#160;session with the remote service is&#160;</p>
<p style="position:absolute;top:804px;left:504px;white-space:nowrap" class="ft574">started.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5716">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft5716">13/25</p>
</div>
<!-- Page 58 -->
<a name="58"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page58-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables058.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft5815">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft580">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft5816">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft5816">FINAL |&#160;1.00</p>
<p style="position:absolute;top:186px;left:90px;white-space:nowrap" class="ft5848"><i><b>3.2.7&#160;Client logoff</b></i></p>
<p style="position:absolute;top:240px;left:88px;white-space:nowrap" class="ft583"><b>Use&#160;case unique&#160;ID</b></p>
<p style="position:absolute;top:240px;left:450px;white-space:nowrap" class="ft584">/UC 210/</p>
<p style="position:absolute;top:267px;left:88px;white-space:nowrap" class="ft583"><b>Title</b></p>
<p style="position:absolute;top:267px;left:450px;white-space:nowrap" class="ft584">Client logoff</p>
<p style="position:absolute;top:295px;left:88px;white-space:nowrap" class="ft583"><b>Authors</b></p>
<p style="position:absolute;top:295px;left:450px;white-space:nowrap" class="ft584">Irina Beliakova, Vladimir Bashmakov</p>
<p style="position:absolute;top:322px;left:88px;white-space:nowrap" class="ft583"><b>Use&#160;case revision&#160;number</b></p>
<p style="position:absolute;top:322px;left:450px;white-space:nowrap" class="ft584">01</p>
<p style="position:absolute;top:350px;left:88px;white-space:nowrap" class="ft583"><b>Use&#160;case revision&#160;date</b></p>
<p style="position:absolute;top:350px;left:450px;white-space:nowrap" class="ft584">2006-01-16&#160;</p>
<p style="position:absolute;top:377px;left:88px;white-space:nowrap" class="ft583"><b>Short description/purpose(s)</b></p>
<p style="position:absolute;top:377px;left:450px;white-space:nowrap" class="ft587">The user wishes to&#160;end current working&#160;<br/>session with the remote server.</p>
<p style="position:absolute;top:424px;left:88px;white-space:nowrap" class="ft583"><b>Roles</b></p>
<p style="position:absolute;top:424px;left:450px;white-space:nowrap" class="ft584">User</p>
<p style="position:absolute;top:451px;left:88px;white-space:nowrap" class="ft583"><b>Includes</b></p>
<p style="position:absolute;top:451px;left:450px;white-space:nowrap" class="ft584">(none)</p>
<p style="position:absolute;top:479px;left:88px;white-space:nowrap" class="ft583"><b>Preconditions</b></p>
<p style="position:absolute;top:479px;left:450px;white-space:nowrap" class="ft587">The user has&#160;already started&#160;a session&#160;<br/>with the server (see /UC 200/).</p>
<p style="position:absolute;top:526px;left:88px;white-space:nowrap" class="ft583"><b>Postcondition</b></p>
<p style="position:absolute;top:526px;left:450px;white-space:nowrap" class="ft587">The user cannot&#160;use the server anymore&#160;<br/>without&#160;performing a new logon session.</p>
<p style="position:absolute;top:572px;left:88px;white-space:nowrap" class="ft583"><b>Normal&#160;Flow</b></p>
<p style="position:absolute;top:572px;left:477px;white-space:nowrap" class="ft584">1.&#160;The user notifies&#160;the local&#160;system&#160;</p>
<p style="position:absolute;top:592px;left:504px;white-space:nowrap" class="ft587">(client) that s/he wishes to end a&#160;<br/>session.</p>
<p style="position:absolute;top:630px;left:477px;white-space:nowrap" class="ft584">2.&#160;The user will be disconnected&#160;from&#160;</p>
<p style="position:absolute;top:649px;left:504px;white-space:nowrap" class="ft584">the server.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5816">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft5816">14/25</p>
</div>
<!-- Page 59 -->
<a name="59"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page59-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables059.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft5915">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft590">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft5916">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft5916">FINAL |&#160;1.00</p>
<p style="position:absolute;top:186px;left:90px;white-space:nowrap" class="ft5948"><i><b>3.2.8&#160;User/platform&#160;authentication</b></i></p>
<p style="position:absolute;top:240px;left:88px;white-space:nowrap" class="ft593"><b>Use&#160;case unique&#160;ID (per WP&#160;or SWP)&#160;</b></p>
<p style="position:absolute;top:240px;left:450px;white-space:nowrap" class="ft594">/UC 220/</p>
<p style="position:absolute;top:267px;left:88px;white-space:nowrap" class="ft593"><b>Title</b></p>
<p style="position:absolute;top:267px;left:450px;white-space:nowrap" class="ft594">User/platform&#160;authentication</p>
<p style="position:absolute;top:304px;left:88px;white-space:nowrap" class="ft593"><b>Authors</b></p>
<p style="position:absolute;top:295px;left:450px;white-space:nowrap" class="ft597">Irina Beliakova. Vladimir Bashmakov&#160;<br/>(INTEK)</p>
<p style="position:absolute;top:341px;left:88px;white-space:nowrap" class="ft593"><b>Use&#160;case revision&#160;number</b></p>
<p style="position:absolute;top:341px;left:450px;white-space:nowrap" class="ft594">01</p>
<p style="position:absolute;top:369px;left:88px;white-space:nowrap" class="ft593"><b>Use&#160;case revision&#160;date</b></p>
<p style="position:absolute;top:369px;left:450px;white-space:nowrap" class="ft594">2006-01-16&#160;</p>
<p style="position:absolute;top:425px;left:88px;white-space:nowrap" class="ft593"><b>Short description/purpose(s)</b></p>
<p style="position:absolute;top:396px;left:450px;white-space:nowrap" class="ft597">The client&#160;asks the remote server to&#160;<br/>authenticate&#160;the user/TPM-equipped&#160;<br/>platform&#160;according to&#160;the policy set for&#160;<br/>the user</p>
<p style="position:absolute;top:481px;left:88px;white-space:nowrap" class="ft593"><b>Roles</b></p>
<p style="position:absolute;top:481px;left:450px;white-space:nowrap" class="ft594">User</p>
<p style="position:absolute;top:509px;left:88px;white-space:nowrap" class="ft593"><b>Includes</b></p>
<p style="position:absolute;top:509px;left:450px;white-space:nowrap" class="ft594">(none)</p>
<p style="position:absolute;top:546px;left:88px;white-space:nowrap" class="ft593"><b>Preconditions</b></p>
<p style="position:absolute;top:537px;left:450px;white-space:nowrap" class="ft597">/UC 400/ should be done before this&#160;<br/>action.</p>
<p style="position:absolute;top:622px;left:88px;white-space:nowrap" class="ft593"><b>Normal&#160;Flow</b></p>
<p style="position:absolute;top:583px;left:477px;white-space:nowrap" class="ft594">1.&#160;The system&#160;asks&#160;the user for&#160;</p>
<p style="position:absolute;top:603px;left:504px;white-space:nowrap" class="ft594">authentication&#160;data.</p>
<p style="position:absolute;top:622px;left:477px;white-space:nowrap" class="ft597">2.&#160;The user enters data.<br/>3.&#160;The remote&#160;system authenticates&#160;</p>
<p style="position:absolute;top:660px;left:504px;white-space:nowrap" class="ft597">the user and TPM-equipped&#160;<br/>platform.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft5916">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft5916">15/25</p>
</div>
<!-- Page 60 -->
<a name="60"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page60-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables060.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft6015">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft600">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft6016">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft6016">FINAL |&#160;1.00</p>
<p style="position:absolute;top:186px;left:90px;white-space:nowrap" class="ft6048"><i><b>3.2.9&#160;Using&#160;a&#160;remote server&#160;secure application/service</b></i></p>
<p style="position:absolute;top:220px;left:88px;white-space:nowrap" class="ft603"><b>Use&#160;case unique&#160;ID</b></p>
<p style="position:absolute;top:220px;left:450px;white-space:nowrap" class="ft604">/UC 300/</p>
<p style="position:absolute;top:248px;left:88px;white-space:nowrap" class="ft603"><b>Title</b></p>
<p style="position:absolute;top:248px;left:450px;white-space:nowrap" class="ft607">Using a remote server&#160;secure&#160;<br/>application/service</p>
<p style="position:absolute;top:295px;left:88px;white-space:nowrap" class="ft603"><b>Authors</b></p>
<p style="position:absolute;top:295px;left:450px;white-space:nowrap" class="ft607">Irina Beliakova, Vladimir Bashmakov&#160;<br/>(INTEK)&#160;</p>
<p style="position:absolute;top:341px;left:88px;white-space:nowrap" class="ft603"><b>Use&#160;case revision&#160;number</b></p>
<p style="position:absolute;top:341px;left:450px;white-space:nowrap" class="ft604">01</p>
<p style="position:absolute;top:369px;left:88px;white-space:nowrap" class="ft603"><b>Use&#160;case revision&#160;date</b></p>
<p style="position:absolute;top:369px;left:450px;white-space:nowrap" class="ft604">2006-01-16&#160;</p>
<p style="position:absolute;top:396px;left:88px;white-space:nowrap" class="ft603"><b>Short description/purpose(s)</b></p>
<p style="position:absolute;top:396px;left:450px;white-space:nowrap" class="ft607">The user starts&#160;a session&#160;with the remote&#160;<br/>secure application/service</p>
<p style="position:absolute;top:443px;left:88px;white-space:nowrap" class="ft603"><b>Roles</b></p>
<p style="position:absolute;top:443px;left:450px;white-space:nowrap" class="ft604">User</p>
<p style="position:absolute;top:471px;left:88px;white-space:nowrap" class="ft603"><b>Includes</b></p>
<p style="position:absolute;top:471px;left:450px;white-space:nowrap" class="ft607">/UC 200/ Client logon&#160;<br/>/UC 210/ Client logoff</p>
<p style="position:absolute;top:517px;left:88px;white-space:nowrap" class="ft603"><b>Preconditions</b></p>
<p style="position:absolute;top:517px;left:477px;white-space:nowrap" class="ft604">1.&#160;/UC 110/ should be done before this&#160;</p>
<p style="position:absolute;top:537px;left:504px;white-space:nowrap" class="ft604">action.</p>
<p style="position:absolute;top:556px;left:477px;white-space:nowrap" class="ft604">2.&#160;/UC 400/ should be done before this&#160;</p>
<p style="position:absolute;top:575px;left:504px;white-space:nowrap" class="ft604">action.</p>
<p style="position:absolute;top:603px;left:88px;white-space:nowrap" class="ft603"><b>Normal&#160;Flow</b></p>
<p style="position:absolute;top:603px;left:477px;white-space:nowrap" class="ft604">1.&#160;The user notifies&#160;the system&#160;that&#160;</p>
<p style="position:absolute;top:622px;left:504px;white-space:nowrap" class="ft604">s/he wishes to&#160;start&#160;a&#160;logon session.</p>
<p style="position:absolute;top:641px;left:477px;white-space:nowrap" class="ft604">2.&#160;The system&#160;opens a new logon to&#160;</p>
<p style="position:absolute;top:660px;left:504px;white-space:nowrap" class="ft604">application&#160;session (see /UC 200/).</p>
<p style="position:absolute;top:679px;left:477px;white-space:nowrap" class="ft607">3.&#160;The user works&#160;with the application&#160;<br/>4.&#160;The user closes&#160;the application&#160;</p>
<p style="position:absolute;top:718px;left:504px;white-space:nowrap" class="ft604">session (see /UC 210/).</p>
<p style="position:absolute;top:737px;left:477px;white-space:nowrap" class="ft604">5.&#160;The user-interface&#160;of the&#160;</p>
<p style="position:absolute;top:756px;left:504px;white-space:nowrap" class="ft604">application&#160;disappears.&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6016">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6016">16/25</p>
</div>
<!-- Page 61 -->
<a name="61"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page61-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables061.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft6115">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft610">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft6116">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft6116">FINAL |&#160;1.00</p>
<p style="position:absolute;top:186px;left:90px;white-space:nowrap" class="ft6148"><i><b>3.2.10&#160;Server&#160;policy&#160;configuration</b></i></p>
<p style="position:absolute;top:240px;left:88px;white-space:nowrap" class="ft613"><b>Use&#160;case unique&#160;ID&#160;</b></p>
<p style="position:absolute;top:240px;left:450px;white-space:nowrap" class="ft614">/UC 400/</p>
<p style="position:absolute;top:267px;left:88px;white-space:nowrap" class="ft613"><b>Title</b></p>
<p style="position:absolute;top:267px;left:450px;white-space:nowrap" class="ft614">Server&#160;policy configuration</p>
<p style="position:absolute;top:295px;left:88px;white-space:nowrap" class="ft613"><b>Authors</b></p>
<p style="position:absolute;top:295px;left:450px;white-space:nowrap" class="ft617">Irina Beliakova, Vladimir Bashmakov&#160;<br/>(INTEK)&#160;</p>
<p style="position:absolute;top:341px;left:88px;white-space:nowrap" class="ft613"><b>Use&#160;case revision&#160;number</b></p>
<p style="position:absolute;top:341px;left:450px;white-space:nowrap" class="ft614">01</p>
<p style="position:absolute;top:369px;left:88px;white-space:nowrap" class="ft613"><b>Use&#160;case revision&#160;date</b></p>
<p style="position:absolute;top:369px;left:450px;white-space:nowrap" class="ft614">2006-01-16</p>
<p style="position:absolute;top:396px;left:88px;white-space:nowrap" class="ft613"><b>Short description/purpose(s)</b></p>
<p style="position:absolute;top:396px;left:450px;white-space:nowrap" class="ft617">The administrator&#160;starts&#160;the utility to&#160;<br/>configure the user logon and policy&#160;<br/>setting.</p>
<p style="position:absolute;top:462px;left:88px;white-space:nowrap" class="ft613"><b>Roles</b></p>
<p style="position:absolute;top:462px;left:450px;white-space:nowrap" class="ft614">Administrator</p>
<p style="position:absolute;top:490px;left:88px;white-space:nowrap" class="ft613"><b>Preconditions</b></p>
<p style="position:absolute;top:490px;left:450px;white-space:nowrap" class="ft617">/UC 10/ and /UC 100/ should be done&#160;<br/>before this action.</p>
<p style="position:absolute;top:537px;left:88px;white-space:nowrap" class="ft613"><b>Postcondition</b></p>
<p style="position:absolute;top:537px;left:450px;white-space:nowrap" class="ft617">The user from&#160;the trusted&#160;client can&#160;log on&#160;<br/>to the remote server using the TPM-<br/>equipped platform&#160;identity .&#160;</p>
<p style="position:absolute;top:603px;left:88px;white-space:nowrap" class="ft613"><b>Normal&#160;Flow</b></p>
<p style="position:absolute;top:603px;left:477px;white-space:nowrap" class="ft614">1.&#160;The authorized administrator&#160;</p>
<p style="position:absolute;top:622px;left:504px;white-space:nowrap" class="ft617">invokes the Credential and Policy&#160;<br/>manager to&#160;set access&#160;right for&#160;<br/>logon for list&#160;of users.</p>
<p style="position:absolute;top:679px;left:477px;white-space:nowrap" class="ft614">2.&#160;The administrator&#160;set the policy&#160;</p>
<p style="position:absolute;top:699px;left:504px;white-space:nowrap" class="ft617">allow&#160;to log on by verifying the user&#160;<br/>password&#160;or&#160;/ and &#160;TPM-equipped&#160;<br/>platform&#160;identity.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6116">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6116">17/25</p>
</div>
<!-- Page 62 -->
<a name="62"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page62-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables062.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft6215">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft620">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft6216">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft6216">FINAL |&#160;1.00</p>
<p style="position:absolute;top:186px;left:90px;white-space:nowrap" class="ft6248"><i><b>3.2.11&#160;Platform registration&#160;on the server</b></i></p>
<p style="position:absolute;top:220px;left:90px;white-space:nowrap" class="ft623"><b>Use&#160;case unique&#160;ID&#160;</b></p>
<p style="position:absolute;top:220px;left:458px;white-space:nowrap" class="ft624">/UC 410/</p>
<p style="position:absolute;top:248px;left:90px;white-space:nowrap" class="ft623"><b>Title</b></p>
<p style="position:absolute;top:248px;left:458px;white-space:nowrap" class="ft624">Platform&#160;registration&#160;on the server</p>
<p style="position:absolute;top:285px;left:90px;white-space:nowrap" class="ft623"><b>Authors</b></p>
<p style="position:absolute;top:275px;left:458px;white-space:nowrap" class="ft627">Irina&#160;Beliakova,&#160;Vladimir&#160;Bashmakov&#160;<br/>(INTEK)&#160;&#160;</p>
<p style="position:absolute;top:322px;left:90px;white-space:nowrap" class="ft623"><b>Use&#160;case revision&#160;number</b></p>
<p style="position:absolute;top:322px;left:458px;white-space:nowrap" class="ft624">01</p>
<p style="position:absolute;top:350px;left:90px;white-space:nowrap" class="ft623"><b>Use&#160;case revision&#160;date</b></p>
<p style="position:absolute;top:350px;left:458px;white-space:nowrap" class="ft624">2006-01-16</p>
<p style="position:absolute;top:406px;left:90px;white-space:nowrap" class="ft623"><b>Short description/purpose(s)</b></p>
<p style="position:absolute;top:377px;left:458px;white-space:nowrap" class="ft627">The server registers&#160;the TPM-equipped&#160;<br/>platform.&#160;The server&#160;accepts&#160;the TPM&#160;<br/>credentials from&#160;clients and saves&#160;them&#160;<br/>in the Master&#160;Repository.</p>
<p style="position:absolute;top:481px;left:90px;white-space:nowrap" class="ft623"><b>Rationale</b></p>
<p style="position:absolute;top:462px;left:458px;white-space:nowrap" class="ft627">In a&#160;physically&#160;separated&#160;environment,&#160;<br/>this is similar&#160;to registering a&#160;computing&#160;<br/>platform&#160;from a&#160;network.</p>
<p style="position:absolute;top:528px;left:90px;white-space:nowrap" class="ft623"><b>Roles</b></p>
<p style="position:absolute;top:528px;left:458px;white-space:nowrap" class="ft624">Administrator&#160;&#160;</p>
<p style="position:absolute;top:556px;left:90px;white-space:nowrap" class="ft623"><b>Preconditions</b></p>
<p style="position:absolute;top:556px;left:458px;white-space:nowrap" class="ft624">/UC 100/ should be done before</p>
<p style="position:absolute;top:593px;left:90px;white-space:nowrap" class="ft623"><b>Postcondition</b></p>
<p style="position:absolute;top:583px;left:458px;white-space:nowrap" class="ft627">Server can&#160;be used for remote &#160;MFA&#160;<br/>access.</p>
<p style="position:absolute;top:678px;left:90px;white-space:nowrap" class="ft623"><b>Normal&#160;Flow</b></p>
<p style="position:absolute;top:630px;left:485px;white-space:nowrap" class="ft627">1.&#160;This use case&#160;is triggered /UC 110/<br/>2.&#160;The server invokes&#160;the register&#160;</p>
<p style="position:absolute;top:668px;left:512px;white-space:nowrap" class="ft624">service.</p>
<p style="position:absolute;top:688px;left:485px;white-space:nowrap" class="ft624">3.&#160;The system&#160;authenticates&#160;the&#160;</p>
<p style="position:absolute;top:707px;left:512px;white-space:nowrap" class="ft624">administrator.</p>
<p style="position:absolute;top:726px;left:485px;white-space:nowrap" class="ft624">4.&#160;The register&#160;service saves&#160;TPM&#160;</p>
<p style="position:absolute;top:745px;left:512px;white-space:nowrap" class="ft624">credential in Master&#160;Repository.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6216">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6216">18/25</p>
</div>
<!-- Page 63 -->
<a name="63"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft6349{font-size:17px;font-family:DAAAAA+BitstreamVeraSans;color:#00ae00;}
-->
</style>
<div id="page63-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables063.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft6315">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft630">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft6316">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft6316">FINAL |&#160;1.00</p>
<p style="position:absolute;top:186px;left:90px;white-space:nowrap" class="ft6348"><i><b>3.2.12&#160;Server&#160;logon&#160;session</b></i></p>
<p style="position:absolute;top:240px;left:88px;white-space:nowrap" class="ft633"><b>Use&#160;case unique&#160;ID</b></p>
<p style="position:absolute;top:240px;left:450px;white-space:nowrap" class="ft634">/UC 510/</p>
<p style="position:absolute;top:267px;left:88px;white-space:nowrap" class="ft633"><b>Title</b></p>
<p style="position:absolute;top:267px;left:450px;white-space:nowrap" class="ft634">Server logon session&#160;</p>
<p style="position:absolute;top:304px;left:88px;white-space:nowrap" class="ft633"><b>Authors</b></p>
<p style="position:absolute;top:295px;left:450px;white-space:nowrap" class="ft637">Irina&#160;Beliakova,&#160;Vladimir&#160;Bashmakov&#160;<br/>(INTEK)&#160;</p>
<p style="position:absolute;top:341px;left:88px;white-space:nowrap" class="ft633"><b>Use&#160;case revision&#160;number</b></p>
<p style="position:absolute;top:341px;left:450px;white-space:nowrap" class="ft634">01</p>
<p style="position:absolute;top:369px;left:88px;white-space:nowrap" class="ft633"><b>Use&#160;case revision&#160;date</b></p>
<p style="position:absolute;top:369px;left:450px;white-space:nowrap" class="ft634">2006-01-16&#160;</p>
<p style="position:absolute;top:416px;left:88px;white-space:nowrap" class="ft633"><b>Short description/purpose(s)</b></p>
<p style="position:absolute;top:396px;left:450px;white-space:nowrap" class="ft637">After TPM&#160;client logon is successful the&#160;<br/>user have access&#160;to remote&#160;server&#160;<br/>resources&#160;according user permissions</p>
<p style="position:absolute;top:462px;left:88px;white-space:nowrap" class="ft633"><b>Roles</b></p>
<p style="position:absolute;top:462px;left:450px;white-space:nowrap" class="ft634">User</p>
<p style="position:absolute;top:490px;left:88px;white-space:nowrap" class="ft633"><b>Includes</b></p>
<p style="position:absolute;top:546px;left:88px;white-space:nowrap" class="ft633"><b>Preconditions</b></p>
<p style="position:absolute;top:517px;left:450px;white-space:nowrap" class="ft637">The client user is going to&#160;logon from &#160;the&#160;<br/>computer&#160;already registered</p>
<p style="position:absolute;top:537px;left:687px;white-space:nowrap" class="ft6349">.</p>
<p style="position:absolute;top:556px;left:477px;white-space:nowrap" class="ft637">1.&#160;/UC 110/ should be done before&#160;.<br/>2.&#160;/UC 400/ should be done before&#160;</p>
<p style="position:absolute;top:641px;left:88px;white-space:nowrap" class="ft633"><b>Normal&#160;Flow</b></p>
<p style="position:absolute;top:603px;left:477px;white-space:nowrap" class="ft637">1.&#160;Server user logon session starts&#160;<br/>2.&#160;Authentication&#160;server requests the&#160;</p>
<p style="position:absolute;top:641px;left:504px;white-space:nowrap" class="ft634">user, TPM&#160;credentials.&#160;</p>
<p style="position:absolute;top:660px;left:477px;white-space:nowrap" class="ft634">3.&#160;According to&#160;the security&#160;policy the&#160;</p>
<p style="position:absolute;top:679px;left:504px;white-space:nowrap" class="ft637">remote&#160;system authenticates&#160;the&#160;<br/>user and TPM&#160;platform&#160;(see /UC&#160;<br/>320/).</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6316">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6316">19/25</p>
</div>
<!-- Page 64 -->
<a name="64"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page64-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables064.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft6415">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft640">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft6416">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft6416">FINAL |&#160;1.00</p>
<p style="position:absolute;top:167px;left:83px;white-space:nowrap" class="ft6410"><b>4&#160;&#160;High level design</b></p>
<p style="position:absolute;top:200px;left:83px;white-space:nowrap" class="ft647">The design and implementation&#160;of the MFA&#160;system&#160;has a goal&#160;to prevent&#160;the listed&#160;<br/>threat&#160;by using as&#160;countermeasure technique the TPM-equipped platform&#160;identity for&#160;<br/>trusted remote&#160;access&#160;to&#160;server.<br/>The multifactor&#160;authentication,&#160;including both user and platform&#160;authentication, covers&#160;<br/>up most&#160;of these threats.&#160;The access&#160;to the network&#160;is granted only if&#160;both&#160;elements&#160;-&#160;<br/>user and platform&#160;-&#160;are&#160;successfully authenticated.<br/>Multifactor&#160;authentication&#160;to remote server&#160;should include components&#160;executed at&#160;<br/>server&#160;and client computers.&#160;Client components&#160;register the trusted platform&#160;with the&#160;<br/>remote&#160;server. Client components&#160;use the TSS at&#160;interface&#160;to the local TPM.&#160;A user can&#160;<br/>login to&#160;a remote&#160;server once the platform&#160;registration&#160;is completed.<br/>The parameters&#160;of multifactor&#160;authentication&#160;system&#160;should be controlled by&#160;<br/>authentication policies&#160;configured on the remote platform.</p>
<p style="position:absolute;top:485px;left:83px;white-space:nowrap" class="ft6447"><i><b>4.1&#160;Client&#160;operations</b></i></p>
<p style="position:absolute;top:516px;left:110px;white-space:nowrap" class="ft644">1.</p>
<p style="position:absolute;top:516px;left:137px;white-space:nowrap" class="ft6445"><i>Platform&#160;registration&#160;with the remote server.</i></p>
<p style="position:absolute;top:535px;left:137px;white-space:nowrap" class="ft647">An existing user with administrative&#160;rights&#160;can register the platform&#160;<br/>authentication information,&#160;namely the AIK and PCR's.<br/>The AIK&#160;is created inside the local&#160;TPM, the AIK&#160;certificate&#160;request&#160;is built and&#160;<br/>sent to&#160;the Open_TC Privacy&#160;CA. PCRs&#160;are&#160;extended during the bootstrap&#160;with&#160;<br/>the integrity measurements client&#160;computer software.&#160;The credentials are&#160;saved&#160;<br/>on the remote server.</p>
<p style="position:absolute;top:660px;left:110px;white-space:nowrap" class="ft6445"><i>2.&#160;Standard&#160;user registration&#160;with remote server using the preexisting&#160;</i></p>
<p style="position:absolute;top:679px;left:137px;white-space:nowrap" class="ft6445"><i>infrastructure.</i></p>
<p style="position:absolute;top:707px;left:110px;white-space:nowrap" class="ft644">3.</p>
<p style="position:absolute;top:707px;left:137px;white-space:nowrap" class="ft6445"><i>Logon&#160;to the remote server.</i></p>
<p style="position:absolute;top:726px;left:137px;white-space:nowrap" class="ft647">The Logon Application&#160;(LAP)&#160;establishes&#160;secure communication&#160;channel with a&#160;<br/>remote&#160;server using OpenSSL or other&#160;secure channel. The LAP&#160;then retrieves&#160;<br/>the TPM Platform&#160;Configuration&#160;Registers&#160;(PCRs)&#160;values, platform&#160;AIK,&#160;and&#160;<br/>collects&#160;the User Identity (UI).&#160;PCRs&#160;and Challenge are signed with the platform&#160;<br/>AIK&#160;to&#160;ensure the information&#160;security. This authentication&#160;information&#160;is being&#160;<br/>sent to&#160;the remote&#160;server for authentication.</p>
<p style="position:absolute;top:861px;left:137px;white-space:nowrap" class="ft647">The server queries the Open_TC Privacy&#160;Certificate Authority&#160;(CA) to certify the&#160;<br/>platform&#160;AIK.&#160;Then it verifies&#160;TPM PCRs.&#160;If both steps&#160;succeed, the server&#160;<br/>proceeds&#160;with user authentication,&#160;which relies on the existing authentication&#160;<br/>infrastructure&#160;and is out of the scope of this scenario.</p>
<p style="position:absolute;top:964px;left:83px;white-space:nowrap" class="ft6447"><i><b>4.2&#160;Server functionality</b></i></p>
<p style="position:absolute;top:996px;left:110px;white-space:nowrap" class="ft644">1.</p>
<p style="position:absolute;top:996px;left:137px;white-space:nowrap" class="ft6445"><i>Register the platform&#160;and store&#160;platform&#160;information.</i></p>
<p style="position:absolute;top:1015px;left:137px;white-space:nowrap" class="ft647">The server supports&#160;the platform&#160;registration.&#160;This procedure involves&#160;<br/>registering platform&#160;AIK&#160;certificate&#160;and PCR's.</p>
<p style="position:absolute;top:1073px;left:110px;white-space:nowrap" class="ft644">2.</p>
<p style="position:absolute;top:1073px;left:137px;white-space:nowrap" class="ft6445"><i>Register the user and store&#160;user&#160;information.</i></p>
<p style="position:absolute;top:1092px;left:137px;white-space:nowrap" class="ft647">The server can&#160;verify user credentials. This&#160;basically relies on the existing&#160;<br/>authentication infrastructure.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6416">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6416">20/25</p>
</div>
<!-- Page 65 -->
<a name="65"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page65-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables065.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft6515">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft650">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft6516">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft6516">FINAL |&#160;1.00</p>
<p style="position:absolute;top:168px;left:110px;white-space:nowrap" class="ft654">3.</p>
<p style="position:absolute;top:168px;left:137px;white-space:nowrap" class="ft6545"><i>Edit user/platform&#160;policy&#160;for multifactor&#160;access.</i></p>
<p style="position:absolute;top:188px;left:137px;white-space:nowrap" class="ft657">The system&#160;administrator&#160;can&#160;change the user policies on&#160;the server to&#160;<br/>determine the required credentials in order to log on to&#160;the server.</p>
<p style="position:absolute;top:245px;left:110px;white-space:nowrap" class="ft654">4.</p>
<p style="position:absolute;top:245px;left:137px;white-space:nowrap" class="ft6545"><i>Enforce&#160;policy&#160;for server&#160;access.</i></p>
<p style="position:absolute;top:264px;left:137px;white-space:nowrap" class="ft657">The server can&#160;verify user credentials with defined policy set&#160;and reject logon if&#160;<br/>the multifactor&#160;authentication&#160;fails.</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6516">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6516">21/25</p>
</div>
<!-- Page 66 -->
<a name="66"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft6650{font-size:17px;font-family:HAAAAA+BitstreamVeraSans;color:#000000;}
	.ft6651{font-size:15px;font-family:FAAAAA+BitstreamVeraSans;color:#000000;}
	.ft6652{font-size:21px;font-family:IAAAAA+ArialMT;color:#000000;}
	.ft6653{font-size:24px;font-family:IAAAAA+ArialMT;color:#000000;}
	.ft6654{font-size:16px;font-family:JAAAAA+Arial;color:#000000;}
	.ft6655{font-size:14px;font-family:JAAAAA+Arial;color:#000000;}
	.ft6656{font-size:14px;font-family:IAAAAA+ArialMT;color:#000000;}
-->
</style>
<div id="page66-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables066.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft6615">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft660">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft6616">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft6616">FINAL |&#160;1.00</p>
<p style="position:absolute;top:186px;left:83px;white-space:nowrap" class="ft6647"><i><b>4.3&#160; MFA&#160;system&#160;architecture</b></i></p>
<p style="position:absolute;top:891px;left:83px;white-space:nowrap" class="ft664">A&#160;preliminary&#160;MFA system&#160;architecture&#160;is depicted&#160;in figure 1&#160;and the&#160;components&#160;are:&#160;</p>
<p style="position:absolute;top:922px;left:110px;white-space:nowrap" class="ft6644">●</p>
<p style="position:absolute;top:919px;left:137px;white-space:nowrap" class="ft663"><b>OpenTC&#160;&#160;&#160;framework.</b></p>
<p style="position:absolute;top:919px;left:335px;white-space:nowrap" class="ft664">&#160;</p>
<p style="position:absolute;top:919px;left:353px;white-space:nowrap" class="ft6645"><i>Open&#160;&#160;&#160;Trusted&#160;&#160;&#160;Computing&#160;&#160;&#160;framework</i></p>
<p style="position:absolute;top:919px;left:694px;white-space:nowrap" class="ft664">&#160;&#160;includes&#160;&#160;&#160;a&#160;</p>
<p style="position:absolute;top:939px;left:137px;white-space:nowrap" class="ft663"><b>virtualization&#160;&#160;&#160;layer</b></p>
<p style="position:absolute;top:939px;left:320px;white-space:nowrap" class="ft664">&#160;&#160;that&#160;&#160;&#160;is&#160;&#160;&#160;managing&#160;&#160;&#160;multiple&#160;&#160;&#160;compartments&#160;&#160;&#160;and&#160;&#160;&#160;security&#160;</p>
<p style="position:absolute;top:958px;left:137px;white-space:nowrap" class="ft664">services&#160;on the client.&#160;</p>
<p style="position:absolute;top:989px;left:110px;white-space:nowrap" class="ft6644">●</p>
<p style="position:absolute;top:986px;left:137px;white-space:nowrap" class="ft663"><b>Client.</b></p>
<p style="position:absolute;top:986px;left:198px;white-space:nowrap" class="ft664">&#160;</p>
<p style="position:absolute;top:986px;left:203px;white-space:nowrap" class="ft6645"><i>Client</i></p>
<p style="position:absolute;top:986px;left:251px;white-space:nowrap" class="ft6650"><i><b>&#160;</b></i></p>
<p style="position:absolute;top:986px;left:257px;white-space:nowrap" class="ft664">is&#160;a&#160;computer&#160;system&#160;that&#160;accesses&#160;a&#160;(remote)&#160;service&#160;on&#160;another&#160;</p>
<p style="position:absolute;top:1005px;left:137px;white-space:nowrap" class="ft667">computer&#160;by&#160;some&#160;kind of&#160;network.&#160;For&#160;everyday&#160;tasks&#160;such&#160;as&#160;word processing,&#160;<br/>surfing&#160;the&#160;Internet&#160;or&#160;image&#160;processing&#160;the&#160;user&#160;is&#160;working&#160;with&#160;his&#160;well&#160;known,&#160;<br/>general&#160;purpose&#160;operating&#160;system.&#160;This&#160;operating&#160;system&#160;could&#160;run&#160;on&#160;top&#160;of&#160;a&#160;<br/>hypervisor in parallel to&#160;other compartments&#160;and security services.</p>
<p style="position:absolute;top:1094px;left:110px;white-space:nowrap" class="ft6644">●</p>
<p style="position:absolute;top:1091px;left:137px;white-space:nowrap" class="ft663"><b>Server.</b></p>
<p style="position:absolute;top:1091px;left:205px;white-space:nowrap" class="ft664">&#160;</p>
<p style="position:absolute;top:1091px;left:211px;white-space:nowrap" class="ft6645"><i>Server&#160;</i></p>
<p style="position:absolute;top:1091px;left:271px;white-space:nowrap" class="ft664">is&#160;a&#160;computer&#160;system&#160;that&#160;provides&#160;services&#160;to&#160;other&#160;computing&#160;</p>
<p style="position:absolute;top:1111px;left:137px;white-space:nowrap" class="ft664">systems</p>
<p style="position:absolute;top:1111px;left:206px;white-space:nowrap" class="ft663"><b>&#160;</b></p>
<p style="position:absolute;top:1111px;left:212px;white-space:nowrap" class="ft664">(clients).&#160;The&#160;entity&#160;the&#160;user&#160;wants&#160;to&#160;use&#160;to&#160;do&#160;some&#160;computer&#160;works.&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6616">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6616">22/25</p>
<p style="position:absolute;top:828px;left:317px;white-space:nowrap" class="ft6651"><i>Figure&#160;1: MFA&#160;system architecture</i></p>
<p style="position:absolute;top:318px;left:154px;white-space:nowrap" class="ft6652">Trusted&#160;Compartment</p>
<p style="position:absolute;top:499px;left:170px;white-space:nowrap" class="ft6653">Client&#160;Computer</p>
<p style="position:absolute;top:265px;left:542px;white-space:nowrap" class="ft6653">Server&#160;Computer</p>
<p style="position:absolute;top:395px;left:167px;white-space:nowrap" class="ft6654"><b>MFA&#160;Logon application</b></p>
<p style="position:absolute;top:485px;left:189px;white-space:nowrap" class="ft6654"><b>VM&#160;Trusted&#160;&#160;&amp;&#160;TPM&#160;</b></p>
<p style="position:absolute;top:504px;left:210px;white-space:nowrap" class="ft6654"><b>management</b></p>
<p style="position:absolute;top:579px;left:224px;white-space:nowrap" class="ft6654"><b>Linux&#160;OS</b></p>
<p style="position:absolute;top:641px;left:183px;white-space:nowrap" class="ft6654"><b>Virtualization&#160;Layer</b></p>
<p style="position:absolute;top:691px;left:325px;white-space:nowrap" class="ft6655"><b>TPM&#160;&#160;</b></p>
<p style="position:absolute;top:318px;left:549px;white-space:nowrap" class="ft6652">Remote&#160;Computer</p>
<p style="position:absolute;top:386px;left:578px;white-space:nowrap" class="ft6654"><b>Authentication&#160;&#160;&amp;</b></p>
<p style="position:absolute;top:405px;left:565px;white-space:nowrap" class="ft6654"><b>&#160;Registration&#160;Server</b></p>
<p style="position:absolute;top:485px;left:550px;white-space:nowrap" class="ft6654"><b>MFA&#160;Credential&#160;&#160;&amp;&#160;Policy&#160;</b></p>
<p style="position:absolute;top:504px;left:610px;white-space:nowrap" class="ft6654"><b>Manager</b></p>
<p style="position:absolute;top:595px;left:579px;white-space:nowrap" class="ft6655"><b>Master&#160;Repository</b></p>
<p style="position:absolute;top:612px;left:569px;white-space:nowrap" class="ft6656">User&#160;&amp;&#160;TPM&#160;&amp;&#160;Settings&#160;</p>
<p style="position:absolute;top:629px;left:610px;white-space:nowrap" class="ft6656">DataBase</p>
<p style="position:absolute;top:698px;left:604px;white-space:nowrap" class="ft6654"><b>Linux&#160;OS</b></p>
<p style="position:absolute;top:801px;left:388px;white-space:nowrap" class="ft6654"><b>Secure&#160;channel</b></p>
<p style="position:absolute;top:394px;left:423px;white-space:nowrap" class="ft6654"><b>Logon</b></p>
<p style="position:absolute;top:261px;left:171px;white-space:nowrap" class="ft6653">Client&#160;Computer</p>
</div>
<!-- Page 67 -->
<a name="67"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page67-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables067.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft6715">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft670">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft6716">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft6716">FINAL |&#160;1.00</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft677">The&#160;server&#160;defines&#160;the&#160;policy&#160;whether&#160;a&#160;connecting&#160;client&#160;user&#160;machine&#160;is&#160;to&#160;be&#160;<br/>considered “trusted” or&#160;not.</p>
<p style="position:absolute;top:200px;left:110px;white-space:nowrap" class="ft6744">●</p>
<p style="position:absolute;top:197px;left:137px;white-space:nowrap" class="ft673"><b>Credential&#160;&amp;&#160;Policy&#160;manager.</b></p>
<p style="position:absolute;top:197px;left:411px;white-space:nowrap" class="ft674">&#160;</p>
<p style="position:absolute;top:197px;left:417px;white-space:nowrap" class="ft6745"><i>The&#160;credential&#160;&amp;&#160;policy&#160;manager&#160;</i></p>
<p style="position:absolute;top:197px;left:695px;white-space:nowrap" class="ft674">is&#160;responsible&#160;</p>
<p style="position:absolute;top:216px;left:137px;white-space:nowrap" class="ft677">to&#160;&#160;&#160;manage&#160;&#160;&#160;and&#160;&#160;&#160;store&#160;&#160;&#160;the&#160;&#160;&#160;user's&#160;&#160;&#160;credentials&#160;&#160;&#160;&amp;&#160;&#160;&#160;policies.&#160;&#160;&#160;The&#160;&#160;&#160;credentials&#160;&#160;&#160;used&#160;<br/>when&#160;authenticating&#160;the&#160;user&#160;with&#160;the&#160;remote&#160;server.&#160;The&#160;credential&#160;manager&#160;<br/>ensures&#160;that&#160;these&#160;credentials&#160;are&#160;securely&#160;stored.&#160;&#160;Secure</p>
<p style="position:absolute;top:255px;left:631px;white-space:nowrap" class="ft673"><b>&#160;Master&#160;Repository&#160;</b></p>
<p style="position:absolute;top:274px;left:137px;white-space:nowrap" class="ft677">is&#160;&#160;&#160;used&#160;&#160;&#160;to&#160;&#160;&#160;save&#160;&#160;&#160;and&#160;&#160;&#160;keep&#160;&#160;&#160;the&#160;&#160;&#160;secure&#160;&#160;&#160;data.&#160;&#160;&#160;MFA&#160;&#160;&#160;includes&#160;&#160;&#160;administrative&#160;<br/>functionality&#160;&#160;&#160;to&#160;&#160;&#160;configure&#160;&#160;&#160;authentication&#160;&#160;&#160;methods&#160;&#160;&#160;and&#160;&#160;&#160;access&#160;&#160;&#160;rights&#160;&#160;&#160;and&#160;<br/>settings.</p>
<p style="position:absolute;top:343px;left:110px;white-space:nowrap" class="ft6744">●</p>
<p style="position:absolute;top:340px;left:137px;white-space:nowrap" class="ft673"><b>TPM.&#160;&#160;</b></p>
<p style="position:absolute;top:340px;left:195px;white-space:nowrap" class="ft6745"><i>Trusted&#160;&#160;&#160;Platform&#160;&#160;&#160;Module</i></p>
<p style="position:absolute;top:340px;left:412px;white-space:nowrap" class="ft674">&#160;&#160;is</p>
<p style="position:absolute;top:340px;left:436px;white-space:nowrap" class="ft673"><b>&#160;</b></p>
<p style="position:absolute;top:340px;left:448px;white-space:nowrap" class="ft674">a&#160;&#160;&#160;chip&#160;&#160;&#160;that&#160;&#160;&#160;provides&#160;&#160;&#160;Trusted&#160;&#160;&#160;Computing&#160;</p>
<p style="position:absolute;top:360px;left:137px;white-space:nowrap" class="ft674">features.&#160;</p>
<p style="position:absolute;top:391px;left:110px;white-space:nowrap" class="ft6744">●</p>
<p style="position:absolute;top:388px;left:137px;white-space:nowrap" class="ft673"><b>PCR. &#160;</b></p>
<p style="position:absolute;top:388px;left:192px;white-space:nowrap" class="ft6745"><i>Platform&#160;Configuration Registers</i></p>
<p style="position:absolute;top:388px;left:462px;white-space:nowrap" class="ft674">. TPM&#160;volatile&#160;memory&#160;section contains&#160;</p>
<p style="position:absolute;top:408px;left:137px;white-space:nowrap" class="ft677">platform&#160;configuration&#160;registers.&#160;These registers&#160;contain the integrity&#160;<br/>measurements&#160;(hashes)&#160;of the firmware and loaded software.&#160;During the system&#160;<br/>boot&#160;the BIOS, the BIOS&#160;extensions, MBR,&#160;the boot&#160;loader&#160;(namely GRUB)&#160;stages&#160;<br/>are&#160;measured&#160;and any designated files, such as&#160;the kernel. These&#160;<br/>measurements&#160;are used to extend the various&#160;PCRs.&#160;</p>
<p style="position:absolute;top:515px;left:110px;white-space:nowrap" class="ft6744">●</p>
<p style="position:absolute;top:513px;left:137px;white-space:nowrap" class="ft673"><b>Client components.&#160;</b></p>
<p style="position:absolute;top:513px;left:323px;white-space:nowrap" class="ft674">MFA</p>
<p style="position:absolute;top:513px;left:358px;white-space:nowrap" class="ft673"><b>&#160;</b></p>
<p style="position:absolute;top:513px;left:364px;white-space:nowrap" class="ft674">components installed on the client.</p>
<p style="position:absolute;top:544px;left:110px;white-space:nowrap" class="ft6744">●</p>
<p style="position:absolute;top:541px;left:137px;white-space:nowrap" class="ft673"><b>Remote server components.&#160;</b></p>
<p style="position:absolute;top:541px;left:405px;white-space:nowrap" class="ft674">MFA</p>
<p style="position:absolute;top:541px;left:441px;white-space:nowrap" class="ft673"><b>&#160;</b></p>
<p style="position:absolute;top:541px;left:446px;white-space:nowrap" class="ft674">components installed on the remote&#160;</p>
<p style="position:absolute;top:561px;left:137px;white-space:nowrap" class="ft674">server.&#160;</p>
<p style="position:absolute;top:608px;left:137px;white-space:nowrap" class="ft677">The client and server components&#160;are&#160;installed on&#160;two systems&#160;by the system&#160;<br/>administrator.&#160;After&#160;the installation has been completed the user&#160;has access&#160;to&#160;<br/>the client system.&#160;The system&#160;administrator&#160;has&#160;access&#160;to server computer.&#160;</p>
<p style="position:absolute;top:694px;left:83px;white-space:nowrap" class="ft677">Since&#160;the specification&#160;of the services and interfaces&#160;provided by the OpenTC&#160;<br/>framework&#160;are currently an ongoing work, the details of the interactions&#160;among&#160;MFA&#160;<br/>and such&#160;services will be specified in&#160;the final MFA specifications.</p>
<p style="position:absolute;top:778px;left:83px;white-space:nowrap" class="ft6710"><b>5&#160;Required services&#160;from&#160;sublayers</b></p>
<p style="position:absolute;top:814px;left:110px;white-space:nowrap" class="ft6744">●</p>
<p style="position:absolute;top:811px;left:137px;white-space:nowrap" class="ft674">An installed and running Open_TC framework on the client platform.</p>
<p style="position:absolute;top:843px;left:110px;white-space:nowrap" class="ft6744">●</p>
<p style="position:absolute;top:840px;left:137px;white-space:nowrap" class="ft677">Multifactor&#160;authentication&#160;services require fully implemented Trusted Software&#160;<br/>Stack&#160;(TSS) for Linux according to&#160;TCG specification.&#160;TSS stack&#160;must support&#160;<br/>basic&#160;TCG functionality&#160;including Attestation&#160;Identities Keys (AIK)&#160;generation,&#160;<br/>TPM&#160;Platform&#160;Configuration Registers (PCRs)&#160;management.</p>
<p style="position:absolute;top:929px;left:110px;white-space:nowrap" class="ft6744">●</p>
<p style="position:absolute;top:926px;left:137px;white-space:nowrap" class="ft674">The security services&#160;such as&#160;OpenSSL for&#160;Open_TC will be used.&#160;</p>
<p style="position:absolute;top:958px;left:110px;white-space:nowrap" class="ft6744">●</p>
<p style="position:absolute;top:955px;left:137px;white-space:nowrap" class="ft674">Crypto/PKI&#160;services - from SWP03c.</p>
<p style="position:absolute;top:986px;left:110px;white-space:nowrap" class="ft6744">●</p>
<p style="position:absolute;top:983px;left:137px;white-space:nowrap" class="ft677">Open_TC Certificate&#160;Authority (CA) to provide the cryptographic&#160;certificate&#160;<br/>infrastructure.</p>
<p style="position:absolute;top:1049px;left:83px;white-space:nowrap" class="ft6710"><b>6&#160;&#160;Environment requirements&#160;</b></p>
<p style="position:absolute;top:1085px;left:110px;white-space:nowrap" class="ft6744">●</p>
<p style="position:absolute;top:1082px;left:137px;white-space:nowrap" class="ft674">A&#160;linux distribution (Fedora&#160;5, OpenSUSE 10 or Damn Small Linux)</p>
<p style="position:absolute;top:1114px;left:110px;white-space:nowrap" class="ft6744">●</p>
<p style="position:absolute;top:1111px;left:137px;white-space:nowrap" class="ft674">PAM&#160; Framework&#160;</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6716">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6716">23/25</p>
</div>
<!-- Page 68 -->
<a name="68"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page68-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables068.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft6815">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft680">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft6816">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft6816">FINAL |&#160;1.00</p>
<p style="position:absolute;top:152px;left:110px;white-space:nowrap" class="ft6844">●</p>
<p style="position:absolute;top:149px;left:137px;white-space:nowrap" class="ft684">OpenSSL Library</p>
<p style="position:absolute;top:181px;left:110px;white-space:nowrap" class="ft6844">●</p>
<p style="position:absolute;top:178px;left:137px;white-space:nowrap" class="ft684">TSS 1.2 library</p>
<p style="position:absolute;top:209px;left:110px;white-space:nowrap" class="ft6844">●</p>
<p style="position:absolute;top:206px;left:137px;white-space:nowrap" class="ft684">TPM&#160;Tools 1.2.4</p>
<p style="position:absolute;top:238px;left:110px;white-space:nowrap" class="ft6844">●</p>
<p style="position:absolute;top:235px;left:137px;white-space:nowrap" class="ft684">TSS Test Suite_27022006</p>
<p style="position:absolute;top:266px;left:110px;white-space:nowrap" class="ft6844">●</p>
<p style="position:absolute;top:263px;left:137px;white-space:nowrap" class="ft684">Linux 2.6.x</p>
<p style="position:absolute;top:295px;left:110px;white-space:nowrap" class="ft6844">●</p>
<p style="position:absolute;top:292px;left:137px;white-space:nowrap" class="ft684">gcc&#160;3.4.x</p>
<p style="position:absolute;top:323px;left:110px;white-space:nowrap" class="ft6844">●</p>
<p style="position:absolute;top:320px;left:137px;white-space:nowrap" class="ft684">eclipse-3.1</p>
<p style="position:absolute;top:367px;left:83px;white-space:nowrap" class="ft6810"><b>7&#160;&#160;Platform requirements</b></p>
<p style="position:absolute;top:400px;left:83px;white-space:nowrap" class="ft687">The Product&#160;is compatible with standard&#160;Linux environment with TPM platform&#160;installed&#160;<br/>and initialized.<br/>The MFA system&#160;Product&#160;supports&#160;features and functionality enabled by a&#160;Trusted&#160;<br/>Platform&#160;Module (TPM)&#160;that requires the following components&#160;to be installed:</p>
<p style="position:absolute;top:498px;left:110px;white-space:nowrap" class="ft6844">●</p>
<p style="position:absolute;top:495px;left:137px;white-space:nowrap" class="ft687">Infineon TPM&#160;SLD 9630 TT&#160;1.1b with TPM&#160;firmware&#160;1.05 or higher; Infineon&#160;<br/>provides a&#160;firmware&#160;update via a&#160;tool based on the TCG field upgrade approach&#160;<br/>that&#160;will be deployed by means comparable to&#160;driver updates.</p>
<p style="position:absolute;top:565px;left:110px;white-space:nowrap" class="ft6844">●</p>
<p style="position:absolute;top:562px;left:137px;white-space:nowrap" class="ft684">TPM&#160;TestSuite –27022006 IBM</p>
<p style="position:absolute;top:593px;left:110px;white-space:nowrap" class="ft6844">●</p>
<p style="position:absolute;top:590px;left:137px;white-space:nowrap" class="ft684">TPM&#160;driver and TSS.</p>
<p style="position:absolute;top:636px;left:83px;white-space:nowrap" class="ft6810"><b>8&#160;List&#160;of&#160;abbreviations</b></p>
<p style="position:absolute;top:670px;left:83px;white-space:nowrap" class="ft687">Listing of term definitions and abbreviations&#160;used in this document&#160;(IT expressions and&#160;<br/>terms&#160;from the application&#160;domain).</p>
<p style="position:absolute;top:727px;left:93px;white-space:nowrap" class="ft683"><b>Abbreviation</b></p>
<p style="position:absolute;top:727px;left:301px;white-space:nowrap" class="ft683"><b>Explanation</b></p>
<p style="position:absolute;top:747px;left:93px;white-space:nowrap" class="ft684">AIK</p>
<p style="position:absolute;top:747px;left:301px;white-space:nowrap" class="ft684">Attestation&#160;Identity Key</p>
<p style="position:absolute;top:766px;left:93px;white-space:nowrap" class="ft684">MFA</p>
<p style="position:absolute;top:766px;left:301px;white-space:nowrap" class="ft684">MultiFactor&#160;Authentication</p>
<p style="position:absolute;top:785px;left:93px;white-space:nowrap" class="ft684">OS</p>
<p style="position:absolute;top:785px;left:301px;white-space:nowrap" class="ft684">Operating System</p>
<p style="position:absolute;top:805px;left:93px;white-space:nowrap" class="ft684">PCR</p>
<p style="position:absolute;top:805px;left:301px;white-space:nowrap" class="ft684">Platform&#160;Configuration Register</p>
<p style="position:absolute;top:824px;left:93px;white-space:nowrap" class="ft684">SSL</p>
<p style="position:absolute;top:824px;left:301px;white-space:nowrap" class="ft684">Secure Sockets&#160;Layer</p>
<p style="position:absolute;top:843px;left:93px;white-space:nowrap" class="ft684">TC</p>
<p style="position:absolute;top:843px;left:301px;white-space:nowrap" class="ft684">Trusted Computing</p>
<p style="position:absolute;top:862px;left:93px;white-space:nowrap" class="ft684">TCB</p>
<p style="position:absolute;top:862px;left:301px;white-space:nowrap" class="ft684">Trusted Computing Base</p>
<p style="position:absolute;top:882px;left:93px;white-space:nowrap" class="ft684">TCG</p>
<p style="position:absolute;top:882px;left:301px;white-space:nowrap" class="ft684">Trusted Computing Group</p>
<p style="position:absolute;top:901px;left:93px;white-space:nowrap" class="ft684">TPM</p>
<p style="position:absolute;top:901px;left:301px;white-space:nowrap" class="ft684">Trusted Platform&#160;Module</p>
<p style="position:absolute;top:920px;left:93px;white-space:nowrap" class="ft684">TSS</p>
<p style="position:absolute;top:920px;left:301px;white-space:nowrap" class="ft684">Trusted Software Stack</p>
<p style="position:absolute;top:986px;left:83px;white-space:nowrap" class="ft6810"><b>9&#160;Referenced&#160;Documents</b></p>
<p style="position:absolute;top:1019px;left:83px;white-space:nowrap" class="ft684">/1/&#160;TCG&#160;Specification,&#160;Architecture&#160;Overview.</p>
<p style="position:absolute;top:1038px;left:83px;white-space:nowrap" class="ft6813">http://www.trustedcomputing.org</p>
<p style="position:absolute;top:1057px;left:83px;white-space:nowrap" class="ft687">April 28, 2004,&#160;<br/>Version 1.2&#160;</p>
<p style="position:absolute;top:1115px;left:83px;white-space:nowrap" class="ft684">/2/&#160;TCG&#160;Software&#160;Stack&#160;(TSS) Specification</p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6816">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6816">24/25</p>
</div>
<!-- Page 69 -->
<a name="69"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page69-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables069.png" alt="background image"/>
<p style="position:absolute;top:128px;left:83px;white-space:nowrap" class="ft6915">&#160;</p>
<p style="position:absolute;top:85px;left:83px;white-space:nowrap" class="ft690">&#160;</p>
<p style="position:absolute;top:114px;left:286px;white-space:nowrap" class="ft6916">MFA Requirements&#160;and&#160;Specification</p>
<p style="position:absolute;top:114px;left:673px;white-space:nowrap" class="ft6916">FINAL |&#160;1.00</p>
<p style="position:absolute;top:149px;left:83px;white-space:nowrap" class="ft697">January&#160;6, 2006,&#160;<br/>Version 1.2</p>
<p style="position:absolute;top:207px;left:83px;white-space:nowrap" class="ft694">/3/&#160;PAM</p>
<p style="position:absolute;top:226px;left:83px;white-space:nowrap" class="ft6914">http://www.kernel.org/pub/linux/libs/pam/Linux-PAM-html/Linux-<br/><a href="http://msdn.microsoft.com/">PAM_ADG.html</a></p>
<p style="position:absolute;top:245px;left:83px;white-space:nowrap" class="ft6913">&#160;&#160;</p>
<p style="position:absolute;top:245px;left:207px;white-space:nowrap" class="ft6913"><a href="http://msdn.microsoft.com/">http://msdn.microsoft.com</a></p>
<p style="position:absolute;top:245px;left:207px;white-space:nowrap" class="ft6913"><a href="http://msdn.microsoft.com/">&#160;&#160;</a></p>
<p style="position:absolute;top:264px;left:83px;white-space:nowrap" class="ft694">Version 0.99.6.0, 5. August&#160;2006.</p>
<p style="position:absolute;top:303px;left:83px;white-space:nowrap" class="ft694">/4/&#160;Secure Coding Guidelines</p>
<p style="position:absolute;top:322px;left:83px;white-space:nowrap" class="ft6913"><a href="http://msdn.microsoft.com/">http://msdn.microsoft.com</a></p>
<p style="position:absolute;top:341px;left:83px;white-space:nowrap" class="ft694">2004</p>
<p style="position:absolute;top:380px;left:83px;white-space:nowrap" class="ft694">/5/&#160;Improving&#160;Web Application&#160;Security:&#160;Threats&#160;and Countermeasures</p>
<p style="position:absolute;top:399px;left:83px;white-space:nowrap" class="ft6913"><a href="http://msdn.microsoft.com/">http://msdn.microsoft.com</a></p>
<p style="position:absolute;top:437px;left:83px;white-space:nowrap" class="ft694">/6/&#160;Writing Secure Code, Second Edition, by Michael Howard, David C. LeBlanc</p>
<p style="position:absolute;top:476px;left:83px;white-space:nowrap" class="ft694">/7/&#160;OpenSSL Toolkit<a href="http://www.openssl.org/">&#160;</a></p>
<p style="position:absolute;top:476px;left:251px;white-space:nowrap" class="ft6913"><a href="http://www.openssl.org/">www.openssl.org/</a></p>
<p style="position:absolute;top:1160px;left:83px;white-space:nowrap" class="ft6916">Open_TC Deliverable 06e.1</p>
<p style="position:absolute;top:1160px;left:763px;white-space:nowrap" class="ft6916">25/25</p>
</div>
<!-- Page 70 -->
<a name="70"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page70-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables070.png" alt="background image"/>
<p style="position:absolute;top:137px;left:92px;white-space:nowrap" class="ft700">&#160;</p>
<p style="position:absolute;top:76px;left:91px;white-space:nowrap" class="ft701">&#160;</p>
<p style="position:absolute;top:242px;left:88px;white-space:nowrap" class="ft702"><b>D6e.3: Intermediate MFA System Specification&#160;</b></p>
<p style="position:absolute;top:319px;left:91px;white-space:nowrap" class="ft703"><b>Project number</b></p>
<p style="position:absolute;top:319px;left:425px;white-space:nowrap" class="ft704">IST-027635</p>
<p style="position:absolute;top:345px;left:91px;white-space:nowrap" class="ft703"><b>Project acronym</b></p>
<p style="position:absolute;top:345px;left:425px;white-space:nowrap" class="ft704">Open_TC</p>
<p style="position:absolute;top:370px;left:91px;white-space:nowrap" class="ft703"><b>Project title</b></p>
<p style="position:absolute;top:370px;left:425px;white-space:nowrap" class="ft704">Open Trusted Computing</p>
<p style="position:absolute;top:396px;left:91px;white-space:nowrap" class="ft703"><b>Deliverable&#160;type</b></p>
<p style="position:absolute;top:396px;left:425px;white-space:nowrap" class="ft704">Internal Report&#160;</p>
<p style="position:absolute;top:439px;left:91px;white-space:nowrap" class="ft703"><b>Deliverable&#160;reference number</b></p>
<p style="position:absolute;top:439px;left:425px;white-space:nowrap" class="ft704">IST-027635/D6e.3/PUBLIC&#160;| 1.00</p>
<p style="position:absolute;top:464px;left:91px;white-space:nowrap" class="ft703"><b>Deliverable&#160;title</b></p>
<p style="position:absolute;top:464px;left:425px;white-space:nowrap" class="ft704">MFA&#160;Concept Prototype</p>
<p style="position:absolute;top:490px;left:91px;white-space:nowrap" class="ft703"><b>WP&#160;contributing&#160;to the deliverable</b></p>
<p style="position:absolute;top:490px;left:425px;white-space:nowrap" class="ft704">WP6</p>
<p style="position:absolute;top:515px;left:91px;white-space:nowrap" class="ft703"><b>Due&#160;date</b></p>
<p style="position:absolute;top:515px;left:425px;white-space:nowrap" class="ft704">Aug 2006 - M08</p>
<p style="position:absolute;top:541px;left:91px;white-space:nowrap" class="ft703"><b>Actual&#160;submission&#160;date</b></p>
<p style="position:absolute;top:541px;left:425px;white-space:nowrap" class="ft704">Sept 12,2006&#160;</p>
<p style="position:absolute;top:584px;left:91px;white-space:nowrap" class="ft703"><b>Responsible Organisation</b></p>
<p style="position:absolute;top:584px;left:424px;white-space:nowrap" class="ft704">INTEK</p>
<p style="position:absolute;top:616px;left:91px;white-space:nowrap" class="ft703"><b>Authors</b></p>
<p style="position:absolute;top:606px;left:424px;white-space:nowrap" class="ft704">Irina Beliakova, Vladimir Tsisser&#160;</p>
<p style="position:absolute;top:645px;left:91px;white-space:nowrap" class="ft703"><b>Abstract</b></p>
<p style="position:absolute;top:645px;left:424px;white-space:nowrap" class="ft707">This&#160;document describes&#160;MFA System which&#160;<br/>use trusted platform&#160;features for&#160;a secure,&#160;<br/>multifactor&#160;authentication to&#160;remote&#160;<br/>computers.&#160;System allows to&#160;make remote&#160;<br/>logon by using TPM credentials and/or&#160;<br/>password.&#160;The document&#160;contains&#160;system&#160;<br/>architecture, components,&#160;their&#160;interactions.&#160;</p>
<p style="position:absolute;top:860px;left:91px;white-space:nowrap" class="ft703"><b>Keywords</b></p>
<p style="position:absolute;top:860px;left:424px;white-space:nowrap" class="ft704">PAM, TPM,&#160;Credential Manager,&#160;MFA</p>
<p style="position:absolute;top:903px;left:92px;white-space:nowrap" class="ft703"><b>Dissemination&#160;level</b></p>
<p style="position:absolute;top:903px;left:423px;white-space:nowrap" class="ft704">Public</p>
<p style="position:absolute;top:929px;left:92px;white-space:nowrap" class="ft703"><b>Revision</b></p>
<p style="position:absolute;top:929px;left:423px;white-space:nowrap" class="ft704">PUBLIC&#160;| 1.00</p>
<p style="position:absolute;top:980px;left:90px;white-space:nowrap" class="ft703"><b>Instrument</b></p>
<p style="position:absolute;top:980px;left:271px;white-space:nowrap" class="ft704">IP</p>
<p style="position:absolute;top:971px;left:452px;white-space:nowrap" class="ft709"><b>Start&#160;date of&#160;the&#160;<br/>project</b></p>
<p style="position:absolute;top:980px;left:633px;white-space:nowrap" class="ft704">1</p>
<p style="position:absolute;top:980px;left:643px;white-space:nowrap" class="ft705">st</p>
<p style="position:absolute;top:980px;left:652px;white-space:nowrap" class="ft704">&#160;November 2005</p>
<p style="position:absolute;top:1009px;left:90px;white-space:nowrap" class="ft703"><b>Thematic&#160;Priority</b></p>
<p style="position:absolute;top:1009px;left:271px;white-space:nowrap" class="ft704">IST</p>
<p style="position:absolute;top:1009px;left:452px;white-space:nowrap" class="ft703"><b>Duration</b></p>
<p style="position:absolute;top:1009px;left:633px;white-space:nowrap" class="ft704">42 months</p>
<p style="position:absolute;top:75px;left:674px;white-space:nowrap" class="ft706">&#160;</p>
</div>
<!-- Page 71 -->
<a name="71"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page71-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables071.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7115">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft710">&#160;</p>
<p style="position:absolute;top:92px;left:278px;white-space:nowrap" class="ft7116">MFA Intermediate&#160;System&#160;Specification</p>
<p style="position:absolute;top:92px;left:664px;white-space:nowrap" class="ft7116">PUBLIC | 1.00</p>
<p style="position:absolute;top:169px;left:328px;white-space:nowrap" class="ft7117"><b>Table&#160;of Contents</b></p>
<p style="position:absolute;top:202px;left:85px;white-space:nowrap" class="ft717">1&#160;&#160;Introduction...............................................................................................................&#160;4<br/>2&#160;&#160;Requirements breakdown..........................................................................................&#160;4<br/>3&#160;&#160;High level design specification...................................................................................&#160;4<br/>4&#160;&#160;Functionality..............................................................................................................&#160;6</p>
<p style="position:absolute;top:278px;left:94px;white-space:nowrap" class="ft717">4.1&#160;Actions...................................................................................................................&#160;6<br/>4.2&#160;Policies...................................................................................................................&#160;8<br/>4.3&#160;Data&#160;structure&#160;organization example.....................................................................&#160;8</p>
<p style="position:absolute;top:336px;left:85px;white-space:nowrap" class="ft714">5&#160;&#160;Preliminary MFA&#160;API...................................................................................................&#160;9</p>
<p style="position:absolute;top:355px;left:94px;white-space:nowrap" class="ft714">5.1&#160;Data&#160;Types.............................................................................................................&#160;9</p>
<p style="position:absolute;top:374px;left:119px;white-space:nowrap" class="ft717">Pointer&#160;&#160;Size:...........................................................................................................&#160;9<br/>Basic&#160;T&#160;ypes:...........................................................................................................&#160;9<br/>Derived&#160;&#160;Types:.......................................................................................................&#160;9<br/>Common&#160;&#160;return code defines:..............................................................................&#160;10</p>
<p style="position:absolute;top:451px;left:94px;white-space:nowrap" class="ft714">5.2&#160;Structures.............................................................................................................&#160;10</p>
<p style="position:absolute;top:470px;left:102px;white-space:nowrap" class="ft717">5.2.1&#160;&#160;MFA_VERSION.................................................................................................&#160;10<br/>5.2.1&#160;MFA_CONTEXT_INFO&#160;.......................................................................................&#160;10</p>
<p style="position:absolute;top:509px;left:94px;white-space:nowrap" class="ft714">5.3&#160;Interface&#160;definition...............................................................................................&#160;11</p>
<p style="position:absolute;top:528px;left:102px;white-space:nowrap" class="ft717">5.3.1&#160;mfa_Context_Create&#160;.......................................................................................&#160;11<br/>5.3.2&#160;mfa_Context_Close..........................................................................................&#160;11<br/>5.3.3&#160;mfa_Context_GetStatus&#160;..................................................................................&#160;12<br/>5.3.4&#160;mfa_Context_FreeMemory&#160;..............................................................................&#160;12<br/>5.3.5&#160;mfa_S_RegisterPlatform&#160;..................................................................................&#160;13<br/>5.3.6&#160;mfa_S_Authenticate.........................................................................................&#160;13<br/>5.3.7&#160;mfa_S_SetAccessPolicy....................................................................................&#160;13<br/>5.3.8&#160;mfa_S_GetAccessPolicy....................................................................................14<br/>5.3.9&#160;mfa_Platform_Initialize&#160;....................................................................................&#160;14<br/>5.3.1&#160;0mfa_C_GetPlaformData..................................................................................&#160;14</p>
<p style="position:absolute;top:720px;left:85px;white-space:nowrap" class="ft717">6&#160;&#160;List of abbreviations.................................................................................................&#160;15<br/>7&#160;&#160;Referenced Documents............................................................................................&#160;15</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft7116">Open_TC Deliverable 6e.3</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft7116">2/16</p>
</div>
<!-- Page 72 -->
<a name="72"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page72-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables072.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7215">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft720">&#160;</p>
<p style="position:absolute;top:92px;left:278px;white-space:nowrap" class="ft7216">MFA Intermediate&#160;System&#160;Specification</p>
<p style="position:absolute;top:92px;left:664px;white-space:nowrap" class="ft7216">PUBLIC | 1.00</p>
<p style="position:absolute;top:169px;left:353px;white-space:nowrap" class="ft7217"><b>List&#160;of figures</b></p>
<p style="position:absolute;top:202px;left:85px;white-space:nowrap" class="ft727">Figure 1: MFA Components.............................................................................................&#160;5<br/>Figure 2: Platform&#160;registration........................................................................................&#160;6<br/>Figure 3: Platform&#160;authentication...................................................................................&#160;8</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft7216">Open_TC Deliverable 6e.3</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft7216">3/16</p>
</div>
<!-- Page 73 -->
<a name="73"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page73-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables073.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7315">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft730">&#160;</p>
<p style="position:absolute;top:92px;left:278px;white-space:nowrap" class="ft7316">MFA Intermediate&#160;System&#160;Specification</p>
<p style="position:absolute;top:92px;left:664px;white-space:nowrap" class="ft7316">PUBLIC | 1.00</p>
<p style="position:absolute;top:172px;left:85px;white-space:nowrap" class="ft7310"><b>1&#160;&#160;Introducti</b></p>
<p style="position:absolute;top:169px;left:241px;white-space:nowrap" class="ft7317"><b>on</b></p>
<p style="position:absolute;top:206px;left:85px;white-space:nowrap" class="ft737">The TPM MultiFactor&#160;Authentication&#160;(MFA) system&#160;is an application&#160;of the Trusted&#160;<br/>Computing technology&#160;and shows the benefits&#160;of such technology for ensuring that&#160;<br/>only a user who&#160;owns a registered platform&#160;equipped with a TPM may&#160;have access&#160;to&#160;<br/>the remote computer&#160;resources.&#160;<br/>Multifactor&#160;authentication&#160;to remote server&#160;involves components&#160;executed at&#160;server&#160;<br/>and client&#160;computers.&#160;Client components&#160;register&#160;TPM with the remote server.&#160;Client&#160;<br/>components&#160;uses the local TPM&#160;through TSS. The user can&#160;login to a&#160;remote&#160;server&#160;<br/>once&#160;the platform&#160;registration&#160;is completed.<br/>The parameters&#160;of multifactor&#160;authentication&#160;system&#160;can be controlled by&#160;<br/>authentication policies.&#160;<br/>This document gives&#160;high level design specification of a&#160;MFA system:&#160;the components&#160;<br/>protocol&#160;messages&#160;exchanged by&#160;the&#160;components&#160;and a&#160;preliminary&#160;API.<br/>Since&#160;the specification&#160;of the services and interfaces&#160;provided by the OpenTC&#160;<br/>framework&#160;are currently an ongoing work, the details of the interactions&#160;among&#160;MFA&#160;<br/>and such&#160;services will be specified in&#160;the final MFA specifications.</p>
<p style="position:absolute;top:557px;left:85px;white-space:nowrap" class="ft7310"><b>2&#160;&#160;Requirements breakdown</b></p>
<p style="position:absolute;top:590px;left:85px;white-space:nowrap" class="ft737">As&#160;long as&#160;an authorized system&#160;is used to&#160;access&#160;corporate&#160;resources,&#160;the entire&#160;<br/>infrastructure&#160;can&#160;be thought of as&#160;protected. Even if&#160;somebody's&#160;credentials have&#160;<br/>been stolen, the intruder will have to operate from&#160;a trusted corporate&#160;platform&#160;to&#160;<br/>gain the access&#160;to&#160;the resources.&#160;On the other hand even the authorized user may&#160;<br/>mistakenly try to&#160;gain the access&#160; from improperly configured system,&#160;such as&#160;home&#160;<br/>computer,&#160;untrusted&#160;device, and etc. - the platforms&#160;that&#160;by definition are outside the&#160;<br/>corporate&#160;control.<br/>The multifactor&#160;authentication,&#160;including both user and platform&#160;authentication covers&#160;<br/>up most&#160;of these threats.&#160;The access&#160;to the network&#160;is granted only if&#160;both&#160;elements&#160;-&#160;<br/>user and platform&#160;-&#160;are&#160;successfully authenticated.<br/>An installed and running Open_TC framework on the client platform&#160;is required.&#160;<br/>Implementation of Multifactor&#160;Authentication application expects&#160;the presence of an&#160;<br/>underlying trusted&#160;framework and requires the following services from&#160;it.</p>
<p style="position:absolute;top:870px;left:112px;white-space:nowrap" class="ft7344">●</p>
<p style="position:absolute;top:867px;left:139px;white-space:nowrap" class="ft737">Trusted Software&#160;Stack (TSS) for Linux according&#160;to TCG&#160;specification.&#160;TSS stack&#160;<br/>must&#160;support&#160;basic&#160;TCG functionality&#160;including Attestation&#160;Identities Keys (AIK)&#160;<br/>generation,&#160;TPM Platform&#160;Configuration Registers&#160;(PCRs) calculation,&#160;storing,&#160;<br/>and retrieval.</p>
<p style="position:absolute;top:956px;left:112px;white-space:nowrap" class="ft7344">●</p>
<p style="position:absolute;top:953px;left:139px;white-space:nowrap" class="ft734">Security services&#160;such as&#160;OpenSSL to&#160;provide secure&#160;communication&#160;protocol.</p>
<p style="position:absolute;top:984px;left:112px;white-space:nowrap" class="ft7344">●</p>
<p style="position:absolute;top:981px;left:139px;white-space:nowrap" class="ft734">Crypto&#160;and PKI&#160;services developed in SWP03c and SWP05d.</p>
<p style="position:absolute;top:1010px;left:85px;white-space:nowrap" class="ft737">For&#160;a&#160;more comprehensive description of the MFA requirements,&#160;the reader should&#160;<br/>refer to the deliverable: “D06e.1 MFA Requirements and Specification”.&#160;</p>
<p style="position:absolute;top:1075px;left:85px;white-space:nowrap" class="ft7310"><b>3&#160;&#160;High level&#160;design specification</b></p>
<p style="position:absolute;top:1108px;left:85px;white-space:nowrap" class="ft734">The MFA architecture&#160;includes two components&#160;components&#160;types:</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft7316">Open_TC Deliverable 6e.3</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft7316">4/16</p>
</div>
<!-- Page 74 -->
<a name="74"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft7457{font-size:21px;font-family:GAAAAA+ArialMT;color:#000000;}
	.ft7458{font-size:24px;font-family:GAAAAA+ArialMT;color:#000000;}
-->
</style>
<div id="page74-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables074.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7415">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft740">&#160;</p>
<p style="position:absolute;top:92px;left:278px;white-space:nowrap" class="ft7416">MFA Intermediate&#160;System&#160;Specification</p>
<p style="position:absolute;top:92px;left:664px;white-space:nowrap" class="ft7416">PUBLIC | 1.00</p>
<p style="position:absolute;top:151px;left:139px;white-space:nowrap" class="ft744">1.&#160;&#160;Client components</p>
<p style="position:absolute;top:179px;left:192px;white-space:nowrap" class="ft744">Register&#160;credential utility</p>
<p style="position:absolute;top:207px;left:139px;white-space:nowrap" class="ft744">2.&#160;&#160;Remote&#160;server components:</p>
<p style="position:absolute;top:236px;left:192px;white-space:nowrap" class="ft748">Authentication&#160;and Registration&#160;Server<br/>Platform/User&#160;identities database:&#160;Master Repository<br/>Credential &amp; Policy Manager</p>
<p style="position:absolute;top:320px;left:85px;white-space:nowrap" class="ft747">The client and server components&#160;are&#160;installed on&#160;two systems&#160;by the system&#160;<br/>administrator.&#160;After&#160;installation is completed the user&#160;has access&#160;to the client system&#160;<br/>and the system&#160;administrator&#160;has access&#160;to&#160;server computer.<br/>These components&#160;can run on on a&#160;single Linux box with TSS and TPM&#160;as&#160;well as&#160;on&#160;<br/>top&#160;of the Open_TC framework.&#160;(Fig.1)</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft7416">Open_TC Deliverable 6e.3</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft7416">5/16</p>
<p style="position:absolute;top:1051px;left:345px;white-space:nowrap" class="ft7451"><i>Figure&#160;1: MFA&#160;Components</i></p>
<p style="position:absolute;top:541px;left:154px;white-space:nowrap" class="ft7457">Trusted&#160;Compartment</p>
<p style="position:absolute;top:722px;left:170px;white-space:nowrap" class="ft7458">Client&#160;Computer</p>
<p style="position:absolute;top:489px;left:542px;white-space:nowrap" class="ft7458">Server&#160;Computer</p>
<p style="position:absolute;top:619px;left:167px;white-space:nowrap" class="ft7454"><b>MFA&#160;Logon application</b></p>
<p style="position:absolute;top:709px;left:189px;white-space:nowrap" class="ft7454"><b>VM&#160;Trusted&#160;&#160;&amp;&#160;TPM&#160;</b></p>
<p style="position:absolute;top:728px;left:211px;white-space:nowrap" class="ft7454"><b>management</b></p>
<p style="position:absolute;top:803px;left:224px;white-space:nowrap" class="ft7454"><b>Linux&#160;OS</b></p>
<p style="position:absolute;top:864px;left:183px;white-space:nowrap" class="ft7454"><b>Virtualization&#160;Layer</b></p>
<p style="position:absolute;top:915px;left:325px;white-space:nowrap" class="ft7455"><b>TPM&#160;&#160;</b></p>
<p style="position:absolute;top:541px;left:550px;white-space:nowrap" class="ft7457">Remote&#160;Computer</p>
<p style="position:absolute;top:609px;left:578px;white-space:nowrap" class="ft7454"><b>Authentication&#160;&#160;&amp;</b></p>
<p style="position:absolute;top:628px;left:566px;white-space:nowrap" class="ft7454"><b>&#160;Registration&#160;Server</b></p>
<p style="position:absolute;top:709px;left:551px;white-space:nowrap" class="ft7454"><b>MFA&#160;Credential&#160;&#160;&amp;&#160;Policy&#160;</b></p>
<p style="position:absolute;top:728px;left:610px;white-space:nowrap" class="ft7454"><b>Manager</b></p>
<p style="position:absolute;top:818px;left:579px;white-space:nowrap" class="ft7455"><b>Master&#160;Repository</b></p>
<p style="position:absolute;top:835px;left:569px;white-space:nowrap" class="ft7443">User&#160;&amp;&#160;TPM&#160;&amp;&#160;Settings&#160;</p>
<p style="position:absolute;top:852px;left:610px;white-space:nowrap" class="ft7443">DataBase</p>
<p style="position:absolute;top:921px;left:604px;white-space:nowrap" class="ft7454"><b>Linux&#160;OS</b></p>
<p style="position:absolute;top:1025px;left:388px;white-space:nowrap" class="ft7454"><b>Secure&#160;channel</b></p>
<p style="position:absolute;top:618px;left:423px;white-space:nowrap" class="ft7454"><b>Logon</b></p>
<p style="position:absolute;top:484px;left:171px;white-space:nowrap" class="ft7458">Client&#160;Computer</p>
</div>
<!-- Page 75 -->
<a name="75"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft7559{font-size:20px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page75-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables075.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7515">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft750">&#160;</p>
<p style="position:absolute;top:92px;left:278px;white-space:nowrap" class="ft7516">MFA Intermediate&#160;System&#160;Specification</p>
<p style="position:absolute;top:92px;left:664px;white-space:nowrap" class="ft7516">PUBLIC | 1.00</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft7510"><b>4&#160;&#160;Functionality</b></p>
<p style="position:absolute;top:202px;left:85px;white-space:nowrap" class="ft7559"><b>4.1&#160;Actions</b></p>
<p style="position:absolute;top:253px;left:85px;white-space:nowrap" class="ft754">&#160; &#160; &#160;There are three actions&#160;that can&#160;be performed on the client:</p>
<p style="position:absolute;top:281px;left:112px;white-space:nowrap" class="ft754">1.</p>
<p style="position:absolute;top:281px;left:139px;white-space:nowrap" class="ft753"><b>Platform registration with&#160;the&#160;remote server.&#160;</b></p>
<p style="position:absolute;top:281px;left:569px;white-space:nowrap" class="ft754">An existing user with&#160;</p>
<p style="position:absolute;top:301px;left:139px;white-space:nowrap" class="ft757">administrative rights can&#160;register&#160;the platform&#160;authentication&#160;information:&#160;<br/>Platform&#160;AIK&#160;and platform&#160;Configuration&#160;Registers&#160;(PCRs)</p>
<p style="position:absolute;top:320px;left:613px;white-space:nowrap" class="ft753"><b>.&#160;</b></p>
<p style="position:absolute;top:339px;left:139px;white-space:nowrap" class="ft757">Platform&#160;AIK&#160;is created&#160;inside the local TPM,&#160;AIK&#160;certificate&#160;request is built and&#160;<br/>sent to&#160;the Open_TC Privacy&#160;CA. PCRs&#160;are&#160;extended during the bootstrap&#160;with&#160;<br/>the integrity measurements of client&#160;computer software.&#160;Retrieved TPM&#160;<br/>Platform&#160;Configuration&#160;Registers&#160;(PCRs)&#160;values and Platform&#160;AIK&#160;as&#160;Combined&#160;<br/>Platform&#160;Registration&#160;Information&#160;(COREG) are sent to&#160;the server.&#160; The server&#160;<br/>receives the COREG and uses it to&#160;create the Platform&#160;Identity – data,&#160;necessary&#160;<br/>for&#160;authentication.&#160;</p>
<p style="position:absolute;top:1031px;left:112px;white-space:nowrap" class="ft754">2.</p>
<p style="position:absolute;top:1031px;left:139px;white-space:nowrap" class="ft753"><b>User&#160;registration&#160;with remote&#160;server.</b></p>
<p style="position:absolute;top:1031px;left:488px;white-space:nowrap" class="ft754">&#160;The possibility of a&#160;new user&#160;</p>
<p style="position:absolute;top:1050px;left:139px;white-space:nowrap" class="ft757">registration&#160;relies&#160;solely on the existing infrastructure.&#160;the application&#160;does not&#160;<br/>intend to&#160;interfere in any way the security practices&#160;existing in the&#160;<br/>infrastructure.</p>
<p style="position:absolute;top:1108px;left:112px;white-space:nowrap" class="ft754">3.</p>
<p style="position:absolute;top:1108px;left:139px;white-space:nowrap" class="ft753"><b>Logon&#160;to the remote&#160;server.</b></p>
<p style="position:absolute;top:1108px;left:401px;white-space:nowrap" class="ft754">&#160;A&#160;client can logon to&#160;the remote&#160;server. This&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft7516">Open_TC Deliverable 6e.3</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft7516">6/16</p>
<p style="position:absolute;top:985px;left:333px;white-space:nowrap" class="ft7551"><i>Figure&#160;2: Platform&#160;registration</i></p>
<p style="position:absolute;top:525px;left:112px;white-space:nowrap" class="ft7523">MFA&#160;Client</p>
<p style="position:absolute;top:526px;left:553px;white-space:nowrap" class="ft7523">MFA_Server</p>
<p style="position:absolute;top:647px;left:210px;white-space:nowrap" class="ft7523">Registration&#160;request</p>
<p style="position:absolute;top:700px;left:208px;white-space:nowrap" class="ft7523">Retrive&#160;PCRs</p>
<p style="position:absolute;top:870px;left:653px;white-space:nowrap" class="ft7523">Hold&#160;the&#160;copy&#160;of&#160;PUBAIK</p>
<p style="position:absolute;top:756px;left:208px;white-space:nowrap" class="ft7523">Create&#160;AIK&#160;(PUBAIK;&#160;PRIVAIK)</p>
<p style="position:absolute;top:672px;left:208px;white-space:nowrap" class="ft7523">Hold&#160;the&#160;copy&#160;of&#160;SCERT</p>
<p style="position:absolute;top:841px;left:653px;white-space:nowrap" class="ft7523">Hold&#160;the&#160;copy&#160;of&#160;PID</p>
<p style="position:absolute;top:526px;left:335px;white-space:nowrap" class="ft7523">Registration&#160;scripts</p>
<p style="position:absolute;top:788px;left:180px;white-space:nowrap" class="ft7523">COREG&#160;(PID,&#160;PUBAIK,&#160;PCRs)</p>
<p style="position:absolute;top:810px;left:395px;white-space:nowrap" class="ft7523">Registration&#160;request&#160;with&#160;COREG</p>
<p style="position:absolute;top:898px;left:653px;white-space:nowrap" class="ft7523">Hold&#160;the&#160;copy&#160;of&#160;PCRs</p>
<p style="position:absolute;top:895px;left:423px;white-space:nowrap" class="ft7523">Registration&#160;succeeded</p>
<p style="position:absolute;top:728px;left:208px;white-space:nowrap" class="ft7523">Generate&#160;Platform&#160;ID&#160;&#160;(PID)</p>
</div>
<!-- Page 76 -->
<a name="76"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page76-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables076.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7615">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft760">&#160;</p>
<p style="position:absolute;top:92px;left:278px;white-space:nowrap" class="ft7616">MFA Intermediate&#160;System&#160;Specification</p>
<p style="position:absolute;top:92px;left:664px;white-space:nowrap" class="ft7616">PUBLIC | 1.00</p>
<p style="position:absolute;top:151px;left:139px;white-space:nowrap" class="ft767">basically&#160;relies&#160;solely on the existing authentication&#160;infrastructure.&#160;In case&#160;the&#160;<br/>remote&#160;server logon system supports&#160;the MFA extension,&#160;a client platform&#160;<br/>authentication will be launched.</p>
<p style="position:absolute;top:228px;left:85px;white-space:nowrap" class="ft764">There are five actions&#160;that&#160;can be performed&#160;on the remote&#160;server:</p>
<p style="position:absolute;top:266px;left:112px;white-space:nowrap" class="ft764">1.</p>
<p style="position:absolute;top:266px;left:139px;white-space:nowrap" class="ft763"><b>Register platform and&#160;store&#160;platform information</b></p>
<p style="position:absolute;top:266px;left:599px;white-space:nowrap" class="ft764">. The server supports&#160;the&#160;</p>
<p style="position:absolute;top:285px;left:139px;white-space:nowrap" class="ft767">platform&#160;registration.&#160;This procedure involves registering Platform&#160;AIK&#160;<br/>certificate:&#160;the server saves&#160;the COREG in Master&#160;Repository.&#160;</p>
<p style="position:absolute;top:343px;left:112px;white-space:nowrap" class="ft764">2.</p>
<p style="position:absolute;top:343px;left:139px;white-space:nowrap" class="ft763"><b>Platform authentication</b></p>
<p style="position:absolute;top:343px;left:362px;white-space:nowrap" class="ft764">. The server supports&#160;the platform&#160;authentication:&#160;</p>
<p style="position:absolute;top:362px;left:139px;white-space:nowrap" class="ft767">the server logon system&#160;launches the platform&#160;authentication&#160;by calling a&#160;<br/>certain&#160;API&#160;function.&#160;</p>
<p style="position:absolute;top:420px;left:139px;white-space:nowrap" class="ft767">MFA&#160;server application&#160;retrieves&#160;the user policy and check it. After a successful&#160;<br/>policy checking, the server establishes secure communication&#160;channel with a&#160;<br/>remote&#160;MFA client using Secure protocol&#160;(OpenSSL library).</p>
<p style="position:absolute;top:497px;left:139px;white-space:nowrap" class="ft767">MFA&#160;server generates&#160;anti-reply challenge (CHALLENGE) and requests&#160;from&#160;MFA&#160;<br/>Client the PCRs&#160;signed using the AIK&#160;key.&#160;</p>
<p style="position:absolute;top:554px;left:139px;white-space:nowrap" class="ft767">MFA&#160;client receives&#160;CHALLENGE&#160;and retrieves the TPM Platform&#160;Configuration&#160;<br/>Registers&#160;(PCRs) values and the Platform&#160;AIK,&#160;sets up the Combined&#160;<br/>Authentication&#160;Information&#160;(COAUTH):- Platform&#160;ID (PID), CHALLENGE&#160;&#160;- Platform&#160;<br/>TPM&#160; PCRs.</p>
<p style="position:absolute;top:650px;left:139px;white-space:nowrap" class="ft764">COAUTH is signed with the Platform&#160;AIK&#160;to&#160;ensure the information&#160;integrity.&#160;</p>
<p style="position:absolute;top:689px;left:85px;white-space:nowrap" class="ft767">This Combined Authentication&#160;Information&#160;(COAUTH) is being send to the remote&#160;<br/>server&#160;for authentication.</p>
<p style="position:absolute;top:746px;left:138px;white-space:nowrap" class="ft767">MFA&#160;server receives&#160;COAUTH and proceeds with the platform&#160;authentication.&#160;It&#160;<br/>retrieves stored&#160;the platform&#160;information&#160;by PID, it verifies&#160;the signature and&#160;<br/>involves&#160;the verification&#160;of the Platform&#160;TPM PCRs.</p>
<p style="position:absolute;top:804px;left:110px;white-space:nowrap" class="ft764">&#160; &#160;</p>
<p style="position:absolute;top:823px;left:85px;white-space:nowrap" class="ft767">In this scenario&#160;network calls are&#160;synchronous.&#160;An established SSL channel is used as&#160;<br/>binary&#160;stream.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft7616">Open_TC Deliverable 6e.3</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft7616">7/16</p>
</div>
<!-- Page 77 -->
<a name="77"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page77-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables077.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7715">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft770">&#160;</p>
<p style="position:absolute;top:92px;left:278px;white-space:nowrap" class="ft7716">MFA Intermediate&#160;System&#160;Specification</p>
<p style="position:absolute;top:92px;left:664px;white-space:nowrap" class="ft7716">PUBLIC | 1.00</p>
<p style="position:absolute;top:723px;left:112px;white-space:nowrap" class="ft774">3.</p>
<p style="position:absolute;top:723px;left:139px;white-space:nowrap" class="ft773"><b>Authenticate&#160;user.</b></p>
<p style="position:absolute;top:723px;left:313px;white-space:nowrap" class="ft774">&#160;The server can&#160;verify user credentials. This&#160;basically relies&#160;</p>
<p style="position:absolute;top:743px;left:139px;white-space:nowrap" class="ft774">on the existing authentication&#160;infrastructure.</p>
<p style="position:absolute;top:771px;left:112px;white-space:nowrap" class="ft774">4.</p>
<p style="position:absolute;top:771px;left:139px;white-space:nowrap" class="ft773"><b>Edit&#160;user/platform policy for multifactor access.</b></p>
<p style="position:absolute;top:771px;left:585px;white-space:nowrap" class="ft774">&#160;The system&#160;administrator&#160;</p>
<p style="position:absolute;top:790px;left:139px;white-space:nowrap" class="ft777">can&#160;change the user policies on the server to determine the required credentials&#160;<br/>in order to logon to&#160;the server.</p>
<p style="position:absolute;top:837px;left:112px;white-space:nowrap" class="ft774">5.</p>
<p style="position:absolute;top:837px;left:139px;white-space:nowrap" class="ft773"><b>Enforce&#160;policy for server&#160;access.</b></p>
<p style="position:absolute;top:837px;left:441px;white-space:nowrap" class="ft774">&#160;The server can&#160;verify the user credentials&#160;</p>
<p style="position:absolute;top:857px;left:139px;white-space:nowrap" class="ft777">against&#160;a defined policy set and reject the logon if multifactor&#160;authentication&#160;<br/>fails.</p>
<p style="position:absolute;top:922px;left:85px;white-space:nowrap" class="ft7718"><b>4.2&#160;Policies</b></p>
<p style="position:absolute;top:952px;left:85px;white-space:nowrap" class="ft777">The policy&#160;determines what type authentication&#160;is required to access&#160;the remote&#160;<br/>service. The following policies will be defined:</p>
<p style="position:absolute;top:1002px;left:112px;white-space:nowrap" class="ft7744">●</p>
<p style="position:absolute;top:999px;left:139px;white-space:nowrap" class="ft774">The platform&#160;authentication is required (optional if&#160;policy is not set).</p>
<p style="position:absolute;top:1031px;left:112px;white-space:nowrap" class="ft7744">●</p>
<p style="position:absolute;top:1028px;left:139px;white-space:nowrap" class="ft777">The list&#160;of platforms&#160;the user is allowed to&#160;login from (the user can&#160;use any&#160;<br/>registered platform&#160;if&#160;this policy is not set).</p>
<p style="position:absolute;top:1093px;left:85px;white-space:nowrap" class="ft7718"><b>4.3&#160;Data structure&#160;organization&#160;example</b></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft7716">Open_TC Deliverable 6e.3</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft7716">8/16</p>
<p style="position:absolute;top:687px;left:322px;white-space:nowrap" class="ft7751"><i>Figure&#160;3: Platform&#160;authentication</i></p>
<p style="position:absolute;top:176px;left:112px;white-space:nowrap" class="ft7743">MFA_Client</p>
<p style="position:absolute;top:176px;left:362px;white-space:nowrap" class="ft7743">MFA_Server</p>
<p style="position:absolute;top:438px;left:222px;white-space:nowrap" class="ft7743">Unlock&#160;AIK&#160;with&#160;PCRs</p>
<p style="position:absolute;top:470px;left:222px;white-space:nowrap" class="ft7743">Compute&#160;Response</p>
<p style="position:absolute;top:565px;left:474px;white-space:nowrap" class="ft7743">Verify&#160;signature</p>
<p style="position:absolute;top:176px;left:676px;white-space:nowrap" class="ft7743">PAM&#160;Framework</p>
<p style="position:absolute;top:279px;left:474px;white-space:nowrap" class="ft7743">Check&#160;user&#160;policy&#160;(UserName)</p>
<p style="position:absolute;top:251px;left:430px;white-space:nowrap" class="ft7743">Authenticate&#160;(ClientHostName,&#160;UserName)</p>
<p style="position:absolute;top:315px;left:219px;white-space:nowrap" class="ft7743">Start&#160;SSL&#160;session</p>
<p style="position:absolute;top:346px;left:265px;white-space:nowrap" class="ft7743">OK</p>
<p style="position:absolute;top:374px;left:474px;white-space:nowrap" class="ft7743">Generate&#160;challenge</p>
<p style="position:absolute;top:378px;left:232px;white-space:nowrap" class="ft7743">CHALLENGE</p>
<p style="position:absolute;top:506px;left:170px;white-space:nowrap" class="ft7743">COAUTH&#160;(PID,&#160;PCRs,&#160;Signature&#160;)</p>
<p style="position:absolute;top:597px;left:474px;white-space:nowrap" class="ft7743">Verify&#160;PCRs</p>
<p style="position:absolute;top:310px;left:474px;white-space:nowrap" class="ft7743">Create&#160;SSL&#160;channel&#160;&#160;(ClientHostName)</p>
<p style="position:absolute;top:634px;left:484px;white-space:nowrap" class="ft7743">Authentication&#160;succeeded</p>
<p style="position:absolute;top:406px;left:222px;white-space:nowrap" class="ft7743">Retrive&#160;Platform&#160;ID&#160;(PID)</p>
<p style="position:absolute;top:534px;left:474px;white-space:nowrap" class="ft7743">Verify&#160;PID</p>
</div>
<!-- Page 78 -->
<a name="78"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft7860{font-size:17px;font-family:IAAAAA+LucidaConsole;color:#ffffff;}
	.ft7861{font-size:17px;font-family:IAAAAA+LucidaConsole;color:#000000;}
	.ft7862{font-size:15px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
	.ft7863{font-size:15px;font-family:JAAAAA+CourierNewPSMT;color:#000000;}
	.ft7864{font-size:15px;line-height:17px;font-family:JAAAAA+CourierNewPSMT;color:#000000;}
-->
</style>
<div id="page78-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables078.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7815">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft780">&#160;</p>
<p style="position:absolute;top:92px;left:278px;white-space:nowrap" class="ft7816">MFA Intermediate&#160;System&#160;Specification</p>
<p style="position:absolute;top:92px;left:664px;white-space:nowrap" class="ft7816">PUBLIC | 1.00</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft788">All data&#160;can be expressed as&#160;two&#160;tables.&#160;The first one is the “Registered Platforms”&#160;<br/>table. The second is a “Users Policies” table. “Registered Platforms”&#160;table consist&#160;of&#160;<br/>three columns: “Platform&#160;ID (PID)”;&#160;“PCRs”;&#160;“Public AIK”.&#160;“Platform&#160;ID (PID)” is the&#160;<br/>Primary&#160;Key (PK)&#160;of this&#160;table. “Users Policies” table also&#160;consists&#160;of three columns:&#160;<br/>“User Name”;&#160;“Policy”;&#160;“Platform&#160;IDs&#160;set” where “User Name” column is the Primary&#160;<br/>Key (PK)&#160;of this table.<br/>“Registered Platforms”&#160;table example:</p>
<p style="position:absolute;top:303px;left:85px;white-space:nowrap" class="ft7860">Platform&#160;ID&#160;</p>
<p style="position:absolute;top:320px;left:85px;white-space:nowrap" class="ft7860">(PID)</p>
<p style="position:absolute;top:303px;left:240px;white-space:nowrap" class="ft7860">PCRs</p>
<p style="position:absolute;top:303px;left:377px;white-space:nowrap" class="ft7860">Certificate&#160;</p>
<p style="position:absolute;top:320px;left:377px;white-space:nowrap" class="ft7860">(Public&#160;AIK)</p>
<p style="position:absolute;top:336px;left:85px;white-space:nowrap" class="ft7861">123987</p>
<p style="position:absolute;top:336px;left:240px;white-space:nowrap" class="ft7861">binary&#160;string&#160;binary&#160;string</p>
<p style="position:absolute;top:353px;left:85px;white-space:nowrap" class="ft7861">321789</p>
<p style="position:absolute;top:353px;left:240px;white-space:nowrap" class="ft7861">binary&#160;string&#160;binary&#160;string</p>
<p style="position:absolute;top:369px;left:85px;white-space:nowrap" class="ft7861">456654</p>
<p style="position:absolute;top:369px;left:240px;white-space:nowrap" class="ft7861">binary&#160;string&#160;binary&#160;string</p>
<p style="position:absolute;top:403px;left:85px;white-space:nowrap" class="ft784">“Users Policies” table example:</p>
<p style="position:absolute;top:431px;left:85px;white-space:nowrap" class="ft7860">User&#160;Name</p>
<p style="position:absolute;top:431px;left:234px;white-space:nowrap" class="ft7860">Policy</p>
<p style="position:absolute;top:431px;left:338px;white-space:nowrap" class="ft7860">Platform&#160;IDs&#160;set</p>
<p style="position:absolute;top:448px;left:85px;white-space:nowrap" class="ft7861">Jack</p>
<p style="position:absolute;top:448px;left:234px;white-space:nowrap" class="ft7861">exclude</p>
<p style="position:absolute;top:448px;left:338px;white-space:nowrap" class="ft7861">NULL</p>
<p style="position:absolute;top:464px;left:85px;white-space:nowrap" class="ft7861">Tom</p>
<p style="position:absolute;top:464px;left:234px;white-space:nowrap" class="ft7861">include</p>
<p style="position:absolute;top:464px;left:338px;white-space:nowrap" class="ft7861">321789;&#160;456654</p>
<p style="position:absolute;top:481px;left:85px;white-space:nowrap" class="ft7861">Bill</p>
<p style="position:absolute;top:481px;left:234px;white-space:nowrap" class="ft7861">include</p>
<p style="position:absolute;top:481px;left:338px;white-space:nowrap" class="ft7861">NULL</p>
<p style="position:absolute;top:527px;left:85px;white-space:nowrap" class="ft787">In this example Jack&#160;can use any client&#160;computer to&#160;login to the server. The TPM&#160;<br/>authentication will not be performed.&#160;Tom can&#160;use only two&#160;computers&#160;with a&#160;<br/>registered TPM to login to the server. Bill can&#160;use any computer with a registered TPM.</p>
<p style="position:absolute;top:612px;left:85px;white-space:nowrap" class="ft7810"><b>5&#160;&#160;Preliminary&#160;MFA&#160;API</b></p>
<p style="position:absolute;top:663px;left:85px;white-space:nowrap" class="ft7818"><b>5.1&#160;Data Types</b></p>
<p style="position:absolute;top:693px;left:85px;white-space:nowrap" class="ft784">This section describes the basic&#160;data&#160;types&#160;defined by this API.</p>
<p style="position:absolute;top:739px;left:85px;white-space:nowrap" class="ft7862"><b>Pointer&#160;Size:</b></p>
<p style="position:absolute;top:761px;left:85px;white-space:nowrap" class="ft784">Pointer size becomes&#160;32 bits on 32-bit systems&#160;and 64 bits with 64-bit system.</p>
<p style="position:absolute;top:798px;left:85px;white-space:nowrap" class="ft7862"><b>Basic Types:</b></p>
<p style="position:absolute;top:820px;left:85px;white-space:nowrap" class="ft787">There are some&#160;new types for 64-bit systems&#160;that were derived from the basic&#160;<br/>C_language integer and long types, so&#160;they work in existing code. These are the&#160;<br/>expected values&#160;and definitions.</p>
<p style="position:absolute;top:901px;left:89px;white-space:nowrap" class="ft7863">Type</p>
<p style="position:absolute;top:901px;left:238px;white-space:nowrap" class="ft7863">Definition</p>
<p style="position:absolute;top:927px;left:89px;white-space:nowrap" class="ft7863">UINT16</p>
<p style="position:absolute;top:927px;left:238px;white-space:nowrap" class="ft7863">Unsigned INT16</p>
<p style="position:absolute;top:952px;left:89px;white-space:nowrap" class="ft7863">UINT32</p>
<p style="position:absolute;top:952px;left:238px;white-space:nowrap" class="ft7863">Unsigned INT32</p>
<p style="position:absolute;top:977px;left:89px;white-space:nowrap" class="ft7863">BYTE</p>
<p style="position:absolute;top:977px;left:238px;white-space:nowrap" class="ft7863">Unsigned character</p>
<p style="position:absolute;top:1003px;left:89px;white-space:nowrap" class="ft7863">MFA_UNICODE</p>
<p style="position:absolute;top:1003px;left:238px;white-space:nowrap" class="ft7864">MFA_UNICODE character. MFA_UNICODE characters are to be&#160;<br/>treated as an array of 16 bits.</p>
<p style="position:absolute;top:1045px;left:89px;white-space:nowrap" class="ft7863">MFA_PVOID</p>
<p style="position:absolute;top:1045px;left:238px;white-space:nowrap" class="ft7863">void Pointer (32 or 64 bit depending on architecture)</p>
<p style="position:absolute;top:1084px;left:85px;white-space:nowrap" class="ft7862"><b>Derived Types:</b></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft7816">Open_TC Deliverable 6e.3</p>
<p style="position:absolute;top:1160px;left:774px;white-space:nowrap" class="ft7816">9/16</p>
</div>
<!-- Page 79 -->
<a name="79"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft7965{font-size:18px;font-family:KAAAAA+BitstreamVeraSans;color:#000000;}
	.ft7966{font-size:17px;font-family:KAAAAA+BitstreamVeraSans;color:#000000;}
	.ft7967{font-size:15px;line-height:17px;font-family:DAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page79-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables079.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7915">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft790">&#160;</p>
<p style="position:absolute;top:92px;left:278px;white-space:nowrap" class="ft7916">MFA Intermediate&#160;System&#160;Specification</p>
<p style="position:absolute;top:92px;left:664px;white-space:nowrap" class="ft7916">PUBLIC | 1.00</p>
<p style="position:absolute;top:155px;left:89px;white-space:nowrap" class="ft7963">Type</p>
<p style="position:absolute;top:155px;left:239px;white-space:nowrap" class="ft7963">Definition</p>
<p style="position:absolute;top:155px;left:398px;white-space:nowrap" class="ft7963">Usage</p>
<p style="position:absolute;top:181px;left:89px;white-space:nowrap" class="ft7963">MFA_HCONTEXT</p>
<p style="position:absolute;top:181px;left:239px;white-space:nowrap" class="ft7963">UINT32</p>
<p style="position:absolute;top:181px;left:398px;white-space:nowrap" class="ft7963">Context object handle</p>
<p style="position:absolute;top:206px;left:89px;white-space:nowrap" class="ft7963">MFA_FLAG</p>
<p style="position:absolute;top:206px;left:239px;white-space:nowrap" class="ft7963">UINT32</p>
<p style="position:absolute;top:206px;left:398px;white-space:nowrap" class="ft7963">Object attributes</p>
<p style="position:absolute;top:231px;left:89px;white-space:nowrap" class="ft7963">MFA_RESULT</p>
<p style="position:absolute;top:231px;left:239px;white-space:nowrap" class="ft7963">UINT32</p>
<p style="position:absolute;top:231px;left:398px;white-space:nowrap" class="ft7963">result of a MFA interface command</p>
<p style="position:absolute;top:271px;left:85px;white-space:nowrap" class="ft7962"><b>Common&#160;return code defines:</b></p>
<p style="position:absolute;top:297px;left:89px;white-space:nowrap" class="ft7963">Type</p>
<p style="position:absolute;top:297px;left:342px;white-space:nowrap" class="ft7963">Definition</p>
<p style="position:absolute;top:322px;left:89px;white-space:nowrap" class="ft7963">MFA_SUCCESS</p>
<p style="position:absolute;top:322px;left:342px;white-space:nowrap" class="ft7963">Success</p>
<p style="position:absolute;top:348px;left:89px;white-space:nowrap" class="ft7963">MFA_E_FAIL</p>
<p style="position:absolute;top:348px;left:342px;white-space:nowrap" class="ft7963">Non-specific failure</p>
<p style="position:absolute;top:373px;left:89px;white-space:nowrap" class="ft7963">MFA_E_BAD_ARGUMENT</p>
<p style="position:absolute;top:373px;left:342px;white-space:nowrap" class="ft7963">One or more parameter is bad.</p>
<p style="position:absolute;top:398px;left:89px;white-space:nowrap" class="ft7963">MFA_E_INTERNAL_ERROR</p>
<p style="position:absolute;top:398px;left:342px;white-space:nowrap" class="ft7963">An internal SW error has been&#160;detected.</p>
<p style="position:absolute;top:424px;left:89px;white-space:nowrap" class="ft7963">MFA_E_NOTIMPL</p>
<p style="position:absolute;top:424px;left:342px;white-space:nowrap" class="ft7963">Not implemented</p>
<p style="position:absolute;top:449px;left:89px;white-space:nowrap" class="ft7963">MFA_E_CANCELED</p>
<p style="position:absolute;top:449px;left:342px;white-space:nowrap" class="ft7963">The action was canceled</p>
<p style="position:absolute;top:474px;left:89px;white-space:nowrap" class="ft7963">MFA_E_TIMEOUT</p>
<p style="position:absolute;top:474px;left:342px;white-space:nowrap" class="ft7963">The operation has timed out</p>
<p style="position:absolute;top:500px;left:89px;white-space:nowrap" class="ft7963">MFA_E_OUTOFMEMORY</p>
<p style="position:absolute;top:500px;left:342px;white-space:nowrap" class="ft7963">Ran out of memory</p>
<p style="position:absolute;top:558px;left:85px;white-space:nowrap" class="ft7959"><b>5.2&#160;Structures</b></p>
<p style="position:absolute;top:589px;left:85px;white-space:nowrap" class="ft794">This section describes the structures&#160;defined by this API.</p>
<p style="position:absolute;top:636px;left:85px;white-space:nowrap" class="ft7965"><i><b>5.2.1 MFA_VERSION</b></i></p>
<p style="position:absolute;top:661px;left:85px;white-space:nowrap" class="ft797">This structure&#160;allows the MFA to&#160;communicate&#160;between various&#160;versions&#160;of client and&#160;<br/>server&#160;application&#160;components.</p>
<p style="position:absolute;top:719px;left:85px;white-space:nowrap" class="ft794">Definition:</p>
<p style="position:absolute;top:739px;left:192px;white-space:nowrap" class="ft7963">typedef struct tdMFA_VERSION</p>
<p style="position:absolute;top:756px;left:192px;white-space:nowrap" class="ft7964">{<br/>&#160; BYTE bMajor;</p>
<p style="position:absolute;top:790px;left:192px;white-space:nowrap" class="ft7964">&#160; BYTE bMinor;<br/>} MFA_VERSION;</p>
<p style="position:absolute;top:841px;left:85px;white-space:nowrap" class="ft794">Parameters:</p>
<p style="position:absolute;top:861px;left:192px;white-space:nowrap" class="ft7966"><i><b>bMajor</b></i></p>
<p style="position:absolute;top:880px;left:192px;white-space:nowrap" class="ft7967">This&#160;SHALL&#160;be&#160;the&#160;major&#160;version&#160;indicator&#160;for this implementation&#160;of the MFA&#160;<br/>specification.&#160;For version&#160;1&#160;this&#160;must&#160;be 0x01</p>
<p style="position:absolute;top:932px;left:192px;white-space:nowrap" class="ft7966"><i><b>bMinor</b></i></p>
<p style="position:absolute;top:952px;left:192px;white-space:nowrap" class="ft7916">This&#160;SHALL&#160;be&#160;the&#160;minor&#160;version indicator&#160;for this implementation&#160;of&#160;the&#160;MFA&#160;</p>
<p style="position:absolute;top:969px;left:192px;white-space:nowrap" class="ft7967">specification.&#160;For version&#160;1.0&#160;this&#160;must&#160;be&#160;0x00, for version 1.1,&#160;this&#160;must&#160;be&#160;<br/>0x01.</p>
<p style="position:absolute;top:1022px;left:85px;white-space:nowrap" class="ft7965"><i><b>5.2.1&#160;MFA_CONTEXT_INFO&#160;</b></i></p>
<p style="position:absolute;top:1047px;left:85px;white-space:nowrap" class="ft797">This structure&#160;provides information&#160;about context&#160;status.&#160;It&#160;used with&#160;<br/>mfa_S_Context_GetStatus&#160;and&#160;mfa_C_Context_GetStatus&#160;interface&#160;functions.</p>
<p style="position:absolute;top:1105px;left:85px;white-space:nowrap" class="ft794">Definition:</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft7916">Open_TC Deliverable 6e.3</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft7916">10/16</p>
</div>
<!-- Page 80 -->
<a name="80"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page80-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables080.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft8015">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft800">&#160;</p>
<p style="position:absolute;top:92px;left:278px;white-space:nowrap" class="ft8016">MFA Intermediate&#160;System&#160;Specification</p>
<p style="position:absolute;top:92px;left:664px;white-space:nowrap" class="ft8016">PUBLIC | 1.00</p>
<p style="position:absolute;top:151px;left:192px;white-space:nowrap" class="ft8063">typedef struct tdMFA_CONTEXT_INFO</p>
<p style="position:absolute;top:168px;left:192px;white-space:nowrap" class="ft8064">{<br/>&#160; MFA_VERSION versionInfo; &#160;</p>
<p style="position:absolute;top:202px;left:192px;white-space:nowrap" class="ft8064">&#160; MFA_RESULT &#160;lastError;<br/>} MFA_CONTEXT_INFO;</p>
<p style="position:absolute;top:253px;left:85px;white-space:nowrap" class="ft804">Parameters:</p>
<p style="position:absolute;top:272px;left:192px;white-space:nowrap" class="ft8066"><i><b>versionInfo</b></i></p>
<p style="position:absolute;top:292px;left:192px;white-space:nowrap" class="ft8016">Version&#160;data&#160;set by&#160;MFA&#160;interface function</p>
<p style="position:absolute;top:328px;left:192px;white-space:nowrap" class="ft8066"><i><b>lastError</b></i></p>
<p style="position:absolute;top:348px;left:192px;white-space:nowrap" class="ft8016">Last&#160;occurred&#160;error&#160;in&#160;current&#160;context</p>
<p style="position:absolute;top:383px;left:85px;white-space:nowrap" class="ft8059"><b>5.3&#160;Interface definition</b></p>
<p style="position:absolute;top:414px;left:85px;white-space:nowrap" class="ft807">The syntax&#160;used in describing the MFA&#160;application&#160;is based on the common&#160;procedural&#160;<br/>language constructs.&#160;Data types are&#160;described in terms&#160;of ANSI&#160;C.<br/>The MFA allocates&#160;memory&#160;for out&#160;parameters&#160;and provides&#160;a function&#160;to free the&#160;<br/>memory&#160;previously allocated&#160;by the MFA&#160;on a context&#160;object&#160;base. The calling&#160;<br/>application MUST free memory&#160;allocated&#160;by the MFA. The caller&#160;of the MFA&#160;interface&#160;<br/>functions is responsible for&#160;calling mfa_S_Context_FreeMemory&#160;or&#160;<br/>mfa_C_Context_FreeMemory&#160;for each call that&#160;produced allocation&#160;of memory.</p>
<p style="position:absolute;top:568px;left:85px;white-space:nowrap" class="ft807">The&#160;mfa_Context class&#160;represents a&#160;context of a&#160;connection to&#160;the server side MFA&#160;<br/>application&#160;core.</p>
<p style="position:absolute;top:625px;left:85px;white-space:nowrap" class="ft8065"><i><b>5.3.1&#160;mfa_Context_Create&#160;</b></i></p>
<p style="position:absolute;top:650px;left:85px;white-space:nowrap" class="ft807">This method returns a&#160;handle to a&#160;new server side context object. The context&#160;handle&#160;<br/>is used in various&#160;functions&#160;to assign&#160;resources&#160;to it.</p>
<p style="position:absolute;top:708px;left:85px;white-space:nowrap" class="ft804">Definition:</p>
<p style="position:absolute;top:727px;left:192px;white-space:nowrap" class="ft8063">MFA_RESULT&#160;mfa_Context_Create</p>
<p style="position:absolute;top:744px;left:192px;white-space:nowrap" class="ft8064">(&#160; &#160;&#160;<br/>&#160; &#160;&#160;MFA_HCONTEXT*&#160;phContext &#160; &#160;// out</p>
<p style="position:absolute;top:778px;left:192px;white-space:nowrap" class="ft8063">);</p>
<p style="position:absolute;top:812px;left:85px;white-space:nowrap" class="ft804">Parameters:</p>
<p style="position:absolute;top:831px;left:192px;white-space:nowrap" class="ft8066"><i><b>phContext</b></i></p>
<p style="position:absolute;top:852px;left:192px;white-space:nowrap" class="ft8016">Pointer&#160;to a variable that&#160;receives the handle&#160;to the created&#160;context&#160;object.</p>
<p style="position:absolute;top:887px;left:85px;white-space:nowrap" class="ft804">Return Values:</p>
<p style="position:absolute;top:906px;left:192px;white-space:nowrap" class="ft8067">MFA_SUCCESS<br/>MFA_E_BAD_ARGUMENT</p>
<p style="position:absolute;top:959px;left:85px;white-space:nowrap" class="ft8065"><i><b>5.3.2&#160;mfa_Context_Close</b></i></p>
<p style="position:absolute;top:985px;left:85px;white-space:nowrap" class="ft804">This method destroys&#160;a server&#160;side context&#160;and releases&#160;all assigned resources.</p>
<p style="position:absolute;top:1023px;left:85px;white-space:nowrap" class="ft804">Definition:</p>
<p style="position:absolute;top:1042px;left:192px;white-space:nowrap" class="ft8063">MFA_RESULT&#160;mfa_Context_Close</p>
<p style="position:absolute;top:1059px;left:192px;white-space:nowrap" class="ft8064">(<br/>&#160; &#160;&#160;MFA_HCONTEXT&#160;hContext &#160; &#160;// in</p>
<p style="position:absolute;top:1093px;left:192px;white-space:nowrap" class="ft8063">);</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft8016">Open_TC Deliverable 6e.3</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft8016">11/16</p>
</div>
<!-- Page 81 -->
<a name="81"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page81-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables081.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft8115">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft810">&#160;</p>
<p style="position:absolute;top:92px;left:278px;white-space:nowrap" class="ft8116">MFA Intermediate&#160;System&#160;Specification</p>
<p style="position:absolute;top:92px;left:664px;white-space:nowrap" class="ft8116">PUBLIC | 1.00</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft814">Parameters:</p>
<p style="position:absolute;top:170px;left:192px;white-space:nowrap" class="ft8166"><i><b>hContext</b></i></p>
<p style="position:absolute;top:189px;left:192px;white-space:nowrap" class="ft8116">Handle&#160;of the context object which is to be closed.</p>
<p style="position:absolute;top:224px;left:85px;white-space:nowrap" class="ft814">Return Values:</p>
<p style="position:absolute;top:244px;left:192px;white-space:nowrap" class="ft8167">MFA_SUCCESS<br/>MFA_E_INVALID_HANDLE</p>
<p style="position:absolute;top:279px;left:192px;white-space:nowrap" class="ft8116">MFA_E_INTERNAL_ERROR</p>
<p style="position:absolute;top:314px;left:85px;white-space:nowrap" class="ft8165"><i><b>5.3.3&#160;mfa_Context_GetStatus&#160;</b></i></p>
<p style="position:absolute;top:340px;left:85px;white-space:nowrap" class="ft814">This method provides operation status&#160;in specified context.</p>
<p style="position:absolute;top:378px;left:85px;white-space:nowrap" class="ft814">Definition:</p>
<p style="position:absolute;top:397px;left:192px;white-space:nowrap" class="ft8164">MFA_RESULT&#160;mfa_Context_GetStatus<br/>(</p>
<p style="position:absolute;top:431px;left:192px;white-space:nowrap" class="ft8164">&#160; &#160;&#160;MFA_HCONTEXT&#160; &#160; &#160; &#160;hContext, // in<br/>&#160; &#160;&#160;MFA_CONTEXT_INFO** ppStatus &#160;// out</p>
<p style="position:absolute;top:465px;left:192px;white-space:nowrap" class="ft8163">);</p>
<p style="position:absolute;top:499px;left:85px;white-space:nowrap" class="ft814">Parameters:</p>
<p style="position:absolute;top:519px;left:192px;white-space:nowrap" class="ft8166"><i><b>hContext</b></i></p>
<p style="position:absolute;top:538px;left:192px;white-space:nowrap" class="ft8116">Handle&#160;of the context object.</p>
<p style="position:absolute;top:557px;left:192px;white-space:nowrap" class="ft8166"><i><b>ppStatus</b></i></p>
<p style="position:absolute;top:576px;left:192px;white-space:nowrap" class="ft8167">Pointer&#160;to a variable that&#160;receives a pointer&#160;to&#160;the&#160;context&#160;information&#160;structure.&#160;<br/>When&#160;the use of the pointer&#160;ends,&#160;free&#160;the&#160;returned&#160;buffer&#160;by&#160;calling&#160;the&#160;</p>
<p style="position:absolute;top:611px;left:192px;white-space:nowrap" class="ft8116">mfa_S_Context_FreeMemory&#160;function.</p>
<p style="position:absolute;top:646px;left:85px;white-space:nowrap" class="ft814">Return Values:</p>
<p style="position:absolute;top:665px;left:192px;white-space:nowrap" class="ft8167">MFA_SUCCESS<br/>MFA_E_BAD_ARGUMENT</p>
<p style="position:absolute;top:700px;left:192px;white-space:nowrap" class="ft8167">MFA_E_INVALID_HANDLE<br/>MFA_E_INTERNAL_ERROR</p>
<p style="position:absolute;top:753px;left:85px;white-space:nowrap" class="ft8118"><b>5.3.4&#160;mfa_Context_FreeMemory&#160;</b></p>
<p style="position:absolute;top:779px;left:85px;white-space:nowrap" class="ft814">This method frees&#160;memory allocated&#160;by MFA application&#160;on a&#160;server side context&#160;base.</p>
<p style="position:absolute;top:817px;left:85px;white-space:nowrap" class="ft814">Definition:</p>
<p style="position:absolute;top:836px;left:192px;white-space:nowrap" class="ft8163">MFA_RESULT&#160;mfa_Context_FreeMemory</p>
<p style="position:absolute;top:853px;left:192px;white-space:nowrap" class="ft8164">(<br/>&#160; &#160;&#160;MFA_HCONTEXT&#160;hContext, // in</p>
<p style="position:absolute;top:887px;left:192px;white-space:nowrap" class="ft8164">&#160; &#160; BYTE* &#160; &#160; &#160; &#160;rgbMemory&#160;// in<br/>);</p>
<p style="position:absolute;top:938px;left:85px;white-space:nowrap" class="ft814">Parameters:</p>
<p style="position:absolute;top:958px;left:192px;white-space:nowrap" class="ft8166"><i><b>hContext</b></i></p>
<p style="position:absolute;top:977px;left:192px;white-space:nowrap" class="ft8116">Handle&#160;of the context object.</p>
<p style="position:absolute;top:994px;left:192px;white-space:nowrap" class="ft8166"><i><b>rgbMemory</b></i></p>
<p style="position:absolute;top:1014px;left:192px;white-space:nowrap" class="ft8116">Pointer&#160;to the memory block to&#160;be deallocated.</p>
<p style="position:absolute;top:1048px;left:85px;white-space:nowrap" class="ft814">Return Values:</p>
<p style="position:absolute;top:1088px;left:192px;white-space:nowrap" class="ft8167">MFA_SUCCESS<br/>MFA_E_INVALID_HANDLE</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft8116">Open_TC Deliverable 6e.3</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft8116">12/16</p>
</div>
<!-- Page 82 -->
<a name="82"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page82-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables082.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft8215">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft820">&#160;</p>
<p style="position:absolute;top:92px;left:278px;white-space:nowrap" class="ft8216">MFA Intermediate&#160;System&#160;Specification</p>
<p style="position:absolute;top:92px;left:664px;white-space:nowrap" class="ft8216">PUBLIC | 1.00</p>
<p style="position:absolute;top:151px;left:192px;white-space:nowrap" class="ft8267">MFA_E_INTERNAL_ERROR<br/>MFA_E_INVALID_RESOURCE</p>
<p style="position:absolute;top:204px;left:85px;white-space:nowrap" class="ft8265"><i><b>5.3.5&#160;mfa_S_RegisterPlatform&#160;</b></i></p>
<p style="position:absolute;top:229px;left:85px;white-space:nowrap" class="ft827">This method store&#160;platform&#160;registration&#160;information&#160;received from remote&#160;client as&#160;<br/>Platform&#160;Identity for future use in authentication&#160;process.</p>
<p style="position:absolute;top:287px;left:85px;white-space:nowrap" class="ft824">Definition:</p>
<p style="position:absolute;top:306px;left:192px;white-space:nowrap" class="ft8263">MFA_RESULT&#160;mfa_S_RegisterPlatform</p>
<p style="position:absolute;top:323px;left:192px;white-space:nowrap" class="ft8264">(<br/>&#160; &#160;&#160;MFA_HCONTEXT&#160;hContext, &#160; &#160; &#160;// in</p>
<p style="position:absolute;top:357px;left:192px;white-space:nowrap" class="ft8264">&#160; &#160; BYTE*&#160;&#160; &#160; &#160; &#160;pPltmInfoData, // in<br/>&#160; &#160; UINT32 &#160; &#160; &#160; pltmInfoSize &#160; // out</p>
<p style="position:absolute;top:391px;left:192px;white-space:nowrap" class="ft8263">);</p>
<p style="position:absolute;top:426px;left:85px;white-space:nowrap" class="ft824">Parameters:</p>
<p style="position:absolute;top:445px;left:192px;white-space:nowrap" class="ft8266"><i><b>hContext</b></i></p>
<p style="position:absolute;top:464px;left:192px;white-space:nowrap" class="ft8216">Handle&#160;of the context object.</p>
<p style="position:absolute;top:481px;left:192px;white-space:nowrap" class="ft8266"><i><b>pPltmInfoData</b></i></p>
<p style="position:absolute;top:501px;left:192px;white-space:nowrap" class="ft8216">Pointer&#160;to a buffer&#160;containing&#160;the platform&#160;registration&#160;information&#160;(COREG).</p>
<p style="position:absolute;top:518px;left:192px;white-space:nowrap" class="ft8266"><i><b>pltmInfoSize</b></i></p>
<p style="position:absolute;top:537px;left:192px;white-space:nowrap" class="ft8216">Size&#160;of&#160;the&#160;information&#160;pointed&#160;to by&#160;the&#160;</p>
<p style="position:absolute;top:537px;left:501px;white-space:nowrap" class="ft8251"><i>pPltmInfoData</i></p>
<p style="position:absolute;top:537px;left:609px;white-space:nowrap" class="ft8216">&#160;parameter, in bytes.</p>
<p style="position:absolute;top:573px;left:85px;white-space:nowrap" class="ft8265"><i><b>5.3.6&#160;mfa_S_Authenticate</b></i></p>
<p style="position:absolute;top:598px;left:85px;white-space:nowrap" class="ft824">This method provides remote platform&#160;authentication.</p>
<p style="position:absolute;top:637px;left:85px;white-space:nowrap" class="ft824">Definition:</p>
<p style="position:absolute;top:656px;left:192px;white-space:nowrap" class="ft8263">MFA_RESULT&#160;mfa_S_Authenticate</p>
<p style="position:absolute;top:673px;left:192px;white-space:nowrap" class="ft8264">(<br/>&#160; &#160;&#160;MFA_HCONTEXT&#160;hContext, &#160; &#160; &#160; &#160;// in</p>
<p style="position:absolute;top:707px;left:192px;white-space:nowrap" class="ft8264">&#160; &#160;&#160;MFA_UNICODE* userName, &#160; &#160; &#160; &#160;// in<br/>&#160; &#160;&#160;MFA_UNICODE* platformHostName // in</p>
<p style="position:absolute;top:741px;left:192px;white-space:nowrap" class="ft8263">);</p>
<p style="position:absolute;top:775px;left:85px;white-space:nowrap" class="ft824">Parameters:</p>
<p style="position:absolute;top:794px;left:192px;white-space:nowrap" class="ft8266"><i><b>hContext</b></i></p>
<p style="position:absolute;top:813px;left:192px;white-space:nowrap" class="ft8216">Handle&#160;of the context object which is to be closed.</p>
<p style="position:absolute;top:831px;left:192px;white-space:nowrap" class="ft8266"><i><b>userName</b></i></p>
<p style="position:absolute;top:850px;left:192px;white-space:nowrap" class="ft8216">Pointer&#160;to the&#160;MFA_UNICODE string&#160;contain&#160;name of the user</p>
<p style="position:absolute;top:869px;left:192px;white-space:nowrap" class="ft8266"><i><b>platformHostName</b></i></p>
<p style="position:absolute;top:891px;left:192px;white-space:nowrap" class="ft8216">Pointer&#160;to the&#160;MFA_UNICODE string&#160;contain&#160;name of the client&#160;host platform</p>
<p style="position:absolute;top:928px;left:85px;white-space:nowrap" class="ft8265"><i><b>5.3.7&#160;mfa_S_SetAccessPolicy</b></i></p>
<p style="position:absolute;top:953px;left:85px;white-space:nowrap" class="ft824">This method sets&#160;user&#160;access&#160;policy. That&#160;data&#160;is used during authentication&#160;process.</p>
<p style="position:absolute;top:991px;left:85px;white-space:nowrap" class="ft824">Definition:</p>
<p style="position:absolute;top:1011px;left:192px;white-space:nowrap" class="ft8264">MFA_RESULT&#160;mfa_S_SetAccessPolicy<br/>(</p>
<p style="position:absolute;top:1045px;left:192px;white-space:nowrap" class="ft8264">&#160; &#160;&#160;MFA_HCONTEXT&#160;hContext, &#160; &#160; &#160;// in<br/>&#160; &#160; BYTE*&#160;&#160; &#160; &#160; &#160;pPolInfoData, // in</p>
<p style="position:absolute;top:1079px;left:192px;white-space:nowrap" class="ft8264">&#160; &#160; UINT32 &#160; &#160; &#160; pPolInfoSize &#160;// in<br/>);</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft8216">Open_TC Deliverable 6e.3</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft8216">13/16</p>
</div>
<!-- Page 83 -->
<a name="83"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page83-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables083.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft8315">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft830">&#160;</p>
<p style="position:absolute;top:92px;left:278px;white-space:nowrap" class="ft8316">MFA Intermediate&#160;System&#160;Specification</p>
<p style="position:absolute;top:92px;left:664px;white-space:nowrap" class="ft8316">PUBLIC | 1.00</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft834">Parameters:</p>
<p style="position:absolute;top:170px;left:192px;white-space:nowrap" class="ft8366"><i><b>hContext</b></i></p>
<p style="position:absolute;top:189px;left:192px;white-space:nowrap" class="ft8316">Handle&#160;of the context object.</p>
<p style="position:absolute;top:207px;left:192px;white-space:nowrap" class="ft8366"><i><b>pPolInfoData</b></i></p>
<p style="position:absolute;top:226px;left:192px;white-space:nowrap" class="ft8316">Pointer&#160;to a buffer&#160;containing&#160;the &#160;user&#160;policy&#160;information.</p>
<p style="position:absolute;top:244px;left:192px;white-space:nowrap" class="ft8366"><i><b>pltmInfoSize</b></i></p>
<p style="position:absolute;top:263px;left:192px;white-space:nowrap" class="ft8316">Size&#160;of&#160;the&#160;information&#160;pointed&#160;to by&#160;the&#160;</p>
<p style="position:absolute;top:263px;left:501px;white-space:nowrap" class="ft8351"><i>pPolInfoData</i></p>
<p style="position:absolute;top:263px;left:598px;white-space:nowrap" class="ft8316">&#160;parameter,&#160;in&#160;bytes.</p>
<p style="position:absolute;top:298px;left:85px;white-space:nowrap" class="ft8365"><i><b>5.3.8&#160;mfa_S_GetAccessPolicy</b></i></p>
<p style="position:absolute;top:324px;left:85px;white-space:nowrap" class="ft834">This method gets user access&#160;policy.&#160;That data&#160;is used during authentication&#160;process.</p>
<p style="position:absolute;top:362px;left:85px;white-space:nowrap" class="ft834">Definition:</p>
<p style="position:absolute;top:381px;left:192px;white-space:nowrap" class="ft8364">MFA_RESULT&#160;mfa_S_GetAccessPolicy<br/>(</p>
<p style="position:absolute;top:415px;left:192px;white-space:nowrap" class="ft8364">&#160; &#160;&#160;MFA_HCONTEXT&#160;hContext, &#160; &#160; &#160;// in<br/>&#160; &#160; BYTE*&#160;&#160; &#160; &#160; &#160;pPolInfoData, // out</p>
<p style="position:absolute;top:450px;left:192px;white-space:nowrap" class="ft8364">&#160; &#160; UINT32* &#160; &#160; pPolInfoSize &#160;// in/out<br/>);</p>
<p style="position:absolute;top:501px;left:85px;white-space:nowrap" class="ft834">Parameters:</p>
<p style="position:absolute;top:520px;left:192px;white-space:nowrap" class="ft8366"><i><b>hContext</b></i></p>
<p style="position:absolute;top:539px;left:192px;white-space:nowrap" class="ft8316">Handle&#160;of the context object.</p>
<p style="position:absolute;top:556px;left:192px;white-space:nowrap" class="ft8366"><i><b>pPolInfoData</b></i></p>
<p style="position:absolute;top:576px;left:192px;white-space:nowrap" class="ft8316">Pointer&#160;to a buffer&#160;with user policy information.</p>
<p style="position:absolute;top:593px;left:192px;white-space:nowrap" class="ft8366"><i><b>pltmInfoSize</b></i></p>
<p style="position:absolute;top:612px;left:192px;white-space:nowrap" class="ft8316">Pointer&#160;to size&#160;of&#160;the&#160;information&#160;pointed&#160;to by&#160;the&#160;</p>
<p style="position:absolute;top:612px;left:578px;white-space:nowrap" class="ft8351"><i>pPolInfoData</i></p>
<p style="position:absolute;top:612px;left:674px;white-space:nowrap" class="ft8316">&#160;parameter,&#160;in&#160;</p>
<p style="position:absolute;top:630px;left:192px;white-space:nowrap" class="ft8316">bytes.</p>
<p style="position:absolute;top:665px;left:85px;white-space:nowrap" class="ft8365"><i><b>5.3.9&#160;mfa_Platform_Initialize&#160;</b></i></p>
<p style="position:absolute;top:691px;left:85px;white-space:nowrap" class="ft834">This methods takes&#160;TPM ownership, create Platform&#160;AIK.</p>
<p style="position:absolute;top:729px;left:85px;white-space:nowrap" class="ft834">Definition:</p>
<p style="position:absolute;top:748px;left:192px;white-space:nowrap" class="ft8363">MFA_RESULT&#160;mfa_Initialize</p>
<p style="position:absolute;top:765px;left:192px;white-space:nowrap" class="ft8364">(&#160; &#160;&#160;<br/>);</p>
<p style="position:absolute;top:816px;left:85px;white-space:nowrap" class="ft834">Parameters:</p>
<p style="position:absolute;top:871px;left:85px;white-space:nowrap" class="ft834">Return Values:</p>
<p style="position:absolute;top:890px;left:192px;white-space:nowrap" class="ft8316">MFA_SUCCESS</p>
<p style="position:absolute;top:925px;left:85px;white-space:nowrap" class="ft8365"><i><b>5.3.10&#160;mfa_C_GetPlaformData</b></i></p>
<p style="position:absolute;top:951px;left:85px;white-space:nowrap" class="ft834">This method retrieves&#160;the platform&#160;information.</p>
<p style="position:absolute;top:989px;left:85px;white-space:nowrap" class="ft834">Definition:</p>
<p style="position:absolute;top:1008px;left:192px;white-space:nowrap" class="ft8364">MFA_RESULT&#160;mfa_C_GetPlatformData<br/>(</p>
<p style="position:absolute;top:1042px;left:192px;white-space:nowrap" class="ft8364">&#160; &#160;&#160;MFA_HCONTEXT&#160;hContext, &#160; &#160; &#160; // in<br/>&#160; &#160; BYTE**&#160;&#160; &#160; &#160; ppPltmInfoData, // out</p>
<p style="position:absolute;top:1077px;left:192px;white-space:nowrap" class="ft8364">&#160; &#160; UINT32* &#160; &#160; &#160;pPltmInfoSize &#160; // out<br/>);</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft8316">Open_TC Deliverable 6e.3</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft8316">14/16</p>
</div>
<!-- Page 84 -->
<a name="84"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page84-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables084.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft8415">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft840">&#160;</p>
<p style="position:absolute;top:92px;left:278px;white-space:nowrap" class="ft8416">MFA Intermediate&#160;System&#160;Specification</p>
<p style="position:absolute;top:92px;left:664px;white-space:nowrap" class="ft8416">PUBLIC | 1.00</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft844">Parameters:</p>
<p style="position:absolute;top:170px;left:192px;white-space:nowrap" class="ft8466"><i><b>hContext</b></i></p>
<p style="position:absolute;top:189px;left:192px;white-space:nowrap" class="ft8416">Handle&#160;of the context object.</p>
<p style="position:absolute;top:208px;left:192px;white-space:nowrap" class="ft8466"><i><b>ppPltmInfoData</b></i></p>
<p style="position:absolute;top:228px;left:192px;white-space:nowrap" class="ft8416">Pointer&#160;to a variable that&#160;receives a pointer&#160;to&#160;the&#160;buffer&#160;which contain&#160;the&#160;</p>
<p style="position:absolute;top:245px;left:192px;white-space:nowrap" class="ft8467">platform&#160;information.&#160;When the use of the pointer ends, free the returned&#160;buffer&#160;<br/>by&#160;calling&#160;the&#160;mfa_S_Context_FreeMemory&#160;function.</p>
<p style="position:absolute;top:282px;left:192px;white-space:nowrap" class="ft8466"><i><b>pPltmInfoSize</b></i></p>
<p style="position:absolute;top:301px;left:192px;white-space:nowrap" class="ft8416">Pointer&#160;to a variable that&#160;receives the size&#160;of&#160;the&#160;buffer&#160;pointed&#160;to the&#160;</p>
<p style="position:absolute;top:319px;left:192px;white-space:nowrap" class="ft8451"><i>ppPltmInfoData&#160;</i></p>
<p style="position:absolute;top:319px;left:313px;white-space:nowrap" class="ft8416">parameter, in bytes. When the function&#160;returns,&#160;the UINT32&#160;</p>
<p style="position:absolute;top:336px;left:192px;white-space:nowrap" class="ft8416">value contains&#160;the number&#160;of&#160;bytes&#160;stored in the buffer.</p>
<p style="position:absolute;top:372px;left:85px;white-space:nowrap" class="ft8410"><b>6&#160;&#160;List of abbreviations</b></p>
<p style="position:absolute;top:405px;left:85px;white-space:nowrap" class="ft847">Listing of term definitions and abbreviations&#160;used in this document&#160;(IT expressions and&#160;<br/>terms&#160;from the application&#160;domain).</p>
<p style="position:absolute;top:463px;left:95px;white-space:nowrap" class="ft843"><b>Abbreviation</b></p>
<p style="position:absolute;top:463px;left:302px;white-space:nowrap" class="ft843"><b>Explanation</b></p>
<p style="position:absolute;top:482px;left:95px;white-space:nowrap" class="ft844">AIK</p>
<p style="position:absolute;top:482px;left:302px;white-space:nowrap" class="ft844">Attestation&#160;Identity Key</p>
<p style="position:absolute;top:501px;left:95px;white-space:nowrap" class="ft844">API</p>
<p style="position:absolute;top:501px;left:302px;white-space:nowrap" class="ft844">Application&#160;Programming&#160;Interface</p>
<p style="position:absolute;top:520px;left:95px;white-space:nowrap" class="ft844">MFA</p>
<p style="position:absolute;top:520px;left:302px;white-space:nowrap" class="ft844">MultiFactor&#160;Authentication</p>
<p style="position:absolute;top:540px;left:95px;white-space:nowrap" class="ft844">OS</p>
<p style="position:absolute;top:540px;left:302px;white-space:nowrap" class="ft844">Operating System</p>
<p style="position:absolute;top:559px;left:95px;white-space:nowrap" class="ft844">PCR</p>
<p style="position:absolute;top:559px;left:302px;white-space:nowrap" class="ft844">Platform&#160;Configuration&#160;Register</p>
<p style="position:absolute;top:578px;left:95px;white-space:nowrap" class="ft844">SSL</p>
<p style="position:absolute;top:578px;left:302px;white-space:nowrap" class="ft844">Secure Sockets Layer</p>
<p style="position:absolute;top:598px;left:95px;white-space:nowrap" class="ft844">TC</p>
<p style="position:absolute;top:598px;left:302px;white-space:nowrap" class="ft844">Trusted Computing</p>
<p style="position:absolute;top:617px;left:95px;white-space:nowrap" class="ft844">TCB</p>
<p style="position:absolute;top:617px;left:302px;white-space:nowrap" class="ft844">Trusted Computing Base</p>
<p style="position:absolute;top:636px;left:95px;white-space:nowrap" class="ft844">TCG</p>
<p style="position:absolute;top:636px;left:302px;white-space:nowrap" class="ft844">Trusted Computing Group</p>
<p style="position:absolute;top:655px;left:95px;white-space:nowrap" class="ft844">TPM</p>
<p style="position:absolute;top:655px;left:302px;white-space:nowrap" class="ft844">Trusted Platform&#160;Module</p>
<p style="position:absolute;top:675px;left:95px;white-space:nowrap" class="ft844">TSS</p>
<p style="position:absolute;top:675px;left:302px;white-space:nowrap" class="ft844">Trusted Software&#160;Stack</p>
<p style="position:absolute;top:740px;left:85px;white-space:nowrap" class="ft8410"><b>7&#160;&#160;Referenced Documents</b></p>
<p style="position:absolute;top:773px;left:85px;white-space:nowrap" class="ft844">/1/ TCG&#160;Specification,&#160;Architecture&#160;Overview.</p>
<p style="position:absolute;top:793px;left:85px;white-space:nowrap" class="ft8413">http://www.trustedcomputing.org</p>
<p style="position:absolute;top:812px;left:85px;white-space:nowrap" class="ft847">April 28, 2004,&#160;<br/>Version 1.2&#160;</p>
<p style="position:absolute;top:869px;left:85px;white-space:nowrap" class="ft847">/2/ TCG&#160;Software Stack&#160;(TSS) Specification<br/>January&#160;6, 2006,&#160;<br/>Version 1.2</p>
<p style="position:absolute;top:946px;left:85px;white-space:nowrap" class="ft844">/3/ PAM</p>
<p style="position:absolute;top:965px;left:85px;white-space:nowrap" class="ft8414">http://www.kernel.org/pub/linux/libs/pam/Linux-PAM-html/Linux-<br/><a href="http://msdn.microsoft.com/">PAM_ADG.html</a></p>
<p style="position:absolute;top:985px;left:85px;white-space:nowrap" class="ft8413">&#160;&#160;</p>
<p style="position:absolute;top:985px;left:209px;white-space:nowrap" class="ft8413"><a href="http://msdn.microsoft.com/">http://msdn.microsoft.com</a></p>
<p style="position:absolute;top:985px;left:209px;white-space:nowrap" class="ft8413"><a href="http://msdn.microsoft.com/">&#160;&#160;</a></p>
<p style="position:absolute;top:1004px;left:85px;white-space:nowrap" class="ft844">Version 0.99.6.0, 5. August&#160;2006.</p>
<p style="position:absolute;top:1042px;left:85px;white-space:nowrap" class="ft844">/4/ Secure Coding Guidelines</p>
<p style="position:absolute;top:1061px;left:85px;white-space:nowrap" class="ft8413"><a href="http://msdn.microsoft.com/">http://msdn.microsoft.com</a></p>
<p style="position:absolute;top:1081px;left:85px;white-space:nowrap" class="ft844">2004</p>
<p style="position:absolute;top:1119px;left:85px;white-space:nowrap" class="ft844">/5/ Improving&#160;Web Application&#160;Security:&#160;Threats and Countermeasures</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft8416">Open_TC Deliverable 6e.3</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft8416">15/16</p>
</div>
<!-- Page 85 -->
<a name="85"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page85-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OTC_D06.1_Collection_of_WP6_Deliverables085.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft8515">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft850">&#160;</p>
<p style="position:absolute;top:92px;left:278px;white-space:nowrap" class="ft8516">MFA Intermediate&#160;System&#160;Specification</p>
<p style="position:absolute;top:92px;left:664px;white-space:nowrap" class="ft8516">PUBLIC | 1.00</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft8513"><a href="http://msdn.microsoft.com/">http://msdn.microsoft.com</a></p>
<p style="position:absolute;top:189px;left:85px;white-space:nowrap" class="ft854">/6/ Writing Secure Code, Second&#160;Edition, by Michael Howard, David C. LeBlanc</p>
<p style="position:absolute;top:228px;left:85px;white-space:nowrap" class="ft854">/7/ OpenSSL Toolkit<a href="http://www.openssl.org/">&#160;</a></p>
<p style="position:absolute;top:228px;left:252px;white-space:nowrap" class="ft8513"><a href="http://www.openssl.org/">www.openssl.org/</a></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft8516">Open_TC Deliverable 6e.3</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft8516">16/16</p>
</div>
<hr/>
<a name="outline"></a><h1>Document Outline</h1>
<ul>
<li>otcW06_ADDENDUM_to_D6.1_and_D6.2_almost-final.pdf
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#2">1 Introduction</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#2">2 &#160;Workpackage 6's context and purpose</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#2">3 &#160;Use of TC technology in Sub-workpackages 6.a and 6.e</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#2">3.1 SWP06.a: Interoperable DRM solution based on MPEG-21</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#3">3.2 SWP06.e: MultiFactor Authentication (MFA)</a></li>
</ul>
</li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#4">4 List of abbreviations</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#5">5 Referenced Documents</a></li>
</ul>
</li>
<li>otcW06-D6a1-v02-Preliminary_DRM_system_specification.pdf
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#10">1.Introduction</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#10">2.Use Cases</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#10">2.1Overview</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#11">2.2Description of Use Cases</a></li>
</ul>
</li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#18">3.Design Specifications</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#18">3.1Architecture</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#18">3.2Player API</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#18">3.2.1Registration</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#19">3.2.2Content Key Handling</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#19">3.2.3Legacy Player Application</a></li>
</ul>
</li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#20">3.3Manager API</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#20">3.4Application loader</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#20">3.5Core Manager</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#20">3.6License Manager</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#21">3.6.1License Interpreter</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#21">3.6.2License Translation Manager&#160;</a></li>
</ul>
</li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#22">3.7State Management</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#23">3.8Sealed store</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#23">3.8.1Key store</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#23">3.8.2License store</a></li>
</ul>
</li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#23">3.9Utility library</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#24">3.10OS Services</a></li>
</ul>
</li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#25">4.Component Interaction</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#25">4.1Functional parts of the DRM Core&#160;</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#26">4.2Sequence diagram</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#27">4.3DRM system and XEN/L4 virtualization environments</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#27">4.3.1DRM components and compartments</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#28">4.3.2Interfaces between compartments</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#29">5.Requirements from other Partners</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#30">6.Technical API Specification</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#30">6.1External Interfaces</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#30">6.1.1class PlayerInterface</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#31">6.1.2class ManagementInterface</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#31">6.1.3class Utility</a></li>
</ul>
</li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#32">6.2Internal Interfaces</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#32">6.2.1Class DatabaseManager</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#33">6.2.2Class InterpreterInterface</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#34">6.2.3class SystemState</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#34">6.2.4class CoreManager</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#34">6.2.5class LicenseManager</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#35">6.2.6class LicenseTranslationManager</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#36">6.2.7class StateManager</a></li>
</ul>
</li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#37">6.3Helper Classes</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#37">6.3.1class ItemReference</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#37">6.3.2class ItemState</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#37">6.3.3class Key</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#38">6.3.4class License</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#38">6.3.5class PlayerState</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#39">6.3.6class REL</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#41">7.Annex A : C++ Header definition</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#43">8.Glossary of Abbreviations</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#44">9.References</a></li>
</ul>
</li>
<li>otcW06-D6e1-v01-MFA_Requirements_And_Specification.pdf
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#48">1 Introduction&#160;</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#48">2 Threat analysis</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#50">3 Functional requirements</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#50">3.1 Roles and Actors</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#51">3.2 Use cases</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#51">3.2.1 Client/server Installation of MFA components</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#53">3.2.2 Client Initialization</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#54">3.2.3 Platform registration</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#55">3.2.4 Platform unregistration</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#56">3.2.5 User Registration</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#57">3.2.6 Client logon</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#58">3.2.7 Client logoff</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#59">3.2.8 User/platform authentication</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#60">3.2.9 Using a remote server secure application/service</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#61">3.2.10 Server policy configuration</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#62">3.2.11 Platform registration on the server</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#63">3.2.12 Server logon session</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#64">4 &#160;High level design</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#64">4.1 Client operations</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#64">4.2 Server functionality</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#66">4.3 &#160;MFA system architecture</a></li>
</ul>
</li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#67">5 Required services from sublayers</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#67">6 &#160;Environment requirements&#160;</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#68">7 &#160;Platform requirements</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#68">8 List of abbreviations</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#68">9 Referenced Documents</a></li>
</ul>
</li>
<li>otcW06-D6e3-v01-MFA_Intermediate_System_Specification.pdf
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#73">1 Introduction</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#73">2 Requirements breakdown</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#73">3 High level design specification</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#75">4 Functionality</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#75">4.1Actions</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#77">4.2Policies</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#77">4.3Data structure organization example</a></li>
</ul>
</li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#78">5 Preliminary MFA API</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#78">5.1Data Types</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#78">Pointer Size:</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#78">Basic Types:</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#78">Derived Types:</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#79">Common return code defines:</a></li>
</ul>
</li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#79">5.2Structures</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#79">5.2.1 MFA_VERSION</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#79">5.2.1MFA_CONTEXT_INFO&#160;</a></li>
</ul>
</li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#80">5.3Interface definition</a>
<ul>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#80">5.3.1mfa_Context_Create&#160;</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#80">5.3.2mfa_Context_Close</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#81">5.3.3mfa_Context_GetStatus&#160;</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#81">5.3.4mfa_Context_FreeMemory&#160;</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#82">5.3.5mfa_S_RegisterPlatform&#160;</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#82">5.3.6mfa_S_Authenticate</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#82">5.3.7mfa_S_SetAccessPolicy</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#83">5.3.8mfa_S_GetAccessPolicy</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#83">5.3.9mfa_Platform_Initialize&#160;</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#83">5.3.10mfa_C_GetPlaformData</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#84">6 List of abbreviations</a></li>
<li><a href="OTC_D06.1_Collection_of_WP6_Deliverables.html#84">7 Referenced Documents</a></li>
</ul>
</li>
</ul>
</body>
</html>
