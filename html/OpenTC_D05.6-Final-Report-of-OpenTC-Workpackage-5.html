<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>html/OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="generator" content="pdftohtml 0.36"/>
<meta name="date" content="2009-01-15T15:54:25+00:00"/>
<style type="text/css">
<!--
.xflip {
    -moz-transform: scaleX(-1);
    -webkit-transform: scaleX(-1);
    -o-transform: scaleX(-1);
    transform: scaleX(-1);
    filter: fliph;
}
.yflip {
    -moz-transform: scaleY(-1);
    -webkit-transform: scaleY(-1);
    -o-transform: scaleY(-1);
    transform: scaleY(-1);
    filter: flipv;
}
.xyflip {
    -moz-transform: scaleX(-1) scaleY(-1);
    -webkit-transform: scaleX(-1) scaleY(-1);
    -o-transform: scaleX(-1) scaleY(-1);
    transform: scaleX(-1) scaleY(-1);
    filter: fliph + flipv;
}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<!-- Page 1 -->
<a name="1"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft10{font-size:27px;font-family:HHCLFJ+BitstreamVeraSans;color:#000000;}
	.ft11{font-size:16px;font-family:HHCLFJ+BitstreamVeraSans;color:#000000;}
	.ft12{font-size:16px;font-family:HHCLIK+BitstreamVeraSans;color:#000000;}
	.ft13{font-size:10px;font-family:HHCLIK+BitstreamVeraSans;color:#000000;}
	.ft14{font-size:16px;line-height:19px;font-family:HHCLIK+BitstreamVeraSans;color:#000000;}
	.ft15{font-size:16px;line-height:19px;font-family:HHCLFJ+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page1-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5001.png" alt="background image"/>
<p style="position:absolute;top:188px;left:98px;white-space:nowrap" class="ft10"><b>D05.6 Final Report of OpenTC Workpackage 5</b></p>
<p style="position:absolute;top:243px;left:343px;white-space:nowrap" class="ft11"><b>(M37) November&#160;2008</b></p>
<p style="position:absolute;top:303px;left:91px;white-space:nowrap" class="ft11"><b>Project&#160;number</b></p>
<p style="position:absolute;top:303px;left:425px;white-space:nowrap" class="ft12">IST-027635</p>
<p style="position:absolute;top:328px;left:91px;white-space:nowrap" class="ft11"><b>Project&#160;acronym</b></p>
<p style="position:absolute;top:328px;left:425px;white-space:nowrap" class="ft12">Open_TC</p>
<p style="position:absolute;top:354px;left:91px;white-space:nowrap" class="ft11"><b>Project&#160;title</b></p>
<p style="position:absolute;top:354px;left:425px;white-space:nowrap" class="ft12">Open Trusted Computing</p>
<p style="position:absolute;top:379px;left:91px;white-space:nowrap" class="ft11"><b>Deliverable&#160;Type</b></p>
<p style="position:absolute;top:379px;left:425px;white-space:nowrap" class="ft12">Report&#160;</p>
<p style="position:absolute;top:422px;left:91px;white-space:nowrap" class="ft11"><b>Reference&#160;number</b></p>
<p style="position:absolute;top:422px;left:425px;white-space:nowrap" class="ft12">IST-027635/D05.6/V01&#160;Final&#160;</p>
<p style="position:absolute;top:454px;left:91px;white-space:nowrap" class="ft11"><b>Title</b></p>
<p style="position:absolute;top:444px;left:425px;white-space:nowrap" class="ft14">D05.6&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage<br/>5</p>
<p style="position:absolute;top:486px;left:91px;white-space:nowrap" class="ft11"><b>WPs&#160;contributing&#160;</b></p>
<p style="position:absolute;top:486px;left:425px;white-space:nowrap" class="ft12">WP05</p>
<p style="position:absolute;top:511px;left:91px;white-space:nowrap" class="ft11"><b>Due&#160;date</b></p>
<p style="position:absolute;top:511px;left:425px;white-space:nowrap" class="ft12">November&#160;2008&#160;(M37)</p>
<p style="position:absolute;top:535px;left:91px;white-space:nowrap" class="ft11"><b>Actual&#160;submission&#160;date</b></p>
<p style="position:absolute;top:535px;left:425px;white-space:nowrap" class="ft12">January&#160;15th,&#160;2009</p>
<p style="position:absolute;top:577px;left:91px;white-space:nowrap" class="ft11"><b>Responsible&#160;Organisation</b></p>
<p style="position:absolute;top:577px;left:424px;white-space:nowrap" class="ft12">IBM&#160;(Matthias&#160;Schunter)</p>
<p style="position:absolute;top:604px;left:91px;white-space:nowrap" class="ft11"><b>Authors</b></p>
<p style="position:absolute;top:599px;left:424px;white-space:nowrap" class="ft12">CUCL, HP, IBM, IAIK, ITAS,&#160;RUB,&#160;Polito</p>
<p style="position:absolute;top:627px;left:91px;white-space:nowrap" class="ft11"><b>Abstract</b></p>
<p style="position:absolute;top:627px;left:424px;white-space:nowrap" class="ft14">This&#160;report&#160;summarizes&#160;and&#160;consolidates&#160;the<br/>main&#160;results&#160;from&#160;OpenTC&#160;Workpackage&#160;05<br/>“SecurityManagement and&#160;Infrastructure”.</p>
<p style="position:absolute;top:859px;left:91px;white-space:nowrap" class="ft11"><b>Keywords</b></p>
<p style="position:absolute;top:840px;left:424px;white-space:nowrap" class="ft14">OpenTC, Virtualization,&#160;Trusted&#160;Computing,<br/>Security&#160;Services,&#160;Security&#160;Management,<br/>Virtual&#160;Systems</p>
<p style="position:absolute;top:918px;left:92px;white-space:nowrap" class="ft11"><b>Dissemination&#160;level</b></p>
<p style="position:absolute;top:918px;left:423px;white-space:nowrap" class="ft12">Public</p>
<p style="position:absolute;top:944px;left:92px;white-space:nowrap" class="ft11"><b>Revision</b></p>
<p style="position:absolute;top:944px;left:423px;white-space:nowrap" class="ft12">V01&#160;Final</p>
<p style="position:absolute;top:995px;left:90px;white-space:nowrap" class="ft11"><b>Instrument</b></p>
<p style="position:absolute;top:995px;left:271px;white-space:nowrap" class="ft12">IP</p>
<p style="position:absolute;top:986px;left:452px;white-space:nowrap" class="ft15"><b>Start&#160;date&#160;of the<br/>project</b></p>
<p style="position:absolute;top:995px;left:632px;white-space:nowrap" class="ft12">1</p>
<p style="position:absolute;top:995px;left:643px;white-space:nowrap" class="ft13">st</p>
<p style="position:absolute;top:995px;left:652px;white-space:nowrap" class="ft12">&#160;November&#160;2005</p>
<p style="position:absolute;top:1024px;left:90px;white-space:nowrap" class="ft11"><b>Thematic&#160;Priority</b></p>
<p style="position:absolute;top:1024px;left:271px;white-space:nowrap" class="ft12">IST</p>
<p style="position:absolute;top:1024px;left:452px;white-space:nowrap" class="ft11"><b>Duration</b></p>
<p style="position:absolute;top:1024px;left:632px;white-space:nowrap" class="ft12">42 months</p>
</div>
<!-- Page 2 -->
<a name="2"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft26{font-size:26px;font-family:Helvetica;color:#231f20;}
	.ft27{font-size:21px;font-family:Helvetica;color:#231f20;}
	.ft28{font-size:15px;font-family:Times;color:#231f20;}
	.ft29{font-size:15px;font-family:TimesNewRoman;color:#000000;}
	.ft210{font-size:15px;font-family:TimesNewRoman;color:#0000ff;}
	.ft211{font-size:14px;font-family:TimesNewRoman;color:#000000;}
	.ft212{font-size:17px;font-family:Arial;color:#000000;}
	.ft213{font-size:15px;font-family:Helvetica;color:#000000;}
	.ft214{font-size:15px;line-height:18px;font-family:Times;color:#231f20;}
	.ft215{font-size:15px;line-height:17px;font-family:Times;color:#231f20;}
	.ft216{font-size:15px;line-height:19px;font-family:TimesNewRoman;color:#000000;}
-->
</style>
<div id="page2-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5002.png" alt="background image"/>
<p style="position:absolute;top:189px;left:345px;white-space:nowrap" class="ft26"><b>A</b></p>
<p style="position:absolute;top:193px;left:365px;white-space:nowrap" class="ft27"><b>BSTRACT</b></p>
<p style="position:absolute;top:230px;left:150px;white-space:nowrap" class="ft215">This&#160;report&#160;summarizes&#160;and&#160;consolidates&#160;the&#160;main&#160;results&#160;from&#160;OpenTC&#160;Workpackage<br/>05&#160;“Security&#160;Management&#160;and&#160;Infrastructure”.&#160;The&#160;goal&#160;of&#160;Workpackage&#160;5&#160;has&#160;been&#160;to<br/>develop&#160;mechanisms&#160;for&#160;managing&#160;security&#160;of&#160;virtual&#160;systems&#160;while&#160;leveraging&#160;trusted<br/>computing&#160;technologies&#160;for&#160;verifiability&#160;and&#160;protection.</p>
<p style="position:absolute;top:302px;left:172px;white-space:nowrap" class="ft28">Part&#160;I&#160;of&#160;the&#160;deliverable&#160;introduces&#160;our&#160;goals&#160;and&#160;surveys&#160;the&#160;approach&#160;we&#160;have</p>
<p style="position:absolute;top:320px;left:150px;white-space:nowrap" class="ft214">taken&#160;from&#160;a&#160;high-level&#160;perspective.&#160;Part&#160;II&#160;then&#160;describes&#160;key&#160;building&#160;blocks&#160;in&#160;detail.<br/>Part&#160;III&#160;describes&#160;the&#160;WP5&#160;concepts&#160;in&#160;the&#160;demonstrator&#160;and&#160;concludes&#160;the&#160;deliverable<br/>by&#160;evaluating&#160;our&#160;prototype&#160;and&#160;documenting&#160;our&#160;future&#160;outlook.</p>
<p style="position:absolute;top:386px;left:154px;white-space:nowrap" class="ft26"><b>C</b></p>
<p style="position:absolute;top:390px;left:174px;white-space:nowrap" class="ft27"><b>ONTRIBUTORS&#160;AND</b></p>
<p style="position:absolute;top:386px;left:402px;white-space:nowrap" class="ft26"><b>A</b></p>
<p style="position:absolute;top:390px;left:421px;white-space:nowrap" class="ft27"><b>CKNOWLEDGEMENTS</b></p>
<p style="position:absolute;top:427px;left:150px;white-space:nowrap" class="ft214">The&#160;following&#160;people&#160;were&#160;the&#160;main&#160;contributors&#160;to&#160;this&#160;report&#160;(alphabetically&#160;by&#160;or-<br/>ganisation):&#160;Theodore&#160;Hong,&#160;Eric&#160;John,&#160;Derek&#160;Murray&#160;(CUCL);&#160;Serdar&#160;Cabuk,&#160;Chris<br/>Dalton,&#160;Dirk&#160;Kuhlmann,&#160;David&#160;Plaquin&#160;(HP);&#160;Konrad&#160;Eriksson,&#160;Bernhard&#160;Jansen,<br/>HariGovind&#160;V.&#160;Ramasamy,&#160;Matthias&#160;Schunter,&#160;Axel&#160;Tanner,&#160;Andreas&#160;Wespi,&#160;Diego<br/>Zamboni&#160;(IBM);&#160;Peter&#160;Lipp,&#160;Martin&#160;Pirker&#160;(IAIK);&#160;Arnd&#160;Weber&#160;(ITAS);&#160;Frederik<br/>Armknecht,&#160;Yacine&#160;Gasmi,&#160;Ahmad-Reza&#160;Sadeghi,&#160;Patrick&#160;Stewin,&#160;Martin&#160;Unger<br/>(RUB);&#160;Gianluca&#160;Ramunno,&#160;Davide&#160;Vernizzi&#160;(Polito).</p>
<p style="position:absolute;top:553px;left:172px;white-space:nowrap" class="ft28">We&#160;would&#160;like&#160;to&#160;thank&#160;our&#160;reviewer&#160;Peter&#160;Lipp&#160;from&#160;IAIK&#160;Graz.&#160;Furthermore,&#160;we</p>
<p style="position:absolute;top:571px;left:150px;white-space:nowrap" class="ft214">would&#160;like&#160;to&#160;thank&#160;the&#160;other&#160;members&#160;of&#160;the&#160;OpenTC&#160;project&#160;for&#160;helpful&#160;discussions<br/>and&#160;valuable&#160;contributions&#160;to&#160;the&#160;research&#160;that&#160;is&#160;documented&#160;in&#160;this&#160;report.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft28">2</p>
<p style="position:absolute;top:854px;left:148px;white-space:nowrap" class="ft29">If you need further information, please visit our website&#160;</p>
<p style="position:absolute;top:854px;left:488px;white-space:nowrap" class="ft210">www.opentc.net&#160;</p>
<p style="position:absolute;top:854px;left:590px;white-space:nowrap" class="ft29">or contact&#160;the&#160;</p>
<p style="position:absolute;top:874px;left:148px;white-space:nowrap" class="ft29">coordinator:</p>
<p style="position:absolute;top:913px;left:148px;white-space:nowrap" class="ft29">Technikon Forschungs-und Planungsgesellschaft mbH</p>
<p style="position:absolute;top:933px;left:148px;white-space:nowrap" class="ft216">Burgplatz 3a, 9500 Villach, AUSTRIA<br/>Tel.+43 4242 23355 -0<br/>Fax. +43 4242 23355 -77</p>
<p style="position:absolute;top:992px;left:148px;white-space:nowrap" class="ft29">Email&#160;</p>
<p style="position:absolute;top:992px;left:188px;white-space:nowrap" class="ft210">coordination@opentc.net&#160;</p>
<p style="position:absolute;top:1032px;left:220px;white-space:nowrap" class="ft211">The information in this document is provided “as is”, and no guarantee</p>
<p style="position:absolute;top:1049px;left:215px;white-space:nowrap" class="ft211">or warranty is given that the information is fit for any particular purpose.</p>
<p style="position:absolute;top:1067px;left:236px;white-space:nowrap" class="ft211">The user thereof uses the information at its sole risk and liability.</p>
</div>
<!-- Page 3 -->
<a name="3"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft317{font-size:26px;font-family:Times;color:#231f20;}
	.ft318{font-size:18px;font-family:Times;color:#231f20;}
	.ft319{font-size:12px;font-family:Times;color:#231f20;}
	.ft320{font-size:15px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page3-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5003.png" alt="background image"/>
<p style="position:absolute;top:508px;left:274px;white-space:nowrap" class="ft317">Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:579px;left:392px;white-space:nowrap" class="ft318">OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:577px;left:570px;white-space:nowrap" class="ft319">1</p>
<p style="position:absolute;top:622px;left:402px;white-space:nowrap" class="ft320"><i>OpenTC&#160;</i>Deliverable&#160;D05.6</p>
<p style="position:absolute;top:640px;left:331px;white-space:nowrap" class="ft38">V01&#160;–&#160;Final&#160;Revision.&#160;7628&#160;(OpenTC&#160;Public&#160;(PU))</p>
<p style="position:absolute;top:658px;left:450px;white-space:nowrap" class="ft38">2009/01/15</p>
</div>
<!-- Page 4 -->
<a name="4"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft421{font-size:15px;font-family:Helvetica;color:#231f20;}
-->
</style>
<div id="page4-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5004.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft48">2</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft421">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft421">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 5 -->
<a name="5"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft522{font-size:37px;font-family:Times;color:#231f20;}
	.ft523{font-size:15px;font-family:Times;color:#231f20;}
	.ft524{font-size:18px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page5-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5005.png" alt="background image"/>
<p style="position:absolute;top:298px;left:226px;white-space:nowrap" class="ft522"><b>Contents</b></p>
<p style="position:absolute;top:406px;left:226px;white-space:nowrap" class="ft523"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#9"><b>1</b></a></p>
<p style="position:absolute;top:406px;left:248px;white-space:nowrap" class="ft523"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#9"><b>Introduction&#160;and&#160;Outline</b></a></p>
<p style="position:absolute;top:406px;left:734px;white-space:nowrap" class="ft523"><b>7</b></p>
<p style="position:absolute;top:424px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#9">1.1</a></p>
<p style="position:absolute;top:424px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#9">Introduction&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:424px;left:734px;white-space:nowrap" class="ft58">7</p>
<p style="position:absolute;top:442px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#10">1.2</a></p>
<p style="position:absolute;top:442px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#10">Our&#160;Contribution&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:442px;left:734px;white-space:nowrap" class="ft58">8</p>
<p style="position:absolute;top:460px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#10">1.3</a></p>
<p style="position:absolute;top:460px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#10">Outline&#160;of&#160;this&#160;Report&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:460px;left:734px;white-space:nowrap" class="ft58">8</p>
<p style="position:absolute;top:509px;left:226px;white-space:nowrap" class="ft524"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#13"><b>I</b></a></p>
<p style="position:absolute;top:509px;left:251px;white-space:nowrap" class="ft524"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#13"><b>Overview&#160;and&#160;Related&#160;Work</b></a></p>
<p style="position:absolute;top:509px;left:724px;white-space:nowrap" class="ft524"><b>11</b></p>
<p style="position:absolute;top:529px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#14">1.4</a></p>
<p style="position:absolute;top:529px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#14">Dependability&#160;of&#160;Virtual&#160;Systems&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:529px;left:727px;white-space:nowrap" class="ft58">12</p>
<p style="position:absolute;top:562px;left:226px;white-space:nowrap" class="ft523"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#17"><b>2</b></a></p>
<p style="position:absolute;top:562px;left:248px;white-space:nowrap" class="ft523"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#17"><b>Security&#160;Policies&#160;for&#160;Virtual&#160;Data&#160;Centers</b></a></p>
<p style="position:absolute;top:562px;left:727px;white-space:nowrap" class="ft523"><b>15</b></p>
<p style="position:absolute;top:580px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#17">2.1</a></p>
<p style="position:absolute;top:580px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#17">High-level&#160;Policy&#160;Model&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:580px;left:727px;white-space:nowrap" class="ft58">15</p>
<p style="position:absolute;top:598px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#18">2.2</a></p>
<p style="position:absolute;top:598px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#18">Security&#160;Objectives&#160;and&#160;Policy&#160;Enforcement&#160;Points&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:598px;left:727px;white-space:nowrap" class="ft58">16</p>
<p style="position:absolute;top:616px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#20">2.3</a></p>
<p style="position:absolute;top:616px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#20">Example&#160;Policy&#160;Refinements&#160;for&#160;Protected&#160;Resources&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:616px;left:727px;white-space:nowrap" class="ft58">18</p>
<p style="position:absolute;top:649px;left:226px;white-space:nowrap" class="ft523"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#24"><b>3</b></a></p>
<p style="position:absolute;top:649px;left:248px;white-space:nowrap" class="ft523"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#24"><b>Unified&#160;Policy&#160;Enforcement&#160;for&#160;Virtual&#160;Data&#160;Centers</b></a></p>
<p style="position:absolute;top:649px;left:727px;white-space:nowrap" class="ft523"><b>22</b></p>
<p style="position:absolute;top:667px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#24">3.1</a></p>
<p style="position:absolute;top:667px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#24">TVD&#160;Infrastructure&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:667px;left:727px;white-space:nowrap" class="ft58">22</p>
<p style="position:absolute;top:685px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#25">3.2</a></p>
<p style="position:absolute;top:685px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#25">Virtual&#160;Networking&#160;Infrastructure</a></p>
<p style="position:absolute;top:685px;left:499px;white-space:nowrap" class="ft58">.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:685px;left:727px;white-space:nowrap" class="ft58">23</p>
<p style="position:absolute;top:702px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#27">3.3</a></p>
<p style="position:absolute;top:702px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#27">Virtual&#160;Storage&#160;Infrastructure&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:702px;left:727px;white-space:nowrap" class="ft58">25</p>
<p style="position:absolute;top:720px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#28">3.4</a></p>
<p style="position:absolute;top:720px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#28">TVD&#160;Admission&#160;Control&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:720px;left:727px;white-space:nowrap" class="ft58">26</p>
<p style="position:absolute;top:753px;left:226px;white-space:nowrap" class="ft523"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#31"><b>4</b></a></p>
<p style="position:absolute;top:753px;left:248px;white-space:nowrap" class="ft523"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#31"><b>Background&#160;and&#160;Related&#160;Work</b></a></p>
<p style="position:absolute;top:753px;left:727px;white-space:nowrap" class="ft523"><b>29</b></p>
<p style="position:absolute;top:771px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#31">4.1</a></p>
<p style="position:absolute;top:771px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#31">Overview&#160;of&#160;Trusted&#160;Virtual&#160;Domains&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:771px;left:727px;white-space:nowrap" class="ft58">29</p>
<p style="position:absolute;top:789px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#32">4.2</a></p>
<p style="position:absolute;top:789px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#32">Trusted&#160;Computing&#160;–&#160;The&#160;TCG&#160;Approach&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:789px;left:727px;white-space:nowrap" class="ft58">30</p>
<p style="position:absolute;top:807px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#33">4.3</a></p>
<p style="position:absolute;top:807px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#33">Trusted&#160;Channels&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:807px;left:727px;white-space:nowrap" class="ft58">31</p>
<p style="position:absolute;top:825px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#33">4.4</a></p>
<p style="position:absolute;top:825px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#33">Secure&#160;Network&#160;Virtualization&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:825px;left:727px;white-space:nowrap" class="ft58">31</p>
<p style="position:absolute;top:874px;left:226px;white-space:nowrap" class="ft524"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#35"><b>II</b></a></p>
<p style="position:absolute;top:874px;left:258px;white-space:nowrap" class="ft524"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#35"><b>Building&#160;Blocks&#160;of&#160;the&#160;OpenTC&#160;Security&#160;Architecture</b></a></p>
<p style="position:absolute;top:874px;left:724px;white-space:nowrap" class="ft524"><b>33</b></p>
<p style="position:absolute;top:909px;left:226px;white-space:nowrap" class="ft523"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#36"><b>5</b></a></p>
<p style="position:absolute;top:909px;left:248px;white-space:nowrap" class="ft523"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#36"><b>Policy&#160;Enforcement&#160;and&#160;Compliance</b></a></p>
<p style="position:absolute;top:909px;left:727px;white-space:nowrap" class="ft523"><b>34</b></p>
<p style="position:absolute;top:927px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#36">5.1</a></p>
<p style="position:absolute;top:927px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#36">Introduction&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:927px;left:727px;white-space:nowrap" class="ft58">34</p>
<p style="position:absolute;top:945px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#37">5.2</a></p>
<p style="position:absolute;top:945px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#37">Formal&#160;Integrity&#160;Model&#160;for&#160;Virtual&#160;Machines</a></p>
<p style="position:absolute;top:945px;left:566px;white-space:nowrap" class="ft58">.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:945px;left:727px;white-space:nowrap" class="ft58">35</p>
<p style="position:absolute;top:963px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#40">5.3</a></p>
<p style="position:absolute;top:963px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#40">The&#160;PEV&#160;Integrity&#160;Architecture&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:963px;left:727px;white-space:nowrap" class="ft58">38</p>
<p style="position:absolute;top:981px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#43">5.4</a></p>
<p style="position:absolute;top:981px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#43">Realization&#160;using&#160;Xen&#160;and&#160;Linux&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:981px;left:727px;white-space:nowrap" class="ft58">41</p>
<p style="position:absolute;top:999px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#45">5.5</a></p>
<p style="position:absolute;top:999px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#45">Use&#160;Cases&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:999px;left:727px;white-space:nowrap" class="ft58">43</p>
<p style="position:absolute;top:1017px;left:248px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#51">5.6</a></p>
<p style="position:absolute;top:1017px;left:283px;white-space:nowrap" class="ft58"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#51">Conclusion&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:1017px;left:727px;white-space:nowrap" class="ft58">49</p>
<p style="position:absolute;top:1117px;left:480px;white-space:nowrap" class="ft58">3</p>
</div>
<!-- Page 6 -->
<a name="6"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page6-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5006.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft68">4</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft621">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft623"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#53"><b>6</b></a></p>
<p style="position:absolute;top:194px;left:172px;white-space:nowrap" class="ft623"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#53"><b>Hierarchical&#160;Integrity&#160;Management</b></a></p>
<p style="position:absolute;top:194px;left:651px;white-space:nowrap" class="ft623"><b>51</b></p>
<p style="position:absolute;top:212px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#53">6.1</a></p>
<p style="position:absolute;top:212px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#53">Introduction&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:212px;left:651px;white-space:nowrap" class="ft68">51</p>
<p style="position:absolute;top:230px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#54">6.2</a></p>
<p style="position:absolute;top:230px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#54">Design&#160;Overview&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:230px;left:651px;white-space:nowrap" class="ft68">52</p>
<p style="position:absolute;top:247px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#56">6.3</a></p>
<p style="position:absolute;top:247px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#56">Basic&#160;Integrity&#160;Management&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:247px;left:651px;white-space:nowrap" class="ft68">54</p>
<p style="position:absolute;top:265px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#60">6.4</a></p>
<p style="position:absolute;top:265px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#60">Hierarchical&#160;Integrity&#160;Management&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:265px;left:651px;white-space:nowrap" class="ft68">58</p>
<p style="position:absolute;top:283px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#65">6.5</a></p>
<p style="position:absolute;top:283px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#65">Policy&#160;Verification&#160;for&#160;Security&#160;Services&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:283px;left:651px;white-space:nowrap" class="ft68">63</p>
<p style="position:absolute;top:301px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#66">6.6</a></p>
<p style="position:absolute;top:301px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#66">Implementation&#160;in&#160;Xen&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:301px;left:651px;white-space:nowrap" class="ft68">64</p>
<p style="position:absolute;top:319px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#70">6.7</a></p>
<p style="position:absolute;top:319px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#70">Conclusions&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:319px;left:651px;white-space:nowrap" class="ft68">68</p>
<p style="position:absolute;top:352px;left:150px;white-space:nowrap" class="ft623"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#71"><b>7</b></a></p>
<p style="position:absolute;top:352px;left:172px;white-space:nowrap" class="ft623"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#71"><b>Secure&#160;Virtualized&#160;Networking</b></a></p>
<p style="position:absolute;top:352px;left:651px;white-space:nowrap" class="ft623"><b>69</b></p>
<p style="position:absolute;top:370px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#71">7.1</a></p>
<p style="position:absolute;top:370px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#71">Introduction&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:370px;left:651px;white-space:nowrap" class="ft68">69</p>
<p style="position:absolute;top:388px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#72">7.2</a></p>
<p style="position:absolute;top:388px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#72">Design&#160;Overview&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:388px;left:651px;white-space:nowrap" class="ft68">70</p>
<p style="position:absolute;top:406px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#76">7.3</a></p>
<p style="position:absolute;top:406px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#76">Networking&#160;Infrastructure</a></p>
<p style="position:absolute;top:406px;left:378px;white-space:nowrap" class="ft68">.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:406px;left:651px;white-space:nowrap" class="ft68">74</p>
<p style="position:absolute;top:424px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#83">7.4</a></p>
<p style="position:absolute;top:424px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#83">TVD&#160;Infrastructure&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:424px;left:651px;white-space:nowrap" class="ft68">81</p>
<p style="position:absolute;top:442px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#89">7.5</a></p>
<p style="position:absolute;top:442px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#89">Auto-deployment&#160;of&#160;Trusted&#160;Virtual&#160;Domains&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:442px;left:651px;white-space:nowrap" class="ft68">87</p>
<p style="position:absolute;top:460px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#94">7.6</a></p>
<p style="position:absolute;top:460px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#94">Implementation&#160;in&#160;Xen&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:460px;left:651px;white-space:nowrap" class="ft68">92</p>
<p style="position:absolute;top:478px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#97">7.7</a></p>
<p style="position:absolute;top:478px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#97">Discussion&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:478px;left:651px;white-space:nowrap" class="ft68">95</p>
<p style="position:absolute;top:510px;left:150px;white-space:nowrap" class="ft623"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#98"><b>8</b></a></p>
<p style="position:absolute;top:510px;left:172px;white-space:nowrap" class="ft623"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#98"><b>Public&#160;Key&#160;Infrastructure</b></a></p>
<p style="position:absolute;top:510px;left:651px;white-space:nowrap" class="ft623"><b>96</b></p>
<p style="position:absolute;top:528px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#98">8.1</a></p>
<p style="position:absolute;top:528px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#98">Introduction&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:528px;left:651px;white-space:nowrap" class="ft68">96</p>
<p style="position:absolute;top:546px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#99">8.2</a></p>
<p style="position:absolute;top:546px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#99">Basic&#160;Trusted&#160;Computing&#160;PKI&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:546px;left:651px;white-space:nowrap" class="ft68">97</p>
<p style="position:absolute;top:564px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#102">8.3</a></p>
<p style="position:absolute;top:564px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#102">Trusted&#160;Platform&#160;Agent&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:564px;left:643px;white-space:nowrap" class="ft68">100</p>
<p style="position:absolute;top:582px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#104">8.4</a></p>
<p style="position:absolute;top:582px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#104">XKMS&#160;mapping&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:582px;left:643px;white-space:nowrap" class="ft68">102</p>
<p style="position:absolute;top:600px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#112">8.5</a></p>
<p style="position:absolute;top:600px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#112">Open&#160;Issues&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:600px;left:643px;white-space:nowrap" class="ft68">110</p>
<p style="position:absolute;top:633px;left:150px;white-space:nowrap" class="ft623"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#114"><b>9</b></a></p>
<p style="position:absolute;top:633px;left:172px;white-space:nowrap" class="ft623"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#114"><b>Trusted&#160;Channels&#160;using&#160;OpenSSL</b></a></p>
<p style="position:absolute;top:633px;left:643px;white-space:nowrap" class="ft623"><b>112</b></p>
<p style="position:absolute;top:651px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#114">9.1</a></p>
<p style="position:absolute;top:651px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#114">Motivation&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:651px;left:643px;white-space:nowrap" class="ft68">112</p>
<p style="position:absolute;top:669px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#116">9.2</a></p>
<p style="position:absolute;top:669px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#116">Requirement&#160;Analysis&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:669px;left:643px;white-space:nowrap" class="ft68">114</p>
<p style="position:absolute;top:687px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#117">9.3</a></p>
<p style="position:absolute;top:687px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#117">Basic&#160;Definitions&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:687px;left:643px;white-space:nowrap" class="ft68">115</p>
<p style="position:absolute;top:705px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#118">9.4</a></p>
<p style="position:absolute;top:705px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#118">Adapted&#160;TLS&#160;Handshake&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:705px;left:643px;white-space:nowrap" class="ft68">116</p>
<p style="position:absolute;top:723px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#121">9.5</a></p>
<p style="position:absolute;top:723px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#121">Detailed&#160;Description&#160;of&#160;Attestation&#160;Data&#160;Structures&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:723px;left:643px;white-space:nowrap" class="ft68">119</p>
<p style="position:absolute;top:741px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#124">9.6</a></p>
<p style="position:absolute;top:741px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#124">Generic&#160;System&#160;Architecture&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:741px;left:643px;white-space:nowrap" class="ft68">122</p>
<p style="position:absolute;top:759px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#126">9.7</a></p>
<p style="position:absolute;top:759px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#126">A&#160;Trusted&#160;Channel&#160;Implementation&#160;with&#160;OpenSSL&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:759px;left:643px;white-space:nowrap" class="ft68">124</p>
<p style="position:absolute;top:776px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#129">9.8</a></p>
<p style="position:absolute;top:776px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#129">Security&#160;Considerations&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:776px;left:643px;white-space:nowrap" class="ft68">127</p>
<p style="position:absolute;top:794px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#130">9.9</a></p>
<p style="position:absolute;top:794px;left:207px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#130">Functional&#160;Considerations&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:794px;left:643px;white-space:nowrap" class="ft68">128</p>
<p style="position:absolute;top:812px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#131">9.10&#160;Summary&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:812px;left:643px;white-space:nowrap" class="ft68">129</p>
<p style="position:absolute;top:845px;left:150px;white-space:nowrap" class="ft623"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#132"><b>10&#160;Towards&#160;Dependability&#160;and&#160;Attack&#160;Resistance</b></a></p>
<p style="position:absolute;top:845px;left:643px;white-space:nowrap" class="ft623"><b>130</b></p>
<p style="position:absolute;top:863px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#132">10.1&#160;Introduction&#160;to&#160;Dependable&#160;Virtualization&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:863px;left:643px;white-space:nowrap" class="ft68">130</p>
<p style="position:absolute;top:881px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#133">10.2&#160;Using&#160;Virtualization&#160;for&#160;Dependability&#160;and&#160;Security&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:881px;left:643px;white-space:nowrap" class="ft68">131</p>
<p style="position:absolute;top:899px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#136">10.3&#160;Xen-based&#160;Implementation&#160;of&#160;Intrusion&#160;Detection&#160;and&#160;Protection&#160;</a>.&#160;.&#160;.</p>
<p style="position:absolute;top:899px;left:643px;white-space:nowrap" class="ft68">134</p>
<p style="position:absolute;top:917px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#145">10.4&#160;Quantifying&#160;the&#160;Impact&#160;of&#160;Virtualization&#160;on&#160;Node&#160;Reliability&#160;</a>.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:917px;left:643px;white-space:nowrap" class="ft68">143</p>
<p style="position:absolute;top:935px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#149">10.5&#160;An&#160;Architecture&#160;for&#160;a&#160;More&#160;Reliable&#160;Xen&#160;VMM&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:935px;left:643px;white-space:nowrap" class="ft68">147</p>
<p style="position:absolute;top:984px;left:150px;white-space:nowrap" class="ft624"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#153"><b>III</b></a></p>
<p style="position:absolute;top:984px;left:189px;white-space:nowrap" class="ft624"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#153"><b>Evaluation&#160;and&#160;Outlook</b></a></p>
<p style="position:absolute;top:984px;left:638px;white-space:nowrap" class="ft624"><b>151</b></p>
<p style="position:absolute;top:1019px;left:150px;white-space:nowrap" class="ft623"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#154"><b>11&#160;Security&#160;Management&#160;Demonstrator</b></a></p>
<p style="position:absolute;top:1019px;left:643px;white-space:nowrap" class="ft623"><b>152</b></p>
<p style="position:absolute;top:1037px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#154">11.1&#160;Overview&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:1037px;left:643px;white-space:nowrap" class="ft68">152</p>
<p style="position:absolute;top:1055px;left:172px;white-space:nowrap" class="ft68"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#155">11.2&#160;Security&#160;Services&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:1055px;left:643px;white-space:nowrap" class="ft68">153</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft621">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 7 -->
<a name="7"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page7-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5007.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft78">CONTENTS</p>
<p style="position:absolute;top:141px;left:734px;white-space:nowrap" class="ft78">5</p>
<p style="position:absolute;top:194px;left:248px;white-space:nowrap" class="ft78"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#157">11.3&#160;TVD&#160;Master,&#160;Proxies&#160;and&#160;Proxy&#160;Factories&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:194px;left:719px;white-space:nowrap" class="ft78">155</p>
<p style="position:absolute;top:212px;left:248px;white-space:nowrap" class="ft78"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#157">11.4&#160;Secure&#160;Virtual&#160;Network&#160;subsystem&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:212px;left:719px;white-space:nowrap" class="ft78">155</p>
<p style="position:absolute;top:230px;left:248px;white-space:nowrap" class="ft78"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#158">11.5&#160;Trusted&#160;Channel&#160;Proxies&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:230px;left:719px;white-space:nowrap" class="ft78">156</p>
<p style="position:absolute;top:262px;left:226px;white-space:nowrap" class="ft723"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#159"><b>12&#160;Evaluation&#160;of&#160;the&#160;Prototype</b></a></p>
<p style="position:absolute;top:262px;left:719px;white-space:nowrap" class="ft723"><b>157</b></p>
<p style="position:absolute;top:280px;left:248px;white-space:nowrap" class="ft78"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#159">12.1&#160;Performance&#160;Evaluation&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:280px;left:719px;white-space:nowrap" class="ft78">157</p>
<p style="position:absolute;top:298px;left:248px;white-space:nowrap" class="ft78"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#161">12.2&#160;Limitations&#160;of&#160;our&#160;Prototype&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:298px;left:719px;white-space:nowrap" class="ft78">159</p>
<p style="position:absolute;top:331px;left:226px;white-space:nowrap" class="ft723"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#163"><b>13&#160;Conclusion&#160;and&#160;Outlook</b></a></p>
<p style="position:absolute;top:331px;left:719px;white-space:nowrap" class="ft723"><b>161</b></p>
<p style="position:absolute;top:349px;left:248px;white-space:nowrap" class="ft78"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#163">13.1&#160;Lessons&#160;Learned</a></p>
<p style="position:absolute;top:349px;left:398px;white-space:nowrap" class="ft78">.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:349px;left:719px;white-space:nowrap" class="ft78">161</p>
<p style="position:absolute;top:367px;left:248px;white-space:nowrap" class="ft78"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#164">13.2&#160;The&#160;Future&#160;of&#160;Secure&#160;Virtualization&#160;and&#160;Trusted&#160;Computing&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:367px;left:719px;white-space:nowrap" class="ft78">162</p>
<p style="position:absolute;top:385px;left:248px;white-space:nowrap" class="ft78"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#166">13.3&#160;Conclusions&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:385px;left:719px;white-space:nowrap" class="ft78">164</p>
<p style="position:absolute;top:418px;left:226px;white-space:nowrap" class="ft723"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#166"><b>Bibliography</b></a></p>
<p style="position:absolute;top:418px;left:719px;white-space:nowrap" class="ft723"><b>165</b></p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft721">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 8 -->
<a name="8"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page8-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5008.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft88">6</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft821">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft821">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 9 -->
<a name="9"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft925{font-size:31px;font-family:Times;color:#231f20;}
	.ft926{font-size:22px;font-family:Times;color:#231f20;}
	.ft927{font-size:10px;font-family:Times;color:#231f20;}
	.ft928{font-size:9px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page9-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5009.png" alt="background image"/>
<p style="position:absolute;top:295px;left:226px;white-space:nowrap" class="ft925"><b>Chapter&#160;1</b></p>
<p style="position:absolute;top:365px;left:226px;white-space:nowrap" class="ft922"><b>Introduction&#160;and&#160;Outline</b></p>
<p style="position:absolute;top:463px;left:226px;white-space:nowrap" class="ft926"><b>1.1</b></p>
<p style="position:absolute;top:463px;left:274px;white-space:nowrap" class="ft926"><b>Introduction</b></p>
<p style="position:absolute;top:500px;left:226px;white-space:nowrap" class="ft914">Hardware&#160;virtualization&#160;is&#160;enjoying&#160;a&#160;resurgence&#160;of&#160;interest&#160;fueled&#160;in&#160;part&#160;by&#160;its&#160;cost-<br/>saving&#160;potential.&#160;By&#160;allowing&#160;multiple&#160;virtual&#160;machines&#160;to&#160;be&#160;hosted&#160;on&#160;a&#160;single&#160;phys-<br/>ical&#160;server,&#160;virtualization&#160;helps&#160;improve&#160;server&#160;utilization,&#160;reduce&#160;management&#160;and<br/>power&#160;costs,&#160;and&#160;control&#160;the&#160;problem&#160;of&#160;server&#160;sprawl.</p>
<p style="position:absolute;top:572px;left:248px;white-space:nowrap" class="ft98">A&#160;prominent&#160;example&#160;in&#160;this&#160;context&#160;is&#160;data&#160;centers.&#160;The&#160;<i>infrastructure&#160;provider</i>,</p>
<p style="position:absolute;top:590px;left:226px;white-space:nowrap" class="ft914">who&#160;owns,&#160;runs,&#160;and&#160;manages&#160;the&#160;data&#160;center,&#160;can&#160;transfer&#160;the&#160;cost&#160;savings&#160;to&#160;its&#160;cus-<br/>tomers&#160;or&#160;<i>outsourcing&#160;companies</i>,&#160;whose&#160;virtual&#160;infrastructures&#160;are&#160;hosted&#160;on&#160;the&#160;data<br/>center’s&#160;physical&#160;resources.&#160;A&#160;large&#160;number&#160;of&#160;the&#160;companies&#160;that&#160;outsource&#160;their&#160;op-<br/>erations&#160;are&#160;small&#160;and&#160;medium&#160;businesses&#160;or&#160;SMBs,&#160;which&#160;cannot&#160;afford&#160;the&#160;costs&#160;of&#160;a<br/>dedicated&#160;data&#160;center&#160;in&#160;which&#160;all&#160;the&#160;data&#160;center’s&#160;resources&#160;are&#160;used&#160;to&#160;host&#160;a&#160;single<br/>company’s&#160;IT&#160;infrastructure.&#160;Hence,&#160;the&#160;IT&#160;infrastructure&#160;belonging&#160;to&#160;multiple&#160;SMBs<br/>may&#160;be&#160;hosted&#160;inside&#160;the&#160;same&#160;data&#160;center&#160;facility.&#160;Today,&#160;even&#160;in&#160;such&#160;“shared”&#160;data<br/>centers,&#160;each&#160;run&#160;on&#160;distinct&#160;physical&#160;resources&#160;and&#160;there&#160;is&#160;no&#160;resource&#160;sharing&#160;among<br/>various&#160;customers.&#160;In&#160;this&#160;so-called&#160;<i>physical&#160;cages&#160;</i>model,&#160;the&#160;customers&#160;are&#160;physically<br/>isolated&#160;from&#160;each&#160;other&#160;in&#160;the&#160;same&#160;data&#160;center.</p>
<p style="position:absolute;top:770px;left:248px;white-space:nowrap" class="ft98">Limited&#160;trust&#160;in&#160;the&#160;security&#160;of&#160;virtual&#160;datacenters&#160;is&#160;one&#160;major&#160;reason&#160;for&#160;customers</p>
<p style="position:absolute;top:787px;left:226px;white-space:nowrap" class="ft915">not&#160;sharing&#160;physical&#160;resources.&#160;Since&#160;management&#160;is&#160;usually&#160;performed&#160;manually,&#160;ad-<br/>ministrative&#160;errors&#160;are&#160;commonplace.&#160;While&#160;this&#160;may&#160;lead&#160;to&#160;down&#160;times&#160;in&#160;virtual<br/>datacenters&#160;used&#160;by&#160;a&#160;single&#160;customer,&#160;it&#160;can&#160;lead&#160;to&#160;information&#160;leakages&#160;to&#160;competi-<br/>tors&#160;if&#160;the&#160;datacenter&#160;is&#160;shared.&#160;Furthermore,&#160;multiple&#160;organizations&#160;will&#160;only&#160;allow<br/>sharing&#160;of&#160;physical&#160;resources&#160;if&#160;they&#160;can&#160;trust&#160;that&#160;security&#160;incidents&#160;cannot&#160;spread<br/>across&#160;the&#160;isolation&#160;boundary&#160;separating&#160;two&#160;customers.</p>
<p style="position:absolute;top:917px;left:226px;white-space:nowrap" class="ft923"><b>Security&#160;Objectives</b></p>
<p style="position:absolute;top:917px;left:366px;white-space:nowrap" class="ft98">Our&#160;main&#160;security&#160;objective&#160;is&#160;to&#160;provide&#160;isolation&#160;among&#160;dif-</p>
<p style="position:absolute;top:935px;left:226px;white-space:nowrap" class="ft98">ferent&#160;domains&#160;that&#160;is&#160;comparabl<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#9">e</a></p>
<p style="position:absolute;top:932px;left:428px;white-space:nowrap" class="ft927"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#9">1</a></p>
<p style="position:absolute;top:935px;left:437px;white-space:nowrap" class="ft98">with&#160;the&#160;isolation&#160;obtained&#160;by&#160;providing&#160;one&#160;infras-</p>
<p style="position:absolute;top:953px;left:226px;white-space:nowrap" class="ft914">tructure&#160;for&#160;each&#160;customer.&#160;In&#160;particular,&#160;we&#160;require&#160;a&#160;security&#160;architecture&#160;that&#160;protects<br/>those&#160;system&#160;components&#160;that&#160;provide&#160;the&#160;required&#160;isolation&#160;or&#160;allow&#160;to&#160;verifiably&#160;rea-<br/>son&#160;about&#160;their&#160;trustworthiness&#160;of&#160;and&#160;also&#160;of&#160;any&#160;peer&#160;endpoint&#160;(local&#160;or&#160;remote)&#160;with<br/>a&#160;domain,&#160;i.e.,&#160;whether&#160;they&#160;conforms&#160;to&#160;the&#160;underlying&#160;security&#160;policy.</p>
<p style="position:absolute;top:1024px;left:248px;white-space:nowrap" class="ft98">We&#160;achieve&#160;this&#160;by&#160;grouping&#160;VMs&#160;dispersed&#160;across&#160;multiple&#160;physical&#160;resources</p>
<p style="position:absolute;top:1042px;left:226px;white-space:nowrap" class="ft98">into&#160;a&#160;<i>virtual&#160;zone&#160;</i>in&#160;which&#160;customer-specified&#160;security&#160;requirements&#160;are&#160;automatically</p>
<p style="position:absolute;top:1069px;left:242px;white-space:nowrap" class="ft928">1</p>
<p style="position:absolute;top:1071px;left:248px;white-space:nowrap" class="ft919">Note&#160;that&#160;unlike&#160;physical&#160;isolation,&#160;we&#160;do&#160;not&#160;solve&#160;the&#160;problem&#160;of&#160;covert&#160;channels.</p>
<p style="position:absolute;top:1117px;left:480px;white-space:nowrap" class="ft98">7</p>
</div>
<!-- Page 10 -->
<a name="10"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1029{font-size:12px;font-family:EDWLKR+TT19F5Co00;color:#000000;}
	.ft1030{font-size:8px;font-family:UFQSLH+TT19F5Do00;color:#000000;}
	.ft1031{font-size:13px;font-family:RDZRPI+TT19F5Eo00;color:#000000;}
	.ft1032{font-size:12px;font-family:Helvetica;color:#000000;}
	.ft1033{font-size:12px;font-family:Helvetica;color:#000000;-moz-transform: matrix(         0,         -1,          1,          0, 0, 0);-webkit-transform: matrix(         0,         -1,          1,          0, 0, 0);-o-transform: matrix(         0,         -1,          1,          0, 0, 0);-ms-transform: matrix(         0,         -1,          1,          0, 0, 0);-moz-transform-origin: left 75%;-webkit-transform-origin: left 75%;-o-transform-origin: left 75%;-ms-transform-origin: left 75%;}
-->
</style>
<div id="page10-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5010.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft108">8</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft1021">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:287px;left:400px;white-space:nowrap" class="ft1029">Hardware&#160;Platform</p>
<p style="position:absolute;top:265px;left:420px;white-space:nowrap" class="ft1029">Hypervisor</p>
<p style="position:absolute;top:244px;left:406px;white-space:nowrap" class="ft1029">Security&#160;Services</p>
<p style="position:absolute;top:198px;left:366px;white-space:nowrap" class="ft1029">VM</p>
<p style="position:absolute;top:205px;left:382px;white-space:nowrap" class="ft1030">A1</p>
<p style="position:absolute;top:198px;left:406px;white-space:nowrap" class="ft1029">VM</p>
<p style="position:absolute;top:205px;left:423px;white-space:nowrap" class="ft1030">A2</p>
<p style="position:absolute;top:198px;left:456px;white-space:nowrap" class="ft1029">VM</p>
<p style="position:absolute;top:205px;left:472px;white-space:nowrap" class="ft1030">A3</p>
<p style="position:absolute;top:198px;left:496px;white-space:nowrap" class="ft1029">VM</p>
<p style="position:absolute;top:205px;left:513px;white-space:nowrap" class="ft1030">A4</p>
<p style="position:absolute;top:275px;left:265px;white-space:nowrap" class="ft1031">TVD1</p>
<p style="position:absolute;top:291px;left:260px;white-space:nowrap" class="ft1031">Master</p>
<p style="position:absolute;top:278px;left:268px;white-space:nowrap" class="ft1031">TVD1</p>
<p style="position:absolute;top:294px;left:263px;white-space:nowrap" class="ft1031">Master</p>
<p style="position:absolute;top:282px;left:272px;white-space:nowrap" class="ft1031">TVD1</p>
<p style="position:absolute;top:298px;left:267px;white-space:nowrap" class="ft1031">Master</p>
<p style="position:absolute;top:222px;left:367px;white-space:nowrap" class="ft1029">Proxy1</p>
<p style="position:absolute;top:224px;left:511px;white-space:nowrap" class="ft1032">…</p>
<p style="position:absolute;top:222px;left:455px;white-space:nowrap" class="ft1029">Proxy2</p>
<p style="position:absolute;top:420px;left:400px;white-space:nowrap" class="ft1029">Hardware&#160;Platform</p>
<p style="position:absolute;top:398px;left:420px;white-space:nowrap" class="ft1029">Hypervisor</p>
<p style="position:absolute;top:378px;left:406px;white-space:nowrap" class="ft1029">Security&#160;Services</p>
<p style="position:absolute;top:331px;left:366px;white-space:nowrap" class="ft1029">VM</p>
<p style="position:absolute;top:339px;left:382px;white-space:nowrap" class="ft1030">B1</p>
<p style="position:absolute;top:331px;left:407px;white-space:nowrap" class="ft1029">VM</p>
<p style="position:absolute;top:339px;left:423px;white-space:nowrap" class="ft1030">B2</p>
<p style="position:absolute;top:331px;left:448px;white-space:nowrap" class="ft1029">VM</p>
<p style="position:absolute;top:339px;left:465px;white-space:nowrap" class="ft1030">B3</p>
<p style="position:absolute;top:331px;left:489px;white-space:nowrap" class="ft1029">VM</p>
<p style="position:absolute;top:339px;left:505px;white-space:nowrap" class="ft1030">B4</p>
<p style="position:absolute;top:355px;left:367px;white-space:nowrap" class="ft1029">Proxy1</p>
<p style="position:absolute;top:358px;left:511px;white-space:nowrap" class="ft1032">…</p>
<p style="position:absolute;top:355px;left:455px;white-space:nowrap" class="ft1029">Proxy2</p>
<p style="position:absolute;top:362px;left:556px;white-space:nowrap" class="ft1033">H</p>
<p style="position:absolute;top:353px;left:556px;white-space:nowrap" class="ft1033">o</p>
<p style="position:absolute;top:347px;left:556px;white-space:nowrap" class="ft1033">s</p>
<p style="position:absolute;top:341px;left:556px;white-space:nowrap" class="ft1033">t&#160;</p>
<p style="position:absolute;top:334px;left:556px;white-space:nowrap" class="ft1033">B</p>
<p style="position:absolute;top:221px;left:556px;white-space:nowrap" class="ft1033">H</p>
<p style="position:absolute;top:213px;left:556px;white-space:nowrap" class="ft1033">o</p>
<p style="position:absolute;top:206px;left:556px;white-space:nowrap" class="ft1033">s</p>
<p style="position:absolute;top:200px;left:556px;white-space:nowrap" class="ft1033">t&#160;</p>
<p style="position:absolute;top:194px;left:556px;white-space:nowrap" class="ft1033">A</p>
<p style="position:absolute;top:462px;left:247px;white-space:nowrap" class="ft108">Figure&#160;1.1:&#160;TVD&#160;Architecture:&#160;High-Level&#160;Overview.</p>
<p style="position:absolute;top:525px;left:150px;white-space:nowrap" class="ft1015">enforced.&#160;Even&#160;if&#160;VMs&#160;are&#160;migrated&#160;(say,&#160;for&#160;load-balancing&#160;purposes)&#160;the&#160;logical<br/>topology&#160;reflected&#160;by&#160;the&#160;virtual&#160;domain&#160;should&#160;remain&#160;unchanged.&#160;We&#160;deploy&#160;Trusted<br/>Computing&#160;(TC)&#160;functionalities&#160;to&#160;determine&#160;the&#160;trustworthiness&#160;(assure&#160;the&#160;integrity)<br/>of&#160;the&#160;policy&#160;enforcement&#160;components.</p>
<p style="position:absolute;top:597px;left:172px;white-space:nowrap" class="ft108">Such&#160;a&#160;model&#160;would&#160;provide&#160;better&#160;flexibility,&#160;adaptability,&#160;cost&#160;savings&#160;than&#160;to-</p>
<p style="position:absolute;top:615px;left:150px;white-space:nowrap" class="ft1015">day’s&#160;physical&#160;cages&#160;model&#160;while&#160;still&#160;providing&#160;the&#160;main&#160;security&#160;guarantees&#160;required<br/>for&#160;applications&#160;such&#160;as&#160;datacenters.</p>
<p style="position:absolute;top:679px;left:150px;white-space:nowrap" class="ft1026"><b>1.2</b></p>
<p style="position:absolute;top:679px;left:198px;white-space:nowrap" class="ft1026"><b>Our&#160;Contribution</b></p>
<p style="position:absolute;top:716px;left:150px;white-space:nowrap" class="ft1014">In&#160;this&#160;deliverable,&#160;we&#160;provide&#160;a&#160;blueprint&#160;for&#160;realizing&#160;integrity&#160;and&#160;isolation&#160;in&#160;virtual<br/>systems.&#160;We&#160;do&#160;this&#160;by&#160;supporting&#160;a&#160;logical&#160;cages&#160;model,&#160;in&#160;particular&#160;for&#160;virtualized<br/>data&#160;centers,&#160;based&#160;on&#160;a&#160;concept&#160;called&#160;Trusted&#160;Virtual&#160;Domains&#160;or&#160;TVDs&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[16]</a>.&#160;Based<br/>on&#160;previous&#160;work,&#160;we&#160;describe&#160;a&#160;security&#160;management&#160;framework&#160;that&#160;helps&#160;to&#160;realize<br/>the&#160;abstraction&#160;of&#160;TVDs&#160;by&#160;guaranteeing&#160;reliable&#160;isolation&#160;and&#160;flow&#160;control&#160;between<br/>domain&#160;boundaries.&#160;Our&#160;framework&#160;employs&#160;networking&#160;and&#160;storage&#160;virtualization<br/>technologies&#160;as&#160;well&#160;as&#160;Trusted&#160;Computing&#160;for&#160;policy&#160;verification.&#160;Our&#160;main&#160;contribu-<br/>tions&#160;are&#160;(1)&#160;combining&#160;these&#160;technologies&#160;to&#160;realize&#160;TVDs&#160;and&#160;(2)&#160;orchestrating&#160;them<br/>through&#160;a&#160;management&#160;framework&#160;that&#160;automatically&#160;enforces&#160;isolation&#160;among&#160;differ-<br/>ent&#160;zones.&#160;In&#160;particular,&#160;our&#160;solution&#160;aims&#160;at&#160;automating&#160;the&#160;verification,&#160;instantiation<br/>and&#160;deployment&#160;of&#160;the&#160;appropriate&#160;security&#160;mechanisms&#160;and&#160;virtualization&#160;technolo-<br/>gies&#160;based&#160;on&#160;an&#160;input&#160;security&#160;model,&#160;which&#160;specifies&#160;the&#160;required&#160;level&#160;of&#160;isolation<br/>and&#160;permitted&#160;information&#160;flows.</p>
<p style="position:absolute;top:978px;left:150px;white-space:nowrap" class="ft1026"><b>1.3</b></p>
<p style="position:absolute;top:978px;left:198px;white-space:nowrap" class="ft1026"><b>Outline&#160;of&#160;this&#160;Report</b></p>
<p style="position:absolute;top:1015px;left:150px;white-space:nowrap" class="ft1014">This&#160;report&#160;is&#160;structured&#160;in&#160;three&#160;parts.&#160;Part&#160;I&#160;surveys&#160;our&#160;work&#160;and&#160;summarizes&#160;related<br/>work&#160;in&#160;Chapter&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#31">4.&#160;</a>Part&#160;II&#160;describes&#160;selected&#160;building&#160;blocks&#160;of&#160;our&#160;security&#160;architecture<br/>in&#160;detail.&#160;Part&#160;III&#160;describes&#160;WP5&#160;components&#160;of&#160;our&#160;prototype&#160;and&#160;finally&#160;reflects&#160;on</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft1021">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 11 -->
<a name="11"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page11-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5011.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft118">CHAPTER&#160;1.&#160;INTRODUCTION&#160;AND&#160;OUTLINE</p>
<p style="position:absolute;top:141px;left:734px;white-space:nowrap" class="ft118">9</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft1114">our&#160;lessons&#160;learned&#160;and&#160;documents&#160;our&#160;outlook&#160;onto&#160;the&#160;future&#160;of&#160;trusted&#160;computing<br/>and&#160;virtualization.</p>
<p style="position:absolute;top:230px;left:248px;white-space:nowrap" class="ft118">The&#160;first&#160;technical&#160;component&#160;in&#160;Part&#160;II&#160;is&#160;the&#160;integrity&#160;and&#160;assurance&#160;management</p>
<p style="position:absolute;top:247px;left:226px;white-space:nowrap" class="ft1115">of&#160;the&#160;OpenTC&#160;Security&#160;Services.&#160;This&#160;has&#160;two&#160;aspects:&#160;In&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#36">5&#160;</a>we&#160;describe&#160;how<br/>integrity&#160;statements&#160;about&#160;virtual&#160;machines&#160;can&#160;be&#160;made&#160;and&#160;how&#160;data&#160;can&#160;be&#160;bound<br/>to&#160;the&#160;integrity&#160;of&#160;a&#160;machine.&#160;We&#160;also&#160;describe&#160;how&#160;to&#160;protect&#160;the&#160;privacy&#160;of&#160;users<br/>using&#160;our&#160;system.&#160;In&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#53">6&#160;</a>we&#160;extend&#160;these&#160;results&#160;to&#160;cover&#160;hierarchical&#160;integrity<br/>management,&#160;i.e.,&#160;the&#160;integrity&#160;protection&#160;of&#160;packages&#160;of&#160;multiple&#160;virtual&#160;machines&#160;and<br/>the&#160;related&#160;components.</p>
<p style="position:absolute;top:355px;left:248px;white-space:nowrap" class="ft118">The&#160;second&#160;component&#160;is&#160;our&#160;network&#160;security&#160;architecture&#160;described&#160;in&#160;Chapter&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#71">7.</a></p>
<p style="position:absolute;top:373px;left:226px;white-space:nowrap" class="ft1115">It&#160;implements&#160;two&#160;key&#160;ideas.&#160;The&#160;first&#160;idea&#160;is&#160;to&#160;provide&#160;secure&#160;virtual&#160;networks&#160;(so-<br/>called&#160;trusted&#160;virtual&#160;domains)&#160;that&#160;transparently&#160;connect&#160;VMs&#160;on&#160;multiple&#160;hosts.&#160;The<br/>second&#160;idea&#160;is&#160;to&#160;automatically&#160;provision&#160;the&#160;required&#160;protection&#160;mechanisms&#160;such&#160;that<br/>the&#160;networks&#160;guarantee&#160;a&#160;given&#160;set&#160;of&#160;user&#160;requirements.</p>
<p style="position:absolute;top:445px;left:248px;white-space:nowrap" class="ft118">The&#160;third&#160;component&#160;described&#160;in&#160;Chapter&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#98">8&#160;</a>is&#160;the&#160;public&#160;key&#160;infrastructure&#160;(PKI)</p>
<p style="position:absolute;top:463px;left:226px;white-space:nowrap" class="ft1115">that&#160;manages&#160;the&#160;keys&#160;used&#160;four&#160;security&#160;mechanisms.&#160;It&#160;also&#160;includes&#160;trusted&#160;comput-<br/>ing&#160;extensions&#160;to&#160;existing&#160;PKI&#160;standards.</p>
<p style="position:absolute;top:498px;left:248px;white-space:nowrap" class="ft118">The&#160;fourth&#160;component&#160;are&#160;trusted&#160;channels&#160;in&#160;Chapter&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#114">9&#160;</a>that&#160;enable&#160;to&#160;establish&#160;a</p>
<p style="position:absolute;top:516px;left:226px;white-space:nowrap" class="ft1114">secure&#160;channel&#160;while&#160;verifying&#160;the&#160;integrity&#160;of&#160;the&#160;peer.&#160;This&#160;allows&#160;users&#160;to&#160;not&#160;only<br/>guarantee&#160;the&#160;integrity&#160;of&#160;a&#160;given&#160;machine&#160;but&#160;also&#160;to&#160;securely&#160;connect&#160;to&#160;the&#160;machine<br/>that&#160;has&#160;been&#160;validated.</p>
<p style="position:absolute;top:570px;left:248px;white-space:nowrap" class="ft118">The&#160;fifth&#160;and&#160;final&#160;concept&#160;is&#160;our&#160;approach&#160;to&#160;attack&#160;and&#160;failure&#160;resilience&#160;as&#160;doc-</p>
<p style="position:absolute;top:588px;left:226px;white-space:nowrap" class="ft1115">ument&#160;in&#160;Chapter&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#132">10.&#160;</a>This&#160;concept&#160;comprises&#160;three&#160;main&#160;ideas.&#160;The&#160;first&#160;is&#160;to&#160;use<br/>introspection&#160;to&#160;detect&#160;viruses&#160;and&#160;other&#160;failures&#160;inside&#160;a&#160;running&#160;VM.&#160;The&#160;second&#160;is<br/>to&#160;implement&#160;redundancy&#160;for&#160;VMs&#160;and&#160;key&#160;hypervisor&#160;components&#160;such&#160;as&#160;network&#160;or<br/>disk&#160;drivers.&#160;The&#160;final&#160;idea&#160;combining&#160;them&#160;is&#160;to&#160;monitor&#160;VMs&#160;and&#160;rejuvenate&#160;VMs<br/>that&#160;are&#160;failed&#160;or&#160;are&#160;at&#160;risk&#160;of&#160;failing.&#160;Overall,&#160;this&#160;allows&#160;a&#160;substantial&#160;increase&#160;in&#160;the<br/>resiliency&#160;of&#160;the&#160;services&#160;running&#160;on&#160;this&#160;platform.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft1121">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 12 -->
<a name="12"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page12-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5012.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft128">10</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft1221">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft1221">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 13 -->
<a name="13"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page13-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5013.png" alt="background image"/>
<p style="position:absolute;top:475px;left:445px;white-space:nowrap" class="ft1325"><b>Part&#160;I</b></p>
<p style="position:absolute;top:546px;left:258px;white-space:nowrap" class="ft1322"><b>Overview&#160;and&#160;Related&#160;Work</b></p>
<p style="position:absolute;top:1117px;left:476px;white-space:nowrap" class="ft138">11</p>
</div>
<!-- Page 14 -->
<a name="14"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page14-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5014.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft148">12</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft1421">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:189px;left:150px;white-space:nowrap" class="ft1426"><b>1.4</b></p>
<p style="position:absolute;top:189px;left:198px;white-space:nowrap" class="ft1426"><b>Dependability&#160;of&#160;Virtual&#160;Systems</b></p>
<p style="position:absolute;top:227px;left:150px;white-space:nowrap" class="ft1414">We&#160;now&#160;provide&#160;a&#160;sampling&#160;of&#160;related&#160;work&#160;in&#160;the&#160;area&#160;of&#160;using&#160;VMs&#160;for&#160;improving&#160;de-<br/>pendability.&#160;We&#160;also&#160;compare&#160;our&#160;X-Spy&#160;intrusion&#160;detection&#160;framework&#160;with&#160;previous<br/>hypervisor-based&#160;intrusion&#160;detection&#160;systems.&#160;Many&#160;of&#160;these&#160;works,&#160;including&#160;ours,<br/>implicitly&#160;trust&#160;the&#160;virtualization&#160;layer&#160;to&#160;function&#160;properly,&#160;to&#160;isolate&#160;the&#160;VMs&#160;from<br/>each&#160;other,&#160;and&#160;to&#160;control&#160;the&#160;privileged&#160;access&#160;of&#160;certain&#160;VMs&#160;to&#160;other&#160;VMs.&#160;Such&#160;a<br/>trust&#160;can&#160;be&#160;justified&#160;by&#160;the&#160;observation&#160;that&#160;a&#160;typical&#160;hypervisor&#160;consists&#160;of&#160;some&#160;tens<br/>of&#160;thousands&#160;lines-of-code&#160;(LOC),&#160;whereas&#160;a&#160;typical&#160;operating&#160;system&#160;today&#160;is&#160;on&#160;the<br/>order&#160;of&#160;millions&#160;LOC&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[40]</a>.&#160;This&#160;allows&#160;a&#160;much&#160;higher&#160;assurance&#160;for&#160;the&#160;code&#160;of&#160;a<br/>hypervisor.</p>
<p style="position:absolute;top:388px;left:172px;white-space:nowrap" class="ft148">Bressoud&#160;and&#160;Schneider&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[15]&#160;</a>implemented&#160;a&#160;primary-backup&#160;replication&#160;protocol</p>
<p style="position:absolute;top:406px;left:150px;white-space:nowrap" class="ft1415">tolerant&#160;to&#160;benign&#160;faults&#160;at&#160;the&#160;VMM&#160;level.&#160;The&#160;protocol&#160;resolves&#160;non-determinism<br/>by&#160;logging&#160;the&#160;results&#160;of&#160;all&#160;non-deterministic&#160;actions&#160;taken&#160;by&#160;the&#160;primary&#160;and&#160;then<br/>applying&#160;the&#160;same&#160;results&#160;at&#160;the&#160;backups&#160;to&#160;maintain&#160;state&#160;consistency.</p>
<p style="position:absolute;top:460px;left:172px;white-space:nowrap" class="ft148">Double-Take&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[124]&#160;</a>uses&#160;hardware-based&#160;real-time&#160;synchronous&#160;replication&#160;to&#160;repli-</p>
<p style="position:absolute;top:478px;left:150px;white-space:nowrap" class="ft1415">cate&#160;application&#160;data&#160;from&#160;multiple&#160;VMs&#160;to&#160;a&#160;single&#160;physical&#160;machine&#160;so&#160;that&#160;the&#160;appli-<br/>cation&#160;can&#160;automatically&#160;fail&#160;over&#160;to&#160;a&#160;spare&#160;machine&#160;by&#160;importing&#160;the&#160;replicated&#160;data&#160;in<br/>case&#160;of&#160;an&#160;outage.&#160;As&#160;the&#160;replication&#160;is&#160;done&#160;at&#160;the&#160;file&#160;system&#160;level&#160;below&#160;the&#160;VM,&#160;the<br/>technique&#160;is&#160;guest-OS-agnostic.&#160;Such&#160;a&#160;design&#160;could&#160;provide&#160;the&#160;basis&#160;for&#160;a&#160;business<br/>model&#160;in&#160;which&#160;multiple&#160;client&#160;companies&#160;outsource&#160;their&#160;disaster&#160;recovery&#160;capability<br/>to&#160;a&#160;disaster&#160;recovery&#160;hot-site&#160;that&#160;houses&#160;multiple&#160;physical&#160;backup&#160;machines,&#160;one&#160;for<br/>each&#160;client.</p>
<p style="position:absolute;top:604px;left:172px;white-space:nowrap" class="ft148">Douceur&#160;and&#160;Howell&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[29]&#160;</a>describe&#160;how&#160;VMMs&#160;can&#160;be&#160;used&#160;to&#160;ensure&#160;that&#160;VMs</p>
<p style="position:absolute;top:622px;left:150px;white-space:nowrap" class="ft1414">satisfy&#160;determinism&#160;and&#160;thereby&#160;enable&#160;state&#160;machine&#160;replication&#160;at&#160;the&#160;VM&#160;level&#160;rather<br/>than&#160;the&#160;application&#160;level.&#160;Specifically,&#160;they&#160;describe&#160;how&#160;a&#160;VM’s&#160;virtual&#160;disk&#160;and&#160;clock<br/>can&#160;be&#160;made&#160;deterministic&#160;with&#160;respect&#160;to&#160;the&#160;VM’s&#160;execution.&#160;The&#160;design&#160;relieves&#160;the<br/>application&#160;programmer&#160;of&#160;the&#160;burden&#160;of&#160;structuring&#160;the&#160;application&#160;as&#160;a&#160;deterministic<br/>state&#160;machine.&#160;Their&#160;work&#160;is&#160;similar&#160;to&#160;Bressoud&#160;and&#160;Schneider’s&#160;approach&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[15]&#160;</a>of<br/>using&#160;a&#160;VMM&#160;to&#160;resolve&#160;non-determinism.&#160;However,&#160;the&#160;difference&#160;lies&#160;in&#160;the&#160;fact<br/>that&#160;whereas&#160;Bressoud&#160;and&#160;Schneider’s&#160;approach&#160;resolves&#160;non-determinism&#160;using&#160;the<br/>results&#160;of&#160;the&#160;primary&#160;machine’s&#160;computation,&#160;Douceur&#160;and&#160;Howell’s&#160;design&#160;resolves<br/>non-determinism&#160;<i>a&#160;priori&#160;</i>by&#160;constraining&#160;the&#160;behavior&#160;of&#160;the&#160;computation.</p>
<p style="position:absolute;top:783px;left:172px;white-space:nowrap" class="ft148">Dunlap&#160;<i>et&#160;al.&#160;</i>describe&#160;ReVirt&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[31]&#160;</a>for&#160;VM&#160;logging&#160;and&#160;replay.&#160;ReVirt&#160;encapsulates</p>
<p style="position:absolute;top:801px;left:150px;white-space:nowrap" class="ft1415">the&#160;OS&#160;as&#160;a&#160;VM,&#160;logs&#160;non-deterministic&#160;events&#160;that&#160;affect&#160;the&#160;VM’s&#160;execution,&#160;and<br/>uses&#160;the&#160;logged&#160;data&#160;to&#160;replay&#160;the&#160;VM’s&#160;execution&#160;later.&#160;Such&#160;a&#160;capability&#160;is&#160;useful<br/>to&#160;recreate&#160;the&#160;effects&#160;of&#160;non-deterministic&#160;attacks,&#160;as&#160;they&#160;show&#160;later&#160;in&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">[59]</a>.&#160;Their<br/>replay&#160;technique&#160;is&#160;to&#160;start&#160;from&#160;a&#160;checkpoint&#160;state&#160;and&#160;then&#160;roll&#160;forward&#160;using&#160;the&#160;log<br/>to&#160;reach&#160;the&#160;desired&#160;state.</p>
<p style="position:absolute;top:890px;left:172px;white-space:nowrap" class="ft148">Joshi&#160;<i>et&#160;al.&#160;</i><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">[59]&#160;</a>combine&#160;VM&#160;introspection&#160;with&#160;VM&#160;replay&#160;to&#160;analyze&#160;whether&#160;a</p>
<p style="position:absolute;top:908px;left:150px;white-space:nowrap" class="ft1414">vulnerability&#160;was&#160;activated&#160;in&#160;a&#160;VM&#160;before&#160;a&#160;patch&#160;was&#160;applied.&#160;The&#160;analysis&#160;is&#160;based<br/>on&#160;vulnerability-specific&#160;predicates&#160;provided&#160;by&#160;the&#160;patch&#160;writer.&#160;After&#160;the&#160;patch&#160;has<br/>been&#160;applied,&#160;the&#160;same&#160;predicates&#160;can&#160;be&#160;used&#160;during&#160;the&#160;VM’s&#160;normal&#160;execution&#160;to<br/>detect&#160;and&#160;respond&#160;to&#160;attacks.</p>
<p style="position:absolute;top:980px;left:172px;white-space:nowrap" class="ft148">Backtracker&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">[64]&#160;</a>can&#160;be&#160;used&#160;to&#160;identify&#160;which&#160;application&#160;running&#160;inside&#160;a&#160;VM&#160;was</p>
<p style="position:absolute;top:998px;left:150px;white-space:nowrap" class="ft1414">exploited&#160;on&#160;a&#160;given&#160;host.&#160;Backtracker&#160;consists&#160;of&#160;an&#160;online&#160;component&#160;that&#160;records&#160;OS<br/>objects&#160;(such&#160;as&#160;processes&#160;and&#160;files)&#160;and&#160;events&#160;(such&#160;as&#160;read,&#160;write,&#160;and&#160;fork),&#160;and&#160;an<br/>offline&#160;component&#160;that&#160;generates&#160;graphs&#160;depicting&#160;the&#160;possible&#160;chain&#160;of&#160;events&#160;between<br/>the&#160;point&#160;at&#160;which&#160;the&#160;exploit&#160;occurred&#160;and&#160;the&#160;point&#160;at&#160;which&#160;the&#160;exploit&#160;was&#160;detected.</p>
<p style="position:absolute;top:1070px;left:172px;white-space:nowrap" class="ft148">An&#160;extension&#160;of&#160;Backtracker&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">[66]&#160;</a>has&#160;been&#160;used&#160;to&#160;track&#160;attacks&#160;from&#160;a&#160;single&#160;host</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft1421">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 15 -->
<a name="15"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1534{font-size:15px;font-family:Courier;color:#231f20;}
-->
</style>
<div id="page15-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5015.png" alt="background image"/>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft158">13</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft1515">at&#160;which&#160;an&#160;infection&#160;has&#160;been&#160;detected&#160;to&#160;the&#160;originator&#160;of&#160;the&#160;attack&#160;and&#160;to&#160;other&#160;hosts<br/>that&#160;were&#160;compromised&#160;from&#160;that&#160;host.&#160;The&#160;extension&#160;is&#160;based&#160;on&#160;identifying&#160;causal<br/>relationships,&#160;and&#160;has&#160;also&#160;been&#160;used&#160;for&#160;correlating&#160;alerts&#160;from&#160;multiple&#160;intrusion&#160;de-<br/>tection&#160;systems.</p>
<p style="position:absolute;top:265px;left:248px;white-space:nowrap" class="ft158">King&#160;<i>et&#160;al.&#160;</i><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">[65]&#160;</a>describe&#160;the&#160;concept&#160;of&#160;time-traveling&#160;virtual&#160;machines&#160;(TTVMs),</p>
<p style="position:absolute;top:283px;left:226px;white-space:nowrap" class="ft1514">in&#160;which&#160;VM&#160;replay&#160;is&#160;used&#160;for&#160;low-overhead&#160;reverse&#160;debugging&#160;of&#160;operating&#160;systems<br/>and&#160;for&#160;providing&#160;debugging&#160;operations&#160;such&#160;as&#160;reverse&#160;break&#160;point,&#160;reverse&#160;watch<br/>point,&#160;and&#160;reverse&#160;single&#160;step.&#160;Combining&#160;efficient&#160;checkpointing&#160;techniques&#160;with&#160;Re-<br/>Virt,&#160;TTVMs&#160;can&#160;be&#160;used&#160;by&#160;programmers&#160;to&#160;go&#160;to&#160;a&#160;particular&#160;point&#160;in&#160;the&#160;execution<br/>history&#160;of&#160;a&#160;given&#160;run&#160;of&#160;the&#160;OS.&#160;To&#160;recreate&#160;all&#160;relevant&#160;state&#160;for&#160;that&#160;point,&#160;TTVMs<br/>log&#160;all&#160;sources&#160;of&#160;non-determinism.</p>
<p style="position:absolute;top:391px;left:248px;white-space:nowrap" class="ft158">Garfinkel&#160;and&#160;Rosenblum&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[40]&#160;</a>introduced&#160;the&#160;idea&#160;of&#160;hypervisor-based&#160;intrusion</p>
<p style="position:absolute;top:409px;left:226px;white-space:nowrap" class="ft1515">detection,&#160;and&#160;pointed&#160;out&#160;the&#160;advantages&#160;of&#160;this&#160;approach&#160;and&#160;its&#160;applicability&#160;not<br/>only&#160;for&#160;detection,&#160;but&#160;also&#160;for&#160;protection.&#160;Their&#160;Livewire&#160;system&#160;uses&#160;a&#160;modified<br/>VMware&#160;workstation&#160;as&#160;hypervisor&#160;and&#160;implements&#160;various&#160;polling-based&#160;and&#160;event-<br/>driven&#160;sensors.&#160;Compared&#160;with&#160;Livewire,&#160;our&#160;X-Spy&#160;system&#160;employs&#160;more&#160;extensive<br/>detection&#160;techniques&#160;(e.g.,&#160;by&#160;checking&#160;not&#160;only&#160;processes,&#160;but&#160;also&#160;kernel&#160;modules<br/>and&#160;file&#160;systems)&#160;and&#160;protection&#160;techniques&#160;(such&#160;as&#160;pre-checking&#160;and&#160;white-listing&#160;of<br/>binaries,&#160;and&#160;kernel&#160;sealing)&#160;with&#160;an&#160;explicit&#160;focus&#160;on&#160;rootkit&#160;detection.&#160;In&#160;addition,<br/>X-Spy&#160;enables&#160;easy&#160;forensic&#160;analysis.</p>
<p style="position:absolute;top:552px;left:248px;white-space:nowrap" class="ft158">Zhang&#160;<i>et&#160;al.&#160;</i><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[132]&#160;</a>and&#160;Petroni&#160;<i>et&#160;al.&#160;</i><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">[85]&#160;</a>use&#160;a&#160;secure&#160;coprocessor&#160;as&#160;the&#160;basis&#160;for</p>
<p style="position:absolute;top:570px;left:226px;white-space:nowrap" class="ft1514">checking&#160;the&#160;integrity&#160;of&#160;the&#160;OS&#160;kernel&#160;running&#160;on&#160;the&#160;main&#160;processor.&#160;However,&#160;as&#160;the<br/>coprocessor&#160;can&#160;only&#160;read&#160;the&#160;memory&#160;of&#160;the&#160;machine&#160;monitored,&#160;only&#160;polling-based<br/>intrusion&#160;detection&#160;is&#160;possible.&#160;In&#160;contrast,&#160;X-Spy&#160;can&#160;perform&#160;both&#160;polling-based<br/>and&#160;event-driven&#160;intrusion&#160;detection.&#160;Specifically,&#160;it&#160;can&#160;intercept&#160;and&#160;deny&#160;certain<br/>requested&#160;actions&#160;(such&#160;as&#160;suspicious&#160;system&#160;calls),&#160;and&#160;therefore&#160;has&#160;the&#160;capability&#160;to<br/>not&#160;only&#160;detect&#160;but&#160;also&#160;protect.</p>
<p style="position:absolute;top:678px;left:248px;white-space:nowrap" class="ft158">Laureano&#160;<i>et&#160;al.&#160;</i><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#172">[71]&#160;</a>employ&#160;behavior-based&#160;detection&#160;of&#160;anomalous&#160;system&#160;call&#160;se-</p>
<p style="position:absolute;top:696px;left:226px;white-space:nowrap" class="ft1515">quences&#160;after&#160;a&#160;learning&#160;phase&#160;in&#160;which&#160;“normal”&#160;system&#160;calls&#160;are&#160;identified.&#160;Processes<br/>with&#160;anomalous&#160;system&#160;call&#160;sequences&#160;are&#160;labeled&#160;suspicious.&#160;For&#160;these&#160;processes,&#160;cer-<br/>tain&#160;dangerous&#160;system&#160;calls&#160;will&#160;in&#160;turn&#160;be&#160;blocked.&#160;The&#160;authors&#160;describe&#160;a&#160;prototype<br/>based&#160;on&#160;a&#160;type-II&#160;hypervisor,&#160;namely,&#160;User-Mode&#160;Linux&#160;(UML)&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[28]</a>.</p>
<p style="position:absolute;top:767px;left:248px;white-space:nowrap" class="ft158">The&#160;ISIS&#160;system&#160;of&#160;Litty&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#172">[75]&#160;</a>is&#160;also&#160;based&#160;on&#160;UML.&#160;ISIS&#160;runs&#160;as&#160;a&#160;process&#160;in&#160;the</p>
<p style="position:absolute;top:785px;left:226px;white-space:nowrap" class="ft1514">host&#160;operating&#160;system&#160;and&#160;detects&#160;intrusions&#160;in&#160;the&#160;guest&#160;operating&#160;system&#160;by&#160;using<br/>the</p>
<p style="position:absolute;top:804px;left:248px;white-space:nowrap" class="ft1534">ptrace</p>
<p style="position:absolute;top:803px;left:306px;white-space:nowrap" class="ft158">system&#160;call&#160;for&#160;instrumenting&#160;the&#160;guest&#160;UML&#160;kernel.&#160;Unlike&#160;X-Spy,&#160;ISIS</p>
<p style="position:absolute;top:821px;left:226px;white-space:nowrap" class="ft158">focuses&#160;mostly&#160;on&#160;intrusion&#160;detection&#160;and&#160;not&#160;protection.</p>
<p style="position:absolute;top:839px;left:248px;white-space:nowrap" class="ft158">Jiang&#160;<i>et&#160;al.&#160;</i><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">[57]&#160;</a>describe&#160;the&#160;<i>VMwatcher&#160;</i>system,&#160;in&#160;which&#160;host-based&#160;anti-malware</p>
<p style="position:absolute;top:857px;left:226px;white-space:nowrap" class="ft1514">software&#160;is&#160;used&#160;to&#160;monitor&#160;a&#160;VM&#160;from&#160;within&#160;a&#160;different&#160;VM.&#160;X-Spy&#160;and&#160;VMwatcher<br/>are&#160;similar&#160;in&#160;that&#160;both&#160;use&#160;the&#160;hypervisor&#160;as&#160;a&#160;bridge&#160;for&#160;cross-VM&#160;inspection,&#160;and&#160;both<br/>tackle&#160;the&#160;semantic&#160;gap&#160;problem.&#160;While&#160;their&#160;work&#160;focuses&#160;on&#160;bridging&#160;the&#160;semantic<br/>gap&#160;on&#160;a&#160;multitude&#160;of&#160;platforms&#160;(hypervisors&#160;and&#160;operating&#160;systems),&#160;our&#160;work&#160;focuses<br/>on&#160;employing&#160;more&#160;extensive&#160;detection&#160;mechanisms&#160;(such&#160;as&#160;checking&#160;not&#160;only&#160;pro-<br/>cesses,&#160;but&#160;also&#160;kernel&#160;modules,&#160;network&#160;connections,&#160;and&#160;file&#160;systems)&#160;on&#160;a&#160;single<br/>hypervisor.&#160;In&#160;contrast&#160;to&#160;X-Spy,&#160;VMwatcher&#160;does&#160;not&#160;include&#160;event-driven&#160;detection<br/>methods&#160;or&#160;protection&#160;techniques.</p>
<p style="position:absolute;top:1001px;left:248px;white-space:nowrap" class="ft158">The&#160;Strider&#160;GhostBuster&#160;system&#160;by&#160;Beck&#160;<i>et&#160;al.&#160;</i><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[12]&#160;</a>is&#160;similar&#160;to&#160;X-Spy&#160;in&#160;that&#160;both</p>
<p style="position:absolute;top:1018px;left:226px;white-space:nowrap" class="ft1514">use&#160;a&#160;differential&#160;view&#160;of&#160;system&#160;resources.&#160;Strider&#160;GhostBuster&#160;compares&#160;high-level<br/>information&#160;(such&#160;as&#160;information&#160;obtained&#160;by&#160;an&#160;OS&#160;command)&#160;with&#160;low-level&#160;infor-<br/>mation&#160;(e.g.,&#160;kernel&#160;information)&#160;to&#160;detect&#160;malicious&#160;software&#160;trying&#160;to&#160;hide&#160;system<br/>resources&#160;from&#160;the&#160;user&#160;and&#160;administrator.&#160;However,&#160;such&#160;a&#160;comparison&#160;has&#160;limited</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft1521">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 16 -->
<a name="16"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page16-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5016.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft168">14</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft1621">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft1614">effectiveness&#160;as&#160;detection&#160;takes&#160;place&#160;in&#160;the&#160;same&#160;(potentially&#160;compromised)&#160;OS&#160;envi-<br/>ronment.&#160;Beck&#160;<i>et&#160;al.&#160;</i>also&#160;compare&#160;the&#160;file&#160;system&#160;view&#160;obtained&#160;from&#160;a&#160;potentially<br/>compromised&#160;OS&#160;with&#160;the&#160;view&#160;obtained&#160;from&#160;an&#160;OS&#160;booted&#160;from&#160;a&#160;clean&#160;media.&#160;The<br/>disadvantage&#160;of&#160;such&#160;an&#160;approach&#160;is&#160;that&#160;it&#160;requires&#160;multiple&#160;reboots&#160;and&#160;is&#160;limited&#160;to<br/>checking&#160;only&#160;persistent&#160;data&#160;(such&#160;as&#160;file&#160;system)&#160;and&#160;not&#160;run-time&#160;data.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft1621">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 17 -->
<a name="17"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1735{font-size:37px;line-height:44px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page17-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5017.png" alt="background image"/>
<p style="position:absolute;top:295px;left:226px;white-space:nowrap" class="ft1725"><b>Chapter&#160;2</b></p>
<p style="position:absolute;top:365px;left:226px;white-space:nowrap" class="ft1735"><b>Security&#160;Policies&#160;for&#160;Virtual<br/>Data&#160;Centers</b></p>
<p style="position:absolute;top:503px;left:226px;white-space:nowrap" class="ft1714">Data&#160;centers&#160;provide&#160;computing&#160;and&#160;storage&#160;services&#160;to&#160;multiple&#160;customers.&#160;Customers<br/>are&#160;ideally&#160;given&#160;dedicated&#160;resources&#160;such&#160;as&#160;storage&#160;and&#160;physical&#160;machines.&#160;In&#160;the<br/>physical&#160;cages&#160;approach,&#160;only&#160;few&#160;resources&#160;such&#160;as&#160;the&#160;Internet&#160;connection&#160;may&#160;be<br/>shared&#160;between&#160;multiple&#160;customers.&#160;For&#160;cost&#160;efficiency,&#160;our&#160;logical&#160;cages&#160;approach<br/>promotes&#160;securely&#160;extending&#160;sharing&#160;to&#160;other&#160;resources&#160;such&#160;as&#160;storage&#160;and&#160;networks.<br/>This&#160;is&#160;enabled&#160;by&#160;preventing&#160;unauthorized&#160;information&#160;exchange&#160;via&#160;shared&#160;resources.</p>
<p style="position:absolute;top:611px;left:248px;white-space:nowrap" class="ft178">To&#160;model&#160;and&#160;implement&#160;the&#160;logical&#160;caging&#160;approach,&#160;we&#160;introduce&#160;a&#160;domain-based</p>
<p style="position:absolute;top:628px;left:226px;white-space:nowrap" class="ft1715">security&#160;model&#160;for&#160;enforcing&#160;unified&#160;security&#160;policies&#160;in&#160;virtualized&#160;data&#160;centers.&#160;We<br/>focus&#160;on&#160;isolation&#160;policies&#160;that&#160;mimic&#160;physical&#160;separation&#160;of&#160;data&#160;center&#160;customers.&#160;Our<br/>goal&#160;is&#160;to&#160;logically&#160;separate&#160;networks,&#160;storage,&#160;VMs,&#160;users,&#160;and&#160;other&#160;virtual&#160;devices&#160;of<br/>one&#160;customer&#160;from&#160;another&#160;customer.&#160;For&#160;our&#160;purposes,&#160;we&#160;define&#160;<i>domain&#160;isolation&#160;</i>as<br/>the&#160;ability&#160;to&#160;enforce&#160;security&#160;policies&#160;within&#160;a&#160;domain&#160;independently&#160;of&#160;other&#160;domains<br/>that&#160;may&#160;co-exist&#160;on&#160;the&#160;same&#160;infrastructure&#160;and&#160;interact&#160;with&#160;that&#160;domain.&#160;The&#160;core<br/>idea&#160;is&#160;to&#160;use&#160;this&#160;isolation&#160;property&#160;as&#160;a&#160;foundation&#160;for&#160;guaranteeing&#160;desired&#160;security<br/>properties&#160;within&#160;each&#160;virtual&#160;domain&#160;while&#160;managing&#160;shared&#160;services&#160;under&#160;mutually<br/>agreed&#160;policies.</p>
<p style="position:absolute;top:790px;left:248px;white-space:nowrap" class="ft178">We&#160;now&#160;explain&#160;the&#160;policies&#160;that&#160;describe&#160;this&#160;controlled&#160;information&#160;exchange&#160;in&#160;a</p>
<p style="position:absolute;top:808px;left:226px;white-space:nowrap" class="ft1715">virtualized&#160;data&#160;center.&#160;In&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#24">3&#160;</a>we&#160;describe&#160;the&#160;individual&#160;components&#160;that&#160;enable<br/>us&#160;to&#160;enforce&#160;these&#160;policies.</p>
<p style="position:absolute;top:872px;left:226px;white-space:nowrap" class="ft1726"><b>2.1</b></p>
<p style="position:absolute;top:872px;left:274px;white-space:nowrap" class="ft1726"><b>High-level&#160;Policy&#160;Model</b></p>
<p style="position:absolute;top:910px;left:226px;white-space:nowrap" class="ft1714">The&#160;security&#160;model&#160;includes&#160;two&#160;high-level&#160;policies&#160;defining&#160;the&#160;security&#160;objectives<br/>that&#160;must&#160;be&#160;provided&#160;by&#160;the&#160;underlying&#160;infrastructure:</p>
<p style="position:absolute;top:960px;left:226px;white-space:nowrap" class="ft1723"><b>Inter-TVD&#160;Policy:&#160;</b>By&#160;default,&#160;each&#160;TVD&#160;is&#160;isolated&#160;from&#160;the&#160;outside&#160;world.&#160;The</p>
<p style="position:absolute;top:978px;left:263px;white-space:nowrap" class="ft1714">high-level&#160;information-exchange&#160;policy&#160;defines&#160;whether&#160;and&#160;how&#160;information<br/>can&#160;be&#160;exchanged&#160;with&#160;other&#160;TVDs.&#160;If&#160;no&#160;information&#160;flow&#160;with&#160;other&#160;TVDs&#160;is<br/>permitted,&#160;no&#160;resources&#160;can&#160;be&#160;shared&#160;unless&#160;the&#160;data&#160;center&#160;operator&#160;can&#160;guar-<br/>antee&#160;that&#160;the&#160;isolation&#160;is&#160;preserved.&#160;If&#160;information&#160;flow&#160;to/from&#160;other&#160;TVDs&#160;is<br/>allowed,&#160;sub-policies&#160;further&#160;qualify&#160;the&#160;exact&#160;information&#160;flow&#160;policy&#160;for&#160;the<br/>individual&#160;resources.</p>
<p style="position:absolute;top:1117px;left:476px;white-space:nowrap" class="ft178">15</p>
</div>
<!-- Page 18 -->
<a name="18"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1836{font-size:13px;font-family:ZRSKVS+TTE26Fo00;color:#000000;}
	.ft1837{font-size:8px;font-family:QEHNHK+TTE270o00;color:#000000;}
	.ft1838{font-size:13px;font-family:Helvetica;color:#000000;}
	.ft1839{font-size:13px;line-height:15px;font-family:Helvetica;color:#000000;}
	.ft1840{font-size:15px;line-height:18px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page18-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5018.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft188">16</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft1821">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:191px;left:423px;white-space:nowrap" class="ft1836">VPE</p>
<p style="position:absolute;top:199px;left:443px;white-space:nowrap" class="ft1837">1&#160;</p>
<p style="position:absolute;top:206px;left:418px;white-space:nowrap" class="ft1836">(Role</p>
<p style="position:absolute;top:214px;left:445px;white-space:nowrap" class="ft1837">1)</p>
<p style="position:absolute;top:195px;left:258px;white-space:nowrap" class="ft1839">Roles&#160;of&#160;Single-Domain<br/>Machines&#160;(subjects):</p>
<p style="position:absolute;top:278px;left:258px;white-space:nowrap" class="ft1839">Multi-Domain&#160;Resources&#160;<br/>(objects)</p>
<p style="position:absolute;top:236px;left:258px;white-space:nowrap" class="ft1839">Operations[parameter]&#160;<br/>(mode):</p>
<p style="position:absolute;top:191px;left:474px;white-space:nowrap" class="ft1836">VPE</p>
<p style="position:absolute;top:199px;left:494px;white-space:nowrap" class="ft1837">2&#160;</p>
<p style="position:absolute;top:206px;left:470px;white-space:nowrap" class="ft1836">(Role</p>
<p style="position:absolute;top:214px;left:496px;white-space:nowrap" class="ft1837">2)</p>
<p style="position:absolute;top:191px;left:526px;white-space:nowrap" class="ft1836">VPE</p>
<p style="position:absolute;top:199px;left:545px;white-space:nowrap" class="ft1837">3&#160;</p>
<p style="position:absolute;top:206px;left:521px;white-space:nowrap" class="ft1836">(Role</p>
<p style="position:absolute;top:214px;left:547px;white-space:nowrap" class="ft1837">3)</p>
<p style="position:absolute;top:340px;left:172px;white-space:nowrap" class="ft188">Figure&#160;2.1:&#160;Policy&#160;Model:&#160;Single-TVD&#160;Machines&#160;operate&#160;on&#160;Shared&#160;Resources</p>
<p style="position:absolute;top:388px;left:150px;white-space:nowrap" class="ft1823"><b>Intra-TVD&#160;Policy:&#160;</b>Domain&#160;policies&#160;allow&#160;TVD&#160;owners&#160;(e.g.,&#160;customers)&#160;to&#160;define&#160;the</p>
<p style="position:absolute;top:406px;left:187px;white-space:nowrap" class="ft1814">security&#160;objectives&#160;within&#160;their&#160;own&#160;TVDs.&#160;Examples&#160;of&#160;such&#160;policies&#160;include<br/>how&#160;the&#160;internal&#160;communication&#160;is&#160;to&#160;be&#160;protected&#160;and&#160;under&#160;what&#160;conditions<br/>resources&#160;(e.g.,&#160;storage,&#160;machines)&#160;can&#160;join&#160;a&#160;particular&#160;TVD.</p>
<p style="position:absolute;top:475px;left:150px;white-space:nowrap" class="ft1814">We&#160;further&#160;define&#160;more&#160;fine-grained&#160;policies&#160;by&#160;the&#160;use&#160;of&#160;<i>roles&#160;</i>that&#160;can&#160;be&#160;assigned<br/>to&#160;any&#160;member&#160;VM,&#160;say&#160;to&#160;a&#160;member&#160;machine.&#160;This&#160;allows&#160;us&#160;to&#160;define&#160;and&#160;enforce<br/>role-based&#160;policies&#160;within&#160;and&#160;across&#160;TVDs.&#160;For&#160;example,&#160;machines&#160;can&#160;now&#160;assume<br/>internal&#160;or&#160;gateway&#160;roles&#160;with&#160;corresponding&#160;permissions;&#160;while&#160;a&#160;workstation&#160;may&#160;not<br/>be&#160;allowed&#160;to&#160;connect&#160;to&#160;non-TVD&#160;networks,&#160;machines&#160;with&#160;the&#160;“firewall”&#160;role&#160;can&#160;be<br/>allowed&#160;to&#160;connect&#160;to&#160;selected&#160;other&#160;networks.&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#18">2.1&#160;</a>depicts&#160;three&#160;VMs&#160;in&#160;a&#160;single<br/>TVD.&#160;Each&#160;VM&#160;is&#160;given&#160;different&#160;levels&#160;of&#160;access&#160;to&#160;resources&#160;with&#160;respect&#160;to&#160;their&#160;role<br/>for&#160;that&#160;TVD.</p>
<p style="position:absolute;top:646px;left:150px;white-space:nowrap" class="ft1826"><b>2.2</b></p>
<p style="position:absolute;top:646px;left:198px;white-space:nowrap" class="ft1826"><b>Security&#160;Objectives&#160;and&#160;Policy&#160;Enforcement&#160;Points</b></p>
<p style="position:absolute;top:684px;left:150px;white-space:nowrap" class="ft1814">Policies&#160;are&#160;enforced&#160;for&#160;all&#160;shared&#160;resources&#160;in&#160;the&#160;TVD&#160;infrastructure&#160;(see&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#19">2.2)</a>.<br/>The&#160;basis&#160;of&#160;all&#160;policies&#160;is&#160;isolation&#160;at&#160;the&#160;boundary&#160;of&#160;each&#160;TVD.&#160;By&#160;default,&#160;each<br/>resource&#160;is&#160;associated&#160;with&#160;a&#160;single&#160;domain.&#160;This&#160;achieves&#160;a&#160;basic&#160;level&#160;of&#160;isolation.&#160;If<br/>information&#160;flow&#160;between&#160;TVDs&#160;is&#160;allowed,&#160;resources&#160;can&#160;also&#160;be&#160;member&#160;of&#160;different<br/>TVDs.&#160;For&#160;example,&#160;a&#160;TVD&#160;can&#160;allow&#160;certain&#160;types&#160;of&#160;resources&#160;on&#160;certain&#160;hosts&#160;to<br/>provide&#160;services&#160;also&#160;to&#160;other&#160;domains.&#160;Each&#160;TVD&#160;defines&#160;rules&#160;regarding&#160;in-bound<br/>and&#160;out-bound&#160;information&#160;flow&#160;for&#160;restricting&#160;communication&#160;with&#160;the&#160;outside&#160;world.<br/>The&#160;underlying&#160;policy-enforcement&#160;infrastructure&#160;then&#160;has&#160;to&#160;ensure&#160;that&#160;only&#160;resources<br/>trusted&#160;by&#160;all&#160;TVDs&#160;are&#160;shared.</p>
<p style="position:absolute;top:845px;left:172px;white-space:nowrap" class="ft188">Architecturally,&#160;there&#160;are&#160;two&#160;ways&#160;of&#160;enforcing&#160;such&#160;rules,&#160;depending&#160;on&#160;the&#160;trust</p>
<p style="position:absolute;top:863px;left:150px;white-space:nowrap" class="ft1814">between&#160;the&#160;TVDs.&#160;The&#160;first&#160;method&#160;involves&#160;two&#160;shared&#160;resources&#160;connected&#160;by&#160;an<br/>intermediate&#160;domain.&#160;In&#160;this&#160;method,&#160;each&#160;TVD&#160;enforces&#160;its&#160;side&#160;of&#160;the&#160;flow&#160;control<br/>by&#160;means&#160;of&#160;its&#160;own&#160;shared&#160;resource.&#160;An&#160;example&#160;of&#160;this&#160;type&#160;of&#160;connection&#160;is&#160;the&#160;one<br/>that&#160;exists&#160;between&#160;<i>TVD&#160;A&#160;</i>and&#160;<i>TVD&#160;B&#160;</i>in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#19">2.2.&#160;</a>This&#160;method&#160;is&#160;used&#160;when&#160;the<br/>trust&#160;level&#160;between&#160;<i>TVD&#160;A&#160;</i>and&#160;<i>TVD&#160;B&#160;</i>is&#160;low,&#160;and&#160;the&#160;two&#160;cannot&#160;agree&#160;on&#160;a&#160;shared<br/>resource&#160;that&#160;is&#160;mutually&#160;trusted.&#160;The&#160;shared&#160;resource&#160;in&#160;<i>TVD&#160;A&#160;</i>will&#160;enforce&#160;<i>TVD&#160;A</i>’s<br/>policies&#160;regarding&#160;in-bound&#160;traffic&#160;from&#160;<i>TVD&#160;B</i>,&#160;even&#160;if&#160;the&#160;shared&#160;resource&#160;in&#160;<i>TVD&#160;B<br/></i>does&#160;not&#160;enforce&#160;<i>TVD&#160;B</i>’s&#160;policies&#160;regarding&#160;out-bound&#160;traffic.&#160;The&#160;shared&#160;resources<br/>can&#160;be&#160;thought&#160;of&#160;being&#160;a&#160;part&#160;of&#160;a&#160;“neutral”&#160;TVD&#160;(<i>TVD&#160;AB</i>)&#160;with&#160;its&#160;own&#160;set&#160;of&#160;mem-<br/>bership&#160;requirements.&#160;The&#160;second&#160;method&#160;that&#160;requires&#160;shared&#160;trust&#160;is&#160;to&#160;establish&#160;one<br/>or&#160;more&#160;shared&#160;resources&#160;that&#160;are&#160;accessed&#160;from&#160;both&#160;TVDs&#160;while&#160;allowing&#160;controlled<br/>information&#160;flow.&#160;This&#160;mechanism&#160;is&#160;used&#160;between&#160;<i>TVD&#160;B&#160;</i>and&#160;<i>TVD&#160;C&#160;</i>in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#19">2.2.</a></p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft1821">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 19 -->
<a name="19"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1941{font-size:19px;font-family:Helvetica;color:#000000;}
	.ft1942{font-size:14px;font-family:Helvetica;color:#000000;}
	.ft1943{font-size:9px;font-family:Helvetica;color:#000000;}
	.ft1944{font-size:8px;font-family:Helvetica;color:#000000;}
	.ft1945{font-size:9px;font-family:Helvetica;color:#000000;}
	.ft1946{font-size:15px;font-family:HHSPQG+CMMI10;color:#231f20;}
	.ft1947{font-size:10px;font-family:YTDDTT+CMMI7;color:#231f20;}
	.ft1948{font-size:15px;font-family:FEJUEM+CMR10;color:#231f20;}
	.ft1949{font-size:9px;line-height:11px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page19-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5019.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft198">CHAPTER&#160;2.&#160;SECURITY&#160;POLICIES&#160;FOR&#160;VIRTUAL&#160;DATA&#160;CENTERS</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft198">17</p>
<p style="position:absolute;top:197px;left:312px;white-space:nowrap" class="ft1941"><b>TVD&#160;A</b></p>
<p style="position:absolute;top:197px;left:487px;white-space:nowrap" class="ft1941"><b>TVD&#160;B</b></p>
<p style="position:absolute;top:361px;left:232px;white-space:nowrap" class="ft1942">Internet</p>
<p style="position:absolute;top:265px;left:313px;white-space:nowrap" class="ft1949">Membership<br/>Constraints</p>
<p style="position:absolute;top:336px;left:389px;white-space:nowrap" class="ft1943">Flow&#160;Enforcement&#160;</p>
<p style="position:absolute;top:347px;left:397px;white-space:nowrap" class="ft1943">by&#160;Single-trust&#160;</p>
<p style="position:absolute;top:359px;left:389px;white-space:nowrap" class="ft1943">Shared&#160;Resources</p>
<p style="position:absolute;top:336px;left:322px;white-space:nowrap" class="ft1943">Isolation&#160;</p>
<p style="position:absolute;top:347px;left:313px;white-space:nowrap" class="ft1943">Enforcement</p>
<p style="position:absolute;top:197px;left:572px;white-space:nowrap" class="ft1941"><b>TVD&#160;C</b></p>
<p style="position:absolute;top:336px;left:515px;white-space:nowrap" class="ft1943">Flow&#160;Enforcement&#160;</p>
<p style="position:absolute;top:347px;left:514px;white-space:nowrap" class="ft1943">by&#160;Mutually&#160;Trusted</p>
<p style="position:absolute;top:359px;left:516px;white-space:nowrap" class="ft1943">Shared&#160;Resources</p>
<p style="position:absolute;top:220px;left:393px;white-space:nowrap" class="ft1941"><b>TVD&#160;AB</b></p>
<p style="position:absolute;top:303px;left:400px;white-space:nowrap" class="ft1944">Shared&#160;Resource</p>
<p style="position:absolute;top:270px;left:657px;white-space:nowrap" class="ft1943">Internal</p>
<p style="position:absolute;top:289px;left:657px;white-space:nowrap" class="ft1943">Trusted/Shared</p>
<p style="position:absolute;top:251px;left:657px;white-space:nowrap" class="ft1945"><b>Resource&#160;Types:</b></p>
<p style="position:absolute;top:209px;left:662px;white-space:nowrap" class="ft1945"><b>Machine&#160;in&#160;Role</b></p>
<p style="position:absolute;top:401px;left:226px;white-space:nowrap" class="ft1914">Figure&#160;2.2:&#160;Usage&#160;Control&#160;for&#160;Shared&#160;Resources:&#160;Machines&#160;use&#160;resources&#160;belonging&#160;to<br/>TVDs.</p>
<p style="position:absolute;top:449px;left:399px;white-space:nowrap" class="ft198">From&#160;/&#160;to</p>
<p style="position:absolute;top:448px;left:473px;white-space:nowrap" class="ft1946">D</p>
<p style="position:absolute;top:454px;left:485px;white-space:nowrap" class="ft1947">I</p>
<p style="position:absolute;top:448px;left:510px;white-space:nowrap" class="ft1946">D</p>
<p style="position:absolute;top:454px;left:522px;white-space:nowrap" class="ft1947">D</p>
<p style="position:absolute;top:448px;left:551px;white-space:nowrap" class="ft1946">D</p>
<p style="position:absolute;top:454px;left:564px;white-space:nowrap" class="ft1947">i</p>
<p style="position:absolute;top:467px;left:417px;white-space:nowrap" class="ft1946">D</p>
<p style="position:absolute;top:473px;left:430px;white-space:nowrap" class="ft1947">I</p>
<p style="position:absolute;top:468px;left:479px;white-space:nowrap" class="ft1923"><b>1</b></p>
<p style="position:absolute;top:468px;left:518px;white-space:nowrap" class="ft198">1</p>
<p style="position:absolute;top:468px;left:556px;white-space:nowrap" class="ft198">0</p>
<p style="position:absolute;top:485px;left:415px;white-space:nowrap" class="ft1946">D</p>
<p style="position:absolute;top:491px;left:428px;white-space:nowrap" class="ft1947">D</p>
<p style="position:absolute;top:486px;left:479px;white-space:nowrap" class="ft198">0</p>
<p style="position:absolute;top:486px;left:518px;white-space:nowrap" class="ft1923"><b>1</b></p>
<p style="position:absolute;top:486px;left:556px;white-space:nowrap" class="ft198">1</p>
<p style="position:absolute;top:503px;left:418px;white-space:nowrap" class="ft1946">D</p>
<p style="position:absolute;top:509px;left:431px;white-space:nowrap" class="ft1947">i</p>
<p style="position:absolute;top:504px;left:479px;white-space:nowrap" class="ft198">0</p>
<p style="position:absolute;top:504px;left:518px;white-space:nowrap" class="ft198">1</p>
<p style="position:absolute;top:504px;left:556px;white-space:nowrap" class="ft1923"><b>1</b></p>
<p style="position:absolute;top:536px;left:226px;white-space:nowrap" class="ft198">Table&#160;2.1:&#160;High-level&#160;Directed&#160;Flow&#160;Control&#160;Matrix&#160;for&#160;Internet</p>
<p style="position:absolute;top:535px;left:622px;white-space:nowrap" class="ft1946">D</p>
<p style="position:absolute;top:541px;left:635px;white-space:nowrap" class="ft1947">I</p>
<p style="position:absolute;top:536px;left:641px;white-space:nowrap" class="ft198">,&#160;DMZ</p>
<p style="position:absolute;top:535px;left:688px;white-space:nowrap" class="ft1946">D</p>
<p style="position:absolute;top:541px;left:701px;white-space:nowrap" class="ft1947">D</p>
<p style="position:absolute;top:536px;left:711px;white-space:nowrap" class="ft198">,&#160;and</p>
<p style="position:absolute;top:554px;left:226px;white-space:nowrap" class="ft198">Intranet</p>
<p style="position:absolute;top:553px;left:276px;white-space:nowrap" class="ft1946">D</p>
<p style="position:absolute;top:559px;left:289px;white-space:nowrap" class="ft1947">i</p>
<p style="position:absolute;top:554px;left:294px;white-space:nowrap" class="ft198">.</p>
<p style="position:absolute;top:601px;left:248px;white-space:nowrap" class="ft198">Security&#160;within&#160;a&#160;virtual&#160;domain&#160;is&#160;finally&#160;obtained&#160;by&#160;defining&#160;and&#160;enforcing&#160;<i>mem-</i></p>
<p style="position:absolute;top:619px;left:226px;white-space:nowrap" class="ft1915"><i>bership&#160;requirements&#160;</i>that&#160;resources&#160;have&#160;to&#160;satisfy&#160;prior&#160;to&#160;being&#160;admitted&#160;to&#160;the&#160;TVD<br/>and&#160;for&#160;retaining&#160;the&#160;membership.&#160;This&#160;may&#160;also&#160;include&#160;special&#160;requirements&#160;for<br/>different&#160;machine&#160;types:&#160;Because,&#160;for&#160;example,&#160;shared&#160;resources&#160;play&#160;a&#160;key&#160;role&#160;in<br/>restricting&#160;information&#160;flow&#160;between&#160;TVDs,&#160;the&#160;software&#160;on&#160;those&#160;machines&#160;may&#160;be<br/>subject&#160;to&#160;additional&#160;integrity&#160;verification&#160;as&#160;compared&#160;to&#160;the&#160;software&#160;on&#160;regular&#160;VMs.</p>
<p style="position:absolute;top:731px;left:226px;white-space:nowrap" class="ft1924"><b>2.2.1</b></p>
<p style="position:absolute;top:731px;left:280px;white-space:nowrap" class="ft1924"><b>Permitted&#160;Flows&#160;in&#160;Data&#160;Centers</b></p>
<p style="position:absolute;top:761px;left:226px;white-space:nowrap" class="ft1914">At&#160;a&#160;high&#160;level&#160;flow&#160;control&#160;policies&#160;define&#160;the&#160;allowed&#160;traffic&#160;flow&#160;between&#160;two&#160;do-<br/>mains&#160;and&#160;how&#160;the&#160;domains&#160;should&#160;be&#160;protected.&#160;Allowed&#160;information&#160;flows&#160;can&#160;be<br/>represented&#160;by&#160;a&#160;simple&#160;flow&#160;control&#160;matrix&#160;as&#160;depicted&#160;in&#160;Table&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#19">2.1,&#160;</a>where</p>
<p style="position:absolute;top:796px;left:672px;white-space:nowrap" class="ft1948">1</p>
<p style="position:absolute;top:797px;left:683px;white-space:nowrap" class="ft198">allows&#160;in-</p>
<p style="position:absolute;top:815px;left:226px;white-space:nowrap" class="ft198">formation&#160;flow&#160;and</p>
<p style="position:absolute;top:814px;left:344px;white-space:nowrap" class="ft1948">0</p>
<p style="position:absolute;top:815px;left:355px;white-space:nowrap" class="ft198">denies&#160;it.&#160;This&#160;example&#160;implements&#160;a&#160;basic&#160;enterprise&#160;policy&#160;that</p>
<p style="position:absolute;top:833px;left:226px;white-space:nowrap" class="ft198">regulates&#160;incoming&#160;flow&#160;from&#160;untrusted&#160;outside&#160;entities&#160;(</p>
<p style="position:absolute;top:832px;left:575px;white-space:nowrap" class="ft1946">D</p>
<p style="position:absolute;top:838px;left:587px;white-space:nowrap" class="ft1947">I</p>
<p style="position:absolute;top:833px;left:594px;white-space:nowrap" class="ft198">)&#160;through&#160;a&#160;semi-trusted</p>
<p style="position:absolute;top:851px;left:226px;white-space:nowrap" class="ft198">intermediary&#160;domain&#160;(</p>
<p style="position:absolute;top:850px;left:361px;white-space:nowrap" class="ft1946">D</p>
<p style="position:absolute;top:856px;left:373px;white-space:nowrap" class="ft1947">D</p>
<p style="position:absolute;top:851px;left:384px;white-space:nowrap" class="ft198">),&#160;and&#160;disallows&#160;any&#160;outgoing&#160;flow.&#160;Note&#160;that&#160;this&#160;matrix&#160;is</p>
<p style="position:absolute;top:869px;left:226px;white-space:nowrap" class="ft1914">directional,&#160;i.e.,&#160;it&#160;might&#160;allow&#160;flows&#160;in&#160;one&#160;direction&#160;but&#160;not&#160;in&#160;the&#160;opposite&#160;direction.<br/>If&#160;flow&#160;policies&#160;between&#160;two&#160;TVDs&#160;are&#160;asymmetric,&#160;only&#160;shared&#160;resources&#160;that&#160;can<br/>enforce&#160;these&#160;policies&#160;are&#160;permitted.</p>
<p style="position:absolute;top:923px;left:248px;white-space:nowrap" class="ft198">Device-specific&#160;policies&#160;(network,&#160;storage)&#160;can&#160;then&#160;refine&#160;these&#160;basic&#160;rules.&#160;If&#160;an</p>
<p style="position:absolute;top:941px;left:226px;white-space:nowrap" class="ft1914">information&#160;flow&#160;is&#160;not&#160;permitted,&#160;then&#160;also&#160;shared&#160;resources&#160;are&#160;not&#160;permitted&#160;between<br/>these&#160;TVDs.</p>
<p style="position:absolute;top:999px;left:226px;white-space:nowrap" class="ft1924"><b>2.2.2</b></p>
<p style="position:absolute;top:999px;left:280px;white-space:nowrap" class="ft1924"><b>Membership&#160;Requirements</b></p>
<p style="position:absolute;top:1029px;left:226px;white-space:nowrap" class="ft1915">Membership&#160;requirements&#160;define&#160;under&#160;what&#160;conditions&#160;resources&#160;may&#160;join&#160;a&#160;domain.<br/>From&#160;a&#160;high-level&#160;policy&#160;perspective,&#160;several&#160;criteria&#160;can&#160;be&#160;applied&#160;to&#160;decide&#160;whether<br/>an&#160;entity&#160;is&#160;allowed&#160;to&#160;join&#160;a&#160;domain,&#160;for&#160;example:</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft1921">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 20 -->
<a name="20"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2050{font-size:15px;font-family:KCVLUL+CMSY10;color:#231f20;}
	.ft2051{font-size:22px;line-height:26px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page20-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5020.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft208">18</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft2021">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:193px;left:172px;white-space:nowrap" class="ft2050">•</p>
<p style="position:absolute;top:194px;left:187px;white-space:nowrap" class="ft2014"><i>Certificates</i>:&#160;An&#160;authority&#160;defined&#160;by&#160;the&#160;TVD&#160;policy&#160;can&#160;certify&#160;a&#160;resource&#160;to<br/>be&#160;member&#160;of&#160;a&#160;TVD.&#160;A&#160;common&#160;example&#160;is&#160;that&#160;an&#160;enterprise&#160;issues&#160;machine<br/>certificates&#160;to&#160;allow&#160;its&#160;machines&#160;to&#160;join&#160;the&#160;corporate&#160;network.</p>
<p style="position:absolute;top:258px;left:172px;white-space:nowrap" class="ft2050">•</p>
<p style="position:absolute;top:259px;left:187px;white-space:nowrap" class="ft2014"><i>Integrity&#160;Proofs</i>:&#160;A&#160;resource&#160;may&#160;prove&#160;its&#160;right&#160;to&#160;join&#160;a&#160;TVD&#160;using&#160;integrity<br/>proofs.&#160;It&#160;may,&#160;e.g.,&#160;prove&#160;that&#160;the&#160;integrity&#160;of&#160;the&#160;base&#160;operating&#160;system&#160;is&#160;intact<br/>and&#160;that&#160;all&#160;required&#160;patches&#160;have&#160;been&#160;applied&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[103]</a>.</p>
<p style="position:absolute;top:324px;left:172px;white-space:nowrap" class="ft2050">•</p>
<p style="position:absolute;top:325px;left:187px;white-space:nowrap" class="ft2014"><i>User-identity</i>:&#160;Only&#160;machines&#160;operated&#160;by&#160;a&#160;certain&#160;user&#160;can&#160;join.&#160;This&#160;can&#160;be<br/>validated&#160;by&#160;user-name/password&#160;or&#160;by&#160;a&#160;cryptographic&#160;token.</p>
<p style="position:absolute;top:376px;left:150px;white-space:nowrap" class="ft2015">In&#160;general,&#160;a&#160;resource&#160;may&#160;need&#160;to&#160;show&#160;proper&#160;credentials&#160;to&#160;prove&#160;that&#160;it&#160;fulfills<br/>certain&#160;properties&#160;before&#160;allowing&#160;the&#160;resource&#160;to&#160;join&#160;the&#160;TVD&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[96]</a>.&#160;More&#160;formally,<br/>a&#160;machine</p>
<p style="position:absolute;top:411px;left:216px;white-space:nowrap" class="ft2046">m</p>
<p style="position:absolute;top:412px;left:233px;white-space:nowrap" class="ft208">is&#160;permitted&#160;to&#160;join&#160;a&#160;TVD</p>
<p style="position:absolute;top:411px;left:399px;white-space:nowrap" class="ft2046">t</p>
<p style="position:absolute;top:412px;left:409px;white-space:nowrap" class="ft208">if&#160;and&#160;only&#160;if&#160;there&#160;is&#160;at&#160;least&#160;one&#160;property</p>
<p style="position:absolute;top:430px;left:150px;white-space:nowrap" class="ft208">of</p>
<p style="position:absolute;top:429px;left:167px;white-space:nowrap" class="ft2046">m</p>
<p style="position:absolute;top:430px;left:184px;white-space:nowrap" class="ft208">that&#160;satisfies&#160;each&#160;security&#160;requirement&#160;of</p>
<p style="position:absolute;top:429px;left:440px;white-space:nowrap" class="ft2046">t</p>
<p style="position:absolute;top:430px;left:446px;white-space:nowrap" class="ft208">.&#160;The&#160;validations&#160;of&#160;these&#160;properties</p>
<p style="position:absolute;top:448px;left:150px;white-space:nowrap" class="ft2015">are&#160;usually&#160;done&#160;on&#160;a&#160;per-type&#160;and&#160;role&#160;basis.&#160;For&#160;example,&#160;requirements&#160;for&#160;a&#160;shared<br/>resource&#160;are&#160;usually&#160;stronger&#160;than&#160;the&#160;requirements&#160;for&#160;a&#160;TVD-internal&#160;resource.</p>
<p style="position:absolute;top:512px;left:150px;white-space:nowrap" class="ft2026"><b>2.3</b></p>
<p style="position:absolute;top:512px;left:198px;white-space:nowrap" class="ft2051"><b>Example&#160;Policy&#160;Refinements&#160;for&#160;Protected&#160;Re-<br/>sources</b></p>
<p style="position:absolute;top:576px;left:150px;white-space:nowrap" class="ft2014">Policies&#160;alone&#160;are&#160;not&#160;sufficient&#160;to&#160;enforce&#160;customer&#160;separation&#160;in&#160;a&#160;virtualized&#160;data<br/>center.&#160;Ultimately,&#160;one&#160;needs&#160;to&#160;transform&#160;these&#160;policies&#160;into&#160;data&#160;center&#160;configurations<br/>and&#160;security&#160;mechanisms&#160;specific&#160;to&#160;each&#160;resource&#160;(e.g.,&#160;VLAN&#160;configuration).&#160;To&#160;do<br/>so,&#160;we&#160;introduce&#160;a&#160;policy&#160;management&#160;scheme&#160;that&#160;accepts&#160;high-level&#160;domain&#160;policies<br/>and&#160;transforms&#160;them&#160;into&#160;resource-specific&#160;low-level&#160;policies&#160;and&#160;configurations.&#160;In<br/>Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#154">11&#160;</a>we&#160;demonstrate&#160;a&#160;prototype&#160;based&#160;on&#160;this&#160;architecture&#160;that&#160;enforces&#160;high-<br/>level&#160;TVD&#160;policies&#160;by&#160;lower-level&#160;network&#160;and&#160;infrastructure&#160;configurations,&#160;which&#160;is<br/>then&#160;deployed&#160;onto&#160;each&#160;physical&#160;platform&#160;to&#160;assist&#160;customer&#160;separation.</p>
<p style="position:absolute;top:743px;left:150px;white-space:nowrap" class="ft2024"><b>2.3.1</b></p>
<p style="position:absolute;top:743px;left:204px;white-space:nowrap" class="ft2024"><b>Refinement&#160;Model</b></p>
<p style="position:absolute;top:773px;left:150px;white-space:nowrap" class="ft2015">The&#160;high-level&#160;policy&#160;defines&#160;the&#160;basic&#160;flow&#160;control,&#160;protection,&#160;and&#160;admission&#160;require-<br/>ments.&#160;We&#160;aim&#160;at&#160;enforcing&#160;these&#160;high-level&#160;objectives&#160;throughout&#160;all&#160;resources&#160;in&#160;the<br/>data&#160;center.</p>
<p style="position:absolute;top:826px;left:172px;white-space:nowrap" class="ft208">In&#160;the&#160;high-level&#160;model,&#160;flow&#160;control&#160;across&#160;customer&#160;domains&#160;is&#160;specified&#160;by&#160;a</p>
<p style="position:absolute;top:844px;left:150px;white-space:nowrap" class="ft2015">simple&#160;matrix&#160;such&#160;as&#160;the&#160;one&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#19">2.1&#160;</a>that&#160;defines&#160;whether&#160;flows&#160;are&#160;permit-<br/>ted.&#160;This&#160;however&#160;is&#160;not&#160;sufficiently&#160;fine-grained&#160;for&#160;specific&#160;resources.&#160;TVDs,&#160;for<br/>example,&#160;want&#160;to&#160;restrict&#160;their&#160;flow&#160;across&#160;boundaries&#160;by&#160;means&#160;of&#160;firewall&#160;rules.&#160;As<br/>a&#160;consequence,&#160;we&#160;need&#160;to&#160;introduce&#160;a&#160;notion&#160;of&#160;policy&#160;refinement&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[127]</a>,&#160;because&#160;as<br/>translation&#160;moves&#160;towards&#160;lower&#160;levels&#160;of&#160;abstraction,&#160;it&#160;will&#160;require&#160;additional&#160;infor-<br/>mation&#160;(e.g.,&#160;physical&#160;arrangement&#160;of&#160;the&#160;data&#160;center,&#160;“subjective”&#160;trust&#160;information)&#160;to<br/>be&#160;correctly&#160;and&#160;coherently&#160;executed.</p>
<p style="position:absolute;top:970px;left:172px;white-space:nowrap" class="ft208">Our&#160;notion&#160;of&#160;policy&#160;refinement&#160;mandates&#160;the&#160;enforcement&#160;of&#160;“no&#160;flow”&#160;objec-</p>
<p style="position:absolute;top:988px;left:150px;white-space:nowrap" class="ft2015">tives&#160;while&#160;allowing&#160;each&#160;resource&#160;to&#160;refine&#160;what&#160;it&#160;means&#160;so&#160;that&#160;flows&#160;are&#160;permitted<br/>and&#160;how&#160;exactly&#160;unauthorized&#160;flows&#160;shall&#160;be&#160;prevented.&#160;Similarly,&#160;we&#160;do&#160;not&#160;allow<br/>resources&#160;to&#160;deviate&#160;from&#160;the&#160;confidentiality/integrity&#160;objectives;&#160;however,&#160;certain&#160;re-<br/>sources&#160;can&#160;be&#160;declared&#160;trusted&#160;so&#160;that&#160;they&#160;may&#160;enforce&#160;these&#160;objectives&#160;without&#160;addi-<br/>tional&#160;security&#160;mechanisms&#160;such&#160;as&#160;encryption&#160;or&#160;authentication.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft2021">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 21 -->
<a name="21"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2152{font-size:15px;font-family:PBVTQS+CMBX10;color:#231f20;}
-->
</style>
<div id="page21-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5021.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft218">CHAPTER&#160;2.&#160;SECURITY&#160;POLICIES&#160;FOR&#160;VIRTUAL&#160;DATA&#160;CENTERS</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft218">19</p>
<p style="position:absolute;top:191px;left:308px;white-space:nowrap" class="ft218">Flow&#160;to</p>
<p style="position:absolute;top:190px;left:362px;white-space:nowrap" class="ft2150">→</p>
<p style="position:absolute;top:190px;left:395px;white-space:nowrap" class="ft2146">D</p>
<p style="position:absolute;top:196px;left:407px;white-space:nowrap" class="ft2147">I</p>
<p style="position:absolute;top:190px;left:494px;white-space:nowrap" class="ft2146">D</p>
<p style="position:absolute;top:196px;left:506px;white-space:nowrap" class="ft2147">D</p>
<p style="position:absolute;top:190px;left:598px;white-space:nowrap" class="ft2146">D</p>
<p style="position:absolute;top:196px;left:610px;white-space:nowrap" class="ft2147">i</p>
<p style="position:absolute;top:209px;left:288px;white-space:nowrap" class="ft218">Enforced&#160;by</p>
<p style="position:absolute;top:208px;left:369px;white-space:nowrap" class="ft2150">↓</p>
<p style="position:absolute;top:209px;left:392px;white-space:nowrap" class="ft218">gate</p>
<p style="position:absolute;top:209px;left:431px;white-space:nowrap" class="ft218">internal</p>
<p style="position:absolute;top:209px;left:493px;white-space:nowrap" class="ft218">gate</p>
<p style="position:absolute;top:209px;left:534px;white-space:nowrap" class="ft218">internal</p>
<p style="position:absolute;top:209px;left:594px;white-space:nowrap" class="ft218">gate</p>
<p style="position:absolute;top:209px;left:634px;white-space:nowrap" class="ft218">internal</p>
<p style="position:absolute;top:227px;left:358px;white-space:nowrap" class="ft2146">D</p>
<p style="position:absolute;top:233px;left:370px;white-space:nowrap" class="ft2147">I</p>
<p style="position:absolute;top:228px;left:400px;white-space:nowrap" class="ft2152">1</p>
<p style="position:absolute;top:228px;left:450px;white-space:nowrap" class="ft2152">1</p>
<p style="position:absolute;top:227px;left:492px;white-space:nowrap" class="ft2146">P</p>
<p style="position:absolute;top:233px;left:502px;white-space:nowrap" class="ft2147">ID</p>
<p style="position:absolute;top:227px;left:553px;white-space:nowrap" class="ft2148">0</p>
<p style="position:absolute;top:228px;left:602px;white-space:nowrap" class="ft2152">0</p>
<p style="position:absolute;top:228px;left:653px;white-space:nowrap" class="ft2152">0</p>
<p style="position:absolute;top:245px;left:354px;white-space:nowrap" class="ft2146">D</p>
<p style="position:absolute;top:250px;left:366px;white-space:nowrap" class="ft2147">D</p>
<p style="position:absolute;top:245px;left:401px;white-space:nowrap" class="ft2148">0</p>
<p style="position:absolute;top:245px;left:451px;white-space:nowrap" class="ft2148">0</p>
<p style="position:absolute;top:245px;left:501px;white-space:nowrap" class="ft2152">1</p>
<p style="position:absolute;top:245px;left:552px;white-space:nowrap" class="ft2152">1</p>
<p style="position:absolute;top:245px;left:594px;white-space:nowrap" class="ft2146">P</p>
<p style="position:absolute;top:250px;left:604px;white-space:nowrap" class="ft2147">Di</p>
<p style="position:absolute;top:245px;left:653px;white-space:nowrap" class="ft2148">0</p>
<p style="position:absolute;top:263px;left:359px;white-space:nowrap" class="ft2146">D</p>
<p style="position:absolute;top:268px;left:372px;white-space:nowrap" class="ft2147">i</p>
<p style="position:absolute;top:263px;left:400px;white-space:nowrap" class="ft2152">0</p>
<p style="position:absolute;top:263px;left:450px;white-space:nowrap" class="ft2152">0</p>
<p style="position:absolute;top:263px;left:493px;white-space:nowrap" class="ft2146">P</p>
<p style="position:absolute;top:268px;left:503px;white-space:nowrap" class="ft2147">Di</p>
<p style="position:absolute;top:263px;left:553px;white-space:nowrap" class="ft2148">0</p>
<p style="position:absolute;top:263px;left:602px;white-space:nowrap" class="ft2152">1</p>
<p style="position:absolute;top:263px;left:653px;white-space:nowrap" class="ft2152">1</p>
<p style="position:absolute;top:295px;left:261px;white-space:nowrap" class="ft218">Table&#160;2.2:&#160;Example&#160;Network&#160;Flow&#160;Control&#160;Policy&#160;Matrix&#160;for&#160;Three&#160;TVDs.</p>
<p style="position:absolute;top:358px;left:248px;white-space:nowrap" class="ft218">Similarly,&#160;the&#160;fact&#160;that&#160;admission&#160;is&#160;restricted&#160;is&#160;then&#160;refined&#160;by&#160;specific&#160;admission</p>
<p style="position:absolute;top:376px;left:226px;white-space:nowrap" class="ft218">control&#160;policies&#160;that&#160;are&#160;enforced&#160;by&#160;the&#160;underlying&#160;infrastructure.</p>
<p style="position:absolute;top:394px;left:248px;white-space:nowrap" class="ft218">Note&#160;that&#160;conflict&#160;detection&#160;and&#160;resolution&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[127,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#172">76]&#160;</a>can&#160;later&#160;be&#160;used&#160;to&#160;extend&#160;this</p>
<p style="position:absolute;top:412px;left:226px;white-space:nowrap" class="ft2115">simple&#160;notion&#160;of&#160;refinement.&#160;However,&#160;we&#160;currently&#160;stay&#160;on&#160;the&#160;safe&#160;side:&#160;Connections<br/>are&#160;only&#160;possible&#160;if&#160;both&#160;TVDs&#160;allow&#160;them.&#160;Similarly,&#160;if&#160;one&#160;domain&#160;requires&#160;confi-<br/>dentiality,&#160;information&#160;flows&#160;are&#160;only&#160;allowed&#160;to&#160;TVDs&#160;that&#160;also&#160;require&#160;confidentiality.<br/>Other&#160;schemes&#160;for&#160;more&#160;elaborate&#160;flow&#160;control&#160;have&#160;been&#160;proposed&#160;in&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[33,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">17,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">32,&#160;38]</a>.</p>
<p style="position:absolute;top:507px;left:226px;white-space:nowrap" class="ft2124"><b>2.3.2</b></p>
<p style="position:absolute;top:507px;left:280px;white-space:nowrap" class="ft2124"><b>Network&#160;Security&#160;Policies</b></p>
<p style="position:absolute;top:537px;left:226px;white-space:nowrap" class="ft2115">We&#160;now&#160;survey&#160;the&#160;policy&#160;model&#160;of&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[18]&#160;</a>and&#160;show&#160;how&#160;it&#160;related&#160;to&#160;the&#160;corresponding<br/>high-level&#160;policy.&#160;Similar&#160;to&#160;our&#160;high-level&#160;policies,&#160;there&#160;are&#160;two&#160;types&#160;of&#160;policies<br/>governing&#160;security&#160;in&#160;the&#160;network.&#160;The&#160;first&#160;limits&#160;flow&#160;between&#160;networks,&#160;whereas&#160;the<br/>second&#160;defines&#160;membership&#160;requirements&#160;to&#160;each&#160;network.</p>
<p style="position:absolute;top:630px;left:226px;white-space:nowrap" class="ft2123"><b>Network&#160;Security&#160;Policies&#160;across&#160;TVDs</b></p>
<p style="position:absolute;top:630px;left:490px;white-space:nowrap" class="ft218">A&#160;policy&#160;covers&#160;isolation&#160;and&#160;flow&#160;control</p>
<p style="position:absolute;top:648px;left:226px;white-space:nowrap" class="ft2115">between&#160;TVDs&#160;as&#160;well&#160;as&#160;integrity&#160;and&#160;confidentiality&#160;against&#160;outsiders.&#160;These&#160;basic<br/>security&#160;requirements&#160;are&#160;then&#160;mapped&#160;to&#160;appropriate&#160;policies&#160;for&#160;each&#160;resource.&#160;For<br/>example,&#160;from&#160;a&#160;networking&#160;perspective,&#160;isolation&#160;refers&#160;to&#160;the&#160;requirement&#160;that,&#160;unless<br/>the&#160;inter-TVD&#160;policies&#160;explicitly&#160;allow&#160;such&#160;an&#160;information&#160;flow,&#160;a&#160;dishonest&#160;VM&#160;in&#160;one<br/>TVD&#160;cannot&#160;(1)&#160;send&#160;messages&#160;to&#160;a&#160;dishonest&#160;VM&#160;in&#160;another&#160;TVD&#160;(information&#160;flow),<br/>(2)&#160;read&#160;messages&#160;sent&#160;on&#160;another&#160;TVD&#160;(confidentiality),&#160;(3)&#160;alter&#160;messages&#160;transmitted<br/>on&#160;another&#160;TVD&#160;(data&#160;integrity),&#160;and&#160;(4)&#160;become&#160;a&#160;member&#160;of&#160;another&#160;TVD&#160;network<br/>(access&#160;control).</p>
<p style="position:absolute;top:792px;left:248px;white-space:nowrap" class="ft218">TVDs&#160;often&#160;constitute&#160;independent&#160;organizational&#160;units&#160;that&#160;may&#160;not&#160;trust&#160;each</p>
<p style="position:absolute;top:810px;left:226px;white-space:nowrap" class="ft2114">other.&#160;If&#160;this&#160;is&#160;the&#160;case,&#160;a&#160;communication&#160;using&#160;another&#160;TVD&#160;can&#160;be&#160;established&#160;(see<br/>the&#160;communication&#160;between&#160;TVD&#160;A&#160;and&#160;B&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#19">2.2)</a>.&#160;The&#160;advantage&#160;of&#160;such&#160;a<br/>decentralized&#160;enforcement&#160;approach&#160;is&#160;that&#160;each&#160;TVD&#160;is&#160;shielded&#160;from&#160;security&#160;failures<br/>in&#160;other&#160;TVDs,&#160;thus&#160;contribute&#160;to&#160;domain&#160;isolation.&#160;For&#160;networks,&#160;the&#160;main&#160;inter-<br/>TVD&#160;security&#160;objectives&#160;are&#160;controlled&#160;information&#160;sharing&#160;among&#160;the&#160;TVDs&#160;as&#160;well<br/>as&#160;integrity&#160;and&#160;confidentiality&#160;protection&#160;of&#160;the&#160;channel.</p>
<p style="position:absolute;top:917px;left:248px;white-space:nowrap" class="ft218">While&#160;the&#160;high-level&#160;model&#160;specifies&#160;whether&#160;information&#160;exchange&#160;is&#160;allowed&#160;be-</p>
<p style="position:absolute;top:935px;left:226px;white-space:nowrap" class="ft218">tween&#160;domains&#160;or&#160;not,&#160;we&#160;now&#160;refine&#160;this&#160;policy&#160;as&#160;follows:</p>
<p style="position:absolute;top:967px;left:248px;white-space:nowrap" class="ft2150">•</p>
<p style="position:absolute;top:968px;left:263px;white-space:nowrap" class="ft2114">We&#160;refine&#160;the&#160;active&#160;elements&#160;(subjects)&#160;of&#160;given&#160;domains&#160;by&#160;introducing&#160;roles<br/>that&#160;machines&#160;can&#160;play.&#160;This&#160;allows&#160;us&#160;to&#160;set&#160;different&#160;permissions&#160;to&#160;boundary<br/>machines&#160;as&#160;compared&#160;to&#160;internal&#160;machines.</p>
<p style="position:absolute;top:1033px;left:248px;white-space:nowrap" class="ft2150">•</p>
<p style="position:absolute;top:1034px;left:263px;white-space:nowrap" class="ft2114">In&#160;case&#160;information&#160;flow&#160;is&#160;permitted&#160;in&#160;principle,&#160;we&#160;refine&#160;the&#160;network&#160;secu-<br/>rity&#160;policies&#160;by&#160;introducing&#160;flow&#160;control&#160;rules&#160;that&#160;can&#160;further&#160;restrict&#160;the&#160;actual</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft2121">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 22 -->
<a name="22"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2253{font-size:15px;font-family:ZGHGFF+CMTI10;color:#231f20;}
	.ft2254{font-size:12px;font-family:Times;color:#231f20;}
	.ft2255{font-size:12px;line-height:14px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page22-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5022.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft228">20</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft2221">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:187px;white-space:nowrap" class="ft2214">information&#160;exchange.&#160;A&#160;network&#160;policy&#160;may&#160;disallow&#160;flow&#160;even&#160;though&#160;it&#160;has<br/>been&#160;allowed&#160;from&#160;a&#160;high-level&#160;policy&#160;perspective.</p>
<p style="position:absolute;top:244px;left:150px;white-space:nowrap" class="ft2214">An&#160;information&#160;flow&#160;control&#160;matrix&#160;is&#160;a&#160;simple&#160;way&#160;of&#160;formalizing&#160;these&#160;network&#160;con-<br/>nectivity&#160;objectives.&#160;Table&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#21">2.2&#160;</a>shows&#160;a&#160;sample&#160;matrix&#160;for&#160;the&#160;three&#160;example&#160;TVDs<br/>introduced&#160;earlier.&#160;Each&#160;matrix&#160;element&#160;represents&#160;a&#160;policy&#160;specifying&#160;permitted&#160;con-<br/>nections&#160;between&#160;a&#160;pair&#160;of&#160;TVDs,&#160;as&#160;enforced&#160;by&#160;one&#160;of&#160;the&#160;TVDs.&#160;The&#160;depicted<br/>policies</p>
<p style="position:absolute;top:315px;left:200px;white-space:nowrap" class="ft2246">P</p>
<p style="position:absolute;top:321px;left:210px;white-space:nowrap" class="ft2247">x</p>
<p style="position:absolute;top:316px;left:221px;white-space:nowrap" class="ft228">that&#160;limit&#160;information&#160;exchange&#160;will&#160;be&#160;implemented&#160;by&#160;firewall&#160;rules&#160;that</p>
<p style="position:absolute;top:334px;left:150px;white-space:nowrap" class="ft228">are&#160;used&#160;to&#160;program&#160;the&#160;boundary&#160;firewalls.&#160;The</p>
<p style="position:absolute;top:334px;left:453px;white-space:nowrap" class="ft2252">1</p>
<p style="position:absolute;top:334px;left:466px;white-space:nowrap" class="ft228">values&#160;along&#160;the&#160;matrix&#160;diagonal</p>
<p style="position:absolute;top:352px;left:150px;white-space:nowrap" class="ft228">convey&#160;the&#160;fact&#160;that&#160;there&#160;is&#160;free&#160;information&#160;exchange&#160;within&#160;each&#160;TVD.&#160;The</p>
<p style="position:absolute;top:352px;left:629px;white-space:nowrap" class="ft2252">0</p>
<p style="position:absolute;top:352px;left:643px;white-space:nowrap" class="ft228">val-</p>
<p style="position:absolute;top:370px;left:150px;white-space:nowrap" class="ft2214">ues&#160;in&#160;the&#160;matrix&#160;are&#160;used&#160;to&#160;specify&#160;that&#160;there&#160;should&#160;be&#160;no&#160;direct&#160;information&#160;flow<br/>between&#160;two&#160;TVDs,&#160;e.g.,&#160;between&#160;the&#160;Internet</p>
<p style="position:absolute;top:387px;left:434px;white-space:nowrap" class="ft2246">D</p>
<p style="position:absolute;top:393px;left:447px;white-space:nowrap" class="ft2247">I</p>
<p style="position:absolute;top:388px;left:458px;white-space:nowrap" class="ft228">and&#160;the&#160;intranet</p>
<p style="position:absolute;top:387px;left:557px;white-space:nowrap" class="ft2246">D</p>
<p style="position:absolute;top:393px;left:569px;white-space:nowrap" class="ft2247">i</p>
<p style="position:absolute;top:388px;left:574px;white-space:nowrap" class="ft228">.&#160;Care&#160;must&#160;be</p>
<p style="position:absolute;top:406px;left:150px;white-space:nowrap" class="ft2214">taken&#160;to&#160;ensure&#160;that&#160;the&#160;pairwise&#160;TVD&#160;policies&#160;specified&#160;in&#160;the&#160;information&#160;flow&#160;control<br/>matrix&#160;do&#160;not&#160;accidentally&#160;contradict&#160;each&#160;other&#160;or&#160;allow&#160;undesired&#160;indirect&#160;flow.</p>
<p style="position:absolute;top:464px;left:150px;white-space:nowrap" class="ft2223"><b>Intra-TVD&#160;Network&#160;Security&#160;Policy</b></p>
<p style="position:absolute;top:464px;left:397px;white-space:nowrap" class="ft228">Within&#160;a&#160;TVD,&#160;all&#160;VMs&#160;can&#160;freely&#160;commu-</p>
<p style="position:absolute;top:482px;left:150px;white-space:nowrap" class="ft2215">nicate&#160;with&#160;each&#160;other&#160;while&#160;observing&#160;TVD-specific&#160;integrity&#160;and&#160;confidentiality&#160;re-<br/>quirements.&#160;For&#160;this&#160;purpose,&#160;the&#160;underlying&#160;infrastructure&#160;may&#160;ensure&#160;that&#160;intra-TVD<br/>communication&#160;only&#160;takes&#160;place&#160;over&#160;an&#160;authenticated&#160;and&#160;encrypted&#160;channel&#160;(e.g.,<br/>IPSec),&#160;or&#160;alternatively,&#160;a&#160;trusted&#160;networ<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#22">k</a></p>
<p style="position:absolute;top:533px;left:398px;white-space:nowrap" class="ft2227"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#22">1</a></p>
<p style="position:absolute;top:535px;left:404px;white-space:nowrap" class="ft228"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#22">.</a></p>
<p style="position:absolute;top:576px;left:150px;white-space:nowrap" class="ft2224"><b>2.3.3</b></p>
<p style="position:absolute;top:576px;left:204px;white-space:nowrap" class="ft2224"><b>Towards&#160;Storage&#160;Security&#160;Policies</b></p>
<p style="position:absolute;top:606px;left:150px;white-space:nowrap" class="ft2214">Virtual&#160;disks&#160;attached&#160;to&#160;VMs&#160;must&#160;retain&#160;the&#160;advantages&#160;offered&#160;by&#160;storage&#160;virtualiza-<br/>tion&#160;while&#160;at&#160;the&#160;same&#160;time&#160;enforcing&#160;TVD&#160;security&#160;policies.&#160;Advantages&#160;of&#160;storage<br/>virtualization&#160;include&#160;improved&#160;storage&#160;utilization,&#160;simplified&#160;storage&#160;administration,<br/>and&#160;the&#160;flexibility&#160;to&#160;accommodate&#160;heterogeneous&#160;physical&#160;storage&#160;devices.&#160;Similar&#160;to<br/>network,&#160;we&#160;now&#160;show&#160;a&#160;refinement&#160;of&#160;the&#160;high-level&#160;TVD&#160;policies&#160;into&#160;access&#160;control<br/>policies&#160;for&#160;VMs&#160;in&#160;certain&#160;roles&#160;to&#160;disks&#160;belonging&#160;to&#160;a&#160;domain.</p>
<p style="position:absolute;top:736px;left:150px;white-space:nowrap" class="ft2223"><b>Inter-TVD&#160;Storage&#160;Security</b></p>
<p style="position:absolute;top:736px;left:344px;white-space:nowrap" class="ft228">A&#160;virtual&#160;disk&#160;has&#160;a&#160;single&#160;label&#160;corresponding&#160;to&#160;the</p>
<p style="position:absolute;top:754px;left:150px;white-space:nowrap" class="ft2215">TVD&#160;it&#160;belongs&#160;to.&#160;Whenever&#160;a&#160;virtual&#160;machine&#160;operates&#160;on&#160;virtual&#160;storage,&#160;the&#160;global<br/>flow&#160;matrix&#160;described&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#17">2&#160;</a>needs&#160;to&#160;be&#160;satisfied.&#160;For&#160;flexibility,&#160;each&#160;TVD&#160;can<br/>define&#160;a&#160;set&#160;of&#160;storage&#160;policies&#160;that&#160;govern&#160;usage&#160;and&#160;security&#160;of&#160;its&#160;storage.&#160;A&#160;single<br/>policy&#160;is&#160;then&#160;assigned&#160;to&#160;and&#160;enforced&#160;for&#160;each&#160;storage&#160;volume.</p>
<p style="position:absolute;top:825px;left:172px;white-space:nowrap" class="ft228">As&#160;the&#160;starting&#160;point&#160;of&#160;our&#160;storage&#160;policy&#160;refinement,&#160;we&#160;define&#160;a&#160;<i>maximum&#160;per-</i></p>
<p style="position:absolute;top:843px;left:150px;white-space:nowrap" class="ft2220"><i>mission&#160;policy&#160;</i>as&#160;follows:</p>
<p style="position:absolute;top:876px;left:168px;white-space:nowrap" class="ft228">1.&#160;Any&#160;machine&#160;in&#160;domain</p>
<p style="position:absolute;top:875px;left:337px;white-space:nowrap" class="ft2253">TVD</p>
<p style="position:absolute;top:881px;left:372px;white-space:nowrap" class="ft2247">A</p>
<p style="position:absolute;top:876px;left:386px;white-space:nowrap" class="ft228">playing&#160;any&#160;role&#160;can&#160;write&#160;to&#160;a&#160;disk&#160;of&#160;domain</p>
<p style="position:absolute;top:893px;left:187px;white-space:nowrap" class="ft2253">TVD</p>
<p style="position:absolute;top:899px;left:222px;white-space:nowrap" class="ft2247">B</p>
<p style="position:absolute;top:894px;left:236px;white-space:nowrap" class="ft228">iff&#160;flow&#160;from&#160;domain</p>
<p style="position:absolute;top:893px;left:364px;white-space:nowrap" class="ft2253">TVD</p>
<p style="position:absolute;top:899px;left:399px;white-space:nowrap" class="ft2247">A</p>
<p style="position:absolute;top:894px;left:412px;white-space:nowrap" class="ft228">to&#160;domain</p>
<p style="position:absolute;top:893px;left:476px;white-space:nowrap" class="ft2253">TVD</p>
<p style="position:absolute;top:899px;left:511px;white-space:nowrap" class="ft2247">B</p>
<p style="position:absolute;top:894px;left:525px;white-space:nowrap" class="ft228">is&#160;permitted.</p>
<p style="position:absolute;top:924px;left:168px;white-space:nowrap" class="ft228">2.&#160;Any&#160;machine&#160;in&#160;domain</p>
<p style="position:absolute;top:923px;left:333px;white-space:nowrap" class="ft2253">TVD</p>
<p style="position:absolute;top:929px;left:368px;white-space:nowrap" class="ft2247">A</p>
<p style="position:absolute;top:924px;left:381px;white-space:nowrap" class="ft228">playing&#160;any&#160;role&#160;can&#160;read&#160;from&#160;a&#160;disk&#160;of&#160;domain</p>
<p style="position:absolute;top:941px;left:187px;white-space:nowrap" class="ft2253">TVD</p>
<p style="position:absolute;top:947px;left:222px;white-space:nowrap" class="ft2247">B</p>
<p style="position:absolute;top:942px;left:236px;white-space:nowrap" class="ft228">iff&#160;flow&#160;from&#160;domain</p>
<p style="position:absolute;top:941px;left:364px;white-space:nowrap" class="ft2253">TVD</p>
<p style="position:absolute;top:947px;left:399px;white-space:nowrap" class="ft2247">B</p>
<p style="position:absolute;top:942px;left:413px;white-space:nowrap" class="ft228">to&#160;domain</p>
<p style="position:absolute;top:941px;left:477px;white-space:nowrap" class="ft2253">TVD</p>
<p style="position:absolute;top:947px;left:511px;white-space:nowrap" class="ft2247">A</p>
<p style="position:absolute;top:942px;left:525px;white-space:nowrap" class="ft228">is&#160;permitted.</p>
<p style="position:absolute;top:972px;left:168px;white-space:nowrap" class="ft228">3.&#160;Any&#160;single&#160;machine&#160;in&#160;any&#160;domain&#160;can&#160;read/write&#160;mount&#160;a&#160;blank&#160;disk.&#160;After&#160;data</p>
<p style="position:absolute;top:989px;left:187px;white-space:nowrap" class="ft2214">is&#160;written,&#160;the&#160;disk&#160;changes&#160;ownership&#160;and&#160;is&#160;now&#160;assigned&#160;to&#160;the&#160;domain&#160;of&#160;the<br/>machine&#160;who&#160;has&#160;written&#160;data.</p>
<p style="position:absolute;top:1031px;left:166px;white-space:nowrap" class="ft2228">1</p>
<p style="position:absolute;top:1033px;left:171px;white-space:nowrap" class="ft2219">A&#160;network&#160;is&#160;called&#160;<i>trusted&#160;</i>with&#160;respect&#160;to&#160;a&#160;TVD&#160;security&#160;objective&#160;if&#160;it&#160;is&#160;trusted&#160;to&#160;enforce&#160;the&#160;given</p>
<p style="position:absolute;top:1048px;left:150px;white-space:nowrap" class="ft2255">objective&#160;transparently.&#160;For&#160;example,&#160;a&#160;server-internal&#160;Ethernet&#160;can&#160;often&#160;be&#160;assumed&#160;to&#160;provide&#160;confiden-<br/>tiality&#160;without&#160;any&#160;need&#160;for&#160;encryption.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft2221">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 23 -->
<a name="23"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page23-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5023.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft238">CHAPTER&#160;2.&#160;SECURITY&#160;POLICIES&#160;FOR&#160;VIRTUAL&#160;DATA&#160;CENTERS</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft238">21</p>
<p style="position:absolute;top:191px;left:255px;white-space:nowrap" class="ft238">Flow&#160;to</p>
<p style="position:absolute;top:190px;left:309px;white-space:nowrap" class="ft2350">→</p>
<p style="position:absolute;top:190px;left:356px;white-space:nowrap" class="ft2346">D</p>
<p style="position:absolute;top:196px;left:368px;white-space:nowrap" class="ft2347">I</p>
<p style="position:absolute;top:190px;left:485px;white-space:nowrap" class="ft2346">D</p>
<p style="position:absolute;top:196px;left:497px;white-space:nowrap" class="ft2347">D</p>
<p style="position:absolute;top:190px;left:618px;white-space:nowrap" class="ft2346">D</p>
<p style="position:absolute;top:196px;left:630px;white-space:nowrap" class="ft2347">i</p>
<p style="position:absolute;top:209px;left:255px;white-space:nowrap" class="ft238">Disk</p>
<p style="position:absolute;top:208px;left:291px;white-space:nowrap" class="ft2350">↓</p>
<p style="position:absolute;top:209px;left:353px;white-space:nowrap" class="ft238">gate</p>
<p style="position:absolute;top:209px;left:407px;white-space:nowrap" class="ft238">internal</p>
<p style="position:absolute;top:209px;left:484px;white-space:nowrap" class="ft238">gate</p>
<p style="position:absolute;top:209px;left:540px;white-space:nowrap" class="ft238">internal</p>
<p style="position:absolute;top:209px;left:614px;white-space:nowrap" class="ft238">gate</p>
<p style="position:absolute;top:209px;left:667px;white-space:nowrap" class="ft238">internal</p>
<p style="position:absolute;top:227px;left:304px;white-space:nowrap" class="ft2346">D</p>
<p style="position:absolute;top:233px;left:317px;white-space:nowrap" class="ft2347">I</p>
<p style="position:absolute;top:227px;left:352px;white-space:nowrap" class="ft2346">r/w</p>
<p style="position:absolute;top:227px;left:417px;white-space:nowrap" class="ft2346">r/w</p>
<p style="position:absolute;top:227px;left:491px;white-space:nowrap" class="ft2346">w</p>
<p style="position:absolute;top:227px;left:559px;white-space:nowrap" class="ft2348">0</p>
<p style="position:absolute;top:228px;left:622px;white-space:nowrap" class="ft2352">0</p>
<p style="position:absolute;top:228px;left:686px;white-space:nowrap" class="ft2352">0</p>
<p style="position:absolute;top:245px;left:300px;white-space:nowrap" class="ft2346">D</p>
<p style="position:absolute;top:250px;left:313px;white-space:nowrap" class="ft2347">D</p>
<p style="position:absolute;top:245px;left:362px;white-space:nowrap" class="ft2346">r</p>
<p style="position:absolute;top:245px;left:426px;white-space:nowrap" class="ft2348">0</p>
<p style="position:absolute;top:245px;left:483px;white-space:nowrap" class="ft2346">r/w</p>
<p style="position:absolute;top:245px;left:550px;white-space:nowrap" class="ft2346">r/w</p>
<p style="position:absolute;top:245px;left:613px;white-space:nowrap" class="ft2346">r/w</p>
<p style="position:absolute;top:245px;left:686px;white-space:nowrap" class="ft2348">0</p>
<p style="position:absolute;top:263px;left:306px;white-space:nowrap" class="ft2346">D</p>
<p style="position:absolute;top:268px;left:318px;white-space:nowrap" class="ft2347">i</p>
<p style="position:absolute;top:263px;left:361px;white-space:nowrap" class="ft2352">0</p>
<p style="position:absolute;top:263px;left:425px;white-space:nowrap" class="ft2352">0</p>
<p style="position:absolute;top:263px;left:483px;white-space:nowrap" class="ft2346">r/w</p>
<p style="position:absolute;top:263px;left:559px;white-space:nowrap" class="ft2348">0</p>
<p style="position:absolute;top:263px;left:613px;white-space:nowrap" class="ft2346">r/w</p>
<p style="position:absolute;top:263px;left:677px;white-space:nowrap" class="ft2346">r/w</p>
<p style="position:absolute;top:282px;left:288px;white-space:nowrap" class="ft238">Blank</p>
<p style="position:absolute;top:281px;left:358px;white-space:nowrap" class="ft2346">r/</p>
<p style="position:absolute;top:281px;left:426px;white-space:nowrap" class="ft2348">0</p>
<p style="position:absolute;top:281px;left:489px;white-space:nowrap" class="ft2346">r/</p>
<p style="position:absolute;top:281px;left:559px;white-space:nowrap" class="ft2348">0</p>
<p style="position:absolute;top:281px;left:619px;white-space:nowrap" class="ft2346">r/</p>
<p style="position:absolute;top:281px;left:686px;white-space:nowrap" class="ft2348">0</p>
<p style="position:absolute;top:298px;left:338px;white-space:nowrap" class="ft2346">w</p>
<p style="position:absolute;top:298px;left:354px;white-space:nowrap" class="ft2350">→</p>
<p style="position:absolute;top:298px;left:373px;white-space:nowrap" class="ft2346">D</p>
<p style="position:absolute;top:304px;left:385px;white-space:nowrap" class="ft2347">I</p>
<p style="position:absolute;top:298px;left:426px;white-space:nowrap" class="ft2348">0</p>
<p style="position:absolute;top:298px;left:467px;white-space:nowrap" class="ft2346">w</p>
<p style="position:absolute;top:298px;left:483px;white-space:nowrap" class="ft2350">→</p>
<p style="position:absolute;top:298px;left:502px;white-space:nowrap" class="ft2346">D</p>
<p style="position:absolute;top:304px;left:514px;white-space:nowrap" class="ft2347">D</p>
<p style="position:absolute;top:298px;left:559px;white-space:nowrap" class="ft2348">0</p>
<p style="position:absolute;top:298px;left:600px;white-space:nowrap" class="ft2346">w</p>
<p style="position:absolute;top:298px;left:616px;white-space:nowrap" class="ft2350">→</p>
<p style="position:absolute;top:298px;left:635px;white-space:nowrap" class="ft2346">D</p>
<p style="position:absolute;top:304px;left:647px;white-space:nowrap" class="ft2347">i</p>
<p style="position:absolute;top:298px;left:686px;white-space:nowrap" class="ft2348">0</p>
<p style="position:absolute;top:331px;left:276px;white-space:nowrap" class="ft238">Table&#160;2.3:&#160;Example&#160;of&#160;a&#160;Refined&#160;Disk&#160;Policy&#160;Matrix&#160;for&#160;Three&#160;TVDs.</p>
<p style="position:absolute;top:394px;left:226px;white-space:nowrap" class="ft2315">Table&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#23">2.3&#160;</a>shows&#160;the&#160;resulting&#160;maximum&#160;disk&#160;access&#160;control&#160;policy.&#160;Actual&#160;policies&#160;are<br/>then&#160;valid&#160;with&#160;respect&#160;to&#160;a&#160;maximum-permission&#160;policy&#160;for&#160;a&#160;domain&#160;if&#160;they&#160;permit<br/>a&#160;subset&#160;of&#160;its&#160;permissions.&#160;Note&#160;that&#160;as&#160;flow&#160;within&#160;a&#160;domain&#160;is&#160;always&#160;allowed,<br/>this&#160;implies&#160;that&#160;disks&#160;of&#160;the&#160;same&#160;domain&#160;as&#160;the&#160;machine&#160;may&#160;always&#160;be&#160;mounted<br/>read/write.</p>
<p style="position:absolute;top:506px;left:226px;white-space:nowrap" class="ft2323"><b>Intra-TVD&#160;Storage&#160;Security</b></p>
<p style="position:absolute;top:506px;left:424px;white-space:nowrap" class="ft238">By&#160;default,&#160;we&#160;consider&#160;the&#160;content&#160;of&#160;a&#160;disk&#160;to&#160;be</p>
<p style="position:absolute;top:524px;left:226px;white-space:nowrap" class="ft2314">confidential&#160;while&#160;the&#160;storage&#160;medium&#160;(possibly&#160;remote)&#160;is&#160;deemed&#160;to&#160;be&#160;untrusted.&#160;As<br/>a&#160;consequence,&#160;if&#160;a&#160;given&#160;domain&#160;does&#160;not&#160;declare&#160;a&#160;given&#160;storage&#160;medium&#160;as&#160;trusted,<br/>we&#160;deploy&#160;whole-disk&#160;encryption&#160;using&#160;a&#160;key&#160;that&#160;is&#160;maintained&#160;by&#160;the&#160;TVD&#160;infrastruc-<br/>ture<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#23">.</a></p>
<p style="position:absolute;top:575px;left:253px;white-space:nowrap" class="ft2327"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#23">2</a></p>
<p style="position:absolute;top:578px;left:265px;white-space:nowrap" class="ft238">Another&#160;aspect&#160;reflected&#160;in&#160;the&#160;disk&#160;policies&#160;is&#160;the&#160;fact&#160;that&#160;we&#160;have&#160;a&#160;notion&#160;of</p>
<p style="position:absolute;top:595px;left:226px;white-space:nowrap" class="ft2315">blank&#160;disks.&#160;Once&#160;they&#160;are&#160;written&#160;by&#160;another&#160;domain,&#160;they&#160;change&#160;color,&#160;and&#160;are&#160;then<br/>associated&#160;with&#160;this&#160;other&#160;domain&#160;while&#160;being&#160;encrypted&#160;under&#160;the&#160;corresponding&#160;key.<br/>In&#160;the&#160;future,&#160;it&#160;would&#160;be&#160;desirable&#160;to&#160;have&#160;integrity-protected&#160;storage&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[24,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">89]&#160;</a>where<br/>the&#160;TVD&#160;can&#160;validate&#160;that&#160;its&#160;content&#160;have&#160;not&#160;been&#160;changed&#160;by&#160;untrusted&#160;entities.</p>
<p style="position:absolute;top:667px;left:248px;white-space:nowrap" class="ft238">For&#160;protecting&#160;the&#160;data&#160;in&#160;a&#160;particular&#160;TVD,&#160;virtual&#160;storage&#160;may&#160;in&#160;addition&#160;specify</p>
<p style="position:absolute;top:685px;left:226px;white-space:nowrap" class="ft2315">which&#160;conditions&#160;on&#160;the&#160;system&#160;must&#160;be&#160;satisfied&#160;before&#160;a&#160;disk&#160;may&#160;be&#160;<i>re-mounted&#160;</i>by&#160;a<br/>VM&#160;that&#160;has&#160;previously&#160;unmounted&#160;the&#160;disk,&#160;and&#160;whether&#160;shared&#160;mounting&#160;by&#160;multiple<br/>systems&#160;is&#160;allowed.&#160;Note&#160;that&#160;these&#160;membership&#160;restrictions&#160;require&#160;bookkeeping&#160;of<br/>disks&#160;and&#160;management&#160;of&#160;access&#160;of&#160;VMs&#160;to&#160;disks.</p>
<p style="position:absolute;top:1058px;left:242px;white-space:nowrap" class="ft2328">2</p>
<p style="position:absolute;top:1060px;left:248px;white-space:nowrap" class="ft2319">Note&#160;that&#160;the&#160;VM&#160;only&#160;sees&#160;unencrypted&#160;storage,&#160;i.e.,&#160;the&#160;TVD&#160;infrastructure&#160;automatically&#160;loops&#160;in</p>
<p style="position:absolute;top:1074px;left:226px;white-space:nowrap" class="ft2319">encryption.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft2321">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 24 -->
<a name="24"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2456{font-size:15px;line-height:17px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page24-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5024.png" alt="background image"/>
<p style="position:absolute;top:295px;left:150px;white-space:nowrap" class="ft2425"><b>Chapter&#160;3</b></p>
<p style="position:absolute;top:365px;left:150px;white-space:nowrap" class="ft2435"><b>Unified&#160;Policy&#160;Enforcement&#160;for<br/>Virtual&#160;Data&#160;Centers</b></p>
<p style="position:absolute;top:503px;left:172px;white-space:nowrap" class="ft248">In&#160;this&#160;section,&#160;we&#160;introduce&#160;a&#160;TVD-based&#160;policy&#160;enforcement&#160;framework&#160;that&#160;or-</p>
<p style="position:absolute;top:521px;left:150px;white-space:nowrap" class="ft2414">chestrates&#160;the&#160;deployment&#160;and&#160;enforcement&#160;of&#160;the&#160;type&#160;of&#160;policies&#160;we&#160;presented&#160;in<br/>Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#17">2&#160;</a>across&#160;the&#160;data&#160;center.&#160;Existing&#160;storage&#160;and&#160;network&#160;virtualization&#160;technolo-<br/>gies&#160;as&#160;well&#160;as&#160;existing&#160;Trusted&#160;Computing&#160;components&#160;(in&#160;software&#160;and&#160;hardware)&#160;are<br/>the&#160;building&#160;blocks&#160;of&#160;our&#160;solution.&#160;Our&#160;framework&#160;(1)&#160;combines&#160;these&#160;technologies&#160;to<br/>realize&#160;TVDs&#160;and&#160;(2)&#160;orchestrates&#160;them&#160;using&#160;the&#160;TVD&#160;infrastructure,&#160;which&#160;provisions<br/>the&#160;appropriate&#160;security&#160;mechanisms.</p>
<p style="position:absolute;top:656px;left:150px;white-space:nowrap" class="ft2426"><b>3.1</b></p>
<p style="position:absolute;top:656px;left:198px;white-space:nowrap" class="ft2426"><b>TVD&#160;Infrastructure</b></p>
<p style="position:absolute;top:694px;left:150px;white-space:nowrap" class="ft2414">The&#160;TVD&#160;infrastructure&#160;consists&#160;of&#160;a&#160;management&#160;layer&#160;and&#160;an&#160;enforcement&#160;layer.<br/>The&#160;TVD&#160;management&#160;layer&#160;includes&#160;TVD&#160;masters,&#160;proxies,&#160;and&#160;factories,&#160;whereas<br/>the&#160;TVD&#160;enforcement&#160;layer&#160;consists&#160;of&#160;various&#160;security&#160;services.&#160;Each&#160;TVD&#160;is&#160;iden-<br/>tified&#160;by&#160;a&#160;unique&#160;<i>TVD&#160;Master&#160;</i>that&#160;orchestrates&#160;TVD&#160;deployment&#160;and&#160;configuration.<br/>The&#160;TVD&#160;Master&#160;can&#160;be&#160;implemented&#160;as&#160;a&#160;centralized&#160;entity&#160;(as&#160;in&#160;our&#160;prototype&#160;de-<br/>scribed&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#154">11)&#160;</a>or&#160;have&#160;a&#160;distributed&#160;fault-tolerant&#160;implementation.&#160;The&#160;TVD<br/>Master&#160;contains&#160;a&#160;repository&#160;of&#160;high-level&#160;TVD&#160;policies&#160;and&#160;credentials&#160;(e.g.,&#160;VPN<br/>keys).&#160;The&#160;Master&#160;also&#160;exposes&#160;a&#160;TVD&#160;management&#160;API&#160;through&#160;which&#160;the&#160;TVD<br/>owner&#160;can&#160;specify&#160;those&#160;policies&#160;and&#160;credentials.&#160;In&#160;the&#160;deployment&#160;phase,&#160;the&#160;TVD<br/>Master&#160;first&#160;verifies&#160;the&#160;suitability&#160;and&#160;capability&#160;of&#160;the&#160;physical&#160;host&#160;(which&#160;we&#160;refer&#160;to<br/>as&#160;pre-admission&#160;control).&#160;It&#160;then&#160;uses&#160;a&#160;generic&#160;<i>TVD&#160;Factory&#160;</i>service&#160;to&#160;spawn&#160;a&#160;<i>TVD<br/>Proxy</i>,&#160;which&#160;acts&#160;as&#160;the&#160;local&#160;delegate&#160;of&#160;the&#160;TVD&#160;Master&#160;dedicated&#160;to&#160;that&#160;particular<br/>host.&#160;The&#160;TVD&#160;Proxy&#160;is&#160;responsible&#160;for&#160;(1)&#160;translation&#160;of&#160;high-level&#160;TVD&#160;policies&#160;into<br/>low-level&#160;platform-specific&#160;configurations,&#160;(2)&#160;configuration&#160;of&#160;the&#160;host&#160;and&#160;security<br/>services&#160;with&#160;respect&#160;to&#160;the&#160;translated&#160;policies,&#160;and&#160;(3)&#160;interaction&#160;with&#160;the&#160;security<br/>services&#160;in&#160;TVD&#160;admission&#160;and&#160;flow&#160;control.</p>
<p style="position:absolute;top:981px;left:172px;white-space:nowrap" class="ft248">Security&#160;services&#160;implement&#160;the&#160;security&#160;enforcement&#160;layer&#160;of&#160;our&#160;TVD&#160;infrastruc-</p>
<p style="position:absolute;top:999px;left:150px;white-space:nowrap" class="ft2414">ture.&#160;They&#160;run&#160;in&#160;a&#160;trusted&#160;execution&#160;environment&#160;on&#160;each&#160;physical&#160;host&#160;(e.g.,&#160;Domain-0<br/>in&#160;Xen)&#160;and&#160;(1)&#160;manage&#160;the&#160;security&#160;configuration&#160;of&#160;the&#160;hypervisor,&#160;(2)&#160;provide&#160;secure<br/>virtualization&#160;of&#160;resources&#160;(e.g.,&#160;virtual&#160;devices)&#160;to&#160;the&#160;VMs,&#160;and&#160;(3)&#160;provide&#160;support<br/>to&#160;TVD&#160;proxies&#160;in&#160;enforcing&#160;flow&#160;and&#160;access&#160;control&#160;policies&#160;within&#160;and&#160;across&#160;TVD<br/>boundaries.&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#25">3.1&#160;</a>shows&#160;a&#160;high-level&#160;list&#160;of&#160;security&#160;services&#160;and&#160;their&#160;interac-</p>
<p style="position:absolute;top:1117px;left:400px;white-space:nowrap" class="ft248">22</p>
</div>
<!-- Page 25 -->
<a name="25"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2557{font-size:7px;font-family:Helvetica;color:#000000;}
	.ft2558{font-size:7px;font-family:Helvetica;color:#000000;}
	.ft2559{font-size:6px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page25-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5025.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft258">CHAPTER&#160;3.&#160;UNIFIED&#160;POLICY&#160;ENFORCEMENT&#160;FOR&#160;VIRTUAL&#160;DATA&#160;CENTERS23</p>
<p style="position:absolute;top:218px;left:352px;white-space:nowrap" class="ft2557"><b>Compartment&#160;Manager</b></p>
<p style="position:absolute;top:218px;left:496px;white-space:nowrap" class="ft2557"><b>TVD&#160;Proxy</b></p>
<p style="position:absolute;top:197px;left:588px;white-space:nowrap" class="ft2557"><b>TVD&#160;Master</b></p>
<p style="position:absolute;top:281px;left:564px;white-space:nowrap" class="ft2558">Network&#160;Manager</p>
<p style="position:absolute;top:289px;left:574px;white-space:nowrap" class="ft2558">(sub-proxy)</p>
<p style="position:absolute;top:281px;left:487px;white-space:nowrap" class="ft2558">Storage&#160;Manager&#160;</p>
<p style="position:absolute;top:289px;left:498px;white-space:nowrap" class="ft2558">(sub-proxy)</p>
<p style="position:absolute;top:287px;left:390px;white-space:nowrap" class="ft2558">Virtual&#160;Device&#160;Manager</p>
<p style="position:absolute;top:257px;left:347px;white-space:nowrap" class="ft2558">Integrity&#160;Manager</p>
<p style="position:absolute;top:320px;left:350px;white-space:nowrap" class="ft2559"><b>TVD&#160;Component</b></p>
<p style="position:absolute;top:321px;left:415px;white-space:nowrap" class="ft2559"><b>Security&#160;Service</b></p>
<p style="position:absolute;top:352px;left:325px;white-space:nowrap" class="ft258">Figure&#160;3.1:&#160;TVD&#160;Components&#160;and&#160;Security&#160;Services.</p>
<p style="position:absolute;top:388px;left:226px;white-space:nowrap" class="ft2515">tion&#160;with&#160;the&#160;TVD&#160;components.&#160;Most&#160;importantly,&#160;the&#160;<i>compartment&#160;manager&#160;</i>service<br/>manages&#160;the&#160;life-cycle&#160;of&#160;VMs&#160;in&#160;both&#160;para-virtualized&#160;and&#160;fully&#160;virtualized&#160;modes.<br/>This&#160;service&#160;works&#160;in&#160;collaboration&#160;with&#160;the&#160;TVD&#160;Proxy&#160;to&#160;admit&#160;VMs&#160;into&#160;TVDs.<br/>The&#160;<i>integrity&#160;manager&#160;</i>service&#160;implements&#160;Trusted&#160;Computing&#160;extensions&#160;and&#160;assists<br/>the&#160;TVD&#160;Proxy&#160;in&#160;host&#160;pre-admission&#160;and&#160;VM&#160;admission&#160;control.&#160;The&#160;<i>virtual&#160;network<br/>manager&#160;</i>and&#160;<i>virtual&#160;storage&#160;manager&#160;</i>services&#160;are&#160;invoked&#160;by&#160;the&#160;TVD&#160;Proxy.&#160;They<br/>implement&#160;resource&#160;virtualization&#160;technologies&#160;and&#160;enforce&#160;parts&#160;of&#160;the&#160;high-level&#160;TVD<br/>policies&#160;that&#160;are&#160;relevant&#160;to&#160;their&#160;operation.&#160;Lastly,&#160;the&#160;<i>virtual&#160;device&#160;manager&#160;</i>service<br/>handles&#160;the&#160;secure&#160;resource&#160;allocation&#160;and&#160;setup&#160;of&#160;virtual&#160;devices&#160;assigned&#160;to&#160;each<br/>VM.</p>
<p style="position:absolute;top:567px;left:248px;white-space:nowrap" class="ft258">Our&#160;TVD&#160;infrastructure&#160;is&#160;geared&#160;towards&#160;automated&#160;deployment&#160;and&#160;enforcement</p>
<p style="position:absolute;top:585px;left:226px;white-space:nowrap" class="ft2514">of&#160;security&#160;policies&#160;specified&#160;by&#160;the&#160;TVD&#160;Master.&#160;Automated&#160;refinement&#160;and&#160;transla-<br/>tion&#160;of&#160;high-level&#160;policies&#160;into&#160;low-level&#160;configurations&#160;are&#160;of&#160;particular&#160;interest.&#160;For<br/>example,&#160;for&#160;information&#160;flow&#160;between&#160;two&#160;hosts&#160;in&#160;a&#160;trusted&#160;data&#160;center&#160;environment,<br/>other&#160;mechanisms&#160;need&#160;to&#160;be&#160;in&#160;place&#160;than&#160;for&#160;a&#160;flow&#160;between&#160;two&#160;hosts&#160;at&#160;opposite<br/>ends&#160;of&#160;an&#160;untrusted&#160;WAN&#160;link.&#160;In&#160;the&#160;latter&#160;case,&#160;the&#160;hosts&#160;should&#160;be&#160;configured&#160;to<br/>allow&#160;communication&#160;between&#160;them&#160;only&#160;through&#160;a&#160;VPN&#160;tunnel.</p>
<p style="position:absolute;top:693px;left:248px;white-space:nowrap" class="ft258">Another&#160;important&#160;consideration&#160;is&#160;policy&#160;conflict&#160;detection&#160;and&#160;resolution&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[127,</a></p>
<p style="position:absolute;top:711px;left:226px;white-space:nowrap" class="ft2515"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#172">76]</a>.&#160;In&#160;fact,&#160;conflicting&#160;high-level&#160;policies&#160;(e.g.,&#160;a&#160;connection&#160;being&#160;allowed&#160;in&#160;the<br/>inter-TVD&#160;policy&#160;but&#160;disallowed&#160;in&#160;the&#160;intra-TVD&#160;policy)&#160;can&#160;potentially&#160;result&#160;in&#160;an<br/>incorrect&#160;configuration&#160;of&#160;the&#160;underlying&#160;infrastructure.&#160;We&#160;cannot&#160;solely&#160;rely&#160;on&#160;the<br/>TVD&#160;owner&#160;to&#160;specify&#160;conflict-free&#160;policies.&#160;It&#160;is&#160;important&#160;to&#160;detect&#160;policy&#160;conflicts<br/>and&#160;provide&#160;feedback&#160;to&#160;the&#160;owner&#160;in&#160;case&#160;one&#160;is&#160;detected.&#160;In&#160;the&#160;present&#160;prototype,<br/>policy&#160;refinement&#160;is&#160;performed&#160;manually.&#160;The&#160;result&#160;is&#160;a&#160;set&#160;of&#160;configuration&#160;files&#160;that<br/>we&#160;use&#160;for&#160;configuring&#160;the&#160;security&#160;services&#160;at&#160;the&#160;policy&#160;enforcement&#160;layer&#160;(e.g.,&#160;the<br/>virtual&#160;networking&#160;infrastructure).&#160;In&#160;future&#160;work,&#160;we&#160;will&#160;investigate&#160;the&#160;automation<br/>of&#160;this&#160;step&#160;using,&#160;for&#160;example,&#160;the&#160;IETF&#160;policy&#160;model&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">[91]&#160;</a>and&#160;various&#160;graph-based<br/>mechanisms&#160;from&#160;the&#160;literature.&#160;We&#160;will&#160;also&#160;investigate&#160;different&#160;techniques&#160;for&#160;re-<br/>solving&#160;conflicting&#160;policies&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[33,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">17,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">32,&#160;38]</a>.</p>
<p style="position:absolute;top:936px;left:226px;white-space:nowrap" class="ft2526"><b>3.2</b></p>
<p style="position:absolute;top:936px;left:274px;white-space:nowrap" class="ft2526"><b>Virtual&#160;Networking&#160;Infrastructure</b></p>
<p style="position:absolute;top:974px;left:226px;white-space:nowrap" class="ft2514">Virtual&#160;networking&#160;(VNET)&#160;technologies&#160;enable&#160;the&#160;seamless&#160;interconnection&#160;of&#160;VMs<br/>that&#160;reside&#160;on&#160;different&#160;physical&#160;hosts&#160;as&#160;if&#160;they&#160;were&#160;running&#160;on&#160;the&#160;same&#160;machine.<br/>In&#160;our&#160;TVD&#160;framework,&#160;we&#160;employ&#160;multiple&#160;technologies,&#160;including&#160;virtual&#160;switches,<br/>Ethernet&#160;encapsulation,&#160;VLAN&#160;tagging,&#160;and&#160;VPNs,&#160;to&#160;virtualize&#160;the&#160;underlying&#160;net-<br/>work&#160;and&#160;securely&#160;group&#160;VMs&#160;that&#160;belong&#160;to&#160;the&#160;same&#160;TVD.&#160;A&#160;single&#160;private&#160;virtual<br/>network&#160;is&#160;dedicated&#160;to&#160;each&#160;TVD,&#160;and&#160;network&#160;separation&#160;is&#160;ensured&#160;by&#160;connecting</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft2521">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 26 -->
<a name="26"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2660{font-size:8px;font-family:CXOYBI+TT1A403o00;color:#000000;}
	.ft2661{font-size:8px;font-family:PGUGBG+TT1A404o00;color:#000000;-moz-transform: matrix(         0,         -1,          1,          0, 0, 0);-webkit-transform: matrix(         0,         -1,          1,          0, 0, 0);-o-transform: matrix(         0,         -1,          1,          0, 0, 0);-ms-transform: matrix(         0,         -1,          1,          0, 0, 0);-moz-transform-origin: left 75%;-webkit-transform-origin: left 75%;-o-transform-origin: left 75%;-ms-transform-origin: left 75%;}
	.ft2662{font-size:11px;font-family:TWPWAV+TT1A405o00;color:#000000;}
	.ft2663{font-size:8px;font-family:PGUGBG+TT1A404o00;color:#ffffff;-moz-transform: matrix(         0,         -1,          1,          0, 0, 0);-webkit-transform: matrix(         0,         -1,          1,          0, 0, 0);-o-transform: matrix(         0,         -1,          1,          0, 0, 0);-ms-transform: matrix(         0,         -1,          1,          0, 0, 0);-moz-transform-origin: left 75%;-webkit-transform-origin: left 75%;-o-transform-origin: left 75%;-ms-transform-origin: left 75%;}
	.ft2664{font-size:13px;font-family:ACHYIG+TT1A406o00;color:#7f7f7f;}
	.ft2665{font-size:13px;font-family:ACHYIG+TT1A406o00;color:#000000;}
	.ft2666{font-size:9px;font-family:HSAEUE+TT1A407o00;color:#000000;}
	.ft2667{font-size:8px;font-family:CXOYBI+TT1A403o00;color:#ffffff;}
	.ft2668{font-size:9px;font-family:HSAEUE+TT1A407o00;color:#ffffff;}
-->
</style>
<div id="page26-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5026.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft268">24</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft2621">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:218px;left:246px;white-space:nowrap" class="ft2660">VM</p>
<p style="position:absolute;top:216px;left:244px;white-space:nowrap" class="ft2660">VM</p>
<p style="position:absolute;top:349px;left:552px;white-space:nowrap" class="ft2661">Eth</p>
<p style="position:absolute;top:338px;left:552px;white-space:nowrap" class="ft2661">er</p>
<p style="position:absolute;top:331px;left:552px;white-space:nowrap" class="ft2661">IP</p>
<p style="position:absolute;top:188px;left:406px;white-space:nowrap" class="ft2662">Host&#160;C</p>
<p style="position:absolute;top:188px;left:519px;white-space:nowrap" class="ft2662">Host&#160;D</p>
<p style="position:absolute;top:188px;left:264px;white-space:nowrap" class="ft2662">Host&#160;A</p>
<p style="position:absolute;top:311px;left:513px;white-space:nowrap" class="ft2663">VPN</p>
<p style="position:absolute;top:403px;left:520px;white-space:nowrap" class="ft2664">WAN</p>
<p style="position:absolute;top:398px;left:515px;white-space:nowrap" class="ft2665">WAN</p>
<p style="position:absolute;top:257px;left:245px;white-space:nowrap" class="ft2666">vSwitch</p>
<p style="position:absolute;top:218px;left:268px;white-space:nowrap" class="ft2660">VM</p>
<p style="position:absolute;top:216px;left:267px;white-space:nowrap" class="ft2660">VM</p>
<p style="position:absolute;top:218px;left:418px;white-space:nowrap" class="ft2660">VM</p>
<p style="position:absolute;top:216px;left:416px;white-space:nowrap" class="ft2660">VM</p>
<p style="position:absolute;top:219px;left:500px;white-space:nowrap" class="ft2660">VM</p>
<p style="position:absolute;top:217px;left:498px;white-space:nowrap" class="ft2667">VM</p>
<p style="position:absolute;top:218px;left:535px;white-space:nowrap" class="ft2660">VM</p>
<p style="position:absolute;top:217px;left:533px;white-space:nowrap" class="ft2660">VM&#160;VM</p>
<p style="position:absolute;top:217px;left:554px;white-space:nowrap" class="ft2660">VM</p>
<p style="position:absolute;top:258px;left:496px;white-space:nowrap" class="ft2668">vSwitch</p>
<p style="position:absolute;top:218px;left:300px;white-space:nowrap" class="ft2660">VM</p>
<p style="position:absolute;top:216px;left:298px;white-space:nowrap" class="ft2667">VM</p>
<p style="position:absolute;top:348px;left:308px;white-space:nowrap" class="ft2663">Tag</p>
<p style="position:absolute;top:336px;left:308px;white-space:nowrap" class="ft2663">ge</p>
<p style="position:absolute;top:328px;left:308px;white-space:nowrap" class="ft2663">r</p>
<p style="position:absolute;top:257px;left:293px;white-space:nowrap" class="ft2668">vSwitch</p>
<p style="position:absolute;top:349px;left:512px;white-space:nowrap" class="ft2663">Eth</p>
<p style="position:absolute;top:338px;left:512px;white-space:nowrap" class="ft2663">er</p>
<p style="position:absolute;top:331px;left:512px;white-space:nowrap" class="ft2663">IP</p>
<p style="position:absolute;top:419px;left:304px;white-space:nowrap" class="ft2662">VLAN&#160;Switch</p>
<p style="position:absolute;top:188px;left:353px;white-space:nowrap" class="ft2662">Host&#160;B</p>
<p style="position:absolute;top:217px;left:363px;white-space:nowrap" class="ft2660">VM</p>
<p style="position:absolute;top:216px;left:361px;white-space:nowrap" class="ft2660">VM</p>
<p style="position:absolute;top:350px;left:374px;white-space:nowrap" class="ft2661">Tag</p>
<p style="position:absolute;top:338px;left:374px;white-space:nowrap" class="ft2661">ge</p>
<p style="position:absolute;top:330px;left:374px;white-space:nowrap" class="ft2661">r</p>
<p style="position:absolute;top:257px;left:356px;white-space:nowrap" class="ft2666">vSwitch</p>
<p style="position:absolute;top:311px;left:247px;white-space:nowrap" class="ft2661">VPN</p>
<p style="position:absolute;top:347px;left:261px;white-space:nowrap" class="ft2661">Tag</p>
<p style="position:absolute;top:336px;left:261px;white-space:nowrap" class="ft2661">ge</p>
<p style="position:absolute;top:328px;left:261px;white-space:nowrap" class="ft2661">r</p>
<p style="position:absolute;top:348px;left:245px;white-space:nowrap" class="ft2661">Eth</p>
<p style="position:absolute;top:337px;left:245px;white-space:nowrap" class="ft2661">er</p>
<p style="position:absolute;top:330px;left:245px;white-space:nowrap" class="ft2661">IP</p>
<p style="position:absolute;top:351px;left:360px;white-space:nowrap" class="ft2661">Eth</p>
<p style="position:absolute;top:340px;left:360px;white-space:nowrap" class="ft2661">er</p>
<p style="position:absolute;top:333px;left:360px;white-space:nowrap" class="ft2661">IP</p>
<p style="position:absolute;top:311px;left:361px;white-space:nowrap" class="ft2661">VPN</p>
<p style="position:absolute;top:348px;left:293px;white-space:nowrap" class="ft2663">Eth</p>
<p style="position:absolute;top:338px;left:293px;white-space:nowrap" class="ft2663">er</p>
<p style="position:absolute;top:331px;left:293px;white-space:nowrap" class="ft2663">IP</p>
<p style="position:absolute;top:312px;left:293px;white-space:nowrap" class="ft2663">VPN</p>
<p style="position:absolute;top:258px;left:537px;white-space:nowrap" class="ft2666">vSwitch</p>
<p style="position:absolute;top:312px;left:552px;white-space:nowrap" class="ft2661">VPN</p>
<p style="position:absolute;top:470px;left:281px;white-space:nowrap" class="ft268">Figure&#160;3.2:&#160;General&#160;vSwitch&#160;Architecture.</p>
<p style="position:absolute;top:518px;left:150px;white-space:nowrap" class="ft2615">the&#160;VMs&#160;at&#160;the&#160;Ethernet&#160;level.&#160;Logically&#160;speaking,&#160;we&#160;provide&#160;a&#160;separate&#160;“virtual<br/>infrastructure”&#160;for&#160;each&#160;TVD&#160;in&#160;which&#160;we&#160;control&#160;and&#160;limit&#160;the&#160;sharing&#160;of&#160;network&#160;re-<br/>sources&#160;(such&#160;as&#160;routers,&#160;switches)&#160;between&#160;TVDs.&#160;This&#160;also&#160;provides&#160;the&#160;TVD&#160;owner<br/>with&#160;the&#160;freedom&#160;to&#160;deploy&#160;a&#160;wide&#160;range&#160;of&#160;networking&#160;solutions&#160;on&#160;top&#160;of&#160;the&#160;TVD<br/>network&#160;infrastructure.&#160;Network&#160;address&#160;allocations,&#160;transport&#160;protocols,&#160;and&#160;other&#160;ser-<br/>vices&#160;are&#160;then&#160;fully&#160;customizable&#160;by&#160;the&#160;TVD&#160;owner&#160;and&#160;work&#160;transparently&#160;as&#160;if&#160;the<br/>VMs&#160;were&#160;in&#160;an&#160;isolated&#160;physical&#160;network.&#160;To&#160;maintain&#160;secrecy&#160;and&#160;confidentiality&#160;of<br/>network&#160;data&#160;(where&#160;necessary),&#160;network&#160;communication&#160;is&#160;established&#160;over&#160;encrypted<br/>VPN&#160;tunnels.&#160;This&#160;enables&#160;the&#160;transparent&#160;use&#160;of&#160;untrusted&#160;networks&#160;between&#160;physical<br/>hosts&#160;that&#160;contain&#160;VMs&#160;within&#160;the&#160;same&#160;TVD&#160;to&#160;provide&#160;a&#160;seamless&#160;view&#160;of&#160;the&#160;TVD<br/>network.</p>
<p style="position:absolute;top:716px;left:172px;white-space:nowrap" class="ft268">In&#160;this&#160;section,&#160;we&#160;introduce&#160;the&#160;technologies&#160;we&#160;use&#160;to&#160;implement&#160;a&#160;security-</p>
<p style="position:absolute;top:734px;left:150px;white-space:nowrap" class="ft2615">enhanced&#160;VNET&#160;infrastructure&#160;for&#160;TVD&#160;owners.&#160;The&#160;concept&#160;of&#160;virtual&#160;switching&#160;is<br/>central&#160;to&#160;our&#160;architecture,&#160;which&#160;is&#160;then&#160;protected&#160;by&#160;existing&#160;VPN&#160;technologies&#160;that<br/>provide&#160;data&#160;confidentiality&#160;and&#160;integrity&#160;where&#160;needed.&#160;The&#160;VNET&#160;infrastructure&#160;acts<br/>as&#160;the&#160;local&#160;enforcer&#160;of&#160;VNET&#160;policies.&#160;As&#160;described&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#21">2.3.2,&#160;</a>these&#160;policies<br/>are&#160;based&#160;on&#160;the&#160;high-level&#160;TVD&#160;policies&#160;and&#160;translated&#160;into&#160;network&#160;configurations&#160;by<br/>the&#160;TVD&#160;Proxy.&#160;The&#160;Proxy&#160;then&#160;deploys&#160;the&#160;whole&#160;VNET&#160;infrastructure&#160;with&#160;respect<br/>to&#160;the&#160;translated&#160;configuration.</p>
<p style="position:absolute;top:882px;left:150px;white-space:nowrap" class="ft2624"><b>3.2.1</b></p>
<p style="position:absolute;top:882px;left:204px;white-space:nowrap" class="ft2624"><b>Virtual&#160;Switching</b></p>
<p style="position:absolute;top:912px;left:150px;white-space:nowrap" class="ft2615">The&#160;<i>virtual&#160;switch&#160;</i>(vSwitch)&#160;is&#160;the&#160;central&#160;component&#160;of&#160;the&#160;virtual&#160;networking&#160;in-<br/>frastructure&#160;and&#160;operates&#160;similarly&#160;to&#160;a&#160;physical&#160;switch.&#160;It&#160;is&#160;responsible&#160;for&#160;network<br/>virtualization&#160;and&#160;isolation,&#160;and&#160;enables&#160;a&#160;virtual&#160;network&#160;to&#160;span&#160;multiple&#160;physical<br/>hosts.&#160;To&#160;do&#160;so,&#160;the&#160;vSwitch&#160;uses&#160;EtherIP&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[52]&#160;</a>and&#160;VLAN&#160;tagging&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[49]&#160;</a>to&#160;insert&#160;VLAN<br/>membership&#160;information&#160;into&#160;every&#160;network&#160;packet.&#160;The&#160;vSwitch&#160;also&#160;implements&#160;the<br/>necessary&#160;address-mapping&#160;techniques&#160;to&#160;direct&#160;packets&#160;only&#160;to&#160;those&#160;machines&#160;that<br/>host&#160;member&#160;VMs.&#160;Virtual&#160;switches&#160;provide&#160;the&#160;primitives&#160;for&#160;implementing&#160;higher-<br/>level&#160;security&#160;policies&#160;for&#160;networking&#160;and&#160;are&#160;configured&#160;by&#160;the&#160;higher-level&#160;TVD&#160;man-<br/>agement&#160;layer.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft2621">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 27 -->
<a name="27"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page27-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5027.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft278">CHAPTER&#160;3.&#160;UNIFIED&#160;POLICY&#160;ENFORCEMENT&#160;FOR&#160;VIRTUAL&#160;DATA&#160;CENTERS25</p>
<p style="position:absolute;top:194px;left:248px;white-space:nowrap" class="ft278">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#26">3.2&#160;</a>illustrates&#160;an&#160;example&#160;architecture&#160;in&#160;which&#160;physical&#160;machines&#160;host&#160;mul-</p>
<p style="position:absolute;top:212px;left:226px;white-space:nowrap" class="ft2715">tiple&#160;VMs&#160;with&#160;different&#160;TVD&#160;memberships&#160;(the&#160;light&#160;and&#160;dark&#160;shades&#160;indicate&#160;dif-<br/>ferent&#160;TVDs).&#160;Hosts&#160;A,&#160;B,&#160;and&#160;D&#160;are&#160;virtualized&#160;machines,&#160;whereas&#160;Host&#160;C&#160;is&#160;non-<br/>virtualized.&#160;Furthermore,&#160;Hosts&#160;A,&#160;B,&#160;and&#160;C&#160;reside&#160;on&#160;the&#160;same&#160;LAN,&#160;and&#160;thus&#160;can<br/>communicate&#160;directly&#160;using&#160;the&#160;trusted&#160;physical&#160;infrastructure&#160;without&#160;further&#160;protec-<br/>tion&#160;(e.g.,&#160;traffic&#160;encryption).&#160;For&#160;example,&#160;the&#160;<i>light&#160;</i>VMs&#160;hosted&#160;on&#160;Hosts&#160;A&#160;and&#160;B&#160;are<br/>inter-connected&#160;using&#160;the&#160;local&#160;VLAN-enabled&#160;physical&#160;switch.&#160;In&#160;this&#160;case,&#160;the&#160;physi-<br/>cal&#160;switch&#160;separates&#160;the&#160;TVD&#160;traffic&#160;from&#160;other&#160;traffic&#160;passing&#160;through&#160;the&#160;switch&#160;using<br/>VLAN&#160;tags.&#160;Similarly,&#160;the&#160;<i>dark&#160;</i>VMs&#160;hosted&#160;on&#160;Host&#160;A&#160;and&#160;the&#160;non-virtualized&#160;Host<br/>C&#160;are&#160;seamlessly&#160;inter-connected&#160;using&#160;the&#160;local&#160;switch.&#160;In&#160;contrast,&#160;connections&#160;that<br/>require&#160;IP&#160;connectivity&#160;are&#160;routed&#160;over&#160;the&#160;WAN&#160;link.&#160;The&#160;WAN&#160;cloud&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#26">3.2<br/></a>represents&#160;the&#160;physical&#160;network&#160;infrastructure&#160;able&#160;to&#160;deal&#160;with&#160;TVD-enabled&#160;virtual<br/>networks;&#160;it&#160;can&#160;include&#160;LANs&#160;with&#160;devices&#160;capable&#160;of&#160;VLAN&#160;tagging&#160;and&#160;gateways<br/>to&#160;connect&#160;the&#160;LANs&#160;to&#160;each&#160;other&#160;over&#160;(possibly&#160;insecure)&#160;WAN&#160;links.&#160;For&#160;connec-<br/>tions&#160;that&#160;traverse&#160;untrusted&#160;medium,&#160;we&#160;employ&#160;EtherIP&#160;encapsulation&#160;to&#160;denote&#160;TVD<br/>membership&#160;and&#160;additional&#160;security&#160;measures&#160;(such&#160;as&#160;encryption)&#160;to&#160;ensure&#160;compli-<br/>ance&#160;with&#160;the&#160;confidentiality&#160;and&#160;integrity&#160;requirements.</p>
<p style="position:absolute;top:521px;left:226px;white-space:nowrap" class="ft2724"><b>3.2.2</b></p>
<p style="position:absolute;top:521px;left:280px;white-space:nowrap" class="ft2724"><b>Virtual&#160;Private&#160;Networking</b></p>
<p style="position:absolute;top:551px;left:226px;white-space:nowrap" class="ft2714">In&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#26">3.2,&#160;</a>VMs&#160;hosted&#160;on&#160;Host&#160;D&#160;are&#160;connected&#160;to&#160;the&#160;other&#160;machines&#160;over&#160;a<br/>WAN&#160;link.&#160;A&#160;practical&#160;setting&#160;in&#160;which&#160;such&#160;a&#160;connection&#160;might&#160;exist&#160;would&#160;be&#160;an<br/>outsourced&#160;remote&#160;resource&#160;connected&#160;to&#160;the&#160;local&#160;data&#160;center&#160;through&#160;the&#160;Internet.&#160;As<br/>an&#160;example,&#160;lightly&#160;shaded&#160;VMs&#160;on&#160;Host&#160;D&#160;connect&#160;to&#160;the&#160;lone&#160;VM&#160;on&#160;Host&#160;B&#160;over<br/>this&#160;untrusted&#160;link.&#160;In&#160;this&#160;setting,&#160;we&#160;use&#160;a&#160;combination&#160;of&#160;EtherIP&#160;encapsulation&#160;and<br/>VPN&#160;technology&#160;to&#160;ensure&#160;the&#160;confidentiality&#160;and&#160;integrity&#160;of&#160;the&#160;communication.&#160;To<br/>do&#160;so,&#160;we&#160;use&#160;point-to-point&#160;VPN&#160;tunnels&#160;with&#160;OpenVPN&#160;that&#160;are&#160;configured&#160;via&#160;the<br/>TVD&#160;Proxy&#160;from&#160;the&#160;TVD&#160;policies.&#160;This&#160;enables&#160;reconfiguration&#160;of&#160;the&#160;topology&#160;and<br/>the&#160;involved&#160;VPNs&#160;within&#160;a&#160;TVD&#160;from&#160;a&#160;single&#160;administration&#160;point,&#160;the&#160;TVD&#160;Master.</p>
<p style="position:absolute;top:713px;left:248px;white-space:nowrap" class="ft278">TVD&#160;policies&#160;distributed&#160;from&#160;the&#160;TVD&#160;Master&#160;to&#160;the&#160;TVD&#160;Proxy&#160;also&#160;include&#160;the</p>
<p style="position:absolute;top:731px;left:226px;white-space:nowrap" class="ft2715">secret&#160;key&#160;for&#160;the&#160;VPN&#160;along&#160;with&#160;other&#160;VPN-specific&#160;settings.&#160;On&#160;a&#160;physical&#160;host,&#160;the<br/>VPN’s&#160;endpoint&#160;is&#160;represented&#160;as&#160;a&#160;local&#160;virtual&#160;network&#160;interface&#160;(vif)&#160;that&#160;is&#160;plugged<br/>into&#160;the&#160;appropriate&#160;vSwitch&#160;controlled&#160;by&#160;the&#160;TVD&#160;Proxy.&#160;The&#160;vSwitch&#160;then&#160;decides<br/>whether&#160;to&#160;tunnel&#160;the&#160;communication&#160;between&#160;VMs,&#160;and&#160;if&#160;so,&#160;uses&#160;the&#160;VPN&#160;module<br/>to&#160;establish&#160;the&#160;tunnel&#160;and&#160;access&#160;the&#160;VPN&#160;secret&#160;for&#160;traffic&#160;encryption&#160;and&#160;decryption.</p>
<p style="position:absolute;top:848px;left:226px;white-space:nowrap" class="ft2726"><b>3.3</b></p>
<p style="position:absolute;top:848px;left:274px;white-space:nowrap" class="ft2726"><b>Virtual&#160;Storage&#160;Infrastructure</b></p>
<p style="position:absolute;top:886px;left:226px;white-space:nowrap" class="ft2714">We&#160;focus&#160;on&#160;a&#160;simplified&#160;security&#160;management&#160;of&#160;virtualized&#160;storage.&#160;Broadly&#160;speak-<br/>ing,&#160;storage&#160;virtualization&#160;abstracts&#160;away&#160;the&#160;physical&#160;storage&#160;resource(s).&#160;It&#160;is&#160;desir-<br/>able&#160;to&#160;allow&#160;a&#160;storage&#160;resource&#160;to&#160;be&#160;shared&#160;by&#160;multiple&#160;host&#160;computers,&#160;and&#160;also&#160;to<br/>provide&#160;a&#160;single&#160;storage&#160;device&#160;abstraction&#160;to&#160;a&#160;computer&#160;irrespective&#160;of&#160;the&#160;underly-<br/>ing&#160;physical&#160;storage,&#160;which&#160;may&#160;be&#160;a&#160;single&#160;hard&#160;disk,&#160;a&#160;set&#160;of&#160;hard&#160;disks,&#160;a&#160;Storage<br/>Area&#160;Network&#160;(SAN),&#160;etc.&#160;To&#160;satisfy&#160;both&#160;requirements,&#160;storage&#160;virtualization&#160;is&#160;typ-<br/>ically&#160;done&#160;at&#160;two&#160;levels.&#160;The&#160;first&#160;level&#160;of&#160;virtualization&#160;involves&#160;aggregating&#160;all&#160;the<br/>(potentially&#160;heterogeneous)&#160;physical&#160;storage&#160;devices&#160;into&#160;one&#160;or&#160;more&#160;virtual&#160;storage<br/>pools.&#160;The&#160;aggregation&#160;allows&#160;more&#160;centralized&#160;and&#160;convenient&#160;data&#160;management.&#160;The<br/>second&#160;level&#160;of&#160;virtualization&#160;concerns&#160;the&#160;unified&#160;granularity&#160;(i.e.,&#160;blocks&#160;or&#160;files)&#160;at</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft2721">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 28 -->
<a name="28"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2869{font-size:10px;font-family:Helvetica;color:#000000;}
	.ft2870{font-size:8px;font-family:Helvetica;color:#000000;}
	.ft2871{font-size:10px;line-height:11px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page28-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5028.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft288">26</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft2821">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:278px;left:423px;white-space:nowrap" class="ft2869">Consolidation</p>
<p style="position:absolute;top:238px;left:421px;white-space:nowrap" class="ft2844">Access&#160;Control&#160;&amp;&#160;Encryption</p>
<p style="position:absolute;top:260px;left:424px;white-space:nowrap" class="ft2844">TVD&#160;A</p>
<p style="position:absolute;top:260px;left:465px;white-space:nowrap" class="ft2844">TVD&#160;B</p>
<p style="position:absolute;top:260px;left:502px;white-space:nowrap" class="ft2844">TVD&#160;C</p>
<p style="position:absolute;top:297px;left:284px;white-space:nowrap" class="ft2871">Heterogeneous&#160;<br/>Physical&#160;Storage</p>
<p style="position:absolute;top:247px;left:284px;white-space:nowrap" class="ft2871">Per-TVD&#160;<br/>Raw&#160;Storage</p>
<p style="position:absolute;top:206px;left:284px;white-space:nowrap" class="ft2871">Per-TVD&#160;<br/>Virtual&#160;Storage</p>
<p style="position:absolute;top:193px;left:420px;white-space:nowrap" class="ft2870"><b>TVD&#160;A</b></p>
<p style="position:absolute;top:193px;left:461px;white-space:nowrap" class="ft2870"><b>TVD&#160;B</b></p>
<p style="position:absolute;top:193px;left:501px;white-space:nowrap" class="ft2870"><b>TVD&#160;C</b></p>
<p style="position:absolute;top:260px;left:377px;white-space:nowrap" class="ft2844">Metadata</p>
<p style="position:absolute;top:349px;left:235px;white-space:nowrap" class="ft288">Figure&#160;3.3:&#160;Security&#160;Enforcement&#160;for&#160;Virtualized&#160;Storage.</p>
<p style="position:absolute;top:397px;left:150px;white-space:nowrap" class="ft2815">which&#160;data&#160;in&#160;each&#160;pool&#160;is&#160;presented&#160;to&#160;the&#160;higher-level&#160;entities&#160;(operating&#160;systems,<br/>applications,&#160;or&#160;VMs).</p>
<p style="position:absolute;top:433px;left:172px;white-space:nowrap" class="ft288">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#28">3.3&#160;</a>shows&#160;our&#160;storage&#160;security&#160;enforcement&#160;architecture,&#160;in&#160;which&#160;existing</p>
<p style="position:absolute;top:451px;left:150px;white-space:nowrap" class="ft2814">heterogeneous&#160;physical&#160;storage&#160;devices&#160;are&#160;consolidated&#160;into&#160;a&#160;joint&#160;pool.&#160;This&#160;vir-<br/>tual&#160;storage&#160;pool&#160;is&#160;then&#160;subdivided&#160;into&#160;raw&#160;storage&#160;for&#160;each&#160;TVD.&#160;Each&#160;raw&#160;storage<br/>volume&#160;has&#160;an&#160;owner&#160;TVD&#160;that&#160;determines&#160;its&#160;policy&#160;(indicated&#160;by&#160;the&#160;labels&#160;TVD<br/>A,&#160;TVD&#160;B,&#160;and&#160;TVD&#160;C&#160;at&#160;the&#160;per-TVD&#160;raw&#160;storage&#160;layer&#160;in&#160;the&#160;figure).&#160;In&#160;addition,<br/>when&#160;a&#160;volume&#160;shall&#160;be&#160;shared&#160;among&#160;multiple&#160;TVDs,&#160;there&#160;is&#160;also&#160;a&#160;set&#160;of&#160;member<br/>TVDs&#160;associated&#160;with&#160;it.&#160;The&#160;access&#160;control&#160;and&#160;encryption&#160;layer&#160;helps&#160;enforce&#160;the<br/>storage-sharing&#160;policy&#160;defined&#160;by&#160;the&#160;owner&#160;TVD,&#160;e.g.,&#160;enforcing&#160;read,&#160;write,&#160;create,<br/>and&#160;update&#160;access&#160;permissions&#160;for&#160;the&#160;member&#160;TVDs.&#160;This&#160;layer&#160;is&#160;a&#160;logical&#160;layer&#160;that<br/>in&#160;reality&#160;consists&#160;of&#160;the&#160;virtual&#160;storage&#160;managers&#160;(part&#160;of&#160;the&#160;security&#160;services)&#160;located<br/>on&#160;each&#160;physical&#160;platform.&#160;The&#160;virtual&#160;storage&#160;manager&#160;on&#160;each&#160;physical&#160;platform&#160;is<br/>responsible&#160;for&#160;enforcing&#160;the&#160;owner&#160;TVD’s&#160;storage&#160;security&#160;policies&#160;(see&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#22">2.3.3)<br/></a>on&#160;these&#160;volumes.&#160;If&#160;a&#160;certain&#160;intra-TVD&#160;security&#160;policy&#160;requires&#160;confidentiality&#160;and<br/>does&#160;not&#160;declare&#160;the&#160;medium&#160;as&#160;trusted,&#160;the&#160;disk&#160;is&#160;encrypted&#160;using&#160;a&#160;key&#160;belonging&#160;to<br/>the&#160;owner&#160;TVD<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#28">.</a></p>
<p style="position:absolute;top:682px;left:248px;white-space:nowrap" class="ft2827"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#28">1</a></p>
<p style="position:absolute;top:684px;left:258px;white-space:nowrap" class="ft288">If&#160;conditions&#160;for&#160;(re-)mounting&#160;a&#160;disk&#160;have&#160;been&#160;defined,&#160;the&#160;disk&#160;is</p>
<p style="position:absolute;top:702px;left:150px;white-space:nowrap" class="ft2814">also&#160;encrypted&#160;and&#160;the&#160;key&#160;is&#160;sealed&#160;against&#160;the&#160;TCB&#160;while&#160;including&#160;these&#160;conditions<br/>into&#160;the&#160;unsealing&#160;instructions.&#160;The&#160;policy&#160;and&#160;meta-data&#160;are&#160;held&#160;on&#160;a&#160;separate&#160;raw<br/>volume&#160;that&#160;is&#160;only&#160;accessible&#160;by&#160;the&#160;data&#160;center&#160;infrastructure.</p>
<p style="position:absolute;top:756px;left:172px;white-space:nowrap" class="ft288">An&#160;administrator&#160;of&#160;a&#160;domain&#160;may&#160;request&#160;that&#160;a&#160;disk&#160;be&#160;mounted&#160;to&#160;a&#160;particular</p>
<p style="position:absolute;top:774px;left:150px;white-space:nowrap" class="ft2815">VM&#160;in&#160;a&#160;particular&#160;mode&#160;(read/write).&#160;In&#160;Xen,&#160;the&#160;disk&#160;is&#160;usually&#160;mounted&#160;in&#160;the<br/>management&#160;machine&#160;Domain-0&#160;as&#160;a&#160;<i>back-end&#160;device&#160;</i>and&#160;then&#160;accessed&#160;by&#160;a&#160;guest<br/>VM&#160;via&#160;a&#160;<i>front-end&#160;</i>device.&#160;The&#160;virtual&#160;storage&#160;manager&#160;on&#160;the&#160;platform&#160;validates&#160;the<br/>mount&#160;request&#160;against&#160;the&#160;policies&#160;of&#160;both&#160;the&#160;TVD&#160;the&#160;VM&#160;is&#160;part&#160;of&#160;and&#160;the&#160;owner<br/>TVD&#160;for&#160;the&#160;disk.&#160;Once&#160;mounted,&#160;appropriate&#160;read-write&#160;permissions&#160;are&#160;granted&#160;based<br/>on&#160;the&#160;flow&#160;control&#160;policy&#160;for&#160;the&#160;two&#160;TVDs,&#160;e.g.,&#160;read&#160;access&#160;is&#160;granted&#160;only&#160;if&#160;the<br/>policies&#160;specified&#160;in&#160;the&#160;disk&#160;policy&#160;matrix&#160;allow&#160;the&#160;VM’s&#160;TVD&#160;such&#160;an&#160;access&#160;to&#160;the<br/>disk&#160;belonging&#160;to&#160;the&#160;owner&#160;TVD.</p>
<p style="position:absolute;top:946px;left:150px;white-space:nowrap" class="ft2826"><b>3.4</b></p>
<p style="position:absolute;top:946px;left:198px;white-space:nowrap" class="ft2826"><b>TVD&#160;Admission&#160;Control</b></p>
<p style="position:absolute;top:983px;left:150px;white-space:nowrap" class="ft2814">When&#160;a&#160;VM&#160;is&#160;about&#160;to&#160;join&#160;a&#160;TVD,&#160;different&#160;properties&#160;will&#160;be&#160;verified&#160;by&#160;the&#160;local<br/>TVD&#160;Proxy&#160;to&#160;ensure&#160;that&#160;policies&#160;of&#160;all&#160;the&#160;TVDs&#160;that&#160;the&#160;VM&#160;is&#160;currently&#160;a&#160;member<br/>of&#160;as&#160;well&#160;as&#160;of&#160;the&#160;TVD&#160;that&#160;it&#160;wants&#160;to&#160;join&#160;are&#160;not&#160;violated.&#160;If&#160;the&#160;verification&#160;is<br/>successful,&#160;then&#160;the&#160;VM&#160;will&#160;be&#160;connected&#160;to&#160;that&#160;TVD.&#160;The&#160;TVD&#160;admission&#160;control</p>
<p style="position:absolute;top:1063px;left:166px;white-space:nowrap" class="ft2828">1</p>
<p style="position:absolute;top:1065px;left:171px;white-space:nowrap" class="ft2819">For&#160;efficiency&#160;reasons,&#160;we&#160;currently&#160;do&#160;not&#160;provide&#160;integrity&#160;protection.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft2821">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 29 -->
<a name="29"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page29-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5029.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft298">CHAPTER&#160;3.&#160;UNIFIED&#160;POLICY&#160;ENFORCEMENT&#160;FOR&#160;VIRTUAL&#160;DATA&#160;CENTERS27</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft2914">protocol&#160;is&#160;the&#160;procedure&#160;by&#160;which&#160;the&#160;VM&#160;gets&#160;connected&#160;to&#160;the&#160;TVD.&#160;In&#160;the&#160;case&#160;of<br/>a&#160;VM&#160;joining&#160;multiple&#160;TVDs,&#160;the&#160;admission&#160;control&#160;protocol&#160;is&#160;executed&#160;for&#160;each&#160;of<br/>those&#160;TVDs.&#160;We&#160;now&#160;describe&#160;the&#160;steps&#160;of&#160;the&#160;protocol.</p>
<p style="position:absolute;top:247px;left:248px;white-space:nowrap" class="ft298">We&#160;assume&#160;that&#160;the&#160;computing&#160;platform&#160;that&#160;executes&#160;the&#160;VM&#160;provides&#160;mechanisms</p>
<p style="position:absolute;top:265px;left:226px;white-space:nowrap" class="ft2914">that&#160;allow&#160;remote&#160;parties&#160;to&#160;convince&#160;themselves&#160;about&#160;its&#160;trustworthiness.&#160;Example<br/>mechanisms&#160;include&#160;trusted&#160;(authenticated)&#160;boot&#160;and&#160;the&#160;remote&#160;attestation&#160;protocol<br/>(see&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#32">4.2)&#160;</a>based&#160;on&#160;TPM&#160;technology.</p>
<p style="position:absolute;top:341px;left:226px;white-space:nowrap" class="ft2923"><b>TVD&#160;Proxy&#160;Initialization&#160;Phase:</b></p>
<p style="position:absolute;top:341px;left:447px;white-space:nowrap" class="ft298">To&#160;allow&#160;a&#160;VM&#160;to&#160;join&#160;a&#160;TVD,&#160;the&#160;platform&#160;host-</p>
<p style="position:absolute;top:359px;left:226px;white-space:nowrap" class="ft2914">ing&#160;the&#160;VM&#160;needs&#160;access&#160;to&#160;the&#160;TVD&#160;policy,&#160;and&#160;upon&#160;successful&#160;admission,&#160;to&#160;TVD<br/>secrets,&#160;such&#160;as&#160;the&#160;VPN&#160;key.&#160;For&#160;this&#160;purpose,&#160;TVD&#160;Proxy&#160;services&#160;are&#160;started&#160;on&#160;the<br/>platform&#160;for&#160;each&#160;TVD&#160;whose&#160;VMs&#160;may&#160;be&#160;hosted.&#160;The&#160;TVD&#160;Proxy&#160;can&#160;be&#160;started&#160;at<br/>boot&#160;time&#160;of&#160;the&#160;underlying&#160;hypervisor,&#160;by&#160;a&#160;system&#160;service&#160;(TVD&#160;Proxy&#160;Factory),&#160;or<br/>by&#160;the&#160;VM&#160;itself,&#160;as&#160;long&#160;as&#160;the&#160;TVD&#160;Proxy&#160;is&#160;strongly&#160;isolated&#160;from&#160;the&#160;VM.</p>
<p style="position:absolute;top:470px;left:226px;white-space:nowrap" class="ft2923"><b>Pre-Admission&#160;Phase:</b></p>
<p style="position:absolute;top:470px;left:382px;white-space:nowrap" class="ft298">When&#160;a&#160;VM&#160;wants&#160;to&#160;join&#160;a&#160;TVD&#160;that&#160;is&#160;going&#160;to&#160;be&#160;hosted</p>
<p style="position:absolute;top:488px;left:226px;white-space:nowrap" class="ft2915">on&#160;the&#160;platform&#160;for&#160;the&#160;first&#160;time,&#160;the&#160;TVD&#160;Master&#160;has&#160;to&#160;establish&#160;a&#160;trust&#160;relationship<br/>with&#160;the&#160;platform&#160;running&#160;the&#160;VM,&#160;specifically&#160;with&#160;the&#160;TVD&#160;Proxy.&#160;We&#160;call&#160;this<br/>step&#160;the&#160;<i>pre-admission&#160;</i>phase.&#160;It&#160;involves&#160;the&#160;establishment&#160;of&#160;a&#160;trusted&#160;channel&#160;(see<br/>Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#33">4.3)&#160;</a>between&#160;the&#160;TVD&#160;Master&#160;and&#160;the&#160;TVD&#160;Proxy&#160;(or&#160;the&#160;TVD&#160;Proxy&#160;Factory).<br/>The&#160;trusted&#160;channel&#160;allows&#160;the&#160;TVD&#160;Master&#160;to&#160;verify&#160;the&#160;integrity&#160;of&#160;the&#160;TVD&#160;Proxy<br/>(Factory)&#160;and&#160;the&#160;underlying&#160;platform.&#160;After&#160;the&#160;trusted&#160;channel&#160;has&#160;been&#160;established<br/>and&#160;the&#160;correct&#160;configuration&#160;of&#160;the&#160;Proxy&#160;has&#160;been&#160;verified,&#160;the&#160;TVD&#160;Master&#160;can&#160;send<br/>the&#160;TVD&#160;policies&#160;and&#160;credentials&#160;(such&#160;as&#160;a&#160;VPN&#160;key)&#160;to&#160;the&#160;TVD&#160;Proxy.</p>
<p style="position:absolute;top:653px;left:226px;white-space:nowrap" class="ft2923"><b>Admission&#160;Control&#160;Phase:</b></p>
<p style="position:absolute;top:653px;left:409px;white-space:nowrap" class="ft298">The&#160;Compartment&#160;Manager&#160;(part&#160;of&#160;the&#160;platform&#160;secu-</p>
<p style="position:absolute;top:671px;left:226px;white-space:nowrap" class="ft2915">rity&#160;services&#160;shown&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#25">3.1)&#160;</a>is&#160;responsible&#160;for&#160;starting&#160;new&#160;VMs.&#160;The&#160;Compart-<br/>ment&#160;Manager&#160;loads&#160;the&#160;VM&#160;configuration&#160;and&#160;enforces&#160;the&#160;security&#160;directives&#160;with<br/>the&#160;help&#160;of&#160;the&#160;Integrity&#160;Manager&#160;(also&#160;part&#160;of&#160;the&#160;platform&#160;security&#160;services&#160;shown&#160;in<br/>Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#25">3.1)</a>.&#160;The&#160;security&#160;directives&#160;may&#160;include&#160;gathering&#160;the&#160;VM&#160;state&#160;information,<br/>such&#160;as&#160;the&#160;VM&#160;configuration,&#160;kernel,&#160;and&#160;disk(s)&#160;that&#160;are&#160;going&#160;to&#160;be&#160;attached&#160;to&#160;the<br/>VM.</p>
<p style="position:absolute;top:778px;left:248px;white-space:nowrap" class="ft298">If&#160;the&#160;VM&#160;configuration&#160;states&#160;that&#160;the&#160;VM&#160;should&#160;join&#160;one&#160;or&#160;more&#160;TVDs,&#160;then&#160;the</p>
<p style="position:absolute;top:796px;left:226px;white-space:nowrap" class="ft2914">Compartment&#160;Manager&#160;interacts&#160;with&#160;the&#160;corresponding&#160;TVD&#160;Proxy(ies)&#160;and&#160;invokes<br/>TPM&#160;functions&#160;to&#160;attest&#160;the&#160;state&#160;of&#160;the&#160;VM.&#160;The&#160;TVD&#160;Proxy&#160;verifies&#160;certain&#160;properties<br/>before&#160;allowing&#160;the&#160;VM&#160;to&#160;join&#160;the&#160;TVD.&#160;More&#160;concretely,&#160;the&#160;TVD&#160;Proxy&#160;has&#160;to<br/>ensure&#160;that</p>
<p style="position:absolute;top:880px;left:248px;white-space:nowrap" class="ft2950">•</p>
<p style="position:absolute;top:881px;left:263px;white-space:nowrap" class="ft298">the&#160;VM&#160;fulfills&#160;the&#160;integrity&#160;requirements&#160;of&#160;the&#160;TVD;</p>
<p style="position:absolute;top:910px;left:248px;white-space:nowrap" class="ft2950">•</p>
<p style="position:absolute;top:911px;left:263px;white-space:nowrap" class="ft2914">the&#160;information&#160;flow&#160;policies&#160;of&#160;all&#160;TVDs&#160;the&#160;VM&#160;will&#160;be&#160;a&#160;member&#160;of&#160;will&#160;not<br/>be&#160;violated;</p>
<p style="position:absolute;top:957px;left:248px;white-space:nowrap" class="ft2950">•</p>
<p style="position:absolute;top:958px;left:263px;white-space:nowrap" class="ft2915">the&#160;VM&#160;enforces&#160;specific&#160;information&#160;flow&#160;rules&#160;between&#160;TVDs&#160;if&#160;such&#160;rules&#160;are<br/>required&#160;by&#160;the&#160;TVD&#160;policy,&#160;and&#160;that</p>
<p style="position:absolute;top:1004px;left:248px;white-space:nowrap" class="ft2950">•</p>
<p style="position:absolute;top:1005px;left:263px;white-space:nowrap" class="ft2915">the&#160;underlying&#160;platform&#160;(e.g.,&#160;the&#160;hypervisor&#160;and&#160;attached&#160;devices)&#160;fulfills&#160;the<br/>security&#160;requirements&#160;of&#160;the&#160;TVD.</p>
<p style="position:absolute;top:1054px;left:226px;white-space:nowrap" class="ft2914">Platform&#160;verification&#160;involves&#160;matching&#160;the&#160;security&#160;requirements&#160;with&#160;the&#160;platform’s<br/>capabilities&#160;and&#160;mechanisms&#160;instantiated&#160;on&#160;top&#160;of&#160;these&#160;capabilities.&#160;For&#160;example,</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft2921">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 30 -->
<a name="30"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page30-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5030.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft308">28</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft3021">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft3014">suppose&#160;that&#160;data&#160;confidentiality&#160;is&#160;a&#160;TVD&#160;requirement.&#160;Then,&#160;if&#160;hard&#160;disks&#160;or&#160;network<br/>connections&#160;are&#160;not&#160;trusted,&#160;additional&#160;mechanisms,&#160;such&#160;as&#160;block&#160;encryption&#160;or&#160;VPN<br/>(respectively),&#160;need&#160;to&#160;be&#160;instantiated&#160;to&#160;satisfy&#160;the&#160;requirement.</p>
<p style="position:absolute;top:269px;left:150px;white-space:nowrap" class="ft3023"><b>TVD&#160;Join&#160;Phase:</b></p>
<p style="position:absolute;top:269px;left:274px;white-space:nowrap" class="ft308">If&#160;the&#160;VM&#160;and&#160;the&#160;provided&#160;infrastructure&#160;fulfill&#160;all&#160;TVD&#160;require-</p>
<p style="position:absolute;top:287px;left:150px;white-space:nowrap" class="ft3015">ments,&#160;a&#160;new&#160;network&#160;stack&#160;is&#160;created&#160;and&#160;configured&#160;as&#160;described&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#25">3.2.&#160;</a>Once<br/>the&#160;Compartment&#160;Manager&#160;has&#160;started&#160;the&#160;VM,&#160;it&#160;sends&#160;an&#160;attach&#160;request&#160;to&#160;the&#160;corre-<br/>sponding&#160;TVD&#160;vSwitch.&#160;Once&#160;the&#160;VM&#160;is&#160;connected&#160;to&#160;the&#160;vSwitch,&#160;it&#160;is&#160;a&#160;member&#160;of<br/>the&#160;TVD.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft3021">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 31 -->
<a name="31"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3172{font-size:10px;font-family:YPVRDH+CMR7;color:#231f20;}
	.ft3173{font-size:15px;font-family:IERFBJ+CMSS10;color:#231f20;}
-->
</style>
<div id="page31-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5031.png" alt="background image"/>
<p style="position:absolute;top:295px;left:226px;white-space:nowrap" class="ft3125"><b>Chapter&#160;4</b></p>
<p style="position:absolute;top:365px;left:226px;white-space:nowrap" class="ft3122"><b>Background&#160;and&#160;Related&#160;Work</b></p>
<p style="position:absolute;top:458px;left:226px;white-space:nowrap" class="ft3114">In&#160;order&#160;to&#160;put&#160;our&#160;work&#160;in&#160;context&#160;we&#160;survey&#160;key&#160;concepts&#160;that&#160;underlie&#160;our&#160;approach.<br/>Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#31">4.1&#160;</a>presents&#160;the&#160;TVD&#160;concept,&#160;which&#160;can&#160;be&#160;thought&#160;of&#160;as&#160;a&#160;virtualization<br/>of&#160;today’s&#160;security&#160;zones&#160;while&#160;making&#160;security&#160;requirements&#160;explicit.&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#32">4.2<br/></a>describes&#160;<i>Trusted&#160;Computing&#160;</i>concepts.&#160;The&#160;core&#160;of&#160;this&#160;concept&#160;is&#160;a&#160;security&#160;hardware<br/>device&#160;called&#160;<i>Trusted&#160;Platform&#160;Module&#160;</i>that&#160;guarantees&#160;certain&#160;security&#160;functionalities<br/>in&#160;spite&#160;of&#160;attacks.&#160;We&#160;finally&#160;survey&#160;related&#160;work&#160;on&#160;trusted&#160;channels&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#33">4.3<br/></a>and&#160;on&#160;secure&#160;virtual&#160;networking&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#33">4.4.</a></p>
<p style="position:absolute;top:612px;left:226px;white-space:nowrap" class="ft3126"><b>4.1</b></p>
<p style="position:absolute;top:612px;left:275px;white-space:nowrap" class="ft3126"><b>Overview&#160;of&#160;Trusted&#160;Virtual&#160;Domains</b></p>
<p style="position:absolute;top:649px;left:226px;white-space:nowrap" class="ft3114">Bussani&#160;<i>et&#160;al.&#160;</i><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[16]&#160;</a>introduced&#160;the&#160;concept&#160;of&#160;TVDs.&#160;A&#160;Trusted&#160;Virtual&#160;Domain&#160;con-<br/>sists&#160;of&#160;a&#160;set&#160;of&#160;distributed&#160;Virtual&#160;Processing&#160;Elements&#160;(VPEs),&#160;storage&#160;for&#160;the&#160;VPEs,<br/>and&#160;a&#160;communication&#160;medium&#160;interconnecting&#160;the&#160;VPEs&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[16,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">62,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">45]</a>.&#160;The&#160;TVD&#160;pro-<br/>vides&#160;a&#160;policy&#160;and&#160;containment&#160;boundary&#160;around&#160;those&#160;VPEs.&#160;VPEs&#160;within&#160;each&#160;TVD<br/>can&#160;usually&#160;exchange&#160;information&#160;freely&#160;and&#160;securely&#160;with&#160;each&#160;other.&#160;At&#160;the&#160;same<br/>time,&#160;they&#160;are&#160;sufficiently&#160;isolated&#160;from&#160;outside&#160;VPEs,&#160;including&#160;those&#160;belonging&#160;to<br/>other&#160;TVDs.&#160;Here,&#160;isolation&#160;loosely&#160;refers&#160;to&#160;the&#160;requirement&#160;that&#160;a&#160;dishonest&#160;VPE&#160;in<br/>one&#160;TVD&#160;cannot&#160;exchange&#160;information&#160;(e.g.,&#160;by&#160;sending&#160;messages&#160;or&#160;by&#160;sharing&#160;stor-<br/>age)&#160;with&#160;a&#160;dishonest&#160;VPE&#160;in&#160;another&#160;TVD,&#160;unless&#160;the&#160;inter-TVD&#160;policies&#160;explicitly<br/>allow&#160;such&#160;an&#160;exchange.&#160;There&#160;is&#160;a&#160;TVD&#160;<i>infrastructure&#160;</i>(for&#160;each&#160;TVD)&#160;that&#160;provides&#160;a<br/>unified&#160;level&#160;of&#160;security&#160;to&#160;member&#160;VPEs,&#160;while&#160;restricting&#160;the&#160;interaction&#160;with&#160;VPEs<br/>outside&#160;the&#160;TVD&#160;to&#160;pre-specified,&#160;well-defined&#160;means&#160;only.&#160;Unified&#160;security&#160;within&#160;a<br/>virtual&#160;domain&#160;is&#160;obtained&#160;by&#160;defining&#160;and&#160;enforcing&#160;<i>membership&#160;requirements&#160;</i>that&#160;the<br/>VPEs&#160;have&#160;to&#160;satisfy&#160;before&#160;being&#160;admitted&#160;to&#160;the&#160;TVD&#160;and&#160;for&#160;retaining&#160;membership.<br/>Each&#160;TVD&#160;defines&#160;rules&#160;regarding&#160;information&#160;exchange&#160;with&#160;the&#160;outside&#160;world,&#160;e.g.,<br/>restrictions&#160;regarding&#160;in-bound&#160;and&#160;out-bound&#160;network&#160;traffic.</p>
<p style="position:absolute;top:936px;left:248px;white-space:nowrap" class="ft318">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#10">1.1&#160;</a>shows&#160;customer&#160;VMs&#160;as&#160;VPEs&#160;belonging&#160;to</p>
<p style="position:absolute;top:936px;left:584px;white-space:nowrap" class="ft3153">TVD</p>
<p style="position:absolute;top:941px;left:618px;white-space:nowrap" class="ft3172">1</p>
<p style="position:absolute;top:936px;left:629px;white-space:nowrap" class="ft318">spanning&#160;two&#160;plat-</p>
<p style="position:absolute;top:954px;left:226px;white-space:nowrap" class="ft318">forms&#160;(contained&#160;in&#160;the&#160;dashed&#160;boxes).&#160;The&#160;Master&#160;(</p>
<p style="position:absolute;top:954px;left:538px;white-space:nowrap" class="ft3173">TVD1&#160;Master</p>
<p style="position:absolute;top:954px;left:623px;white-space:nowrap" class="ft318">)&#160;and&#160;Proxy&#160;compo-</p>
<p style="position:absolute;top:972px;left:226px;white-space:nowrap" class="ft318">nents&#160;(</p>
<p style="position:absolute;top:972px;left:266px;white-space:nowrap" class="ft3173">Proxy1</p>
<p style="position:absolute;top:972px;left:313px;white-space:nowrap" class="ft318">on&#160;each&#160;platform)&#160;are&#160;part&#160;of&#160;the&#160;TVD&#160;infrastructure,&#160;which&#160;we&#160;describe</p>
<p style="position:absolute;top:990px;left:226px;white-space:nowrap" class="ft3114">in&#160;detail&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#24">3.1.&#160;</a>The&#160;TVD&#160;Master&#160;is&#160;the&#160;orchestrator&#160;of&#160;the&#160;TVD&#160;deployment<br/>and&#160;configuration.&#160;There&#160;is&#160;one&#160;TVD&#160;Proxy&#160;for&#160;each&#160;platform&#160;hosting&#160;VMs&#160;belonging<br/>to&#160;that&#160;TVD.&#160;If&#160;the&#160;platform&#160;hosts&#160;VMs&#160;belonging&#160;to&#160;multiple&#160;TVDs,&#160;then&#160;there&#160;are<br/>multiple&#160;TVD&#160;proxies&#160;on&#160;that&#160;platform,&#160;one&#160;per&#160;TVD.&#160;The&#160;TVD&#160;Proxy&#160;on&#160;a&#160;platform<br/>is&#160;configured&#160;by&#160;the&#160;TVD&#160;Master&#160;and&#160;can&#160;be&#160;thought&#160;of&#160;as&#160;the&#160;local&#160;TVD&#160;policy&#160;en-</p>
<p style="position:absolute;top:1117px;left:476px;white-space:nowrap" class="ft318">29</p>
</div>
<!-- Page 32 -->
<a name="32"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3274{font-size:12px;font-family:AIQUZS+CMTI8;color:#231f20;}
	.ft3275{font-size:9px;font-family:CXWIHD+CMMI6;color:#231f20;}
	.ft3276{font-size:9px;font-family:YWLKJZ+CMR6;color:#231f20;}
	.ft3277{font-size:12px;font-family:QGHZAS+CMR8;color:#231f20;}
	.ft3278{font-size:12px;font-family:EMREEO+CMSY8;color:#231f20;}
	.ft3279{font-size:12px;font-family:XLWMJL+CMMI8;color:#231f20;}
-->
</style>
<div id="page32-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5032.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft328">30</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft3221">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft3214">forcer.&#160;VMs&#160;belonging&#160;to&#160;the&#160;same&#160;TVD&#160;can&#160;usually&#160;exchange&#160;information&#160;freely&#160;with<br/>each&#160;other&#160;unless&#160;restricted&#160;by&#160;VM-level&#160;policies.&#160;For&#160;example,&#160;traffic&#160;originating&#160;from</p>
<p style="position:absolute;top:229px;left:150px;white-space:nowrap" class="ft3253">VM</p>
<p style="position:absolute;top:234px;left:177px;white-space:nowrap" class="ft3247">A</p>
<p style="position:absolute;top:234px;left:186px;white-space:nowrap" class="ft3272">1</p>
<p style="position:absolute;top:230px;left:196px;white-space:nowrap" class="ft328">or</p>
<p style="position:absolute;top:229px;left:213px;white-space:nowrap" class="ft3253">VM</p>
<p style="position:absolute;top:234px;left:239px;white-space:nowrap" class="ft3247">A</p>
<p style="position:absolute;top:234px;left:248px;white-space:nowrap" class="ft3272">2</p>
<p style="position:absolute;top:230px;left:259px;white-space:nowrap" class="ft328">on&#160;Host&#160;A&#160;is&#160;routed&#160;to</p>
<p style="position:absolute;top:229px;left:395px;white-space:nowrap" class="ft3253">VM</p>
<p style="position:absolute;top:234px;left:422px;white-space:nowrap" class="ft3247">Bi</p>
<p style="position:absolute;top:230px;left:441px;white-space:nowrap" class="ft328">(</p>
<p style="position:absolute;top:229px;left:446px;white-space:nowrap" class="ft3246">i</p>
<p style="position:absolute;top:229px;left:455px;white-space:nowrap" class="ft3248">=&#160;1</p>
<p style="position:absolute;top:229px;left:478px;white-space:nowrap" class="ft3246">,</p>
<p style="position:absolute;top:229px;left:485px;white-space:nowrap" class="ft3250">·&#160;·&#160;·</p>
<p style="position:absolute;top:229px;left:507px;white-space:nowrap" class="ft3246">,</p>
<p style="position:absolute;top:229px;left:514px;white-space:nowrap" class="ft3248">4</p>
<p style="position:absolute;top:230px;left:521px;white-space:nowrap" class="ft328">)&#160;on&#160;Host&#160;B&#160;without&#160;any</p>
<p style="position:absolute;top:247px;left:150px;white-space:nowrap" class="ft3215">restrictions.&#160;Information&#160;exchange&#160;among&#160;TVDs&#160;can&#160;be&#160;allowed;&#160;however,&#160;it&#160;is&#160;subject<br/>to&#160;the&#160;network&#160;and&#160;storage&#160;policies&#160;stated&#160;by&#160;each&#160;TVD&#160;Master&#160;and&#160;locally&#160;enforced&#160;by<br/>each&#160;TVD&#160;Proxy.</p>
<p style="position:absolute;top:329px;left:150px;white-space:nowrap" class="ft3226"><b>4.2</b></p>
<p style="position:absolute;top:329px;left:198px;white-space:nowrap" class="ft3226"><b>Trusted&#160;Computing&#160;–&#160;The&#160;TCG&#160;Approach</b></p>
<p style="position:absolute;top:367px;left:150px;white-space:nowrap" class="ft3215">It&#160;is&#160;important&#160;to&#160;have&#160;reliable&#160;mechanisms&#160;for&#160;a&#160;system&#160;to&#160;reason&#160;and&#160;verify&#160;the&#160;trust-<br/>worthiness&#160;(i.e.,&#160;compliance&#160;with&#160;a&#160;certain&#160;security&#160;policy)&#160;of&#160;a&#160;peer&#160;endpoint&#160;(local<br/>or&#160;remote).&#160;A&#160;recent&#160;industrial&#160;initiative&#160;towards&#160;realizing&#160;such&#160;a&#160;mechanism&#160;was&#160;put<br/>forward&#160;by&#160;the&#160;<i>Trusted&#160;Computing&#160;Group&#160;</i>(TCG)&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[113]</a>,&#160;a&#160;consortium&#160;of&#160;a&#160;large&#160;number<br/>of&#160;IT&#160;enterprises&#160;that&#160;proposes&#160;a&#160;new&#160;generation&#160;of&#160;computing&#160;platforms&#160;that&#160;employs<br/>both&#160;supplemental&#160;hardware&#160;and&#160;software&#160;(see,&#160;e.g.,&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#172">[81,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">100]</a>).&#160;The&#160;TC<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#32">G</a></p>
<p style="position:absolute;top:454px;left:602px;white-space:nowrap" class="ft3227"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#32">1</a></p>
<p style="position:absolute;top:457px;left:613px;white-space:nowrap" class="ft328">has&#160;pub-</p>
<p style="position:absolute;top:475px;left:150px;white-space:nowrap" class="ft328">lished&#160;several&#160;specifications&#160;on&#160;various&#160;concepts&#160;of&#160;trusted&#160;infrastructures&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[121]</a>.</p>
<p style="position:absolute;top:514px;left:150px;white-space:nowrap" class="ft3223"><b>The&#160;Trusted&#160;Platform&#160;Module</b></p>
<p style="position:absolute;top:514px;left:354px;white-space:nowrap" class="ft328">The&#160;core&#160;component&#160;the&#160;TCG&#160;specifies&#160;is&#160;the&#160;<i>Trusted</i></p>
<p style="position:absolute;top:532px;left:150px;white-space:nowrap" class="ft3215"><i>Platform&#160;Module&#160;</i>(TPM).&#160;Currently,&#160;the&#160;widespread&#160;implementation&#160;of&#160;the&#160;TPM&#160;is&#160;a<br/>small&#160;tamper-evident&#160;chi<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#32">p</a></p>
<p style="position:absolute;top:548px;left:305px;white-space:nowrap" class="ft3227"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#32">2</a></p>
<p style="position:absolute;top:550px;left:314px;white-space:nowrap" class="ft328">that&#160;implements&#160;multiple&#160;<i>roots-of-trust&#160;</i><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[122,&#160;120]</a>,&#160;e.g.,&#160;the</p>
<p style="position:absolute;top:568px;left:150px;white-space:nowrap" class="ft3215">root-of-trust&#160;for&#160;reporting&#160;and&#160;the&#160;root-of-trust&#160;for&#160;storage.&#160;Each&#160;root-of-trust&#160;enables<br/>parties,&#160;both&#160;local&#160;and&#160;remote,&#160;to&#160;place&#160;trust&#160;on&#160;a&#160;TPM-equipped&#160;platform&#160;that&#160;the&#160;lat-<br/>ter&#160;will&#160;behave&#160;as&#160;expected&#160;for&#160;the&#160;intended&#160;purpose.&#160;By&#160;definition,&#160;the&#160;parties&#160;trust<br/>each&#160;root-of-trust,&#160;and&#160;therefore&#160;it&#160;is&#160;essential&#160;that&#160;the&#160;roots-of-trust&#160;always&#160;behave&#160;as<br/>expected.&#160;Given&#160;that&#160;requirement,&#160;a&#160;hardware&#160;root-of-trust&#160;–&#160;especially&#160;one&#160;that&#160;is&#160;com-<br/>pletely&#160;protected&#160;from&#160;software&#160;attacks&#160;and&#160;tamper-evident&#160;against&#160;physical&#160;attacks,&#160;as<br/>required&#160;by&#160;the&#160;TPM&#160;specification&#160;–&#160;is&#160;assumed&#160;to&#160;provide&#160;a&#160;better&#160;protection&#160;than<br/>software-only&#160;solutions.</p>
<p style="position:absolute;top:734px;left:150px;white-space:nowrap" class="ft3223"><b>Attestation&#160;and&#160;Integrity&#160;Verification</b></p>
<p style="position:absolute;top:734px;left:399px;white-space:nowrap" class="ft328">The&#160;Trusted&#160;Computing&#160;features&#160;we&#160;leverage</p>
<p style="position:absolute;top:752px;left:150px;white-space:nowrap" class="ft3214">in&#160;this&#160;paper&#160;are&#160;protection&#160;of&#160;keys,&#160;secure&#160;recording&#160;of&#160;integrity&#160;measurements,&#160;attes-<br/>tation,&#160;and&#160;sealing.&#160;Integrity&#160;verification&#160;mechanisms&#160;enable&#160;a&#160;remote&#160;party&#160;to&#160;verify<br/>whether&#160;system&#160;components&#160;conform&#160;to&#160;certain&#160;security&#160;policies.&#160;<i>Measurement&#160;</i>of&#160;a<br/>component&#160;involves&#160;computing&#160;the&#160;SHA-1&#160;hash&#160;of&#160;the&#160;binary&#160;code&#160;of&#160;that&#160;component.<br/>In&#160;particular,&#160;each&#160;software&#160;component&#160;in&#160;the&#160;Trusted&#160;Computing&#160;Base&#160;(TCB)&#160;is&#160;first<br/>measured&#160;and&#160;then&#160;its&#160;measurement&#160;recorded&#160;before&#160;control&#160;is&#160;passed&#160;to&#160;it.&#160;The&#160;hash<br/>values&#160;are&#160;then&#160;appended&#160;to&#160;a&#160;hash&#160;chain,&#160;which&#160;is&#160;kept&#160;in&#160;special&#160;protected&#160;registers<br/>called&#160;<i>Platform&#160;Configuration&#160;Registers&#160;</i>(PCRs),&#160;thus&#160;acting&#160;as&#160;accumulators&#160;for&#160;mea-<br/>surements.&#160;<i>Recording&#160;</i>a&#160;measurement&#160;means&#160;appending&#160;it&#160;to&#160;the&#160;hash&#160;chain&#160;by&#160;PCR<br/>extend&#160;operatio<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#32">n</a></p>
<p style="position:absolute;top:910px;left:250px;white-space:nowrap" class="ft3227"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#32">3</a></p>
<p style="position:absolute;top:913px;left:256px;white-space:nowrap" class="ft328"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#32">.&#160;</a>The&#160;sequence&#160;of&#160;measured&#160;values&#160;are&#160;also&#160;stored&#160;in&#160;a&#160;<i>measurement</i></p>
<p style="position:absolute;top:931px;left:150px;white-space:nowrap" class="ft3220"><i>lo<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#32">g</a></i></p>
<p style="position:absolute;top:928px;left:169px;white-space:nowrap" class="ft3227"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#32">4</a></p>
<p style="position:absolute;top:931px;left:175px;white-space:nowrap" class="ft328"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#32">,&#160;</a>external&#160;to&#160;the&#160;TPM.</p>
<p style="position:absolute;top:958px;left:166px;white-space:nowrap" class="ft3228">1</p>
<p style="position:absolute;top:960px;left:174px;white-space:nowrap" class="ft3219">TCG’s&#160;claimed&#160;role&#160;is&#160;to&#160;develop,&#160;define,&#160;and&#160;promote&#160;open&#160;and&#160;vendor-neutral&#160;industry&#160;specifications</p>
<p style="position:absolute;top:974px;left:150px;white-space:nowrap" class="ft3255">for&#160;Trusted&#160;Computing,&#160;including&#160;hardware&#160;building&#160;blocks&#160;and&#160;software&#160;interface&#160;specifications&#160;across&#160;mul-<br/>tiple&#160;platforms&#160;and&#160;operating&#160;environments.</p>
<p style="position:absolute;top:1000px;left:166px;white-space:nowrap" class="ft3228">2</p>
<p style="position:absolute;top:1003px;left:174px;white-space:nowrap" class="ft3219">Many&#160;vendors&#160;already&#160;ship&#160;their&#160;platforms&#160;with&#160;TPMs&#160;(mainly&#160;laptop&#160;PCs&#160;and&#160;servers).</p>
<p style="position:absolute;top:1015px;left:166px;white-space:nowrap" class="ft3228">3</p>
<p style="position:absolute;top:1017px;left:171px;white-space:nowrap" class="ft3219">Extending&#160;of&#160;PCR&#160;values&#160;is&#160;performed&#160;as&#160;follows:</p>
<p style="position:absolute;top:1017px;left:413px;white-space:nowrap" class="ft3274">PCR</p>
<p style="position:absolute;top:1021px;left:441px;white-space:nowrap" class="ft3275">i</p>
<p style="position:absolute;top:1021px;left:445px;white-space:nowrap" class="ft3276">+1</p>
<p style="position:absolute;top:1016px;left:463px;white-space:nowrap" class="ft3277">:=&#160;SHA1(</p>
<p style="position:absolute;top:1017px;left:517px;white-space:nowrap" class="ft3274">PCR</p>
<p style="position:absolute;top:1021px;left:545px;white-space:nowrap" class="ft3275">i</p>
<p style="position:absolute;top:1016px;left:550px;white-space:nowrap" class="ft3278">|</p>
<p style="position:absolute;top:1017px;left:553px;white-space:nowrap" class="ft3279">I</p>
<p style="position:absolute;top:1016px;left:560px;white-space:nowrap" class="ft3277">)</p>
<p style="position:absolute;top:1017px;left:564px;white-space:nowrap" class="ft3219">,&#160;with&#160;the&#160;old&#160;register</p>
<p style="position:absolute;top:1031px;left:150px;white-space:nowrap" class="ft3219">value</p>
<p style="position:absolute;top:1031px;left:178px;white-space:nowrap" class="ft3274">PCR</p>
<p style="position:absolute;top:1035px;left:206px;white-space:nowrap" class="ft3275">i</p>
<p style="position:absolute;top:1031px;left:211px;white-space:nowrap" class="ft3219">,&#160;the&#160;new&#160;register&#160;value</p>
<p style="position:absolute;top:1031px;left:324px;white-space:nowrap" class="ft3274">PCR</p>
<p style="position:absolute;top:1035px;left:352px;white-space:nowrap" class="ft3275">i</p>
<p style="position:absolute;top:1035px;left:356px;white-space:nowrap" class="ft3276">+1</p>
<p style="position:absolute;top:1031px;left:370px;white-space:nowrap" class="ft3219">,&#160;and&#160;the&#160;input</p>
<p style="position:absolute;top:1031px;left:442px;white-space:nowrap" class="ft3279">I</p>
<p style="position:absolute;top:1031px;left:451px;white-space:nowrap" class="ft3219">(e.g.&#160;a&#160;SHA-1&#160;hash&#160;value).</p>
<p style="position:absolute;top:1044px;left:166px;white-space:nowrap" class="ft3228">4</p>
<p style="position:absolute;top:1046px;left:171px;white-space:nowrap" class="ft3219">Since&#160;each&#160;PCR&#160;holds&#160;only&#160;the&#160;digest&#160;of&#160;(part&#160;of)&#160;the&#160;chain&#160;of&#160;trust,&#160;keeping&#160;the&#160;list&#160;of&#160;all&#160;measured</p>
<p style="position:absolute;top:1060px;left:150px;white-space:nowrap" class="ft3255">values&#160;is&#160;required&#160;if&#160;afterwards,&#160;during&#160;the&#160;attestation&#160;process,&#160;a&#160;remote&#160;party&#160;wants&#160;to&#160;identify&#160;each&#160;measured<br/>component.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft3221">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 33 -->
<a name="33"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page33-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5033.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft338">CHAPTER&#160;4.&#160;BACKGROUND&#160;AND&#160;RELATED&#160;WORK</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft338">31</p>
<p style="position:absolute;top:194px;left:248px;white-space:nowrap" class="ft3320"><i>Attestation&#160;</i>refers&#160;to&#160;the&#160;challenge-response-style&#160;cryptographic&#160;protocol&#160;for&#160;a&#160;re-</p>
<p style="position:absolute;top:212px;left:226px;white-space:nowrap" class="ft3315">mote&#160;party&#160;to&#160;query&#160;the&#160;recorded&#160;platform&#160;measurement&#160;values&#160;and&#160;for&#160;the&#160;platform&#160;to<br/>reliably&#160;report&#160;the&#160;requested&#160;values.&#160;The&#160;verifier&#160;first&#160;sends&#160;a&#160;challenge&#160;to&#160;the&#160;platform.<br/>The&#160;platform&#160;invokes&#160;the</p>
<p style="position:absolute;top:247px;left:385px;white-space:nowrap" class="ft3373">TPM</p>
<p style="position:absolute;top:247px;left:418px;white-space:nowrap" class="ft338">_</p>
<p style="position:absolute;top:247px;left:425px;white-space:nowrap" class="ft3373">Quote</p>
<p style="position:absolute;top:247px;left:468px;white-space:nowrap" class="ft338">command&#160;with&#160;the&#160;challenge&#160;as&#160;a&#160;parameter.</p>
<p style="position:absolute;top:265px;left:226px;white-space:nowrap" class="ft3315">The&#160;invocation&#160;also&#160;carries&#160;an&#160;indication&#160;of&#160;which&#160;PCRs&#160;are&#160;of&#160;interest.&#160;The&#160;TPM<br/>returns&#160;a&#160;signed&#160;<i>quote&#160;</i>containing&#160;the&#160;challenge&#160;and&#160;the&#160;values&#160;of&#160;the&#160;specified&#160;PCRs.<br/>The&#160;TPM&#160;signs&#160;using&#160;an&#160;Attestation&#160;Identity&#160;Key&#160;(AIK),&#160;whose&#160;public&#160;key&#160;is&#160;certified<br/>by&#160;a&#160;third&#160;party&#160;that&#160;the&#160;verifier&#160;trusts,&#160;called&#160;<i>Privacy&#160;CA&#160;</i>in&#160;TCG&#160;terminology.&#160;The<br/>platform&#160;then&#160;replies&#160;to&#160;the&#160;verifier&#160;with&#160;the&#160;signed&#160;quote&#160;along&#160;with&#160;the&#160;AIK&#160;public<br/>key&#160;certificate&#160;and&#160;the&#160;log&#160;information&#160;that&#160;is&#160;necessary&#160;to&#160;reconstruct&#160;the&#160;platform’s<br/>configuration.&#160;Based&#160;on&#160;the&#160;reply,&#160;the&#160;verifier&#160;can&#160;decide&#160;whether&#160;the&#160;platform&#160;is&#160;in&#160;an<br/>acceptable&#160;state.</p>
<p style="position:absolute;top:409px;left:248px;white-space:nowrap" class="ft3320"><i>Sealing&#160;</i>is&#160;a&#160;TPM&#160;operation&#160;that&#160;is&#160;used&#160;locally&#160;to&#160;ensure&#160;that&#160;a&#160;certain&#160;data&#160;item</p>
<p style="position:absolute;top:427px;left:226px;white-space:nowrap" class="ft3314">is&#160;accessible&#160;only&#160;under&#160;specific&#160;platform&#160;configurations&#160;reflected&#160;by&#160;PCR&#160;values.&#160;The<br/><i>unsealing&#160;</i>operation&#160;will&#160;reveal&#160;the&#160;data&#160;item&#160;only&#160;if&#160;the&#160;PCR&#160;values&#160;at&#160;the&#160;time&#160;of&#160;the<br/>operation&#160;match&#160;the&#160;PCR&#160;specified&#160;values&#160;at&#160;the&#160;time&#160;of&#160;sealing.</p>
<p style="position:absolute;top:480px;left:248px;white-space:nowrap" class="ft338">A&#160;more&#160;general&#160;and&#160;flexible&#160;extension&#160;to&#160;the&#160;binary&#160;attestation&#160;is&#160;<i>property-based</i></p>
<p style="position:absolute;top:498px;left:226px;white-space:nowrap" class="ft3315"><i>attestation&#160;</i><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[96,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">90,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#172">69]</a>:&#160;Attestation&#160;should&#160;only&#160;determine&#160;whether&#160;a&#160;platform&#160;config-<br/>uration&#160;or&#160;an&#160;application&#160;has&#160;a&#160;desired&#160;property.&#160;However,&#160;our&#160;prototype&#160;is&#160;still&#160;using<br/>binary&#160;attestation.</p>
<p style="position:absolute;top:552px;left:248px;white-space:nowrap" class="ft338">In&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[47]</a>,&#160;the&#160;authors&#160;propose&#160;<i>semantic&#160;remote&#160;attestation&#160;</i>using&#160;language-based</p>
<p style="position:absolute;top:570px;left:226px;white-space:nowrap" class="ft3314">trusted&#160;VM&#160;to&#160;remotely&#160;attest&#160;high-level&#160;program&#160;properties.&#160;The&#160;general&#160;idea&#160;is&#160;to<br/>use&#160;a&#160;<i>trusted&#160;VM&#160;</i>(TrustedVM)&#160;that&#160;verifies&#160;the&#160;security&#160;policy&#160;of&#160;another&#160;virtual&#160;ma-<br/>chine&#160;on&#160;a&#160;given&#160;host.</p>
<p style="position:absolute;top:624px;left:248px;white-space:nowrap" class="ft338">In&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#172">[77]</a>,&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#172">[78]</a>,&#160;and&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#172">[79]</a>,&#160;the&#160;authors&#160;propose&#160;a&#160;software&#160;architecture&#160;based&#160;on&#160;Linux</p>
<p style="position:absolute;top:642px;left:226px;white-space:nowrap" class="ft3314">providing&#160;attestation&#160;and&#160;binding.&#160;The&#160;architecture&#160;binds&#160;short-lifetime&#160;data&#160;(e.g.,&#160;ap-<br/>plication&#160;data)&#160;to&#160;long-lifetime&#160;data&#160;(e.g.,&#160;the&#160;Linux&#160;kernel)&#160;and&#160;allows&#160;access&#160;to&#160;that<br/>data&#160;only&#160;if&#160;the&#160;system&#160;is&#160;compatible&#160;with&#160;a&#160;security&#160;policy&#160;certified&#160;by&#160;a&#160;security&#160;ad-<br/>ministrator.</p>
<p style="position:absolute;top:742px;left:226px;white-space:nowrap" class="ft3326"><b>4.3</b></p>
<p style="position:absolute;top:742px;left:275px;white-space:nowrap" class="ft3326"><b>Trusted&#160;Channels</b></p>
<p style="position:absolute;top:780px;left:226px;white-space:nowrap" class="ft3315">The&#160;standard&#160;approach&#160;for&#160;establishing&#160;secure&#160;channels&#160;over&#160;the&#160;Internet&#160;is&#160;to&#160;use&#160;secu-<br/>rity&#160;protocols&#160;such&#160;as&#160;Transport&#160;Layer&#160;Security&#160;(TLS)&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[27]&#160;</a>or&#160;Internet&#160;Protocol&#160;Secu-<br/>rity&#160;(IPSec)&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">[63]</a>),&#160;which&#160;aim&#160;at&#160;assuring&#160;confidentiality,&#160;integrity,&#160;and&#160;freshness&#160;of&#160;the<br/>transmitted&#160;data&#160;as&#160;well&#160;as&#160;authenticity&#160;of&#160;the&#160;endpoints&#160;involved.&#160;However,&#160;as&#160;men-<br/>tioned&#160;before,&#160;secure&#160;channels&#160;do&#160;not&#160;provide&#160;any&#160;guarantees&#160;about&#160;the&#160;integrity&#160;of&#160;the<br/>communication&#160;endpoints,&#160;which&#160;can&#160;be&#160;compromised&#160;by&#160;viruses&#160;or&#160;Trojans.&#160;Based<br/>on&#160;security&#160;architectures&#160;that&#160;deploy&#160;Trusted&#160;Computing&#160;functionality,&#160;one&#160;can&#160;extend<br/>these&#160;protocols&#160;with&#160;integrity&#160;reporting&#160;mechanisms&#160;(e.g.,&#160;the&#160;TLS&#160;extension&#160;proposed<br/>in&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[42,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">9]</a>).&#160;Such&#160;extensions&#160;can&#160;be&#160;based&#160;on&#160;binary&#160;attestation&#160;or&#160;on&#160;property-based<br/>attestation.</p>
<p style="position:absolute;top:987px;left:226px;white-space:nowrap" class="ft3326"><b>4.4</b></p>
<p style="position:absolute;top:987px;left:275px;white-space:nowrap" class="ft3326"><b>Secure&#160;Network&#160;Virtualization</b></p>
<p style="position:absolute;top:1025px;left:226px;white-space:nowrap" class="ft3315">Previous&#160;work&#160;on&#160;virtualizing&#160;physical&#160;networks&#160;can&#160;be&#160;roughly&#160;grouped&#160;into&#160;two&#160;cat-<br/>egories:&#160;those&#160;based&#160;on&#160;Ethernet&#160;virtualization&#160;and&#160;those&#160;based&#160;on&#160;TCP/IP-level&#160;virtu-<br/>alization.&#160;Although&#160;both&#160;categories&#160;include&#160;a&#160;substantial&#160;amount&#160;of&#160;work,&#160;few&#160;of&#160;these</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft3321">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 34 -->
<a name="34"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page34-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5034.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft348">32</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft3421">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft348">studies&#160;have&#160;an&#160;explicit&#160;focus&#160;on&#160;security.</p>
<p style="position:absolute;top:212px;left:172px;white-space:nowrap" class="ft348">A&#160;secure&#160;network&#160;virtualization&#160;framework&#160;was&#160;proposed&#160;by&#160;Cabuk&#160;<i>et&#160;al.&#160;</i><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[18]&#160;</a>for</p>
<p style="position:absolute;top:230px;left:150px;white-space:nowrap" class="ft3415">realizing&#160;the&#160;network&#160;flow&#160;aspects&#160;of&#160;TVDs.&#160;The&#160;focus&#160;of&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[18]&#160;</a>is&#160;a&#160;security-enhanced<br/>network&#160;virtualization,&#160;which&#160;(1)&#160;allows&#160;groups&#160;of&#160;related&#160;VMs&#160;running&#160;on&#160;separate<br/>physical&#160;machines&#160;to&#160;be&#160;connected&#160;together&#160;as&#160;though&#160;they&#160;were&#160;on&#160;their&#160;own&#160;separate<br/>network&#160;fabric,&#160;and&#160;(2)&#160;enforces&#160;intra-TVD&#160;and&#160;inter-TVD&#160;security&#160;requirements&#160;such<br/>as&#160;confidentiality,&#160;integrity,&#160;and&#160;inter-TVD&#160;flow&#160;control.&#160;This&#160;has&#160;been&#160;achieved&#160;by&#160;an<br/>automatic&#160;provisioning&#160;of&#160;networking&#160;components&#160;such&#160;as&#160;VPNs,&#160;Ethernet&#160;encapsula-<br/>tion,&#160;VLAN&#160;tagging,&#160;and&#160;virtual&#160;firewalls.</p>
<p style="position:absolute;top:355px;left:172px;white-space:nowrap" class="ft348">A&#160;second&#160;concept&#160;for&#160;managing&#160;VLAN&#160;access&#160;has&#160;been&#160;proposed&#160;by&#160;Berger&#160;<i>et&#160;al.&#160;</i>in</p>
<p style="position:absolute;top:373px;left:150px;white-space:nowrap" class="ft3415"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[14]</a>.&#160;Both&#160;papers&#160;contain&#160;similar&#160;concepts&#160;for&#160;managing&#160;VLANs&#160;inside&#160;the&#160;data&#160;center<br/>with&#160;some&#160;differences.&#160;The&#160;work&#160;of&#160;Berger&#160;<i>et&#160;al.&#160;</i>has&#160;more&#160;of&#160;a&#160;focus&#160;on&#160;integrity<br/>assurance&#160;using&#160;Trusted&#160;Computing.&#160;The&#160;work&#160;of&#160;Cabuk&#160;et&#160;al&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[18]&#160;</a>allows&#160;provisioning<br/>of&#160;secure&#160;virtual&#160;networking&#160;even&#160;if&#160;no&#160;VLAN&#160;infrastructure&#160;is&#160;present.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft3421">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 35 -->
<a name="35"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page35-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5035.png" alt="background image"/>
<p style="position:absolute;top:458px;left:439px;white-space:nowrap" class="ft3525"><b>Part&#160;II</b></p>
<p style="position:absolute;top:529px;left:235px;white-space:nowrap" class="ft3522"><b>Building&#160;Blocks&#160;of&#160;the&#160;OpenTC</b></p>
<p style="position:absolute;top:573px;left:313px;white-space:nowrap" class="ft3522"><b>Security&#160;Architecture</b></p>
<p style="position:absolute;top:1117px;left:476px;white-space:nowrap" class="ft358">33</p>
</div>
<!-- Page 36 -->
<a name="36"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page36-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5036.png" alt="background image"/>
<p style="position:absolute;top:295px;left:150px;white-space:nowrap" class="ft3625"><b>Chapter&#160;5</b></p>
<p style="position:absolute;top:365px;left:150px;white-space:nowrap" class="ft3635"><b>Policy&#160;Enforcement&#160;and<br/>Compliance&#160;Proofs&#160;for&#160;Xen<br/>Virtual&#160;Machines</b></p>
<p style="position:absolute;top:512px;left:244px;white-space:nowrap" class="ft368">Bernhard&#160;Jansen,&#160;HariGovind&#160;V.&#160;Ramasamy,&#160;Matthias&#160;Schunter&#160;(IBM)</p>
<p style="position:absolute;top:591px;left:150px;white-space:nowrap" class="ft3626"><b>5.1</b></p>
<p style="position:absolute;top:591px;left:198px;white-space:nowrap" class="ft3626"><b>Introduction</b></p>
<p style="position:absolute;top:629px;left:150px;white-space:nowrap" class="ft3614">Hardware&#160;virtualization&#160;is&#160;enjoying&#160;a&#160;resurgence&#160;of&#160;interest&#160;fueled&#160;in&#160;part&#160;by&#160;its&#160;cost-<br/>saving&#160;potential&#160;in&#160;data&#160;centers.&#160;By&#160;allowing&#160;multiple&#160;virtual&#160;machines&#160;to&#160;be&#160;hosted<br/>on&#160;a&#160;single&#160;physical&#160;server,&#160;virtualization&#160;helps&#160;improve&#160;server&#160;utilization,&#160;reduce&#160;man-<br/>agement&#160;and&#160;power&#160;costs,&#160;and&#160;control&#160;the&#160;problem&#160;of&#160;server&#160;sprawl.</p>
<p style="position:absolute;top:700px;left:172px;white-space:nowrap" class="ft368">We&#160;are&#160;interested&#160;in&#160;the&#160;security&#160;management&#160;of&#160;virtual&#160;machines,&#160;i.e.,&#160;the&#160;pro-</p>
<p style="position:absolute;top:718px;left:150px;white-space:nowrap" class="ft3614">tection,&#160;enforcement,&#160;and&#160;verification&#160;of&#160;the&#160;security&#160;of&#160;virtual&#160;machines.&#160;Security<br/>management&#160;is&#160;a&#160;non-trivial&#160;problem&#160;even&#160;in&#160;traditional&#160;non-virtualized&#160;environments.<br/>Security&#160;management&#160;of&#160;virtual&#160;machines&#160;(VMs)&#160;is&#160;even&#160;more&#160;complicated&#160;because&#160;the<br/>virtual&#160;machines&#160;hosted&#160;on&#160;a&#160;given&#160;physical&#160;server&#160;may&#160;belong&#160;to&#160;different&#160;virtual&#160;orga-<br/>nizations,&#160;and&#160;as&#160;a&#160;result,&#160;may&#160;have&#160;differing&#160;security&#160;requirements.&#160;Protecting&#160;a&#160;VM<br/>against&#160;security&#160;attacks&#160;may&#160;be&#160;complicated&#160;by&#160;inadequate&#160;isolation&#160;of&#160;the&#160;VM&#160;from<br/>other&#160;VMs&#160;hosted&#160;on&#160;the&#160;same&#160;server.&#160;Verifying&#160;the&#160;security&#160;of&#160;a&#160;VM&#160;may&#160;be&#160;compli-<br/>cated&#160;by&#160;confidentiality&#160;requirements,&#160;which&#160;may&#160;dictate&#160;that&#160;the&#160;information&#160;needed<br/>for&#160;verification&#160;of&#160;a&#160;VM’s&#160;configuration&#160;should&#160;not&#160;divulge&#160;configuration&#160;information<br/>of&#160;other&#160;co-hosted&#160;VMs.</p>
<p style="position:absolute;top:898px;left:172px;white-space:nowrap" class="ft368">We&#160;address&#160;two&#160;main&#160;problems&#160;relating&#160;to&#160;security&#160;management,&#160;particularly&#160;in-</p>
<p style="position:absolute;top:916px;left:150px;white-space:nowrap" class="ft3615">tegrity&#160;management,&#160;of&#160;VMs:&#160;(1)&#160;protecting&#160;the&#160;security&#160;policies&#160;of&#160;a&#160;VM&#160;against<br/>modification&#160;throughout&#160;the&#160;VM’s&#160;life&#160;cycle,&#160;and&#160;(2)&#160;verifying&#160;that&#160;a&#160;VM&#160;is&#160;com-<br/>pliant&#160;with&#160;specified&#160;security&#160;requirements.&#160;We&#160;describe&#160;a&#160;formal&#160;model&#160;that&#160;gen-<br/>eralizes&#160;integrity&#160;management&#160;mechanisms&#160;based&#160;on&#160;the&#160;Trusted&#160;Platform&#160;Module<br/>(TPM)&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[120]&#160;</a>to&#160;cover&#160;VMs&#160;(and&#160;their&#160;associated&#160;virtual&#160;devices)&#160;and&#160;a&#160;wider&#160;range<br/>of&#160;security&#160;policies&#160;(such&#160;as&#160;isolation&#160;policies&#160;for&#160;secure&#160;device&#160;virtualization&#160;and&#160;mi-<br/>gration&#160;constraints&#160;for&#160;VMs).&#160;On&#160;TPM-equipped&#160;platforms,&#160;system&#160;compliance&#160;can<br/>be&#160;evaluated&#160;by&#160;checking&#160;TPM&#160;register&#160;values.&#160;Our&#160;model&#160;allows&#160;finer-grained&#160;com-<br/>pliance&#160;checks&#160;by&#160;handling&#160;policies&#160;that&#160;can&#160;be&#160;expressed&#160;as&#160;predicates&#160;on&#160;system&#160;log</p>
<p style="position:absolute;top:1117px;left:400px;white-space:nowrap" class="ft368">34</p>
</div>
<!-- Page 37 -->
<a name="37"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3780{font-size:10px;font-family:Helvetica;color:#000000;}
	.ft3781{font-size:14px;font-family:Helvetica;color:#000000;}
	.ft3782{font-size:12px;font-family:KPSHBO+TT35EFo00;color:#000000;}
	.ft3783{font-size:14px;font-family:Times;color:#000000;}
	.ft3784{font-size:9px;line-height:9px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page37-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5037.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft378">CHAPTER&#160;5.&#160;POLICY&#160;ENFORCEMENT&#160;AND&#160;COMPLIANCE</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft378">35</p>
<p style="position:absolute;top:306px;left:438px;white-space:nowrap" class="ft3780"><b>Physical&#160;Hardware</b></p>
<p style="position:absolute;top:212px;left:321px;white-space:nowrap" class="ft3780"><b>Management&#160;</b></p>
<p style="position:absolute;top:225px;left:325px;white-space:nowrap" class="ft3780"><b>of&#160;security,&#160;</b></p>
<p style="position:absolute;top:237px;left:332px;white-space:nowrap" class="ft3780"><b>devices,&#160;</b></p>
<p style="position:absolute;top:250px;left:323px;white-space:nowrap" class="ft3780"><b>VMs,&#160;and&#160;I/O</b></p>
<p style="position:absolute;top:197px;left:339px;white-space:nowrap" class="ft3780"><b>Dom0</b></p>
<p style="position:absolute;top:254px;left:421px;white-space:nowrap" class="ft3780"><b>GuestOS</b></p>
<p style="position:absolute;top:216px;left:429px;white-space:nowrap" class="ft3780"><b>User</b></p>
<p style="position:absolute;top:229px;left:419px;white-space:nowrap" class="ft3780"><b>Software</b></p>
<p style="position:absolute;top:197px;left:420px;white-space:nowrap" class="ft3780"><b>DomU&#160;1</b></p>
<p style="position:absolute;top:254px;left:505px;white-space:nowrap" class="ft3780"><b>GuestOS</b></p>
<p style="position:absolute;top:216px;left:516px;white-space:nowrap" class="ft3780"><b>User</b></p>
<p style="position:absolute;top:229px;left:506px;white-space:nowrap" class="ft3780"><b>Software</b></p>
<p style="position:absolute;top:197px;left:507px;white-space:nowrap" class="ft3780"><b>DomU&#160;2</b></p>
<p style="position:absolute;top:254px;left:590px;white-space:nowrap" class="ft3780"><b>GuestOS</b></p>
<p style="position:absolute;top:216px;left:601px;white-space:nowrap" class="ft3780"><b>User</b></p>
<p style="position:absolute;top:229px;left:591px;white-space:nowrap" class="ft3780"><b>Software</b></p>
<p style="position:absolute;top:194px;left:592px;white-space:nowrap" class="ft3780"><b>DomU&#160;3</b></p>
<p style="position:absolute;top:283px;left:460px;white-space:nowrap" class="ft3780"><b>VMM&#160;Core</b></p>
<p style="position:absolute;top:357px;left:351px;white-space:nowrap" class="ft378">Figure&#160;5.1:&#160;Xen&#160;virtual&#160;machine&#160;architecture</p>
<p style="position:absolute;top:501px;left:424px;white-space:nowrap" class="ft3781"><b>TCB</b></p>
<p style="position:absolute;top:435px;left:337px;white-space:nowrap" class="ft3743">policy</p>
<p style="position:absolute;top:459px;left:383px;white-space:nowrap" class="ft3743">log</p>
<p style="position:absolute;top:469px;left:373px;white-space:nowrap" class="ft3743">integrity</p>
<p style="position:absolute;top:478px;left:379px;white-space:nowrap" class="ft3743">state</p>
<p style="position:absolute;top:459px;left:440px;white-space:nowrap" class="ft3743">conditional</p>
<p style="position:absolute;top:468px;left:447px;white-space:nowrap" class="ft3743">release&#160;</p>
<p style="position:absolute;top:478px;left:443px;white-space:nowrap" class="ft3743">of&#160;secrets</p>
<p style="position:absolute;top:417px;left:477px;white-space:nowrap" class="ft3781"><b>VM</b></p>
<p style="position:absolute;top:481px;left:516px;white-space:nowrap" class="ft3784">sealing&#160;or&#160;<br/>attestation</p>
<p style="position:absolute;top:500px;left:522px;white-space:nowrap" class="ft3743">request</p>
<p style="position:absolute;top:519px;left:518px;white-space:nowrap" class="ft3743">response</p>
<p style="position:absolute;top:482px;left:571px;white-space:nowrap" class="ft3780"><b>User&#160;or&#160;Verifier</b></p>
<p style="position:absolute;top:499px;left:592px;white-space:nowrap" class="ft3744">integrity</p>
<p style="position:absolute;top:507px;left:583px;white-space:nowrap" class="ft3744">requirements</p>
<p style="position:absolute;top:516px;left:584px;white-space:nowrap" class="ft3744">predicate&#160;&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:510px;left:619px;white-space:nowrap" class="ft3782">Π</p>
<p style="position:absolute;top:510px;left:619px;white-space:nowrap" class="ft3782">Π</p>
<p style="position:absolute;top:394px;left:413px;white-space:nowrap" class="ft3781"><b>System</b></p>
<p style="position:absolute;top:516px;left:397px;white-space:nowrap" class="ft3743">log&#160;</p>
<p style="position:absolute;top:525px;left:384px;white-space:nowrap" class="ft3743">repository</p>
<p style="position:absolute;top:516px;left:452px;white-space:nowrap" class="ft3743">secret</p>
<p style="position:absolute;top:525px;left:444px;white-space:nowrap" class="ft3743">repository</p>
<p style="position:absolute;top:417px;left:417px;white-space:nowrap" class="ft3781"><b>VM</b></p>
<p style="position:absolute;top:417px;left:382px;white-space:nowrap" class="ft3781"><b>VM</b></p>
<p style="position:absolute;top:414px;left:445px;white-space:nowrap" class="ft3783"><b>.&#160;.&#160;.&#160;.</b></p>
<p style="position:absolute;top:581px;left:329px;white-space:nowrap" class="ft378">Figure&#160;5.2:&#160;System&#160;model&#160;for&#160;integrity&#160;management</p>
<p style="position:absolute;top:629px;left:226px;white-space:nowrap" class="ft3715">entries.&#160;Verifying&#160;compliance&#160;involves&#160;showing&#160;that&#160;the&#160;system&#160;integrity&#160;state,&#160;as&#160;re-<br/>flected&#160;by&#160;secure&#160;write-only&#160;logs,&#160;satisfies&#160;certain&#160;conditions.&#160;We&#160;build&#160;on&#160;previous<br/>work&#160;by&#160;others&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[39,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">45,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">101,&#160;104,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">13]&#160;</a>who&#160;have&#160;used&#160;the&#160;Trusted&#160;Platform&#160;Module<br/>(TPM)&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[120]&#160;</a>to&#160;protect&#160;the&#160;integrity&#160;of&#160;the&#160;core&#160;virtual&#160;machine&#160;monitor&#160;(VMM)&#160;and&#160;to<br/>reliably&#160;isolate&#160;VMs.&#160;Based&#160;on&#160;the&#160;formal&#160;model,&#160;we&#160;describe&#160;an&#160;integrity&#160;architecture<br/>called&#160;PEV&#160;(which&#160;stands&#160;for&#160;protection,&#160;enforcement,&#160;and&#160;verification)&#160;and&#160;associated<br/>protocols.&#160;The&#160;architecture&#160;incorporates&#160;integrity&#160;protection&#160;and&#160;verification&#160;as&#160;part&#160;of<br/>the&#160;virtualization&#160;software&#160;itself,&#160;and&#160;at&#160;the&#160;same&#160;time&#160;enhances&#160;its&#160;policy&#160;enforcement<br/>capabilities.&#160;We&#160;describe&#160;a&#160;prototype&#160;realization&#160;of&#160;our&#160;architecture&#160;using&#160;the&#160;Xen<br/>hypervisor&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[11]</a>.&#160;We&#160;demonstrate&#160;the&#160;policy&#160;enforcement&#160;and&#160;compliance&#160;checking<br/>capabilities&#160;of&#160;our&#160;prototype&#160;through&#160;multiple&#160;use&#160;cases.</p>
<p style="position:absolute;top:827px;left:248px;white-space:nowrap" class="ft378">Our&#160;generalized&#160;integrity&#160;management&#160;mechanisms&#160;are&#160;both&#160;extensible&#160;and&#160;flexi-</p>
<p style="position:absolute;top:845px;left:226px;white-space:nowrap" class="ft3714">ble.&#160;<i>Extensibility&#160;</i>means&#160;that&#160;it&#160;is&#160;possible&#160;to&#160;guarantee&#160;compliance&#160;even&#160;if&#160;new&#160;virtual<br/>devices&#160;are&#160;attached&#160;to&#160;the&#160;VMs.&#160;<i>Flexibility&#160;</i>means&#160;that&#160;the&#160;verifier&#160;is&#160;able&#160;to&#160;spec-<br/>ify&#160;which&#160;aspects&#160;of&#160;the&#160;enforced&#160;security&#160;policies&#160;are&#160;of&#160;interest,&#160;and&#160;obtain&#160;only&#160;the<br/>information&#160;corresponding&#160;to&#160;those&#160;aspects&#160;for&#160;validation&#160;of&#160;system&#160;compliance.</p>
<p style="position:absolute;top:962px;left:226px;white-space:nowrap" class="ft3726"><b>5.2</b></p>
<p style="position:absolute;top:962px;left:275px;white-space:nowrap" class="ft3726"><b>Formal&#160;Integrity&#160;Model&#160;for&#160;Virtual&#160;Machines</b></p>
<p style="position:absolute;top:1000px;left:226px;white-space:nowrap" class="ft3715">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#37">5.2&#160;</a>shows&#160;our&#160;system&#160;model&#160;for&#160;integrity&#160;management.&#160;At&#160;a&#160;high&#160;level,&#160;the<br/>system&#160;consists&#160;of&#160;VMs&#160;and&#160;a&#160;TCB,&#160;and&#160;is&#160;configured&#160;through&#160;policies.&#160;The&#160;TCB&#160;peri-<br/>odically&#160;logs&#160;the&#160;integrity&#160;state&#160;of&#160;the&#160;rest&#160;of&#160;the&#160;system.&#160;The&#160;log&#160;repository&#160;contains&#160;a<br/>record&#160;of&#160;the&#160;integrity&#160;history&#160;of&#160;the&#160;system,&#160;and&#160;is&#160;<i>secure&#160;write-only</i>,&#160;i.e.,&#160;log&#160;entries,<br/>once&#160;written,&#160;cannot&#160;be&#160;modified&#160;or&#160;removed&#160;by&#160;any&#160;entity&#160;in&#160;the&#160;rest&#160;of&#160;the&#160;system.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft3721">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 38 -->
<a name="38"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3885{font-size:12px;font-family:Times;color:#000000;}
	.ft3886{font-size:10px;font-family:CXOYBI+TT3AFAo00;color:#000000;}
	.ft3887{font-size:10px;font-family:RDZRPI+TT3AFBo00;color:#000000;}
	.ft3888{font-size:7px;font-family:CXOYBI+TT3AFCo00;color:#000000;}
	.ft3889{font-size:7px;font-family:KPSHBO+TT3AFDo00;color:#000000;}
-->
</style>
<div id="page38-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5038.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft388">36</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft3821">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:238px;left:470px;white-space:nowrap" class="ft3885">…</p>
<p style="position:absolute;top:226px;left:465px;white-space:nowrap" class="ft3885">…</p>
<p style="position:absolute;top:186px;left:355px;white-space:nowrap" class="ft3886">(</p>
<p style="position:absolute;top:186px;left:359px;white-space:nowrap" class="ft3887">id,&#160;type,&#160;log</p>
<p style="position:absolute;top:186px;left:407px;white-space:nowrap" class="ft3886">)</p>
<p style="position:absolute;top:186px;left:355px;white-space:nowrap" class="ft3886">(</p>
<p style="position:absolute;top:186px;left:359px;white-space:nowrap" class="ft3887">id,&#160;type,&#160;log</p>
<p style="position:absolute;top:186px;left:407px;white-space:nowrap" class="ft3886">)</p>
<p style="position:absolute;top:212px;left:304px;white-space:nowrap" class="ft3886">(</p>
<p style="position:absolute;top:212px;left:308px;white-space:nowrap" class="ft3887">id</p>
<p style="position:absolute;top:217px;left:317px;white-space:nowrap" class="ft3888">1</p>
<p style="position:absolute;top:212px;left:321px;white-space:nowrap" class="ft3887">,&#160;type</p>
<p style="position:absolute;top:217px;left:343px;white-space:nowrap" class="ft3888">1</p>
<p style="position:absolute;top:212px;left:348px;white-space:nowrap" class="ft3887">,&#160;log</p>
<p style="position:absolute;top:217px;left:364px;white-space:nowrap" class="ft3888">1</p>
<p style="position:absolute;top:212px;left:369px;white-space:nowrap" class="ft3886">)</p>
<p style="position:absolute;top:212px;left:304px;white-space:nowrap" class="ft3886">(</p>
<p style="position:absolute;top:212px;left:308px;white-space:nowrap" class="ft3887">id</p>
<p style="position:absolute;top:217px;left:317px;white-space:nowrap" class="ft3888">1</p>
<p style="position:absolute;top:212px;left:321px;white-space:nowrap" class="ft3887">,&#160;type</p>
<p style="position:absolute;top:217px;left:343px;white-space:nowrap" class="ft3888">1</p>
<p style="position:absolute;top:212px;left:348px;white-space:nowrap" class="ft3887">,&#160;log</p>
<p style="position:absolute;top:217px;left:364px;white-space:nowrap" class="ft3888">1</p>
<p style="position:absolute;top:212px;left:369px;white-space:nowrap" class="ft3886">)</p>
<p style="position:absolute;top:235px;left:275px;white-space:nowrap" class="ft3886">(</p>
<p style="position:absolute;top:235px;left:279px;white-space:nowrap" class="ft3887">id</p>
<p style="position:absolute;top:240px;left:287px;white-space:nowrap" class="ft3888">11</p>
<p style="position:absolute;top:235px;left:296px;white-space:nowrap" class="ft3887">,&#160;type</p>
<p style="position:absolute;top:240px;left:318px;white-space:nowrap" class="ft3888">11</p>
<p style="position:absolute;top:235px;left:326px;white-space:nowrap" class="ft3887">,&#160;log</p>
<p style="position:absolute;top:240px;left:343px;white-space:nowrap" class="ft3888">11</p>
<p style="position:absolute;top:235px;left:351px;white-space:nowrap" class="ft3886">)</p>
<p style="position:absolute;top:235px;left:275px;white-space:nowrap" class="ft3886">(</p>
<p style="position:absolute;top:235px;left:279px;white-space:nowrap" class="ft3887">id</p>
<p style="position:absolute;top:240px;left:287px;white-space:nowrap" class="ft3888">11</p>
<p style="position:absolute;top:235px;left:296px;white-space:nowrap" class="ft3887">,&#160;type</p>
<p style="position:absolute;top:240px;left:318px;white-space:nowrap" class="ft3888">11</p>
<p style="position:absolute;top:235px;left:326px;white-space:nowrap" class="ft3887">,&#160;log</p>
<p style="position:absolute;top:240px;left:343px;white-space:nowrap" class="ft3888">11</p>
<p style="position:absolute;top:235px;left:351px;white-space:nowrap" class="ft3886">)</p>
<p style="position:absolute;top:257px;left:249px;white-space:nowrap" class="ft3886">(</p>
<p style="position:absolute;top:257px;left:253px;white-space:nowrap" class="ft3887">id</p>
<p style="position:absolute;top:262px;left:261px;white-space:nowrap" class="ft3888">111</p>
<p style="position:absolute;top:257px;left:273px;white-space:nowrap" class="ft3887">,&#160;type</p>
<p style="position:absolute;top:262px;left:296px;white-space:nowrap" class="ft3888">111</p>
<p style="position:absolute;top:257px;left:308px;white-space:nowrap" class="ft3887">,&#160;log</p>
<p style="position:absolute;top:262px;left:324px;white-space:nowrap" class="ft3888">111</p>
<p style="position:absolute;top:257px;left:337px;white-space:nowrap" class="ft3886">)</p>
<p style="position:absolute;top:257px;left:249px;white-space:nowrap" class="ft3886">(</p>
<p style="position:absolute;top:257px;left:253px;white-space:nowrap" class="ft3887">id</p>
<p style="position:absolute;top:262px;left:261px;white-space:nowrap" class="ft3888">111</p>
<p style="position:absolute;top:257px;left:273px;white-space:nowrap" class="ft3887">,&#160;type</p>
<p style="position:absolute;top:262px;left:296px;white-space:nowrap" class="ft3888">111</p>
<p style="position:absolute;top:257px;left:308px;white-space:nowrap" class="ft3887">,&#160;log</p>
<p style="position:absolute;top:262px;left:324px;white-space:nowrap" class="ft3888">111</p>
<p style="position:absolute;top:257px;left:337px;white-space:nowrap" class="ft3886">)</p>
<p style="position:absolute;top:236px;left:390px;white-space:nowrap" class="ft3886">(</p>
<p style="position:absolute;top:236px;left:394px;white-space:nowrap" class="ft3887">id</p>
<p style="position:absolute;top:240px;left:402px;white-space:nowrap" class="ft3888">21</p>
<p style="position:absolute;top:236px;left:410px;white-space:nowrap" class="ft3887">,&#160;type</p>
<p style="position:absolute;top:240px;left:433px;white-space:nowrap" class="ft3888">21</p>
<p style="position:absolute;top:236px;left:441px;white-space:nowrap" class="ft3887">,&#160;log</p>
<p style="position:absolute;top:240px;left:458px;white-space:nowrap" class="ft3888">21</p>
<p style="position:absolute;top:236px;left:466px;white-space:nowrap" class="ft3886">)</p>
<p style="position:absolute;top:236px;left:390px;white-space:nowrap" class="ft3886">(</p>
<p style="position:absolute;top:236px;left:394px;white-space:nowrap" class="ft3887">id</p>
<p style="position:absolute;top:240px;left:402px;white-space:nowrap" class="ft3888">21</p>
<p style="position:absolute;top:236px;left:410px;white-space:nowrap" class="ft3887">,&#160;type</p>
<p style="position:absolute;top:240px;left:433px;white-space:nowrap" class="ft3888">21</p>
<p style="position:absolute;top:236px;left:441px;white-space:nowrap" class="ft3887">,&#160;log</p>
<p style="position:absolute;top:240px;left:458px;white-space:nowrap" class="ft3888">21</p>
<p style="position:absolute;top:236px;left:466px;white-space:nowrap" class="ft3886">)&#160;(</p>
<p style="position:absolute;top:236px;left:487px;white-space:nowrap" class="ft3887">id</p>
<p style="position:absolute;top:240px;left:496px;white-space:nowrap" class="ft3888">2</p>
<p style="position:absolute;top:241px;left:500px;white-space:nowrap" class="ft3889">n</p>
<p style="position:absolute;top:236px;left:505px;white-space:nowrap" class="ft3887">,&#160;type</p>
<p style="position:absolute;top:240px;left:527px;white-space:nowrap" class="ft3888">2</p>
<p style="position:absolute;top:241px;left:531px;white-space:nowrap" class="ft3889">n</p>
<p style="position:absolute;top:236px;left:536px;white-space:nowrap" class="ft3887">,&#160;log</p>
<p style="position:absolute;top:240px;left:553px;white-space:nowrap" class="ft3888">2</p>
<p style="position:absolute;top:241px;left:557px;white-space:nowrap" class="ft3889">n</p>
<p style="position:absolute;top:236px;left:562px;white-space:nowrap" class="ft3886">)</p>
<p style="position:absolute;top:236px;left:484px;white-space:nowrap" class="ft3886">(</p>
<p style="position:absolute;top:236px;left:487px;white-space:nowrap" class="ft3887">id</p>
<p style="position:absolute;top:240px;left:496px;white-space:nowrap" class="ft3888">2</p>
<p style="position:absolute;top:241px;left:500px;white-space:nowrap" class="ft3889">n</p>
<p style="position:absolute;top:236px;left:505px;white-space:nowrap" class="ft3887">,&#160;type</p>
<p style="position:absolute;top:240px;left:527px;white-space:nowrap" class="ft3888">2</p>
<p style="position:absolute;top:241px;left:531px;white-space:nowrap" class="ft3889">n</p>
<p style="position:absolute;top:236px;left:536px;white-space:nowrap" class="ft3887">,&#160;log</p>
<p style="position:absolute;top:240px;left:553px;white-space:nowrap" class="ft3888">2</p>
<p style="position:absolute;top:241px;left:557px;white-space:nowrap" class="ft3889">n</p>
<p style="position:absolute;top:236px;left:562px;white-space:nowrap" class="ft3886">)</p>
<p style="position:absolute;top:211px;left:404px;white-space:nowrap" class="ft3886">(</p>
<p style="position:absolute;top:211px;left:408px;white-space:nowrap" class="ft3887">id</p>
<p style="position:absolute;top:215px;left:416px;white-space:nowrap" class="ft3888">2</p>
<p style="position:absolute;top:211px;left:420px;white-space:nowrap" class="ft3887">,&#160;type</p>
<p style="position:absolute;top:215px;left:443px;white-space:nowrap" class="ft3888">2</p>
<p style="position:absolute;top:211px;left:447px;white-space:nowrap" class="ft3887">,&#160;log</p>
<p style="position:absolute;top:215px;left:464px;white-space:nowrap" class="ft3888">2</p>
<p style="position:absolute;top:211px;left:468px;white-space:nowrap" class="ft3886">)</p>
<p style="position:absolute;top:211px;left:404px;white-space:nowrap" class="ft3886">(</p>
<p style="position:absolute;top:211px;left:408px;white-space:nowrap" class="ft3887">id</p>
<p style="position:absolute;top:215px;left:416px;white-space:nowrap" class="ft3888">2</p>
<p style="position:absolute;top:211px;left:420px;white-space:nowrap" class="ft3887">,&#160;type</p>
<p style="position:absolute;top:215px;left:443px;white-space:nowrap" class="ft3888">2</p>
<p style="position:absolute;top:211px;left:447px;white-space:nowrap" class="ft3887">,&#160;log</p>
<p style="position:absolute;top:215px;left:464px;white-space:nowrap" class="ft3888">2</p>
<p style="position:absolute;top:211px;left:468px;white-space:nowrap" class="ft3886">)</p>
<p style="position:absolute;top:309px;left:310px;white-space:nowrap" class="ft388">Figure&#160;5.3:&#160;Tree</p>
<p style="position:absolute;top:308px;left:411px;white-space:nowrap" class="ft3850">T</p>
<p style="position:absolute;top:309px;left:426px;white-space:nowrap" class="ft388">of&#160;log&#160;entries</p>
<p style="position:absolute;top:356px;left:150px;white-space:nowrap" class="ft3814">The&#160;log&#160;data&#160;includes&#160;the&#160;list&#160;of&#160;software&#160;components,&#160;configuration&#160;parameters,&#160;poli-<br/>cies,&#160;and&#160;any&#160;updates&#160;to&#160;them.&#160;The&#160;log&#160;contents&#160;are&#160;useful&#160;in&#160;evaluating&#160;compliance<br/>with&#160;those&#160;security&#160;properties&#160;that&#160;can&#160;be&#160;expressed&#160;as&#160;predicates&#160;on&#160;the&#160;contents.&#160;The<br/>compliance&#160;proof&#160;involves&#160;showing&#160;that&#160;correct&#160;policies&#160;and&#160;healthy&#160;policy&#160;enforce-<br/>ment&#160;mechanisms&#160;are&#160;in&#160;place.&#160;The&#160;TCB&#160;also&#160;provides&#160;conditional&#160;release&#160;of&#160;secrets,<br/>where&#160;the&#160;condition&#160;is&#160;expressed&#160;as&#160;predicates&#160;on&#160;the&#160;log&#160;data.&#160;That&#160;allows&#160;a&#160;sensitive<br/>data&#160;item&#160;and&#160;a&#160;condition&#160;to&#160;be&#160;stored&#160;such&#160;that&#160;the&#160;data&#160;item&#160;is&#160;released&#160;only&#160;if&#160;the&#160;log<br/>data&#160;satisfies&#160;the&#160;condition&#160;specified.</p>
<p style="position:absolute;top:500px;left:172px;white-space:nowrap" class="ft388">For&#160;flexibility&#160;and&#160;extensibility,&#160;the&#160;log&#160;data&#160;is&#160;stored&#160;in&#160;a&#160;tree&#160;structure&#160;instead</p>
<p style="position:absolute;top:518px;left:150px;white-space:nowrap" class="ft388">of&#160;a&#160;monolithic&#160;log&#160;file.&#160;The&#160;log&#160;tree</p>
<p style="position:absolute;top:517px;left:382px;white-space:nowrap" class="ft3850">T</p>
<p style="position:absolute;top:518px;left:399px;white-space:nowrap" class="ft388">is&#160;shown&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#38">5.3.&#160;</a>Each&#160;tree&#160;node&#160;is&#160;a</p>
<p style="position:absolute;top:535px;left:150px;white-space:nowrap" class="ft3815">triple&#160;containing&#160;log&#160;data&#160;for&#160;one&#160;system&#160;component.&#160;To&#160;keep&#160;the&#160;tree&#160;size&#160;manageable,<br/>only&#160;those&#160;components&#160;that&#160;have&#160;an&#160;impact&#160;on&#160;the&#160;system’s&#160;integrity&#160;or&#160;those&#160;that&#160;are<br/>of&#160;interest&#160;from&#160;an&#160;integrity&#160;verification&#160;point&#160;of&#160;view&#160;are&#160;represented&#160;in&#160;the&#160;log&#160;tree.<br/>A&#160;triple&#160;for&#160;a&#160;component</p>
<p style="position:absolute;top:588px;left:305px;white-space:nowrap" class="ft3846">k</p>
<p style="position:absolute;top:589px;left:318px;white-space:nowrap" class="ft388">contains&#160;an&#160;identifier</p>
<p style="position:absolute;top:588px;left:449px;white-space:nowrap" class="ft3846">id</p>
<p style="position:absolute;top:594px;left:462px;white-space:nowrap" class="ft3847">k</p>
<p style="position:absolute;top:589px;left:469px;white-space:nowrap" class="ft388">,&#160;a&#160;component&#160;type</p>
<p style="position:absolute;top:588px;left:589px;white-space:nowrap" class="ft3846">type</p>
<p style="position:absolute;top:594px;left:617px;white-space:nowrap" class="ft3847">k</p>
<p style="position:absolute;top:589px;left:624px;white-space:nowrap" class="ft388">,&#160;and&#160;a</p>
<p style="position:absolute;top:607px;left:150px;white-space:nowrap" class="ft388">vector</p>
<p style="position:absolute;top:606px;left:190px;white-space:nowrap" class="ft3846">log</p>
<p style="position:absolute;top:612px;left:210px;white-space:nowrap" class="ft3847">k</p>
<p style="position:absolute;top:607px;left:220px;white-space:nowrap" class="ft388">of&#160;log&#160;values.&#160;Sub-components&#160;are&#160;modeled&#160;as&#160;children&#160;of&#160;a&#160;node.&#160;The&#160;tree</p>
<p style="position:absolute;top:625px;left:150px;white-space:nowrap" class="ft3814">can&#160;be&#160;extended&#160;by&#160;adding&#160;or&#160;removing&#160;children&#160;nodes.&#160;For&#160;example,&#160;the&#160;addition&#160;of&#160;a<br/>new&#160;virtual&#160;device&#160;to&#160;a&#160;VM&#160;can&#160;be&#160;easily&#160;reflected&#160;in&#160;the&#160;log&#160;tree&#160;by&#160;adding&#160;a&#160;new&#160;node<br/>as&#160;a&#160;child&#160;of&#160;the&#160;sub-tree&#160;that&#160;corresponds&#160;to&#160;the&#160;VM.</p>
<p style="position:absolute;top:679px;left:172px;white-space:nowrap" class="ft388">The&#160;integrity&#160;requirements&#160;of&#160;a&#160;user&#160;or&#160;verifier&#160;are&#160;modeled&#160;by</p>
<p style="position:absolute;top:678px;left:552px;white-space:nowrap" class="ft3848">Π(</p>
<p style="position:absolute;top:678px;left:569px;white-space:nowrap" class="ft3873">p</p>
<p style="position:absolute;top:678px;left:577px;white-space:nowrap" class="ft3848">(</p>
<p style="position:absolute;top:678px;left:582px;white-space:nowrap" class="ft3850">T</p>
<p style="position:absolute;top:678px;left:594px;white-space:nowrap" class="ft3848">))</p>
<p style="position:absolute;top:679px;left:606px;white-space:nowrap" class="ft388">,&#160;where</p>
<p style="position:absolute;top:678px;left:654px;white-space:nowrap" class="ft3848">Π</p>
<p style="position:absolute;top:697px;left:150px;white-space:nowrap" class="ft388">is&#160;a&#160;predicate&#160;and</p>
<p style="position:absolute;top:696px;left:258px;white-space:nowrap" class="ft3873">p</p>
<p style="position:absolute;top:696px;left:266px;white-space:nowrap" class="ft3848">()</p>
<p style="position:absolute;top:697px;left:282px;white-space:nowrap" class="ft388">is&#160;a&#160;projection&#160;function.&#160;We&#160;introduce&#160;the&#160;notion&#160;of&#160;a&#160;<i>projection</i></p>
<p style="position:absolute;top:715px;left:150px;white-space:nowrap" class="ft3820"><i>function</i>,&#160;denoted&#160;by</p>
<p style="position:absolute;top:714px;left:279px;white-space:nowrap" class="ft3873">p</p>
<p style="position:absolute;top:714px;left:287px;white-space:nowrap" class="ft3848">()</p>
<p style="position:absolute;top:715px;left:298px;white-space:nowrap" class="ft388">,&#160;to&#160;model&#160;the&#160;specific&#160;aspects&#160;of&#160;the&#160;system’s&#160;integrity&#160;state</p>
<p style="position:absolute;top:733px;left:150px;white-space:nowrap" class="ft3815">that&#160;is&#160;of&#160;interest&#160;to&#160;a&#160;user&#160;or&#160;verifier.&#160;For&#160;example,&#160;a&#160;verifier&#160;may&#160;be&#160;interested&#160;only&#160;in<br/>a&#160;disk’s&#160;access&#160;control&#160;list&#160;and&#160;not&#160;the&#160;actual&#160;disk&#160;contents.&#160;When&#160;applied&#160;on&#160;the&#160;log<br/>tree,&#160;the&#160;function&#160;returns&#160;a&#160;subset&#160;of&#160;the&#160;tree&#160;nodes&#160;and&#160;a&#160;subset&#160;of&#160;the&#160;vector&#160;elements<br/>from&#160;the&#160;log&#160;vector&#160;of&#160;each&#160;node.&#160;Formally,</p>
<p style="position:absolute;top:786px;left:433px;white-space:nowrap" class="ft3873">p</p>
<p style="position:absolute;top:785px;left:441px;white-space:nowrap" class="ft3848">(</p>
<p style="position:absolute;top:785px;left:447px;white-space:nowrap" class="ft3850">T</p>
<p style="position:absolute;top:785px;left:459px;white-space:nowrap" class="ft3848">)&#160;=</p>
<p style="position:absolute;top:785px;left:492px;white-space:nowrap" class="ft3850">{</p>
<p style="position:absolute;top:785px;left:499px;white-space:nowrap" class="ft3846">l</p>
<p style="position:absolute;top:791px;left:504px;white-space:nowrap" class="ft3847">k</p>
<p style="position:absolute;top:785px;left:511px;white-space:nowrap" class="ft3850">}</p>
<p style="position:absolute;top:786px;left:519px;white-space:nowrap" class="ft388">,&#160;where</p>
<p style="position:absolute;top:785px;left:570px;white-space:nowrap" class="ft3846">l</p>
<p style="position:absolute;top:791px;left:575px;white-space:nowrap" class="ft3847">k</p>
<p style="position:absolute;top:785px;left:590px;white-space:nowrap" class="ft3850">∈</p>
<p style="position:absolute;top:785px;left:607px;white-space:nowrap" class="ft3846">log</p>
<p style="position:absolute;top:791px;left:627px;white-space:nowrap" class="ft3847">k</p>
<p style="position:absolute;top:786px;left:634px;white-space:nowrap" class="ft388">,&#160;and</p>
<p style="position:absolute;top:803px;left:150px;white-space:nowrap" class="ft3848">(</p>
<p style="position:absolute;top:803px;left:156px;white-space:nowrap" class="ft3846">id</p>
<p style="position:absolute;top:809px;left:168px;white-space:nowrap" class="ft3847">k</p>
<p style="position:absolute;top:803px;left:176px;white-space:nowrap" class="ft3846">,&#160;type</p>
<p style="position:absolute;top:809px;left:210px;white-space:nowrap" class="ft3847">k</p>
<p style="position:absolute;top:803px;left:218px;white-space:nowrap" class="ft3846">,&#160;log</p>
<p style="position:absolute;top:809px;left:244px;white-space:nowrap" class="ft3847">k</p>
<p style="position:absolute;top:803px;left:251px;white-space:nowrap" class="ft3848">)</p>
<p style="position:absolute;top:803px;left:261px;white-space:nowrap" class="ft3850">∈&#160;T</p>
<p style="position:absolute;top:803px;left:287px;white-space:nowrap" class="ft3846">.</p>
<p style="position:absolute;top:822px;left:172px;white-space:nowrap" class="ft388">We&#160;now&#160;use&#160;our&#160;formal&#160;model&#160;to&#160;generalize&#160;TPM-based&#160;integrity&#160;protection&#160;and</p>
<p style="position:absolute;top:840px;left:150px;white-space:nowrap" class="ft388">verification.&#160;We&#160;also&#160;enhance&#160;our&#160;model&#160;by&#160;adding&#160;access&#160;control&#160;to&#160;the&#160;log&#160;contents.</p>
<p style="position:absolute;top:899px;left:150px;white-space:nowrap" class="ft3824"><b>5.2.1</b></p>
<p style="position:absolute;top:899px;left:204px;white-space:nowrap" class="ft3824"><b>Generalized&#160;Sealing&#160;to&#160;Protect&#160;Integrity</b></p>
<p style="position:absolute;top:929px;left:150px;white-space:nowrap" class="ft3814">A&#160;TPM-equipped&#160;system&#160;can&#160;<i>seal&#160;</i>a&#160;data&#160;item,&#160;i.e.,&#160;the&#160;system&#160;can&#160;encrypt&#160;the&#160;data&#160;item<br/>and&#160;bind&#160;it&#160;to&#160;the&#160;system&#160;configuration&#160;prevalent&#160;at&#160;the&#160;time&#160;of&#160;sealing.&#160;The&#160;system<br/>configuration&#160;is&#160;reflected&#160;by&#160;the&#160;contents&#160;of&#160;a&#160;specified&#160;subset&#160;of&#160;the&#160;TPM’s&#160;PCRs.&#160;The<br/>data&#160;item&#160;may&#160;be&#160;a&#160;key&#160;generated&#160;by&#160;the&#160;TPM&#160;itself&#160;or&#160;something&#160;generated&#160;outside&#160;the<br/>TPM.&#160;Decryption&#160;of&#160;the&#160;data&#160;item,&#160;called&#160;<i>unsealing</i>,&#160;is&#160;possible&#160;only&#160;when&#160;the&#160;system<br/>configuration&#160;(reflected&#160;by&#160;the&#160;contents&#160;of&#160;the&#160;same&#160;subset&#160;of&#160;PCRs)&#160;is&#160;the&#160;same&#160;as&#160;that<br/>at&#160;the&#160;time&#160;of&#160;sealing.</p>
<p style="position:absolute;top:1054px;left:172px;white-space:nowrap" class="ft388">We&#160;generalize&#160;sealing&#160;for&#160;protecting&#160;the&#160;integrity&#160;of&#160;a&#160;sensitive&#160;data&#160;item</p>
<p style="position:absolute;top:1053px;left:605px;white-space:nowrap" class="ft3846">d</p>
<p style="position:absolute;top:1054px;left:616px;white-space:nowrap" class="ft388">by&#160;mak-</p>
<p style="position:absolute;top:1072px;left:150px;white-space:nowrap" class="ft388">ing</p>
<p style="position:absolute;top:1071px;left:175px;white-space:nowrap" class="ft3846">d</p>
<p style="position:absolute;top:1072px;left:188px;white-space:nowrap" class="ft388">inaccessible&#160;to&#160;the&#160;system&#160;(or&#160;some&#160;component)&#160;unless&#160;specified&#160;integrity&#160;re-</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft3821">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 39 -->
<a name="39"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3990{font-size:7px;font-family:QVSPJU+CMMI5;color:#231f20;}
-->
</style>
<div id="page39-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5039.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft398">CHAPTER&#160;5.&#160;POLICY&#160;ENFORCEMENT&#160;AND&#160;COMPLIANCE</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft398">37</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft398">quirements&#160;are&#160;met.&#160;We&#160;use&#160;two&#160;operations,</p>
<p style="position:absolute;top:193px;left:498px;white-space:nowrap" class="ft3973">seal</p>
<p style="position:absolute;top:194px;left:525px;white-space:nowrap" class="ft398">and</p>
<p style="position:absolute;top:193px;left:551px;white-space:nowrap" class="ft3973">unseal</p>
<p style="position:absolute;top:194px;left:590px;white-space:nowrap" class="ft398">,&#160;to&#160;model&#160;the&#160;concept&#160;of</p>
<p style="position:absolute;top:212px;left:226px;white-space:nowrap" class="ft398">generalized&#160;sealing.&#160;Let</p>
<p style="position:absolute;top:211px;left:381px;white-space:nowrap" class="ft3950">T</p>
<p style="position:absolute;top:216px;left:389px;white-space:nowrap" class="ft3947">x</p>
<p style="position:absolute;top:212px;left:401px;white-space:nowrap" class="ft398">denote&#160;the&#160;log&#160;tree&#160;at&#160;time</p>
<p style="position:absolute;top:211px;left:570px;white-space:nowrap" class="ft3946">t</p>
<p style="position:absolute;top:216px;left:575px;white-space:nowrap" class="ft3947">x</p>
<p style="position:absolute;top:212px;left:582px;white-space:nowrap" class="ft398">.&#160;The</p>
<p style="position:absolute;top:211px;left:624px;white-space:nowrap" class="ft3973">seal</p>
<p style="position:absolute;top:212px;left:652px;white-space:nowrap" class="ft398">operation,&#160;per-</p>
<p style="position:absolute;top:230px;left:226px;white-space:nowrap" class="ft398">formed&#160;at&#160;time</p>
<p style="position:absolute;top:229px;left:321px;white-space:nowrap" class="ft3946">t</p>
<p style="position:absolute;top:234px;left:326px;white-space:nowrap" class="ft3947">s</p>
<p style="position:absolute;top:230px;left:332px;white-space:nowrap" class="ft398">,&#160;takes&#160;as&#160;input&#160;the&#160;data&#160;item</p>
<p style="position:absolute;top:229px;left:512px;white-space:nowrap" class="ft3946">d</p>
<p style="position:absolute;top:230px;left:520px;white-space:nowrap" class="ft398">,&#160;a&#160;projection&#160;function</p>
<p style="position:absolute;top:229px;left:660px;white-space:nowrap" class="ft3973">p</p>
<p style="position:absolute;top:229px;left:668px;white-space:nowrap" class="ft3948">()</p>
<p style="position:absolute;top:230px;left:679px;white-space:nowrap" class="ft398">,&#160;a&#160;sealing</p>
<p style="position:absolute;top:247px;left:226px;white-space:nowrap" class="ft398">predicate</p>
<p style="position:absolute;top:246px;left:285px;white-space:nowrap" class="ft3948">Π</p>
<p style="position:absolute;top:247px;left:297px;white-space:nowrap" class="ft398">,&#160;and&#160;the&#160;public&#160;part</p>
<p style="position:absolute;top:246px;left:424px;white-space:nowrap" class="ft3946">K</p>
<p style="position:absolute;top:252px;left:437px;white-space:nowrap" class="ft3947">p</p>
<p style="position:absolute;top:247px;left:449px;white-space:nowrap" class="ft398">of&#160;an&#160;encryption&#160;key</p>
<p style="position:absolute;top:246px;left:579px;white-space:nowrap" class="ft3946">K</p>
<p style="position:absolute;top:247px;left:593px;white-space:nowrap" class="ft398">.&#160;The&#160;operation&#160;logs</p>
<p style="position:absolute;top:247px;left:722px;white-space:nowrap" class="ft3973">p</p>
<p style="position:absolute;top:246px;left:730px;white-space:nowrap" class="ft3948">()</p>
<p style="position:absolute;top:265px;left:226px;white-space:nowrap" class="ft398">and</p>
<p style="position:absolute;top:264px;left:251px;white-space:nowrap" class="ft3948">Π</p>
<p style="position:absolute;top:265px;left:263px;white-space:nowrap" class="ft398">,&#160;and&#160;encrypts</p>
<p style="position:absolute;top:264px;left:350px;white-space:nowrap" class="ft3946">d</p>
<p style="position:absolute;top:265px;left:362px;white-space:nowrap" class="ft398">using</p>
<p style="position:absolute;top:264px;left:398px;white-space:nowrap" class="ft3946">K</p>
<p style="position:absolute;top:270px;left:411px;white-space:nowrap" class="ft3947">p</p>
<p style="position:absolute;top:265px;left:422px;white-space:nowrap" class="ft398">to&#160;produce&#160;the&#160;encrypted&#160;output</p>
<p style="position:absolute;top:264px;left:616px;white-space:nowrap" class="ft3946">e</p>
<p style="position:absolute;top:265px;left:623px;white-space:nowrap" class="ft398">.&#160;Thus,&#160;the&#160;contents</p>
<p style="position:absolute;top:283px;left:226px;white-space:nowrap" class="ft398">of</p>
<p style="position:absolute;top:282px;left:242px;white-space:nowrap" class="ft3950">T</p>
<p style="position:absolute;top:288px;left:251px;white-space:nowrap" class="ft3947">s</p>
<p style="position:absolute;top:283px;left:261px;white-space:nowrap" class="ft398">include</p>
<p style="position:absolute;top:283px;left:309px;white-space:nowrap" class="ft3973">p</p>
<p style="position:absolute;top:282px;left:317px;white-space:nowrap" class="ft3948">()</p>
<p style="position:absolute;top:283px;left:332px;white-space:nowrap" class="ft398">and</p>
<p style="position:absolute;top:282px;left:358px;white-space:nowrap" class="ft3948">Π</p>
<p style="position:absolute;top:283px;left:369px;white-space:nowrap" class="ft398">.&#160;The</p>
<p style="position:absolute;top:283px;left:406px;white-space:nowrap" class="ft3973">unseal</p>
<p style="position:absolute;top:283px;left:448px;white-space:nowrap" class="ft398">operation,&#160;performed&#160;at&#160;time</p>
<p style="position:absolute;top:282px;left:624px;white-space:nowrap" class="ft3946">t</p>
<p style="position:absolute;top:288px;left:630px;white-space:nowrap" class="ft3947">u</p>
<p style="position:absolute;top:283px;left:642px;white-space:nowrap" class="ft398">(where</p>
<p style="position:absolute;top:282px;left:687px;white-space:nowrap" class="ft3946">t</p>
<p style="position:absolute;top:288px;left:692px;white-space:nowrap" class="ft3947">u</p>
<p style="position:absolute;top:282px;left:705px;white-space:nowrap" class="ft3946">&gt;&#160;t</p>
<p style="position:absolute;top:288px;left:726px;white-space:nowrap" class="ft3947">s</p>
<p style="position:absolute;top:283px;left:733px;white-space:nowrap" class="ft398">),</p>
<p style="position:absolute;top:301px;left:226px;white-space:nowrap" class="ft398">takes&#160;as&#160;input</p>
<p style="position:absolute;top:300px;left:310px;white-space:nowrap" class="ft3946">e</p>
<p style="position:absolute;top:301px;left:320px;white-space:nowrap" class="ft398">and</p>
<p style="position:absolute;top:300px;left:345px;white-space:nowrap" class="ft3950">T</p>
<p style="position:absolute;top:306px;left:353px;white-space:nowrap" class="ft3947">u</p>
<p style="position:absolute;top:301px;left:361px;white-space:nowrap" class="ft398">,&#160;and&#160;outputs</p>
<p style="position:absolute;top:300px;left:440px;white-space:nowrap" class="ft3946">d</p>
<p style="position:absolute;top:301px;left:451px;white-space:nowrap" class="ft398">iff&#160;the&#160;condition</p>
<p style="position:absolute;top:300px;left:550px;white-space:nowrap" class="ft3948">Π(</p>
<p style="position:absolute;top:301px;left:567px;white-space:nowrap" class="ft3973">p</p>
<p style="position:absolute;top:300px;left:574px;white-space:nowrap" class="ft3948">(</p>
<p style="position:absolute;top:300px;left:580px;white-space:nowrap" class="ft3950">T</p>
<p style="position:absolute;top:306px;left:588px;white-space:nowrap" class="ft3947">u</p>
<p style="position:absolute;top:300px;left:596px;white-space:nowrap" class="ft3948">))</p>
<p style="position:absolute;top:301px;left:611px;white-space:nowrap" class="ft398">holds.&#160;In&#160;other&#160;words,</p>
<p style="position:absolute;top:319px;left:226px;white-space:nowrap" class="ft398">the&#160;private&#160;part&#160;of&#160;the&#160;key</p>
<p style="position:absolute;top:318px;left:386px;white-space:nowrap" class="ft3946">K</p>
<p style="position:absolute;top:319px;left:403px;white-space:nowrap" class="ft398">used&#160;for&#160;decrypting</p>
<p style="position:absolute;top:318px;left:525px;white-space:nowrap" class="ft3946">e</p>
<p style="position:absolute;top:319px;left:536px;white-space:nowrap" class="ft398">is&#160;revealed&#160;iff&#160;the&#160;condition&#160;holds.</p>
<p style="position:absolute;top:337px;left:226px;white-space:nowrap" class="ft398">Here,</p>
<p style="position:absolute;top:336px;left:263px;white-space:nowrap" class="ft3973">p</p>
<p style="position:absolute;top:336px;left:271px;white-space:nowrap" class="ft3948">()</p>
<p style="position:absolute;top:337px;left:287px;white-space:nowrap" class="ft398">and</p>
<p style="position:absolute;top:336px;left:312px;white-space:nowrap" class="ft3948">Π</p>
<p style="position:absolute;top:337px;left:328px;white-space:nowrap" class="ft398">are&#160;retrieved&#160;from&#160;the&#160;log.&#160;A&#160;simple&#160;sealing&#160;predicate&#160;may&#160;just&#160;com-</p>
<p style="position:absolute;top:355px;left:226px;white-space:nowrap" class="ft398">pare&#160;the&#160;result&#160;of</p>
<p style="position:absolute;top:354px;left:330px;white-space:nowrap" class="ft3973">p</p>
<p style="position:absolute;top:354px;left:337px;white-space:nowrap" class="ft3948">(</p>
<p style="position:absolute;top:354px;left:343px;white-space:nowrap" class="ft3950">T</p>
<p style="position:absolute;top:360px;left:351px;white-space:nowrap" class="ft3947">u</p>
<p style="position:absolute;top:354px;left:359px;white-space:nowrap" class="ft3948">)</p>
<p style="position:absolute;top:355px;left:368px;white-space:nowrap" class="ft398">with&#160;a&#160;reference&#160;value&#160;(e.g.,</p>
<p style="position:absolute;top:354px;left:537px;white-space:nowrap" class="ft3973">p</p>
<p style="position:absolute;top:354px;left:544px;white-space:nowrap" class="ft3948">(</p>
<p style="position:absolute;top:354px;left:550px;white-space:nowrap" class="ft3950">T</p>
<p style="position:absolute;top:360px;left:558px;white-space:nowrap" class="ft3947">s</p>
<p style="position:absolute;top:354px;left:565px;white-space:nowrap" class="ft3948">)</p>
<p style="position:absolute;top:355px;left:570px;white-space:nowrap" class="ft398">).&#160;A&#160;more&#160;complex&#160;predicate</p>
<p style="position:absolute;top:373px;left:226px;white-space:nowrap" class="ft398">may&#160;extract&#160;the&#160;high-level&#160;properties&#160;of&#160;the&#160;system&#160;from</p>
<p style="position:absolute;top:372px;left:563px;white-space:nowrap" class="ft3973">p</p>
<p style="position:absolute;top:372px;left:571px;white-space:nowrap" class="ft3948">(</p>
<p style="position:absolute;top:372px;left:576px;white-space:nowrap" class="ft3950">T</p>
<p style="position:absolute;top:378px;left:584px;white-space:nowrap" class="ft3947">u</p>
<p style="position:absolute;top:372px;left:592px;white-space:nowrap" class="ft3948">)</p>
<p style="position:absolute;top:373px;left:602px;white-space:nowrap" class="ft398">and&#160;compare&#160;them&#160;with</p>
<p style="position:absolute;top:391px;left:226px;white-space:nowrap" class="ft398">desired&#160;properties&#160;(similar&#160;to&#160;property-based&#160;attestation&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">[90,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">20,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">47]</a>).</p>
<p style="position:absolute;top:409px;left:248px;white-space:nowrap" class="ft398">One&#160;can&#160;easily&#160;see&#160;that&#160;our&#160;generalized&#160;sealing&#160;concept&#160;covers&#160;the&#160;special&#160;case&#160;of</p>
<p style="position:absolute;top:427px;left:226px;white-space:nowrap" class="ft398">TPM&#160;sealing.&#160;For&#160;TPM&#160;sealing,</p>
<p style="position:absolute;top:426px;left:424px;white-space:nowrap" class="ft3950">T</p>
<p style="position:absolute;top:432px;left:432px;white-space:nowrap" class="ft3947">u</p>
<p style="position:absolute;top:427px;left:444px;white-space:nowrap" class="ft398">consists&#160;of&#160;the&#160;values&#160;in&#160;the&#160;PCRs;&#160;the&#160;projection</p>
<p style="position:absolute;top:445px;left:226px;white-space:nowrap" class="ft398">function</p>
<p style="position:absolute;top:444px;left:280px;white-space:nowrap" class="ft3973">p</p>
<p style="position:absolute;top:444px;left:287px;white-space:nowrap" class="ft3948">()</p>
<p style="position:absolute;top:445px;left:302px;white-space:nowrap" class="ft398">specifies&#160;the&#160;subset&#160;of&#160;PCRs&#160;whose&#160;values&#160;are&#160;of&#160;interest&#160;for&#160;assessing&#160;the</p>
<p style="position:absolute;top:463px;left:226px;white-space:nowrap" class="ft398">system’s&#160;integrity;&#160;the&#160;sealing&#160;predicate</p>
<p style="position:absolute;top:462px;left:471px;white-space:nowrap" class="ft3948">Π</p>
<p style="position:absolute;top:463px;left:487px;white-space:nowrap" class="ft398">checks&#160;whether&#160;their&#160;values&#160;at&#160;the&#160;time&#160;of</p>
<p style="position:absolute;top:480px;left:226px;white-space:nowrap" class="ft398">unsealing&#160;are&#160;the&#160;same&#160;as&#160;at&#160;the&#160;time&#160;of&#160;sealing.</p>
<p style="position:absolute;top:539px;left:226px;white-space:nowrap" class="ft3924"><b>5.2.2</b></p>
<p style="position:absolute;top:539px;left:280px;white-space:nowrap" class="ft3924"><b>Generalized&#160;Attestation&#160;to&#160;Verify&#160;Integrity</b></p>
<p style="position:absolute;top:569px;left:226px;white-space:nowrap" class="ft3915">A&#160;TPM-equipped&#160;system&#160;can&#160;use&#160;the&#160;TPM&#160;to&#160;engage&#160;in&#160;a&#160;challenge-response&#160;style<br/>cryptographic&#160;protocol,&#160;called&#160;<i>attestation</i>,&#160;with&#160;a&#160;verifier.&#160;The&#160;protocol&#160;allows&#160;the&#160;ver-<br/>ifier&#160;to&#160;query&#160;and&#160;reliably&#160;obtain&#160;the&#160;measurement&#160;values&#160;for&#160;the&#160;system&#160;stored&#160;in&#160;the<br/>PCRs&#160;of&#160;the&#160;TPM.&#160;Reliable&#160;reporting&#160;of&#160;the&#160;measurement&#160;values&#160;is&#160;due&#160;to&#160;the&#160;signing<br/>of&#160;the&#160;values&#160;by&#160;the&#160;TPM,&#160;which&#160;is&#160;trusted&#160;by&#160;the&#160;verifier.&#160;Based&#160;on&#160;these&#160;values,&#160;the<br/>verifier&#160;can&#160;assesses&#160;the&#160;integrity&#160;state&#160;and&#160;the&#160;trustworthiness&#160;of&#160;the&#160;system.</p>
<p style="position:absolute;top:677px;left:248px;white-space:nowrap" class="ft398">We&#160;generalize&#160;attestation&#160;so&#160;that&#160;the&#160;verifier&#160;can&#160;specify&#160;which&#160;aspects&#160;of&#160;the&#160;sys-</p>
<p style="position:absolute;top:695px;left:226px;white-space:nowrap" class="ft398">tem’s&#160;integrity&#160;state&#160;are&#160;of&#160;interest&#160;to&#160;her.&#160;In&#160;our&#160;model,&#160;the&#160;attestation&#160;operation</p>
<p style="position:absolute;top:712px;left:226px;white-space:nowrap" class="ft3973">attest</p>
<p style="position:absolute;top:712px;left:262px;white-space:nowrap" class="ft3948">()</p>
<p style="position:absolute;top:713px;left:277px;white-space:nowrap" class="ft398">obtains&#160;as&#160;input&#160;a&#160;challenge</p>
<p style="position:absolute;top:712px;left:445px;white-space:nowrap" class="ft3946">c</p>
<p style="position:absolute;top:713px;left:451px;white-space:nowrap" class="ft398">,&#160;an&#160;attestation&#160;predicate</p>
<p style="position:absolute;top:712px;left:599px;white-space:nowrap" class="ft3948">Π</p>
<p style="position:absolute;top:713px;left:610px;white-space:nowrap" class="ft398">,&#160;a&#160;projection&#160;function</p>
<p style="position:absolute;top:730px;left:226px;white-space:nowrap" class="ft3973">p</p>
<p style="position:absolute;top:730px;left:234px;white-space:nowrap" class="ft3948">()</p>
<p style="position:absolute;top:731px;left:245px;white-space:nowrap" class="ft398">,&#160;and&#160;a&#160;secret&#160;key</p>
<p style="position:absolute;top:730px;left:352px;white-space:nowrap" class="ft3946">K</p>
<p style="position:absolute;top:736px;left:365px;white-space:nowrap" class="ft3947">s</p>
<p style="position:absolute;top:731px;left:371px;white-space:nowrap" class="ft398">.&#160;The&#160;operation&#160;outputs&#160;a&#160;signed&#160;message</p>
<p style="position:absolute;top:730px;left:622px;white-space:nowrap" class="ft3973">sign</p>
<p style="position:absolute;top:737px;left:646px;white-space:nowrap" class="ft3947">K</p>
<p style="position:absolute;top:741px;left:656px;white-space:nowrap" class="ft3990">s</p>
<p style="position:absolute;top:730px;left:663px;white-space:nowrap" class="ft3948">(</p>
<p style="position:absolute;top:730px;left:669px;white-space:nowrap" class="ft3973">f</p>
<p style="position:absolute;top:730px;left:674px;white-space:nowrap" class="ft3948">(</p>
<p style="position:absolute;top:730px;left:680px;white-space:nowrap" class="ft3973">p</p>
<p style="position:absolute;top:730px;left:688px;white-space:nowrap" class="ft3948">(</p>
<p style="position:absolute;top:730px;left:694px;white-space:nowrap" class="ft3950">T</p>
<p style="position:absolute;top:730px;left:706px;white-space:nowrap" class="ft3948">))</p>
<p style="position:absolute;top:730px;left:717px;white-space:nowrap" class="ft3946">,&#160;c</p>
<p style="position:absolute;top:730px;left:730px;white-space:nowrap" class="ft3948">)</p>
<p style="position:absolute;top:731px;left:736px;white-space:nowrap" class="ft398">.</p>
<p style="position:absolute;top:749px;left:248px;white-space:nowrap" class="ft398">Our&#160;attestation&#160;operation&#160;is&#160;a&#160;generalization&#160;of&#160;both&#160;binary&#160;and&#160;property-based&#160;at-</p>
<p style="position:absolute;top:766px;left:226px;white-space:nowrap" class="ft398">testation&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">[90,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">20,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">47]</a>.&#160;For&#160;binary&#160;attestation,&#160;the&#160;predicate</p>
<p style="position:absolute;top:765px;left:594px;white-space:nowrap" class="ft3948">Π</p>
<p style="position:absolute;top:766px;left:611px;white-space:nowrap" class="ft398">is&#160;simply&#160;the&#160;identity</p>
<p style="position:absolute;top:784px;left:226px;white-space:nowrap" class="ft398">function,&#160;i.e.,</p>
<p style="position:absolute;top:783px;left:312px;white-space:nowrap" class="ft3948">Π(</p>
<p style="position:absolute;top:783px;left:329px;white-space:nowrap" class="ft3946">x</p>
<p style="position:absolute;top:783px;left:338px;white-space:nowrap" class="ft3948">)&#160;=</p>
<p style="position:absolute;top:783px;left:369px;white-space:nowrap" class="ft3946">x</p>
<p style="position:absolute;top:784px;left:377px;white-space:nowrap" class="ft398">,&#160;and&#160;the&#160;result&#160;of&#160;attestation&#160;is&#160;simply&#160;the&#160;signature&#160;on&#160;the</p>
<p style="position:absolute;top:802px;left:226px;white-space:nowrap" class="ft3914">result&#160;of&#160;the&#160;projection&#160;function&#160;applied&#160;on&#160;the&#160;log&#160;tree.&#160;TPM&#160;attestation&#160;is&#160;a&#160;special<br/>case&#160;of&#160;binary&#160;attestation&#160;in&#160;which</p>
<p style="position:absolute;top:819px;left:442px;white-space:nowrap" class="ft3950">T</p>
<p style="position:absolute;top:820px;left:459px;white-space:nowrap" class="ft398">simply&#160;consists&#160;of&#160;the&#160;values&#160;in&#160;the&#160;PCRs&#160;and</p>
<p style="position:absolute;top:838px;left:226px;white-space:nowrap" class="ft398">the&#160;projection&#160;function</p>
<p style="position:absolute;top:838px;left:367px;white-space:nowrap" class="ft3973">p</p>
<p style="position:absolute;top:837px;left:375px;white-space:nowrap" class="ft3948">()</p>
<p style="position:absolute;top:838px;left:390px;white-space:nowrap" class="ft398">specifies&#160;a&#160;subset&#160;of&#160;PCRs.&#160;For&#160;property-based&#160;attestation,</p>
<p style="position:absolute;top:856px;left:226px;white-space:nowrap" class="ft398">the&#160;predicate</p>
<p style="position:absolute;top:855px;left:306px;white-space:nowrap" class="ft3948">Π</p>
<p style="position:absolute;top:856px;left:321px;white-space:nowrap" class="ft398">extracts&#160;high-level&#160;properties&#160;from&#160;the&#160;result&#160;of&#160;the&#160;projection&#160;function</p>
<p style="position:absolute;top:874px;left:226px;white-space:nowrap" class="ft398">applied&#160;on&#160;the&#160;log&#160;tree.</p>
<p style="position:absolute;top:892px;left:248px;white-space:nowrap" class="ft398">Whereas&#160;previous&#160;works&#160;such&#160;as&#160;the&#160;Integrity&#160;Measurement&#160;Architecture&#160;(IMA)&#160;of</p>
<p style="position:absolute;top:910px;left:226px;white-space:nowrap" class="ft3915">of&#160;Sailer&#160;<i>et&#160;al</i>.&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[104]&#160;</a>provide&#160;a&#160;good&#160;way&#160;of&#160;checking&#160;the&#160;hash&#160;of&#160;software&#160;binaries,<br/>our&#160;generalized&#160;attestation&#160;enables&#160;better&#160;assessment&#160;of&#160;the&#160;run-time&#160;behavior&#160;of&#160;the<br/>system.&#160;In&#160;this&#160;respect,&#160;our&#160;model&#160;has&#160;goals&#160;similar&#160;to&#160;those&#160;of&#160;Haldar&#160;<i>et&#160;al</i>.&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[47]</a>.&#160;How-<br/>ever,&#160;unlike&#160;Haldar&#160;<i>et&#160;al</i>.&#160;who&#160;focus&#160;on&#160;attesting&#160;the&#160;behavior&#160;of&#160;a&#160;software&#160;application,<br/>our&#160;model&#160;has&#160;a&#160;focus&#160;on&#160;VMs&#160;and&#160;virtual&#160;devices.&#160;For&#160;example,&#160;our&#160;attestation&#160;oper-<br/>ation&#160;enables&#160;a&#160;verifier&#160;to&#160;check&#160;the&#160;number&#160;and&#160;type&#160;of&#160;VMs&#160;running&#160;on&#160;the&#160;system.<br/>Because&#160;of&#160;their&#160;reliance&#160;on&#160;the&#160;Java&#160;virtual&#160;machine&#160;which&#160;runs&#160;on&#160;top&#160;of&#160;an&#160;operating<br/>system,&#160;their&#160;TCB&#160;includes&#160;the&#160;operating&#160;system.&#160;In&#160;contrast,&#160;our&#160;TCB&#160;includes&#160;only<br/>the&#160;VMM&#160;and&#160;underlying&#160;system&#160;layers,&#160;and&#160;is&#160;much&#160;smaller&#160;than&#160;theirs.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft3921">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 40 -->
<a name="40"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4091{font-size:11px;font-family:Helvetica;color:#000000;}
	.ft4092{font-size:11px;line-height:13px;font-family:Helvetica;color:#000000;}
	.ft4093{font-size:9px;line-height:10px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page40-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5040.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft408">38</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft4021">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:238px;left:351px;white-space:nowrap" class="ft4092">Central&#160;<br/>Integrity</p>
<p style="position:absolute;top:265px;left:348px;white-space:nowrap" class="ft4091">Manager</p>
<p style="position:absolute;top:207px;left:454px;white-space:nowrap" class="ft4044">Network&#160;</p>
<p style="position:absolute;top:216px;left:440px;white-space:nowrap" class="ft4044">Integrity&#160;Manager</p>
<p style="position:absolute;top:241px;left:459px;white-space:nowrap" class="ft4044">VMM&#160;</p>
<p style="position:absolute;top:250px;left:440px;white-space:nowrap" class="ft4044">Integrity&#160;Manager</p>
<p style="position:absolute;top:272px;left:455px;white-space:nowrap" class="ft4044">Devices&#160;</p>
<p style="position:absolute;top:282px;left:440px;white-space:nowrap" class="ft4044">Integrity&#160;Manager</p>
<p style="position:absolute;top:307px;left:456px;white-space:nowrap" class="ft4044">Storage</p>
<p style="position:absolute;top:316px;left:440px;white-space:nowrap" class="ft4044">Integrity&#160;Manager</p>
<p style="position:absolute;top:211px;left:257px;white-space:nowrap" class="ft4091">Attestation</p>
<p style="position:absolute;top:268px;left:266px;white-space:nowrap" class="ft4091">Sealing</p>
<p style="position:absolute;top:283px;left:261px;white-space:nowrap" class="ft4091">Unsealing</p>
<p style="position:absolute;top:194px;left:320px;white-space:nowrap" class="ft4091">TCB</p>
<p style="position:absolute;top:324px;left:354px;white-space:nowrap" class="ft4093">Predicate<br/>Evaluator</p>
<p style="position:absolute;top:386px;left:217px;white-space:nowrap" class="ft408">Figure&#160;5.4:&#160;Architecture&#160;for&#160;integrity&#160;protection&#160;and&#160;verification</p>
<p style="position:absolute;top:432px;left:150px;white-space:nowrap" class="ft4024"><b>5.2.3</b></p>
<p style="position:absolute;top:432px;left:204px;white-space:nowrap" class="ft4024"><b>Access&#160;Restriction</b></p>
<p style="position:absolute;top:462px;left:150px;white-space:nowrap" class="ft4056">The&#160;integrity&#160;of&#160;certain&#160;aspects&#160;of&#160;the&#160;system&#160;(such&#160;as&#160;the&#160;VMM)&#160;may&#160;be&#160;important&#160;to<br/>multiple&#160;users.&#160;Conversely,&#160;certain&#160;aspects&#160;of&#160;the&#160;system&#160;may&#160;be&#160;confidential&#160;to&#160;one<br/>or&#160;more&#160;users,&#160;e.g.,&#160;the&#160;state&#160;of&#160;a&#160;particular&#160;VM&#160;may&#160;be&#160;verified&#160;only&#160;by&#160;the&#160;users&#160;of<br/>that&#160;VM.&#160;Hence,&#160;it&#160;is&#160;important&#160;that&#160;attestation&#160;and&#160;sealing&#160;be&#160;applied&#160;not&#160;directly&#160;on<br/>the&#160;system&#160;state,&#160;but&#160;on&#160;appropriate&#160;projections&#160;of&#160;the&#160;state.&#160;Furthermore,&#160;if&#160;a&#160;state<br/>that&#160;is&#160;relevant&#160;for&#160;integrity&#160;verification&#160;contains&#160;information&#160;about&#160;multiple&#160;users,&#160;it<br/>should&#160;be&#160;possible&#160;to&#160;prove&#160;integrity&#160;without&#160;revealing&#160;the&#160;actual&#160;state.&#160;We&#160;formalize<br/>such&#160;requirements&#160;using&#160;two&#160;concepts:&#160;<i>access&#160;restriction&#160;specification&#160;</i>and&#160;<i>projection<br/>assessment&#160;function</i>.</p>
<p style="position:absolute;top:623px;left:172px;white-space:nowrap" class="ft408">Given&#160;a&#160;set&#160;of&#160;users</p>
<p style="position:absolute;top:622px;left:303px;white-space:nowrap" class="ft4046">U</p>
<p style="position:absolute;top:623px;left:320px;white-space:nowrap" class="ft408">and&#160;a&#160;log&#160;tree</p>
<p style="position:absolute;top:622px;left:412px;white-space:nowrap" class="ft4050">T</p>
<p style="position:absolute;top:623px;left:424px;white-space:nowrap" class="ft408">,&#160;an&#160;access&#160;restriction&#160;is&#160;specified&#160;by&#160;a</p>
<p style="position:absolute;top:641px;left:150px;white-space:nowrap" class="ft408">function</p>
<p style="position:absolute;top:641px;left:205px;white-space:nowrap" class="ft4073">r</p>
<p style="position:absolute;top:640px;left:211px;white-space:nowrap" class="ft4048">()</p>
<p style="position:absolute;top:641px;left:228px;white-space:nowrap" class="ft408">that&#160;assigns&#160;a&#160;subset&#160;of</p>
<p style="position:absolute;top:640px;left:379px;white-space:nowrap" class="ft4046">U</p>
<p style="position:absolute;top:641px;left:397px;white-space:nowrap" class="ft408">to&#160;each&#160;vector&#160;element&#160;in&#160;each&#160;node&#160;of&#160;the</p>
<p style="position:absolute;top:659px;left:150px;white-space:nowrap" class="ft4015">tree.&#160;The&#160;subset&#160;assigned&#160;to&#160;a&#160;given&#160;vector&#160;element&#160;in&#160;a&#160;given&#160;node&#160;is&#160;called&#160;the&#160;<i>access<br/>control&#160;list&#160;</i>(ACL)&#160;for&#160;that&#160;element.&#160;Despite&#160;the&#160;potentially&#160;large&#160;number&#160;of&#160;nodes&#160;in&#160;the<br/>log&#160;tree,&#160;ACLs&#160;can&#160;be&#160;efficiently&#160;implemented&#160;by&#160;attaching&#160;ACLs&#160;only&#160;to&#160;some&#160;nodes<br/>and&#160;vector&#160;elements.&#160;ACLs&#160;of&#160;children&#160;nodes&#160;may&#160;be&#160;derived&#160;through&#160;inheritance&#160;of<br/>the&#160;parent&#160;node’s&#160;ACL.&#160;Scoping&#160;rules&#160;may&#160;be&#160;used&#160;to&#160;apply&#160;an&#160;ACL&#160;to&#160;multiple&#160;vector<br/>elements&#160;of&#160;a&#160;given&#160;node.</p>
<p style="position:absolute;top:766px;left:172px;white-space:nowrap" class="ft408">A&#160;projection&#160;assessment&#160;function&#160;can&#160;determine&#160;whether&#160;a&#160;given&#160;projection&#160;con-</p>
<p style="position:absolute;top:784px;left:150px;white-space:nowrap" class="ft408">forms&#160;to&#160;or&#160;violates&#160;access&#160;restrictions.&#160;A&#160;projection</p>
<p style="position:absolute;top:784px;left:477px;white-space:nowrap" class="ft4073">p</p>
<p style="position:absolute;top:783px;left:485px;white-space:nowrap" class="ft4048">(</p>
<p style="position:absolute;top:783px;left:490px;white-space:nowrap" class="ft4050">T</p>
<p style="position:absolute;top:783px;left:502px;white-space:nowrap" class="ft4048">)</p>
<p style="position:absolute;top:784px;left:513px;white-space:nowrap" class="ft408">applied&#160;by&#160;a&#160;user</p>
<p style="position:absolute;top:783px;left:623px;white-space:nowrap" class="ft4046">u</p>
<p style="position:absolute;top:783px;left:637px;white-space:nowrap" class="ft4050">∈</p>
<p style="position:absolute;top:783px;left:654px;white-space:nowrap" class="ft4046">U</p>
<p style="position:absolute;top:802px;left:150px;white-space:nowrap" class="ft408">conforms&#160;to&#160;the&#160;access&#160;restriction&#160;specification</p>
<p style="position:absolute;top:802px;left:440px;white-space:nowrap" class="ft4073">r</p>
<p style="position:absolute;top:801px;left:445px;white-space:nowrap" class="ft4048">()</p>
<p style="position:absolute;top:802px;left:462px;white-space:nowrap" class="ft408">if&#160;the&#160;output&#160;only&#160;contains&#160;vector</p>
<p style="position:absolute;top:820px;left:150px;white-space:nowrap" class="ft408">elements&#160;in&#160;which</p>
<p style="position:absolute;top:819px;left:261px;white-space:nowrap" class="ft4046">u</p>
<p style="position:absolute;top:820px;left:273px;white-space:nowrap" class="ft408">was&#160;contained&#160;in&#160;the&#160;ACL.&#160;Any&#160;predicate</p>
<p style="position:absolute;top:819px;left:521px;white-space:nowrap" class="ft4048">Π</p>
<p style="position:absolute;top:820px;left:536px;white-space:nowrap" class="ft408">for&#160;attestation&#160;or&#160;seal-</p>
<p style="position:absolute;top:838px;left:150px;white-space:nowrap" class="ft4014">ing&#160;can&#160;be&#160;applied&#160;on&#160;such&#160;a&#160;projection&#160;without&#160;violating&#160;the&#160;access&#160;restrictions.&#160;If&#160;the<br/>projection&#160;does&#160;not&#160;conform&#160;to</p>
<p style="position:absolute;top:856px;left:337px;white-space:nowrap" class="ft4073">r</p>
<p style="position:absolute;top:855px;left:342px;white-space:nowrap" class="ft4048">()</p>
<p style="position:absolute;top:856px;left:353px;white-space:nowrap" class="ft408">,&#160;then&#160;prior&#160;to&#160;applying&#160;the&#160;predicate,&#160;an&#160;<i>access&#160;filter</i></p>
<p style="position:absolute;top:874px;left:150px;white-space:nowrap" class="ft408">is&#160;used&#160;to&#160;hide&#160;those&#160;parts&#160;of</p>
<p style="position:absolute;top:874px;left:324px;white-space:nowrap" class="ft4073">p</p>
<p style="position:absolute;top:873px;left:332px;white-space:nowrap" class="ft4048">(</p>
<p style="position:absolute;top:873px;left:337px;white-space:nowrap" class="ft4050">T</p>
<p style="position:absolute;top:873px;left:349px;white-space:nowrap" class="ft4048">)</p>
<p style="position:absolute;top:874px;left:359px;white-space:nowrap" class="ft408">that</p>
<p style="position:absolute;top:873px;left:385px;white-space:nowrap" class="ft4046">u</p>
<p style="position:absolute;top:874px;left:397px;white-space:nowrap" class="ft408">is&#160;not&#160;authorized&#160;to&#160;see.</p>
<p style="position:absolute;top:938px;left:150px;white-space:nowrap" class="ft4026"><b>5.3</b></p>
<p style="position:absolute;top:938px;left:198px;white-space:nowrap" class="ft4026"><b>The&#160;PEV&#160;Integrity&#160;Architecture</b></p>
<p style="position:absolute;top:976px;left:150px;white-space:nowrap" class="ft4015">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#40">5.4&#160;</a>shows&#160;the&#160;PEV&#160;architecture&#160;for&#160;protecting,&#160;enforcing,&#160;and&#160;verifying&#160;the<br/>integrity&#160;of&#160;VMs&#160;and&#160;virtual&#160;devices.&#160;There&#160;is&#160;a&#160;<i>central&#160;integrity&#160;manager&#160;</i>and&#160;<i>compo-<br/>nent&#160;integrity&#160;managers&#160;</i>that&#160;are&#160;associated&#160;with&#160;individual&#160;system&#160;components&#160;such&#160;as<br/>storage,&#160;VMM,&#160;networking,&#160;and&#160;other&#160;devices.&#160;Each&#160;component&#160;integrity&#160;manager&#160;is<br/>responsible&#160;for&#160;the&#160;part&#160;of&#160;the&#160;log&#160;tree&#160;corresponding&#160;to&#160;the&#160;component.&#160;For&#160;example,<br/>the&#160;storage&#160;integrity&#160;manager&#160;is&#160;responsible&#160;for&#160;maintaining&#160;the&#160;storage&#160;sub-tree&#160;of&#160;the</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft4021">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 41 -->
<a name="41"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page41-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5041.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft418">CHAPTER&#160;5.&#160;POLICY&#160;ENFORCEMENT&#160;AND&#160;COMPLIANCE</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft418">39</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft418">system&#160;log&#160;tree</p>
<p style="position:absolute;top:193px;left:321px;white-space:nowrap" class="ft4150">T</p>
<p style="position:absolute;top:194px;left:333px;white-space:nowrap" class="ft418">.&#160;Hereafter,&#160;we&#160;refer&#160;to&#160;the&#160;central&#160;integrity&#160;manager&#160;as&#160;<i>the&#160;</i>Integrity</p>
<p style="position:absolute;top:212px;left:226px;white-space:nowrap" class="ft418">Manager.</p>
<p style="position:absolute;top:230px;left:248px;white-space:nowrap" class="ft418">The&#160;Integrity&#160;Manager&#160;has&#160;a&#160;<i>master&#160;plug-in&#160;module&#160;</i>for&#160;each&#160;log&#160;projection&#160;func-</p>
<p style="position:absolute;top:247px;left:226px;white-space:nowrap" class="ft4114">tion&#160;that&#160;needs&#160;to&#160;be&#160;implemented.&#160;The&#160;module&#160;obtains&#160;state&#160;information&#160;about&#160;various<br/>aspects&#160;of&#160;the&#160;system&#160;that&#160;may&#160;be&#160;of&#160;interest&#160;to&#160;a&#160;potential&#160;verifier&#160;or&#160;user&#160;by&#160;invoking<br/>the&#160;appropriate&#160;<i>component&#160;plug-in&#160;modules&#160;</i>and&#160;aggregating&#160;their&#160;outputs.&#160;A&#160;compo-<br/>nent&#160;plug-in&#160;module&#160;is&#160;part&#160;of&#160;the&#160;component&#160;integrity&#160;manager&#160;and&#160;reveals&#160;particular<br/>aspects&#160;of&#160;the&#160;component’s&#160;integrity&#160;that&#160;are&#160;relevant&#160;for&#160;the&#160;projection&#160;function.</p>
<p style="position:absolute;top:337px;left:248px;white-space:nowrap" class="ft418">In&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#40">5.4,&#160;</a>the&#160;various&#160;master&#160;plug-in&#160;modules&#160;are&#160;attached&#160;to&#160;the&#160;Integrity&#160;Man-</p>
<p style="position:absolute;top:355px;left:226px;white-space:nowrap" class="ft4115">ager&#160;are&#160;shown&#160;using&#160;different&#160;geometrical&#160;shapes&#160;(ovals,&#160;hexagons,&#160;triangles,&#160;and<br/>rectangles).&#160;For&#160;example,&#160;the&#160;triangular&#160;plug-in&#160;module&#160;measures&#160;certain&#160;aspects&#160;of<br/>system&#160;storage&#160;and&#160;the&#160;VMM,&#160;as&#160;indicated&#160;by&#160;the&#160;presence&#160;of&#160;triangular&#160;component<br/>plug-in&#160;modules&#160;in&#160;the&#160;Storage&#160;Integrity&#160;Manager&#160;and&#160;VMM&#160;Integrity&#160;Manager.&#160;On<br/>the&#160;other&#160;hand,&#160;the&#160;hexagonal&#160;plug-in&#160;module&#160;measures&#160;only&#160;certain&#160;aspects&#160;of&#160;sys-<br/>tem&#160;devices.&#160;Each&#160;plug-in&#160;module&#160;has&#160;a&#160;unique&#160;identifier.&#160;The&#160;mapping&#160;between&#160;each<br/>plug-in&#160;identifier&#160;and&#160;the&#160;functionality&#160;provided&#160;by&#160;the&#160;corresponding&#160;plug-in&#160;module<br/>is&#160;made&#160;publicly&#160;available&#160;(e.g.,&#160;through&#160;a&#160;naming&#160;service&#160;or&#160;a&#160;published&#160;table).</p>
<p style="position:absolute;top:539px;left:226px;white-space:nowrap" class="ft4124"><b>5.3.1</b></p>
<p style="position:absolute;top:539px;left:280px;white-space:nowrap" class="ft4124"><b>Sealing/Unsealing&#160;Protocol</b></p>
<p style="position:absolute;top:569px;left:226px;white-space:nowrap" class="ft418">At&#160;the&#160;time&#160;of&#160;sealing,&#160;the&#160;user&#160;provides&#160;the&#160;following&#160;inputs:</p>
<p style="position:absolute;top:599px;left:226px;white-space:nowrap" class="ft4123"><b>Data&#160;</b>The&#160;data&#160;item&#160;to&#160;be&#160;encrypted&#160;during&#160;sealing&#160;and&#160;to&#160;be&#160;revealed&#160;later&#160;only&#160;if</p>
<p style="position:absolute;top:617px;left:263px;white-space:nowrap" class="ft418">certain&#160;conditions&#160;are&#160;met.</p>
<p style="position:absolute;top:647px;left:226px;white-space:nowrap" class="ft4123"><b>Key&#160;</b>The&#160;sealing&#160;key&#160;whose&#160;public&#160;part&#160;is&#160;used&#160;for&#160;encrypting&#160;the&#160;data&#160;at&#160;the&#160;time&#160;of</p>
<p style="position:absolute;top:665px;left:263px;white-space:nowrap" class="ft4115">sealing,&#160;and&#160;whose&#160;private&#160;part&#160;is&#160;revealed&#160;only&#160;if&#160;the&#160;unseal&#160;operation&#160;completes<br/>successfully.</p>
<p style="position:absolute;top:713px;left:226px;white-space:nowrap" class="ft4123"><b>Identifier(s)&#160;of&#160;Plug-in&#160;Module(s)&#160;</b>By&#160;listing&#160;the&#160;identifiers&#160;of&#160;plug-in&#160;modules,&#160;a&#160;user</p>
<p style="position:absolute;top:731px;left:263px;white-space:nowrap" class="ft4115">can&#160;choose&#160;what&#160;aspects&#160;of&#160;the&#160;system’s&#160;integrity&#160;state&#160;are&#160;to&#160;be&#160;checked&#160;prior&#160;to<br/>revealing&#160;the&#160;private&#160;part&#160;of&#160;the&#160;sealing&#160;key.</p>
<p style="position:absolute;top:779px;left:226px;white-space:nowrap" class="ft4123"><b>Predicate&#160;</b>The&#160;predicate&#160;specifies&#160;user-defined&#160;conditions&#160;that&#160;the&#160;system’s&#160;integrity</p>
<p style="position:absolute;top:796px;left:263px;white-space:nowrap" class="ft4114">state&#160;must&#160;satisfy&#160;at&#160;the&#160;time&#160;of&#160;unsealing&#160;in&#160;order&#160;for&#160;the&#160;private&#160;part&#160;of&#160;the<br/>sealing&#160;key&#160;to&#160;be&#160;revealed.</p>
<p style="position:absolute;top:844px;left:248px;white-space:nowrap" class="ft418">Our&#160;sealing&#160;protocol&#160;requires&#160;the&#160;log&#160;projection&#160;functions&#160;(described&#160;in&#160;Sec-</p>
<p style="position:absolute;top:862px;left:226px;white-space:nowrap" class="ft4114">tion&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#38">5.2.1)&#160;</a>to&#160;be&#160;implemented&#160;as&#160;plug-in&#160;modules&#160;as&#160;part&#160;of&#160;the&#160;TCB.&#160;The&#160;key&#160;used<br/>for&#160;encrypting&#160;the&#160;sensitive&#160;data&#160;item&#160;is&#160;sealed&#160;away&#160;against&#160;the&#160;state&#160;of&#160;the&#160;TCB&#160;and<br/>a&#160;hash&#160;of&#160;the&#160;user-specified&#160;projection&#160;functions&#160;and&#160;sealing&#160;predicates.&#160;The&#160;Integrity<br/>Manager&#160;stores&#160;the&#160;state&#160;of&#160;the&#160;TCB&#160;in&#160;PCRs&#160;that&#160;cannot&#160;be&#160;reset&#160;and&#160;the&#160;hash&#160;in&#160;a<br/>resettable&#160;PCR&#160;(say</p>
<p style="position:absolute;top:933px;left:350px;white-space:nowrap" class="ft4146">P&#160;CR</p>
<p style="position:absolute;top:939px;left:385px;white-space:nowrap" class="ft4147">i</p>
<p style="position:absolute;top:934px;left:390px;white-space:nowrap" class="ft418">).&#160;This&#160;ensures&#160;that&#160;the&#160;TCB&#160;is&#160;aware&#160;of&#160;the&#160;conditions&#160;to</p>
<p style="position:absolute;top:952px;left:226px;white-space:nowrap" class="ft4115">be&#160;satisfied&#160;before&#160;the&#160;key&#160;can&#160;be&#160;revealed&#160;to&#160;the&#160;user.&#160;To&#160;perform&#160;the&#160;unseal&#160;operation,<br/>the&#160;TCB&#160;has&#160;to&#160;ensure&#160;that</p>
<p style="position:absolute;top:969px;left:393px;white-space:nowrap" class="ft4146">P&#160;CR</p>
<p style="position:absolute;top:975px;left:428px;white-space:nowrap" class="ft4147">i</p>
<p style="position:absolute;top:970px;left:437px;white-space:nowrap" class="ft418">still&#160;contains&#160;the&#160;hash&#160;of&#160;the&#160;user-specified&#160;projec-</p>
<p style="position:absolute;top:988px;left:226px;white-space:nowrap" class="ft4115">tion&#160;function&#160;and&#160;sealing&#160;predicates.&#160;Then,&#160;the&#160;unseal&#160;operation&#160;reveals&#160;the&#160;key&#160;to&#160;the<br/>Integrity&#160;Manager.&#160;The&#160;Integrity&#160;Manager&#160;then&#160;invokes&#160;the&#160;<i>predicate&#160;evaluator&#160;</i>module<br/>(Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#40">5.4)&#160;</a>to&#160;check&#160;whether&#160;the&#160;sealing&#160;predicates&#160;(evaluated&#160;on&#160;the&#160;output&#160;of&#160;the&#160;log<br/>projection&#160;function)&#160;are&#160;indeed&#160;satisfied.&#160;If&#160;that&#160;is&#160;the&#160;case,&#160;then&#160;the&#160;Integrity&#160;Manager<br/>reveals&#160;the&#160;key&#160;to&#160;the&#160;user.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft4121">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 42 -->
<a name="42"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4294{font-size:8px;font-family:Times;color:#000000;}
	.ft4295{font-size:5px;font-family:Times;color:#000000;}
	.ft4296{font-size:8px;font-family:Times;color:#ffffff;}
	.ft4297{font-size:5px;font-family:Times;color:#ffffff;}
	.ft4298{font-size:7px;font-family:ACHYIG+TT2193o00;color:#000000;}
	.ft4299{font-size:7px;font-family:KPSHBO+TT2194o00;color:#000000;}
-->
</style>
<div id="page42-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5042.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft428">40</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft4221">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:201px;left:311px;white-space:nowrap" class="ft4294"><b>N</b></p>
<p style="position:absolute;top:221px;left:287px;white-space:nowrap" class="ft4294"><b>N</b></p>
<p style="position:absolute;top:225px;left:293px;white-space:nowrap" class="ft4295"><b>1</b></p>
<p style="position:absolute;top:221px;left:330px;white-space:nowrap" class="ft4294"><b>N</b></p>
<p style="position:absolute;top:225px;left:335px;white-space:nowrap" class="ft4295"><b>2</b></p>
<p style="position:absolute;top:243px;left:268px;white-space:nowrap" class="ft4294"><b>N</b></p>
<p style="position:absolute;top:247px;left:274px;white-space:nowrap" class="ft4295"><b>11</b></p>
<p style="position:absolute;top:243px;left:306px;white-space:nowrap" class="ft4294"><b>N</b></p>
<p style="position:absolute;top:247px;left:312px;white-space:nowrap" class="ft4295"><b>12</b></p>
<p style="position:absolute;top:241px;left:440px;white-space:nowrap" class="ft4294"><b>N’</b></p>
<p style="position:absolute;top:261px;left:417px;white-space:nowrap" class="ft4294"><b>N’</b></p>
<p style="position:absolute;top:265px;left:425px;white-space:nowrap" class="ft4295"><b>1</b></p>
<p style="position:absolute;top:261px;left:459px;white-space:nowrap" class="ft4294"><b>N’</b></p>
<p style="position:absolute;top:265px;left:467px;white-space:nowrap" class="ft4295"><b>2</b></p>
<p style="position:absolute;top:284px;left:397px;white-space:nowrap" class="ft4294"><b>N’</b></p>
<p style="position:absolute;top:287px;left:406px;white-space:nowrap" class="ft4295"><b>11</b></p>
<p style="position:absolute;top:284px;left:435px;white-space:nowrap" class="ft4294"><b>N’</b></p>
<p style="position:absolute;top:287px;left:444px;white-space:nowrap" class="ft4295"><b>12</b></p>
<p style="position:absolute;top:284px;left:313px;white-space:nowrap" class="ft4296"><b>R</b></p>
<p style="position:absolute;top:304px;left:289px;white-space:nowrap" class="ft4296"><b>R</b></p>
<p style="position:absolute;top:308px;left:295px;white-space:nowrap" class="ft4297"><b>1</b></p>
<p style="position:absolute;top:304px;left:332px;white-space:nowrap" class="ft4296"><b>R</b></p>
<p style="position:absolute;top:308px;left:337px;white-space:nowrap" class="ft4297"><b>2</b></p>
<p style="position:absolute;top:326px;left:270px;white-space:nowrap" class="ft4296"><b>R</b></p>
<p style="position:absolute;top:330px;left:276px;white-space:nowrap" class="ft4297"><b>11</b></p>
<p style="position:absolute;top:326px;left:308px;white-space:nowrap" class="ft4296"><b>R</b></p>
<p style="position:absolute;top:330px;left:314px;white-space:nowrap" class="ft4297"><b>12</b></p>
<p style="position:absolute;top:187px;left:311px;white-space:nowrap" class="ft4298">TT</p>
<p style="position:absolute;top:270px;left:312px;white-space:nowrap" class="ft4298">R</p>
<p style="position:absolute;top:270px;left:312px;white-space:nowrap" class="ft4298">R</p>
<p style="position:absolute;top:223px;left:442px;white-space:nowrap" class="ft4299">¯</p>
<p style="position:absolute;top:224px;left:440px;white-space:nowrap" class="ft4298">T</p>
<p style="position:absolute;top:223px;left:442px;white-space:nowrap" class="ft4299">¯</p>
<p style="position:absolute;top:224px;left:440px;white-space:nowrap" class="ft4298">T</p>
<p style="position:absolute;top:252px;left:375px;white-space:nowrap" class="ft4298">T&#160;⊗&#160;R</p>
<p style="position:absolute;top:252px;left:375px;white-space:nowrap" class="ft4298">T&#160;⊗&#160;R</p>
<p style="position:absolute;top:373px;left:239px;white-space:nowrap" class="ft428">Figure&#160;5.5:&#160;Enforcing&#160;access&#160;restrictions&#160;on&#160;system&#160;state</p>
<p style="position:absolute;top:421px;left:172px;white-space:nowrap" class="ft428">The&#160;flexibility&#160;of&#160;our&#160;sealing&#160;protocol&#160;is&#160;due&#160;to&#160;the&#160;fact&#160;that&#160;arbitrarily&#160;complex</p>
<p style="position:absolute;top:439px;left:150px;white-space:nowrap" class="ft4215">conditions&#160;to&#160;reveal&#160;the&#160;sealed&#160;key&#160;can&#160;be&#160;coded&#160;as&#160;plug-in&#160;modules.&#160;The&#160;extensibility<br/>arises&#160;from&#160;the&#160;fact&#160;that&#160;new&#160;plug-in&#160;modules&#160;covering&#160;the&#160;integrity&#160;state&#160;of&#160;newly<br/>added&#160;VMs&#160;or&#160;virtual&#160;devices&#160;can&#160;be&#160;easily&#160;added&#160;to&#160;the&#160;TCB.</p>
<p style="position:absolute;top:533px;left:150px;white-space:nowrap" class="ft4224"><b>5.3.2</b></p>
<p style="position:absolute;top:533px;left:204px;white-space:nowrap" class="ft4224"><b>Attestation&#160;Protocol</b></p>
<p style="position:absolute;top:563px;left:150px;white-space:nowrap" class="ft4214">The&#160;verifier&#160;initiating&#160;the&#160;attestation&#160;protocol&#160;provides&#160;as&#160;input&#160;a&#160;challenge&#160;(to&#160;ensure<br/>freshness)&#160;and&#160;the&#160;identifier(s)&#160;of&#160;plug-in&#160;module(s)&#160;that&#160;are&#160;relevant&#160;to&#160;evaluating&#160;sys-<br/>tem&#160;compliance&#160;with&#160;the&#160;verifier’s&#160;integrity&#160;requirements.&#160;The&#160;flexibility&#160;of&#160;our&#160;attes-<br/>tation&#160;protocol&#160;relies&#160;on&#160;the&#160;verifier&#160;being&#160;able&#160;to&#160;attest&#160;the&#160;TCB&#160;and&#160;requires&#160;the&#160;log<br/>projection&#160;functions&#160;(described&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#38">5.2.1)&#160;</a>to&#160;be&#160;implemented&#160;as&#160;plug-in&#160;modules<br/>as&#160;part&#160;of&#160;the&#160;TCB.&#160;The&#160;extensibility&#160;of&#160;our&#160;attestation&#160;protocols&#160;relies&#160;on&#160;the&#160;ability&#160;to<br/>add&#160;new&#160;plug-in&#160;modules&#160;for&#160;new&#160;aspects&#160;of&#160;the&#160;system’s&#160;integrity&#160;state&#160;that&#160;the&#160;verifier<br/>may&#160;be&#160;interested&#160;in.</p>
<p style="position:absolute;top:748px;left:150px;white-space:nowrap" class="ft4224"><b>5.3.3</b></p>
<p style="position:absolute;top:748px;left:204px;white-space:nowrap" class="ft4224"><b>A&#160;Blinding&#160;Technique&#160;For&#160;Enforcing&#160;Access&#160;Restrictions</b></p>
<p style="position:absolute;top:778px;left:150px;white-space:nowrap" class="ft4214">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#42">5.5&#160;</a>shows&#160;a&#160;simple&#160;<i>blinding&#160;</i>technique&#160;that&#160;uses&#160;a&#160;<i>commitment&#160;scheme&#160;</i>to&#160;enforce<br/>access&#160;restrictions&#160;on&#160;the&#160;log&#160;tree.&#160;Cryptographic&#160;commitment&#160;schemes&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[44]&#160;</a>generally<br/>consist&#160;of&#160;two&#160;phases.&#160;The&#160;first&#160;phase,&#160;called&#160;<i>commit&#160;phase</i>,&#160;is&#160;used&#160;to&#160;make&#160;a&#160;party<br/><i>commit&#160;</i>to&#160;a&#160;particular&#160;value&#160;while&#160;hiding&#160;that&#160;value&#160;from&#160;another&#160;party.&#160;It&#160;is&#160;only&#160;in&#160;the<br/>second&#160;phase,&#160;called&#160;<i>reveal&#160;phase</i>,&#160;that&#160;the&#160;value&#160;is&#160;<i>revealed&#160;</i>to&#160;the&#160;second&#160;party.&#160;Any<br/>commitment&#160;scheme&#160;guarantees&#160;that&#160;(a)&#160;the&#160;committed&#160;value&#160;cannot&#160;be&#160;obtained&#160;by&#160;the<br/>second&#160;party&#160;before&#160;the&#160;reveal&#160;phase,&#160;and&#160;(b)&#160;the&#160;second&#160;party&#160;can&#160;detect&#160;whether&#160;the<br/>value&#160;revealed&#160;is&#160;indeed&#160;the&#160;same&#160;value&#160;that&#160;was&#160;committed&#160;to&#160;in&#160;the&#160;first&#160;phase.</p>
<p style="position:absolute;top:921px;left:172px;white-space:nowrap" class="ft428">For&#160;simplicity,&#160;we&#160;consider&#160;blinding&#160;at&#160;the&#160;granularity&#160;of&#160;log&#160;tree&#160;nodes&#160;instead&#160;of</p>
<p style="position:absolute;top:939px;left:150px;white-space:nowrap" class="ft4214">at&#160;the&#160;granularity&#160;of&#160;log&#160;vector&#160;elements&#160;in&#160;the&#160;tree&#160;nodes,&#160;i.e.,&#160;the&#160;access&#160;restriction<br/>specification</p>
<p style="position:absolute;top:956px;left:230px;white-space:nowrap" class="ft4273">r</p>
<p style="position:absolute;top:956px;left:235px;white-space:nowrap" class="ft4248">()</p>
<p style="position:absolute;top:957px;left:252px;white-space:nowrap" class="ft428">assigns&#160;a&#160;subset&#160;of</p>
<p style="position:absolute;top:956px;left:371px;white-space:nowrap" class="ft4246">U</p>
<p style="position:absolute;top:957px;left:387px;white-space:nowrap" class="ft428">to&#160;each&#160;node&#160;of&#160;the&#160;tree.&#160;A&#160;<i>random&#160;</i>tree</p>
<p style="position:absolute;top:956px;left:638px;white-space:nowrap" class="ft4250">R</p>
<p style="position:absolute;top:957px;left:655px;white-space:nowrap" class="ft428">is</p>
<p style="position:absolute;top:975px;left:150px;white-space:nowrap" class="ft428">bound&#160;to&#160;the&#160;original&#160;log&#160;tree</p>
<p style="position:absolute;top:974px;left:336px;white-space:nowrap" class="ft4250">T</p>
<p style="position:absolute;top:975px;left:353px;white-space:nowrap" class="ft428">through&#160;a&#160;<i>multi-bit&#160;commitment&#160;scheme&#160;</i>to&#160;give&#160;the</p>
<p style="position:absolute;top:993px;left:150px;white-space:nowrap" class="ft428">blinded&#160;log&#160;tree</p>
<p style="position:absolute;top:988px;left:249px;white-space:nowrap" class="ft4248">¯</p>
<p style="position:absolute;top:992px;left:246px;white-space:nowrap" class="ft4250">T</p>
<p style="position:absolute;top:993px;left:258px;white-space:nowrap" class="ft428">.</p>
<p style="position:absolute;top:992px;left:266px;white-space:nowrap" class="ft4250">R</p>
<p style="position:absolute;top:993px;left:282px;white-space:nowrap" class="ft428">is&#160;a&#160;tree&#160;that&#160;has&#160;the&#160;same&#160;structure&#160;as&#160;that&#160;of</p>
<p style="position:absolute;top:992px;left:549px;white-space:nowrap" class="ft4250">T</p>
<p style="position:absolute;top:993px;left:564px;white-space:nowrap" class="ft428">and&#160;whose&#160;nodes</p>
<p style="position:absolute;top:1011px;left:150px;white-space:nowrap" class="ft4215">are&#160;random&#160;numbers.&#160;Existing&#160;commitment&#160;schemes&#160;such&#160;as&#160;the&#160;one&#160;by&#160;Damgard&#160;et<br/>al.&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[26]&#160;</a>or&#160;those&#160;based&#160;on&#160;one-way&#160;hash&#160;functions&#160;can&#160;be&#160;used&#160;for&#160;this&#160;purpose.</p>
<p style="position:absolute;top:1047px;left:172px;white-space:nowrap" class="ft428">In&#160;a&#160;TPM-equipped&#160;system,&#160;logging&#160;is&#160;done&#160;by&#160;extending&#160;the&#160;PCRs&#160;with&#160;the&#160;mea-</p>
<p style="position:absolute;top:1065px;left:150px;white-space:nowrap" class="ft428">surement&#160;values.&#160;For&#160;blinding,&#160;it&#160;is&#160;the&#160;nodes&#160;of</p>
<p style="position:absolute;top:1060px;left:464px;white-space:nowrap" class="ft4248">¯</p>
<p style="position:absolute;top:1064px;left:461px;white-space:nowrap" class="ft4250">T</p>
<p style="position:absolute;top:1065px;left:479px;white-space:nowrap" class="ft428">that&#160;are&#160;actually&#160;logged.&#160;This</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft4221">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 43 -->
<a name="43"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page43-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5043.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft438">CHAPTER&#160;5.&#160;POLICY&#160;ENFORCEMENT&#160;AND&#160;COMPLIANCE</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft438">41</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft438">means&#160;that&#160;instead&#160;of&#160;doing&#160;the&#160;normal</p>
<p style="position:absolute;top:193px;left:478px;white-space:nowrap" class="ft4373">TPM</p>
<p style="position:absolute;top:194px;left:511px;white-space:nowrap" class="ft438">_</p>
<p style="position:absolute;top:193px;left:518px;white-space:nowrap" class="ft4373">extend</p>
<p style="position:absolute;top:193px;left:559px;white-space:nowrap" class="ft4348">(</p>
<p style="position:absolute;top:193px;left:565px;white-space:nowrap" class="ft4373">n</p>
<p style="position:absolute;top:193px;left:573px;white-space:nowrap" class="ft4348">)</p>
<p style="position:absolute;top:194px;left:579px;white-space:nowrap" class="ft438">,&#160;a</p>
<p style="position:absolute;top:193px;left:602px;white-space:nowrap" class="ft4373">TPM</p>
<p style="position:absolute;top:194px;left:635px;white-space:nowrap" class="ft438">_</p>
<p style="position:absolute;top:193px;left:642px;white-space:nowrap" class="ft4373">extend</p>
<p style="position:absolute;top:193px;left:683px;white-space:nowrap" class="ft4348">(</p>
<p style="position:absolute;top:193px;left:689px;white-space:nowrap" class="ft4373">r</p>
<p style="position:absolute;top:193px;left:697px;white-space:nowrap" class="ft4350">⊗</p>
<p style="position:absolute;top:193px;left:712px;white-space:nowrap" class="ft4373">n</p>
<p style="position:absolute;top:193px;left:720px;white-space:nowrap" class="ft4348">)</p>
<p style="position:absolute;top:194px;left:732px;white-space:nowrap" class="ft438">is</p>
<p style="position:absolute;top:212px;left:226px;white-space:nowrap" class="ft438">done,&#160;where</p>
<p style="position:absolute;top:211px;left:308px;white-space:nowrap" class="ft4346">n</p>
<p style="position:absolute;top:212px;left:323px;white-space:nowrap" class="ft438">is&#160;a&#160;node&#160;of</p>
<p style="position:absolute;top:211px;left:405px;white-space:nowrap" class="ft4350">T</p>
<p style="position:absolute;top:212px;left:417px;white-space:nowrap" class="ft438">,</p>
<p style="position:absolute;top:211px;left:427px;white-space:nowrap" class="ft4346">r</p>
<p style="position:absolute;top:212px;left:440px;white-space:nowrap" class="ft438">is&#160;a&#160;node&#160;of</p>
<p style="position:absolute;top:211px;left:522px;white-space:nowrap" class="ft4350">R</p>
<p style="position:absolute;top:212px;left:535px;white-space:nowrap" class="ft438">,&#160;and</p>
<p style="position:absolute;top:211px;left:573px;white-space:nowrap" class="ft4350">⊗</p>
<p style="position:absolute;top:212px;left:590px;white-space:nowrap" class="ft438">denotes&#160;the&#160;commitment</p>
<p style="position:absolute;top:230px;left:226px;white-space:nowrap" class="ft438">operation&#160;used&#160;for&#160;hiding</p>
<p style="position:absolute;top:229px;left:381px;white-space:nowrap" class="ft4346">n</p>
<p style="position:absolute;top:230px;left:393px;white-space:nowrap" class="ft438">until&#160;the&#160;reveal&#160;phase.</p>
<p style="position:absolute;top:247px;left:248px;white-space:nowrap" class="ft438">A&#160;projection&#160;function</p>
<p style="position:absolute;top:247px;left:380px;white-space:nowrap" class="ft4373">p</p>
<p style="position:absolute;top:246px;left:388px;white-space:nowrap" class="ft4348">()</p>
<p style="position:absolute;top:247px;left:403px;white-space:nowrap" class="ft438">that&#160;conforms&#160;to&#160;the&#160;access&#160;restrictions&#160;can&#160;be&#160;realized&#160;as</p>
<p style="position:absolute;top:265px;left:226px;white-space:nowrap" class="ft438">follows:&#160;when&#160;invoked&#160;at&#160;the&#160;request&#160;of&#160;user</p>
<p style="position:absolute;top:264px;left:498px;white-space:nowrap" class="ft4346">u</p>
<p style="position:absolute;top:265px;left:506px;white-space:nowrap" class="ft438">,</p>
<p style="position:absolute;top:265px;left:514px;white-space:nowrap" class="ft4373">p</p>
<p style="position:absolute;top:264px;left:522px;white-space:nowrap" class="ft4348">()</p>
<p style="position:absolute;top:265px;left:537px;white-space:nowrap" class="ft438">reveals</p>
<p style="position:absolute;top:261px;left:586px;white-space:nowrap" class="ft4348">¯</p>
<p style="position:absolute;top:264px;left:583px;white-space:nowrap" class="ft4350">T</p>
<p style="position:absolute;top:265px;left:599px;white-space:nowrap" class="ft438">and&#160;only&#160;those&#160;nodes&#160;in</p>
<p style="position:absolute;top:282px;left:226px;white-space:nowrap" class="ft4350">T</p>
<p style="position:absolute;top:283px;left:241px;white-space:nowrap" class="ft438">that&#160;contain</p>
<p style="position:absolute;top:282px;left:314px;white-space:nowrap" class="ft4346">u</p>
<p style="position:absolute;top:283px;left:326px;white-space:nowrap" class="ft438">in&#160;their&#160;respective&#160;ACLs.&#160;Thus,</p>
<p style="position:absolute;top:283px;left:514px;white-space:nowrap" class="ft4373">p</p>
<p style="position:absolute;top:282px;left:522px;white-space:nowrap" class="ft4348">()</p>
<p style="position:absolute;top:283px;left:537px;white-space:nowrap" class="ft438">implements&#160;the&#160;reveal&#160;phase&#160;of&#160;the</p>
<p style="position:absolute;top:301px;left:226px;white-space:nowrap" class="ft438">multi-bit&#160;commitment&#160;scheme&#160;and&#160;reveals&#160;only&#160;those&#160;nodes&#160;in</p>
<p style="position:absolute;top:300px;left:608px;white-space:nowrap" class="ft4350">T</p>
<p style="position:absolute;top:301px;left:624px;white-space:nowrap" class="ft438">that</p>
<p style="position:absolute;top:300px;left:651px;white-space:nowrap" class="ft4346">u</p>
<p style="position:absolute;top:301px;left:664px;white-space:nowrap" class="ft438">is&#160;authorized</p>
<p style="position:absolute;top:319px;left:226px;white-space:nowrap" class="ft4315">to&#160;access.&#160;Due&#160;to&#160;the&#160;guarantees&#160;of&#160;the&#160;commitment&#160;scheme,&#160;the&#160;system&#160;cannot&#160;invent<br/>arbitrary&#160;values&#160;for&#160;the&#160;nodes&#160;in</p>
<p style="position:absolute;top:336px;left:420px;white-space:nowrap" class="ft4350">T</p>
<p style="position:absolute;top:337px;left:436px;white-space:nowrap" class="ft438">without&#160;being&#160;detected&#160;by&#160;the&#160;user.</p>
<p style="position:absolute;top:355px;left:248px;white-space:nowrap" class="ft438">As&#160;a&#160;result&#160;of&#160;the&#160;blinding&#160;technique&#160;described&#160;above,&#160;any&#160;user</p>
<p style="position:absolute;top:354px;left:642px;white-space:nowrap" class="ft4346">u</p>
<p style="position:absolute;top:355px;left:656px;white-space:nowrap" class="ft438">knows&#160;that&#160;all</p>
<p style="position:absolute;top:373px;left:226px;white-space:nowrap" class="ft4315">components&#160;that&#160;have&#160;any&#160;effect&#160;on&#160;system&#160;integrity&#160;have&#160;been&#160;taken&#160;into&#160;consideration<br/>in&#160;the&#160;system&#160;log&#160;tree;&#160;in&#160;addition,&#160;for&#160;those&#160;components&#160;that&#160;it&#160;is&#160;authorized&#160;to&#160;access,</p>
<p style="position:absolute;top:408px;left:226px;white-space:nowrap" class="ft4346">u</p>
<p style="position:absolute;top:409px;left:238px;white-space:nowrap" class="ft438">can&#160;check&#160;whether&#160;they&#160;indeed&#160;have&#160;the&#160;acceptable&#160;configuration&#160;and&#160;state&#160;value,&#160;by</p>
<p style="position:absolute;top:427px;left:226px;white-space:nowrap" class="ft4314">comparing&#160;with&#160;its&#160;own&#160;reference&#160;values&#160;that&#160;may&#160;be&#160;provided&#160;and&#160;certified&#160;by&#160;a&#160;trusted<br/>third&#160;party.&#160;In&#160;particular,&#160;if&#160;the&#160;ACL&#160;for&#160;the&#160;root&#160;node&#160;is</p>
<p style="position:absolute;top:444px;left:575px;white-space:nowrap" class="ft4346">U</p>
<p style="position:absolute;top:445px;left:591px;white-space:nowrap" class="ft438">(i.e.,&#160;all&#160;users&#160;can&#160;access</p>
<p style="position:absolute;top:463px;left:226px;white-space:nowrap" class="ft4315">the&#160;root&#160;node),&#160;then&#160;any&#160;user&#160;can&#160;verify&#160;overall&#160;system&#160;integrity&#160;(just&#160;from&#160;the&#160;value&#160;of<br/><i>root</i>(</p>
<p style="position:absolute;top:479px;left:256px;white-space:nowrap" class="ft4350">T</p>
<p style="position:absolute;top:480px;left:267px;white-space:nowrap" class="ft438">))&#160;without&#160;knowing&#160;the&#160;exact&#160;configuration&#160;of&#160;any&#160;individual&#160;component&#160;in&#160;the</p>
<p style="position:absolute;top:498px;left:226px;white-space:nowrap" class="ft438">system.</p>
<p style="position:absolute;top:516px;left:248px;white-space:nowrap" class="ft438">Our&#160;approach&#160;of&#160;using&#160;commitment&#160;schemes&#160;for&#160;blinding&#160;suffers&#160;from&#160;the&#160;disad-</p>
<p style="position:absolute;top:534px;left:226px;white-space:nowrap" class="ft4315">vantage&#160;that&#160;two&#160;colluding&#160;verifiers&#160;can&#160;learn&#160;the&#160;values&#160;revealed&#160;to&#160;the&#160;other.&#160;Alternate<br/>schemes&#160;based&#160;on&#160;zero-knowledge&#160;proofs&#160;or&#160;deniable&#160;signatures&#160;need&#160;to&#160;be&#160;investigated<br/>to&#160;overcome&#160;this&#160;disadvantage.</p>
<p style="position:absolute;top:634px;left:226px;white-space:nowrap" class="ft4326"><b>5.4</b></p>
<p style="position:absolute;top:634px;left:274px;white-space:nowrap" class="ft4326"><b>Realization&#160;using&#160;Xen&#160;and&#160;Linux</b></p>
<p style="position:absolute;top:672px;left:226px;white-space:nowrap" class="ft4314">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#44">5.6&#160;</a>shows&#160;an&#160;example&#160;implementation&#160;of&#160;our&#160;PEV&#160;architecture&#160;with&#160;the&#160;Xen&#160;hy-<br/>pervisor&#160;using&#160;Linux&#160;for&#160;Dom0.&#160;The&#160;main&#160;components&#160;of&#160;our&#160;implementation&#160;are&#160;the<br/>Compartment&#160;Manager&#160;(CM),&#160;Integrity&#160;Manager&#160;(IM),&#160;and&#160;the&#160;Secure&#160;Virtual&#160;Device<br/>Manager&#160;(SVDM).&#160;All&#160;components&#160;are&#160;implemented&#160;in&#160;Dom0.&#160;The&#160;CM&#160;is&#160;responsi-<br/>ble&#160;for&#160;the&#160;VM&#160;life&#160;cycle&#160;management.&#160;As&#160;the&#160;sole&#160;entry&#160;point&#160;for&#160;user&#160;commands,&#160;it<br/>communicates&#160;directly&#160;with&#160;the&#160;hypervisor&#160;and&#160;orchestrates&#160;the&#160;IM&#160;and&#160;the&#160;SVDM.&#160;Ta-<br/>ble&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#44">5.1&#160;</a>shows&#160;the&#160;mapping&#160;between&#160;concepts&#160;in&#160;our&#160;formal&#160;model&#160;and&#160;their&#160;realization<br/>in&#160;our&#160;Xen&#160;prototype.&#160;XSLT&#160;is&#160;a&#160;language&#160;for&#160;transforming&#160;one&#160;XML&#160;document&#160;into<br/>another&#160;XML&#160;document&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[6]</a>.&#160;We&#160;assume&#160;that&#160;the&#160;XSLT&#160;interpreter&#160;is&#160;part&#160;of&#160;the&#160;TCB.</p>
<p style="position:absolute;top:833px;left:248px;white-space:nowrap" class="ft438">The</p>
<p style="position:absolute;top:833px;left:275px;white-space:nowrap" class="ft4373">getCurrentState</p>
<p style="position:absolute;top:832px;left:375px;white-space:nowrap" class="ft4348">()</p>
<p style="position:absolute;top:833px;left:390px;white-space:nowrap" class="ft438">function&#160;of&#160;the&#160;CM&#160;returns&#160;the&#160;current&#160;state&#160;of&#160;the&#160;physical</p>
<p style="position:absolute;top:851px;left:226px;white-space:nowrap" class="ft4315">machine,&#160;which&#160;includes&#160;the&#160;list&#160;of&#160;hosted&#160;VMs,&#160;their&#160;status&#160;(active,&#160;suspended,&#160;or<br/>hibernating),&#160;VM&#160;ownership&#160;information&#160;(e.g.,&#160;the&#160;virtual&#160;organization&#160;to&#160;which&#160;a&#160;VM<br/>belongs),&#160;the&#160;amount&#160;of&#160;free&#160;memory&#160;available,&#160;etc.&#160;Using&#160;the&#160;result&#160;of&#160;the&#160;function,<br/>a&#160;verifier&#160;can&#160;decide&#160;whether&#160;the&#160;physical&#160;machine&#160;satisfies&#160;the&#160;integrity&#160;requirements<br/>for&#160;performing&#160;certain&#160;actions&#160;(e.g.,&#160;starting&#160;a&#160;new&#160;VM&#160;belonging&#160;to&#160;a&#160;particular&#160;virtual<br/>organization).</p>
<p style="position:absolute;top:959px;left:248px;white-space:nowrap" class="ft438">The&#160;IM&#160;in&#160;our&#160;Xen&#160;prototype&#160;has&#160;a&#160;storage&#160;integrity&#160;plug-in&#160;(SIP)&#160;for&#160;measuring&#160;var-</p>
<p style="position:absolute;top:977px;left:226px;white-space:nowrap" class="ft4315">ious&#160;disk&#160;images&#160;and&#160;files.&#160;The&#160;IM&#160;also&#160;has&#160;an&#160;Attestation&#160;&amp;&#160;Sealing&#160;module&#160;(ASM)<br/>that&#160;interfaces&#160;with&#160;the&#160;TPM&#160;for&#160;executing&#160;the&#160;sealing&#160;and&#160;attestation&#160;protocols&#160;(de-<br/>scribed&#160;in&#160;Sections&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#41">5.3.1&#160;</a>and&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#42">5.3.2)&#160;</a>as&#160;well&#160;as&#160;for&#160;invoking&#160;normal&#160;TPM&#160;operations,<br/>such&#160;as</p>
<p style="position:absolute;top:1030px;left:276px;white-space:nowrap" class="ft4373">TPM</p>
<p style="position:absolute;top:1031px;left:309px;white-space:nowrap" class="ft438">_</p>
<p style="position:absolute;top:1030px;left:317px;white-space:nowrap" class="ft4373">Quote</p>
<p style="position:absolute;top:1031px;left:355px;white-space:nowrap" class="ft438">.&#160;The&#160;ASM&#160;invokes&#160;normal&#160;TPM&#160;operations&#160;through&#160;the&#160;TPM</p>
<p style="position:absolute;top:1049px;left:226px;white-space:nowrap" class="ft4314">Software&#160;Stack&#160;(TSS)&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[116]</a>,&#160;which&#160;is&#160;the&#160;standard&#160;API&#160;for&#160;accessing&#160;the&#160;functions&#160;of<br/>the&#160;TPM.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft4321">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 44 -->
<a name="44"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft44100{font-size:13px;font-family:Helvetica;color:#000000;}
	.ft44101{font-size:8px;line-height:10px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page44-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5044.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft448">42</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft4421">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:562px;left:379px;white-space:nowrap" class="ft44100"><b>Xen&#160;Hypervisor</b></p>
<p style="position:absolute;top:606px;left:321px;white-space:nowrap" class="ft44100"><b>TPM</b></p>
<p style="position:absolute;top:595px;left:366px;white-space:nowrap" class="ft44100"><b>Hard&#160;Disk&#160;</b></p>
<p style="position:absolute;top:610px;left:362px;white-space:nowrap" class="ft44100"><b>Drive&#160;(HDD)</b></p>
<p style="position:absolute;top:603px;left:457px;white-space:nowrap" class="ft44100"><b>Network</b></p>
<p style="position:absolute;top:479px;left:317px;white-space:nowrap" class="ft4470"><b>/dev/tpm</b></p>
<p style="position:absolute;top:499px;left:325px;white-space:nowrap" class="ft4470"><b>TPM</b></p>
<p style="position:absolute;top:509px;left:322px;white-space:nowrap" class="ft4470"><b>Driver</b></p>
<p style="position:absolute;top:442px;left:325px;white-space:nowrap" class="ft4470"><b>TPM&#160;</b></p>
<p style="position:absolute;top:450px;left:316px;white-space:nowrap" class="ft4470"><b>Software&#160;</b></p>
<p style="position:absolute;top:459px;left:323px;white-space:nowrap" class="ft4470"><b>Stack</b></p>
<p style="position:absolute;top:512px;left:374px;white-space:nowrap" class="ft4470"><b>HDD&#160;</b></p>
<p style="position:absolute;top:522px;left:372px;white-space:nowrap" class="ft4470"><b>Driver</b></p>
<p style="position:absolute;top:498px;left:388px;white-space:nowrap" class="ft4470"><b>DM&#160;Crypt</b></p>
<p style="position:absolute;top:479px;left:367px;white-space:nowrap" class="ft4470"><b>/dev/sda</b></p>
<p style="position:absolute;top:512px;left:455px;white-space:nowrap" class="ft4470"><b>Ethernet</b></p>
<p style="position:absolute;top:522px;left:460px;white-space:nowrap" class="ft4470"><b>Driver</b></p>
<p style="position:absolute;top:510px;left:502px;white-space:nowrap" class="ft4470"><b>virtual&#160;</b></p>
<p style="position:absolute;top:518px;left:499px;white-space:nowrap" class="ft4470"><b>network&#160;</b></p>
<p style="position:absolute;top:527px;left:502px;white-space:nowrap" class="ft4470"><b>device&#160;</b></p>
<p style="position:absolute;top:535px;left:499px;white-space:nowrap" class="ft4470"><b>backend</b></p>
<p style="position:absolute;top:498px;left:481px;white-space:nowrap" class="ft4470"><b>Bridge</b></p>
<p style="position:absolute;top:479px;left:463px;white-space:nowrap" class="ft4470"><b>brctl</b></p>
<p style="position:absolute;top:479px;left:507px;white-space:nowrap" class="ft4470"><b>eth0</b></p>
<p style="position:absolute;top:304px;left:392px;white-space:nowrap" class="ft4470"><b>Compartment</b></p>
<p style="position:absolute;top:314px;left:402px;white-space:nowrap" class="ft4470"><b>Manager</b></p>
<p style="position:absolute;top:342px;left:346px;white-space:nowrap" class="ft4470"><b>Integrity</b></p>
<p style="position:absolute;top:352px;left:345px;white-space:nowrap" class="ft4470"><b>Manager</b></p>
<p style="position:absolute;top:342px;left:455px;white-space:nowrap" class="ft4470"><b>Secure&#160;Virtual</b></p>
<p style="position:absolute;top:352px;left:453px;white-space:nowrap" class="ft4470"><b>Device&#160;Manager</b></p>
<p style="position:absolute;top:367px;left:438px;white-space:nowrap" class="ft4470"><b>virtual</b></p>
<p style="position:absolute;top:377px;left:442px;white-space:nowrap" class="ft4470"><b>disk</b></p>
<p style="position:absolute;top:367px;left:507px;white-space:nowrap" class="ft4470"><b>virtual</b></p>
<p style="position:absolute;top:377px;left:512px;white-space:nowrap" class="ft4470"><b>NIC</b></p>
<p style="position:absolute;top:371px;left:318px;white-space:nowrap" class="ft4470"><b>Attestation</b></p>
<p style="position:absolute;top:382px;left:321px;white-space:nowrap" class="ft4470"><b>&amp;&#160;Sealing</b></p>
<p style="position:absolute;top:392px;left:326px;white-space:nowrap" class="ft4470"><b>Module</b></p>
<p style="position:absolute;top:371px;left:375px;white-space:nowrap" class="ft4470"><b>Storage</b></p>
<p style="position:absolute;top:382px;left:373px;white-space:nowrap" class="ft4470"><b>Integrity</b></p>
<p style="position:absolute;top:392px;left:377px;white-space:nowrap" class="ft4470"><b>Plug-in</b></p>
<p style="position:absolute;top:281px;left:411px;white-space:nowrap" class="ft4445"><b>Dom0</b></p>
<p style="position:absolute;top:356px;left:273px;white-space:nowrap" class="ft44101"><b>User<br/>Space</b></p>
<p style="position:absolute;top:450px;left:273px;white-space:nowrap" class="ft44101"><b>Library<br/>Space</b></p>
<p style="position:absolute;top:494px;left:273px;white-space:nowrap" class="ft44101"><b>Kernel<br/>Space</b></p>
<p style="position:absolute;top:510px;left:415px;white-space:nowrap" class="ft4470"><b>virtual&#160;</b></p>
<p style="position:absolute;top:518px;left:417px;white-space:nowrap" class="ft4470"><b>block</b></p>
<p style="position:absolute;top:527px;left:414px;white-space:nowrap" class="ft4470"><b>device&#160;</b></p>
<p style="position:absolute;top:535px;left:411px;white-space:nowrap" class="ft4470"><b>backend</b></p>
<p style="position:absolute;top:665px;left:274px;white-space:nowrap" class="ft448">Figure&#160;5.6:&#160;Realization&#160;using&#160;Xen&#160;and&#160;Linux</p>
<p style="position:absolute;top:876px;left:280px;white-space:nowrap" class="ft4423"><b>Model</b></p>
<p style="position:absolute;top:876px;left:376px;white-space:nowrap" class="ft4423"><b>Xen-based&#160;Prototype</b></p>
<p style="position:absolute;top:894px;left:259px;white-space:nowrap" class="ft448">Projection</p>
<p style="position:absolute;top:894px;left:339px;white-space:nowrap" class="ft4473">p</p>
<p style="position:absolute;top:893px;left:347px;white-space:nowrap" class="ft4448">()</p>
<p style="position:absolute;top:894px;left:376px;white-space:nowrap" class="ft448">component&#160;measurement&#160;plug-in</p>
<p style="position:absolute;top:912px;left:265px;white-space:nowrap" class="ft448">Predicate</p>
<p style="position:absolute;top:911px;left:339px;white-space:nowrap" class="ft4448">Π</p>
<p style="position:absolute;top:912px;left:376px;white-space:nowrap" class="ft448">XSLT&#160;stylesheet</p>
<p style="position:absolute;top:930px;left:242px;white-space:nowrap" class="ft448">Access&#160;Filter</p>
<p style="position:absolute;top:930px;left:376px;white-space:nowrap" class="ft448">XSLT&#160;stylesheet</p>
<p style="position:absolute;top:978px;left:282px;white-space:nowrap" class="ft448">Table&#160;5.1:&#160;From&#160;model&#160;to&#160;implementation</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft4421">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 45 -->
<a name="45"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page45-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5045.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft458">CHAPTER&#160;5.&#160;POLICY&#160;ENFORCEMENT&#160;AND&#160;COMPLIANCE</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft458">43</p>
<p style="position:absolute;top:194px;left:248px;white-space:nowrap" class="ft458">The&#160;SVDM&#160;is&#160;responsible&#160;for&#160;managing&#160;virtual&#160;devices&#160;such&#160;as&#160;virtual&#160;hard&#160;disks,</p>
<p style="position:absolute;top:212px;left:226px;white-space:nowrap" class="ft4515">virtual&#160;block&#160;devices,&#160;virtual&#160;network&#160;devices,&#160;and&#160;virtual&#160;TPMs.&#160;The&#160;service&#160;offered<br/>by&#160;the&#160;SVDM&#160;is&#160;realized&#160;through&#160;multiple&#160;specialized&#160;low-level&#160;component&#160;plug-in<br/>modules,&#160;one&#160;for&#160;each&#160;virtual&#160;device.&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#44">5.6&#160;</a>shows&#160;two&#160;plug-ins&#160;in&#160;our&#160;Xen&#160;pro-<br/>totype.&#160;One&#160;is&#160;for&#160;managing&#160;the&#160;virtual&#160;(encrypted)&#160;hard&#160;disk&#160;and&#160;the&#160;other&#160;one&#160;is&#160;for<br/>managing&#160;the&#160;virtual&#160;network&#160;interface&#160;card&#160;(NIC).</p>
<p style="position:absolute;top:301px;left:248px;white-space:nowrap" class="ft458">In&#160;Dom0,&#160;secure&#160;device&#160;virtualization&#160;is&#160;implemented&#160;in&#160;the&#160;kernel&#160;space.&#160;Tasks</p>
<p style="position:absolute;top:319px;left:226px;white-space:nowrap" class="ft4515">such&#160;as&#160;configuring&#160;virtual&#160;devices&#160;are&#160;done&#160;through&#160;the&#160;SVDM&#160;in&#160;the&#160;user&#160;(or&#160;applica-<br/>tion)&#160;space.&#160;The&#160;SVDM&#160;manages&#160;the&#160;security&#160;properties&#160;of&#160;devices.&#160;For&#160;example,&#160;a&#160;se-<br/>cure&#160;hard&#160;disk&#160;is&#160;implemented&#160;by&#160;means&#160;of&#160;the&#160;<i>DM&#160;Crypt&#160;</i>loopback&#160;device.&#160;Similarly,<br/>network&#160;virtualization&#160;is&#160;done&#160;by&#160;providing&#160;virtual&#160;NICs&#160;for&#160;the&#160;VMs&#160;and&#160;<i>bridging<br/></i>these&#160;virtual&#160;NICs&#160;to&#160;the&#160;physical&#160;NIC.&#160;Security&#160;for&#160;networks&#160;has&#160;two&#160;aspects.&#160;Topol-<br/>ogy&#160;constraints&#160;define&#160;which&#160;VM&#160;is&#160;allowed&#160;to&#160;connect&#160;to&#160;which&#160;sub-network(s).&#160;In<br/>addition,&#160;confidentiality&#160;requirements&#160;dictate&#160;which&#160;connections&#160;need&#160;to&#160;be&#160;encrypted.</p>
<p style="position:absolute;top:445px;left:248px;white-space:nowrap" class="ft458">Secure&#160;management&#160;of&#160;virtual&#160;devices&#160;is&#160;a&#160;complex&#160;task.&#160;For&#160;example,&#160;there&#160;are</p>
<p style="position:absolute;top:463px;left:226px;white-space:nowrap" class="ft4515">multiple&#160;steps&#160;involved&#160;in&#160;starting&#160;a&#160;virtual&#160;hard-disk&#160;drive.&#160;First,&#160;a&#160;policy-based&#160;check<br/>of&#160;the&#160;state&#160;of&#160;the&#160;physical&#160;machine&#160;is&#160;done&#160;based&#160;on&#160;the&#160;results&#160;of</p>
<p style="position:absolute;top:480px;left:630px;white-space:nowrap" class="ft4573">getCurrentState</p>
<p style="position:absolute;top:479px;left:730px;white-space:nowrap" class="ft4548">()</p>
<p style="position:absolute;top:498px;left:226px;white-space:nowrap" class="ft4515">function.&#160;Depending&#160;on&#160;the&#160;logic&#160;implemented&#160;by&#160;the&#160;corresponding&#160;plug-in,&#160;that<br/>check&#160;may&#160;include&#160;verifying&#160;the&#160;measurements&#160;of&#160;the&#160;hypervisor,&#160;binary&#160;disk,&#160;and&#160;the<br/>Dom0&#160;image.&#160;Then,&#160;the&#160;virtual&#160;hard-disk&#160;is&#160;attached&#160;with&#160;credentials&#160;and&#160;connected<br/>to&#160;a&#160;loop&#160;device&#160;(/dev/loop).&#160;The&#160;virtual&#160;hard-disk&#160;may&#160;be&#160;encrypted,&#160;for&#160;example,<br/>with&#160;a&#160;sealing&#160;key&#160;that&#160;is&#160;made&#160;available&#160;only&#160;if&#160;the&#160;platform&#160;is&#160;in&#160;a&#160;certain&#160;state.&#160;The<br/>decryption&#160;of&#160;the&#160;virtual&#160;hard-disk&#160;image&#160;is&#160;done&#160;using&#160;the&#160;Linux&#160;hard-disk&#160;encryptor.<br/>After&#160;decryption,&#160;the&#160;device&#160;file&#160;that&#160;gives&#160;access&#160;to&#160;the&#160;decrypted&#160;image&#160;is&#160;connected<br/>to&#160;the&#160;front-end.&#160;Similar&#160;policy-based&#160;checks&#160;may&#160;be&#160;done&#160;when&#160;starting&#160;other&#160;virtual<br/>devices.&#160;For&#160;example,&#160;before&#160;starting&#160;a&#160;virtual&#160;network&#160;device,&#160;policies&#160;may&#160;stipulate<br/>that&#160;the&#160;VM&#160;must&#160;be&#160;in&#160;some&#160;acceptable&#160;state&#160;and&#160;outside&#160;firewalls&#160;must&#160;be&#160;configured<br/>correctly.</p>
<p style="position:absolute;top:742px;left:226px;white-space:nowrap" class="ft4526"><b>5.5</b></p>
<p style="position:absolute;top:742px;left:274px;white-space:nowrap" class="ft4526"><b>Use&#160;Cases</b></p>
<p style="position:absolute;top:780px;left:226px;white-space:nowrap" class="ft4556">In&#160;this&#160;section,&#160;we&#160;describe&#160;a&#160;few&#160;examples&#160;of&#160;how&#160;the&#160;components&#160;introduced&#160;in&#160;Sec-<br/>tion&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#43">5.4&#160;</a>interact&#160;for&#160;integrity&#160;protection,&#160;enforcement,&#160;and&#160;verification&#160;purposes.&#160;We<br/>assume&#160;that&#160;the&#160;core&#160;TCB&#160;(including&#160;Xen&#160;and&#160;Dom0&#160;Linux)&#160;has&#160;been&#160;measured&#160;at<br/>start-up&#160;time.&#160;Additional&#160;services&#160;may&#160;need&#160;to&#160;be&#160;measured&#160;based&#160;on&#160;policy.&#160;The&#160;mea-<br/>surement&#160;can&#160;either&#160;be&#160;done&#160;by&#160;a&#160;trusted&#160;boot&#160;loader&#160;such&#160;as&#160;TrustedGRUB&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[4]&#160;</a>(which<br/>measures&#160;the&#160;entire&#160;boot&#160;image)&#160;or&#160;by&#160;a&#160;more&#160;fine-grained&#160;approach&#160;such&#160;as&#160;Sailer&#160;<i>et<br/>al</i>.’s&#160;IMA&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[104]</a>.</p>
<p style="position:absolute;top:946px;left:226px;white-space:nowrap" class="ft4524"><b>5.5.1</b></p>
<p style="position:absolute;top:946px;left:280px;white-space:nowrap" class="ft4524"><b>TPM-based&#160;Attestation&#160;on&#160;a&#160;VM&#160;Disk</b></p>
<p style="position:absolute;top:976px;left:226px;white-space:nowrap" class="ft4514">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#46">5.7&#160;</a>shows&#160;the&#160;component&#160;interactions&#160;for&#160;attesting&#160;the&#160;current&#160;state&#160;of&#160;the&#160;TCB<br/>and&#160;the&#160;status&#160;of&#160;a&#160;VM’s&#160;disk&#160;image.&#160;The&#160;user/verifier&#160;interacts&#160;with&#160;the&#160;CM&#160;through<br/>the</p>
<p style="position:absolute;top:1011px;left:249px;white-space:nowrap" class="ft4573">attestationRequest</p>
<p style="position:absolute;top:1012px;left:371px;white-space:nowrap" class="ft458">call&#160;with&#160;an&#160;<i>attestation&#160;descriptor&#160;</i>and&#160;<i>user&#160;credential&#160;</i>as&#160;pa-</p>
<p style="position:absolute;top:1030px;left:226px;white-space:nowrap" class="ft4515">rameters&#160;(step&#160;1).&#160;The&#160;attestation&#160;descriptor&#160;is&#160;an&#160;XML&#160;structure&#160;that&#160;describes&#160;what<br/>aspect&#160;of&#160;the&#160;system’s&#160;integrity&#160;state&#160;the&#160;verifier&#160;wants&#160;attested.&#160;In&#160;other&#160;words,&#160;the<br/>attestation&#160;descriptor&#160;is&#160;how&#160;the&#160;verifier&#160;chooses&#160;the&#160;log&#160;projection&#160;function&#160;suitable</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft4521">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 46 -->
<a name="46"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page46-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5046.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft468">44</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft4621">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:851px;left:262px;white-space:nowrap" class="ft468">Figure&#160;5.7:&#160;TPM-based&#160;attestation&#160;on&#160;a&#160;VM&#160;disk</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft4621">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 47 -->
<a name="47"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft47102{font-size:13px;font-family:Courier;color:#231f20;}
-->
</style>
<div id="page47-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5047.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft478">CHAPTER&#160;5.&#160;POLICY&#160;ENFORCEMENT&#160;AND&#160;COMPLIANCE</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft478">45</p>
<p style="position:absolute;top:194px;left:290px;white-space:nowrap" class="ft47102">&lt;attestation-desc&gt;</p>
<p style="position:absolute;top:211px;left:307px;white-space:nowrap" class="ft47102">&lt;attestation&#160;type=&#34;tpm-based&#34;</p>
<p style="position:absolute;top:227px;left:347px;white-space:nowrap" class="ft47102">challenge=&#34;0xaded...&#34;</p>
<p style="position:absolute;top:243px;left:347px;white-space:nowrap" class="ft47102">aik=&#34;0xaada3..&#34;&gt;</p>
<p style="position:absolute;top:260px;left:323px;white-space:nowrap" class="ft47102">&lt;measurement-desc&#160;type=&#34;tpm&#34;&gt;</p>
<p style="position:absolute;top:276px;left:355px;white-space:nowrap" class="ft47102">&lt;measureTarget&#160;name=&#34;disk:/dev/sdb1&#34;</p>
<p style="position:absolute;top:293px;left:379px;white-space:nowrap" class="ft47102">dest=&#34;PCR16&#34;/&gt;</p>
<p style="position:absolute;top:309px;left:323px;white-space:nowrap" class="ft47102">&lt;/measurement-desc&gt;</p>
<p style="position:absolute;top:326px;left:323px;white-space:nowrap" class="ft47102">&lt;attestTarget&#160;name=&#34;ALLPCRS&#34;/&gt;</p>
<p style="position:absolute;top:342px;left:307px;white-space:nowrap" class="ft47102">&lt;/attestation&gt;</p>
<p style="position:absolute;top:359px;left:290px;white-space:nowrap" class="ft47102">&lt;/attestation-desc&gt;</p>
<p style="position:absolute;top:406px;left:358px;white-space:nowrap" class="ft478">Figure&#160;5.8:&#160;Attestation&#160;descriptor&#160;in&#160;XML</p>
<p style="position:absolute;top:454px;left:226px;white-space:nowrap" class="ft4715">for&#160;its&#160;purpose.&#160;As&#160;described&#160;before,&#160;projection&#160;functions&#160;are&#160;realized&#160;by&#160;a&#160;set&#160;of&#160;com-<br/>ponent&#160;plug-in&#160;modules.&#160;Some&#160;of&#160;these&#160;plug-in&#160;modules&#160;are&#160;<i>measurement&#160;plug-ins</i>,<br/>which&#160;not&#160;only&#160;return&#160;the&#160;relevant&#160;integrity&#160;states&#160;of&#160;the&#160;components&#160;but&#160;are&#160;also&#160;the<br/>ones&#160;measuring&#160;their&#160;integrity&#160;states&#160;in&#160;the&#160;first&#160;place.&#160;The&#160;attestation&#160;descriptor&#160;con-<br/>tains&#160;one&#160;or&#160;more&#160;<i>measurement&#160;descriptors</i>.&#160;Based&#160;on&#160;the&#160;measurement&#160;descriptors,<br/>the&#160;IM&#160;knows&#160;the&#160;exact&#160;set&#160;of&#160;measurement&#160;plug-ins&#160;to&#160;invoke.</p>
<p style="position:absolute;top:561px;left:248px;white-space:nowrap" class="ft478">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#47">5.8&#160;</a>shows&#160;an&#160;example&#160;attestation&#160;descriptor&#160;as&#160;a&#160;XML&#160;structure.&#160;It&#160;contains</p>
<p style="position:absolute;top:579px;left:226px;white-space:nowrap" class="ft478">an</p>
<p style="position:absolute;top:580px;left:246px;white-space:nowrap" class="ft4734">&lt;attestation&gt;</p>
<p style="position:absolute;top:579px;left:368px;white-space:nowrap" class="ft478">section,&#160;which&#160;defines&#160;the&#160;type&#160;of&#160;attestation&#160;(</p>
<p style="position:absolute;top:580px;left:656px;white-space:nowrap" class="ft4734">tpm-based</p>
<p style="position:absolute;top:579px;left:737px;white-space:nowrap" class="ft478">)</p>
<p style="position:absolute;top:597px;left:226px;white-space:nowrap" class="ft478">and&#160;the&#160;parameters&#160;needed&#160;for&#160;attestation&#160;(the&#160;TPM&#160;Attestation&#160;Identity&#160;Key&#160;or</p>
<p style="position:absolute;top:598px;left:715px;white-space:nowrap" class="ft4734">AIK</p>
<p style="position:absolute;top:615px;left:226px;white-space:nowrap" class="ft478">and&#160;a</p>
<p style="position:absolute;top:616px;left:262px;white-space:nowrap" class="ft4734">challenge</p>
<p style="position:absolute;top:615px;left:343px;white-space:nowrap" class="ft478">).&#160;Nested&#160;in&#160;the&#160;attestation&#160;descriptor&#160;is&#160;a&#160;measurement&#160;descriptor,</p>
<p style="position:absolute;top:633px;left:226px;white-space:nowrap" class="ft478">which&#160;specifies&#160;a&#160;measurement&#160;target&#160;(</p>
<p style="position:absolute;top:634px;left:460px;white-space:nowrap" class="ft4734">measureTarget</p>
<p style="position:absolute;top:633px;left:577px;white-space:nowrap" class="ft478">)&#160;and&#160;a&#160;destination&#160;(</p>
<p style="position:absolute;top:634px;left:697px;white-space:nowrap" class="ft4734">dest</p>
<p style="position:absolute;top:633px;left:733px;white-space:nowrap" class="ft478">).</p>
<p style="position:absolute;top:651px;left:226px;white-space:nowrap" class="ft4715">The&#160;target&#160;indicates&#160;what&#160;is&#160;to&#160;be&#160;measured&#160;(in&#160;this&#160;case,&#160;a&#160;VM&#160;disk&#160;image),&#160;whereas<br/>the&#160;destination&#160;indicates&#160;where&#160;the&#160;result&#160;should&#160;be&#160;stored&#160;(in&#160;this&#160;case,&#160;the&#160;TPM’s&#160;PCR<br/>number&#160;16).&#160;The</p>
<p style="position:absolute;top:688px;left:330px;white-space:nowrap" class="ft4734">&lt;attestTarget&gt;</p>
<p style="position:absolute;top:687px;left:458px;white-space:nowrap" class="ft478">defines&#160;the&#160;scope&#160;of&#160;the&#160;requested&#160;attestation&#160;(in</p>
<p style="position:absolute;top:705px;left:226px;white-space:nowrap" class="ft478">this&#160;case,&#160;all&#160;PCRs).</p>
<p style="position:absolute;top:723px;left:248px;white-space:nowrap" class="ft478">Based&#160;on&#160;the&#160;user&#160;credential&#160;supplied,&#160;the&#160;CM&#160;checks&#160;whether&#160;the&#160;verifier&#160;has&#160;the</p>
<p style="position:absolute;top:741px;left:226px;white-space:nowrap" class="ft4715">right&#160;to&#160;request&#160;attestation&#160;of&#160;the&#160;system&#160;sub-states&#160;indicated&#160;by&#160;the&#160;attestation&#160;descrip-<br/>tor.&#160;The&#160;check&#160;is&#160;essentially&#160;a&#160;way&#160;of&#160;determining&#160;whether&#160;the&#160;requested&#160;projection&#160;is<br/>a&#160;projection&#160;that&#160;conforms&#160;to&#160;the&#160;access&#160;restriction&#160;specification;&#160;hence,&#160;it&#160;is&#160;useful&#160;in<br/>enforcing&#160;access&#160;restriction.&#160;If&#160;the&#160;check&#160;reveals&#160;that&#160;the&#160;verifier&#160;wants&#160;to&#160;have&#160;more<br/>attested&#160;than&#160;what&#160;he/she&#160;is&#160;allowed&#160;to,&#160;then&#160;the&#160;entire&#160;attestation&#160;request&#160;is&#160;denied.<br/>Otherwise,&#160;the&#160;CM&#160;forwards&#160;the&#160;request&#160;to&#160;the&#160;IM&#160;(step&#160;1.1).</p>
<p style="position:absolute;top:848px;left:248px;white-space:nowrap" class="ft478">The&#160;IM&#160;extracts&#160;the&#160;measurement&#160;descriptor(s)&#160;from&#160;the&#160;attestation&#160;descriptor&#160;and</p>
<p style="position:absolute;top:866px;left:226px;white-space:nowrap" class="ft4715">delegates&#160;the&#160;measurement(s)&#160;to&#160;the&#160;appropriate&#160;plug-in(s).&#160;In&#160;our&#160;example,&#160;the&#160;IM<br/>invokes&#160;the</p>
<p style="position:absolute;top:884px;left:298px;white-space:nowrap" class="ft4773">measurevHD</p>
<p style="position:absolute;top:884px;left:382px;white-space:nowrap" class="ft478">function&#160;at&#160;the&#160;SIP&#160;passing&#160;the&#160;measurement&#160;descriptor&#160;as&#160;a</p>
<p style="position:absolute;top:902px;left:226px;white-space:nowrap" class="ft4714">parameter&#160;(step&#160;1.1.1).&#160;The&#160;plug-in&#160;completes&#160;the&#160;requested&#160;measurement&#160;and&#160;returns<br/>the&#160;measurement&#160;result&#160;back&#160;to&#160;the&#160;IM&#160;(step&#160;1.1.2).&#160;Although&#160;step&#160;1.1.2&#160;might&#160;look&#160;like<br/>an&#160;unnecessary&#160;extra&#160;step,&#160;the&#160;indirection&#160;via&#160;the&#160;IM&#160;allows&#160;the&#160;measurement&#160;plug-ins<br/>to&#160;be&#160;written&#160;independent&#160;of&#160;the&#160;TPM&#160;or&#160;similar&#160;future&#160;devices&#160;that&#160;are&#160;indicated&#160;as</p>
<p style="position:absolute;top:974px;left:226px;white-space:nowrap" class="ft4734">dest</p>
<p style="position:absolute;top:974px;left:262px;white-space:nowrap" class="ft478">.</p>
<p style="position:absolute;top:992px;left:248px;white-space:nowrap" class="ft478">The&#160;IM&#160;invokes&#160;the</p>
<p style="position:absolute;top:991px;left:371px;white-space:nowrap" class="ft4773">wrToTPM</p>
<p style="position:absolute;top:992px;left:440px;white-space:nowrap" class="ft478">function&#160;at&#160;the&#160;ASM&#160;with&#160;the&#160;challenge,&#160;the</p>
<p style="position:absolute;top:992px;left:711px;white-space:nowrap" class="ft4734">AIK</p>
<p style="position:absolute;top:992px;left:738px;white-space:nowrap" class="ft478">,</p>
<p style="position:absolute;top:1010px;left:226px;white-space:nowrap" class="ft4715">the&#160;measurement&#160;result,&#160;and&#160;the&#160;destination&#160;PCR&#160;(step&#160;1.1.3).&#160;The&#160;actual&#160;writing&#160;of&#160;the<br/>result&#160;into&#160;the&#160;PCR&#160;happens&#160;by&#160;the</p>
<p style="position:absolute;top:1027px;left:441px;white-space:nowrap" class="ft4773">TPM</p>
<p style="position:absolute;top:1027px;left:474px;white-space:nowrap" class="ft478">_</p>
<p style="position:absolute;top:1027px;left:481px;white-space:nowrap" class="ft4773">extend</p>
<p style="position:absolute;top:1027px;left:526px;white-space:nowrap" class="ft478">operation&#160;(step&#160;1.1.3.1).&#160;Thereafter,</p>
<p style="position:absolute;top:1045px;left:226px;white-space:nowrap" class="ft478">a</p>
<p style="position:absolute;top:1045px;left:237px;white-space:nowrap" class="ft4773">TPM</p>
<p style="position:absolute;top:1045px;left:270px;white-space:nowrap" class="ft478">_</p>
<p style="position:absolute;top:1045px;left:277px;white-space:nowrap" class="ft4773">Quote</p>
<p style="position:absolute;top:1045px;left:320px;white-space:nowrap" class="ft478">gets&#160;created&#160;and&#160;returned&#160;to&#160;the&#160;ASM&#160;(steps&#160;1.1.3.2&#160;and&#160;1.1.3.3).&#160;The</p>
<p style="position:absolute;top:1063px;left:226px;white-space:nowrap" class="ft478">ASM&#160;wraps&#160;the</p>
<p style="position:absolute;top:1063px;left:322px;white-space:nowrap" class="ft4773">TPM</p>
<p style="position:absolute;top:1063px;left:355px;white-space:nowrap" class="ft478">_</p>
<p style="position:absolute;top:1063px;left:362px;white-space:nowrap" class="ft4773">Quote</p>
<p style="position:absolute;top:1063px;left:404px;white-space:nowrap" class="ft478">into&#160;an</p>
<p style="position:absolute;top:1063px;left:448px;white-space:nowrap" class="ft4773">attestationResponse</p>
<p style="position:absolute;top:1063px;left:576px;white-space:nowrap" class="ft478">and&#160;returns&#160;it&#160;to&#160;the&#160;IM.&#160;The</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft4721">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 48 -->
<a name="48"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page48-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5048.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft488">46</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft4821">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:599px;left:245px;white-space:nowrap" class="ft488">Figure&#160;5.9:&#160;Creation&#160;of&#160;a&#160;VM&#160;with&#160;TPM-based&#160;sealing</p>
<p style="position:absolute;top:647px;left:150px;white-space:nowrap" class="ft4873">attestationResponse</p>
<p style="position:absolute;top:647px;left:278px;white-space:nowrap" class="ft488">includes&#160;not&#160;only&#160;the</p>
<p style="position:absolute;top:647px;left:408px;white-space:nowrap" class="ft4873">TPM</p>
<p style="position:absolute;top:647px;left:440px;white-space:nowrap" class="ft488">_</p>
<p style="position:absolute;top:647px;left:448px;white-space:nowrap" class="ft4873">Quote</p>
<p style="position:absolute;top:647px;left:490px;white-space:nowrap" class="ft488">but&#160;also&#160;the&#160;relevant&#160;log&#160;files.</p>
<p style="position:absolute;top:665px;left:150px;white-space:nowrap" class="ft488">The&#160;IM&#160;returns&#160;the</p>
<p style="position:absolute;top:665px;left:266px;white-space:nowrap" class="ft4873">attestationResponse</p>
<p style="position:absolute;top:665px;left:395px;white-space:nowrap" class="ft488">to&#160;the&#160;CM&#160;(step&#160;1.2),&#160;which&#160;forwards&#160;it&#160;to&#160;the</p>
<p style="position:absolute;top:683px;left:150px;white-space:nowrap" class="ft488">verifier&#160;(step&#160;2).</p>
<p style="position:absolute;top:701px;left:172px;white-space:nowrap" class="ft488">A&#160;verifier&#160;can&#160;check&#160;the&#160;attestation&#160;result&#160;by&#160;recomputing&#160;a&#160;hash&#160;over&#160;the&#160;attestation</p>
<p style="position:absolute;top:719px;left:150px;white-space:nowrap" class="ft488">targets&#160;(i.e.,&#160;the&#160;relevant&#160;log&#160;files)&#160;specified&#160;in&#160;the</p>
<p style="position:absolute;top:719px;left:448px;white-space:nowrap" class="ft4873">attestationResponse</p>
<p style="position:absolute;top:719px;left:576px;white-space:nowrap" class="ft488">and&#160;comparing</p>
<p style="position:absolute;top:737px;left:150px;white-space:nowrap" class="ft488">the&#160;resulting&#160;hash&#160;with&#160;the&#160;hash&#160;in&#160;the&#160;PCR&#160;from&#160;the</p>
<p style="position:absolute;top:736px;left:467px;white-space:nowrap" class="ft4873">TPM</p>
<p style="position:absolute;top:737px;left:500px;white-space:nowrap" class="ft488">_</p>
<p style="position:absolute;top:736px;left:507px;white-space:nowrap" class="ft4873">Quote</p>
<p style="position:absolute;top:737px;left:545px;white-space:nowrap" class="ft488">.</p>
<p style="position:absolute;top:755px;left:172px;white-space:nowrap" class="ft488">The&#160;PCR&#160;in&#160;which&#160;the&#160;measurement&#160;result&#160;is&#160;stored&#160;will&#160;be&#160;reset&#160;after&#160;the&#160;attestation</p>
<p style="position:absolute;top:773px;left:150px;white-space:nowrap" class="ft4815">process&#160;has&#160;finished.&#160;Therefore,&#160;our&#160;prototype&#160;requires&#160;a&#160;TCG&#160;1.2&#160;compliant&#160;TPM,&#160;and<br/>the</p>
<p style="position:absolute;top:792px;left:172px;white-space:nowrap" class="ft4834">dest</p>
<p style="position:absolute;top:791px;left:212px;white-space:nowrap" class="ft488">PCR&#160;has&#160;to&#160;be</p>
<p style="position:absolute;top:790px;left:300px;white-space:nowrap" class="ft4848">16</p>
<p style="position:absolute;top:791px;left:319px;white-space:nowrap" class="ft488">or&#160;higher.</p>
<p style="position:absolute;top:850px;left:150px;white-space:nowrap" class="ft4824"><b>5.5.2</b></p>
<p style="position:absolute;top:850px;left:204px;white-space:nowrap" class="ft4824"><b>(Re-)Starting&#160;a&#160;VM&#160;with&#160;TPM-based&#160;Sealing</b></p>
<p style="position:absolute;top:880px;left:150px;white-space:nowrap" class="ft4814">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#48">5.9&#160;</a>shows&#160;the&#160;component&#160;interactions&#160;for&#160;(re-)starting&#160;a&#160;VM&#160;with&#160;a&#160;sealed&#160;disk<br/>image.&#160;In&#160;this&#160;use&#160;case,&#160;we&#160;show&#160;how&#160;to&#160;enforce&#160;a&#160;policy&#160;that&#160;specifies&#160;that&#160;the&#160;key&#160;for<br/>decrypting&#160;the&#160;disk&#160;image&#160;be&#160;revealed&#160;only&#160;after&#160;measuring&#160;the&#160;disk&#160;image&#160;and&#160;only&#160;if<br/>the&#160;measurement&#160;value&#160;written&#160;into&#160;a&#160;specified&#160;PCR&#160;matches&#160;the&#160;value&#160;against&#160;which<br/>the&#160;key&#160;was&#160;sealed.</p>
<p style="position:absolute;top:969px;left:172px;white-space:nowrap" class="ft488">The&#160;user&#160;interacts&#160;with&#160;the&#160;CM&#160;through&#160;the</p>
<p style="position:absolute;top:969px;left:455px;white-space:nowrap" class="ft4873">startVM</p>
<p style="position:absolute;top:969px;left:512px;white-space:nowrap" class="ft488">call&#160;to&#160;(re-)start&#160;the&#160;VM</p>
<p style="position:absolute;top:987px;left:150px;white-space:nowrap" class="ft4814">(step&#160;1).&#160;After&#160;determining&#160;that&#160;the&#160;disk&#160;image&#160;has&#160;to&#160;be&#160;first&#160;decrypted&#160;through&#160;unseal-<br/>ing,&#160;the&#160;CM&#160;obtains&#160;the&#160;<i>sealing&#160;descriptor&#160;</i>that&#160;was&#160;given&#160;to&#160;it&#160;at&#160;the&#160;time&#160;of&#160;sealing.<br/>Like&#160;the&#160;attestation&#160;descriptor,&#160;the&#160;sealing&#160;descriptor&#160;also&#160;contains&#160;one&#160;or&#160;more&#160;mea-<br/>surement&#160;descriptors,&#160;which&#160;are&#160;used&#160;to&#160;let&#160;the&#160;IM&#160;know&#160;the&#160;exact&#160;set&#160;of&#160;measurement<br/>plug-in&#160;modules&#160;to&#160;invoke.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft4821">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 49 -->
<a name="49"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft49103{font-size:18px;line-height:20px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page49-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5049.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft498">CHAPTER&#160;5.&#160;POLICY&#160;ENFORCEMENT&#160;AND&#160;COMPLIANCE</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft498">47</p>
<p style="position:absolute;top:194px;left:290px;white-space:nowrap" class="ft49102">&lt;sealing-desc&gt;</p>
<p style="position:absolute;top:211px;left:307px;white-space:nowrap" class="ft49102">&lt;sealing&#160;type=&#34;tpm-based&#34;&#160;keyid=&#34;0x01&#34;&gt;</p>
<p style="position:absolute;top:227px;left:323px;white-space:nowrap" class="ft49102">&lt;measurement-desc&#160;type=&#34;tpm&#34;&gt;</p>
<p style="position:absolute;top:243px;left:355px;white-space:nowrap" class="ft49102">&lt;measureTarget</p>
<p style="position:absolute;top:260px;left:290px;white-space:nowrap" class="ft49102">‘‘</p>
<p style="position:absolute;top:260px;left:379px;white-space:nowrap" class="ft49102">name=&#34;file:/xenimages/vm1image&#34;</p>
<p style="position:absolute;top:276px;left:379px;white-space:nowrap" class="ft49102">desc=&#34;PCR16&#34;/&gt;</p>
<p style="position:absolute;top:293px;left:323px;white-space:nowrap" class="ft49102">&lt;/measurement-desc&gt;</p>
<p style="position:absolute;top:309px;left:307px;white-space:nowrap" class="ft49102">&lt;/sealing&gt;</p>
<p style="position:absolute;top:326px;left:290px;white-space:nowrap" class="ft49102">&lt;/sealing-desc&gt;</p>
<p style="position:absolute;top:374px;left:365px;white-space:nowrap" class="ft498">Figure&#160;5.10:&#160;Sealing&#160;descriptor&#160;in&#160;XML</p>
<p style="position:absolute;top:422px;left:248px;white-space:nowrap" class="ft498">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#49">5.10&#160;</a>shows&#160;an&#160;example&#160;sealing&#160;descriptor&#160;as&#160;an&#160;XML&#160;structure.&#160;It&#160;contains</p>
<p style="position:absolute;top:440px;left:226px;white-space:nowrap" class="ft498">an</p>
<p style="position:absolute;top:441px;left:244px;white-space:nowrap" class="ft4934">&lt;sealing&gt;</p>
<p style="position:absolute;top:440px;left:329px;white-space:nowrap" class="ft498">section,&#160;which&#160;defines&#160;the&#160;type&#160;of&#160;sealing&#160;(</p>
<p style="position:absolute;top:441px;left:585px;white-space:nowrap" class="ft4934">tpm-based</p>
<p style="position:absolute;top:440px;left:666px;white-space:nowrap" class="ft498">)&#160;and&#160;the&#160;pa-</p>
<p style="position:absolute;top:458px;left:226px;white-space:nowrap" class="ft4914">rameters&#160;needed&#160;for&#160;unsealing&#160;(the&#160;identifier&#160;of&#160;the&#160;key&#160;protected&#160;by&#160;the&#160;TPM).&#160;Nested<br/>in&#160;the&#160;sealing&#160;descriptor&#160;there&#160;is&#160;a&#160;measurement&#160;descriptor,&#160;which&#160;specifies&#160;a&#160;measure-<br/>ment&#160;target&#160;(</p>
<p style="position:absolute;top:494px;left:303px;white-space:nowrap" class="ft4934">measureTarget</p>
<p style="position:absolute;top:494px;left:420px;white-space:nowrap" class="ft498">)&#160;and&#160;a&#160;destination&#160;(</p>
<p style="position:absolute;top:494px;left:540px;white-space:nowrap" class="ft4934">dest</p>
<p style="position:absolute;top:494px;left:576px;white-space:nowrap" class="ft498">).&#160;The&#160;target&#160;indicates&#160;what</p>
<p style="position:absolute;top:511px;left:226px;white-space:nowrap" class="ft4914">is&#160;to&#160;be&#160;measured&#160;(in&#160;this&#160;case,&#160;a&#160;VM&#160;disk&#160;image),&#160;whereas&#160;the&#160;destination&#160;indicates<br/>where&#160;the&#160;result&#160;should&#160;be&#160;stored&#160;(in&#160;this&#160;case,&#160;the&#160;TPM’s&#160;PCR&#160;number&#160;16).</p>
<p style="position:absolute;top:547px;left:248px;white-space:nowrap" class="ft498">The&#160;CM&#160;calls&#160;the&#160;IM&#160;interface</p>
<p style="position:absolute;top:547px;left:434px;white-space:nowrap" class="ft4973">unsealKey</p>
<p style="position:absolute;top:547px;left:501px;white-space:nowrap" class="ft498">(step&#160;1.1),&#160;passing&#160;the&#160;sealing&#160;descriptor</p>
<p style="position:absolute;top:565px;left:226px;white-space:nowrap" class="ft4914">as&#160;a&#160;parameter.&#160;The&#160;IM&#160;extracts&#160;the&#160;measurement&#160;descriptor&#160;from&#160;the&#160;sealing&#160;descrip-<br/>tor&#160;and&#160;calls&#160;the</p>
<p style="position:absolute;top:583px;left:331px;white-space:nowrap" class="ft4973">measurevHD</p>
<p style="position:absolute;top:583px;left:416px;white-space:nowrap" class="ft498">interface&#160;of&#160;the&#160;SIP&#160;with&#160;the&#160;measurement&#160;descriptor</p>
<p style="position:absolute;top:601px;left:226px;white-space:nowrap" class="ft498">(step&#160;1.1.1).&#160;The&#160;plug-in&#160;reads&#160;the&#160;list&#160;of</p>
<p style="position:absolute;top:602px;left:477px;white-space:nowrap" class="ft4934">measureTargets</p>
<p style="position:absolute;top:601px;left:603px;white-space:nowrap" class="ft498">,&#160;and&#160;accordingly&#160;mea-</p>
<p style="position:absolute;top:619px;left:226px;white-space:nowrap" class="ft4915">sures&#160;the&#160;disk&#160;image.&#160;It&#160;returns&#160;a&#160;measurement&#160;result&#160;list&#160;to&#160;the&#160;IM&#160;(step&#160;1.1.2).&#160;The<br/>IM&#160;calls&#160;the&#160;ASM,&#160;which&#160;handles&#160;TPM-related&#160;functions&#160;(step&#160;1.1.3).&#160;The&#160;ASM&#160;writes<br/>the&#160;measurements&#160;to&#160;the&#160;TPM&#160;by&#160;invoking&#160;the</p>
<p style="position:absolute;top:654px;left:510px;white-space:nowrap" class="ft4973">TPM</p>
<p style="position:absolute;top:655px;left:543px;white-space:nowrap" class="ft498">_</p>
<p style="position:absolute;top:654px;left:550px;white-space:nowrap" class="ft4973">Extend</p>
<p style="position:absolute;top:655px;left:598px;white-space:nowrap" class="ft498">operation&#160;(step&#160;1.1.3.1).</p>
<p style="position:absolute;top:673px;left:226px;white-space:nowrap" class="ft498">Furthermore,&#160;the&#160;ASM&#160;performs&#160;the&#160;unsealing&#160;of&#160;the&#160;key&#160;requested&#160;by&#160;invoking&#160;the</p>
<p style="position:absolute;top:690px;left:226px;white-space:nowrap" class="ft4973">TPM</p>
<p style="position:absolute;top:691px;left:259px;white-space:nowrap" class="ft498">_</p>
<p style="position:absolute;top:690px;left:266px;white-space:nowrap" class="ft4973">Unseal</p>
<p style="position:absolute;top:691px;left:311px;white-space:nowrap" class="ft498">operation&#160;(step&#160;1.1.3.3).&#160;If&#160;the</p>
<p style="position:absolute;top:692px;left:493px;white-space:nowrap" class="ft4934">dest</p>
<p style="position:absolute;top:691px;left:532px;white-space:nowrap" class="ft498">PCR&#160;value&#160;matches&#160;the&#160;value&#160;at&#160;the</p>
<p style="position:absolute;top:709px;left:226px;white-space:nowrap" class="ft4914">time&#160;of&#160;sealing,&#160;then&#160;the&#160;disk&#160;is&#160;in&#160;the&#160;desired&#160;state&#160;and&#160;the&#160;unseal&#160;operation&#160;is&#160;success-<br/>ful&#160;(step&#160;1.1.3.4);&#160;in&#160;that&#160;case,&#160;the&#160;ASM&#160;returns&#160;a&#160;key&#160;back&#160;to&#160;the&#160;IM&#160;(step&#160;1.1.4),&#160;which<br/>in&#160;turn&#160;returns&#160;the&#160;key&#160;to&#160;the&#160;CM&#160;(step&#160;1.2).&#160;In&#160;case&#160;the&#160;unseal&#160;operation&#160;fails,&#160;the&#160;ASM<br/>would&#160;return&#160;a&#160;failure.&#160;The&#160;CM&#160;calls&#160;the&#160;SVDM&#160;function</p>
<p style="position:absolute;top:762px;left:570px;white-space:nowrap" class="ft4973">configAndUnlock</p>
<p style="position:absolute;top:762px;left:676px;white-space:nowrap" class="ft4948">()</p>
<p style="position:absolute;top:763px;left:691px;white-space:nowrap" class="ft498">to&#160;attach</p>
<p style="position:absolute;top:781px;left:226px;white-space:nowrap" class="ft4915">and&#160;unlock&#160;the&#160;disk&#160;(steps&#160;1.3&#160;and&#160;1.4).&#160;Upon&#160;successful&#160;completion&#160;of&#160;that&#160;function,<br/>the&#160;CM&#160;instructs&#160;the&#160;Xen&#160;hypervisor&#160;to&#160;actually&#160;start&#160;the&#160;VM&#160;(steps&#160;1.5&#160;and&#160;1.6).</p>
<p style="position:absolute;top:816px;left:248px;white-space:nowrap" class="ft498">For&#160;the&#160;sake&#160;of&#160;simplicity,&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#48">5.9&#160;</a>does&#160;not&#160;show&#160;details&#160;of&#160;key&#160;handling&#160;such&#160;as</p>
<p style="position:absolute;top:834px;left:226px;white-space:nowrap" class="ft498">loading&#160;a&#160;sealing&#160;wrapper&#160;key&#160;into&#160;the&#160;TPM.</p>
<p style="position:absolute;top:893px;left:226px;white-space:nowrap" class="ft4924"><b>5.5.3</b></p>
<p style="position:absolute;top:893px;left:280px;white-space:nowrap" class="ft49103"><b>Enforcement&#160;and&#160;Compliance&#160;Proofs&#160;for&#160;Information&#160;Flow<br/>Control</b></p>
<p style="position:absolute;top:944px;left:226px;white-space:nowrap" class="ft4914">Consider,&#160;for&#160;example,&#160;the&#160;virtual&#160;network&#160;topology&#160;shown&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#50">5.11&#160;</a>with&#160;four<br/>virtual&#160;network&#160;zones.&#160;The&#160;topology&#160;shows&#160;the&#160;network&#160;of&#160;a&#160;company&#160;(which&#160;we<br/>shall&#160;call&#160;the&#160;<i>customer&#160;</i>company)&#160;connected&#160;to&#160;the&#160;Internet&#160;via&#160;a&#160;demilitarized&#160;zone<br/>(DMZ).&#160;The&#160;customer&#160;network&#160;is&#160;also&#160;connected&#160;to&#160;a&#160;<i>management&#160;network&#160;</i>that&#160;allows<br/>an&#160;outsourcing&#160;provider&#160;to&#160;manage&#160;the&#160;customer&#160;systems.&#160;The&#160;management&#160;network&#160;is<br/>not&#160;connected&#160;to&#160;the&#160;Internet.</p>
<p style="position:absolute;top:1051px;left:248px;white-space:nowrap" class="ft498">An&#160;information&#160;flow-control&#160;matrix&#160;is&#160;a&#160;simple&#160;way&#160;of&#160;formalizing&#160;the&#160;system-wide</p>
<p style="position:absolute;top:1069px;left:226px;white-space:nowrap" class="ft498">flow-control&#160;objectives&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[18]</a>.&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#50">5.12&#160;</a>shows&#160;a&#160;sample&#160;matrix&#160;for&#160;the&#160;four&#160;virtual</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft4921">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 50 -->
<a name="50"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft50104{font-size:11px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page50-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5050.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft508">48</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft5021">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:206px;left:321px;white-space:nowrap" class="ft50104"><b>Customer</b></p>
<p style="position:absolute;top:217px;left:326px;white-space:nowrap" class="ft50104"><b>Network</b></p>
<p style="position:absolute;top:206px;left:428px;white-space:nowrap" class="ft50104"><b>Management</b></p>
<p style="position:absolute;top:217px;left:441px;white-space:nowrap" class="ft50104"><b>Network</b></p>
<p style="position:absolute;top:305px;left:339px;white-space:nowrap" class="ft50104"><b>DMZ</b></p>
<p style="position:absolute;top:305px;left:445px;white-space:nowrap" class="ft50104"><b>Internet</b></p>
<p style="position:absolute;top:367px;left:293px;white-space:nowrap" class="ft508">Figure&#160;5.11:&#160;Virtual&#160;network&#160;topology</p>
<p style="position:absolute;top:401px;left:251px;white-space:nowrap" class="ft508">from/to</p>
<p style="position:absolute;top:400px;left:330px;white-space:nowrap" class="ft5052">Cust</p>
<p style="position:absolute;top:400px;left:365px;white-space:nowrap" class="ft5046">.</p>
<p style="position:absolute;top:400px;left:387px;white-space:nowrap" class="ft5052">DMZ</p>
<p style="position:absolute;top:400px;left:445px;white-space:nowrap" class="ft5052">Mgmt</p>
<p style="position:absolute;top:400px;left:491px;white-space:nowrap" class="ft5046">.</p>
<p style="position:absolute;top:401px;left:513px;white-space:nowrap" class="ft5023"><b>Internet</b></p>
<p style="position:absolute;top:422px;left:251px;white-space:nowrap" class="ft5052">Cust</p>
<p style="position:absolute;top:421px;left:286px;white-space:nowrap" class="ft5046">.</p>
<p style="position:absolute;top:422px;left:330px;white-space:nowrap" class="ft508">1</p>
<p style="position:absolute;top:422px;left:387px;white-space:nowrap" class="ft508">1</p>
<p style="position:absolute;top:422px;left:445px;white-space:nowrap" class="ft508">1</p>
<p style="position:absolute;top:422px;left:513px;white-space:nowrap" class="ft508">0</p>
<p style="position:absolute;top:440px;left:251px;white-space:nowrap" class="ft5052">DMZ</p>
<p style="position:absolute;top:441px;left:330px;white-space:nowrap" class="ft508">1</p>
<p style="position:absolute;top:441px;left:387px;white-space:nowrap" class="ft508">1</p>
<p style="position:absolute;top:441px;left:445px;white-space:nowrap" class="ft508">0</p>
<p style="position:absolute;top:441px;left:513px;white-space:nowrap" class="ft508">1</p>
<p style="position:absolute;top:459px;left:251px;white-space:nowrap" class="ft5052">Mgmt</p>
<p style="position:absolute;top:458px;left:296px;white-space:nowrap" class="ft5046">.</p>
<p style="position:absolute;top:459px;left:330px;white-space:nowrap" class="ft508">1</p>
<p style="position:absolute;top:459px;left:387px;white-space:nowrap" class="ft508">0</p>
<p style="position:absolute;top:459px;left:445px;white-space:nowrap" class="ft508">1</p>
<p style="position:absolute;top:459px;left:513px;white-space:nowrap" class="ft508">0</p>
<p style="position:absolute;top:478px;left:251px;white-space:nowrap" class="ft5052">Internet</p>
<p style="position:absolute;top:478px;left:330px;white-space:nowrap" class="ft508">0</p>
<p style="position:absolute;top:478px;left:387px;white-space:nowrap" class="ft508">1</p>
<p style="position:absolute;top:478px;left:445px;white-space:nowrap" class="ft508">0</p>
<p style="position:absolute;top:478px;left:513px;white-space:nowrap" class="ft508">0</p>
<p style="position:absolute;top:525px;left:309px;white-space:nowrap" class="ft508">Figure&#160;5.12:&#160;Flow&#160;control&#160;matrix</p>
<p style="position:absolute;top:562px;left:206px;white-space:nowrap" class="ft50102">&lt;flow-policy&gt;</p>
<p style="position:absolute;top:578px;left:223px;white-space:nowrap" class="ft50102">&lt;zone&#160;id=&#34;customer-net&#34;&gt;</p>
<p style="position:absolute;top:595px;left:239px;white-space:nowrap" class="ft50102">&lt;permit&#160;id=&#34;mgmt-net&#34;&#160;/&gt;</p>
<p style="position:absolute;top:611px;left:239px;white-space:nowrap" class="ft50102">&lt;permit&#160;id=&#34;dmz&#34;&#160;/&gt;</p>
<p style="position:absolute;top:627px;left:223px;white-space:nowrap" class="ft50102">&lt;/zone&gt;&#160;...</p>
<p style="position:absolute;top:644px;left:206px;white-space:nowrap" class="ft50102">&lt;/flow-policy&gt;</p>
<p style="position:absolute;top:710px;left:284px;white-space:nowrap" class="ft508">Figure&#160;5.13:&#160;Flow&#160;control&#160;policy&#160;in&#160;XML</p>
<p style="position:absolute;top:758px;left:150px;white-space:nowrap" class="ft5015">network&#160;zones.&#160;Each&#160;matrix&#160;element&#160;represents&#160;a&#160;policy&#160;specifying&#160;the&#160;information<br/>flows&#160;permitted&#160;between&#160;a&#160;pair&#160;of&#160;network&#160;zones.&#160;The&#160;1&#160;elements&#160;along&#160;the&#160;matrix<br/>diagonal&#160;convey&#160;the&#160;fact&#160;that&#160;there&#160;is&#160;free&#160;information&#160;flow&#160;within&#160;each&#160;network&#160;zone.<br/>The&#160;0&#160;elements&#160;in&#160;the&#160;matrix&#160;are&#160;used&#160;to&#160;specify&#160;that&#160;there&#160;should&#160;be&#160;no&#160;information<br/>flow&#160;between&#160;two&#160;zones,&#160;e.g.,&#160;between&#160;the&#160;management&#160;zone&#160;and&#160;the&#160;Internet.</p>
<p style="position:absolute;top:848px;left:172px;white-space:nowrap" class="ft508">In&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[18]</a>,&#160;we&#160;described&#160;a&#160;Xen-based&#160;prototype&#160;of&#160;a&#160;secure&#160;network&#160;virtualization</p>
<p style="position:absolute;top:866px;left:150px;white-space:nowrap" class="ft5014">architecture&#160;that&#160;is&#160;based&#160;on&#160;the&#160;concept&#160;of&#160;Trusted&#160;Virtual&#160;Domains.&#160;The&#160;architecture<br/>allows&#160;arbitrary&#160;network&#160;topologies&#160;connecting&#160;VMs.&#160;For&#160;example,&#160;different&#160;VMs&#160;on<br/>the&#160;same&#160;physical&#160;infrastructure&#160;may&#160;belong&#160;to&#160;different&#160;virtual&#160;network&#160;zones.&#160;Despite<br/>this,&#160;the&#160;architecture&#160;ensures&#160;the&#160;enforcement&#160;of&#160;policy-based&#160;information&#160;flow&#160;control.<br/>We&#160;can&#160;use&#160;the&#160;architecture&#160;for&#160;enforcing&#160;the&#160;policies&#160;shown&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#50">5.12.</a></p>
<p style="position:absolute;top:955px;left:172px;white-space:nowrap" class="ft508">By&#160;combining&#160;the&#160;Xen&#160;prototypes&#160;of&#160;our&#160;PEV&#160;architecture&#160;and&#160;our&#160;secure&#160;network</p>
<p style="position:absolute;top:973px;left:150px;white-space:nowrap" class="ft5015">virtualization&#160;architecture,&#160;it&#160;is&#160;possible&#160;to&#160;validate&#160;the&#160;configuration&#160;of&#160;the&#160;virtual&#160;net-<br/>working&#160;subsystem&#160;on&#160;each&#160;host.&#160;The&#160;subsystem&#160;exports&#160;an&#160;XML&#160;version&#160;of&#160;its&#160;flow-<br/>control&#160;matrix,&#160;as&#160;shown&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#50">5.13.&#160;</a>The&#160;network&#160;measurement&#160;plug-in&#160;outputs<br/>the&#160;XML&#160;structure&#160;of&#160;the&#160;flow-control&#160;policy,&#160;when&#160;invoked&#160;by&#160;the&#160;IM.&#160;By&#160;request-<br/>ing&#160;attestation&#160;of&#160;the&#160;TCB&#160;and&#160;this&#160;policy,&#160;a&#160;verifier&#160;can&#160;obtain&#160;a&#160;compliance&#160;proof&#160;for<br/>the&#160;correct&#160;configuration&#160;of&#160;the&#160;virtual&#160;networking&#160;subsystem&#160;on&#160;a&#160;given&#160;host.&#160;At&#160;the</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft5021">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 51 -->
<a name="51"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page51-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5051.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft518">CHAPTER&#160;5.&#160;POLICY&#160;ENFORCEMENT&#160;AND&#160;COMPLIANCE</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft518">49</p>
<p style="position:absolute;top:194px;left:244px;white-space:nowrap" class="ft51102">&lt;xsl:template</p>
<p style="position:absolute;top:211px;left:260px;white-space:nowrap" class="ft51102">match=&#34;/flow-policy/zone[@id=’customer-net’]&#34;&gt;</p>
<p style="position:absolute;top:227px;left:260px;white-space:nowrap" class="ft51102">&lt;xsl:choose&gt;&#160;&lt;xsl:if</p>
<p style="position:absolute;top:243px;left:293px;white-space:nowrap" class="ft51102">test=&#34;count(*[@id=’dmz’])=1</p>
<p style="position:absolute;top:260px;left:341px;white-space:nowrap" class="ft51102">and&#160;count(*[@id=’mgmt-net’])=1&#34;&gt;</p>
<p style="position:absolute;top:276px;left:293px;white-space:nowrap" class="ft51102">&lt;true&#160;/&gt;</p>
<p style="position:absolute;top:293px;left:276px;white-space:nowrap" class="ft51102">&lt;/xsl:if&gt;</p>
<p style="position:absolute;top:309px;left:260px;white-space:nowrap" class="ft51102">&lt;/xsl:choose&gt;</p>
<p style="position:absolute;top:326px;left:244px;white-space:nowrap" class="ft51102">&lt;/xsl:template&gt;</p>
<p style="position:absolute;top:392px;left:397px;white-space:nowrap" class="ft518">Figure&#160;5.14:&#160;XSLT&#160;condition</p>
<p style="position:absolute;top:440px;left:226px;white-space:nowrap" class="ft5114">verifier,&#160;a&#160;XSLT&#160;stylesheet&#160;is&#160;used&#160;to&#160;perform&#160;further&#160;transformations&#160;on&#160;the&#160;XML&#160;file<br/>returned&#160;by&#160;the&#160;platform.&#160;The&#160;XSLT&#160;stylesheet&#160;is&#160;a&#160;concrete&#160;implementation&#160;of&#160;the&#160;at-<br/>testation&#160;predicate</p>
<p style="position:absolute;top:475px;left:338px;white-space:nowrap" class="ft5148">Π</p>
<p style="position:absolute;top:476px;left:353px;white-space:nowrap" class="ft518">(described&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#39">5.2.2)</a>,&#160;which&#160;assesses&#160;whether&#160;the&#160;platform</p>
<p style="position:absolute;top:494px;left:226px;white-space:nowrap" class="ft5114">is&#160;trustworthy&#160;from&#160;the&#160;verifier’s&#160;point&#160;of&#160;view.&#160;The&#160;result&#160;of&#160;the&#160;predicate&#160;will&#160;serve&#160;to<br/>convince&#160;the&#160;verifier&#160;that&#160;the&#160;policy&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#50">5.12&#160;</a>is&#160;the&#160;actual&#160;flow-control&#160;policy&#160;as<br/>enforced&#160;by&#160;the&#160;network&#160;subsystem.&#160;If&#160;access&#160;restriction&#160;is&#160;an&#160;important&#160;concern,&#160;the<br/>XML&#160;output&#160;from&#160;the&#160;plug-in&#160;modules&#160;may&#160;be&#160;first&#160;processed&#160;by&#160;an&#160;XSLT&#160;stylesheet<br/>that&#160;implements&#160;a&#160;access&#160;filter&#160;before&#160;passing&#160;it&#160;on&#160;to&#160;the&#160;verifier.&#160;In&#160;such&#160;a&#160;case,&#160;the<br/>stylesheet&#160;would&#160;be&#160;embedded&#160;in&#160;the&#160;platform&#160;TCB.</p>
<p style="position:absolute;top:601px;left:248px;white-space:nowrap" class="ft518">A&#160;user&#160;can&#160;also&#160;protect&#160;sensitive&#160;information&#160;(say,&#160;an&#160;encryption&#160;key)&#160;against&#160;access</p>
<p style="position:absolute;top:619px;left:226px;white-space:nowrap" class="ft5115">by&#160;an&#160;untrusted&#160;network&#160;configuration&#160;using&#160;a&#160;two-stage&#160;procedure.&#160;The&#160;first&#160;stage&#160;is<br/>sealing,&#160;in&#160;which&#160;the&#160;user&#160;has&#160;to&#160;specify&#160;the&#160;binary&#160;configuration&#160;of&#160;the&#160;TCB&#160;and&#160;condi-<br/>tions&#160;for&#160;checking&#160;whether&#160;a&#160;given&#160;network&#160;configuration&#160;is&#160;a&#160;trusted&#160;one.&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#51">5.14<br/></a>shows&#160;an&#160;XSLT&#160;script&#160;that&#160;encodes&#160;the&#160;condition&#160;that&#160;the&#160;customer&#160;network&#160;should&#160;be<br/>directly&#160;connected&#160;only&#160;to&#160;the&#160;DMZ&#160;and&#160;the&#160;management&#160;network&#160;of&#160;the&#160;outsourcing<br/>provider,&#160;but&#160;not&#160;to&#160;any&#160;other&#160;network.&#160;The&#160;input&#160;to&#160;the&#160;XSLT&#160;script&#160;is&#160;the&#160;XML&#160;pol-<br/>icy&#160;that&#160;is&#160;output&#160;by&#160;the&#160;network&#160;measurement&#160;plug-in.&#160;The&#160;XSLT&#160;script&#160;is&#160;a&#160;concrete<br/>realization&#160;of&#160;the&#160;user-specified&#160;predicate</p>
<p style="position:absolute;top:744px;left:482px;white-space:nowrap" class="ft5148">Π</p>
<p style="position:absolute;top:745px;left:499px;white-space:nowrap" class="ft518">in&#160;our&#160;formal&#160;model&#160;(Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#37">5.2)</a>.&#160;The</p>
<p style="position:absolute;top:763px;left:226px;white-space:nowrap" class="ft5114">user&#160;seals&#160;the&#160;key&#160;to&#160;both&#160;the&#160;state&#160;of&#160;the&#160;TCB&#160;and&#160;the&#160;value&#160;of&#160;a&#160;resettable&#160;PCR;&#160;the<br/>latter&#160;reflects&#160;the&#160;integrity&#160;of&#160;the&#160;XSLT&#160;script&#160;and&#160;the&#160;integrity&#160;of&#160;the&#160;plug-in&#160;identifier.<br/>The&#160;second&#160;stage&#160;is&#160;unsealing,&#160;in&#160;which&#160;the&#160;IM&#160;(i)&#160;obtains&#160;the&#160;result&#160;of&#160;the&#160;plug-in,&#160;(ii)<br/>applies&#160;the&#160;result&#160;as&#160;input&#160;to&#160;the&#160;XSLT&#160;script,&#160;(iii)&#160;extends&#160;the&#160;resettable&#160;PCR&#160;with&#160;the<br/>hash&#160;of&#160;the&#160;XSLT&#160;script&#160;and&#160;the&#160;network&#160;measurement&#160;plug-in&#160;identifier,&#160;and&#160;(iv)&#160;tries<br/>to&#160;unseal&#160;the&#160;actual&#160;key.&#160;For&#160;steps&#160;(iii)&#160;and&#160;(iv),&#160;the&#160;IM&#160;invokes&#160;the&#160;ASM.&#160;The&#160;TPM<br/>should&#160;only&#160;reveal&#160;the&#160;key&#160;if&#160;the&#160;TCB&#160;is&#160;correct&#160;and&#160;the&#160;XSLT&#160;evaluated&#160;to</p>
<p style="position:absolute;top:871px;left:679px;white-space:nowrap" class="ft5134">&lt;true/&gt;</p>
<p style="position:absolute;top:888px;left:226px;white-space:nowrap" class="ft518">when&#160;executed&#160;on&#160;their&#160;output.</p>
<p style="position:absolute;top:952px;left:226px;white-space:nowrap" class="ft5126"><b>5.6</b></p>
<p style="position:absolute;top:952px;left:274px;white-space:nowrap" class="ft5126"><b>Conclusion</b></p>
<p style="position:absolute;top:990px;left:226px;white-space:nowrap" class="ft5115">We&#160;introduced&#160;a&#160;formal&#160;model&#160;for&#160;managing&#160;the&#160;integrity&#160;of&#160;arbitrary&#160;aspects&#160;of&#160;a<br/>virtualized&#160;system&#160;and&#160;evaluating&#160;system&#160;compliance&#160;with&#160;respect&#160;to&#160;given&#160;security<br/>policies.&#160;Based&#160;on&#160;the&#160;model,&#160;we&#160;described&#160;an&#160;architecture,&#160;called&#160;PEV,&#160;for&#160;protecting<br/>security&#160;policies&#160;against&#160;modification,&#160;and&#160;allowing&#160;stakeholders&#160;to&#160;verify&#160;the&#160;poli-<br/>cies&#160;actually&#160;implemented.&#160;We&#160;generalized&#160;the&#160;integrity&#160;management&#160;functions&#160;of&#160;the</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft5121">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 52 -->
<a name="52"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page52-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5052.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft528">50</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft5221">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft5214">Trusted&#160;Platform&#160;Module,&#160;so&#160;that&#160;they&#160;are&#160;applicable&#160;not&#160;just&#160;for&#160;software&#160;binaries,&#160;but<br/>also&#160;for&#160;checking&#160;security&#160;compliance&#160;and&#160;enforcing&#160;security&#160;policies.&#160;We&#160;described<br/>a&#160;prototype&#160;implementation&#160;of&#160;the&#160;architecture&#160;based&#160;on&#160;the&#160;Xen&#160;hypervisor.&#160;We&#160;also<br/>presented&#160;multiple&#160;use&#160;cases&#160;to&#160;demonstrate&#160;the&#160;policy&#160;enforcement&#160;and&#160;compliance<br/>checking&#160;capabilities&#160;of&#160;our&#160;implementation.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft5221">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 53 -->
<a name="53"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page53-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5053.png" alt="background image"/>
<p style="position:absolute;top:295px;left:226px;white-space:nowrap" class="ft5325"><b>Chapter&#160;6</b></p>
<p style="position:absolute;top:365px;left:226px;white-space:nowrap" class="ft5335"><b>Hierarchical&#160;Integrity<br/>Management&#160;for&#160;Complex<br/>Trusted&#160;Platforms</b></p>
<p style="position:absolute;top:548px;left:277px;white-space:nowrap" class="ft538">Serdar&#160;Cabuk,&#160;David&#160;Plaquin&#160;(HP),&#160;Theodore&#160;Hong,&#160;Derek&#160;Murray,&#160;Eric&#160;John</p>
<p style="position:absolute;top:566px;left:692px;white-space:nowrap" class="ft538">(CUCL)</p>
<p style="position:absolute;top:644px;left:226px;white-space:nowrap" class="ft5326"><b>6.1</b></p>
<p style="position:absolute;top:644px;left:274px;white-space:nowrap" class="ft5326"><b>Introduction</b></p>
<p style="position:absolute;top:682px;left:226px;white-space:nowrap" class="ft5314">Trusted&#160;Computing&#160;has&#160;been&#160;proposed&#160;as&#160;a&#160;means&#160;of&#160;providing&#160;verifiable&#160;trust&#160;in&#160;a<br/>computing&#160;platform.&#160;However,&#160;as&#160;virtualization&#160;becomes&#160;more&#160;popular&#160;and&#160;platform<br/>changes&#160;(such&#160;as&#160;security&#160;patches)&#160;occur&#160;more&#160;frequently,&#160;the&#160;established&#160;model&#160;for<br/>Trusted&#160;Computing&#160;is&#160;insufficient&#160;to&#160;cope&#160;in&#160;real-world&#160;scenarios.&#160;We&#160;therefore&#160;intro-<br/>duce&#160;an&#160;extensible&#160;integrity&#160;management&#160;framework&#160;that&#160;is&#160;better&#160;suited&#160;to&#160;deal&#160;with<br/>complicated&#160;trust&#160;dependencies&#160;and&#160;change&#160;management.</p>
<p style="position:absolute;top:790px;left:248px;white-space:nowrap" class="ft538">The&#160;goal&#160;of&#160;Trusted&#160;Computing&#160;is&#160;to&#160;enable&#160;third&#160;parties&#160;to&#160;remotely&#160;attest&#160;and</p>
<p style="position:absolute;top:808px;left:226px;white-space:nowrap" class="ft5315">verify&#160;the&#160;configuration&#160;of&#160;a&#160;computing&#160;platform&#160;in&#160;a&#160;secure&#160;manner.&#160;Existing&#160;<i>trusted<br/>platforms&#160;</i>typically&#160;contain&#160;a&#160;component&#160;that&#160;is&#160;at&#160;least&#160;logically&#160;protected&#160;from&#160;sub-<br/>version.&#160;The&#160;implicitly&#160;trusted&#160;components&#160;of&#160;a&#160;trusted&#160;platform&#160;–&#160;in&#160;particular,&#160;the<br/>hardware&#160;Trusted&#160;Platform&#160;Module&#160;(TPM)&#160;–&#160;can&#160;be&#160;used&#160;to&#160;store&#160;integrity&#160;measure-<br/>ments,&#160;and&#160;subsequently&#160;report&#160;these&#160;to&#160;users&#160;(or&#160;remote&#160;entities)&#160;with&#160;a&#160;cryptographic<br/>guarantee&#160;of&#160;their&#160;veracity.&#160;Users&#160;can&#160;then&#160;compare&#160;the&#160;reported&#160;measurements&#160;with<br/>known&#160;or&#160;expected&#160;values,&#160;and&#160;thereby&#160;infer&#160;whether&#160;the&#160;platform&#160;is&#160;operating&#160;as&#160;ex-<br/>pected&#160;(e.g.,&#160;it&#160;is&#160;running&#160;the&#160;expected&#160;software&#160;with&#160;the&#160;expected&#160;configuration&#160;while<br/>enforcing&#160;the&#160;expected&#160;policies).</p>
<p style="position:absolute;top:969px;left:248px;white-space:nowrap" class="ft538">Present&#160;implementations&#160;of&#160;Trusted&#160;Computing&#160;technology&#160;can&#160;take&#160;immutable</p>
<p style="position:absolute;top:987px;left:226px;white-space:nowrap" class="ft5315">snapshots&#160;of&#160;a&#160;whole&#160;platform,&#160;which&#160;can&#160;then&#160;be&#160;used&#160;as&#160;proof&#160;of&#160;trustworthi-<br/>ness&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[104,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">39,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">54,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">35]</a>.&#160;They&#160;do&#160;not,&#160;however,&#160;provide&#160;more&#160;granular&#160;verifications&#160;of<br/>platform&#160;components&#160;such&#160;as&#160;individual&#160;virtual&#160;machines&#160;(VMs)&#160;and&#160;applications.&#160;The<br/>platform&#160;is&#160;treated&#160;as&#160;a&#160;whole,&#160;and&#160;while&#160;it&#160;is&#160;possible&#160;to&#160;store&#160;integrity&#160;measurements<br/>of&#160;VMs&#160;and&#160;applications,&#160;the&#160;limited&#160;amount&#160;of&#160;storage&#160;in&#160;a&#160;TPM&#160;means&#160;that&#160;it&#160;is&#160;not</p>
<p style="position:absolute;top:1117px;left:476px;white-space:nowrap" class="ft538">51</p>
</div>
<!-- Page 54 -->
<a name="54"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page54-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5054.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft548">52</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft5421">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft5414">possible&#160;to&#160;represent&#160;individual&#160;components&#160;and&#160;the&#160;dependencies&#160;between&#160;them.&#160;Fur-<br/>thermore,&#160;it&#160;is&#160;not&#160;possible&#160;to&#160;manage&#160;changes&#160;to&#160;measured&#160;components.&#160;The&#160;current<br/>scheme&#160;advocated&#160;by&#160;the&#160;Trusted&#160;Computing&#160;Group&#160;(TCG)&#160;deems&#160;all&#160;such&#160;changes<br/>to&#160;be&#160;malicious&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[114]</a>.&#160;This&#160;is&#160;certainly&#160;impractical&#160;for&#160;modern&#160;server&#160;environments,<br/>which&#160;undergo&#160;a&#160;constant&#160;bombardment&#160;of&#160;security&#160;patches&#160;and&#160;policy&#160;changes.&#160;In<br/>2007&#160;alone,&#160;Microsoft&#160;released&#160;11&#160;security&#160;related&#160;patches&#160;for&#160;the&#160;Windows&#160;operating<br/>system&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[3]</a>,&#160;while&#160;a&#160;typical&#160;enterprise&#160;anti-virus&#160;application&#160;will&#160;undergo&#160;two&#160;to&#160;five<br/>updates&#160;in&#160;an&#160;average&#160;week&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#172">[80]</a>.</p>
<p style="position:absolute;top:337px;left:172px;white-space:nowrap" class="ft548">In&#160;this&#160;paper,&#160;we&#160;introduce&#160;an&#160;extensible&#160;integrity&#160;management&#160;framework&#160;that</p>
<p style="position:absolute;top:355px;left:150px;white-space:nowrap" class="ft5415">addresses&#160;these&#160;two&#160;shortcomings.&#160;To&#160;improve&#160;integrity&#160;management,&#160;we&#160;explicitly<br/>represent&#160;integrity&#160;dependencies&#160;between&#160;platform&#160;components&#160;by&#160;giving&#160;individual<br/>registers&#160;to&#160;each&#160;component&#160;to&#160;store&#160;their&#160;integrity&#160;measurements,&#160;and&#160;chaining&#160;these<br/>components&#160;together&#160;in&#160;a&#160;dependency&#160;graph.&#160;To&#160;improve&#160;change&#160;management,&#160;we<br/>introduce&#160;a&#160;new&#160;distinction&#160;between&#160;reversible&#160;and&#160;irreversible&#160;changes&#160;to&#160;measured<br/>components.&#160;A&#160;reversible&#160;change&#160;is&#160;one&#160;that&#160;can&#160;be&#160;undone&#160;and&#160;is&#160;guaranteed&#160;not&#160;to<br/>have&#160;any&#160;permanent&#160;effects.&#160;The&#160;introduction&#160;of&#160;reversible&#160;changes&#160;allows&#160;the&#160;platform<br/>integrity&#160;to&#160;be&#160;modified&#160;temporarily,&#160;for&#160;example&#160;when&#160;a&#160;device&#160;is&#160;hot-plugged&#160;and<br/>then&#160;removed.&#160;Although&#160;the&#160;platform&#160;may&#160;no&#160;longer&#160;be&#160;considered&#160;trustworthy&#160;during<br/>the&#160;time&#160;that&#160;the&#160;change&#160;holds,&#160;its&#160;integrity&#160;can&#160;be&#160;safely&#160;restored&#160;after&#160;the&#160;change&#160;is<br/>undone.</p>
<p style="position:absolute;top:552px;left:172px;white-space:nowrap" class="ft548">Our&#160;resulting&#160;framework&#160;gives&#160;a&#160;better&#160;understanding&#160;of&#160;a&#160;platform’s&#160;security&#160;prop-</p>
<p style="position:absolute;top:570px;left:150px;white-space:nowrap" class="ft5415">erties,&#160;which&#160;can&#160;be&#160;used&#160;in&#160;policy&#160;verification.&#160;Like&#160;existing&#160;Trusted&#160;Computing&#160;im-<br/>plementations,&#160;our&#160;services&#160;can&#160;be&#160;used&#160;to&#160;grant&#160;access&#160;to&#160;protected&#160;resources&#160;(such<br/>as&#160;encrypted&#160;storage)&#160;only&#160;when&#160;the&#160;policy&#160;is&#160;satisfied;&#160;however,&#160;unlike&#160;existing&#160;im-<br/>plementations,&#160;these&#160;policies&#160;can&#160;be&#160;more&#160;fine-grained,&#160;dynamic,&#160;and&#160;flexible.&#160;Our<br/>prototype&#160;implementation,&#160;built&#160;on&#160;the&#160;Xen&#160;virtual&#160;machine&#160;monitor&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[30]</a>,&#160;includes<br/>the&#160;integrity&#160;management&#160;framework&#160;and&#160;a&#160;credential&#160;manager&#160;service,&#160;which&#160;demon-<br/>strates&#160;the&#160;use&#160;of&#160;enhanced&#160;policy&#160;checks&#160;to&#160;control&#160;access&#160;to&#160;security&#160;credentials.</p>
<p style="position:absolute;top:736px;left:150px;white-space:nowrap" class="ft5423"><b>Chapter&#160;Outline</b></p>
<p style="position:absolute;top:736px;left:271px;white-space:nowrap" class="ft548">Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#54">6.2&#160;</a>outlines&#160;the&#160;motivation&#160;and&#160;high-level&#160;design&#160;for&#160;our</p>
<p style="position:absolute;top:754px;left:150px;white-space:nowrap" class="ft5415">integrity&#160;management&#160;framework.&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#56">6.3&#160;</a>presents&#160;the&#160;basic&#160;framework,&#160;which<br/>provides&#160;integrity&#160;services&#160;to&#160;individual&#160;components;&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#60">6.4&#160;</a>extends&#160;this&#160;into&#160;re-<br/>versible&#160;integrity&#160;changes&#160;and&#160;an&#160;explicit&#160;dependency&#160;graph,&#160;and&#160;provides&#160;use&#160;cases<br/>for&#160;this&#160;model.&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#65">6.5&#160;</a>presents&#160;some&#160;examples&#160;of&#160;security&#160;services&#160;that&#160;could<br/>make&#160;use&#160;of&#160;our&#160;framework.&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#66">6.6&#160;</a>describes&#160;our&#160;prototype&#160;implementation&#160;of&#160;the<br/>framework&#160;and&#160;the&#160;credential&#160;management&#160;service&#160;on&#160;Xen.&#160;Finally,&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#70">6.7&#160;</a>we<br/>draw&#160;some&#160;conclusions.</p>
<p style="position:absolute;top:907px;left:150px;white-space:nowrap" class="ft5426"><b>6.2</b></p>
<p style="position:absolute;top:907px;left:198px;white-space:nowrap" class="ft5426"><b>Design&#160;Overview</b></p>
<p style="position:absolute;top:945px;left:150px;white-space:nowrap" class="ft5414">The&#160;typical&#160;design&#160;for&#160;a&#160;trusted&#160;platform&#160;comprises&#160;a&#160;hardware&#160;TPM&#160;and&#160;software&#160;in-<br/>tegrity&#160;management&#160;services.&#160;These&#160;services&#160;measure&#160;platform&#160;components,&#160;store&#160;in-<br/>tegrity&#160;measurements&#160;as&#160;immutable&#160;logs&#160;and&#160;attest&#160;these&#160;measurements&#160;to&#160;third&#160;parties.<br/>The&#160;services&#160;use&#160;the&#160;TPM&#160;to&#160;provide&#160;a&#160;link&#160;with&#160;the&#160;CRTM.&#160;In&#160;a&#160;non-virtualized&#160;plat-<br/>form,&#160;with&#160;relatively&#160;few&#160;components&#160;to&#160;be&#160;measured,&#160;this&#160;model&#160;is&#160;sufficient.&#160;How-<br/>ever,&#160;it&#160;does&#160;not&#160;scale&#160;to&#160;complex&#160;virtualized&#160;platforms&#160;that&#160;have&#160;a&#160;plethora&#160;of&#160;com-<br/>ponents&#160;and&#160;dependencies&#160;between&#160;these&#160;components.&#160;In&#160;this&#160;section,&#160;we&#160;first&#160;discuss</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft5421">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 55 -->
<a name="55"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page55-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5055.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft558">CHAPTER&#160;6.&#160;HIERARCHICAL&#160;INTEGRITY&#160;MANAGEMENT</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft558">53</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft5514">the&#160;limitations&#160;of&#160;the&#160;existing&#160;model.&#160;We&#160;then&#160;present&#160;the&#160;high-level&#160;design&#160;goals&#160;that<br/>motivate&#160;our&#160;integrity&#160;management&#160;framework.</p>
<p style="position:absolute;top:252px;left:226px;white-space:nowrap" class="ft5524"><b>6.2.1</b></p>
<p style="position:absolute;top:252px;left:280px;white-space:nowrap" class="ft5524"><b>Hardware&#160;Limitations</b></p>
<p style="position:absolute;top:282px;left:226px;white-space:nowrap" class="ft5514">Current&#160;integrity&#160;management&#160;systems&#160;typically&#160;employ&#160;the&#160;TPM&#160;as&#160;the&#160;sole&#160;repository<br/>for&#160;integrity&#160;measurements&#160;(see&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#31">4)</a>.&#160;Unfortunately,&#160;such&#160;schemes&#160;are&#160;funda-<br/>mentally&#160;limited&#160;by&#160;the&#160;hardware&#160;capabilities&#160;of&#160;a&#160;TPM:</p>
<p style="position:absolute;top:351px;left:245px;white-space:nowrap" class="ft558">1.&#160;A&#160;TPM&#160;contains&#160;a&#160;small,&#160;limited&#160;amount&#160;of&#160;memory&#160;(PCRs).&#160;The&#160;TCG&#160;spec-</p>
<p style="position:absolute;top:369px;left:263px;white-space:nowrap" class="ft5514">ification&#160;recommends&#160;that&#160;a&#160;TPM&#160;has&#160;at&#160;least&#160;16&#160;PCRs&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[114]</a>.&#160;Therefore,&#160;for<br/>portability,&#160;we&#160;cannot&#160;assume&#160;that&#160;a&#160;TPM&#160;will&#160;have&#160;any&#160;more&#160;than&#160;16&#160;PCRs.<br/>Hence,&#160;it&#160;is&#160;not&#160;feasible&#160;to&#160;store&#160;individual&#160;measurements&#160;for&#160;a&#160;large&#160;number&#160;of<br/>virtualized&#160;platform&#160;components.</p>
<p style="position:absolute;top:453px;left:245px;white-space:nowrap" class="ft558">2.&#160;The&#160;limited&#160;number&#160;of&#160;PCRs&#160;is&#160;typically&#160;addressed&#160;by&#160;aggregating&#160;measurements</p>
<p style="position:absolute;top:471px;left:263px;white-space:nowrap" class="ft5514">in&#160;the&#160;same&#160;register.&#160;Where&#160;two&#160;components&#160;are&#160;independent,&#160;this&#160;introduces&#160;a<br/>false&#160;dependency&#160;between&#160;them.&#160;Furthermore,&#160;the&#160;definition&#160;of&#160;the</p>
<p style="position:absolute;top:489px;left:688px;white-space:nowrap" class="ft5534">extend</p>
<p style="position:absolute;top:507px;left:263px;white-space:nowrap" class="ft5515">function&#160;introduces&#160;an&#160;artificial&#160;dependency&#160;on&#160;the&#160;order&#160;in&#160;which&#160;they&#160;are&#160;ag-<br/>gregated.</p>
<p style="position:absolute;top:554px;left:245px;white-space:nowrap" class="ft558">3.&#160;It&#160;is&#160;not&#160;possible&#160;to&#160;reverse&#160;the&#160;inclusion&#160;of&#160;a&#160;measurement&#160;in&#160;a&#160;TPM&#160;register.</p>
<p style="position:absolute;top:572px;left:263px;white-space:nowrap" class="ft5515">Therefore,&#160;it&#160;is&#160;impossible&#160;for&#160;a&#160;platform&#160;component&#160;to&#160;report&#160;a&#160;change&#160;to&#160;its<br/>integrity&#160;(e.g.&#160;by&#160;the&#160;dynamic&#160;loading&#160;of&#160;some&#160;code,&#160;or&#160;the&#160;connection&#160;of&#160;a&#160;new<br/>device)&#160;and&#160;revert&#160;back&#160;(after&#160;unloading/disconnection).</p>
<p style="position:absolute;top:641px;left:248px;white-space:nowrap" class="ft558">To&#160;illustrate&#160;these&#160;limitations,&#160;consider&#160;the&#160;following&#160;example.&#160;A&#160;server&#160;platform</p>
<p style="position:absolute;top:659px;left:226px;white-space:nowrap" class="ft5515">hosts&#160;tens&#160;of&#160;small&#160;VMs,&#160;each&#160;of&#160;which&#160;runs&#160;a&#160;particular&#160;service.&#160;To&#160;keep&#160;track&#160;of&#160;the<br/>platform&#160;integrity&#160;on&#160;a&#160;traditional&#160;TPM-based&#160;system,&#160;the&#160;measurements&#160;must&#160;be&#160;ag-<br/>gregated,&#160;because&#160;there&#160;are&#160;more&#160;VMs&#160;than&#160;PCRs.&#160;For&#160;example,&#160;it&#160;might&#160;be&#160;necessary<br/>to&#160;store&#160;measurements&#160;for&#160;a&#160;virtual&#160;network&#160;switch&#160;and&#160;a&#160;virtual&#160;storage&#160;manager&#160;in&#160;the<br/>same&#160;PCR,&#160;which&#160;creates&#160;a&#160;false&#160;integrity&#160;dependency&#160;between&#160;these&#160;two&#160;VMs.&#160;If&#160;a<br/>malicious&#160;change&#160;is&#160;made&#160;to&#160;the&#160;virtual&#160;network&#160;switch,&#160;and&#160;this&#160;change&#160;is&#160;reported&#160;to<br/>the&#160;appropriate&#160;PCR,&#160;the&#160;integrity&#160;of&#160;the&#160;storage&#160;manager&#160;also&#160;appears&#160;to&#160;be&#160;compro-<br/>mised.&#160;The&#160;same&#160;is&#160;true&#160;for&#160;all&#160;other&#160;VMs&#160;whose&#160;measurements&#160;are&#160;aggregated&#160;in&#160;that<br/>PCR.</p>
<p style="position:absolute;top:820px;left:248px;white-space:nowrap" class="ft558">It&#160;would&#160;be&#160;possible&#160;to&#160;extend&#160;the&#160;set&#160;of&#160;PCRs&#160;by&#160;giving&#160;a&#160;virtual&#160;TPM&#160;to&#160;each</p>
<p style="position:absolute;top:838px;left:226px;white-space:nowrap" class="ft5514">platform&#160;component&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[13]</a>.&#160;However,&#160;by&#160;allocating&#160;independent&#160;virtual&#160;PCRs&#160;to&#160;each<br/>component,&#160;it&#160;is&#160;no&#160;longer&#160;possible&#160;to&#160;represent&#160;real&#160;dependencies&#160;between&#160;compo-<br/>nent<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#55">s</a></p>
<p style="position:absolute;top:872px;left:258px;white-space:nowrap" class="ft5527"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#55">1</a></p>
<p style="position:absolute;top:874px;left:264px;white-space:nowrap" class="ft558"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#55">.&#160;</a>Furthermore,&#160;since&#160;the&#160;virtual&#160;TPMs&#160;emulate&#160;the&#160;behavior&#160;of&#160;a&#160;hardware&#160;TPM,</p>
<p style="position:absolute;top:892px;left:226px;white-space:nowrap" class="ft558">it&#160;remains&#160;impossible&#160;to&#160;revert&#160;changes.</p>
<p style="position:absolute;top:933px;left:226px;white-space:nowrap" class="ft5524"><b>6.2.2</b></p>
<p style="position:absolute;top:933px;left:280px;white-space:nowrap" class="ft5524"><b>High-level&#160;Design</b></p>
<p style="position:absolute;top:963px;left:226px;white-space:nowrap" class="ft5514">It&#160;is&#160;clear&#160;that&#160;software&#160;measurement&#160;support&#160;is&#160;required&#160;to&#160;address&#160;the&#160;limitations&#160;of<br/>hardware&#160;capabilities.&#160;We&#160;refer&#160;to&#160;the&#160;set&#160;of&#160;software&#160;components&#160;that&#160;comprise&#160;the<br/>integrity&#160;framework&#160;as&#160;the&#160;<i>software&#160;root&#160;of&#160;trust&#160;for&#160;measurement&#160;(SRTM)</i>.&#160;These&#160;com-<br/>ponents&#160;are&#160;part&#160;of&#160;the&#160;platform&#160;TCB,&#160;and&#160;should&#160;be&#160;isolated&#160;from&#160;other&#160;components;</p>
<p style="position:absolute;top:1043px;left:242px;white-space:nowrap" class="ft5528">1</p>
<p style="position:absolute;top:1046px;left:248px;white-space:nowrap" class="ft5519">Some&#160;virtual&#160;TPM&#160;designs&#160;share&#160;a&#160;fixed&#160;number&#160;of&#160;PCRs&#160;between&#160;all&#160;virtual&#160;TPMs&#160;and&#160;the&#160;hardware</p>
<p style="position:absolute;top:1060px;left:226px;white-space:nowrap" class="ft5555">TPM,&#160;and&#160;these&#160;could&#160;be&#160;used&#160;to&#160;express&#160;dependencies.&#160;However,&#160;the&#160;reliance&#160;on&#160;the&#160;hardware&#160;TPM&#160;leads<br/>to&#160;the&#160;same&#160;limitations&#160;as&#160;a&#160;single-TPM&#160;scheme.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft5521">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 56 -->
<a name="56"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft56105{font-size:10px;font-family:ITPEVV+TTFF19o00;color:#000000;}
	.ft56106{font-size:7px;font-family:VRBBWM+TTFF1Ao00;color:#000000;}
-->
</style>
<div id="page56-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5056.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft568">54</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft5621">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:204px;left:221px;white-space:nowrap" class="ft56105">CRTM</p>
<p style="position:absolute;top:204px;left:221px;white-space:nowrap" class="ft56105">CRTM</p>
<p style="position:absolute;top:204px;left:280px;white-space:nowrap" class="ft56105">BIOS</p>
<p style="position:absolute;top:204px;left:280px;white-space:nowrap" class="ft56105">BIOS</p>
<p style="position:absolute;top:204px;left:328px;white-space:nowrap" class="ft56105">Boot&#160;Loader</p>
<p style="position:absolute;top:204px;left:328px;white-space:nowrap" class="ft56105">Boot&#160;Loader</p>
<p style="position:absolute;top:207px;left:396px;white-space:nowrap" class="ft56105">OS&#160;Kernel</p>
<p style="position:absolute;top:207px;left:396px;white-space:nowrap" class="ft56105">OS&#160;Kernel</p>
<p style="position:absolute;top:207px;left:463px;white-space:nowrap" class="ft56105">SRTM</p>
<p style="position:absolute;top:207px;left:463px;white-space:nowrap" class="ft56105">SRTM</p>
<p style="position:absolute;top:283px;left:222px;white-space:nowrap" class="ft56105">TPM</p>
<p style="position:absolute;top:283px;left:222px;white-space:nowrap" class="ft56105">TPM</p>
<p style="position:absolute;top:200px;left:565px;white-space:nowrap" class="ft56105">Dynamic</p>
<p style="position:absolute;top:212px;left:559px;white-space:nowrap" class="ft56105">Component</p>
<p style="position:absolute;top:200px;left:565px;white-space:nowrap" class="ft56105">Dynamic</p>
<p style="position:absolute;top:212px;left:559px;white-space:nowrap" class="ft56105">Component</p>
<p style="position:absolute;top:244px;left:577px;white-space:nowrap" class="ft56105">...</p>
<p style="position:absolute;top:273px;left:565px;white-space:nowrap" class="ft56105">Dynamic</p>
<p style="position:absolute;top:284px;left:559px;white-space:nowrap" class="ft56105">Component</p>
<p style="position:absolute;top:273px;left:565px;white-space:nowrap" class="ft56105">Dynamic</p>
<p style="position:absolute;top:284px;left:559px;white-space:nowrap" class="ft56105">Component</p>
<p style="position:absolute;top:290px;left:457px;white-space:nowrap" class="ft56105">Platform&#160;TCB</p>
<p style="position:absolute;top:259px;left:236px;white-space:nowrap" class="ft56106">hashes&#160;stored</p>
<p style="position:absolute;top:239px;left:508px;white-space:nowrap" class="ft56106">hashes&#160;stored</p>
<p style="position:absolute;top:334px;left:150px;white-space:nowrap" class="ft5614">Figure&#160;6.1:&#160;The&#160;position&#160;of&#160;the&#160;SRTM&#160;within&#160;the&#160;overall&#160;integrity&#160;management&#160;frame-<br/>work.</p>
<p style="position:absolute;top:394px;left:150px;white-space:nowrap" class="ft5615">for&#160;example,&#160;by&#160;virtualization.&#160;Dynamic&#160;components&#160;outside&#160;the&#160;platform&#160;TCB&#160;rely<br/>on&#160;the&#160;SRTM&#160;to&#160;store&#160;measurements&#160;on&#160;their&#160;behalf,&#160;rather&#160;than&#160;the&#160;underlying&#160;TPM.<br/>Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#56">6.1&#160;</a>illustrates&#160;the&#160;position&#160;of&#160;the&#160;SRTM&#160;within&#160;the&#160;overall&#160;integrity&#160;management<br/>framework.</p>
<p style="position:absolute;top:466px;left:172px;white-space:nowrap" class="ft568">Our&#160;framework&#160;has&#160;the&#160;following&#160;design&#160;objectives:</p>
<p style="position:absolute;top:495px;left:150px;white-space:nowrap" class="ft5623"><b>Unlimited&#160;measurement&#160;storage&#160;</b>The&#160;framework&#160;should&#160;allow&#160;the&#160;storage&#160;of&#160;individ-</p>
<p style="position:absolute;top:513px;left:187px;white-space:nowrap" class="ft568">ual&#160;integrity&#160;measurements&#160;for&#160;an&#160;arbitrary&#160;number&#160;of&#160;components.</p>
<p style="position:absolute;top:542px;left:150px;white-space:nowrap" class="ft5623"><b>Explicit&#160;dependency&#160;representation&#160;</b>The&#160;framework&#160;should&#160;allow&#160;the&#160;explicit&#160;and</p>
<p style="position:absolute;top:559px;left:187px;white-space:nowrap" class="ft5614">unambiguous&#160;representation&#160;of&#160;an&#160;arbitrary&#160;number&#160;of&#160;dependencies&#160;between<br/>platform&#160;components.&#160;There&#160;should&#160;be&#160;no&#160;false&#160;or&#160;artificial&#160;dependencies&#160;intro-<br/>duced&#160;by&#160;aggregation.</p>
<p style="position:absolute;top:624px;left:150px;white-space:nowrap" class="ft5623"><b>Static&#160;integrity&#160;management&#160;</b>The&#160;framework&#160;should&#160;provide&#160;a&#160;superset&#160;of&#160;the&#160;func-</p>
<p style="position:absolute;top:642px;left:187px;white-space:nowrap" class="ft568">tionality&#160;of&#160;a&#160;traditional&#160;TPM,&#160;with&#160;respect&#160;to&#160;static&#160;integrity.</p>
<p style="position:absolute;top:670px;left:150px;white-space:nowrap" class="ft5623"><b>Dynamic&#160;integrity&#160;management&#160;</b>The&#160;framework&#160;should&#160;enable&#160;the&#160;integrity&#160;state&#160;of</p>
<p style="position:absolute;top:688px;left:187px;white-space:nowrap" class="ft5615">a&#160;platform&#160;component&#160;to&#160;revert&#160;to&#160;a&#160;previous&#160;trusted&#160;state&#160;in&#160;a&#160;controlled&#160;and<br/>verifiable&#160;manner.</p>
<p style="position:absolute;top:735px;left:150px;white-space:nowrap" class="ft5623"><b>Link&#160;to&#160;hardware&#160;TPM&#160;</b>The&#160;software&#160;framework&#160;should&#160;be&#160;linked&#160;in&#160;a&#160;chain&#160;of&#160;trust</p>
<p style="position:absolute;top:753px;left:187px;white-space:nowrap" class="ft5615">to&#160;the&#160;hardware&#160;TPM.&#160;This&#160;can&#160;be&#160;achieved&#160;by&#160;storing&#160;the&#160;measurements&#160;for&#160;the<br/>SRTM&#160;and&#160;other&#160;static&#160;components&#160;in&#160;the&#160;platform&#160;TCB&#160;(such&#160;as&#160;the&#160;hypervisor<br/>and&#160;any&#160;physical&#160;device&#160;drivers)&#160;in&#160;the&#160;TPM.&#160;As&#160;this&#160;set&#160;of&#160;components&#160;is&#160;small<br/>and&#160;non-changing,&#160;the&#160;limitations&#160;of&#160;a&#160;hardware&#160;TPM&#160;do&#160;not&#160;come&#160;into&#160;effect.</p>
<p style="position:absolute;top:835px;left:150px;white-space:nowrap" class="ft5623"><b>Minimal&#160;TCB&#160;</b>In&#160;order&#160;to&#160;improve&#160;the&#160;trustworthiness&#160;of&#160;the&#160;framework,&#160;the&#160;SRTM</p>
<p style="position:absolute;top:853px;left:187px;white-space:nowrap" class="ft5614">and&#160;other&#160;components&#160;in&#160;the&#160;TCB&#160;should&#160;have&#160;a&#160;minimal&#160;amount&#160;of&#160;code&#160;and&#160;size<br/>of&#160;interface.&#160;This&#160;paper&#160;does&#160;not&#160;focus&#160;on&#160;minimizing&#160;the&#160;TCB,&#160;but&#160;a&#160;possible<br/>approach&#160;would&#160;involve&#160;using&#160;disaggregation&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">[83]</a>.</p>
<p style="position:absolute;top:917px;left:150px;white-space:nowrap" class="ft5623"><b>Platform&#160;independence&#160;</b>The&#160;framework&#160;should&#160;not&#160;be&#160;limited&#160;to&#160;a&#160;single&#160;hypervisor</p>
<p style="position:absolute;top:935px;left:187px;white-space:nowrap" class="ft5614">technology.&#160;Although&#160;the&#160;implementation&#160;(see&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#66">6.6)&#160;</a>was&#160;carried&#160;out&#160;using<br/>Xen,&#160;it&#160;should&#160;be&#160;possible&#160;to&#160;use&#160;alternative&#160;technologies,&#160;such&#160;as&#160;VMware&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[109]<br/></a>or&#160;an&#160;L4&#160;microkernel&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#172">[74]</a>.</p>
<p style="position:absolute;top:1016px;left:150px;white-space:nowrap" class="ft5626"><b>6.3</b></p>
<p style="position:absolute;top:1016px;left:198px;white-space:nowrap" class="ft5626"><b>Basic&#160;Integrity&#160;Management</b></p>
<p style="position:absolute;top:1054px;left:150px;white-space:nowrap" class="ft5614">In&#160;this&#160;section,&#160;we&#160;present&#160;a&#160;basic&#160;design&#160;for&#160;the&#160;SRTM&#160;service&#160;that&#160;we&#160;introduced<br/>earlier.&#160;This&#160;platform-independent&#160;service&#160;provides&#160;the&#160;minimal&#160;functionality&#160;needed</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft5621">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 57 -->
<a name="57"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft57107{font-size:12px;font-family:Courier;color:#000000;}
	.ft57108{font-size:9px;font-family:Courier;color:#000000;}
	.ft57109{font-size:19px;font-family:DMCZLT+TT1011Eo00;color:#000000;}
	.ft57110{font-size:13px;font-family:DUCRGK+TT1011Fo00;color:#000000;}
	.ft57111{font-size:22px;font-family:KPSHBO+TT10120o00;color:#000000;}
-->
</style>
<div id="page57-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5057.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft578">CHAPTER&#160;6.&#160;HIERARCHICAL&#160;INTEGRITY&#160;MANAGEMENT</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft578">55</p>
<p style="position:absolute;top:197px;left:351px;white-space:nowrap" class="ft57107">#</p>
<p style="position:absolute;top:197px;left:435px;white-space:nowrap" class="ft57107">CCRs</p>
<p style="position:absolute;top:197px;left:351px;white-space:nowrap" class="ft57107">#</p>
<p style="position:absolute;top:197px;left:435px;white-space:nowrap" class="ft57107">CCRs</p>
<p style="position:absolute;top:251px;left:287px;white-space:nowrap" class="ft57107">CCR03</p>
<p style="position:absolute;top:252px;left:343px;white-space:nowrap" class="ft57108"><b>2f:d2:c1:42:5c:ce:9e:ce:62:50:71:22:db:43:61:25:ab:82:be:55&#160;</b></p>
<p style="position:absolute;top:350px;left:226px;white-space:nowrap" class="ft5714">Figure&#160;6.2:&#160;Basic&#160;integrity&#160;management&#160;components&#160;–&#160;Component&#160;configuration&#160;reg-<br/>ister&#160;table.</p>
<p style="position:absolute;top:629px;left:460px;white-space:nowrap" class="ft57109">VMM&#160;and&#160;Hardware</p>
<p style="position:absolute;top:567px;left:584px;white-space:nowrap" class="ft57109">BMSI</p>
<p style="position:absolute;top:403px;left:341px;white-space:nowrap" class="ft57110">Management</p>
<p style="position:absolute;top:403px;left:444px;white-space:nowrap" class="ft57110">Protected&#160;Storage</p>
<p style="position:absolute;top:403px;left:576px;white-space:nowrap" class="ft57110">Integrity</p>
<p style="position:absolute;top:481px;left:594px;white-space:nowrap" class="ft57109">BIM</p>
<p style="position:absolute;top:536px;left:522px;white-space:nowrap" class="ft57111">...</p>
<p style="position:absolute;top:526px;left:342px;white-space:nowrap" class="ft57110">Management</p>
<p style="position:absolute;top:527px;left:449px;white-space:nowrap" class="ft57110">TPM</p>
<p style="position:absolute;top:686px;left:253px;white-space:nowrap" class="ft578">Figure&#160;6.3:&#160;Basic&#160;integrity&#160;management&#160;components&#160;–&#160;The&#160;BIM&#160;architecture.</p>
<p style="position:absolute;top:734px;left:226px;white-space:nowrap" class="ft5715">to&#160;manage&#160;the&#160;integrity&#160;of&#160;dynamic&#160;(non-TCB)&#160;platform&#160;components,&#160;which&#160;will&#160;be<br/>extended&#160;further&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#60">6.4.&#160;</a>Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#57">6.3.1&#160;</a>sets&#160;out&#160;the&#160;basic&#160;measurement&#160;model,<br/>while&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#59">6.3.2&#160;</a>describes&#160;the&#160;corresponding&#160;service&#160;architecture&#160;and&#160;interfaces.</p>
<p style="position:absolute;top:811px;left:226px;white-space:nowrap" class="ft5724"><b>6.3.1</b></p>
<p style="position:absolute;top:811px;left:280px;white-space:nowrap" class="ft5724"><b>Measurement&#160;Model</b></p>
<p style="position:absolute;top:841px;left:226px;white-space:nowrap" class="ft5714">The&#160;Basic&#160;Integrity&#160;Management&#160;(BIM)&#160;service&#160;stores&#160;static&#160;integrity&#160;measurements&#160;of<br/>dynamic&#160;components&#160;that&#160;are&#160;arranged&#160;in&#160;a&#160;flat&#160;hierarchy,&#160;such&#160;as&#160;the&#160;one&#160;shown&#160;in<br/>Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#58">6.4.&#160;</a>Each&#160;component&#160;has&#160;a&#160;single&#160;Component&#160;Configuration&#160;Register&#160;(CCR)<br/>associated&#160;with&#160;it.&#160;A&#160;CCR&#160;is&#160;analogous&#160;to&#160;a&#160;PCR&#160;and&#160;holds&#160;integrity&#160;measurements&#160;for<br/>that&#160;component.&#160;The&#160;measurements&#160;are&#160;held&#160;together&#160;in&#160;a&#160;global&#160;CCR&#160;table&#160;similar&#160;to<br/>the&#160;one&#160;depicted&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#57">6.2.</a></p>
<p style="position:absolute;top:970px;left:226px;white-space:nowrap" class="ft5723"><b>Static&#160;Measurements</b></p>
<p style="position:absolute;top:998px;left:226px;white-space:nowrap" class="ft5715">The&#160;BIM&#160;measurement&#160;model&#160;mimics&#160;TPM&#160;measurement&#160;capabilities&#160;but&#160;stores&#160;in-<br/>tegrity&#160;measurements&#160;in&#160;software&#160;rather&#160;than&#160;hardware.&#160;Each&#160;registered&#160;dynamic&#160;com-<br/>ponent&#160;is&#160;assigned&#160;a&#160;BIM&#160;CCR&#160;to&#160;which&#160;its&#160;measurements&#160;are&#160;reported.&#160;This&#160;is<br/>achieved&#160;by&#160;an</p>
<p style="position:absolute;top:1053px;left:325px;white-space:nowrap" class="ft5734">extend</p>
<p style="position:absolute;top:1052px;left:384px;white-space:nowrap" class="ft578">operation,&#160;which&#160;stores&#160;a&#160;new&#160;measurement&#160;in&#160;a&#160;CCR&#160;by</p>
<p style="position:absolute;top:1070px;left:226px;white-space:nowrap" class="ft578">hashing&#160;it&#160;together&#160;with&#160;the&#160;current&#160;value&#160;of&#160;the&#160;CCR.&#160;Dynamic&#160;components&#160;use&#160;this</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft5721">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 58 -->
<a name="58"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft58112{font-size:9px;font-family:MEDLMS+TT1060Ao00;color:#ffffff;}
	.ft58113{font-size:9px;font-family:QEHNHK+TT1060Bo00;color:#000000;}
	.ft58114{font-size:10px;font-family:MEDLMS+TT1060Co00;color:#000000;}
	.ft58115{font-size:9px;font-family:VNZQXL+TT1060Do00;color:#000000;}
	.ft58116{font-size:10px;font-family:MEDLMS+TT1060Fo00;color:#ffffff;}
	.ft58117{font-size:10px;font-family:MEDLMS+TT1060Fo00;color:#000000;}
-->
</style>
<div id="page58-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5058.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft588">56</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft5821">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:192px;left:433px;white-space:nowrap" class="ft58112">CID</p>
<p style="position:absolute;top:192px;left:457px;white-space:nowrap" class="ft58112">PID</p>
<p style="position:absolute;top:206px;left:437px;white-space:nowrap" class="ft58113">0</p>
<p style="position:absolute;top:206px;left:462px;white-space:nowrap" class="ft58113">-</p>
<p style="position:absolute;top:220px;left:437px;white-space:nowrap" class="ft58113">1</p>
<p style="position:absolute;top:220px;left:461px;white-space:nowrap" class="ft58113">0</p>
<p style="position:absolute;top:234px;left:437px;white-space:nowrap" class="ft58113">2</p>
<p style="position:absolute;top:234px;left:461px;white-space:nowrap" class="ft58113">0</p>
<p style="position:absolute;top:248px;left:437px;white-space:nowrap" class="ft58113">3</p>
<p style="position:absolute;top:248px;left:461px;white-space:nowrap" class="ft58113">0</p>
<p style="position:absolute;top:192px;left:433px;white-space:nowrap" class="ft58112">CID</p>
<p style="position:absolute;top:192px;left:457px;white-space:nowrap" class="ft58112">PID</p>
<p style="position:absolute;top:206px;left:437px;white-space:nowrap" class="ft58113">0</p>
<p style="position:absolute;top:206px;left:462px;white-space:nowrap" class="ft58113">-</p>
<p style="position:absolute;top:220px;left:437px;white-space:nowrap" class="ft58113">1</p>
<p style="position:absolute;top:220px;left:461px;white-space:nowrap" class="ft58113">0</p>
<p style="position:absolute;top:234px;left:437px;white-space:nowrap" class="ft58113">2</p>
<p style="position:absolute;top:234px;left:461px;white-space:nowrap" class="ft58113">0</p>
<p style="position:absolute;top:248px;left:437px;white-space:nowrap" class="ft58113">3</p>
<p style="position:absolute;top:248px;left:461px;white-space:nowrap" class="ft58113">0</p>
<p style="position:absolute;top:189px;left:257px;white-space:nowrap" class="ft58114">1</p>
<p style="position:absolute;top:189px;left:304px;white-space:nowrap" class="ft58114">22</p>
<p style="position:absolute;top:189px;left:350px;white-space:nowrap" class="ft58114">33</p>
<p style="position:absolute;top:262px;left:347px;white-space:nowrap" class="ft58115">Platform&#160;TCB</p>
<p style="position:absolute;top:235px;left:279px;white-space:nowrap" class="ft58115">VM</p>
<p style="position:absolute;top:235px;left:325px;white-space:nowrap" class="ft58115">VM</p>
<p style="position:absolute;top:235px;left:372px;white-space:nowrap" class="ft58115">VM</p>
<p style="position:absolute;top:255px;left:257px;white-space:nowrap" class="ft58114">0</p>
<p style="position:absolute;top:230px;left:528px;white-space:nowrap" class="ft58116">00</p>
<p style="position:absolute;top:192px;left:503px;white-space:nowrap" class="ft58117">11</p>
<p style="position:absolute;top:192px;left:528px;white-space:nowrap" class="ft58117">22</p>
<p style="position:absolute;top:192px;left:552px;white-space:nowrap" class="ft58117">33</p>
<p style="position:absolute;top:304px;left:244px;white-space:nowrap" class="ft588">Figure&#160;6.4:&#160;Simple&#160;integrity&#160;use&#160;case&#160;–&#160;a&#160;flat&#160;hierarchy.</p>
<p style="position:absolute;top:352px;left:150px;white-space:nowrap" class="ft5814">operation&#160;to&#160;report&#160;ongoing&#160;measurements&#160;when&#160;their&#160;contents&#160;change.&#160;For&#160;example,<br/>a&#160;firewall&#160;service&#160;would&#160;extend&#160;its&#160;CCR&#160;if&#160;its&#160;rule-set&#160;was&#160;about&#160;to&#160;be&#160;changed.&#160;The<br/>specifics&#160;of&#160;when/how&#160;measurements&#160;are&#160;taken&#160;is&#160;component-dependent,&#160;but&#160;the&#160;logic<br/>that&#160;performs&#160;this&#160;activity&#160;must&#160;be&#160;trusted&#160;to&#160;report&#160;changes&#160;faithfully.&#160;This&#160;behavior<br/>is&#160;assured&#160;by&#160;the&#160;initial&#160;measurement&#160;of&#160;the&#160;component&#160;by&#160;the&#160;component&#160;that&#160;starts&#160;it.<br/>In&#160;the&#160;BIM&#160;model,&#160;this&#160;can&#160;only&#160;be&#160;a&#160;static&#160;(platform&#160;TCB)&#160;component.</p>
<p style="position:absolute;top:460px;left:172px;white-space:nowrap" class="ft588">This&#160;measurement&#160;model&#160;provides&#160;better&#160;scalability&#160;than&#160;models&#160;that&#160;use&#160;the&#160;TPM</p>
<p style="position:absolute;top:477px;left:150px;white-space:nowrap" class="ft5815">as&#160;the&#160;sole&#160;repository&#160;for&#160;measurements.&#160;By&#160;using&#160;software&#160;registers,&#160;the&#160;BIM&#160;can<br/>store&#160;a&#160;virtually&#160;unlimited&#160;number&#160;of&#160;individual&#160;measurements.&#160;Hence,&#160;no&#160;aggregation<br/>is&#160;needed.&#160;However,&#160;the&#160;measurements&#160;are&#160;still&#160;accumulated&#160;and&#160;the&#160;CCRs&#160;are&#160;irre-<br/>versible.&#160;That&#160;is,&#160;recording&#160;a&#160;measurement</p>
<p style="position:absolute;top:530px;left:414px;white-space:nowrap" class="ft5846">M</p>
<p style="position:absolute;top:536px;left:429px;white-space:nowrap" class="ft5872">1</p>
<p style="position:absolute;top:531px;left:436px;white-space:nowrap" class="ft588">,&#160;followed&#160;by&#160;a&#160;changed&#160;measurement</p>
<p style="position:absolute;top:548px;left:150px;white-space:nowrap" class="ft5846">M</p>
<p style="position:absolute;top:554px;left:164px;white-space:nowrap" class="ft5872">2</p>
<p style="position:absolute;top:549px;left:171px;white-space:nowrap" class="ft588">,&#160;followed&#160;by</p>
<p style="position:absolute;top:548px;left:256px;white-space:nowrap" class="ft5846">M</p>
<p style="position:absolute;top:554px;left:271px;white-space:nowrap" class="ft5872">1</p>
<p style="position:absolute;top:549px;left:282px;white-space:nowrap" class="ft588">again,&#160;results&#160;in&#160;a&#160;different&#160;value&#160;than&#160;the&#160;original&#160;recording&#160;of</p>
<p style="position:absolute;top:566px;left:150px;white-space:nowrap" class="ft5846">M</p>
<p style="position:absolute;top:572px;left:164px;white-space:nowrap" class="ft5872">1</p>
<p style="position:absolute;top:567px;left:175px;white-space:nowrap" class="ft588">alone.&#160;Hence,&#160;components&#160;are&#160;not&#160;allowed&#160;to&#160;change&#160;in&#160;any&#160;way&#160;without&#160;perma-</p>
<p style="position:absolute;top:585px;left:150px;white-space:nowrap" class="ft5815">nent&#160;loss&#160;of&#160;integrity.&#160;Even&#160;if&#160;a&#160;change&#160;is&#160;later&#160;undone,&#160;the&#160;component&#160;cannot&#160;return<br/>to&#160;its&#160;previous&#160;trust&#160;state.&#160;In&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#60">6.4,&#160;</a>we&#160;will&#160;address&#160;this&#160;problem&#160;by&#160;employing<br/>dynamic&#160;registers&#160;for&#160;reversible&#160;measurements.</p>
<p style="position:absolute;top:661px;left:150px;white-space:nowrap" class="ft5823"><b>Simple&#160;Trust&#160;Dependency</b></p>
<p style="position:absolute;top:689px;left:150px;white-space:nowrap" class="ft5814">The&#160;BIM&#160;service&#160;implements&#160;a&#160;flat&#160;hierarchy&#160;to&#160;capture&#160;the&#160;integrity&#160;dependencies<br/>between&#160;platform&#160;components.&#160;In&#160;this&#160;model,&#160;the&#160;integrity&#160;of&#160;dynamic&#160;components<br/>solely&#160;depends&#160;on&#160;the&#160;integrity&#160;of&#160;the&#160;underlying&#160;platform&#160;TCB.&#160;We&#160;show&#160;an&#160;example<br/>flat&#160;hierarchy&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#58">6.4.&#160;</a>The&#160;components&#160;labeled&#160;<i>one</i>,&#160;<i>two</i>,&#160;and&#160;<i>three&#160;</i>are&#160;virtual<br/>machines&#160;running&#160;directly&#160;on&#160;the&#160;trusted&#160;platform.&#160;Component&#160;<i>zero&#160;</i>is&#160;the&#160;platform<br/>TCB&#160;that&#160;includes&#160;the&#160;SRTM&#160;(in&#160;this&#160;case,&#160;the&#160;BIM&#160;service).&#160;Each&#160;VM&#160;depends&#160;only<br/>on&#160;the&#160;platform&#160;TCB&#160;underneath.&#160;If&#160;the&#160;integrity&#160;of&#160;the&#160;TCB&#160;(component&#160;<i>zero</i>)&#160;is<br/>compromised,&#160;then&#160;the&#160;integrity&#160;of&#160;all&#160;of&#160;the&#160;VMs&#160;is&#160;compromised&#160;as&#160;well.&#160;However,<br/>the&#160;VMs&#160;are&#160;independent&#160;of&#160;one&#160;another&#160;and&#160;therefore&#160;do&#160;not&#160;have&#160;a&#160;trust&#160;dependency.<br/>As&#160;an&#160;example,&#160;if&#160;the&#160;integrity&#160;of&#160;VM</p>
<p style="position:absolute;top:855px;left:373px;white-space:nowrap" class="ft5872">1</p>
<p style="position:absolute;top:850px;left:382px;white-space:nowrap" class="ft588">is&#160;compromised,&#160;the&#160;integrity&#160;of&#160;VM</p>
<p style="position:absolute;top:855px;left:600px;white-space:nowrap" class="ft5872">2</p>
<p style="position:absolute;top:850px;left:610px;white-space:nowrap" class="ft588">and&#160;VM</p>
<p style="position:absolute;top:855px;left:659px;white-space:nowrap" class="ft5872">3</p>
<p style="position:absolute;top:868px;left:150px;white-space:nowrap" class="ft588">remains&#160;intact.</p>
<p style="position:absolute;top:886px;left:172px;white-space:nowrap" class="ft588">In&#160;what&#160;follows,&#160;we&#160;depict&#160;the&#160;integrity&#160;relationships&#160;between&#160;components&#160;using</p>
<p style="position:absolute;top:904px;left:150px;white-space:nowrap" class="ft5814">a&#160;dependency&#160;graph,&#160;and&#160;represent&#160;it&#160;using&#160;a&#160;dependency&#160;table.&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#58">6.4&#160;</a>shows&#160;a<br/>simple&#160;graph&#160;and&#160;its&#160;dependency&#160;table&#160;equivalent.&#160;For&#160;example,&#160;the&#160;second&#160;row&#160;in&#160;the<br/>dependency&#160;table&#160;states&#160;that&#160;the&#160;integrity&#160;of&#160;the&#160;child&#160;component&#160;<i>one&#160;</i>(VM</p>
<p style="position:absolute;top:945px;left:600px;white-space:nowrap" class="ft5872">1</p>
<p style="position:absolute;top:940px;left:607px;white-space:nowrap" class="ft588">)&#160;depends</p>
<p style="position:absolute;top:958px;left:150px;white-space:nowrap" class="ft588">on&#160;the&#160;integrity&#160;of&#160;the&#160;parent&#160;component&#160;<i>zero&#160;</i>(TCB).</p>
<p style="position:absolute;top:976px;left:172px;white-space:nowrap" class="ft588">In&#160;the&#160;simple&#160;BIM&#160;model,&#160;there&#160;is&#160;always&#160;a&#160;single&#160;trusted&#160;component&#160;(the&#160;plat-</p>
<p style="position:absolute;top:994px;left:150px;white-space:nowrap" class="ft5815">form&#160;TCB)&#160;on&#160;which&#160;all&#160;other&#160;components&#160;depend.&#160;This&#160;yields&#160;the&#160;“flat&#160;hierarchy”<br/>dependency&#160;graph&#160;and&#160;table&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#58">6.4.&#160;</a>The&#160;flat&#160;hierarchy&#160;arises,&#160;because&#160;a&#160;dynamic<br/>component&#160;(such&#160;as&#160;a&#160;VM)&#160;can&#160;only&#160;be&#160;started&#160;by&#160;a&#160;trusted&#160;component.&#160;Since&#160;the&#160;TCB<br/>is&#160;static&#160;and&#160;platform-wide,&#160;it&#160;is&#160;not&#160;possible&#160;for&#160;a&#160;dynamic&#160;component&#160;to&#160;start&#160;–&#160;and<br/>hence&#160;become&#160;a&#160;parent&#160;of&#160;–&#160;another&#160;dynamic&#160;component.&#160;Therefore&#160;the&#160;BIM&#160;cannot</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft5821">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 59 -->
<a name="59"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft59118{font-size:13px;font-family:Times;color:#231f20;}
	.ft59119{font-size:13px;line-height:18px;font-family:Times;color:#231f20;}
	.ft59120{font-size:13px;line-height:17px;font-family:Times;color:#231f20;}
	.ft59121{font-size:15px;line-height:18px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page59-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5059.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft598">CHAPTER&#160;6.&#160;HIERARCHICAL&#160;INTEGRITY&#160;MANAGEMENT</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft598">57</p>
<p style="position:absolute;top:195px;left:236px;white-space:nowrap" class="ft5923"><b>Integrity</b></p>
<p style="position:absolute;top:195px;left:358px;white-space:nowrap" class="ft5923"><b>Description</b></p>
<p style="position:absolute;top:215px;left:236px;white-space:nowrap" class="ft59102">extend</p>
<p style="position:absolute;top:214px;left:358px;white-space:nowrap" class="ft59119">Takes&#160;a&#160;hash&#160;value&#160;as&#160;an&#160;argument&#160;and&#160;irreversibly&#160;extends&#160;the&#160;com-<br/>ponent&#160;CCR&#160;with&#160;that&#160;hash.</p>
<p style="position:absolute;top:251px;left:236px;white-space:nowrap" class="ft59102">quote</p>
<p style="position:absolute;top:250px;left:358px;white-space:nowrap" class="ft59120">Takes&#160;arbitrary&#160;external&#160;data&#160;(i.e.,&#160;nonce)&#160;and&#160;returns&#160;a&#160;quotation&#160;of<br/>the&#160;current&#160;TCB&#160;measurements,&#160;the&#160;nonce,&#160;and&#160;the&#160;component&#160;CCR<br/>value&#160;signed&#160;by&#160;a&#160;TPM&#160;attestation&#160;identity&#160;key&#160;(AIK).</p>
<p style="position:absolute;top:307px;left:236px;white-space:nowrap" class="ft59121"><b>Protected&#160;Stor-<br/>age</b></p>
<p style="position:absolute;top:307px;left:358px;white-space:nowrap" class="ft5923"><b>Description</b></p>
<p style="position:absolute;top:345px;left:236px;white-space:nowrap" class="ft59102">seal</p>
<p style="position:absolute;top:344px;left:358px;white-space:nowrap" class="ft59120">Takes&#160;data&#160;to&#160;be&#160;protected,&#160;seals&#160;it&#160;to&#160;the&#160;TPM&#160;binding&#160;it&#160;to&#160;current<br/>TCB&#160;and&#160;CCR&#160;measurements,&#160;and&#160;returns&#160;the&#160;sealed&#160;(encrypted)&#160;blob.</p>
<p style="position:absolute;top:381px;left:236px;white-space:nowrap" class="ft59102">unseal</p>
<p style="position:absolute;top:380px;left:358px;white-space:nowrap" class="ft59120">Takes&#160;the&#160;sealed&#160;blob&#160;and&#160;unseals&#160;and&#160;returns&#160;the&#160;data&#160;iff&#160;the&#160;integrity<br/>of&#160;the&#160;TCB&#160;and&#160;the&#160;component&#160;are&#160;verified&#160;as&#160;intact.</p>
<p style="position:absolute;top:418px;left:236px;white-space:nowrap" class="ft5923"><b>Management</b></p>
<p style="position:absolute;top:418px;left:358px;white-space:nowrap" class="ft5923"><b>Description</b></p>
<p style="position:absolute;top:439px;left:236px;white-space:nowrap" class="ft59102">register</p>
<p style="position:absolute;top:438px;left:358px;white-space:nowrap" class="ft59119">Takes&#160;the&#160;initial&#160;measurement,&#160;adds&#160;the&#160;component&#160;to&#160;the&#160;dependency<br/>table,&#160;and&#160;fills&#160;the&#160;CCR&#160;with&#160;the&#160;initial&#160;measurement.</p>
<p style="position:absolute;top:474px;left:236px;white-space:nowrap" class="ft59102">delete</p>
<p style="position:absolute;top:474px;left:358px;white-space:nowrap" class="ft59118">Deletes&#160;the&#160;component&#160;and&#160;all&#160;its&#160;sealed&#160;data.</p>
<p style="position:absolute;top:508px;left:269px;white-space:nowrap" class="ft598">Table&#160;6.1:&#160;BIM&#160;integrity,&#160;protected&#160;storage,&#160;and&#160;management&#160;interfaces.</p>
<p style="position:absolute;top:540px;left:226px;white-space:nowrap" class="ft5914">manage,&#160;for&#160;example,&#160;the&#160;integrity&#160;of&#160;an&#160;application&#160;started&#160;within&#160;a&#160;VM.&#160;However,&#160;the<br/>BIM&#160;serves&#160;as&#160;a&#160;basis&#160;to&#160;build&#160;the&#160;hierarchical&#160;model&#160;which&#160;addresses&#160;this&#160;limitation,<br/>which&#160;is&#160;introduced&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#60">6.4.</a></p>
<p style="position:absolute;top:617px;left:226px;white-space:nowrap" class="ft5924"><b>6.3.2</b></p>
<p style="position:absolute;top:617px;left:280px;white-space:nowrap" class="ft5924"><b>The&#160;BIM&#160;Architecture</b></p>
<p style="position:absolute;top:647px;left:226px;white-space:nowrap" class="ft598">As&#160;shown&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#57">6.3,&#160;</a>BIM&#160;services&#160;are&#160;grouped&#160;under&#160;three&#160;interfaces:</p>
<p style="position:absolute;top:680px;left:226px;white-space:nowrap" class="ft5923"><b>Integrity&#160;interface&#160;</b>This&#160;interface&#160;provides&#160;functions&#160;to&#160;report&#160;and&#160;quote&#160;integrity</p>
<p style="position:absolute;top:698px;left:263px;white-space:nowrap" class="ft5915">measurements&#160;of&#160;dynamic&#160;(i.e.,&#160;non-TCB)&#160;components.&#160;Components&#160;use&#160;this<br/>interface&#160;to&#160;extend&#160;their&#160;register&#160;values&#160;when&#160;they&#160;detect&#160;significant&#160;changes&#160;to<br/>their&#160;measured&#160;content.&#160;A&#160;component&#160;is&#160;only&#160;allowed&#160;to&#160;alter&#160;its&#160;own&#160;register,<br/>while&#160;an&#160;integrity&#160;quote&#160;can&#160;be&#160;requested&#160;by&#160;any&#160;entity.&#160;Using&#160;the&#160;underlying<br/>TPM&#160;interface,&#160;the&#160;latter&#160;operation&#160;returns&#160;a&#160;signed&#160;integrity&#160;digest&#160;that&#160;contains<br/>the&#160;measurements&#160;of&#160;the&#160;dynamic&#160;component&#160;and&#160;the&#160;platform&#160;TCB.&#160;Using&#160;this<br/>digest,&#160;a&#160;third&#160;party&#160;can&#160;verify&#160;the&#160;complete&#160;integrity&#160;chain.</p>
<p style="position:absolute;top:835px;left:226px;white-space:nowrap" class="ft5923"><b>Protected&#160;storage&#160;interface&#160;</b>This&#160;interface&#160;provides&#160;functions&#160;to&#160;store&#160;and&#160;reveal&#160;se-</p>
<p style="position:absolute;top:853px;left:263px;white-space:nowrap" class="ft5915">crets&#160;on&#160;behalf&#160;of&#160;dynamic&#160;components.&#160;These&#160;secrets&#160;are&#160;bound&#160;to&#160;the&#160;integrity<br/>of&#160;the&#160;TCB&#160;and&#160;the&#160;owner&#160;component,&#160;i.e.,&#160;they&#160;are&#160;revealed&#160;if&#160;and&#160;only&#160;if&#160;the<br/>integrity&#160;of&#160;the&#160;component&#160;and&#160;its&#160;ancestors&#160;(in&#160;the&#160;BIM&#160;case,&#160;the&#160;platform&#160;TCB)<br/>is&#160;intact.&#160;The&#160;BIM&#160;uses&#160;the&#160;underlying&#160;TPM&#160;interface&#160;for&#160;sealing&#160;and&#160;unsealing<br/>data&#160;to&#160;and&#160;from&#160;the&#160;TPM,&#160;which&#160;automatically&#160;implies&#160;a&#160;verification&#160;check&#160;on<br/>the&#160;TCB.&#160;Verification&#160;of&#160;the&#160;component’s&#160;integrity&#160;can&#160;be&#160;done&#160;either&#160;by&#160;the&#160;BIM<br/>or&#160;delegated&#160;to&#160;a&#160;third-party&#160;verifier.&#160;Our&#160;prototype&#160;implements&#160;the&#160;former&#160;case<br/>in&#160;which&#160;the&#160;BIM&#160;needs&#160;to&#160;store&#160;the&#160;expected&#160;measurements&#160;for&#160;comparison.&#160;We<br/>use&#160;the&#160;TPM&#160;sealing&#160;operation&#160;itself&#160;to&#160;do&#160;so&#160;and&#160;use&#160;the&#160;CCR&#160;values&#160;at&#160;the&#160;time<br/>of&#160;sealing&#160;as&#160;the&#160;future&#160;expected&#160;values.&#160;We&#160;concatenate&#160;these&#160;values&#160;to&#160;the&#160;se-<br/>cret&#160;and&#160;seal&#160;the&#160;whole&#160;blob.&#160;The&#160;unsealing&#160;operation&#160;at&#160;a&#160;later&#160;time&#160;returns&#160;not<br/>only&#160;the&#160;sealed&#160;secret&#160;but&#160;also&#160;the&#160;expected&#160;set&#160;of&#160;measurements&#160;that&#160;we&#160;compare<br/>to&#160;the&#160;CCR&#160;values&#160;at&#160;that&#160;time.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft5921">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 60 -->
<a name="60"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page60-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5060.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft608">58</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft6021">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft6023"><b>Management&#160;interface&#160;</b>This&#160;interface&#160;provides&#160;functions&#160;to&#160;register&#160;dynamic&#160;compo-</p>
<p style="position:absolute;top:212px;left:187px;white-space:nowrap" class="ft6015">nents&#160;to&#160;the&#160;framework&#160;so&#160;that&#160;their&#160;integrity&#160;can&#160;be&#160;tracked&#160;by&#160;the&#160;BIM.&#160;The&#160;BIM<br/>is&#160;a&#160;passive&#160;service,&#160;and&#160;so&#160;only&#160;registered&#160;components&#160;are&#160;tracked.&#160;As&#160;discussed<br/>in&#160;the&#160;previous&#160;sections,&#160;the&#160;initial&#160;measurement&#160;of&#160;the&#160;component&#160;is&#160;provided<br/>from&#160;outside&#160;by&#160;a&#160;trusted&#160;component&#160;that&#160;measures&#160;and&#160;initiates&#160;the&#160;component.<br/>The&#160;interface&#160;also&#160;allows&#160;the&#160;deletion&#160;of&#160;components&#160;and&#160;their&#160;sealed&#160;data.</p>
<p style="position:absolute;top:316px;left:172px;white-space:nowrap" class="ft608">Table&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#59">6.1&#160;</a>details&#160;the&#160;individual&#160;functions&#160;provided&#160;by&#160;each&#160;interface.&#160;As&#160;shown&#160;in</p>
<p style="position:absolute;top:334px;left:150px;white-space:nowrap" class="ft6015">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#57">6.3,&#160;</a>the&#160;BIM,&#160;in&#160;turn,&#160;makes&#160;use&#160;of&#160;the&#160;Basic&#160;Management&#160;and&#160;Security&#160;Interface<br/>(BMSI),&#160;which&#160;provides&#160;a&#160;platform-agnostic&#160;interface&#160;to&#160;the&#160;underlying&#160;hypervisor&#160;and<br/>hardware&#160;TPM.&#160;In&#160;particular,&#160;the&#160;BMSI&#160;provides&#160;functions&#160;that&#160;enable&#160;the&#160;BIM&#160;to<br/>access&#160;the&#160;TPM&#160;and&#160;establish&#160;a&#160;link&#160;to&#160;the&#160;hardware&#160;root&#160;of&#160;trust.&#160;The&#160;implementation<br/>of&#160;the&#160;BMSI&#160;is&#160;discussed&#160;in&#160;more&#160;detail&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#66">6.6.</a></p>
<p style="position:absolute;top:452px;left:150px;white-space:nowrap" class="ft6026"><b>6.4</b></p>
<p style="position:absolute;top:452px;left:198px;white-space:nowrap" class="ft6026"><b>Hierarchical&#160;Integrity&#160;Management</b></p>
<p style="position:absolute;top:490px;left:150px;white-space:nowrap" class="ft6014">In&#160;this&#160;section,&#160;we&#160;present&#160;an&#160;enhanced&#160;design&#160;for&#160;the&#160;SRTM&#160;service&#160;that&#160;we&#160;introduced<br/>in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#54">6.2.&#160;</a>This&#160;platform-independent&#160;service&#160;features&#160;dynamic&#160;measurements&#160;and<br/>a&#160;component&#160;hierarchy&#160;that&#160;we&#160;use&#160;to&#160;manage&#160;the&#160;integrity&#160;of&#160;dynamic&#160;(non-TCB)&#160;plat-<br/>form&#160;components&#160;more&#160;effectively.&#160;We&#160;describe&#160;the&#160;security&#160;model&#160;for&#160;measurements<br/>in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#60">6.4.1.&#160;</a>We&#160;describe&#160;the&#160;service&#160;architecture&#160;and&#160;interfaces&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#64">6.4.2.</a></p>
<p style="position:absolute;top:602px;left:150px;white-space:nowrap" class="ft6024"><b>6.4.1</b></p>
<p style="position:absolute;top:602px;left:204px;white-space:nowrap" class="ft6024"><b>Measurement&#160;Model</b></p>
<p style="position:absolute;top:632px;left:150px;white-space:nowrap" class="ft6014">The&#160;Hierarchical&#160;Integrity&#160;Management&#160;(HIM)&#160;service&#160;stores&#160;integrity&#160;measurements<br/>in&#160;a&#160;CCR&#160;table&#160;as&#160;illustrated&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#57">6.2.&#160;</a>To&#160;overcome&#160;the&#160;shortcomings&#160;of&#160;the&#160;BIM<br/>model&#160;(e.g.,&#160;irreversible&#160;measurements),&#160;we&#160;have&#160;extended&#160;it&#160;by&#160;introducing&#160;two&#160;new<br/>concepts:&#160;dynamic&#160;measurements&#160;and&#160;hierarchical&#160;trust.</p>
<p style="position:absolute;top:726px;left:150px;white-space:nowrap" class="ft6023"><b>Dynamic&#160;Measurements</b></p>
<p style="position:absolute;top:754px;left:150px;white-space:nowrap" class="ft6014">The&#160;HIM&#160;measurement&#160;model&#160;enhances&#160;the&#160;BIM&#160;model&#160;in&#160;two&#160;ways.&#160;First,&#160;HIM&#160;allows<br/>multiple&#160;registers&#160;to&#160;be&#160;assigned&#160;to&#160;a&#160;single&#160;dynamic&#160;component.&#160;This&#160;way,&#160;component<br/>measurements&#160;can&#160;be&#160;tracked&#160;with&#160;better&#160;granularity.&#160;Second,&#160;HIM&#160;supports&#160;dynamic<br/>measurements&#160;that&#160;can&#160;be&#160;reported&#160;to&#160;a&#160;resettable&#160;register.&#160;This&#160;increases&#160;flexibility<br/>and&#160;allows&#160;a&#160;component&#160;to&#160;revert&#160;back&#160;to&#160;a&#160;trustworthy&#160;configuration&#160;if&#160;permitted&#160;by<br/>its&#160;change&#160;policy.</p>
<p style="position:absolute;top:861px;left:172px;white-space:nowrap" class="ft6023"><b>Change&#160;types.&#160;</b>We&#160;distinguish&#160;two&#160;types&#160;of&#160;component&#160;changes.&#160;More&#160;specifically:</p>
<p style="position:absolute;top:879px;left:150px;white-space:nowrap" class="ft6014">An&#160;<i>irreversible&#160;change&#160;</i>is&#160;one&#160;that&#160;requires&#160;the&#160;component&#160;to&#160;be&#160;restarted&#160;before&#160;its<br/>integrity&#160;can&#160;be&#160;re-established.&#160;Such&#160;a&#160;change&#160;is&#160;one&#160;made&#160;to&#160;the&#160;integrity-critical&#160;part<br/>of&#160;the&#160;component;&#160;that&#160;is,&#160;to&#160;the&#160;code&#160;or&#160;other&#160;data&#160;of&#160;the&#160;component&#160;that&#160;has&#160;a&#160;potential<br/>impact&#160;on&#160;the&#160;future&#160;ability&#160;of&#160;the&#160;component&#160;to&#160;implement&#160;its&#160;intended&#160;functionality<br/>correctly.&#160;An&#160;example&#160;of&#160;an&#160;irreversible&#160;change&#160;is&#160;a&#160;kernel&#160;loading&#160;an&#160;untrusted&#160;device<br/>driver&#160;as&#160;the&#160;driver&#160;may&#160;make&#160;a&#160;change&#160;to&#160;kernel&#160;memory&#160;that&#160;will&#160;persist&#160;even&#160;after&#160;it<br/>is&#160;unloaded.</p>
<p style="position:absolute;top:1005px;left:172px;white-space:nowrap" class="ft608">A&#160;<i>reversible&#160;change&#160;</i>is&#160;one&#160;in&#160;which&#160;the&#160;component&#160;is&#160;permitted&#160;to&#160;re-establish</p>
<p style="position:absolute;top:1023px;left:150px;white-space:nowrap" class="ft6014">integrity&#160;without&#160;being&#160;completely&#160;reinitialized.&#160;Such&#160;a&#160;change&#160;is&#160;one&#160;made&#160;to&#160;a&#160;non-<br/>critical&#160;part&#160;of&#160;the&#160;component;&#160;that&#160;is,&#160;to&#160;code&#160;or&#160;other&#160;data&#160;of&#160;the&#160;component&#160;that&#160;has<br/>no&#160;direct&#160;or&#160;potential&#160;impact&#160;on&#160;the&#160;component’s&#160;future&#160;security.&#160;A&#160;component&#160;still</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft6021">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 61 -->
<a name="61"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page61-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5061.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft618">CHAPTER&#160;6.&#160;HIERARCHICAL&#160;INTEGRITY&#160;MANAGEMENT</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft618">59</p>
<p style="position:absolute;top:428px;left:226px;white-space:nowrap" class="ft6115">Figure&#160;6.5:&#160;Transition&#160;diagram&#160;for&#160;component&#160;integrity&#160;states.&#160;A&#160;component&#160;in&#160;the<br/>non-critical&#160;state&#160;can&#160;be&#160;made&#160;intact&#160;by&#160;undoing&#160;dynamic&#160;changes,&#160;but&#160;the&#160;critical&#160;state<br/>can&#160;only&#160;return&#160;to&#160;the&#160;intact&#160;state&#160;by&#160;re-initialization.</p>
<p style="position:absolute;top:511px;left:226px;white-space:nowrap" class="ft6115">loses&#160;its&#160;integrity&#160;if&#160;a&#160;change&#160;is&#160;made&#160;to&#160;it.&#160;However,&#160;depending&#160;on&#160;the&#160;exact&#160;nature<br/>of&#160;the&#160;change,&#160;we&#160;may&#160;permit&#160;the&#160;component&#160;to&#160;regain&#160;integrity&#160;(and&#160;therefore&#160;trust)<br/>by&#160;undoing&#160;the&#160;change&#160;and&#160;returning&#160;to&#160;its&#160;previous&#160;state.&#160;For&#160;example,&#160;changes&#160;to<br/>configuration&#160;parameters&#160;are&#160;often&#160;reversible&#160;–&#160;e.g.&#160;changing&#160;the&#160;identity&#160;certificate<br/>that&#160;a&#160;component&#160;uses.&#160;The&#160;integrity&#160;management&#160;system&#160;will&#160;need&#160;to&#160;note&#160;such&#160;a<br/>change&#160;in&#160;order&#160;to&#160;fully&#160;report&#160;the&#160;state&#160;of&#160;the&#160;platform,&#160;but&#160;the&#160;certificate&#160;may&#160;be<br/>safely&#160;changed&#160;back&#160;without&#160;causing&#160;security&#160;implications.&#160;Another&#160;example&#160;might&#160;be<br/>loading&#160;a&#160;trusted&#160;kernel&#160;module&#160;that&#160;is&#160;known&#160;not&#160;to&#160;leave&#160;any&#160;side&#160;effects&#160;after&#160;being<br/>unloaded.</p>
<p style="position:absolute;top:673px;left:248px;white-space:nowrap" class="ft618">The&#160;categorization&#160;of&#160;a&#160;change&#160;as&#160;reversible&#160;or&#160;irreversible&#160;is&#160;component-dependent</p>
<p style="position:absolute;top:691px;left:226px;white-space:nowrap" class="ft6115">and&#160;will&#160;be&#160;set&#160;by&#160;each&#160;component’s&#160;own&#160;change-type&#160;policy.&#160;For&#160;example,&#160;a&#160;policy<br/>stating&#160;that&#160;all&#160;changes&#160;are&#160;irreversible&#160;reduces&#160;to&#160;the&#160;static&#160;measurement&#160;model.&#160;A<br/>component&#160;that&#160;permits&#160;reversible&#160;changes&#160;is&#160;referred&#160;to&#160;as&#160;a&#160;<i>dynamic&#160;component&#160;</i>(“dy-<br/>namic”&#160;because&#160;its&#160;integrity&#160;state&#160;may&#160;change&#160;multiple&#160;times).</p>
<p style="position:absolute;top:763px;left:248px;white-space:nowrap" class="ft6123"><b>Measurement&#160;reporting.&#160;</b>Recording&#160;dynamic&#160;measurements&#160;requires&#160;two&#160;mea-</p>
<p style="position:absolute;top:781px;left:226px;white-space:nowrap" class="ft6114">surement&#160;registers,&#160;a&#160;<i>static&#160;register&#160;</i>and&#160;a&#160;<i>dynamic&#160;register</i>,&#160;rather&#160;than&#160;the&#160;single&#160;reg-<br/>ister&#160;used&#160;in&#160;the&#160;static&#160;measurement&#160;model.&#160;Irreversible&#160;changes&#160;are&#160;reported&#160;to&#160;the<br/>static&#160;register&#160;in&#160;the&#160;same&#160;way&#160;as&#160;in&#160;the&#160;static&#160;measurement&#160;model;&#160;that&#160;is,&#160;the</p>
<p style="position:absolute;top:817px;left:688px;white-space:nowrap" class="ft6134">extend</p>
<p style="position:absolute;top:834px;left:226px;white-space:nowrap" class="ft6115">operation&#160;is&#160;used&#160;to&#160;combine&#160;the&#160;new&#160;measurement&#160;with&#160;the&#160;existing&#160;register&#160;value&#160;to<br/>obtain&#160;the&#160;new&#160;register&#160;value.</p>
<p style="position:absolute;top:887px;left:389px;white-space:nowrap" class="ft6146">extend</p>
<p style="position:absolute;top:887px;left:433px;white-space:nowrap" class="ft6148">(</p>
<p style="position:absolute;top:887px;left:439px;white-space:nowrap" class="ft6146">R,&#160;M</p>
<p style="position:absolute;top:887px;left:474px;white-space:nowrap" class="ft6148">)&#160;=</p>
<p style="position:absolute;top:887px;left:499px;white-space:nowrap" class="ft6146">hash</p>
<p style="position:absolute;top:887px;left:531px;white-space:nowrap" class="ft6148">(</p>
<p style="position:absolute;top:887px;left:537px;white-space:nowrap" class="ft6146">R</p>
<p style="position:absolute;top:887px;left:549px;white-space:nowrap" class="ft6150">||</p>
<p style="position:absolute;top:887px;left:557px;white-space:nowrap" class="ft6146">M</p>
<p style="position:absolute;top:887px;left:573px;white-space:nowrap" class="ft6148">)</p>
<p style="position:absolute;top:915px;left:226px;white-space:nowrap" class="ft618">where</p>
<p style="position:absolute;top:914px;left:266px;white-space:nowrap" class="ft6146">R</p>
<p style="position:absolute;top:915px;left:282px;white-space:nowrap" class="ft618">is&#160;the&#160;value&#160;of&#160;the&#160;register&#160;and</p>
<p style="position:absolute;top:914px;left:465px;white-space:nowrap" class="ft6146">M</p>
<p style="position:absolute;top:915px;left:485px;white-space:nowrap" class="ft618">is&#160;the&#160;measurement.</p>
<p style="position:absolute;top:933px;left:248px;white-space:nowrap" class="ft618">By&#160;contrast,&#160;reversible&#160;changes&#160;are&#160;reported&#160;to&#160;the&#160;dynamic&#160;register&#160;by&#160;<i>replacing</i></p>
<p style="position:absolute;top:951px;left:226px;white-space:nowrap" class="ft618">the&#160;previous&#160;value&#160;held&#160;in&#160;that&#160;register,&#160;using&#160;the</p>
<p style="position:absolute;top:952px;left:519px;white-space:nowrap" class="ft6134">reset</p>
<p style="position:absolute;top:951px;left:568px;white-space:nowrap" class="ft618">operation.</p>
<p style="position:absolute;top:986px;left:426px;white-space:nowrap" class="ft6146">reset</p>
<p style="position:absolute;top:986px;left:460px;white-space:nowrap" class="ft6148">(</p>
<p style="position:absolute;top:986px;left:465px;white-space:nowrap" class="ft6146">R,&#160;M</p>
<p style="position:absolute;top:986px;left:500px;white-space:nowrap" class="ft6148">)&#160;=</p>
<p style="position:absolute;top:986px;left:525px;white-space:nowrap" class="ft6146">M</p>
<p style="position:absolute;top:1014px;left:248px;white-space:nowrap" class="ft618">We&#160;can&#160;see&#160;that&#160;attempting&#160;to&#160;reverse&#160;an&#160;irreversible&#160;change&#160;does&#160;not&#160;return&#160;the</p>
<p style="position:absolute;top:1031px;left:226px;white-space:nowrap" class="ft618">static&#160;register&#160;to&#160;its&#160;initial&#160;state:</p>
<p style="position:absolute;top:1063px;left:226px;white-space:nowrap" class="ft6146">R</p>
<p style="position:absolute;top:1069px;left:237px;white-space:nowrap" class="ft6147">f&#160;inal</p>
<p style="position:absolute;top:1063px;left:271px;white-space:nowrap" class="ft6148">=</p>
<p style="position:absolute;top:1063px;left:287px;white-space:nowrap" class="ft6146">extend</p>
<p style="position:absolute;top:1063px;left:332px;white-space:nowrap" class="ft6148">(</p>
<p style="position:absolute;top:1063px;left:338px;white-space:nowrap" class="ft6146">extend</p>
<p style="position:absolute;top:1063px;left:382px;white-space:nowrap" class="ft6148">(</p>
<p style="position:absolute;top:1063px;left:388px;white-space:nowrap" class="ft6146">R</p>
<p style="position:absolute;top:1069px;left:399px;white-space:nowrap" class="ft6147">initial</p>
<p style="position:absolute;top:1063px;left:435px;white-space:nowrap" class="ft6146">,&#160;M</p>
<p style="position:absolute;top:1069px;left:456px;white-space:nowrap" class="ft6172">2</p>
<p style="position:absolute;top:1063px;left:463px;white-space:nowrap" class="ft6148">)</p>
<p style="position:absolute;top:1063px;left:468px;white-space:nowrap" class="ft6146">,&#160;M</p>
<p style="position:absolute;top:1069px;left:490px;white-space:nowrap" class="ft6172">1</p>
<p style="position:absolute;top:1063px;left:496px;white-space:nowrap" class="ft6148">)&#160;=</p>
<p style="position:absolute;top:1063px;left:522px;white-space:nowrap" class="ft6146">hash</p>
<p style="position:absolute;top:1063px;left:554px;white-space:nowrap" class="ft6148">(</p>
<p style="position:absolute;top:1063px;left:560px;white-space:nowrap" class="ft6146">hash</p>
<p style="position:absolute;top:1063px;left:592px;white-space:nowrap" class="ft6148">(</p>
<p style="position:absolute;top:1063px;left:598px;white-space:nowrap" class="ft6146">R</p>
<p style="position:absolute;top:1069px;left:609px;white-space:nowrap" class="ft6147">initial</p>
<p style="position:absolute;top:1063px;left:645px;white-space:nowrap" class="ft6150">||</p>
<p style="position:absolute;top:1063px;left:653px;white-space:nowrap" class="ft6146">M</p>
<p style="position:absolute;top:1069px;left:668px;white-space:nowrap" class="ft6172">2</p>
<p style="position:absolute;top:1063px;left:674px;white-space:nowrap" class="ft6148">)</p>
<p style="position:absolute;top:1063px;left:680px;white-space:nowrap" class="ft6150">||</p>
<p style="position:absolute;top:1063px;left:689px;white-space:nowrap" class="ft6146">M</p>
<p style="position:absolute;top:1069px;left:703px;white-space:nowrap" class="ft6172">1</p>
<p style="position:absolute;top:1063px;left:710px;white-space:nowrap" class="ft6148">)</p>
<p style="position:absolute;top:1063px;left:720px;white-space:nowrap" class="ft6150">6</p>
<p style="position:absolute;top:1063px;left:720px;white-space:nowrap" class="ft6148">=</p>
<p style="position:absolute;top:1063px;left:735px;white-space:nowrap" class="ft6146">R</p>
<p style="position:absolute;top:1069px;left:747px;white-space:nowrap" class="ft6147">initial</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft6121">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 62 -->
<a name="62"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page62-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5062.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft628">60</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft6221">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:172px;white-space:nowrap" class="ft628">However,&#160;reversing&#160;a&#160;reversible&#160;change&#160;<i>does&#160;</i>return&#160;the&#160;dynamic&#160;register&#160;to&#160;its&#160;initial</p>
<p style="position:absolute;top:212px;left:150px;white-space:nowrap" class="ft628">state:</p>
<p style="position:absolute;top:261px;left:170px;white-space:nowrap" class="ft6246">R</p>
<p style="position:absolute;top:267px;left:181px;white-space:nowrap" class="ft6247">f&#160;inal</p>
<p style="position:absolute;top:261px;left:215px;white-space:nowrap" class="ft6248">=</p>
<p style="position:absolute;top:261px;left:231px;white-space:nowrap" class="ft6246">reset</p>
<p style="position:absolute;top:261px;left:264px;white-space:nowrap" class="ft6248">(</p>
<p style="position:absolute;top:261px;left:270px;white-space:nowrap" class="ft6246">reset</p>
<p style="position:absolute;top:261px;left:303px;white-space:nowrap" class="ft6248">(</p>
<p style="position:absolute;top:261px;left:309px;white-space:nowrap" class="ft6246">R</p>
<p style="position:absolute;top:267px;left:320px;white-space:nowrap" class="ft6247">initial</p>
<p style="position:absolute;top:261px;left:356px;white-space:nowrap" class="ft6246">,&#160;M</p>
<p style="position:absolute;top:267px;left:377px;white-space:nowrap" class="ft6272">2</p>
<p style="position:absolute;top:261px;left:384px;white-space:nowrap" class="ft6248">)</p>
<p style="position:absolute;top:261px;left:390px;white-space:nowrap" class="ft6246">,&#160;M</p>
<p style="position:absolute;top:267px;left:411px;white-space:nowrap" class="ft6272">1</p>
<p style="position:absolute;top:261px;left:418px;white-space:nowrap" class="ft6248">)&#160;=</p>
<p style="position:absolute;top:261px;left:443px;white-space:nowrap" class="ft6246">reset</p>
<p style="position:absolute;top:261px;left:477px;white-space:nowrap" class="ft6248">(</p>
<p style="position:absolute;top:261px;left:483px;white-space:nowrap" class="ft6246">M</p>
<p style="position:absolute;top:267px;left:497px;white-space:nowrap" class="ft6272">2</p>
<p style="position:absolute;top:261px;left:504px;white-space:nowrap" class="ft6246">,&#160;M</p>
<p style="position:absolute;top:267px;left:525px;white-space:nowrap" class="ft6272">1</p>
<p style="position:absolute;top:261px;left:532px;white-space:nowrap" class="ft6248">)&#160;=</p>
<p style="position:absolute;top:261px;left:557px;white-space:nowrap" class="ft6246">M</p>
<p style="position:absolute;top:267px;left:572px;white-space:nowrap" class="ft6272">1</p>
<p style="position:absolute;top:261px;left:583px;white-space:nowrap" class="ft6248">=</p>
<p style="position:absolute;top:261px;left:599px;white-space:nowrap" class="ft6246">R</p>
<p style="position:absolute;top:267px;left:610px;white-space:nowrap" class="ft6247">initial</p>
<p style="position:absolute;top:295px;left:172px;white-space:nowrap" class="ft628">The&#160;exact&#160;nature&#160;of&#160;the&#160;reporting&#160;activity&#160;and&#160;the&#160;corresponding&#160;change-type&#160;policy</p>
<p style="position:absolute;top:313px;left:150px;white-space:nowrap" class="ft6214">is&#160;component-dependent.&#160;However,&#160;the&#160;logic&#160;that&#160;performs&#160;this&#160;activity&#160;must&#160;be&#160;a&#160;part<br/>of&#160;the&#160;initial&#160;measurements&#160;so&#160;that&#160;we&#160;can&#160;trust&#160;the&#160;component&#160;to&#160;report&#160;the&#160;changes&#160;to<br/>the&#160;correct&#160;register.</p>
<p style="position:absolute;top:367px;left:172px;white-space:nowrap" class="ft6223"><b>Integrity&#160;states.&#160;</b>Depending&#160;on&#160;the&#160;measurement&#160;values&#160;stored&#160;in&#160;its&#160;static&#160;and</p>
<p style="position:absolute;top:385px;left:150px;white-space:nowrap" class="ft6214">dynamic&#160;registers,&#160;a&#160;dynamic&#160;component&#160;can&#160;be&#160;in&#160;one&#160;of&#160;three&#160;local&#160;integrity&#160;states:<br/>intact,&#160;non-critical,&#160;and&#160;critical.&#160;The&#160;component&#160;is&#160;in&#160;the&#160;<i>intact&#160;state&#160;</i>if&#160;and&#160;only&#160;if&#160;the<br/>values&#160;in&#160;the&#160;static&#160;and&#160;dynamic&#160;registers&#160;are&#160;consistent&#160;with&#160;the&#160;expected&#160;measurement<br/>values.&#160;The&#160;component&#160;is&#160;in&#160;the&#160;<i>non-critical&#160;state&#160;</i>if&#160;and&#160;only&#160;if&#160;the&#160;value&#160;in&#160;the&#160;static<br/>register&#160;is&#160;consistent&#160;with&#160;the&#160;expected&#160;measurement&#160;value&#160;but&#160;the&#160;value&#160;in&#160;the&#160;dynamic<br/>register&#160;is&#160;not.&#160;In&#160;all&#160;other&#160;cases,&#160;the&#160;component&#160;is&#160;in&#160;the&#160;<i>critical&#160;state</i>.&#160;As&#160;shown&#160;in<br/>Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#61">6.5,&#160;</a>the&#160;foregoing&#160;arrangement&#160;enables&#160;a&#160;dynamic&#160;component&#160;that&#160;has&#160;only&#160;been<br/>subject&#160;to&#160;non-critical&#160;changes&#160;to&#160;be&#160;restored&#160;to&#160;the&#160;intact&#160;state.&#160;A&#160;component&#160;that&#160;is<br/>in&#160;the&#160;critical&#160;state&#160;cannot&#160;be&#160;restored&#160;to&#160;any&#160;other&#160;state&#160;unless&#160;re-initiated&#160;with&#160;an<br/>expected&#160;configuration&#160;(during&#160;which&#160;both&#160;registers&#160;are&#160;reset).</p>
<p style="position:absolute;top:564px;left:172px;white-space:nowrap" class="ft6223"><b>Security&#160;states.&#160;</b>Depending&#160;on&#160;the&#160;integrity&#160;state,&#160;a&#160;component&#160;can&#160;be&#160;in&#160;three</p>
<p style="position:absolute;top:582px;left:150px;white-space:nowrap" class="ft6215">security&#160;states:&#160;trustworthy,&#160;secure,&#160;and&#160;insecure.&#160;A&#160;component&#160;is&#160;<i>trustworthy&#160;</i>if&#160;and<br/>only&#160;if&#160;it&#160;is&#160;in&#160;intact&#160;state.&#160;A&#160;component&#160;is&#160;<i>secure&#160;</i>if&#160;and&#160;only&#160;if&#160;it&#160;is&#160;in&#160;intact&#160;or&#160;non-<br/>critical&#160;states.&#160;In&#160;all&#160;other&#160;cases,&#160;the&#160;component&#160;is&#160;deemed&#160;<i>insecure</i>.</p>
<p style="position:absolute;top:636px;left:172px;white-space:nowrap" class="ft6223"><b>Example&#160;use&#160;case&#160;for&#160;dynamic&#160;registers.&#160;</b>Digital&#160;Rights&#160;Management&#160;(DRM)&#160;ser-</p>
<p style="position:absolute;top:654px;left:150px;white-space:nowrap" class="ft6214">vices&#160;control&#160;the&#160;distribution&#160;of&#160;media&#160;content&#160;onto&#160;computing&#160;platforms.&#160;It&#160;is&#160;possible<br/>that&#160;a&#160;DRM&#160;service&#160;will&#160;not&#160;push&#160;video&#160;content&#160;to&#160;a&#160;computing&#160;accessory&#160;if,&#160;for&#160;ex-<br/>ample,&#160;an&#160;external&#160;recording&#160;device&#160;is&#160;plugged&#160;to&#160;it.&#160;In&#160;this&#160;case,&#160;software&#160;that&#160;detects<br/>and&#160;installs&#160;the&#160;plug-and-play&#160;drivers&#160;for&#160;the&#160;recording&#160;device&#160;must&#160;be&#160;part&#160;of&#160;the&#160;static<br/>measurements.&#160;However,&#160;the&#160;state&#160;in&#160;which&#160;a&#160;recording&#160;device&#160;is&#160;detected&#160;in&#160;the&#160;sys-<br/>tem&#160;can&#160;be&#160;reported&#160;dynamically.&#160;In&#160;fact,&#160;this&#160;can&#160;be&#160;reflected&#160;in&#160;the&#160;dynamic&#160;register<br/>for&#160;a&#160;secure&#160;DRM&#160;player&#160;application.&#160;As&#160;long&#160;as&#160;the&#160;recording&#160;device&#160;is&#160;connected,<br/>no&#160;content&#160;is&#160;downloaded.&#160;Once&#160;the&#160;user&#160;unplugs&#160;the&#160;device,&#160;the&#160;dynamic&#160;register&#160;is<br/>reset&#160;and&#160;content&#160;can&#160;be&#160;pushed&#160;to&#160;the&#160;player&#160;without&#160;requiring&#160;the&#160;application&#160;to&#160;be<br/>restarted.</p>
<p style="position:absolute;top:855px;left:150px;white-space:nowrap" class="ft6223"><b>Hierarchical&#160;Trust&#160;Dependency</b></p>
<p style="position:absolute;top:883px;left:150px;white-space:nowrap" class="ft6214">We&#160;enhance&#160;the&#160;BIM&#160;dependency&#160;model&#160;by&#160;introducing&#160;a&#160;hierarchy&#160;of&#160;trust&#160;dependen-<br/>cies&#160;that&#160;we&#160;represent&#160;as&#160;a&#160;directed&#160;acyclic&#160;graph.&#160;In&#160;such&#160;a&#160;graph,&#160;the&#160;edges&#160;indicate<br/>trust&#160;dependencies&#160;where&#160;the&#160;integrity&#160;of&#160;the&#160;component&#160;at&#160;the&#160;origin&#160;depends&#160;on&#160;the<br/>integrity&#160;of&#160;the&#160;component&#160;at&#160;the&#160;destination.&#160;If&#160;the&#160;integrity&#160;of&#160;the&#160;destination&#160;com-<br/>ponent&#160;is&#160;compromised,&#160;then&#160;the&#160;integrity&#160;of&#160;the&#160;origin&#160;component&#160;is&#160;always&#160;compro-<br/>mised&#160;as&#160;well.&#160;However,&#160;the&#160;reverse&#160;is&#160;not&#160;true.&#160;To&#160;illustrate&#160;these&#160;more&#160;complex&#160;trust<br/>relationships,&#160;consider&#160;the&#160;following&#160;use&#160;cases.</p>
<p style="position:absolute;top:1009px;left:172px;white-space:nowrap" class="ft628">In&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#58">6.4,&#160;</a>we&#160;see&#160;the&#160;simple&#160;flat&#160;hierarchy&#160;as&#160;previously&#160;described&#160;in&#160;Sec-</p>
<p style="position:absolute;top:1027px;left:150px;white-space:nowrap" class="ft6214">tion&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#56">6.3.&#160;</a>The&#160;components&#160;labeled&#160;<i>one</i>,&#160;<i>two</i>,&#160;and&#160;<i>three&#160;</i>are&#160;virtual&#160;machines&#160;running<br/>directly&#160;on&#160;the&#160;trusted&#160;platform.&#160;Component&#160;<i>zero&#160;</i>is&#160;the&#160;platform&#160;TCB&#160;that&#160;includes&#160;the<br/>SRTM&#160;(in&#160;this&#160;case,&#160;the&#160;HIM&#160;service).&#160;Each&#160;VM&#160;depends&#160;only&#160;on&#160;the&#160;platform&#160;TCB</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft6221">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 63 -->
<a name="63"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft63122{font-size:9px;font-family:MEDLMS+TT10691o00;color:#ffffff;}
	.ft63123{font-size:9px;font-family:UFQSLH+TT10692o00;color:#000000;}
	.ft63124{font-size:10px;font-family:QEHNHK+TT10693o00;color:#000000;}
	.ft63125{font-size:9px;font-family:TWPWAV+TT10694o00;color:#000000;}
	.ft63126{font-size:10px;font-family:QEHNHK+TT10695o00;color:#000000;}
	.ft63127{font-size:10px;font-family:QEHNHK+TT10695o00;color:#ffffff;}
	.ft63128{font-size:9px;font-family:MEDLMS+TT106E8o00;color:#ffffff;}
	.ft63129{font-size:9px;font-family:ZRSKVS+TT106E9o00;color:#000000;}
	.ft63130{font-size:10px;font-family:HSAEUE+TT106EAo00;color:#000000;}
	.ft63131{font-size:9px;font-family:XGQFDG+TT106EBo00;color:#000000;}
	.ft63132{font-size:10px;font-family:HSAEUE+TT106ECo00;color:#ffffff;}
	.ft63133{font-size:10px;font-family:HSAEUE+TT106ECo00;color:#000000;}
-->
</style>
<div id="page63-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5063.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft638">CHAPTER&#160;6.&#160;HIERARCHICAL&#160;INTEGRITY&#160;MANAGEMENT</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft638">61</p>
<p style="position:absolute;top:192px;left:511px;white-space:nowrap" class="ft63122">CID</p>
<p style="position:absolute;top:192px;left:535px;white-space:nowrap" class="ft63122">PID</p>
<p style="position:absolute;top:206px;left:515px;white-space:nowrap" class="ft63123">0</p>
<p style="position:absolute;top:206px;left:540px;white-space:nowrap" class="ft63123">-</p>
<p style="position:absolute;top:220px;left:515px;white-space:nowrap" class="ft63123">1</p>
<p style="position:absolute;top:220px;left:539px;white-space:nowrap" class="ft63123">0</p>
<p style="position:absolute;top:234px;left:515px;white-space:nowrap" class="ft63123">2</p>
<p style="position:absolute;top:234px;left:539px;white-space:nowrap" class="ft63123">1</p>
<p style="position:absolute;top:248px;left:515px;white-space:nowrap" class="ft63123">3</p>
<p style="position:absolute;top:248px;left:539px;white-space:nowrap" class="ft63123">1</p>
<p style="position:absolute;top:261px;left:515px;white-space:nowrap" class="ft63123">4</p>
<p style="position:absolute;top:261px;left:539px;white-space:nowrap" class="ft63123">1</p>
<p style="position:absolute;top:192px;left:511px;white-space:nowrap" class="ft63122">CID</p>
<p style="position:absolute;top:192px;left:535px;white-space:nowrap" class="ft63122">PID</p>
<p style="position:absolute;top:206px;left:515px;white-space:nowrap" class="ft63123">0</p>
<p style="position:absolute;top:206px;left:540px;white-space:nowrap" class="ft63123">-</p>
<p style="position:absolute;top:220px;left:515px;white-space:nowrap" class="ft63123">1</p>
<p style="position:absolute;top:220px;left:539px;white-space:nowrap" class="ft63123">0</p>
<p style="position:absolute;top:234px;left:515px;white-space:nowrap" class="ft63123">2</p>
<p style="position:absolute;top:234px;left:539px;white-space:nowrap" class="ft63123">1</p>
<p style="position:absolute;top:248px;left:515px;white-space:nowrap" class="ft63123">3</p>
<p style="position:absolute;top:248px;left:539px;white-space:nowrap" class="ft63123">1</p>
<p style="position:absolute;top:261px;left:515px;white-space:nowrap" class="ft63123">4</p>
<p style="position:absolute;top:261px;left:539px;white-space:nowrap" class="ft63123">1</p>
<p style="position:absolute;top:189px;left:337px;white-space:nowrap" class="ft63124">1</p>
<p style="position:absolute;top:214px;left:384px;white-space:nowrap" class="ft63124">22</p>
<p style="position:absolute;top:261px;left:426px;white-space:nowrap" class="ft63125">Platform&#160;TCB</p>
<p style="position:absolute;top:225px;left:358px;white-space:nowrap" class="ft63125">VM</p>
<p style="position:absolute;top:235px;left:338px;white-space:nowrap" class="ft63125">Manager</p>
<p style="position:absolute;top:234px;left:390px;white-space:nowrap" class="ft63125">VM</p>
<p style="position:absolute;top:254px;left:337px;white-space:nowrap" class="ft63124">0</p>
<p style="position:absolute;top:214px;left:415px;white-space:nowrap" class="ft63124">33</p>
<p style="position:absolute;top:234px;left:420px;white-space:nowrap" class="ft63125">VM</p>
<p style="position:absolute;top:214px;left:444px;white-space:nowrap" class="ft63124">44</p>
<p style="position:absolute;top:234px;left:450px;white-space:nowrap" class="ft63125">VM</p>
<p style="position:absolute;top:230px;left:606px;white-space:nowrap" class="ft63126">1</p>
<p style="position:absolute;top:192px;left:581px;white-space:nowrap" class="ft63126">22</p>
<p style="position:absolute;top:192px;left:606px;white-space:nowrap" class="ft63126">33</p>
<p style="position:absolute;top:192px;left:631px;white-space:nowrap" class="ft63126">44</p>
<p style="position:absolute;top:266px;left:606px;white-space:nowrap" class="ft63127">00</p>
<p style="position:absolute;top:291px;left:417px;white-space:nowrap" class="ft6319">(a)&#160;Multi-level&#160;dependency.</p>
<p style="position:absolute;top:343px;left:515px;white-space:nowrap" class="ft63128">CID</p>
<p style="position:absolute;top:343px;left:540px;white-space:nowrap" class="ft63128">PID</p>
<p style="position:absolute;top:358px;left:520px;white-space:nowrap" class="ft63129">0</p>
<p style="position:absolute;top:358px;left:545px;white-space:nowrap" class="ft63129">-</p>
<p style="position:absolute;top:374px;left:520px;white-space:nowrap" class="ft63129">1</p>
<p style="position:absolute;top:374px;left:544px;white-space:nowrap" class="ft63129">0</p>
<p style="position:absolute;top:390px;left:520px;white-space:nowrap" class="ft63129">2</p>
<p style="position:absolute;top:390px;left:544px;white-space:nowrap" class="ft63129">0</p>
<p style="position:absolute;top:405px;left:520px;white-space:nowrap" class="ft63129">3</p>
<p style="position:absolute;top:405px;left:544px;white-space:nowrap" class="ft63129">1</p>
<p style="position:absolute;top:421px;left:520px;white-space:nowrap" class="ft63129">4</p>
<p style="position:absolute;top:421px;left:544px;white-space:nowrap" class="ft63129">3</p>
<p style="position:absolute;top:437px;left:520px;white-space:nowrap" class="ft63129">5</p>
<p style="position:absolute;top:437px;left:544px;white-space:nowrap" class="ft63129">2</p>
<p style="position:absolute;top:452px;left:520px;white-space:nowrap" class="ft63129">6</p>
<p style="position:absolute;top:452px;left:544px;white-space:nowrap" class="ft63129">5</p>
<p style="position:absolute;top:343px;left:515px;white-space:nowrap" class="ft63128">CID</p>
<p style="position:absolute;top:343px;left:540px;white-space:nowrap" class="ft63128">PID</p>
<p style="position:absolute;top:358px;left:520px;white-space:nowrap" class="ft63129">0</p>
<p style="position:absolute;top:358px;left:545px;white-space:nowrap" class="ft63129">-</p>
<p style="position:absolute;top:374px;left:520px;white-space:nowrap" class="ft63129">1</p>
<p style="position:absolute;top:374px;left:544px;white-space:nowrap" class="ft63129">0</p>
<p style="position:absolute;top:390px;left:520px;white-space:nowrap" class="ft63129">2</p>
<p style="position:absolute;top:390px;left:544px;white-space:nowrap" class="ft63129">0</p>
<p style="position:absolute;top:405px;left:520px;white-space:nowrap" class="ft63129">3</p>
<p style="position:absolute;top:405px;left:544px;white-space:nowrap" class="ft63129">1</p>
<p style="position:absolute;top:421px;left:520px;white-space:nowrap" class="ft63129">4</p>
<p style="position:absolute;top:421px;left:544px;white-space:nowrap" class="ft63129">3</p>
<p style="position:absolute;top:437px;left:520px;white-space:nowrap" class="ft63129">5</p>
<p style="position:absolute;top:437px;left:544px;white-space:nowrap" class="ft63129">2</p>
<p style="position:absolute;top:452px;left:520px;white-space:nowrap" class="ft63129">6</p>
<p style="position:absolute;top:452px;left:544px;white-space:nowrap" class="ft63129">5</p>
<p style="position:absolute;top:341px;left:335px;white-space:nowrap" class="ft63130">1</p>
<p style="position:absolute;top:435px;left:427px;white-space:nowrap" class="ft63131">Platform&#160;TCB</p>
<p style="position:absolute;top:407px;left:383px;white-space:nowrap" class="ft63131">VM</p>
<p style="position:absolute;top:428px;left:335px;white-space:nowrap" class="ft63130">0</p>
<p style="position:absolute;top:452px;left:614px;white-space:nowrap" class="ft63132">00</p>
<p style="position:absolute;top:381px;left:594px;white-space:nowrap" class="ft63133">33</p>
<p style="position:absolute;top:389px;left:345px;white-space:nowrap" class="ft63130">33</p>
<p style="position:absolute;top:357px;left:348px;white-space:nowrap" class="ft63130">44</p>
<p style="position:absolute;top:371px;left:350px;white-space:nowrap" class="ft63131">APP</p>
<p style="position:absolute;top:390px;left:371px;white-space:nowrap" class="ft63131">JVM</p>
<p style="position:absolute;top:417px;left:594px;white-space:nowrap" class="ft63133">11</p>
<p style="position:absolute;top:417px;left:630px;white-space:nowrap" class="ft63133">22</p>
<p style="position:absolute;top:345px;left:594px;white-space:nowrap" class="ft63133">44</p>
<p style="position:absolute;top:381px;left:629px;white-space:nowrap" class="ft63133">55</p>
<p style="position:absolute;top:346px;left:629px;white-space:nowrap" class="ft63133">66</p>
<p style="position:absolute;top:341px;left:408px;white-space:nowrap" class="ft63130">2</p>
<p style="position:absolute;top:407px;left:456px;white-space:nowrap" class="ft63131">VM</p>
<p style="position:absolute;top:389px;left:418px;white-space:nowrap" class="ft63130">55</p>
<p style="position:absolute;top:357px;left:421px;white-space:nowrap" class="ft63130">66</p>
<p style="position:absolute;top:371px;left:425px;white-space:nowrap" class="ft63131">VM</p>
<p style="position:absolute;top:390px;left:425px;white-space:nowrap" class="ft63131">VMWARE</p>
<p style="position:absolute;top:478px;left:426px;white-space:nowrap" class="ft6319">(b)&#160;Nested&#160;components.</p>
<p style="position:absolute;top:513px;left:353px;white-space:nowrap" class="ft638">Figure&#160;6.6:&#160;Hierarchical&#160;integrity&#160;use&#160;cases.</p>
<p style="position:absolute;top:561px;left:226px;white-space:nowrap" class="ft6314">underneath.&#160;If&#160;the&#160;integrity&#160;of&#160;the&#160;TCB&#160;(component&#160;<i>zero</i>)&#160;is&#160;compromised,&#160;then&#160;the<br/>integrity&#160;of&#160;all&#160;of&#160;the&#160;VMs&#160;is&#160;compromised&#160;as&#160;well.&#160;However,&#160;the&#160;VMs&#160;are&#160;independent<br/>of&#160;one&#160;another&#160;and&#160;therefore&#160;do&#160;not&#160;have&#160;a&#160;trust&#160;dependency.&#160;As&#160;an&#160;example,&#160;if&#160;the<br/>integrity&#160;of&#160;VM</p>
<p style="position:absolute;top:620px;left:321px;white-space:nowrap" class="ft6372">1</p>
<p style="position:absolute;top:615px;left:327px;white-space:nowrap" class="ft638">is&#160;compromised,&#160;the&#160;integrity&#160;of&#160;VM</p>
<p style="position:absolute;top:620px;left:546px;white-space:nowrap" class="ft6372">2</p>
<p style="position:absolute;top:615px;left:557px;white-space:nowrap" class="ft638">and&#160;VM</p>
<p style="position:absolute;top:620px;left:606px;white-space:nowrap" class="ft6372">3</p>
<p style="position:absolute;top:615px;left:616px;white-space:nowrap" class="ft638">remains&#160;intact.</p>
<p style="position:absolute;top:633px;left:248px;white-space:nowrap" class="ft638">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#63">6.6(a)&#160;</a>shows&#160;a&#160;more&#160;complex&#160;multi-level&#160;dependency.&#160;Component&#160;<i>one&#160;</i>is&#160;a</p>
<p style="position:absolute;top:651px;left:226px;white-space:nowrap" class="ft6314">service&#160;that&#160;manages&#160;the&#160;life-cycle&#160;of&#160;components&#160;<i>two</i>,&#160;<i>three</i>,&#160;and&#160;<i>four</i>.&#160;All&#160;components<br/>are&#160;virtual&#160;machines.&#160;The&#160;latter&#160;VMs&#160;are&#160;independent&#160;of&#160;one&#160;another,&#160;as&#160;before,&#160;but<br/>their&#160;integrity&#160;depends&#160;on&#160;that&#160;of&#160;the&#160;domain&#160;manager,&#160;whose&#160;integrity&#160;in&#160;turn&#160;depends<br/>on&#160;the&#160;TCB.</p>
<p style="position:absolute;top:722px;left:248px;white-space:nowrap" class="ft638">In&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#63">6.6(b),&#160;</a>we&#160;see&#160;a&#160;nested&#160;dependency&#160;relationship.&#160;Components&#160;<i>one&#160;</i>and</p>
<p style="position:absolute;top:740px;left:226px;white-space:nowrap" class="ft6315"><i>two&#160;</i>are&#160;virtual&#160;machines,&#160;which&#160;themselves&#160;contain&#160;further&#160;virtual&#160;machines:&#160;compo-<br/>nent&#160;<i>three</i>,&#160;which&#160;is&#160;a&#160;Java&#160;virtual&#160;machine,&#160;and&#160;component&#160;<i>five</i>,&#160;which&#160;is&#160;a&#160;VMware<br/>hypervisor.&#160;These&#160;nested&#160;virtual&#160;machines&#160;support&#160;guest&#160;components:&#160;component&#160;<i>four</i>,<br/>a&#160;Java&#160;application,&#160;and&#160;component&#160;<i>six</i>,&#160;a&#160;VMware&#160;guest.&#160;Within&#160;component&#160;<i>one</i>,&#160;a&#160;tra-<br/>ditional&#160;linear&#160;chain-of-trust&#160;applies:&#160;Java&#160;application&#160;depends&#160;on&#160;Java&#160;virtual&#160;machine<br/>depends&#160;on&#160;operating&#160;system.&#160;A&#160;similar&#160;chain&#160;can&#160;be&#160;found&#160;within&#160;the&#160;VMware&#160;com-<br/>ponent.&#160;However,&#160;these&#160;two&#160;chains&#160;of&#160;trust&#160;are&#160;independent&#160;of&#160;one&#160;another,&#160;and&#160;both<br/>depend&#160;ultimately&#160;on&#160;the&#160;underlying&#160;platform&#160;TCB.</p>
<p style="position:absolute;top:884px;left:248px;white-space:nowrap" class="ft638">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#64">6.7&#160;</a>illustrates&#160;more&#160;complicated&#160;use&#160;cases.&#160;In&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#64">6.7(a),&#160;</a>we&#160;see&#160;a&#160;mul-</p>
<p style="position:absolute;top:902px;left:226px;white-space:nowrap" class="ft6314">tiple&#160;dependency&#160;relationship.&#160;Component&#160;<i>five&#160;</i>is&#160;a&#160;virtual&#160;machine&#160;that&#160;uses&#160;services<br/>from&#160;components&#160;<i>one</i>,&#160;<i>two</i>,&#160;and&#160;<i>four</i>.&#160;These&#160;components&#160;are&#160;small&#160;virtual&#160;machines<br/>that&#160;provide&#160;virtual&#160;networking,&#160;virtual&#160;storage,&#160;and&#160;virtual&#160;TPM&#160;services,&#160;respectively.<br/>Further,&#160;the&#160;integrity&#160;of&#160;the&#160;virtual&#160;TPM&#160;depends&#160;on&#160;the&#160;integrity&#160;of&#160;the&#160;virtual&#160;TPM<br/>manager&#160;domain&#160;(component&#160;<i>three</i>).</p>
<p style="position:absolute;top:991px;left:248px;white-space:nowrap" class="ft638">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#64">6.7(b)&#160;</a>shows&#160;a&#160;similar&#160;VM&#160;grouping&#160;example&#160;which&#160;we&#160;intend&#160;to&#160;explore</p>
<p style="position:absolute;top:1009px;left:226px;white-space:nowrap" class="ft6315">further&#160;in&#160;future&#160;work.&#160;In&#160;this&#160;example,&#160;we&#160;use&#160;miniature&#160;virtual&#160;TPM&#160;services&#160;to&#160;assist<br/>and&#160;enhance&#160;the&#160;integrity&#160;measurement&#160;capabilities&#160;of&#160;the&#160;framework.&#160;In&#160;this&#160;design&#160;we<br/>bind&#160;a&#160;single&#160;virtual&#160;TPM&#160;to&#160;a&#160;component&#160;(application&#160;or&#160;VM)&#160;and&#160;delegate&#160;component<br/>measurements&#160;to&#160;this&#160;virtual&#160;TPM.&#160;The&#160;virtual&#160;TPM&#160;then&#160;replaces&#160;the&#160;component&#160;CCRs</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft6321">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 64 -->
<a name="64"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft64134{font-size:9px;font-family:MEDLMS+TT10740o00;color:#ffffff;}
	.ft64135{font-size:9px;font-family:RDZRPI+TT10741o00;color:#000000;}
	.ft64136{font-size:10px;font-family:UFQSLH+TT10742o00;color:#000000;}
	.ft64137{font-size:9px;font-family:LWWHKC+TT10743o00;color:#000000;}
	.ft64138{font-size:10px;font-family:UFQSLH+TT10744o00;color:#ffffff;}
	.ft64139{font-size:10px;font-family:UFQSLH+TT10744o00;color:#000000;}
	.ft64140{font-size:10px;font-family:UFQSLH+TT1078Fo00;color:#000000;}
	.ft64141{font-size:9px;font-family:TWPWAV+TT10790o00;color:#000000;}
	.ft64142{font-size:9px;font-family:MEDLMS+TT10791o00;color:#ffffff;}
	.ft64143{font-size:9px;font-family:DMCZLT+TT10792o00;color:#000000;}
	.ft64144{font-size:10px;font-family:UFQSLH+TT10793o00;color:#ffffff;}
	.ft64145{font-size:10px;font-family:UFQSLH+TT10793o00;color:#000000;}
-->
</style>
<div id="page64-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5064.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft648">62</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft6421">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:192px;left:431px;white-space:nowrap" class="ft64134">CID</p>
<p style="position:absolute;top:192px;left:458px;white-space:nowrap" class="ft64134">PID</p>
<p style="position:absolute;top:206px;left:435px;white-space:nowrap" class="ft64135">0</p>
<p style="position:absolute;top:206px;left:463px;white-space:nowrap" class="ft64135">-</p>
<p style="position:absolute;top:220px;left:435px;white-space:nowrap" class="ft64135">1</p>
<p style="position:absolute;top:220px;left:462px;white-space:nowrap" class="ft64135">0</p>
<p style="position:absolute;top:233px;left:435px;white-space:nowrap" class="ft64135">2</p>
<p style="position:absolute;top:233px;left:462px;white-space:nowrap" class="ft64135">0</p>
<p style="position:absolute;top:247px;left:435px;white-space:nowrap" class="ft64135">3</p>
<p style="position:absolute;top:247px;left:462px;white-space:nowrap" class="ft64135">0</p>
<p style="position:absolute;top:261px;left:435px;white-space:nowrap" class="ft64135">4</p>
<p style="position:absolute;top:261px;left:462px;white-space:nowrap" class="ft64135">3</p>
<p style="position:absolute;top:274px;left:435px;white-space:nowrap" class="ft64135">5</p>
<p style="position:absolute;top:274px;left:453px;white-space:nowrap" class="ft64135">{1,2,4}</p>
<p style="position:absolute;top:192px;left:431px;white-space:nowrap" class="ft64134">CID</p>
<p style="position:absolute;top:192px;left:458px;white-space:nowrap" class="ft64134">PID</p>
<p style="position:absolute;top:206px;left:435px;white-space:nowrap" class="ft64135">0</p>
<p style="position:absolute;top:206px;left:463px;white-space:nowrap" class="ft64135">-</p>
<p style="position:absolute;top:220px;left:435px;white-space:nowrap" class="ft64135">1</p>
<p style="position:absolute;top:220px;left:462px;white-space:nowrap" class="ft64135">0</p>
<p style="position:absolute;top:233px;left:435px;white-space:nowrap" class="ft64135">2</p>
<p style="position:absolute;top:233px;left:462px;white-space:nowrap" class="ft64135">0</p>
<p style="position:absolute;top:247px;left:435px;white-space:nowrap" class="ft64135">3</p>
<p style="position:absolute;top:247px;left:462px;white-space:nowrap" class="ft64135">0</p>
<p style="position:absolute;top:261px;left:435px;white-space:nowrap" class="ft64135">4</p>
<p style="position:absolute;top:261px;left:462px;white-space:nowrap" class="ft64135">3</p>
<p style="position:absolute;top:274px;left:435px;white-space:nowrap" class="ft64135">5</p>
<p style="position:absolute;top:274px;left:453px;white-space:nowrap" class="ft64135">{1,2,4}</p>
<p style="position:absolute;top:190px;left:259px;white-space:nowrap" class="ft64136">5</p>
<p style="position:absolute;top:224px;left:295px;white-space:nowrap" class="ft64136">11</p>
<p style="position:absolute;top:261px;left:347px;white-space:nowrap" class="ft64137">Platform&#160;TCB</p>
<p style="position:absolute;top:234px;left:273px;white-space:nowrap" class="ft64137">VM&#160;vNET</p>
<p style="position:absolute;top:254px;left:259px;white-space:nowrap" class="ft64136">0</p>
<p style="position:absolute;top:224px;left:322px;white-space:nowrap" class="ft64136">22</p>
<p style="position:absolute;top:234px;left:322px;white-space:nowrap" class="ft64137">vSTO</p>
<p style="position:absolute;top:214px;left:348px;white-space:nowrap" class="ft64136">33</p>
<p style="position:absolute;top:224px;left:348px;white-space:nowrap" class="ft64137">vTPM</p>
<p style="position:absolute;top:235px;left:351px;white-space:nowrap" class="ft64137">MGR</p>
<p style="position:absolute;top:224px;left:378px;white-space:nowrap" class="ft64136">44</p>
<p style="position:absolute;top:234px;left:377px;white-space:nowrap" class="ft64137">vTPM</p>
<p style="position:absolute;top:268px;left:530px;white-space:nowrap" class="ft64138">00</p>
<p style="position:absolute;top:231px;left:506px;white-space:nowrap" class="ft64139">11</p>
<p style="position:absolute;top:231px;left:530px;white-space:nowrap" class="ft64139">22</p>
<p style="position:absolute;top:231px;left:554px;white-space:nowrap" class="ft64139">33</p>
<p style="position:absolute;top:198px;left:554px;white-space:nowrap" class="ft64139">44</p>
<p style="position:absolute;top:198px;left:506px;white-space:nowrap" class="ft64139">55</p>
<p style="position:absolute;top:224px;left:322px;white-space:nowrap" class="ft64136">2</p>
<p style="position:absolute;top:298px;left:342px;white-space:nowrap" class="ft6419">(a)&#160;Disaggregated&#160;services.</p>
<p style="position:absolute;top:348px;left:259px;white-space:nowrap" class="ft64140">2</p>
<p style="position:absolute;top:439px;left:348px;white-space:nowrap" class="ft64141">Platform&#160;TCB</p>
<p style="position:absolute;top:412px;left:317px;white-space:nowrap" class="ft64141">VM</p>
<p style="position:absolute;top:432px;left:259px;white-space:nowrap" class="ft64140">0</p>
<p style="position:absolute;top:394px;left:269px;white-space:nowrap" class="ft64140">33</p>
<p style="position:absolute;top:363px;left:271px;white-space:nowrap" class="ft64140">55</p>
<p style="position:absolute;top:377px;left:273px;white-space:nowrap" class="ft64141">APP</p>
<p style="position:absolute;top:396px;left:307px;white-space:nowrap" class="ft64141">JVM</p>
<p style="position:absolute;top:363px;left:297px;white-space:nowrap" class="ft64140">4</p>
<p style="position:absolute;top:377px;left:295px;white-space:nowrap" class="ft64141">vTPM</p>
<p style="position:absolute;top:391px;left:341px;white-space:nowrap" class="ft64140">11</p>
<p style="position:absolute;top:412px;left:341px;white-space:nowrap" class="ft64141">vTPM</p>
<p style="position:absolute;top:349px;left:428px;white-space:nowrap" class="ft64142">CID</p>
<p style="position:absolute;top:349px;left:463px;white-space:nowrap" class="ft64142">PID</p>
<p style="position:absolute;top:364px;left:432px;white-space:nowrap" class="ft64143">0</p>
<p style="position:absolute;top:364px;left:468px;white-space:nowrap" class="ft64143">-</p>
<p style="position:absolute;top:379px;left:432px;white-space:nowrap" class="ft64143">1</p>
<p style="position:absolute;top:379px;left:467px;white-space:nowrap" class="ft64143">0</p>
<p style="position:absolute;top:394px;left:432px;white-space:nowrap" class="ft64143">2</p>
<p style="position:absolute;top:394px;left:451px;white-space:nowrap" class="ft64143">{0,1,M(1)}</p>
<p style="position:absolute;top:410px;left:432px;white-space:nowrap" class="ft64143">3</p>
<p style="position:absolute;top:410px;left:467px;white-space:nowrap" class="ft64143">2</p>
<p style="position:absolute;top:425px;left:432px;white-space:nowrap" class="ft64143">4</p>
<p style="position:absolute;top:425px;left:467px;white-space:nowrap" class="ft64143">3</p>
<p style="position:absolute;top:440px;left:432px;white-space:nowrap" class="ft64143">5</p>
<p style="position:absolute;top:440px;left:451px;white-space:nowrap" class="ft64143">{0,4,M(4)}</p>
<p style="position:absolute;top:349px;left:428px;white-space:nowrap" class="ft64142">CID</p>
<p style="position:absolute;top:349px;left:463px;white-space:nowrap" class="ft64142">PID</p>
<p style="position:absolute;top:364px;left:432px;white-space:nowrap" class="ft64143">0</p>
<p style="position:absolute;top:364px;left:468px;white-space:nowrap" class="ft64143">-</p>
<p style="position:absolute;top:379px;left:432px;white-space:nowrap" class="ft64143">1</p>
<p style="position:absolute;top:379px;left:467px;white-space:nowrap" class="ft64143">0</p>
<p style="position:absolute;top:394px;left:432px;white-space:nowrap" class="ft64143">2</p>
<p style="position:absolute;top:394px;left:451px;white-space:nowrap" class="ft64143">{0,1,M(1)}</p>
<p style="position:absolute;top:410px;left:432px;white-space:nowrap" class="ft64143">3</p>
<p style="position:absolute;top:410px;left:467px;white-space:nowrap" class="ft64143">2</p>
<p style="position:absolute;top:425px;left:432px;white-space:nowrap" class="ft64143">4</p>
<p style="position:absolute;top:425px;left:467px;white-space:nowrap" class="ft64143">3</p>
<p style="position:absolute;top:440px;left:432px;white-space:nowrap" class="ft64143">5</p>
<p style="position:absolute;top:440px;left:451px;white-space:nowrap" class="ft64143">{0,4,M(4)}</p>
<p style="position:absolute;top:438px;left:533px;white-space:nowrap" class="ft64144">00</p>
<p style="position:absolute;top:407px;left:516px;white-space:nowrap" class="ft64145">22</p>
<p style="position:absolute;top:407px;left:553px;white-space:nowrap" class="ft64145">11</p>
<p style="position:absolute;top:350px;left:516px;white-space:nowrap" class="ft64145">55</p>
<p style="position:absolute;top:350px;left:555px;white-space:nowrap" class="ft64145">44</p>
<p style="position:absolute;top:379px;left:533px;white-space:nowrap" class="ft64145">33</p>
<p style="position:absolute;top:394px;left:270px;white-space:nowrap" class="ft64140">3</p>
<p style="position:absolute;top:468px;left:347px;white-space:nowrap" class="ft6419">(b)&#160;Virtual&#160;TPM&#160;binding.</p>
<p style="position:absolute;top:503px;left:160px;white-space:nowrap" class="ft648">Figure&#160;6.7:&#160;More&#160;complicated&#160;use&#160;cases.&#160;Dashed&#160;lines&#160;denote&#160;implicit&#160;dependency.</p>
<p style="position:absolute;top:551px;left:150px;white-space:nowrap" class="ft6415">to&#160;provide&#160;more&#160;granular&#160;run-time&#160;measurements&#160;for&#160;the&#160;component&#160;it&#160;is&#160;attached&#160;to.<br/>The&#160;measurements&#160;for&#160;the&#160;virtual&#160;TPM&#160;service&#160;itself&#160;is&#160;still&#160;held&#160;by&#160;its&#160;own&#160;CCRs.&#160;As<br/>an&#160;example,&#160;the&#160;integrity&#160;of&#160;component&#160;<i>two&#160;</i>now&#160;depends&#160;on&#160;the&#160;integrity&#160;of&#160;component<br/><i>one&#160;</i>(its&#160;attached&#160;virtual&#160;TPM)&#160;and&#160;the&#160;run-time&#160;measurements&#160;taken&#160;by&#160;this&#160;virtual<br/>TPM&#160;(e.g.,&#160;during&#160;authenticated&#160;VM</p>
<p style="position:absolute;top:628px;left:370px;white-space:nowrap" class="ft6472">2</p>
<p style="position:absolute;top:623px;left:381px;white-space:nowrap" class="ft648">bootstrap).&#160;We&#160;refer&#160;to&#160;this&#160;measurement&#160;set&#160;as</p>
<p style="position:absolute;top:641px;left:150px;white-space:nowrap" class="ft6415">M(<i>one</i>).&#160;The&#160;same&#160;holds&#160;for&#160;the&#160;application&#160;component&#160;<i>five&#160;</i>and&#160;its&#160;attached&#160;virtual<br/>TPM&#160;service&#160;component&#160;<i>four</i>.&#160;The&#160;present&#160;HIM&#160;implementation&#160;does&#160;not&#160;yet&#160;support<br/>virtual&#160;TPM&#160;attachment.</p>
<p style="position:absolute;top:717px;left:150px;white-space:nowrap" class="ft6424"><b>6.4.2</b></p>
<p style="position:absolute;top:717px;left:204px;white-space:nowrap" class="ft6424"><b>The&#160;HIM&#160;Architecture</b></p>
<p style="position:absolute;top:747px;left:150px;white-space:nowrap" class="ft6414">The&#160;HIM&#160;service&#160;implements&#160;the&#160;same&#160;integrity,&#160;protected&#160;storage,&#160;and&#160;management<br/>interfaces&#160;as&#160;the&#160;BIM&#160;service&#160;as&#160;presented&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#56">6.3,&#160;</a>but&#160;with&#160;the&#160;following&#160;en-<br/>hancements.</p>
<p style="position:absolute;top:801px;left:172px;white-space:nowrap" class="ft648">The&#160;HIM&#160;integrity&#160;interface&#160;provides&#160;an</p>
<p style="position:absolute;top:802px;left:418px;white-space:nowrap" class="ft6434">extend</p>
<p style="position:absolute;top:801px;left:476px;white-space:nowrap" class="ft648">function&#160;that&#160;alters&#160;the&#160;value&#160;of</p>
<p style="position:absolute;top:819px;left:150px;white-space:nowrap" class="ft6414">the&#160;static&#160;CCR&#160;in&#160;the&#160;same&#160;way&#160;as&#160;the&#160;BIM&#160;equivalent.&#160;To&#160;support&#160;dynamic&#160;mea-<br/>surements,&#160;the&#160;interface&#160;also&#160;provides&#160;a</p>
<p style="position:absolute;top:838px;left:395px;white-space:nowrap" class="ft6434">reset</p>
<p style="position:absolute;top:837px;left:445px;white-space:nowrap" class="ft648">function&#160;that&#160;is&#160;used&#160;to&#160;report&#160;to&#160;the</p>
<p style="position:absolute;top:855px;left:150px;white-space:nowrap" class="ft6414">dynamic&#160;register&#160;and&#160;overwrite&#160;its&#160;value.&#160;In&#160;addition,&#160;to&#160;support&#160;hierarchical&#160;integrity<br/>dependency,&#160;the</p>
<p style="position:absolute;top:874px;left:253px;white-space:nowrap" class="ft6434">quote</p>
<p style="position:absolute;top:873px;left:303px;white-space:nowrap" class="ft648">function&#160;is&#160;modified.&#160;This&#160;function&#160;now&#160;returns&#160;the&#160;aggre-</p>
<p style="position:absolute;top:891px;left:150px;white-space:nowrap" class="ft6414">gated&#160;integrity&#160;measurements&#160;of&#160;the&#160;component&#160;in&#160;question.&#160;Specifically,&#160;the&#160;signed<br/>quote&#160;now&#160;contains&#160;the&#160;TCB&#160;integrity&#160;measurements&#160;plus&#160;the&#160;measurements&#160;of&#160;the<br/>component&#160;and&#160;all&#160;its&#160;ancestors&#160;hashed&#160;in&#160;a&#160;single&#160;value.</p>
<p style="position:absolute;top:944px;left:172px;white-space:nowrap" class="ft648">In&#160;the&#160;HIM&#160;protected&#160;storage&#160;interface,&#160;the</p>
<p style="position:absolute;top:945px;left:438px;white-space:nowrap" class="ft6434">seal</p>
<p style="position:absolute;top:944px;left:478px;white-space:nowrap" class="ft648">and</p>
<p style="position:absolute;top:945px;left:505px;white-space:nowrap" class="ft6434">unseal</p>
<p style="position:absolute;top:944px;left:563px;white-space:nowrap" class="ft648">functions&#160;are&#160;en-</p>
<p style="position:absolute;top:962px;left:150px;white-space:nowrap" class="ft648">hanced&#160;to&#160;support&#160;component&#160;dependency&#160;and&#160;dynamic&#160;measurements.&#160;The</p>
<p style="position:absolute;top:963px;left:629px;white-space:nowrap" class="ft6434">seal</p>
<p style="position:absolute;top:980px;left:150px;white-space:nowrap" class="ft6414">function&#160;now&#160;binds&#160;the&#160;stored&#160;secret&#160;to&#160;the&#160;integrity&#160;of&#160;all&#160;the&#160;trust&#160;chains&#160;that&#160;reach<br/>the&#160;component&#160;in&#160;question&#160;from&#160;the&#160;TCB;&#160;that&#160;is,&#160;the&#160;subgraph&#160;of&#160;all&#160;paths&#160;from&#160;that<br/>component&#160;to&#160;the&#160;root&#160;TCB.&#160;Hence&#160;the&#160;integrity&#160;state&#160;of&#160;components&#160;not&#160;on&#160;a&#160;path&#160;be-<br/>tween&#160;that&#160;component&#160;and&#160;the&#160;TCB&#160;is&#160;ignored.&#160;For&#160;example,&#160;in&#160;the&#160;nested&#160;use&#160;case&#160;in<br/>Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#63">6.6(b),&#160;</a>an&#160;integrity&#160;compromise&#160;in&#160;the&#160;VMware&#160;compartment&#160;will&#160;not&#160;affect&#160;the<br/>ability&#160;of&#160;the&#160;Java&#160;application&#160;to&#160;unseal&#160;previously&#160;sealed&#160;information,&#160;as&#160;long&#160;as&#160;the</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft6421">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 65 -->
<a name="65"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page65-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5065.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft658">CHAPTER&#160;6.&#160;HIERARCHICAL&#160;INTEGRITY&#160;MANAGEMENT</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft658">63</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft658">Java&#160;compartment&#160;remains&#160;intact.</p>
<p style="position:absolute;top:212px;left:248px;white-space:nowrap" class="ft658">Lastly,&#160;the&#160;HIM&#160;management&#160;interface&#160;provides</p>
<p style="position:absolute;top:212px;left:547px;white-space:nowrap" class="ft6534">register</p>
<p style="position:absolute;top:212px;left:624px;white-space:nowrap" class="ft658">and</p>
<p style="position:absolute;top:212px;left:651px;white-space:nowrap" class="ft6534">delete</p>
<p style="position:absolute;top:212px;left:710px;white-space:nowrap" class="ft658">func-</p>
<p style="position:absolute;top:230px;left:226px;white-space:nowrap" class="ft658">tions.&#160;The</p>
<p style="position:absolute;top:230px;left:297px;white-space:nowrap" class="ft6534">delete</p>
<p style="position:absolute;top:230px;left:357px;white-space:nowrap" class="ft658">function&#160;is&#160;the&#160;same&#160;as&#160;in&#160;the&#160;BIM.&#160;However,&#160;the</p>
<p style="position:absolute;top:230px;left:670px;white-space:nowrap" class="ft6534">register</p>
<p style="position:absolute;top:247px;left:226px;white-space:nowrap" class="ft6514">function&#160;now&#160;takes&#160;a&#160;dependency&#160;list&#160;as&#160;a&#160;parameter&#160;that&#160;specifies&#160;additional&#160;ancestor<br/>components&#160;the&#160;component&#160;depends&#160;on&#160;besides&#160;the&#160;one&#160;that&#160;registers&#160;the&#160;component.</p>
<p style="position:absolute;top:311px;left:226px;white-space:nowrap" class="ft6526"><b>6.5</b></p>
<p style="position:absolute;top:311px;left:275px;white-space:nowrap" class="ft6526"><b>Policy&#160;Verification&#160;for&#160;Security&#160;Services</b></p>
<p style="position:absolute;top:349px;left:226px;white-space:nowrap" class="ft6515">In&#160;this&#160;section,&#160;we&#160;introduce&#160;example&#160;security&#160;services&#160;that&#160;leverage&#160;the&#160;HIM&#160;frame-<br/>work&#160;for&#160;policy&#160;verification&#160;and&#160;access&#160;control.&#160;Our&#160;examples&#160;include&#160;a&#160;credential<br/>management&#160;service&#160;(Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#65">6.5.1)</a>,&#160;a&#160;virtual&#160;TPM&#160;service&#160;(Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#65">6.5.2)</a>,&#160;and&#160;a&#160;vir-<br/>tual&#160;network&#160;service&#160;(Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#66">6.5.3)</a>.</p>
<p style="position:absolute;top:444px;left:226px;white-space:nowrap" class="ft6524"><b>6.5.1</b></p>
<p style="position:absolute;top:444px;left:280px;white-space:nowrap" class="ft6524"><b>Credential&#160;Management&#160;Service</b></p>
<p style="position:absolute;top:474px;left:226px;white-space:nowrap" class="ft6514">Protected&#160;storage&#160;services&#160;provide&#160;secure&#160;access&#160;to&#160;secrets&#160;that&#160;are&#160;sealed&#160;to&#160;the&#160;under-<br/>lying&#160;TPM&#160;on&#160;behalf&#160;of&#160;their&#160;owners.&#160;It&#160;is&#160;expected&#160;that&#160;these&#160;services&#160;retain&#160;control<br/>over&#160;these&#160;secrets&#160;and&#160;enforce&#160;the&#160;associated&#160;access&#160;control&#160;policies&#160;at&#160;all&#160;times.&#160;By<br/>contrast,&#160;most&#160;storage&#160;services&#160;such&#160;as&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[104]&#160;</a>and&#160;the&#160;HIM&#160;provide&#160;one-time&#160;verifica-<br/>tion,&#160;and&#160;are&#160;therefore&#160;susceptible&#160;to&#160;a&#160;time-of-check&#160;to&#160;time-of-use&#160;vulnerability.&#160;This<br/>occurs&#160;because&#160;these&#160;services&#160;release&#160;the&#160;stored&#160;secret&#160;to&#160;the&#160;requesting&#160;component<br/>once&#160;they&#160;verify&#160;the&#160;necessary&#160;policies&#160;(e.g.,&#160;HIM&#160;unseal&#160;successfully&#160;verifies&#160;the&#160;ag-<br/>gregate&#160;integrity).&#160;Once&#160;the&#160;secret&#160;is&#160;revealed,&#160;these&#160;services&#160;can&#160;no&#160;longer&#160;restrict<br/>access&#160;to&#160;it&#160;if&#160;the&#160;component&#160;undergoes&#160;a&#160;malicious&#160;change.</p>
<p style="position:absolute;top:635px;left:248px;white-space:nowrap" class="ft658">To&#160;enable&#160;ongoing&#160;policy&#160;verification&#160;and&#160;enforcement,&#160;we&#160;designed&#160;and&#160;imple-</p>
<p style="position:absolute;top:653px;left:226px;white-space:nowrap" class="ft6515">mented&#160;a&#160;credential&#160;management&#160;service&#160;(CMS)&#160;that&#160;uses&#160;the&#160;integrity&#160;management<br/>framework&#160;to&#160;provide&#160;secure&#160;access&#160;to&#160;secrets&#160;while&#160;maintaining&#160;control&#160;at&#160;all&#160;times.<br/>Unlike&#160;the&#160;HIM&#160;unseal&#160;operation,&#160;CMS&#160;credentials&#160;are&#160;never&#160;revealed&#160;to&#160;requesting<br/>services&#160;directly&#160;but&#160;are&#160;always&#160;held&#160;securely&#160;by&#160;the&#160;CMS.&#160;In&#160;essence,&#160;the&#160;CMS&#160;is&#160;a<br/>reference&#160;monitor&#160;that&#160;mediates&#160;and&#160;provides&#160;access&#160;to&#160;secured&#160;data&#160;through&#160;a&#160;well-<br/>defined&#160;interface.</p>
<p style="position:absolute;top:761px;left:248px;white-space:nowrap" class="ft658">The&#160;CMS&#160;interface&#160;is&#160;comprised&#160;of&#160;management&#160;and&#160;service&#160;interfaces.&#160;Compo-</p>
<p style="position:absolute;top:779px;left:226px;white-space:nowrap" class="ft6514">nents&#160;use&#160;the&#160;management&#160;interface&#160;to&#160;register&#160;component&#160;credentials&#160;with&#160;the&#160;CMS.<br/>To&#160;do&#160;so,&#160;the</p>
<p style="position:absolute;top:797px;left:316px;white-space:nowrap" class="ft6534">register</p>
<p style="position:absolute;top:797px;left:393px;white-space:nowrap" class="ft658">function&#160;takes&#160;the&#160;credential&#160;as&#160;input&#160;and&#160;seals&#160;it&#160;to&#160;the</p>
<p style="position:absolute;top:815px;left:226px;white-space:nowrap" class="ft658">underlying&#160;TPM.&#160;The&#160;interface&#160;also&#160;provides&#160;a</p>
<p style="position:absolute;top:815px;left:514px;white-space:nowrap" class="ft6534">discard</p>
<p style="position:absolute;top:815px;left:582px;white-space:nowrap" class="ft658">function&#160;which&#160;deletes&#160;the</p>
<p style="position:absolute;top:832px;left:226px;white-space:nowrap" class="ft6514">stored&#160;credential.&#160;The&#160;service&#160;interface&#160;provides&#160;access&#160;to&#160;the&#160;credentials&#160;through&#160;a<br/>generic</p>
<p style="position:absolute;top:851px;left:275px;white-space:nowrap" class="ft6534">access</p>
<p style="position:absolute;top:850px;left:334px;white-space:nowrap" class="ft658">function.&#160;We&#160;have&#160;designed&#160;this&#160;interface&#160;as&#160;an&#160;extensible&#160;plug-in</p>
<p style="position:absolute;top:868px;left:226px;white-space:nowrap" class="ft6514">interface;&#160;that&#160;is,&#160;the&#160;exact&#160;nature&#160;of&#160;the&#160;interface&#160;depends&#160;on&#160;the&#160;nature&#160;of&#160;the&#160;stored<br/>credential&#160;and&#160;the&#160;type&#160;of&#160;functionality&#160;needed.&#160;For&#160;example,&#160;if&#160;the&#160;stored&#160;credentials<br/>are&#160;cryptographic&#160;keys,&#160;we&#160;offer&#160;a&#160;plug-in&#160;service&#160;that&#160;provides&#160;encryption/decryption<br/>capabilities&#160;so&#160;that&#160;components&#160;can&#160;use&#160;the&#160;interface&#160;to&#160;encrypt/decrypt&#160;data&#160;without<br/>seeing&#160;the&#160;actual&#160;key.&#160;Regardless&#160;of&#160;the&#160;functionality&#160;provided,&#160;the&#160;CMS&#160;uses&#160;the&#160;HIM<br/>to&#160;verify&#160;the&#160;aggregate&#160;integrity&#160;prior&#160;to&#160;each&#160;access&#160;to&#160;the&#160;secret.</p>
<p style="position:absolute;top:999px;left:226px;white-space:nowrap" class="ft6524"><b>6.5.2</b></p>
<p style="position:absolute;top:999px;left:280px;white-space:nowrap" class="ft6524"><b>Virtual&#160;TPM&#160;Service</b></p>
<p style="position:absolute;top:1029px;left:226px;white-space:nowrap" class="ft6515">A&#160;natural&#160;extension&#160;to&#160;the&#160;CMS&#160;functionality&#160;would&#160;be&#160;to&#160;provide&#160;a&#160;miniature&#160;TPM&#160;in-<br/>terface&#160;to&#160;the&#160;various&#160;platform&#160;components,&#160;as&#160;illustrated&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#64">6.7(b).&#160;</a>This&#160;enables<br/>these&#160;components&#160;to&#160;have&#160;a&#160;standardized&#160;interface&#160;as&#160;in&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[114]&#160;</a>to&#160;prove&#160;their&#160;integrity</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft6521">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 66 -->
<a name="66"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page66-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5066.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft668">64</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft6621">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft6615">and&#160;provides&#160;a&#160;strong&#160;identity&#160;for&#160;each&#160;component.&#160;Such&#160;an&#160;approach&#160;has&#160;already&#160;been<br/>taken&#160;through&#160;TPM&#160;virtualization&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[13]&#160;</a>which&#160;gives&#160;each&#160;VM&#160;a&#160;TPM&#160;interface&#160;imple-<br/>mented&#160;by&#160;a&#160;virtual&#160;TPM&#160;service.&#160;However,&#160;it&#160;is&#160;not&#160;yet&#160;clear&#160;what&#160;the&#160;best&#160;mechanism<br/>is&#160;for&#160;establishing&#160;a&#160;secure&#160;binding&#160;between&#160;a&#160;virtual&#160;TPM&#160;and&#160;its&#160;platform&#160;TCB.</p>
<p style="position:absolute;top:265px;left:172px;white-space:nowrap" class="ft668">Our&#160;framework&#160;could&#160;be&#160;used&#160;to&#160;bridge&#160;the&#160;gap&#160;between&#160;virtual&#160;TPM&#160;services&#160;and</p>
<p style="position:absolute;top:283px;left:150px;white-space:nowrap" class="ft6614">the&#160;platform&#160;TCB.&#160;For&#160;example,&#160;a&#160;central&#160;trusted&#160;CMS&#160;service&#160;could&#160;be&#160;used&#160;as&#160;the<br/>single&#160;secure&#160;repository&#160;for&#160;virtual&#160;TPM&#160;keys.&#160;Access&#160;to&#160;these&#160;keys&#160;would&#160;require<br/>verification&#160;of&#160;the&#160;complete&#160;HIM&#160;integrity&#160;chain,&#160;including&#160;verification&#160;of&#160;the&#160;platform<br/>TCB.&#160;For&#160;example,&#160;to&#160;sign&#160;a&#160;quote&#160;request,&#160;a&#160;virtual&#160;TPM&#160;would&#160;use&#160;the&#160;CMS&#160;interface<br/>to&#160;gain&#160;access&#160;to&#160;its&#160;signing&#160;key.</p>
<p style="position:absolute;top:396px;left:150px;white-space:nowrap" class="ft6624"><b>6.5.3</b></p>
<p style="position:absolute;top:396px;left:204px;white-space:nowrap" class="ft6624"><b>Virtual&#160;Network&#160;Service</b></p>
<p style="position:absolute;top:426px;left:150px;white-space:nowrap" class="ft6615">Virtualization&#160;provides&#160;direct&#160;isolation&#160;of&#160;computing&#160;resources&#160;such&#160;as&#160;memory&#160;and<br/>CPU&#160;between&#160;guest&#160;operating&#160;systems&#160;on&#160;a&#160;physical&#160;platform.&#160;However,&#160;the&#160;network<br/>remains&#160;a&#160;shared&#160;resource&#160;as&#160;all&#160;traffic&#160;from&#160;guests&#160;will&#160;eventually&#160;end&#160;up&#160;on&#160;the&#160;same<br/>physical&#160;medium.&#160;Various&#160;mechanisms&#160;can&#160;be&#160;used&#160;to&#160;provide&#160;network&#160;isolation&#160;be-<br/>tween&#160;network&#160;domains,&#160;as&#160;described&#160;in&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[19]</a>.&#160;In&#160;general,&#160;encryption&#160;must&#160;be&#160;used&#160;for<br/>isolation&#160;when&#160;network&#160;traffic&#160;is&#160;delivered&#160;over&#160;an&#160;untrusted&#160;shared&#160;physical&#160;medium.</p>
<p style="position:absolute;top:533px;left:172px;white-space:nowrap" class="ft668">Using&#160;our&#160;framework&#160;in&#160;combination&#160;with&#160;the&#160;CMS,&#160;one&#160;could&#160;design&#160;a&#160;virtual</p>
<p style="position:absolute;top:551px;left:150px;white-space:nowrap" class="ft6614">network&#160;(vNET)&#160;service&#160;which&#160;provides&#160;isolation&#160;through&#160;an&#160;encryption&#160;layer&#160;such&#160;as<br/>IPSEC.&#160;In&#160;this&#160;setting,&#160;the&#160;vNET&#160;service&#160;would&#160;store&#160;its&#160;credentials&#160;(e.g.,&#160;network&#160;en-<br/>cryption&#160;key)&#160;in&#160;the&#160;CMS,&#160;in&#160;combination&#160;with&#160;the&#160;expected&#160;CCR&#160;values&#160;of&#160;the&#160;service<br/>and&#160;any&#160;ancestor&#160;service&#160;it&#160;depends&#160;on&#160;(including&#160;any&#160;potential&#160;network&#160;configuration<br/>information).&#160;Because&#160;the&#160;key&#160;is&#160;held&#160;by&#160;the&#160;CMS&#160;and&#160;not&#160;revealed&#160;to&#160;the&#160;vNET&#160;ser-<br/>vice,&#160;any&#160;change&#160;in&#160;the&#160;integrity&#160;of&#160;the&#160;service&#160;or&#160;its&#160;ancestor&#160;components&#160;would&#160;result<br/>in&#160;the&#160;network&#160;link&#160;becoming&#160;unavailable&#160;for&#160;the&#160;VM&#160;connected&#160;to&#160;this&#160;specific&#160;vNET.<br/>As&#160;a&#160;result,&#160;the&#160;capability&#160;of&#160;a&#160;VM&#160;to&#160;communicate&#160;with&#160;its&#160;peer&#160;within&#160;a&#160;considered<br/>domain&#160;would&#160;implicitly&#160;prove&#160;its&#160;trustworthiness,&#160;which&#160;would&#160;provide&#160;continuous<br/>authentication&#160;as&#160;opposed&#160;to&#160;relying&#160;only&#160;on&#160;an&#160;initial&#160;handshake&#160;as&#160;most&#160;network&#160;au-<br/>thentication&#160;mechanisms&#160;do.</p>
<p style="position:absolute;top:777px;left:150px;white-space:nowrap" class="ft6626"><b>6.6</b></p>
<p style="position:absolute;top:777px;left:198px;white-space:nowrap" class="ft6626"><b>Implementation&#160;in&#160;Xen</b></p>
<p style="position:absolute;top:815px;left:150px;white-space:nowrap" class="ft6614">In&#160;this&#160;section,&#160;we&#160;describe&#160;a&#160;prototype&#160;implementation&#160;of&#160;the&#160;integrity&#160;management<br/>framework&#160;and&#160;the&#160;credential&#160;management&#160;service&#160;on&#160;the&#160;Xen&#160;virtual&#160;machine&#160;moni-<br/>tor&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[30]</a>.&#160;The&#160;implementation&#160;features&#160;the&#160;management&#160;and&#160;service&#160;interfaces&#160;of&#160;both.<br/>Note&#160;that&#160;although&#160;we&#160;present&#160;our&#160;implementation&#160;with&#160;Xen,&#160;the&#160;framework&#160;could<br/>equally&#160;be&#160;implemented&#160;on&#160;an&#160;alternative&#160;virtualized&#160;or&#160;microkernel-based&#160;platform<br/>(e.g.,&#160;the&#160;L4/Fiasco&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#172">[70]&#160;</a>microkernel).</p>
<p style="position:absolute;top:945px;left:150px;white-space:nowrap" class="ft6624"><b>6.6.1</b></p>
<p style="position:absolute;top:945px;left:204px;white-space:nowrap" class="ft6624"><b>Infrastructure&#160;Overview</b></p>
<p style="position:absolute;top:975px;left:150px;white-space:nowrap" class="ft6614">The&#160;various&#160;components&#160;of&#160;the&#160;integrity&#160;management&#160;framework&#160;are&#160;provided&#160;by&#160;one<br/>or&#160;more&#160;virtual&#160;machines,&#160;running&#160;on&#160;top&#160;of&#160;the&#160;Xen&#160;virtual&#160;machine&#160;monitor.&#160;The<br/>use&#160;of&#160;virtualization&#160;isolates&#160;the&#160;trusted&#160;platform&#160;from&#160;a&#160;misbehaving&#160;guest&#160;operating<br/>system,&#160;and&#160;all&#160;communication&#160;with&#160;the&#160;trusted&#160;platform&#160;passes&#160;through&#160;well-defined<br/>interfaces.&#160;Our&#160;implementation&#160;is&#160;based&#160;on&#160;Xen&#160;version&#160;3.0.4,&#160;a&#160;VMM&#160;for&#160;the&#160;IA32</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft6621">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 67 -->
<a name="67"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft67146{font-size:13px;font-family:VRBBWM+TT10F6Eo00;color:#000000;}
	.ft67147{font-size:9px;font-family:JBEEIF+TT10F6Fo00;color:#000000;}
	.ft67148{font-size:9px;font-family:DUCRGK+TT10F71o00;color:#000000;-moz-transform: matrix(         0,         -1, 1.0001200144,          0, 0, 0);-webkit-transform: matrix(         0,         -1, 1.0001200144,          0, 0, 0);-o-transform: matrix(         0,         -1, 1.0001200144,          0, 0, 0);-ms-transform: matrix(         0,         -1, 1.0001200144,          0, 0, 0);-moz-transform-origin: left 75%;-webkit-transform-origin: left 75%;-o-transform-origin: left 75%;-ms-transform-origin: left 75%;}
-->
</style>
<div id="page67-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5067.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft678">CHAPTER&#160;6.&#160;HIERARCHICAL&#160;INTEGRITY&#160;MANAGEMENT</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft678">65</p>
<p style="position:absolute;top:407px;left:554px;white-space:nowrap" class="ft67146">BMSI</p>
<p style="position:absolute;top:383px;left:420px;white-space:nowrap" class="ft67147">libI</p>
<p style="position:absolute;top:383px;left:549px;white-space:nowrap" class="ft67147">libM</p>
<p style="position:absolute;top:383px;left:486px;white-space:nowrap" class="ft67147">libT</p>
<p style="position:absolute;top:346px;left:412px;white-space:nowrap" class="ft67147">BIM</p>
<p style="position:absolute;top:346px;left:480px;white-space:nowrap" class="ft67147">HIM</p>
<p style="position:absolute;top:303px;left:456px;white-space:nowrap" class="ft67147">CMS</p>
<p style="position:absolute;top:213px;left:408px;white-space:nowrap" class="ft67147">vNET&#160;Service</p>
<p style="position:absolute;top:225px;left:504px;white-space:nowrap" class="ft67147">vTPM&#160;Service</p>
<p style="position:absolute;top:477px;left:537px;white-space:nowrap" class="ft67146">Xen&#160;VMM</p>
<p style="position:absolute;top:512px;left:410px;white-space:nowrap" class="ft67147">TPM</p>
<p style="position:absolute;top:512px;left:410px;white-space:nowrap" class="ft67147">TPM</p>
<p style="position:absolute;top:441px;left:422px;white-space:nowrap" class="ft67147">TPM&#160;</p>
<p style="position:absolute;top:451px;left:419px;white-space:nowrap" class="ft67147">driver</p>
<p style="position:absolute;top:250px;left:375px;white-space:nowrap" class="ft67148">Se</p>
<p style="position:absolute;top:242px;left:375px;white-space:nowrap" class="ft67148">curi</p>
<p style="position:absolute;top:228px;left:375px;white-space:nowrap" class="ft67148">ty&#160;</p>
<p style="position:absolute;top:219px;left:375px;white-space:nowrap" class="ft67148">se</p>
<p style="position:absolute;top:212px;left:375px;white-space:nowrap" class="ft67148">rv</p>
<p style="position:absolute;top:204px;left:375px;white-space:nowrap" class="ft67148">ice</p>
<p style="position:absolute;top:194px;left:375px;white-space:nowrap" class="ft67148">s</p>
<p style="position:absolute;top:340px;left:374px;white-space:nowrap" class="ft67148">Core</p>
<p style="position:absolute;top:324px;left:374px;white-space:nowrap" class="ft67148">&#160;se</p>
<p style="position:absolute;top:314px;left:374px;white-space:nowrap" class="ft67148">rvic</p>
<p style="position:absolute;top:301px;left:374px;white-space:nowrap" class="ft67148">es</p>
<p style="position:absolute;top:410px;left:366px;white-space:nowrap" class="ft67148">Library&#160;&#160;laye</p>
<p style="position:absolute;top:392px;left:376px;white-space:nowrap" class="ft67148">r</p>
<p style="position:absolute;top:453px;left:366px;white-space:nowrap" class="ft67148">Drive</p>
<p style="position:absolute;top:434px;left:366px;white-space:nowrap" class="ft67148">r&#160;</p>
<p style="position:absolute;top:451px;left:376px;white-space:nowrap" class="ft67148">laye</p>
<p style="position:absolute;top:436px;left:376px;white-space:nowrap" class="ft67148">r</p>
<p style="position:absolute;top:194px;left:565px;white-space:nowrap" class="ft6745"><b>Dom&#160;0</b></p>
<p style="position:absolute;top:295px;left:537px;white-space:nowrap" class="ft67147">DMS</p>
<p style="position:absolute;top:556px;left:311px;white-space:nowrap" class="ft678">Figure&#160;6.8:&#160;Illustration&#160;of&#160;the&#160;prototype&#160;in&#160;a&#160;layered&#160;stack.</p>
<p style="position:absolute;top:604px;left:226px;white-space:nowrap" class="ft6715">platform,&#160;with&#160;the&#160;VMs&#160;running&#160;a&#160;paravirtualized&#160;version&#160;of&#160;Linux&#160;2.6.18.&#160;For&#160;inter-<br/>domain&#160;communication,&#160;we&#160;employ&#160;the&#160;light-weight&#160;communication&#160;library&#160;introduced<br/>in&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[8]</a>.</p>
<p style="position:absolute;top:658px;left:248px;white-space:nowrap" class="ft678">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#67">6.8&#160;</a>illustrates&#160;our&#160;implementation&#160;on&#160;Xen.&#160;In&#160;the&#160;present&#160;prototype,&#160;all</p>
<p style="position:absolute;top:676px;left:226px;white-space:nowrap" class="ft6714">framework&#160;components&#160;and&#160;the&#160;CMS&#160;are&#160;implemented&#160;as&#160;libraries&#160;and&#160;services&#160;run-<br/>ning&#160;in&#160;the&#160;Xen&#160;privileged&#160;management&#160;domain&#160;Dom0.&#160;However,&#160;as&#160;we&#160;have&#160;defined<br/>interfaces&#160;between&#160;each&#160;of&#160;the&#160;components,&#160;it&#160;should&#160;be&#160;straightforward&#160;to&#160;move&#160;to-<br/>wards&#160;a&#160;disaggregated&#160;approach&#160;as&#160;described&#160;in&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">[83]</a>.&#160;The&#160;framework&#160;components&#160;are<br/>arranged&#160;in&#160;a&#160;layered&#160;stack.&#160;At&#160;the&#160;lowest&#160;layer&#160;is&#160;the&#160;basic&#160;management&#160;and&#160;secu-<br/>rity&#160;interface&#160;(BMSI)&#160;that&#160;provides&#160;libraries&#160;for&#160;domain&#160;life-cycle&#160;management&#160;(libM),<br/>basic&#160;TPM&#160;access&#160;(libT),&#160;and&#160;integrity&#160;management&#160;(libI).&#160;At&#160;the&#160;core&#160;services&#160;layer<br/>are&#160;the&#160;integrity&#160;manager&#160;services&#160;BIM&#160;and&#160;HIM&#160;that&#160;provide&#160;basic&#160;and&#160;hierarchical<br/>integrity&#160;management,&#160;respectively.&#160;Also&#160;in&#160;this&#160;layer&#160;are&#160;the&#160;CMS&#160;and&#160;the&#160;domain<br/>management&#160;service&#160;(DMS).&#160;At&#160;the&#160;highest&#160;layer&#160;are&#160;the&#160;security&#160;services&#160;that&#160;use&#160;the<br/>framework&#160;for&#160;various&#160;purposes.&#160;The&#160;platform&#160;TCB&#160;consists&#160;of&#160;the&#160;static&#160;components<br/>up&#160;to&#160;and&#160;including&#160;the&#160;SRTM&#160;(the&#160;BMSI&#160;libraries&#160;and&#160;the&#160;integrity&#160;managers).&#160;How-<br/>ever,&#160;for&#160;simplicity,&#160;we&#160;also&#160;include&#160;the&#160;CMS&#160;in&#160;the&#160;platform&#160;TCB.&#160;The&#160;measurements<br/>of&#160;these&#160;components&#160;are&#160;reported&#160;to&#160;the&#160;underlying&#160;TPM.&#160;The&#160;application&#160;TCB&#160;consists<br/>of&#160;the&#160;platform&#160;TCB&#160;plus&#160;the&#160;security&#160;services&#160;that&#160;run&#160;on&#160;top&#160;of&#160;it.&#160;The&#160;measurements<br/>of&#160;the&#160;latter&#160;are&#160;reported&#160;to&#160;the&#160;SRTM.</p>
<p style="position:absolute;top:986px;left:226px;white-space:nowrap" class="ft6724"><b>6.6.2</b></p>
<p style="position:absolute;top:986px;left:280px;white-space:nowrap" class="ft6724"><b>Component&#160;Design</b></p>
<p style="position:absolute;top:1016px;left:226px;white-space:nowrap" class="ft6715">In&#160;the&#160;present&#160;prototype,&#160;we&#160;have&#160;implemented&#160;the&#160;highlighted&#160;components&#160;depicted<br/>in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#67">6.8,&#160;</a>namely&#160;the&#160;BMSI&#160;libraries,&#160;BIM&#160;and&#160;HIM&#160;services,&#160;CMS,&#160;and&#160;DMS.&#160;In<br/>this&#160;section,&#160;we&#160;present&#160;the&#160;details&#160;of&#160;these&#160;components&#160;including&#160;both&#160;the&#160;BIM&#160;and<br/>HIM;&#160;however,&#160;due&#160;to&#160;space&#160;constraints,&#160;we&#160;present&#160;an&#160;example&#160;use&#160;case&#160;that&#160;uses&#160;only</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft6721">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 68 -->
<a name="68"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page68-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5068.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft688">66</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft6821">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft688">the&#160;HIM.</p>
<p style="position:absolute;top:233px;left:150px;white-space:nowrap" class="ft6823"><b>BMSI&#160;Libraries</b></p>
<p style="position:absolute;top:261px;left:150px;white-space:nowrap" class="ft6814">The&#160;Basic&#160;Management&#160;and&#160;Security&#160;Interface&#160;(BMSI)&#160;provides&#160;a&#160;common&#160;and&#160;ex-<br/>tensible&#160;interface&#160;to&#160;the&#160;underlying&#160;hypervisor&#160;(i.e.,&#160;Xen)&#160;and&#160;the&#160;TPM.&#160;The&#160;BMSI<br/>provides&#160;libraries&#160;for&#160;domain&#160;life-cycle&#160;management&#160;(libM),&#160;basic&#160;TPM&#160;access&#160;(libT),<br/>and&#160;integrity&#160;management&#160;(libI).</p>
<p style="position:absolute;top:348px;left:150px;white-space:nowrap" class="ft6823"><b>libM&#160;</b>This&#160;library&#160;provides&#160;hypervisor-agnostic&#160;management&#160;functions&#160;to&#160;upper&#160;layers.</p>
<p style="position:absolute;top:366px;left:187px;white-space:nowrap" class="ft6814">At&#160;its&#160;lowest&#160;level,&#160;the&#160;library&#160;manages&#160;allocatable&#160;resources&#160;called&#160;<i>Protection<br/>Domains&#160;(PDs)</i>.&#160;A&#160;PD&#160;is&#160;an&#160;executable&#160;component&#160;that&#160;receives&#160;an&#160;allocation&#160;of<br/>memory&#160;and&#160;CPU&#160;cycles,&#160;and&#160;is&#160;scheduled&#160;by&#160;the&#160;hypervisor.&#160;On&#160;Xen&#160;platforms,<br/>a&#160;PD&#160;is&#160;equivalent&#160;to&#160;a&#160;Xen&#160;domain&#160;(virtual&#160;machine).&#160;In&#160;this&#160;prototype,&#160;we<br/>use&#160;libM&#160;to&#160;implement&#160;the&#160;Domain&#160;Management&#160;Service&#160;(DMS).&#160;This&#160;service<br/>manages&#160;the&#160;life-cycle&#160;of&#160;PDs&#160;and&#160;uses&#160;the&#160;integrity&#160;managers&#160;to&#160;keep&#160;track&#160;of<br/>PD&#160;integrity.&#160;We&#160;refer&#160;the&#160;reader&#160;to&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">[83]&#160;</a>for&#160;further&#160;details&#160;on&#160;the&#160;libM&#160;and&#160;DMS<br/>implementation.</p>
<p style="position:absolute;top:521px;left:150px;white-space:nowrap" class="ft6823"><b>libT&#160;</b>This&#160;library&#160;provides&#160;the&#160;minimal&#160;functionality&#160;to&#160;access&#160;the&#160;integrity&#160;and&#160;pro-</p>
<p style="position:absolute;top:539px;left:187px;white-space:nowrap" class="ft6814">tected&#160;storage&#160;interfaces&#160;of&#160;the&#160;TPM.&#160;Security&#160;services&#160;(e.g.,&#160;BIM&#160;and&#160;HIM)<br/>use&#160;this&#160;library&#160;to&#160;obtain&#160;a&#160;signed&#160;quotation&#160;of&#160;the&#160;TCB&#160;measurements&#160;and<br/>to&#160;seal/unseal&#160;data&#160;to/from&#160;the&#160;TPM.&#160;To&#160;do&#160;so,&#160;libT&#160;uses&#160;the&#160;TPM&#160;functions</p>
<p style="position:absolute;top:594px;left:187px;white-space:nowrap" class="ft6834">TPM_Quote()</p>
<p style="position:absolute;top:593px;left:286px;white-space:nowrap" class="ft688">,</p>
<p style="position:absolute;top:594px;left:297px;white-space:nowrap" class="ft6834">TPM_Seal()</p>
<p style="position:absolute;top:593px;left:387px;white-space:nowrap" class="ft688">,&#160;and</p>
<p style="position:absolute;top:594px;left:427px;white-space:nowrap" class="ft6834">TPM_Unseal()</p>
<p style="position:absolute;top:593px;left:542px;white-space:nowrap" class="ft688">as&#160;described&#160;by&#160;the</p>
<p style="position:absolute;top:611px;left:187px;white-space:nowrap" class="ft688">TPM&#160;specification&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[114]</a>.</p>
<p style="position:absolute;top:641px;left:150px;white-space:nowrap" class="ft6823"><b>libI&#160;</b>This&#160;library&#160;stores&#160;and&#160;provides&#160;access&#160;to&#160;the&#160;integrity&#160;measurement&#160;and&#160;depen-</p>
<p style="position:absolute;top:659px;left:187px;white-space:nowrap" class="ft688">dency&#160;tables.&#160;The</p>
<p style="position:absolute;top:660px;left:302px;white-space:nowrap" class="ft6834">getMeasurement()</p>
<p style="position:absolute;top:659px;left:450px;white-space:nowrap" class="ft688">function&#160;returns&#160;a&#160;measurement&#160;list</p>
<p style="position:absolute;top:677px;left:187px;white-space:nowrap" class="ft6814">that&#160;includes&#160;the&#160;integrity&#160;measurements&#160;of&#160;the&#160;component&#160;and&#160;its&#160;ancestors.<br/>In&#160;the&#160;BIM&#160;case,&#160;a&#160;single&#160;value&#160;is&#160;returned.&#160;The</p>
<p style="position:absolute;top:696px;left:486px;white-space:nowrap" class="ft6834">setMeasurement()</p>
<p style="position:absolute;top:695px;left:634px;white-space:nowrap" class="ft688">func-</p>
<p style="position:absolute;top:713px;left:187px;white-space:nowrap" class="ft688">tion&#160;extends&#160;the&#160;value&#160;of&#160;the&#160;component&#160;register.&#160;The</p>
<p style="position:absolute;top:713px;left:504px;white-space:nowrap" class="ft6834">resetMeasurement()</p>
<p style="position:absolute;top:731px;left:187px;white-space:nowrap" class="ft688">function&#160;overwrites&#160;the&#160;value&#160;of&#160;the&#160;dynamic&#160;register.&#160;The</p>
<p style="position:absolute;top:731px;left:540px;white-space:nowrap" class="ft6834">addComponent()</p>
<p style="position:absolute;top:749px;left:187px;white-space:nowrap" class="ft6814">function&#160;adds&#160;an&#160;entry&#160;to&#160;the&#160;dependency&#160;table&#160;and&#160;sets&#160;its&#160;dependencies&#160;as&#160;spec-<br/>ified.&#160;It&#160;also&#160;adds&#160;an&#160;entry&#160;to&#160;the&#160;measurements&#160;table&#160;and&#160;records&#160;the&#160;initial<br/>measurements.&#160;The</p>
<p style="position:absolute;top:785px;left:309px;white-space:nowrap" class="ft6834">deleteComponent()</p>
<p style="position:absolute;top:784px;left:465px;white-space:nowrap" class="ft688">function&#160;checks&#160;that&#160;the&#160;specified</p>
<p style="position:absolute;top:802px;left:187px;white-space:nowrap" class="ft688">component&#160;has&#160;no&#160;successors&#160;and&#160;removes&#160;it&#160;from&#160;the&#160;table.</p>
<p style="position:absolute;top:842px;left:150px;white-space:nowrap" class="ft6823"><b>Component&#160;Interactions</b></p>
<p style="position:absolute;top:870px;left:150px;white-space:nowrap" class="ft6814">The&#160;BIM&#160;and&#160;HIM&#160;services&#160;implement&#160;the&#160;interfaces&#160;presented&#160;in&#160;Sections&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#56">6.3&#160;</a>and&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#60">6.4,<br/></a>respectively.&#160;Similarly,&#160;the&#160;CMS&#160;service&#160;implements&#160;the&#160;interfaces&#160;presented&#160;in&#160;Sec-<br/>tion&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#65">6.5.1&#160;</a>and&#160;uses&#160;a&#160;cryptographic&#160;service&#160;as&#160;a&#160;plug-in&#160;for&#160;block&#160;encryption&#160;and&#160;de-<br/>cryption.&#160;On&#160;a&#160;Xen&#160;platform,&#160;we&#160;use&#160;these&#160;services&#160;to&#160;manage&#160;the&#160;integrity&#160;of&#160;VMs<br/>and&#160;applications&#160;running&#160;on&#160;these&#160;VMs.</p>
<p style="position:absolute;top:960px;left:172px;white-space:nowrap" class="ft688">VM&#160;integrity&#160;management&#160;is&#160;incorporated&#160;into&#160;VM&#160;life-cycle&#160;management.&#160;To&#160;as-</p>
<p style="position:absolute;top:978px;left:150px;white-space:nowrap" class="ft6814">sist&#160;both,&#160;the&#160;DMS&#160;uses&#160;the&#160;BMSI&#160;library&#160;libM&#160;and&#160;the&#160;HIM&#160;service.&#160;The&#160;VM&#160;start-up<br/>phase&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#69">6.9&#160;</a>depicts&#160;the&#160;interaction&#160;among&#160;these&#160;components.&#160;During&#160;this&#160;phase,<br/>the&#160;DMS&#160;invokes&#160;libM,&#160;which&#160;prepares&#160;resources&#160;for&#160;the&#160;VM,&#160;measures&#160;the&#160;VM&#160;image<br/>(comprising&#160;the&#160;kernel,&#160;an&#160;optional&#160;initial&#160;ramdisk&#160;and&#160;command-line&#160;parameters),&#160;and<br/>stores&#160;the&#160;measurement&#160;in&#160;the&#160;CCR&#160;for&#160;that&#160;VM.&#160;This&#160;performs&#160;a&#160;function&#160;similar&#160;to&#160;a<br/>secure&#160;bootloader,&#160;and&#160;it&#160;is&#160;the&#160;responsibility&#160;of&#160;the&#160;kernel&#160;to&#160;measure&#160;any&#160;components</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft6821">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 69 -->
<a name="69"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft69149{font-size:5px;font-family:Helvetica;color:#000000;}
	.ft69150{font-size:150px;font-family:Times;color:#000000;}
-->
</style>
<div id="page69-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5069.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft698">CHAPTER&#160;6.&#160;HIERARCHICAL&#160;INTEGRITY&#160;MANAGEMENT</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft698">67</p>
<p style="position:absolute;top:195px;left:315px;white-space:nowrap" class="ft69149">DMS</p>
<p style="position:absolute;top:195px;left:352px;white-space:nowrap" class="ft69149">BMSI:libM</p>
<p style="position:absolute;top:207px;left:328px;white-space:nowrap" class="ft69149">prepareVM()</p>
<p style="position:absolute;top:292px;left:333px;white-space:nowrap" class="ft69149">runVM()</p>
<p style="position:absolute;top:324px;left:326px;white-space:nowrap" class="ft69149">VM_STARTED</p>
<p style="position:absolute;top:195px;left:398px;white-space:nowrap" class="ft69149">PD:VM</p>
<p style="position:absolute;top:224px;left:357px;white-space:nowrap" class="ft69149">preparePD()</p>
<p style="position:absolute;top:195px;left:569px;white-space:nowrap" class="ft69149">HIM</p>
<p style="position:absolute;top:239px;left:458px;white-space:nowrap" class="ft69149">register()</p>
<p style="position:absolute;top:271px;left:464px;white-space:nowrap" class="ft69149">CID</p>
<p style="position:absolute;top:195px;left:605px;white-space:nowrap" class="ft69149">BMSI:libI</p>
<p style="position:absolute;top:249px;left:576px;white-space:nowrap" class="ft69149">addComponent()</p>
<p style="position:absolute;top:260px;left:589px;white-space:nowrap" class="ft69149">CID</p>
<p style="position:absolute;top:303px;left:375px;white-space:nowrap" class="ft69149">startPD()</p>
<p style="position:absolute;top:314px;left:368px;white-space:nowrap" class="ft69149">PD_STARTED</p>
<p style="position:absolute;top:195px;left:646px;white-space:nowrap" class="ft69149">BMSI:libT</p>
<p style="position:absolute;top:410px;left:606px;white-space:nowrap" class="ft69149">unseal()</p>
<p style="position:absolute;top:195px;left:694px;white-space:nowrap" class="ft69149">TPM</p>
<p style="position:absolute;top:431px;left:663px;white-space:nowrap" class="ft69149">TPM_unseal()</p>
<p style="position:absolute;top:442px;left:662px;white-space:nowrap" class="ft69149">unsealed_blob</p>
<p style="position:absolute;top:474px;left:532px;white-space:nowrap" class="ft69149">getMeasurements()</p>
<p style="position:absolute;top:484px;left:524px;white-space:nowrap" class="ft69149">componentMeasurements</p>
<p style="position:absolute;top:116px;left:280px;white-space:nowrap" class="ft69150">&#160;</p>
<p style="position:absolute;top:195px;left:436px;white-space:nowrap" class="ft69149">VM:DRMS</p>
<p style="position:absolute;top:324px;left:480px;white-space:nowrap" class="ft69149">register()</p>
<p style="position:absolute;top:367px;left:485px;white-space:nowrap" class="ft69149">CID</p>
<p style="position:absolute;top:378px;left:414px;white-space:nowrap" class="ft69149">DRMS.run()</p>
<p style="position:absolute;top:399px;left:523px;white-space:nowrap" class="ft69149">unseal()</p>
<p style="position:absolute;top:346px;left:576px;white-space:nowrap" class="ft69149">addComponent()</p>
<p style="position:absolute;top:356px;left:589px;white-space:nowrap" class="ft69149">CID</p>
<p style="position:absolute;top:323px;left:260px;white-space:nowrap" class="ft69150"></p>
<p style="position:absolute;top:282px;left:328px;white-space:nowrap" class="ft69149">VM_READY</p>
<p style="position:absolute;top:195px;left:484px;white-space:nowrap" class="ft69149">CMS</p>
<p style="position:absolute;top:195px;left:519px;white-space:nowrap" class="ft69149">CMS:Crypto</p>
<p style="position:absolute;top:388px;left:460px;white-space:nowrap" class="ft69149">access()</p>
<p style="position:absolute;top:538px;left:450px;white-space:nowrap" class="ft69149">decryptedContent</p>
<p style="position:absolute;top:452px;left:599px;white-space:nowrap" class="ft69149">unsealed_blob</p>
<p style="position:absolute;top:463px;left:516px;white-space:nowrap" class="ft69149">unsealed_blob</p>
<p style="position:absolute;top:501px;left:490px;white-space:nowrap" class="ft69149">verify()</p>
<p style="position:absolute;top:516px;left:501px;white-space:nowrap" class="ft69149">decrypt()</p>
<p style="position:absolute;top:527px;left:494px;white-space:nowrap" class="ft69149">decrypted_blob</p>
<p style="position:absolute;top:583px;left:226px;white-space:nowrap" class="ft6914">Figure&#160;6.9:&#160;Sequence&#160;diagram&#160;of&#160;interactions&#160;between&#160;the&#160;framework&#160;services&#160;for&#160;a<br/>DRM&#160;application&#160;use&#160;case.</p>
<p style="position:absolute;top:649px;left:226px;white-space:nowrap" class="ft6914">which&#160;it&#160;subsequently&#160;loads.&#160;The&#160;DMS&#160;also&#160;registers&#160;the&#160;new&#160;VM&#160;with&#160;the&#160;HIM&#160;ser-<br/>vice,&#160;and&#160;configures&#160;any&#160;dependencies&#160;between&#160;the&#160;new&#160;VM&#160;and&#160;existing&#160;VMs.&#160;The<br/>HIM&#160;uses&#160;libI&#160;to&#160;store&#160;this&#160;information&#160;in&#160;the&#160;measurement&#160;and&#160;dependency&#160;tables.<br/>Following&#160;the&#160;successful&#160;completion&#160;of&#160;the&#160;above&#160;steps,&#160;the&#160;DMS&#160;starts&#160;the&#160;VM.</p>
<p style="position:absolute;top:721px;left:248px;white-space:nowrap" class="ft698">The&#160;HIM&#160;service&#160;additionally&#160;allows&#160;applications&#160;running&#160;in&#160;VMs&#160;to&#160;be&#160;registered</p>
<p style="position:absolute;top:739px;left:226px;white-space:nowrap" class="ft6915">with&#160;the&#160;framework.&#160;The&#160;application&#160;start-up&#160;phase&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#69">6.9&#160;</a>depicts&#160;the&#160;case&#160;in<br/>which&#160;the&#160;VM&#160;that&#160;was&#160;started&#160;in&#160;the&#160;previous&#160;phase&#160;loads&#160;and&#160;registers&#160;a&#160;DRM&#160;service<br/>with&#160;the&#160;HIM.&#160;In&#160;this&#160;case,&#160;the&#160;VM&#160;becomes&#160;an&#160;ancestor&#160;of&#160;the&#160;service&#160;and&#160;provides&#160;its<br/>initial&#160;measurements.&#160;As&#160;a&#160;result,&#160;the&#160;cumulative&#160;integrity&#160;of&#160;the&#160;service&#160;now&#160;includes<br/>the&#160;VM’s&#160;measurements&#160;as&#160;well&#160;as&#160;the&#160;platform&#160;TCB&#160;measurements.</p>
<p style="position:absolute;top:829px;left:248px;white-space:nowrap" class="ft698">The&#160;last&#160;phase&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#69">6.9&#160;</a>depicts&#160;a&#160;use&#160;case&#160;in&#160;which&#160;the&#160;DRM&#160;service&#160;that&#160;was</p>
<p style="position:absolute;top:847px;left:226px;white-space:nowrap" class="ft6914">started&#160;in&#160;the&#160;previous&#160;phase&#160;attempts&#160;to&#160;decrypt&#160;encrypted&#160;media&#160;content&#160;using&#160;a&#160;key<br/>that&#160;is&#160;stored&#160;on&#160;the&#160;TPM&#160;on&#160;behalf&#160;of&#160;this&#160;service.&#160;The&#160;DRM&#160;service&#160;invokes&#160;the&#160;CMS<br/>service&#160;interface&#160;to&#160;request&#160;access&#160;to&#160;this&#160;key.&#160;The&#160;CMS&#160;then&#160;invokes&#160;HIM&#160;unseal&#160;to&#160;re-<br/>trieve&#160;the&#160;key&#160;from&#160;the&#160;TPM.&#160;HIM&#160;unseals&#160;the&#160;key&#160;if&#160;and&#160;only&#160;if&#160;the&#160;underlying&#160;policies<br/>regarding&#160;the&#160;key’s&#160;release&#160;are&#160;satisfied.&#160;In&#160;this&#160;case,&#160;the&#160;key&#160;is&#160;unsealed&#160;from&#160;the&#160;TPM<br/>and&#160;returned&#160;to&#160;the&#160;CMS&#160;if&#160;the&#160;integrity&#160;of&#160;the&#160;platform&#160;TCB&#160;is&#160;intact.&#160;On&#160;receiving&#160;the<br/>key&#160;from&#160;the&#160;HIM,&#160;the&#160;CMS&#160;performs&#160;further&#160;verification.&#160;It&#160;compares&#160;the&#160;expected<br/>CCR&#160;values&#160;of&#160;the&#160;DRM&#160;service&#160;and&#160;its&#160;ancestor&#160;VM&#160;(unsealed&#160;along&#160;with&#160;the&#160;key)&#160;to<br/>the&#160;current&#160;CCR&#160;values.&#160;If&#160;the&#160;measurements&#160;match,&#160;the&#160;CMS&#160;uses&#160;its&#160;cryptographic<br/>service&#160;to&#160;decrypt&#160;the&#160;block,&#160;which&#160;is&#160;then&#160;returned&#160;to&#160;the&#160;DRM&#160;service.&#160;Note&#160;that&#160;any<br/>subsequent&#160;access&#160;requests&#160;to&#160;the&#160;key&#160;will&#160;also&#160;follow&#160;a&#160;similar&#160;verification&#160;cycle,&#160;with<br/>the&#160;exception&#160;that&#160;HIM&#160;(hence&#160;TPM)&#160;seal&#160;is&#160;omitted&#160;because&#160;the&#160;CMS&#160;caches&#160;the&#160;key<br/>internally.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft6921">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 70 -->
<a name="70"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page70-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5070.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft708">68</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft7021">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:189px;left:150px;white-space:nowrap" class="ft7026"><b>6.7</b></p>
<p style="position:absolute;top:189px;left:198px;white-space:nowrap" class="ft7026"><b>Conclusions</b></p>
<p style="position:absolute;top:227px;left:150px;white-space:nowrap" class="ft7014">In&#160;this&#160;paper,&#160;we&#160;have&#160;introduced&#160;a&#160;novel&#160;integrity&#160;management&#160;framework&#160;that&#160;im-<br/>proves&#160;on&#160;the&#160;integrity&#160;measurement&#160;and&#160;policy&#160;verification&#160;capabilities&#160;of&#160;present<br/>Trusted&#160;Computing&#160;solutions.&#160;In&#160;particular,&#160;our&#160;framework&#160;is&#160;able&#160;to&#160;cope&#160;with&#160;the<br/>proliferation&#160;of&#160;measured&#160;components&#160;and&#160;dependencies&#160;between&#160;them&#160;as&#160;well&#160;as&#160;dy-<br/>namic&#160;changes&#160;to&#160;platform&#160;components.&#160;In&#160;essence,&#160;the&#160;framework&#160;implements&#160;a&#160;small,<br/>software-based&#160;root&#160;of&#160;trust&#160;for&#160;measurement&#160;(SRTM)&#160;that&#160;provides&#160;a&#160;secure&#160;link&#160;to&#160;the<br/>core&#160;root&#160;of&#160;trust&#160;for&#160;measurement&#160;(CRTM).&#160;We&#160;have&#160;implemented&#160;our&#160;framework&#160;on<br/>the&#160;Xen&#160;virtual&#160;machine&#160;monitor&#160;and&#160;proposed&#160;several&#160;ways&#160;in&#160;which&#160;security&#160;services<br/>could&#160;take&#160;advantage&#160;of&#160;this&#160;architecture&#160;for&#160;policy&#160;verification&#160;and&#160;access&#160;control.</p>
<p style="position:absolute;top:388px;left:172px;white-space:nowrap" class="ft708">We&#160;anticipate&#160;integrity&#160;and&#160;trust&#160;management&#160;to&#160;become&#160;especially&#160;useful&#160;for&#160;appli-</p>
<p style="position:absolute;top:406px;left:150px;white-space:nowrap" class="ft7015">cation&#160;and&#160;service&#160;level&#160;components.&#160;We&#160;will&#160;therefore&#160;continue&#160;to&#160;investigate&#160;further<br/>potential&#160;uses&#160;for&#160;our&#160;framework&#160;by&#160;user&#160;level&#160;applications.&#160;In&#160;the&#160;short&#160;term,&#160;we&#160;plan<br/>to&#160;implement&#160;CMS-aware&#160;services&#160;such&#160;as&#160;a&#160;virtual&#160;network&#160;service&#160;based&#160;on&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[19]&#160;</a>that<br/>uses&#160;the&#160;CMS&#160;to&#160;store&#160;encryption&#160;keys.&#160;The&#160;virtual&#160;TPM&#160;service&#160;is&#160;also&#160;particularly<br/>interesting.&#160;In&#160;the&#160;long&#160;term,&#160;we&#160;plan&#160;to&#160;investigate&#160;various&#160;ways&#160;of&#160;exploiting&#160;our<br/>framework&#160;to&#160;help&#160;enhance&#160;the&#160;security&#160;properties&#160;of&#160;virtual&#160;TPM&#160;services&#160;(e.g.,&#160;their<br/>binding&#160;to&#160;the&#160;platform&#160;TCB).&#160;Conversely,&#160;we&#160;plan&#160;to&#160;use&#160;virtual&#160;TPM&#160;services&#160;to&#160;help<br/>enhance&#160;the&#160;measurement&#160;capabilities&#160;of&#160;the&#160;HIM&#160;framework&#160;and&#160;provide&#160;more&#160;granu-<br/>lar&#160;run-time&#160;measurements&#160;compared&#160;to&#160;a&#160;single&#160;CCR.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft7021">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 71 -->
<a name="71"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page71-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5071.png" alt="background image"/>
<p style="position:absolute;top:295px;left:226px;white-space:nowrap" class="ft7125"><b>Chapter&#160;7</b></p>
<p style="position:absolute;top:365px;left:226px;white-space:nowrap" class="ft7135"><b>Towards&#160;Automated<br/>Provisioning&#160;of&#160;Secure<br/>Virtualized&#160;Networks</b></p>
<p style="position:absolute;top:512px;left:365px;white-space:nowrap" class="ft718">S.&#160;Cabuk,&#160;C.&#160;Dalton&#160;(HPL),&#160;H.&#160;Ramasamy,&#160;M.&#160;Schunter&#160;(IBM)</p>
<p style="position:absolute;top:586px;left:226px;white-space:nowrap" class="ft7126"><b>7.1</b></p>
<p style="position:absolute;top:586px;left:274px;white-space:nowrap" class="ft7126"><b>Introduction</b></p>
<p style="position:absolute;top:624px;left:226px;white-space:nowrap" class="ft7114">Virtualization&#160;allows&#160;the&#160;abstraction&#160;of&#160;the&#160;real&#160;hardware&#160;configuration&#160;of&#160;a&#160;computer<br/>system.&#160;A&#160;computer&#160;uses&#160;a&#160;layer&#160;of&#160;software,&#160;called&#160;the&#160;Virtual&#160;Machine&#160;Monitor<br/>(VMM),&#160;to&#160;provide&#160;the&#160;illusion&#160;of&#160;real&#160;hardware&#160;for&#160;multiple&#160;virtual&#160;machines&#160;(VMs).<br/>Inside&#160;each&#160;VM,&#160;the&#160;operating&#160;system&#160;(often&#160;called&#160;the&#160;<i>guest&#160;</i>OS)&#160;and&#160;applications&#160;run<br/>on&#160;the&#160;VM’s&#160;own&#160;virtual&#160;resources&#160;such&#160;as&#160;virtual&#160;CPU,&#160;virtual&#160;network&#160;card,&#160;virtual<br/>RAM,&#160;and&#160;virtual&#160;disks.&#160;A&#160;VMM&#160;can&#160;be&#160;hosted&#160;directly&#160;on&#160;the&#160;computer&#160;hardware<br/>(e.g.,&#160;Xen&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[11]&#160;</a>or&#160;VMware&#160;ESX)&#160;or&#160;within&#160;a&#160;host&#160;operating&#160;system&#160;(e.g.,&#160;VMware<br/>Player).</p>
<p style="position:absolute;top:767px;left:248px;white-space:nowrap" class="ft718">A&#160;challenge&#160;of&#160;virtualization&#160;is&#160;isolation&#160;between&#160;potentially&#160;distrusting&#160;virtual&#160;ma-</p>
<p style="position:absolute;top:785px;left:226px;white-space:nowrap" class="ft7115">chines&#160;and&#160;their&#160;resources&#160;that&#160;reside&#160;on&#160;the&#160;same&#160;physical&#160;infrastructure.&#160;Machine&#160;vir-<br/>tualization&#160;alone&#160;provides&#160;reasonable&#160;isolation&#160;of&#160;computing&#160;resources&#160;such&#160;as&#160;mem-<br/>ory&#160;and&#160;CPU&#160;between&#160;guest&#160;domains.&#160;However,&#160;the&#160;network&#160;remains&#160;to&#160;be&#160;a&#160;shared<br/>resource&#160;as&#160;all&#160;traffic&#160;from&#160;guests&#160;eventually&#160;pass&#160;through&#160;a&#160;shared&#160;network&#160;resource<br/>(e.g.,&#160;a&#160;physical&#160;switch)&#160;and&#160;end&#160;up&#160;on&#160;the&#160;shared&#160;physical&#160;medium.&#160;Today’s&#160;VMM<br/>virtual&#160;networking&#160;implementations&#160;provide&#160;simple&#160;mechanisms&#160;to&#160;bridge&#160;all&#160;VM&#160;traf-<br/>fic&#160;through&#160;the&#160;actual&#160;physical&#160;network&#160;card&#160;of&#160;the&#160;physical&#160;machine.&#160;This&#160;level&#160;of<br/>isolation&#160;can&#160;be&#160;sufficient&#160;for&#160;individual&#160;and&#160;small&#160;enterprise&#160;purposes.&#160;However,&#160;a<br/>large-scale&#160;infrastructure&#160;(e.g.,&#160;a&#160;virtualized&#160;data&#160;center)&#160;that&#160;hosts&#160;services&#160;belonging<br/>to&#160;multiple&#160;customers&#160;require&#160;further&#160;guarantees&#160;on&#160;customer&#160;separation,&#160;e.g.,&#160;to&#160;avoid<br/>accidental&#160;or&#160;malicious&#160;data&#160;leakage.</p>
<p style="position:absolute;top:983px;left:248px;white-space:nowrap" class="ft718">Our&#160;focus&#160;in&#160;this&#160;paper&#160;is&#160;security-enhanced&#160;network&#160;virtualization,&#160;which&#160;(1)&#160;al-</p>
<p style="position:absolute;top:1001px;left:226px;white-space:nowrap" class="ft7114">lows&#160;groups&#160;of&#160;related&#160;VMs&#160;running&#160;on&#160;separate&#160;physical&#160;machines&#160;to&#160;be&#160;connected<br/>together&#160;as&#160;though&#160;they&#160;were&#160;on&#160;their&#160;own&#160;separate&#160;network&#160;fabric,&#160;and&#160;(2)&#160;enforces<br/>cross-group&#160;security&#160;requirements&#160;such&#160;as&#160;isolation,&#160;authentication,&#160;confidentiality,&#160;in-<br/>tegrity,&#160;and&#160;information&#160;flow&#160;control.&#160;The&#160;goal&#160;is&#160;to&#160;group&#160;related&#160;VMs&#160;(e.g.,&#160;VMs<br/>belonging&#160;to&#160;the&#160;same&#160;customer&#160;in&#160;a&#160;data&#160;center)&#160;distributed&#160;across&#160;several&#160;physical</p>
<p style="position:absolute;top:1117px;left:476px;white-space:nowrap" class="ft718">69</p>
</div>
<!-- Page 72 -->
<a name="72"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page72-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5072.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft728">70</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft7221">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft7214">machines&#160;into&#160;<i>virtual&#160;enclave&#160;networks</i>,&#160;so&#160;that&#160;each&#160;group&#160;of&#160;VMs&#160;has&#160;the&#160;same&#160;pro-<br/>tection&#160;as&#160;if&#160;the&#160;VMs&#160;were&#160;hosted&#160;on&#160;a&#160;separate&#160;physical&#160;LAN.&#160;Our&#160;solution&#160;for&#160;achiev-<br/>ing&#160;this&#160;goal&#160;also&#160;takes&#160;advantage&#160;(whenever&#160;possible)&#160;of&#160;the&#160;fact&#160;that&#160;some&#160;VMs&#160;in<br/>a&#160;group&#160;may&#160;be&#160;co-hosted&#160;on&#160;the&#160;same&#160;hardware;&#160;it&#160;is&#160;not&#160;necessary&#160;to&#160;involve&#160;the<br/>physical&#160;network&#160;during&#160;information&#160;flow&#160;between&#160;two&#160;such&#160;VMs.</p>
<p style="position:absolute;top:283px;left:172px;white-space:nowrap" class="ft728">The&#160;concept&#160;of&#160;Trusted&#160;Virtual&#160;Domains&#160;or&#160;TVDs&#160;was&#160;put&#160;forth&#160;by&#160;Bussani&#160;et</p>
<p style="position:absolute;top:301px;left:150px;white-space:nowrap" class="ft7214">al.&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[16]&#160;</a>to&#160;provide&#160;quantifiable&#160;security&#160;and&#160;operational&#160;management&#160;for&#160;business&#160;and<br/>IT&#160;services,&#160;and&#160;to&#160;simplify&#160;overall&#160;containment&#160;and&#160;trust&#160;management&#160;in&#160;large&#160;dis-<br/>tributed&#160;systems.&#160;Informally&#160;speaking,&#160;TVDs&#160;can&#160;be&#160;thought&#160;of&#160;as&#160;security-enhanced<br/>variants&#160;of&#160;virtualized&#160;network&#160;zones,&#160;in&#160;which&#160;specified&#160;security&#160;policies&#160;can&#160;be&#160;auto-<br/>matically&#160;enforced.&#160;We&#160;describe&#160;the&#160;first&#160;practical&#160;realization&#160;of&#160;TVDs&#160;using&#160;a&#160;secure<br/>network&#160;virtualization&#160;framework&#160;that&#160;guarantees&#160;reliable&#160;isolation&#160;and&#160;flow&#160;control<br/>requirements&#160;between&#160;TVD&#160;boundaries.&#160;The&#160;requirements&#160;are&#160;specified&#160;by&#160;TVD&#160;poli-<br/>cies,&#160;which&#160;are&#160;enforced&#160;dynamically&#160;despite&#160;changing&#160;TVD&#160;membership,&#160;policies,<br/>and&#160;properties&#160;of&#160;the&#160;member&#160;VMs.&#160;The&#160;framework&#160;is&#160;based&#160;on&#160;existing&#160;and&#160;well-<br/>established&#160;network&#160;virtualization&#160;technologies&#160;such&#160;as&#160;Ethernet&#160;encapsulation,&#160;VLAN<br/>tagging,&#160;virtual&#160;private&#160;networks&#160;(VPNs),&#160;and&#160;network&#160;access&#160;control&#160;(NAC)&#160;for&#160;con-<br/>figuration&#160;validation.</p>
<p style="position:absolute;top:516px;left:172px;white-space:nowrap" class="ft728">Our&#160;main&#160;contributions&#160;are&#160;(1)&#160;combining&#160;standard&#160;network&#160;virtualization&#160;technolo-</p>
<p style="position:absolute;top:534px;left:150px;white-space:nowrap" class="ft7214">gies&#160;to&#160;realize&#160;TVDs,&#160;and&#160;(2)&#160;orchestrating&#160;them&#160;through&#160;a&#160;management&#160;framework&#160;that<br/>is&#160;geared&#160;towards&#160;automation.&#160;In&#160;particular,&#160;our&#160;solution&#160;aims&#160;at&#160;automatically&#160;instan-<br/>tiating&#160;and&#160;deploying&#160;the&#160;appropriate&#160;security&#160;mechanisms&#160;and&#160;network&#160;virtualization<br/>technologies&#160;based&#160;on&#160;an&#160;input&#160;security&#160;model,&#160;which&#160;specifies&#160;the&#160;required&#160;level&#160;of<br/>isolation&#160;and&#160;permitted&#160;network&#160;flows.</p>
<p style="position:absolute;top:664px;left:150px;white-space:nowrap" class="ft7223"><b>Chapter&#160;Outline</b></p>
<p style="position:absolute;top:664px;left:272px;white-space:nowrap" class="ft728">The&#160;remainder&#160;of&#160;this&#160;chapter&#160;is&#160;organized&#160;as&#160;follows.&#160;In&#160;Sec-</p>
<p style="position:absolute;top:682px;left:150px;white-space:nowrap" class="ft7215">tion&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#72">7.2,&#160;</a>we&#160;provide&#160;an&#160;overview&#160;of&#160;our&#160;security&#160;objectives&#160;and&#160;describe&#160;the&#160;high-level<br/>framework&#160;to&#160;achieve&#160;the&#160;objectives.&#160;We&#160;introduce&#160;the&#160;networking&#160;components&#160;re-<br/>quired&#160;for&#160;our&#160;framework&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#76">7.3&#160;</a>and&#160;describe&#160;how&#160;they&#160;can&#160;be&#160;orchestrated<br/>to&#160;enforce&#160;TVD&#160;policies.&#160;In&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#83">7.4,&#160;</a>we&#160;present&#160;the&#160;TVD&#160;security&#160;model&#160;and&#160;the<br/>components&#160;constituting&#160;the&#160;TVD&#160;infrastructure.&#160;In&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#89">7.5,&#160;</a>we&#160;cover&#160;the&#160;dynamic<br/>aspects&#160;of&#160;TVD&#160;deployment&#160;including&#160;TVD&#160;establishment,&#160;population,&#160;and&#160;admission<br/>control.&#160;In&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#94">7.6,&#160;</a>we&#160;describe&#160;a&#160;Xen-based&#160;prototype&#160;implementation&#160;of&#160;our<br/>secure&#160;virtual&#160;networking&#160;framework.</p>
<p style="position:absolute;top:853px;left:150px;white-space:nowrap" class="ft7226"><b>7.2</b></p>
<p style="position:absolute;top:853px;left:198px;white-space:nowrap" class="ft7226"><b>Design&#160;Overview</b></p>
<p style="position:absolute;top:891px;left:150px;white-space:nowrap" class="ft7214">At&#160;a&#160;high&#160;level,&#160;our&#160;network&#160;virtualization&#160;framework&#160;comprises&#160;virtual&#160;networking<br/>(VNET)&#160;and&#160;TVD&#160;infrastructure.&#160;In&#160;essence,&#160;the&#160;VNET&#160;infrastructure&#160;abstracts&#160;away<br/>the&#160;underlying&#160;network&#160;fabric&#160;and&#160;realizes&#160;the&#160;mapping&#160;from&#160;physical&#160;to&#160;logical&#160;net-<br/>work&#160;topologies.&#160;The&#160;TVD&#160;infrastructure&#160;configures&#160;the&#160;network&#160;devices&#160;and&#160;instanti-<br/>ates&#160;the&#160;appropriate&#160;set&#160;of&#160;mechanisms&#160;to&#160;realize&#160;TVD&#160;policies&#160;in&#160;conjunction&#160;with&#160;the<br/>VNET&#160;infrastructure.&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#73">7.1&#160;</a>illustrates&#160;one&#160;such&#160;physical&#160;to&#160;virtual&#160;mapping.&#160;Us-<br/>ing&#160;this&#160;abstraction,&#160;the&#160;logical&#160;layout&#160;as&#160;observed&#160;by&#160;the&#160;TVD&#160;owners&#160;(Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#73">7.1(b))<br/></a>remains&#160;agnostic&#160;to&#160;the&#160;actual&#160;layout&#160;of&#160;the&#160;physical&#160;infrastructure&#160;(Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#73">7.1(a))</a>.&#160;In<br/>this&#160;section,&#160;we&#160;provide&#160;an&#160;overview&#160;of&#160;the&#160;mechanisms&#160;that&#160;enable&#160;this&#160;mapping&#160;while<br/>enforcing&#160;TVD&#160;policies&#160;within&#160;and&#160;across&#160;customer&#160;domains.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft7221">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 73 -->
<a name="73"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page73-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5073.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft738">CHAPTER&#160;7.&#160;SECURE&#160;VIRTUALIZED&#160;NETWORKING</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft738">71</p>
<p style="position:absolute;top:565px;left:440px;white-space:nowrap" class="ft7319">(a)&#160;Physical&#160;view.</p>
<p style="position:absolute;top:757px;left:442px;white-space:nowrap" class="ft7319">(b)&#160;Logical&#160;view.</p>
<p style="position:absolute;top:792px;left:226px;white-space:nowrap" class="ft738">Figure&#160;7.1:&#160;An&#160;example&#160;TVD-based&#160;virtual&#160;network&#160;mapping:</p>
<p style="position:absolute;top:791px;left:618px;white-space:nowrap" class="ft7346">R</p>
<p style="position:absolute;top:792px;left:635px;white-space:nowrap" class="ft738">and</p>
<p style="position:absolute;top:791px;left:662px;white-space:nowrap" class="ft7346">B</p>
<p style="position:absolute;top:792px;left:679px;white-space:nowrap" class="ft738">are&#160;virtual</p>
<p style="position:absolute;top:810px;left:226px;white-space:nowrap" class="ft738">switches&#160;for&#160;<i>red&#160;</i>and&#160;<i>blue&#160;</i>TVDs;</p>
<p style="position:absolute;top:809px;left:428px;white-space:nowrap" class="ft7346">G</p>
<p style="position:absolute;top:810px;left:444px;white-space:nowrap" class="ft738">is&#160;a&#160;virtual&#160;gateway&#160;that&#160;controls&#160;inter-TVD&#160;com-</p>
<p style="position:absolute;top:828px;left:226px;white-space:nowrap" class="ft738">munication&#160;(not&#160;shown&#160;in&#160;(a)&#160;for&#160;clarity).</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft7321">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 74 -->
<a name="74"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page74-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5074.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft748">72</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft7421">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:191px;left:150px;white-space:nowrap" class="ft7424"><b>7.2.1</b></p>
<p style="position:absolute;top:191px;left:204px;white-space:nowrap" class="ft7424"><b>High-level&#160;Objectives</b></p>
<p style="position:absolute;top:222px;left:150px;white-space:nowrap" class="ft7415">This&#160;paper&#160;mainly&#160;considers&#160;virtual&#160;data&#160;centers&#160;that&#160;host&#160;multiple&#160;customers&#160;with&#160;po-<br/>tentially&#160;conflicting&#160;interests.&#160;In&#160;this&#160;setting,&#160;our&#160;secure&#160;networking&#160;framework&#160;helps<br/>meet&#160;the&#160;following&#160;functional&#160;and&#160;security&#160;objectives:</p>
<p style="position:absolute;top:290px;left:150px;white-space:nowrap" class="ft7423"><b>Virtual&#160;Networking&#160;</b>The&#160;framework&#160;should&#160;support&#160;arbitrary&#160;logical&#160;network&#160;topolo-</p>
<p style="position:absolute;top:308px;left:187px;white-space:nowrap" class="ft748">gies&#160;that&#160;inter-connect&#160;virtualized&#160;and&#160;non-virtualized&#160;platforms&#160;alike.</p>
<p style="position:absolute;top:338px;left:150px;white-space:nowrap" class="ft7423"><b>Customer&#160;Separation&#160;</b>The&#160;framework&#160;should&#160;provide&#160;sufficient&#160;separation&#160;guarantees</p>
<p style="position:absolute;top:356px;left:187px;white-space:nowrap" class="ft748">to&#160;customers&#160;such&#160;that&#160;data&#160;leakage&#160;between&#160;customer&#160;domains&#160;is&#160;minima<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#74">l</a></p>
<p style="position:absolute;top:354px;left:632px;white-space:nowrap" class="ft7427"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#74">1</a></p>
<p style="position:absolute;top:356px;left:638px;white-space:nowrap" class="ft748">.</p>
<p style="position:absolute;top:386px;left:150px;white-space:nowrap" class="ft7423"><b>Unified&#160;Policy&#160;Enforcement&#160;</b>The&#160;framework&#160;should&#160;enforce&#160;domain&#160;policies&#160;within</p>
<p style="position:absolute;top:404px;left:187px;white-space:nowrap" class="ft7415">and&#160;across&#160;customer&#160;domains&#160;in&#160;a&#160;seamless&#160;manner.&#160;The&#160;policies&#160;define&#160;integrity,<br/>confidentiality,&#160;and&#160;isolation&#160;requirements&#160;for&#160;each&#160;domain,&#160;and&#160;information&#160;flow<br/>control&#160;requirements&#160;between&#160;any&#160;two&#160;domains.</p>
<p style="position:absolute;top:470px;left:150px;white-space:nowrap" class="ft7423"><b>Autonomous&#160;Management&#160;</b>The&#160;framework&#160;should&#160;deploy,&#160;configure&#160;and&#160;manage&#160;the</p>
<p style="position:absolute;top:488px;left:187px;white-space:nowrap" class="ft748">networking&#160;and&#160;security&#160;mechanisms&#160;in&#160;an&#160;automated&#160;manner.</p>
<p style="position:absolute;top:528px;left:150px;white-space:nowrap" class="ft7424"><b>7.2.2</b></p>
<p style="position:absolute;top:528px;left:204px;white-space:nowrap" class="ft7424"><b>Overview&#160;of&#160;the&#160;VNET&#160;Infrastructure</b></p>
<p style="position:absolute;top:558px;left:150px;white-space:nowrap" class="ft7414">Our&#160;VNET&#160;infrastructure&#160;inter-connects&#160;groups&#160;of&#160;related&#160;VMs&#160;as&#160;though&#160;they&#160;were<br/>on&#160;their&#160;own&#160;separate&#160;network&#160;fabric.&#160;As&#160;a&#160;result,&#160;pockets&#160;of&#160;virtual&#160;LAN&#160;(VLAN)<br/>segments&#160;are&#160;formed&#160;across&#160;the&#160;data&#160;center.&#160;The&#160;central&#160;VLAN&#160;element&#160;is&#160;a&#160;virtual<br/>switch,&#160;which&#160;regulates&#160;and&#160;isolates&#160;the&#160;network&#160;traffic&#160;for&#160;each&#160;segment.&#160;There&#160;is<br/>a&#160;single&#160;virtual&#160;switch&#160;per&#160;VLAN&#160;segment.&#160;A&#160;VM&#160;appears&#160;on&#160;a&#160;particular&#160;VLAN<br/>segment&#160;if&#160;one&#160;of&#160;its&#160;virtual&#160;network&#160;interface&#160;cards&#160;(vNICs)&#160;is&#160;“plugged”&#160;into&#160;one&#160;of<br/>the&#160;switch&#160;ports&#160;on&#160;the&#160;virtual&#160;switch&#160;forming&#160;that&#160;segment.</p>
<p style="position:absolute;top:684px;left:172px;white-space:nowrap" class="ft748">The&#160;virtual&#160;switch&#160;behaves&#160;like&#160;a&#160;normal&#160;physical&#160;switch&#160;and&#160;coordinates&#160;traffic&#160;to</p>
<p style="position:absolute;top:702px;left:150px;white-space:nowrap" class="ft748">and&#160;from&#160;member&#160;VMs.&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#73">7.1(b)&#160;</a>illustrates&#160;two&#160;virtual&#160;switches</p>
<p style="position:absolute;top:701px;left:583px;white-space:nowrap" class="ft7446">R</p>
<p style="position:absolute;top:702px;left:599px;white-space:nowrap" class="ft748">and</p>
<p style="position:absolute;top:701px;left:626px;white-space:nowrap" class="ft7446">B</p>
<p style="position:absolute;top:702px;left:643px;white-space:nowrap" class="ft748">that</p>
<p style="position:absolute;top:720px;left:150px;white-space:nowrap" class="ft7414">coordinate&#160;the&#160;subnet&#160;communication&#160;for&#160;<i>red&#160;</i>and&#160;<i>blue&#160;</i>segments.&#160;The&#160;virtual&#160;switch<br/>logic&#160;resides&#160;either&#160;on&#160;the&#160;host&#160;OS&#160;of&#160;the&#160;virtualized&#160;platform,&#160;or&#160;on&#160;a&#160;dedicated&#160;VM<br/>as&#160;shown&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#73">7.1(a).&#160;</a>To&#160;satisfy&#160;security&#160;properties&#160;even&#160;when&#160;the&#160;traffic&#160;tra-<br/>verses&#160;untrusted&#160;communication&#160;medium,&#160;additional&#160;VPN&#160;modules&#160;may&#160;be&#160;employed.<br/>Similarly,&#160;additional&#160;network&#160;admission&#160;control&#160;(NAC)&#160;modules&#160;may&#160;be&#160;employed&#160;to<br/>authenticate&#160;the&#160;VMs&#160;prior&#160;to&#160;VLAN&#160;admission.</p>
<p style="position:absolute;top:850px;left:150px;white-space:nowrap" class="ft7424"><b>7.2.3</b></p>
<p style="position:absolute;top:850px;left:204px;white-space:nowrap" class="ft7424"><b>Overview&#160;of&#160;the&#160;TVD&#160;Infrastructure</b></p>
<p style="position:absolute;top:880px;left:150px;white-space:nowrap" class="ft7415">A&#160;TVD&#160;is&#160;represented&#160;by&#160;a&#160;set&#160;of&#160;distributed&#160;virtual&#160;processing&#160;elements&#160;(VPE)&#160;(e.g.,<br/>VMs&#160;and&#160;virtual&#160;switches)&#160;and&#160;a&#160;communication&#160;medium&#160;interconnecting&#160;the&#160;VPEs.<br/>The&#160;TVD&#160;provides&#160;a&#160;policy&#160;and&#160;containment&#160;boundary&#160;around&#160;those&#160;VPEs.&#160;At&#160;a&#160;high<br/>level,&#160;the&#160;TVD&#160;policy&#160;has&#160;three&#160;aspects:&#160;(1)&#160;membership&#160;requirements&#160;for&#160;the&#160;TVD,&#160;(2)<br/>interaction&#160;among&#160;VPEs&#160;of&#160;that&#160;TVD,&#160;and&#160;(3)&#160;interaction&#160;of&#160;the&#160;TVD&#160;with&#160;other&#160;TVDs<br/>and&#160;the&#160;outside&#160;world.&#160;VPEs&#160;within&#160;each&#160;TVD&#160;can&#160;usually&#160;communicate&#160;freely&#160;and<br/>securely&#160;with&#160;each&#160;other.&#160;At&#160;the&#160;same&#160;time,&#160;they&#160;are&#160;sufficiently&#160;isolated&#160;from&#160;outside<br/>VPEs&#160;including&#160;those&#160;belonging&#160;to&#160;other&#160;TVDs.&#160;From&#160;a&#160;networking&#160;perspective,&#160;iso-<br/>lation&#160;loosely&#160;refers&#160;to&#160;the&#160;requirement&#160;that&#160;a&#160;dishonest&#160;VPE&#160;in&#160;one&#160;TVD&#160;cannot&#160;send</p>
<p style="position:absolute;top:1051px;left:166px;white-space:nowrap" class="ft7428">1</p>
<p style="position:absolute;top:1053px;left:171px;white-space:nowrap" class="ft7419">Indirect&#160;communication&#160;channels&#160;such&#160;as&#160;covert&#160;and&#160;subliminal&#160;channels&#160;are&#160;outside&#160;the&#160;scope&#160;of&#160;this</p>
<p style="position:absolute;top:1067px;left:150px;white-space:nowrap" class="ft7419">paper.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft7421">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 75 -->
<a name="75"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page75-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5075.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft758">CHAPTER&#160;7.&#160;SECURE&#160;VIRTUALIZED&#160;NETWORKING</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft758">73</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft7514">messages&#160;to&#160;a&#160;dishonest&#160;VPE&#160;in&#160;another&#160;TVD,&#160;unless&#160;the&#160;inter-TVD&#160;policies&#160;explicitly<br/>allow&#160;such&#160;data&#160;flow.</p>
<p style="position:absolute;top:230px;left:248px;white-space:nowrap" class="ft758">Each&#160;TVD&#160;has&#160;an&#160;associated&#160;<i>infrastructure&#160;</i>whose&#160;purpose&#160;is&#160;to&#160;provide&#160;a&#160;unified</p>
<p style="position:absolute;top:247px;left:226px;white-space:nowrap" class="ft7514">level&#160;of&#160;security&#160;to&#160;member&#160;VPEs,&#160;while&#160;restricting&#160;the&#160;interaction&#160;with&#160;VPEs&#160;outside<br/>the&#160;TVD&#160;to&#160;pre-specified,&#160;well-defined&#160;means&#160;only.&#160;Unified&#160;security&#160;within&#160;a&#160;domain<br/>is&#160;obtained&#160;by&#160;defining&#160;and&#160;enforcing&#160;<i>membership&#160;and&#160;communication&#160;requirements<br/></i>that&#160;the&#160;VPEs&#160;and&#160;networks&#160;have&#160;to&#160;satisfy&#160;before&#160;being&#160;admitted&#160;to&#160;the&#160;TVD&#160;and&#160;for<br/>retaining&#160;the&#160;membership.&#160;Unified&#160;security&#160;across&#160;domains&#160;is&#160;obtained&#160;by&#160;defining&#160;and<br/>enforcing&#160;<i>flow&#160;requirements&#160;</i>that&#160;the&#160;VPEs&#160;have&#160;to&#160;satisfy&#160;to&#160;be&#160;able&#160;to&#160;interact&#160;with<br/>VPEs&#160;in&#160;other&#160;TVDs.&#160;To&#160;do&#160;so,&#160;each&#160;TVD&#160;defines&#160;rules&#160;that&#160;regulate&#160;in-bound&#160;and<br/>out-bound&#160;network&#160;traffic&#160;and&#160;restrict&#160;communication&#160;with&#160;the&#160;outside&#160;world.</p>
<p style="position:absolute;top:391px;left:248px;white-space:nowrap" class="ft758">The&#160;central&#160;element&#160;in&#160;the&#160;TVD&#160;infrastructure&#160;is&#160;the&#160;TVD&#160;master&#160;which&#160;keeps&#160;track</p>
<p style="position:absolute;top:409px;left:226px;white-space:nowrap" class="ft7514">of&#160;high-level&#160;TVD&#160;policies&#160;and&#160;secrets.&#160;TVD&#160;masters&#160;maintain&#160;control&#160;over&#160;member<br/>VPEs&#160;using&#160;TVD&#160;proxies.&#160;There&#160;is&#160;a&#160;single&#160;TVD&#160;master&#160;per&#160;TVD&#160;and&#160;a&#160;single&#160;TVD<br/>proxy&#160;per&#160;physical&#160;platform.&#160;A&#160;VPE&#160;appears&#160;on&#160;a&#160;particular&#160;TVD&#160;if&#160;it&#160;complies&#160;with&#160;the<br/>membership&#160;requirements&#160;enforced&#160;by&#160;the&#160;TVD&#160;proxy&#160;controlling&#160;that&#160;domain&#160;on&#160;that<br/>physical&#160;platform.&#160;VPEs&#160;communicate&#160;freely&#160;within&#160;a&#160;TVD.&#160;Communication&#160;across<br/>TVDs&#160;is&#160;controlled&#160;by&#160;entities&#160;configured&#160;by&#160;TVD&#160;proxies.</p>
<p style="position:absolute;top:539px;left:226px;white-space:nowrap" class="ft7524"><b>7.2.4</b></p>
<p style="position:absolute;top:539px;left:280px;white-space:nowrap" class="ft7524"><b>Overview&#160;of&#160;TVD-based&#160;Virtual&#160;Networking</b></p>
<p style="position:absolute;top:569px;left:226px;white-space:nowrap" class="ft7514">VNET&#160;and&#160;TVD&#160;infrastructures&#160;play&#160;complementary&#160;roles&#160;in&#160;meeting&#160;the&#160;aforemen-<br/>tioned&#160;high-level&#160;objectives.&#160;In&#160;particular,&#160;the&#160;VNET&#160;infrastructure&#160;provides&#160;the&#160;tools<br/>and&#160;mechanisms&#160;to&#160;enable&#160;secure&#160;virtual&#160;networking&#160;in&#160;a&#160;data&#160;center.&#160;The&#160;TVD&#160;infras-<br/>tructure&#160;defines&#160;unified&#160;domain&#160;policies,&#160;and&#160;automatically&#160;configures&#160;and&#160;manages<br/>these&#160;mechanisms&#160;in&#160;conjunction&#160;with&#160;the&#160;policy.&#160;It&#160;also&#160;provides&#160;domain&#160;customers<br/>the&#160;necessary&#160;tools&#160;to&#160;manage&#160;their&#160;TVDs.&#160;Any&#160;action&#160;by&#160;the&#160;customer&#160;is&#160;then&#160;seam-<br/>lessly&#160;reflected&#160;on&#160;the&#160;underlying&#160;VNET&#160;infrastructure&#160;in&#160;an&#160;automated&#160;manner.</p>
<p style="position:absolute;top:695px;left:248px;white-space:nowrap" class="ft758">This&#160;two-layer&#160;architecture&#160;has&#160;many&#160;advantages:</p>
<p style="position:absolute;top:728px;left:245px;white-space:nowrap" class="ft758">1.&#160;The&#160;policy&#160;(TVD)&#160;and&#160;enforcement&#160;(VNET)&#160;layers&#160;are&#160;clearly&#160;separated&#160;from</p>
<p style="position:absolute;top:746px;left:263px;white-space:nowrap" class="ft7515">each&#160;other,&#160;which&#160;yields&#160;a&#160;modular&#160;framework.&#160;As&#160;a&#160;result,&#160;a&#160;plethora&#160;of&#160;VNET<br/>technologies&#160;can&#160;be&#160;deployed&#160;underneath&#160;the&#160;TVD&#160;infrastructure&#160;in&#160;place&#160;of&#160;the<br/>current&#160;offering.</p>
<p style="position:absolute;top:811px;left:245px;white-space:nowrap" class="ft758">2.&#160;The&#160;policy&#160;layer&#160;is&#160;not&#160;restricted&#160;to&#160;network-type&#160;policies&#160;only.&#160;For&#160;example,</p>
<p style="position:absolute;top:829px;left:263px;white-space:nowrap" class="ft7514">similar&#160;policies&#160;can&#160;be&#160;devised&#160;to&#160;configure&#160;and&#160;manage&#160;mechanisms&#160;to&#160;share<br/>virtual&#160;storage&#160;between&#160;VMs&#160;in&#160;a&#160;single&#160;TVD.</p>
<p style="position:absolute;top:877px;left:245px;white-space:nowrap" class="ft758">3.&#160;The&#160;policy&#160;layer&#160;provides&#160;a&#160;high-level&#160;abstraction&#160;of&#160;the&#160;infrastructure&#160;to&#160;cus-</p>
<p style="position:absolute;top:895px;left:263px;white-space:nowrap" class="ft7514">tomers,&#160;which&#160;in&#160;turn&#160;yields&#160;simpler&#160;administrative&#160;tools&#160;that&#160;are&#160;agnostic&#160;to&#160;the<br/>complexities&#160;of&#160;the&#160;underlying&#160;VNET&#160;technology.</p>
<p style="position:absolute;top:943px;left:245px;white-space:nowrap" class="ft758">4.&#160;Automated&#160;deployment,&#160;configuration&#160;and&#160;management&#160;of&#160;customer&#160;TVDs&#160;are</p>
<p style="position:absolute;top:961px;left:263px;white-space:nowrap" class="ft7514">desirable&#160;in&#160;a&#160;virtual&#160;data&#160;center&#160;that&#160;can&#160;effectively&#160;reduce&#160;operational&#160;costs<br/>by&#160;easing&#160;the&#160;management&#160;burden,&#160;and&#160;mitigate&#160;insider&#160;threat&#160;by&#160;automating<br/>administrative&#160;tasks.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft7521">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 76 -->
<a name="76"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page76-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5076.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft768">74</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft7621">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:449px;left:150px;white-space:nowrap" class="ft768">Figure&#160;7.2:&#160;An&#160;Example&#160;Physical&#160;to&#160;Virtual&#160;Mapping&#160;with&#160;two&#160;Virtual&#160;LAN&#160;Segments.</p>
<p style="position:absolute;top:508px;left:150px;white-space:nowrap" class="ft7626"><b>7.3</b></p>
<p style="position:absolute;top:508px;left:198px;white-space:nowrap" class="ft7626"><b>Networking&#160;Infrastructure</b></p>
<p style="position:absolute;top:546px;left:150px;white-space:nowrap" class="ft7614">In&#160;this&#160;section,&#160;we&#160;present&#160;the&#160;network&#160;virtualization&#160;layer&#160;that&#160;enables&#160;the&#160;creation&#160;of<br/>arbitrary&#160;virtual&#160;topologies&#160;on&#160;top&#160;of&#160;the&#160;underlying&#160;physical&#160;network.&#160;This&#160;layer&#160;also<br/>provides&#160;the&#160;basic&#160;mechanisms&#160;to&#160;help&#160;enforce&#160;TVD&#160;admission&#160;and&#160;flow&#160;policies&#160;at&#160;a<br/>higher&#160;level.</p>
<p style="position:absolute;top:640px;left:150px;white-space:nowrap" class="ft7624"><b>7.3.1</b></p>
<p style="position:absolute;top:640px;left:204px;white-space:nowrap" class="ft7624"><b>Aims&#160;and&#160;Requirements</b></p>
<p style="position:absolute;top:670px;left:150px;white-space:nowrap" class="ft7623"><b>Functional&#160;Requirements</b></p>
<p style="position:absolute;top:698px;left:150px;white-space:nowrap" class="ft7614">The&#160;main&#160;aim&#160;of&#160;the&#160;VNET&#160;infrastructure&#160;is&#160;to&#160;allow&#160;groups&#160;of&#160;related&#160;VMs&#160;running<br/>on&#160;separate&#160;physical&#160;machines&#160;to&#160;be&#160;connected&#160;together&#160;as&#160;though&#160;they&#160;were&#160;on&#160;their<br/>own&#160;separate&#160;network&#160;fabric.&#160;For&#160;example,&#160;a&#160;group&#160;of&#160;related&#160;VMs&#160;may&#160;have&#160;to&#160;be<br/>connected&#160;directly&#160;together&#160;on&#160;the&#160;same&#160;VLAN&#160;segment&#160;even&#160;though,&#160;in&#160;reality,&#160;they<br/>may&#160;be&#160;at&#160;opposite&#160;ends&#160;of&#160;a&#160;WAN&#160;link&#160;separated&#160;by&#160;many&#160;physical&#160;LAN&#160;segments.<br/>Further,&#160;multiple&#160;segmented&#160;virtual&#160;networks&#160;may&#160;have&#160;to&#160;be&#160;established&#160;on&#160;a&#160;single<br/>physical&#160;network&#160;segment&#160;to&#160;achieve&#160;improved&#160;security&#160;properties&#160;such&#160;as&#160;network<br/>isolation.&#160;Third,&#160;the&#160;VNET&#160;infrastructure&#160;needs&#160;to&#160;inter-operate&#160;with&#160;existing&#160;non-<br/>virtualized&#160;entities&#160;(e.g.,&#160;standard&#160;client&#160;machines&#160;on&#160;the&#160;Internet)&#160;and&#160;allow&#160;our&#160;virtual<br/>networks&#160;to&#160;connect&#160;to&#160;real&#160;networks.</p>
<p style="position:absolute;top:878px;left:172px;white-space:nowrap" class="ft768">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#76">7.2&#160;</a>illustrates&#160;an&#160;example&#160;physical&#160;to&#160;virtual&#160;mapping.&#160;Physical&#160;machine</p>
<p style="position:absolute;top:896px;left:150px;white-space:nowrap" class="ft7615">A&#160;hosts&#160;two&#160;VMs.&#160;One&#160;of&#160;them&#160;(A2)&#160;is&#160;connected&#160;into&#160;VLAN&#160;segment&#160;1.&#160;Physical<br/>machine&#160;B&#160;also&#160;hosts&#160;two&#160;VMs.&#160;One&#160;of&#160;them&#160;(B1)&#160;is&#160;also&#160;connected&#160;into&#160;VLAN&#160;seg-<br/>ment&#160;1.&#160;VM&#160;A1&#160;and&#160;VM&#160;B1&#160;appear&#160;as&#160;though&#160;they&#160;are&#160;connected&#160;together&#160;via&#160;a&#160;single<br/>LAN&#160;segment&#160;even&#160;though&#160;in&#160;reality&#160;the&#160;physical&#160;network&#160;connecting&#160;them&#160;consists<br/>of&#160;multiple&#160;LAN&#160;segments&#160;interconnected&#160;via&#160;routers.&#160;VMs&#160;C2&#160;and&#160;D1&#160;are&#160;also&#160;con-<br/>nected&#160;together&#160;via&#160;VLAN&#160;segment&#160;2.&#160;Traffic&#160;is&#160;isolated&#160;between&#160;VLAN&#160;segments&#160;so<br/>machines&#160;C2&#160;and&#160;D1&#160;cannot&#160;see&#160;the&#160;traffic&#160;passing&#160;between&#160;A2&#160;and&#160;B1&#160;even&#160;though<br/>they&#160;are&#160;sharing&#160;the&#160;underlying&#160;physical&#160;network&#160;infrastructure.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft7621">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 77 -->
<a name="77"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page77-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5077.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft778">CHAPTER&#160;7.&#160;SECURE&#160;VIRTUALIZED&#160;NETWORKING</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft778">75</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft7723"><b>Attacker&#160;Model</b></p>
<p style="position:absolute;top:222px;left:226px;white-space:nowrap" class="ft7714">Our&#160;research&#160;specifically&#160;focuses&#160;on&#160;virtual&#160;data&#160;centers&#160;that&#160;aim&#160;to&#160;separate&#160;customer<br/>networks&#160;and&#160;protect&#160;network&#160;traffic&#160;even&#160;when&#160;the&#160;transmission&#160;lines&#160;are&#160;untrusted.<br/>We&#160;mainly&#160;focus&#160;on&#160;network&#160;separation&#160;and&#160;protection;&#160;however,&#160;our&#160;policies&#160;and&#160;in-<br/>frastructure&#160;are&#160;generic&#160;and&#160;can&#160;be&#160;applied&#160;to&#160;other&#160;requirements&#160;such&#160;as&#160;storage&#160;isola-<br/>tion.&#160;A&#160;particular&#160;threat&#160;we&#160;consider&#160;here&#160;is&#160;the&#160;threat&#160;of&#160;malicious&#160;data&#160;center&#160;users&#160;that<br/>can&#160;try&#160;to&#160;gain&#160;access&#160;to&#160;other&#160;customer&#160;networks&#160;for&#160;the&#160;purpose&#160;of&#160;stealing&#160;sensitive<br/>information&#160;or&#160;rendering&#160;those&#160;systems&#160;unusable.</p>
<p style="position:absolute;top:329px;left:547px;white-space:nowrap" class="ft778">Additional&#160;threats&#160;could&#160;include</p>
<p style="position:absolute;top:347px;left:226px;white-space:nowrap" class="ft7715">malicious&#160;users&#160;tapping&#160;untrusted&#160;transmission&#160;lines&#160;when&#160;data&#160;travels&#160;across&#160;a&#160;WAN;<br/>malicious&#160;users&#160;injecting&#160;traffic&#160;into&#160;unauthorized&#160;network&#160;segments;&#160;or&#160;in&#160;a&#160;more&#160;ex-<br/>treme&#160;case,&#160;a&#160;compromised&#160;virtual&#160;network&#160;device&#160;leaking&#160;all&#160;data&#160;passing&#160;through&#160;the<br/>switch&#160;or&#160;router.&#160;These&#160;risks&#160;clearly&#160;reduce&#160;the&#160;benefits&#160;of&#160;machine&#160;consolidation&#160;in&#160;a<br/>virtual&#160;data&#160;center.&#160;The&#160;risks&#160;also&#160;limit&#160;the&#160;guarantees&#160;that&#160;infrastructure&#160;owners&#160;would<br/>put&#160;into&#160;service-level&#160;agreements&#160;when&#160;compared&#160;to&#160;the&#160;case&#160;of&#160;physical&#160;isolation&#160;of<br/>the&#160;networks&#160;belonging&#160;to&#160;different&#160;customers.</p>
<p style="position:absolute;top:494px;left:226px;white-space:nowrap" class="ft7723"><b>Security&#160;Requirements</b></p>
<p style="position:absolute;top:523px;left:226px;white-space:nowrap" class="ft7715">Our&#160;VNET&#160;infrastructure&#160;adheres&#160;to&#160;following&#160;security&#160;requirements&#160;to&#160;address&#160;these<br/>threats&#160;in&#160;a&#160;virtual&#160;data&#160;center:</p>
<p style="position:absolute;top:573px;left:245px;white-space:nowrap" class="ft778">1.&#160;The&#160;infrastructure&#160;must&#160;provide&#160;logical&#160;isolation&#160;of&#160;VLAN&#160;segments.&#160;A&#160;rogue</p>
<p style="position:absolute;top:591px;left:263px;white-space:nowrap" class="ft7715">segment&#160;must&#160;not&#160;be&#160;able&#160;to&#160;gain&#160;control&#160;of&#160;devices&#160;that&#160;belong&#160;to&#160;other&#160;VLANs<br/>in&#160;the&#160;virtual&#160;data&#160;center.</p>
<p style="position:absolute;top:639px;left:245px;white-space:nowrap" class="ft778">2.&#160;The&#160;infrastructure&#160;must&#160;protect&#160;and&#160;separate&#160;the&#160;traffic&#160;generated&#160;by&#160;each&#160;VLAN</p>
<p style="position:absolute;top:657px;left:263px;white-space:nowrap" class="ft7714">segment.&#160;VLANs&#160;must&#160;not&#160;be&#160;able&#160;to&#160;see,&#160;intercept&#160;or&#160;inject&#160;packets&#160;into&#160;traffic<br/>originating&#160;from&#160;other&#160;VLANs.</p>
<p style="position:absolute;top:705px;left:245px;white-space:nowrap" class="ft778">3.&#160;Network&#160;connections&#160;can&#160;be&#160;established&#160;between&#160;VMs&#160;that&#160;belong&#160;to&#160;the&#160;same</p>
<p style="position:absolute;top:723px;left:263px;white-space:nowrap" class="ft7714">VLAN&#160;segment&#160;and&#160;between&#160;VMs&#160;that&#160;belong&#160;to&#160;different&#160;VLAN&#160;segments&#160;(i.e.,<br/>TVDs).&#160;The&#160;infrastructure&#160;must&#160;secure&#160;these&#160;connections&#160;whenever&#160;they&#160;are<br/>established&#160;over&#160;untrusted&#160;physical&#160;medium.</p>
<p style="position:absolute;top:789px;left:245px;white-space:nowrap" class="ft778">4.&#160;The&#160;infrastructure&#160;must&#160;authenticate&#160;and&#160;sanity-check&#160;all&#160;VNET&#160;entities&#160;(virtual</p>
<p style="position:absolute;top:806px;left:263px;white-space:nowrap" class="ft7714">or&#160;physical)&#160;including&#160;the&#160;management&#160;entities&#160;prior&#160;to&#160;admission&#160;to&#160;the&#160;particu-<br/>lar&#160;VLAN&#160;segment.</p>
<p style="position:absolute;top:865px;left:226px;white-space:nowrap" class="ft7724"><b>7.3.2</b></p>
<p style="position:absolute;top:865px;left:280px;white-space:nowrap" class="ft7724"><b>Networking&#160;Infrastructure</b></p>
<p style="position:absolute;top:895px;left:226px;white-space:nowrap" class="ft7715">One&#160;option&#160;for&#160;virtual&#160;networking&#160;is&#160;to&#160;virtualize&#160;at&#160;the&#160;IP&#160;level.&#160;However,&#160;to&#160;also<br/>support&#160;non-IP&#160;protocols&#160;and&#160;IP&#160;support&#160;services&#160;(such&#160;as&#160;ARP)&#160;that&#160;sit&#160;directly&#160;on&#160;top<br/>of&#160;the&#160;Ethernet&#160;protocol,&#160;we&#160;have&#160;chosen&#160;to&#160;virtualize&#160;at&#160;the&#160;Ethernet&#160;level.</p>
<p style="position:absolute;top:971px;left:226px;white-space:nowrap" class="ft7723"><b>Architecture&#160;Overview</b></p>
<p style="position:absolute;top:999px;left:226px;white-space:nowrap" class="ft7714">Our&#160;VNET&#160;infrastructure&#160;employs&#160;a&#160;mixture&#160;of&#160;physical&#160;and&#160;virtual&#160;networking&#160;en-<br/>tities&#160;to&#160;inter-connect&#160;physical&#160;and&#160;virtual&#160;machines&#160;with&#160;respect&#160;to&#160;the&#160;logical&#160;topol-<br/>ogy.&#160;Physical&#160;networking&#160;entities&#160;include&#160;standard&#160;physical&#160;networking&#160;devices&#160;such&#160;as<br/>VLAN-enabled&#160;switches&#160;and&#160;routers.&#160;Virtual&#160;networking&#160;entities&#160;include&#160;virtual&#160;net-<br/>work&#160;interface&#160;cards&#160;(vNICs),&#160;virtual&#160;switches,&#160;virtual&#160;routers,&#160;and&#160;virtual&#160;gateways.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft7721">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 78 -->
<a name="78"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page78-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5078.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft788">76</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft7821">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:437px;left:232px;white-space:nowrap" class="ft788">Table&#160;7.1:&#160;Virtual&#160;components&#160;of&#160;the&#160;VNET&#160;infrastructure.</p>
<p style="position:absolute;top:470px;left:159px;white-space:nowrap" class="ft788">VNET</p>
<p style="position:absolute;top:470px;left:225px;white-space:nowrap" class="ft788">C</p>
<p style="position:absolute;top:472px;left:235px;white-space:nowrap" class="ft7819">OMPO</p>
<p style="position:absolute;top:470px;left:273px;white-space:nowrap" class="ft788">-</p>
<p style="position:absolute;top:490px;left:159px;white-space:nowrap" class="ft7819">NENT</p>
<p style="position:absolute;top:470px;left:297px;white-space:nowrap" class="ft788">F</p>
<p style="position:absolute;top:472px;left:306px;white-space:nowrap" class="ft7819">UNCTIONALITY</p>
<p style="position:absolute;top:509px;left:159px;white-space:nowrap" class="ft788">Virtual&#160;NIC</p>
<p style="position:absolute;top:509px;left:296px;white-space:nowrap" class="ft788">Connects&#160;a&#160;virtual&#160;machine&#160;to&#160;a&#160;virtual&#160;switch</p>
<p style="position:absolute;top:528px;left:159px;white-space:nowrap" class="ft788">Virtual&#160;Switch</p>
<p style="position:absolute;top:528px;left:296px;white-space:nowrap" class="ft7814">Provides&#160;centralised&#160;switching&#160;functionality&#160;per&#160;subnet<br/>Performs&#160;address&#160;mapping&#160;and&#160;translation&#160;using&#160;switching&#160;ta-<br/>ble<br/>Provides&#160;logical&#160;traffic&#160;isolation&#160;between&#160;VLAN&#160;segments</p>
<p style="position:absolute;top:600px;left:159px;white-space:nowrap" class="ft788">EtherIP&#160;Module</p>
<p style="position:absolute;top:600px;left:296px;white-space:nowrap" class="ft7815">Tunnels&#160;Ethernet&#160;and&#160;802.3&#160;packets&#160;via&#160;IP&#160;datagrams<br/>Expands&#160;a&#160;LAN&#160;over&#160;a&#160;WAN&#160;or&#160;MAN</p>
<p style="position:absolute;top:636px;left:159px;white-space:nowrap" class="ft788">VLAN&#160;Module</p>
<p style="position:absolute;top:636px;left:296px;white-space:nowrap" class="ft7814">Tags&#160;Layer&#160;2&#160;frames&#160;with&#160;the&#160;corresponding&#160;VLAN&#160;identifier<br/>Provides&#160;traffic&#160;isolation&#160;on&#160;the&#160;physical&#160;switch</p>
<p style="position:absolute;top:673px;left:159px;white-space:nowrap" class="ft788">VPN&#160;Module</p>
<p style="position:absolute;top:673px;left:296px;white-space:nowrap" class="ft7815">Encapsulates&#160;traffic&#160;in&#160;IP&#160;packets<br/>Provides&#160;confidentiality&#160;and&#160;integrity&#160;over&#160;insecure&#160;medium</p>
<p style="position:absolute;top:709px;left:159px;white-space:nowrap" class="ft788">NAC&#160;Module</p>
<p style="position:absolute;top:709px;left:296px;white-space:nowrap" class="ft7814">Enables&#160;port-based&#160;access&#160;control&#160;and&#160;compliance&#160;checking<br/>prior&#160;to&#160;network&#160;admission</p>
<p style="position:absolute;top:746px;left:159px;white-space:nowrap" class="ft788">Virtual&#160;Router</p>
<p style="position:absolute;top:746px;left:296px;white-space:nowrap" class="ft7814">Routes&#160;Layer&#160;3&#160;traffic&#160;between&#160;VMs&#160;on&#160;different&#160;VLAN&#160;seg-<br/>ments</p>
<p style="position:absolute;top:782px;left:159px;white-space:nowrap" class="ft788">Virtual&#160;Gateway</p>
<p style="position:absolute;top:782px;left:296px;white-space:nowrap" class="ft7814">Advertises&#160;routing&#160;information&#160;about&#160;the&#160;virtual&#160;network&#160;be-<br/>hind&#160;it<br/>Converts&#160;packets&#160;to&#160;and&#160;from&#160;the&#160;VNET&#160;encapsulated&#160;format</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft7821">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 79 -->
<a name="79"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft79151{font-size:8px;font-family:Helvetica;color:#000000;-moz-transform: matrix(         0,          1, -1.000179032,          0, 0, 0);-webkit-transform: matrix(         0,          1, -1.000179032,          0, 0, 0);-o-transform: matrix(         0,          1, -1.000179032,          0, 0, 0);-ms-transform: matrix(         0,          1, -1.000179032,          0, 0, 0);-moz-transform-origin: left 75%;-webkit-transform-origin: left 75%;-o-transform-origin: left 75%;-ms-transform-origin: left 75%;}
	.ft79152{font-size:13px;line-height:14px;font-family:Helvetica;color:#000000;}
	.ft79153{font-size:8px;line-height:12px;font-family:Helvetica;color:#000000;-moz-transform: matrix(         0,          1, -1.000179032,          0, 0, 0);-webkit-transform: matrix(         0,          1, -1.000179032,          0, 0, 0);-o-transform: matrix(         0,          1, -1.000179032,          0, 0, 0);-ms-transform: matrix(         0,          1, -1.000179032,          0, 0, 0);-moz-transform-origin: left 75%;-webkit-transform-origin: left 75%;-o-transform-origin: left 75%;-ms-transform-origin: left 75%;}
	.ft79154{font-size:13px;line-height:15px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page79-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5079.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft798">CHAPTER&#160;7.&#160;SECURE&#160;VIRTUALIZED&#160;NETWORKING</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft798">77</p>
<p style="position:absolute;top:277px;left:278px;white-space:nowrap" class="ft79100"><b>vSwitches</b></p>
<p style="position:absolute;top:317px;left:278px;white-space:nowrap" class="ft79100"><b>VPN</b></p>
<p style="position:absolute;top:222px;left:278px;white-space:nowrap" class="ft79152"><b>VMs<br/>&amp;&#160;vNICs</b></p>
<p style="position:absolute;top:347px;left:611px;white-space:nowrap" class="ft79151"><b>E</b></p>
<p style="position:absolute;top:353px;left:611px;white-space:nowrap" class="ft79153"><b>the<br/>rI</b></p>
<p style="position:absolute;top:371px;left:611px;white-space:nowrap" class="ft79151"><b>P</b></p>
<p style="position:absolute;top:357px;left:278px;white-space:nowrap" class="ft79154"><b>EtherIP<br/>encapsulation</b></p>
<p style="position:absolute;top:347px;left:650px;white-space:nowrap" class="ft79151"><b>E</b></p>
<p style="position:absolute;top:353px;left:650px;white-space:nowrap" class="ft79153"><b>the<br/>rI</b></p>
<p style="position:absolute;top:371px;left:650px;white-space:nowrap" class="ft79151"><b>P</b></p>
<p style="position:absolute;top:464px;left:278px;white-space:nowrap" class="ft79154"><b>VLAN-enabled<br/>Physical&#160;Switch</b></p>
<p style="position:absolute;top:520px;left:593px;white-space:nowrap" class="ft79100"><b>TCP/IP</b></p>
<p style="position:absolute;top:193px;left:547px;white-space:nowrap" class="ft79100"><b>Host-3</b></p>
<p style="position:absolute;top:193px;left:620px;white-space:nowrap" class="ft79100"><b>Host-4</b></p>
<p style="position:absolute;top:347px;left:392px;white-space:nowrap" class="ft79151"><b>E</b></p>
<p style="position:absolute;top:353px;left:392px;white-space:nowrap" class="ft79153"><b>the<br/>rI</b></p>
<p style="position:absolute;top:371px;left:392px;white-space:nowrap" class="ft79151"><b>P</b></p>
<p style="position:absolute;top:389px;left:411px;white-space:nowrap" class="ft79151"><b>T</b></p>
<p style="position:absolute;top:394px;left:411px;white-space:nowrap" class="ft79151"><b>a</b></p>
<p style="position:absolute;top:398px;left:411px;white-space:nowrap" class="ft79151"><b>gge</b></p>
<p style="position:absolute;top:413px;left:411px;white-space:nowrap" class="ft79151"><b>r</b></p>
<p style="position:absolute;top:414px;left:278px;white-space:nowrap" class="ft79100"><b>VLAN&#160;Tagging</b></p>
<p style="position:absolute;top:193px;left:401px;white-space:nowrap" class="ft79100"><b>Host-1</b></p>
<p style="position:absolute;top:304px;left:502px;white-space:nowrap" class="ft79151"><b>V</b></p>
<p style="position:absolute;top:310px;left:502px;white-space:nowrap" class="ft79151"><b>P</b></p>
<p style="position:absolute;top:316px;left:502px;white-space:nowrap" class="ft79151"><b>N</b></p>
<p style="position:absolute;top:345px;left:464px;white-space:nowrap" class="ft79151"><b>E</b></p>
<p style="position:absolute;top:351px;left:464px;white-space:nowrap" class="ft79153"><b>the<br/>rI</b></p>
<p style="position:absolute;top:369px;left:464px;white-space:nowrap" class="ft79151"><b>P</b></p>
<p style="position:absolute;top:347px;left:502px;white-space:nowrap" class="ft79151"><b>E</b></p>
<p style="position:absolute;top:353px;left:502px;white-space:nowrap" class="ft79153"><b>the<br/>rI</b></p>
<p style="position:absolute;top:371px;left:502px;white-space:nowrap" class="ft79151"><b>P</b></p>
<p style="position:absolute;top:192px;left:474px;white-space:nowrap" class="ft79100"><b>Host-2</b></p>
<p style="position:absolute;top:389px;left:392px;white-space:nowrap" class="ft79151"><b>T</b></p>
<p style="position:absolute;top:394px;left:392px;white-space:nowrap" class="ft79151"><b>a</b></p>
<p style="position:absolute;top:398px;left:392px;white-space:nowrap" class="ft79151"><b>gge</b></p>
<p style="position:absolute;top:413px;left:392px;white-space:nowrap" class="ft79151"><b>r</b></p>
<p style="position:absolute;top:389px;left:483px;white-space:nowrap" class="ft79151"><b>T</b></p>
<p style="position:absolute;top:394px;left:483px;white-space:nowrap" class="ft79151"><b>a</b></p>
<p style="position:absolute;top:398px;left:483px;white-space:nowrap" class="ft79151"><b>gge</b></p>
<p style="position:absolute;top:413px;left:483px;white-space:nowrap" class="ft79151"><b>r</b></p>
<p style="position:absolute;top:389px;left:465px;white-space:nowrap" class="ft79151"><b>T</b></p>
<p style="position:absolute;top:394px;left:465px;white-space:nowrap" class="ft79151"><b>a</b></p>
<p style="position:absolute;top:399px;left:465px;white-space:nowrap" class="ft79151"><b>gge</b></p>
<p style="position:absolute;top:414px;left:465px;white-space:nowrap" class="ft79151"><b>r</b></p>
<p style="position:absolute;top:389px;left:524px;white-space:nowrap" class="ft79151"><b>T</b></p>
<p style="position:absolute;top:394px;left:524px;white-space:nowrap" class="ft79151"><b>a</b></p>
<p style="position:absolute;top:398px;left:524px;white-space:nowrap" class="ft79151"><b>gge</b></p>
<p style="position:absolute;top:413px;left:524px;white-space:nowrap" class="ft79151"><b>r</b></p>
<p style="position:absolute;top:389px;left:503px;white-space:nowrap" class="ft79151"><b>T</b></p>
<p style="position:absolute;top:394px;left:503px;white-space:nowrap" class="ft79151"><b>a</b></p>
<p style="position:absolute;top:398px;left:503px;white-space:nowrap" class="ft79151"><b>gge</b></p>
<p style="position:absolute;top:413px;left:503px;white-space:nowrap" class="ft79151"><b>r</b></p>
<p style="position:absolute;top:311px;left:614px;white-space:nowrap" class="ft79151"><b>V</b></p>
<p style="position:absolute;top:316px;left:614px;white-space:nowrap" class="ft79151"><b>P</b></p>
<p style="position:absolute;top:322px;left:614px;white-space:nowrap" class="ft79151"><b>N</b></p>
<p style="position:absolute;top:556px;left:265px;white-space:nowrap" class="ft798">Figure&#160;7.3:&#160;Components&#160;of&#160;the&#160;Secure&#160;Virtual&#160;Networking&#160;Infrastructure.</p>
<p style="position:absolute;top:619px;left:226px;white-space:nowrap" class="ft7914">Table&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#78">7.3.2&#160;</a>provides&#160;a&#160;list&#160;of&#160;all&#160;virtual&#160;networking&#160;devices&#160;we&#160;employ&#160;in&#160;our&#160;networks<br/>alongside&#160;standard&#160;physical&#160;devices&#160;(e.g.,&#160;physical&#160;switches).&#160;In&#160;essence,&#160;a&#160;central&#160;vir-<br/>tual&#160;switch&#160;per&#160;virtual&#160;LAN&#160;(VLAN)&#160;segment&#160;uses&#160;a&#160;combination&#160;of&#160;these&#160;devices&#160;and<br/>modules&#160;to&#160;enable&#160;the&#160;virtualization&#160;of&#160;the&#160;underlying&#160;network&#160;and&#160;secure&#160;the&#160;com-<br/>munication.&#160;We&#160;provide&#160;details&#160;on&#160;each&#160;virtual&#160;networking&#160;device&#160;in&#160;the&#160;following<br/>sections.</p>
<p style="position:absolute;top:726px;left:248px;white-space:nowrap" class="ft798">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#79">7.3&#160;</a>illustrates&#160;how&#160;these&#160;components&#160;can&#160;be&#160;composed&#160;into&#160;a&#160;secure&#160;VNET</p>
<p style="position:absolute;top:744px;left:226px;white-space:nowrap" class="ft7915">infrastructure&#160;that&#160;provides&#160;isolation&#160;between&#160;different&#160;VLANs&#160;(i.e.,&#160;TVDs),&#160;where<br/>each&#160;TVD&#160;is&#160;represented&#160;by&#160;a&#160;different&#160;color&#160;(red&#160;(solid),&#160;green&#160;(dashed),&#160;or&#160;blue&#160;(dou-<br/>ble)&#160;line).&#160;Abstractly&#160;speaking,&#160;it&#160;is&#160;as&#160;if&#160;our&#160;secure&#160;VNET&#160;framework&#160;provides&#160;colored<br/>networks&#160;(in&#160;which&#160;a&#160;different&#160;color&#160;means&#160;a&#160;different&#160;TVD)&#160;with&#160;security&#160;guarantees<br/>(such&#160;as&#160;confidentiality,&#160;integrity,&#160;and&#160;isolation)&#160;to&#160;higher&#160;layers&#160;of&#160;the&#160;virtual&#160;infras-<br/>tructure.&#160;VMs&#160;connect&#160;to&#160;the&#160;network&#160;using&#160;their&#160;vNICs&#160;through&#160;the&#160;corresponding<br/>virtual&#160;switch&#160;for&#160;that&#160;VLAN;&#160;whereas&#160;a&#160;non-virtualized&#160;physical&#160;host,&#160;such&#160;as&#160;Host-3<br/>in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#79">7.3,&#160;</a>is&#160;directly&#160;connected&#160;to&#160;a&#160;VLAN-enabled&#160;physical&#160;switch&#160;without&#160;em-<br/>ploying&#160;a&#160;virtual&#160;switch.&#160;A&#160;VM&#160;can&#160;be&#160;connected&#160;to&#160;multiple&#160;VLAN&#160;segments&#160;using&#160;a<br/>different&#160;vNIC&#160;for&#160;each&#160;VLAN&#160;segment;&#160;hence,&#160;the&#160;VM&#160;can&#160;be&#160;a&#160;member&#160;of&#160;multiple<br/>TVDs&#160;simultaneously.&#160;For&#160;example,&#160;the&#160;lone&#160;VM&#160;in&#160;Host-2&#160;is&#160;part&#160;of&#160;two&#160;VLAN&#160;seg-<br/>ments,&#160;each&#160;represented&#160;by&#160;a&#160;virtual&#160;switch&#160;with&#160;a&#160;different&#160;color;&#160;hence,&#160;the&#160;VM&#160;is&#160;a<br/>member&#160;of&#160;both&#160;the&#160;blue&#160;and&#160;green&#160;TVDs.</p>
<p style="position:absolute;top:999px;left:226px;white-space:nowrap" class="ft7923"><b>Virtual&#160;Switching</b></p>
<p style="position:absolute;top:1027px;left:226px;white-space:nowrap" class="ft7915">Virtual&#160;switches&#160;enable&#160;network&#160;virtualization&#160;and&#160;co-ordinate&#160;all&#160;communication<br/>within&#160;and&#160;across&#160;VLAN&#160;segments.&#160;Each&#160;VM&#160;has&#160;a&#160;number&#160;of&#160;vNICs&#160;where&#160;each&#160;can<br/>be&#160;associated&#160;with&#160;at&#160;most&#160;one&#160;VLAN&#160;segment.&#160;Each&#160;VLAN&#160;segment&#160;is&#160;represented</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft7921">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 80 -->
<a name="80"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page80-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5080.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft808">78</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft8021">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft8014">by&#160;a&#160;virtual&#160;switch&#160;or&#160;a&#160;<i>vSwitch</i>,&#160;which&#160;behaves&#160;like&#160;a&#160;normal&#160;physical&#160;switch&#160;for&#160;that<br/>segment.&#160;A&#160;VM&#160;appears&#160;on&#160;a&#160;particular&#160;VLAN&#160;if&#160;one&#160;of&#160;its&#160;vNICs&#160;is&#160;“plugged”&#160;into<br/>one&#160;of&#160;the&#160;switch&#160;ports&#160;on&#160;the&#160;vSwitch.&#160;Ethernet&#160;broadcast&#160;traffic&#160;generated&#160;by&#160;a&#160;VM<br/>connected&#160;to&#160;the&#160;vSwitch&#160;is&#160;passed&#160;to&#160;all&#160;VMs&#160;connected&#160;to&#160;that&#160;vSwitch.&#160;Like&#160;a&#160;real<br/>switch,&#160;the&#160;vSwitch&#160;also&#160;builds&#160;up&#160;a&#160;forwarding&#160;table&#160;based&#160;on&#160;observed&#160;traffic&#160;so&#160;that<br/>non-broadcast&#160;Ethernet&#160;traffic&#160;can&#160;be&#160;delivered&#160;point-to-point&#160;to&#160;improve&#160;bandwidth<br/>efficiency.</p>
<p style="position:absolute;top:319px;left:172px;white-space:nowrap" class="ft808">To&#160;enable&#160;network&#160;virtualization,&#160;our&#160;vSwitches&#160;encapsulate&#160;or&#160;tag&#160;VM&#160;Ethernet</p>
<p style="position:absolute;top:337px;left:150px;white-space:nowrap" class="ft8015">frames&#160;with&#160;VLAN&#160;identifiers&#160;using&#160;the&#160;EtherIP&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[52]&#160;</a>and&#160;IEEE&#160;802.1Q&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[49]&#160;</a>modules,<br/>respectively.&#160;Ethernet&#160;frames&#160;originating&#160;from&#160;the&#160;source&#160;host&#160;are&#160;handled&#160;differently<br/>depending&#160;on&#160;whether&#160;the&#160;source&#160;host&#160;is&#160;virtualized&#160;and&#160;whether&#160;the&#160;destination&#160;host<br/>resides&#160;in&#160;the&#160;same&#160;LAN.&#160;For&#160;a&#160;virtualized&#160;domain&#160;(e.g.,&#160;Host-1&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#79">7.3)</a>,&#160;each<br/>frame&#160;is&#160;tagged&#160;using&#160;a&#160;VLAN&#160;tagging&#160;module.&#160;If&#160;the&#160;destination&#160;of&#160;the&#160;Ethernet<br/>frame&#160;is&#160;a&#160;VM&#160;on&#160;another&#160;host&#160;that&#160;is&#160;connected&#160;to&#160;the&#160;same&#160;VLAN-capable&#160;switch<br/>(e.g.,&#160;another&#160;physical&#160;domain&#160;in&#160;a&#160;data&#160;center),&#160;this&#160;tag&#160;indicates&#160;the&#160;VLAN&#160;segment<br/>to&#160;which&#160;the&#160;VM&#160;belongs.&#160;If&#160;the&#160;destination&#160;is&#160;a&#160;host&#160;that&#160;resides&#160;outside&#160;the&#160;LAN<br/>domain&#160;(e.g.,&#160;Host-4),&#160;the&#160;VLAN&#160;tag&#160;forces&#160;the&#160;switch&#160;to&#160;bridge&#160;the&#160;connection&#160;to&#160;an<br/>outgoing&#160;WAN&#160;line&#160;(indicated&#160;by&#160;the&#160;black&#160;(thick)&#160;line&#160;in&#160;the&#160;VLAN-enabled&#160;physical<br/>switch&#160;of&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#79">7.3)&#160;</a>that&#160;is&#160;connected&#160;to&#160;a&#160;router&#160;for&#160;further&#160;packet&#160;routing.&#160;In&#160;this<br/>case,&#160;the&#160;VM&#160;Ethernet&#160;frames&#160;are&#160;encapsulated&#160;in&#160;IP&#160;packets&#160;to&#160;indicate&#160;the&#160;VLAN<br/>segment&#160;membership.&#160;Lastly,&#160;if&#160;a&#160;non-virtualized&#160;physical&#160;host&#160;is&#160;directly&#160;connected<br/>to&#160;the&#160;VLAN&#160;switch&#160;(e.g.,&#160;Host-3),&#160;no&#160;tagging&#160;is&#160;required&#160;for&#160;the&#160;outgoing&#160;connection<br/>from&#160;the&#160;host’s&#160;domain.&#160;In&#160;the&#160;absence&#160;of&#160;a&#160;trusted&#160;physical&#160;network,&#160;each&#160;VLAN<br/>segment&#160;can&#160;employ&#160;an&#160;optional&#160;VPN&#160;layer&#160;to&#160;provide&#160;authentication,&#160;integrity,&#160;and<br/>confidentiality.</p>
<p style="position:absolute;top:664px;left:150px;white-space:nowrap" class="ft8023"><b>EtherIP&#160;Encapsulation</b></p>
<p style="position:absolute;top:692px;left:150px;white-space:nowrap" class="ft8014">EtherIP&#160;is&#160;a&#160;standard&#160;protocol&#160;for&#160;tunneling&#160;Ethernet&#160;and&#160;802.3&#160;packets&#160;via&#160;IP&#160;data-<br/>grams&#160;and&#160;can&#160;be&#160;employed&#160;to&#160;expand&#160;a&#160;LAN&#160;over&#160;a&#160;Wide&#160;or&#160;Metropolitan&#160;Area&#160;Net-<br/>work&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[52]</a>.&#160;We&#160;employ&#160;EtherIP&#160;encapsulation&#160;as&#160;the&#160;standard&#160;mechanism&#160;to&#160;insert<br/>VLAN&#160;membership&#160;information&#160;into&#160;Ethernet/802.3&#160;frames.&#160;To&#160;do&#160;so,&#160;each&#160;tunnel<br/>endpoint&#160;uses&#160;a&#160;special&#160;network&#160;device&#160;provided&#160;by&#160;the&#160;operating&#160;system&#160;that&#160;encapsu-<br/>lates&#160;outgoing&#160;Ethernet/802.3&#160;packets&#160;in&#160;new&#160;IP&#160;packets.&#160;We&#160;insert&#160;VLAN&#160;membership<br/>information&#160;(i.e.,&#160;the&#160;VLAN&#160;identifier)&#160;into&#160;the&#160;EtherIP&#160;header&#160;of&#160;each&#160;encapsulated<br/>packet.&#160;The&#160;encapsulated&#160;packets&#160;are&#160;then&#160;transmitted&#160;to&#160;the&#160;other&#160;side&#160;of&#160;the&#160;tunnel<br/>where&#160;the&#160;embedded&#160;Ethernet/802.3&#160;packets&#160;are&#160;extracted&#160;and&#160;transmitted&#160;to&#160;the&#160;desti-<br/>nation&#160;host&#160;that&#160;belongs&#160;to&#160;the&#160;same&#160;VLAN&#160;segment.</p>
<p style="position:absolute;top:893px;left:150px;white-space:nowrap" class="ft8023"><b>Address&#160;Mapping</b></p>
<p style="position:absolute;top:893px;left:281px;white-space:nowrap" class="ft808">The&#160;vSwitch&#160;component&#160;maps&#160;the&#160;Ethernet&#160;address&#160;of&#160;the&#160;en-</p>
<p style="position:absolute;top:911px;left:150px;white-space:nowrap" class="ft8015">capsulated&#160;Ethernet&#160;frame&#160;to&#160;an&#160;appropriate&#160;IP&#160;address.&#160;This&#160;way,&#160;the&#160;encapsulated<br/>Ethernet&#160;frame&#160;can&#160;be&#160;transmitted&#160;over&#160;the&#160;underlying&#160;physical&#160;network&#160;to&#160;physical<br/>machines&#160;hosting&#160;other&#160;VMs&#160;connected&#160;to&#160;the&#160;same&#160;LAN&#160;segment&#160;that&#160;would&#160;have<br/>seen&#160;that&#160;Ethernet&#160;traffic&#160;had&#160;the&#160;VMs&#160;actually&#160;been&#160;on&#160;a&#160;real&#160;LAN&#160;together.&#160;The&#160;IP<br/>address&#160;chosen&#160;to&#160;route&#160;the&#160;encapsulated&#160;Ethernet&#160;frames&#160;over&#160;the&#160;underlying&#160;physical<br/>network&#160;depends&#160;upon&#160;whether&#160;the&#160;encapsulated&#160;Ethernet&#160;frame&#160;is&#160;an&#160;Ethernet&#160;broad-<br/>cast&#160;frame&#160;and&#160;also&#160;whether&#160;the&#160;vSwitch&#160;has&#160;built&#160;up&#160;a&#160;table&#160;of&#160;the&#160;locations&#160;of&#160;the<br/>physical&#160;machines&#160;hosting&#160;other&#160;VMs&#160;on&#160;a&#160;particular&#160;LAN&#160;segment&#160;based&#160;on&#160;observ-<br/>ing&#160;traffic&#160;on&#160;that&#160;LAN.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft8021">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 81 -->
<a name="81"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page81-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5081.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft818">CHAPTER&#160;7.&#160;SECURE&#160;VIRTUALIZED&#160;NETWORKING</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft818">79</p>
<p style="position:absolute;top:194px;left:248px;white-space:nowrap" class="ft818">IP&#160;packets&#160;encapsulating&#160;broadcast&#160;Ethernet&#160;frames&#160;are&#160;given&#160;a&#160;multicast&#160;IP&#160;ad-</p>
<p style="position:absolute;top:212px;left:226px;white-space:nowrap" class="ft8115">dress&#160;and&#160;sent&#160;out&#160;over&#160;the&#160;physical&#160;network.&#160;Each&#160;VLAN&#160;segment&#160;has&#160;an&#160;IP&#160;multicast<br/>address&#160;associated&#160;with&#160;it.&#160;All&#160;physical&#160;machines&#160;hosting&#160;VMs&#160;on&#160;a&#160;particular&#160;VLAN<br/>segment&#160;are&#160;members&#160;of&#160;the&#160;multicast&#160;group&#160;for&#160;that&#160;VLAN&#160;segment.&#160;This&#160;mechanism<br/>ensures&#160;that&#160;all&#160;VMs&#160;on&#160;a&#160;particular&#160;VLAN&#160;segment&#160;receive&#160;all&#160;broadcast&#160;Ethernet<br/>frames&#160;from&#160;other&#160;VMs&#160;on&#160;that&#160;segment.&#160;Encapsulated&#160;Ethernet&#160;frames&#160;that&#160;contain<br/>a&#160;directed&#160;Ethernet&#160;address&#160;destination&#160;are&#160;either&#160;flooded&#160;to&#160;all&#160;the&#160;VMs&#160;on&#160;a&#160;partic-<br/>ular&#160;VLAN&#160;segment&#160;(using&#160;the&#160;IP&#160;multicast&#160;address&#160;as&#160;in&#160;the&#160;broadcast&#160;case)&#160;or&#160;sent<br/>to&#160;a&#160;specific&#160;physical&#160;machine&#160;IP&#160;address.&#160;This&#160;depends&#160;upon&#160;whether&#160;the&#160;vSwitch<br/>component&#160;on&#160;the&#160;encapsulating&#160;VM&#160;has&#160;learned&#160;the&#160;location&#160;of&#160;the&#160;physical&#160;machine<br/>hosting&#160;the&#160;VM&#160;with&#160;the&#160;given&#160;Ethernet&#160;destination&#160;address&#160;based&#160;on&#160;traffic&#160;observation<br/>through&#160;the&#160;vSwitch.</p>
<p style="position:absolute;top:431px;left:226px;white-space:nowrap" class="ft8123"><b>Requirements&#160;Revisited</b></p>
<p style="position:absolute;top:431px;left:393px;white-space:nowrap" class="ft818">EtherIP&#160;can&#160;be&#160;used&#160;over&#160;arbitrary&#160;Layer&#160;3&#160;networks.&#160;The</p>
<p style="position:absolute;top:449px;left:226px;white-space:nowrap" class="ft8114">decision&#160;to&#160;encapsulate&#160;Ethernet&#160;frames&#160;from&#160;VMs&#160;within&#160;IP&#160;packets&#160;allow&#160;us&#160;to&#160;con-<br/>nect&#160;different&#160;VMs&#160;to&#160;the&#160;same&#160;VLAN&#160;segment&#160;so&#160;long&#160;as&#160;the&#160;physical&#160;machines&#160;host-<br/>ing&#160;those&#160;VMs&#160;have&#160;some&#160;form&#160;of&#160;IP&#160;based&#160;connectivity&#160;between&#160;them,&#160;even&#160;a&#160;WAN<br/>link.&#160;There&#160;are&#160;no&#160;restrictions&#160;on&#160;the&#160;topology&#160;of&#160;that&#160;physical&#160;network.</p>
<p style="position:absolute;top:520px;left:248px;white-space:nowrap" class="ft818">To&#160;allow&#160;routing&#160;within&#160;virtual&#160;networks&#160;we&#160;use&#160;virtual&#160;routers&#160;that&#160;reside&#160;on</p>
<p style="position:absolute;top:538px;left:226px;white-space:nowrap" class="ft8114">VMs&#160;with&#160;multiple&#160;vNICs.&#160;The&#160;interface&#160;cards&#160;are&#160;plugged&#160;into&#160;ports&#160;on&#160;the&#160;differ-<br/>ent&#160;vSwitches&#160;that&#160;it&#160;is&#160;required&#160;to&#160;route&#160;between.&#160;Standard&#160;routing&#160;software&#160;is&#160;then<br/>configured&#160;and&#160;run&#160;on&#160;the&#160;routing&#160;VM&#160;to&#160;provide&#160;the&#160;desired&#160;routing&#160;services&#160;between<br/>the&#160;connected&#160;VLAN&#160;segments.</p>
<p style="position:absolute;top:610px;left:248px;white-space:nowrap" class="ft818">To&#160;allow&#160;for&#160;communication&#160;with&#160;non-virtualized&#160;systems&#160;we&#160;provide&#160;a&#160;virtual</p>
<p style="position:absolute;top:628px;left:226px;white-space:nowrap" class="ft8115">gateway&#160;that&#160;simply&#160;is&#160;another&#160;VM&#160;with&#160;two&#160;vNICs.&#160;One&#160;vNIC&#160;is&#160;plugged&#160;into&#160;a<br/>port&#160;on&#160;a&#160;vSwitch;&#160;the&#160;other&#160;one&#160;is&#160;bridged&#160;directly&#160;on&#160;to&#160;the&#160;physical&#160;network.&#160;The<br/>gateway&#160;has&#160;two&#160;main&#160;roles:&#160;(1)&#160;It&#160;advertises&#160;routing&#160;information&#160;about&#160;the&#160;virtual&#160;net-<br/>work&#160;behind&#160;it&#160;so&#160;that&#160;hosts&#160;in&#160;the&#160;non-virtualized&#160;world&#160;can&#160;locate&#160;the&#160;VMs&#160;that&#160;reside<br/>on&#160;a&#160;virtual&#160;network,&#160;and&#160;(2)&#160;it&#160;converts&#160;packets&#160;to&#160;and&#160;from&#160;the&#160;encapsulated&#160;format<br/>required&#160;of&#160;our&#160;virtual&#160;networks.</p>
<p style="position:absolute;top:757px;left:226px;white-space:nowrap" class="ft8123"><b>VLAN&#160;Tagging</b></p>
<p style="position:absolute;top:785px;left:226px;white-space:nowrap" class="ft8114">VLAN&#160;tagging&#160;is&#160;a&#160;well-established&#160;VNET&#160;technology&#160;that&#160;provides&#160;isolation&#160;of<br/>VLAN&#160;segments&#160;on&#160;physical&#160;network&#160;equipment&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[49]</a>.&#160;We&#160;employ&#160;VLAN&#160;tagging<br/>as&#160;an&#160;alternative&#160;to&#160;Ethernet&#160;encapsulation&#160;for&#160;efficiency&#160;purposes.&#160;For&#160;example,&#160;in&#160;a<br/>virtualized&#160;datacenter&#160;a&#160;VLAN-enabled&#160;switch&#160;may&#160;be&#160;used&#160;that&#160;yield&#160;increased&#160;per-<br/>formance&#160;over&#160;EtherIP&#160;encapsulation.</p>
<p style="position:absolute;top:875px;left:248px;white-space:nowrap" class="ft818">Each&#160;VLAN&#160;segment&#160;employs&#160;its&#160;own&#160;VLAN&#160;tagging&#160;module&#160;to&#160;tag&#160;its&#160;Ethernet</p>
<p style="position:absolute;top:893px;left:226px;white-space:nowrap" class="ft8114">frames.&#160;This&#160;module&#160;resides&#160;within&#160;the&#160;hypervisor&#160;or&#160;host&#160;OS&#160;that&#160;facilitates&#160;the&#160;net-<br/>working&#160;capabilities,&#160;captures&#160;packets&#160;originating&#160;from&#160;VMs,&#160;and&#160;tags&#160;those&#160;with&#160;the<br/>ID&#160;of&#160;the&#160;VM’s&#160;VLAN&#160;before&#160;sending&#160;them&#160;onto&#160;the&#160;physical&#160;wire.&#160;On&#160;the&#160;receiv-<br/>ing&#160;side,&#160;the&#160;module&#160;removes&#160;the&#160;VLAN&#160;tag&#160;and&#160;passes&#160;the&#160;packets&#160;untagged&#160;into&#160;the<br/>destination&#160;VM(s).&#160;Packets&#160;are&#160;only&#160;tagged&#160;when&#160;they&#160;have&#160;to&#160;be&#160;transmitted&#160;over&#160;the<br/>physical&#160;network.&#160;VMs&#160;are&#160;unaware&#160;of&#160;the&#160;VLAN&#160;tagging&#160;and&#160;send/receive&#160;packets<br/>without&#160;any&#160;VLAN&#160;information.</p>
<p style="position:absolute;top:1018px;left:248px;white-space:nowrap" class="ft818">To&#160;handle&#160;VLAN&#160;tagged&#160;packets,&#160;the&#160;physical&#160;network&#160;equipment&#160;needs&#160;to&#160;support</p>
<p style="position:absolute;top:1036px;left:226px;white-space:nowrap" class="ft8114">IEEE&#160;802.1Q&#160;and&#160;be&#160;configured&#160;accordingly.&#160;As&#160;an&#160;example,&#160;if&#160;a&#160;machine&#160;hosts&#160;a&#160;VM<br/>that&#160;is&#160;part&#160;of&#160;VLAN&#160;42,&#160;then&#160;the&#160;switch&#160;port&#160;that&#160;is&#160;used&#160;by&#160;that&#160;machine&#160;needs&#160;to<br/>be&#160;assigned&#160;to&#160;that&#160;specific&#160;VLAN&#160;42.&#160;A&#160;physical&#160;machine&#160;can&#160;host&#160;multiple&#160;VMs</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft8121">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 82 -->
<a name="82"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page82-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5082.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft828">80</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft8221">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft8214">which&#160;can&#160;be&#160;on&#160;different&#160;VLANs,&#160;therefore&#160;a&#160;switch&#160;port&#160;might&#160;be&#160;assigned&#160;to&#160;mul-<br/>tiple&#160;VLANs&#160;(which&#160;creates&#160;a</p>
<p style="position:absolute;top:212px;left:337px;white-space:nowrap" class="ft8234">VLAN&#160;trunk</p>
<p style="position:absolute;top:212px;left:432px;white-space:nowrap" class="ft828">between&#160;the&#160;host&#160;and&#160;the&#160;switch&#160;port).</p>
<p style="position:absolute;top:230px;left:150px;white-space:nowrap" class="ft8214">Whenever&#160;a&#160;host&#160;deploys&#160;a&#160;new&#160;VM&#160;or&#160;removes&#160;a&#160;VM,&#160;the&#160;switch&#160;port&#160;might&#160;need&#160;to<br/>be&#160;reconfigured.&#160;Ideally,&#160;this&#160;can&#160;be&#160;done&#160;in&#160;a&#160;dynamic&#160;and&#160;automated&#160;fashion,&#160;e.g.,<br/>through&#160;network&#160;management&#160;protocols.&#160;Physical&#160;switches&#160;only&#160;pass&#160;packets&#160;between<br/>machines&#160;within&#160;the&#160;same&#160;VLAN,&#160;which&#160;provides&#160;an&#160;additional&#160;isolation&#160;mechanism<br/>to&#160;our&#160;VLAN-capable&#160;vSwitch&#160;that&#160;is&#160;deployed&#160;on&#160;all&#160;of&#160;the&#160;hosts.</p>
<p style="position:absolute;top:341px;left:150px;white-space:nowrap" class="ft8223"><b>Address&#160;Mapping</b></p>
<p style="position:absolute;top:341px;left:278px;white-space:nowrap" class="ft828">VLAN&#160;tagging&#160;does&#160;not&#160;require&#160;any&#160;extra&#160;address&#160;mapping&#160;mech-</p>
<p style="position:absolute;top:359px;left:150px;white-space:nowrap" class="ft8215">anism.&#160;VMs&#160;discover&#160;address&#160;information&#160;of&#160;other&#160;VMs&#160;using&#160;standard&#160;discovery&#160;pro-<br/>tocols&#160;as&#160;in&#160;a&#160;non-virtualized&#160;environment.&#160;However,&#160;the&#160;vSwitch&#160;module&#160;that&#160;runs<br/>on&#160;each&#160;physical&#160;machine&#160;learns&#160;Ethernet&#160;addresses&#160;attached&#160;to&#160;the&#160;vSwitch&#160;ports&#160;by<br/>inspecting&#160;packets&#160;(in&#160;the&#160;same&#160;way&#160;as&#160;physical&#160;switches&#160;do)&#160;and&#160;builds&#160;up&#160;lookup&#160;ta-<br/>bles&#160;(one&#160;table&#160;per&#160;vSwitch&#160;/&#160;VLAN)&#160;that&#160;store&#160;information&#160;about&#160;the&#160;location&#160;of&#160;VMs<br/>based&#160;on&#160;their&#160;Ethernet&#160;addresses.&#160;The&#160;vSwitch&#160;uses&#160;this&#160;table&#160;to&#160;decide&#160;if&#160;a&#160;packet&#160;has<br/>to&#160;be&#160;passed&#160;to&#160;a&#160;local&#160;VM&#160;or&#160;onto&#160;the&#160;physical&#160;network&#160;to&#160;be&#160;delivered&#160;to&#160;a&#160;remote<br/>machine.</p>
<p style="position:absolute;top:502px;left:172px;white-space:nowrap" class="ft828">There&#160;is&#160;no&#160;explicit&#160;mapping&#160;of&#160;broadcast&#160;/&#160;multicast&#160;addresses&#160;as&#160;in&#160;the&#160;case&#160;of</p>
<p style="position:absolute;top:520px;left:150px;white-space:nowrap" class="ft8215">EtherIP&#160;encapsulation.&#160;Instead,&#160;physical&#160;switches&#160;that&#160;manage&#160;the&#160;underlying&#160;network<br/>infrastructure&#160;ensure&#160;that&#160;broadcast&#160;and&#160;multicast&#160;traffic&#160;never&#160;crosses&#160;VLAN&#160;bound-<br/>aries.&#160;Broadcast&#160;and&#160;multicast&#160;packets&#160;that&#160;are&#160;tagged&#160;with&#160;a&#160;VLAN&#160;ID&#160;are&#160;passed&#160;to<br/>all&#160;switch&#160;ports&#160;that&#160;are&#160;associated&#160;with&#160;that&#160;particular&#160;VLAN,&#160;but&#160;no&#160;other&#160;ports.&#160;When<br/>those&#160;packets&#160;enter&#160;the&#160;physical&#160;machine&#160;that&#160;runs&#160;our&#160;vSwitch&#160;module,&#160;the&#160;packets&#160;are<br/>only&#160;passed&#160;into&#160;VMs&#160;that&#160;are&#160;attached&#160;to&#160;vSwitch&#160;ports&#160;that&#160;are&#160;assigned&#160;to&#160;the&#160;VLAN<br/>matching&#160;the&#160;ID&#160;in&#160;the&#160;packets.</p>
<p style="position:absolute;top:668px;left:150px;white-space:nowrap" class="ft8223"><b>Requirements&#160;Revisited</b></p>
<p style="position:absolute;top:668px;left:319px;white-space:nowrap" class="ft828">VLAN&#160;tagging&#160;can&#160;be&#160;used&#160;over&#160;arbitrary&#160;Layer&#160;3&#160;net-</p>
<p style="position:absolute;top:686px;left:150px;white-space:nowrap" class="ft8214">works.&#160;However,&#160;unlike&#160;EtherIP&#160;a&#160;solution&#160;based&#160;on&#160;pure&#160;VLAN&#160;tagging&#160;is&#160;limited<br/>to&#160;a&#160;LAN&#160;environment&#160;and&#160;cannot&#160;be&#160;deployed&#160;over&#160;WAN&#160;links.&#160;VLAN&#160;tagging&#160;highly<br/>depends&#160;on&#160;support&#160;from&#160;the&#160;physical&#160;network&#160;equipment&#160;that&#160;is&#160;managing&#160;the&#160;underly-<br/>ing&#160;infrastructure.&#160;For&#160;example,&#160;physical&#160;switches&#160;need&#160;to&#160;support&#160;the&#160;VLAN&#160;tagging<br/>standard&#160;that&#160;we&#160;use&#160;when&#160;tagging&#160;our&#160;packets&#160;in&#160;our&#160;vSwitch&#160;module&#160;(IEEE&#160;802.1Q)<br/>and&#160;need&#160;to&#160;be&#160;configured&#160;to&#160;handle&#160;tagged&#160;packets&#160;in&#160;order&#160;to&#160;provide&#160;appropriate<br/>isolation&#160;between&#160;VLANs.</p>
<p style="position:absolute;top:811px;left:172px;white-space:nowrap" class="ft828">A&#160;VLAN&#160;is&#160;a&#160;logical&#160;network&#160;segment&#160;and&#160;by&#160;default&#160;network&#160;traffic&#160;such&#160;as&#160;broad-</p>
<p style="position:absolute;top:829px;left:150px;white-space:nowrap" class="ft8214">cast&#160;messages&#160;or&#160;ARP&#160;communication&#160;is&#160;limited&#160;to&#160;a&#160;single&#160;VLAN.&#160;However,&#160;it&#160;is<br/>also&#160;possible&#160;to&#160;allow&#160;communication&#160;between&#160;(virtual)&#160;machines&#160;of&#160;different&#160;VLANs<br/>through</p>
<p style="position:absolute;top:866px;left:201px;white-space:nowrap" class="ft8234">Inter-VLAN&#160;routing</p>
<p style="position:absolute;top:865px;left:362px;white-space:nowrap" class="ft828">.&#160;There&#160;are&#160;multiple&#160;well-known&#160;and&#160;standardized</p>
<p style="position:absolute;top:883px;left:150px;white-space:nowrap" class="ft8214">solutions&#160;to&#160;allow&#160;this.&#160;For&#160;example,&#160;most&#160;physical&#160;switches&#160;facilitate&#160;fast&#160;Layer&#160;3<br/>routing&#160;between&#160;multiple&#160;VLANs.&#160;This&#160;solution&#160;offers&#160;high&#160;performance,&#160;but&#160;requires<br/>that&#160;routing&#160;policies&#160;can&#160;be&#160;configured&#160;on&#160;the&#160;physical&#160;network&#160;devices&#160;–&#160;ideally&#160;in<br/>an&#160;automated&#160;fashion.&#160;As&#160;an&#160;alternative,&#160;we&#160;can&#160;also&#160;deploy&#160;specific&#160;VMs&#160;that&#160;have<br/>multiple&#160;network&#160;interfaces&#160;in&#160;multiple&#160;VLANs&#160;and&#160;route&#160;packets&#160;between&#160;those&#160;–&#160;as<br/>in&#160;the&#160;EtherIP&#160;encapsulation&#160;approach.</p>
<p style="position:absolute;top:990px;left:172px;white-space:nowrap" class="ft828">VLAN&#160;tagging&#160;inherently&#160;supports&#160;communciation&#160;with&#160;non-virtualized&#160;systems.</p>
<p style="position:absolute;top:1008px;left:150px;white-space:nowrap" class="ft8214">This&#160;is&#160;because&#160;VLAN&#160;tagging&#160;is&#160;a&#160;widely&#160;used&#160;standard&#160;that&#160;is&#160;deployed&#160;within&#160;in-<br/>frastructures&#160;where&#160;physical&#160;machines&#160;do&#160;not&#160;run&#160;any&#160;(network)&#160;virtualization&#160;soft-<br/>ware.&#160;There&#160;is&#160;no&#160;need&#160;for&#160;a&#160;virtual&#160;gateway&#160;as&#160;in&#160;the&#160;EtherIP&#160;case.&#160;Instead,&#160;physical<br/>switches&#160;can&#160;be&#160;configured&#160;to&#160;remove&#160;VLAN&#160;tags&#160;from&#160;packets&#160;when&#160;transmitting&#160;on</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft8221">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 83 -->
<a name="83"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page83-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5083.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft838">CHAPTER&#160;7.&#160;SECURE&#160;VIRTUALIZED&#160;NETWORKING</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft838">81</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft8314">a&#160;port&#160;where&#160;the&#160;connected&#160;endpoint&#160;is&#160;not&#160;VLAN-capable,&#160;and&#160;add&#160;tags&#160;whenever<br/>packets&#160;are&#160;received&#160;on&#160;that&#160;specific&#160;port.&#160;In&#160;that&#160;case&#160;those&#160;endpoints&#160;are&#160;completely<br/>unaware&#160;of&#160;VLANs,&#160;and&#160;receive&#160;and&#160;transmit&#160;packets&#160;without&#160;any&#160;VLAN&#160;information.</p>
<p style="position:absolute;top:268px;left:226px;white-space:nowrap" class="ft8323"><b>Secure&#160;Networking</b></p>
<p style="position:absolute;top:296px;left:226px;white-space:nowrap" class="ft8314">In&#160;addition&#160;to&#160;EtherIP&#160;and&#160;VLAN&#160;tagging&#160;modules,&#160;our&#160;vSwitches&#160;employ&#160;network<br/>access&#160;modules&#160;for&#160;admission&#160;control&#160;and&#160;optional&#160;VPN&#160;modules&#160;for&#160;packet&#160;tunneling.<br/>Network&#160;access&#160;control&#160;or&#160;NAC&#160;is&#160;an&#160;IEEE&#160;802.1X&#160;standard&#160;for&#160;port-based&#160;access&#160;con-<br/>trol&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[50]</a>.&#160;NAC&#160;can&#160;be&#160;implemented&#160;by&#160;various&#160;network&#160;devices&#160;which&#160;in&#160;turn&#160;force&#160;a<br/>host&#160;(supplicant)&#160;go&#160;through&#160;an&#160;authentication&#160;process&#160;prior&#160;to&#160;using&#160;services&#160;provided<br/>by&#160;the&#160;device&#160;(e.g.,&#160;being&#160;admitted&#160;to&#160;the&#160;network).&#160;All&#160;network&#160;traffic&#160;originating<br/>from&#160;the&#160;supplicant&#160;is&#160;blocked&#160;prior&#160;to&#160;admission&#160;except&#160;the&#160;NAC&#160;traffic&#160;itself.&#160;NAC<br/>requests&#160;are&#160;received&#160;by&#160;an&#160;access&#160;point&#160;(authenticator)&#160;and&#160;forwarded&#160;to&#160;an&#160;authenti-<br/>cation&#160;server&#160;(AS)&#160;(e.g.,&#160;a&#160;RADIUS&#160;server).&#160;The&#160;AS&#160;runs&#160;a&#160;choice&#160;of&#160;authentication<br/>protocol&#160;specified&#160;by&#160;the&#160;extensible&#160;authentication&#160;protocol&#160;(EAP).&#160;It&#160;returns&#160;the&#160;verdict<br/>to&#160;the&#160;authenticator&#160;as&#160;a&#160;result&#160;of&#160;which&#160;access&#160;is&#160;granted&#160;to&#160;the&#160;supplicant&#160;or&#160;denied.<br/>The&#160;NAC&#160;module&#160;is&#160;incorporated&#160;into&#160;the&#160;vSwitch&#160;admission&#160;process&#160;during&#160;which&#160;the<br/>requesting&#160;VM&#160;is&#160;authenticated&#160;prior&#160;to&#160;TVD&#160;admission.&#160;The&#160;choice&#160;of&#160;which&#160;authen-<br/>tication&#160;method&#160;is&#160;dictated&#160;by&#160;the&#160;high-level&#160;TVD&#160;policies.</p>
<p style="position:absolute;top:547px;left:248px;white-space:nowrap" class="ft838">Encapsulation&#160;and&#160;tagging&#160;alone&#160;do&#160;not&#160;provide&#160;any&#160;guarantees&#160;on&#160;the&#160;confiden-</p>
<p style="position:absolute;top:565px;left:226px;white-space:nowrap" class="ft8314">tiality&#160;and&#160;integrity&#160;of&#160;the&#160;packets&#160;/&#160;frames&#160;that&#160;are&#160;transmitted&#160;on&#160;the&#160;wire.&#160;Without&#160;a<br/>proper&#160;VPN&#160;layer,&#160;these&#160;schemes&#160;are&#160;only&#160;suitable&#160;for&#160;routed&#160;and&#160;controlled&#160;networks<br/>in&#160;which&#160;the&#160;underlying&#160;physical&#160;infrastructure&#160;is&#160;trusted,&#160;e.g.,&#160;a&#160;virtualized&#160;data&#160;cen-<br/>ter.&#160;In&#160;cases&#160;no&#160;such&#160;guarantees&#160;can&#160;be&#160;given&#160;(e.g.,&#160;over&#160;a&#160;WAN&#160;link),&#160;we&#160;employ&#160;an<br/>implementation&#160;of&#160;IPSec&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">[63]&#160;</a>to&#160;tunnel&#160;VLAN&#160;communication&#160;in&#160;a&#160;confidential&#160;and&#160;an<br/>integrity-preserving&#160;way.&#160;To&#160;do&#160;so,&#160;the&#160;VPN&#160;module&#160;employs&#160;the&#160;Encapsulating&#160;Secu-<br/>rity&#160;Payload&#160;(ESP)&#160;of&#160;IPSec&#160;that&#160;encapsulates&#160;IP&#160;packets&#160;and&#160;applies&#160;block&#160;encryption<br/>to&#160;provide&#160;confidentiality&#160;and&#160;integrity.&#160;This&#160;adds&#160;an&#160;additional&#160;layer&#160;of&#160;packet&#160;encap-<br/>sulation&#160;on&#160;top&#160;of&#160;EtherIP.&#160;The&#160;optional&#160;VPN&#160;module&#160;is&#160;incorporated&#160;into&#160;the&#160;vSwitch.</p>
<p style="position:absolute;top:754px;left:226px;white-space:nowrap" class="ft8326"><b>7.4</b></p>
<p style="position:absolute;top:754px;left:275px;white-space:nowrap" class="ft8326"><b>TVD&#160;Infrastructure</b></p>
<p style="position:absolute;top:792px;left:226px;white-space:nowrap" class="ft8315">In&#160;this&#160;section,&#160;we&#160;present&#160;the&#160;trusted&#160;virtual&#160;domain&#160;(TVD)&#160;infrastructure,&#160;the&#160;com-<br/>position&#160;of&#160;its&#160;components&#160;to&#160;form&#160;TVDs&#160;and&#160;to&#160;enforce&#160;TVD&#160;policies,&#160;and&#160;describe<br/>the&#160;management&#160;of&#160;this&#160;infrastructure.&#160;We&#160;first&#160;focus&#160;on&#160;the&#160;static&#160;behavior&#160;of&#160;a&#160;secure<br/>network&#160;virtualization&#160;framework&#160;that&#160;is&#160;already&#160;up&#160;and&#160;running.&#160;Later,&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#89">7.5,<br/></a>we&#160;focus&#160;on&#160;the&#160;more&#160;dynamic&#160;aspects&#160;of&#160;the&#160;framework,&#160;including&#160;establishment&#160;and<br/>deployment&#160;of&#160;the&#160;secure&#160;virtual&#160;infrastructure.</p>
<p style="position:absolute;top:921px;left:226px;white-space:nowrap" class="ft8324"><b>7.4.1</b></p>
<p style="position:absolute;top:921px;left:280px;white-space:nowrap" class="ft8324"><b>Security&#160;Objectives&#160;and&#160;Policies</b></p>
<p style="position:absolute;top:952px;left:226px;white-space:nowrap" class="ft8315">Security&#160;policies&#160;for&#160;a&#160;TVD&#160;can&#160;be&#160;grouped&#160;into&#160;two&#160;categories:&#160;intra-TVD&#160;policies<br/>that&#160;enforce&#160;security&#160;within&#160;a&#160;TVD&#160;and&#160;inter-TVD&#160;policies&#160;that&#160;enforce&#160;security&#160;across<br/>TVDs.</p>
<p style="position:absolute;top:1026px;left:226px;white-space:nowrap" class="ft8323"><b>Security&#160;within&#160;a&#160;TVD</b></p>
<p style="position:absolute;top:1054px;left:226px;white-space:nowrap" class="ft8314">Within&#160;a&#160;TVD,&#160;all&#160;VPEs&#160;can&#160;freely&#160;communicate&#160;with&#160;each&#160;other&#160;while&#160;observing<br/>TVD-specific&#160;integrity&#160;and&#160;confidentiality&#160;requirements.&#160;Inside&#160;a&#160;data&#160;center,&#160;this</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft8321">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 84 -->
<a name="84"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft84155{font-size:10px;font-family:BLCKOE+CMSY7;color:#231f20;}
-->
</style>
<div id="page84-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5084.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft848">82</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft8421">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft8414">trusted&#160;network&#160;may&#160;be&#160;achieved&#160;without&#160;additional&#160;protection&#160;mechanisms.&#160;On&#160;poten-<br/>tially&#160;insecure&#160;networks,&#160;secure&#160;intra-TVD&#160;communication&#160;requires&#160;an&#160;authenticated<br/>and&#160;encrypted&#160;channel&#160;(e.g.,&#160;using&#160;IPsec<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#84">)</a></p>
<p style="position:absolute;top:227px;left:396px;white-space:nowrap" class="ft8427"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#84">2</a></p>
<p style="position:absolute;top:230px;left:402px;white-space:nowrap" class="ft848"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#84">.</a></p>
<p style="position:absolute;top:247px;left:172px;white-space:nowrap" class="ft848">Given&#160;a&#160;set</p>
<p style="position:absolute;top:246px;left:243px;white-space:nowrap" class="ft8446">T</p>
<p style="position:absolute;top:247px;left:257px;white-space:nowrap" class="ft848">of&#160;trusted&#160;virtual&#160;domains,&#160;one&#160;way&#160;of&#160;formalizing&#160;secure&#160;communi-</p>
<p style="position:absolute;top:265px;left:150px;white-space:nowrap" class="ft848">cation&#160;requirements&#160;as&#160;a&#160;domain-protection&#160;function</p>
<p style="position:absolute;top:264px;left:462px;white-space:nowrap" class="ft8446">P</p>
<p style="position:absolute;top:264px;left:478px;white-space:nowrap" class="ft8448">:</p>
<p style="position:absolute;top:264px;left:486px;white-space:nowrap" class="ft8446">T</p>
<p style="position:absolute;top:264px;left:501px;white-space:nowrap" class="ft8450">→</p>
<p style="position:absolute;top:264px;left:520px;white-space:nowrap" class="ft8448">2</p>
<p style="position:absolute;top:262px;left:528px;white-space:nowrap" class="ft84155">{</p>
<p style="position:absolute;top:263px;left:534px;white-space:nowrap" class="ft8447">c,i,s</p>
<p style="position:absolute;top:262px;left:556px;white-space:nowrap" class="ft84155">}</p>
<p style="position:absolute;top:265px;left:563px;white-space:nowrap" class="ft848">,&#160;which&#160;describes</p>
<p style="position:absolute;top:283px;left:150px;white-space:nowrap" class="ft8414">the&#160;subset&#160;of&#160;security&#160;objectives&#160;(confidentiality,&#160;integrity&#160;protection,&#160;and&#160;isolation)&#160;as-<br/>signed&#160;to&#160;a&#160;particular&#160;TVD.&#160;In&#160;TVD&#160;context,&#160;integrity&#160;means&#160;that&#160;a&#160;VPE&#160;cannot&#160;inject<br/>“bad”&#160;messages&#160;and&#160;pretend&#160;they&#160;are&#160;from&#160;another&#160;VPE.&#160;Confidentiality&#160;refers&#160;to&#160;the<br/>requirement&#160;that&#160;two&#160;honest&#160;VPEs&#160;(in&#160;the&#160;same&#160;TVD&#160;or&#160;different&#160;TVDs)&#160;can&#160;commu-<br/>nicate&#160;with&#160;each&#160;other&#160;without&#160;an&#160;eavesdropper&#160;learning&#160;the&#160;content&#160;of&#160;the&#160;communi-<br/>catio<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#84">n</a></p>
<p style="position:absolute;top:370px;left:186px;white-space:nowrap" class="ft8427"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#84">3</a></p>
<p style="position:absolute;top:373px;left:192px;white-space:nowrap" class="ft848">.&#160;Isolation&#160;means&#160;that&#160;each&#160;TVD&#160;can&#160;enforce&#160;its&#160;security&#160;policy&#160;independently</p>
<p style="position:absolute;top:391px;left:150px;white-space:nowrap" class="ft8414">of&#160;other&#160;TVDs&#160;that&#160;share&#160;the&#160;same&#160;infrastructure&#160;in&#160;a&#160;data&#160;center.&#160;In&#160;that&#160;respect&#160;a&#160;TVD<br/>must&#160;be&#160;shielded&#160;from&#160;policy&#160;violations&#160;in&#160;other&#160;TVDs.</p>
<p style="position:absolute;top:427px;left:172px;white-space:nowrap" class="ft848">Admission&#160;control&#160;and&#160;membership&#160;management&#160;are&#160;crucial&#160;aspects&#160;of&#160;TVDs&#160;that</p>
<p style="position:absolute;top:445px;left:150px;white-space:nowrap" class="ft8414">help&#160;meet&#160;these&#160;security&#160;objectives.&#160;VPEs&#160;that&#160;seek&#160;TVD&#160;membership&#160;may&#160;be&#160;required<br/>to&#160;prove&#160;their&#160;eligibility&#160;either&#160;periodically&#160;or&#160;on&#160;request.&#160;For&#160;example,&#160;prospective<br/>members&#160;may&#160;be&#160;required&#160;to&#160;possess&#160;certain&#160;credentials&#160;such&#160;as&#160;certificates&#160;or&#160;to&#160;prove<br/>that&#160;they&#160;satisfy&#160;certain&#160;properties&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[96]&#160;</a>prior&#160;to&#160;admission&#160;to&#160;the&#160;TVD&#160;in&#160;a&#160;certain&#160;role.<br/>The&#160;conditions&#160;may&#160;vary&#160;for&#160;different&#160;roles&#160;of&#160;VPEs.&#160;For&#160;example,&#160;servers&#160;and&#160;work-<br/>stations&#160;may&#160;have&#160;different&#160;TVD&#160;membership&#160;requirements.&#160;Similarly,&#160;the&#160;security<br/>requirements&#160;on&#160;internal&#160;machines&#160;are&#160;usually&#160;weaker&#160;than&#160;for&#160;machine&#160;acting&#160;in&#160;a<br/>gateway&#160;role.&#160;Overall,&#160;a&#160;TVD&#160;should&#160;be&#160;able&#160;to&#160;restrict&#160;its&#160;membership&#160;to&#160;machines<br/>that&#160;satisfy&#160;a&#160;given&#160;set&#160;of&#160;conditions&#160;for&#160;each&#160;given&#160;role.&#160;Some&#160;VPEs&#160;may&#160;be&#160;part&#160;of<br/>more&#160;than&#160;one&#160;TVDs,&#160;in&#160;which&#160;case&#160;they&#160;would&#160;have&#160;to&#160;satisfy&#160;the&#160;membership&#160;require-<br/>ments&#160;of&#160;all&#160;the&#160;TVDs&#160;they&#160;are&#160;part&#160;of.&#160;Note&#160;that&#160;to&#160;enable&#160;multiple&#160;TVD&#160;membership,<br/>the&#160;individual&#160;TVD&#160;membership&#160;requirements&#160;must&#160;be&#160;conflict-free.</p>
<p style="position:absolute;top:660px;left:172px;white-space:nowrap" class="ft848">One&#160;way&#160;of&#160;formalizing&#160;the&#160;membership&#160;requirements&#160;for&#160;a&#160;set</p>
<p style="position:absolute;top:659px;left:552px;white-space:nowrap" class="ft8446">T</p>
<p style="position:absolute;top:660px;left:566px;white-space:nowrap" class="ft848">of&#160;trusted&#160;virtual</p>
<p style="position:absolute;top:678px;left:150px;white-space:nowrap" class="ft848">domains&#160;is&#160;to&#160;define&#160;a&#160;function</p>
<p style="position:absolute;top:677px;left:344px;white-space:nowrap" class="ft8446">R</p>
<p style="position:absolute;top:677px;left:361px;white-space:nowrap" class="ft8448">:</p>
<p style="position:absolute;top:677px;left:372px;white-space:nowrap" class="ft8446">T</p>
<p style="position:absolute;top:677px;left:389px;white-space:nowrap" class="ft8450">→</p>
<p style="position:absolute;top:677px;left:410px;white-space:nowrap" class="ft8446">R</p>
<p style="position:absolute;top:678px;left:426px;white-space:nowrap" class="ft848">that&#160;identifies&#160;the&#160;set&#160;of&#160;unique&#160;roles</p>
<p style="position:absolute;top:677px;left:654px;white-space:nowrap" class="ft8446">R</p>
<p style="position:absolute;top:696px;left:150px;white-space:nowrap" class="ft848">for&#160;a&#160;given&#160;TVD.&#160;We&#160;then&#160;use&#160;a&#160;function</p>
<p style="position:absolute;top:695px;left:404px;white-space:nowrap" class="ft8446">M</p>
<p style="position:absolute;top:695px;left:426px;white-space:nowrap" class="ft8448">:</p>
<p style="position:absolute;top:695px;left:436px;white-space:nowrap" class="ft8446">R</p>
<p style="position:absolute;top:695px;left:453px;white-space:nowrap" class="ft8450">→</p>
<p style="position:absolute;top:695px;left:474px;white-space:nowrap" class="ft8448">2</p>
<p style="position:absolute;top:693px;left:482px;white-space:nowrap" class="ft8447">P</p>
<p style="position:absolute;top:696px;left:492px;white-space:nowrap" class="ft848">,&#160;where</p>
<p style="position:absolute;top:695px;left:541px;white-space:nowrap" class="ft8448">(</p>
<p style="position:absolute;top:695px;left:547px;white-space:nowrap" class="ft8446">P,</p>
<p style="position:absolute;top:695px;left:564px;white-space:nowrap" class="ft8450">≤</p>
<p style="position:absolute;top:695px;left:575px;white-space:nowrap" class="ft8448">)</p>
<p style="position:absolute;top:696px;left:586px;white-space:nowrap" class="ft848">is&#160;a&#160;lattice&#160;of</p>
<p style="position:absolute;top:714px;left:150px;white-space:nowrap" class="ft8415">security&#160;properties&#160;to&#160;identify&#160;the&#160;required&#160;security&#160;properties&#160;for&#160;each&#160;given&#160;role&#160;for<br/>that&#160;TVD.&#160;A&#160;machine</p>
<p style="position:absolute;top:731px;left:284px;white-space:nowrap" class="ft8446">m</p>
<p style="position:absolute;top:732px;left:301px;white-space:nowrap" class="ft848">with&#160;a&#160;set</p>
<p style="position:absolute;top:731px;left:363px;white-space:nowrap" class="ft8446">p</p>
<p style="position:absolute;top:736px;left:371px;white-space:nowrap" class="ft8447">m</p>
<p style="position:absolute;top:732px;left:386px;white-space:nowrap" class="ft848">of&#160;security&#160;properties&#160;may&#160;be&#160;permitted&#160;to&#160;join</p>
<p style="position:absolute;top:750px;left:150px;white-space:nowrap" class="ft848">the&#160;TVD</p>
<p style="position:absolute;top:749px;left:206px;white-space:nowrap" class="ft8446">t</p>
<p style="position:absolute;top:750px;left:216px;white-space:nowrap" class="ft848">in&#160;role</p>
<p style="position:absolute;top:749px;left:258px;white-space:nowrap" class="ft8446">r</p>
<p style="position:absolute;top:750px;left:269px;white-space:nowrap" class="ft848">iff</p>
<p style="position:absolute;top:749px;left:287px;white-space:nowrap" class="ft8446">r</p>
<p style="position:absolute;top:749px;left:298px;white-space:nowrap" class="ft8450">∈</p>
<p style="position:absolute;top:749px;left:312px;white-space:nowrap" class="ft8446">R</p>
<p style="position:absolute;top:749px;left:324px;white-space:nowrap" class="ft8448">(</p>
<p style="position:absolute;top:749px;left:330px;white-space:nowrap" class="ft8446">t</p>
<p style="position:absolute;top:749px;left:335px;white-space:nowrap" class="ft8448">)</p>
<p style="position:absolute;top:750px;left:345px;white-space:nowrap" class="ft848">and</p>
<p style="position:absolute;top:749px;left:370px;white-space:nowrap" class="ft8450">∀</p>
<p style="position:absolute;top:749px;left:378px;white-space:nowrap" class="ft8446">p</p>
<p style="position:absolute;top:749px;left:390px;white-space:nowrap" class="ft8450">∈</p>
<p style="position:absolute;top:749px;left:404px;white-space:nowrap" class="ft8446">M</p>
<p style="position:absolute;top:749px;left:420px;white-space:nowrap" class="ft8448">(</p>
<p style="position:absolute;top:749px;left:426px;white-space:nowrap" class="ft8446">r</p>
<p style="position:absolute;top:749px;left:433px;white-space:nowrap" class="ft8448">)&#160;:</p>
<p style="position:absolute;top:749px;left:452px;white-space:nowrap" class="ft8450">∃</p>
<p style="position:absolute;top:749px;left:460px;white-space:nowrap" class="ft8446">p</p>
<p style="position:absolute;top:747px;left:468px;white-space:nowrap" class="ft84155">′</p>
<p style="position:absolute;top:749px;left:476px;white-space:nowrap" class="ft8450">∈</p>
<p style="position:absolute;top:749px;left:490px;white-space:nowrap" class="ft8446">p</p>
<p style="position:absolute;top:754px;left:498px;white-space:nowrap" class="ft8447">m</p>
<p style="position:absolute;top:750px;left:513px;white-space:nowrap" class="ft848">such&#160;that</p>
<p style="position:absolute;top:749px;left:570px;white-space:nowrap" class="ft8446">p</p>
<p style="position:absolute;top:747px;left:578px;white-space:nowrap" class="ft84155">′</p>
<p style="position:absolute;top:749px;left:586px;white-space:nowrap" class="ft8450">≥</p>
<p style="position:absolute;top:749px;left:602px;white-space:nowrap" class="ft8446">p</p>
<p style="position:absolute;top:750px;left:610px;white-space:nowrap" class="ft848">.&#160;In&#160;other</p>
<p style="position:absolute;top:767px;left:150px;white-space:nowrap" class="ft848">words,</p>
<p style="position:absolute;top:766px;left:194px;white-space:nowrap" class="ft8446">m</p>
<p style="position:absolute;top:767px;left:211px;white-space:nowrap" class="ft848">is&#160;permitted&#160;to&#160;join</p>
<p style="position:absolute;top:766px;left:328px;white-space:nowrap" class="ft8446">t</p>
<p style="position:absolute;top:767px;left:337px;white-space:nowrap" class="ft848">iff&#160;there&#160;is&#160;at&#160;least&#160;one&#160;property&#160;of</p>
<p style="position:absolute;top:766px;left:544px;white-space:nowrap" class="ft8446">m</p>
<p style="position:absolute;top:767px;left:561px;white-space:nowrap" class="ft848">that&#160;satisfies&#160;each</p>
<p style="position:absolute;top:785px;left:150px;white-space:nowrap" class="ft848">security&#160;requirement&#160;of</p>
<p style="position:absolute;top:784px;left:293px;white-space:nowrap" class="ft8446">r</p>
<p style="position:absolute;top:785px;left:300px;white-space:nowrap" class="ft848">.</p>
<p style="position:absolute;top:825px;left:150px;white-space:nowrap" class="ft8423"><b>Security&#160;across&#160;TVDs</b></p>
<p style="position:absolute;top:853px;left:150px;white-space:nowrap" class="ft8415">Inter-TVD&#160;security&#160;objectives&#160;are&#160;independently&#160;enforced&#160;by&#160;each&#160;of&#160;the&#160;individual<br/>TVDs&#160;involved.&#160;To&#160;facilitate&#160;such&#160;multilateral&#160;enforcement,&#160;global&#160;security&#160;objectives<br/>are&#160;decomposed&#160;into&#160;per-TVD&#160;security&#160;policies.&#160;The&#160;advantage&#160;of&#160;such&#160;a&#160;decentral-<br/>ized&#160;enforcement&#160;approach&#160;is&#160;that&#160;each&#160;TVD&#160;is&#160;shielded&#160;from&#160;security&#160;failures&#160;in&#160;other<br/>TVDs,&#160;hence&#160;enforce&#160;domain&#160;isolation.&#160;Security&#160;objectives&#160;may&#160;take&#160;different&#160;forms;<br/>here,&#160;we&#160;focus&#160;on&#160;information&#160;flow&#160;control&#160;among&#160;the&#160;TVDs&#160;and&#160;multi-TVD&#160;member-<br/>ships.</p>
<p style="position:absolute;top:979px;left:172px;white-space:nowrap" class="ft848">An&#160;information&#160;flow&#160;control&#160;matrix&#160;is&#160;a&#160;simple&#160;way&#160;of&#160;formalizing&#160;the&#160;system-wide</p>
<p style="position:absolute;top:997px;left:150px;white-space:nowrap" class="ft848">flow&#160;control&#160;objectives.&#160;Table&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#85">7.2&#160;</a>shows&#160;a&#160;sample&#160;matrix&#160;for&#160;three&#160;TVDs:</p>
<p style="position:absolute;top:996px;left:618px;white-space:nowrap" class="ft8446">T&#160;V&#160;D</p>
<p style="position:absolute;top:1002px;left:653px;white-space:nowrap" class="ft8447">α</p>
<p style="position:absolute;top:997px;left:662px;white-space:nowrap" class="ft848">,</p>
<p style="position:absolute;top:1023px;left:166px;white-space:nowrap" class="ft8428">2</p>
<p style="position:absolute;top:1026px;left:171px;white-space:nowrap" class="ft8419">A&#160;network&#160;is&#160;<i>trusted&#160;</i>with&#160;respect&#160;to&#160;a&#160;TVD&#160;security&#160;objective&#160;if&#160;it&#160;is&#160;trusted&#160;to&#160;enforce&#160;the&#160;given&#160;objective</p>
<p style="position:absolute;top:1040px;left:150px;white-space:nowrap" class="ft8455">transparently.&#160;For&#160;example,&#160;a&#160;server-internal&#160;Ethernet&#160;can&#160;often&#160;provide&#160;confidentiality&#160;without&#160;any&#160;need&#160;for<br/>encryption.</p>
<p style="position:absolute;top:1066px;left:166px;white-space:nowrap" class="ft8428">3</p>
<p style="position:absolute;top:1069px;left:171px;white-space:nowrap" class="ft8419">Covert&#160;communication&#160;channels&#160;are&#160;outside&#160;the&#160;scope&#160;of&#160;this&#160;paper.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft8421">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 85 -->
<a name="85"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page85-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5085.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft858">CHAPTER&#160;7.&#160;SECURE&#160;VIRTUALIZED&#160;NETWORKING</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft858">83</p>
<p style="position:absolute;top:204px;left:296px;white-space:nowrap" class="ft858">Table&#160;7.2:&#160;Example&#160;TVD&#160;Policy&#160;Specification&#160;for&#160;Three&#160;TVDs</p>
<p style="position:absolute;top:222px;left:379px;white-space:nowrap" class="ft858">from:</p>
<p style="position:absolute;top:222px;left:535px;white-space:nowrap" class="ft858">to:</p>
<p style="position:absolute;top:240px;left:344px;white-space:nowrap" class="ft858">TVD</p>
<p style="position:absolute;top:240px;left:420px;white-space:nowrap" class="ft858">Role</p>
<p style="position:absolute;top:239px;left:463px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:245px;left:498px;white-space:nowrap" class="ft8547">α</p>
<p style="position:absolute;top:239px;left:522px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:245px;left:557px;white-space:nowrap" class="ft8547">β</p>
<p style="position:absolute;top:239px;left:580px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:245px;left:615px;white-space:nowrap" class="ft8547">γ</p>
<p style="position:absolute;top:257px;left:344px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:263px;left:379px;white-space:nowrap" class="ft8547">α</p>
<p style="position:absolute;top:258px;left:423px;white-space:nowrap" class="ft858">gate</p>
<p style="position:absolute;top:258px;left:477px;white-space:nowrap" class="ft8552">1</p>
<p style="position:absolute;top:255px;left:486px;white-space:nowrap" class="ft85155">∗</p>
<p style="position:absolute;top:258px;left:536px;white-space:nowrap" class="ft8552">0</p>
<p style="position:absolute;top:255px;left:545px;white-space:nowrap" class="ft85155">∗</p>
<p style="position:absolute;top:257px;left:589px;white-space:nowrap" class="ft8546">P</p>
<p style="position:absolute;top:263px;left:599px;white-space:nowrap" class="ft8547">αγ</p>
<p style="position:absolute;top:275px;left:344px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:281px;left:379px;white-space:nowrap" class="ft8547">α</p>
<p style="position:absolute;top:276px;left:403px;white-space:nowrap" class="ft858">internal</p>
<p style="position:absolute;top:276px;left:477px;white-space:nowrap" class="ft8552">1</p>
<p style="position:absolute;top:273px;left:486px;white-space:nowrap" class="ft85155">∗</p>
<p style="position:absolute;top:293px;left:344px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:299px;left:379px;white-space:nowrap" class="ft8547">β</p>
<p style="position:absolute;top:294px;left:423px;white-space:nowrap" class="ft858">gate</p>
<p style="position:absolute;top:294px;left:477px;white-space:nowrap" class="ft8552">0</p>
<p style="position:absolute;top:291px;left:486px;white-space:nowrap" class="ft85155">∗</p>
<p style="position:absolute;top:294px;left:536px;white-space:nowrap" class="ft8552">1</p>
<p style="position:absolute;top:291px;left:545px;white-space:nowrap" class="ft85155">∗</p>
<p style="position:absolute;top:294px;left:597px;white-space:nowrap" class="ft8552">0</p>
<p style="position:absolute;top:311px;left:344px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:317px;left:379px;white-space:nowrap" class="ft8547">β</p>
<p style="position:absolute;top:312px;left:403px;white-space:nowrap" class="ft858">internal</p>
<p style="position:absolute;top:312px;left:536px;white-space:nowrap" class="ft8552">1</p>
<p style="position:absolute;top:309px;left:545px;white-space:nowrap" class="ft85155">∗</p>
<p style="position:absolute;top:329px;left:344px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:335px;left:379px;white-space:nowrap" class="ft8547">γ</p>
<p style="position:absolute;top:330px;left:423px;white-space:nowrap" class="ft858">gate</p>
<p style="position:absolute;top:329px;left:473px;white-space:nowrap" class="ft8546">P</p>
<p style="position:absolute;top:335px;left:482px;white-space:nowrap" class="ft8547">γα</p>
<p style="position:absolute;top:329px;left:531px;white-space:nowrap" class="ft8546">P</p>
<p style="position:absolute;top:335px;left:541px;white-space:nowrap" class="ft8547">γβ</p>
<p style="position:absolute;top:330px;left:597px;white-space:nowrap" class="ft8552">1</p>
<p style="position:absolute;top:347px;left:344px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:353px;left:379px;white-space:nowrap" class="ft8547">γ</p>
<p style="position:absolute;top:348px;left:403px;white-space:nowrap" class="ft858">internal</p>
<p style="position:absolute;top:348px;left:594px;white-space:nowrap" class="ft8552">1</p>
<p style="position:absolute;top:345px;left:602px;white-space:nowrap" class="ft85155">∗</p>
<p style="position:absolute;top:397px;left:334px;white-space:nowrap" class="ft858">Table&#160;7.3:&#160;Components&#160;of&#160;the&#160;TVD&#160;infrastructure.</p>
<p style="position:absolute;top:429px;left:235px;white-space:nowrap" class="ft858">TVD</p>
<p style="position:absolute;top:429px;left:286px;white-space:nowrap" class="ft858">C</p>
<p style="position:absolute;top:431px;left:297px;white-space:nowrap" class="ft8519">OMPO</p>
<p style="position:absolute;top:429px;left:334px;white-space:nowrap" class="ft858">-</p>
<p style="position:absolute;top:449px;left:235px;white-space:nowrap" class="ft8519">NENT</p>
<p style="position:absolute;top:429px;left:358px;white-space:nowrap" class="ft858">F</p>
<p style="position:absolute;top:431px;left:367px;white-space:nowrap" class="ft8519">UNCTIONALITY</p>
<p style="position:absolute;top:469px;left:235px;white-space:nowrap" class="ft858">TVD&#160;Master</p>
<p style="position:absolute;top:469px;left:357px;white-space:nowrap" class="ft8514">A&#160;global&#160;policy&#160;and&#160;credential&#160;repository&#160;per&#160;TVD&#160;that&#160;provisions<br/>TVD&#160;proxies&#160;onto&#160;each&#160;physical&#160;host.</p>
<p style="position:absolute;top:505px;left:235px;white-space:nowrap" class="ft858">TVD&#160;Proxy</p>
<p style="position:absolute;top:505px;left:357px;white-space:nowrap" class="ft8515">A&#160;local&#160;TVD&#160;master&#160;delegate,&#160;policy&#160;enforcer,&#160;and&#160;credential<br/>repository&#160;per&#160;physical&#160;host&#160;per&#160;TVD.</p>
<p style="position:absolute;top:541px;left:235px;white-space:nowrap" class="ft858">TVD</p>
<p style="position:absolute;top:541px;left:317px;white-space:nowrap" class="ft858">Co-</p>
<p style="position:absolute;top:559px;left:235px;white-space:nowrap" class="ft858">ordinator</p>
<p style="position:absolute;top:541px;left:357px;white-space:nowrap" class="ft8514">A&#160;local&#160;TVD&#160;factory&#160;per&#160;physical&#160;host&#160;that&#160;spawns&#160;TVD&#160;proxies<br/>on&#160;request&#160;by&#160;TVD&#160;masters.</p>
<p style="position:absolute;top:624px;left:226px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:630px;left:261px;white-space:nowrap" class="ft8547">β</p>
<p style="position:absolute;top:625px;left:269px;white-space:nowrap" class="ft858">,&#160;and</p>
<p style="position:absolute;top:624px;left:303px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:630px;left:338px;white-space:nowrap" class="ft8547">γ</p>
<p style="position:absolute;top:625px;left:346px;white-space:nowrap" class="ft858">.&#160;Each&#160;matrix&#160;line&#160;represents&#160;a&#160;policy&#160;elements&#160;that&#160;specifies&#160;for&#160;a</p>
<p style="position:absolute;top:643px;left:226px;white-space:nowrap" class="ft858">given&#160;role&#160;of&#160;a&#160;given&#160;domain,&#160;what&#160;other&#160;domains&#160;it&#160;may&#160;connect&#160;to.&#160;The</p>
<p style="position:absolute;top:643px;left:676px;white-space:nowrap" class="ft8552">1</p>
<p style="position:absolute;top:643px;left:688px;white-space:nowrap" class="ft858">elements</p>
<p style="position:absolute;top:661px;left:226px;white-space:nowrap" class="ft858">along&#160;the&#160;matrix&#160;diagonal&#160;convey&#160;the&#160;fact&#160;that&#160;any&#160;connection&#160;is&#160;allowed&#160;while&#160;a</p>
<p style="position:absolute;top:661px;left:733px;white-space:nowrap" class="ft8552">0</p>
<p style="position:absolute;top:679px;left:226px;white-space:nowrap" class="ft858">disallows&#160;information&#160;flow.</p>
<p style="position:absolute;top:697px;left:248px;white-space:nowrap" class="ft858">While&#160;these&#160;two&#160;policies&#160;will&#160;later&#160;be&#160;enforced&#160;by&#160;allowing&#160;or&#160;disallowing&#160;logi-</p>
<p style="position:absolute;top:715px;left:226px;white-space:nowrap" class="ft8514">cal&#160;connections,&#160;gateway&#160;machines&#160;can&#160;also&#160;enforce&#160;further&#160;application-level&#160;policies.<br/>These&#160;policies</p>
<p style="position:absolute;top:732px;left:315px;white-space:nowrap" class="ft8546">P</p>
<p style="position:absolute;top:733px;left:330px;white-space:nowrap" class="ft858">refine&#160;the&#160;all-flow&#160;policy</p>
<p style="position:absolute;top:732px;left:480px;white-space:nowrap" class="ft8552">1</p>
<p style="position:absolute;top:733px;left:491px;white-space:nowrap" class="ft858">by&#160;allowing&#160;some&#160;flows&#160;while&#160;disallowing</p>
<p style="position:absolute;top:750px;left:226px;white-space:nowrap" class="ft858">others.&#160;In&#160;order&#160;to&#160;allow&#160;flow&#160;from&#160;a&#160;machine</p>
<p style="position:absolute;top:749px;left:508px;white-space:nowrap" class="ft8546">A</p>
<p style="position:absolute;top:750px;left:524px;white-space:nowrap" class="ft858">playing&#160;Role</p>
<p style="position:absolute;top:749px;left:606px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:755px;left:641px;white-space:nowrap" class="ft8547">A</p>
<p style="position:absolute;top:749px;left:651px;white-space:nowrap" class="ft8546">/Role</p>
<p style="position:absolute;top:755px;left:689px;white-space:nowrap" class="ft8547">A</p>
<p style="position:absolute;top:750px;left:702px;white-space:nowrap" class="ft858">to&#160;ma-</p>
<p style="position:absolute;top:768px;left:226px;white-space:nowrap" class="ft858">chine</p>
<p style="position:absolute;top:767px;left:262px;white-space:nowrap" class="ft8546">B</p>
<p style="position:absolute;top:768px;left:278px;white-space:nowrap" class="ft858">playing</p>
<p style="position:absolute;top:767px;left:327px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:773px;left:363px;white-space:nowrap" class="ft8547">B</p>
<p style="position:absolute;top:767px;left:373px;white-space:nowrap" class="ft8546">/Role</p>
<p style="position:absolute;top:773px;left:411px;white-space:nowrap" class="ft8547">B</p>
<p style="position:absolute;top:768px;left:421px;white-space:nowrap" class="ft858">,&#160;both&#160;corresponding&#160;policies&#160;need&#160;to&#160;permit&#160;the&#160;flow.</p>
<p style="position:absolute;top:786px;left:226px;white-space:nowrap" class="ft858">E.g.,&#160;if</p>
<p style="position:absolute;top:785px;left:271px;white-space:nowrap" class="ft8546">P</p>
<p style="position:absolute;top:791px;left:281px;white-space:nowrap" class="ft8547">αβ</p>
<p style="position:absolute;top:785px;left:301px;white-space:nowrap" class="ft8548">=</p>
<p style="position:absolute;top:786px;left:317px;white-space:nowrap" class="ft8552">0</p>
<p style="position:absolute;top:786px;left:330px;white-space:nowrap" class="ft858">in&#160;Table&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#85">7.2,&#160;</a>then</p>
<p style="position:absolute;top:785px;left:438px;white-space:nowrap" class="ft8546">P</p>
<p style="position:absolute;top:791px;left:448px;white-space:nowrap" class="ft8547">αγ</p>
<p style="position:absolute;top:786px;left:468px;white-space:nowrap" class="ft858">and</p>
<p style="position:absolute;top:785px;left:493px;white-space:nowrap" class="ft8546">P</p>
<p style="position:absolute;top:791px;left:503px;white-space:nowrap" class="ft8547">γβ</p>
<p style="position:absolute;top:786px;left:522px;white-space:nowrap" class="ft858">should&#160;not&#160;be&#160;inadvertedly</p>
<p style="position:absolute;top:786px;left:685px;white-space:nowrap" class="ft8552">1</p>
<p style="position:absolute;top:786px;left:694px;white-space:nowrap" class="ft858">.&#160;Other-</p>
<p style="position:absolute;top:804px;left:226px;white-space:nowrap" class="ft858">wise,&#160;indirect&#160;information&#160;flow&#160;from</p>
<p style="position:absolute;top:803px;left:446px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:809px;left:482px;white-space:nowrap" class="ft8547">α</p>
<p style="position:absolute;top:804px;left:494px;white-space:nowrap" class="ft858">to</p>
<p style="position:absolute;top:803px;left:509px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:809px;left:544px;white-space:nowrap" class="ft8547">β</p>
<p style="position:absolute;top:804px;left:556px;white-space:nowrap" class="ft858">would&#160;be&#160;unconstrained,&#160;which</p>
<p style="position:absolute;top:822px;left:226px;white-space:nowrap" class="ft858">would&#160;contradict&#160;with</p>
<p style="position:absolute;top:821px;left:361px;white-space:nowrap" class="ft8546">P</p>
<p style="position:absolute;top:827px;left:370px;white-space:nowrap" class="ft8547">αβ</p>
<p style="position:absolute;top:822px;left:390px;white-space:nowrap" class="ft858">and&#160;result&#160;in&#160;a&#160;policy&#160;conflict.</p>
<p style="position:absolute;top:840px;left:248px;white-space:nowrap" class="ft858">The&#160;TVD&#160;policy&#160;also&#160;includes&#160;<i>multi-TVD&#160;membership&#160;policy</i>,&#160;where&#160;a&#160;TVD&#160;spec-</p>
<p style="position:absolute;top:858px;left:226px;white-space:nowrap" class="ft8514">ifies&#160;whether&#160;a&#160;VPE&#160;in&#160;a&#160;certain&#160;role&#160;can&#160;hold&#160;another&#160;role&#160;in&#160;the&#160;same&#160;TVD&#160;or&#160;other<br/>roles&#160;of&#160;other&#160;TVDs.&#160;This&#160;is&#160;formalized&#160;by&#160;multi-membership&#160;function</p>
<p style="position:absolute;top:875px;left:656px;white-space:nowrap" class="ft8546">M</p>
<p style="position:absolute;top:873px;left:672px;white-space:nowrap" class="ft85155">′</p>
<p style="position:absolute;top:875px;left:680px;white-space:nowrap" class="ft8548">:</p>
<p style="position:absolute;top:875px;left:689px;white-space:nowrap" class="ft8546">R</p>
<p style="position:absolute;top:875px;left:705px;white-space:nowrap" class="ft8550">→</p>
<p style="position:absolute;top:875px;left:724px;white-space:nowrap" class="ft8548">2</p>
<p style="position:absolute;top:873px;left:732px;white-space:nowrap" class="ft8547">R</p>
<p style="position:absolute;top:894px;left:226px;white-space:nowrap" class="ft8515">that&#160;assigns&#160;the&#160;subset&#160;of&#160;roles&#160;of&#160;other&#160;domains&#160;that&#160;can&#160;be&#160;assumed&#160;by&#160;a&#160;given&#160;VPE.<br/>At&#160;the&#160;time&#160;of&#160;TVD&#160;policy&#160;specification,&#160;it&#160;is&#160;important&#160;to&#160;ensure&#160;that&#160;there&#160;is&#160;no&#160;conflict<br/>between&#160;the&#160;various&#160;policy&#160;forms,&#160;e.g.,&#160;if&#160;the&#160;information&#160;flow&#160;control&#160;policy&#160;specifies<br/>that&#160;there&#160;should&#160;be&#160;no&#160;information&#160;flow&#160;between</p>
<p style="position:absolute;top:947px;left:528px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:953px;left:563px;white-space:nowrap" class="ft8547">α</p>
<p style="position:absolute;top:948px;left:575px;white-space:nowrap" class="ft858">and</p>
<p style="position:absolute;top:947px;left:601px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:953px;left:636px;white-space:nowrap" class="ft8547">β</p>
<p style="position:absolute;top:948px;left:645px;white-space:nowrap" class="ft858">,&#160;then&#160;the&#160;multi-</p>
<p style="position:absolute;top:966px;left:226px;white-space:nowrap" class="ft858">TVD&#160;membership&#160;restrictions&#160;cannot&#160;allow&#160;any&#160;VM&#160;to&#160;simultaneously&#160;be&#160;a&#160;member&#160;of</p>
<p style="position:absolute;top:983px;left:226px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:988px;left:261px;white-space:nowrap" class="ft8547">α</p>
<p style="position:absolute;top:984px;left:274px;white-space:nowrap" class="ft858">and</p>
<p style="position:absolute;top:983px;left:299px;white-space:nowrap" class="ft8546">T&#160;V&#160;D</p>
<p style="position:absolute;top:988px;left:334px;white-space:nowrap" class="ft8547">β</p>
<p style="position:absolute;top:984px;left:342px;white-space:nowrap" class="ft858">.</p>
<p style="position:absolute;top:1024px;left:226px;white-space:nowrap" class="ft8524"><b>7.4.2</b></p>
<p style="position:absolute;top:1024px;left:280px;white-space:nowrap" class="ft8524"><b>TVD&#160;Components</b></p>
<p style="position:absolute;top:1054px;left:226px;white-space:nowrap" class="ft8514">A&#160;TVD&#160;infrastructure&#160;consists&#160;of&#160;a&#160;single&#160;TVD&#160;master&#160;and&#160;multiple&#160;TVD&#160;proxies&#160;that<br/>act&#160;as&#160;a&#160;delegate&#160;for&#160;that&#160;TVD&#160;on&#160;each&#160;physical&#160;host.&#160;We&#160;also&#160;use&#160;a&#160;local&#160;TVD&#160;co-</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft8521">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 86 -->
<a name="86"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page86-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5086.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft868">84</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft8621">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft8614">ordinator&#160;per&#160;physical&#160;platform&#160;to&#160;spawn&#160;all&#160;TVDs&#160;for&#160;that&#160;platform&#160;during&#160;TVD&#160;pro-<br/>visioning.&#160;Table&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#85">7.4.1&#160;</a>lists&#160;each&#160;component&#160;and&#160;its&#160;role&#160;in&#160;the&#160;TVD&#160;infrastructure.</p>
<p style="position:absolute;top:251px;left:150px;white-space:nowrap" class="ft8623"><b>TVD&#160;master</b></p>
<p style="position:absolute;top:279px;left:150px;white-space:nowrap" class="ft8615">The&#160;<i>TVD&#160;master&#160;</i>plays&#160;a&#160;central&#160;role&#160;in&#160;the&#160;management&#160;and&#160;auto-deployment&#160;of&#160;each<br/>TVD.&#160;We&#160;refer&#160;to&#160;the&#160;TVD&#160;master&#160;as&#160;a&#160;single&#160;logical&#160;entity&#160;for&#160;each&#160;TVD,&#160;although&#160;its<br/>implementation&#160;may&#160;be&#160;distributed.&#160;The&#160;TVD&#160;master&#160;is&#160;trusted&#160;by&#160;the&#160;TVD&#160;infrastruc-<br/>ture&#160;and&#160;the&#160;VPEs&#160;that&#160;are&#160;members&#160;of&#160;the&#160;TVD.&#160;Known&#160;techniques&#160;based&#160;on&#160;Trusted<br/>Computing&#160;can&#160;be&#160;used&#160;to&#160;validate&#160;the&#160;integrity&#160;of&#160;the&#160;TVD&#160;master&#160;by&#160;verifying&#160;its<br/>software&#160;configuration.&#160;The&#160;TVD&#160;master&#160;can&#160;be&#160;hosted&#160;on&#160;a&#160;physical&#160;machine&#160;or&#160;a<br/>virtual&#160;machine.&#160;In&#160;the&#160;case&#160;of&#160;a&#160;VM&#160;implementation,&#160;the&#160;PEV&#160;architecture&#160;proposed<br/>by&#160;Jansen&#160;et&#160;al.&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">[55]&#160;</a>can&#160;be&#160;used&#160;to&#160;obtain&#160;policy&#160;enforcement&#160;and&#160;compliance&#160;proofs<br/>for&#160;the&#160;purpose&#160;of&#160;assessing&#160;the&#160;TVD&#160;master’s&#160;trustworthiness.</p>
<p style="position:absolute;top:440px;left:172px;white-space:nowrap" class="ft868">The&#160;TVD&#160;policy&#160;is&#160;defined&#160;at&#160;the&#160;TVD&#160;master&#160;by&#160;the&#160;domain&#160;administrator&#160;(e.g.,</p>
<p style="position:absolute;top:458px;left:150px;white-space:nowrap" class="ft8615">the&#160;administrator&#160;of&#160;a&#160;data&#160;center&#160;hosting&#160;multiple&#160;TVDs&#160;agrees&#160;on&#160;a&#160;policy&#160;with&#160;each<br/>customer).&#160;The&#160;TVD&#160;master&#160;has&#160;the&#160;following&#160;responsibilities:</p>
<p style="position:absolute;top:507px;left:168px;white-space:nowrap" class="ft868">1.&#160;distributing&#160;the&#160;TVD&#160;policy&#160;and&#160;other&#160;TVD&#160;credentials&#160;(such&#160;as&#160;VPN&#160;key)&#160;to&#160;the</p>
<p style="position:absolute;top:525px;left:187px;white-space:nowrap" class="ft868">TVD&#160;proxies&#160;and&#160;informing&#160;them&#160;of&#160;any&#160;updates,</p>
<p style="position:absolute;top:554px;left:168px;white-space:nowrap" class="ft868">2.&#160;determining&#160;the&#160;suitability&#160;of&#160;a&#160;platform&#160;to&#160;host&#160;a&#160;TVD&#160;proxy&#160;(described&#160;be-</p>
<p style="position:absolute;top:571px;left:187px;white-space:nowrap" class="ft8614">low)&#160;and&#160;periodically&#160;assessing&#160;the&#160;platform’s&#160;continued&#160;suitability&#160;to&#160;host&#160;VPEs<br/>belonging&#160;to&#160;the&#160;TVD.</p>
<p style="position:absolute;top:618px;left:168px;white-space:nowrap" class="ft868">3.&#160;maintaining&#160;an&#160;up-to-date&#160;view&#160;of&#160;the&#160;TVD&#160;membership&#160;which&#160;includes&#160;a&#160;list&#160;of</p>
<p style="position:absolute;top:636px;left:187px;white-space:nowrap" class="ft868">TVD&#160;proxies&#160;and&#160;the&#160;VPEs&#160;hosted&#160;on&#160;their&#160;respective&#160;platforms.</p>
<p style="position:absolute;top:676px;left:150px;white-space:nowrap" class="ft8623"><b>TVD&#160;proxy</b></p>
<p style="position:absolute;top:704px;left:150px;white-space:nowrap" class="ft8614">On&#160;every&#160;host&#160;that&#160;may&#160;potentially&#160;host&#160;a&#160;VM&#160;belonging&#160;to&#160;the&#160;TVD,&#160;there&#160;is&#160;a&#160;local<br/>delegate&#160;of&#160;the&#160;TVD&#160;master,&#160;called&#160;the&#160;<i>TVD&#160;proxy</i>.&#160;The&#160;TVD&#160;proxy&#160;is&#160;the&#160;local&#160;enforcer<br/>of&#160;the&#160;TVD&#160;policies&#160;on&#160;a&#160;given&#160;physical&#160;platform.&#160;At&#160;the&#160;time&#160;of&#160;its&#160;creation,&#160;the&#160;TVD<br/>proxy&#160;receives&#160;the&#160;TVD&#160;policy&#160;from&#160;the&#160;TVD&#160;master.&#160;Upon&#160;an&#160;update&#160;to&#160;the&#160;TVD<br/>policy&#160;(by&#160;a&#160;domain&#160;administrator),&#160;renewal&#160;of&#160;TVD&#160;credentials,&#160;or&#160;refresh&#160;of&#160;TVD<br/>VPN&#160;keys&#160;at&#160;the&#160;TVD&#160;master,&#160;the&#160;master&#160;conveys&#160;the&#160;update&#160;to&#160;the&#160;TVD&#160;proxies.</p>
<p style="position:absolute;top:811px;left:172px;white-space:nowrap" class="ft868">The&#160;TVD&#160;proxies&#160;on&#160;a&#160;given&#160;platform&#160;are&#160;independent.&#160;Although&#160;TVD&#160;proxies</p>
<p style="position:absolute;top:829px;left:150px;white-space:nowrap" class="ft8615">are&#160;trusted,&#160;TVD&#160;proxies&#160;on&#160;the&#160;same&#160;platform&#160;should&#160;be&#160;sufficiently&#160;isolated&#160;from<br/>each&#160;other.&#160;For&#160;example,&#160;a&#160;TVD&#160;proxy&#160;should&#160;not&#160;be&#160;able&#160;to&#160;access&#160;private&#160;TVD<br/>information&#160;(such&#160;as&#160;policies,&#160;certificates,&#160;and&#160;VPN&#160;keys)&#160;belonging&#160;to&#160;another&#160;TVD<br/>proxy.&#160;For&#160;improved&#160;isolation,&#160;each&#160;TVD&#160;proxy&#160;on&#160;the&#160;platform&#160;may&#160;be&#160;hosted&#160;in<br/>a&#160;separate&#160;<i>infrastructure&#160;</i>VM,&#160;which&#160;is&#160;different&#160;from&#160;a&#160;VM&#160;hosting&#160;regular&#160;services,<br/>called&#160;<i>production&#160;</i>VM.&#160;On&#160;a&#160;platform&#160;with&#160;the&#160;Trusted&#160;Platform&#160;Module&#160;or&#160;TPM&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[115]</a>,<br/>isolation&#160;can&#160;further&#160;be&#160;improved&#160;by&#160;TPM&#160;virtualization&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[13]</a>,&#160;assigning&#160;a&#160;separate<br/>virtual&#160;TPM&#160;to&#160;each&#160;infrastructure&#160;VM,&#160;and&#160;using&#160;the&#160;virtual&#160;TPM&#160;as&#160;the&#160;basis&#160;for<br/>storing&#160;private&#160;TVD&#160;information.</p>
<p style="position:absolute;top:991px;left:172px;white-space:nowrap" class="ft868">A&#160;TVD&#160;proxy&#160;must&#160;only&#160;be&#160;able&#160;to&#160;interact&#160;with&#160;VMs&#160;hosted&#160;on&#160;the&#160;platform&#160;be-</p>
<p style="position:absolute;top:1008px;left:150px;white-space:nowrap" class="ft8614">longing&#160;to&#160;the&#160;same&#160;TVD.&#160;As&#160;we&#160;describe&#160;below,&#160;that&#160;requirement&#160;is&#160;enforced&#160;by&#160;a<br/>local&#160;TVD&#160;co-ordinator.&#160;The&#160;responsibilities&#160;of&#160;the&#160;TVD&#160;proxy&#160;are:</p>
<p style="position:absolute;top:1054px;left:150px;white-space:nowrap" class="ft8623"><b>Configuration&#160;of&#160;the&#160;Local&#160;TVD&#160;vSwitch&#160;</b>The&#160;TVD&#160;proxy&#160;configures&#160;the&#160;local&#160;TVD</p>
<p style="position:absolute;top:1072px;left:187px;white-space:nowrap" class="ft868">vSwitch&#160;on&#160;a&#160;given&#160;host&#160;based&#160;on&#160;TVD&#160;policy.&#160;For&#160;example,&#160;if&#160;the&#160;TVD&#160;policy</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft8621">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 87 -->
<a name="87"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page87-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5087.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft878">CHAPTER&#160;7.&#160;SECURE&#160;VIRTUALIZED&#160;NETWORKING</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft878">85</p>
<p style="position:absolute;top:194px;left:263px;white-space:nowrap" class="ft8714">specifies&#160;that&#160;information&#160;confidentiality&#160;is&#160;an&#160;objective,&#160;then&#160;the&#160;TVD&#160;proxy<br/>enables&#160;all&#160;traffic&#160;through&#160;the&#160;vSwitch&#160;to&#160;pass&#160;through&#160;the&#160;VPN&#160;module&#160;and<br/>provides&#160;the&#160;VPN&#160;key&#160;to&#160;the&#160;module.</p>
<p style="position:absolute;top:259px;left:226px;white-space:nowrap" class="ft8723"><b>Caching&#160;of&#160;the&#160;TVD&#160;Information&#160;</b>The&#160;TVD&#160;proxy&#160;maintains&#160;private&#160;TVD&#160;informa-</p>
<p style="position:absolute;top:277px;left:263px;white-space:nowrap" class="ft878">tion&#160;such&#160;as&#160;policies,&#160;certificates,&#160;and&#160;VPN&#160;keys.</p>
<p style="position:absolute;top:306px;left:226px;white-space:nowrap" class="ft8723"><b>Status&#160;Reports&#160;to&#160;the&#160;TVD&#160;Master&#160;</b>Upon&#160;request&#160;or&#160;periodically,&#160;the&#160;TVD&#160;proxy</p>
<p style="position:absolute;top:323px;left:263px;white-space:nowrap" class="ft8714">provides&#160;a&#160;platform&#160;status&#160;report&#160;to&#160;the&#160;TVD&#160;master.&#160;The&#160;report&#160;includes&#160;in-<br/>formation&#160;such&#160;as&#160;the&#160;number&#160;of&#160;VMs&#160;belonging&#160;to&#160;the&#160;TVD&#160;and&#160;their&#160;unique<br/>addressable&#160;identifiers&#160;and&#160;the&#160;current&#160;vSwitch&#160;configuration.&#160;The&#160;status&#160;report<br/>also&#160;serves&#160;as&#160;an&#160;<i>“I&#160;am&#160;alive”&#160;</i>message&#160;to&#160;the&#160;TVD&#160;master,&#160;and&#160;helps&#160;the&#160;TVD<br/>master&#160;to&#160;keep&#160;an&#160;updated&#160;list&#160;of&#160;TVD&#160;proxies&#160;that&#160;are&#160;connected&#160;to&#160;it.</p>
<p style="position:absolute;top:424px;left:226px;white-space:nowrap" class="ft8723"><b>Enforcement&#160;of&#160;Admission&#160;Requirements&#160;for&#160;VMs&#160;into&#160;the&#160;TVD&#160;</b>A&#160;VM’s&#160;virtual</p>
<p style="position:absolute;top:442px;left:263px;white-space:nowrap" class="ft8714">NIC&#160;is&#160;attached&#160;to&#160;a&#160;vSwitch&#160;only&#160;after&#160;the&#160;TVD&#160;proxies&#160;of&#160;the&#160;switch’s&#160;and<br/>the&#160;machine’s&#160;domain&#160;approve&#160;this&#160;attachment.&#160;Note&#160;that&#160;while&#160;the&#160;TVD&#160;proxy<br/>of&#160;the&#160;switch&#160;prevents&#160;admission&#160;of&#160;non-compliant&#160;machines,&#160;the&#160;TVD&#160;proxy&#160;of<br/>the&#160;machine&#160;prevents&#160;outflow&#160;into&#160;untrusted&#160;peer&#160;domains.</p>
<p style="position:absolute;top:525px;left:226px;white-space:nowrap" class="ft8723"><b>Continuous&#160;Enforcement&#160;of&#160;TVD&#160;Policy&#160;</b>The&#160;TVD&#160;proxy&#160;is&#160;responsible&#160;for&#160;contin-</p>
<p style="position:absolute;top:543px;left:263px;white-space:nowrap" class="ft8714">uous&#160;enforcement&#160;of&#160;TVD&#160;policy&#160;despite&#160;updates&#160;to&#160;the&#160;policy&#160;and&#160;changing<br/>configuration&#160;of&#160;the&#160;platform&#160;and&#160;member&#160;VMs.&#160;Upon&#160;receiving&#160;an&#160;update&#160;to<br/>the&#160;TVD&#160;policy&#160;from&#160;the&#160;TVD&#160;master,&#160;the&#160;TVD&#160;proxy&#160;may&#160;re-configure&#160;the<br/>vSwitch,&#160;and&#160;re-assess&#160;member&#160;VMs’&#160;membership&#160;to&#160;reflect&#160;the&#160;updated&#160;policy.<br/>Even&#160;without&#160;any&#160;policy&#160;update,&#160;the&#160;TVD&#160;proxy&#160;may&#160;be&#160;required&#160;by&#160;TVD&#160;policy<br/>to&#160;periodically&#160;do&#160;such&#160;re-configuration&#160;and&#160;re-assessment.</p>
<p style="position:absolute;top:672px;left:226px;white-space:nowrap" class="ft8723"><b>Local&#160;Common&#160;TVD&#160;Coordinator&#160;(LCTC)</b></p>
<p style="position:absolute;top:700px;left:226px;white-space:nowrap" class="ft8715">The&#160;Local&#160;Common&#160;TVD&#160;Coordinator&#160;or&#160;LCTC&#160;is&#160;present&#160;on&#160;every&#160;platform&#160;(hence,<br/>the&#160;word&#160;<i>local&#160;</i>in&#160;the&#160;name)&#160;on&#160;which&#160;a&#160;TVD&#160;element&#160;has&#160;to&#160;be&#160;hosted.&#160;The&#160;LCTC<br/>itself&#160;does&#160;not&#160;belong&#160;to&#160;any&#160;single&#160;TVD&#160;(hence,&#160;the&#160;word&#160;<i>common&#160;</i>in&#160;the&#160;name).&#160;The<br/>LCTC&#160;is&#160;part&#160;of&#160;the&#160;minimal&#160;TC<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#87">B</a></p>
<p style="position:absolute;top:752px;left:429px;white-space:nowrap" class="ft8727"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#87">4</a></p>
<p style="position:absolute;top:754px;left:439px;white-space:nowrap" class="ft878">on&#160;every&#160;TVD-enabled&#160;platform.</p>
<p style="position:absolute;top:772px;left:248px;white-space:nowrap" class="ft878">The&#160;LCTC&#160;is&#160;the&#160;entity&#160;that&#160;a&#160;TVD&#160;master&#160;or&#160;a&#160;system&#160;administrator&#160;contacts&#160;to</p>
<p style="position:absolute;top:790px;left:226px;white-space:nowrap" class="ft8714">create&#160;a&#160;new&#160;TVD&#160;proxy&#160;on&#160;the&#160;platform.&#160;For&#160;this&#160;purpose,&#160;the&#160;LCTC&#160;must&#160;be&#160;made<br/>publicly&#160;addressable&#160;and&#160;knowledgeable&#160;about&#160;the&#160;identities&#160;of&#160;the&#160;entities&#160;that&#160;may<br/>potentially&#160;request&#160;the&#160;creation.</p>
<p style="position:absolute;top:844px;left:248px;white-space:nowrap" class="ft878">The&#160;LCTC&#160;has&#160;two&#160;main&#160;responsibilities,&#160;namely&#160;(1)&#160;creation&#160;of&#160;new&#160;TVD&#160;proxies</p>
<p style="position:absolute;top:862px;left:226px;white-space:nowrap" class="ft8715">on&#160;the&#160;local&#160;platform,&#160;(2)&#160;restricting&#160;access&#160;of&#160;TVD&#160;proxies&#160;only&#160;to&#160;VMs&#160;belonging<br/>to&#160;their&#160;respective&#160;TVDs.&#160;The&#160;LCTC&#160;maintains&#160;a&#160;list&#160;of&#160;VMs&#160;currently&#160;hosted&#160;on<br/>the&#160;platform,&#160;a&#160;list&#160;of&#160;TVD&#160;proxies&#160;currently&#160;hosted&#160;on&#160;the&#160;platform,&#160;and&#160;a&#160;mapping<br/>between&#160;the&#160;VMs&#160;and&#160;the&#160;TVDs&#160;they&#160;belong&#160;to.</p>
<p style="position:absolute;top:956px;left:226px;white-space:nowrap" class="ft8724"><b>7.4.3</b></p>
<p style="position:absolute;top:956px;left:280px;white-space:nowrap" class="ft8724"><b>Establishment&#160;of&#160;the&#160;TVD&#160;Infrastructure</b></p>
<p style="position:absolute;top:986px;left:226px;white-space:nowrap" class="ft8723"><b>Preparing&#160;a&#160;Platform&#160;to&#160;Host&#160;a&#160;given&#160;TVD</b></p>
<p style="position:absolute;top:1014px;left:226px;white-space:nowrap" class="ft8714">The&#160;initial&#160;step&#160;for&#160;establishing&#160;a&#160;TVD&#160;is&#160;to&#160;create&#160;the&#160;TVD&#160;master&#160;(step&#160;0&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#92">7.5)<br/></a>and&#160;initialize&#160;the&#160;master&#160;with&#160;the&#160;TVD&#160;requirements&#160;(as&#160;formalized&#160;above)&#160;and&#160;the</p>
<p style="position:absolute;top:1058px;left:242px;white-space:nowrap" class="ft8728">4</p>
<p style="position:absolute;top:1060px;left:248px;white-space:nowrap" class="ft8719">On&#160;a&#160;Xen-based&#160;platform,&#160;the&#160;minimal&#160;TCB&#160;consists&#160;of&#160;the&#160;LCTC,&#160;Xen&#160;Dom0,&#160;the&#160;Xen&#160;hypervisor,&#160;and</p>
<p style="position:absolute;top:1074px;left:226px;white-space:nowrap" class="ft8719">the&#160;underlying&#160;hardware.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft8721">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 88 -->
<a name="88"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page88-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5088.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft888">86</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft8821">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft8814">policy.&#160;The&#160;output&#160;of&#160;the&#160;step&#160;is&#160;a&#160;TVD&#160;object&#160;that&#160;contains&#160;the&#160;TVD’s&#160;unique&#160;identifier,<br/>i.e.,&#160;the&#160;TVD&#160;master’s&#160;URL&#160;and&#160;public&#160;key.</p>
<p style="position:absolute;top:230px;left:172px;white-space:nowrap" class="ft888">Once&#160;the&#160;TVD&#160;master&#160;has&#160;been&#160;initialized,&#160;the&#160;TVD&#160;is&#160;ready&#160;for&#160;being&#160;populated</p>
<p style="position:absolute;top:247px;left:150px;white-space:nowrap" class="ft8814">with&#160;member&#160;entities,&#160;such&#160;as&#160;platforms&#160;and&#160;VPEs.&#160;A&#160;VPE&#160;becomes&#160;admitted&#160;to&#160;a&#160;TVD<br/>after&#160;the&#160;successful&#160;completion&#160;of&#160;a&#160;multi-step&#160;protocol&#160;(steps&#160;1&#160;and&#160;2&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#92">7.5)</a>:</p>
<p style="position:absolute;top:298px;left:168px;white-space:nowrap" class="ft888">1.&#160;The&#160;LCTC&#160;on&#160;a&#160;physical&#160;platform&#160;creates&#160;a&#160;<i>TVD&#160;proxy&#160;</i>for&#160;the&#160;given&#160;domain&#160;and</p>
<p style="position:absolute;top:316px;left:187px;white-space:nowrap" class="ft888">initializes&#160;it&#160;with&#160;the&#160;URL&#160;and&#160;public&#160;key&#160;of&#160;the&#160;TVD&#160;master.</p>
<p style="position:absolute;top:346px;left:168px;white-space:nowrap" class="ft888">2.&#160;The&#160;TVD&#160;proxy&#160;sets&#160;up&#160;a&#160;secure,&#160;authenticated&#160;channel&#160;with&#160;the&#160;TVD&#160;master</p>
<p style="position:absolute;top:364px;left:187px;white-space:nowrap" class="ft8815">using&#160;standard&#160;techniques.&#160;This&#160;includes&#160;a&#160;validation&#160;whether&#160;the&#160;physical&#160;plat-<br/>form&#160;satisfies&#160;the&#160;admission&#160;requirements&#160;of&#160;this&#160;specific&#160;TVD.</p>
<p style="position:absolute;top:412px;left:168px;white-space:nowrap" class="ft888">3.&#160;The&#160;TVD&#160;proxy&#160;indicates&#160;the&#160;security&#160;and&#160;functional&#160;capabilities&#160;of&#160;the&#160;physical</p>
<p style="position:absolute;top:430px;left:187px;white-space:nowrap" class="ft8815">machine.&#160;Using&#160;the&#160;capability&#160;model,&#160;the&#160;TVD&#160;master&#160;determines&#160;which&#160;addi-<br/>tional&#160;mechanisms&#160;must&#160;be&#160;provided&#160;at&#160;the&#160;level&#160;of&#160;the&#160;virtual&#160;infrastructure.&#160;For<br/>example,&#160;if&#160;a&#160;TVD&#160;requirements&#160;specification&#160;includes&#160;isolation&#160;and&#160;the&#160;physi-<br/>cal&#160;infrastructure&#160;does&#160;not&#160;have&#160;that&#160;capability,&#160;then&#160;special&#160;(VLAN&#160;tagging&#160;or<br/>VPN)&#160;modules&#160;must&#160;be&#160;instantiated&#160;within&#160;the&#160;Dom0&#160;of&#160;physical&#160;machines&#160;host-<br/>ing&#160;VMs&#160;that&#160;are&#160;part&#160;of&#160;the&#160;TVD.</p>
<p style="position:absolute;top:549px;left:168px;white-space:nowrap" class="ft888">4.&#160;The&#160;TVD&#160;master&#160;then&#160;replies&#160;to&#160;the&#160;TVD&#160;proxy&#160;with&#160;the&#160;TVD&#160;security&#160;policy</p>
<p style="position:absolute;top:567px;left:187px;white-space:nowrap" class="ft8814">(such&#160;as&#160;flow&#160;control&#160;policies&#160;between&#160;VMs&#160;belonging&#160;to&#160;different&#160;TVDs&#160;hosted<br/>on&#160;the&#160;same&#160;physical&#160;machine)&#160;and&#160;additional&#160;mechanisms&#160;that&#160;must&#160;be&#160;provided<br/>at&#160;the&#160;virtualization&#160;level.&#160;The&#160;TVD&#160;proxy&#160;also&#160;obtains&#160;the&#160;TVD&#160;credentials<br/>needed&#160;for&#160;network&#160;security.</p>
<p style="position:absolute;top:651px;left:168px;white-space:nowrap" class="ft888">5.&#160;The&#160;TVD&#160;proxy&#160;then&#160;instantiates&#160;and&#160;configures&#160;the&#160;required&#160;TVD-specific&#160;mod-</p>
<p style="position:absolute;top:669px;left:187px;white-space:nowrap" class="ft8814">ules&#160;(e.g.,&#160;vSwitch,&#160;VLAN&#160;tagging&#160;module,&#160;encapsulation&#160;module,&#160;VPN&#160;module,<br/>policy&#160;engine,&#160;etc.)&#160;according&#160;to&#160;the&#160;TVD&#160;policy.&#160;After&#160;this&#160;step,&#160;the&#160;physical<br/>machine&#160;is&#160;ready&#160;to&#160;host&#160;a&#160;VM&#160;belonging&#160;to&#160;the&#160;TVD.</p>
<p style="position:absolute;top:745px;left:150px;white-space:nowrap" class="ft8823"><b>Adding&#160;a&#160;VPE&#160;to&#160;a&#160;Requested&#160;Domain</b></p>
<p style="position:absolute;top:772px;left:150px;white-space:nowrap" class="ft8814">Once&#160;the&#160;platform&#160;is&#160;ready&#160;to&#160;host&#160;VPEs&#160;that&#160;are&#160;members&#160;of&#160;a&#160;given&#160;TVD,&#160;a&#160;VPE&#160;can<br/>join&#160;the&#160;TVD&#160;by&#160;being&#160;connected&#160;to&#160;the&#160;corresponding&#160;vSwitch&#160;as&#160;follows:</p>
<p style="position:absolute;top:820px;left:168px;white-space:nowrap" class="ft888">1.&#160;A&#160;VPE&#160;requests&#160;to&#160;join&#160;a&#160;given&#160;domain&#160;(identified&#160;by&#160;master&#160;URL&#160;and&#160;public</p>
<p style="position:absolute;top:838px;left:187px;white-space:nowrap" class="ft888">key)&#160;playing&#160;a&#160;given&#160;role.</p>
<p style="position:absolute;top:868px;left:168px;white-space:nowrap" class="ft888">2.&#160;The&#160;VPE&#160;runs&#160;a&#160;credential&#160;validation&#160;protocol&#160;with&#160;the&#160;TVD&#160;proxy&#160;of&#160;the&#160;domain</p>
<p style="position:absolute;top:886px;left:187px;white-space:nowrap" class="ft888">that&#160;it&#160;intends&#160;to&#160;join.&#160;The&#160;required&#160;credentials&#160;usually&#160;depend&#160;on&#160;the&#160;role&#160;to&#160;play.</p>
<p style="position:absolute;top:916px;left:168px;white-space:nowrap" class="ft888">3.&#160;The&#160;TVD&#160;proxy&#160;admits&#160;the&#160;machine&#160;to&#160;the&#160;domain&#160;and&#160;connects&#160;it&#160;with&#160;the&#160;re-</p>
<p style="position:absolute;top:934px;left:187px;white-space:nowrap" class="ft888">quested&#160;resources&#160;such&#160;as&#160;the&#160;domain-internal&#160;network.</p>
<p style="position:absolute;top:974px;left:150px;white-space:nowrap" class="ft8823"><b>Connecting&#160;a&#160;VPE&#160;to&#160;a&#160;Requested&#160;Domain</b></p>
<p style="position:absolute;top:1002px;left:150px;white-space:nowrap" class="ft8815">Once&#160;a&#160;VPE&#160;has&#160;been&#160;assigned&#160;to&#160;a&#160;domain,&#160;it&#160;may&#160;request&#160;connection&#160;to&#160;networks&#160;of<br/>other&#160;domains:</p>
<p style="position:absolute;top:1049px;left:168px;white-space:nowrap" class="ft888">1.&#160;A&#160;VPE&#160;requests&#160;to&#160;connect&#160;a&#160;given&#160;virtual&#160;network&#160;adapter&#160;to&#160;the&#160;network&#160;of&#160;a</p>
<p style="position:absolute;top:1067px;left:187px;white-space:nowrap" class="ft888">second&#160;domain&#160;(identified&#160;by&#160;master&#160;URL&#160;and&#160;public&#160;key).</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft8821">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 89 -->
<a name="89"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page89-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5089.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft898">CHAPTER&#160;7.&#160;SECURE&#160;VIRTUALIZED&#160;NETWORKING</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft898">87</p>
<p style="position:absolute;top:194px;left:245px;white-space:nowrap" class="ft898">2.&#160;The&#160;VPE&#160;runs&#160;a&#160;credential&#160;validation&#160;protocol&#160;with&#160;the&#160;TVD&#160;proxy&#160;of&#160;the&#160;domain</p>
<p style="position:absolute;top:212px;left:263px;white-space:nowrap" class="ft898">of&#160;the&#160;vSwitch.</p>
<p style="position:absolute;top:241px;left:245px;white-space:nowrap" class="ft898">3.&#160;The&#160;TVD&#160;proxy&#160;of&#160;the&#160;domain&#160;is&#160;asked&#160;whether&#160;connection&#160;to&#160;this&#160;target&#160;TVD&#160;is</p>
<p style="position:absolute;top:259px;left:263px;white-space:nowrap" class="ft898">permitted.</p>
<p style="position:absolute;top:289px;left:245px;white-space:nowrap" class="ft898">4.&#160;The&#160;virtual&#160;network&#160;of&#160;the&#160;VPE&#160;is&#160;connected&#160;to&#160;the&#160;vSwitch.</p>
<p style="position:absolute;top:335px;left:226px;white-space:nowrap" class="ft8926"><b>7.5</b></p>
<p style="position:absolute;top:335px;left:274px;white-space:nowrap" class="ft8926"><b>Auto-deployment&#160;of&#160;Trusted&#160;Virtual&#160;Domains</b></p>
<p style="position:absolute;top:373px;left:226px;white-space:nowrap" class="ft8914">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#91">7.4&#160;</a>shows&#160;the&#160;steps&#160;involved&#160;in&#160;automatic&#160;deployment&#160;of&#160;secure&#160;virtual&#160;infras-<br/>tructures&#160;as&#160;TVD&#160;configurations.&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#92">7.5&#160;</a>shows&#160;the&#160;steps&#160;involved&#160;in&#160;the&#160;establish-<br/>ment&#160;and&#160;management&#160;of&#160;a&#160;single&#160;TVD.</p>
<p style="position:absolute;top:427px;left:248px;white-space:nowrap" class="ft898">First,&#160;the&#160;virtual&#160;infrastructure&#160;topology&#160;must&#160;be&#160;decomposed&#160;into&#160;constituent</p>
<p style="position:absolute;top:445px;left:226px;white-space:nowrap" class="ft8914">TVDs,&#160;along&#160;with&#160;associated&#160;security&#160;requirements&#160;and&#160;policy&#160;model.&#160;Second,&#160;a&#160;<i>capa-<br/>bility&#160;model&#160;</i>of&#160;the&#160;physical&#160;infrastructure&#160;must&#160;be&#160;developed.&#160;Capability&#160;modeling&#160;is<br/>essentially&#160;the&#160;step&#160;of&#160;taking&#160;stock&#160;of&#160;existing&#160;mechanisms&#160;that&#160;can&#160;be&#160;directly&#160;used&#160;to<br/>satisfy&#160;the&#160;TVD&#160;security&#160;requirements.&#160;In&#160;this&#160;paper,&#160;we&#160;consider&#160;the&#160;case&#160;where&#160;both<br/>steps&#160;are&#160;done&#160;manually&#160;in&#160;an&#160;offline&#160;manner;&#160;future&#160;extensions&#160;will&#160;focus&#160;on&#160;automat-<br/>ing&#160;them&#160;and&#160;on&#160;dynamically&#160;changing&#160;the&#160;capability&#160;models&#160;based&#160;on&#160;actual&#160;changes<br/>to&#160;the&#160;capabilities.</p>
<p style="position:absolute;top:593px;left:226px;white-space:nowrap" class="ft8924"><b>7.5.1</b></p>
<p style="position:absolute;top:593px;left:280px;white-space:nowrap" class="ft8924"><b>Capability&#160;Modeling&#160;of&#160;the&#160;Physical&#160;Infrastructure</b></p>
<p style="position:absolute;top:623px;left:226px;white-space:nowrap" class="ft8914">Capability&#160;modeling&#160;of&#160;the&#160;physical&#160;infrastructure&#160;considers&#160;both&#160;functional&#160;and&#160;secu-<br/>rity&#160;capabilities.&#160;The&#160;functional&#160;capabilities&#160;of&#160;a&#160;host&#160;may&#160;be&#160;modeled&#160;using&#160;a&#160;function</p>
<p style="position:absolute;top:658px;left:226px;white-space:nowrap" class="ft8946">C</p>
<p style="position:absolute;top:658px;left:243px;white-space:nowrap" class="ft8948">:</p>
<p style="position:absolute;top:658px;left:251px;white-space:nowrap" class="ft8946">H</p>
<p style="position:absolute;top:658px;left:270px;white-space:nowrap" class="ft8950">→&#160;{</p>
<p style="position:absolute;top:658px;left:297px;white-space:nowrap" class="ft8946">V&#160;LAN,&#160;Ethernet,&#160;IP</p>
<p style="position:absolute;top:658px;left:437px;white-space:nowrap" class="ft8950">}</p>
<p style="position:absolute;top:659px;left:445px;white-space:nowrap" class="ft898">,&#160;to&#160;describe&#160;whether&#160;a&#160;host&#160;has&#160;VLAN,&#160;Ethernet,</p>
<p style="position:absolute;top:677px;left:226px;white-space:nowrap" class="ft8914">or&#160;IP&#160;support.&#160;Modeling&#160;of&#160;security&#160;capabilities&#160;includes&#160;two&#160;orthogonal&#160;aspects:&#160;the<br/>set&#160;of&#160;security&#160;properties&#160;and&#160;the&#160;assurance&#160;that&#160;these&#160;properties&#160;are&#160;actually&#160;provided.<br/>Table&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#94">7.4&#160;</a>lists&#160;some&#160;examples&#160;of&#160;security&#160;properties&#160;and&#160;Table&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#95">7.5&#160;</a>gives&#160;examples&#160;of<br/>the&#160;types&#160;of&#160;evidence&#160;that&#160;can&#160;be&#160;used&#160;to&#160;support&#160;security&#160;property&#160;claims.</p>
<p style="position:absolute;top:771px;left:226px;white-space:nowrap" class="ft8924"><b>7.5.2</b></p>
<p style="position:absolute;top:771px;left:280px;white-space:nowrap" class="ft8924"><b>Instantiation&#160;of&#160;the&#160;Right&#160;Networking&#160;Modules</b></p>
<p style="position:absolute;top:802px;left:226px;white-space:nowrap" class="ft8915">The&#160;TVD&#160;proxy&#160;uses&#160;the&#160;instructions&#160;given&#160;to&#160;it&#160;by&#160;the&#160;TVD&#160;master&#160;to&#160;determine&#160;the<br/>right&#160;protection&#160;mechanisms&#160;to&#160;instantiate&#160;on&#160;the&#160;local&#160;platform&#160;for&#160;the&#160;TVD&#160;network<br/>traffic,&#160;and&#160;accordingly&#160;configures&#160;the&#160;local&#160;TVD&#160;vSwitch.</p>
<p style="position:absolute;top:855px;left:248px;white-space:nowrap" class="ft898">Suppose&#160;that&#160;isolation&#160;of&#160;TVD&#160;traffic&#160;is&#160;a&#160;requirement.&#160;Then,&#160;VLAN&#160;tagging&#160;alone</p>
<p style="position:absolute;top:873px;left:226px;white-space:nowrap" class="ft8914">would&#160;suffice&#160;provided&#160;the&#160;TVD&#160;spans&#160;only&#160;the&#160;LAN&#160;and&#160;the&#160;physical&#160;switches&#160;on&#160;the<br/>LAN&#160;are&#160;VLAN-enabled&#160;(i.e.,&#160;it&#160;must&#160;support&#160;IEEE&#160;802.1Q&#160;and&#160;must&#160;be&#160;appropriately<br/>configured);&#160;in&#160;that&#160;case,&#160;a&#160;VLAN&#160;tagging&#160;module&#160;would&#160;be&#160;created&#160;and&#160;connected<br/>to&#160;the&#160;vSwitch.&#160;If&#160;the&#160;TVD&#160;spans&#160;beyond&#160;a&#160;LAN,&#160;then&#160;VLAN&#160;tagging&#160;must&#160;be&#160;used<br/>in&#160;conjunction&#160;with&#160;EtherIP&#160;encapsulation.&#160;In&#160;this&#160;case,&#160;the&#160;VLAN&#160;tagged&#160;packet&#160;is<br/>encapsulated&#160;in&#160;a&#160;new&#160;IP&#160;packet&#160;and&#160;tunneled&#160;to&#160;the&#160;other&#160;side,&#160;where&#160;the&#160;original<br/>VLAN&#160;tagged&#160;packet&#160;is&#160;extracted&#160;and&#160;transmitted&#160;on&#160;the&#160;VLAN.&#160;If&#160;VLAN-enabled<br/>switches&#160;are&#160;not&#160;available,&#160;then&#160;EtherIP&#160;alone&#160;would&#160;suffice&#160;for&#160;isolation.</p>
<p style="position:absolute;top:1017px;left:248px;white-space:nowrap" class="ft898">By&#160;itself,&#160;EtherIP&#160;does&#160;not&#160;provide&#160;integrity&#160;or&#160;confidentiality&#160;of&#160;the&#160;packets.</p>
<p style="position:absolute;top:1035px;left:226px;white-space:nowrap" class="ft8914">Hence,&#160;when&#160;those&#160;properties&#160;are&#160;required,&#160;EtherIP&#160;is&#160;suitable&#160;only&#160;on&#160;routed&#160;and<br/>trusted&#160;networks,&#160;e.g.,&#160;EtherIP&#160;would&#160;be&#160;suitable&#160;for&#160;traffic&#160;between&#160;two&#160;vSwitches</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft8921">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 90 -->
<a name="90"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page90-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5090.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft908">88</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft9021">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft9014">hosted&#160;on&#160;different&#160;physical&#160;platforms&#160;that&#160;are&#160;not&#160;connected&#160;to&#160;the&#160;same&#160;VLAN&#160;switch<br/>in&#160;a&#160;datacenter&#160;or&#160;corporate&#160;environment.</p>
<p style="position:absolute;top:230px;left:172px;white-space:nowrap" class="ft908">If&#160;integrity&#160;or&#160;confidentiality&#160;are&#160;required&#160;properties&#160;and&#160;the&#160;underlying&#160;network&#160;is</p>
<p style="position:absolute;top:247px;left:150px;white-space:nowrap" class="ft9015">not&#160;trusted,&#160;then&#160;IPsec&#160;is&#160;used&#160;in&#160;conjunction&#160;with&#160;EtherIP&#160;and&#160;VLAN.&#160;In&#160;that&#160;case,<br/>the&#160;TVD&#160;proxy&#160;will&#160;create&#160;the&#160;VPN&#160;module,&#160;initialize&#160;it&#160;with&#160;the&#160;VPN&#160;key&#160;obtained<br/>from&#160;the&#160;master,&#160;and&#160;connect&#160;it&#160;to&#160;the&#160;vSwitch.&#160;Since&#160;IPsec&#160;only&#160;operates&#160;on&#160;IP&#160;packets<br/>and&#160;not&#160;Ethernet&#160;or&#160;VLAN&#160;ones,&#160;double&#160;encapsulation&#160;is&#160;needed:&#160;EtherIP&#160;is&#160;used&#160;to<br/>first&#160;encapsulate&#160;the&#160;Ethernet&#160;or&#160;VLAN&#160;packets,&#160;followed&#160;by&#160;IPsec&#160;encapsulation&#160;and<br/>encryption&#160;(using&#160;the&#160;VPN&#160;key).</p>
<p style="position:absolute;top:378px;left:150px;white-space:nowrap" class="ft9024"><b>7.5.3</b></p>
<p style="position:absolute;top:378px;left:204px;white-space:nowrap" class="ft9024"><b>Inter-TVD&#160;Management</b></p>
<p style="position:absolute;top:408px;left:172px;white-space:nowrap" class="ft908">Separation&#160;of&#160;flow&#160;control&#160;and&#160;transport.&#160;Transport&#160;part&#160;is&#160;based&#160;on&#160;today’s&#160;connec-</p>
<p style="position:absolute;top:426px;left:150px;white-space:nowrap" class="ft9015">tion&#160;between&#160;autonomous&#160;systems&#160;based&#160;on&#160;BGP.&#160;Flow&#160;control&#160;is&#160;based&#160;on&#160;firewalls.<br/>Flow&#160;control&#160;part&#160;figures&#160;out&#160;whether&#160;a&#160;packet&#160;can&#160;get&#160;out&#160;to&#160;the&#160;other&#160;TVD&#160;and&#160;what<br/>protection&#160;mechanism&#160;is&#160;needed&#160;(e.g.,&#160;encryption).&#160;After&#160;flow&#160;control,&#160;border&#160;gateway<br/>takes&#160;care&#160;of&#160;routing&#160;the&#160;packet&#160;to&#160;the&#160;border&#160;gateway&#160;at&#160;other&#160;end.&#160;Contact&#160;master<br/>for&#160;obtaining&#160;capability&#160;of&#160;the&#160;other&#160;side&#160;gateway.&#160;Master-master&#160;communication&#160;for<br/>generating&#160;shared&#160;key&#160;for&#160;encryption&#160;for&#160;inter-TVD&#160;traffic.</p>
<p style="position:absolute;top:533px;left:172px;white-space:nowrap" class="ft908">One&#160;firewall&#160;for&#160;each&#160;other&#160;TVD,&#160;or&#160;new&#160;rules&#160;for&#160;another&#160;new&#160;TVD&#160;on&#160;the&#160;same</p>
<p style="position:absolute;top:551px;left:150px;white-space:nowrap" class="ft908">firewall?</p>
<p style="position:absolute;top:569px;left:172px;white-space:nowrap" class="ft908">Inter-TVD&#160;management&#160;deals&#160;with&#160;the&#160;<i>interchange&#160;fabric&#160;</i>for&#160;communication&#160;be-</p>
<p style="position:absolute;top:587px;left:150px;white-space:nowrap" class="ft9015">tween&#160;TVDs,&#160;enforcement&#160;of&#160;inter-TVD&#160;flow&#160;control&#160;policies,&#160;external&#160;zones&#160;(IP&#160;versus<br/>Ethernet),&#160;approval&#160;of&#160;admission&#160;requests&#160;by&#160;TVD-external&#160;entities&#160;(such&#160;as&#160;a&#160;new&#160;VM)<br/>to&#160;join&#160;the&#160;TVD,&#160;and&#160;linking&#160;such&#160;entities&#160;with&#160;the&#160;appropriate&#160;TVD&#160;master.</p>
<p style="position:absolute;top:641px;left:172px;white-space:nowrap" class="ft908">As&#160;shown&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#85">7.2,&#160;</a>inter-TVD&#160;communication&#160;can&#160;be&#160;broadly&#160;classified&#160;into</p>
<p style="position:absolute;top:659px;left:150px;white-space:nowrap" class="ft9014">three&#160;types:&#160;(1)&#160;<i>controlled&#160;</i>connections,&#160;represented&#160;by&#160;policy&#160;entries&#160;in&#160;the&#160;matrix,<br/>(2)&#160;<i>open&#160;</i>or&#160;unrestricted&#160;connections,&#160;represented&#160;by</p>
<p style="position:absolute;top:677px;left:467px;white-space:nowrap" class="ft9052">1</p>
<p style="position:absolute;top:677px;left:480px;white-space:nowrap" class="ft908">elements&#160;in&#160;the&#160;matrix,&#160;and&#160;(3)</p>
<p style="position:absolute;top:695px;left:150px;white-space:nowrap" class="ft9020"><i>closed&#160;</i>connections,&#160;represented&#160;by</p>
<p style="position:absolute;top:695px;left:362px;white-space:nowrap" class="ft9052">0</p>
<p style="position:absolute;top:695px;left:375px;white-space:nowrap" class="ft908">elements&#160;in&#160;the&#160;matrix.</p>
<p style="position:absolute;top:713px;left:172px;white-space:nowrap" class="ft908">Controlled&#160;connections&#160;restrict&#160;the&#160;flow&#160;between&#160;TVDs&#160;based&#160;on&#160;specified&#160;poli-</p>
<p style="position:absolute;top:731px;left:150px;white-space:nowrap" class="ft9015">cies.&#160;The&#160;policies&#160;are&#160;enforced&#160;at&#160;TVD&#160;boundaries&#160;(at&#160;both&#160;TVDs)&#160;by&#160;appropriately<br/>configured&#160;firewalls.&#160;The&#160;TVD&#160;master&#160;may&#160;push&#160;pre-checked&#160;configurations&#160;(derived<br/>from&#160;TVD&#160;policies)&#160;into&#160;the&#160;firewalls&#160;during&#160;the&#160;establishment&#160;of&#160;the&#160;TVD&#160;topology.<br/>If&#160;available,&#160;a&#160;management&#160;console&#160;at&#160;the&#160;TVD&#160;master&#160;may&#160;be&#160;used&#160;to&#160;manually&#160;set<br/>up&#160;and/or&#160;alter&#160;the&#160;configurations&#160;of&#160;the&#160;firewalls.&#160;A&#160;TVD&#160;firewall&#160;has&#160;multiple&#160;vir-<br/>tual&#160;network&#160;interface&#160;cards,&#160;one&#160;card&#160;for&#160;the&#160;internal&#160;VLAN&#160;that&#160;the&#160;firewall&#160;protects<br/>and&#160;one&#160;additional&#160;card&#160;for&#160;each&#160;TVD&#160;that&#160;the&#160;members&#160;of&#160;the&#160;protected&#160;TVD&#160;want&#160;to<br/>communicate&#160;with.</p>
<p style="position:absolute;top:874px;left:172px;white-space:nowrap" class="ft908">Open&#160;connection&#160;between&#160;two&#160;TVDs&#160;means&#160;that&#160;any&#160;two&#160;machines&#160;in&#160;either&#160;TVD</p>
<p style="position:absolute;top:892px;left:150px;white-space:nowrap" class="ft9015">can&#160;communicate&#160;freely.&#160;In&#160;such&#160;a&#160;case,&#160;the&#160;firewalls&#160;at&#160;both&#160;TVDs&#160;would&#160;have&#160;virtual<br/>network&#160;cards&#160;for&#160;the&#160;peer&#160;domain&#160;and&#160;simply&#160;serve&#160;as&#160;bridges&#160;between&#160;the&#160;domains.<br/>For&#160;example,&#160;different&#160;zones&#160;in&#160;a&#160;given&#160;enterprise&#160;may&#160;form&#160;different&#160;TVDs,&#160;but&#160;may<br/>communicate&#160;freely.&#160;As&#160;another&#160;example,&#160;two&#160;TVDs&#160;may&#160;have&#160;different&#160;member-<br/>ship&#160;requirements,&#160;but&#160;may&#160;have&#160;an&#160;open&#160;connection&#160;between&#160;their&#160;elements.&#160;Open<br/>connection&#160;between&#160;two&#160;domains&#160;may&#160;be&#160;implemented&#160;using&#160;an&#160;unlimited&#160;number&#160;of<br/>virtual&#160;routers.&#160;In&#160;a&#160;physical&#160;machine&#160;that&#160;is&#160;hosting&#160;two&#160;VMs&#160;belonging&#160;to&#160;different<br/>TVDs&#160;with&#160;an&#160;open&#160;connection,&#160;the&#160;corresponding&#160;vSwitches&#160;may&#160;be&#160;directly&#160;con-<br/>nected.&#160;Communication&#160;between&#160;two&#160;TVDs,&#160;while&#160;open,&#160;may&#160;be&#160;subject&#160;to&#160;some&#160;con-<br/>straints&#160;and&#160;monitoring.&#160;For&#160;example,&#160;a&#160;TVD&#160;master&#160;may&#160;permit&#160;the&#160;creation&#160;of&#160;only</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft9021">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 91 -->
<a name="91"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page91-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5091.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft918">CHAPTER&#160;7.&#160;SECURE&#160;VIRTUALIZED&#160;NETWORKING</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft918">89</p>
<p style="position:absolute;top:224px;left:485px;white-space:nowrap" class="ft9143">Security&#160;</p>
<p style="position:absolute;top:235px;left:489px;white-space:nowrap" class="ft9143">Policy</p>
<p style="position:absolute;top:279px;left:484px;white-space:nowrap" class="ft9143">Per-host&#160;</p>
<p style="position:absolute;top:290px;left:479px;white-space:nowrap" class="ft9143">Extensions</p>
<p style="position:absolute;top:334px;left:487px;white-space:nowrap" class="ft9143">Global&#160;</p>
<p style="position:absolute;top:345px;left:473px;white-space:nowrap" class="ft9143">Configuration</p>
<p style="position:absolute;top:194px;left:505px;white-space:nowrap" class="ft9149">TVD&#160;<br/>Requirements</p>
<p style="position:absolute;top:252px;left:505px;white-space:nowrap" class="ft9149">Mechanisms<br/>Required</p>
<p style="position:absolute;top:307px;left:505px;white-space:nowrap" class="ft9149">Deployment&#160;Planning&#160;<br/>&amp;&#160;Management</p>
<p style="position:absolute;top:223px;left:416px;white-space:nowrap" class="ft9143">TVD&#160;Policy</p>
<p style="position:absolute;top:234px;left:426px;white-space:nowrap" class="ft9143">Model</p>
<p style="position:absolute;top:278px;left:422px;white-space:nowrap" class="ft9143">Capability</p>
<p style="position:absolute;top:289px;left:429px;white-space:nowrap" class="ft9143">Model</p>
<p style="position:absolute;top:364px;left:398px;white-space:nowrap" class="ft9149">Revised&#160;Requirements,&#160;<br/>Policies,&#160;or&#160;Capabilities</p>
<p style="position:absolute;top:407px;left:339px;white-space:nowrap" class="ft918">Figure&#160;7.4:&#160;Steps&#160;in&#160;Auto-Deployment&#160;of&#160;TVDs.</p>
<p style="position:absolute;top:497px;left:226px;white-space:nowrap" class="ft9114">a&#160;few&#160;virtual&#160;routers&#160;on&#160;certain&#160;high-assurance&#160;physical&#160;machines&#160;for&#160;information&#160;flow<br/>between&#160;the&#160;TVD&#160;and&#160;another&#160;TVD&#160;with&#160;which&#160;the&#160;former&#160;has&#160;an&#160;open&#160;connection.</p>
<p style="position:absolute;top:532px;left:248px;white-space:nowrap" class="ft918">A&#160;closed&#160;connection&#160;between&#160;two&#160;TVDs&#160;can&#160;be&#160;seen&#160;as&#160;a&#160;special&#160;case&#160;of&#160;a&#160;con-</p>
<p style="position:absolute;top:550px;left:226px;white-space:nowrap" class="ft9115">trolled&#160;connection&#160;in&#160;which&#160;the&#160;firewall&#160;does&#160;not&#160;have&#160;virtual&#160;network&#160;card&#160;for&#160;the&#160;peer<br/>TVD.&#160;In&#160;addition&#160;to&#160;the&#160;firewall&#160;filtering&#160;rules,&#160;the&#160;absence&#160;of&#160;the&#160;card&#160;will&#160;prevent&#160;any<br/>communication&#160;with&#160;the&#160;peer&#160;TVD.</p>
<p style="position:absolute;top:604px;left:248px;white-space:nowrap" class="ft918">Special&#160;VMs&#160;(e.g.,&#160;gateways)&#160;may&#160;have&#160;membership&#160;in&#160;two&#160;or&#160;more&#160;open&#160;TVDs</p>
<p style="position:absolute;top:622px;left:226px;white-space:nowrap" class="ft918">simultaneously.&#160;Consider&#160;a&#160;VM&#160;that&#160;is&#160;first&#160;a&#160;member&#160;of&#160;TVD</p>
<p style="position:absolute;top:621px;left:616px;white-space:nowrap" class="ft9146">α</p>
<p style="position:absolute;top:622px;left:626px;white-space:nowrap" class="ft918">.&#160;The&#160;VM&#160;has&#160;one</p>
<p style="position:absolute;top:640px;left:226px;white-space:nowrap" class="ft918">virtual&#160;NIC&#160;that&#160;is&#160;connected&#160;to&#160;the&#160;vSwitch&#160;of&#160;TVD</p>
<p style="position:absolute;top:639px;left:555px;white-space:nowrap" class="ft9146">α</p>
<p style="position:absolute;top:640px;left:565px;white-space:nowrap" class="ft918">.&#160;Now,&#160;suppose&#160;that&#160;the&#160;VM</p>
<p style="position:absolute;top:658px;left:226px;white-space:nowrap" class="ft918">needs&#160;to&#160;be&#160;a&#160;member&#160;of&#160;both&#160;TVD</p>
<p style="position:absolute;top:657px;left:449px;white-space:nowrap" class="ft9146">α</p>
<p style="position:absolute;top:658px;left:463px;white-space:nowrap" class="ft918">and&#160;TVD</p>
<p style="position:absolute;top:657px;left:525px;white-space:nowrap" class="ft9146">β</p>
<p style="position:absolute;top:658px;left:538px;white-space:nowrap" class="ft918">simultaneously.&#160;For&#160;this&#160;purpose,</p>
<p style="position:absolute;top:676px;left:226px;white-space:nowrap" class="ft918">the&#160;VM&#160;needs&#160;to&#160;have&#160;two&#160;virtual&#160;NICs,&#160;one&#160;connected&#160;to&#160;the&#160;vSwitch&#160;of&#160;TVD</p>
<p style="position:absolute;top:675px;left:706px;white-space:nowrap" class="ft9146">α</p>
<p style="position:absolute;top:676px;left:720px;white-space:nowrap" class="ft918">and</p>
<p style="position:absolute;top:694px;left:226px;white-space:nowrap" class="ft918">the&#160;other&#160;connected&#160;to&#160;that&#160;of&#160;TVD</p>
<p style="position:absolute;top:693px;left:437px;white-space:nowrap" class="ft9146">β</p>
<p style="position:absolute;top:694px;left:446px;white-space:nowrap" class="ft918">.&#160;Any&#160;VM&#160;request&#160;to&#160;create&#160;a&#160;new&#160;virtual&#160;NIC&#160;has</p>
<p style="position:absolute;top:712px;left:226px;white-space:nowrap" class="ft918">to&#160;be&#160;approved&#160;by&#160;the&#160;TVD&#160;proxy,&#160;which&#160;grants&#160;the&#160;approval&#160;only&#160;if&#160;TVD</p>
<p style="position:absolute;top:711px;left:668px;white-space:nowrap" class="ft9146">α</p>
<p style="position:absolute;top:712px;left:681px;white-space:nowrap" class="ft918">is&#160;an&#160;open</p>
<p style="position:absolute;top:730px;left:226px;white-space:nowrap" class="ft918">TVD&#160;and&#160;TVD</p>
<p style="position:absolute;top:729px;left:323px;white-space:nowrap" class="ft9146">α</p>
<p style="position:absolute;top:730px;left:333px;white-space:nowrap" class="ft918">’s&#160;policies&#160;allow&#160;such&#160;a&#160;dual&#160;membership.&#160;Initially,&#160;the&#160;new&#160;virtual</p>
<p style="position:absolute;top:748px;left:226px;white-space:nowrap" class="ft9115">NIC&#160;is&#160;connected&#160;to&#160;the&#160;default&#160;network,&#160;and&#160;the&#160;VM&#160;sends&#160;a&#160;membership&#160;request&#160;for<br/>TVD</p>
<p style="position:absolute;top:765px;left:262px;white-space:nowrap" class="ft9146">β</p>
<p style="position:absolute;top:766px;left:277px;white-space:nowrap" class="ft918">to&#160;the&#160;local&#160;TVD&#160;proxy&#160;(if&#160;present)&#160;or&#160;a&#160;remote&#160;TVD&#160;master.&#160;If&#160;TVD</p>
<p style="position:absolute;top:765px;left:722px;white-space:nowrap" class="ft9146">β</p>
<p style="position:absolute;top:766px;left:732px;white-space:nowrap" class="ft918">’s</p>
<p style="position:absolute;top:784px;left:226px;white-space:nowrap" class="ft918">policies&#160;allow&#160;for&#160;dual&#160;membership&#160;with&#160;TVD</p>
<p style="position:absolute;top:783px;left:507px;white-space:nowrap" class="ft9146">α</p>
<p style="position:absolute;top:784px;left:520px;white-space:nowrap" class="ft918">and&#160;the&#160;VM&#160;satisfies&#160;other&#160;admission</p>
<p style="position:absolute;top:802px;left:226px;white-space:nowrap" class="ft918">requirements&#160;for&#160;TVD</p>
<p style="position:absolute;top:801px;left:362px;white-space:nowrap" class="ft9146">β</p>
<p style="position:absolute;top:802px;left:371px;white-space:nowrap" class="ft918">,&#160;then&#160;proxy&#160;for&#160;TVD</p>
<p style="position:absolute;top:801px;left:500px;white-space:nowrap" class="ft9146">β</p>
<p style="position:absolute;top:802px;left:512px;white-space:nowrap" class="ft918">will&#160;connect&#160;the&#160;new&#160;virtual&#160;NIC&#160;to&#160;the</p>
<p style="position:absolute;top:819px;left:226px;white-space:nowrap" class="ft918">vSwitch&#160;of&#160;TVD</p>
<p style="position:absolute;top:818px;left:329px;white-space:nowrap" class="ft9146">β</p>
<p style="position:absolute;top:819px;left:339px;white-space:nowrap" class="ft918">.&#160;At&#160;this&#160;point,&#160;the&#160;VM&#160;is&#160;connected&#160;to&#160;the&#160;VLANs&#160;of&#160;both&#160;TVDs.</p>
<p style="position:absolute;top:860px;left:226px;white-space:nowrap" class="ft9124"><b>7.5.4</b></p>
<p style="position:absolute;top:860px;left:280px;white-space:nowrap" class="ft9124"><b>Intra-TVD&#160;Management</b></p>
<p style="position:absolute;top:890px;left:226px;white-space:nowrap" class="ft9140">Intra-TVD&#160;management&#160;is&#160;concerned&#160;with&#160;TVD&#160;membership&#160;(including&#160;mutual&#160;au-<br/>thentication),&#160;communication&#160;within&#160;a&#160;TVD,&#160;and&#160;the&#160;network&#160;fabric&#160;(i.e.,&#160;internal&#160;topol-<br/>ogy)&#160;of&#160;a&#160;TVD.&#160;Prior&#160;to&#160;membership&#160;negotiation,&#160;mutual&#160;authentication&#160;requires&#160;both<br/>the&#160;TVD&#160;infrastructure&#160;(TVD&#160;proxy&#160;or&#160;the&#160;master&#160;in&#160;the&#160;absence&#160;of&#160;a&#160;proxy)&#160;and&#160;the<br/>client&#160;(i.e.,&#160;the&#160;prospective&#160;member&#160;VM)&#160;to&#160;authenticate&#160;itself&#160;to&#160;each&#160;other.&#160;For&#160;TVD<br/>authentication,&#160;we&#160;employ&#160;TVD&#160;certificates&#160;that&#160;are&#160;issued&#160;and&#160;distributed&#160;for&#160;each<br/>TVD.&#160;For&#160;client&#160;authentication,&#160;we&#160;use&#160;the&#160;IEEE&#160;802.1X&#160;standard&#160;for&#160;network&#160;access<br/>control&#160;(NAC).&#160;The&#160;latter&#160;employs&#160;a&#160;port-based&#160;authentication&#160;scheme&#160;and&#160;a&#160;third-party<br/>authenticator&#160;(e.g.,&#160;a&#160;RADIUS&#160;server)&#160;to&#160;authenticate&#160;the&#160;VM.&#160;In&#160;this&#160;setting,&#160;the&#160;TVD<br/>proxy&#160;acts&#160;as&#160;the&#160;<i>authenticator&#160;</i>that&#160;forwards&#160;the&#160;request&#160;to&#160;the&#160;<i>authentication&#160;server<br/></i>and&#160;interprets&#160;the&#160;result.&#160;We&#160;describe&#160;client&#160;authentication&#160;in&#160;detail&#160;in&#160;Sections&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#89">7.5</a></p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft9121">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 92 -->
<a name="92"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft92156{font-size:17px;font-family:Helvetica;color:#000000;}
	.ft92157{font-size:17px;font-family:Helvetica;color:#000000;}
	.ft92158{font-size:15px;font-family:KPSHBO+TT9CE8o00;color:#000000;}
-->
</style>
<div id="page92-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5092.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft928">90</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft9221">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:231px;left:479px;white-space:nowrap" class="ft92156">TVD&#160;Master</p>
<p style="position:absolute;top:209px;left:334px;white-space:nowrap" class="ft92156">DomU</p>
<p style="position:absolute;top:209px;left:252px;white-space:nowrap" class="ft92156">Dom0</p>
<p style="position:absolute;top:345px;left:245px;white-space:nowrap" class="ft92104"><b>TVD&#160;proxy</b></p>
<p style="position:absolute;top:272px;left:240px;white-space:nowrap" class="ft92104"><b>TVD-specific</b></p>
<p style="position:absolute;top:285px;left:251px;white-space:nowrap" class="ft92104"><b>Modules</b></p>
<p style="position:absolute;top:244px;left:235px;white-space:nowrap" class="ft92104"><b>EtherIP&#160;VLAN</b></p>
<p style="position:absolute;top:310px;left:283px;white-space:nowrap" class="ft92157"><b>…..</b></p>
<p style="position:absolute;top:305px;left:236px;white-space:nowrap" class="ft92104"><b>Policy&#160;</b></p>
<p style="position:absolute;top:319px;left:236px;white-space:nowrap" class="ft92104"><b>Engine</b></p>
<p style="position:absolute;top:272px;left:240px;white-space:nowrap" class="ft92104"><b>TVD-specific</b></p>
<p style="position:absolute;top:285px;left:251px;white-space:nowrap" class="ft92104"><b>Modules</b></p>
<p style="position:absolute;top:244px;left:235px;white-space:nowrap" class="ft92104"><b>EtherIP&#160;VLAN</b></p>
<p style="position:absolute;top:310px;left:283px;white-space:nowrap" class="ft92157"><b>…..</b></p>
<p style="position:absolute;top:305px;left:236px;white-space:nowrap" class="ft92104"><b>Policy&#160;</b></p>
<p style="position:absolute;top:319px;left:236px;white-space:nowrap" class="ft92104"><b>Engine</b></p>
<p style="position:absolute;top:353px;left:340px;white-space:nowrap" class="ft92104"><b>vNICs</b></p>
<p style="position:absolute;top:362px;left:350px;white-space:nowrap" class="ft92157"><b>…</b></p>
<p style="position:absolute;top:424px;left:254px;white-space:nowrap" class="ft92104"><b>0</b></p>
<p style="position:absolute;top:424px;left:272px;white-space:nowrap" class="ft92104"><b>TVD&#160;object&#160;</b></p>
<p style="position:absolute;top:419px;left:334px;white-space:nowrap" class="ft92158">←</p>
<p style="position:absolute;top:424px;left:352px;white-space:nowrap" class="ft92104"><b>create&#160;TVD&#160;(TVD&#160;requirements,&#160;policy&#160;model)</b></p>
<p style="position:absolute;top:445px;left:272px;white-space:nowrap" class="ft92104"><b>create&#160;TVD&#160;Proxy&#160;(Master&#160;URL)</b></p>
<p style="position:absolute;top:447px;left:254px;white-space:nowrap" class="ft92104"><b>1</b></p>
<p style="position:absolute;top:351px;left:524px;white-space:nowrap" class="ft92104"><b>0</b></p>
<p style="position:absolute;top:469px;left:254px;white-space:nowrap" class="ft92104"><b>2</b></p>
<p style="position:absolute;top:467px;left:272px;white-space:nowrap" class="ft92104"><b>connect&#160;VM&#160;to&#160;TVD&#160;(TVD&#160;object)</b></p>
<p style="position:absolute;top:362px;left:305px;white-space:nowrap" class="ft92104"><b>1</b></p>
<p style="position:absolute;top:385px;left:434px;white-space:nowrap" class="ft92104"><b>1</b></p>
<p style="position:absolute;top:312px;left:355px;white-space:nowrap" class="ft92104"><b>2</b></p>
<p style="position:absolute;top:506px;left:290px;white-space:nowrap" class="ft928">Figure&#160;7.5:&#160;Steps&#160;in&#160;Populating&#160;a&#160;TVD.</p>
<p style="position:absolute;top:569px;left:150px;white-space:nowrap" class="ft928">and&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#94">7.6.</a></p>
<p style="position:absolute;top:587px;left:172px;white-space:nowrap" class="ft9220"><i>Intra-TVD&#160;policies&#160;</i>specify&#160;the&#160;membership&#160;requirements&#160;for&#160;each&#160;TVD,&#160;i.e.,&#160;the</p>
<p style="position:absolute;top:605px;left:150px;white-space:nowrap" class="ft9215">conditions&#160;under&#160;which&#160;a&#160;VM&#160;is&#160;allowed&#160;to&#160;join&#160;the&#160;TVD.&#160;At&#160;a&#160;physical&#160;machine&#160;host-<br/>ing&#160;the&#160;VM,&#160;the&#160;requirements&#160;are&#160;enforced&#160;by&#160;the&#160;machine’s&#160;TVD&#160;proxy&#160;in&#160;collabo-<br/>ration&#160;with&#160;networking&#160;elements&#160;(such&#160;as&#160;vSwitches)&#160;based&#160;on&#160;the&#160;policies&#160;given&#160;to<br/>the&#160;TVD&#160;proxy&#160;by&#160;the&#160;TVD&#160;master.&#160;We&#160;describe&#160;TVD&#160;admission&#160;control&#160;in&#160;detail&#160;in<br/>Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#89">7.5.</a></p>
<p style="position:absolute;top:694px;left:172px;white-space:nowrap" class="ft928">A&#160;VLAN&#160;can&#160;be&#160;part&#160;of&#160;at&#160;most&#160;one&#160;TVD.&#160;For&#160;completeness,&#160;each&#160;VLAN&#160;that</p>
<p style="position:absolute;top:712px;left:150px;white-space:nowrap" class="ft928">is&#160;not&#160;explicitly&#160;part&#160;of&#160;some&#160;TVD&#160;is&#160;assumed&#160;to&#160;be&#160;a&#160;member&#160;of&#160;a&#160;<i>dummy&#160;</i>TVD,</p>
<p style="position:absolute;top:729px;left:150px;white-space:nowrap" class="ft9246">T&#160;V&#160;D</p>
<p style="position:absolute;top:735px;left:185px;white-space:nowrap" class="ft9272">∆</p>
<p style="position:absolute;top:730px;left:196px;white-space:nowrap" class="ft928">.&#160;Although&#160;a&#160;VLAN&#160;that&#160;is&#160;part&#160;of</p>
<p style="position:absolute;top:729px;left:421px;white-space:nowrap" class="ft9246">T&#160;V&#160;D</p>
<p style="position:absolute;top:735px;left:456px;white-space:nowrap" class="ft9272">∆</p>
<p style="position:absolute;top:730px;left:473px;white-space:nowrap" class="ft928">may&#160;employ&#160;its&#160;own&#160;protection</p>
<p style="position:absolute;top:748px;left:150px;white-space:nowrap" class="ft9214">mechanisms,&#160;the&#160;TVD&#160;itself&#160;does&#160;not&#160;enforce&#160;any&#160;flow&#160;control&#160;policy&#160;and&#160;has&#160;open<br/>or&#160;unrestricted&#160;connections&#160;with&#160;other&#160;TVDs.&#160;Thus,&#160;in&#160;the&#160;information&#160;flow&#160;control<br/>matrix&#160;representation,&#160;the&#160;entries&#160;for&#160;policies,</p>
<p style="position:absolute;top:783px;left:432px;white-space:nowrap" class="ft9246">P</p>
<p style="position:absolute;top:789px;left:442px;white-space:nowrap" class="ft9272">∆</p>
<p style="position:absolute;top:789px;left:452px;white-space:nowrap" class="ft9247">α</p>
<p style="position:absolute;top:784px;left:465px;white-space:nowrap" class="ft928">and</p>
<p style="position:absolute;top:783px;left:491px;white-space:nowrap" class="ft9246">P</p>
<p style="position:absolute;top:789px;left:501px;white-space:nowrap" class="ft9247">α</p>
<p style="position:absolute;top:789px;left:508px;white-space:nowrap" class="ft9272">∆</p>
<p style="position:absolute;top:784px;left:519px;white-space:nowrap" class="ft928">,&#160;would&#160;all&#160;be</p>
<p style="position:absolute;top:784px;left:609px;white-space:nowrap" class="ft9252">1</p>
<p style="position:absolute;top:784px;left:622px;white-space:nowrap" class="ft928">for&#160;any</p>
<p style="position:absolute;top:801px;left:150px;white-space:nowrap" class="ft9246">T&#160;V&#160;D</p>
<p style="position:absolute;top:807px;left:185px;white-space:nowrap" class="ft9247">α</p>
<p style="position:absolute;top:802px;left:193px;white-space:nowrap" class="ft928">.</p>
<p style="position:absolute;top:820px;left:172px;white-space:nowrap" class="ft928">A&#160;VM&#160;that&#160;is&#160;connected&#160;to&#160;a&#160;particular&#160;VLAN&#160;segment&#160;automatically&#160;inherits&#160;the</p>
<p style="position:absolute;top:838px;left:150px;white-space:nowrap" class="ft9214">segment’s&#160;TVD&#160;membership.&#160;The&#160;VM&#160;gets&#160;connected&#160;to&#160;the&#160;VLAN&#160;segment&#160;only&#160;after<br/>the&#160;TVD&#160;proxy&#160;on&#160;the&#160;VM’s&#160;physical&#160;machine&#160;has&#160;checked&#160;whether&#160;the&#160;VM&#160;satisfies<br/>the&#160;TVD&#160;membership&#160;requirements.&#160;Once&#160;it&#160;has&#160;become&#160;a&#160;member,&#160;the&#160;VM&#160;can&#160;ex-<br/>change&#160;information&#160;freely&#160;with&#160;all&#160;other&#160;VMs&#160;in&#160;the&#160;same&#160;VLAN&#160;segment&#160;and&#160;TVD<br/>(intra-TVD&#160;communication&#160;is&#160;typically&#160;open&#160;or&#160;unrestricted).&#160;As&#160;mentioned&#160;before,&#160;a<br/>VM&#160;can&#160;be&#160;connected&#160;to&#160;more&#160;than&#160;one&#160;VLAN&#160;(and&#160;hence,&#160;be&#160;a&#160;member&#160;of&#160;more&#160;than<br/>one&#160;TVD)&#160;through&#160;a&#160;separate&#160;vNIC&#160;for&#160;each&#160;VLAN.</p>
<p style="position:absolute;top:963px;left:172px;white-space:nowrap" class="ft928">A&#160;VM&#160;can&#160;become&#160;a&#160;TVD&#160;member&#160;either&#160;in&#160;an&#160;active&#160;or&#160;in&#160;a&#160;passive&#160;fashion.&#160;In</p>
<p style="position:absolute;top:981px;left:150px;white-space:nowrap" class="ft9215">the&#160;<i>passive&#160;membership&#160;model</i>,&#160;a&#160;VM&#160;can&#160;be&#160;(passively)&#160;assigned&#160;a&#160;TVD&#160;membership<br/>at&#160;the&#160;time&#160;of&#160;its&#160;creation&#160;by&#160;specifying&#160;in&#160;the&#160;VM’s&#160;start-up&#160;configuration&#160;files&#160;which<br/>VLAN(s)&#160;the&#160;VM&#160;should&#160;be&#160;connected&#160;to.&#160;Alternatively,&#160;in&#160;the&#160;<i>active&#160;membership<br/>model</i>,&#160;a&#160;VM&#160;can&#160;actively&#160;request&#160;TVD&#160;membership&#160;at&#160;a&#160;later&#160;stage&#160;through&#160;the&#160;cor-<br/>responding&#160;TVD&#160;proxy&#160;interface&#160;or&#160;by&#160;directly&#160;contacting&#160;the&#160;TVD&#160;master&#160;if&#160;a&#160;TVD<br/>proxy&#160;is&#160;not&#160;present&#160;on&#160;the&#160;local&#160;platform.&#160;When&#160;a&#160;VM&#160;is&#160;created,&#160;it&#160;can&#160;use&#160;its&#160;default</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft9221">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 93 -->
<a name="93"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page93-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5093.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft938">CHAPTER&#160;7.&#160;SECURE&#160;VIRTUALIZED&#160;NETWORKING</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft938">91</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft9314">network&#160;connection&#160;to&#160;communicate&#160;with&#160;the&#160;outside&#160;world,&#160;particularly&#160;the&#160;local&#160;TVD<br/>proxy&#160;(if&#160;present)&#160;or&#160;a&#160;remote&#160;TVD&#160;master&#160;to&#160;request&#160;TVD&#160;membership.&#160;In&#160;either&#160;case,<br/>the&#160;IP&#160;address&#160;of&#160;the&#160;TVD&#160;authority&#160;must&#160;be&#160;made&#160;available&#160;to&#160;the&#160;VM.</p>
<p style="position:absolute;top:247px;left:248px;white-space:nowrap" class="ft938">A&#160;<i>closed&#160;TVD&#160;</i>is&#160;a&#160;special&#160;TVD&#160;that&#160;has&#160;closed&#160;connections&#160;with&#160;all&#160;other&#160;TVDs.</p>
<p style="position:absolute;top:265px;left:226px;white-space:nowrap" class="ft9314">For&#160;example,&#160;in&#160;a&#160;multi-level&#160;secure&#160;(MLS)&#160;military&#160;infrastructure,&#160;a&#160;top&#160;secret&#160;military<br/>domain&#160;would&#160;be&#160;a&#160;good&#160;candidate&#160;for&#160;a&#160;closed&#160;TVD.&#160;A&#160;closed&#160;TVD&#160;is&#160;shut&#160;off&#160;from<br/>the&#160;outside&#160;world,&#160;and&#160;a&#160;VM&#160;that&#160;does&#160;not&#160;belong&#160;to&#160;the&#160;TVD&#160;is&#160;part&#160;of&#160;that&#160;outside<br/>world.&#160;Hence,&#160;the&#160;active&#160;membership&#160;model&#160;is&#160;not&#160;applicable&#160;for&#160;closed&#160;TVDs.&#160;The<br/>TVD&#160;master&#160;for&#160;closed&#160;domains&#160;maintains&#160;a&#160;list&#160;of&#160;pre-approved&#160;platforms&#160;and&#160;will<br/>create&#160;TVD&#160;proxies&#160;only&#160;on&#160;those&#160;platforms.&#160;Only&#160;the&#160;system&#160;administrator&#160;or&#160;the<br/>TVD&#160;administrator&#160;can&#160;modify&#160;the&#160;list&#160;directly&#160;at&#160;the&#160;TVD&#160;master.</p>
<p style="position:absolute;top:391px;left:248px;white-space:nowrap" class="ft938">Open&#160;TVDs&#160;are&#160;those&#160;that&#160;are&#160;not&#160;closed.&#160;Both&#160;active&#160;and&#160;passive&#160;membership&#160;is</p>
<p style="position:absolute;top:409px;left:226px;white-space:nowrap" class="ft9315">possible&#160;in&#160;open&#160;TVDs.&#160;If&#160;the&#160;TVD&#160;master&#160;is&#160;directly&#160;contacted&#160;by&#160;the&#160;VM,&#160;the&#160;master<br/>checks&#160;whether&#160;a&#160;TVD&#160;proxy&#160;is&#160;already&#160;present&#160;on&#160;the&#160;VM’s&#160;platform.&#160;If&#160;so,&#160;the&#160;master<br/>instructs&#160;the&#160;proxy&#160;to&#160;initiate&#160;the&#160;admission&#160;protocol&#160;for&#160;the&#160;VM.&#160;If&#160;the&#160;TVD&#160;proxy&#160;is<br/>not&#160;present,&#160;then&#160;the&#160;TVD&#160;master&#160;initiates&#160;the&#160;protocol&#160;with&#160;the&#160;LCTC&#160;on&#160;the&#160;platform<br/>to&#160;create&#160;a&#160;TVD&#160;proxy.</p>
<p style="position:absolute;top:498px;left:248px;white-space:nowrap" class="ft938">TVD&#160;membership&#160;requirements&#160;may&#160;be&#160;checked&#160;and&#160;enforced&#160;on&#160;a&#160;one-time&#160;or&#160;on</p>
<p style="position:absolute;top:516px;left:226px;white-space:nowrap" class="ft9315">a&#160;continual&#160;basis.&#160;Membership&#160;can&#160;be&#160;a&#160;one-time&#160;operation&#160;in&#160;which&#160;the&#160;requirements<br/>are&#160;checked&#160;once&#160;and&#160;for&#160;all,&#160;and&#160;thereafter,&#160;the&#160;VM&#160;holds&#160;the&#160;TVD&#160;membership&#160;for&#160;the<br/>duration&#160;of&#160;its&#160;life-cycle.&#160;Alternatively,&#160;membership&#160;requirements&#160;can&#160;be&#160;re-evaluated<br/>in&#160;an&#160;online&#160;fashion.&#160;The&#160;TVD&#160;proxy&#160;may&#160;regularly&#160;check&#160;whether&#160;a&#160;VM&#160;satisfies&#160;the<br/>requirements.&#160;A&#160;session-based&#160;scheme&#160;may&#160;be&#160;employed&#160;in&#160;which&#160;a&#160;VM&#160;is&#160;allowed<br/>open&#160;communication&#160;with&#160;other&#160;TVD&#160;members&#160;only&#160;until&#160;the&#160;next&#160;check&#160;(i.e.,&#160;end&#160;of<br/>the&#160;session).</p>
<p style="position:absolute;top:642px;left:248px;white-space:nowrap" class="ft938">Policy&#160;updates&#160;at&#160;the&#160;TVD&#160;master&#160;or&#160;updates&#160;to&#160;a&#160;platform&#160;configuration&#160;may&#160;result</p>
<p style="position:absolute;top:660px;left:226px;white-space:nowrap" class="ft9314">in&#160;a&#160;platform&#160;becoming&#160;ineligible&#160;to&#160;any&#160;longer&#160;host&#160;member&#160;VPEs.&#160;In&#160;that&#160;case,&#160;the<br/>TVD&#160;master&#160;contacts&#160;the&#160;LCTC&#160;and&#160;requests&#160;it&#160;to&#160;destroy&#160;the&#160;TVD&#160;proxy.&#160;If&#160;the&#160;TVD<br/>is&#160;a&#160;closed&#160;TVD,&#160;prior&#160;to&#160;the&#160;actual&#160;destruction&#160;of&#160;the&#160;TVD&#160;proxy,&#160;members&#160;VMs&#160;are<br/>either&#160;migrated&#160;to&#160;another&#160;platform&#160;with&#160;a&#160;TVD&#160;proxy&#160;or&#160;destroyed.&#160;If&#160;the&#160;TVD&#160;is&#160;a<br/>open&#160;TVD,&#160;the&#160;VMs&#160;connected&#160;to&#160;the&#160;vSwitch&#160;are&#160;detached&#160;and&#160;re-connected&#160;to&#160;the<br/>default&#160;network&#160;connection.&#160;The&#160;LCTC&#160;sends&#160;an&#160;acknowledgment&#160;to&#160;the&#160;TVD&#160;master<br/>after&#160;the&#160;destruction&#160;of&#160;the&#160;TVD&#160;proxy.&#160;The&#160;TVD&#160;master&#160;may&#160;also&#160;rekey&#160;the&#160;TVD&#160;VPN<br/>key&#160;and&#160;distribute&#160;the&#160;new&#160;VPN&#160;key&#160;to&#160;the&#160;TVD&#160;proxies&#160;as&#160;a&#160;further&#160;security&#160;measure.</p>
<p style="position:absolute;top:803px;left:248px;white-space:nowrap" class="ft938">When&#160;a&#160;platform&#160;goes&#160;offline&#160;(e.g.,&#160;due&#160;to&#160;maintenance&#160;or&#160;network&#160;partition),&#160;the</p>
<p style="position:absolute;top:821px;left:226px;white-space:nowrap" class="ft9314">TVD&#160;proxy&#160;gets&#160;disconnected&#160;from&#160;the&#160;TVD&#160;master.&#160;In&#160;such&#160;cases,&#160;the&#160;disconnected<br/>TVD&#160;proxy&#160;still&#160;continues&#160;to&#160;act&#160;as&#160;the&#160;local&#160;TVD&#160;authority&#160;for&#160;the&#160;VMs&#160;belonging<br/>to&#160;the&#160;TVD.&#160;However,&#160;the&#160;TVD&#160;VPEs&#160;on&#160;the&#160;platform&#160;are&#160;disconnected&#160;from&#160;the&#160;rest<br/>of&#160;the&#160;TVD.&#160;The&#160;absence&#160;of&#160;a&#160;threshold&#160;number&#160;of&#160;status&#160;reports&#160;from&#160;the&#160;TVD&#160;proxy<br/>causes&#160;the&#160;TVD&#160;master&#160;to&#160;update&#160;its&#160;list&#160;of&#160;TVD&#160;proxies.&#160;Thereafter,&#160;when&#160;the&#160;platform<br/>comes&#160;online&#160;again,&#160;the&#160;LCTC&#160;on&#160;the&#160;platform&#160;contacts&#160;the&#160;TVD&#160;master&#160;indicating&#160;that<br/>the&#160;disconnected&#160;platform&#160;is&#160;online&#160;again&#160;and&#160;contains&#160;TVD&#160;VPEs&#160;that&#160;wish&#160;to&#160;re-<br/>connect&#160;to&#160;the&#160;rest&#160;of&#160;the&#160;TVD.&#160;That&#160;is&#160;followed&#160;by&#160;a&#160;prepare&#160;phase,&#160;similar&#160;to&#160;the&#160;one<br/>that&#160;happens&#160;prior&#160;to&#160;the&#160;creation&#160;of&#160;the&#160;TVD&#160;proxy&#160;(Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#85">7.4.2)</a>.&#160;It&#160;is&#160;necessary<br/>to&#160;re-assess&#160;the&#160;suitability&#160;of&#160;the&#160;platform&#160;for&#160;still&#160;hosting&#160;the&#160;TVD&#160;proxy&#160;through&#160;the<br/>prepare&#160;phase,&#160;because&#160;the&#160;TVD&#160;policy&#160;and&#160;the&#160;platform&#160;state&#160;may&#160;have&#160;changed&#160;in&#160;the<br/>duration&#160;when&#160;the&#160;platform&#160;was&#160;offline.&#160;After&#160;the&#160;successful&#160;completion&#160;of&#160;the&#160;prepare<br/>phase,&#160;the&#160;TVD&#160;proxy&#160;re-establishes&#160;the&#160;secure,&#160;authenticated&#160;communication&#160;channel<br/>with&#160;the&#160;TVD&#160;master.&#160;The&#160;TVD&#160;proxy&#160;obtains&#160;the&#160;updated&#160;TVD&#160;policy&#160;and&#160;other&#160;cre-<br/>dentials&#160;from&#160;the&#160;TVD&#160;master&#160;through&#160;the&#160;channel,&#160;and&#160;re-configures&#160;the&#160;networking</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft9321">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 94 -->
<a name="94"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page94-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5094.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft948">92</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft9421">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:204px;left:190px;white-space:nowrap" class="ft948">Table&#160;7.4:&#160;Examples&#160;of&#160;Security&#160;Properties&#160;used&#160;in&#160;Capability&#160;Modeling.</p>
<p style="position:absolute;top:225px;left:159px;white-space:nowrap" class="ft9423"><b>Property</b></p>
<p style="position:absolute;top:225px;left:281px;white-space:nowrap" class="ft9423"><b>Description</b></p>
<p style="position:absolute;top:244px;left:159px;white-space:nowrap" class="ft94118">TVD&#160;Isolation</p>
<p style="position:absolute;top:244px;left:281px;white-space:nowrap" class="ft94118">Flow&#160;control&#160;policies&#160;in&#160;place&#160;for&#160;a&#160;TVD.</p>
<p style="position:absolute;top:263px;left:159px;white-space:nowrap" class="ft94118">Network</p>
<p style="position:absolute;top:263px;left:281px;white-space:nowrap" class="ft94118">The&#160;actual&#160;topology&#160;of&#160;a&#160;virtual&#160;network&#160;in&#160;a&#160;physical&#160;machine.</p>
<p style="position:absolute;top:281px;left:159px;white-space:nowrap" class="ft94118">Network&#160;Policy</p>
<p style="position:absolute;top:281px;left:281px;white-space:nowrap" class="ft94119">Security&#160;policies&#160;for&#160;the&#160;network,&#160;such&#160;as&#160;firewall&#160;rules&#160;and&#160;isolation<br/>rules&#160;stating&#160;which&#160;subnets&#160;can&#160;be&#160;connected.</p>
<p style="position:absolute;top:318px;left:159px;white-space:nowrap" class="ft94118">Storage&#160;Policy</p>
<p style="position:absolute;top:318px;left:281px;white-space:nowrap" class="ft94119">Policies&#160;for&#160;storage&#160;security,&#160;such&#160;as&#160;whether&#160;the&#160;disks&#160;are&#160;encrypted&#160;and<br/>what&#160;VMs&#160;have&#160;permission&#160;to&#160;mount&#160;a&#160;particular&#160;disk.</p>
<p style="position:absolute;top:354px;left:159px;white-space:nowrap" class="ft94118">Virtual&#160;Machines</p>
<p style="position:absolute;top:354px;left:281px;white-space:nowrap" class="ft94120">The&#160;life-cycle&#160;protection&#160;mechanisms&#160;of&#160;the&#160;individual&#160;VMs,&#160;e.g.,&#160;pre-<br/>conditions&#160;for&#160;execution&#160;of&#160;a&#160;VM.</p>
<p style="position:absolute;top:391px;left:159px;white-space:nowrap" class="ft94118">Hypervisor</p>
<p style="position:absolute;top:391px;left:281px;white-space:nowrap" class="ft94118">Binary&#160;integrity&#160;of&#160;the&#160;hypervisor.</p>
<p style="position:absolute;top:409px;left:159px;white-space:nowrap" class="ft94118">Users</p>
<p style="position:absolute;top:409px;left:281px;white-space:nowrap" class="ft94119">The&#160;roles&#160;and&#160;associated&#160;users&#160;of&#160;a&#160;machine,&#160;e.g.,&#160;who&#160;can&#160;assume&#160;the<br/>role&#160;of&#160;administrator&#160;of&#160;the&#160;TVD&#160;master.</p>
<p style="position:absolute;top:478px;left:150px;white-space:nowrap" class="ft948">components&#160;according&#160;to&#160;TVD&#160;policy.</p>
<p style="position:absolute;top:524px;left:150px;white-space:nowrap" class="ft9426"><b>7.6</b></p>
<p style="position:absolute;top:524px;left:198px;white-space:nowrap" class="ft9426"><b>Implementation&#160;in&#160;Xen</b></p>
<p style="position:absolute;top:562px;left:150px;white-space:nowrap" class="ft9414">In&#160;this&#160;section,&#160;we&#160;describe&#160;a&#160;Xen-based&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[11]&#160;</a>prototype&#160;implementation&#160;of&#160;our&#160;secure<br/>virtual&#160;networking&#160;framework.&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#96">7.6&#160;</a>shows&#160;the&#160;implementation&#160;of&#160;two&#160;TVDs,</p>
<p style="position:absolute;top:597px;left:150px;white-space:nowrap" class="ft9446">T&#160;V&#160;D</p>
<p style="position:absolute;top:603px;left:185px;white-space:nowrap" class="ft9447">α</p>
<p style="position:absolute;top:598px;left:197px;white-space:nowrap" class="ft948">and</p>
<p style="position:absolute;top:597px;left:223px;white-space:nowrap" class="ft9446">T&#160;V&#160;D</p>
<p style="position:absolute;top:603px;left:258px;white-space:nowrap" class="ft9447">β</p>
<p style="position:absolute;top:598px;left:266px;white-space:nowrap" class="ft948">.&#160;The&#160;policy&#160;engine,&#160;also&#160;shown&#160;in&#160;the&#160;figure,&#160;implements&#160;the&#160;poli-</p>
<p style="position:absolute;top:616px;left:150px;white-space:nowrap" class="ft9414">cies&#160;corresponding&#160;to&#160;the&#160;TVDs&#160;specified&#160;in&#160;the&#160;information&#160;flow&#160;control&#160;matrix&#160;of&#160;Fig-<br/>ure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#85">7.2,&#160;</a>i.e.,&#160;open&#160;connection&#160;within&#160;each&#160;TVD&#160;and&#160;closed&#160;connection&#160;between</p>
<p style="position:absolute;top:633px;left:622px;white-space:nowrap" class="ft9446">T&#160;V&#160;D</p>
<p style="position:absolute;top:639px;left:657px;white-space:nowrap" class="ft9447">α</p>
<p style="position:absolute;top:652px;left:150px;white-space:nowrap" class="ft948">and</p>
<p style="position:absolute;top:651px;left:175px;white-space:nowrap" class="ft9446">T&#160;V&#160;D</p>
<p style="position:absolute;top:657px;left:210px;white-space:nowrap" class="ft9447">β</p>
<p style="position:absolute;top:652px;left:219px;white-space:nowrap" class="ft948">.</p>
<p style="position:absolute;top:693px;left:150px;white-space:nowrap" class="ft9424"><b>7.6.1</b></p>
<p style="position:absolute;top:693px;left:204px;white-space:nowrap" class="ft9424"><b>Implementation&#160;Details</b></p>
<p style="position:absolute;top:723px;left:150px;white-space:nowrap" class="ft9414">Our&#160;implementation&#160;is&#160;based&#160;on&#160;Xen-unstable&#160;3.0.4,&#160;a&#160;VMM&#160;for&#160;the&#160;IA32&#160;platform,<br/>with&#160;the&#160;VMs&#160;running&#160;the&#160;Linux&#160;2.6.18&#160;operating&#160;system.&#160;Our&#160;networking&#160;extensions<br/>are&#160;implemented&#160;as&#160;kernel&#160;modules&#160;in&#160;Dom0,&#160;which&#160;also&#160;acts&#160;as&#160;driver&#160;domain&#160;for&#160;the<br/>physical&#160;NIC(s)&#160;of&#160;each&#160;physical&#160;host.&#160;A&#160;driver&#160;domain&#160;is&#160;special&#160;in&#160;the&#160;sense&#160;that&#160;it<br/>has&#160;access&#160;to&#160;portions&#160;of&#160;the&#160;host’s&#160;physical&#160;hardware,&#160;such&#160;as&#160;a&#160;physical&#160;NIC.</p>
<p style="position:absolute;top:812px;left:172px;white-space:nowrap" class="ft948">The&#160;virtual&#160;network&#160;interface&#160;organization&#160;of&#160;Xen&#160;splits&#160;a&#160;NIC&#160;driver&#160;into&#160;two&#160;parts:</p>
<p style="position:absolute;top:830px;left:150px;white-space:nowrap" class="ft9414">a&#160;front-end&#160;driver&#160;and&#160;a&#160;back-end&#160;driver.&#160;A&#160;front-end&#160;driver&#160;is&#160;a&#160;special&#160;NIC&#160;driver&#160;that<br/>resides&#160;within&#160;the&#160;kernel&#160;of&#160;the&#160;guest&#160;OS.&#160;It&#160;is&#160;responsible&#160;for&#160;allocating&#160;a&#160;network<br/>device&#160;within&#160;the&#160;guest&#160;kernel&#160;(eth0&#160;in&#160;Dom1&#160;and&#160;Dom2&#160;of&#160;hosts&#160;A&#160;and&#160;B,&#160;shown&#160;in<br/>Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#96">7.6)</a>.&#160;The&#160;guest&#160;kernel&#160;layers&#160;its&#160;IP&#160;stack&#160;on&#160;top&#160;of&#160;that&#160;device&#160;as&#160;if&#160;it&#160;had&#160;a&#160;real<br/>Ethernet&#160;device&#160;driver&#160;to&#160;talk&#160;to.&#160;The&#160;back-end&#160;portion&#160;of&#160;the&#160;network&#160;driver&#160;resides<br/>within&#160;the&#160;kernel&#160;of&#160;a&#160;separate&#160;driver&#160;domain&#160;(Dom0&#160;in&#160;our&#160;implementation)&#160;and&#160;creates<br/>a&#160;network&#160;device&#160;within&#160;the&#160;driver&#160;domain&#160;for&#160;every&#160;front-end&#160;device&#160;in&#160;a&#160;guest&#160;domain<br/>that&#160;gets&#160;created.&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#96">7.6&#160;</a>shows&#160;two&#160;of&#160;these&#160;back-end&#160;devices,&#160;vif1.0&#160;and&#160;vif2.0,&#160;in<br/>each&#160;of&#160;the&#160;two&#160;hosts&#160;A&#160;and&#160;B.&#160;These&#160;back-end&#160;devices&#160;correspond&#160;to&#160;the&#160;eth0&#160;devices<br/>in&#160;Dom1&#160;and&#160;Dom2,&#160;respectively,&#160;in&#160;each&#160;host.</p>
<p style="position:absolute;top:1010px;left:172px;white-space:nowrap" class="ft948">Conceptually,&#160;the&#160;pair&#160;of&#160;front-end&#160;and&#160;back-end&#160;devices&#160;behaves&#160;as&#160;follows.&#160;Pack-</p>
<p style="position:absolute;top:1027px;left:150px;white-space:nowrap" class="ft9415">ets&#160;sent&#160;out&#160;by&#160;the&#160;network&#160;stack&#160;running&#160;on&#160;top&#160;of&#160;the&#160;front-end&#160;network&#160;device&#160;in&#160;the<br/>guest&#160;domain&#160;appear&#160;as&#160;packets&#160;received&#160;by&#160;the&#160;back-end&#160;network&#160;device&#160;in&#160;the&#160;driver<br/>domain.&#160;Similarly,&#160;packets&#160;sent&#160;out&#160;by&#160;the&#160;back-end&#160;network-device&#160;by&#160;the&#160;driver&#160;do-</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft9421">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 95 -->
<a name="95"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page95-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5095.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft958">CHAPTER&#160;7.&#160;SECURE&#160;VIRTUALIZED&#160;NETWORKING</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft958">93</p>
<p style="position:absolute;top:204px;left:226px;white-space:nowrap" class="ft958">Table&#160;7.5:&#160;Assurance&#160;for&#160;Past,&#160;Present,&#160;and&#160;Future&#160;States&#160;used&#160;in&#160;Capability&#160;Modeling.</p>
<p style="position:absolute;top:225px;left:235px;white-space:nowrap" class="ft9523"><b>Past&#160;State</b></p>
<p style="position:absolute;top:225px;left:357px;white-space:nowrap" class="ft9523"><b>Description</b></p>
<p style="position:absolute;top:244px;left:235px;white-space:nowrap" class="ft95118">Trust</p>
<p style="position:absolute;top:244px;left:357px;white-space:nowrap" class="ft95118">A&#160;user&#160;believes&#160;that&#160;an&#160;entity&#160;has&#160;certain&#160;security&#160;properties.</p>
<p style="position:absolute;top:262px;left:235px;white-space:nowrap" class="ft95118">Mutable&#160;Log</p>
<p style="position:absolute;top:262px;left:357px;white-space:nowrap" class="ft95119">The&#160;entity&#160;provides&#160;log-file&#160;evidence&#160;(e.g.,&#160;audits)&#160;that&#160;indicates&#160;that&#160;the<br/>platform&#160;provides&#160;certain&#160;properties.</p>
<p style="position:absolute;top:298px;left:235px;white-space:nowrap" class="ft95118">Immutable&#160;Logs</p>
<p style="position:absolute;top:298px;left:357px;white-space:nowrap" class="ft95119">The&#160;entity&#160;has&#160;immutable&#160;logging&#160;systems&#160;(e.g.,&#160;a&#160;TPM-quote&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[120]</a>)&#160;for<br/>providing&#160;evidence.&#160;Since&#160;the&#160;log&#160;cannot&#160;modified&#160;by&#160;the&#160;entity&#160;itself,<br/>the&#160;resulting&#160;assurance&#160;is&#160;stronger&#160;than&#160;when&#160;mutable&#160;logs&#160;are&#160;used.</p>
<p style="position:absolute;top:354px;left:235px;white-space:nowrap" class="ft9523"><b>Present&#160;State</b></p>
<p style="position:absolute;top:354px;left:357px;white-space:nowrap" class="ft9523"><b>Description</b></p>
<p style="position:absolute;top:374px;left:235px;white-space:nowrap" class="ft95118">Evaluations</p>
<p style="position:absolute;top:374px;left:357px;white-space:nowrap" class="ft95118">Evaluation&#160;of&#160;a&#160;given&#160;state,&#160;e.g.,&#160;Common&#160;Criteria&#160;evaluations&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[25]</a>.</p>
<p style="position:absolute;top:392px;left:235px;white-space:nowrap" class="ft95118">Introspection</p>
<p style="position:absolute;top:392px;left:357px;white-space:nowrap" class="ft95118">Introspection&#160;of&#160;a&#160;system&#160;by&#160;executing&#160;security&#160;tests,&#160;e.g.,&#160;virus&#160;scanner.</p>
<p style="position:absolute;top:412px;left:235px;white-space:nowrap" class="ft9523"><b>Future&#160;State</b></p>
<p style="position:absolute;top:412px;left:357px;white-space:nowrap" class="ft9523"><b>Description</b></p>
<p style="position:absolute;top:432px;left:235px;white-space:nowrap" class="ft95118">Policies</p>
<p style="position:absolute;top:432px;left:357px;white-space:nowrap" class="ft95119">By&#160;providing&#160;policies&#160;and&#160;evidence&#160;of&#160;their&#160;enforcement,&#160;a&#160;system&#160;can<br/>justify&#160;claims&#160;about&#160;its&#160;future&#160;behavior.&#160;e.g.,&#160;DRM&#160;policies&#160;and&#160;VM&#160;life-<br/>cycle&#160;protection&#160;policy.</p>
<p style="position:absolute;top:486px;left:235px;white-space:nowrap" class="ft95118">Audit</p>
<p style="position:absolute;top:486px;left:357px;white-space:nowrap" class="ft95119">By&#160;guaranteeing&#160;regular&#160;audits,&#160;organizations&#160;can&#160;claim&#160;that&#160;certain&#160;poli-<br/>cies&#160;will&#160;be&#160;enforced&#160;in&#160;the&#160;future.</p>
<p style="position:absolute;top:555px;left:226px;white-space:nowrap" class="ft9514">main&#160;appear&#160;to&#160;the&#160;network&#160;stack&#160;running&#160;within&#160;a&#160;guest&#160;domain&#160;as&#160;packets&#160;received&#160;by<br/>the&#160;front-end&#160;network&#160;device.&#160;In&#160;its&#160;standard&#160;configuration,&#160;Xen&#160;is&#160;configured&#160;to&#160;simply<br/>bridge&#160;the&#160;driver&#160;domain&#160;back-end&#160;devices&#160;onto&#160;the&#160;real&#160;physical&#160;NIC.&#160;By&#160;this&#160;mech-<br/>anism,&#160;packets&#160;generated&#160;by&#160;a&#160;guest&#160;domain&#160;find&#160;their&#160;way&#160;onto&#160;the&#160;physical&#160;network<br/>and&#160;packets&#160;on&#160;the&#160;physical&#160;network&#160;can&#160;be&#160;received&#160;by&#160;the&#160;guest&#160;domain.</p>
<p style="position:absolute;top:644px;left:248px;white-space:nowrap" class="ft958">The&#160;Xen&#160;configuration&#160;file&#160;is&#160;used&#160;to&#160;specify&#160;the&#160;particular&#160;vSwitch&#160;and&#160;the&#160;partic-</p>
<p style="position:absolute;top:662px;left:226px;white-space:nowrap" class="ft9515">ular&#160;port&#160;in&#160;the&#160;vSwitch&#160;to&#160;which&#160;a&#160;Xen&#160;back-end&#160;device&#160;is&#160;attached.&#160;We&#160;use&#160;additional<br/>scripts&#160;to&#160;specify&#160;whether&#160;a&#160;particular&#160;vSwitch&#160;should&#160;use&#160;one&#160;or&#160;both&#160;of&#160;VLAN&#160;tagging<br/>and&#160;encapsulation&#160;mechanisms&#160;for&#160;isolating&#160;separate&#160;virtual&#160;networks.</p>
<p style="position:absolute;top:716px;left:248px;white-space:nowrap" class="ft958">The&#160;vSwitches&#160;for</p>
<p style="position:absolute;top:715px;left:362px;white-space:nowrap" class="ft9546">T&#160;V&#160;D</p>
<p style="position:absolute;top:721px;left:398px;white-space:nowrap" class="ft9547">α</p>
<p style="position:absolute;top:716px;left:410px;white-space:nowrap" class="ft958">and</p>
<p style="position:absolute;top:715px;left:436px;white-space:nowrap" class="ft9546">T&#160;V&#160;D</p>
<p style="position:absolute;top:721px;left:471px;white-space:nowrap" class="ft9547">β</p>
<p style="position:absolute;top:716px;left:483px;white-space:nowrap" class="ft958">are&#160;each&#160;implemented&#160;in&#160;a&#160;distributed&#160;fash-</p>
<p style="position:absolute;top:734px;left:226px;white-space:nowrap" class="ft9514">ion&#160;(i.e.,&#160;spread&#160;across&#160;hosts&#160;A&#160;and&#160;B)&#160;by&#160;a&#160;kernel&#160;module&#160;in&#160;Dom0,&#160;which&#160;maintains&#160;a<br/>table&#160;mapping&#160;virtual&#160;network&#160;devices&#160;to&#160;ports&#160;on&#160;a&#160;particular&#160;vSwitch.&#160;Essentially,&#160;the<br/>kernel&#160;module&#160;implements&#160;EtherIP&#160;processing&#160;for&#160;packets&#160;coming&#160;out&#160;of&#160;and&#160;destined<br/>for&#160;the&#160;VMs.&#160;Each&#160;virtual&#160;switch&#160;(and&#160;hence&#160;VLAN&#160;segment)&#160;has&#160;a&#160;number&#160;identi-<br/>fier&#160;associated&#160;with&#160;it.&#160;The&#160;Ethernet&#160;packets&#160;sent&#160;by&#160;a&#160;VM&#160;are&#160;captured&#160;by&#160;the&#160;kernel<br/>module&#160;implementing&#160;part&#160;of&#160;the&#160;vSwitch&#160;as&#160;they&#160;are&#160;received&#160;on&#160;the&#160;corresponding<br/>back-end&#160;device&#160;in&#160;Dom0.&#160;The&#160;packets&#160;are&#160;encapsulated&#160;using&#160;EtherIP&#160;with&#160;the&#160;net-<br/>work&#160;identifier&#160;field&#160;set&#160;to&#160;match&#160;the&#160;identifier&#160;of&#160;the&#160;vSwitch&#160;that&#160;the&#160;VM&#160;is&#160;supposed<br/>to&#160;be&#160;plugged&#160;into.&#160;The&#160;EtherIP&#160;packet&#160;is&#160;given&#160;either&#160;a&#160;multicast&#160;or&#160;unicast&#160;IP&#160;address<br/>and&#160;simply&#160;fed&#160;into&#160;the&#160;Dom0&#160;IP&#160;stack&#160;for&#160;routing&#160;onto&#160;the&#160;physical&#160;network.&#160;The<br/>kernel&#160;module&#160;also&#160;receives&#160;EtherIP&#160;packets&#160;destined&#160;for&#160;the&#160;physical&#160;host.&#160;The&#160;mod-<br/>ule&#160;un-encapsulates&#160;the&#160;Ethernet&#160;frames&#160;contained&#160;in&#160;the&#160;encapsulated&#160;EtherIP&#160;packets<br/>and&#160;transmits&#160;the&#160;raw&#160;frame&#160;over&#160;the&#160;appropriate&#160;virtual&#160;network&#160;interface&#160;so&#160;that&#160;it&#160;is<br/>received&#160;by&#160;the&#160;intended&#160;guest&#160;vNIC.</p>
<p style="position:absolute;top:985px;left:248px;white-space:nowrap" class="ft958">In&#160;addition&#160;to&#160;the&#160;kernel&#160;module&#160;for&#160;EtherIP&#160;processing,&#160;we&#160;have&#160;also&#160;implemented</p>
<p style="position:absolute;top:1003px;left:226px;white-space:nowrap" class="ft9514">a&#160;kernel&#160;module&#160;for&#160;VLAN&#160;tagging&#160;in&#160;Dom0&#160;of&#160;each&#160;virtualized&#160;host.&#160;Ethernet&#160;pack-<br/>ets&#160;sent&#160;by&#160;a&#160;VM&#160;are&#160;grabbed&#160;at&#160;the&#160;same&#160;point&#160;in&#160;the&#160;Dom0&#160;network&#160;stack&#160;as&#160;in&#160;the<br/>case&#160;of&#160;EtherIP&#160;processing.&#160;However,&#160;instead&#160;of&#160;wrapping&#160;the&#160;Ethernet&#160;packets&#160;in<br/>an&#160;IP&#160;packet,&#160;the&#160;VLAN&#160;tagging&#160;module&#160;re-transmits&#160;the&#160;packets&#160;unmodified&#160;into&#160;a</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft9521">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 96 -->
<a name="96"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft96159{font-size:12px;font-family:KPSHBO+TT10D5Do00;color:#000000;}
	.ft96160{font-size:9px;font-family:KPSHBO+TT10D5Eo00;color:#000000;}
	.ft96161{font-size:6px;line-height:7px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page96-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5096.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft968">94</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft9621">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:266px;white-space:nowrap" class="ft9659"><b>Host&#160;A</b></p>
<p style="position:absolute;top:211px;left:331px;white-space:nowrap" class="ft9659"><b>Dom&#160;1</b></p>
<p style="position:absolute;top:211px;left:228px;white-space:nowrap" class="ft9659"><b>Dom&#160;0</b></p>
<p style="position:absolute;top:256px;left:257px;white-space:nowrap" class="ft96159">α</p>
<p style="position:absolute;top:258px;left:219px;white-space:nowrap" class="ft9659"><b>encap.</b></p>
<p style="position:absolute;top:265px;left:218px;white-space:nowrap" class="ft9659"><b>module</b></p>
<p style="position:absolute;top:256px;left:179px;white-space:nowrap" class="ft9659"><b>VLAN&#160;</b></p>
<p style="position:absolute;top:263px;left:178px;white-space:nowrap" class="ft96161"><b>tagging<br/>module</b></p>
<p style="position:absolute;top:228px;left:271px;white-space:nowrap" class="ft9659"><b>Policy</b></p>
<p style="position:absolute;top:235px;left:270px;white-space:nowrap" class="ft9659"><b>Engine</b></p>
<p style="position:absolute;top:246px;left:265px;white-space:nowrap" class="ft9659"><b>vSwitches</b></p>
<p style="position:absolute;top:326px;left:344px;white-space:nowrap" class="ft9659"><b>eth0</b></p>
<p style="position:absolute;top:326px;left:384px;white-space:nowrap" class="ft9659"><b>eth0</b></p>
<p style="position:absolute;top:326px;left:302px;white-space:nowrap" class="ft9659"><b>vif2.0</b></p>
<p style="position:absolute;top:327px;left:265px;white-space:nowrap" class="ft9659"><b>vif1.0</b></p>
<p style="position:absolute;top:326px;left:232px;white-space:nowrap" class="ft9659"><b>eth0</b></p>
<p style="position:absolute;top:311px;left:335px;white-space:nowrap" class="ft9659"><b>front-end&#160;devices</b></p>
<p style="position:absolute;top:303px;left:262px;white-space:nowrap" class="ft9659"><b>back-end&#160;</b></p>
<p style="position:absolute;top:310px;left:265px;white-space:nowrap" class="ft9659"><b>devices</b></p>
<p style="position:absolute;top:306px;left:231px;white-space:nowrap" class="ft96161"><b>physical<br/>NIC</b></p>
<p style="position:absolute;top:384px;left:367px;white-space:nowrap" class="ft9659"><b>VLAN-capable</b></p>
<p style="position:absolute;top:391px;left:365px;white-space:nowrap" class="ft9659"><b>physical&#160;switch</b></p>
<p style="position:absolute;top:194px;left:529px;white-space:nowrap" class="ft9659"><b>Host&#160;B</b></p>
<p style="position:absolute;top:211px;left:595px;white-space:nowrap" class="ft9659"><b>Dom&#160;1</b></p>
<p style="position:absolute;top:211px;left:492px;white-space:nowrap" class="ft9659"><b>Dom&#160;0</b></p>
<p style="position:absolute;top:256px;left:520px;white-space:nowrap" class="ft96159">α</p>
<p style="position:absolute;top:258px;left:482px;white-space:nowrap" class="ft9659"><b>encap.</b></p>
<p style="position:absolute;top:265px;left:481px;white-space:nowrap" class="ft9659"><b>module</b></p>
<p style="position:absolute;top:256px;left:443px;white-space:nowrap" class="ft9659"><b>VLAN&#160;</b></p>
<p style="position:absolute;top:263px;left:441px;white-space:nowrap" class="ft96161"><b>tagging<br/>module</b></p>
<p style="position:absolute;top:228px;left:535px;white-space:nowrap" class="ft9659"><b>Policy</b></p>
<p style="position:absolute;top:235px;left:533px;white-space:nowrap" class="ft9659"><b>Engine</b></p>
<p style="position:absolute;top:246px;left:528px;white-space:nowrap" class="ft9659"><b>vSwitches</b></p>
<p style="position:absolute;top:326px;left:607px;white-space:nowrap" class="ft9659"><b>eth0</b></p>
<p style="position:absolute;top:326px;left:647px;white-space:nowrap" class="ft9659"><b>eth0</b></p>
<p style="position:absolute;top:326px;left:566px;white-space:nowrap" class="ft9659"><b>vif2.0</b></p>
<p style="position:absolute;top:327px;left:528px;white-space:nowrap" class="ft9659"><b>vif1.0</b></p>
<p style="position:absolute;top:326px;left:495px;white-space:nowrap" class="ft9659"><b>eth0</b></p>
<p style="position:absolute;top:311px;left:599px;white-space:nowrap" class="ft9659"><b>front-end&#160;devices</b></p>
<p style="position:absolute;top:303px;left:526px;white-space:nowrap" class="ft9659"><b>back-end&#160;</b></p>
<p style="position:absolute;top:310px;left:528px;white-space:nowrap" class="ft9659"><b>devices</b></p>
<p style="position:absolute;top:306px;left:494px;white-space:nowrap" class="ft96161"><b>physical<br/>NIC</b></p>
<p style="position:absolute;top:412px;left:219px;white-space:nowrap" class="ft9659"><b>Host&#160;C</b></p>
<p style="position:absolute;top:455px;left:232px;white-space:nowrap" class="ft9659"><b>eth0</b></p>
<p style="position:absolute;top:431px;left:213px;white-space:nowrap" class="ft9659"><b>physical&#160;NIC</b></p>
<p style="position:absolute;top:438px;left:207px;white-space:nowrap" class="ft9659"><b>(VLAN&#160;un-aware)</b></p>
<p style="position:absolute;top:397px;left:300px;white-space:nowrap" class="ft9659"><b>C</b></p>
<p style="position:absolute;top:397px;left:290px;white-space:nowrap" class="ft9659"><b>A1</b></p>
<p style="position:absolute;top:397px;left:439px;white-space:nowrap" class="ft9659"><b>C</b></p>
<p style="position:absolute;top:397px;left:428px;white-space:nowrap" class="ft9659"><b>B1</b></p>
<p style="position:absolute;top:472px;left:282px;white-space:nowrap" class="ft9659"><b>C</b></p>
<p style="position:absolute;top:472px;left:272px;white-space:nowrap" class="ft9659"><b>A1</b></p>
<p style="position:absolute;top:472px;left:340px;white-space:nowrap" class="ft9659"><b>C</b></p>
<p style="position:absolute;top:472px;left:330px;white-space:nowrap" class="ft9659"><b>B1</b></p>
<p style="position:absolute;top:374px;left:299px;white-space:nowrap" class="ft9659"><b>A1</b></p>
<p style="position:absolute;top:374px;left:291px;white-space:nowrap" class="ft9659"><b>C</b></p>
<p style="position:absolute;top:374px;left:437px;white-space:nowrap" class="ft9659"><b>B1</b></p>
<p style="position:absolute;top:374px;left:430px;white-space:nowrap" class="ft9659"><b>C</b></p>
<p style="position:absolute;top:450px;left:281px;white-space:nowrap" class="ft9659"><b>A1</b></p>
<p style="position:absolute;top:450px;left:273px;white-space:nowrap" class="ft9659"><b>C</b></p>
<p style="position:absolute;top:450px;left:339px;white-space:nowrap" class="ft9659"><b>B1</b></p>
<p style="position:absolute;top:450px;left:331px;white-space:nowrap" class="ft9659"><b>C</b></p>
<p style="position:absolute;top:213px;left:635px;white-space:nowrap" class="ft9659"><b>Dom&#160;2</b></p>
<p style="position:absolute;top:213px;left:371px;white-space:nowrap" class="ft9659"><b>Dom&#160;2</b></p>
<p style="position:absolute;top:258px;left:293px;white-space:nowrap" class="ft96160">β</p>
<p style="position:absolute;top:258px;left:556px;white-space:nowrap" class="ft96160">β</p>
<p style="position:absolute;top:510px;left:264px;white-space:nowrap" class="ft968">Figure&#160;7.6:&#160;Prototype&#160;Implementation&#160;of&#160;TVDs.</p>
<p style="position:absolute;top:573px;left:150px;white-space:nowrap" class="ft968">pre-configured&#160;Linux&#160;VLAN&#160;device&#160;(eth0.</p>
<p style="position:absolute;top:572px;left:409px;white-space:nowrap" class="ft9646">α</p>
<p style="position:absolute;top:573px;left:424px;white-space:nowrap" class="ft968">and&#160;eth0.</p>
<p style="position:absolute;top:572px;left:480px;white-space:nowrap" class="ft9646">β</p>
<p style="position:absolute;top:573px;left:495px;white-space:nowrap" class="ft968">of&#160;hosts&#160;A&#160;and&#160;B,&#160;shown&#160;in</p>
<p style="position:absolute;top:591px;left:150px;white-space:nowrap" class="ft9614">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#96">7.6)&#160;</a>matching&#160;the&#160;VLAN&#160;that&#160;the&#160;VM’s&#160;vNIC&#160;is&#160;supposed&#160;to&#160;be&#160;connected&#160;to.<br/>The&#160;VLAN&#160;devic<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#96">e</a></p>
<p style="position:absolute;top:606px;left:264px;white-space:nowrap" class="ft9627"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#96">5</a></p>
<p style="position:absolute;top:609px;left:275px;white-space:nowrap" class="ft968">(provided&#160;by&#160;the&#160;standard&#160;Linux&#160;kernel&#160;VLAN&#160;support)&#160;applies</p>
<p style="position:absolute;top:627px;left:150px;white-space:nowrap" class="ft9615">the&#160;right&#160;VLAN&#160;tag&#160;to&#160;the&#160;packet&#160;before&#160;sending&#160;it&#160;out&#160;onto&#160;the&#160;physical&#160;wire&#160;through<br/>the&#160;physical&#160;NIC.&#160;The&#160;VLAN&#160;tagging&#160;module&#160;also&#160;intercepts&#160;VLAN&#160;packets&#160;arriving<br/>on&#160;the&#160;physical&#160;wire&#160;destined&#160;for&#160;a&#160;VM.&#160;The&#160;module&#160;uses&#160;the&#160;standard&#160;Linux&#160;VLAN<br/>Ethernet&#160;packet&#160;handler&#160;provided&#160;by&#160;the&#160;8021q.ko&#160;kernel&#160;module&#160;with&#160;a&#160;slight&#160;modifi-<br/>cation:&#160;the&#160;handler&#160;removes&#160;the&#160;VLAN&#160;tags&#160;and,&#160;based&#160;on&#160;the&#160;tag,&#160;maps&#160;packets&#160;to&#160;the<br/>appropriate&#160;vSwitch&#160;(</p>
<p style="position:absolute;top:715px;left:279px;white-space:nowrap" class="ft9646">α</p>
<p style="position:absolute;top:716px;left:292px;white-space:nowrap" class="ft968">or</p>
<p style="position:absolute;top:715px;left:308px;white-space:nowrap" class="ft9646">β</p>
<p style="position:absolute;top:716px;left:317px;white-space:nowrap" class="ft968">)&#160;which,&#160;in&#160;turn,&#160;maps&#160;them&#160;to&#160;the&#160;corresponding&#160;back-end</p>
<p style="position:absolute;top:734px;left:150px;white-space:nowrap" class="ft9614">device&#160;(vif1.0&#160;or&#160;vif2.0)&#160;in&#160;Dom0.&#160;The&#160;packets&#160;eventually&#160;arrive&#160;at&#160;the&#160;corresponding<br/>front-end&#160;device&#160;(eth0&#160;in&#160;Dom1&#160;or&#160;Dom2)&#160;as&#160;plain&#160;Ethernet&#160;packets.</p>
<p style="position:absolute;top:793px;left:150px;white-space:nowrap" class="ft9624"><b>7.6.2</b></p>
<p style="position:absolute;top:793px;left:204px;white-space:nowrap" class="ft9624"><b>Implementation&#160;Issues</b></p>
<p style="position:absolute;top:823px;left:150px;white-space:nowrap" class="ft9614">Below&#160;are&#160;some&#160;implementation&#160;issues&#160;we&#160;had&#160;to&#160;tackle&#160;in&#160;realizing&#160;the&#160;VLAN&#160;and<br/>encapsulation&#160;approaches.</p>
<p style="position:absolute;top:859px;left:172px;white-space:nowrap" class="ft968">(1)&#160;Some&#160;Ethernet&#160;cards&#160;offer&#160;VLAN&#160;tag&#160;filtering&#160;and&#160;tag&#160;removal/offload&#160;capa-</p>
<p style="position:absolute;top:877px;left:150px;white-space:nowrap" class="ft9614">bilities.&#160;Such&#160;capabilities&#160;are&#160;useful&#160;when&#160;running&#160;just&#160;a&#160;single&#160;kernel&#160;on&#160;a&#160;physical<br/>platform,&#160;in&#160;which&#160;case&#160;there&#160;is&#160;no&#160;need&#160;to&#160;maintain&#160;the&#160;tags&#160;for&#160;making&#160;propagation<br/>decisions.&#160;However,&#160;for&#160;our&#160;virtual&#160;networking&#160;extensions,&#160;the&#160;hardware&#160;device&#160;should<br/>not&#160;strip&#160;the&#160;tags&#160;from&#160;packets&#160;on&#160;reception&#160;over&#160;the&#160;physical&#160;wire;&#160;instead,&#160;the&#160;ker-<br/>nel&#160;modules&#160;we&#160;have&#160;implemented&#160;should&#160;decide&#160;to&#160;which&#160;VM&#160;the&#160;packets&#160;should&#160;be<br/>forwarded.&#160;For&#160;this&#160;purpose,&#160;we&#160;modified&#160;the&#160;Linux&#160;kernel&#160;tg3.ko&#160;and&#160;forcedeth.ko<br/>network&#160;drivers&#160;so&#160;as&#160;to&#160;disable&#160;VLAN&#160;offloading.</p>
<p style="position:absolute;top:1002px;left:172px;white-space:nowrap" class="ft968">(2)&#160;For&#160;efficiency&#160;reasons,&#160;the&#160;Xen&#160;front-end&#160;and&#160;back-end&#160;driver&#160;implementations</p>
<p style="position:absolute;top:1020px;left:150px;white-space:nowrap" class="ft968">avoid&#160;computing&#160;checksums&#160;between&#160;them&#160;for&#160;TCP/IP&#160;and&#160;UDP/IP&#160;packets.&#160;We&#160;mod-</p>
<p style="position:absolute;top:1047px;left:166px;white-space:nowrap" class="ft9628">5</p>
<p style="position:absolute;top:1049px;left:171px;white-space:nowrap" class="ft9619">An&#160;alternative&#160;approach,&#160;which&#160;we&#160;will&#160;implement&#160;in&#160;the&#160;future,&#160;is&#160;to&#160;directly&#160;tag&#160;the&#160;packet&#160;and&#160;send</p>
<p style="position:absolute;top:1064px;left:150px;white-space:nowrap" class="ft9619">the&#160;tagged&#160;packet&#160;straight&#160;out&#160;of&#160;the&#160;physical&#160;NIC&#160;without&#160;relying&#160;on&#160;the&#160;standard&#160;Linux&#160;VLAN&#160;devices.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft9621">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 97 -->
<a name="97"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page97-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5097.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft978">CHAPTER&#160;7.&#160;SECURE&#160;VIRTUALIZED&#160;NETWORKING</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft978">95</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft9714">ified&#160;the&#160;Xen&#160;code&#160;to&#160;also&#160;handle&#160;our&#160;EtherIP-encapsulated&#160;IP&#160;packets&#160;in&#160;a&#160;similar<br/>manner.</p>
<p style="position:absolute;top:230px;left:248px;white-space:nowrap" class="ft978">(3)&#160;The&#160;EtherIP&#160;encapsulation&#160;approach&#160;relies&#160;on&#160;mapping&#160;a&#160;virtual&#160;Ethernet&#160;broad-</p>
<p style="position:absolute;top:247px;left:226px;white-space:nowrap" class="ft9714">cast&#160;domain&#160;to&#160;a&#160;IP&#160;multicast&#160;domain.&#160;While&#160;this&#160;works&#160;in&#160;a&#160;LAN&#160;environment,&#160;we&#160;en-<br/>countered&#160;problems&#160;when&#160;creating&#160;VLAN&#160;segments&#160;that&#160;span&#160;WAN-separated&#160;physical<br/>machines.&#160;We&#160;resolved&#160;this&#160;issue&#160;by&#160;building&#160;uni-directional&#160;multicast&#160;tunnels&#160;between<br/>successive&#160;LAN&#160;segments.</p>
<p style="position:absolute;top:347px;left:226px;white-space:nowrap" class="ft9726"><b>7.7</b></p>
<p style="position:absolute;top:347px;left:275px;white-space:nowrap" class="ft9726"><b>Discussion</b></p>
<p style="position:absolute;top:385px;left:226px;white-space:nowrap" class="ft9715">In&#160;this&#160;paper,&#160;we&#160;introduced&#160;a&#160;secure&#160;virtual&#160;networking&#160;model&#160;and&#160;a&#160;framework&#160;for<br/>efficient&#160;and&#160;security-enhanced&#160;network&#160;virtualization.&#160;The&#160;key&#160;drivers&#160;of&#160;our&#160;frame-<br/>work&#160;design&#160;were&#160;the&#160;security&#160;and&#160;management&#160;objectives&#160;of&#160;virtualized&#160;data&#160;centers,<br/>which&#160;are&#160;meant&#160;to&#160;co-host&#160;IT&#160;infrastructures&#160;belonging&#160;to&#160;multiple&#160;departments&#160;of&#160;an<br/>organization&#160;or&#160;even&#160;multiple&#160;organizations.</p>
<p style="position:absolute;top:475px;left:248px;white-space:nowrap" class="ft978">Our&#160;framework&#160;utilizes&#160;a&#160;combination&#160;of&#160;existing&#160;networking&#160;technologies&#160;(such</p>
<p style="position:absolute;top:493px;left:226px;white-space:nowrap" class="ft9714">as&#160;Ethernet&#160;encapsulation,&#160;VLAN&#160;tagging,&#160;VPN,&#160;and&#160;NAC)&#160;and&#160;security&#160;policy&#160;en-<br/>forcement&#160;to&#160;concretely&#160;realize&#160;the&#160;abstraction&#160;of&#160;Trusted&#160;Virtual&#160;Domains,&#160;which&#160;can<br/>be&#160;thought&#160;of&#160;as&#160;security-enhanced&#160;variants&#160;of&#160;virtualized&#160;network&#160;zones.&#160;Policies&#160;are<br/>specified&#160;and&#160;enforced&#160;at&#160;the&#160;intra-TVD&#160;level&#160;(e.g.,&#160;membership&#160;requirements)&#160;and<br/>inter-TVD&#160;level&#160;(e.g.,&#160;information&#160;flow&#160;control).</p>
<p style="position:absolute;top:582px;left:248px;white-space:nowrap" class="ft978">Observing&#160;that&#160;manual&#160;configuration&#160;of&#160;virtual&#160;networks&#160;is&#160;usually&#160;error-prone,&#160;our</p>
<p style="position:absolute;top:600px;left:226px;white-space:nowrap" class="ft9714">design&#160;is&#160;oriented&#160;towards&#160;automation.&#160;To&#160;orchestrate&#160;the&#160;TVD&#160;configuration&#160;and&#160;de-<br/>ployment&#160;process,&#160;we&#160;introduced&#160;management&#160;entities&#160;called&#160;TVD&#160;masters.&#160;Based&#160;on<br/>the&#160;capability&#160;models&#160;of&#160;the&#160;physical&#160;infrastructure&#160;that&#160;are&#160;given&#160;as&#160;input&#160;to&#160;them,<br/>the&#160;TVD&#160;masters&#160;coordinate&#160;the&#160;set-up&#160;and&#160;population&#160;of&#160;TVDs&#160;using&#160;a&#160;well-defined<br/>protocol.</p>
<p style="position:absolute;top:690px;left:248px;white-space:nowrap" class="ft978">We&#160;described&#160;a&#160;Xen-based&#160;prototype&#160;that&#160;implements&#160;a&#160;subset&#160;of&#160;our&#160;secure&#160;net-</p>
<p style="position:absolute;top:708px;left:226px;white-space:nowrap" class="ft9714">work&#160;virtualization&#160;framework&#160;design.&#160;The&#160;performance&#160;of&#160;our&#160;virtual&#160;networking&#160;ex-<br/>tensions&#160;is&#160;comparable&#160;to&#160;the&#160;standard&#160;Xen&#160;(bridge)&#160;configuration.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft9721">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 98 -->
<a name="98"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page98-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5098.png" alt="background image"/>
<p style="position:absolute;top:295px;left:150px;white-space:nowrap" class="ft9825"><b>Chapter&#160;8</b></p>
<p style="position:absolute;top:365px;left:150px;white-space:nowrap" class="ft9822"><b>Public&#160;Key&#160;Infrastructure</b></p>
<p style="position:absolute;top:422px;left:312px;white-space:nowrap" class="ft988">P.&#160;Lipp,&#160;M.&#160;Pirker&#160;(IAIK),&#160;G.&#160;Ramunno,&#160;D.&#160;Vernizzi&#160;(POL)</p>
<p style="position:absolute;top:495px;left:150px;white-space:nowrap" class="ft9826"><b>8.1</b></p>
<p style="position:absolute;top:495px;left:198px;white-space:nowrap" class="ft9826"><b>Introduction</b></p>
<p style="position:absolute;top:533px;left:150px;white-space:nowrap" class="ft9815">This&#160;chapter&#160;outlines&#160;a&#160;basic&#160;design&#160;for&#160;integration&#160;of&#160;Trusted&#160;Computing&#160;(TC)&#160;features<br/>into&#160;a&#160;Public-Key&#160;Infrastructure&#160;(PKI).&#160;The&#160;adoption&#160;of&#160;Trusted&#160;Computing&#160;technolo-<br/>gies&#160;demands&#160;an&#160;enhancement&#160;of&#160;existing&#160;infrastructures&#160;as&#160;well&#160;as&#160;an&#160;adaption&#160;of<br/>procedures&#160;within&#160;PKIs.&#160;One&#160;can&#160;identify&#160;multiple&#160;areas&#160;where&#160;new&#160;development&#160;for<br/>Trusted&#160;Computing&#160;is&#160;needed:</p>
<p style="position:absolute;top:647px;left:172px;white-space:nowrap" class="ft9850">•</p>
<p style="position:absolute;top:648px;left:187px;white-space:nowrap" class="ft9815">First,&#160;the&#160;design&#160;of&#160;a&#160;trusted&#160;platform&#160;agent&#160;(TPA).&#160;Its&#160;task&#160;is&#160;to&#160;support&#160;initial-<br/>ising,&#160;activating&#160;and&#160;deactivating&#160;the&#160;TPM&#160;security&#160;chain&#160;under&#160;user&#160;control.&#160;It<br/>supports&#160;the&#160;most&#160;important&#160;mechanisms&#160;and&#160;services&#160;for&#160;creation&#160;(or&#160;request<br/>creation)&#160;of&#160;keys&#160;and&#160;credentials&#160;related&#160;to&#160;Trusted&#160;Computing.&#160;It&#160;is&#160;capable&#160;of<br/>communicating&#160;with&#160;network&#160;PKI&#160;services.</p>
<p style="position:absolute;top:747px;left:172px;white-space:nowrap" class="ft9850">•</p>
<p style="position:absolute;top:748px;left:187px;white-space:nowrap" class="ft9814">Further,&#160;a&#160;so&#160;called&#160;“Privacy&#160;CA”,&#160;an&#160;entity&#160;offering&#160;PKI&#160;operations&#160;(certificate<br/>issuance,&#160;validation,&#160;.&#160;.&#160;.&#160;)&#160;just&#160;like&#160;traditional&#160;certification&#160;authority&#160;services,&#160;but<br/>specialising&#160;in&#160;Trusted&#160;Computing&#160;specific&#160;tasks.&#160;This&#160;includes&#160;the&#160;handling&#160;of<br/>the&#160;TPM&#160;Attestation&#160;Identity&#160;Key&#160;credential&#160;creation&#160;cycle&#160;and&#160;managing&#160;asso-<br/>ciated&#160;request/response&#160;messages,&#160;keys&#160;and&#160;credentials.&#160;Also,&#160;offering&#160;services<br/>for&#160;determination&#160;of&#160;current&#160;status&#160;and&#160;possible&#160;re-evaluation&#160;of&#160;credentials.</p>
<p style="position:absolute;top:864px;left:172px;white-space:nowrap" class="ft9850">•</p>
<p style="position:absolute;top:865px;left:187px;white-space:nowrap" class="ft9815">As&#160;a&#160;communication&#160;protocol&#160;between&#160;local&#160;services&#160;(TPA)&#160;and&#160;network&#160;service<br/>(privacy&#160;CA)&#160;the&#160;XML&#160;Key&#160;Management&#160;Protocol&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[129]&#160;</a>is&#160;employed.&#160;It&#160;offers<br/>functionality&#160;to&#160;transport&#160;traditional&#160;PKI&#160;operations&#160;and&#160;enough&#160;flexibility&#160;for<br/>new&#160;Trusted&#160;Computing&#160;specific&#160;operations.</p>
<p style="position:absolute;top:946px;left:172px;white-space:nowrap" class="ft9850">•</p>
<p style="position:absolute;top:947px;left:187px;white-space:nowrap" class="ft9814">Advanced&#160;services&#160;are&#160;out&#160;of&#160;scope&#160;of&#160;this&#160;document,&#160;only&#160;basic&#160;services&#160;are<br/>covered&#160;here.&#160;The&#160;implementation&#160;experience&#160;of&#160;the&#160;basic&#160;services&#160;will&#160;lead<br/>to&#160;a&#160;refinement&#160;of&#160;the&#160;services&#160;design.&#160;Additional&#160;services&#160;are,&#160;e.g.,&#160;the&#160;inte-<br/>gration&#160;of&#160;Subject&#160;Key&#160;Attestation&#160;Evidence&#160;(SKAE)&#160;extension&#160;support,&#160;Direct<br/>Anonymous&#160;Attestation&#160;(DAA)&#160;as&#160;a&#160;replacement&#160;concept&#160;for&#160;the&#160;privacy&#160;CA,&#160;and<br/>automated&#160;policy&#160;checking&#160;plus&#160;validation&#160;support.&#160;Further,&#160;once&#160;the&#160;XKMS&#160;im-<br/>plementation&#160;reaches&#160;a&#160;stable&#160;state,&#160;an&#160;alternative&#160;communication&#160;protocol&#160;will<br/>be&#160;researched.</p>
<p style="position:absolute;top:1117px;left:400px;white-space:nowrap" class="ft988">96</p>
</div>
<!-- Page 99 -->
<a name="99"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page99-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5099.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft998">CHAPTER&#160;8.&#160;PUBLIC&#160;KEY&#160;INFRASTRUCTURE</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft998">97</p>
<p style="position:absolute;top:240px;left:226px;white-space:nowrap" class="ft9926"><b>8.2</b></p>
<p style="position:absolute;top:240px;left:274px;white-space:nowrap" class="ft9926"><b>Basic&#160;Trusted&#160;Computing&#160;PKI</b></p>
<p style="position:absolute;top:277px;left:226px;white-space:nowrap" class="ft9914">A&#160;public&#160;key&#160;infrastructure&#160;is&#160;a&#160;framework&#160;enabling&#160;authentication,&#160;confidentiality&#160;and<br/>integrity&#160;services&#160;using&#160;public&#160;key&#160;cryptography.&#160;It&#160;helps&#160;the&#160;users&#160;of&#160;a&#160;(public)&#160;network<br/>to,&#160;e.g.,&#160;authenticate&#160;the&#160;identity&#160;of&#160;communication&#160;partners&#160;and&#160;thus&#160;establish&#160;levels<br/>of&#160;trust&#160;and/or&#160;secure&#160;communication&#160;channels.</p>
<p style="position:absolute;top:349px;left:248px;white-space:nowrap" class="ft998">The&#160;Trusted&#160;Computing&#160;concept&#160;introduces&#160;new&#160;types&#160;of&#160;security&#160;credentials&#160;and</p>
<p style="position:absolute;top:367px;left:226px;white-space:nowrap" class="ft9914">procedures.&#160;Some&#160;fit&#160;established&#160;structures,&#160;some&#160;require&#160;small&#160;adoptions&#160;and&#160;some<br/>represent&#160;new&#160;concepts.</p>
<p style="position:absolute;top:403px;left:248px;white-space:nowrap" class="ft998">Associated&#160;with&#160;the&#160;credentials&#160;is&#160;a&#160;life&#160;cycle&#160;of&#160;introducing&#160;them&#160;to&#160;the&#160;infrastruc-</p>
<p style="position:absolute;top:421px;left:226px;white-space:nowrap" class="ft9914">ture,&#160;exchange&#160;of&#160;information&#160;between&#160;nodes&#160;in&#160;the&#160;network,&#160;(re)validation/evaluation<br/>of&#160;their&#160;information&#160;value&#160;and&#160;finally&#160;withdrawal&#160;from&#160;use.</p>
<p style="position:absolute;top:457px;left:248px;white-space:nowrap" class="ft998">The&#160;new&#160;components&#160;of&#160;a&#160;basic&#160;Trusting&#160;Computing&#160;PKI&#160;are&#160;discussed&#160;in&#160;the&#160;fol-</p>
<p style="position:absolute;top:475px;left:226px;white-space:nowrap" class="ft998">lowing&#160;sections.</p>
<p style="position:absolute;top:533px;left:226px;white-space:nowrap" class="ft9924"><b>8.2.1</b></p>
<p style="position:absolute;top:533px;left:280px;white-space:nowrap" class="ft9924"><b>EK&#160;Certificate</b></p>
<p style="position:absolute;top:563px;left:226px;white-space:nowrap" class="ft9914">Every&#160;Trusted&#160;Platform&#160;Module&#160;(TPM)&#160;is&#160;(should&#160;be)&#160;accompanied&#160;by&#160;a&#160;corresponding<br/>TPM&#160;Endorsement&#160;certificate.&#160;This&#160;certificate&#160;contains&#160;the&#160;public&#160;part&#160;of&#160;the&#160;Endorse-<br/>ment&#160;Key&#160;(EK)&#160;pair,&#160;which&#160;can&#160;be&#160;viewed&#160;as&#160;a&#160;TPM&#160;identity.&#160;The&#160;private&#160;part,&#160;called<br/>the&#160;private&#160;Endorsement&#160;Key,&#160;is&#160;stored&#160;permanently&#160;inside&#160;the&#160;TPM&#160;and&#160;can&#160;not&#160;be&#160;re-<br/>trieved&#160;once&#160;inserted.&#160;The&#160;certificate&#160;is&#160;(typically)&#160;signed&#160;by&#160;the&#160;TPM&#160;manufacturer&#160;and<br/>represents&#160;an&#160;assertion&#160;that&#160;the&#160;specific&#160;TPM&#160;conforms&#160;with&#160;the&#160;required&#160;specifications<br/>and&#160;the&#160;private&#160;Endorsement&#160;Key&#160;is&#160;kept&#160;safe&#160;by&#160;a&#160;TPM.</p>
<p style="position:absolute;top:729px;left:226px;white-space:nowrap" class="ft9923"><b>Extraction</b></p>
<p style="position:absolute;top:757px;left:226px;white-space:nowrap" class="ft9914">As&#160;per&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[116]&#160;</a>specification&#160;a&#160;distinct&#160;location&#160;of&#160;non-volatile&#160;RAM&#160;on&#160;the&#160;TPM&#160;chip<br/>is&#160;reserved&#160;for&#160;the&#160;TPM&#160;EK&#160;certificate.&#160;Further,&#160;the&#160;TPM&#160;commands&#160;to&#160;extract&#160;non-<br/>volatile&#160;memory&#160;content&#160;from&#160;the&#160;TPM&#160;are&#160;standardised.&#160;Thus,&#160;an&#160;obvious&#160;function&#160;of<br/>the&#160;TPA&#160;is&#160;to&#160;extract&#160;the&#160;EK&#160;certificate.&#160;Unfortunately,&#160;to&#160;this&#160;date&#160;the&#160;only&#160;manufac-<br/>turer&#160;to&#160;include&#160;a&#160;TPM&#160;EK&#160;certificate&#160;on&#160;chip&#160;in&#160;every&#160;shipped&#160;TPM&#160;is&#160;Infineon.</p>
<p style="position:absolute;top:886px;left:226px;white-space:nowrap" class="ft9923"><b>Creation</b></p>
<p style="position:absolute;top:914px;left:226px;white-space:nowrap" class="ft9915">If&#160;a&#160;TPM&#160;is&#160;shipped&#160;without&#160;a&#160;manufacturer&#160;issued&#160;certificate,&#160;a&#160;“late”&#160;construction&#160;of<br/>an&#160;EK&#160;certificate&#160;may&#160;be&#160;applicable&#160;in&#160;selected&#160;scenarios,&#160;e.g.,&#160;a&#160;limited&#160;deployment<br/>in&#160;a&#160;department&#160;wide&#160;setup.&#160;Tools&#160;for&#160;creation&#160;of&#160;an&#160;EK&#160;certificate,&#160;utilising&#160;the&#160;real<br/>public&#160;Endorsement&#160;Key&#160;of&#160;a&#160;TPM,&#160;are&#160;already&#160;available&#160;from&#160;OpenTC&#160;partner&#160;IAIK.<br/>Integration&#160;of&#160;this&#160;functionality&#160;into&#160;a&#160;TPA&#160;is&#160;aimed&#160;for.</p>
<p style="position:absolute;top:1004px;left:248px;white-space:nowrap" class="ft998">Who&#160;signs&#160;the&#160;TPM&#160;EK&#160;certificate&#160;and&#160;thus&#160;vouches&#160;for&#160;its&#160;integrity&#160;is&#160;of&#160;crucial</p>
<p style="position:absolute;top:1022px;left:226px;white-space:nowrap" class="ft9915">importance.&#160;In&#160;a&#160;limited&#160;deployment&#160;scenario&#160;a&#160;centralised&#160;entity&#160;can&#160;issue&#160;homegrown<br/>EK&#160;certificates&#160;as&#160;well&#160;as&#160;offer&#160;services&#160;for&#160;their&#160;validation.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft9921">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 100 -->
<a name="100"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page100-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5100.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1008">98</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft10021">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:172px;white-space:nowrap" class="ft1008">In&#160;the&#160;case&#160;of&#160;TPM&#160;vendor&#160;Infineon&#160;the&#160;necessary&#160;certificate&#160;chain&#160;for&#160;validation&#160;is</p>
<p style="position:absolute;top:212px;left:150px;white-space:nowrap" class="ft10015">freely&#160;available&#160;for&#160;download&#160;from&#160;the&#160;manufacturers&#160;homepage.&#160;In&#160;the&#160;case&#160;of&#160;a&#160;self<br/>made&#160;certificate,&#160;the&#160;signing&#160;authority&#160;certificate&#160;must&#160;be&#160;made&#160;available&#160;and&#160;accessible<br/>to&#160;a&#160;validation&#160;entity&#160;later.</p>
<p style="position:absolute;top:265px;left:172px;white-space:nowrap" class="ft1008">Note&#160;that&#160;a&#160;proof&#160;of&#160;possession&#160;of&#160;an&#160;EK&#160;private&#160;key&#160;can&#160;only&#160;be&#160;done&#160;with&#160;a&#160;full</p>
<p style="position:absolute;top:283px;left:150px;white-space:nowrap" class="ft1008">AIK&#160;cycle&#160;(see&#160;section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#101">8.2.3)</a>.&#160;This&#160;is&#160;an&#160;intentional&#160;limit&#160;of&#160;the&#160;TPM&#160;design.</p>
<p style="position:absolute;top:301px;left:172px;white-space:nowrap" class="ft1008">Note&#160;also&#160;that&#160;a&#160;TPM&#160;EK&#160;certificate&#160;is&#160;the&#160;only&#160;proof&#160;that&#160;the&#160;corresponding&#160;public</p>
<p style="position:absolute;top:319px;left:150px;white-space:nowrap" class="ft10014">Endorsement&#160;Key&#160;actually&#160;belongs&#160;to&#160;a&#160;specific&#160;type&#160;of&#160;TPM.&#160;Only&#160;a&#160;certificate&#160;signed<br/>by&#160;a&#160;manufacturer&#160;(or&#160;equivalent&#160;important&#160;entity)&#160;is&#160;proof&#160;that&#160;the&#160;referenced&#160;TPM&#160;is&#160;a<br/>hardware&#160;TPM.&#160;Self&#160;created&#160;certificates&#160;may&#160;contain&#160;an&#160;EK&#160;public&#160;key&#160;which&#160;actually<br/>belongs&#160;to&#160;a&#160;TPM&#160;software&#160;emulator&#160;(e.g.,</p>
<p style="position:absolute;top:374px;left:414px;white-space:nowrap" class="ft10034"><a href="http://tpm-emulator.berlios.de/">http://tpm-emulator.berlios.</a></p>
<p style="position:absolute;top:392px;left:150px;white-space:nowrap" class="ft10034"><a href="http://tpm-emulator.berlios.de/">de/</a></p>
<p style="position:absolute;top:391px;left:177px;white-space:nowrap" class="ft1008"><a href="http://tpm-emulator.berlios.de/">)</a></p>
<p style="position:absolute;top:448px;left:150px;white-space:nowrap" class="ft10023"><b>Validation</b></p>
<p style="position:absolute;top:476px;left:150px;white-space:nowrap" class="ft1008">Validation&#160;of&#160;an&#160;TPM&#160;EK&#160;certificate&#160;may&#160;be&#160;accomplished&#160;in&#160;multiple&#160;steps:</p>
<p style="position:absolute;top:521px;left:172px;white-space:nowrap" class="ft10050">•</p>
<p style="position:absolute;top:522px;left:187px;white-space:nowrap" class="ft10014">A&#160;local&#160;user&#160;can&#160;read&#160;the&#160;public&#160;EK&#160;key&#160;from&#160;the&#160;local&#160;TPM&#160;and&#160;compare&#160;it&#160;to&#160;the<br/>one&#160;contained&#160;in&#160;the&#160;sample&#160;TPM&#160;EK&#160;certificate.&#160;Upon&#160;match,&#160;one&#160;can&#160;assume<br/>the&#160;certificate&#160;belongs&#160;to&#160;the&#160;TPM&#160;in&#160;the&#160;local&#160;machine.</p>
<p style="position:absolute;top:586px;left:172px;white-space:nowrap" class="ft10050">•</p>
<p style="position:absolute;top:587px;left:187px;white-space:nowrap" class="ft10014">If&#160;the&#160;issuer&#160;certificate&#160;chain&#160;is&#160;locally&#160;available&#160;and&#160;the&#160;Trusted&#160;Platform&#160;Agent<br/>contains&#160;the&#160;necessary&#160;cryptographic&#160;support,&#160;a&#160;cryptographic&#160;validation&#160;of&#160;the<br/>signatures&#160;of&#160;the&#160;certificate&#160;chain&#160;is&#160;possible.</p>
<p style="position:absolute;top:651px;left:172px;white-space:nowrap" class="ft10050">•</p>
<p style="position:absolute;top:652px;left:187px;white-space:nowrap" class="ft10015">A&#160;thin&#160;TPA&#160;with&#160;minimal&#160;footprint&#160;may&#160;offload&#160;certificate&#160;verification&#160;to&#160;a&#160;remote<br/>service&#160;with&#160;more&#160;resources.&#160;In&#160;this&#160;design&#160;the&#160;usage&#160;of&#160;XKMS&#160;is&#160;suggested&#160;(see<br/>section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#109">8.4.4)</a>.</p>
<p style="position:absolute;top:712px;left:187px;white-space:nowrap" class="ft10014">Note&#160;that&#160;the&#160;“how”&#160;is&#160;not&#160;as&#160;important&#160;as&#160;the&#160;security&#160;implications&#160;of&#160;remote<br/>verification.&#160;The&#160;EK&#160;uniquely&#160;identifies&#160;the&#160;TPM,&#160;thus,&#160;every&#160;operation&#160;showing<br/>the&#160;EK&#160;to&#160;third&#160;parties&#160;must&#160;ensure&#160;that&#160;the&#160;third&#160;party&#160;can&#160;be&#160;trusted.&#160;Also,<br/>security&#160;of&#160;the&#160;communication&#160;link&#160;with&#160;the&#160;remote&#160;service&#160;has&#160;to&#160;be&#160;considered.</p>
<p style="position:absolute;top:793px;left:172px;white-space:nowrap" class="ft10050">•</p>
<p style="position:absolute;top:794px;left:187px;white-space:nowrap" class="ft10015">Full&#160;validation&#160;also&#160;requires&#160;a&#160;check&#160;with&#160;a&#160;PKI&#160;of&#160;the&#160;manufacturer&#160;of&#160;the&#160;spe-<br/>cific&#160;TPM&#160;model&#160;(or&#160;series),&#160;if&#160;there&#160;are&#160;any&#160;known&#160;conditions&#160;affecting&#160;the<br/>security&#160;of&#160;the&#160;TPM.&#160;This&#160;infrastructure&#160;is&#160;out&#160;of&#160;scope&#160;for&#160;a&#160;basic&#160;infrastructure.</p>
<p style="position:absolute;top:858px;left:150px;white-space:nowrap" class="ft1008">Revocation&#160;checking&#160;is&#160;not&#160;part&#160;of&#160;the&#160;Basic&#160;PKI.</p>
<p style="position:absolute;top:917px;left:150px;white-space:nowrap" class="ft10024"><b>8.2.2</b></p>
<p style="position:absolute;top:917px;left:204px;white-space:nowrap" class="ft10024"><b>Platform&#160;Certificate</b></p>
<p style="position:absolute;top:947px;left:150px;white-space:nowrap" class="ft10014">The&#160;platform&#160;manufacturer&#160;vouches&#160;for&#160;the&#160;parts&#160;of&#160;a&#160;platform&#160;with&#160;a&#160;Platform&#160;Endorse-<br/>ment&#160;(PE)&#160;Credential.&#160;It&#160;represents&#160;an&#160;assertion&#160;that&#160;the&#160;specific&#160;platform&#160;incorporates<br/>a&#160;properly&#160;certified&#160;TPM&#160;and&#160;the&#160;necessary&#160;infrastructure&#160;according&#160;to&#160;TCG&#160;specifi-<br/>cations.&#160;There&#160;is&#160;a&#160;requirement&#160;for&#160;a&#160;“root&#160;of&#160;trust”&#160;(CRTM)&#160;to&#160;be&#160;a&#160;starting&#160;point&#160;for<br/>building&#160;a&#160;“chain&#160;of&#160;trust”&#160;and&#160;related&#160;security&#160;measurements&#160;are&#160;implemented&#160;to&#160;check<br/>the&#160;integrity&#160;of&#160;the&#160;platform.</p>
<p style="position:absolute;top:1054px;left:172px;white-space:nowrap" class="ft1008">So&#160;far&#160;no&#160;PE&#160;certificate&#160;is&#160;known&#160;to&#160;have&#160;been&#160;regularly&#160;shipped&#160;with&#160;a&#160;platform.</p>
<p style="position:absolute;top:1072px;left:150px;white-space:nowrap" class="ft1008">However,&#160;a&#160;tool&#160;to&#160;create&#160;PE&#160;certificates&#160;is&#160;available&#160;from&#160;OpenTC&#160;partner&#160;IAIK.&#160;As&#160;the</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft10021">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 101 -->
<a name="101"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page101-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5101.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1018">CHAPTER&#160;8.&#160;PUBLIC&#160;KEY&#160;INFRASTRUCTURE</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft1018">99</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft10114">PE&#160;certificate&#160;is&#160;primarily&#160;part&#160;of&#160;the&#160;AIK&#160;cycle&#160;(see&#160;section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#101">8.2.3)&#160;</a>to&#160;be&#160;implemented<br/>for&#160;the&#160;basic&#160;PKI,&#160;the&#160;creation&#160;of&#160;a&#160;fake&#160;PE&#160;certificate&#160;with&#160;“random”&#160;values&#160;is&#160;aimed<br/>for&#160;as&#160;proof&#160;of&#160;concept.</p>
<p style="position:absolute;top:288px;left:226px;white-space:nowrap" class="ft10124"><b>8.2.3</b></p>
<p style="position:absolute;top:288px;left:280px;white-space:nowrap" class="ft10124"><b>Attestation&#160;Identity</b></p>
<p style="position:absolute;top:318px;left:226px;white-space:nowrap" class="ft10115">As&#160;the&#160;Endorsement&#160;Key&#160;uniquely&#160;identifies&#160;a&#160;TPM&#160;and&#160;hence&#160;a&#160;specific&#160;piece&#160;of&#160;sur-<br/>rounding&#160;hardware,&#160;the&#160;privacy&#160;of&#160;the&#160;user(s)&#160;is&#160;at&#160;risk&#160;if&#160;the&#160;EK&#160;is&#160;used&#160;directly&#160;for<br/>transactions.&#160;As&#160;a&#160;consequence,&#160;the&#160;TCG&#160;introduced&#160;Attestation&#160;Identity&#160;Keys&#160;(AIKs)<br/>and&#160;associated&#160;AIK&#160;certificates&#160;(standard&#160;X509&#160;Public&#160;Key&#160;Certificates&#160;that&#160;include&#160;ex-<br/>tensions&#160;defined&#160;by&#160;TCG),&#160;which&#160;cannot&#160;be&#160;backtracked&#160;directly&#160;to&#160;a&#160;specific&#160;platform.<br/>The&#160;only&#160;entity&#160;that&#160;possibly&#160;knows&#160;more&#160;details&#160;is&#160;a&#160;trusted&#160;third&#160;party&#160;that&#160;issues&#160;the<br/>AIK&#160;certificates,&#160;the&#160;so&#160;called&#160;Privacy&#160;CA.</p>
<p style="position:absolute;top:484px;left:226px;white-space:nowrap" class="ft10123"><b>AIK&#160;certificate&#160;creation&#160;cycle</b></p>
<p style="position:absolute;top:512px;left:226px;white-space:nowrap" class="ft1018">In&#160;order&#160;to&#160;create&#160;an&#160;AIK&#160;certificate&#160;the&#160;following&#160;steps&#160;are&#160;taken:</p>
<p style="position:absolute;top:558px;left:248px;white-space:nowrap" class="ft10150">•</p>
<p style="position:absolute;top:559px;left:263px;white-space:nowrap" class="ft10114">The&#160;Trusted&#160;Platform&#160;Agent&#160;(TPA,&#160;see&#160;section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#102">8.3)&#160;</a>running&#160;on&#160;a&#160;machine&#160;con-<br/>taining&#160;a&#160;TPM,&#160;calls&#160;the</p>
<p style="position:absolute;top:577px;left:407px;white-space:nowrap" class="ft10173">CollateIdentityRequest</p>
<p style="position:absolute;top:577px;left:550px;white-space:nowrap" class="ft1018">function&#160;of&#160;the&#160;Trusted&#160;Software</p>
<p style="position:absolute;top:595px;left:263px;white-space:nowrap" class="ft1018">Stack&#160;(TSS)&#160;layer.</p>
<p style="position:absolute;top:624px;left:248px;white-space:nowrap" class="ft10150">•</p>
<p style="position:absolute;top:625px;left:263px;white-space:nowrap" class="ft10115">This&#160;creates&#160;an&#160;Attestation&#160;Identity&#160;RSA&#160;key&#160;pair&#160;and&#160;a&#160;certification&#160;request&#160;in-<br/>tended&#160;for&#160;the&#160;Privacy&#160;CA.</p>
<p style="position:absolute;top:672px;left:248px;white-space:nowrap" class="ft10150">•</p>
<p style="position:absolute;top:673px;left:263px;white-space:nowrap" class="ft10114">The&#160;request&#160;is&#160;transported&#160;to&#160;the&#160;Privacy&#160;CA,&#160;using&#160;proper&#160;PKI&#160;operational&#160;pro-<br/>tocols.</p>
<p style="position:absolute;top:720px;left:248px;white-space:nowrap" class="ft10150">•</p>
<p style="position:absolute;top:721px;left:263px;white-space:nowrap" class="ft10115">The&#160;Privacy&#160;CA&#160;validates&#160;the&#160;request&#160;content&#160;(and&#160;included&#160;EK&#160;and&#160;PE&#160;certifi-<br/>cates).&#160;On&#160;success&#160;it&#160;issues&#160;an&#160;AIK&#160;certificate,&#160;encrypted&#160;with&#160;the&#160;public&#160;EK&#160;key<br/>of&#160;the&#160;TPM&#160;and&#160;thus&#160;only&#160;readable&#160;by&#160;the&#160;indented&#160;recipient.</p>
<p style="position:absolute;top:785px;left:248px;white-space:nowrap" class="ft10150">•</p>
<p style="position:absolute;top:786px;left:263px;white-space:nowrap" class="ft1018">The&#160;Privacy&#160;CA&#160;result&#160;is&#160;communicated&#160;back&#160;to&#160;the&#160;TPA.</p>
<p style="position:absolute;top:815px;left:248px;white-space:nowrap" class="ft10150">•</p>
<p style="position:absolute;top:816px;left:263px;white-space:nowrap" class="ft1018">The&#160;TPA&#160;calls&#160;the</p>
<p style="position:absolute;top:816px;left:375px;white-space:nowrap" class="ft10173">ActivateIdentity</p>
<p style="position:absolute;top:816px;left:477px;white-space:nowrap" class="ft1018">function&#160;of&#160;the&#160;Trusted&#160;Software&#160;Stack,&#160;thus</p>
<p style="position:absolute;top:834px;left:263px;white-space:nowrap" class="ft1018">unwrapping&#160;the&#160;AIK&#160;certificate.</p>
<p style="position:absolute;top:863px;left:248px;white-space:nowrap" class="ft10150">•</p>
<p style="position:absolute;top:864px;left:263px;white-space:nowrap" class="ft1018">The&#160;TPA&#160;stores&#160;the&#160;AIK&#160;certificate&#160;locally.</p>
<p style="position:absolute;top:894px;left:226px;white-space:nowrap" class="ft10115">Summarising,&#160;an&#160;activated&#160;AIK&#160;identity&#160;comprises&#160;a)&#160;an&#160;“identity”&#160;TPM&#160;keypair&#160;and<br/>b)&#160;an&#160;associated&#160;certificate&#160;proving&#160;that&#160;the&#160;keypair&#160;belongs&#160;to&#160;a&#160;“valid”&#160;TPM,&#160;vouched<br/>for&#160;by&#160;a&#160;Privacy&#160;CA&#160;entity.</p>
<p style="position:absolute;top:988px;left:226px;white-space:nowrap" class="ft10123"><b>Privacy&#160;CA</b></p>
<p style="position:absolute;top:1016px;left:226px;white-space:nowrap" class="ft10115">The&#160;role&#160;of&#160;the&#160;Privacy&#160;CA&#160;(PCA)&#160;is&#160;of&#160;being&#160;a&#160;trusted&#160;third&#160;party&#160;that&#160;works&#160;as&#160;an<br/>anonymiser.&#160;For&#160;privacy&#160;reasons&#160;the&#160;unique&#160;TPM&#160;Endorsement&#160;Key&#160;should&#160;only&#160;be<br/>shown&#160;on&#160;a&#160;“need&#160;to&#160;know&#160;basis”.&#160;In&#160;the&#160;concept&#160;of&#160;the&#160;AIK&#160;cycle&#160;(see&#160;previous<br/>section)&#160;the&#160;Privacy&#160;CA&#160;issues&#160;AIK&#160;certificates&#160;for&#160;a&#160;“derived”&#160;AIK&#160;key.&#160;This&#160;ensures</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft10121">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 102 -->
<a name="102"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page102-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5102.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1028">100</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft10221">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft10214">better&#160;anonymity&#160;of&#160;the&#160;EK&#160;key&#160;holder,&#160;but&#160;still&#160;contains&#160;proof&#160;of&#160;the&#160;underlying&#160;Trusted<br/>Computing&#160;supported&#160;hardware.</p>
<p style="position:absolute;top:230px;left:172px;white-space:nowrap" class="ft1028">Operation&#160;of&#160;a&#160;Privacy&#160;CA&#160;is&#160;guided&#160;by&#160;a&#160;published&#160;policy.&#160;It&#160;should&#160;clearly&#160;de-</p>
<p style="position:absolute;top:247px;left:150px;white-space:nowrap" class="ft10214">scribe&#160;how&#160;the&#160;relationship&#160;EK&#160;certificate&#160;versus&#160;issued&#160;AIK&#160;certificates&#160;is&#160;managed.<br/>The&#160;implementation&#160;options&#160;for&#160;a&#160;Privacy&#160;CA&#160;cover&#160;a&#160;spectrum&#160;from&#160;“remember&#160;every-<br/>thing”&#160;to&#160;“know&#160;enough&#160;for&#160;the&#160;specific&#160;operation,&#160;forget&#160;everything&#160;after&#160;completion<br/>of&#160;operation”.&#160;Thus,&#160;the&#160;usage&#160;of&#160;a&#160;specific&#160;PCA&#160;may&#160;be&#160;usage&#160;scenario&#160;dependent.</p>
<p style="position:absolute;top:319px;left:172px;white-space:nowrap" class="ft1028">Implementation&#160;of&#160;a&#160;Privacy&#160;CA&#160;covers&#160;functionality&#160;for</p>
<p style="position:absolute;top:361px;left:172px;white-space:nowrap" class="ft10250">•</p>
<p style="position:absolute;top:362px;left:187px;white-space:nowrap" class="ft10215">A&#160;network&#160;front&#160;end&#160;for&#160;receiving/sending&#160;requests/responses.&#160;The&#160;design&#160;in&#160;this<br/>document&#160;uses&#160;the&#160;XML&#160;Key&#160;Management&#160;Standard&#160;(XKMS).</p>
<p style="position:absolute;top:407px;left:172px;white-space:nowrap" class="ft10250">•</p>
<p style="position:absolute;top:408px;left:187px;white-space:nowrap" class="ft1028">A&#160;unit&#160;implementing&#160;the&#160;AIK&#160;cycle.</p>
<p style="position:absolute;top:434px;left:172px;white-space:nowrap" class="ft10250">•</p>
<p style="position:absolute;top:435px;left:187px;white-space:nowrap" class="ft10214">Local&#160;storage.&#160;The&#160;PCA&#160;handles&#160;multiple&#160;types&#160;of&#160;certificates.&#160;It&#160;receives&#160;Trusted<br/>Computing&#160;specific&#160;certificates&#160;(EK,&#160;etc.),&#160;it&#160;issues&#160;AIK&#160;certificates&#160;and&#160;needs<br/>foreign&#160;certificates&#160;for&#160;validation&#160;(e.g.,&#160;EK&#160;manufacturer&#160;certificate&#160;chain).&#160;The<br/>storage&#160;must&#160;accommodate&#160;multiple&#160;types.</p>
<p style="position:absolute;top:516px;left:172px;white-space:nowrap" class="ft10250">•</p>
<p style="position:absolute;top:517px;left:187px;white-space:nowrap" class="ft1028">A&#160;validation&#160;unit,&#160;capable&#160;of&#160;determining&#160;the&#160;status&#160;of&#160;certificates.</p>
<p style="position:absolute;top:540px;left:187px;white-space:nowrap" class="ft10215">In&#160;the&#160;easiest&#160;scenario&#160;the&#160;validation&#160;concerns&#160;self&#160;issued&#160;certificates,&#160;thus&#160;trans-<br/>forming&#160;a&#160;validation&#160;operation&#160;to&#160;a&#160;simple&#160;signature&#160;check&#160;or&#160;lookup&#160;in&#160;local<br/>storage.&#160;Further,&#160;the&#160;validation&#160;unit&#160;should&#160;be&#160;preloaded&#160;with&#160;manufacturer&#160;cer-<br/>tificate&#160;chains&#160;(e.g.,&#160;those&#160;already&#160;available&#160;from&#160;Infineon),&#160;if&#160;possible,&#160;too.</p>
<p style="position:absolute;top:616px;left:187px;white-space:nowrap" class="ft10215">The&#160;more&#160;complex&#160;case&#160;of&#160;actively&#160;contacting&#160;external&#160;entities&#160;for&#160;missing&#160;pieces<br/>required&#160;for&#160;validation&#160;is&#160;out&#160;of&#160;scope&#160;for&#160;a&#160;basic&#160;PKI.</p>
<p style="position:absolute;top:704px;left:150px;white-space:nowrap" class="ft10226"><b>8.3</b></p>
<p style="position:absolute;top:704px;left:198px;white-space:nowrap" class="ft10226"><b>Trusted&#160;Platform&#160;Agent</b></p>
<p style="position:absolute;top:742px;left:150px;white-space:nowrap" class="ft10215">A&#160;PKI&#160;requires&#160;both&#160;server&#160;side&#160;components,&#160;such&#160;as&#160;certificate&#160;authorities,&#160;as&#160;well&#160;as<br/>client&#160;side&#160;applications&#160;that&#160;provide&#160;access&#160;to&#160;PKI&#160;services.&#160;In&#160;the&#160;context&#160;of&#160;Trusted<br/>Computing&#160;such&#160;a&#160;client&#160;application&#160;is&#160;referred&#160;to&#160;as&#160;the&#160;<i>Trusted&#160;Platform&#160;Agent&#160;</i>(TPA).<br/>For&#160;wide&#160;user&#160;acceptance&#160;it&#160;is&#160;crucial&#160;that&#160;the&#160;TPA&#160;makes&#160;all&#160;Trusted&#160;Computing&#160;re-<br/>lated&#160;functionality&#160;available&#160;in&#160;a&#160;consistent&#160;and&#160;user-friendly&#160;way.&#160;Ideally,&#160;the&#160;TPA<br/>is&#160;designed&#160;and&#160;implemented&#160;in&#160;a&#160;modular&#160;way&#160;that&#160;provides&#160;an&#160;easy&#160;integration&#160;of<br/>additional&#160;advanced&#160;services&#160;later&#160;on.&#160;Furthermore,&#160;in&#160;terms&#160;of&#160;user&#160;friendliness&#160;the<br/>TPA&#160;is&#160;expected&#160;to&#160;provide&#160;an&#160;abstraction&#160;of&#160;the&#160;underlying&#160;system&#160;concepts&#160;that&#160;is<br/>understandable&#160;and&#160;manageable&#160;for&#160;an&#160;average&#160;user:&#160;for&#160;this&#160;purpose&#160;a&#160;simple&#160;API&#160;is<br/>provided&#160;as&#160;well&#160;as&#160;console&#160;commands&#160;running&#160;on&#160;top&#160;of&#160;it.&#160;The&#160;TPA&#160;largely&#160;relies<br/>on&#160;the&#160;services&#160;provided&#160;by&#160;the&#160;TSS&#160;stack.&#160;The&#160;overall&#160;architecture&#160;design&#160;of&#160;the&#160;TPA<br/>and&#160;the&#160;individual&#160;system&#160;layers&#160;is&#160;presented&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#103">8.1.&#160;</a>Dark&#160;grey&#160;boxes&#160;represent<br/>components&#160;that&#160;will&#160;be&#160;possibly&#160;developed&#160;for&#160;the&#160;Advanced&#160;PKI.</p>
<p style="position:absolute;top:975px;left:172px;white-space:nowrap" class="ft1028">The&#160;initial&#160;basic&#160;core&#160;functionalities&#160;provided&#160;by&#160;TPA&#160;fall&#160;in&#160;the&#160;following&#160;cate-</p>
<p style="position:absolute;top:993px;left:150px;white-space:nowrap" class="ft1028">gories:</p>
<p style="position:absolute;top:1035px;left:172px;white-space:nowrap" class="ft10250">•</p>
<p style="position:absolute;top:1036px;left:187px;white-space:nowrap" class="ft1028">TPM&#160;and&#160;platform&#160;management.&#160;This&#160;category&#160;includes&#160;operations&#160;such&#160;as</p>
<p style="position:absolute;top:1054px;left:187px;white-space:nowrap" class="ft10273">TakeOwnership</p>
<p style="position:absolute;top:1054px;left:282px;white-space:nowrap" class="ft1028">,&#160;enabling&#160;and&#160;disabling&#160;the&#160;TPM&#160;and&#160;reading&#160;TPM&#160;status&#160;in-</p>
<p style="position:absolute;top:1072px;left:187px;white-space:nowrap" class="ft1028">formation.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft10221">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 103 -->
<a name="103"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft103162{font-size:6px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page103-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5103.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1038">CHAPTER&#160;8.&#160;PUBLIC&#160;KEY&#160;INFRASTRUCTURE</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1038">101</p>
<p style="position:absolute;top:361px;left:385px;white-space:nowrap" class="ft10358">(hardware or software) TPM</p>
<p style="position:absolute;top:335px;left:399px;white-space:nowrap" class="ft10358">TPM Device Driver</p>
<p style="position:absolute;top:297px;left:412px;white-space:nowrap" class="ft10358">TSS Stack</p>
<p style="position:absolute;top:250px;left:544px;white-space:nowrap" class="ft103162">SKAE</p>
<p style="position:absolute;top:258px;left:543px;white-space:nowrap" class="ft103162">parser</p>
<p style="position:absolute;top:261px;left:597px;white-space:nowrap" class="ft103149">DAA</p>
<p style="position:absolute;top:268px;left:593px;white-space:nowrap" class="ft103149">wrapper</p>
<p style="position:absolute;top:243px;left:362px;white-space:nowrap" class="ft103162">TPM</p>
<p style="position:absolute;top:251px;left:350px;white-space:nowrap" class="ft103162">management&#160;</p>
<p style="position:absolute;top:260px;left:351px;white-space:nowrap" class="ft103162">and reporting</p>
<p style="position:absolute;top:249px;left:277px;white-space:nowrap" class="ft103162">CA and PCA</p>
<p style="position:absolute;top:257px;left:282px;white-space:nowrap" class="ft103162">interface</p>
<p style="position:absolute;top:249px;left:475px;white-space:nowrap" class="ft103162">Other service</p>
<p style="position:absolute;top:257px;left:481px;white-space:nowrap" class="ft103162">modules</p>
<p style="position:absolute;top:288px;left:596px;white-space:nowrap" class="ft103162">DAA</p>
<p style="position:absolute;top:296px;left:591px;white-space:nowrap" class="ft103162">functions</p>
<p style="position:absolute;top:308px;left:669px;white-space:nowrap" class="ft10358">User space</p>
<p style="position:absolute;top:333px;left:669px;white-space:nowrap" class="ft10358">Kernel space</p>
<p style="position:absolute;top:242px;left:597px;white-space:nowrap" class="ft103149">DAA</p>
<p style="position:absolute;top:249px;left:589px;white-space:nowrap" class="ft103149">platform role</p>
<p style="position:absolute;top:249px;left:423px;white-space:nowrap" class="ft103162">Local</p>
<p style="position:absolute;top:258px;left:420px;white-space:nowrap" class="ft103162">storage</p>
<p style="position:absolute;top:202px;left:501px;white-space:nowrap" class="ft103162">TPA console utilities</p>
<p style="position:absolute;top:224px;left:432px;white-space:nowrap" class="ft103162">TPA API</p>
<p style="position:absolute;top:221px;left:686px;white-space:nowrap" class="ft10358">Trusted Platform</p>
<p style="position:absolute;top:241px;left:691px;white-space:nowrap" class="ft10358">&#160;Agent (TPA)</p>
<p style="position:absolute;top:400px;left:291px;white-space:nowrap" class="ft1038">Figure&#160;8.1:&#160;Trusted&#160;Platform&#160;Agent&#160;(TPA)&#160;and&#160;underlying&#160;layers</p>
<p style="position:absolute;top:447px;left:248px;white-space:nowrap" class="ft10350">•</p>
<p style="position:absolute;top:448px;left:263px;white-space:nowrap" class="ft10315">TC&#160;credentials&#160;management.&#160;This&#160;category&#160;includes&#160;operations&#160;needed&#160;to&#160;man-<br/>age&#160;the&#160;life&#160;cycle&#160;of&#160;TC&#160;credentials&#160;(EK,&#160;PE,&#160;and&#160;AIK&#160;certificates)&#160;by&#160;interacting<br/>with&#160;TC-enabled&#160;authorities.&#160;The&#160;TPA&#160;and&#160;the&#160;latter&#160;communicate&#160;through&#160;net-<br/>work&#160;protocols,&#160;XKMS&#160;will&#160;be&#160;used&#160;for&#160;the&#160;first&#160;prototype&#160;(required&#160;extensions<br/>will&#160;be&#160;developed&#160;as&#160;needed)</p>
<p style="position:absolute;top:549px;left:281px;white-space:nowrap" class="ft10323"><b>–&#160;</b>EK&#160;certificate:&#160;extraction,&#160;creation,&#160;validation</p>
<p style="position:absolute;top:573px;left:281px;white-space:nowrap" class="ft10323"><b>–&#160;</b>Platform&#160;certificate:&#160;creation,&#160;validation</p>
<p style="position:absolute;top:597px;left:281px;white-space:nowrap" class="ft10323"><b>–&#160;</b>AIK&#160;certificate:&#160;creation,&#160;validation,&#160;reissue,&#160;revocation</p>
<p style="position:absolute;top:626px;left:248px;white-space:nowrap" class="ft10350">•</p>
<p style="position:absolute;top:627px;left:263px;white-space:nowrap" class="ft10315">Light&#160;support&#160;for&#160;standard&#160;X.509&#160;credentials.&#160;A&#160;simplified&#160;support&#160;to&#160;request&#160;a<br/>standard&#160;X.509&#160;certificate&#160;is&#160;provided:&#160;it&#160;is&#160;possible&#160;to&#160;manage&#160;certificate&#160;with<br/>standard&#160;profiles&#160;using&#160;the&#160;TC-enabled&#160;PKI.&#160;This&#160;support&#160;does&#160;not&#160;include&#160;the<br/>interaction&#160;with&#160;standard&#160;PKI&#160;authorities;&#160;however&#160;the&#160;interoperability&#160;of&#160;the<br/>issued&#160;certificates&#160;with&#160;existing&#160;standard&#160;PKIs&#160;is&#160;guaranteed.</p>
<p style="position:absolute;top:728px;left:248px;white-space:nowrap" class="ft10350">•</p>
<p style="position:absolute;top:729px;left:263px;white-space:nowrap" class="ft1038">Local&#160;storage&#160;for&#160;TC-related&#160;and&#160;standard&#160;keys&#160;and&#160;certificates</p>
<p style="position:absolute;top:758px;left:248px;white-space:nowrap" class="ft10350">•</p>
<p style="position:absolute;top:759px;left:263px;white-space:nowrap" class="ft10314">Integrity&#160;measurement&#160;and&#160;reporting.&#160;This&#160;category&#160;includes&#160;the&#160;following&#160;TPM<br/>operations:&#160;extending&#160;PCRs,&#160;reading&#160;PCRs,&#160;activating&#160;identities&#160;(i.e.,&#160;AIK&#160;cer-<br/>tificates)&#160;and&#160;TPM&#160;quote&#160;operation.</p>
<p style="position:absolute;top:823px;left:248px;white-space:nowrap" class="ft10350">•</p>
<p style="position:absolute;top:824px;left:263px;white-space:nowrap" class="ft1038">API&#160;to&#160;access&#160;all&#160;functionalities&#160;provided&#160;by&#160;TPA.</p>
<p style="position:absolute;top:854px;left:226px;white-space:nowrap" class="ft10315">In&#160;addition,&#160;the&#160;TPA&#160;can&#160;also&#160;act&#160;as&#160;an&#160;integration&#160;point&#160;for&#160;a&#160;number&#160;of&#160;other&#160;services&#160;in<br/>the&#160;context&#160;of&#160;Trusted&#160;Computing.&#160;The&#160;main&#160;benefit&#160;of&#160;this&#160;approach&#160;for&#160;the&#160;user&#160;is&#160;that<br/>all&#160;Trusted&#160;Computing&#160;related&#160;tasks&#160;can&#160;be&#160;done&#160;from&#160;a&#160;single&#160;point,&#160;the&#160;TPA.&#160;Adding<br/>additional&#160;services&#160;is&#160;facilitated&#160;by&#160;the&#160;modular&#160;nature&#160;of&#160;the&#160;TPA.&#160;These&#160;additional<br/>services&#160;might&#160;include&#160;(but&#160;are&#160;not&#160;limited&#160;to):</p>
<p style="position:absolute;top:973px;left:248px;white-space:nowrap" class="ft10350">•</p>
<p style="position:absolute;top:974px;left:263px;white-space:nowrap" class="ft10314">Management&#160;of&#160;the&#160;DAA&#160;communications&#160;among&#160;the&#160;different&#160;roles&#160;(Trusted<br/>Platform,&#160;Issuer&#160;and&#160;Verifier)</p>
<p style="position:absolute;top:1022px;left:281px;white-space:nowrap" class="ft10323"><b>–&#160;</b>Standard&#160;formats&#160;for&#160;the&#160;exchanged&#160;DAA&#160;data&#160;and&#160;messages&#160;for&#160;using</p>
<p style="position:absolute;top:1040px;left:296px;white-space:nowrap" class="ft1038">DAA&#160;as&#160;a&#160;standalone&#160;protocol&#160;or&#160;integrated&#160;within&#160;other&#160;protocols</p>
<p style="position:absolute;top:1063px;left:281px;white-space:nowrap" class="ft10323"><b>–&#160;</b>A&#160;network&#160;protocol&#160;for&#160;using&#160;the&#160;DAA&#160;as&#160;a&#160;standalone&#160;application&#160;protocol</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft10321">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 104 -->
<a name="104"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft104163{font-size:15px;font-family:Times;color:#007f00;}
	.ft104164{font-size:15px;font-family:KCVLUL+CMSY10;color:#007f00;}
-->
</style>
<div id="page104-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5104.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1048">102</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft10421">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:193px;left:172px;white-space:nowrap" class="ft10450">•</p>
<p style="position:absolute;top:194px;left:187px;white-space:nowrap" class="ft10440">Support&#160;for&#160;another&#160;TC-PKI&#160;operational&#160;protocol&#160;like&#160;<i>Certificate&#160;Management<br/>Messages&#160;over&#160;CMS&#160;</i>(CMC)&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[51]&#160;</a>in&#160;addition&#160;to&#160;XKMS.</p>
<p style="position:absolute;top:240px;left:172px;white-space:nowrap" class="ft10450">•</p>
<p style="position:absolute;top:241px;left:187px;white-space:nowrap" class="ft10414">Support&#160;for&#160;the&#160;Subject&#160;Key&#160;Attestation&#160;Evidence&#160;(SKAE)&#160;extension&#160;for&#160;X.509<br/>credentials.</p>
<p style="position:absolute;top:288px;left:172px;white-space:nowrap" class="ft10450">•</p>
<p style="position:absolute;top:289px;left:187px;white-space:nowrap" class="ft1048">A&#160;front&#160;end&#160;for&#160;key&#160;backup&#160;and&#160;key&#160;migration.</p>
<p style="position:absolute;top:318px;left:172px;white-space:nowrap" class="ft10450">•</p>
<p style="position:absolute;top:319px;left:187px;white-space:nowrap" class="ft1048">A&#160;user&#160;and&#160;policy&#160;management&#160;framework.</p>
<p style="position:absolute;top:395px;left:150px;white-space:nowrap" class="ft10426"><b>8.4</b></p>
<p style="position:absolute;top:395px;left:198px;white-space:nowrap" class="ft10426"><b>XKMS&#160;mapping</b></p>
<p style="position:absolute;top:433px;left:150px;white-space:nowrap" class="ft10415">A&#160;public&#160;key&#160;infrastructure&#160;integrates&#160;multiple&#160;actors&#160;–&#160;clients,&#160;certification&#160;authorities<br/>and&#160;specialised&#160;services.&#160;Over&#160;the&#160;years&#160;multiple&#160;protocols&#160;were&#160;developed&#160;in&#160;the&#160;area<br/>of&#160;PKI&#160;and&#160;credential&#160;management.&#160;For&#160;Trusted&#160;Computing&#160;it&#160;is&#160;necessary&#160;to&#160;carry<br/>traditional&#160;PKI&#160;services&#160;as&#160;well&#160;as&#160;TC&#160;specific&#160;attributes,&#160;queries&#160;and&#160;data&#160;blobs.</p>
<p style="position:absolute;top:505px;left:172px;white-space:nowrap" class="ft1048">XML&#160;Key&#160;Management&#160;Services&#160;(XKMS)&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[129]</a>)&#160;is&#160;chosen&#160;for&#160;a&#160;first&#160;basic&#160;Trusted</p>
<p style="position:absolute;top:523px;left:150px;white-space:nowrap" class="ft10415">Computing&#160;enabled&#160;PKI&#160;setup,&#160;which&#160;is&#160;in&#160;line&#160;with&#160;the&#160;considerations&#160;of&#160;the&#160;TCG&#160;in<br/><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[111]&#160;</a>(chap.&#160;6.5.2/p.43)&#160;and&#160;their&#160;recommendation:</p>
<p style="position:absolute;top:558px;left:172px;white-space:nowrap" class="ft10420"><i>“XKMS&#160;provides&#160;a&#160;way&#160;to&#160;express&#160;certificate&#160;management&#160;function&#160;in&#160;XML,&#160;while</i></p>
<p style="position:absolute;top:576px;left:150px;white-space:nowrap" class="ft10440"><i>providing&#160;a&#160;wrapper&#160;over&#160;legacy&#160;CA&#160;services&#160;designed&#160;for&#160;X.509&#160;certificates.&#160;As&#160;such,<br/>XKMS&#160;provides&#160;the&#160;most&#160;attractive&#160;solution&#160;for&#160;credential&#160;management&#160;for&#160;existing<br/>CAs&#160;in&#160;the&#160;PKI&#160;industry.”</i></p>
<p style="position:absolute;top:630px;left:172px;white-space:nowrap" class="ft1048">XKMS&#160;supports&#160;four&#160;standard&#160;registration&#160;service&#160;functions:&#160;Register,&#160;Recover,</p>
<p style="position:absolute;top:648px;left:150px;white-space:nowrap" class="ft10414">Reissue&#160;and&#160;Revoke.&#160;These&#160;offer&#160;a&#160;wide&#160;range&#160;of&#160;parameters&#160;and&#160;thus&#160;cover&#160;the&#160;whole<br/>life&#160;cycle&#160;support&#160;of&#160;credentials.</p>
<p style="position:absolute;top:684px;left:172px;white-space:nowrap" class="ft1048">Further,&#160;two&#160;key&#160;information&#160;service&#160;functions,&#160;Locate&#160;and&#160;Validate,&#160;provide&#160;search</p>
<p style="position:absolute;top:702px;left:150px;white-space:nowrap" class="ft1048">and&#160;status&#160;query&#160;functionality&#160;about&#160;credentials&#160;deployed&#160;in&#160;the&#160;PKI.</p>
<p style="position:absolute;top:720px;left:172px;white-space:nowrap" class="ft1048">Considering&#160;the&#160;PKI&#160;components&#160;outlined&#160;in&#160;section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#99">8.2&#160;</a>and&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#102">8.3,&#160;</a>in&#160;the&#160;following</p>
<p style="position:absolute;top:738px;left:150px;white-space:nowrap" class="ft10414">sections&#160;a&#160;mapping&#160;of&#160;PKI&#160;operations&#160;to&#160;XKMS&#160;specific&#160;requests&#160;and&#160;responses&#160;is<br/>established&#160;and&#160;interaction&#160;with&#160;Trusted&#160;Computing&#160;usage&#160;discussed.</p>
<p style="position:absolute;top:814px;left:150px;white-space:nowrap" class="ft10424"><b>8.4.1</b></p>
<p style="position:absolute;top:814px;left:204px;white-space:nowrap" class="ft10424"><b>Message&#160;Structure</b></p>
<p style="position:absolute;top:844px;left:150px;white-space:nowrap" class="ft10414">XKMS&#160;is&#160;an&#160;XML&#160;based&#160;protocol&#160;for&#160;common&#160;PKI&#160;operations.&#160;The&#160;revised&#160;edition&#160;2.0<br/>of&#160;XKMS&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[129]&#160;</a>reached&#160;recommendation&#160;status&#160;in&#160;June&#160;2005.&#160;In&#160;order&#160;to&#160;reduce&#160;du-<br/>plicate&#160;descriptions&#160;in&#160;the&#160;following&#160;sections,&#160;the&#160;common&#160;XML&#160;structures&#160;of&#160;a&#160;typical<br/>XKMS&#160;request&#160;and&#160;response&#160;message&#160;are&#160;discussed.</p>
<p style="position:absolute;top:956px;left:150px;white-space:nowrap" class="ft10423"><b>Request</b></p>
<p style="position:absolute;top:984px;left:150px;white-space:nowrap" class="ft1048">The&#160;following&#160;block&#160;outlines&#160;the&#160;structure&#160;of&#160;a&#160;typical&#160;XKMS&#160;request:</p>
<p style="position:absolute;top:1016px;left:150px;white-space:nowrap" class="ft1048">&lt;&#160;?&#160;<b>xml&#160;v&#160;e&#160;r&#160;s&#160;i&#160;o&#160;n&#160;</b>=</p>
<p style="position:absolute;top:1016px;left:277px;white-space:nowrap" class="ft104163"><i>&#34;&#160;1&#160;.&#160;0&#160;&#34;</i></p>
<p style="position:absolute;top:1016px;left:331px;white-space:nowrap" class="ft1048">e&#160;n&#160;c&#160;o&#160;d&#160;i&#160;n&#160;g&#160;=</p>
<p style="position:absolute;top:1016px;left:411px;white-space:nowrap" class="ft104163"><i>&#34;UTF</i></p>
<p style="position:absolute;top:1015px;left:445px;white-space:nowrap" class="ft104164">−</p>
<p style="position:absolute;top:1016px;left:457px;white-space:nowrap" class="ft104163"><i>8&#34;</i></p>
<p style="position:absolute;top:1016px;left:474px;white-space:nowrap" class="ft1048">?&#160;&gt;</p>
<p style="position:absolute;top:1034px;left:150px;white-space:nowrap" class="ft1048">&lt;&#160;.&#160;.&#160;.&#160;<b>R&#160;e&#160;q&#160;u&#160;e&#160;s&#160;t&#160;</b>x&#160;m&#160;l&#160;n&#160;s=</p>
<p style="position:absolute;top:1034px;left:312px;white-space:nowrap" class="ft104163"><i>&#34;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www&#160;.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;2&#160;/&#160;0&#160;3&#160;/&#160;xkms&#160;#&#160;&#34;</i></p>
<p style="position:absolute;top:1052px;left:170px;white-space:nowrap" class="ft1048">x&#160;m&#160;l&#160;n&#160;s&#160;:&#160;d&#160;s&#160;=</p>
<p style="position:absolute;top:1052px;left:250px;white-space:nowrap" class="ft104163"><i>&#34;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www&#160;.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;0&#160;/&#160;0&#160;9&#160;/&#160;x&#160;m&#160;l&#160;d&#160;s&#160;i&#160;g&#160;#&#160;&#34;</i></p>
<p style="position:absolute;top:1070px;left:170px;white-space:nowrap" class="ft1048">x&#160;m&#160;l&#160;n&#160;s&#160;:&#160;x&#160;e&#160;n&#160;c&#160;=</p>
<p style="position:absolute;top:1070px;left:268px;white-space:nowrap" class="ft104163"><i>&#34;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www&#160;.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;1&#160;/&#160;0&#160;4&#160;/&#160;x&#160;m&#160;l&#160;e&#160;n&#160;c&#160;#&#160;&#34;</i></p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft10421">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 105 -->
<a name="105"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page105-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5105.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1058">CHAPTER&#160;8.&#160;PUBLIC&#160;KEY&#160;INFRASTRUCTURE</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1058">103</p>
<p style="position:absolute;top:194px;left:246px;white-space:nowrap" class="ft1058">I&#160;d&#160;=</p>
<p style="position:absolute;top:194px;left:272px;white-space:nowrap" class="ft105163"><i>&#34;&#160;.&#160;.&#160;.&#160;&#34;</i></p>
<p style="position:absolute;top:212px;left:246px;white-space:nowrap" class="ft1058">S&#160;e&#160;r&#160;v&#160;i&#160;c&#160;e&#160;=</p>
<p style="position:absolute;top:212px;left:317px;white-space:nowrap" class="ft105163"><i>&#34;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;o&#160;p&#160;e&#160;n&#160;t&#160;c&#160;.&#160;i&#160;a&#160;i&#160;k&#160;.&#160;t&#160;u&#160;g&#160;r&#160;a&#160;z&#160;.&#160;a&#160;t&#160;/&#160;xkms&#160;/&#160;.&#160;.&#160;.&#160;&#34;</i></p>
<p style="position:absolute;top:212px;left:666px;white-space:nowrap" class="ft1058">&gt;</p>
<p style="position:absolute;top:230px;left:248px;white-space:nowrap" class="ft1058">.&#160;.&#160;.&#160;p&#160;a&#160;y&#160;l&#160;o&#160;a&#160;d&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:247px;left:244px;white-space:nowrap" class="ft1058">&lt;&#160;<b>A&#160;u&#160;t&#160;h&#160;e&#160;n&#160;t&#160;i&#160;c&#160;a&#160;t&#160;i&#160;o&#160;n&#160;</b>&gt;</p>
<p style="position:absolute;top:265px;left:266px;white-space:nowrap" class="ft1058">.&#160;.&#160;.</p>
<p style="position:absolute;top:283px;left:244px;white-space:nowrap" class="ft1058">&lt;&#160;/&#160;<b>A&#160;u&#160;t&#160;h&#160;e&#160;n&#160;t&#160;i&#160;c&#160;a&#160;t&#160;i&#160;o&#160;n&#160;</b>&gt;</p>
<p style="position:absolute;top:301px;left:226px;white-space:nowrap" class="ft1058">&lt;&#160;/&#160;.&#160;.&#160;.&#160;<b>R&#160;e&#160;q&#160;u&#160;e&#160;s&#160;t&#160;</b>&gt;</p>
<p style="position:absolute;top:337px;left:226px;white-space:nowrap" class="ft1058">The&#160;XML&#160;tag&#160;name&#160;of&#160;an&#160;XKMS&#160;request&#160;message&#160;always&#160;ends&#160;in</p>
<p style="position:absolute;top:338px;left:629px;white-space:nowrap" class="ft10534">Request</p>
<p style="position:absolute;top:337px;left:692px;white-space:nowrap" class="ft1058">.&#160;Exam-</p>
<p style="position:absolute;top:355px;left:226px;white-space:nowrap" class="ft1058">ple&#160;tag&#160;names&#160;are</p>
<p style="position:absolute;top:355px;left:337px;white-space:nowrap" class="ft10534">LocateRequest</p>
<p style="position:absolute;top:355px;left:454px;white-space:nowrap" class="ft1058">,</p>
<p style="position:absolute;top:355px;left:462px;white-space:nowrap" class="ft10534">ValidateRequest</p>
<p style="position:absolute;top:355px;left:597px;white-space:nowrap" class="ft1058">,&#160;etc.&#160;The&#160;XKMS&#160;XML</p>
<p style="position:absolute;top:373px;left:226px;white-space:nowrap" class="ft10514">schema&#160;includes&#160;the&#160;schemata&#160;of&#160;the&#160;XML&#160;digital&#160;signature&#160;standard&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[130]&#160;</a>as&#160;well<br/>as&#160;the&#160;XML&#160;encryption&#160;standard&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[131]</a>.&#160;A&#160;good&#160;solution&#160;is&#160;to&#160;assign&#160;the&#160;default&#160;XML<br/>namespace&#160;to&#160;XKMS&#160;and&#160;assign&#160;easy&#160;recognisable&#160;prefixes&#160;for&#160;the&#160;inclusions,&#160;as&#160;shown<br/>above.</p>
<p style="position:absolute;top:444px;left:248px;white-space:nowrap" class="ft1058">Every&#160;XKMS&#160;message&#160;must&#160;carry&#160;a&#160;unique</p>
<p style="position:absolute;top:445px;left:505px;white-space:nowrap" class="ft10534">Id</p>
<p style="position:absolute;top:444px;left:526px;white-space:nowrap" class="ft1058">identifier&#160;generated&#160;by&#160;the&#160;originator</p>
<p style="position:absolute;top:462px;left:226px;white-space:nowrap" class="ft10514">of&#160;the&#160;message.&#160;Typically&#160;this&#160;is&#160;a&#160;random&#160;string&#160;of&#160;at&#160;minimum&#160;32&#160;characters&#160;(to<br/>provide&#160;sufficient&#160;entropy&#160;against&#160;attacks).</p>
<p style="position:absolute;top:498px;left:248px;white-space:nowrap" class="ft1058">The</p>
<p style="position:absolute;top:499px;left:276px;white-space:nowrap" class="ft10534">Service</p>
<p style="position:absolute;top:498px;left:344px;white-space:nowrap" class="ft1058">attribute&#160;contains&#160;the&#160;URI&#160;of&#160;the&#160;network&#160;service&#160;endpoint.&#160;For&#160;a</p>
<p style="position:absolute;top:516px;left:226px;white-space:nowrap" class="ft10515">basic&#160;PKI&#160;infrastructure&#160;the&#160;HTTP&#160;protocol&#160;is&#160;sufficient&#160;as&#160;transport&#160;medium.&#160;Thus,&#160;a<br/>XKMS&#160;request&#160;is&#160;mapped&#160;to&#160;a&#160;HTTP&#160;POST&#160;operation:</p>
<p style="position:absolute;top:566px;left:226px;white-space:nowrap" class="ft1058">POST&#160;/&#160;xkms&#160;/&#160;.&#160;.&#160;.&#160;HTTP&#160;/&#160;1&#160;.&#160;0</p>
<p style="position:absolute;top:584px;left:228px;white-space:nowrap" class="ft1058">C&#160;o&#160;n&#160;t&#160;e&#160;n&#160;t</p>
<p style="position:absolute;top:583px;left:287px;white-space:nowrap" class="ft10550">−</p>
<p style="position:absolute;top:584px;left:300px;white-space:nowrap" class="ft1058">T&#160;y&#160;p&#160;e&#160;:&#160;t&#160;e&#160;x&#160;t&#160;/&#160;xml</p>
<p style="position:absolute;top:602px;left:228px;white-space:nowrap" class="ft10515">H&#160;o&#160;s&#160;t&#160;:&#160;o&#160;p&#160;e&#160;n&#160;t&#160;c&#160;.&#160;i&#160;a&#160;i&#160;k&#160;.&#160;t&#160;u&#160;g&#160;r&#160;a&#160;z&#160;.&#160;a&#160;t<br/>C&#160;o&#160;n&#160;n&#160;e&#160;c&#160;t&#160;i&#160;o&#160;n&#160;:&#160;C&#160;l&#160;o&#160;s&#160;e</p>
<p style="position:absolute;top:638px;left:227px;white-space:nowrap" class="ft1058">Cache</p>
<p style="position:absolute;top:637px;left:270px;white-space:nowrap" class="ft10550">−</p>
<p style="position:absolute;top:638px;left:282px;white-space:nowrap" class="ft1058">C&#160;o&#160;n&#160;t&#160;r&#160;o&#160;l&#160;:&#160;no</p>
<p style="position:absolute;top:637px;left:377px;white-space:nowrap" class="ft10550">−</p>
<p style="position:absolute;top:638px;left:389px;white-space:nowrap" class="ft1058">c&#160;a&#160;c&#160;h&#160;e</p>
<p style="position:absolute;top:656px;left:228px;white-space:nowrap" class="ft1058">C&#160;o&#160;n&#160;t&#160;e&#160;n&#160;t</p>
<p style="position:absolute;top:655px;left:287px;white-space:nowrap" class="ft10550">−</p>
<p style="position:absolute;top:656px;left:300px;white-space:nowrap" class="ft1058">L&#160;e&#160;n&#160;g&#160;t&#160;h&#160;:</p>
<p style="position:absolute;top:656px;left:374px;white-space:nowrap" class="ft1058">.&#160;.&#160;.</p>
<p style="position:absolute;top:692px;left:226px;white-space:nowrap" class="ft1058">&lt;?&#160;<b>xml&#160;v&#160;e&#160;r&#160;s&#160;i&#160;o&#160;n&#160;</b>=</p>
<p style="position:absolute;top:692px;left:353px;white-space:nowrap" class="ft105163"><i>&#34;&#160;1&#160;.&#160;0&#160;&#34;</i></p>
<p style="position:absolute;top:692px;left:407px;white-space:nowrap" class="ft1058">e&#160;n&#160;c&#160;o&#160;d&#160;i&#160;n&#160;g&#160;=</p>
<p style="position:absolute;top:692px;left:487px;white-space:nowrap" class="ft105163"><i>&#34;UTF</i></p>
<p style="position:absolute;top:691px;left:522px;white-space:nowrap" class="ft105164">−</p>
<p style="position:absolute;top:692px;left:533px;white-space:nowrap" class="ft105163"><i>8&#34;</i></p>
<p style="position:absolute;top:692px;left:550px;white-space:nowrap" class="ft1058">?&#160;&gt;</p>
<p style="position:absolute;top:710px;left:226px;white-space:nowrap" class="ft1058">&lt;&#160;.&#160;.&#160;.&#160;<b>R&#160;e&#160;q&#160;u&#160;e&#160;s&#160;t</b></p>
<p style="position:absolute;top:710px;left:338px;white-space:nowrap" class="ft1058">.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:710px;left:388px;white-space:nowrap" class="ft1058">&gt;</p>
<p style="position:absolute;top:746px;left:226px;white-space:nowrap" class="ft1058">The&#160;path&#160;component&#160;“</p>
<p style="position:absolute;top:746px;left:359px;white-space:nowrap" class="ft10534">/xkms/...</p>
<p style="position:absolute;top:746px;left:440px;white-space:nowrap" class="ft1058">”&#160;is&#160;used&#160;to&#160;distinguish&#160;categories&#160;of</p>
<p style="position:absolute;top:763px;left:248px;white-space:nowrap" class="ft1058">requests.&#160;An&#160;obvious&#160;mapping&#160;would&#160;be,&#160;e.g.,&#160;“</p>
<p style="position:absolute;top:764px;left:547px;white-space:nowrap" class="ft10534">.../aik</p>
<p style="position:absolute;top:763px;left:610px;white-space:nowrap" class="ft1058">”&#160;for&#160;all&#160;AIK&#160;specific</p>
<p style="position:absolute;top:781px;left:226px;white-space:nowrap" class="ft1058">requests&#160;and&#160;“</p>
<p style="position:absolute;top:782px;left:312px;white-space:nowrap" class="ft10534">.../ek</p>
<p style="position:absolute;top:781px;left:366px;white-space:nowrap" class="ft1058">”&#160;for&#160;EK&#160;related&#160;operations.&#160;Implementation&#160;experience&#160;is&#160;ex-</p>
<p style="position:absolute;top:799px;left:226px;white-space:nowrap" class="ft1058">pected&#160;to&#160;define&#160;useful&#160;groupings.</p>
<p style="position:absolute;top:817px;left:248px;white-space:nowrap" class="ft1058">An&#160;optional</p>
<p style="position:absolute;top:818px;left:328px;white-space:nowrap" class="ft10534">Authentication</p>
<p style="position:absolute;top:817px;left:460px;white-space:nowrap" class="ft1058">component&#160;is&#160;employed&#160;for&#160;operations&#160;which</p>
<p style="position:absolute;top:835px;left:226px;white-space:nowrap" class="ft10514">are&#160;restricted&#160;to&#160;specific&#160;clients&#160;or&#160;need&#160;proof&#160;of&#160;knowledge&#160;of&#160;a&#160;shared&#160;secret.&#160;The<br/>XKMS&#160;standard&#160;contains&#160;a&#160;description&#160;of&#160;an&#160;algorithm&#160;to&#160;derive&#160;a&#160;cryptographic<br/>key&#160;from&#160;a&#160;secret&#160;string&#160;(e.g.,&#160;password).&#160;One&#160;can&#160;then&#160;use&#160;this&#160;key&#160;to&#160;generate<br/>a&#160;XML&#160;digital&#160;signature&#160;inside&#160;the</p>
<p style="position:absolute;top:890px;left:446px;white-space:nowrap" class="ft10534">Authentication</p>
<p style="position:absolute;top:889px;left:577px;white-space:nowrap" class="ft1058">message&#160;component&#160;which</p>
<p style="position:absolute;top:907px;left:226px;white-space:nowrap" class="ft1058">references&#160;the</p>
<p style="position:absolute;top:908px;left:318px;white-space:nowrap" class="ft10534">KeyBinding</p>
<p style="position:absolute;top:907px;left:413px;white-space:nowrap" class="ft1058">type&#160;payload&#160;of&#160;the&#160;request.&#160;If&#160;the&#160;validation&#160;of&#160;the</p>
<p style="position:absolute;top:926px;left:226px;white-space:nowrap" class="ft10534">Authentication</p>
<p style="position:absolute;top:925px;left:359px;white-space:nowrap" class="ft1058">element&#160;fails&#160;at&#160;server&#160;side,&#160;the&#160;response&#160;message&#160;contains</p>
<p style="position:absolute;top:943px;left:226px;white-space:nowrap" class="ft1058">“</p>
<p style="position:absolute;top:944px;left:233px;white-space:nowrap" class="ft10534">ResultMajor=Sender</p>
<p style="position:absolute;top:943px;left:395px;white-space:nowrap" class="ft1058">”&#160;with&#160;“</p>
<p style="position:absolute;top:944px;left:441px;white-space:nowrap" class="ft10534">ResultMinor=NoAuthentication</p>
<p style="position:absolute;top:943px;left:693px;white-space:nowrap" class="ft1058">”.</p>
<p style="position:absolute;top:1000px;left:226px;white-space:nowrap" class="ft10523"><b>Response</b></p>
<p style="position:absolute;top:1029px;left:226px;white-space:nowrap" class="ft1058">The&#160;following&#160;block&#160;outlines&#160;the&#160;structure&#160;of&#160;a&#160;typical&#160;XKMS&#160;response:</p>
<p style="position:absolute;top:1061px;left:226px;white-space:nowrap" class="ft1058">&lt;?&#160;<b>xml&#160;v&#160;e&#160;r&#160;s&#160;i&#160;o&#160;n&#160;</b>=</p>
<p style="position:absolute;top:1061px;left:353px;white-space:nowrap" class="ft105163"><i>&#34;&#160;1&#160;.&#160;0&#160;&#34;</i></p>
<p style="position:absolute;top:1061px;left:407px;white-space:nowrap" class="ft1058">e&#160;n&#160;c&#160;o&#160;d&#160;i&#160;n&#160;g&#160;=</p>
<p style="position:absolute;top:1061px;left:487px;white-space:nowrap" class="ft105163"><i>&#34;UTF</i></p>
<p style="position:absolute;top:1060px;left:522px;white-space:nowrap" class="ft105164">−</p>
<p style="position:absolute;top:1061px;left:533px;white-space:nowrap" class="ft105163"><i>8&#34;</i></p>
<p style="position:absolute;top:1061px;left:550px;white-space:nowrap" class="ft1058">?&#160;&gt;</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft10521">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 106 -->
<a name="106"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page106-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5106.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1068">104</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft10621">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft1068">&lt;&#160;.&#160;.&#160;.&#160;R&#160;e&#160;s&#160;u&#160;l&#160;t&#160;x&#160;m&#160;l&#160;n&#160;s=</p>
<p style="position:absolute;top:194px;left:303px;white-space:nowrap" class="ft106163"><i>&#34;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www&#160;.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;2&#160;/&#160;0&#160;3&#160;/&#160;xkms&#160;#&#160;&#34;</i></p>
<p style="position:absolute;top:212px;left:170px;white-space:nowrap" class="ft1068">x&#160;m&#160;l&#160;n&#160;s&#160;:&#160;d&#160;s&#160;=</p>
<p style="position:absolute;top:212px;left:250px;white-space:nowrap" class="ft106163"><i>&#34;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www&#160;.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;0&#160;/&#160;0&#160;9&#160;/&#160;x&#160;m&#160;l&#160;d&#160;s&#160;i&#160;g&#160;#&#160;&#34;</i></p>
<p style="position:absolute;top:230px;left:170px;white-space:nowrap" class="ft1068">x&#160;m&#160;l&#160;n&#160;s&#160;:&#160;x&#160;e&#160;n&#160;c&#160;=</p>
<p style="position:absolute;top:230px;left:268px;white-space:nowrap" class="ft106163"><i>&#34;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www&#160;.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;1&#160;/&#160;0&#160;4&#160;/&#160;x&#160;m&#160;l&#160;e&#160;n&#160;c&#160;#&#160;&#34;</i></p>
<p style="position:absolute;top:247px;left:170px;white-space:nowrap" class="ft1068">I&#160;d&#160;=</p>
<p style="position:absolute;top:247px;left:196px;white-space:nowrap" class="ft106163"><i>&#34;&#160;.&#160;.&#160;.&#160;&#34;</i></p>
<p style="position:absolute;top:265px;left:170px;white-space:nowrap" class="ft1068">R&#160;e&#160;q&#160;u&#160;e&#160;s&#160;t&#160;I&#160;d&#160;=</p>
<p style="position:absolute;top:265px;left:259px;white-space:nowrap" class="ft106163"><i>&#34;&#160;.&#160;.&#160;.&#160;&#34;</i></p>
<p style="position:absolute;top:283px;left:170px;white-space:nowrap" class="ft1068">R&#160;e&#160;s&#160;u&#160;l&#160;t&#160;M&#160;a&#160;j&#160;o&#160;r&#160;=</p>
<p style="position:absolute;top:283px;left:277px;white-space:nowrap" class="ft106163"><i>&#34;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www&#160;.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;2&#160;/&#160;0&#160;3&#160;/&#160;xkms&#160;#&#160;S&#160;u&#160;c&#160;c&#160;e&#160;s&#160;s&#160;&#34;</i></p>
<p style="position:absolute;top:301px;left:170px;white-space:nowrap" class="ft1068">R&#160;e&#160;s&#160;u&#160;l&#160;t&#160;M&#160;i&#160;n&#160;o&#160;r&#160;=</p>
<p style="position:absolute;top:301px;left:277px;white-space:nowrap" class="ft106163"><i>&#34;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www&#160;.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;2&#160;/&#160;0&#160;3&#160;/&#160;xkms&#160;#&#160;.&#160;.&#160;.&#160;&#34;</i></p>
<p style="position:absolute;top:319px;left:170px;white-space:nowrap" class="ft1068">S&#160;e&#160;r&#160;v&#160;i&#160;c&#160;e&#160;=</p>
<p style="position:absolute;top:319px;left:241px;white-space:nowrap" class="ft106163"><i>&#34;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;o&#160;p&#160;e&#160;n&#160;t&#160;c&#160;.&#160;i&#160;a&#160;i&#160;k&#160;.&#160;t&#160;u&#160;g&#160;r&#160;a&#160;z&#160;.&#160;a&#160;t&#160;/&#160;xkms&#160;/&#160;.&#160;.&#160;.&#160;&#34;</i></p>
<p style="position:absolute;top:319px;left:590px;white-space:nowrap" class="ft1068">&gt;</p>
<p style="position:absolute;top:337px;left:168px;white-space:nowrap" class="ft1068">&lt;&#160;<b>S&#160;i&#160;g&#160;n&#160;a&#160;t&#160;u&#160;r&#160;e&#160;</b>x&#160;m&#160;l&#160;n&#160;s=</p>
<p style="position:absolute;top:337px;left:321px;white-space:nowrap" class="ft106163"><i>&#34;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www&#160;.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;0&#160;/&#160;0&#160;9&#160;/&#160;x&#160;m&#160;l&#160;d&#160;s&#160;i&#160;g&#160;#&#160;&#34;</i></p>
<p style="position:absolute;top:337px;left:643px;white-space:nowrap" class="ft1068">&gt;</p>
<p style="position:absolute;top:355px;left:190px;white-space:nowrap" class="ft1068">.&#160;.&#160;.&#160;g&#160;l&#160;o&#160;b&#160;a&#160;l&#160;m&#160;e&#160;s&#160;s&#160;a&#160;g&#160;e</p>
<p style="position:absolute;top:355px;left:350px;white-space:nowrap" class="ft1068">s&#160;i&#160;g&#160;n&#160;a&#160;t&#160;u&#160;r&#160;e</p>
<p style="position:absolute;top:355px;left:439px;white-space:nowrap" class="ft1068">o&#160;f&#160;XKMS&#160;r&#160;e&#160;s&#160;p&#160;o&#160;n&#160;d&#160;e&#160;r&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:373px;left:168px;white-space:nowrap" class="ft1068">&lt;&#160;/&#160;<b>S&#160;i&#160;g&#160;n&#160;a&#160;t&#160;u&#160;r&#160;e&#160;</b>&gt;</p>
<p style="position:absolute;top:391px;left:172px;white-space:nowrap" class="ft1068">.&#160;.&#160;.&#160;p&#160;a&#160;y&#160;l&#160;o&#160;a&#160;d&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:409px;left:150px;white-space:nowrap" class="ft1068">&lt;&#160;/&#160;.&#160;.&#160;.&#160;R&#160;e&#160;s&#160;u&#160;l&#160;t&#160;&gt;</p>
<p style="position:absolute;top:444px;left:150px;white-space:nowrap" class="ft1068">The&#160;XML&#160;tag&#160;name&#160;of&#160;an&#160;XKMS&#160;response&#160;message&#160;always&#160;ends&#160;in</p>
<p style="position:absolute;top:445px;left:550px;white-space:nowrap" class="ft10634">Result</p>
<p style="position:absolute;top:444px;left:604px;white-space:nowrap" class="ft1068">.&#160;Example</p>
<p style="position:absolute;top:462px;left:150px;white-space:nowrap" class="ft1068">tag&#160;names&#160;are</p>
<p style="position:absolute;top:463px;left:236px;white-space:nowrap" class="ft10634">LocateResult</p>
<p style="position:absolute;top:462px;left:344px;white-space:nowrap" class="ft1068">,</p>
<p style="position:absolute;top:463px;left:351px;white-space:nowrap" class="ft10634">ValidateResult</p>
<p style="position:absolute;top:462px;left:477px;white-space:nowrap" class="ft1068">,&#160;etc.&#160;Note&#160;that&#160;there&#160;also&#160;exists</p>
<p style="position:absolute;top:480px;left:150px;white-space:nowrap" class="ft1068">a&#160;basic</p>
<p style="position:absolute;top:481px;left:195px;white-space:nowrap" class="ft10634">Result</p>
<p style="position:absolute;top:480px;left:253px;white-space:nowrap" class="ft1068">response&#160;message.&#160;This&#160;one&#160;is&#160;emitted&#160;by&#160;the&#160;server&#160;when&#160;he&#160;cannot</p>
<p style="position:absolute;top:498px;left:150px;white-space:nowrap" class="ft10614">properly&#160;parse&#160;an&#160;invalid&#160;request&#160;and&#160;thus&#160;cannot&#160;determine&#160;the&#160;more&#160;specific&#160;type&#160;of&#160;a<br/>request.</p>
<p style="position:absolute;top:533px;left:172px;white-space:nowrap" class="ft1068">In&#160;comparison&#160;to&#160;the&#160;XKMS&#160;request&#160;message&#160;the&#160;result&#160;message&#160;contains&#160;additional</p>
<p style="position:absolute;top:551px;left:150px;white-space:nowrap" class="ft1068">components:</p>
<p style="position:absolute;top:579px;left:172px;white-space:nowrap" class="ft10650">•</p>
<p style="position:absolute;top:581px;left:187px;white-space:nowrap" class="ft10634">RequestId</p>
<p style="position:absolute;top:580px;left:273px;white-space:nowrap" class="ft1068">is&#160;a&#160;copy&#160;of&#160;the</p>
<p style="position:absolute;top:581px;left:371px;white-space:nowrap" class="ft10634">Id</p>
<p style="position:absolute;top:580px;left:394px;white-space:nowrap" class="ft1068">of&#160;the&#160;corresponding&#160;request&#160;message.&#160;It&#160;en-</p>
<p style="position:absolute;top:598px;left:187px;white-space:nowrap" class="ft10614">ables&#160;a&#160;client&#160;with&#160;multiple&#160;XKMS&#160;messages&#160;in&#160;transit&#160;to&#160;match&#160;request-response<br/>pairs.</p>
<p style="position:absolute;top:645px;left:172px;white-space:nowrap" class="ft10650">•</p>
<p style="position:absolute;top:646px;left:187px;white-space:nowrap" class="ft10634">ResultMajor</p>
<p style="position:absolute;top:646px;left:289px;white-space:nowrap" class="ft1068">specifies&#160;the&#160;overall&#160;outcome&#160;of&#160;the&#160;request.&#160;In&#160;case&#160;of&#160;process-</p>
<p style="position:absolute;top:663px;left:187px;white-space:nowrap" class="ft1068">ing&#160;of&#160;the&#160;request&#160;without&#160;failure&#160;a</p>
<p style="position:absolute;top:664px;left:402px;white-space:nowrap" class="ft10634">Success</p>
<p style="position:absolute;top:663px;left:469px;white-space:nowrap" class="ft1068">result&#160;is&#160;expected.&#160;In&#160;the&#160;case&#160;of</p>
<p style="position:absolute;top:681px;left:187px;white-space:nowrap" class="ft1068">an&#160;error</p>
<p style="position:absolute;top:682px;left:239px;white-space:nowrap" class="ft10634">ResultMajor</p>
<p style="position:absolute;top:681px;left:341px;white-space:nowrap" class="ft1068">contains&#160;an&#160;indication&#160;who&#160;is&#160;assumed&#160;to&#160;be&#160;the&#160;cause</p>
<p style="position:absolute;top:699px;left:187px;white-space:nowrap" class="ft1068">of&#160;the&#160;error,</p>
<p style="position:absolute;top:700px;left:261px;white-space:nowrap" class="ft10634">Sender</p>
<p style="position:absolute;top:699px;left:319px;white-space:nowrap" class="ft1068">or</p>
<p style="position:absolute;top:700px;left:335px;white-space:nowrap" class="ft10634">Receiver</p>
<p style="position:absolute;top:699px;left:407px;white-space:nowrap" class="ft1068">.</p>
<p style="position:absolute;top:728px;left:172px;white-space:nowrap" class="ft10650">•</p>
<p style="position:absolute;top:729px;left:187px;white-space:nowrap" class="ft1068">An&#160;optional</p>
<p style="position:absolute;top:729px;left:263px;white-space:nowrap" class="ft10634">ResultMinor</p>
<p style="position:absolute;top:729px;left:365px;white-space:nowrap" class="ft1068">specifies&#160;additional&#160;details&#160;of&#160;the&#160;result&#160;status&#160;of&#160;a</p>
<p style="position:absolute;top:746px;left:187px;white-space:nowrap" class="ft1068">request,&#160;if&#160;the&#160;value&#160;in</p>
<p style="position:absolute;top:747px;left:331px;white-space:nowrap" class="ft10634">ResultMajor</p>
<p style="position:absolute;top:746px;left:435px;white-space:nowrap" class="ft1068">can&#160;not&#160;alone&#160;represent&#160;all&#160;interesting</p>
<p style="position:absolute;top:764px;left:187px;white-space:nowrap" class="ft1068">information.</p>
<p style="position:absolute;top:793px;left:150px;white-space:nowrap" class="ft10614">A&#160;response&#160;by&#160;an&#160;XKMS&#160;service&#160;is&#160;expected&#160;to&#160;be&#160;always&#160;signed.&#160;This&#160;XML&#160;digital<br/>signature&#160;encloses&#160;the&#160;whole&#160;XKMS&#160;message.&#160;In&#160;order&#160;for&#160;the&#160;client&#160;to&#160;verify&#160;the&#160;sig-<br/>nature,&#160;the&#160;public&#160;key&#160;of&#160;the&#160;XKMS&#160;service&#160;must&#160;be&#160;known&#160;on&#160;the&#160;client&#160;side.&#160;Typically<br/>the&#160;public&#160;key&#160;is&#160;shipped&#160;to&#160;the&#160;client&#160;in&#160;form&#160;of&#160;a&#160;X509&#160;type&#160;certificate.</p>
<p style="position:absolute;top:865px;left:172px;white-space:nowrap" class="ft1068">The&#160;result&#160;received&#160;from&#160;an&#160;XKMS&#160;request&#160;submitted&#160;using&#160;HTTP&#160;POST&#160;typically</p>
<p style="position:absolute;top:883px;left:150px;white-space:nowrap" class="ft1068">looks&#160;like:</p>
<p style="position:absolute;top:915px;left:149px;white-space:nowrap" class="ft1068">HTTP&#160;/&#160;1&#160;.&#160;1&#160;200&#160;OK</p>
<p style="position:absolute;top:933px;left:152px;white-space:nowrap" class="ft1068">D&#160;a&#160;t&#160;e&#160;:</p>
<p style="position:absolute;top:933px;left:208px;white-space:nowrap" class="ft1068">.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:951px;left:152px;white-space:nowrap" class="ft1068">C&#160;o&#160;n&#160;t&#160;e&#160;n&#160;t</p>
<p style="position:absolute;top:950px;left:211px;white-space:nowrap" class="ft10650">−</p>
<p style="position:absolute;top:951px;left:223px;white-space:nowrap" class="ft1068">T&#160;y&#160;p&#160;e&#160;:&#160;t&#160;e&#160;x&#160;t&#160;/&#160;xml&#160;;</p>
<p style="position:absolute;top:951px;left:368px;white-space:nowrap" class="ft1068">c&#160;h&#160;a&#160;r&#160;s&#160;e&#160;t&#160;=UTF</p>
<p style="position:absolute;top:950px;left:463px;white-space:nowrap" class="ft10650">−</p>
<p style="position:absolute;top:951px;left:475px;white-space:nowrap" class="ft1068">8</p>
<p style="position:absolute;top:969px;left:152px;white-space:nowrap" class="ft1068">C&#160;o&#160;n&#160;t&#160;e&#160;n&#160;t</p>
<p style="position:absolute;top:968px;left:211px;white-space:nowrap" class="ft10650">−</p>
<p style="position:absolute;top:969px;left:224px;white-space:nowrap" class="ft1068">L&#160;e&#160;n&#160;g&#160;t&#160;h&#160;:</p>
<p style="position:absolute;top:969px;left:297px;white-space:nowrap" class="ft1068">.&#160;.&#160;.</p>
<p style="position:absolute;top:987px;left:152px;white-space:nowrap" class="ft1068">C&#160;o&#160;n&#160;n&#160;e&#160;c&#160;t&#160;i&#160;o&#160;n&#160;:&#160;c&#160;l&#160;o&#160;s&#160;e</p>
<p style="position:absolute;top:1023px;left:150px;white-space:nowrap" class="ft1068">&lt;&#160;?&#160;<b>xml&#160;v&#160;e&#160;r&#160;s&#160;i&#160;o&#160;n&#160;</b>=</p>
<p style="position:absolute;top:1023px;left:277px;white-space:nowrap" class="ft106163"><i>&#34;&#160;1&#160;.&#160;0&#160;&#34;</i></p>
<p style="position:absolute;top:1023px;left:331px;white-space:nowrap" class="ft1068">e&#160;n&#160;c&#160;o&#160;d&#160;i&#160;n&#160;g&#160;=</p>
<p style="position:absolute;top:1023px;left:411px;white-space:nowrap" class="ft106163"><i>&#34;UTF</i></p>
<p style="position:absolute;top:1022px;left:445px;white-space:nowrap" class="ft106164">−</p>
<p style="position:absolute;top:1023px;left:457px;white-space:nowrap" class="ft106163"><i>8&#34;</i></p>
<p style="position:absolute;top:1023px;left:474px;white-space:nowrap" class="ft1068">?&#160;&gt;</p>
<p style="position:absolute;top:1041px;left:150px;white-space:nowrap" class="ft1068">&lt;&#160;.&#160;.&#160;.&#160;R&#160;e&#160;s&#160;u&#160;l&#160;t</p>
<p style="position:absolute;top:1041px;left:253px;white-space:nowrap" class="ft1068">.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft10621">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 107 -->
<a name="107"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page107-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5107.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1078">CHAPTER&#160;8.&#160;PUBLIC&#160;KEY&#160;INFRASTRUCTURE</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1078">105</p>
<p style="position:absolute;top:191px;left:226px;white-space:nowrap" class="ft10724"><b>8.4.2</b></p>
<p style="position:absolute;top:191px;left:280px;white-space:nowrap" class="ft10724"><b>RegisterRequest</b></p>
<p style="position:absolute;top:222px;left:226px;white-space:nowrap" class="ft10715">A&#160;XKMS&#160;RegisterRequest&#160;is&#160;used&#160;to&#160;build&#160;a&#160;binding&#160;of&#160;information,&#160;typically&#160;to&#160;a<br/>public&#160;key(pair).&#160;The&#160;registration&#160;request&#160;message&#160;contains&#160;a&#160;prototype&#160;of&#160;the&#160;requested<br/>binding.</p>
<p style="position:absolute;top:275px;left:248px;white-space:nowrap" class="ft1078">In&#160;the&#160;context&#160;of&#160;Trusted&#160;Computing&#160;a&#160;RegisterRequest&#160;may&#160;perform&#160;the&#160;following</p>
<p style="position:absolute;top:293px;left:226px;white-space:nowrap" class="ft1078">functions:</p>
<p style="position:absolute;top:351px;left:226px;white-space:nowrap" class="ft10723"><b>Creation&#160;of&#160;an&#160;EK&#160;certificate</b></p>
<p style="position:absolute;top:379px;left:226px;white-space:nowrap" class="ft10714">The&#160;TCG&#160;infrastructure&#160;concept&#160;requires&#160;the&#160;public&#160;endorsement&#160;key&#160;of&#160;a&#160;TPM&#160;accom-<br/>panied&#160;by&#160;a&#160;certificate.&#160;To&#160;integrate&#160;TPMs&#160;(or&#160;TPM&#160;emulators)&#160;without&#160;a&#160;certificate,&#160;a<br/>function&#160;to&#160;create&#160;one&#160;from&#160;a&#160;public&#160;key&#160;is&#160;desired.</p>
<p style="position:absolute;top:433px;left:248px;white-space:nowrap" class="ft1078">Structure&#160;of&#160;a&#160;request,&#160;including&#160;a&#160;RSA&#160;public&#160;key:</p>
<p style="position:absolute;top:466px;left:226px;white-space:nowrap" class="ft1078">&lt;&#160;<b>R&#160;e&#160;g&#160;i&#160;s&#160;t&#160;e&#160;r&#160;R&#160;e&#160;q&#160;u&#160;e&#160;s&#160;t</b></p>
<p style="position:absolute;top:466px;left:382px;white-space:nowrap" class="ft1078">.&#160;.&#160;.&#160;&gt;</p>
<p style="position:absolute;top:483px;left:244px;white-space:nowrap" class="ft1078">&lt;&#160;<b>P&#160;r&#160;o&#160;t&#160;o&#160;t&#160;y&#160;p&#160;e&#160;K&#160;e&#160;y&#160;B&#160;i&#160;n&#160;d&#160;i&#160;n&#160;g&#160;</b>I&#160;d&#160;=</p>
<p style="position:absolute;top:483px;left:460px;white-space:nowrap" class="ft107163"><i>&#34;&#160;.&#160;.&#160;.&#160;.&#160;.&#160;&#34;</i></p>
<p style="position:absolute;top:483px;left:522px;white-space:nowrap" class="ft1078">&gt;</p>
<p style="position:absolute;top:501px;left:262px;white-space:nowrap" class="ft1078">&lt;&#160;<b>Key&#160;Info</b></p>
<p style="position:absolute;top:501px;left:347px;white-space:nowrap" class="ft1078">.&#160;.&#160;.&#160;&gt;</p>
<p style="position:absolute;top:519px;left:280px;white-space:nowrap" class="ft1078">&lt;<b>KeyValue&#160;</b>&gt;</p>
<p style="position:absolute;top:537px;left:298px;white-space:nowrap" class="ft1078">&lt;<b>RSAKeyValue</b>&gt;</p>
<p style="position:absolute;top:555px;left:316px;white-space:nowrap" class="ft10715">&lt;<b>Modulus&#160;</b>&gt;&#160;.&#160;.&#160;.&#160;&lt;&#160;/&#160;<b>Modulus&#160;</b>&gt;<br/>&lt;<b>Exponent&#160;</b>&gt;&#160;.&#160;.&#160;.&#160;&lt;&#160;/&#160;<b>Exponent&#160;</b>&gt;</p>
<p style="position:absolute;top:591px;left:298px;white-space:nowrap" class="ft1078">&lt;&#160;/&#160;<b>RSAKeyValue</b>&gt;</p>
<p style="position:absolute;top:609px;left:280px;white-space:nowrap" class="ft1078">&lt;&#160;/&#160;<b>KeyValue&#160;</b>&gt;</p>
<p style="position:absolute;top:627px;left:262px;white-space:nowrap" class="ft1078">&lt;&#160;/&#160;<b>Key&#160;Info&#160;</b>&gt;</p>
<p style="position:absolute;top:645px;left:244px;white-space:nowrap" class="ft10714">&lt;&#160;/&#160;<b>P&#160;r&#160;o&#160;t&#160;o&#160;t&#160;y&#160;p&#160;e&#160;K&#160;e&#160;y&#160;B&#160;i&#160;n&#160;d&#160;i&#160;n&#160;g</b>&gt;<br/>&lt;&#160;<b>A&#160;u&#160;t&#160;h&#160;e&#160;n&#160;t&#160;i&#160;c&#160;a&#160;t&#160;i&#160;o&#160;n&#160;</b>&gt;</p>
<p style="position:absolute;top:681px;left:266px;white-space:nowrap" class="ft1078">.&#160;.&#160;.&#160;S&#160;i&#160;g&#160;n&#160;a&#160;t&#160;u&#160;r&#160;e</p>
<p style="position:absolute;top:681px;left:381px;white-space:nowrap" class="ft1078">r&#160;e&#160;f&#160;e&#160;r&#160;e&#160;n&#160;c&#160;i&#160;n&#160;g&#160;P&#160;r&#160;o&#160;t&#160;o&#160;t&#160;y&#160;p&#160;e&#160;K&#160;e&#160;y&#160;B&#160;i&#160;n&#160;d&#160;i&#160;n&#160;g&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:699px;left:244px;white-space:nowrap" class="ft1078">&lt;&#160;/&#160;<b>A&#160;u&#160;t&#160;h&#160;e&#160;n&#160;t&#160;i&#160;c&#160;a&#160;t&#160;i&#160;o&#160;n&#160;</b>&gt;</p>
<p style="position:absolute;top:716px;left:226px;white-space:nowrap" class="ft1078">&lt;&#160;/&#160;<b>R&#160;e&#160;g&#160;i&#160;s&#160;t&#160;e&#160;r&#160;R&#160;e&#160;q&#160;u&#160;e&#160;s&#160;t&#160;</b>&gt;</p>
<p style="position:absolute;top:789px;left:226px;white-space:nowrap" class="ft10723"><b>Creation&#160;of&#160;an&#160;AIK&#160;identity</b></p>
<p style="position:absolute;top:817px;left:226px;white-space:nowrap" class="ft10714">The&#160;exchange&#160;between&#160;a&#160;client&#160;system&#160;TPM/TSS&#160;and&#160;a&#160;Privacy&#160;CA&#160;to&#160;create&#160;an&#160;AIK<br/>certificate&#160;is&#160;almost&#160;fully&#160;standardised&#160;in&#160;the&#160;TCG&#160;specifications.&#160;Basically,&#160;it&#160;com-<br/>prises&#160;a&#160;transfer&#160;of&#160;an&#160;encrypted&#160;binary&#160;blob&#160;(namely&#160;an&#160;array&#160;of&#160;bytes)&#160;to&#160;the&#160;Privacy<br/>CA,&#160;resulting&#160;in&#160;2&#160;binary&#160;blobs&#160;as&#160;an&#160;answer.&#160;Unfortunately&#160;the&#160;features&#160;of&#160;the&#160;XKMS<br/>protocol&#160;do&#160;not&#160;allow&#160;for&#160;an&#160;obvious&#160;mapping.&#160;To&#160;prevent&#160;early&#160;modification&#160;of&#160;XKMS<br/>we&#160;decide&#160;to&#160;transfer&#160;the&#160;blob&#160;information&#160;in&#160;this&#160;case&#160;in&#160;the</p>
<p style="position:absolute;top:907px;left:598px;white-space:nowrap" class="ft10734">OpaqueClientData</p>
<p style="position:absolute;top:924px;left:226px;white-space:nowrap" class="ft10715">tag.&#160;As&#160;the&#160;name&#160;suggests&#160;the&#160;content&#160;of&#160;this&#160;tag&#160;should&#160;be&#160;opaque&#160;to&#160;the&#160;server,&#160;how-<br/>ever&#160;the&#160;gain&#160;of&#160;experience&#160;of&#160;getting&#160;a&#160;running&#160;prototype&#160;faster&#160;has&#160;priority.&#160;In&#160;a&#160;later<br/>implementation&#160;of&#160;an&#160;advanced&#160;PKI&#160;the&#160;use&#160;of,&#160;e.g.,&#160;the&#160;XKMS&#160;MessageExtension<br/>feature&#160;for&#160;a&#160;cleaner&#160;solution&#160;may&#160;be&#160;considered.</p>
<p style="position:absolute;top:996px;left:248px;white-space:nowrap" class="ft1078">Structure&#160;of&#160;the&#160;request:</p>
<p style="position:absolute;top:1029px;left:226px;white-space:nowrap" class="ft1078">&lt;&#160;<b>R&#160;e&#160;g&#160;i&#160;s&#160;t&#160;e&#160;r&#160;R&#160;e&#160;q&#160;u&#160;e&#160;s&#160;t</b></p>
<p style="position:absolute;top:1029px;left:382px;white-space:nowrap" class="ft1078">.&#160;.&#160;.&#160;&gt;</p>
<p style="position:absolute;top:1046px;left:244px;white-space:nowrap" class="ft1078">&lt;&#160;<b>P&#160;r&#160;o&#160;t&#160;o&#160;t&#160;y&#160;p&#160;e&#160;K&#160;e&#160;y&#160;B&#160;i&#160;n&#160;d&#160;i&#160;n&#160;g&#160;</b>I&#160;d&#160;=</p>
<p style="position:absolute;top:1046px;left:460px;white-space:nowrap" class="ft107163"><i>&#34;&#160;.&#160;.&#160;.&#160;.&#160;.&#160;&#34;</i></p>
<p style="position:absolute;top:1046px;left:522px;white-space:nowrap" class="ft1078">&gt;</p>
<p style="position:absolute;top:1064px;left:262px;white-space:nowrap" class="ft1078">&lt;&#160;<b>Key&#160;Info</b></p>
<p style="position:absolute;top:1064px;left:347px;white-space:nowrap" class="ft1078">.&#160;.&#160;.&#160;&gt;</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft10721">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 108 -->
<a name="108"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page108-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5108.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1088">106</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft10821">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:204px;white-space:nowrap" class="ft1088">&lt;<b>KeyValue&#160;</b>&gt;</p>
<p style="position:absolute;top:212px;left:222px;white-space:nowrap" class="ft1088">&lt;<b>RSAKeyValue</b>&gt;</p>
<p style="position:absolute;top:230px;left:240px;white-space:nowrap" class="ft10815">&lt;<b>Modulus&#160;</b>&gt;&#160;.&#160;.&#160;.&#160;&lt;&#160;/&#160;<b>Modulus&#160;</b>&gt;<br/>&lt;<b>Exponent&#160;</b>&gt;&#160;.&#160;.&#160;.&#160;&lt;&#160;/&#160;<b>Exponent&#160;</b>&gt;</p>
<p style="position:absolute;top:265px;left:222px;white-space:nowrap" class="ft1088">&lt;&#160;/&#160;<b>RSAKeyValue</b>&gt;</p>
<p style="position:absolute;top:283px;left:204px;white-space:nowrap" class="ft1088">&lt;&#160;/&#160;<b>KeyValue&#160;</b>&gt;</p>
<p style="position:absolute;top:301px;left:186px;white-space:nowrap" class="ft1088">&lt;&#160;/&#160;<b>Key&#160;Info&#160;</b>&gt;</p>
<p style="position:absolute;top:319px;left:168px;white-space:nowrap" class="ft10815">&lt;&#160;/&#160;<b>P&#160;r&#160;o&#160;t&#160;o&#160;t&#160;y&#160;p&#160;e&#160;K&#160;e&#160;y&#160;B&#160;i&#160;n&#160;d&#160;i&#160;n&#160;g</b>&gt;<br/>&lt;&#160;<b>A&#160;u&#160;t&#160;h&#160;e&#160;n&#160;t&#160;i&#160;c&#160;a&#160;t&#160;i&#160;o&#160;n&#160;</b>&gt;</p>
<p style="position:absolute;top:355px;left:190px;white-space:nowrap" class="ft1088">.&#160;.&#160;.&#160;S&#160;i&#160;g&#160;n&#160;a&#160;t&#160;u&#160;r&#160;e</p>
<p style="position:absolute;top:355px;left:305px;white-space:nowrap" class="ft1088">r&#160;e&#160;f&#160;e&#160;r&#160;e&#160;n&#160;c&#160;i&#160;n&#160;g&#160;P&#160;r&#160;o&#160;t&#160;o&#160;t&#160;y&#160;p&#160;e&#160;K&#160;e&#160;y&#160;B&#160;i&#160;n&#160;d&#160;i&#160;n&#160;g&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:373px;left:168px;white-space:nowrap" class="ft1088">&lt;&#160;/&#160;<b>A&#160;u&#160;t&#160;h&#160;e&#160;n&#160;t&#160;i&#160;c&#160;a&#160;t&#160;i&#160;o&#160;n&#160;</b>&gt;</p>
<p style="position:absolute;top:391px;left:150px;white-space:nowrap" class="ft1088">&lt;&#160;/&#160;<b>R&#160;e&#160;g&#160;i&#160;s&#160;t&#160;e&#160;r&#160;R&#160;e&#160;q&#160;u&#160;e&#160;s&#160;t&#160;</b>&gt;</p>
<p style="position:absolute;top:426px;left:150px;white-space:nowrap" class="ft1088">The</p>
<p style="position:absolute;top:427px;left:190px;white-space:nowrap" class="ft10834">blob</p>
<p style="position:absolute;top:426px;left:242px;white-space:nowrap" class="ft1088">element</p>
<p style="position:absolute;top:426px;left:307px;white-space:nowrap" class="ft1088">containing</p>
<p style="position:absolute;top:426px;left:386px;white-space:nowrap" class="ft1088">the</p>
<p style="position:absolute;top:426px;left:421px;white-space:nowrap" class="ft1088">binary</p>
<p style="position:absolute;top:426px;left:476px;white-space:nowrap" class="ft1088">blob</p>
<p style="position:absolute;top:426px;left:520px;white-space:nowrap" class="ft1088">as</p>
<p style="position:absolute;top:426px;left:549px;white-space:nowrap" class="ft1088">returned</p>
<p style="position:absolute;top:426px;left:615px;white-space:nowrap" class="ft1088">by</p>
<p style="position:absolute;top:426px;left:647px;white-space:nowrap" class="ft1088">the</p>
<p style="position:absolute;top:444px;left:150px;white-space:nowrap" class="ft10873">CollateIdentityRequest</p>
<p style="position:absolute;top:444px;left:294px;white-space:nowrap" class="ft1088">function&#160;of&#160;the&#160;TSS.</p>
<p style="position:absolute;top:462px;left:172px;white-space:nowrap" class="ft1088">Structure&#160;of&#160;the&#160;response:</p>
<p style="position:absolute;top:495px;left:150px;white-space:nowrap" class="ft1088">&lt;&#160;<b>R&#160;e&#160;g&#160;i&#160;s&#160;t&#160;e&#160;r&#160;R&#160;e&#160;s&#160;u&#160;l&#160;t</b></p>
<p style="position:absolute;top:495px;left:297px;white-space:nowrap" class="ft1088">.&#160;.&#160;.&#160;&gt;</p>
<p style="position:absolute;top:513px;left:168px;white-space:nowrap" class="ft10815">&lt;&#160;<b>S&#160;i&#160;g&#160;n&#160;a&#160;t&#160;u&#160;r&#160;e&#160;</b>&gt;&#160;.&#160;.&#160;.&#160;&lt;&#160;/&#160;<b>S&#160;i&#160;g&#160;n&#160;a&#160;t&#160;u&#160;r&#160;e&#160;</b>&gt;<br/>&lt;&#160;<b>Key&#160;Binding</b>&gt;</p>
<p style="position:absolute;top:549px;left:186px;white-space:nowrap" class="ft1088">&lt;&#160;<b>Key&#160;Info</b></p>
<p style="position:absolute;top:549px;left:270px;white-space:nowrap" class="ft1088">.&#160;.&#160;.&#160;&gt;</p>
<p style="position:absolute;top:566px;left:204px;white-space:nowrap" class="ft1088">&lt;<b>X509Data</b>&gt;</p>
<p style="position:absolute;top:584px;left:222px;white-space:nowrap" class="ft1088">&lt;&#160;<b>X&#160;5&#160;0&#160;9&#160;C&#160;e&#160;r&#160;t&#160;i&#160;f&#160;i&#160;c&#160;a&#160;t&#160;e</b>&gt;&#160;.&#160;.&#160;.&#160;&lt;&#160;/&#160;<b>X&#160;5&#160;0&#160;9&#160;C&#160;e&#160;r&#160;t&#160;i&#160;f&#160;i&#160;c&#160;a&#160;t&#160;e</b>&gt;</p>
<p style="position:absolute;top:602px;left:204px;white-space:nowrap" class="ft1088">&lt;&#160;/&#160;<b>X509Data</b>&gt;</p>
<p style="position:absolute;top:620px;left:186px;white-space:nowrap" class="ft10814">&lt;&#160;/&#160;<b>Key&#160;Info&#160;</b>&gt;<br/>&lt;&#160;<b>S&#160;t&#160;a&#160;t&#160;u&#160;s&#160;</b>S&#160;t&#160;a&#160;t&#160;u&#160;s&#160;V&#160;a&#160;l&#160;u&#160;e&#160;=</p>
<p style="position:absolute;top:638px;left:366px;white-space:nowrap" class="ft108163"><i>&#34;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www&#160;.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;2&#160;/&#160;0&#160;3&#160;/&#160;xkms&#160;#&#160;V&#160;a&#160;l&#160;i&#160;d&#160;&#34;</i></p>
<p style="position:absolute;top:638px;left:708px;white-space:nowrap" class="ft1088">/&#160;&gt;</p>
<p style="position:absolute;top:656px;left:168px;white-space:nowrap" class="ft1088">&lt;&#160;/&#160;<b>Key&#160;Binding</b>&gt;</p>
<p style="position:absolute;top:674px;left:150px;white-space:nowrap" class="ft1088">&lt;&#160;/&#160;<b>R&#160;e&#160;g&#160;i&#160;s&#160;t&#160;e&#160;r&#160;R&#160;e&#160;s&#160;u&#160;l&#160;t&#160;</b>&gt;</p>
<p style="position:absolute;top:710px;left:150px;white-space:nowrap" class="ft1088">With</p>
<p style="position:absolute;top:711px;left:198px;white-space:nowrap" class="ft10834">blob1</p>
<p style="position:absolute;top:710px;left:262px;white-space:nowrap" class="ft1088">containing</p>
<p style="position:absolute;top:710px;left:344px;white-space:nowrap" class="ft1088">the</p>
<p style="position:absolute;top:711px;left:381px;white-space:nowrap" class="ft10834">symCaAttestation</p>
<p style="position:absolute;top:710px;left:543px;white-space:nowrap" class="ft1088">and</p>
<p style="position:absolute;top:711px;left:583px;white-space:nowrap" class="ft10834">blob2</p>
<p style="position:absolute;top:710px;left:647px;white-space:nowrap" class="ft1088">the</p>
<p style="position:absolute;top:728px;left:150px;white-space:nowrap" class="ft10834">asymCaContents</p>
<p style="position:absolute;top:728px;left:280px;white-space:nowrap" class="ft1088">answer&#160;of&#160;the&#160;Privacy&#160;CA,&#160;to&#160;be&#160;passed&#160;to&#160;the</p>
<p style="position:absolute;top:727px;left:566px;white-space:nowrap" class="ft10873">ActivateIdentity</p>
<p style="position:absolute;top:746px;left:150px;white-space:nowrap" class="ft1088">function&#160;of&#160;the&#160;client&#160;TSS.</p>
<p style="position:absolute;top:763px;left:172px;white-space:nowrap" class="ft1088">For&#160;a&#160;discussion&#160;of&#160;other</p>
<p style="position:absolute;top:764px;left:323px;white-space:nowrap" class="ft10834">Authentication</p>
<p style="position:absolute;top:763px;left:453px;white-space:nowrap" class="ft1088">possibilities,&#160;see&#160;also&#160;section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#110">8.4.5.</a></p>
<p style="position:absolute;top:822px;left:150px;white-space:nowrap" class="ft10824"><b>8.4.3</b></p>
<p style="position:absolute;top:822px;left:204px;white-space:nowrap" class="ft10824"><b>LocateRequest</b></p>
<p style="position:absolute;top:852px;left:150px;white-space:nowrap" class="ft10814">A&#160;XKMS&#160;LocateRequest&#160;provides&#160;a&#160;discovery&#160;function.&#160;It&#160;resolves&#160;the&#160;passed&#160;query<br/>keybinding&#160;and&#160;matches&#160;request&#160;information&#160;with&#160;local&#160;and/or&#160;remote&#160;data.&#160;The&#160;answer<br/>of&#160;a&#160;Locate&#160;service&#160;makes&#160;no&#160;assertions&#160;to&#160;any&#160;validation&#160;criteria.&#160;However,&#160;a&#160;result&#160;of<br/>a&#160;Locate&#160;service&#160;may&#160;be&#160;forwarded&#160;to&#160;a&#160;validation&#160;service,&#160;or,&#160;if&#160;possible,&#160;additional<br/>trust&#160;verification&#160;is&#160;done&#160;locally.</p>
<p style="position:absolute;top:942px;left:172px;white-space:nowrap" class="ft1088">The&#160;following&#160;services&#160;are&#160;useful&#160;in&#160;a&#160;Trusted&#160;Computing&#160;context:</p>
<p style="position:absolute;top:1000px;left:150px;white-space:nowrap" class="ft10823"><b>Query&#160;for&#160;an&#160;AIK&#160;certificate</b></p>
<p style="position:absolute;top:1028px;left:150px;white-space:nowrap" class="ft10814">AIK&#160;certificates&#160;do&#160;not&#160;contain&#160;a&#160;subject&#160;distinguished&#160;name&#160;of&#160;the&#160;certificate&#160;owner,<br/>but&#160;only&#160;a</p>
<p style="position:absolute;top:1046px;left:213px;white-space:nowrap" class="ft10834">label</p>
<p style="position:absolute;top:1046px;left:258px;white-space:nowrap" class="ft1088">,&#160;chosen&#160;freely&#160;at&#160;AIK&#160;certificate&#160;creation&#160;time&#160;by&#160;the&#160;client/user.&#160;To</p>
<p style="position:absolute;top:1063px;left:150px;white-space:nowrap" class="ft1088">retrieve&#160;a&#160;specific&#160;AIK&#160;certificate&#160;a&#160;locate&#160;request&#160;for&#160;a&#160;specific&#160;label&#160;name&#160;is&#160;desired.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft10821">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 109 -->
<a name="109"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page109-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5109.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1098">CHAPTER&#160;8.&#160;PUBLIC&#160;KEY&#160;INFRASTRUCTURE</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1098">107</p>
<p style="position:absolute;top:194px;left:248px;white-space:nowrap" class="ft1098">An&#160;obvious&#160;mapping&#160;to&#160;XKMS&#160;would&#160;be&#160;to&#160;use&#160;the</p>
<p style="position:absolute;top:194px;left:568px;white-space:nowrap" class="ft10934">X509SubjectName</p>
<p style="position:absolute;top:194px;left:707px;white-space:nowrap" class="ft1098">in&#160;the</p>
<p style="position:absolute;top:212px;left:226px;white-space:nowrap" class="ft10934">KeyInfo</p>
<p style="position:absolute;top:212px;left:293px;white-space:nowrap" class="ft1098">portion,&#160;however,&#160;as&#160;some&#160;XKMS&#160;libraries&#160;may&#160;check&#160;this&#160;field&#160;strictly&#160;for</p>
<p style="position:absolute;top:230px;left:226px;white-space:nowrap" class="ft10915">X509&#160;name&#160;rules&#160;compatibility&#160;(and&#160;the&#160;AIK&#160;label&#160;specification&#160;is&#160;less&#160;restrictive)&#160;this<br/>is&#160;avoided&#160;and&#160;the</p>
<p style="position:absolute;top:248px;left:337px;white-space:nowrap" class="ft10934">KeyName</p>
<p style="position:absolute;top:247px;left:404px;white-space:nowrap" class="ft1098">field&#160;used&#160;instead.</p>
<p style="position:absolute;top:265px;left:248px;white-space:nowrap" class="ft1098">Thus,&#160;a&#160;query&#160;for&#160;a&#160;specific&#160;AIK&#160;certificate&#160;looks&#160;like:</p>
<p style="position:absolute;top:298px;left:226px;white-space:nowrap" class="ft1098">&lt;&#160;<b>L&#160;o&#160;c&#160;a&#160;t&#160;e&#160;R&#160;e&#160;q&#160;u&#160;e&#160;s&#160;t</b></p>
<p style="position:absolute;top:298px;left:364px;white-space:nowrap" class="ft1098">.&#160;.&#160;.&#160;&gt;</p>
<p style="position:absolute;top:316px;left:244px;white-space:nowrap" class="ft10914">&lt;<b>RespondWith</b>&gt;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www&#160;.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;2&#160;/&#160;0&#160;3&#160;/&#160;xkms#&#160;X&#160;5&#160;0&#160;9&#160;C&#160;e&#160;r&#160;t&#160;&lt;&#160;/&#160;<b>RespondWith</b>&gt;<br/>&lt;<b>QueryKeyBinding&#160;</b>&gt;</p>
<p style="position:absolute;top:352px;left:262px;white-space:nowrap" class="ft1098">&lt;&#160;<b>Key&#160;Info</b></p>
<p style="position:absolute;top:352px;left:346px;white-space:nowrap" class="ft1098">.&#160;.&#160;.&#160;&gt;</p>
<p style="position:absolute;top:370px;left:280px;white-space:nowrap" class="ft1098">&lt;<b>KeyName</b>&gt;&#160;l&#160;a&#160;b&#160;e&#160;l&#160;O&#160;f&#160;A&#160;i&#160;k&#160;C&#160;e&#160;r&#160;t&#160;i&#160;f&#160;i&#160;c&#160;a&#160;t&#160;e&#160;&lt;&#160;/&#160;<b>KeyName</b>&gt;</p>
<p style="position:absolute;top:388px;left:262px;white-space:nowrap" class="ft1098">&lt;&#160;/&#160;<b>Key&#160;Info&#160;</b>&gt;</p>
<p style="position:absolute;top:406px;left:244px;white-space:nowrap" class="ft1098">&lt;&#160;/&#160;<b>QueryKeyBinding&#160;</b>&gt;</p>
<p style="position:absolute;top:423px;left:226px;white-space:nowrap" class="ft1098">&lt;&#160;/&#160;<b>L&#160;o&#160;c&#160;a&#160;t&#160;e&#160;R&#160;e&#160;q&#160;u&#160;e&#160;s&#160;t</b>&gt;</p>
<p style="position:absolute;top:459px;left:226px;white-space:nowrap" class="ft1098">An&#160;answer&#160;is&#160;of&#160;the&#160;form:</p>
<p style="position:absolute;top:492px;left:226px;white-space:nowrap" class="ft1098">&lt;&#160;L&#160;o&#160;c&#160;a&#160;t&#160;e&#160;R&#160;e&#160;s&#160;u&#160;l&#160;t</p>
<p style="position:absolute;top:492px;left:356px;white-space:nowrap" class="ft1098">.&#160;.&#160;.</p>
<p style="position:absolute;top:509px;left:246px;white-space:nowrap" class="ft1098">R&#160;e&#160;s&#160;u&#160;l&#160;t&#160;M&#160;a&#160;j&#160;o&#160;r&#160;=</p>
<p style="position:absolute;top:509px;left:353px;white-space:nowrap" class="ft109163"><i>&#34;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www&#160;.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;2&#160;/&#160;0&#160;3&#160;/&#160;xkms&#160;#&#160;S&#160;u&#160;c&#160;c&#160;e&#160;s&#160;s&#160;&#34;</i></p>
<p style="position:absolute;top:509px;left:723px;white-space:nowrap" class="ft1098">.&#160;.&#160;.&#160;&gt;</p>
<p style="position:absolute;top:527px;left:244px;white-space:nowrap" class="ft10914">&lt;&#160;<b>S&#160;i&#160;g&#160;n&#160;a&#160;t&#160;u&#160;r&#160;e&#160;</b>&gt;&#160;.&#160;.&#160;.&#160;&lt;&#160;/&#160;<b>S&#160;i&#160;g&#160;n&#160;a&#160;t&#160;u&#160;r&#160;e&#160;</b>&gt;<br/>&lt;&#160;<b>U&#160;n&#160;v&#160;e&#160;r&#160;i&#160;f&#160;i&#160;e&#160;d&#160;K&#160;e&#160;y&#160;B&#160;i&#160;n&#160;d&#160;i&#160;n&#160;g&#160;</b>&gt;</p>
<p style="position:absolute;top:563px;left:262px;white-space:nowrap" class="ft1098">&lt;&#160;<b>Key&#160;Info</b></p>
<p style="position:absolute;top:563px;left:347px;white-space:nowrap" class="ft1098">.&#160;.&#160;.&#160;&gt;</p>
<p style="position:absolute;top:581px;left:280px;white-space:nowrap" class="ft1098">&lt;<b>X509Data</b>&gt;</p>
<p style="position:absolute;top:599px;left:298px;white-space:nowrap" class="ft1098">&lt;&#160;<b>X&#160;5&#160;0&#160;9&#160;C&#160;e&#160;r&#160;t&#160;i&#160;f&#160;i&#160;c&#160;a&#160;t&#160;e</b>&gt;&#160;.&#160;.&#160;.&#160;&lt;&#160;/&#160;<b>X&#160;5&#160;0&#160;9&#160;C&#160;e&#160;r&#160;t&#160;i&#160;f&#160;i&#160;c&#160;a&#160;t&#160;e</b>&gt;</p>
<p style="position:absolute;top:617px;left:280px;white-space:nowrap" class="ft1098">&lt;&#160;/&#160;<b>X509Data</b>&gt;</p>
<p style="position:absolute;top:635px;left:262px;white-space:nowrap" class="ft1098">&lt;&#160;/&#160;<b>Key&#160;Info&#160;</b>&gt;</p>
<p style="position:absolute;top:653px;left:244px;white-space:nowrap" class="ft1098">&lt;&#160;/&#160;<b>U&#160;n&#160;v&#160;e&#160;r&#160;i&#160;f&#160;i&#160;e&#160;d&#160;K&#160;e&#160;y&#160;B&#160;i&#160;n&#160;d&#160;i&#160;n&#160;g&#160;</b>&gt;</p>
<p style="position:absolute;top:671px;left:226px;white-space:nowrap" class="ft1098">&lt;&#160;/&#160;L&#160;o&#160;c&#160;a&#160;t&#160;e&#160;R&#160;e&#160;s&#160;u&#160;l&#160;t&#160;&gt;</p>
<p style="position:absolute;top:706px;left:226px;white-space:nowrap" class="ft10914">Note&#160;that&#160;depending&#160;on&#160;the&#160;policy&#160;of&#160;the&#160;Privacy&#160;CA&#160;the&#160;AIK&#160;label&#160;may&#160;not&#160;be&#160;unique<br/>and&#160;in&#160;the</p>
<p style="position:absolute;top:725px;left:289px;white-space:nowrap" class="ft10934">X509Data</p>
<p style="position:absolute;top:724px;left:364px;white-space:nowrap" class="ft1098">component&#160;multiple&#160;certificates&#160;may&#160;be&#160;returned.</p>
<p style="position:absolute;top:783px;left:226px;white-space:nowrap" class="ft10924"><b>8.4.4</b></p>
<p style="position:absolute;top:783px;left:280px;white-space:nowrap" class="ft10924"><b>ValidateRequest</b></p>
<p style="position:absolute;top:813px;left:226px;white-space:nowrap" class="ft10914">The&#160;operations&#160;of&#160;an&#160;XKMS&#160;ValidateRequest&#160;are&#160;similar&#160;to&#160;a&#160;LocateRequest&#160;(see&#160;pre-<br/>vious&#160;section),&#160;however,&#160;the&#160;returned&#160;status&#160;of&#160;a&#160;binding&#160;is&#160;evaluated&#160;from&#160;well&#160;defined<br/>validation&#160;criteria.&#160;A&#160;validation&#160;service&#160;returns&#160;only&#160;information&#160;which&#160;has&#160;been&#160;vali-<br/>dated&#160;by&#160;the&#160;service.&#160;Its&#160;validation&#160;policy&#160;is&#160;expected&#160;to&#160;be&#160;publicly&#160;available.</p>
<p style="position:absolute;top:885px;left:248px;white-space:nowrap" class="ft1098">In&#160;order&#160;to&#160;validate&#160;a&#160;specific&#160;certificate,&#160;it&#160;is&#160;sent&#160;to&#160;the&#160;service:</p>
<p style="position:absolute;top:917px;left:226px;white-space:nowrap" class="ft1098">&lt;&#160;<b>V&#160;a&#160;l&#160;i&#160;d&#160;a&#160;t&#160;e&#160;R&#160;e&#160;q&#160;u&#160;e&#160;s&#160;t</b></p>
<p style="position:absolute;top:917px;left:382px;white-space:nowrap" class="ft1098">.&#160;.&#160;.&#160;&gt;</p>
<p style="position:absolute;top:935px;left:244px;white-space:nowrap" class="ft1098">&lt;<b>RespondWith</b>&gt;</p>
<p style="position:absolute;top:953px;left:265px;white-space:nowrap" class="ft1098">h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www&#160;.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;2&#160;/&#160;0&#160;3&#160;/&#160;xkms#&#160;X5&#160;0&#160;9&#160;Ch&#160;ain</p>
<p style="position:absolute;top:971px;left:244px;white-space:nowrap" class="ft10914">&lt;&#160;/&#160;<b>RespondWith</b>&gt;<br/>&lt;<b>QueryKeyBinding&#160;</b>&gt;</p>
<p style="position:absolute;top:1007px;left:262px;white-space:nowrap" class="ft1098">&lt;&#160;<b>Key&#160;Info</b></p>
<p style="position:absolute;top:1007px;left:346px;white-space:nowrap" class="ft1098">.&#160;.&#160;.&#160;&gt;</p>
<p style="position:absolute;top:1025px;left:280px;white-space:nowrap" class="ft1098">&lt;<b>X509Data</b>&gt;</p>
<p style="position:absolute;top:1043px;left:298px;white-space:nowrap" class="ft1098">&lt;&#160;<b>X&#160;5&#160;0&#160;9&#160;C&#160;e&#160;r&#160;t&#160;i&#160;f&#160;i&#160;c&#160;a&#160;t&#160;e</b>&gt;&#160;.&#160;.&#160;.&#160;&lt;&#160;/&#160;<b>X&#160;5&#160;0&#160;9&#160;C&#160;e&#160;r&#160;t&#160;i&#160;f&#160;i&#160;c&#160;a&#160;t&#160;e</b>&gt;</p>
<p style="position:absolute;top:1061px;left:280px;white-space:nowrap" class="ft1098">&lt;&#160;/&#160;<b>X509Data</b>&gt;</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft10921">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 110 -->
<a name="110"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page110-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5110.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1108">108</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft11021">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:186px;white-space:nowrap" class="ft1108">&lt;&#160;/&#160;<b>Key&#160;Info&#160;</b>&gt;</p>
<p style="position:absolute;top:212px;left:168px;white-space:nowrap" class="ft1108">&lt;&#160;/&#160;<b>QueryKeyBinding&#160;</b>&gt;</p>
<p style="position:absolute;top:230px;left:150px;white-space:nowrap" class="ft1108">&lt;&#160;/&#160;<b>V&#160;a&#160;l&#160;i&#160;d&#160;a&#160;t&#160;e&#160;R&#160;e&#160;q&#160;u&#160;e&#160;s&#160;t&#160;</b>&gt;</p>
<p style="position:absolute;top:265px;left:150px;white-space:nowrap" class="ft1108">The&#160;expected&#160;result&#160;upon&#160;positive&#160;validation&#160;is&#160;an</p>
<p style="position:absolute;top:266px;left:465px;white-space:nowrap" class="ft11034">X509Chain</p>
<p style="position:absolute;top:265px;left:546px;white-space:nowrap" class="ft1108">,&#160;a&#160;certificate&#160;chain</p>
<p style="position:absolute;top:283px;left:150px;white-space:nowrap" class="ft1108">build&#160;from&#160;the&#160;supplied&#160;certificate&#160;to&#160;a&#160;trusted&#160;root.</p>
<p style="position:absolute;top:316px;left:150px;white-space:nowrap" class="ft1108">&lt;&#160;<b>V&#160;a&#160;l&#160;i&#160;d&#160;a&#160;t&#160;e&#160;R&#160;e&#160;s&#160;u&#160;l&#160;t</b></p>
<p style="position:absolute;top:316px;left:297px;white-space:nowrap" class="ft1108">.&#160;.&#160;.</p>
<p style="position:absolute;top:333px;left:170px;white-space:nowrap" class="ft1108">R&#160;e&#160;s&#160;u&#160;l&#160;t&#160;M&#160;a&#160;j&#160;o&#160;r&#160;=</p>
<p style="position:absolute;top:333px;left:277px;white-space:nowrap" class="ft110163"><i>&#34;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www&#160;.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;2&#160;/&#160;0&#160;3&#160;/&#160;xkms&#160;#&#160;S&#160;u&#160;c&#160;c&#160;e&#160;s&#160;s&#160;&#34;</i></p>
<p style="position:absolute;top:333px;left:647px;white-space:nowrap" class="ft1108">.&#160;.&#160;.&#160;&gt;</p>
<p style="position:absolute;top:351px;left:168px;white-space:nowrap" class="ft11014">&lt;&#160;<b>S&#160;i&#160;g&#160;n&#160;a&#160;t&#160;u&#160;r&#160;e&#160;</b>&gt;&#160;.&#160;.&#160;.&#160;&lt;&#160;/&#160;<b>S&#160;i&#160;g&#160;n&#160;a&#160;t&#160;u&#160;r&#160;e&#160;</b>&gt;<br/>&lt;&#160;<b>Key&#160;Binding</b>&gt;</p>
<p style="position:absolute;top:387px;left:186px;white-space:nowrap" class="ft1108">&lt;&#160;<b>Key&#160;Info&#160;</b>x&#160;m&#160;l&#160;n&#160;s=</p>
<p style="position:absolute;top:387px;left:321px;white-space:nowrap" class="ft110163"><i>&#34;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www&#160;.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;0&#160;/&#160;0&#160;9&#160;/&#160;x&#160;m&#160;l&#160;d&#160;s&#160;i&#160;g&#160;#&#160;&#34;</i></p>
<p style="position:absolute;top:387px;left:643px;white-space:nowrap" class="ft1108">&gt;</p>
<p style="position:absolute;top:405px;left:204px;white-space:nowrap" class="ft1108">&lt;<b>X509Data</b>&gt;</p>
<p style="position:absolute;top:423px;left:222px;white-space:nowrap" class="ft11014">&lt;&#160;<b>X&#160;5&#160;0&#160;9&#160;C&#160;e&#160;r&#160;t&#160;i&#160;f&#160;i&#160;c&#160;a&#160;t&#160;e</b>&gt;&#160;.&#160;.&#160;.&#160;&lt;&#160;/&#160;<b>X&#160;5&#160;0&#160;9&#160;C&#160;e&#160;r&#160;t&#160;i&#160;f&#160;i&#160;c&#160;a&#160;t&#160;e</b>&gt;<br/>&lt;&#160;<b>X&#160;5&#160;0&#160;9&#160;C&#160;e&#160;r&#160;t&#160;i&#160;f&#160;i&#160;c&#160;a&#160;t&#160;e</b>&gt;&#160;.&#160;.&#160;.&#160;&lt;&#160;/&#160;<b>X&#160;5&#160;0&#160;9&#160;C&#160;e&#160;r&#160;t&#160;i&#160;f&#160;i&#160;c&#160;a&#160;t&#160;e</b>&gt;<br/>&lt;&#160;<b>X&#160;5&#160;0&#160;9&#160;C&#160;e&#160;r&#160;t&#160;i&#160;f&#160;i&#160;c&#160;a&#160;t&#160;e</b>&gt;&#160;.&#160;.&#160;.&#160;&lt;&#160;/&#160;<b>X&#160;5&#160;0&#160;9&#160;C&#160;e&#160;r&#160;t&#160;i&#160;f&#160;i&#160;c&#160;a&#160;t&#160;e</b>&gt;</p>
<p style="position:absolute;top:477px;left:204px;white-space:nowrap" class="ft1108">&lt;&#160;/&#160;<b>X509Data</b>&gt;</p>
<p style="position:absolute;top:495px;left:186px;white-space:nowrap" class="ft11014">&lt;&#160;/&#160;<b>Key&#160;Info&#160;</b>&gt;<br/>&lt;&#160;<b>S&#160;t&#160;a&#160;t&#160;u&#160;s&#160;</b>S&#160;t&#160;a&#160;t&#160;u&#160;s&#160;V&#160;a&#160;l&#160;u&#160;e&#160;=</p>
<p style="position:absolute;top:513px;left:366px;white-space:nowrap" class="ft110163"><i>&#34;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www&#160;.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;2&#160;/&#160;0&#160;3&#160;/&#160;xkms&#160;#&#160;V&#160;a&#160;l&#160;i&#160;d&#160;&#34;</i></p>
<p style="position:absolute;top:513px;left:706px;white-space:nowrap" class="ft1108">&gt;</p>
<p style="position:absolute;top:531px;left:204px;white-space:nowrap" class="ft1108">&lt;&#160;<b>V&#160;a&#160;l&#160;i&#160;d&#160;R&#160;e&#160;a&#160;s&#160;o&#160;n&#160;</b>&gt;</p>
<p style="position:absolute;top:549px;left:233px;white-space:nowrap" class="ft1108">h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;2&#160;/&#160;0&#160;3&#160;/&#160;xkms#&#160;I&#160;s&#160;s&#160;u&#160;e&#160;r&#160;T&#160;r&#160;u&#160;s&#160;t</p>
<p style="position:absolute;top:566px;left:204px;white-space:nowrap" class="ft11014">&lt;&#160;/&#160;<b>V&#160;a&#160;l&#160;i&#160;d&#160;R&#160;e&#160;a&#160;s&#160;o&#160;n&#160;</b>&gt;<br/>&lt;&#160;<b>V&#160;a&#160;l&#160;i&#160;d&#160;R&#160;e&#160;a&#160;s&#160;o&#160;n&#160;</b>&gt;</p>
<p style="position:absolute;top:602px;left:233px;white-space:nowrap" class="ft1108">h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;2&#160;/&#160;0&#160;3&#160;/&#160;xkms#&#160;S&#160;i&#160;g&#160;n&#160;a&#160;t&#160;u&#160;r&#160;e</p>
<p style="position:absolute;top:620px;left:204px;white-space:nowrap" class="ft11014">&lt;&#160;/&#160;<b>V&#160;a&#160;l&#160;i&#160;d&#160;R&#160;e&#160;a&#160;s&#160;o&#160;n&#160;</b>&gt;<br/>&lt;&#160;<b>V&#160;a&#160;l&#160;i&#160;d&#160;R&#160;e&#160;a&#160;s&#160;o&#160;n&#160;</b>&gt;</p>
<p style="position:absolute;top:656px;left:233px;white-space:nowrap" class="ft1108">h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;2&#160;/&#160;0&#160;3&#160;/&#160;xkms#&#160;V&#160;a&#160;l&#160;i&#160;d&#160;i&#160;t&#160;y&#160;I&#160;n&#160;t&#160;e&#160;r&#160;v&#160;a&#160;l</p>
<p style="position:absolute;top:674px;left:213px;white-space:nowrap" class="ft1108">&lt;&#160;/&#160;<b>V&#160;a&#160;l&#160;i&#160;d&#160;R&#160;e&#160;a&#160;s&#160;o&#160;n&#160;</b>&gt;</p>
<p style="position:absolute;top:692px;left:186px;white-space:nowrap" class="ft1108">&lt;&#160;/&#160;<b>S&#160;t&#160;a&#160;t&#160;u&#160;s&#160;</b>&gt;</p>
<p style="position:absolute;top:710px;left:168px;white-space:nowrap" class="ft1108">&lt;&#160;/&#160;<b>Key&#160;Binding</b>&gt;</p>
<p style="position:absolute;top:728px;left:150px;white-space:nowrap" class="ft1108">&lt;&#160;/&#160;<b>V&#160;a&#160;l&#160;i&#160;d&#160;a&#160;t&#160;e&#160;R&#160;e&#160;s&#160;u&#160;l&#160;t&#160;</b>&gt;</p>
<p style="position:absolute;top:763px;left:150px;white-space:nowrap" class="ft11014">The&#160;corresponding&#160;result&#160;message&#160;contains&#160;the&#160;certificate&#160;chain&#160;as&#160;an&#160;array&#160;of&#160;certifi-<br/>cates&#160;and&#160;a</p>
<p style="position:absolute;top:782px;left:219px;white-space:nowrap" class="ft11034">Status</p>
<p style="position:absolute;top:781px;left:277px;white-space:nowrap" class="ft1108">component&#160;describing&#160;more&#160;detailed&#160;evaluation&#160;results.</p>
<p style="position:absolute;top:799px;left:172px;white-space:nowrap" class="ft1108">In&#160;Trusted&#160;Computing&#160;it&#160;is&#160;of&#160;interest&#160;to&#160;check&#160;the&#160;status&#160;of&#160;EK&#160;and&#160;AIK&#160;certificates.</p>
<p style="position:absolute;top:817px;left:150px;white-space:nowrap" class="ft1108">For&#160;a&#160;basic&#160;PKI&#160;the&#160;XKMS&#160;validation&#160;message&#160;exchange&#160;is&#160;the&#160;same&#160;for&#160;both&#160;cases.</p>
<p style="position:absolute;top:835px;left:172px;white-space:nowrap" class="ft1108">Note&#160;that&#160;a&#160;PE&#160;certificate&#160;is&#160;an&#160;attribute&#160;certificate&#160;whereas&#160;XKMS&#160;is&#160;designed&#160;for</p>
<p style="position:absolute;top:853px;left:150px;white-space:nowrap" class="ft11015">X509&#160;certificates.&#160;An&#160;attribute&#160;certificate&#160;may&#160;be&#160;included&#160;somehow&#160;in&#160;raw&#160;form&#160;as<br/>array&#160;of&#160;bytes,&#160;but&#160;the&#160;feasibility&#160;of&#160;this&#160;concept&#160;still&#160;has&#160;to&#160;be&#160;determined.</p>
<p style="position:absolute;top:889px;left:172px;white-space:nowrap" class="ft1108">Note&#160;that&#160;it&#160;is&#160;a&#160;policy&#160;decision&#160;of&#160;the&#160;service&#160;whether&#160;the&#160;service&#160;only&#160;validates</p>
<p style="position:absolute;top:907px;left:150px;white-space:nowrap" class="ft11015">its&#160;own&#160;issued&#160;certificates&#160;or&#160;also&#160;uses&#160;external&#160;resources.&#160;E.g.,&#160;validation&#160;of&#160;an&#160;EK<br/>certificate&#160;may&#160;be&#160;done&#160;locally&#160;at&#160;the&#160;server&#160;if&#160;the&#160;certificate&#160;chain&#160;is&#160;known,&#160;however<br/>proper&#160;validation&#160;should&#160;also&#160;include&#160;a&#160;revocation&#160;check&#160;with&#160;a&#160;manufacturer&#160;PKI,&#160;if<br/>available.</p>
<p style="position:absolute;top:1019px;left:150px;white-space:nowrap" class="ft11024"><b>8.4.5</b></p>
<p style="position:absolute;top:1019px;left:204px;white-space:nowrap" class="ft11024"><b>RevokeRequest</b></p>
<p style="position:absolute;top:1049px;left:150px;white-space:nowrap" class="ft11014">An&#160;XKMS&#160;RevokeRequest&#160;manifests&#160;the&#160;desire&#160;to&#160;invalidate&#160;a&#160;previously&#160;issued&#160;bind-<br/>ing.&#160;The&#160;payload&#160;consists&#160;of&#160;what&#160;to&#160;revoke,&#160;a&#160;certificate,&#160;etc.:</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft11021">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 111 -->
<a name="111"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page111-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5111.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1118">CHAPTER&#160;8.&#160;PUBLIC&#160;KEY&#160;INFRASTRUCTURE</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1118">109</p>
<p style="position:absolute;top:206px;left:226px;white-space:nowrap" class="ft1118">&lt;?&#160;<b>xml&#160;v&#160;e&#160;r&#160;s&#160;i&#160;o&#160;n&#160;</b>=</p>
<p style="position:absolute;top:206px;left:353px;white-space:nowrap" class="ft111163"><i>&#34;&#160;1&#160;.&#160;0&#160;&#34;</i></p>
<p style="position:absolute;top:206px;left:407px;white-space:nowrap" class="ft1118">e&#160;n&#160;c&#160;o&#160;d&#160;i&#160;n&#160;g&#160;=</p>
<p style="position:absolute;top:206px;left:487px;white-space:nowrap" class="ft111163"><i>&#34;UTF</i></p>
<p style="position:absolute;top:205px;left:522px;white-space:nowrap" class="ft111164">−</p>
<p style="position:absolute;top:206px;left:533px;white-space:nowrap" class="ft111163"><i>8&#34;</i></p>
<p style="position:absolute;top:206px;left:550px;white-space:nowrap" class="ft1118">?&#160;&gt;</p>
<p style="position:absolute;top:224px;left:226px;white-space:nowrap" class="ft1118">&lt;&#160;<b>Rev&#160;o&#160;keRequest</b></p>
<p style="position:absolute;top:224px;left:365px;white-space:nowrap" class="ft1118">.&#160;.&#160;.&#160;&gt;</p>
<p style="position:absolute;top:242px;left:244px;white-space:nowrap" class="ft1118">&lt;&#160;<b>RevokeKeyBinding&#160;</b>I&#160;d&#160;=</p>
<p style="position:absolute;top:242px;left:434px;white-space:nowrap" class="ft111163"><i>&#34;&#160;.&#160;.&#160;.&#160;&#34;</i></p>
<p style="position:absolute;top:242px;left:478px;white-space:nowrap" class="ft1118">&gt;</p>
<p style="position:absolute;top:260px;left:262px;white-space:nowrap" class="ft1118">&lt;&#160;<b>Key&#160;Info</b></p>
<p style="position:absolute;top:260px;left:347px;white-space:nowrap" class="ft1118">.&#160;.&#160;.&#160;&gt;</p>
<p style="position:absolute;top:278px;left:280px;white-space:nowrap" class="ft1118">&lt;<b>X509Data</b>&gt;</p>
<p style="position:absolute;top:296px;left:298px;white-space:nowrap" class="ft1118">&lt;&#160;<b>X&#160;5&#160;0&#160;9&#160;C&#160;e&#160;r&#160;t&#160;i&#160;f&#160;i&#160;c&#160;a&#160;t&#160;e</b>&gt;&#160;.&#160;.&#160;.&#160;&lt;&#160;/&#160;<b>X&#160;5&#160;0&#160;9&#160;C&#160;e&#160;r&#160;t&#160;i&#160;f&#160;i&#160;c&#160;a&#160;t&#160;e</b>&gt;</p>
<p style="position:absolute;top:314px;left:280px;white-space:nowrap" class="ft1118">&lt;&#160;/&#160;<b>X509Data</b>&gt;</p>
<p style="position:absolute;top:332px;left:262px;white-space:nowrap" class="ft11114">&lt;&#160;/&#160;<b>Key&#160;Info&#160;</b>&gt;<br/>&lt;&#160;<b>S&#160;t&#160;a&#160;t&#160;u&#160;s</b></p>
<p style="position:absolute;top:368px;left:264px;white-space:nowrap" class="ft1118">S&#160;t&#160;a&#160;t&#160;u&#160;s&#160;V&#160;a&#160;l&#160;u&#160;e&#160;=</p>
<p style="position:absolute;top:368px;left:371px;white-space:nowrap" class="ft111163"><i>&#34;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www&#160;.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;2&#160;/&#160;0&#160;3&#160;/&#160;xkms&#160;#&#160;I&#160;n&#160;d&#160;e&#160;t&#160;e&#160;r&#160;m&#160;i&#160;n&#160;a&#160;t&#160;e&#160;&#34;</i></p>
<p style="position:absolute;top:368px;left:784px;white-space:nowrap" class="ft1118">/&#160;&gt;</p>
<p style="position:absolute;top:385px;left:244px;white-space:nowrap" class="ft11114">&lt;&#160;/&#160;<b>RevokeKeyBinding&#160;</b>&gt;<br/>&lt;&#160;<b>A&#160;u&#160;t&#160;h&#160;e&#160;n&#160;t&#160;i&#160;c&#160;a&#160;t&#160;i&#160;o&#160;n&#160;</b>&gt;</p>
<p style="position:absolute;top:421px;left:266px;white-space:nowrap" class="ft1118">.&#160;.&#160;.&#160;S&#160;i&#160;g&#160;n&#160;a&#160;t&#160;u&#160;r&#160;e</p>
<p style="position:absolute;top:421px;left:381px;white-space:nowrap" class="ft1118">r&#160;e&#160;f&#160;e&#160;r&#160;e&#160;n&#160;c&#160;i&#160;n&#160;g&#160;R&#160;e&#160;v&#160;o&#160;k&#160;e&#160;K&#160;e&#160;y&#160;B&#160;i&#160;n&#160;d&#160;i&#160;n&#160;g&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:439px;left:244px;white-space:nowrap" class="ft1118">&lt;&#160;/&#160;<b>A&#160;u&#160;t&#160;h&#160;e&#160;n&#160;t&#160;i&#160;c&#160;a&#160;t&#160;i&#160;o&#160;n&#160;</b>&gt;</p>
<p style="position:absolute;top:457px;left:226px;white-space:nowrap" class="ft1118">&lt;&#160;/&#160;<b>Rev&#160;o&#160;keRequest&#160;</b>&gt;</p>
<p style="position:absolute;top:493px;left:226px;white-space:nowrap" class="ft11114">It&#160;is&#160;expected&#160;that&#160;this&#160;function&#160;is&#160;always&#160;restricted&#160;to&#160;a&#160;specific&#160;client&#160;population,&#160;thus<br/>always&#160;requires&#160;an</p>
<p style="position:absolute;top:511px;left:341px;white-space:nowrap" class="ft11134">Authentication</p>
<p style="position:absolute;top:511px;left:470px;white-space:nowrap" class="ft1118">element.</p>
<p style="position:absolute;top:529px;left:248px;white-space:nowrap" class="ft1118">The&#160;response&#160;consists&#160;of&#160;a&#160;simple</p>
<p style="position:absolute;top:529px;left:453px;white-space:nowrap" class="ft11134">Success</p>
<p style="position:absolute;top:529px;left:519px;white-space:nowrap" class="ft1118">(or&#160;not):</p>
<p style="position:absolute;top:561px;left:226px;white-space:nowrap" class="ft1118">&lt;?&#160;<b>xml&#160;v&#160;e&#160;r&#160;s&#160;i&#160;o&#160;n&#160;</b>=</p>
<p style="position:absolute;top:561px;left:353px;white-space:nowrap" class="ft111163"><i>&#34;&#160;1&#160;.&#160;0&#160;&#34;</i></p>
<p style="position:absolute;top:561px;left:407px;white-space:nowrap" class="ft1118">e&#160;n&#160;c&#160;o&#160;d&#160;i&#160;n&#160;g&#160;=</p>
<p style="position:absolute;top:561px;left:487px;white-space:nowrap" class="ft111163"><i>&#34;UTF</i></p>
<p style="position:absolute;top:560px;left:522px;white-space:nowrap" class="ft111164">−</p>
<p style="position:absolute;top:561px;left:533px;white-space:nowrap" class="ft111163"><i>8&#34;</i></p>
<p style="position:absolute;top:561px;left:550px;white-space:nowrap" class="ft1118">?&#160;&gt;</p>
<p style="position:absolute;top:579px;left:226px;white-space:nowrap" class="ft1118">&lt;&#160;<b>R&#160;e&#160;v&#160;o&#160;k&#160;e&#160;R&#160;e&#160;s&#160;u&#160;l&#160;t</b></p>
<p style="position:absolute;top:579px;left:356px;white-space:nowrap" class="ft1118">.&#160;.&#160;.</p>
<p style="position:absolute;top:597px;left:246px;white-space:nowrap" class="ft1118">R&#160;e&#160;s&#160;u&#160;l&#160;t&#160;M&#160;a&#160;j&#160;o&#160;r&#160;=</p>
<p style="position:absolute;top:597px;left:353px;white-space:nowrap" class="ft111163"><i>&#34;&#160;h&#160;t&#160;t&#160;p&#160;:&#160;/&#160;/&#160;www&#160;.&#160;w3&#160;.&#160;o&#160;r&#160;g&#160;/&#160;2&#160;0&#160;0&#160;2&#160;/&#160;0&#160;3&#160;/&#160;xkms&#160;#&#160;S&#160;u&#160;c&#160;c&#160;e&#160;s&#160;s&#160;&#34;</i></p>
<p style="position:absolute;top:597px;left:711px;white-space:nowrap" class="ft1118">&gt;</p>
<p style="position:absolute;top:615px;left:244px;white-space:nowrap" class="ft1118">&lt;&#160;<b>S&#160;i&#160;g&#160;n&#160;a&#160;t&#160;u&#160;r&#160;e</b></p>
<p style="position:absolute;top:615px;left:346px;white-space:nowrap" class="ft1118">.&#160;.&#160;.&#160;&gt;</p>
<p style="position:absolute;top:633px;left:266px;white-space:nowrap" class="ft1118">.&#160;.&#160;.</p>
<p style="position:absolute;top:651px;left:244px;white-space:nowrap" class="ft1118">&lt;&#160;/&#160;<b>S&#160;i&#160;g&#160;n&#160;a&#160;t&#160;u&#160;r&#160;e&#160;</b>&gt;</p>
<p style="position:absolute;top:669px;left:226px;white-space:nowrap" class="ft1118">&lt;&#160;/&#160;<b>R&#160;e&#160;v&#160;o&#160;k&#160;e&#160;R&#160;e&#160;s&#160;u&#160;l&#160;t&#160;</b>&gt;</p>
<p style="position:absolute;top:704px;left:226px;white-space:nowrap" class="ft1118">The&#160;XKMS&#160;options&#160;of</p>
<p style="position:absolute;top:705px;left:371px;white-space:nowrap" class="ft11134">Authentication</p>
<p style="position:absolute;top:704px;left:502px;white-space:nowrap" class="ft1118">and/or</p>
<p style="position:absolute;top:705px;left:546px;white-space:nowrap" class="ft11134">RevocationCode</p>
<p style="position:absolute;top:704px;left:677px;white-space:nowrap" class="ft1118">require&#160;re-</p>
<p style="position:absolute;top:722px;left:226px;white-space:nowrap" class="ft11114">examination&#160;under&#160;Trusted&#160;Computing.&#160;Both&#160;represent&#160;an&#160;assurance&#160;to&#160;the&#160;service&#160;that<br/>one&#160;is&#160;a&#160;valid&#160;entity,&#160;allowed&#160;to&#160;withdraw/revoke&#160;information&#160;from&#160;the&#160;PKI.</p>
<p style="position:absolute;top:758px;left:248px;white-space:nowrap" class="ft1118">In&#160;the&#160;case&#160;of&#160;use&#160;of&#160;a</p>
<p style="position:absolute;top:759px;left:389px;white-space:nowrap" class="ft11134">RevocationCode</p>
<p style="position:absolute;top:758px;left:520px;white-space:nowrap" class="ft1118">during&#160;the&#160;RegisterRequest&#160;(see&#160;sec-</p>
<p style="position:absolute;top:776px;left:226px;white-space:nowrap" class="ft11114">tion&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#107">8.4.2)&#160;</a>a&#160;code&#160;is&#160;specified&#160;and&#160;only&#160;if&#160;a&#160;RevokeRequest&#160;supplies&#160;the&#160;identical&#160;code<br/>again&#160;the&#160;revocation&#160;is&#160;accepted.</p>
<p style="position:absolute;top:812px;left:248px;white-space:nowrap" class="ft1118">The</p>
<p style="position:absolute;top:813px;left:275px;white-space:nowrap" class="ft11134">Authentication</p>
<p style="position:absolute;top:812px;left:404px;white-space:nowrap" class="ft1118">signature&#160;can&#160;be&#160;generated&#160;from&#160;a&#160;shared&#160;secret&#160;–&#160;a&#160;pass-</p>
<p style="position:absolute;top:830px;left:226px;white-space:nowrap" class="ft1118">word.&#160;Usage&#160;of&#160;a&#160;(TPM)&#160;private&#160;key&#160;itself&#160;to&#160;generate&#160;an</p>
<p style="position:absolute;top:831px;left:569px;white-space:nowrap" class="ft11134">Authentication</p>
<p style="position:absolute;top:830px;left:698px;white-space:nowrap" class="ft1118">XKMS</p>
<p style="position:absolute;top:848px;left:226px;white-space:nowrap" class="ft11114">signature&#160;(effectively&#160;a&#160;proof&#160;of&#160;possession&#160;signature)&#160;is&#160;not&#160;always&#160;feasible&#160;in&#160;a&#160;trusted<br/>computing&#160;context.&#160;The&#160;private&#160;endorsement&#160;key&#160;is&#160;not&#160;available&#160;for&#160;generic&#160;crypto-<br/>graphic&#160;operations&#160;and&#160;the&#160;private&#160;key&#160;corresponding&#160;to&#160;an&#160;AIK&#160;certificate&#160;is&#160;also&#160;not<br/>designed&#160;to&#160;be&#160;used&#160;for&#160;arbitrary&#160;signing&#160;operations.</p>
<p style="position:absolute;top:960px;left:226px;white-space:nowrap" class="ft11124"><b>8.4.6</b></p>
<p style="position:absolute;top:960px;left:280px;white-space:nowrap" class="ft11124"><b>ReissueRequest</b></p>
<p style="position:absolute;top:990px;left:226px;white-space:nowrap" class="ft11115">XKMS&#160;ReissueRequests&#160;are&#160;similar&#160;to&#160;RegisterRequests&#160;(see&#160;section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#107">8.4.2)</a>,&#160;the&#160;goal<br/>being&#160;to&#160;issue&#160;the&#160;same&#160;item&#160;again.&#160;The&#160;obvious&#160;application&#160;is&#160;to&#160;forward&#160;an&#160;expired<br/>certificate&#160;and&#160;obtain&#160;a&#160;fresh&#160;one&#160;of&#160;same&#160;content,&#160;but&#160;with&#160;a&#160;new&#160;validity&#160;period&#160;(the<br/>old&#160;one&#160;getting&#160;revoked).</p>
<p style="position:absolute;top:1062px;left:248px;white-space:nowrap" class="ft1118">Issues&#160;of</p>
<p style="position:absolute;top:1063px;left:305px;white-space:nowrap" class="ft11134">Authentication</p>
<p style="position:absolute;top:1062px;left:434px;white-space:nowrap" class="ft1118">are&#160;similar&#160;to&#160;those&#160;described&#160;in&#160;section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#110">8.4.5.</a></p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft11121">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 112 -->
<a name="112"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page112-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5112.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1128">110</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft11221">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:172px;white-space:nowrap" class="ft1128">Reissuing&#160;Trusted&#160;Computing&#160;related&#160;credentials&#160;is&#160;out&#160;of&#160;scope&#160;for&#160;a&#160;basic&#160;PKI.</p>
<p style="position:absolute;top:212px;left:150px;white-space:nowrap" class="ft11214">This&#160;point&#160;may&#160;be&#160;revisited&#160;when&#160;more&#160;experiences&#160;with&#160;certificate&#160;life&#160;expectancy,<br/>usage&#160;scenarios&#160;and&#160;validity&#160;periods&#160;are&#160;available.</p>
<p style="position:absolute;top:288px;left:150px;white-space:nowrap" class="ft11224"><b>8.4.7</b></p>
<p style="position:absolute;top:288px;left:204px;white-space:nowrap" class="ft11224"><b>RecoverRequest</b></p>
<p style="position:absolute;top:318px;left:150px;white-space:nowrap" class="ft11214">The&#160;XKMS&#160;RecoverRequest&#160;serves&#160;to&#160;recover&#160;a&#160;private&#160;key&#160;associated&#160;with&#160;a&#160;previ-<br/>ously&#160;binding.&#160;This&#160;is&#160;only&#160;possible&#160;if&#160;the&#160;private&#160;key&#160;was&#160;previously&#160;escrowed&#160;at&#160;the<br/>server&#160;or&#160;server&#160;generated.&#160;In&#160;the&#160;context&#160;of&#160;a&#160;basic&#160;Trusted&#160;Computing&#160;infrastructure<br/>there&#160;is&#160;no&#160;application&#160;for&#160;this&#160;type&#160;of&#160;request,&#160;as&#160;this&#160;would&#160;invalidate&#160;the&#160;concept&#160;of<br/>TPM&#160;bound&#160;keys,&#160;thus&#160;can&#160;be&#160;ignored.</p>
<p style="position:absolute;top:454px;left:150px;white-space:nowrap" class="ft11226"><b>8.5</b></p>
<p style="position:absolute;top:454px;left:198px;white-space:nowrap" class="ft11226"><b>Open&#160;Issues</b></p>
<p style="position:absolute;top:492px;left:150px;white-space:nowrap" class="ft11214">Design&#160;and&#160;implementation&#160;of&#160;a&#160;basic&#160;trusted&#160;PKI&#160;for&#160;OpenTC&#160;highlights&#160;multiple<br/>issues&#160;to&#160;be&#160;considered.&#160;Among&#160;them&#160;are</p>
<p style="position:absolute;top:556px;left:172px;white-space:nowrap" class="ft11250">•</p>
<p style="position:absolute;top:557px;left:187px;white-space:nowrap" class="ft11214">Certificates&#160;and&#160;issuing&#160;authorities&#160;require&#160;clear&#160;and&#160;distinct&#160;policies.&#160;This&#160;in-<br/>cludes&#160;human&#160;readable&#160;text&#160;as&#160;well&#160;as&#160;associated&#160;Object&#160;Identifiers&#160;(OIDs)&#160;for<br/>automated&#160;processing.&#160;Only&#160;standardisation&#160;of&#160;these&#160;ensures&#160;interoperability&#160;and<br/>spreading&#160;of&#160;a&#160;Trusted&#160;Computing&#160;PKI.</p>
<p style="position:absolute;top:640px;left:172px;white-space:nowrap" class="ft11250">•</p>
<p style="position:absolute;top:641px;left:187px;white-space:nowrap" class="ft11215">The&#160;basic&#160;PKI&#160;outlined&#160;in&#160;this&#160;document&#160;assumes&#160;XKMS&#160;as&#160;transport&#160;protocol<br/>and&#160;no&#160;specific&#160;schema&#160;extensions&#160;for&#160;Trusted&#160;Computing.&#160;However,&#160;even&#160;a&#160;ba-<br/>sic&#160;scenario&#160;suggests&#160;that&#160;new&#160;URI&#160;string&#160;definitions&#160;for&#160;KeyUsage,&#160;UseKeyWith<br/>etc.&#160;would&#160;be&#160;useful&#160;to&#160;clearly&#160;distinguish&#160;TC&#160;specific&#160;operations&#160;from&#160;common<br/>PKI&#160;operations.</p>
<p style="position:absolute;top:742px;left:172px;white-space:nowrap" class="ft11250">•</p>
<p style="position:absolute;top:743px;left:187px;white-space:nowrap" class="ft11214">The&#160;public&#160;documents&#160;of&#160;the&#160;TCG&#160;currently&#160;only&#160;discuss&#160;security&#160;credentials<br/>in&#160;X509&#160;certificate&#160;format.&#160;Some&#160;documents&#160;however&#160;hint&#160;at&#160;the&#160;possibility&#160;of<br/>future&#160;XML&#160;based&#160;credentials.&#160;The&#160;inclusion&#160;of&#160;XML&#160;credentials&#160;directly&#160;in<br/>XKMS&#160;is&#160;a&#160;tempting&#160;outlook,&#160;however&#160;the&#160;resulting&#160;schema&#160;extensions&#160;and&#160;ef-<br/>fects&#160;on&#160;alternative&#160;protocols&#160;and&#160;designs&#160;have&#160;to&#160;be&#160;carefully&#160;considered.</p>
<p style="position:absolute;top:843px;left:172px;white-space:nowrap" class="ft11250">•</p>
<p style="position:absolute;top:844px;left:187px;white-space:nowrap" class="ft11215">At&#160;time&#160;of&#160;this&#160;writing&#160;the&#160;only&#160;TPM&#160;manufacturer&#160;shipping&#160;EK&#160;certificates&#160;with<br/>its&#160;TPM&#160;chips&#160;is&#160;Infineon.&#160;There&#160;are&#160;no&#160;known&#160;public&#160;platform&#160;certificates.&#160;There<br/>is&#160;no&#160;known&#160;public&#160;AIK&#160;cycle&#160;test.&#160;A&#160;first&#160;basic&#160;PKI&#160;implementation&#160;is&#160;hopefully<br/>a&#160;stimulus&#160;for&#160;accelerated&#160;development,&#160;but&#160;this&#160;highlights&#160;that&#160;this&#160;area&#160;is&#160;still<br/>under&#160;major&#160;development.&#160;Future&#160;design&#160;adoptions&#160;are&#160;to&#160;be&#160;expected.</p>
<p style="position:absolute;top:945px;left:172px;white-space:nowrap" class="ft11250">•</p>
<p style="position:absolute;top:946px;left:187px;white-space:nowrap" class="ft11214">The&#160;software&#160;platform&#160;designated&#160;to&#160;implement&#160;this&#160;first&#160;design&#160;on&#160;is&#160;Linux&#160;with<br/>its&#160;Trusted&#160;Software&#160;Stack&#160;(TSS)&#160;called&#160;TrouSerS&#160;<a href="http://trousers.sf.net">(</a></p>
<p style="position:absolute;top:965px;left:495px;white-space:nowrap" class="ft11234"><a href="http://trousers.sf.net">http://trousers.sf.</a></p>
<p style="position:absolute;top:983px;left:187px;white-space:nowrap" class="ft11234"><a href="http://trousers.sf.net">net</a></p>
<p style="position:absolute;top:982px;left:214px;white-space:nowrap" class="ft1128"><a href="http://trousers.sf.net">)</a>.&#160;At&#160;the&#160;time&#160;of&#160;writing&#160;this&#160;document&#160;this&#160;is&#160;the&#160;only&#160;freely&#160;available&#160;fully</p>
<p style="position:absolute;top:1000px;left:187px;white-space:nowrap" class="ft11214">implemented&#160;TSS&#160;for&#160;the&#160;Linux&#160;platform.&#160;Therefore&#160;all&#160;experiments&#160;and&#160;proto-<br/>typing&#160;is&#160;using&#160;the&#160;TrouSerS&#160;specific&#160;implementation&#160;of&#160;the&#160;AIK&#160;cycle.&#160;Being<br/>heavily&#160;tied&#160;to&#160;low&#160;level&#160;C&#160;structures,&#160;level&#160;of&#160;compatibility&#160;of&#160;the&#160;TrouSerS&#160;im-<br/>plementation&#160;with&#160;other&#160;TSS&#160;implementations&#160;is&#160;unknown.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft11221">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 113 -->
<a name="113"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page113-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5113.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1138">CHAPTER&#160;8.&#160;PUBLIC&#160;KEY&#160;INFRASTRUCTURE</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1138">111</p>
<p style="position:absolute;top:193px;left:248px;white-space:nowrap" class="ft11350">•</p>
<p style="position:absolute;top:194px;left:263px;white-space:nowrap" class="ft11315">We&#160;have&#160;developed&#160;prototype&#160;implementations&#160;of&#160;key&#160;TCG&#160;PKI&#160;components.&#160;We<br/>solved&#160;the&#160;cryptographic&#160;challenges&#160;of&#160;interacting&#160;with&#160;a&#160;TPM.&#160;To&#160;our&#160;knowl-<br/>edge&#160;we&#160;are&#160;the&#160;first&#160;to&#160;actually&#160;demonstrate&#160;a&#160;working&#160;public&#160;full&#160;PrivacyCA<br/>cycle,&#160;using&#160;TCG&#160;style&#160;certificates&#160;and&#160;a&#160;dedicated&#160;client-server&#160;network&#160;setup.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft11321">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 114 -->
<a name="114"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page114-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5114.png" alt="background image"/>
<p style="position:absolute;top:295px;left:150px;white-space:nowrap" class="ft11425"><b>Chapter&#160;9</b></p>
<p style="position:absolute;top:365px;left:150px;white-space:nowrap" class="ft11435"><b>An&#160;Efficient&#160;Implementation&#160;of<br/>Trusted&#160;Channels&#160;based&#160;on<br/>OpenSSL</b></p>
<p style="position:absolute;top:512px;left:169px;white-space:nowrap" class="ft1148">F.&#160;Armknecht,&#160;Y.&#160;Gasmi,&#160;A.&#160;Sadeghi,&#160;P.&#160;Stewin,&#160;M.&#160;Unger&#160;(RUB),&#160;G.&#160;Ramunno,&#160;D.</p>
<p style="position:absolute;top:530px;left:566px;white-space:nowrap" class="ft1148">Vernizzi&#160;(Polito)</p>
<p style="position:absolute;top:604px;left:150px;white-space:nowrap" class="ft11426"><b>9.1</b></p>
<p style="position:absolute;top:604px;left:198px;white-space:nowrap" class="ft11426"><b>Motivation</b></p>
<p style="position:absolute;top:642px;left:150px;white-space:nowrap" class="ft11414">Most&#160;of&#160;the&#160;security&#160;sensitive&#160;applications&#160;on&#160;the&#160;Internet&#160;(e.g.,&#160;online&#160;banking,&#160;eCom-<br/>merce&#160;and&#160;eGovernment)&#160;typically&#160;deploy&#160;secure&#160;channels&#160;such&#160;as&#160;TLS&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[27]&#160;</a>or&#160;IPSec<br/><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">[63]&#160;</a>to&#160;provide&#160;secure&#160;access&#160;to&#160;and&#160;communication&#160;with&#160;the&#160;corresponding&#160;services.<br/>These&#160;security&#160;protocols&#160;protect&#160;data&#160;during&#160;transmission&#160;and&#160;allow&#160;to&#160;authenticate<br/>the&#160;endpoints.&#160;However,&#160;they&#160;do&#160;not&#160;provide&#160;any&#160;protection&#160;from&#160;(maliciously)&#160;mod-<br/>ified&#160;software&#160;running&#160;on&#160;an&#160;endpoint.&#160;More&#160;precisely,&#160;setting-up&#160;a&#160;secure&#160;channel&#160;is<br/>currently&#160;not&#160;linked&#160;to&#160;the&#160;integrity&#160;of&#160;an&#160;endpoint.&#160;However,&#160;most&#160;attacks&#160;concern<br/>compromising&#160;the&#160;endpoints&#160;by&#160;injecting&#160;malicious&#160;code&#160;rather&#160;than&#160;compromising&#160;the<br/>secure&#160;channel.</p>
<p style="position:absolute;top:803px;left:172px;white-space:nowrap" class="ft1148">This&#160;leads&#160;to&#160;the&#160;central&#160;problem&#160;of&#160;today’s&#160;secure&#160;channel&#160;protocols:&#160;using&#160;a&#160;secure</p>
<p style="position:absolute;top:821px;left:150px;white-space:nowrap" class="ft1148">channel&#160;to&#160;communicate&#160;with&#160;an&#160;unknown&#160;peer&#160;opens&#160;doors&#160;for&#160;a&#160;wide&#160;range&#160;of&#160;attacks.</p>
<p style="position:absolute;top:839px;left:172px;white-space:nowrap" class="ft1148">Considering&#160;a&#160;corporate&#160;computing&#160;at&#160;home&#160;scenario&#160;the&#160;following&#160;could&#160;happen:</p>
<p style="position:absolute;top:857px;left:150px;white-space:nowrap" class="ft11414">an&#160;employee&#160;wants&#160;to&#160;access&#160;from&#160;home&#160;a&#160;corporate’s&#160;document&#160;management&#160;server<br/>to&#160;work&#160;on&#160;a&#160;confidential&#160;document.&#160;For&#160;this&#160;purpose&#160;he&#160;sets-up&#160;a&#160;secure&#160;channel&#160;to<br/>the&#160;company’s&#160;network&#160;and&#160;downloads&#160;the&#160;document.&#160;The&#160;problem&#160;consists&#160;in&#160;the&#160;fact<br/>that&#160;the&#160;employee&#160;opened&#160;an&#160;email&#160;attachment&#160;containing&#160;the&#160;executable&#160;of&#160;a&#160;Trojan<br/>the&#160;day&#160;before,&#160;which&#160;installed&#160;itself&#160;on&#160;the&#160;system&#160;at&#160;this&#160;very&#160;moment.&#160;Now,&#160;the<br/>attacker&#160;that&#160;sent&#160;the&#160;Trojan&#160;can&#160;access&#160;the&#160;employee’s&#160;computer&#160;and&#160;the&#160;document&#160;he<br/>just&#160;downloaded&#160;is&#160;compromised&#160;at&#160;the&#160;moment&#160;it&#160;was&#160;transferred&#160;to&#160;the&#160;employee’s<br/>system.</p>
<p style="position:absolute;top:1001px;left:172px;white-space:nowrap" class="ft1148">Hence,&#160;for&#160;the&#160;secure&#160;provision&#160;of&#160;digital&#160;services&#160;over&#160;the&#160;Internet&#160;endpoint&#160;in-</p>
<p style="position:absolute;top:1018px;left:150px;white-space:nowrap" class="ft11414">tegrity&#160;is&#160;vital.&#160;To&#160;avert&#160;such&#160;attack&#160;scenarios,&#160;information&#160;on&#160;the&#160;communication&#160;end-<br/>points&#160;integrity&#160;or&#160;configuration&#160;has&#160;to&#160;be&#160;provided&#160;in&#160;a&#160;secure&#160;and&#160;reliable&#160;manner,<br/>to&#160;enable&#160;the&#160;peers&#160;to&#160;judge&#160;each&#160;other’s&#160;“trustworthiness”&#160;based&#160;on&#160;the&#160;information<br/>received.</p>
<p style="position:absolute;top:1117px;left:396px;white-space:nowrap" class="ft1148">112</p>
</div>
<!-- Page 115 -->
<a name="115"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page115-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5115.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1158">CHAPTER&#160;9.&#160;TRUSTED&#160;CHANNELS&#160;USING&#160;OPENSSL</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1158">113</p>
<p style="position:absolute;top:194px;left:248px;white-space:nowrap" class="ft1158">Reporting&#160;integrity&#160;information&#160;of&#160;a&#160;remote&#160;platform&#160;is&#160;one&#160;of&#160;the&#160;main&#160;goals&#160;of</p>
<p style="position:absolute;top:212px;left:226px;white-space:nowrap" class="ft11514">Trusted&#160;Computing&#160;(TC)&#160;as&#160;proposed&#160;by&#160;the&#160;Trusted&#160;Computing&#160;Group&#160;(TCG,&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[114]</a>).<br/>The&#160;basic&#160;idea&#160;is&#160;to&#160;securely&#160;capture&#160;configuration&#160;information&#160;of&#160;the&#160;core&#160;components<br/>of&#160;the&#160;platform&#160;(firmware&#160;and&#160;software).&#160;This&#160;information&#160;is&#160;stored&#160;in&#160;a&#160;cost-effective,<br/>tamper-resistant&#160;Trusted&#160;Platform&#160;Module&#160;(TPM).&#160;The&#160;TPM&#160;in&#160;turn&#160;is&#160;mounted&#160;on&#160;the<br/>main&#160;board&#160;of&#160;the&#160;computing&#160;platform&#160;and&#160;acts&#160;as&#160;trust&#160;anchor.&#160;It&#160;can&#160;sign&#160;gathered<br/>configuration&#160;information&#160;and&#160;report&#160;it&#160;to&#160;a&#160;requesting&#160;party.&#160;This&#160;process&#160;is&#160;called</p>
<p style="position:absolute;top:318px;left:226px;white-space:nowrap" class="ft11546">attestation</p>
<p style="position:absolute;top:319px;left:303px;white-space:nowrap" class="ft1158">by&#160;the&#160;TCG.&#160;Additionally&#160;data&#160;can&#160;be&#160;stored&#160;bound&#160;to&#160;a&#160;specific&#160;platform</p>
<p style="position:absolute;top:337px;left:226px;white-space:nowrap" class="ft1158">configuration.&#160;The&#160;TCG&#160;calls&#160;this&#160;mechanism</p>
<p style="position:absolute;top:336px;left:503px;white-space:nowrap" class="ft11546">binding/sealing</p>
<p style="position:absolute;top:337px;left:613px;white-space:nowrap" class="ft1158">data.</p>
<p style="position:absolute;top:355px;left:248px;white-space:nowrap" class="ft1158">In&#160;this&#160;paper&#160;we&#160;focus&#160;on&#160;the&#160;combination&#160;of&#160;TCG&#160;TC&#160;functionalities&#160;and&#160;the&#160;TLS</p>
<p style="position:absolute;top:373px;left:226px;white-space:nowrap" class="ft11514">protocol&#160;to&#160;form&#160;a&#160;Trusted&#160;Channel.&#160;However,&#160;our&#160;solution&#160;can&#160;also&#160;be&#160;applied&#160;with<br/>IPSec&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">[63]</a>.&#160;Currently,&#160;we&#160;are&#160;considering&#160;an&#160;implementation&#160;of&#160;Trusted&#160;Channels&#160;for<br/>this&#160;protocol&#160;as&#160;well.</p>
<p style="position:absolute;top:427px;left:248px;white-space:nowrap" class="ft1158">The&#160;central&#160;feature&#160;of&#160;the&#160;Trusted&#160;Channel&#160;is&#160;the&#160;capability&#160;to&#160;provide&#160;reliable&#160;ev-</p>
<p style="position:absolute;top:445px;left:226px;white-space:nowrap" class="ft11515">idence&#160;concerning&#160;the&#160;trustworthiness&#160;of&#160;a&#160;communication&#160;partner.&#160;Furthermore,&#160;by<br/>means&#160;of&#160;a&#160;specific&#160;system&#160;architecture&#160;we&#160;are&#160;able&#160;to&#160;enforce&#160;the&#160;security&#160;of&#160;data&#160;not<br/>only&#160;during&#160;transmission&#160;but&#160;also&#160;on&#160;the&#160;involved&#160;endpoints.&#160;It&#160;has&#160;to&#160;be&#160;pointed&#160;out<br/>that&#160;the&#160;linkage&#160;of&#160;configuration&#160;information&#160;to&#160;the&#160;TLS&#160;channel&#160;is&#160;crucial&#160;to&#160;prevent&#160;<i>re-<br/>lay&#160;attacks&#160;</i>where&#160;the&#160;configuration&#160;of&#160;a&#160;third&#160;platform,&#160;deemed&#160;trustworthy,&#160;is&#160;relayed<br/>by&#160;an&#160;attacker,&#160;acting&#160;as&#160;Man-in-the-Middle&#160;(MitM).</p>
<p style="position:absolute;top:552px;left:248px;white-space:nowrap" class="ft1158">Linking&#160;endpoint&#160;configuration&#160;information&#160;to&#160;secure&#160;channels&#160;has&#160;been&#160;already</p>
<p style="position:absolute;top:570px;left:226px;white-space:nowrap" class="ft11514">investigated&#160;in&#160;the&#160;literature&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[43,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">108,&#160;98,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#172">79,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">56,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">22,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">84]</a>,&#160;often&#160;also&#160;combined&#160;with<br/>the&#160;TLS&#160;protocol&#160;because&#160;it&#160;is&#160;the&#160;most&#160;common&#160;protocol&#160;used&#160;in&#160;practice.&#160;The&#160;TCG<br/>also&#160;works&#160;on&#160;this&#160;issue&#160;in&#160;a&#160;specific&#160;working&#160;group&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[111,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">123]</a>.&#160;However,&#160;none&#160;of<br/>the&#160;solutions&#160;so&#160;far&#160;addresses&#160;the&#160;problem&#160;fully.&#160;Some&#160;of&#160;the&#160;approaches&#160;only&#160;provide<br/>an&#160;insecure&#160;linkage&#160;between&#160;the&#160;secure&#160;channel&#160;and&#160;integrity&#160;information,&#160;thus&#160;MitM<br/>attacks&#160;seem&#160;still&#160;possible.&#160;Others&#160;in&#160;turn,&#160;have&#160;problems&#160;concerning&#160;their&#160;performance<br/>in&#160;a&#160;server&#160;environment&#160;or&#160;required&#160;costly&#160;acquisitions&#160;of,&#160;e.g.,&#160;specific&#160;cryptographic<br/>hardware&#160;(see&#160;Related&#160;Work&#160;in&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[10]</a>).</p>
<p style="position:absolute;top:714px;left:248px;white-space:nowrap" class="ft1158">In&#160;a&#160;recent&#160;approach&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[10]&#160;</a>a&#160;protocol&#160;and&#160;a&#160;generic&#160;system&#160;architecture&#160;for&#160;establish-</p>
<p style="position:absolute;top:732px;left:226px;white-space:nowrap" class="ft11515">ing&#160;and&#160;maintaining&#160;Trusted&#160;Channels,&#160;using&#160;TC&#160;functionalities&#160;and&#160;the&#160;TLS&#160;protocol,<br/>was&#160;proposed&#160;that&#160;overcomes&#160;most&#160;of&#160;the&#160;shortcomings&#160;identified&#160;in&#160;the&#160;afore&#160;refer-<br/>enced&#160;work.&#160;However,&#160;the&#160;solution&#160;in&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[10]&#160;</a>has&#160;some&#160;deficiencies&#160;that&#160;our&#160;solution&#160;aims<br/>to&#160;tackle:&#160;first,&#160;some&#160;features&#160;do&#160;not&#160;conform&#160;to&#160;the&#160;TLS&#160;specification&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[27]</a>,&#160;e.g.,&#160;send-<br/>ing&#160;attestation&#160;data&#160;within&#160;the&#160;key&#160;exchange&#160;messages,&#160;or&#160;including&#160;integrity&#160;data&#160;in<br/>session&#160;key&#160;computation.&#160;Changing&#160;central&#160;message&#160;formats&#160;or&#160;computations&#160;of&#160;the<br/>TLS&#160;protocol&#160;would&#160;result&#160;in&#160;a&#160;time-consuming&#160;and&#160;costly&#160;re-specification&#160;process&#160;as<br/>well&#160;as&#160;an&#160;extensive&#160;evaluation&#160;of&#160;security&#160;implications&#160;and&#160;backward&#160;compatibility.<br/>Second,&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[10]&#160;</a>supports&#160;only&#160;RSA&#160;key&#160;transport,&#160;however,&#160;<i>Diffie-Hellman&#160;</i>(DH)&#160;can&#160;pro-<br/>vide&#160;perfect&#160;forward&#160;secrecy&#160;of&#160;session&#160;keys&#160;and&#160;is&#160;also&#160;used&#160;by&#160;a&#160;multitude&#160;of&#160;servers.<br/>Third,&#160;fundamental&#160;functional&#160;requirements,&#160;like&#160;e.g.,&#160;backward&#160;compatibility&#160;–&#160;to&#160;al-<br/>low&#160;communication&#160;with&#160;systems&#160;that&#160;do&#160;not&#160;support&#160;integrity&#160;reporting&#160;–&#160;or&#160;costs&#160;of<br/>certification&#160;processes&#160;are&#160;not&#160;considered.&#160;Certification&#160;by,&#160;e.g.,&#160;VeriSign&#160;is&#160;costly.&#160;This<br/>means&#160;re-certification&#160;should&#160;take&#160;place&#160;very&#160;seldom,&#160;whereas&#160;in&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[10]&#160;</a>re-certification<br/>would&#160;be&#160;necessary&#160;every&#160;time&#160;the&#160;system&#160;is&#160;updated,&#160;which&#160;is&#160;the&#160;case&#160;in&#160;practice<br/>since&#160;systems&#160;are&#160;updated&#160;regularly&#160;to&#160;overcome&#160;security&#160;problems&#160;or&#160;to&#160;incorporate<br/>new&#160;functionalities.</p>
<p style="position:absolute;top:1059px;left:226px;white-space:nowrap" class="ft11523"><b>Main&#160;Contribution:&#160;</b>To&#160;overcome&#160;the&#160;described&#160;shortcomings&#160;we&#160;present&#160;a&#160;new&#160;ap-</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft11521">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 116 -->
<a name="116"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page116-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5116.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1168">114</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft11621">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft11615">proach&#160;that&#160;bases&#160;on&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[10]&#160;</a>but,&#160;strictly&#160;conforms&#160;to&#160;the&#160;guidelines&#160;of&#160;the&#160;TLS&#160;speci-<br/>fication&#160;and&#160;respects&#160;central&#160;functional&#160;requirements&#160;listed&#160;in&#160;detail&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#117">9.2.2.<br/></a>Additionally,&#160;we&#160;focus&#160;on&#160;a&#160;proof&#160;of&#160;concept&#160;implementation&#160;of&#160;the&#160;new&#160;handshake<br/>protocol&#160;to&#160;enable&#160;the&#160;deployment&#160;of&#160;our&#160;approach.</p>
<p style="position:absolute;top:270px;left:150px;white-space:nowrap" class="ft11614">Thus,&#160;our&#160;main&#160;contribution&#160;is&#160;that&#160;our&#160;concept&#160;(1)&#160;fully&#160;adheres&#160;to&#160;the&#160;TLS&#160;specifica-<br/>tion&#160;and&#160;uses&#160;existing&#160;message&#160;extension&#160;formats&#160;to&#160;convey&#160;configuration&#160;information.<br/>To&#160;further&#160;facilitate&#160;a&#160;widespread&#160;deployment&#160;we&#160;(2)&#160;designed&#160;our&#160;concept&#160;to&#160;incor-<br/>porate&#160;functional&#160;requirements&#160;like,&#160;e.g.,&#160;the&#160;possibility&#160;to&#160;update&#160;systems&#160;without&#160;the<br/>need&#160;for&#160;re-certification,&#160;backward&#160;compatibility,&#160;high-performance&#160;system&#160;design&#160;as<br/>well&#160;as&#160;incurring&#160;no&#160;additional&#160;costs&#160;for&#160;the&#160;users&#160;by&#160;requiring&#160;the&#160;use&#160;of&#160;expensive<br/>cryptographic&#160;hardware&#160;or&#160;extensive&#160;software&#160;adaptations.&#160;Apart&#160;from&#160;that&#160;(3)&#160;support<br/>for&#160;all&#160;relevant&#160;kinds&#160;of&#160;key&#160;exchange&#160;methods&#160;is&#160;provided.&#160;Furthermore,&#160;we&#160;(4)&#160;pro-<br/>vide&#160;stronger&#160;forward&#160;secrecy&#160;of&#160;session&#160;keys&#160;regarding&#160;the&#160;RSA&#160;key&#160;exchange&#160;method,<br/>because&#160;keys&#160;are&#160;held&#160;protected&#160;by&#160;hardware,&#160;rendering&#160;their&#160;disclosure&#160;very&#160;difficult.<br/>Finally,&#160;we&#160;(5)&#160;present&#160;a&#160;proof&#160;of&#160;concept&#160;implementation&#160;of&#160;our&#160;Trusted&#160;Channel&#160;pro-<br/>tocol.</p>
<p style="position:absolute;top:489px;left:150px;white-space:nowrap" class="ft11614"><b>Outline:&#160;</b>In&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#116">9.2&#160;</a>and&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#117">9.3,&#160;</a>we&#160;specify&#160;properties&#160;and&#160;basic&#160;terms&#160;related<br/>to&#160;Trusted&#160;Channels,&#160;followed&#160;by&#160;our&#160;adapted&#160;TLS&#160;handshake&#160;protocol&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#118">9.4.<br/></a>Subsequently,&#160;we&#160;provide&#160;a&#160;detailed&#160;description&#160;of&#160;the&#160;modifications&#160;to&#160;the&#160;handshake<br/>messages&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#121">9.5.&#160;</a>In&#160;the&#160;Sections&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#124">9.6&#160;</a>and&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#126">9.7,&#160;</a>we&#160;first&#160;describe&#160;the&#160;logical<br/>architecture&#160;and&#160;then&#160;the&#160;implementation&#160;of&#160;our&#160;approach.&#160;Finally,&#160;in&#160;Sections&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#129">9.8&#160;</a>and<br/><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#130">9.9,&#160;</a>we&#160;evaluate&#160;the&#160;whole&#160;concept&#160;with&#160;regard&#160;to&#160;the&#160;security-related&#160;as&#160;well&#160;as&#160;the<br/>functional&#160;requirements&#160;enlisted&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#116">9.2,&#160;</a>concluded&#160;by&#160;a&#160;short&#160;Summary.</p>
<p style="position:absolute;top:665px;left:150px;white-space:nowrap" class="ft11626"><b>9.2</b></p>
<p style="position:absolute;top:665px;left:198px;white-space:nowrap" class="ft11626"><b>Requirement&#160;Analysis</b></p>
<p style="position:absolute;top:703px;left:150px;white-space:nowrap" class="ft11614">In&#160;this&#160;Section&#160;we&#160;define&#160;the&#160;properties&#160;of&#160;our&#160;Trusted&#160;Channel&#160;concept&#160;and&#160;derive&#160;the<br/>requirements&#160;necessary&#160;to&#160;provide&#160;those&#160;properties.<br/><b>Adversary&#160;Model</b>:&#160;The&#160;attacker&#160;may&#160;be&#160;a&#160;malicious&#160;third&#160;party,&#160;a&#160;user&#160;or&#160;even&#160;the&#160;ad-<br/>ministrator&#160;of&#160;a&#160;platform,&#160;either&#160;eavesdropping&#160;the&#160;communication&#160;between&#160;two&#160;plat-<br/>forms&#160;or&#160;controlling&#160;one&#160;of&#160;the&#160;peers&#160;directly&#160;involved&#160;in&#160;the&#160;communication.&#160;The<br/>adversary&#160;is&#160;capable&#160;to&#160;manipulate&#160;the&#160;software&#160;running&#160;on&#160;a&#160;platform,&#160;further&#160;he&#160;can<br/>eavesdrop,&#160;replace,&#160;replay,&#160;relay&#160;or&#160;manipulate&#160;data&#160;transferred.&#160;But,&#160;we&#160;do&#160;not&#160;con-<br/>sider&#160;sophisticated&#160;invasive&#160;or&#160;non-invasive&#160;hardware&#160;attacks&#160;on&#160;involved&#160;platforms.</p>
<p style="position:absolute;top:888px;left:150px;white-space:nowrap" class="ft11624"><b>9.2.1</b></p>
<p style="position:absolute;top:888px;left:208px;white-space:nowrap" class="ft11624"><b>Security&#160;Requirements</b></p>
<p style="position:absolute;top:918px;left:150px;white-space:nowrap" class="ft1168">We&#160;adopt&#160;the&#160;security&#160;requirements&#160;presented&#160;in&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[10]&#160;</a>for&#160;a&#160;Trusted&#160;Channel:</p>
<p style="position:absolute;top:958px;left:157px;white-space:nowrap" class="ft11623"><b>(SR1)&#160;Secure&#160;channel&#160;properties:&#160;</b>Integrity&#160;and&#160;confidentiality&#160;of&#160;data,&#160;freshness&#160;to</p>
<p style="position:absolute;top:976px;left:180px;white-space:nowrap" class="ft11614">prevent&#160;replay&#160;attacks,&#160;and&#160;authenticity&#160;both&#160;during&#160;transmission&#160;as&#160;well&#160;as&#160;within<br/>the&#160;endpoints&#160;have&#160;to&#160;be&#160;provided.</p>
<p style="position:absolute;top:1016px;left:157px;white-space:nowrap" class="ft11623"><b>(SR2)&#160;Authentic&#160;linkage&#160;of&#160;configuration/integrity&#160;information&#160;and&#160;secure&#160;chan-</b></p>
<p style="position:absolute;top:1034px;left:180px;white-space:nowrap" class="ft11615"><b>nel:&#160;</b>Authentic&#160;configuration/integrity&#160;information&#160;must&#160;be&#160;bound&#160;to&#160;the&#160;trusted<br/>channel&#160;(i.e.,&#160;during&#160;the&#160;establishment&#160;and&#160;while&#160;the&#160;Trusted&#160;Channel&#160;is&#160;in&#160;place,<br/>e.g.,&#160;the&#160;system&#160;state&#160;changes)&#160;to&#160;prevent&#160;relay&#160;attacks.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft11621">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 117 -->
<a name="117"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page117-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5117.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1178">CHAPTER&#160;9.&#160;TRUSTED&#160;CHANNELS&#160;USING&#160;OPENSSL</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1178">115</p>
<p style="position:absolute;top:194px;left:233px;white-space:nowrap" class="ft11723"><b>(SR3)&#160;Privacy:&#160;</b>Creation&#160;and&#160;maintenance&#160;of&#160;the&#160;channel&#160;should&#160;adhere&#160;to&#160;the&#160;least</p>
<p style="position:absolute;top:212px;left:256px;white-space:nowrap" class="ft11714">information&#160;paradigm,&#160;i.e.,&#160;disclosure&#160;of&#160;a&#160;platform’s&#160;configuration/integrity&#160;infor-<br/>mation&#160;not&#160;beyond&#160;what&#160;is&#160;necessary&#160;for&#160;proper&#160;integrity&#160;validation.&#160;Furthermore,<br/>platform&#160;configuration&#160;information&#160;has&#160;to&#160;be&#160;protected&#160;against&#160;disclosure&#160;to&#160;a&#160;third<br/>party.</p>
<p style="position:absolute;top:328px;left:226px;white-space:nowrap" class="ft11724"><b>9.2.2</b></p>
<p style="position:absolute;top:328px;left:280px;white-space:nowrap" class="ft11724"><b>Functional&#160;Requirements</b></p>
<p style="position:absolute;top:359px;left:226px;white-space:nowrap" class="ft11714">Looking&#160;at&#160;the&#160;wide&#160;area&#160;of&#160;application&#160;of&#160;TLS&#160;on,&#160;e.g.,&#160;servers,&#160;desktop-PCs,&#160;laptops<br/>and&#160;infrastructure&#160;devices&#160;like&#160;gateways,&#160;all&#160;with&#160;different&#160;functional&#160;needs&#160;concern-<br/>ing&#160;the&#160;setup&#160;of&#160;Trusted&#160;Channels,&#160;our&#160;solution&#160;has&#160;to&#160;adhere&#160;to&#160;some&#160;core&#160;functional<br/>requirements:</p>
<p style="position:absolute;top:435px;left:233px;white-space:nowrap" class="ft11723"><b>(FR1)&#160;Fast&#160;deployment&#160;support:&#160;</b>The&#160;alterations&#160;to&#160;existing&#160;software&#160;and&#160;hardware</p>
<p style="position:absolute;top:453px;left:256px;white-space:nowrap" class="ft11714">environments&#160;should&#160;be&#160;minimal&#160;and&#160;additional&#160;concepts&#160;introduced&#160;should&#160;make<br/>use&#160;of&#160;and&#160;have&#160;to&#160;adhere&#160;to&#160;existing&#160;specifications.&#160;In&#160;addition,&#160;all&#160;relevant&#160;key<br/>exchange&#160;techniques&#160;have&#160;to&#160;be&#160;supported.</p>
<p style="position:absolute;top:511px;left:233px;white-space:nowrap" class="ft11723"><b>(FR2)&#160;Minimal&#160;costs:&#160;</b>The&#160;whole&#160;approach&#160;must&#160;not&#160;incur&#160;additional&#160;costs&#160;for&#160;users</p>
<p style="position:absolute;top:529px;left:256px;white-space:nowrap" class="ft1178">like,&#160;e.g.,&#160;for&#160;expensive&#160;hardware,&#160;software&#160;or&#160;certification.</p>
<p style="position:absolute;top:551px;left:233px;white-space:nowrap" class="ft11723"><b>(FR3)&#160;Minimal&#160;overhead&#160;during&#160;handshake:&#160;</b>The&#160;overhead&#160;induced&#160;to&#160;the&#160;hand-</p>
<p style="position:absolute;top:569px;left:256px;white-space:nowrap" class="ft11714">shake&#160;by&#160;setting-up&#160;a&#160;Trusted&#160;Channel&#160;has&#160;to&#160;be&#160;minimal&#160;compared&#160;to&#160;setting-up<br/>a&#160;common&#160;secure&#160;channel.</p>
<p style="position:absolute;top:610px;left:233px;white-space:nowrap" class="ft11723"><b>(FR4)&#160;Flexible&#160;configuration/integrity&#160;reporting:&#160;</b>It&#160;has&#160;to&#160;be&#160;possible&#160;to&#160;apply&#160;dif-</p>
<p style="position:absolute;top:628px;left:256px;white-space:nowrap" class="ft11714">ferent&#160;approaches&#160;for&#160;integrity&#160;reporting&#160;to&#160;support&#160;a&#160;multitude&#160;of&#160;differing&#160;sys-<br/>tems&#160;and&#160;use-case&#160;designs.</p>
<p style="position:absolute;top:668px;left:233px;white-space:nowrap" class="ft11723"><b>(FR5)&#160;Backward&#160;compatibility:&#160;</b>Systems&#160;supporting&#160;the&#160;Trusted&#160;Channel&#160;approach</p>
<p style="position:absolute;top:686px;left:256px;white-space:nowrap" class="ft11714">have&#160;to&#160;be&#160;able&#160;to&#160;establish&#160;conventional&#160;secure&#160;channels,&#160;e.g.,&#160;to&#160;peers&#160;that&#160;do&#160;not<br/>provide&#160;the&#160;means&#160;to&#160;set-up&#160;Trusted&#160;Channels.</p>
<p style="position:absolute;top:772px;left:226px;white-space:nowrap" class="ft11726"><b>9.3</b></p>
<p style="position:absolute;top:772px;left:275px;white-space:nowrap" class="ft11726"><b>Basic&#160;Definitions</b></p>
<p style="position:absolute;top:810px;left:226px;white-space:nowrap" class="ft1178">The&#160;underlying&#160;system&#160;architecture&#160;considers&#160;client&#160;-&#160;server&#160;(</p>
<p style="position:absolute;top:809px;left:609px;white-space:nowrap" class="ft11750">C</p>
<p style="position:absolute;top:810px;left:618px;white-space:nowrap" class="ft1178">,</p>
<p style="position:absolute;top:809px;left:628px;white-space:nowrap" class="ft11750">S</p>
<p style="position:absolute;top:810px;left:638px;white-space:nowrap" class="ft1178">)&#160;communication</p>
<p style="position:absolute;top:828px;left:226px;white-space:nowrap" class="ft11714">where&#160;each&#160;involved&#160;endpoint&#160;may&#160;require&#160;configuration/integrity&#160;information&#160;of&#160;the<br/>other&#160;endpoint&#160;to&#160;be&#160;able&#160;to&#160;judge&#160;its&#160;trustworthiness.</p>
<p style="position:absolute;top:864px;left:248px;white-space:nowrap" class="ft1178">The&#160;evaluation&#160;of&#160;configuration&#160;information&#160;is&#160;done&#160;according&#160;to&#160;the&#160;locally&#160;ap-</p>
<p style="position:absolute;top:882px;left:226px;white-space:nowrap" class="ft11714">plied&#160;<i>security&#160;policy</i>.&#160;If&#160;the&#160;other&#160;endpoint’s&#160;configuration&#160;information&#160;conforms&#160;to<br/>the&#160;security&#160;policy,&#160;this&#160;endpoint&#160;is&#160;considered&#160;to&#160;be&#160;trustworthy.&#160;This&#160;security&#160;policy<br/>consists&#160;of&#160;a&#160;set&#160;of&#160;requirements&#160;and&#160;guidelines&#160;that&#160;have&#160;to&#160;be&#160;fulfilled&#160;by&#160;the&#160;platform<br/>configuration&#160;of&#160;the&#160;counterpart,&#160;e.g.,&#160;that&#160;an&#160;appropriate&#160;operating&#160;system&#160;and&#160;access<br/>control&#160;mechanism&#160;are&#160;in&#160;place,&#160;etc.</p>
<p style="position:absolute;top:971px;left:248px;white-space:nowrap" class="ft1178">The&#160;configuration&#160;of&#160;a&#160;platform&#160;is&#160;represented&#160;by&#160;a&#160;combination&#160;of&#160;credentials</p>
<p style="position:absolute;top:989px;left:226px;white-space:nowrap" class="ft1178">vouching&#160;for&#160;security&#160;relevant</p>
<p style="position:absolute;top:989px;left:420px;white-space:nowrap" class="ft11753">properties</p>
<p style="position:absolute;top:989px;left:491px;white-space:nowrap" class="ft1178">of&#160;the&#160;platform’s&#160;components&#160;(hardware</p>
<p style="position:absolute;top:1007px;left:226px;white-space:nowrap" class="ft1178">and/or&#160;software).&#160;Deriving&#160;those</p>
<p style="position:absolute;top:1007px;left:423px;white-space:nowrap" class="ft11753">properties</p>
<p style="position:absolute;top:1007px;left:491px;white-space:nowrap" class="ft1178">can&#160;be&#160;done&#160;in&#160;different&#160;ways&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[96,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">47,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">37]</a>.</p>
<p style="position:absolute;top:1025px;left:226px;white-space:nowrap" class="ft11714">The&#160;TCG&#160;proposes&#160;to&#160;compute&#160;SHA1&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[34]&#160;</a>hash&#160;values&#160;over&#160;code&#160;(software/firmware)<br/>for&#160;that&#160;purpose.&#160;The&#160;mechanism&#160;of&#160;deriving&#160;these&#160;hash&#160;values&#160;is&#160;called</p>
<p style="position:absolute;top:1042px;left:679px;white-space:nowrap" class="ft11746">measure</p>
<p style="position:absolute;top:1043px;left:737px;white-space:nowrap" class="ft1178">-</p>
<p style="position:absolute;top:1060px;left:226px;white-space:nowrap" class="ft11746">ment</p>
<p style="position:absolute;top:1061px;left:261px;white-space:nowrap" class="ft1178">.&#160;These&#160;hash&#160;values&#160;are&#160;designated&#160;as</p>
<p style="position:absolute;top:1060px;left:490px;white-space:nowrap" class="ft11746">digitalf&#160;ingerprints</p>
<p style="position:absolute;top:1061px;left:620px;white-space:nowrap" class="ft1178">,&#160;since&#160;they&#160;are&#160;used</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft11721">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 118 -->
<a name="118"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft118165{font-size:12px;font-family:UABXEI+CMSS8;color:#231f20;}
-->
</style>
<div id="page118-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5118.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1188">116</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft11821">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft1188">to&#160;unambiguously&#160;identify&#160;components.</p>
<p style="position:absolute;top:212px;left:172px;white-space:nowrap" class="ft1188">To&#160;be&#160;able&#160;to&#160;derive&#160;the&#160;trustworthiness&#160;of&#160;a&#160;platform&#160;we&#160;have&#160;to&#160;compare&#160;the&#160;digital</p>
<p style="position:absolute;top:230px;left:150px;white-space:nowrap" class="ft1188">fingerprints&#160;reported&#160;by&#160;a&#160;counterpart&#160;to</p>
<p style="position:absolute;top:229px;left:397px;white-space:nowrap" class="ft11846">ref&#160;erence&#160;values</p>
<p style="position:absolute;top:230px;left:512px;white-space:nowrap" class="ft1188">.&#160;In&#160;our&#160;approach</p>
<p style="position:absolute;top:229px;left:623px;white-space:nowrap" class="ft11846">ref&#160;er</p>
<p style="position:absolute;top:230px;left:660px;white-space:nowrap" class="ft1188">-</p>
<p style="position:absolute;top:246px;left:150px;white-space:nowrap" class="ft11846">ence&#160;values</p>
<p style="position:absolute;top:247px;left:228px;white-space:nowrap" class="ft1188">represent&#160;digital&#160;fingerprints&#160;provided&#160;and&#160;signed&#160;by&#160;a&#160;Trusted&#160;Third&#160;Party</p>
<p style="position:absolute;top:265px;left:150px;white-space:nowrap" class="ft11815">(e.g.,&#160;the&#160;distributor&#160;or&#160;manufacturer&#160;of&#160;a&#160;component).&#160;Alternatively,&#160;whole&#160;certificates<br/>can&#160;be&#160;used&#160;to&#160;vouch&#160;for&#160;certain&#160;properties&#160;of&#160;the&#160;respective&#160;components.</p>
<p style="position:absolute;top:301px;left:172px;white-space:nowrap" class="ft1188">The&#160;communication&#160;endpoints&#160;of&#160;our&#160;implementation&#160;operate&#160;based&#160;on&#160;<i>compart-</i></p>
<p style="position:absolute;top:319px;left:150px;white-space:nowrap" class="ft11814"><i>ments</i>.&#160;A&#160;compartment&#160;consists&#160;of&#160;one&#160;or&#160;a&#160;group&#160;of&#160;software&#160;components&#160;that&#160;is&#160;log-<br/>ically&#160;isolated&#160;from&#160;other&#160;software&#160;components.&#160;Isolation&#160;means&#160;that&#160;a&#160;compartment<br/>can&#160;only&#160;access&#160;data&#160;of&#160;another&#160;compartment&#160;using&#160;specified&#160;interfaces&#160;provided&#160;by&#160;a<br/>controlling&#160;instance.</p>
<p style="position:absolute;top:391px;left:172px;white-space:nowrap" class="ft1188">The&#160;set&#160;of&#160;all&#160;security&#160;critical&#160;software&#160;and&#160;hardware&#160;components&#160;of&#160;a&#160;platform</p>
<p style="position:absolute;top:409px;left:150px;white-space:nowrap" class="ft11814">responsible&#160;for&#160;preserving&#160;its&#160;trustworthiness&#160;is&#160;called&#160;<i>Trusted&#160;Computing&#160;Base&#160;</i>(TCB).<br/>Thus,&#160;it&#160;is&#160;crucial&#160;to&#160;keep&#160;the&#160;TCB&#160;isolated&#160;and&#160;as&#160;small&#160;as&#160;possible&#160;to&#160;avoid&#160;known<br/>problems&#160;and&#160;vulnerabilities&#160;arising&#160;along&#160;with&#160;code&#160;complexity.</p>
<p style="position:absolute;top:463px;left:172px;white-space:nowrap" class="ft1188">The&#160;central&#160;component&#160;of&#160;the&#160;TCB&#160;is&#160;formed&#160;by&#160;the&#160;TPM,&#160;which&#160;is&#160;currently&#160;im-</p>
<p style="position:absolute;top:480px;left:150px;white-space:nowrap" class="ft11815">plemented&#160;as&#160;a&#160;dedicated&#160;hardware&#160;chip.&#160;It&#160;offers&#160;amongst&#160;others&#160;a&#160;<i>cryptographic&#160;hash<br/>function&#160;</i>(SHA-1),&#160;a&#160;<i>cryptographic&#160;engine&#160;</i>(RSA)&#160;for&#160;encryption/decryption&#160;and&#160;sign-<br/>ing,&#160;a&#160;hardware-based&#160;<i>Random&#160;Number&#160;Generator&#160;</i>(RNG),&#160;hardware&#160;protected&#160;<i>mono-<br/>tonic&#160;counters&#160;</i>as&#160;well&#160;as&#160;some&#160;amount&#160;of&#160;<i>protected&#160;storage</i>.&#160;It&#160;provides&#160;a&#160;set&#160;of&#160;registers<br/>in&#160;protected&#160;storage&#160;called&#160;<i>Platform&#160;Configuration&#160;Registers&#160;</i>(PCR)&#160;that&#160;can&#160;be&#160;used&#160;to<br/>store&#160;hash&#160;values.&#160;The&#160;value&#160;of&#160;a&#160;PCR&#160;can&#160;only&#160;be&#160;modified&#160;in&#160;a&#160;predefined&#160;wa<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#118">y</a></p>
<p style="position:absolute;top:568px;left:656px;white-space:nowrap" class="ft11827"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#118">1</a></p>
<p style="position:absolute;top:570px;left:662px;white-space:nowrap" class="ft1188"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#118">.</a></p>
<p style="position:absolute;top:588px;left:150px;white-space:nowrap" class="ft11840">Protected&#160;storage&#160;is&#160;also&#160;used&#160;to&#160;store&#160;certain&#160;security&#160;sensitive&#160;keys,&#160;e.g.,&#160;<i>Attestation<br/>Identity&#160;Key<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#118">s</a></i></p>
<p style="position:absolute;top:604px;left:227px;white-space:nowrap" class="ft11827"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#118">2</a></p>
<p style="position:absolute;top:606px;left:237px;white-space:nowrap" class="ft1188">(AIKs)&#160;or&#160;the</p>
<p style="position:absolute;top:605px;left:321px;white-space:nowrap" class="ft11846">Storage&#160;Root&#160;Ke<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#118">y</a></p>
<p style="position:absolute;top:604px;left:441px;white-space:nowrap" class="ft11827"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#118">3</a></p>
<p style="position:absolute;top:606px;left:451px;white-space:nowrap" class="ft1188">(SRK).</p>
<p style="position:absolute;top:624px;left:172px;white-space:nowrap" class="ft1188">To&#160;improve&#160;security&#160;of&#160;the&#160;common&#160;TLS&#160;protocol,&#160;we&#160;move&#160;all&#160;security&#160;relevant</p>
<p style="position:absolute;top:642px;left:150px;white-space:nowrap" class="ft11814">operations&#160;like,&#160;e.g.,&#160;encryption,&#160;signing&#160;and&#160;the&#160;handling&#160;of&#160;credentials&#160;to&#160;the&#160;TCB,<br/>whose&#160;code&#160;is&#160;protected&#160;against&#160;a&#160;wide&#160;range&#160;of&#160;attacks&#160;(see&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#124">9.6)&#160;</a>running&#160;in<br/>separate&#160;memory&#160;space&#160;and&#160;only&#160;accessible&#160;via&#160;interfaces.&#160;The&#160;protocol&#160;implementa-<br/>tion&#160;remains&#160;in&#160;user&#160;space,&#160;because&#160;there&#160;is&#160;no&#160;need&#160;to&#160;protect&#160;it.</p>
<p style="position:absolute;top:760px;left:150px;white-space:nowrap" class="ft11826"><b>9.4</b></p>
<p style="position:absolute;top:760px;left:198px;white-space:nowrap" class="ft11826"><b>Adapted&#160;TLS&#160;Handshake</b></p>
<p style="position:absolute;top:797px;left:150px;white-space:nowrap" class="ft11814">In&#160;this&#160;Section&#160;we&#160;describe&#160;the&#160;high-level&#160;adaptations&#160;we&#160;introduce&#160;to&#160;the&#160;TLS&#160;hand-<br/>shake&#160;protocol.&#160;We&#160;focus&#160;on&#160;the&#160;Diffie-Hellman&#160;Ephemeral&#160;(DHE)&#160;key&#160;exchange<br/>method&#160;in&#160;a&#160;mutual&#160;attestation&#160;scenario,&#160;but&#160;our&#160;design&#160;supports&#160;all&#160;common&#160;TLS&#160;key<br/>exchange&#160;types&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[27]</a>.&#160;Structures&#160;we&#160;added&#160;or&#160;altered&#160;are&#160;depicted&#160;in&#160;bold&#160;text&#160;in&#160;Figure<br/><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#119">9.1.&#160;</a>A&#160;detailed&#160;description&#160;of&#160;attestation&#160;structures&#160;is&#160;given&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#121">9.5.</a></p>
<p style="position:absolute;top:910px;left:150px;white-space:nowrap" class="ft11823"><b>Negotiating&#160;Security&#160;Parameters:&#160;</b>To&#160;set&#160;up&#160;a&#160;Trusted&#160;Channel,</p>
<p style="position:absolute;top:909px;left:539px;white-space:nowrap" class="ft11850">C</p>
<p style="position:absolute;top:910px;left:551px;white-space:nowrap" class="ft1188">starts&#160;the&#160;necessary</p>
<p style="position:absolute;top:928px;left:150px;white-space:nowrap" class="ft1188">TLS&#160;software&#160;and&#160;sends&#160;a</p>
<p style="position:absolute;top:927px;left:310px;white-space:nowrap" class="ft11853">ClientHello</p>
<p style="position:absolute;top:928px;left:389px;white-space:nowrap" class="ft1188">message&#160;to</p>
<p style="position:absolute;top:927px;left:459px;white-space:nowrap" class="ft11850">S</p>
<p style="position:absolute;top:928px;left:474px;white-space:nowrap" class="ft1188">that&#160;answers&#160;with&#160;a&#160;correspond-</p>
<p style="position:absolute;top:945px;left:150px;white-space:nowrap" class="ft1188">ing</p>
<p style="position:absolute;top:945px;left:173px;white-space:nowrap" class="ft11853">ServerHello</p>
<p style="position:absolute;top:945px;left:254px;white-space:nowrap" class="ft1188">message.&#160;Using&#160;those&#160;hello&#160;messages&#160;the&#160;two&#160;parties&#160;involved&#160;in&#160;the</p>
<p style="position:absolute;top:963px;left:150px;white-space:nowrap" class="ft1188">communication&#160;negotiate&#160;the&#160;attributes&#160;of&#160;the&#160;Trusted&#160;Channel&#160;they&#160;want&#160;to&#160;establish.</p>
<p style="position:absolute;top:990px;left:166px;white-space:nowrap" class="ft11828">1</p>
<p style="position:absolute;top:992px;left:175px;white-space:nowrap" class="ft11874">PCR</p>
<p style="position:absolute;top:996px;left:202px;white-space:nowrap" class="ft11875">i</p>
<p style="position:absolute;top:996px;left:206px;white-space:nowrap" class="ft11876">+1</p>
<p style="position:absolute;top:992px;left:225px;white-space:nowrap" class="ft11878">←</p>
<p style="position:absolute;top:992px;left:242px;white-space:nowrap" class="ft118165">Hash</p>
<p style="position:absolute;top:992px;left:268px;white-space:nowrap" class="ft11877">(</p>
<p style="position:absolute;top:992px;left:273px;white-space:nowrap" class="ft11874">PCR</p>
<p style="position:absolute;top:996px;left:301px;white-space:nowrap" class="ft11875">i</p>
<p style="position:absolute;top:992px;left:305px;white-space:nowrap" class="ft11878">|</p>
<p style="position:absolute;top:992px;left:309px;white-space:nowrap" class="ft11879">x</p>
<p style="position:absolute;top:992px;left:316px;white-space:nowrap" class="ft11877">)</p>
<p style="position:absolute;top:992px;left:321px;white-space:nowrap" class="ft11819">,&#160;with&#160;old&#160;register&#160;value</p>
<p style="position:absolute;top:992px;left:438px;white-space:nowrap" class="ft11874">PCR</p>
<p style="position:absolute;top:996px;left:466px;white-space:nowrap" class="ft11875">i</p>
<p style="position:absolute;top:992px;left:471px;white-space:nowrap" class="ft11819">,&#160;new&#160;register&#160;value</p>
<p style="position:absolute;top:992px;left:568px;white-space:nowrap" class="ft11874">PCR</p>
<p style="position:absolute;top:996px;left:595px;white-space:nowrap" class="ft11875">i</p>
<p style="position:absolute;top:996px;left:599px;white-space:nowrap" class="ft11876">+1</p>
<p style="position:absolute;top:992px;left:614px;white-space:nowrap" class="ft11819">,&#160;and&#160;input</p>
<p style="position:absolute;top:1006px;left:150px;white-space:nowrap" class="ft11879">x</p>
<p style="position:absolute;top:1007px;left:160px;white-space:nowrap" class="ft11819">(e.g.,&#160;a&#160;SHA-1&#160;hash&#160;value).&#160;This&#160;process&#160;is&#160;called&#160;<i>extending&#160;</i>a&#160;PCR.</p>
<p style="position:absolute;top:1019px;left:166px;white-space:nowrap" class="ft11828">2</p>
<p style="position:absolute;top:1021px;left:171px;white-space:nowrap" class="ft11819">These&#160;are&#160;specific&#160;signing&#160;keys&#160;defined&#160;in&#160;the&#160;TCG&#160;specifications&#160;that&#160;can&#160;be&#160;used&#160;to&#160;authenticate&#160;a</p>
<p style="position:absolute;top:1035px;left:150px;white-space:nowrap" class="ft11855">user&#160;and/or&#160;his&#160;system.&#160;They&#160;are&#160;kept&#160;securely&#160;inside&#160;the&#160;TPM&#160;and&#160;can&#160;only&#160;be&#160;used&#160;for&#160;signing&#160;stored<br/>measurement&#160;values&#160;or&#160;certifying&#160;other&#160;non-migratable&#160;keys&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[114]</a>.</p>
<p style="position:absolute;top:1062px;left:166px;white-space:nowrap" class="ft11828">3</p>
<p style="position:absolute;top:1064px;left:171px;white-space:nowrap" class="ft11819">This&#160;key&#160;is&#160;kept&#160;inside&#160;the&#160;TPM&#160;as&#160;root&#160;for&#160;the&#160;whole&#160;key&#160;hierarchy&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[114]</a>.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft11821">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 119 -->
<a name="119"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page119-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5119.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1198">CHAPTER&#160;9.&#160;TRUSTED&#160;CHANNELS&#160;USING&#160;OPENSSL</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1198">117</p>
<p style="position:absolute;top:1027px;left:339px;white-space:nowrap" class="ft1198">Figure&#160;9.1:&#160;Adapted&#160;TLS&#160;DHE-RSA&#160;Handshake</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft11921">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 120 -->
<a name="120"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft120166{font-size:10px;font-family:EPDXYL+CMTI7;color:#231f20;}
-->
</style>
<div id="page120-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5120.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1208">118</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft12021">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft12014">In&#160;contrast&#160;to&#160;the&#160;common&#160;TLS&#160;design&#160;the&#160;nonces&#160;sent&#160;in&#160;the&#160;hello&#160;messages&#160;are&#160;taken<br/>from&#160;a&#160;RNG&#160;seeded&#160;by&#160;the&#160;TPM&#160;at&#160;boot-tim<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#120">e</a></p>
<p style="position:absolute;top:209px;left:432px;white-space:nowrap" class="ft12027"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#120">4</a></p>
<p style="position:absolute;top:212px;left:438px;white-space:nowrap" class="ft1208"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#120">.&#160;</a>Furthermore,&#160;each&#160;side&#160;includes&#160;an</p>
<p style="position:absolute;top:230px;left:150px;white-space:nowrap" class="ft12020"><i>Attestation&#160;Extension&#160;</i>(</p>
<p style="position:absolute;top:229px;left:287px;white-space:nowrap" class="ft12053">AExt</p>
<p style="position:absolute;top:230px;left:321px;white-space:nowrap" class="ft1208">),&#160;that&#160;is&#160;used&#160;to&#160;specify&#160;details&#160;concerning&#160;the&#160;configura-</p>
<p style="position:absolute;top:247px;left:150px;white-space:nowrap" class="ft1208">tion/integrity&#160;information&#160;that&#160;will&#160;be&#160;exchanged.</p>
<p style="position:absolute;top:270px;left:150px;white-space:nowrap" class="ft12015"><b>Configuration&#160;and&#160;Key&#160;Exchange:&#160;</b>Each&#160;peer&#160;provides&#160;evidence&#160;related&#160;to&#160;its&#160;con-<br/>figuration&#160;and&#160;integrity.&#160;For&#160;this&#160;purpose&#160;we&#160;use&#160;additional</p>
<p style="position:absolute;top:287px;left:513px;white-space:nowrap" class="ft12053">SupplementalData</p>
<p style="position:absolute;top:288px;left:636px;white-space:nowrap" class="ft1208">mes-</p>
<p style="position:absolute;top:306px;left:150px;white-space:nowrap" class="ft12014">sages&#160;as&#160;defined&#160;in&#160;Internet&#160;Engineering&#160;Task&#160;Force&#160;(IETF)&#160;RFC4680&#160;(cf.&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#121">9.5,<br/></a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[105]</a>).&#160;Thus,</p>
<p style="position:absolute;top:323px;left:233px;white-space:nowrap" class="ft12053">SupplementalData</p>
<p style="position:absolute;top:324px;left:356px;white-space:nowrap" class="ft1208">messages&#160;are&#160;composed&#160;to&#160;transfer&#160;<i>Attestation&#160;Data</i></p>
<p style="position:absolute;top:341px;left:150px;white-space:nowrap" class="ft1208">(</p>
<p style="position:absolute;top:341px;left:155px;white-space:nowrap" class="ft12053">aD</p>
<p style="position:absolute;top:341px;left:175px;white-space:nowrap" class="ft1208">)&#160;representing&#160;configuration/integrity&#160;information.</p>
<p style="position:absolute;top:341px;left:478px;white-space:nowrap" class="ft12053">aD</p>
<p style="position:absolute;top:341px;left:503px;white-space:nowrap" class="ft1208">is&#160;signed&#160;using&#160;a&#160;secret&#160;key</p>
<p style="position:absolute;top:359px;left:150px;white-space:nowrap" class="ft1208">(</p>
<p style="position:absolute;top:359px;left:155px;white-space:nowrap" class="ft12053">SK</p>
<p style="position:absolute;top:364px;left:175px;white-space:nowrap" class="ft120166">sign</p>
<p style="position:absolute;top:359px;left:198px;white-space:nowrap" class="ft1208">)&#160;for&#160;authentication&#160;and&#160;integrity&#160;protection&#160;of&#160;configuration&#160;information.&#160;Fol-</p>
<p style="position:absolute;top:377px;left:150px;white-space:nowrap" class="ft1208">lowing&#160;the</p>
<p style="position:absolute;top:377px;left:219px;white-space:nowrap" class="ft12053">SupplementalData</p>
<p style="position:absolute;top:377px;left:344px;white-space:nowrap" class="ft1208">message,&#160;each&#160;side&#160;provides&#160;a&#160;certificate&#160;(</p>
<p style="position:absolute;top:377px;left:602px;white-space:nowrap" class="ft12053">cert</p>
<p style="position:absolute;top:382px;left:626px;white-space:nowrap" class="ft120166">TCLS</p>
<p style="position:absolute;top:377px;left:660px;white-space:nowrap" class="ft1208">)</p>
<p style="position:absolute;top:395px;left:150px;white-space:nowrap" class="ft1208">including&#160;the&#160;respective&#160;public&#160;key&#160;(</p>
<p style="position:absolute;top:395px;left:367px;white-space:nowrap" class="ft12053">PK</p>
<p style="position:absolute;top:400px;left:388px;white-space:nowrap" class="ft120166">sign</p>
<p style="position:absolute;top:395px;left:412px;white-space:nowrap" class="ft1208">)&#160;used&#160;to&#160;verify&#160;this&#160;signature.</p>
<p style="position:absolute;top:418px;left:150px;white-space:nowrap" class="ft1208">Subsequently,</p>
<p style="position:absolute;top:417px;left:237px;white-space:nowrap" class="ft12053">DHvalues</p>
<p style="position:absolute;top:418px;left:304px;white-space:nowrap" class="ft1208">(</p>
<p style="position:absolute;top:417px;left:309px;white-space:nowrap" class="ft12053">DH</p>
<p style="position:absolute;top:423px;left:332px;white-space:nowrap" class="ft120166">public</p>
<p style="position:absolute;top:418px;left:365px;white-space:nowrap" class="ft1208">,</p>
<p style="position:absolute;top:417px;left:372px;white-space:nowrap" class="ft12053">DH</p>
<p style="position:absolute;top:423px;left:395px;white-space:nowrap" class="ft120166">secret</p>
<p style="position:absolute;top:418px;left:427px;white-space:nowrap" class="ft1208">)&#160;are&#160;computed&#160;on&#160;both&#160;sides.</p>
<p style="position:absolute;top:417px;left:610px;white-space:nowrap" class="ft12053">DH</p>
<p style="position:absolute;top:415px;left:635px;white-space:nowrap" class="ft120166">S</p>
<p style="position:absolute;top:425px;left:633px;white-space:nowrap" class="ft120166">public</p>
<p style="position:absolute;top:438px;left:150px;white-space:nowrap" class="ft1208">is&#160;signed&#160;using</p>
<p style="position:absolute;top:437px;left:243px;white-space:nowrap" class="ft12053">SK</p>
<p style="position:absolute;top:435px;left:265px;white-space:nowrap" class="ft120166">S</p>
<p style="position:absolute;top:445px;left:263px;white-space:nowrap" class="ft120166">sign</p>
<p style="position:absolute;top:438px;left:290px;white-space:nowrap" class="ft1208">to&#160;provide&#160;authentication&#160;evidence.</p>
<p style="position:absolute;top:437px;left:504px;white-space:nowrap" class="ft12050">S</p>
<p style="position:absolute;top:438px;left:518px;white-space:nowrap" class="ft1208">then&#160;sends</p>
<p style="position:absolute;top:437px;left:585px;white-space:nowrap" class="ft12053">DH</p>
<p style="position:absolute;top:435px;left:610px;white-space:nowrap" class="ft120166">S</p>
<p style="position:absolute;top:445px;left:608px;white-space:nowrap" class="ft120166">public</p>
<p style="position:absolute;top:438px;left:644px;white-space:nowrap" class="ft1208">and</p>
<p style="position:absolute;top:458px;left:150px;white-space:nowrap" class="ft1208">a&#160;signature&#160;(</p>
<p style="position:absolute;top:458px;left:227px;white-space:nowrap" class="ft12053">Sig</p>
<p style="position:absolute;top:456px;left:248px;white-space:nowrap" class="ft120166">S</p>
<p style="position:absolute;top:465px;left:247px;white-space:nowrap" class="ft120166">DH</p>
<p style="position:absolute;top:458px;left:267px;white-space:nowrap" class="ft1208">)&#160;to</p>
<p style="position:absolute;top:457px;left:295px;white-space:nowrap" class="ft12050">C</p>
<p style="position:absolute;top:458px;left:309px;white-space:nowrap" class="ft1208">within&#160;the</p>
<p style="position:absolute;top:458px;left:376px;white-space:nowrap" class="ft12053">ServerKeyExchange</p>
<p style="position:absolute;top:458px;left:511px;white-space:nowrap" class="ft1208">message.</p>
<p style="position:absolute;top:457px;left:575px;white-space:nowrap" class="ft12050">C</p>
<p style="position:absolute;top:458px;left:589px;white-space:nowrap" class="ft1208">computes&#160;its</p>
<p style="position:absolute;top:476px;left:150px;white-space:nowrap" class="ft1208">own&#160;values&#160;and&#160;sends</p>
<p style="position:absolute;top:476px;left:290px;white-space:nowrap" class="ft12053">DH</p>
<p style="position:absolute;top:473px;left:315px;white-space:nowrap" class="ft120166">C</p>
<p style="position:absolute;top:483px;left:312px;white-space:nowrap" class="ft120166">public</p>
<p style="position:absolute;top:476px;left:350px;white-space:nowrap" class="ft1208">to</p>
<p style="position:absolute;top:475px;left:368px;white-space:nowrap" class="ft12050">S</p>
<p style="position:absolute;top:476px;left:383px;white-space:nowrap" class="ft1208">using&#160;the</p>
<p style="position:absolute;top:476px;left:445px;white-space:nowrap" class="ft12053">ClientKeyExchange</p>
<p style="position:absolute;top:476px;left:578px;white-space:nowrap" class="ft1208">message.&#160;The</p>
<p style="position:absolute;top:496px;left:150px;white-space:nowrap" class="ft1208">following</p>
<p style="position:absolute;top:496px;left:212px;white-space:nowrap" class="ft12053">CertificateVerify</p>
<p style="position:absolute;top:496px;left:325px;white-space:nowrap" class="ft1208">message&#160;is&#160;used&#160;to&#160;prove&#160;the&#160;possession&#160;of</p>
<p style="position:absolute;top:496px;left:592px;white-space:nowrap" class="ft12053">SK</p>
<p style="position:absolute;top:494px;left:614px;white-space:nowrap" class="ft120166">C</p>
<p style="position:absolute;top:503px;left:612px;white-space:nowrap" class="ft120166">sign</p>
<p style="position:absolute;top:496px;left:635px;white-space:nowrap" class="ft1208">,&#160;and</p>
<p style="position:absolute;top:516px;left:150px;white-space:nowrap" class="ft1208">to&#160;authenticate</p>
<p style="position:absolute;top:516px;left:241px;white-space:nowrap" class="ft12053">DH</p>
<p style="position:absolute;top:514px;left:266px;white-space:nowrap" class="ft120166">C</p>
<p style="position:absolute;top:523px;left:264px;white-space:nowrap" class="ft120166">public</p>
<p style="position:absolute;top:516px;left:296px;white-space:nowrap" class="ft1208">,&#160;by&#160;signing&#160;a&#160;digest&#160;over&#160;all&#160;previously&#160;exchanged&#160;handshake</p>
<p style="position:absolute;top:537px;left:150px;white-space:nowrap" class="ft1208">messages&#160;(</p>
<p style="position:absolute;top:536px;left:215px;white-space:nowrap" class="ft12046">prev</p>
<p style="position:absolute;top:537px;left:244px;white-space:nowrap" class="ft1208">)&#160;using</p>
<p style="position:absolute;top:536px;left:289px;white-space:nowrap" class="ft12053">SK</p>
<p style="position:absolute;top:534px;left:311px;white-space:nowrap" class="ft120166">C</p>
<p style="position:absolute;top:543px;left:309px;white-space:nowrap" class="ft120166">sign</p>
<p style="position:absolute;top:537px;left:336px;white-space:nowrap" class="ft1208"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[27]</a>.</p>
<p style="position:absolute;top:559px;left:150px;white-space:nowrap" class="ft12023"><b>Session&#160;Key&#160;Computation:&#160;</b>Following</p>
<p style="position:absolute;top:559px;left:398px;white-space:nowrap" class="ft12053">CertificateVerify</p>
<p style="position:absolute;top:559px;left:506px;white-space:nowrap" class="ft1208">,&#160;the&#160;TLS</p>
<p style="position:absolute;top:558px;left:572px;white-space:nowrap" class="ft12046">master&#160;secret</p>
<p style="position:absolute;top:577px;left:150px;white-space:nowrap" class="ft1208">(</p>
<p style="position:absolute;top:576px;left:155px;white-space:nowrap" class="ft12053">ms</p>
<p style="position:absolute;top:577px;left:174px;white-space:nowrap" class="ft1208">)&#160;is&#160;computed&#160;on&#160;both&#160;sides&#160;using</p>
<p style="position:absolute;top:576px;left:396px;white-space:nowrap" class="ft12053">nonce</p>
<p style="position:absolute;top:574px;left:434px;white-space:nowrap" class="ft120166">C</p>
<p style="position:absolute;top:584px;left:433px;white-space:nowrap" class="ft120166">TPM</p>
<p style="position:absolute;top:577px;left:464px;white-space:nowrap" class="ft1208">,</p>
<p style="position:absolute;top:576px;left:474px;white-space:nowrap" class="ft12053">nonce</p>
<p style="position:absolute;top:574px;left:513px;white-space:nowrap" class="ft120166">S</p>
<p style="position:absolute;top:584px;left:512px;white-space:nowrap" class="ft120166">TPM</p>
<p style="position:absolute;top:577px;left:542px;white-space:nowrap" class="ft1208">,&#160;a&#160;string&#160;indicating</p>
<p style="position:absolute;top:595px;left:150px;white-space:nowrap" class="ft1208">that&#160;this&#160;is&#160;a</p>
<p style="position:absolute;top:594px;left:229px;white-space:nowrap" class="ft12053">ms</p>
<p style="position:absolute;top:595px;left:249px;white-space:nowrap" class="ft1208">,&#160;and&#160;the&#160;result&#160;of&#160;the&#160;final&#160;<i>Diffie-Hellman&#160;</i>computation&#160;as&#160;input&#160;to&#160;a</p>
<p style="position:absolute;top:612px;left:150px;white-space:nowrap" class="ft12046">pseudo&#160;random&#160;f&#160;unction</p>
<p style="position:absolute;top:613px;left:323px;white-space:nowrap" class="ft1208">(PRF).&#160;Subsequently,&#160;the&#160;Session&#160;Key&#160;(</p>
<p style="position:absolute;top:612px;left:567px;white-space:nowrap" class="ft12053">SeK</p>
<p style="position:absolute;top:613px;left:596px;white-space:nowrap" class="ft1208">)&#160;is&#160;derived</p>
<p style="position:absolute;top:631px;left:150px;white-space:nowrap" class="ft1208">from&#160;the</p>
<p style="position:absolute;top:630px;left:210px;white-space:nowrap" class="ft12053">ms</p>
<p style="position:absolute;top:631px;left:236px;white-space:nowrap" class="ft1208">on&#160;both&#160;peers&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[27,&#160;</a>p.24].&#160;At&#160;last,&#160;the&#160;handshake&#160;is&#160;finalized&#160;by&#160;the</p>
<p style="position:absolute;top:648px;left:150px;white-space:nowrap" class="ft12053">ChangeCipherSpec</p>
<p style="position:absolute;top:649px;left:275px;white-space:nowrap" class="ft1208">protocol&#160;and&#160;final</p>
<p style="position:absolute;top:648px;left:384px;white-space:nowrap" class="ft12053">Finished</p>
<p style="position:absolute;top:649px;left:444px;white-space:nowrap" class="ft1208">messages.&#160;These</p>
<p style="position:absolute;top:648px;left:549px;white-space:nowrap" class="ft12053">Finished</p>
<p style="position:absolute;top:649px;left:609px;white-space:nowrap" class="ft1208">messages</p>
<p style="position:absolute;top:667px;left:150px;white-space:nowrap" class="ft1208">are&#160;already&#160;encrypted&#160;using</p>
<p style="position:absolute;top:666px;left:318px;white-space:nowrap" class="ft12053">SeK</p>
<p style="position:absolute;top:667px;left:347px;white-space:nowrap" class="ft1208">,&#160;thus,&#160;a&#160;failure&#160;in&#160;key&#160;exchange&#160;would&#160;be&#160;noticed.</p>
<p style="position:absolute;top:730px;left:150px;white-space:nowrap" class="ft12024"><b>9.4.1</b></p>
<p style="position:absolute;top:730px;left:204px;white-space:nowrap" class="ft12024"><b>State&#160;Changes</b></p>
<p style="position:absolute;top:760px;left:150px;white-space:nowrap" class="ft12014">Since&#160;state&#160;changes&#160;might&#160;happen&#160;on&#160;both&#160;peers&#160;while&#160;the&#160;Trusted&#160;Channel&#160;is&#160;in&#160;place,<br/>we&#160;provide&#160;the&#160;possibility&#160;to&#160;exchange&#160;updated&#160;integrity&#160;information&#160;in&#160;a&#160;short&#160;re-<br/>handshake.&#160;This&#160;re-handshake&#160;is&#160;triggered&#160;when&#160;a&#160;state&#160;change,&#160;e.g.,&#160;the&#160;execution&#160;of<br/>another&#160;software&#160;in&#160;the&#160;same&#160;compartment,&#160;occurs&#160;on&#160;any&#160;side,&#160;and&#160;if&#160;the&#160;correspond-<br/>ing&#160;state&#160;monitoring&#160;option&#160;was&#160;selected&#160;in</p>
<p style="position:absolute;top:831px;left:422px;white-space:nowrap" class="ft12053">AExt</p>
<p style="position:absolute;top:831px;left:463px;white-space:nowrap" class="ft1208">(cf.&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#122">9.5.2)</a></p>
<p style="position:absolute;top:829px;left:578px;white-space:nowrap" class="ft12027"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#120">5</a></p>
<p style="position:absolute;top:831px;left:584px;white-space:nowrap" class="ft1208">.&#160;In&#160;case&#160;the</p>
<p style="position:absolute;top:849px;left:150px;white-space:nowrap" class="ft12015">parties&#160;agreed&#160;on&#160;state&#160;change&#160;notification&#160;during&#160;the&#160;initial&#160;handshake,&#160;the&#160;following<br/>procedure&#160;takes&#160;place:&#160;If&#160;a&#160;state&#160;change&#160;happens&#160;on&#160;one&#160;platform&#160;access&#160;to&#160;the</p>
<p style="position:absolute;top:867px;left:636px;white-space:nowrap" class="ft12053">SeK</p>
<p style="position:absolute;top:885px;left:150px;white-space:nowrap" class="ft12014">can&#160;be&#160;blocked&#160;and/or&#160;access&#160;to&#160;data&#160;belonging&#160;to&#160;the&#160;session&#160;is&#160;restricted&#160;depending<br/>on&#160;the&#160;security&#160;policy&#160;of&#160;the&#160;application.&#160;Both&#160;sides&#160;are&#160;notified&#160;using</p>
<p style="position:absolute;top:903px;left:577px;white-space:nowrap" class="ft12053">HelloRequest</p>
<p style="position:absolute;top:903px;left:662px;white-space:nowrap" class="ft1208">,</p>
<p style="position:absolute;top:920px;left:150px;white-space:nowrap" class="ft12053">ClientHello</p>
<p style="position:absolute;top:921px;left:228px;white-space:nowrap" class="ft1208">and</p>
<p style="position:absolute;top:920px;left:253px;white-space:nowrap" class="ft12053">ServerHello</p>
<p style="position:absolute;top:921px;left:329px;white-space:nowrap" class="ft1208">,&#160;respectively.&#160;The&#160;updated&#160;integrity&#160;information&#160;for&#160;val-</p>
<p style="position:absolute;top:939px;left:150px;white-space:nowrap" class="ft1208">idating&#160;the&#160;new&#160;configuration&#160;is&#160;securely&#160;transmitted&#160;to&#160;the&#160;counterpart&#160;encrypted&#160;using</p>
<p style="position:absolute;top:956px;left:150px;white-space:nowrap" class="ft12053">SeK</p>
<p style="position:absolute;top:957px;left:182px;white-space:nowrap" class="ft1208">and&#160;included&#160;in&#160;a&#160;data&#160;structure&#160;called&#160;<i>State&#160;Change&#160;Extension&#160;</i>(</p>
<p style="position:absolute;top:956px;left:563px;white-space:nowrap" class="ft12053">SCExt</p>
<p style="position:absolute;top:957px;left:605px;white-space:nowrap" class="ft1208">)&#160;(cf.&#160;Sec-</p>
<p style="position:absolute;top:975px;left:150px;white-space:nowrap" class="ft1208">tion&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#122">9.5.2)</a>.&#160;Subsequently,&#160;a&#160;TLS&#160;resume&#160;message&#160;flow&#160;takes&#160;place&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[27]</a>.&#160;After&#160;the&#160;short</p>
<p style="position:absolute;top:1001px;left:166px;white-space:nowrap" class="ft12028">4</p>
<p style="position:absolute;top:1003px;left:171px;white-space:nowrap" class="ft12019">We&#160;use&#160;the&#160;TPM&#160;as&#160;source&#160;for&#160;random&#160;values,&#160;because&#160;its&#160;RNG&#160;is&#160;considered&#160;as&#160;true&#160;random&#160;generator</p>
<p style="position:absolute;top:1017px;left:150px;white-space:nowrap" class="ft12055">in&#160;contrast&#160;to&#160;the&#160;pseudo-random&#160;generator&#160;implemented&#160;in&#160;OpenSSL.&#160;The&#160;advantage&#160;of&#160;this&#160;feature&#160;becomes<br/>obvious&#160;with&#160;respect&#160;to&#160;the&#160;recently&#160;discovered&#160;security&#160;weakness&#160;in&#160;the&#160;OpenSSL&#160;RNG&#160;in&#160;Debian&#160;Linux<br/>systems&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[112]</a>.</p>
<p style="position:absolute;top:1058px;left:166px;white-space:nowrap" class="ft12028">5</p>
<p style="position:absolute;top:1060px;left:171px;white-space:nowrap" class="ft12019">Changes&#160;inside&#160;the&#160;compartments&#160;can&#160;be&#160;detected&#160;using&#160;the&#160;Integrity&#160;Measurement&#160;Architecture&#160;(IMA,</p>
<p style="position:absolute;top:1074px;left:150px;white-space:nowrap" class="ft12019"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[103]</a>)&#160;proposed&#160;and&#160;implemented&#160;by&#160;IBM.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft12021">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 121 -->
<a name="121"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page121-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5121.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1218">CHAPTER&#160;9.&#160;TRUSTED&#160;CHANNELS&#160;USING&#160;OPENSSL</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1218">119</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft1218">TLS&#160;resume&#160;handshake&#160;the&#160;new&#160;session&#160;key</p>
<p style="position:absolute;top:193px;left:500px;white-space:nowrap" class="ft12153">SeK</p>
<p style="position:absolute;top:190px;left:529px;white-space:nowrap" class="ft121155">′</p>
<p style="position:absolute;top:194px;left:538px;white-space:nowrap" class="ft1218">is&#160;computed&#160;and&#160;the&#160;communica-</p>
<p style="position:absolute;top:212px;left:226px;white-space:nowrap" class="ft12114">tion&#160;can&#160;continue,&#160;or&#160;the&#160;channel&#160;is&#160;torn-down&#160;because&#160;the&#160;requirements&#160;of&#160;the&#160;security<br/>policy&#160;of&#160;the&#160;peer&#160;are&#160;not&#160;fulfilled&#160;any&#160;longer.</p>
<p style="position:absolute;top:293px;left:226px;white-space:nowrap" class="ft12126"><b>9.5</b></p>
<p style="position:absolute;top:293px;left:274px;white-space:nowrap" class="ft12126"><b>Detailed&#160;Description&#160;of&#160;Attestation&#160;Data&#160;Structures</b></p>
<p style="position:absolute;top:331px;left:226px;white-space:nowrap" class="ft12114">In&#160;this&#160;section&#160;we&#160;introduce&#160;credentials&#160;and&#160;extensions&#160;to&#160;TLS&#160;handshake&#160;messages&#160;we<br/>use&#160;to&#160;set&#160;up&#160;a&#160;Trusted&#160;Channel,&#160;followed&#160;by&#160;an&#160;example&#160;of&#160;their&#160;usage.</p>
<p style="position:absolute;top:408px;left:226px;white-space:nowrap" class="ft12124"><b>9.5.1</b></p>
<p style="position:absolute;top:408px;left:280px;white-space:nowrap" class="ft12124"><b>Key&#160;Exchange&#160;Types&#160;and&#160;Certificate&#160;Elements</b></p>
<p style="position:absolute;top:438px;left:226px;white-space:nowrap" class="ft12115">In&#160;a&#160;common&#160;TLS&#160;handshake&#160;certificates&#160;are&#160;used&#160;to&#160;authenticate&#160;the&#160;peers.&#160;There<br/>are&#160;different&#160;certificate&#160;types&#160;used&#160;for&#160;different&#160;key&#160;exchange&#160;methods.&#160;Depending&#160;on<br/>the&#160;type&#160;of&#160;certificate&#160;chosen&#160;or&#160;key&#160;exchange&#160;method&#160;supported,&#160;we&#160;add&#160;extensions<br/>to&#160;the&#160;certificates.&#160;The&#160;certificate&#160;extensions&#160;and&#160;credentials&#160;we&#160;define&#160;are&#160;necessary<br/>to&#160;bind&#160;the&#160;TLS&#160;channel&#160;to&#160;the&#160;endpoints&#160;whose&#160;configuration&#160;is&#160;reported,&#160;and&#160;to&#160;be<br/>capable&#160;of&#160;proving&#160;that&#160;a&#160;certain&#160;TCB&#160;is&#160;in&#160;place.&#160;These&#160;new&#160;credentials&#160;are&#160;held&#160;in&#160;an<br/>environment&#160;protected&#160;by&#160;TC&#160;mechanisms.&#160;Therefore,&#160;we&#160;act&#160;on&#160;the&#160;assumption&#160;that<br/>these&#160;additional&#160;security&#160;measures&#160;justify&#160;stronger&#160;security&#160;assumptions&#160;concerning&#160;the<br/>storage&#160;and&#160;usage&#160;of&#160;those&#160;credentials.&#160;In&#160;the&#160;following&#160;paragraphs&#160;we&#160;explain&#160;their<br/>creation,&#160;storage&#160;and&#160;interdependency.</p>
<p style="position:absolute;top:640px;left:226px;white-space:nowrap" class="ft12123"><b>SKAE&#160;Key&#160;(</b></p>
<p style="position:absolute;top:639px;left:303px;white-space:nowrap" class="ft12153">K</p>
<p style="position:absolute;top:644px;left:315px;white-space:nowrap" class="ft121166">SKAE</p>
<p style="position:absolute;top:640px;left:350px;white-space:nowrap" class="ft12123"><b>)&#160;and&#160;SKAE</b>:&#160;The</p>
<p style="position:absolute;top:639px;left:460px;white-space:nowrap" class="ft12146">non</p>
<p style="position:absolute;top:640px;left:485px;white-space:nowrap" class="ft1218">-</p>
<p style="position:absolute;top:639px;left:490px;white-space:nowrap" class="ft12146">migratabl<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#121">e</a></p>
<p style="position:absolute;top:637px;left:562px;white-space:nowrap" class="ft12127"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#121">6</a></p>
<p style="position:absolute;top:640px;left:571px;white-space:nowrap" class="ft1218">asymmetric&#160;key&#160;pair</p>
<p style="position:absolute;top:639px;left:695px;white-space:nowrap" class="ft12153">K</p>
<p style="position:absolute;top:644px;left:706px;white-space:nowrap" class="ft121166">SKAE</p>
<p style="position:absolute;top:658px;left:226px;white-space:nowrap" class="ft1218">(</p>
<p style="position:absolute;top:657px;left:231px;white-space:nowrap" class="ft12153">PK</p>
<p style="position:absolute;top:662px;left:253px;white-space:nowrap" class="ft121166">SKAE</p>
<p style="position:absolute;top:658px;left:288px;white-space:nowrap" class="ft1218">,</p>
<p style="position:absolute;top:657px;left:296px;white-space:nowrap" class="ft12153">SK</p>
<p style="position:absolute;top:662px;left:316px;white-space:nowrap" class="ft121166">SKAE</p>
<p style="position:absolute;top:658px;left:352px;white-space:nowrap" class="ft1218">)&#160;is&#160;created&#160;after&#160;an&#160;AIK&#160;(</p>
<p style="position:absolute;top:657px;left:507px;white-space:nowrap" class="ft12153">K</p>
<p style="position:absolute;top:662px;left:518px;white-space:nowrap" class="ft121166">AIK</p>
<p style="position:absolute;top:658px;left:544px;white-space:nowrap" class="ft1218">)&#160;has&#160;been&#160;certified&#160;and&#160;installed.</p>
<p style="position:absolute;top:676px;left:226px;white-space:nowrap" class="ft1218">Its&#160;private&#160;part</p>
<p style="position:absolute;top:675px;left:322px;white-space:nowrap" class="ft12153">SK</p>
<p style="position:absolute;top:680px;left:342px;white-space:nowrap" class="ft121166">SKAE</p>
<p style="position:absolute;top:676px;left:383px;white-space:nowrap" class="ft1218">is&#160;sealed&#160;to&#160;a&#160;specific&#160;TCB&#160;using&#160;the&#160;SRK&#160;(</p>
<p style="position:absolute;top:675px;left:659px;white-space:nowrap" class="ft12153">K</p>
<p style="position:absolute;top:680px;left:670px;white-space:nowrap" class="ft121166">storage</p>
<p style="position:absolute;top:676px;left:709px;white-space:nowrap" class="ft1218">)&#160;and</p>
<p style="position:absolute;top:693px;left:226px;white-space:nowrap" class="ft12140">never&#160;leaves&#160;the&#160;TPM&#160;unencrypted.&#160;We&#160;make&#160;use&#160;of&#160;the&#160;<i>Subject&#160;Key&#160;Attestation&#160;Ev-<br/>idence&#160;</i>(</p>
<p style="position:absolute;top:711px;left:275px;white-space:nowrap" class="ft12153">SKAE</p>
<p style="position:absolute;top:711px;left:318px;white-space:nowrap" class="ft1218">)&#160;as&#160;proposed&#160;by&#160;the&#160;TCG&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[110]</a>.&#160;In&#160;contrast&#160;to&#160;the&#160;intended&#160;purpose,</p>
<p style="position:absolute;top:729px;left:226px;white-space:nowrap" class="ft1218">we&#160;use&#160;the</p>
<p style="position:absolute;top:729px;left:297px;white-space:nowrap" class="ft12153">SKAE</p>
<p style="position:absolute;top:729px;left:345px;white-space:nowrap" class="ft1218">as&#160;standalone&#160;element&#160;within&#160;our&#160;handshake,&#160;but&#160;we&#160;also&#160;foresee</p>
<p style="position:absolute;top:747px;left:226px;white-space:nowrap" class="ft1218">the&#160;possibility&#160;to&#160;include&#160;it&#160;in&#160;a&#160;X.509&#160;certificate.&#160;The</p>
<p style="position:absolute;top:747px;left:561px;white-space:nowrap" class="ft12153">SKAE</p>
<p style="position:absolute;top:747px;left:608px;white-space:nowrap" class="ft1218">basically&#160;consists&#160;of&#160;a</p>
<p style="position:absolute;top:766px;left:226px;white-space:nowrap" class="ft12134">TPM_CERTIFY_INFO2</p>
<p style="position:absolute;top:765px;left:383px;white-space:nowrap" class="ft1218">structure&#160;representing&#160;the&#160;TCB&#160;configuration&#160;that&#160;has&#160;to&#160;be</p>
<p style="position:absolute;top:783px;left:226px;white-space:nowrap" class="ft1218">in&#160;place&#160;during&#160;key&#160;release&#160;(including&#160;a&#160;digest&#160;of</p>
<p style="position:absolute;top:783px;left:517px;white-space:nowrap" class="ft12153">PK</p>
<p style="position:absolute;top:788px;left:539px;white-space:nowrap" class="ft121166">SKAE</p>
<p style="position:absolute;top:783px;left:578px;white-space:nowrap" class="ft1218"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[118,&#160;</a>p.96])&#160;and&#160;a&#160;signature</p>
<p style="position:absolute;top:801px;left:226px;white-space:nowrap" class="ft1218">over&#160;this&#160;structure&#160;(</p>
<p style="position:absolute;top:801px;left:344px;white-space:nowrap" class="ft12153">Sig</p>
<p style="position:absolute;top:806px;left:364px;white-space:nowrap" class="ft121166">SKAE</p>
<p style="position:absolute;top:801px;left:400px;white-space:nowrap" class="ft1218">)&#160;by&#160;a</p>
<p style="position:absolute;top:801px;left:439px;white-space:nowrap" class="ft12153">K</p>
<p style="position:absolute;top:806px;left:451px;white-space:nowrap" class="ft121166">AIK</p>
<p style="position:absolute;top:801px;left:476px;white-space:nowrap" class="ft1218">.&#160;Additionally,&#160;links&#160;to&#160;reference&#160;values&#160;can</p>
<p style="position:absolute;top:819px;left:226px;white-space:nowrap" class="ft1218">be&#160;provided.&#160;The</p>
<p style="position:absolute;top:819px;left:338px;white-space:nowrap" class="ft12153">SKAE</p>
<p style="position:absolute;top:819px;left:386px;white-space:nowrap" class="ft1218">can&#160;vouch&#160;that</p>
<p style="position:absolute;top:819px;left:480px;white-space:nowrap" class="ft12153">K</p>
<p style="position:absolute;top:824px;left:491px;white-space:nowrap" class="ft121166">SKAE</p>
<p style="position:absolute;top:819px;left:532px;white-space:nowrap" class="ft1218">was&#160;created&#160;by&#160;a&#160;<i>Trusted&#160;Platform</i></p>
<p style="position:absolute;top:837px;left:226px;white-space:nowrap" class="ft12114">that&#160;conforms&#160;to&#160;the&#160;TCG&#160;specification&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[114]&#160;</a>and&#160;that&#160;a&#160;certain&#160;TCB&#160;configuration&#160;has<br/>to&#160;be&#160;in&#160;place&#160;during&#160;release&#160;because&#160;of&#160;sealing.</p>
<p style="position:absolute;top:877px;left:226px;white-space:nowrap" class="ft12123"><b>Secure&#160;Encryption&#160;Key&#160;(</b></p>
<p style="position:absolute;top:877px;left:387px;white-space:nowrap" class="ft12153">K</p>
<p style="position:absolute;top:882px;left:399px;white-space:nowrap" class="ft121166">enc</p>
<p style="position:absolute;top:877px;left:418px;white-space:nowrap" class="ft12123"><b>)&#160;and&#160;Secure&#160;Signature&#160;Key&#160;(</b></p>
<p style="position:absolute;top:877px;left:608px;white-space:nowrap" class="ft12153">K</p>
<p style="position:absolute;top:882px;left:620px;white-space:nowrap" class="ft121166">sign</p>
<p style="position:absolute;top:877px;left:643px;white-space:nowrap" class="ft12123"><b>):&#160;</b>We&#160;introduce</p>
<p style="position:absolute;top:895px;left:226px;white-space:nowrap" class="ft1218">the&#160;asymmetric&#160;key&#160;pairs&#160;<i>Secure&#160;Encryption&#160;Key</i></p>
<p style="position:absolute;top:895px;left:532px;white-space:nowrap" class="ft12153">K</p>
<p style="position:absolute;top:900px;left:543px;white-space:nowrap" class="ft121166">enc</p>
<p style="position:absolute;top:895px;left:568px;white-space:nowrap" class="ft1218">(</p>
<p style="position:absolute;top:895px;left:573px;white-space:nowrap" class="ft12153">PK</p>
<p style="position:absolute;top:900px;left:595px;white-space:nowrap" class="ft121166">enc</p>
<p style="position:absolute;top:895px;left:615px;white-space:nowrap" class="ft1218">,</p>
<p style="position:absolute;top:895px;left:624px;white-space:nowrap" class="ft12153">SK</p>
<p style="position:absolute;top:900px;left:644px;white-space:nowrap" class="ft121166">enc</p>
<p style="position:absolute;top:895px;left:664px;white-space:nowrap" class="ft1218">)&#160;and&#160;<i>Secure</i></p>
<p style="position:absolute;top:913px;left:226px;white-space:nowrap" class="ft12120"><i>Signature&#160;Key</i></p>
<p style="position:absolute;top:913px;left:315px;white-space:nowrap" class="ft12153">K</p>
<p style="position:absolute;top:918px;left:327px;white-space:nowrap" class="ft121166">sign</p>
<p style="position:absolute;top:913px;left:355px;white-space:nowrap" class="ft1218">(</p>
<p style="position:absolute;top:913px;left:360px;white-space:nowrap" class="ft12153">PK</p>
<p style="position:absolute;top:918px;left:381px;white-space:nowrap" class="ft121166">sign</p>
<p style="position:absolute;top:913px;left:404px;white-space:nowrap" class="ft1218">,</p>
<p style="position:absolute;top:913px;left:413px;white-space:nowrap" class="ft12153">SK</p>
<p style="position:absolute;top:918px;left:433px;white-space:nowrap" class="ft121166">sign</p>
<p style="position:absolute;top:913px;left:456px;white-space:nowrap" class="ft1218">),&#160;that&#160;are&#160;considered&#160;long-lived&#160;and&#160;usable&#160;for</p>
<p style="position:absolute;top:931px;left:226px;white-space:nowrap" class="ft12114">client&#160;compartments&#160;that&#160;wish&#160;to&#160;establish&#160;a&#160;Trusted&#160;Channel&#160;to&#160;a&#160;remote&#160;party.&#160;They<br/>are&#160;created&#160;inside&#160;the&#160;TCB&#160;and&#160;sealed&#160;using</p>
<p style="position:absolute;top:948px;left:492px;white-space:nowrap" class="ft12153">K</p>
<p style="position:absolute;top:954px;left:503px;white-space:nowrap" class="ft121166">storage</p>
<p style="position:absolute;top:949px;left:543px;white-space:nowrap" class="ft1218">.</p>
<p style="position:absolute;top:971px;left:226px;white-space:nowrap" class="ft1218">Depending&#160;on&#160;the&#160;key&#160;exchange&#160;method&#160;supported&#160;and&#160;the&#160;respective&#160;certificate,</p>
<p style="position:absolute;top:971px;left:700px;white-space:nowrap" class="ft12153">PK</p>
<p style="position:absolute;top:976px;left:722px;white-space:nowrap" class="ft121166">enc</p>
<p style="position:absolute;top:989px;left:226px;white-space:nowrap" class="ft1218">and/or</p>
<p style="position:absolute;top:989px;left:269px;white-space:nowrap" class="ft12153">PK</p>
<p style="position:absolute;top:994px;left:291px;white-space:nowrap" class="ft121166">sign</p>
<p style="position:absolute;top:989px;left:319px;white-space:nowrap" class="ft1218">are&#160;included&#160;in&#160;the&#160;common&#160;<i>TLS&#160;certificate&#160;</i>(</p>
<p style="position:absolute;top:989px;left:593px;white-space:nowrap" class="ft12153">cert</p>
<p style="position:absolute;top:994px;left:617px;white-space:nowrap" class="ft121166">TCLS</p>
<p style="position:absolute;top:989px;left:651px;white-space:nowrap" class="ft1218">)&#160;as&#160;encryption</p>
<p style="position:absolute;top:1007px;left:226px;white-space:nowrap" class="ft1218">or&#160;signature&#160;key&#160;(cf.&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#122">9.2)</a>.&#160;Thus,&#160;either&#160;the&#160;public&#160;part&#160;of</p>
<p style="position:absolute;top:1007px;left:610px;white-space:nowrap" class="ft12153">K</p>
<p style="position:absolute;top:1012px;left:622px;white-space:nowrap" class="ft121166">enc</p>
<p style="position:absolute;top:1007px;left:645px;white-space:nowrap" class="ft1218">or</p>
<p style="position:absolute;top:1007px;left:662px;white-space:nowrap" class="ft12153">K</p>
<p style="position:absolute;top:1012px;left:673px;white-space:nowrap" class="ft121166">sign</p>
<p style="position:absolute;top:1007px;left:700px;white-space:nowrap" class="ft1218">are&#160;put</p>
<p style="position:absolute;top:1025px;left:226px;white-space:nowrap" class="ft1218">into&#160;the&#160;public&#160;key&#160;field&#160;of&#160;the&#160;X.509&#160;certificate.&#160;In&#160;case&#160;of&#160;RSA&#160;and&#160;DH_RSA&#160;key</p>
<p style="position:absolute;top:1052px;left:242px;white-space:nowrap" class="ft12128">6</p>
<p style="position:absolute;top:1054px;left:248px;white-space:nowrap" class="ft12119">The&#160;private&#160;part&#160;of&#160;an&#160;asymmetric&#160;key&#160;pair&#160;labelled</p>
<p style="position:absolute;top:1054px;left:501px;white-space:nowrap" class="ft12179">non</p>
<p style="position:absolute;top:1053px;left:526px;white-space:nowrap" class="ft12178">−</p>
<p style="position:absolute;top:1054px;left:540px;white-space:nowrap" class="ft12179">migratable</p>
<p style="position:absolute;top:1054px;left:605px;white-space:nowrap" class="ft12119">never&#160;leaves&#160;the&#160;TPM&#160;unen-</p>
<p style="position:absolute;top:1068px;left:226px;white-space:nowrap" class="ft12119">crypted&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[114]</a></p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft12121">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 122 -->
<a name="122"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft122167{font-size:15px;font-family:QJAZUT+CMTT10;color:#231f20;}
	.ft122168{font-size:9px;font-family:EPDXYL+CMTI7;color:#231f20;}
-->
</style>
<div id="page122-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5122.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1228">120</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft12221">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:306px;left:251px;white-space:nowrap" class="ft1228">Figure&#160;9.2:&#160;Handshake&#160;Types&#160;and&#160;X.509&#160;Certificates</p>
<p style="position:absolute;top:354px;left:150px;white-space:nowrap" class="ft1228">exchanges,</p>
<p style="position:absolute;top:354px;left:221px;white-space:nowrap" class="ft12253">K</p>
<p style="position:absolute;top:359px;left:233px;white-space:nowrap" class="ft122166">sign</p>
<p style="position:absolute;top:354px;left:261px;white-space:nowrap" class="ft1228">is&#160;included&#160;as&#160;Signature&#160;Key&#160;Extension&#160;to&#160;the&#160;TLS&#160;certificate.&#160;Its</p>
<p style="position:absolute;top:372px;left:150px;white-space:nowrap" class="ft12215">X.509&#160;format,&#160;including&#160;the&#160;use&#160;of&#160;extensions,&#160;is&#160;specified&#160;in&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[48]</a>.&#160;The&#160;signature&#160;key&#160;is<br/>needed&#160;in&#160;these&#160;handshakes&#160;to&#160;provide&#160;the&#160;binding&#160;between&#160;integrity&#160;information&#160;and<br/>the&#160;endpoints.&#160;This&#160;is&#160;not&#160;feasible&#160;using&#160;the&#160;encryption&#160;key&#160;in&#160;those&#160;handshake&#160;types,<br/>and&#160;using&#160;a&#160;single&#160;key&#160;for&#160;encryption&#160;and&#160;signing&#160;is&#160;considered&#160;insecure.</p>
<p style="position:absolute;top:448px;left:150px;white-space:nowrap" class="ft12253">K</p>
<p style="position:absolute;top:453px;left:161px;white-space:nowrap" class="ft122166">enc</p>
<p style="position:absolute;top:448px;left:186px;white-space:nowrap" class="ft1228">and/or</p>
<p style="position:absolute;top:448px;left:229px;white-space:nowrap" class="ft12253">K</p>
<p style="position:absolute;top:453px;left:240px;white-space:nowrap" class="ft122166">sign</p>
<p style="position:absolute;top:448px;left:269px;white-space:nowrap" class="ft1228">must&#160;be&#160;used&#160;for&#160;client&#160;and&#160;server&#160;authentication&#160;during&#160;the&#160;TLS</p>
<p style="position:absolute;top:466px;left:150px;white-space:nowrap" class="ft12215">channel&#160;setup&#160;to&#160;guarantee&#160;the&#160;binding&#160;of&#160;the&#160;secure&#160;channel&#160;to&#160;the&#160;integrity&#160;state&#160;of<br/>the&#160;endpoints.&#160;Therefore,&#160;the&#160;usual&#160;TLS&#160;authentication&#160;scheme&#160;will&#160;be&#160;used&#160;for&#160;server<br/>authentication&#160;and&#160;its</p>
<p style="position:absolute;top:502px;left:284px;white-space:nowrap" class="ft12253">cert</p>
<p style="position:absolute;top:499px;left:310px;white-space:nowrap" class="ft122166">S</p>
<p style="position:absolute;top:509px;left:309px;white-space:nowrap" class="ft122166">TCLS</p>
<p style="position:absolute;top:502px;left:347px;white-space:nowrap" class="ft1228">will&#160;likely&#160;be&#160;signed&#160;by&#160;a&#160;CA&#160;like&#160;e.g.&#160;VeriSign.&#160;In</p>
<p style="position:absolute;top:520px;left:150px;white-space:nowrap" class="ft12214">contrast,&#160;the&#160;TLS&#160;client&#160;authentication&#160;mechanism,&#160;optional&#160;for&#160;a&#160;standard&#160;TLS&#160;chan-<br/>nel,&#160;must&#160;be&#160;used&#160;to&#160;guarantee&#160;the&#160;binding&#160;through</p>
<p style="position:absolute;top:538px;left:469px;white-space:nowrap" class="ft12253">cert</p>
<p style="position:absolute;top:535px;left:495px;white-space:nowrap" class="ft122166">C</p>
<p style="position:absolute;top:545px;left:493px;white-space:nowrap" class="ft122166">TCLS</p>
<p style="position:absolute;top:538px;left:533px;white-space:nowrap" class="ft1228">even&#160;if&#160;the&#160;actual&#160;and</p>
<p style="position:absolute;top:556px;left:150px;white-space:nowrap" class="ft1228">reliable&#160;authentication&#160;of</p>
<p style="position:absolute;top:555px;left:303px;white-space:nowrap" class="ft12250">C</p>
<p style="position:absolute;top:556px;left:316px;white-space:nowrap" class="ft1228">might&#160;not&#160;be&#160;needed.&#160;Therefore,&#160;in&#160;this&#160;case</p>
<p style="position:absolute;top:555px;left:583px;white-space:nowrap" class="ft12253">cert</p>
<p style="position:absolute;top:553px;left:608px;white-space:nowrap" class="ft122166">C</p>
<p style="position:absolute;top:563px;left:607px;white-space:nowrap" class="ft122166">TCLS</p>
<p style="position:absolute;top:556px;left:645px;white-space:nowrap" class="ft1228">can</p>
<p style="position:absolute;top:574px;left:150px;white-space:nowrap" class="ft1228">be&#160;self-signed.</p>
<p style="position:absolute;top:596px;left:150px;white-space:nowrap" class="ft12253">SK</p>
<p style="position:absolute;top:601px;left:170px;white-space:nowrap" class="ft122166">enc</p>
<p style="position:absolute;top:596px;left:194px;white-space:nowrap" class="ft1228">and</p>
<p style="position:absolute;top:596px;left:220px;white-space:nowrap" class="ft12253">SK</p>
<p style="position:absolute;top:601px;left:240px;white-space:nowrap" class="ft122166">sign</p>
<p style="position:absolute;top:596px;left:267px;white-space:nowrap" class="ft1228">are&#160;loaded&#160;and&#160;decrypted&#160;during&#160;the&#160;start&#160;of&#160;the&#160;platform&#160;and&#160;kept</p>
<p style="position:absolute;top:614px;left:150px;white-space:nowrap" class="ft1228">inside&#160;the&#160;TCB.&#160;Subsequently,&#160;we&#160;need</p>
<p style="position:absolute;top:614px;left:396px;white-space:nowrap" class="ft12253">K</p>
<p style="position:absolute;top:619px;left:408px;white-space:nowrap" class="ft122166">SKAE</p>
<p style="position:absolute;top:614px;left:448px;white-space:nowrap" class="ft1228">to&#160;authenticate</p>
<p style="position:absolute;top:614px;left:542px;white-space:nowrap" class="ft12253">K</p>
<p style="position:absolute;top:619px;left:554px;white-space:nowrap" class="ft122166">enc</p>
<p style="position:absolute;top:612px;left:578px;white-space:nowrap" class="ft12227"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#122">7</a></p>
<p style="position:absolute;top:614px;left:589px;white-space:nowrap" class="ft1228">and</p>
<p style="position:absolute;top:614px;left:616px;white-space:nowrap" class="ft12253">K</p>
<p style="position:absolute;top:619px;left:627px;white-space:nowrap" class="ft122166">sign</p>
<p style="position:absolute;top:612px;left:655px;white-space:nowrap" class="ft12227"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#122">8</a></p>
<p style="position:absolute;top:614px;left:661px;white-space:nowrap" class="ft1228">:</p>
<p style="position:absolute;top:632px;left:150px;white-space:nowrap" class="ft1228">By&#160;signing</p>
<p style="position:absolute;top:632px;left:220px;white-space:nowrap" class="ft12253">PK</p>
<p style="position:absolute;top:637px;left:241px;white-space:nowrap" class="ft122166">enc</p>
<p style="position:absolute;top:632px;left:265px;white-space:nowrap" class="ft1228">and</p>
<p style="position:absolute;top:632px;left:291px;white-space:nowrap" class="ft12253">PK</p>
<p style="position:absolute;top:637px;left:312px;white-space:nowrap" class="ft122166">sign</p>
<p style="position:absolute;top:632px;left:340px;white-space:nowrap" class="ft1228">using</p>
<p style="position:absolute;top:632px;left:377px;white-space:nowrap" class="ft12253">SK</p>
<p style="position:absolute;top:637px;left:397px;white-space:nowrap" class="ft122166">SKAE</p>
<p style="position:absolute;top:632px;left:436px;white-space:nowrap" class="ft1228">we&#160;provide&#160;twofold&#160;evidence:&#160;that&#160;the</p>
<p style="position:absolute;top:650px;left:150px;white-space:nowrap" class="ft1228">TCB&#160;identified&#160;by&#160;the</p>
<p style="position:absolute;top:650px;left:286px;white-space:nowrap" class="ft12253">SKAE</p>
<p style="position:absolute;top:650px;left:334px;white-space:nowrap" class="ft1228">was&#160;in&#160;place&#160;during&#160;the&#160;signatur<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#122">e</a></p>
<p style="position:absolute;top:648px;left:534px;white-space:nowrap" class="ft12227"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#122">9</a></p>
<p style="position:absolute;top:650px;left:544px;white-space:nowrap" class="ft1228">and&#160;it&#160;is&#160;a&#160;statement</p>
<p style="position:absolute;top:668px;left:150px;white-space:nowrap" class="ft1228">from&#160;that&#160;TCB&#160;about</p>
<p style="position:absolute;top:668px;left:284px;white-space:nowrap" class="ft12253">K</p>
<p style="position:absolute;top:673px;left:296px;white-space:nowrap" class="ft122166">enc</p>
<p style="position:absolute;top:668px;left:320px;white-space:nowrap" class="ft1228">and</p>
<p style="position:absolute;top:668px;left:347px;white-space:nowrap" class="ft12253">K</p>
<p style="position:absolute;top:673px;left:358px;white-space:nowrap" class="ft122166">sign</p>
<p style="position:absolute;top:668px;left:387px;white-space:nowrap" class="ft1228">like:&#160;“I&#160;certify&#160;that</p>
<p style="position:absolute;top:668px;left:509px;white-space:nowrap" class="ft12253">K</p>
<p style="position:absolute;top:673px;left:520px;white-space:nowrap" class="ft122166">enc</p>
<p style="position:absolute;top:668px;left:540px;white-space:nowrap" class="ft1228">,</p>
<p style="position:absolute;top:668px;left:549px;white-space:nowrap" class="ft12253">K</p>
<p style="position:absolute;top:673px;left:561px;white-space:nowrap" class="ft122166">sign</p>
<p style="position:absolute;top:668px;left:589px;white-space:nowrap" class="ft1228">are&#160;correctly</p>
<p style="position:absolute;top:686px;left:150px;white-space:nowrap" class="ft1228">treated,&#160;i.e.,&#160;when&#160;decrypted,&#160;the&#160;keys&#160;are&#160;kept&#160;secret&#160;by&#160;myself”.&#160;If&#160;the&#160;verifier&#160;of&#160;the</p>
<p style="position:absolute;top:703px;left:150px;white-space:nowrap" class="ft12253">SKAE</p>
<p style="position:absolute;top:704px;left:196px;white-space:nowrap" class="ft1228">trusts&#160;the&#160;TCB&#160;attested&#160;by&#160;it,&#160;then&#160;the&#160;verifier&#160;can&#160;also&#160;trust&#160;the&#160;TCB’s&#160;statement</p>
<p style="position:absolute;top:722px;left:150px;white-space:nowrap" class="ft1228">about&#160;the&#160;correct&#160;treatment&#160;of</p>
<p style="position:absolute;top:721px;left:331px;white-space:nowrap" class="ft12253">K</p>
<p style="position:absolute;top:727px;left:343px;white-space:nowrap" class="ft122166">enc</p>
<p style="position:absolute;top:722px;left:366px;white-space:nowrap" class="ft1228">and</p>
<p style="position:absolute;top:721px;left:392px;white-space:nowrap" class="ft12253">K</p>
<p style="position:absolute;top:727px;left:403px;white-space:nowrap" class="ft122166">sign</p>
<p style="position:absolute;top:722px;left:426px;white-space:nowrap" class="ft1228">.&#160;Therefore,&#160;the</p>
<p style="position:absolute;top:723px;left:524px;white-space:nowrap" class="ft122167">TPM</p>
<p style="position:absolute;top:722px;left:548px;white-space:nowrap" class="ft1228">_</p>
<p style="position:absolute;top:723px;left:555px;white-space:nowrap" class="ft122167">Sign</p>
<p style="position:absolute;top:721px;left:586px;white-space:nowrap" class="ft12248">()</p>
<p style="position:absolute;top:722px;left:602px;white-space:nowrap" class="ft1228">function&#160;is</p>
<p style="position:absolute;top:740px;left:150px;white-space:nowrap" class="ft1228">applied&#160;to&#160;sign</p>
<p style="position:absolute;top:739px;left:247px;white-space:nowrap" class="ft12253">K</p>
<p style="position:absolute;top:745px;left:259px;white-space:nowrap" class="ft122166">enc</p>
<p style="position:absolute;top:740px;left:278px;white-space:nowrap" class="ft1228">’s&#160;and</p>
<p style="position:absolute;top:739px;left:321px;white-space:nowrap" class="ft12253">K</p>
<p style="position:absolute;top:745px;left:332px;white-space:nowrap" class="ft122166">sign</p>
<p style="position:absolute;top:740px;left:356px;white-space:nowrap" class="ft1228">’s&#160;public&#160;parts&#160;with</p>
<p style="position:absolute;top:739px;left:481px;white-space:nowrap" class="ft12253">SK</p>
<p style="position:absolute;top:745px;left:501px;white-space:nowrap" class="ft122166">SKAE</p>
<p style="position:absolute;top:740px;left:542px;white-space:nowrap" class="ft1228">at&#160;boot&#160;tim<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#122">e</a></p>
<p style="position:absolute;top:737px;left:617px;white-space:nowrap" class="ft12227"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#122">10</a></p>
<p style="position:absolute;top:740px;left:628px;white-space:nowrap" class="ft1228">.&#160;The</p>
<p style="position:absolute;top:758px;left:150px;white-space:nowrap" class="ft1228">resulting&#160;signature</p>
<p style="position:absolute;top:757px;left:264px;white-space:nowrap" class="ft12253">Sig</p>
<p style="position:absolute;top:763px;left:284px;white-space:nowrap" class="ft122166">BSEK</p>
<p style="position:absolute;top:758px;left:323px;white-space:nowrap" class="ft1228">is&#160;held&#160;in&#160;the&#160;TCB&#160;memory&#160;space.</p>
<p style="position:absolute;top:821px;left:150px;white-space:nowrap" class="ft12224"><b>9.5.2</b></p>
<p style="position:absolute;top:821px;left:204px;white-space:nowrap" class="ft12224"><b>Extensions&#160;used&#160;in&#160;the&#160;TLS&#160;handshake</b></p>
<p style="position:absolute;top:851px;left:150px;white-space:nowrap" class="ft12214">The&#160;extensions&#160;to&#160;the&#160;TLS&#160;protocol&#160;that&#160;will&#160;be&#160;introduced&#160;in&#160;the&#160;following&#160;paragraphs<br/>are&#160;necessary&#160;to&#160;trigger&#160;and&#160;negotiate&#160;the&#160;exchange&#160;of&#160;configuration&#160;information&#160;as&#160;well<br/>as&#160;for&#160;the&#160;transport&#160;of&#160;the&#160;additional&#160;configuration/integrity&#160;data.&#160;Extensions&#160;to&#160;the&#160;TLS<br/>handshake&#160;protocol&#160;can&#160;be&#160;small&#160;data&#160;chunks&#160;added&#160;to&#160;the&#160;Hello&#160;messages&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[27]&#160;</a>or&#160;com-<br/>pletely&#160;new&#160;handshake&#160;messages.&#160;These&#160;extensions&#160;are&#160;explicitly&#160;foreseen&#160;by&#160;the&#160;TLS</p>
<p style="position:absolute;top:949px;left:166px;white-space:nowrap" class="ft12228">7</p>
<p style="position:absolute;top:951px;left:171px;white-space:nowrap" class="ft12219">In&#160;case&#160;DH_RSA&#160;key&#160;exchange&#160;was&#160;chosen,&#160;the&#160;DH&#160;parameters&#160;included&#160;in&#160;the&#160;certificate&#160;are&#160;signed.</p>
<p style="position:absolute;top:964px;left:166px;white-space:nowrap" class="ft12228">8</p>
<p style="position:absolute;top:966px;left:171px;white-space:nowrap" class="ft12219">It&#160;would&#160;also&#160;be&#160;possible&#160;to&#160;use</p>
<p style="position:absolute;top:966px;left:335px;white-space:nowrap" class="ft12274">K</p>
<p style="position:absolute;top:970px;left:345px;white-space:nowrap" class="ft122168">SKAE</p>
<p style="position:absolute;top:966px;left:380px;white-space:nowrap" class="ft12219">instead&#160;of</p>
<p style="position:absolute;top:966px;left:433px;white-space:nowrap" class="ft12274">K</p>
<p style="position:absolute;top:970px;left:443px;white-space:nowrap" class="ft122168">sign</p>
<p style="position:absolute;top:966px;left:463px;white-space:nowrap" class="ft12219">,</p>
<p style="position:absolute;top:966px;left:471px;white-space:nowrap" class="ft12274">K</p>
<p style="position:absolute;top:969px;left:481px;white-space:nowrap" class="ft122168">enc</p>
<p style="position:absolute;top:966px;left:502px;white-space:nowrap" class="ft12219">for&#160;signing/encrypting&#160;during&#160;the</p>
<p style="position:absolute;top:980px;left:150px;white-space:nowrap" class="ft12255">handshake.&#160;But&#160;then&#160;the&#160;involvement&#160;of&#160;the&#160;TPM&#160;every&#160;time&#160;a&#160;Trusted&#160;Channel&#160;is&#160;set&#160;up&#160;would&#160;be&#160;necessary.<br/>This&#160;would&#160;result&#160;in&#160;a&#160;significant&#160;performance&#160;loss,&#160;especially&#160;in&#160;connection&#160;with&#160;server&#160;systems.&#160;Using</p>
<p style="position:absolute;top:1008px;left:150px;white-space:nowrap" class="ft12274">K</p>
<p style="position:absolute;top:1012px;left:160px;white-space:nowrap" class="ft122168">AIK</p>
<p style="position:absolute;top:1009px;left:184px;white-space:nowrap" class="ft12219">directly&#160;for&#160;this&#160;purpose&#160;is&#160;not&#160;allowed&#160;by&#160;the&#160;TCG&#160;specification.</p>
<p style="position:absolute;top:1021px;left:166px;white-space:nowrap" class="ft12228">9</p>
<p style="position:absolute;top:1023px;left:171px;white-space:nowrap" class="ft12219">The&#160;TCB&#160;must&#160;check&#160;<i>digest&#160;at&#160;creation&#160;</i>and&#160;<i>digest&#160;at&#160;release&#160;</i>of&#160;the&#160;stored&#160;key&#160;data&#160;objects&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[118,&#160;</a>p.89]</p>
<p style="position:absolute;top:1037px;left:150px;white-space:nowrap" class="ft12219">before&#160;signing&#160;them&#160;with</p>
<p style="position:absolute;top:1037px;left:273px;white-space:nowrap" class="ft12274">SK</p>
<p style="position:absolute;top:1041px;left:290px;white-space:nowrap" class="ft122168">SKAE</p>
<p style="position:absolute;top:1037px;left:323px;white-space:nowrap" class="ft12219">to&#160;be&#160;sure&#160;that&#160;they&#160;were&#160;not&#160;compromised&#160;by&#160;a&#160;former&#160;TCB.</p>
<p style="position:absolute;top:1050px;left:162px;white-space:nowrap" class="ft12228">10</p>
<p style="position:absolute;top:1052px;left:171px;white-space:nowrap" class="ft12219">This&#160;has&#160;to&#160;be&#160;done&#160;at&#160;every&#160;system&#160;boot&#160;because&#160;otherwise&#160;the&#160;TCB&#160;update&#160;mechanism&#160;presented&#160;in</p>
<p style="position:absolute;top:1066px;left:150px;white-space:nowrap" class="ft12219">Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#126">9.6.2&#160;</a>could&#160;be&#160;compromised.&#160;Thus&#160;this&#160;signature&#160;is&#160;held&#160;in&#160;volatile&#160;memory.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft12221">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 123 -->
<a name="123"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page123-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5123.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1238">CHAPTER&#160;9.&#160;TRUSTED&#160;CHANNELS&#160;USING&#160;OPENSSL</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1238">121</p>
<p style="position:absolute;top:593px;left:289px;white-space:nowrap" class="ft1238">Figure&#160;9.3:&#160;Supplemental&#160;Data&#160;Message&#160;Creation&#160;and&#160;Evaluation</p>
<p style="position:absolute;top:641px;left:226px;white-space:nowrap" class="ft12314">specification&#160;to&#160;deal&#160;with&#160;advancements&#160;and&#160;changes&#160;in&#160;communication&#160;infrastructures.<br/>There&#160;already&#160;exist&#160;several&#160;extensions&#160;to&#160;the&#160;TLS&#160;protocol,&#160;e.g.,&#160;for&#160;sending&#160;client&#160;cer-<br/>tificate&#160;URLs&#160;or&#160;explicit&#160;server&#160;name&#160;indication&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">[95]</a>.&#160;The&#160;basic&#160;concept&#160;for&#160;extending<br/>TLS&#160;with&#160;an&#160;additional&#160;handshake&#160;message&#160;is&#160;described&#160;in&#160;RFC4680&#160;available&#160;from&#160;the<br/>Internet&#160;Engineering&#160;Task&#160;Force&#160;(IETF)&#160;Networking&#160;Group&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[105]</a>.&#160;This&#160;RFC&#160;defines<br/>the&#160;additional</p>
<p style="position:absolute;top:730px;left:314px;white-space:nowrap" class="ft12353">SupplementalData</p>
<p style="position:absolute;top:731px;left:438px;white-space:nowrap" class="ft1238">handshake&#160;message&#160;envisioned&#160;to&#160;carry&#160;additional</p>
<p style="position:absolute;top:749px;left:226px;white-space:nowrap" class="ft12315">generic&#160;data,&#160;whose&#160;format&#160;must&#160;be&#160;specified&#160;by&#160;the&#160;application&#160;that&#160;uses&#160;it,&#160;and&#160;whose<br/>delivery&#160;must&#160;be&#160;negotiated&#160;via&#160;Hello&#160;message&#160;extensions.</p>
<p style="position:absolute;top:807px;left:226px;white-space:nowrap" class="ft12323"><b>Hello&#160;message&#160;extensions</b>:</p>
<p style="position:absolute;top:806px;left:400px;white-space:nowrap" class="ft12346">Attestation&#160;Extension</p>
<p style="position:absolute;top:807px;left:556px;white-space:nowrap" class="ft1238">or</p>
<p style="position:absolute;top:806px;left:574px;white-space:nowrap" class="ft12346">State&#160;Change&#160;Extension</p>
<p style="position:absolute;top:825px;left:226px;white-space:nowrap" class="ft1238">(</p>
<p style="position:absolute;top:824px;left:231px;white-space:nowrap" class="ft12353">AExt</p>
<p style="position:absolute;top:825px;left:266px;white-space:nowrap" class="ft1238">,</p>
<p style="position:absolute;top:824px;left:275px;white-space:nowrap" class="ft12353">SCExt</p>
<p style="position:absolute;top:825px;left:318px;white-space:nowrap" class="ft1238">)&#160;are&#160;transmitted&#160;within&#160;the</p>
<p style="position:absolute;top:824px;left:492px;white-space:nowrap" class="ft12353">ClientHello</p>
<p style="position:absolute;top:825px;left:572px;white-space:nowrap" class="ft1238">and</p>
<p style="position:absolute;top:824px;left:599px;white-space:nowrap" class="ft12353">ServerHello</p>
<p style="position:absolute;top:825px;left:681px;white-space:nowrap" class="ft1238">messages.</p>
<p style="position:absolute;top:843px;left:226px;white-space:nowrap" class="ft1238">The&#160;first&#160;one&#160;is&#160;used&#160;in&#160;the&#160;initial&#160;handshake&#160;to&#160;negotiate&#160;which&#160;side&#160;(</p>
<p style="position:absolute;top:842px;left:647px;white-space:nowrap" class="ft12350">C</p>
<p style="position:absolute;top:843px;left:660px;white-space:nowrap" class="ft1238">and/or</p>
<p style="position:absolute;top:842px;left:702px;white-space:nowrap" class="ft12350">S</p>
<p style="position:absolute;top:843px;left:712px;white-space:nowrap" class="ft1238">)&#160;has</p>
<p style="position:absolute;top:861px;left:226px;white-space:nowrap" class="ft12314">to&#160;attest&#160;to&#160;its&#160;state,&#160;the&#160;type&#160;of&#160;attestation&#160;and&#160;state-monitoring&#160;supported&#160;or&#160;if&#160;privacy<br/>of&#160;configuration&#160;information&#160;is&#160;desired.</p>
<p style="position:absolute;top:878px;left:470px;white-space:nowrap" class="ft12353">SCExt</p>
<p style="position:absolute;top:879px;left:512px;white-space:nowrap" class="ft1238">,&#160;in&#160;turn,&#160;is&#160;used&#160;to&#160;inform&#160;the&#160;peer&#160;of</p>
<p style="position:absolute;top:897px;left:226px;white-space:nowrap" class="ft12315">a&#160;state&#160;change&#160;on&#160;the&#160;counterpart&#160;and&#160;to&#160;transport&#160;configuration&#160;data&#160;in&#160;a&#160;re-handshake<br/>(cf.&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#120">9.4.1)</a>.</p>
<p style="position:absolute;top:937px;left:226px;white-space:nowrap" class="ft12323"><b>Supplemental&#160;Data&#160;Message&#160;Creation&#160;and&#160;Evaluation</b>:&#160;The</p>
<p style="position:absolute;top:937px;left:623px;white-space:nowrap" class="ft12353">SupplementalData</p>
<p style="position:absolute;top:955px;left:226px;white-space:nowrap" class="ft1238">message&#160;includes&#160;the</p>
<p style="position:absolute;top:954px;left:361px;white-space:nowrap" class="ft12353">SKAE</p>
<p style="position:absolute;top:955px;left:404px;white-space:nowrap" class="ft1238">,</p>
<p style="position:absolute;top:954px;left:414px;white-space:nowrap" class="ft12353">PK</p>
<p style="position:absolute;top:960px;left:435px;white-space:nowrap" class="ft123166">SKAE</p>
<p style="position:absolute;top:955px;left:471px;white-space:nowrap" class="ft1238">,</p>
<p style="position:absolute;top:954px;left:481px;white-space:nowrap" class="ft12353">cert</p>
<p style="position:absolute;top:960px;left:505px;white-space:nowrap" class="ft123166">AIK</p>
<p style="position:absolute;top:955px;left:530px;white-space:nowrap" class="ft1238">,</p>
<p style="position:absolute;top:954px;left:540px;white-space:nowrap" class="ft12353">Sig</p>
<p style="position:absolute;top:960px;left:560px;white-space:nowrap" class="ft123166">BSEK</p>
<p style="position:absolute;top:955px;left:595px;white-space:nowrap" class="ft1238">,&#160;a&#160;concatenation&#160;of&#160;the</p>
<p style="position:absolute;top:973px;left:226px;white-space:nowrap" class="ft1238">nonces&#160;sent&#160;in&#160;the&#160;TLS&#160;Hello&#160;messages&#160;and</p>
<p style="position:absolute;top:972px;left:499px;white-space:nowrap" class="ft12353">properties</p>
<p style="position:absolute;top:973px;left:568px;white-space:nowrap" class="ft1238">(see&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#117">9.3)</a>,&#160;depending</p>
<p style="position:absolute;top:991px;left:226px;white-space:nowrap" class="ft1238">on&#160;what&#160;kind&#160;of&#160;attestation&#160;and&#160;key&#160;exchange&#160;was&#160;chosen.&#160;Furthermore,&#160;a&#160;Signature</p>
<p style="position:absolute;top:1008px;left:226px;white-space:nowrap" class="ft12353">Sig</p>
<p style="position:absolute;top:1014px;left:246px;white-space:nowrap" class="ft123166">aD</p>
<p style="position:absolute;top:1009px;left:267px;white-space:nowrap" class="ft1238">on</p>
<p style="position:absolute;top:1008px;left:286px;white-space:nowrap" class="ft12353">aD</p>
<p style="position:absolute;top:1009px;left:310px;white-space:nowrap" class="ft1238">is&#160;appended.&#160;This&#160;signature&#160;is&#160;needed&#160;to&#160;bind&#160;the</p>
<p style="position:absolute;top:1008px;left:607px;white-space:nowrap" class="ft12353">aD</p>
<p style="position:absolute;top:1009px;left:631px;white-space:nowrap" class="ft1238">structure&#160;to&#160;the&#160;re-</p>
<p style="position:absolute;top:1027px;left:226px;white-space:nowrap" class="ft1238">spective&#160;secure&#160;channel&#160;endpoint.&#160;In&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#123">9.3&#160;</a>we&#160;show&#160;how</p>
<p style="position:absolute;top:1026px;left:602px;white-space:nowrap" class="ft12353">aD</p>
<p style="position:absolute;top:1027px;left:626px;white-space:nowrap" class="ft1238">is&#160;composed,&#160;while</p>
<p style="position:absolute;top:1045px;left:226px;white-space:nowrap" class="ft1238">the</p>
<p style="position:absolute;top:1044px;left:248px;white-space:nowrap" class="ft12353">properties</p>
<p style="position:absolute;top:1045px;left:317px;white-space:nowrap" class="ft1238">field&#160;is&#160;considered&#160;as&#160;black&#160;box,&#160;since&#160;its&#160;values&#160;vary&#160;depending&#160;on&#160;the</p>
<p style="position:absolute;top:1063px;left:226px;white-space:nowrap" class="ft1238">attestation&#160;concept&#160;chosen.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft12321">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 124 -->
<a name="124"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page124-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5124.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1248">122</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft12421">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft1248">In&#160;our&#160;proof&#160;of&#160;concept&#160;prototype&#160;the</p>
<p style="position:absolute;top:193px;left:376px;white-space:nowrap" class="ft12453">properties</p>
<p style="position:absolute;top:194px;left:444px;white-space:nowrap" class="ft1248">data&#160;consists&#160;of&#160;measurements&#160;repre-</p>
<p style="position:absolute;top:212px;left:150px;white-space:nowrap" class="ft12414">senting&#160;the&#160;images&#160;of&#160;the&#160;client&#160;compartments&#160;using&#160;the&#160;TLS&#160;Trusted&#160;Channel&#160;extracted<br/>from&#160;a&#160;<i>Configuration&#160;Data&#160;Structure&#160;</i>(</p>
<p style="position:absolute;top:229px;left:377px;white-space:nowrap" class="ft12453">CDS</p>
<p style="position:absolute;top:230px;left:409px;white-space:nowrap" class="ft1248">)&#160;and&#160;corresponding&#160;signed</p>
<p style="position:absolute;top:229px;left:575px;white-space:nowrap" class="ft12446">ref&#160;erence&#160;va</p>
<p style="position:absolute;top:230px;left:660px;white-space:nowrap" class="ft1248">-</p>
<p style="position:absolute;top:246px;left:150px;white-space:nowrap" class="ft12446">lues</p>
<p style="position:absolute;top:247px;left:183px;white-space:nowrap" class="ft1248">(see&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#117">9.3)</a>.&#160;The</p>
<p style="position:absolute;top:247px;left:329px;white-space:nowrap" class="ft12453">CDS</p>
<p style="position:absolute;top:247px;left:367px;white-space:nowrap" class="ft1248">itself&#160;holds&#160;a&#160;list&#160;of&#160;measurements&#160;of&#160;the&#160;binary</p>
<p style="position:absolute;top:265px;left:150px;white-space:nowrap" class="ft1248">images&#160;of&#160;all&#160;client&#160;compartments&#160;running&#160;on&#160;top&#160;of&#160;the&#160;TCB.</p>
<p style="position:absolute;top:288px;left:150px;white-space:nowrap" class="ft12414"><b>Determination&#160;of&#160;endpoint&#160;trustworthiness:&#160;</b>The&#160;trustworthiness&#160;of&#160;the&#160;peer’s&#160;TCB<br/>is&#160;determined&#160;by&#160;evaluating</p>
<p style="position:absolute;top:305px;left:317px;white-space:nowrap" class="ft12453">Sig</p>
<p style="position:absolute;top:311px;left:337px;white-space:nowrap" class="ft124166">SKAE</p>
<p style="position:absolute;top:306px;left:376px;white-space:nowrap" class="ft1248">(cf.&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#121">9.5.1)&#160;</a>and&#160;the&#160;TCB&#160;measurement&#160;in-</p>
<p style="position:absolute;top:324px;left:150px;white-space:nowrap" class="ft1248">cluded&#160;in</p>
<p style="position:absolute;top:323px;left:209px;white-space:nowrap" class="ft12453">SKAE</p>
<p style="position:absolute;top:324px;left:256px;white-space:nowrap" class="ft1248">using</p>
<p style="position:absolute;top:323px;left:292px;white-space:nowrap" class="ft12446">ref&#160;erence&#160;values</p>
<p style="position:absolute;top:324px;left:409px;white-space:nowrap" class="ft1248">provided&#160;by&#160;trusted&#160;third&#160;parties.&#160;To&#160;verify</p>
<p style="position:absolute;top:341px;left:150px;white-space:nowrap" class="ft1248">the&#160;validity&#160;of</p>
<p style="position:absolute;top:341px;left:239px;white-space:nowrap" class="ft12453">K</p>
<p style="position:absolute;top:346px;left:251px;white-space:nowrap" class="ft124166">sign</p>
<p style="position:absolute;top:341px;left:274px;white-space:nowrap" class="ft1248">,</p>
<p style="position:absolute;top:341px;left:282px;white-space:nowrap" class="ft12453">Sig</p>
<p style="position:absolute;top:346px;left:302px;white-space:nowrap" class="ft124166">BSEK</p>
<p style="position:absolute;top:341px;left:342px;white-space:nowrap" class="ft1248">is&#160;checked.&#160;Then&#160;the&#160;linkage&#160;between&#160;secure&#160;channel</p>
<p style="position:absolute;top:359px;left:150px;white-space:nowrap" class="ft1248">endpoint&#160;and</p>
<p style="position:absolute;top:359px;left:231px;white-space:nowrap" class="ft12453">aD</p>
<p style="position:absolute;top:359px;left:256px;white-space:nowrap" class="ft1248">is&#160;verified&#160;by&#160;inspecting</p>
<p style="position:absolute;top:359px;left:403px;white-space:nowrap" class="ft12453">Sig</p>
<p style="position:absolute;top:364px;left:422px;white-space:nowrap" class="ft124166">aD</p>
<p style="position:absolute;top:359px;left:440px;white-space:nowrap" class="ft1248">.&#160;Freshness&#160;of</p>
<p style="position:absolute;top:359px;left:527px;white-space:nowrap" class="ft12453">aD</p>
<p style="position:absolute;top:359px;left:552px;white-space:nowrap" class="ft1248">is&#160;guaranteed&#160;com-</p>
<p style="position:absolute;top:377px;left:150px;white-space:nowrap" class="ft1248">paring</p>
<p style="position:absolute;top:377px;left:193px;white-space:nowrap" class="ft12453">nonceSD</p>
<p style="position:absolute;top:377px;left:257px;white-space:nowrap" class="ft1248">to&#160;the&#160;nonces&#160;sent&#160;the&#160;hello&#160;messages.&#160;Finally,&#160;the&#160;trustworthiness</p>
<p style="position:absolute;top:395px;left:150px;white-space:nowrap" class="ft12414">of&#160;compartments&#160;running&#160;on&#160;top&#160;of&#160;the&#160;TCB&#160;is&#160;determined&#160;in&#160;a&#160;next&#160;step&#160;by&#160;evaluat-<br/>ing</p>
<p style="position:absolute;top:413px;left:174px;white-space:nowrap" class="ft12453">CDS</p>
<p style="position:absolute;top:413px;left:211px;white-space:nowrap" class="ft1248">using&#160;either&#160;additional</p>
<p style="position:absolute;top:412px;left:352px;white-space:nowrap" class="ft12446">ref&#160;erence&#160;values</p>
<p style="position:absolute;top:413px;left:472px;white-space:nowrap" class="ft1248">provided&#160;by&#160;the&#160;peer&#160;within&#160;the</p>
<p style="position:absolute;top:431px;left:150px;white-space:nowrap" class="ft12453">properties</p>
<p style="position:absolute;top:431px;left:218px;white-space:nowrap" class="ft1248">data&#160;field&#160;or&#160;by&#160;trusted&#160;third&#160;parties.</p>
<p style="position:absolute;top:454px;left:150px;white-space:nowrap" class="ft12414">Also&#160;other&#160;concepts&#160;of&#160;attestation&#160;are&#160;supported.&#160;If,&#160;e.g.,&#160;the&#160;TCG&#160;attestation&#160;mech-<br/>anism&#160;should&#160;be&#160;used,&#160;a&#160;digest&#160;of</p>
<p style="position:absolute;top:471px;left:359px;white-space:nowrap" class="ft12453">nonceSD</p>
<p style="position:absolute;top:472px;left:418px;white-space:nowrap" class="ft1248">,</p>
<p style="position:absolute;top:471px;left:426px;white-space:nowrap" class="ft12453">PK</p>
<p style="position:absolute;top:477px;left:448px;white-space:nowrap" class="ft124166">enc</p>
<p style="position:absolute;top:472px;left:472px;white-space:nowrap" class="ft1248">and</p>
<p style="position:absolute;top:471px;left:499px;white-space:nowrap" class="ft12453">PK</p>
<p style="position:absolute;top:477px;left:520px;white-space:nowrap" class="ft124166">sign</p>
<p style="position:absolute;top:472px;left:548px;white-space:nowrap" class="ft1248">is&#160;given&#160;as&#160;external</p>
<p style="position:absolute;top:489px;left:150px;white-space:nowrap" class="ft1248">data&#160;to&#160;the</p>
<p style="position:absolute;top:490px;left:216px;white-space:nowrap" class="ft124167">TPM</p>
<p style="position:absolute;top:489px;left:240px;white-space:nowrap" class="ft1248">_</p>
<p style="position:absolute;top:490px;left:247px;white-space:nowrap" class="ft124167">Quote</p>
<p style="position:absolute;top:488px;left:286px;white-space:nowrap" class="ft12448">()</p>
<p style="position:absolute;top:489px;left:301px;white-space:nowrap" class="ft1248">function&#160;of&#160;the&#160;TPM&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[114]</a>.&#160;This&#160;is&#160;done&#160;to&#160;provide&#160;freshness</p>
<p style="position:absolute;top:507px;left:150px;white-space:nowrap" class="ft1248">of&#160;TCG&#160;attestation&#160;data&#160;(</p>
<p style="position:absolute;top:507px;left:300px;white-space:nowrap" class="ft12453">aD</p>
<p style="position:absolute;top:512px;left:319px;white-space:nowrap" class="ft124166">TCG</p>
<p style="position:absolute;top:507px;left:347px;white-space:nowrap" class="ft1248">)&#160;and&#160;to&#160;replace</p>
<p style="position:absolute;top:507px;left:445px;white-space:nowrap" class="ft12453">Sig</p>
<p style="position:absolute;top:512px;left:464px;white-space:nowrap" class="ft124166">BSEK</p>
<p style="position:absolute;top:507px;left:500px;white-space:nowrap" class="ft1248">.</p>
<p style="position:absolute;top:507px;left:509px;white-space:nowrap" class="ft12453">SKAE</p>
<p style="position:absolute;top:507px;left:556px;white-space:nowrap" class="ft1248">is&#160;not&#160;needed&#160;here</p>
<p style="position:absolute;top:525px;left:150px;white-space:nowrap" class="ft1248">because&#160;the&#160;AIK&#160;is&#160;used&#160;to&#160;sign&#160;the&#160;relevant&#160;values&#160;inside&#160;the&#160;TPM.</p>
<p style="position:absolute;top:548px;left:150px;white-space:nowrap" class="ft1248">Since&#160;TLS&#160;handshake&#160;messages&#160;are&#160;usually&#160;sent&#160;in&#160;clear&#160;text,&#160;in&#160;case</p>
<p style="position:absolute;top:547px;left:616px;white-space:nowrap" class="ft12446">privacy</p>
<p style="position:absolute;top:566px;left:150px;white-space:nowrap" class="ft1248">of&#160;attestation&#160;information&#160;is&#160;desired&#160;by&#160;one&#160;of&#160;the&#160;communication&#160;partners,&#160;no</p>
<p style="position:absolute;top:583px;left:150px;white-space:nowrap" class="ft12453">SupplementalData</p>
<p style="position:absolute;top:584px;left:273px;white-space:nowrap" class="ft1248">messages&#160;are&#160;sent&#160;within&#160;the&#160;first&#160;handshake.&#160;Subsequently,&#160;a&#160;sec-</p>
<p style="position:absolute;top:602px;left:150px;white-space:nowrap" class="ft12415">ond&#160;handshake&#160;is&#160;performed&#160;directly&#160;after&#160;the&#160;first&#160;one&#160;to&#160;exchange&#160;attestation&#160;informa-<br/>tion&#160;encrypted&#160;using&#160;the&#160;session&#160;key&#160;negotiated&#160;in&#160;the&#160;previous&#160;handshake&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[105]</a>.</p>
<p style="position:absolute;top:688px;left:150px;white-space:nowrap" class="ft12426"><b>9.6</b></p>
<p style="position:absolute;top:688px;left:198px;white-space:nowrap" class="ft12426"><b>Generic&#160;System&#160;Architecture</b></p>
<p style="position:absolute;top:726px;left:150px;white-space:nowrap" class="ft12415">Our&#160;generic&#160;system&#160;architecture&#160;is&#160;based&#160;on&#160;security&#160;frameworks&#160;as&#160;proposed,&#160;e.g.,<br/>in&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[97]</a>,&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[102]</a>,&#160;and&#160;consists&#160;of&#160;an&#160;<i>Application</i>,&#160;<i>Trusted&#160;Service</i>,&#160;<i>Virtualization&#160;</i>as&#160;well<br/>as&#160;<i>TC-enabled&#160;Hardware&#160;Layer</i>.&#160;We&#160;kept&#160;our&#160;approach&#160;generic,&#160;thus&#160;it&#160;is&#160;possible&#160;to<br/>implement/integrate&#160;the&#160;components&#160;in&#160;different&#160;systems&#160;also&#160;on&#160;common&#160;operating<br/>systems&#160;like,&#160;e.g.,&#160;Linux&#160;or&#160;Windows.&#160;But,&#160;if&#160;these&#160;monolithic&#160;OSs&#160;are&#160;applied,&#160;some<br/>constraints&#160;have&#160;to&#160;be&#160;considered&#160;when&#160;looking&#160;at&#160;the&#160;security&#160;of&#160;such&#160;implementations,<br/>because&#160;in&#160;general&#160;they&#160;are&#160;not&#160;capable&#160;to&#160;ensure&#160;strong&#160;isolation&#160;of&#160;processes&#160;and<br/>corresponding&#160;data.</p>
<p style="position:absolute;top:892px;left:150px;white-space:nowrap" class="ft12414"><b>TC-enabled&#160;Hardware&#160;Layer</b>:&#160;The&#160;hardware&#160;layer&#160;has&#160;to&#160;offer&#160;TC&#160;extensions&#160;that<br/>are&#160;conforming&#160;to&#160;the&#160;relevant&#160;TCG&#160;specifications&#160;(e.g.,&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[114]</a>).&#160;This&#160;essentially&#160;means<br/>that&#160;it&#160;comprises&#160;a&#160;TPM&#160;chip&#160;and&#160;a&#160;compatible&#160;BIOS.</p>
<p style="position:absolute;top:950px;left:150px;white-space:nowrap" class="ft12414"><b>Virtualization&#160;Layer</b>:&#160;The&#160;virtualization&#160;layer&#160;offers&#160;and&#160;mediates&#160;access&#160;to&#160;central<br/>hardware&#160;components&#160;like,&#160;e.g.,&#160;CPU&#160;and&#160;MMU.&#160;These&#160;tasks&#160;can&#160;be&#160;performed&#160;by<br/>many&#160;kinds&#160;of&#160;virtualization&#160;techniques,&#160;namely&#160;hypervisors,&#160;microkernel&#160;approaches<br/>or&#160;a&#160;common&#160;OS&#160;running&#160;a&#160;virtualization&#160;application,&#160;e.g.,&#160;VMware&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[125]</a>.</p>
<p style="position:absolute;top:1026px;left:150px;white-space:nowrap" class="ft12414"><b>Trusted&#160;Service&#160;Layer</b>:&#160;This&#160;layer&#160;consists&#160;of&#160;security&#160;services&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[10]&#160;</a>and&#160;provides<br/>interfaces&#160;to&#160;the&#160;Application&#160;Layer.&#160;It&#160;also&#160;mediates&#160;and&#160;monitors&#160;access&#160;to&#160;virtualized<br/>hardware&#160;resources.&#160;Subsequently,&#160;we&#160;briefly&#160;describe&#160;the&#160;main&#160;components&#160;of&#160;the</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft12421">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 125 -->
<a name="125"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page125-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5125.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1258">CHAPTER&#160;9.&#160;TRUSTED&#160;CHANNELS&#160;USING&#160;OPENSSL</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1258">123</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft1258">TCB&#160;in&#160;our&#160;approach:</p>
<p style="position:absolute;top:242px;left:233px;white-space:nowrap" class="ft12550">•</p>
<p style="position:absolute;top:243px;left:248px;white-space:nowrap" class="ft12520"><i>Trust&#160;Manager&#160;</i>(</p>
<p style="position:absolute;top:242px;left:346px;white-space:nowrap" class="ft12553">TM</p>
<p style="position:absolute;top:243px;left:372px;white-space:nowrap" class="ft1258">)&#160;provides&#160;functionalities&#160;used&#160;for&#160;establishing&#160;Trusted&#160;Chan-</p>
<p style="position:absolute;top:261px;left:248px;white-space:nowrap" class="ft1258">nels.&#160;To&#160;be&#160;able&#160;to&#160;provide&#160;this&#160;functionality</p>
<p style="position:absolute;top:260px;left:529px;white-space:nowrap" class="ft12553">TM</p>
<p style="position:absolute;top:261px;left:561px;white-space:nowrap" class="ft1258">bundles&#160;multiple&#160;calls&#160;to&#160;the</p>
<p style="position:absolute;top:279px;left:248px;white-space:nowrap" class="ft12515">TPM&#160;into&#160;a&#160;simple&#160;API&#160;for&#160;calling&#160;instances.&#160;Thus,&#160;it&#160;offers&#160;functionality&#160;to&#160;gen-<br/>erate&#160;keys,&#160;bind/unbind,&#160;seal/unseal,&#160;certify&#160;these&#160;keys&#160;or&#160;to&#160;report&#160;the&#160;current<br/>measurement&#160;values&#160;of&#160;the&#160;TCB&#160;stored&#160;inside&#160;the&#160;TPM.&#160;The&#160;keys&#160;used&#160;in&#160;the&#160;ini-<br/>tial&#160;handshake&#160;are&#160;computed&#160;and&#160;held&#160;by&#160;the</p>
<p style="position:absolute;top:332px;left:518px;white-space:nowrap" class="ft12553">TM</p>
<p style="position:absolute;top:332px;left:545px;white-space:nowrap" class="ft1258">.&#160;They&#160;never&#160;leave&#160;the&#160;TCB.</p>
<p style="position:absolute;top:349px;left:233px;white-space:nowrap" class="ft12550">•</p>
<p style="position:absolute;top:350px;left:248px;white-space:nowrap" class="ft12520"><i>Compartment&#160;Manager&#160;</i>(</p>
<p style="position:absolute;top:350px;left:401px;white-space:nowrap" class="ft12553">CM</p>
<p style="position:absolute;top:350px;left:427px;white-space:nowrap" class="ft1258">)&#160;is&#160;responsible&#160;for&#160;starting&#160;and&#160;stopping&#160;compart-</p>
<p style="position:absolute;top:368px;left:248px;white-space:nowrap" class="ft12514">ments.&#160;It&#160;measures&#160;the&#160;compartment&#160;code&#160;when&#160;starting&#160;it&#160;and&#160;assigns&#160;a&#160;locally<br/>unique&#160;ID&#160;to&#160;this&#160;compartment.&#160;This&#160;ID&#160;as&#160;well&#160;as&#160;the&#160;measurements&#160;are&#160;reported<br/>to&#160;the&#160;<i>Integrity&#160;Manager&#160;</i>(see&#160;below).</p>
<p style="position:absolute;top:421px;left:233px;white-space:nowrap" class="ft12550">•</p>
<p style="position:absolute;top:422px;left:248px;white-space:nowrap" class="ft12520"><i>Integrity&#160;Manager&#160;</i>(</p>
<p style="position:absolute;top:422px;left:370px;white-space:nowrap" class="ft12553">IM</p>
<p style="position:absolute;top:422px;left:391px;white-space:nowrap" class="ft1258">)&#160;stores&#160;the&#160;compartment’s</p>
<p style="position:absolute;top:422px;left:559px;white-space:nowrap" class="ft12553">properties</p>
<p style="position:absolute;top:422px;left:624px;white-space:nowrap" class="ft1258">.&#160;In&#160;our&#160;approach</p>
<p style="position:absolute;top:440px;left:248px;white-space:nowrap" class="ft1258">this&#160;means&#160;appending&#160;the&#160;measurements&#160;reported&#160;by</p>
<p style="position:absolute;top:440px;left:568px;white-space:nowrap" class="ft12553">CM</p>
<p style="position:absolute;top:440px;left:599px;white-space:nowrap" class="ft1258">together&#160;with&#160;a&#160;unique</p>
<p style="position:absolute;top:458px;left:248px;white-space:nowrap" class="ft1258">ID&#160;to</p>
<p style="position:absolute;top:458px;left:285px;white-space:nowrap" class="ft12553">CDS</p>
<p style="position:absolute;top:458px;left:321px;white-space:nowrap" class="ft1258">(cf.&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#121">9.5)</a>.</p>
<p style="position:absolute;top:458px;left:432px;white-space:nowrap" class="ft12553">IM</p>
<p style="position:absolute;top:458px;left:458px;white-space:nowrap" class="ft1258">keeps&#160;the</p>
<p style="position:absolute;top:458px;left:519px;white-space:nowrap" class="ft12553">CDS</p>
<p style="position:absolute;top:458px;left:555px;white-space:nowrap" class="ft1258">secure&#160;by&#160;storing&#160;it&#160;inside&#160;the</p>
<p style="position:absolute;top:476px;left:248px;white-space:nowrap" class="ft1258">TCB’s&#160;memory&#160;space&#160;and&#160;provides&#160;it&#160;to&#160;other&#160;TCB&#160;components.</p>
<p style="position:absolute;top:493px;left:233px;white-space:nowrap" class="ft12550">•</p>
<p style="position:absolute;top:494px;left:248px;white-space:nowrap" class="ft12520"><i>Policy&#160;Manager&#160;</i>(</p>
<p style="position:absolute;top:493px;left:352px;white-space:nowrap" class="ft12553">PM</p>
<p style="position:absolute;top:494px;left:378px;white-space:nowrap" class="ft1258">)&#160;stores&#160;platform&#160;and&#160;application&#160;policies&#160;and&#160;provides&#160;them</p>
<p style="position:absolute;top:512px;left:248px;white-space:nowrap" class="ft1258">to&#160;other&#160;components&#160;of&#160;the&#160;TCB&#160;when&#160;neede<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#125">d</a></p>
<p style="position:absolute;top:510px;left:524px;white-space:nowrap" class="ft12527"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#125">11</a></p>
<p style="position:absolute;top:512px;left:535px;white-space:nowrap" class="ft1258"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#125">.</a></p>
<p style="position:absolute;top:529px;left:233px;white-space:nowrap" class="ft12550">•</p>
<p style="position:absolute;top:530px;left:248px;white-space:nowrap" class="ft12520"><i>Storage&#160;Manager&#160;</i>(</p>
<p style="position:absolute;top:529px;left:363px;white-space:nowrap" class="ft12553">SM</p>
<p style="position:absolute;top:530px;left:387px;white-space:nowrap" class="ft1258">)&#160;handles&#160;persistent&#160;data&#160;storing&#160;for&#160;the&#160;different&#160;compart-</p>
<p style="position:absolute;top:548px;left:248px;white-space:nowrap" class="ft1258">ments.</p>
<p style="position:absolute;top:575px;left:226px;white-space:nowrap" class="ft12514"><b>Application&#160;Layer</b>:&#160;In&#160;this&#160;layer&#160;the&#160;applications&#160;run&#160;in&#160;isolated&#160;compartments.&#160;This<br/>can&#160;be&#160;either&#160;applications&#160;running&#160;directly&#160;on&#160;top&#160;of&#160;the&#160;underlying&#160;TCB&#160;or&#160;whole&#160;OSs.</p>
<p style="position:absolute;top:656px;left:226px;white-space:nowrap" class="ft12524"><b>9.6.1</b></p>
<p style="position:absolute;top:656px;left:280px;white-space:nowrap" class="ft12524"><b>Trusted&#160;Initialization</b></p>
<p style="position:absolute;top:686px;left:226px;white-space:nowrap" class="ft12515">To&#160;be&#160;able&#160;to&#160;attest&#160;a&#160;platform’s&#160;configuration,&#160;its&#160;hard-&#160;and&#160;software&#160;components&#160;are<br/>measured&#160;reliably&#160;and&#160;those&#160;measurements&#160;are&#160;stored&#160;securely.&#160;An&#160;ongoing&#160;measure-<br/>ment&#160;process&#160;is&#160;effected&#160;originating&#160;from&#160;the&#160;<i>Core&#160;Root&#160;of&#160;Trust&#160;for&#160;Measuremen<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#125">t</a></i></p>
<p style="position:absolute;top:719px;left:731px;white-space:nowrap" class="ft12527"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#125">12</a></p>
<p style="position:absolute;top:740px;left:226px;white-space:nowrap" class="ft12514">that&#160;initiates&#160;the&#160;measurement&#160;process&#160;up&#160;to&#160;and&#160;excluding&#160;the&#160;Application&#160;Layer.&#160;Ev-<br/>ery&#160;component&#160;that&#160;has&#160;to&#160;be&#160;loaded&#160;during&#160;the&#160;boot&#160;process&#160;is&#160;measured&#160;before&#160;passing<br/>control&#160;over&#160;to&#160;it.</p>
<p style="position:absolute;top:793px;left:248px;white-space:nowrap" class="ft1258">Consequently,&#160;a&#160;<i>Chain&#160;of&#160;Trust&#160;</i>(CoT)&#160;is&#160;established&#160;and&#160;the&#160;TCB&#160;is&#160;measured&#160;re-</p>
<p style="position:absolute;top:811px;left:226px;white-space:nowrap" class="ft12514">liably.&#160;These&#160;measurements&#160;are&#160;stored&#160;inside&#160;the&#160;TPM&#160;and&#160;represent&#160;the&#160;<i>static&#160;config-<br/>uration&#160;</i>in&#160;our&#160;approach,&#160;because&#160;it&#160;must&#160;be&#160;only&#160;modifiable&#160;with&#160;a&#160;subsequent&#160;reboot.<br/>After&#160;the&#160;boot&#160;process&#160;platform&#160;monitoring&#160;is&#160;conducted&#160;by</p>
<p style="position:absolute;top:847px;left:591px;white-space:nowrap" class="ft12553">CM</p>
<p style="position:absolute;top:847px;left:617px;white-space:nowrap" class="ft1258">.&#160;Thus,</p>
<p style="position:absolute;top:847px;left:665px;white-space:nowrap" class="ft12553">CM</p>
<p style="position:absolute;top:847px;left:696px;white-space:nowrap" class="ft1258">extends</p>
<p style="position:absolute;top:865px;left:226px;white-space:nowrap" class="ft1258">the&#160;CoT&#160;when&#160;a&#160;client&#160;compartment&#160;is&#160;loaded&#160;that&#160;runs&#160;on&#160;top&#160;of&#160;the&#160;TCB.</p>
<p style="position:absolute;top:865px;left:683px;white-space:nowrap" class="ft12553">CDS</p>
<p style="position:absolute;top:865px;left:719px;white-space:nowrap" class="ft1258">that</p>
<p style="position:absolute;top:883px;left:226px;white-space:nowrap" class="ft1258">reflects&#160;the&#160;platform&#160;configuration&#160;is&#160;maintained&#160;by</p>
<p style="position:absolute;top:883px;left:533px;white-space:nowrap" class="ft12553">IM</p>
<p style="position:absolute;top:883px;left:554px;white-space:nowrap" class="ft1258">.&#160;The&#160;configuration&#160;of&#160;compart-</p>
<p style="position:absolute;top:901px;left:226px;white-space:nowrap" class="ft12514">ments&#160;that&#160;run&#160;above&#160;the&#160;TCB&#160;represents&#160;the&#160;<i>dynamic&#160;configuration&#160;</i>because&#160;we&#160;allow<br/>state&#160;changes&#160;to&#160;happen.</p>
<p style="position:absolute;top:937px;left:248px;white-space:nowrap" class="ft1258">In&#160;our&#160;approach&#160;the&#160;CoT&#160;is&#160;initially&#160;built-up&#160;until&#160;the&#160;TCB&#160;is&#160;loaded&#160;and&#160;run-</p>
<p style="position:absolute;top:955px;left:226px;white-space:nowrap" class="ft1258">ning.</p>
<p style="position:absolute;top:955px;left:270px;white-space:nowrap" class="ft1258">To&#160;be&#160;able&#160;to&#160;provide&#160;support&#160;for&#160;Trusted&#160;Channels&#160;a&#160;RNG,&#160;seeded&#160;using</p>
<p style="position:absolute;top:974px;left:226px;white-space:nowrap" class="ft125167">TPM</p>
<p style="position:absolute;top:973px;left:250px;white-space:nowrap" class="ft1258">_</p>
<p style="position:absolute;top:974px;left:257px;white-space:nowrap" class="ft125167">GetRandom</p>
<p style="position:absolute;top:972px;left:328px;white-space:nowrap" class="ft12548">()</p>
<p style="position:absolute;top:973px;left:345px;white-space:nowrap" class="ft1258">at&#160;boot-time,&#160;provides&#160;random.&#160;After&#160;the&#160;system&#160;has&#160;booted-up</p>
<p style="position:absolute;top:991px;left:226px;white-space:nowrap" class="ft1258">and&#160;the&#160;TCB&#160;is&#160;in&#160;place,</p>
<p style="position:absolute;top:990px;left:374px;white-space:nowrap" class="ft12553">TM</p>
<p style="position:absolute;top:991px;left:404px;white-space:nowrap" class="ft1258">unseals</p>
<p style="position:absolute;top:990px;left:452px;white-space:nowrap" class="ft12553">K</p>
<p style="position:absolute;top:996px;left:464px;white-space:nowrap" class="ft125166">enc</p>
<p style="position:absolute;top:991px;left:487px;white-space:nowrap" class="ft1258">and</p>
<p style="position:absolute;top:990px;left:512px;white-space:nowrap" class="ft12553">K</p>
<p style="position:absolute;top:996px;left:524px;white-space:nowrap" class="ft125166">sign</p>
<p style="position:absolute;top:991px;left:550px;white-space:nowrap" class="ft1258">and&#160;signs&#160;their&#160;public&#160;parts&#160;with</p>
<p style="position:absolute;top:1008px;left:226px;white-space:nowrap" class="ft12553">SK</p>
<p style="position:absolute;top:1013px;left:246px;white-space:nowrap" class="ft125166">SKAE</p>
<p style="position:absolute;top:1009px;left:282px;white-space:nowrap" class="ft1258">.</p>
<p style="position:absolute;top:1008px;left:292px;white-space:nowrap" class="ft12553">TM</p>
<p style="position:absolute;top:1009px;left:323px;white-space:nowrap" class="ft1258">now&#160;holds</p>
<p style="position:absolute;top:1008px;left:389px;white-space:nowrap" class="ft12553">K</p>
<p style="position:absolute;top:1013px;left:401px;white-space:nowrap" class="ft125166">enc</p>
<p style="position:absolute;top:1009px;left:420px;white-space:nowrap" class="ft1258">,</p>
<p style="position:absolute;top:1008px;left:429px;white-space:nowrap" class="ft12553">K</p>
<p style="position:absolute;top:1013px;left:440px;white-space:nowrap" class="ft125166">sign</p>
<p style="position:absolute;top:1009px;left:463px;white-space:nowrap" class="ft1258">,</p>
<p style="position:absolute;top:1008px;left:472px;white-space:nowrap" class="ft12553">PK</p>
<p style="position:absolute;top:1013px;left:493px;white-space:nowrap" class="ft125166">SKAE</p>
<p style="position:absolute;top:1009px;left:533px;white-space:nowrap" class="ft1258">and</p>
<p style="position:absolute;top:1008px;left:559px;white-space:nowrap" class="ft12553">Sig</p>
<p style="position:absolute;top:1013px;left:579px;white-space:nowrap" class="ft125166">BSEK</p>
<p style="position:absolute;top:1009px;left:615px;white-space:nowrap" class="ft1258">.&#160;Thus,&#160;the&#160;system&#160;is</p>
<p style="position:absolute;top:1036px;left:238px;white-space:nowrap" class="ft12528">11</p>
<p style="position:absolute;top:1039px;left:248px;white-space:nowrap" class="ft12519">This&#160;component&#160;is&#160;not&#160;implemented&#160;yet,&#160;for&#160;the&#160;prototype&#160;we&#160;applied&#160;fixed&#160;policies.</p>
<p style="position:absolute;top:1051px;left:238px;white-space:nowrap" class="ft12528">12</p>
<p style="position:absolute;top:1053px;left:248px;white-space:nowrap" class="ft12519">This&#160;is&#160;a&#160;small&#160;piece&#160;of&#160;code&#160;initiating&#160;the&#160;measurement&#160;process&#160;at&#160;the&#160;very&#160;beginning&#160;of&#160;the&#160;boot&#160;process.</p>
<p style="position:absolute;top:1067px;left:226px;white-space:nowrap" class="ft12519">Usually,&#160;this&#160;code&#160;is&#160;located&#160;within&#160;the&#160;BIOS.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft12521">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 126 -->
<a name="126"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page126-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5126.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1268">124</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft12621">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft1268">initialized&#160;and&#160;ready&#160;to&#160;set&#160;up&#160;a&#160;Trusted&#160;Channel.</p>
<p style="position:absolute;top:252px;left:150px;white-space:nowrap" class="ft12624"><b>9.6.2</b></p>
<p style="position:absolute;top:252px;left:204px;white-space:nowrap" class="ft12624"><b>TCB&#160;Update&#160;Management</b></p>
<p style="position:absolute;top:282px;left:150px;white-space:nowrap" class="ft12614">We&#160;want&#160;to&#160;be&#160;able&#160;to&#160;change&#160;the&#160;TCB&#160;configuration&#160;without&#160;requesting&#160;a&#160;new&#160;TLS<br/>certificate&#160;every&#160;time&#160;this&#160;is&#160;done.&#160;This&#160;is&#160;an&#160;important&#160;issue&#160;because&#160;on&#160;the&#160;one&#160;hand<br/>re-certification&#160;of&#160;the&#160;TLS&#160;endpoint&#160;and&#160;its&#160;keys&#160;is&#160;expensive&#160;and&#160;on&#160;the&#160;other&#160;hand&#160;we<br/>want&#160;the&#160;keys&#160;to&#160;be&#160;securely&#160;bound&#160;to&#160;a&#160;specific&#160;platform&#160;configuration&#160;to&#160;be&#160;able&#160;to<br/>prove&#160;that&#160;they&#160;have&#160;not&#160;been&#160;compromised.</p>
<p style="position:absolute;top:372px;left:172px;white-space:nowrap" class="ft1268">Using&#160;non-migratable&#160;keys&#160;during&#160;the&#160;handshake&#160;would&#160;be&#160;the&#160;safest&#160;way&#160;to&#160;protect</p>
<p style="position:absolute;top:390px;left:150px;white-space:nowrap" class="ft12615">keys&#160;from&#160;being&#160;compromised&#160;but&#160;resealing&#160;such&#160;keys&#160;to&#160;a&#160;different&#160;TCB&#160;is&#160;not&#160;possible<br/><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[119]</a>.&#160;Therefore,&#160;we&#160;present&#160;a&#160;procedure&#160;that&#160;allows&#160;the&#160;update&#160;of&#160;the&#160;TCB&#160;without<br/>compromising&#160;the&#160;TLS&#160;keys&#160;and&#160;thus&#160;preserves&#160;the&#160;validity&#160;of&#160;the&#160;TLS&#160;certificate.</p>
<p style="position:absolute;top:444px;left:172px;white-space:nowrap" class="ft1268">The&#160;problem&#160;here&#160;is&#160;that&#160;a&#160;system&#160;in&#160;an&#160;updated&#160;state&#160;(and&#160;its&#160;peer)&#160;has&#160;to&#160;be&#160;able&#160;to</p>
<p style="position:absolute;top:462px;left:150px;white-space:nowrap" class="ft1268">judge&#160;its&#160;former&#160;state,&#160;because&#160;otherwise</p>
<p style="position:absolute;top:461px;left:395px;white-space:nowrap" class="ft12653">K</p>
<p style="position:absolute;top:467px;left:406px;white-space:nowrap" class="ft126166">enc</p>
<p style="position:absolute;top:462px;left:429px;white-space:nowrap" class="ft1268">and</p>
<p style="position:absolute;top:461px;left:454px;white-space:nowrap" class="ft12653">K</p>
<p style="position:absolute;top:467px;left:466px;white-space:nowrap" class="ft126166">sign</p>
<p style="position:absolute;top:462px;left:492px;white-space:nowrap" class="ft1268">may&#160;have&#160;been&#160;compromised</p>
<p style="position:absolute;top:480px;left:150px;white-space:nowrap" class="ft1268">and&#160;a&#160;new&#160;certificate&#160;is&#160;needed.&#160;To&#160;achieve&#160;this,&#160;we&#160;keep&#160;a&#160;secure</p>
<p style="position:absolute;top:479px;left:566px;white-space:nowrap" class="ft12653">changelog</p>
<p style="position:absolute;top:480px;left:629px;white-space:nowrap" class="ft1268">.&#160;The</p>
<p style="position:absolute;top:497px;left:150px;white-space:nowrap" class="ft12653">changelog</p>
<p style="position:absolute;top:498px;left:219px;white-space:nowrap" class="ft1268">holds&#160;names&#160;and&#160;hash&#160;values&#160;of&#160;components&#160;that&#160;have&#160;been&#160;installed&#160;or</p>
<p style="position:absolute;top:515px;left:150px;white-space:nowrap" class="ft12614">removed.&#160;Additionally&#160;it&#160;contains&#160;a&#160;link&#160;to&#160;a&#160;certificate&#160;by&#160;a&#160;trusted&#160;third&#160;party&#160;(e.g.,<br/>manufacturer)&#160;that&#160;vouches&#160;for&#160;these&#160;values.</p>
<p style="position:absolute;top:551px;left:172px;white-space:nowrap" class="ft1268">The&#160;update&#160;process&#160;starts&#160;with&#160;unsealing</p>
<p style="position:absolute;top:551px;left:414px;white-space:nowrap" class="ft12653">SK</p>
<p style="position:absolute;top:556px;left:434px;white-space:nowrap" class="ft126166">sign</p>
<p style="position:absolute;top:551px;left:460px;white-space:nowrap" class="ft1268">and</p>
<p style="position:absolute;top:551px;left:484px;white-space:nowrap" class="ft12653">SK</p>
<p style="position:absolute;top:556px;left:504px;white-space:nowrap" class="ft126166">enc</p>
<p style="position:absolute;top:551px;left:524px;white-space:nowrap" class="ft1268">.&#160;Then&#160;the&#160;new</p>
<p style="position:absolute;top:551px;left:615px;white-space:nowrap" class="ft12653">package</p>
<p style="position:absolute;top:567px;left:150px;white-space:nowrap" class="ft12627"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#126">13</a></p>
<p style="position:absolute;top:569px;left:164px;white-space:nowrap" class="ft1268">is&#160;downloaded&#160;from&#160;a&#160;trustworthy&#160;entity&#160;together&#160;with</p>
<p style="position:absolute;top:569px;left:487px;white-space:nowrap" class="ft12653">cert</p>
<p style="position:absolute;top:574px;left:511px;white-space:nowrap" class="ft126166">update</p>
<p style="position:absolute;top:569px;left:550px;white-space:nowrap" class="ft1268">containing&#160;the&#160;hash</p>
<p style="position:absolute;top:587px;left:150px;white-space:nowrap" class="ft1268">value&#160;of&#160;the&#160;component&#160;after&#160;installation.&#160;Then,</p>
<p style="position:absolute;top:587px;left:450px;white-space:nowrap" class="ft12653">TM</p>
<p style="position:absolute;top:587px;left:482px;white-space:nowrap" class="ft1268">computes&#160;the&#160;foreseen&#160;config-</p>
<p style="position:absolute;top:605px;left:150px;white-space:nowrap" class="ft12615">uration&#160;of&#160;the&#160;platform&#160;after&#160;the&#160;installation&#160;using&#160;the&#160;hash&#160;value&#160;comprised&#160;in&#160;the<br/>certificate&#160;replacing&#160;the&#160;values&#160;of&#160;the&#160;removed&#160;component&#160;in&#160;the</p>
<p style="position:absolute;top:623px;left:544px;white-space:nowrap" class="ft12653">CDS</p>
<p style="position:absolute;top:623px;left:581px;white-space:nowrap" class="ft1268">and&#160;it&#160;updates</p>
<p style="position:absolute;top:641px;left:150px;white-space:nowrap" class="ft12653">changelog</p>
<p style="position:absolute;top:641px;left:217px;white-space:nowrap" class="ft1268">accordingly.&#160;Subsequently,</p>
<p style="position:absolute;top:641px;left:384px;white-space:nowrap" class="ft12653">SK</p>
<p style="position:absolute;top:646px;left:404px;white-space:nowrap" class="ft126166">sign</p>
<p style="position:absolute;top:641px;left:431px;white-space:nowrap" class="ft1268">and</p>
<p style="position:absolute;top:641px;left:456px;white-space:nowrap" class="ft12653">SK</p>
<p style="position:absolute;top:646px;left:476px;white-space:nowrap" class="ft126166">enc</p>
<p style="position:absolute;top:641px;left:500px;white-space:nowrap" class="ft1268">are&#160;sealed&#160;to&#160;this&#160;state.&#160;In&#160;a</p>
<p style="position:absolute;top:659px;left:150px;white-space:nowrap" class="ft1268">last&#160;step&#160;the&#160;new</p>
<p style="position:absolute;top:658px;left:250px;white-space:nowrap" class="ft12653">package</p>
<p style="position:absolute;top:659px;left:303px;white-space:nowrap" class="ft1268">is&#160;installed.&#160;After&#160;this&#160;process&#160;the&#160;platform&#160;has&#160;to&#160;be&#160;rebooted</p>
<p style="position:absolute;top:677px;left:150px;white-space:nowrap" class="ft1268">to&#160;let&#160;the&#160;changes&#160;take&#160;effect.</p>
<p style="position:absolute;top:695px;left:172px;white-space:nowrap" class="ft1268">After&#160;the&#160;platform&#160;is&#160;initialized&#160;again,&#160;a&#160;new</p>
<p style="position:absolute;top:694px;left:439px;white-space:nowrap" class="ft12653">K</p>
<p style="position:absolute;top:700px;left:450px;white-space:nowrap" class="ft126166">SKAE</p>
<p style="position:absolute;top:695px;left:489px;white-space:nowrap" class="ft1268">and&#160;related</p>
<p style="position:absolute;top:694px;left:559px;white-space:nowrap" class="ft12653">SKAE</p>
<p style="position:absolute;top:695px;left:605px;white-space:nowrap" class="ft1268">have&#160;to&#160;be</p>
<p style="position:absolute;top:713px;left:150px;white-space:nowrap" class="ft1268">created.&#160;From&#160;then&#160;on&#160;the&#160;new</p>
<p style="position:absolute;top:712px;left:343px;white-space:nowrap" class="ft12653">SK</p>
<p style="position:absolute;top:718px;left:363px;white-space:nowrap" class="ft126166">SKAE</p>
<p style="position:absolute;top:713px;left:403px;white-space:nowrap" class="ft1268">is&#160;used&#160;to&#160;sign</p>
<p style="position:absolute;top:712px;left:496px;white-space:nowrap" class="ft12653">PK</p>
<p style="position:absolute;top:718px;left:517px;white-space:nowrap" class="ft126166">enc</p>
<p style="position:absolute;top:713px;left:542px;white-space:nowrap" class="ft1268">and</p>
<p style="position:absolute;top:712px;left:568px;white-space:nowrap" class="ft12653">PK</p>
<p style="position:absolute;top:718px;left:589px;white-space:nowrap" class="ft126166">sign</p>
<p style="position:absolute;top:713px;left:617px;white-space:nowrap" class="ft1268">creating</p>
<p style="position:absolute;top:730px;left:150px;white-space:nowrap" class="ft12653">Sig</p>
<p style="position:absolute;top:736px;left:170px;white-space:nowrap" class="ft126166">BSEK</p>
<p style="position:absolute;top:731px;left:205px;white-space:nowrap" class="ft1268">.</p>
<p style="position:absolute;top:795px;left:150px;white-space:nowrap" class="ft12626"><b>9.7</b></p>
<p style="position:absolute;top:795px;left:198px;white-space:nowrap" class="ft12626"><b>A&#160;Trusted&#160;Channel&#160;Implementation&#160;with&#160;OpenSSL</b></p>
<p style="position:absolute;top:832px;left:150px;white-space:nowrap" class="ft12614">As&#160;basis&#160;for&#160;the&#160;implementation&#160;of&#160;the&#160;Trusted&#160;Channel&#160;we&#160;chose&#160;the&#160;Xen&#160;Hypervisor<br/><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[128]</a>.&#160;The&#160;components&#160;–</p>
<p style="position:absolute;top:850px;left:313px;white-space:nowrap" class="ft12653">TM</p>
<p style="position:absolute;top:850px;left:340px;white-space:nowrap" class="ft1268">,</p>
<p style="position:absolute;top:850px;left:349px;white-space:nowrap" class="ft12653">SM</p>
<p style="position:absolute;top:850px;left:373px;white-space:nowrap" class="ft1268">,</p>
<p style="position:absolute;top:850px;left:382px;white-space:nowrap" class="ft12653">IM</p>
<p style="position:absolute;top:850px;left:404px;white-space:nowrap" class="ft1268">,&#160;and</p>
<p style="position:absolute;top:850px;left:440px;white-space:nowrap" class="ft12653">CM</p>
<p style="position:absolute;top:850px;left:466px;white-space:nowrap" class="ft1268">–&#160;mentioned&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#124">9.6&#160;</a>have</p>
<p style="position:absolute;top:868px;left:150px;white-space:nowrap" class="ft12615">been&#160;developed&#160;within&#160;the&#160;OpenTC&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">[86,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#172">68]&#160;</a>and&#160;EMSCB&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[36]&#160;</a>projects.&#160;We&#160;used&#160;these<br/>services&#160;and&#160;extended&#160;them&#160;where&#160;needed.</p>
<p style="position:absolute;top:945px;left:150px;white-space:nowrap" class="ft12624"><b>9.7.1</b></p>
<p style="position:absolute;top:945px;left:204px;white-space:nowrap" class="ft12624"><b>Implementation&#160;Architecture</b></p>
<p style="position:absolute;top:975px;left:150px;white-space:nowrap" class="ft12614">In&#160;order&#160;to&#160;confine&#160;the&#160;size&#160;of&#160;the&#160;Trusted&#160;Computing&#160;Base&#160;(TCB),&#160;we&#160;designed&#160;the<br/>Trusted&#160;Channel&#160;split&#160;into&#160;two&#160;groups&#160;of&#160;components.</p>
<p style="position:absolute;top:1011px;left:172px;white-space:nowrap" class="ft1268">One&#160;group&#160;(the</p>
<p style="position:absolute;top:1010px;left:269px;white-space:nowrap" class="ft12653">TLS&#160;backend</p>
<p style="position:absolute;top:1011px;left:355px;white-space:nowrap" class="ft1268">),&#160;minimal&#160;and&#160;part&#160;of&#160;the&#160;TCB,&#160;performs&#160;the&#160;secu-</p>
<p style="position:absolute;top:1029px;left:150px;white-space:nowrap" class="ft1268">rity&#160;critical&#160;operations:&#160;encryption/&#160;decryption,&#160;MAC&#160;calculation/verification&#160;and&#160;the</p>
<p style="position:absolute;top:1055px;left:162px;white-space:nowrap" class="ft12628">13</p>
<p style="position:absolute;top:1058px;left:171px;white-space:nowrap" class="ft12619">This&#160;could&#160;be&#160;package&#160;structures&#160;as&#160;used&#160;by&#160;several&#160;Linux&#160;distributions,&#160;e.g.,&#160;rpm&#160;or&#160;deb.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft12621">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 127 -->
<a name="127"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page127-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5127.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1278">CHAPTER&#160;9.&#160;TRUSTED&#160;CHANNELS&#160;USING&#160;OPENSSL</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1278">125</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft1278">management&#160;of&#160;the&#160;TLS&#160;session&#160;are&#160;performed&#160;by</p>
<p style="position:absolute;top:193px;left:532px;white-space:nowrap" class="ft12753">TM</p>
<p style="position:absolute;top:194px;left:558px;white-space:nowrap" class="ft1278">,&#160;while&#160;the&#160;storage&#160;of&#160;sensitive</p>
<p style="position:absolute;top:212px;left:226px;white-space:nowrap" class="ft1278">data&#160;like&#160;keys&#160;and&#160;certificates&#160;is&#160;done&#160;by</p>
<p style="position:absolute;top:211px;left:470px;white-space:nowrap" class="ft12753">SM</p>
<p style="position:absolute;top:209px;left:498px;white-space:nowrap" class="ft12727"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#127">14</a></p>
<p style="position:absolute;top:212px;left:510px;white-space:nowrap" class="ft1278"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#127">.</a></p>
<p style="position:absolute;top:230px;left:248px;white-space:nowrap" class="ft1278">The&#160;actual&#160;protocol&#160;implementation&#160;(the</p>
<p style="position:absolute;top:229px;left:493px;white-space:nowrap" class="ft12753">TLS&#160;frontend</p>
<p style="position:absolute;top:230px;left:582px;white-space:nowrap" class="ft1278">),&#160;instead,&#160;runs&#160;in&#160;the&#160;same</p>
<p style="position:absolute;top:247px;left:226px;white-space:nowrap" class="ft12714">compartment&#160;as&#160;the&#160;application&#160;and&#160;is&#160;not&#160;needed&#160;to&#160;be&#160;trusted,&#160;thus&#160;its&#160;size&#160;is&#160;not<br/>important.&#160;Applications&#160;already&#160;using&#160;the&#160;TLS&#160;implementation&#160;we&#160;chose&#160;to&#160;enhance<br/>(OpenSSL)&#160;must&#160;be&#160;slightly&#160;modified&#160;to&#160;be&#160;able&#160;to&#160;set&#160;up&#160;a&#160;Trusted&#160;Channel&#160;instead&#160;of<br/>the&#160;standard&#160;TLS&#160;secure&#160;channel.</p>
<p style="position:absolute;top:319px;left:248px;white-space:nowrap" class="ft1278">But,&#160;our&#160;architecture&#160;is&#160;also&#160;capable&#160;to&#160;support&#160;the&#160;provision&#160;of&#160;Trusted&#160;Channels</p>
<p style="position:absolute;top:337px;left:226px;white-space:nowrap" class="ft12714">as&#160;a&#160;service,&#160;running&#160;in&#160;a&#160;separate&#160;compartment&#160;and&#160;implemented&#160;as&#160;proxy.&#160;If&#160;so,&#160;the<br/>application&#160;directly&#160;bound&#160;to&#160;the&#160;adapted&#160;TLS&#160;protocol&#160;is&#160;the&#160;service&#160;providing&#160;the<br/>Trusted&#160;Channel&#160;to&#160;other&#160;applications.</p>
<p style="position:absolute;top:391px;left:248px;white-space:nowrap" class="ft1278">We&#160;identified&#160;at&#160;least&#160;two&#160;types&#160;of&#160;interaction&#160;between&#160;a&#160;Trusted&#160;Channel&#160;service</p>
<p style="position:absolute;top:409px;left:226px;white-space:nowrap" class="ft12714">and&#160;a&#160;generic&#160;application:&#160;explicit&#160;or&#160;implicit&#160;invocation.&#160;In&#160;the&#160;first&#160;case&#160;the&#160;applica-<br/>tion&#160;explicitly&#160;requests&#160;the&#160;service&#160;(i.e.&#160;the&#160;proxy)&#160;for&#160;setting&#160;up&#160;a&#160;Trusted&#160;Channel.&#160;A<br/>convenient&#160;implementation&#160;could&#160;use&#160;the&#160;SOCK<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#127">S</a></p>
<p style="position:absolute;top:442px;left:525px;white-space:nowrap" class="ft12727"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#127">15</a></p>
<p style="position:absolute;top:445px;left:540px;white-space:nowrap" class="ft1278">protocol&#160;as&#160;a&#160;carrier&#160;of&#160;the&#160;neces-</p>
<p style="position:absolute;top:463px;left:226px;white-space:nowrap" class="ft12715">sary&#160;calls.&#160;In&#160;case&#160;of&#160;implicit&#160;interaction,&#160;the&#160;application&#160;is&#160;unaware&#160;of&#160;the&#160;setup&#160;of&#160;the<br/>Trusted&#160;Channel.&#160;A&#160;communication&#160;policy,&#160;set&#160;within&#160;the&#160;TCB,&#160;enforces&#160;transparently<br/>the&#160;redirection&#160;of&#160;the&#160;application’s&#160;communications&#160;to&#160;the&#160;Trusted&#160;Channel&#160;service.&#160;A<br/>convenient&#160;implementation&#160;could&#160;rely&#160;on&#160;a&#160;transparent&#160;proxy,&#160;like&#160;the&#160;one&#160;implemented<br/>by&#160;SQUID&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[106]</a>.</p>
<p style="position:absolute;top:552px;left:248px;white-space:nowrap" class="ft1278">With&#160;both&#160;explicit&#160;and&#160;implicit&#160;invocation,&#160;a&#160;scheme&#160;using&#160;a&#160;pair&#160;of&#160;proxies&#160;on</p>
<p style="position:absolute;top:570px;left:226px;white-space:nowrap" class="ft12715">both&#160;sides&#160;can&#160;be&#160;set&#160;up,&#160;thus&#160;implementing&#160;a&#160;tunnel&#160;via&#160;Trusted&#160;Channel&#160;to&#160;carry&#160;the<br/>end-to-end&#160;communication.&#160;With&#160;the&#160;explicit&#160;invocation,&#160;it&#160;is&#160;also&#160;possible&#160;so&#160;set&#160;up&#160;a<br/>scheme&#160;with&#160;a&#160;proxy&#160;only&#160;on&#160;the&#160;client-side,&#160;directly&#160;connecting&#160;via&#160;Trusted&#160;Channel<br/>to&#160;the&#160;server.</p>
<p style="position:absolute;top:682px;left:226px;white-space:nowrap" class="ft12724"><b>9.7.2</b></p>
<p style="position:absolute;top:682px;left:280px;white-space:nowrap" class="ft12724"><b>Enhancements&#160;to&#160;OpenSSL</b></p>
<p style="position:absolute;top:712px;left:226px;white-space:nowrap" class="ft12715">OpenSSL&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">[87]&#160;</a>is&#160;a&#160;multi-platform&#160;and&#160;widespread&#160;software&#160;toolkit&#160;implementing&#160;cryp-<br/>tographic&#160;operations,&#160;SSL&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[53]&#160;</a>and&#160;TLS&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#169">[27]&#160;</a>protocols,&#160;the&#160;encoding/decoding&#160;of<br/>X.509&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[48]&#160;</a>certificates&#160;and&#160;of&#160;other&#160;PKI-related&#160;formats&#160;like&#160;PKCS&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">[60]&#160;</a>standards.<br/>It&#160;consists&#160;of&#160;two&#160;shared&#160;libraries&#160;(</p>
<p style="position:absolute;top:767px;left:440px;white-space:nowrap" class="ft12734">libssl</p>
<p style="position:absolute;top:766px;left:498px;white-space:nowrap" class="ft1278">and</p>
<p style="position:absolute;top:767px;left:525px;white-space:nowrap" class="ft12734">libcrypto</p>
<p style="position:absolute;top:766px;left:606px;white-space:nowrap" class="ft1278">)&#160;implementing&#160;all&#160;the</p>
<p style="position:absolute;top:784px;left:226px;white-space:nowrap" class="ft1278">features&#160;and&#160;a&#160;command&#160;line&#160;tool&#160;(</p>
<p style="position:absolute;top:785px;left:438px;white-space:nowrap" class="ft12734">openssl</p>
<p style="position:absolute;top:784px;left:501px;white-space:nowrap" class="ft1278">)&#160;wrapping&#160;them.&#160;The&#160;libraries&#160;can&#160;also</p>
<p style="position:absolute;top:802px;left:226px;white-space:nowrap" class="ft1278">be&#160;directly&#160;used&#160;by&#160;generic&#160;applications.</p>
<p style="position:absolute;top:820px;left:248px;white-space:nowrap" class="ft1278">OpenSSL&#160;also&#160;offers&#160;the&#160;possibility&#160;to&#160;delegate&#160;the&#160;execution&#160;of&#160;(a&#160;subset&#160;of)&#160;cryp-</p>
<p style="position:absolute;top:838px;left:226px;white-space:nowrap" class="ft12715">tographic&#160;operations&#160;to&#160;a&#160;separate&#160;module&#160;called&#160;engine.&#160;This&#160;is&#160;a&#160;shared&#160;library,&#160;with<br/>a&#160;well-known&#160;interface,&#160;which&#160;can&#160;be&#160;dynamically&#160;loaded&#160;at&#160;run-time&#160;and&#160;used&#160;by<br/>OpenSSL’s&#160;core&#160;libraries:&#160;more&#160;than&#160;one&#160;engine&#160;can&#160;be&#160;used&#160;at&#160;once.&#160;An&#160;engine&#160;can<br/>be&#160;implemented&#160;in&#160;software&#160;or&#160;the&#160;library&#160;can&#160;be&#160;just&#160;the&#160;driver&#160;for&#160;a&#160;hardware&#160;crypto-<br/>graphic&#160;device.</p>
<p style="position:absolute;top:927px;left:248px;white-space:nowrap" class="ft1278">We&#160;built&#160;the&#160;Trusted&#160;Channel&#160;around&#160;three&#160;different&#160;enhancements&#160;to&#160;OpenSSL,</p>
<p style="position:absolute;top:945px;left:226px;white-space:nowrap" class="ft1278">represented&#160;in&#160;the&#160;right-hand&#160;part&#160;of&#160;the&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#128">9.4&#160;</a>and&#160;described&#160;in&#160;the&#160;following.</p>
<p style="position:absolute;top:986px;left:226px;white-space:nowrap" class="ft12715"><b>TLS&#160;protocol&#160;extensions</b>:&#160;The&#160;stable&#160;version&#160;of&#160;OpenSSL&#160;(0.9.8x)&#160;does&#160;not&#160;imple-<br/>ment&#160;any&#160;extension&#160;while&#160;the&#160;development&#160;version&#160;(0.9.9x)&#160;only&#160;includes&#160;hard-coded</p>
<p style="position:absolute;top:1029px;left:238px;white-space:nowrap" class="ft12728">14</p>
<p style="position:absolute;top:1031px;left:248px;white-space:nowrap" class="ft12719">The&#160;trusted&#160;initialization&#160;described&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#125">9.6.1&#160;</a>is&#160;realized&#160;using&#160;the&#160;TrustedGRUB&#160;(<i>tGRUB</i>)&#160;boot</p>
<p style="position:absolute;top:1046px;left:226px;white-space:nowrap" class="ft12719">loader&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[4]</a></p>
<p style="position:absolute;top:1058px;left:238px;white-space:nowrap" class="ft12728">15</p>
<p style="position:absolute;top:1060px;left:248px;white-space:nowrap" class="ft12719">SOCKS&#160;is&#160;a&#160;well-known&#160;protocol&#160;for&#160;the&#160;communication&#160;with&#160;proxies&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#172">[73]</a>.&#160;The&#160;proxy&#160;is&#160;then&#160;the</p>
<p style="position:absolute;top:1074px;left:226px;white-space:nowrap" class="ft12719">application&#160;directly&#160;using&#160;the&#160;adapted&#160;TLS&#160;and&#160;running&#160;as&#160;service.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft12721">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 128 -->
<a name="128"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft128169{font-size:9px;font-family:VNZQXL+TT714Eo00;color:#000000;}
	.ft128170{font-size:9px;line-height:11px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page128-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5128.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1288">126</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft12821">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:419px;white-space:nowrap" class="ft12880"><b>DomU&#160;compartment&#160;(guest&#160;domain)</b></p>
<p style="position:absolute;top:261px;left:426px;white-space:nowrap" class="ft12880"><b>TLS&#160;frontend</b></p>
<p style="position:absolute;top:236px;left:157px;white-space:nowrap" class="ft12880"><b>Dom0&#160;compartment&#160;(privileged&#160;domain)</b></p>
<p style="position:absolute;top:254px;left:162px;white-space:nowrap" class="ft128170"><b>TLS&#160;backend&#160;<br/>(Trust&#160;and&#160;Storage&#160;managers)</b></p>
<p style="position:absolute;top:396px;left:544px;white-space:nowrap" class="ft12880"><b>OpenSSL&#160;enhancements</b></p>
<p style="position:absolute;top:280px;left:174px;white-space:nowrap" class="ft12843">TCh&#160;engine&#160;(server-side&#160;stub)</p>
<p style="position:absolute;top:212px;left:423px;white-space:nowrap" class="ft12880"><b>Application&#160;memory&#160;address&#160;space</b></p>
<p style="position:absolute;top:213px;left:256px;white-space:nowrap" class="ft12880"><b>Communication&#160;channel&#160;(TCP/IP)</b></p>
<p style="position:absolute;top:360px;left:375px;white-space:nowrap" class="ft12843">Xen&#160;Hypervisor</p>
<p style="position:absolute;top:379px;left:386px;white-space:nowrap" class="ft12843">Hardware</p>
<p style="position:absolute;top:376px;left:530px;white-space:nowrap" class="ft12843">CRTM&#160;CPU&#160;TPM</p>
<p style="position:absolute;top:396px;left:228px;white-space:nowrap" class="ft12880"><b>Components&#160;forming&#160;the&#160;TCB</b></p>
<p style="position:absolute;top:339px;left:512px;white-space:nowrap" class="ft12843">Linux&#160;kernel</p>
<p style="position:absolute;top:339px;left:251px;white-space:nowrap" class="ft12843">Linux&#160;kernel</p>
<p style="position:absolute;top:322px;left:215px;white-space:nowrap" class="ft12843">TCG&#160;Software&#160;Stack&#160;(TSS)</p>
<p style="position:absolute;top:295px;left:162px;white-space:nowrap" class="ft12843">Trusted&#160;Platform</p>
<p style="position:absolute;top:306px;left:170px;white-space:nowrap" class="ft12843">&#160;Agent&#160;(TPA)</p>
<p style="position:absolute;top:295px;left:241px;white-space:nowrap" class="ft12843">Software&#160;crypto&#160;</p>
<p style="position:absolute;top:306px;left:239px;white-space:nowrap" class="ft12843">engine&#160;(libcrypto)</p>
<p style="position:absolute;top:282px;left:535px;white-space:nowrap" class="ft12843">libssl</p>
<p style="position:absolute;top:314px;left:522px;white-space:nowrap" class="ft12843">TCh&#160;engine&#160;(client-side&#160;stub)</p>
<p style="position:absolute;top:287px;left:602px;white-space:nowrap" class="ft12843">libcrypto</p>
<p style="position:absolute;top:287px;left:428px;white-space:nowrap" class="ft12893">Standard&#160;OpenSSL<br/>Engine&#160;Interface</p>
<p style="position:absolute;top:239px;left:425px;white-space:nowrap" class="ft128169">Application&#160;Interface</p>
<p style="position:absolute;top:228px;left:529px;white-space:nowrap" class="ft12843">Application&#160;(or&#160;proxy)&#160;using&#160;</p>
<p style="position:absolute;top:239px;left:546px;white-space:nowrap" class="ft12843">TCh-enhanced&#160;TLS</p>
<p style="position:absolute;top:294px;left:517px;white-space:nowrap" class="ft12843">Hello&#160;ext&#160;SD</p>
<p style="position:absolute;top:264px;left:544px;white-space:nowrap" class="ft12843">TCh&#160;management</p>
<p style="position:absolute;top:295px;left:325px;white-space:nowrap" class="ft12843">Compartment</p>
<p style="position:absolute;top:306px;left:335px;white-space:nowrap" class="ft12843">Manager</p>
<p style="position:absolute;top:433px;left:203px;white-space:nowrap" class="ft1288">Figure&#160;9.4:&#160;OpenSSL&#160;enhancements&#160;and&#160;Proof&#160;of&#160;Concept&#160;prototype</p>
<p style="position:absolute;top:469px;left:150px;white-space:nowrap" class="ft1288">support&#160;for&#160;the&#160;extensions&#160;defined&#160;in&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">[95]&#160;</a>to</p>
<p style="position:absolute;top:468px;left:420px;white-space:nowrap" class="ft12853">ClientHello</p>
<p style="position:absolute;top:469px;left:498px;white-space:nowrap" class="ft1288">and</p>
<p style="position:absolute;top:468px;left:524px;white-space:nowrap" class="ft12853">ServerHello</p>
<p style="position:absolute;top:469px;left:605px;white-space:nowrap" class="ft1288">messages.</p>
<p style="position:absolute;top:487px;left:150px;white-space:nowrap" class="ft12815">We&#160;implemented&#160;a&#160;mechanism&#160;to&#160;easily&#160;add&#160;generic&#160;and&#160;application-defined&#160;extensions<br/>to&#160;these&#160;messages,&#160;usable&#160;to&#160;trigger&#160;the&#160;delivery&#160;of</p>
<p style="position:absolute;top:504px;left:448px;white-space:nowrap" class="ft12853">SupplementalData</p>
<p style="position:absolute;top:505px;left:570px;white-space:nowrap" class="ft1288">handshake&#160;mes-</p>
<p style="position:absolute;top:523px;left:150px;white-space:nowrap" class="ft12815">sage&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[105]</a>,&#160;also&#160;newly&#160;implemented&#160;because&#160;not&#160;natively&#160;supported.&#160;These&#160;are&#160;the&#160;only<br/>direct&#160;enhancements&#160;to&#160;OpenSSL,&#160;implemented&#160;as&#160;patch&#160;to</p>
<p style="position:absolute;top:541px;left:504px;white-space:nowrap" class="ft12834">libssl</p>
<p style="position:absolute;top:540px;left:558px;white-space:nowrap" class="ft1288">’s&#160;code,&#160;which&#160;ex-</p>
<p style="position:absolute;top:558px;left:150px;white-space:nowrap" class="ft1288">pose&#160;an&#160;API&#160;for&#160;registering&#160;new&#160;Hello&#160;extensions&#160;or&#160;data&#160;for</p>
<p style="position:absolute;top:558px;left:523px;white-space:nowrap" class="ft12853">SupplementalData</p>
<p style="position:absolute;top:558px;left:647px;white-space:nowrap" class="ft1288">via</p>
<p style="position:absolute;top:576px;left:150px;white-space:nowrap" class="ft1288">callback&#160;functions.</p>
<p style="position:absolute;top:599px;left:150px;white-space:nowrap" class="ft12814"><b>Trusted&#160;Channel&#160;management&#160;library</b>:&#160;This&#160;is&#160;a&#160;completely&#160;new&#160;module&#160;realizing<br/>the&#160;Hello&#160;extensions</p>
<p style="position:absolute;top:616px;left:282px;white-space:nowrap" class="ft12853">AExt</p>
<p style="position:absolute;top:617px;left:323px;white-space:nowrap" class="ft1288">and</p>
<p style="position:absolute;top:616px;left:350px;white-space:nowrap" class="ft12853">SCExt</p>
<p style="position:absolute;top:617px;left:399px;white-space:nowrap" class="ft1288">(on&#160;top&#160;of&#160;the&#160;enhanced</p>
<p style="position:absolute;top:618px;left:555px;white-space:nowrap" class="ft12834">libssl</p>
<p style="position:absolute;top:617px;left:609px;white-space:nowrap" class="ft1288">)&#160;and&#160;the</p>
<p style="position:absolute;top:635px;left:150px;white-space:nowrap" class="ft12814">logic&#160;of&#160;the&#160;Trusted&#160;Channel’s&#160;specific&#160;operations.&#160;It&#160;also&#160;handles&#160;the&#160;parsing&#160;and<br/>the&#160;validation&#160;of&#160;the&#160;credentials&#160;received&#160;during&#160;the&#160;handshake&#160;(</p>
<p style="position:absolute;top:652px;left:539px;white-space:nowrap" class="ft12853">PK</p>
<p style="position:absolute;top:657px;left:561px;white-space:nowrap" class="ft128166">AIK</p>
<p style="position:absolute;top:653px;left:586px;white-space:nowrap" class="ft1288">,</p>
<p style="position:absolute;top:652px;left:595px;white-space:nowrap" class="ft12853">PK</p>
<p style="position:absolute;top:657px;left:616px;white-space:nowrap" class="ft128166">sign</p>
<p style="position:absolute;top:653px;left:644px;white-space:nowrap" class="ft1288">and</p>
<p style="position:absolute;top:670px;left:150px;white-space:nowrap" class="ft12853">PK</p>
<p style="position:absolute;top:675px;left:171px;white-space:nowrap" class="ft128166">enc</p>
<p style="position:absolute;top:671px;left:191px;white-space:nowrap" class="ft1288">)&#160;and&#160;it&#160;manages&#160;the&#160;validation&#160;of&#160;the&#160;attestation&#160;data&#160;(i.e.</p>
<p style="position:absolute;top:670px;left:531px;white-space:nowrap" class="ft12853">aD</p>
<p style="position:absolute;top:671px;left:554px;white-space:nowrap" class="ft1288">and</p>
<p style="position:absolute;top:670px;left:579px;white-space:nowrap" class="ft12853">Sig</p>
<p style="position:absolute;top:675px;left:599px;white-space:nowrap" class="ft128166">aD</p>
<p style="position:absolute;top:671px;left:616px;white-space:nowrap" class="ft1288">)&#160;carried</p>
<p style="position:absolute;top:688px;left:150px;white-space:nowrap" class="ft1288">through&#160;the</p>
<p style="position:absolute;top:688px;left:224px;white-space:nowrap" class="ft12853">SupplementalData</p>
<p style="position:absolute;top:688px;left:348px;white-space:nowrap" class="ft1288">message.&#160;Finally&#160;it&#160;provides&#160;the&#160;application&#160;with&#160;an</p>
<p style="position:absolute;top:706px;left:150px;white-space:nowrap" class="ft1288">interface&#160;to&#160;set&#160;up&#160;the&#160;Trusted&#160;Channel.</p>
<p style="position:absolute;top:729px;left:150px;white-space:nowrap" class="ft12815"><b>TLS&#160;backend&#160;via&#160;split&#160;engine</b>:&#160;To&#160;implement&#160;our&#160;concept&#160;of&#160;delegating&#160;the&#160;secu-<br/>rity&#160;critical&#160;operations,&#160;we&#160;implemented&#160;an&#160;OpenSSL&#160;engine&#160;split&#160;into&#160;two&#160;parts.&#160;The<br/>shared&#160;library&#160;implementing&#160;the&#160;engine&#160;interface&#160;runs&#160;in&#160;the&#160;application&#160;(or&#160;proxy)<br/>memory&#160;space&#160;together&#160;with&#160;the&#160;Trusted&#160;Channel&#160;management&#160;library&#160;and</p>
<p style="position:absolute;top:783px;left:608px;white-space:nowrap" class="ft12834">libssl</p>
<p style="position:absolute;top:782px;left:662px;white-space:nowrap" class="ft1288">:</p>
<p style="position:absolute;top:800px;left:150px;white-space:nowrap" class="ft1288">they&#160;all&#160;form&#160;the</p>
<p style="position:absolute;top:800px;left:258px;white-space:nowrap" class="ft12853">TLS&#160;frontend</p>
<p style="position:absolute;top:800px;left:347px;white-space:nowrap" class="ft1288">.&#160;The&#160;latter&#160;requests&#160;the&#160;execution&#160;of&#160;critical&#160;opera-</p>
<p style="position:absolute;top:818px;left:150px;white-space:nowrap" class="ft1288">tions&#160;over&#160;a&#160;communication&#160;channel&#160;at&#160;the</p>
<p style="position:absolute;top:818px;left:407px;white-space:nowrap" class="ft12853">TLS&#160;backend</p>
<p style="position:absolute;top:818px;left:493px;white-space:nowrap" class="ft1288">,&#160;which&#160;actually&#160;provides&#160;the</p>
<p style="position:absolute;top:836px;left:150px;white-space:nowrap" class="ft12814">functions&#160;needed&#160;by&#160;the&#160;TLS&#160;protocol&#160;and&#160;runs&#160;in&#160;a&#160;different&#160;compartment&#160;as&#160;part&#160;of<br/>the&#160;TCB.</p>
<p style="position:absolute;top:917px;left:150px;white-space:nowrap" class="ft12824"><b>9.7.3</b></p>
<p style="position:absolute;top:917px;left:204px;white-space:nowrap" class="ft12824"><b>Proof&#160;of&#160;Concept&#160;(PoC)&#160;Prototype</b></p>
<p style="position:absolute;top:948px;left:150px;white-space:nowrap" class="ft12815">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#128">9.4&#160;</a>shows&#160;a&#160;PoC&#160;prototype&#160;of&#160;our&#160;OpenSSL-based&#160;Trusted&#160;Channel&#160;implemen-<br/>tation&#160;built&#160;upon&#160;Xen.</p>
<p style="position:absolute;top:983px;left:172px;white-space:nowrap" class="ft1288">The</p>
<p style="position:absolute;top:983px;left:201px;white-space:nowrap" class="ft12853">TLS&#160;backend</p>
<p style="position:absolute;top:983px;left:293px;white-space:nowrap" class="ft1288">runs&#160;in&#160;Domain<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#128">0</a></p>
<p style="position:absolute;top:981px;left:398px;white-space:nowrap" class="ft12827"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#128">16</a></p>
<p style="position:absolute;top:983px;left:415px;white-space:nowrap" class="ft1288">–&#160;the&#160;Xen&#160;privileged&#160;domain&#160;–&#160;and&#160;uses</p>
<p style="position:absolute;top:1001px;left:150px;white-space:nowrap" class="ft12815">TrouSerS&#160;–&#160;an&#160;open&#160;source&#160;TCG&#160;Software&#160;Stack&#160;(TSS)&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[117]&#160;</a>–&#160;to&#160;access&#160;the&#160;TPM<br/>capabilities.&#160;It&#160;can&#160;be&#160;decomposed&#160;in:&#160;(1)&#160;server-side&#160;stub,&#160;the&#160;endpoint&#160;for&#160;the&#160;com-</p>
<p style="position:absolute;top:1046px;left:162px;white-space:nowrap" class="ft12828">16</p>
<p style="position:absolute;top:1048px;left:171px;white-space:nowrap" class="ft12819">Because&#160;the&#160;root&#160;account&#160;in&#160;Domain0&#160;has&#160;full&#160;access&#160;to&#160;all&#160;resources&#160;and&#160;services,&#160;protection&#160;against&#160;a</p>
<p style="position:absolute;top:1062px;left:150px;white-space:nowrap" class="ft12819">malicious&#160;administrator&#160;is&#160;not&#160;possible&#160;in&#160;our&#160;PoC.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft12821">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 129 -->
<a name="129"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft129171{font-size:12px;font-family:Courier;color:#231f20;}
-->
</style>
<div id="page129-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5129.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1298">CHAPTER&#160;9.&#160;TRUSTED&#160;CHANNELS&#160;USING&#160;OPENSSL</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1298">127</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft1298">munication&#160;with&#160;the</p>
<p style="position:absolute;top:193px;left:351px;white-space:nowrap" class="ft12953">TLS&#160;frontend</p>
<p style="position:absolute;top:194px;left:445px;white-space:nowrap" class="ft1298">via&#160;TCP-based&#160;protocol,&#160;(2)&#160;the&#160;Trusted&#160;Platform</p>
<p style="position:absolute;top:212px;left:226px;white-space:nowrap" class="ft1298">Agent&#160;(TPA<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#129">)</a></p>
<p style="position:absolute;top:209px;left:304px;white-space:nowrap" class="ft12927"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#129">17</a></p>
<p style="position:absolute;top:212px;left:319px;white-space:nowrap" class="ft1298">in&#160;charge&#160;of&#160;dealing&#160;with&#160;the&#160;life-cycle&#160;management&#160;of&#160;all&#160;credentials</p>
<p style="position:absolute;top:230px;left:226px;white-space:nowrap" class="ft12915">and&#160;implementing&#160;a&#160;minimal&#160;Storage&#160;Manager&#160;and&#160;(3)&#160;a&#160;software&#160;module&#160;partially&#160;im-<br/>plementing&#160;a&#160;Trust&#160;Manage<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#129">r</a></p>
<p style="position:absolute;top:245px;left:396px;white-space:nowrap" class="ft12927"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#129">18</a></p>
<p style="position:absolute;top:247px;left:411px;white-space:nowrap" class="ft1298">which&#160;performs&#160;all&#160;cryptographic&#160;operations&#160;during&#160;the</p>
<p style="position:absolute;top:265px;left:226px;white-space:nowrap" class="ft1298">handshake&#160;and&#160;the&#160;TLS&#160;session.</p>
<p style="position:absolute;top:329px;left:226px;white-space:nowrap" class="ft12926"><b>9.8</b></p>
<p style="position:absolute;top:329px;left:274px;white-space:nowrap" class="ft12926"><b>Security&#160;Considerations</b></p>
<p style="position:absolute;top:367px;left:226px;white-space:nowrap" class="ft12914">In&#160;this&#160;section&#160;we&#160;carry&#160;out&#160;a&#160;short&#160;reevaluation&#160;of&#160;the&#160;security&#160;requirements&#160;adopted<br/>from&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[10]&#160;</a>and&#160;presented&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#116">9.2.1&#160;</a>with&#160;regard&#160;to&#160;our&#160;new&#160;approach.</p>
<p style="position:absolute;top:425px;left:233px;white-space:nowrap" class="ft12923"><b>(SR1)&#160;Secure&#160;channel&#160;properties:&#160;</b>TLS&#160;provides&#160;secure&#160;channel&#160;properties&#160;during</p>
<p style="position:absolute;top:443px;left:256px;white-space:nowrap" class="ft12914">transmission.&#160;On&#160;the&#160;endpoints&#160;the&#160;TCB&#160;offers&#160;those&#160;properties.&#160;Confidential-<br/>ity&#160;and&#160;integrity&#160;are&#160;provided&#160;by&#160;trusted&#160;initialization,&#160;isolation&#160;of&#160;the&#160;TCB&#160;and<br/>platform&#160;monitoring.&#160;The&#160;concept&#160;is&#160;even&#160;able&#160;to&#160;provide&#160;protection&#160;against&#160;a&#160;ma-<br/>licious&#160;administrator,&#160;because&#160;the&#160;measurements&#160;of&#160;the&#160;TCB&#160;cannot&#160;be&#160;faked,&#160;and<br/>if&#160;the&#160;TCB&#160;is&#160;properly&#160;configured&#160;(expressed&#160;by&#160;its&#160;measurements),&#160;it&#160;should&#160;not<br/>be&#160;possible&#160;to&#160;tamper&#160;with&#160;the&#160;TCB&#160;while&#160;running.&#160;The&#160;TCB&#160;also&#160;takes&#160;care&#160;of<br/>authenticity&#160;and&#160;freshness&#160;by&#160;securely&#160;storing&#160;nonces&#160;and&#160;session&#160;keys.&#160;As&#160;a&#160;result<br/>of&#160;platform&#160;monitoring,&#160;every&#160;manipulation&#160;of&#160;a&#160;compartment&#160;is&#160;noticed&#160;and&#160;ac-<br/>cess&#160;to&#160;sensitive&#160;data&#160;can&#160;be&#160;barred&#160;if&#160;necessary&#160;to&#160;ensure&#160;the&#160;security&#160;properties.<br/>Furthermore,&#160;SM&#160;provides&#160;storage&#160;that&#160;can&#160;preserve&#160;secure&#160;channel&#160;properties&#160;in<br/>case&#160;that&#160;data&#160;is&#160;stored&#160;persistently.</p>
<p style="position:absolute;top:645px;left:233px;white-space:nowrap" class="ft12923"><b>(SR2)&#160;Authentic&#160;linkage&#160;of&#160;configuration&#160;information&#160;and&#160;secure&#160;channel:&#160;</b>Au-</p>
<p style="position:absolute;top:663px;left:256px;white-space:nowrap" class="ft1298">thenticity&#160;of&#160;communication&#160;is&#160;guaranteed&#160;by&#160;providing</p>
<p style="position:absolute;top:662px;left:595px;white-space:nowrap" class="ft12953">cert</p>
<p style="position:absolute;top:668px;left:620px;white-space:nowrap" class="ft129166">TCLS</p>
<p style="position:absolute;top:663px;left:658px;white-space:nowrap" class="ft1298">that&#160;is&#160;used&#160;to</p>
<p style="position:absolute;top:681px;left:256px;white-space:nowrap" class="ft12915">authenticate&#160;the&#160;endpoints&#160;(cf.&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#118">9.4)</a>.&#160;The&#160;secure&#160;linkage&#160;of&#160;configuration<br/>information&#160;to&#160;the&#160;endpoints&#160;is&#160;verified&#160;by&#160;evaluating&#160;the</p>
<p style="position:absolute;top:698px;left:608px;white-space:nowrap" class="ft12953">SKAE</p>
<p style="position:absolute;top:699px;left:651px;white-space:nowrap" class="ft1298">,</p>
<p style="position:absolute;top:698px;left:660px;white-space:nowrap" class="ft12953">Sig</p>
<p style="position:absolute;top:704px;left:680px;white-space:nowrap" class="ft129166">BSEK</p>
<p style="position:absolute;top:699px;left:720px;white-space:nowrap" class="ft1298">and</p>
<p style="position:absolute;top:716px;left:256px;white-space:nowrap" class="ft12953">Sig</p>
<p style="position:absolute;top:722px;left:276px;white-space:nowrap" class="ft129166">aD</p>
<p style="position:absolute;top:717px;left:293px;white-space:nowrap" class="ft1298">.</p>
<p style="position:absolute;top:739px;left:256px;white-space:nowrap" class="ft1298">We&#160;assume&#160;a&#160;secure&#160;as&#160;well&#160;as&#160;specification&#160;conformant&#160;creation&#160;of</p>
<p style="position:absolute;top:739px;left:653px;white-space:nowrap" class="ft12953">K</p>
<p style="position:absolute;top:744px;left:665px;white-space:nowrap" class="ft129166">storage</p>
<p style="position:absolute;top:739px;left:707px;white-space:nowrap" class="ft1298">(Stor-</p>
<p style="position:absolute;top:757px;left:256px;white-space:nowrap" class="ft1298">age&#160;Root&#160;Key)&#160;and</p>
<p style="position:absolute;top:756px;left:371px;white-space:nowrap" class="ft12946">AIK</p>
<p style="position:absolute;top:757px;left:404px;white-space:nowrap" class="ft1298">.&#160;We&#160;further&#160;assume&#160;that&#160;a&#160;TCB&#160;whose&#160;configuration&#160;has</p>
<p style="position:absolute;top:775px;left:256px;white-space:nowrap" class="ft12914">been&#160;evaluated&#160;by&#160;the&#160;counterpart&#160;is&#160;able&#160;to&#160;reliably&#160;transfer&#160;configuration&#160;infor-<br/>mation&#160;related&#160;to&#160;the&#160;client&#160;compartments&#160;and&#160;takes&#160;care&#160;of&#160;the&#160;secure&#160;storage&#160;and<br/>application&#160;of&#160;the&#160;keys&#160;used&#160;within&#160;the&#160;handshake.&#160;A&#160;possibility&#160;for&#160;the&#160;retrieval<br/>of&#160;CA&#160;keys&#160;for&#160;verification&#160;of&#160;signatures&#160;is&#160;also&#160;anticipated.</p>
<p style="position:absolute;top:851px;left:256px;white-space:nowrap" class="ft12915">After&#160;a&#160;successful&#160;evaluation&#160;of&#160;the&#160;credentials&#160;transferred,&#160;these&#160;statements&#160;can<br/>be&#160;made:&#160;All&#160;keys&#160;are&#160;bound&#160;to&#160;the&#160;same&#160;TCB.&#160;This&#160;TCB&#160;is&#160;specified&#160;by&#160;mea-<br/>surement&#160;values&#160;incorporated&#160;in</p>
<p style="position:absolute;top:887px;left:450px;white-space:nowrap" class="ft12953">SKAE</p>
<p style="position:absolute;top:887px;left:493px;white-space:nowrap" class="ft1298">.&#160;Thus,&#160;the</p>
<p style="position:absolute;top:887px;left:560px;white-space:nowrap" class="ft12953">properties</p>
<p style="position:absolute;top:887px;left:628px;white-space:nowrap" class="ft1298">and&#160;the</p>
<p style="position:absolute;top:886px;left:675px;white-space:nowrap" class="ft12946">changelog</p>
<p style="position:absolute;top:905px;left:256px;white-space:nowrap" class="ft1298">sent&#160;originate&#160;from&#160;this&#160;TCB&#160;because</p>
<p style="position:absolute;top:905px;left:488px;white-space:nowrap" class="ft12953">SK</p>
<p style="position:absolute;top:910px;left:508px;white-space:nowrap" class="ft129166">sign</p>
<p style="position:absolute;top:905px;left:535px;white-space:nowrap" class="ft1298">and</p>
<p style="position:absolute;top:905px;left:561px;white-space:nowrap" class="ft12953">SK</p>
<p style="position:absolute;top:910px;left:581px;white-space:nowrap" class="ft129166">enc</p>
<p style="position:absolute;top:905px;left:606px;white-space:nowrap" class="ft1298">are&#160;sealed&#160;to&#160;this&#160;TCB</p>
<p style="position:absolute;top:923px;left:256px;white-space:nowrap" class="ft1298">and&#160;signed&#160;by</p>
<p style="position:absolute;top:923px;left:343px;white-space:nowrap" class="ft12953">SK</p>
<p style="position:absolute;top:928px;left:363px;white-space:nowrap" class="ft129166">SKAE</p>
<p style="position:absolute;top:923px;left:398px;white-space:nowrap" class="ft1298">.</p>
<p style="position:absolute;top:945px;left:256px;white-space:nowrap" class="ft12953">SeK</p>
<p style="position:absolute;top:945px;left:285px;white-space:nowrap" class="ft1298">,</p>
<p style="position:absolute;top:945px;left:293px;white-space:nowrap" class="ft12953">K</p>
<p style="position:absolute;top:950px;left:305px;white-space:nowrap" class="ft129166">sign</p>
<p style="position:absolute;top:945px;left:332px;white-space:nowrap" class="ft1298">and</p>
<p style="position:absolute;top:945px;left:358px;white-space:nowrap" class="ft12953">K</p>
<p style="position:absolute;top:950px;left:369px;white-space:nowrap" class="ft129166">enc</p>
<p style="position:absolute;top:945px;left:393px;white-space:nowrap" class="ft1298">are&#160;kept&#160;inside&#160;the&#160;TCB&#160;during&#160;the&#160;whole&#160;session.&#160;Due&#160;to</p>
<p style="position:absolute;top:963px;left:256px;white-space:nowrap" class="ft12915">the&#160;isolation&#160;property&#160;of&#160;the&#160;TCB&#160;those&#160;keys&#160;cannot&#160;be&#160;disclosed&#160;to&#160;compartments<br/>or&#160;to&#160;other&#160;platforms.&#160;This&#160;is&#160;the&#160;reason&#160;why&#160;we&#160;claim&#160;to&#160;provide&#160;better&#160;forward<br/>secrecy&#160;for&#160;session&#160;keys&#160;in&#160;case&#160;of&#160;using&#160;RSA&#160;as&#160;key&#160;exchange&#160;method.&#160;Relay<br/>attacks&#160;as&#160;well&#160;as&#160;attacks&#160;to&#160;obtain&#160;any&#160;keys&#160;establishing&#160;the&#160;Trusted&#160;Channel&#160;are</p>
<p style="position:absolute;top:1044px;left:238px;white-space:nowrap" class="ft12928">17</p>
<p style="position:absolute;top:1046px;left:248px;white-space:nowrap" class="ft12919">TPA&#160;has&#160;been&#160;developed&#160;within&#160;the&#160;OpenTC&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">[86]&#160;</a>project</p>
<p style="position:absolute;top:1059px;left:238px;white-space:nowrap" class="ft12928">18</p>
<p style="position:absolute;top:1061px;left:248px;white-space:nowrap" class="ft12919">we&#160;chose&#160;to&#160;use&#160;the&#160;OpenSSL&#160;library</p>
<p style="position:absolute;top:1061px;left:428px;white-space:nowrap" class="ft129171">libcrypto</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft12921">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 130 -->
<a name="130"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page130-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5130.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1308">128</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft13021">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:180px;white-space:nowrap" class="ft1308">not&#160;feasible&#160;assumed&#160;that&#160;no&#160;hardware&#160;attacks&#160;are&#160;applied.</p>
<p style="position:absolute;top:216px;left:157px;white-space:nowrap" class="ft13023"><b>(SR3)&#160;Privacy:&#160;</b>With&#160;regard&#160;to&#160;configuration&#160;data&#160;transmitted,&#160;we&#160;provide&#160;a&#160;possi-</p>
<p style="position:absolute;top:234px;left:180px;white-space:nowrap" class="ft13014">bility&#160;to&#160;send&#160;it&#160;encrypted&#160;to&#160;protect&#160;potentially&#160;sensitive&#160;data&#160;(see&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#122">9.5.2)</a>.<br/>Only&#160;the&#160;configuration&#160;of&#160;TCB&#160;and&#160;the&#160;TLS&#160;client&#160;compartments&#160;is&#160;reported&#160;to<br/>the&#160;peer,&#160;keeping&#160;the&#160;information&#160;disclosed&#160;to&#160;the&#160;other&#160;platform&#160;as&#160;minimal&#160;as<br/>possible.&#160;Furthermore,&#160;every&#160;communication&#160;partner&#160;can&#160;assess&#160;the&#160;trustworthi-<br/>ness&#160;of&#160;its&#160;counterpart&#160;and&#160;thus,&#160;make&#160;a&#160;judgment&#160;on&#160;whether&#160;it&#160;will&#160;treat&#160;personal<br/>information&#160;according&#160;to&#160;its&#160;security&#160;policy.</p>
<p style="position:absolute;top:392px;left:150px;white-space:nowrap" class="ft13026"><b>9.9</b></p>
<p style="position:absolute;top:392px;left:198px;white-space:nowrap" class="ft13026"><b>Functional&#160;Considerations</b></p>
<p style="position:absolute;top:430px;left:150px;white-space:nowrap" class="ft13014">To&#160;meet&#160;the&#160;functional&#160;requirements&#160;(cf.&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#117">9.2.2)&#160;</a>following&#160;measures&#160;have&#160;been<br/>taken:</p>
<p style="position:absolute;top:488px;left:157px;white-space:nowrap" class="ft13023"><b>(FR1)&#160;Fast&#160;deployment&#160;support:&#160;</b>To&#160;make&#160;a&#160;fast&#160;and&#160;widespread&#160;deployment&#160;of&#160;our</p>
<p style="position:absolute;top:506px;left:180px;white-space:nowrap" class="ft13014">approach&#160;possible,&#160;we&#160;decided&#160;to&#160;adapt&#160;TLS&#160;as&#160;a&#160;commonly&#160;used&#160;protocol&#160;to&#160;sup-<br/>port&#160;the&#160;exchange&#160;of&#160;endpoint&#160;configuration&#160;information.&#160;Furthermore,&#160;we&#160;took<br/>an&#160;existing&#160;TLS&#160;implementation&#160;(OpenSSL)&#160;and&#160;adapted&#160;it&#160;to&#160;our&#160;needs.&#160;Thus,<br/>the&#160;effort&#160;that&#160;had&#160;to&#160;be&#160;put&#160;into&#160;the&#160;implementation&#160;of&#160;our&#160;approach&#160;was&#160;moder-<br/>ate&#160;and&#160;will&#160;presumably&#160;be&#160;even&#160;smaller&#160;for&#160;other&#160;existing&#160;TLS&#160;implementations,<br/>since&#160;we&#160;had&#160;to&#160;add&#160;features&#160;like,&#160;e.g,&#160;extension&#160;support,&#160;that&#160;normally&#160;should<br/>already&#160;be&#160;integrated.&#160;Additionally,&#160;we&#160;only&#160;applied&#160;mechanisms&#160;and&#160;concepts<br/>already&#160;defined&#160;in&#160;existing&#160;specifications.&#160;Thus,&#160;it&#160;is&#160;not&#160;necessary&#160;to&#160;go&#160;through&#160;a<br/>time-consuming&#160;specification&#160;process.&#160;Finally,&#160;our&#160;new&#160;concept&#160;is&#160;able&#160;to&#160;support<br/>all&#160;common&#160;key&#160;exchange&#160;methods&#160;of&#160;TLS.</p>
<p style="position:absolute;top:690px;left:157px;white-space:nowrap" class="ft13023"><b>(FR2)&#160;Minimal</b></p>
<p style="position:absolute;top:690px;left:287px;white-space:nowrap" class="ft13023"><b>costs:</b></p>
<p style="position:absolute;top:690px;left:380px;white-space:nowrap" class="ft1308">For</p>
<p style="position:absolute;top:690px;left:431px;white-space:nowrap" class="ft1308">the</p>
<p style="position:absolute;top:690px;left:479px;white-space:nowrap" class="ft1308">implementation</p>
<p style="position:absolute;top:690px;left:603px;white-space:nowrap" class="ft1308">of</p>
<p style="position:absolute;top:690px;left:645px;white-space:nowrap" class="ft1308">our</p>
<p style="position:absolute;top:708px;left:180px;white-space:nowrap" class="ft1308">concept</p>
<p style="position:absolute;top:708px;left:264px;white-space:nowrap" class="ft1308">we</p>
<p style="position:absolute;top:708px;left:320px;white-space:nowrap" class="ft1308">used</p>
<p style="position:absolute;top:708px;left:385px;white-space:nowrap" class="ft1308">commercial</p>
<p style="position:absolute;top:708px;left:494px;white-space:nowrap" class="ft1308">off-the-shelf</p>
<p style="position:absolute;top:708px;left:606px;white-space:nowrap" class="ft1308">hardware.</p>
<p style="position:absolute;top:726px;left:180px;white-space:nowrap" class="ft13014">Thus,&#160;no&#160;expensive&#160;cryptographic&#160;hardware&#160;is&#160;necessary.&#160;Only&#160;Open&#160;Source<br/>Software&#160;was&#160;used&#160;for&#160;the&#160;realization&#160;of&#160;the&#160;software&#160;part.&#160;The&#160;resulting&#160;code&#160;is<br/>available&#160;without&#160;charge&#160;and&#160;incurs&#160;no&#160;additional&#160;license&#160;costs&#160;for&#160;the&#160;user.&#160;In<br/>contrast&#160;to&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[10]</a>,&#160;we&#160;also&#160;decoupled&#160;TLS&#160;certificate&#160;keys&#160;from&#160;a&#160;fixed&#160;platform<br/>configuration&#160;by&#160;introducing&#160;a&#160;TCB&#160;update&#160;mechanism&#160;(cf.&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#126">9.6.2)&#160;</a>that<br/>enables&#160;updates&#160;of&#160;the&#160;TCB&#160;without&#160;losing&#160;track&#160;of&#160;the&#160;states&#160;the&#160;platform&#160;went<br/>through.</p>
<p style="position:absolute;top:856px;left:157px;white-space:nowrap" class="ft13023"><b>(FR3)&#160;Minimal&#160;overhead&#160;during&#160;handshake:&#160;</b>To&#160;be&#160;able&#160;to&#160;ensure&#160;fast&#160;response</p>
<p style="position:absolute;top:874px;left:180px;white-space:nowrap" class="ft13015">times,&#160;we&#160;do&#160;not&#160;rely&#160;on&#160;the&#160;direct&#160;usage&#160;of&#160;the&#160;TPM.&#160;This&#160;would&#160;induce&#160;too&#160;much<br/>overhead&#160;since&#160;the&#160;TPM&#160;is&#160;currently&#160;connected&#160;to&#160;a&#160;LPC-Bus&#160;that&#160;has&#160;only&#160;limited<br/>bandwidth&#160;and&#160;its&#160;processing&#160;power&#160;is&#160;also&#160;very&#160;restricted.&#160;Thus,&#160;we&#160;decided&#160;to<br/>involve&#160;the&#160;TPM&#160;only&#160;for&#160;system&#160;initialization.&#160;From&#160;then&#160;on&#160;all&#160;functionalities&#160;are<br/>provided&#160;by&#160;Trusted&#160;Services.&#160;Thus,&#160;even&#160;in&#160;a&#160;server&#160;environment&#160;fast&#160;response<br/>times&#160;are&#160;ensured.&#160;The&#160;overhead&#160;induced&#160;by&#160;transferring&#160;attestation&#160;information<br/>is&#160;minimal,&#160;since&#160;the&#160;amount&#160;of&#160;data&#160;transferred&#160;is&#160;comparatively&#160;small.&#160;We&#160;tested<br/>this&#160;in&#160;a&#160;testbed&#160;and&#160;the&#160;results&#160;showed&#160;that&#160;there&#160;is&#160;no&#160;significant&#160;performance<br/>overhead&#160;induced&#160;by&#160;inserting&#160;and&#160;transferring&#160;the&#160;extensions.</p>
<p style="position:absolute;top:1040px;left:157px;white-space:nowrap" class="ft13023"><b>(FR4)&#160;Flexible&#160;configuration&#160;reporting:&#160;</b>By&#160;incorporating&#160;the&#160;possibility&#160;to&#160;transfer</p>
<p style="position:absolute;top:1058px;left:180px;white-space:nowrap" class="ft1308">whatever&#160;integrity/&#160;configuration&#160;information&#160;(e.g.,&#160;see&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[96]</a>)&#160;one&#160;may&#160;want&#160;to&#160;pro-</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft13021">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 131 -->
<a name="131"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page131-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5131.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1318">CHAPTER&#160;9.&#160;TRUSTED&#160;CHANNELS&#160;USING&#160;OPENSSL</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1318">129</p>
<p style="position:absolute;top:194px;left:256px;white-space:nowrap" class="ft1318">vide,&#160;using&#160;a&#160;black&#160;box</p>
<p style="position:absolute;top:193px;left:397px;white-space:nowrap" class="ft13153">properties</p>
<p style="position:absolute;top:194px;left:465px;white-space:nowrap" class="ft1318">field,&#160;we&#160;ensure&#160;interoperability&#160;and&#160;safeguard</p>
<p style="position:absolute;top:212px;left:256px;white-space:nowrap" class="ft13114">forward&#160;compatibility&#160;of&#160;our&#160;concept.&#160;We&#160;showed&#160;that,&#160;e.g.,&#160;the&#160;TCG&#160;approach<br/>to&#160;use&#160;the</p>
<p style="position:absolute;top:230px;left:317px;white-space:nowrap" class="ft131167">TPM</p>
<p style="position:absolute;top:230px;left:341px;white-space:nowrap" class="ft1318">_</p>
<p style="position:absolute;top:230px;left:348px;white-space:nowrap" class="ft131167">Quote</p>
<p style="position:absolute;top:229px;left:388px;white-space:nowrap" class="ft13148">()</p>
<p style="position:absolute;top:230px;left:403px;white-space:nowrap" class="ft1318"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#175">[119,&#160;</a>p.160]&#160;for&#160;attestation&#160;is&#160;also&#160;supported&#160;(cf.&#160;Section</p>
<p style="position:absolute;top:247px;left:256px;white-space:nowrap" class="ft1318"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#118">9.4)</a>.</p>
<p style="position:absolute;top:270px;left:233px;white-space:nowrap" class="ft13123"><b>(FR5)&#160;Backward&#160;compatibility:&#160;</b>To&#160;be&#160;sure&#160;that&#160;also&#160;peers&#160;only&#160;supporting&#160;common</p>
<p style="position:absolute;top:288px;left:256px;white-space:nowrap" class="ft13114">TLS&#160;secure&#160;channels&#160;can&#160;communicate&#160;with&#160;systems&#160;that&#160;use&#160;our&#160;concept,&#160;we&#160;only<br/>used&#160;or&#160;defined&#160;extensions&#160;to&#160;the&#160;different&#160;specifications.&#160;Those&#160;extensions&#160;are<br/>ignored&#160;if&#160;they&#160;are&#160;not&#160;supported.&#160;Furthermore,&#160;we&#160;kept&#160;the&#160;whole&#160;implementation<br/>separated&#160;from&#160;the&#160;application&#160;layer&#160;offering&#160;a&#160;transparent&#160;usage&#160;of&#160;the&#160;Trusted<br/>Channel.&#160;Thus,&#160;applications&#160;do&#160;not&#160;have&#160;to&#160;be&#160;adapted&#160;to&#160;make&#160;use&#160;of&#160;our&#160;concept.</p>
<p style="position:absolute;top:428px;left:226px;white-space:nowrap" class="ft13126"><b>9.10</b></p>
<p style="position:absolute;top:428px;left:285px;white-space:nowrap" class="ft13126"><b>Summary</b></p>
<p style="position:absolute;top:466px;left:226px;white-space:nowrap" class="ft13114">In&#160;this&#160;paper&#160;we&#160;presented&#160;a&#160;security&#160;architecture&#160;as&#160;well&#160;as&#160;an&#160;adaptation&#160;of&#160;the&#160;TLS<br/>handshake&#160;to&#160;provide&#160;a&#160;Trusted&#160;Channel&#160;that&#160;combines&#160;the&#160;security&#160;features&#160;of&#160;a&#160;se-<br/>cure&#160;channel&#160;with&#160;the&#160;ability&#160;to&#160;determine&#160;the&#160;trustworthiness&#160;of&#160;the&#160;communication<br/>endpoints.</p>
<p style="position:absolute;top:538px;left:248px;white-space:nowrap" class="ft1318">After&#160;a&#160;detailed&#160;description&#160;of&#160;our&#160;design&#160;and&#160;its&#160;implementation,&#160;we&#160;showed&#160;that</p>
<p style="position:absolute;top:555px;left:226px;white-space:nowrap" class="ft13115">our&#160;approach&#160;is&#160;able&#160;to&#160;meet&#160;the&#160;strict&#160;requirements&#160;set&#160;in&#160;the&#160;beginning.&#160;By&#160;meeting<br/>these&#160;requirements&#160;we&#160;are&#160;able&#160;to&#160;provide&#160;a&#160;means&#160;to&#160;fight&#160;off&#160;many&#160;threats&#160;to&#160;today’s<br/>and&#160;tomorrow’s&#160;distributed&#160;applications&#160;with&#160;a&#160;concept&#160;that&#160;is&#160;deployable&#160;in&#160;the&#160;short-<br/>term.</p>
<p style="position:absolute;top:627px;left:248px;white-space:nowrap" class="ft1318">In&#160;a&#160;next&#160;step&#160;we&#160;plan&#160;to&#160;hand&#160;in&#160;a&#160;RFC&#160;for&#160;our&#160;extensions&#160;to&#160;the&#160;IETF&#160;consensus</p>
<p style="position:absolute;top:645px;left:226px;white-space:nowrap" class="ft13114">process&#160;and&#160;we&#160;work&#160;on&#160;adapting&#160;IPSec&#160;to&#160;be&#160;used&#160;as&#160;Trusted&#160;Channel&#160;protocol.&#160;A&#160;for-<br/>mal&#160;security&#160;analysis&#160;of&#160;the&#160;presented&#160;TLS&#160;handshake&#160;is&#160;subject&#160;to&#160;future&#160;work&#160;as&#160;well<br/>as&#160;the&#160;adaptation&#160;of&#160;other&#160;protocols,&#160;e.g.,&#160;SSH,&#160;to&#160;fit&#160;the&#160;needs&#160;of&#160;a&#160;Trusted&#160;Channel.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft13121">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 132 -->
<a name="132"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page132-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5132.png" alt="background image"/>
<p style="position:absolute;top:295px;left:150px;white-space:nowrap" class="ft13225"><b>Chapter&#160;10</b></p>
<p style="position:absolute;top:365px;left:150px;white-space:nowrap" class="ft13235"><b>Towards&#160;Dependability&#160;and<br/>Attack&#160;Resistance</b></p>
<p style="position:absolute;top:467px;left:180px;white-space:nowrap" class="ft1328">Bernhard&#160;Jansen,&#160;HariGovind&#160;V.&#160;Ramasamy,&#160;Matthias&#160;Schunter,&#160;and&#160;Axel&#160;Tanner</p>
<p style="position:absolute;top:485px;left:627px;white-space:nowrap" class="ft1328">(IBM)</p>
<p style="position:absolute;top:564px;left:150px;white-space:nowrap" class="ft13226"><b>10.1</b></p>
<p style="position:absolute;top:564px;left:209px;white-space:nowrap" class="ft13226"><b>Introduction&#160;to&#160;Dependable&#160;Virtualization</b></p>
<p style="position:absolute;top:602px;left:150px;white-space:nowrap" class="ft13215">In&#160;this&#160;chapter,&#160;we&#160;explore&#160;opportunities&#160;for&#160;dependability&#160;and&#160;security&#160;made&#160;available<br/>by&#160;virtualization,&#160;and&#160;provide&#160;detailed&#160;information&#160;on&#160;how&#160;virtualization&#160;affects&#160;sys-<br/>tem&#160;reliability.&#160;We&#160;make&#160;four&#160;contributions:&#160;(1)&#160;a&#160;survey&#160;of&#160;dependability&#160;and&#160;security<br/>enhancements&#160;enabled&#160;by&#160;virtualization,&#160;(2)&#160;a&#160;prototype&#160;demonstrating&#160;the&#160;effective-<br/>ness&#160;of&#160;hypervisor-based&#160;intrusion&#160;detection,&#160;(3)&#160;reliability&#160;models&#160;and&#160;analysis&#160;of&#160;the<br/>effects&#160;of&#160;virtualization,&#160;and&#160;(4)&#160;an&#160;architecture&#160;for&#160;a&#160;reliability-enhanced&#160;Xen&#160;VMM<br/>that&#160;leverages&#160;a&#160;subset&#160;of&#160;the&#160;enhancements.</p>
<p style="position:absolute;top:727px;left:172px;white-space:nowrap" class="ft1328">We&#160;describe&#160;ways&#160;of&#160;leveraging&#160;virtualization&#160;for&#160;dependability&#160;and&#160;security&#160;en-</p>
<p style="position:absolute;top:745px;left:150px;white-space:nowrap" class="ft13215">hancements,&#160;such&#160;as&#160;response&#160;to&#160;load-induced&#160;failures,&#160;administration&#160;of&#160;patches&#160;in&#160;an<br/>availability-preserving&#160;manner,&#160;enforcement&#160;of&#160;fail-safe&#160;behavior,&#160;proactive&#160;software<br/>rejuvenation,&#160;and&#160;intrusion&#160;detection&#160;and&#160;protection.&#160;We&#160;describe&#160;in&#160;detail&#160;a&#160;Xen-based<br/>implementation&#160;of&#160;a&#160;subset&#160;of&#160;these&#160;enhancements,&#160;particularly,&#160;intrusion&#160;detection&#160;and<br/>protection.&#160;The&#160;intrusion&#160;detector,&#160;called&#160;X-Spy,&#160;uses&#160;a&#160;privileged&#160;Xen&#160;VM&#160;to&#160;monitor<br/>and&#160;analyze&#160;the&#160;complete&#160;state&#160;of&#160;other&#160;VMs&#160;co-located&#160;on&#160;the&#160;same&#160;physical&#160;platform.<br/>X-Spy&#160;is&#160;close&#160;enough&#160;to&#160;the&#160;target&#160;monitored&#160;to&#160;have&#160;a&#160;high&#160;degree&#160;of&#160;visibility&#160;into&#160;the<br/>innards&#160;of&#160;the&#160;target&#160;(like&#160;host-based&#160;intrusion&#160;detection&#160;schemes).&#160;At&#160;the&#160;same&#160;time,<br/>thanks&#160;to&#160;the&#160;isolation&#160;provided&#160;by&#160;the&#160;VMM,&#160;X-Spy&#160;is&#160;far&#160;enough&#160;from&#160;the&#160;target&#160;to<br/>be&#160;unaffected&#160;even&#160;if&#160;the&#160;target&#160;becomes&#160;compromised&#160;(like&#160;network-based&#160;intrusion<br/>detection&#160;schemes).&#160;A&#160;key&#160;challenge&#160;in&#160;implementing&#160;X-Spy&#160;was&#160;the&#160;<i>semantic&#160;gap</i>,<br/>i.e.,&#160;the&#160;proper&#160;interpretation&#160;of&#160;process&#160;information&#160;gathered&#160;from&#160;the&#160;VMs&#160;monitored<br/>in&#160;a&#160;completely&#160;different&#160;VM.</p>
<p style="position:absolute;top:978px;left:172px;white-space:nowrap" class="ft1328">We&#160;provide&#160;detailed&#160;information&#160;on&#160;how&#160;virtualization&#160;affects&#160;an&#160;important&#160;depend-</p>
<p style="position:absolute;top:996px;left:150px;white-space:nowrap" class="ft13214">ability&#160;attribute,&#160;namely&#160;reliability.&#160;The&#160;VMM&#160;is&#160;increasingly&#160;seen&#160;as&#160;a&#160;convenient<br/>layer&#160;for&#160;implementing&#160;many&#160;services&#160;such&#160;as&#160;networking&#160;and&#160;security&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[41]&#160;</a>that&#160;were<br/>traditionally&#160;provided&#160;by&#160;the&#160;operating&#160;system.&#160;We&#160;show&#160;why&#160;such&#160;designs&#160;should&#160;be<br/>viewed&#160;with&#160;more&#160;caution.&#160;We&#160;use&#160;combinatorial&#160;modeling&#160;to&#160;analyze&#160;multiple&#160;design<br/>choices&#160;when&#160;a&#160;single&#160;physical&#160;server&#160;is&#160;used&#160;to&#160;host&#160;multiple&#160;virtual&#160;servers&#160;and&#160;to</p>
<p style="position:absolute;top:1117px;left:396px;white-space:nowrap" class="ft1328">130</p>
</div>
<!-- Page 133 -->
<a name="133"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page133-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5133.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1338">CHAPTER&#160;10.&#160;TOWARDS&#160;DEPENDABILITY&#160;AND&#160;ATTACK&#160;RESISTANCE&#160;131</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft13314">quantify&#160;the&#160;reliability&#160;impact&#160;of&#160;virtualization.&#160;In&#160;light&#160;of&#160;the&#160;prevailing&#160;trend&#160;to&#160;shift<br/>services&#160;out&#160;of&#160;the&#160;guest&#160;OS&#160;into&#160;the&#160;virtualization&#160;layer,&#160;we&#160;show&#160;that&#160;this&#160;shift,&#160;if&#160;not<br/>done&#160;carefully,&#160;could&#160;adversely&#160;affect&#160;system&#160;reliability.</p>
<p style="position:absolute;top:247px;left:248px;white-space:nowrap" class="ft1338">We&#160;describe&#160;a&#160;reliability-enhanced&#160;Xen&#160;VMM&#160;architecture,&#160;called&#160;<i>R-Xen</i>,&#160;that&#160;com-</p>
<p style="position:absolute;top:265px;left:226px;white-space:nowrap" class="ft13314">bines&#160;replication,&#160;intrusion&#160;detection,&#160;and&#160;rejuvenation.&#160;Normally,&#160;the&#160;Xen&#160;VMM&#160;con-<br/>sists&#160;of&#160;a&#160;relatively&#160;small&#160;hypervisor&#160;core&#160;and&#160;a&#160;full-fledged&#160;privileged&#160;VM&#160;called&#160;<i>Dom0<br/></i>that&#160;runs&#160;a&#160;guest&#160;OS&#160;(Linux).&#160;Regular&#160;VMs&#160;running&#160;on&#160;the&#160;Xen&#160;VMM&#160;are&#160;called&#160;<i>user<br/>domains&#160;</i>or&#160;<i>DomUs</i>.&#160;Because&#160;of&#160;its&#160;size&#160;and&#160;complexity,&#160;Dom0&#160;is&#160;the&#160;weak&#160;point&#160;in<br/>the&#160;reliability&#160;of&#160;the&#160;Xen&#160;VMM.&#160;R-Xen&#160;focuses&#160;on&#160;improving&#160;Dom0&#160;reliability&#160;(and<br/>thereby&#160;improving&#160;the&#160;Xen&#160;VMM&#160;reliability)&#160;through&#160;three-fold&#160;replication.&#160;The&#160;three<br/>Dom0&#160;replicas&#160;each&#160;contain&#160;X-Spy&#160;implementations&#160;to&#160;mutually&#160;monitor&#160;each&#160;other<br/>and&#160;thus&#160;detect&#160;the&#160;presence&#160;of&#160;faults&#160;and/or&#160;intrusions&#160;in&#160;the&#160;other&#160;two.&#160;If&#160;two&#160;replicas<br/>report&#160;to&#160;the&#160;hypervisor&#160;that&#160;the&#160;third&#160;is&#160;corrupted,&#160;the&#160;hypervisor&#160;terminates&#160;and&#160;reju-<br/>venates&#160;the&#160;corrupt&#160;replica.&#160;If&#160;the&#160;replica&#160;terminated&#160;happens&#160;to&#160;be&#160;the&#160;<i>primary&#160;</i>replica<br/>that&#160;provides&#160;device&#160;virtualization&#160;for&#160;user&#160;domains,&#160;then&#160;one&#160;of&#160;the&#160;two&#160;backups&#160;be-<br/>comes&#160;the&#160;new&#160;primary.</p>
<p style="position:absolute;top:480px;left:248px;white-space:nowrap" class="ft1338">The&#160;remainder&#160;of&#160;the&#160;chapter&#160;is&#160;organized&#160;as&#160;follows.&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#14">1.4&#160;</a>describes&#160;re-</p>
<p style="position:absolute;top:498px;left:226px;white-space:nowrap" class="ft13314">lated&#160;work&#160;in&#160;the&#160;area&#160;of&#160;virtualization-based&#160;dependability&#160;and&#160;virtualization-based<br/>intrusion&#160;detection.&#160;In&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#133">10.2,&#160;</a>we&#160;describe&#160;at&#160;a&#160;high-level&#160;several&#160;dependabil-<br/>ity&#160;and&#160;security&#160;enhancements&#160;(including&#160;intrusion&#160;detection&#160;and&#160;protection)&#160;that&#160;are<br/>made&#160;possible&#160;by&#160;virtualization.&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#136">10.3&#160;</a>describes&#160;X-Spy,&#160;our&#160;Xen-based&#160;proto-<br/>type&#160;implementation&#160;of&#160;intrusion&#160;detection&#160;and&#160;protection.&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#145">10.4&#160;</a>analysis&#160;the<br/>reliability&#160;impact&#160;of&#160;virtualization&#160;and&#160;highlights&#160;the&#160;importance&#160;of&#160;VMM&#160;reliability<br/>to&#160;the&#160;overall&#160;reliability&#160;of&#160;a&#160;virtualized&#160;physical&#160;node.&#160;Motivated&#160;by&#160;the&#160;conclusions<br/>of&#160;our&#160;reliability&#160;analysis&#160;and&#160;leveraging&#160;our&#160;X-Spy&#160;implementation,&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#149">10.5&#160;</a>de-<br/>scribes&#160;an&#160;architecture&#160;for&#160;a&#160;more&#160;reliable&#160;Xen&#160;VMM.</p>
<p style="position:absolute;top:706px;left:226px;white-space:nowrap" class="ft13326"><b>10.2</b></p>
<p style="position:absolute;top:706px;left:285px;white-space:nowrap" class="ft13351"><b>Using&#160;Virtualization&#160;for&#160;Dependability&#160;and&#160;Secu-<br/>rity</b></p>
<p style="position:absolute;top:771px;left:226px;white-space:nowrap" class="ft13315">Commodity&#160;operating&#160;systems&#160;provide&#160;a&#160;level&#160;of&#160;dependability&#160;and&#160;security&#160;that&#160;is<br/>much&#160;lower&#160;than&#160;what&#160;is&#160;desired.&#160;This&#160;situation&#160;has&#160;not&#160;changed&#160;much&#160;in&#160;the&#160;past<br/>decade.&#160;Hence,&#160;the&#160;focus&#160;has&#160;shifted&#160;to&#160;designing&#160;dependable&#160;and&#160;secure&#160;systems<br/>around&#160;the&#160;OS&#160;problems.&#160;Thanks&#160;to&#160;the&#160;flexible&#160;manner&#160;in&#160;which&#160;VM&#160;state&#160;can&#160;be<br/>manipulated,&#160;virtualization&#160;can&#160;enable&#160;such&#160;designs.&#160;In&#160;particular,&#160;VM&#160;state,&#160;much&#160;like<br/>files,&#160;can&#160;be&#160;read,&#160;copied,&#160;modified,&#160;saved,&#160;migrated,&#160;and&#160;restored&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[41]</a>.&#160;In&#160;this&#160;section,<br/>we&#160;give&#160;several&#160;examples&#160;of&#160;dependability&#160;and&#160;security&#160;enhancements&#160;made&#160;possible<br/>by&#160;virtualization.</p>
<p style="position:absolute;top:914px;left:248px;white-space:nowrap" class="ft13323"><b>Coping&#160;with&#160;Load-Induced&#160;Failures:&#160;</b>Deploying&#160;services&#160;on&#160;VMs&#160;instead&#160;of</p>
<p style="position:absolute;top:932px;left:226px;white-space:nowrap" class="ft13314">physical&#160;machines&#160;enables&#160;a&#160;higher&#160;and&#160;more&#160;flexible&#160;resilience&#160;to&#160;load-induced&#160;fail-<br/>ures&#160;without&#160;requiring&#160;additional&#160;hardware.&#160;Under&#160;load&#160;conditions,&#160;the&#160;VMs&#160;can&#160;be<br/>seamlessly&#160;migrated&#160;(using&#160;live&#160;migration&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[23]</a>)&#160;to&#160;a&#160;lightly&#160;loaded&#160;or&#160;a&#160;more&#160;pow-<br/>erful&#160;physical&#160;machine.&#160;VM&#160;creation&#160;is&#160;simple&#160;and&#160;cheap,&#160;much&#160;like&#160;copying&#160;a&#160;file.<br/>In&#160;response&#160;to&#160;high-load&#160;conditions,&#160;it&#160;is&#160;much&#160;easier&#160;to&#160;dynamically&#160;provision&#160;addi-<br/>tional&#160;VMs&#160;on&#160;under-utilized&#160;physical&#160;machines&#160;than&#160;to&#160;provision&#160;additional&#160;physical<br/>machines.&#160;This&#160;flexibility&#160;usually&#160;compensates&#160;for&#160;the&#160;additional&#160;resources&#160;(mainly<br/>memory)&#160;needed&#160;by&#160;the&#160;hypervisor.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft13321">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 134 -->
<a name="134"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page134-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5134.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1348">132</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft13421">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:172px;white-space:nowrap" class="ft13423"><b>Patch&#160;Application&#160;for&#160;High-Availability&#160;Services:&#160;</b>Typically,&#160;patch&#160;application</p>
<p style="position:absolute;top:212px;left:150px;white-space:nowrap" class="ft13415">involves&#160;a&#160;system&#160;restart,&#160;and&#160;thus&#160;negatively&#160;affects&#160;service&#160;availability.&#160;Consider&#160;a<br/>service&#160;running&#160;inside&#160;a&#160;VM.&#160;Virtualization&#160;provides&#160;a&#160;way&#160;of&#160;removing&#160;faults&#160;and&#160;vul-<br/>nerabilities&#160;at&#160;run-time&#160;without&#160;affecting&#160;system&#160;availability.&#160;For&#160;this&#160;purpose,&#160;a&#160;copy<br/>of&#160;the&#160;VM&#160;is&#160;instantiated,&#160;and&#160;the&#160;patch&#160;(be&#160;it&#160;OS-level&#160;or&#160;service-level)&#160;is&#160;applied&#160;on<br/>the&#160;copy&#160;rather&#160;than&#160;on&#160;the&#160;original&#160;VM.&#160;Then,&#160;the&#160;copy&#160;is&#160;restarted&#160;for&#160;the&#160;patch&#160;to<br/>take&#160;effect,&#160;after&#160;which&#160;the&#160;original&#160;VM&#160;is&#160;gracefully&#160;shut&#160;down&#160;and&#160;future&#160;service&#160;re-<br/>quests&#160;are&#160;directed&#160;to&#160;the&#160;copy&#160;VM.&#160;To&#160;ensure&#160;that&#160;there&#160;are&#160;no&#160;undesirable&#160;side&#160;effects<br/>due&#160;to&#160;the&#160;patch&#160;application,&#160;the&#160;copy&#160;VM&#160;may&#160;be&#160;placed&#160;under&#160;special&#160;watch&#160;for&#160;a<br/>sufficiently&#160;long&#160;time&#160;while&#160;its&#160;post-patch&#160;behavior&#160;is&#160;being&#160;observed&#160;before&#160;the&#160;origi-<br/>nal&#160;VM&#160;is&#160;shut&#160;down.&#160;If&#160;the&#160;service&#160;running&#160;inside&#160;the&#160;VM&#160;is&#160;stateful,&#160;then&#160;additional<br/>techniques&#160;based&#160;on&#160;a&#160;combination&#160;of&#160;VM&#160;checkpointing&#160;(e.g.,&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[7]</a>)&#160;and&#160;VM&#160;live&#160;mi-<br/>gration&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[23]&#160;</a>may&#160;be&#160;used&#160;to&#160;retain&#160;network&#160;connections&#160;of&#160;the&#160;original&#160;VM&#160;and&#160;to&#160;bring<br/>the&#160;copy&#160;up-to-date&#160;with&#160;the&#160;last&#160;correct&#160;checkpoint.</p>
<p style="position:absolute;top:445px;left:172px;white-space:nowrap" class="ft13423"><b>Enforcing&#160;Fail-Safe&#160;Behavior&#160;and&#160;Virtual&#160;Patches:&#160;</b>The&#160;average&#160;time&#160;between</p>
<p style="position:absolute;top:463px;left:150px;white-space:nowrap" class="ft13414">the&#160;point&#160;in&#160;time&#160;when&#160;a&#160;vulnerability&#160;is&#160;made&#160;public&#160;and&#160;a&#160;patch&#160;is&#160;available&#160;is&#160;still<br/>measured&#160;in&#160;months.&#160;In&#160;2005,&#160;Microsoft&#160;took&#160;an&#160;average&#160;time&#160;of&#160;134.5&#160;days&#160;for&#160;issuing<br/>critical&#160;patches&#160;for&#160;Windows&#160;security&#160;problems&#160;reported&#160;to&#160;the&#160;company&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[126]</a>.&#160;Devel-<br/>oping&#160;patches&#160;for&#160;a&#160;software&#160;component&#160;is&#160;a&#160;time-consuming&#160;process&#160;because&#160;of&#160;the<br/>need&#160;to&#160;ensure&#160;that&#160;the&#160;patch&#160;does&#160;not&#160;introduce&#160;new&#160;flaws&#160;or&#160;affect&#160;the&#160;dependencies<br/>between&#160;the&#160;component&#160;involved&#160;and&#160;other&#160;components&#160;in&#160;the&#160;system.&#160;In&#160;many&#160;cases,<br/>a&#160;service&#160;administrator&#160;simply&#160;does&#160;not&#160;have&#160;the&#160;luxury&#160;of&#160;suspending&#160;a&#160;service&#160;imme-<br/>diately&#160;after&#160;a&#160;critical&#160;flaw&#160;(in&#160;the&#160;OS&#160;running&#160;the&#160;service&#160;or&#160;the&#160;service&#160;itself)&#160;becomes<br/>publicized&#160;until&#160;the&#160;patch&#160;becomes&#160;available.</p>
<p style="position:absolute;top:624px;left:172px;white-space:nowrap" class="ft1348">Virtualization&#160;can&#160;be&#160;used&#160;to&#160;prolong&#160;the&#160;availability&#160;of&#160;the&#160;service&#160;as&#160;much&#160;as</p>
<p style="position:absolute;top:642px;left:150px;white-space:nowrap" class="ft13415">possible&#160;while&#160;at&#160;the&#160;same&#160;time&#160;ensuring&#160;that&#160;the&#160;service&#160;is&#160;fail-safe.&#160;We&#160;leverage&#160;the<br/>observation&#160;that&#160;publicizing&#160;a&#160;flaw&#160;is&#160;usually&#160;accompanied&#160;by&#160;details&#160;of&#160;possible&#160;attacks<br/>exploiting&#160;the&#160;flaw&#160;and/or&#160;symptoms&#160;of&#160;an&#160;exploited&#160;flaw.&#160;Developing&#160;an&#160;external<br/>monitor&#160;to&#160;identify&#160;attack&#160;signatures&#160;or&#160;symptoms&#160;of&#160;an&#160;exploited&#160;flaw&#160;may&#160;be&#160;done<br/>independently&#160;of&#160;patch&#160;development.&#160;The&#160;monitor&#160;may&#160;also&#160;be&#160;developed&#160;much&#160;faster<br/>than&#160;the&#160;patch&#160;itself,&#160;because&#160;the&#160;monitor&#160;may&#160;not&#160;be&#160;subject&#160;to&#160;the&#160;same&#160;stringent<br/>testing&#160;and&#160;validation&#160;requirements.</p>
<p style="position:absolute;top:767px;left:172px;white-space:nowrap" class="ft1348">Consider&#160;a&#160;service&#160;running&#160;inside&#160;a&#160;VM&#160;rather&#160;than&#160;directly&#160;on&#160;a&#160;physical&#160;machine.</p>
<p style="position:absolute;top:785px;left:150px;white-space:nowrap" class="ft13415">Then,&#160;a&#160;VM-external&#160;monitor,&#160;running&#160;in&#160;parallel&#160;to&#160;the&#160;VM,&#160;can&#160;be&#160;used&#160;to&#160;watch&#160;for<br/>these&#160;attack&#160;signatures&#160;or&#160;detect&#160;the&#160;symptoms&#160;of&#160;exploitation&#160;of&#160;the&#160;flaw.&#160;If&#160;attack<br/>signatures&#160;are&#160;known,&#160;the&#160;VM-external&#160;monitor&#160;can&#160;be&#160;used&#160;to&#160;block&#160;the&#160;attack,&#160;e.g.&#160;by<br/>filtering&#160;the&#160;incoming&#160;network&#160;stream,&#160;to&#160;terminate&#160;interaction&#160;with&#160;the&#160;attack&#160;source,<br/>or&#160;to&#160;protect&#160;targeted&#160;structures&#160;inside&#160;the&#160;VM,&#160;e.g.&#160;the&#160;system&#160;call&#160;table.&#160;If&#160;only&#160;symp-<br/>toms&#160;of&#160;exploitation&#160;are&#160;known,&#160;detection&#160;of&#160;a&#160;compromise&#160;can&#160;be&#160;used&#160;to&#160;immediately<br/>halt&#160;the&#160;VM.&#160;The&#160;monitor&#160;could&#160;be&#160;implemented&#160;at&#160;the&#160;VMM&#160;level&#160;or&#160;in&#160;a&#160;privileged<br/>VM&#160;(such&#160;as&#160;Dom0&#160;in&#160;Xen&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[11]</a>).&#160;If&#160;it&#160;is&#160;important&#160;to&#160;revert&#160;the&#160;service&#160;to&#160;its&#160;last&#160;correct<br/>state&#160;when&#160;a&#160;patch&#160;becomes&#160;available,&#160;then&#160;the&#160;above&#160;technique&#160;can&#160;be&#160;augmented&#160;with<br/>a&#160;checkpointing&#160;mechanism&#160;that&#160;periodically&#160;checkpoints&#160;the&#160;state&#160;of&#160;the&#160;service&#160;with<br/>respect&#160;to&#160;the&#160;VM&#160;(e.g.,&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[7]</a>).</p>
<p style="position:absolute;top:983px;left:172px;white-space:nowrap" class="ft13423"><b>Proactive&#160;Software&#160;Rejuvenation:&#160;</b>Rebooting&#160;a&#160;machine&#160;is&#160;an&#160;easy&#160;way&#160;of&#160;rejuve-</p>
<p style="position:absolute;top:1001px;left:150px;white-space:nowrap" class="ft13414">nating&#160;software.&#160;The&#160;downside&#160;of&#160;machine&#160;reboot&#160;is&#160;that&#160;the&#160;service&#160;is&#160;unavailable&#160;dur-<br/>ing&#160;the&#160;reboot&#160;process.&#160;The&#160;VMM&#160;is&#160;a&#160;convenient&#160;layer&#160;for&#160;introducing&#160;hooks&#160;to&#160;proac-<br/>tively&#160;rejuvenate&#160;the&#160;guest&#160;OS&#160;and&#160;services&#160;running&#160;inside&#160;a&#160;VM&#160;in&#160;a&#160;performance-&#160;and<br/>availability-preserving&#160;way&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">[93]</a>.&#160;Periodically,&#160;the&#160;VMM&#160;can&#160;be&#160;made&#160;to&#160;instantiate&#160;a<br/><i>reincarnation&#160;VM&#160;</i>from&#160;a&#160;clean&#160;VM&#160;image.&#160;The&#160;booting&#160;of&#160;the&#160;reincarnation&#160;VM&#160;is</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft13421">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 135 -->
<a name="135"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page135-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5135.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1358">CHAPTER&#160;10.&#160;TOWARDS&#160;DEPENDABILITY&#160;AND&#160;ATTACK&#160;RESISTANCE&#160;133</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft13514">done&#160;while&#160;the&#160;original&#160;VM&#160;continues&#160;regular&#160;operation,&#160;thereby&#160;maintaining&#160;service<br/>availability.&#160;One&#160;can&#160;view&#160;this&#160;technique&#160;as&#160;a&#160;generalization&#160;of&#160;the&#160;proactive&#160;recovery<br/>technique&#160;for&#160;fault-tolerant&#160;replication&#160;proposed&#160;by&#160;Reiser&#160;and&#160;Kapitza&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">[93]</a>.</p>
<p style="position:absolute;top:247px;left:248px;white-space:nowrap" class="ft1358">As&#160;mentioned&#160;above&#160;in&#160;the&#160;context&#160;of&#160;patch&#160;application,&#160;techniques&#160;based&#160;on&#160;VM</p>
<p style="position:absolute;top:265px;left:226px;white-space:nowrap" class="ft13514">checkpointing&#160;and&#160;live&#160;migration&#160;may&#160;be&#160;used&#160;to&#160;seamlessly&#160;transfer&#160;network&#160;connec-<br/>tions&#160;and&#160;the&#160;service&#160;state&#160;of&#160;the&#160;original&#160;VM&#160;to&#160;the&#160;reincarnation&#160;VM.&#160;It&#160;is&#160;possible&#160;to<br/>adjust&#160;the&#160;performance&#160;impact&#160;of&#160;the&#160;rejuvenation&#160;procedure&#160;on&#160;the&#160;original&#160;VM’s&#160;per-<br/>formance.&#160;To&#160;lower&#160;the&#160;impact,&#160;the&#160;VMM&#160;can&#160;restrict&#160;the&#160;amount&#160;of&#160;resources&#160;devoted<br/>to&#160;the&#160;booting&#160;of&#160;a&#160;reincarnation&#160;VM&#160;and&#160;compensate&#160;for&#160;the&#160;restriction&#160;in&#160;resources&#160;by<br/>allowing&#160;more&#160;time&#160;for&#160;the&#160;reboot&#160;to&#160;complete.</p>
<p style="position:absolute;top:373px;left:248px;white-space:nowrap" class="ft1358">One&#160;can&#160;view&#160;the&#160;above&#160;type&#160;of&#160;rejuvenation&#160;as&#160;a&#160;<i>memory-scrubbing&#160;</i>technique</p>
<p style="position:absolute;top:391px;left:226px;white-space:nowrap" class="ft13514">for&#160;reclaiming&#160;leaked&#160;memory&#160;and&#160;recovering&#160;from&#160;memory&#160;errors&#160;of&#160;the&#160;original&#160;VM.<br/>More&#160;importantly,&#160;such&#160;a&#160;periodic&#160;rejuvenation&#160;offers&#160;a&#160;way&#160;to&#160;proactively&#160;recover&#160;from<br/>errors&#160;without&#160;requiring&#160;failure&#160;detection&#160;mechanisms&#160;(which&#160;are&#160;often&#160;unreliable)&#160;to<br/>trigger&#160;the&#160;recovery.</p>
<p style="position:absolute;top:463px;left:248px;white-space:nowrap" class="ft13523"><b>Intrusion&#160;Detection&#160;and&#160;Response:&#160;</b>Based&#160;on&#160;the&#160;location&#160;of&#160;the&#160;intrusion&#160;detec-</p>
<p style="position:absolute;top:480px;left:226px;white-space:nowrap" class="ft13514">tion&#160;sensors,&#160;intrusion&#160;detection&#160;system&#160;(IDS)&#160;implementations&#160;are&#160;broadly&#160;classified<br/>into&#160;host-based&#160;IDS&#160;(HIDS)&#160;and&#160;network-based&#160;IDS&#160;(NIDS)&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#170">[46]</a>.&#160;A&#160;NIDS&#160;monitors<br/>network&#160;traffic&#160;from&#160;and&#160;to&#160;the&#160;target,&#160;and&#160;analyzes&#160;the&#160;individual&#160;packets&#160;for&#160;signs<br/>of&#160;intrusion.&#160;Because&#160;of&#160;its&#160;isolation&#160;from&#160;the&#160;target&#160;monitored,&#160;a&#160;NIDS&#160;decreases<br/>its&#160;susceptibility&#160;to&#160;attacks&#160;and&#160;is&#160;largely&#160;unaffected&#160;by&#160;a&#160;compromised&#160;target.&#160;How-<br/>ever,&#160;as&#160;network&#160;traffic&#160;becomes&#160;increasingly&#160;encrypted&#160;and&#160;as&#160;the&#160;NIDS&#160;has&#160;no&#160;direct<br/>knowledge&#160;of&#160;the&#160;effects&#160;or&#160;properties&#160;of&#160;the&#160;attack&#160;targets,&#160;the&#160;usefulness&#160;of&#160;NIDS&#160;is<br/>decreased.&#160;The&#160;fact&#160;that&#160;not&#160;all&#160;intrusions&#160;may&#160;manifest&#160;their&#160;effects&#160;in&#160;the&#160;form&#160;of<br/>malicious&#160;traffic&#160;also&#160;lowers&#160;the&#160;utility&#160;of&#160;NIDS.&#160;The&#160;sensors&#160;of&#160;a&#160;HIDS&#160;are&#160;placed<br/>on&#160;the&#160;target&#160;machine&#160;itself,&#160;giving&#160;them&#160;a&#160;high&#160;degree&#160;of&#160;visibility&#160;into&#160;the&#160;internals<br/>of&#160;the&#160;target,&#160;enabling&#160;closer&#160;monitoring&#160;and&#160;analysis&#160;of&#160;the&#160;target&#160;than&#160;NIDS&#160;does.<br/>However,&#160;the&#160;location&#160;of&#160;HIDS&#160;on&#160;the&#160;same&#160;“trust&#160;compartment”&#160;as&#160;the&#160;target&#160;is&#160;also&#160;a<br/>disadvantage:&#160;after&#160;an&#160;intrusion&#160;into&#160;the&#160;target,&#160;the&#160;HIDS&#160;may&#160;no&#160;longer&#160;be&#160;trusted.</p>
<p style="position:absolute;top:714px;left:248px;white-space:nowrap" class="ft1358">Virtualization&#160;provides&#160;a&#160;way&#160;of&#160;removing&#160;the&#160;disadvantages&#160;of&#160;HIDS&#160;and&#160;NIDS,</p>
<p style="position:absolute;top:732px;left:226px;white-space:nowrap" class="ft13514">while&#160;retaining&#160;their&#160;advantages.&#160;In&#160;our&#160;approach,&#160;the&#160;sensors&#160;are&#160;placed&#160;in&#160;a&#160;special<br/>privileged&#160;VM&#160;(called&#160;the&#160;<i>secure&#160;service&#160;VM&#160;</i>or&#160;SSVM)&#160;used&#160;for&#160;monitoring&#160;other&#160;VMs<br/>hosting&#160;regular&#160;production&#160;services&#160;(called&#160;<i>production&#160;VMs&#160;</i>or&#160;PVMs).&#160;The&#160;placement<br/>of&#160;the&#160;sensors&#160;on&#160;the&#160;same&#160;physical&#160;machine&#160;but&#160;in&#160;a&#160;different&#160;VM&#160;allows&#160;monitoring<br/>and&#160;analysis&#160;of&#160;the&#160;complete&#160;state&#160;of&#160;other&#160;VMs&#160;via&#160;the&#160;VMM,&#160;and&#160;at&#160;the&#160;same&#160;time,<br/>keeps&#160;the&#160;sensor&#160;out&#160;of&#160;reach&#160;of&#160;a&#160;potentially&#160;compromised&#160;VM&#160;and&#160;in&#160;a&#160;secure&#160;vantage<br/>position.</p>
<p style="position:absolute;top:857px;left:248px;white-space:nowrap" class="ft1358">The&#160;twin&#160;characteristics&#160;of&#160;proximity&#160;to&#160;the&#160;target&#160;and&#160;isolation&#160;from&#160;the&#160;target</p>
<p style="position:absolute;top:875px;left:226px;white-space:nowrap" class="ft13514">also&#160;make&#160;the&#160;SSVM&#160;a&#160;convenient&#160;location&#160;for&#160;implementing&#160;intrusion&#160;response&#160;mech-<br/>anisms.&#160;The&#160;secure&#160;vantage&#160;point&#160;of&#160;the&#160;SSVM&#160;allows&#160;one&#160;to&#160;implement&#160;otherwise<br/>difficult&#160;responses,&#160;e.g.,&#160;even&#160;a&#160;simple&#160;response&#160;like&#160;‘shutdown&#160;a&#160;compromised&#160;sys-<br/>tem’&#160;may&#160;not&#160;be&#160;effectively&#160;triggered&#160;from&#160;inside&#160;the&#160;compromised&#160;system.&#160;On&#160;the<br/>other&#160;hand,&#160;it&#160;is&#160;easy&#160;and&#160;effective&#160;to&#160;suspend&#160;the&#160;operations&#160;of&#160;a&#160;compromised&#160;PVM<br/>from&#160;the&#160;SSVM.&#160;In&#160;addition,&#160;the&#160;SSVM&#160;can&#160;instruct&#160;the&#160;VMM&#160;to&#160;provision&#160;a&#160;healthy<br/>replacement&#160;PVM&#160;or&#160;block&#160;suspicious&#160;system&#160;calls&#160;that&#160;may&#160;potentially&#160;tamper&#160;with<br/>the&#160;integrity&#160;of&#160;the&#160;kernel.</p>
<p style="position:absolute;top:1018px;left:248px;white-space:nowrap" class="ft1358">For&#160;effective&#160;rejuvenation&#160;of&#160;a&#160;compromised&#160;PVM&#160;by&#160;re-provisioning&#160;a&#160;new&#160;PVM,</p>
<p style="position:absolute;top:1036px;left:226px;white-space:nowrap" class="ft13514">it&#160;is&#160;not&#160;sufficient&#160;to&#160;merely&#160;boot&#160;the&#160;new&#160;PVM&#160;from&#160;a&#160;clean&#160;state.&#160;The&#160;new&#160;PVM<br/>might&#160;still&#160;possess&#160;all&#160;the&#160;vulnerabilities&#160;of&#160;the&#160;compromised&#160;one.&#160;Hence,&#160;it&#160;is&#160;impor-<br/>tant&#160;to&#160;perform&#160;a&#160;forensic&#160;analysis&#160;of&#160;the&#160;compromised&#160;PVM’s&#160;state&#160;to&#160;remove&#160;as&#160;many</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft13521">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 136 -->
<a name="136"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft136172{font-size:22px;line-height:27px;font-family:Times;color:#231f20;}
	.ft136173{font-size:18px;line-height:21px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page136-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5136.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1368">134</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft13621">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft13615">vulnerabilities&#160;as&#160;possible.&#160;Such&#160;an&#160;analysis&#160;is&#160;facilitated&#160;by&#160;the&#160;virtualized&#160;environ-<br/>ment&#160;hosting&#160;the&#160;SSVM.&#160;The&#160;SSVM&#160;can&#160;obtain&#160;not&#160;only&#160;modified&#160;files&#160;of&#160;a&#160;suspended<br/>PVM,&#160;but&#160;also&#160;its&#160;complete&#160;run-time&#160;state&#160;from&#160;the&#160;memory&#160;dump&#160;created&#160;at&#160;the&#160;time<br/>of&#160;suspension.&#160;The&#160;memory&#160;dump&#160;can&#160;be&#160;examined&#160;using&#160;the&#160;same&#160;techniques&#160;as&#160;the<br/>one&#160;used&#160;to&#160;observe&#160;the&#160;state&#160;of&#160;a&#160;running&#160;PVM&#160;from&#160;the&#160;SSVM&#160;for&#160;the&#160;purpose&#160;of<br/>intrusion&#160;detection.</p>
<p style="position:absolute;top:347px;left:150px;white-space:nowrap" class="ft13626"><b>10.3</b></p>
<p style="position:absolute;top:347px;left:209px;white-space:nowrap" class="ft136172"><b>Xen-based&#160;Implementation&#160;of&#160;Intrusion&#160;Detection<br/>and&#160;Protection</b></p>
<p style="position:absolute;top:412px;left:150px;white-space:nowrap" class="ft13615">In&#160;this&#160;section,&#160;we&#160;describe&#160;the&#160;prototype&#160;implementation&#160;of&#160;a&#160;subset&#160;of&#160;the&#160;security<br/>enhancements&#160;mentioned&#160;above,&#160;namely,&#160;intrusion&#160;detection&#160;and&#160;protection&#160;for&#160;VMs.<br/>Later,&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#149">10.5,&#160;</a>we&#160;leverage&#160;the&#160;implementation&#160;for&#160;enforcing&#160;fail-safe&#160;behavior<br/>and&#160;for&#160;triggering&#160;software&#160;rejuvenation&#160;in&#160;our&#160;construction&#160;of&#160;R-Xen.</p>
<p style="position:absolute;top:524px;left:150px;white-space:nowrap" class="ft13624"><b>10.3.1</b></p>
<p style="position:absolute;top:524px;left:213px;white-space:nowrap" class="ft136173"><b>Intrusion&#160;Detection&#160;and&#160;Protection&#160;for&#160;Xen&#160;Virtual&#160;Ma-<br/>chines</b></p>
<p style="position:absolute;top:575px;left:150px;white-space:nowrap" class="ft13614">We&#160;have&#160;implemented&#160;an&#160;intrusion&#160;detection&#160;and&#160;protection&#160;framework&#160;called&#160;<i>X-Spy</i>.<br/>The&#160;core&#160;idea&#160;is&#160;to&#160;use&#160;a&#160;secure&#160;service&#160;VM&#160;(SSVM)&#160;that&#160;monitors&#160;one&#160;or&#160;more&#160;pro-<br/>duction&#160;VMs&#160;(PVM).&#160;The&#160;SSVM&#160;performs&#160;the&#160;following&#160;functions:</p>
<p style="position:absolute;top:641px;left:150px;white-space:nowrap" class="ft13623"><b>Lie&#160;Detection&#160;</b>The&#160;SSVM&#160;accesses&#160;the&#160;memory&#160;of&#160;the&#160;PVM&#160;and&#160;compares&#160;actual&#160;crit-</p>
<p style="position:absolute;top:659px;left:187px;white-space:nowrap" class="ft13615">ical&#160;system&#160;data&#160;(processes,&#160;mounts,&#160;etc.)&#160;against&#160;data&#160;obtained&#160;by&#160;executing<br/>normal&#160;Unix&#160;commands&#160;inside&#160;the&#160;PVM.&#160;If&#160;the&#160;comparison&#160;yields&#160;discrepancies,<br/>then&#160;that&#160;is&#160;indicative&#160;of&#160;a&#160;compromised&#160;PVM.&#160;In&#160;contrast&#160;to&#160;earlier&#160;hypervisor-<br/>based&#160;intrusion&#160;detection&#160;work,&#160;X-Spy’s&#160;detection&#160;mechanisms&#160;are&#160;more&#160;com-<br/>prehensive&#160;and&#160;include&#160;lie&#160;detection&#160;at&#160;the&#160;level&#160;of&#160;processes,&#160;network&#160;connec-<br/>tions,&#160;modules,&#160;and&#160;file&#160;system&#160;mounts.</p>
<p style="position:absolute;top:779px;left:150px;white-space:nowrap" class="ft13623"><b>Protection&#160;</b>We&#160;have&#160;added&#160;a&#160;system&#160;call&#160;inspector&#160;to&#160;Xen&#160;that&#160;allows&#160;the&#160;monitoring</p>
<p style="position:absolute;top:797px;left:187px;white-space:nowrap" class="ft13615">of&#160;the&#160;system&#160;calls&#160;within&#160;the&#160;PVM&#160;for&#160;the&#160;purpose&#160;of&#160;protecting&#160;relevant&#160;foren-<br/>sic&#160;information&#160;(like&#160;log&#160;files)&#160;and&#160;the&#160;integrity&#160;of&#160;the&#160;kernel&#160;(kernel&#160;structures,<br/>modules,&#160;and&#160;memory).</p>
<p style="position:absolute;top:862px;left:172px;white-space:nowrap" class="ft1368">X-Spy&#160;uses&#160;the&#160;Xen&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[11]&#160;</a>VMM&#160;developed&#160;by&#160;Cambridge&#160;University&#160;and&#160;guest&#160;VMs</p>
<p style="position:absolute;top:880px;left:150px;white-space:nowrap" class="ft13615">running&#160;the&#160;Linux&#160;2.6&#160;operating&#160;system.&#160;Nevertheless,&#160;the&#160;concepts&#160;such&#160;as&#160;system&#160;call<br/>analysis&#160;and&#160;lie&#160;detection&#160;can&#160;be&#160;applied&#160;to&#160;other&#160;operating&#160;systems&#160;such&#160;as&#160;Microsoft<br/>Windows.&#160;All&#160;X-Spy&#160;components&#160;are&#160;implemented&#160;either&#160;in&#160;the&#160;Xen&#160;hypervisor&#160;or&#160;in<br/>the&#160;SSVM.&#160;While&#160;their&#160;implementation&#160;logic&#160;depends&#160;on&#160;the&#160;guest&#160;OS,&#160;X-Spy&#160;does&#160;not<br/>require&#160;any&#160;modification&#160;to&#160;the&#160;guest&#160;OS&#160;of&#160;the&#160;PVM.</p>
<p style="position:absolute;top:1010px;left:150px;white-space:nowrap" class="ft13623"><b>Limitations</b></p>
<p style="position:absolute;top:1038px;left:150px;white-space:nowrap" class="ft13615">To&#160;overcome&#160;the&#160;semantic&#160;gap,&#160;we&#160;assume&#160;some&#160;knowledge&#160;of&#160;the&#160;kernel&#160;structures&#160;of<br/>the&#160;guest&#160;operating&#160;system&#160;(specifically,&#160;Linux&#160;kernel&#160;2.6)&#160;so&#160;that&#160;X-Spy&#160;components</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft13621">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 137 -->
<a name="137"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page137-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5137.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1378">CHAPTER&#160;10.&#160;TOWARDS&#160;DEPENDABILITY&#160;AND&#160;ATTACK&#160;RESISTANCE&#160;135</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft13714">can&#160;be&#160;appropriately&#160;coded.&#160;If&#160;the&#160;guest&#160;operating&#160;system&#160;is&#160;upgraded&#160;to&#160;a&#160;newer&#160;ver-<br/>sion&#160;in&#160;which&#160;kernel&#160;structures&#160;are&#160;different,&#160;then&#160;the&#160;X-Spy&#160;components&#160;need&#160;to&#160;be<br/>re-coded&#160;appropriately.&#160;That&#160;fact&#160;may&#160;be&#160;an&#160;impediment&#160;to&#160;commercializing&#160;X-Spy,<br/>as&#160;it&#160;implies&#160;an&#160;ongoing&#160;commitment&#160;to&#160;develop&#160;and&#160;patch&#160;X-Spy&#160;components&#160;to&#160;keep<br/>pace&#160;with&#160;upgrades&#160;to&#160;the&#160;guest&#160;operating&#160;system.</p>
<p style="position:absolute;top:283px;left:248px;white-space:nowrap" class="ft1378">For&#160;detecting&#160;hidden&#160;processes,&#160;X-Spy&#160;requires&#160;that&#160;the&#160;scheduler&#160;of&#160;the&#160;PVM’s</p>
<p style="position:absolute;top:301px;left:226px;white-space:nowrap" class="ft13714">guest&#160;OS&#160;keep&#160;a&#160;list&#160;of&#160;processes&#160;that&#160;need&#160;to&#160;be&#160;scheduled&#160;in&#160;a&#160;standard&#160;place&#160;within<br/>a&#160;known&#160;memory&#160;structure.&#160;If&#160;an&#160;attacker&#160;is&#160;able&#160;to&#160;replace&#160;the&#160;scheduler&#160;with&#160;her&#160;own<br/>one&#160;having&#160;a&#160;different&#160;list&#160;of&#160;processes,&#160;the&#160;detection&#160;approach&#160;would&#160;be&#160;subverted.<br/>That&#160;is&#160;why&#160;it&#160;is&#160;important&#160;to&#160;protect&#160;the&#160;integrity&#160;of&#160;the&#160;kernel&#160;code&#160;(for&#160;example,<br/>using&#160;mechanisms&#160;that&#160;we&#160;describe&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#141">10.3.4)</a>.</p>
<p style="position:absolute;top:391px;left:248px;white-space:nowrap" class="ft1378">The&#160;SSVM&#160;needs&#160;read&#160;access&#160;to&#160;the&#160;memory&#160;of&#160;the&#160;PVMs&#160;for&#160;the&#160;purpose&#160;of&#160;mon-</p>
<p style="position:absolute;top:409px;left:226px;white-space:nowrap" class="ft13715">itoring&#160;them.&#160;In&#160;addition,&#160;it&#160;must&#160;be&#160;possible&#160;to&#160;do&#160;an&#160;SSH&#160;login&#160;to&#160;the&#160;PVM&#160;from&#160;the<br/>SSVM&#160;and&#160;execute&#160;normal&#160;Unix&#160;commands.&#160;These&#160;requirements&#160;are&#160;contrary&#160;to&#160;the<br/>isolation&#160;guarantees&#160;of&#160;the&#160;hypervisor.&#160;The&#160;SSVM&#160;itself&#160;could&#160;become&#160;a&#160;high-value&#160;at-<br/>tack&#160;target,&#160;and&#160;accordingly,&#160;needs&#160;stronger&#160;protection.&#160;Several&#160;measures&#160;can&#160;be&#160;taken<br/>to&#160;strongly&#160;reduce&#160;the&#160;potential&#160;of&#160;the&#160;SSVM&#160;getting&#160;compromised.&#160;For&#160;example,&#160;as&#160;the<br/>SSVM&#160;is&#160;a&#160;special-purpose&#160;VM&#160;(in&#160;contrast&#160;to&#160;PVMs),&#160;it&#160;can&#160;be&#160;hardened,&#160;its&#160;function-<br/>ality&#160;reduced&#160;solely&#160;to&#160;that&#160;of&#160;monitoring&#160;the&#160;PVMs,&#160;and&#160;its&#160;access&#160;restricted&#160;through&#160;a<br/>specific&#160;administrative&#160;interface.</p>
<p style="position:absolute;top:593px;left:226px;white-space:nowrap" class="ft13724"><b>10.3.2</b></p>
<p style="position:absolute;top:593px;left:289px;white-space:nowrap" class="ft13724"><b>Architecture&#160;of&#160;X-Spy</b></p>
<p style="position:absolute;top:623px;left:226px;white-space:nowrap" class="ft13714">The&#160;architecture&#160;of&#160;the&#160;X-Spy&#160;intrusion&#160;detection&#160;framework&#160;is&#160;shown&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#138">10.1.<br/></a>Our&#160;architecture&#160;consists&#160;of&#160;a&#160;PVM&#160;and&#160;a&#160;SSVM&#160;running&#160;on&#160;top&#160;of&#160;the&#160;same&#160;hardware<br/>and&#160;Xen&#160;hypervisor.&#160;In&#160;our&#160;implementation,&#160;both&#160;the&#160;SSVM&#160;and&#160;the&#160;PVM&#160;run&#160;Linux<br/>kernel&#160;2.6.&#160;The&#160;SSVM&#160;obtains&#160;the&#160;run-time&#160;state&#160;of&#160;the&#160;PVM&#160;through&#160;the&#160;Xen&#160;hyper-<br/>visor,&#160;which&#160;is&#160;at&#160;a&#160;lower&#160;level&#160;of&#160;abstraction&#160;than&#160;both&#160;the&#160;SSVM&#160;and&#160;the&#160;PVM.&#160;The<br/>SSVM&#160;has&#160;access&#160;to&#160;the&#160;raw&#160;devices&#160;of&#160;the&#160;PVMs&#160;(memory,&#160;disk,&#160;network);&#160;however,<br/>the&#160;difficulty&#160;lies&#160;in&#160;the&#160;SSVM&#160;properly&#160;interpreting&#160;the&#160;data&#160;because&#160;of&#160;a&#160;semantic<br/>gap&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[21]</a>.&#160;For&#160;example,&#160;the&#160;physical&#160;memory&#160;of&#160;the&#160;host&#160;system&#160;will&#160;be&#160;made&#160;available<br/>in&#160;chunks&#160;as&#160;<i>pseudo-physical&#160;</i>memory&#160;to&#160;the&#160;VMs.&#160;In&#160;addition,&#160;the&#160;(possibly&#160;different)<br/>operating&#160;systems&#160;of&#160;the&#160;VMs&#160;use&#160;a&#160;virtual&#160;address&#160;space&#160;on&#160;top&#160;of&#160;the&#160;physical&#160;mem-<br/>ory,&#160;leading&#160;to&#160;the&#160;problem&#160;of&#160;properly&#160;interpreting&#160;raw&#160;memory&#160;locations&#160;in&#160;a&#160;different<br/>context.</p>
<p style="position:absolute;top:879px;left:226px;white-space:nowrap" class="ft13724"><b>10.3.3</b></p>
<p style="position:absolute;top:879px;left:289px;white-space:nowrap" class="ft13724"><b>Intrusion&#160;Detection&#160;by&#160;means&#160;of&#160;a&#160;Lie-Detector</b></p>
<p style="position:absolute;top:909px;left:226px;white-space:nowrap" class="ft13715">The&#160;basic&#160;idea&#160;of&#160;the&#160;Lie-Detector&#160;is&#160;to&#160;compare&#160;the&#160;insider&#160;and&#160;outsider&#160;views&#160;of&#160;the<br/>system&#160;to&#160;identify&#160;objects&#160;(processes,&#160;files&#160;etc.)&#160;that&#160;try&#160;to&#160;hide&#160;themselves&#160;from&#160;the<br/>operating&#160;system&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[12]</a>.&#160;Such&#160;behavior&#160;is&#160;typical&#160;of&#160;<i>rootkits</i>,&#160;which&#160;are&#160;then&#160;used&#160;to<br/>hide&#160;other&#160;(typically&#160;malicious)&#160;software,&#160;but&#160;is&#160;also&#160;sometimes&#160;characteristic&#160;of&#160;DRM<br/>functionality&#160;(e.g.&#160;the&#160;XCP&#160;content&#160;protection&#160;technology&#160;by&#160;Sony&#160;BMG&#160;in&#160;2005).&#160;The<br/>Lie-Detector&#160;(Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#138">10.1)&#160;</a>consists&#160;of&#160;three&#160;major&#160;functionalities:</p>
<p style="position:absolute;top:1047px;left:245px;white-space:nowrap" class="ft1378">1.&#160;PVM&#160;Information&#160;Collection:&#160;The&#160;Lie-Detector&#160;collects&#160;information&#160;about&#160;the</p>
<p style="position:absolute;top:1064px;left:263px;white-space:nowrap" class="ft1378">PVM&#160;by&#160;two&#160;different&#160;means:&#160;the&#160;<i>native&#160;</i>interface&#160;and&#160;the&#160;<i>frontDoor&#160;</i>interface.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft13721">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 138 -->
<a name="138"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft138174{font-size:10px;font-family:Helvetica;color:#000000;}
	.ft138175{font-size:10px;font-family:Helvetica;color:#000000;-moz-transform: matrix(         0,          1, -1.0000270007,          0, 0, 0);-webkit-transform: matrix(         0,          1, -1.0000270007,          0, 0, 0);-o-transform: matrix(         0,          1, -1.0000270007,          0, 0, 0);-ms-transform: matrix(         0,          1, -1.0000270007,          0, 0, 0);-moz-transform-origin: left 75%;-webkit-transform-origin: left 75%;-o-transform-origin: left 75%;-ms-transform-origin: left 75%;}
-->
</style>
<div id="page138-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5138.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1388">136</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft13821">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:299px;white-space:nowrap" class="ft138174"><i><b>SSVM</b></i></p>
<p style="position:absolute;top:194px;left:490px;white-space:nowrap" class="ft138174"><i><b>PVM</b></i></p>
<p style="position:absolute;top:254px;left:332px;white-space:nowrap" class="ft138175">N</p>
<p style="position:absolute;top:261px;left:332px;white-space:nowrap" class="ft138175">C</p>
<p style="position:absolute;top:269px;left:332px;white-space:nowrap" class="ft138175">R</p>
<p style="position:absolute;top:276px;left:332px;white-space:nowrap" class="ft138175">L</p>
<p style="position:absolute;top:254px;left:318px;white-space:nowrap" class="ft138175">P</p>
<p style="position:absolute;top:261px;left:318px;white-space:nowrap" class="ft138175">L</p>
<p style="position:absolute;top:266px;left:318px;white-space:nowrap" class="ft138175">L</p>
<p style="position:absolute;top:254px;left:345px;white-space:nowrap" class="ft138175">M</p>
<p style="position:absolute;top:262px;left:345px;white-space:nowrap" class="ft138175">L</p>
<p style="position:absolute;top:268px;left:345px;white-space:nowrap" class="ft138175">L</p>
<p style="position:absolute;top:254px;left:359px;white-space:nowrap" class="ft138175">M</p>
<p style="position:absolute;top:262px;left:359px;white-space:nowrap" class="ft138175">o</p>
<p style="position:absolute;top:268px;left:359px;white-space:nowrap" class="ft138175">L</p>
<p style="position:absolute;top:274px;left:359px;white-space:nowrap" class="ft138175">L</p>
<p style="position:absolute;top:315px;left:362px;white-space:nowrap" class="ft13843">PMT</p>
<p style="position:absolute;top:320px;left:321px;white-space:nowrap" class="ft13869">GDMAL</p>
<p style="position:absolute;top:254px;left:407px;white-space:nowrap" class="ft138175">n</p>
<p style="position:absolute;top:260px;left:407px;white-space:nowrap" class="ft138175">e</p>
<p style="position:absolute;top:265px;left:407px;white-space:nowrap" class="ft138175">ts</p>
<p style="position:absolute;top:273px;left:407px;white-space:nowrap" class="ft138175">ta</p>
<p style="position:absolute;top:282px;left:407px;white-space:nowrap" class="ft138175">t</p>
<p style="position:absolute;top:254px;left:393px;white-space:nowrap" class="ft138175">p</p>
<p style="position:absolute;top:260px;left:393px;white-space:nowrap" class="ft138175">s</p>
<p style="position:absolute;top:254px;left:420px;white-space:nowrap" class="ft138175">ls</p>
<p style="position:absolute;top:261px;left:420px;white-space:nowrap" class="ft138175">m</p>
<p style="position:absolute;top:270px;left:420px;white-space:nowrap" class="ft138175">o</p>
<p style="position:absolute;top:275px;left:420px;white-space:nowrap" class="ft138175">d</p>
<p style="position:absolute;top:254px;left:434px;white-space:nowrap" class="ft138175">m</p>
<p style="position:absolute;top:263px;left:434px;white-space:nowrap" class="ft138175">o</p>
<p style="position:absolute;top:268px;left:434px;white-space:nowrap" class="ft138175">u</p>
<p style="position:absolute;top:274px;left:434px;white-space:nowrap" class="ft138175">n</p>
<p style="position:absolute;top:279px;left:434px;white-space:nowrap" class="ft138175">t</p>
<p style="position:absolute;top:301px;left:409px;white-space:nowrap" class="ft13869">ssh</p>
<p style="position:absolute;top:301px;left:409px;white-space:nowrap" class="ft13869">ssh</p>
<p style="position:absolute;top:231px;left:343px;white-space:nowrap" class="ft13869">Lie&#160;-&#160;Detector</p>
<p style="position:absolute;top:356px;left:351px;white-space:nowrap" class="ft13869">MTI</p>
<p style="position:absolute;top:339px;left:402px;white-space:nowrap" class="ft13843">TCP/IP</p>
<p style="position:absolute;top:339px;left:402px;white-space:nowrap" class="ft13843">TCP/IP</p>
<p style="position:absolute;top:339px;left:473px;white-space:nowrap" class="ft13843">TCP/IP</p>
<p style="position:absolute;top:339px;left:473px;white-space:nowrap" class="ft13843">TCP/IP</p>
<p style="position:absolute;top:246px;left:347px;white-space:nowrap" class="ft13869">Normalizer</p>
<p style="position:absolute;top:340px;left:299px;white-space:nowrap" class="ft13870"><b>Kernel</b></p>
<p style="position:absolute;top:364px;left:299px;white-space:nowrap" class="ft13870"><b>Xen</b></p>
<p style="position:absolute;top:210px;left:299px;white-space:nowrap" class="ft13870"><b>User&#160;Space</b></p>
<p style="position:absolute;top:391px;left:299px;white-space:nowrap" class="ft13870"><b>Hardware</b></p>
<p style="position:absolute;top:204px;left:366px;white-space:nowrap" class="ft13869">Event&#160;Handling</p>
<p style="position:absolute;top:417px;left:211px;white-space:nowrap" class="ft1388">Figure&#160;10.1:&#160;Architecture&#160;of&#160;the&#160;X-Spy&#160;Lie-Detector&#160;components.</p>
<p style="position:absolute;top:465px;left:168px;white-space:nowrap" class="ft1388">2.&#160;PVM&#160;Information&#160;Normalization:&#160;The&#160;PVM&#160;information&#160;collected&#160;via&#160;the&#160;native</p>
<p style="position:absolute;top:483px;left:187px;white-space:nowrap" class="ft13815">interface&#160;is&#160;normalized&#160;to&#160;a&#160;format&#160;equivalent&#160;to&#160;that&#160;of&#160;commands&#160;executed<br/>through&#160;the&#160;frontDoor&#160;interface.</p>
<p style="position:absolute;top:530px;left:168px;white-space:nowrap" class="ft1388">3.&#160;Analyze-and-Compare:&#160;The&#160;normalized&#160;information&#160;from&#160;the&#160;native&#160;and&#160;<i>front-</i></p>
<p style="position:absolute;top:548px;left:187px;white-space:nowrap" class="ft13815"><i>Door&#160;</i>interfaces&#160;is&#160;then&#160;compared&#160;to&#160;identify&#160;differences&#160;that&#160;are&#160;indicative&#160;of<br/>maliciously&#160;hidden&#160;system&#160;resources&#160;and&#160;to&#160;minimize&#160;false&#160;positives.&#160;Any&#160;find-<br/>ings&#160;will&#160;be&#160;reported&#160;through&#160;the&#160;<i>Event&#160;Handling&#160;</i>component.</p>
<p style="position:absolute;top:614px;left:150px;white-space:nowrap" class="ft1388">We&#160;describe&#160;the&#160;above&#160;functionalities&#160;in&#160;detail&#160;below.</p>
<p style="position:absolute;top:672px;left:150px;white-space:nowrap" class="ft13823"><b>Memory&#160;Translation&#160;Interface&#160;(MTI)</b></p>
<p style="position:absolute;top:672px;left:408px;white-space:nowrap" class="ft1388">One&#160;of&#160;the&#160;main&#160;components&#160;of&#160;X-Spy&#160;is</p>
<p style="position:absolute;top:690px;left:150px;white-space:nowrap" class="ft13815">a&#160;Memory&#160;Translation&#160;Interface&#160;(MTI)&#160;that&#160;allows&#160;the&#160;SSVM&#160;full&#160;access&#160;to&#160;a&#160;PVM’s<br/>pseudo-physical&#160;and&#160;virtual&#160;memory&#160;in&#160;a&#160;convenient&#160;fashion.&#160;The&#160;MTI&#160;has&#160;two&#160;parts:</p>
<p style="position:absolute;top:738px;left:168px;white-space:nowrap" class="ft1388">1.&#160;An&#160;extension&#160;to&#160;the&#160;Xen&#160;hypervisor,&#160;which&#160;performs&#160;address&#160;translation&#160;and</p>
<p style="position:absolute;top:756px;left:187px;white-space:nowrap" class="ft1388">traversal&#160;of&#160;the&#160;page&#160;tables.</p>
<p style="position:absolute;top:786px;left:168px;white-space:nowrap" class="ft1388">2.&#160;A&#160;Linux&#160;kernel&#160;device&#160;driver&#160;that&#160;runs&#160;in&#160;the&#160;SSVM&#160;kernel&#160;and&#160;provides&#160;two&#160;in-</p>
<p style="position:absolute;top:803px;left:187px;white-space:nowrap" class="ft1388">terfaces,&#160;namely,</p>
<p style="position:absolute;top:804px;left:291px;white-space:nowrap" class="ft13834">/dev/mem_domX</p>
<p style="position:absolute;top:803px;left:411px;white-space:nowrap" class="ft1388">and</p>
<p style="position:absolute;top:804px;left:436px;white-space:nowrap" class="ft13834">/dev/kmem_domX</p>
<p style="position:absolute;top:803px;left:562px;white-space:nowrap" class="ft1388">.&#160;These&#160;interfaces</p>
<p style="position:absolute;top:821px;left:187px;white-space:nowrap" class="ft1388">are&#160;functionally&#160;equivalent&#160;to&#160;the</p>
<p style="position:absolute;top:822px;left:388px;white-space:nowrap" class="ft13834">/dev/mem</p>
<p style="position:absolute;top:821px;left:463px;white-space:nowrap" class="ft1388">and&#160;the</p>
<p style="position:absolute;top:822px;left:510px;white-space:nowrap" class="ft13834">/dev/kmem</p>
<p style="position:absolute;top:821px;left:595px;white-space:nowrap" class="ft1388">device&#160;files,</p>
<p style="position:absolute;top:839px;left:187px;white-space:nowrap" class="ft13815">respectively,&#160;and&#160;allow&#160;the&#160;root&#160;user&#160;in&#160;the&#160;SSVM&#160;kernel&#160;access&#160;to&#160;the&#160;PVM’s<br/>physical&#160;memory&#160;and&#160;kernel&#160;memory&#160;contents,&#160;respectively.</p>
<p style="position:absolute;top:887px;left:150px;white-space:nowrap" class="ft13814">One&#160;challenge&#160;to&#160;overcome&#160;when&#160;implementing&#160;the&#160;MTI&#160;was&#160;that&#160;the&#160;SSVM&#160;cannot<br/>access&#160;a&#160;PVM’s&#160;foreign&#160;memory&#160;as&#160;it&#160;corresponds&#160;to&#160;a&#160;different&#160;context.&#160;Therefore,<br/>the&#160;MTI&#160;has&#160;to&#160;emulate&#160;the&#160;memory&#160;management&#160;unit&#160;by&#160;translating&#160;the&#160;address&#160;to<br/>the&#160;right&#160;format&#160;and&#160;re-mapping&#160;it&#160;from&#160;the&#160;PVM&#160;memory&#160;space&#160;onto&#160;the&#160;memory<br/>space&#160;of&#160;the&#160;Lie-Detector&#160;process&#160;running&#160;in&#160;the&#160;SSVM.&#160;For&#160;this&#160;purpose,&#160;we&#160;have<br/>developed&#160;two&#160;user-space&#160;libraries&#160;that&#160;the&#160;MTI&#160;uses:&#160;the&#160;<i>Guest&#160;Domain&#160;Memory&#160;Ac-<br/>cess&#160;Library&#160;</i>or&#160;GDMAL&#160;and&#160;the&#160;<i>Process&#160;Memory&#160;Translator&#160;</i>or&#160;PMT.&#160;The&#160;GDMAL<br/>provides&#160;read-write&#160;access&#160;to&#160;the&#160;PVM’s&#160;memory.&#160;Within&#160;the&#160;PVM’s&#160;memory,&#160;the<br/>PMT&#160;allows&#160;access&#160;to&#160;the&#160;virtual&#160;address&#160;space&#160;of&#160;PVM&#160;processes.&#160;In&#160;addition,&#160;the<br/>PMT&#160;provides&#160;some&#160;helper&#160;functions&#160;to&#160;facilitate&#160;the&#160;use&#160;of&#160;the</p>
<p style="position:absolute;top:1049px;left:549px;white-space:nowrap" class="ft13834">/dev/mem_domX</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft13821">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 139 -->
<a name="139"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page139-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5139.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1398">CHAPTER&#160;10.&#160;TOWARDS&#160;DEPENDABILITY&#160;AND&#160;ATTACK&#160;RESISTANCE&#160;137</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft1398">and</p>
<p style="position:absolute;top:194px;left:252px;white-space:nowrap" class="ft13934">/dev/kmem_domX</p>
<p style="position:absolute;top:194px;left:383px;white-space:nowrap" class="ft1398">interfaces.&#160;The&#160;PMT&#160;performs&#160;the&#160;process&#160;address&#160;transla-</p>
<p style="position:absolute;top:212px;left:226px;white-space:nowrap" class="ft13915">tion&#160;by&#160;extracting&#160;the&#160;memory&#160;management&#160;information&#160;for&#160;the&#160;process&#160;from&#160;the&#160;OS-<br/>specific&#160;task&#160;(process)&#160;description&#160;data&#160;structure.&#160;When&#160;the&#160;guest&#160;OS&#160;is&#160;Linux,&#160;as&#160;in<br/>our&#160;case,&#160;the&#160;PMT&#160;extracts&#160;the</p>
<p style="position:absolute;top:248px;left:416px;white-space:nowrap" class="ft13934">mm_struct</p>
<p style="position:absolute;top:247px;left:501px;white-space:nowrap" class="ft1398">data&#160;structure&#160;from&#160;the</p>
<p style="position:absolute;top:248px;left:643px;white-space:nowrap" class="ft13934">task_struct</p>
<p style="position:absolute;top:265px;left:226px;white-space:nowrap" class="ft1398">data&#160;structure.</p>
<p style="position:absolute;top:283px;left:248px;white-space:nowrap" class="ft1398">The&#160;<i>native&#160;interface&#160;</i>is&#160;used&#160;to&#160;collect&#160;PVM&#160;information&#160;“from&#160;the&#160;outside”&#160;through</p>
<p style="position:absolute;top:301px;left:226px;white-space:nowrap" class="ft13914">the&#160;raw&#160;access&#160;made&#160;available&#160;by&#160;the&#160;Xen&#160;hypervisor,&#160;e.g.&#160;by&#160;accessing&#160;the&#160;PVM’s<br/>memory&#160;via&#160;the&#160;MTI,&#160;and&#160;to&#160;collect&#160;host-specific&#160;data&#160;via&#160;special&#160;user-space&#160;libraries<br/>that&#160;we&#160;have&#160;developed,&#160;namely&#160;the&#160;process&#160;list&#160;library&#160;(PLL),&#160;the&#160;network&#160;connection<br/>and&#160;routing&#160;library&#160;(NCRL),&#160;and&#160;the&#160;module&#160;list&#160;library&#160;(MLL).</p>
<p style="position:absolute;top:373px;left:248px;white-space:nowrap" class="ft1398">The&#160;second&#160;interface,&#160;called&#160;the&#160;<i>frontDoor&#160;interface</i>,&#160;is&#160;used&#160;to&#160;obtain&#160;PVM&#160;infor-</p>
<p style="position:absolute;top:391px;left:226px;white-space:nowrap" class="ft13914">mation&#160;by&#160;doing&#160;an&#160;SSH&#160;login&#160;to&#160;the&#160;PVM&#160;and&#160;executing&#160;normal&#160;Unix&#160;commands.<br/>The&#160;Lie-Detector&#160;normalizes&#160;the&#160;information&#160;collected&#160;from&#160;both&#160;interfaces,&#160;and&#160;then<br/>compares&#160;them.&#160;If&#160;the&#160;comparison&#160;yields&#160;discrepancies&#160;in&#160;the&#160;information&#160;collected<br/>from&#160;those&#160;two&#160;sources,&#160;this&#160;is&#160;strongly&#160;indicative&#160;of&#160;an&#160;intrusion.&#160;Obviously,&#160;it&#160;is&#160;not<br/>possible&#160;to&#160;obtain&#160;information&#160;through&#160;the&#160;frontDoor&#160;interface&#160;and&#160;the&#160;native&#160;interface<br/>at&#160;exactly&#160;the&#160;same&#160;time.&#160;This&#160;timing&#160;difference&#160;may&#160;lead&#160;to&#160;false&#160;positives,&#160;and&#160;we<br/>explain&#160;below&#160;how&#160;to&#160;overcome&#160;this&#160;problem.&#160;We&#160;implement&#160;comparison&#160;methods&#160;for<br/>processes,&#160;network&#160;connections,&#160;kernel&#160;modules,&#160;file&#160;system&#160;mounts&#160;and&#160;files.</p>
<p style="position:absolute;top:534px;left:248px;white-space:nowrap" class="ft1398">The&#160;MTI&#160;provides&#160;access&#160;to&#160;the&#160;PVM’s&#160;raw&#160;kernel&#160;virtual&#160;memory&#160;but&#160;lacks&#160;any</p>
<p style="position:absolute;top:552px;left:226px;white-space:nowrap" class="ft13956">semantic&#160;context.&#160;To&#160;fix&#160;this&#160;shortcoming,&#160;we&#160;manually&#160;created&#160;a&#160;<i>memory&#160;offset&#160;file<br/></i>for&#160;each&#160;librar<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#139">y</a></p>
<p style="position:absolute;top:568px;left:321px;white-space:nowrap" class="ft13927"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#139">1</a></p>
<p style="position:absolute;top:570px;left:327px;white-space:nowrap" class="ft1398"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#139">.&#160;</a>Based&#160;on&#160;these&#160;files,&#160;the&#160;libraries&#160;such&#160;as&#160;PLL,&#160;NCRL,&#160;and&#160;MLL,</p>
<p style="position:absolute;top:588px;left:226px;white-space:nowrap" class="ft13915">implement&#160;the&#160;logic&#160;to&#160;extract&#160;all&#160;data&#160;values&#160;of&#160;interest&#160;from&#160;the&#160;raw&#160;kernel&#160;virtual<br/>memory.&#160;Each&#160;offset&#160;file&#160;stores&#160;the&#160;offset&#160;values&#160;of&#160;the&#160;start&#160;of&#160;each&#160;data&#160;item&#160;of&#160;interest<br/>from&#160;the&#160;beginning&#160;of&#160;the&#160;containing&#160;structure.</p>
<p style="position:absolute;top:664px;left:226px;white-space:nowrap" class="ft13923"><b>Process&#160;List</b></p>
<p style="position:absolute;top:664px;left:318px;white-space:nowrap" class="ft1398">The&#160;PLL&#160;acts&#160;on&#160;information&#160;provided&#160;by&#160;the&#160;MTI&#160;to&#160;generate&#160;output</p>
<p style="position:absolute;top:682px;left:226px;white-space:nowrap" class="ft1398">similar&#160;to&#160;that&#160;of&#160;the</p>
<p style="position:absolute;top:682px;left:354px;white-space:nowrap" class="ft13934">ps</p>
<p style="position:absolute;top:682px;left:376px;white-space:nowrap" class="ft1398">command.&#160;This&#160;is&#160;done&#160;by&#160;accessing&#160;and&#160;then&#160;traversing&#160;the</p>
<p style="position:absolute;top:700px;left:226px;white-space:nowrap" class="ft1398">doubly-linked&#160;circular&#160;task&#160;list&#160;via&#160;the&#160;MTI.</p>
<p style="position:absolute;top:718px;left:248px;white-space:nowrap" class="ft1398">Our&#160;comparison&#160;is&#160;based&#160;on&#160;the&#160;multitude&#160;of&#160;information&#160;extractable&#160;from&#160;this</p>
<p style="position:absolute;top:736px;left:226px;white-space:nowrap" class="ft13934">task_struct</p>
<p style="position:absolute;top:736px;left:330px;white-space:nowrap" class="ft1398">data&#160;structure,&#160;such&#160;as&#160;PID,&#160;state,&#160;parent,&#160;open&#160;files,&#160;registers,&#160;pri-</p>
<p style="position:absolute;top:754px;left:226px;white-space:nowrap" class="ft13915">orities,&#160;locks,&#160;and&#160;memory&#160;management&#160;information.&#160;However,&#160;not&#160;all&#160;fields&#160;in&#160;the<br/>data&#160;structure&#160;are&#160;used.&#160;For&#160;example,&#160;the&#160;running&#160;time&#160;of&#160;a&#160;process&#160;as&#160;seen&#160;by&#160;the<br/>native&#160;interface&#160;query&#160;and&#160;the&#160;frontDoor&#160;interface&#160;query&#160;are&#160;bound&#160;to&#160;slightly&#160;differ,<br/>owing&#160;to&#160;the&#160;difference&#160;in&#160;the&#160;time&#160;of&#160;query.</p>
<p style="position:absolute;top:825px;left:248px;white-space:nowrap" class="ft1398">This&#160;comparison&#160;will&#160;detect&#160;processes&#160;in&#160;the&#160;PVM&#160;that&#160;actively&#160;try&#160;to&#160;hide&#160;their</p>
<p style="position:absolute;top:843px;left:226px;white-space:nowrap" class="ft13914">presence&#160;or&#160;change&#160;their&#160;appearance&#160;(e.g.&#160;the&#160;owner)&#160;from&#160;queries&#160;made&#160;from&#160;within<br/>the&#160;PVM.&#160;This&#160;will&#160;identify&#160;rootkit-like&#160;behavior,&#160;as&#160;non-hiding&#160;processes&#160;can&#160;be&#160;iden-<br/>tified&#160;by&#160;more&#160;conventional&#160;(non-hypervisor-based)&#160;malware&#160;detection&#160;tools.</p>
<p style="position:absolute;top:897px;left:248px;white-space:nowrap" class="ft1398">Note&#160;that&#160;simply&#160;comparing&#160;the&#160;process&#160;information&#160;from&#160;the&#160;native&#160;and&#160;frontDoor</p>
<p style="position:absolute;top:915px;left:226px;white-space:nowrap" class="ft13914">interfaces&#160;results&#160;in&#160;false&#160;positives&#160;because&#160;of&#160;frequent&#160;changes&#160;to&#160;the&#160;process&#160;table.<br/>We&#160;fix&#160;this&#160;by&#160;executing&#160;a&#160;native&#160;access&#160;(outsider&#160;view)&#160;before&#160;and&#160;after&#160;the&#160;frontDoor<br/>query&#160;(insider&#160;view).&#160;If&#160;a&#160;given&#160;process&#160;disappeared&#160;in&#160;the&#160;second&#160;query&#160;but&#160;is&#160;again<br/>visible&#160;in&#160;the&#160;third,&#160;we&#160;consider&#160;it&#160;to&#160;be&#160;an&#160;intrusion.&#160;If&#160;it&#160;does&#160;not&#160;reappear,&#160;we&#160;assume<br/>that&#160;the&#160;process&#160;merely&#160;terminated.</p>
<p style="position:absolute;top:1026px;left:226px;white-space:nowrap" class="ft13923"><b>Network&#160;Connections&#160;and&#160;Routing</b></p>
<p style="position:absolute;top:1026px;left:461px;white-space:nowrap" class="ft1398">We&#160;obtain&#160;information&#160;about&#160;IPv4&#160;connections,</p>
<p style="position:absolute;top:1044px;left:226px;white-space:nowrap" class="ft1398">Unix&#160;socket&#160;connections,&#160;and&#160;IPv4&#160;routing&#160;through&#160;the&#160;native&#160;and&#160;frontDoor&#160;inter-</p>
<p style="position:absolute;top:1071px;left:242px;white-space:nowrap" class="ft13928">1</p>
<p style="position:absolute;top:1073px;left:248px;white-space:nowrap" class="ft13919">With&#160;some&#160;effort,&#160;it&#160;is&#160;possible&#160;to&#160;generate&#160;the&#160;offset&#160;files&#160;automatically&#160;at&#160;kernel&#160;compilation&#160;time.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft13921">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 140 -->
<a name="140"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page140-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5140.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1408">138</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft14021">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft14014">faces.&#160;For&#160;the&#160;native&#160;interface&#160;queries,&#160;we&#160;have&#160;developed&#160;the&#160;NCRL&#160;library,&#160;which<br/>uses&#160;the&#160;MTI&#160;to&#160;collect&#160;information&#160;equivalent&#160;to&#160;that&#160;obtained&#160;from&#160;three&#160;commands:<br/>‘</p>
<p style="position:absolute;top:230px;left:155px;white-space:nowrap" class="ft14034">netstat&#160;-an&#160;-inet</p>
<p style="position:absolute;top:230px;left:307px;white-space:nowrap" class="ft1408">’&#160;for&#160;IPv4&#160;connections,&#160;‘</p>
<p style="position:absolute;top:230px;left:453px;white-space:nowrap" class="ft14034">netstat&#160;-an&#160;-unix</p>
<p style="position:absolute;top:230px;left:606px;white-space:nowrap" class="ft1408">’&#160;for&#160;Unix</p>
<p style="position:absolute;top:247px;left:150px;white-space:nowrap" class="ft1408">Socket&#160;connections,&#160;and&#160;‘</p>
<p style="position:absolute;top:248px;left:302px;white-space:nowrap" class="ft14034">netstat&#160;-rn</p>
<p style="position:absolute;top:247px;left:400px;white-space:nowrap" class="ft1408">’&#160;for&#160;IPv4&#160;routing.&#160;This&#160;information&#160;can&#160;then</p>
<p style="position:absolute;top:265px;left:150px;white-space:nowrap" class="ft1408">be&#160;used&#160;to&#160;discover&#160;hidden&#160;network&#160;connections.</p>
<p style="position:absolute;top:283px;left:172px;white-space:nowrap" class="ft1408">Similar&#160;to&#160;the&#160;timing&#160;problem&#160;in&#160;the&#160;Lie-Detector&#160;comparison&#160;of&#160;process&#160;informa-</p>
<p style="position:absolute;top:301px;left:150px;white-space:nowrap" class="ft14014">tion,&#160;we&#160;face&#160;a&#160;timing&#160;problem&#160;in&#160;the&#160;comparison&#160;of&#160;network&#160;connection&#160;information<br/>because&#160;of&#160;network&#160;connections&#160;that&#160;were&#160;terminated&#160;or&#160;started&#160;in&#160;the&#160;time&#160;interval&#160;be-<br/>tween&#160;the&#160;native&#160;interface&#160;query&#160;and&#160;the&#160;frontDoor&#160;interface&#160;query.&#160;The&#160;solution&#160;here<br/>is&#160;again&#160;to&#160;reduce&#160;false&#160;positives&#160;by&#160;using&#160;three&#160;querie<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#140">s</a></p>
<p style="position:absolute;top:353px;left:478px;white-space:nowrap" class="ft14027"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#140">2</a></p>
<p style="position:absolute;top:355px;left:484px;white-space:nowrap" class="ft1408">.</p>
<p style="position:absolute;top:395px;left:150px;white-space:nowrap" class="ft14023"><b>Module&#160;List</b></p>
<p style="position:absolute;top:395px;left:244px;white-space:nowrap" class="ft1408">To&#160;obtain&#160;information&#160;about&#160;the&#160;PVM’s&#160;kernel&#160;modules&#160;we&#160;have&#160;de-</p>
<p style="position:absolute;top:413px;left:150px;white-space:nowrap" class="ft14015">veloped&#160;another&#160;user-space&#160;library&#160;called&#160;the&#160;MLL&#160;for&#160;collecting&#160;information&#160;from<br/>the&#160;native&#160;interface&#160;query.&#160;The&#160;frontDoor&#160;interface&#160;query&#160;uses&#160;the</p>
<p style="position:absolute;top:431px;left:553px;white-space:nowrap" class="ft14034">lsmod</p>
<p style="position:absolute;top:431px;left:603px;white-space:nowrap" class="ft1408">command,</p>
<p style="position:absolute;top:449px;left:150px;white-space:nowrap" class="ft1408">which&#160;outputs&#160;the&#160;contents&#160;of</p>
<p style="position:absolute;top:449px;left:334px;white-space:nowrap" class="ft14034">/proc/modules</p>
<p style="position:absolute;top:449px;left:455px;white-space:nowrap" class="ft1408">displaying&#160;the&#160;kernel&#160;modules&#160;cur-</p>
<p style="position:absolute;top:467px;left:150px;white-space:nowrap" class="ft14040">rently&#160;loaded.&#160;In&#160;addition&#160;to&#160;the&#160;native&#160;interface&#160;and&#160;frontDoor&#160;interface&#160;queries,&#160;the<br/>MLL&#160;also&#160;queries&#160;a&#160;third&#160;Xen&#160;interface&#160;for&#160;detecting&#160;hidden&#160;Linux&#160;loadable&#160;kernel<br/>modules&#160;(LKMs).&#160;LKMs&#160;are&#160;a&#160;way&#160;to&#160;link&#160;object&#160;code&#160;without&#160;interruption&#160;to&#160;the<br/>Linux&#160;kernel&#160;while&#160;it&#160;is&#160;running.&#160;Such&#160;LKMs&#160;are&#160;automatically&#160;registered&#160;at&#160;loading<br/>time,&#160;but&#160;it&#160;is&#160;possible&#160;for&#160;an&#160;LKM&#160;to&#160;un-register&#160;itself&#160;after&#160;loading.&#160;In&#160;such&#160;a&#160;case,<br/>the&#160;LKM&#160;can&#160;hide&#160;even&#160;from&#160;a&#160;native&#160;interface&#160;query&#160;(as&#160;the&#160;adore-ng&#160;rootkit&#160;indeed<br/>does;&#160;see&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#143">10.3.5)</a>.&#160;To&#160;address&#160;this&#160;issue,&#160;we&#160;established&#160;a&#160;<i>shadow&#160;module&#160;list<br/></i>in&#160;the&#160;hypervisor.&#160;The&#160;hypervisor&#160;traps&#160;the</p>
<p style="position:absolute;top:593px;left:413px;white-space:nowrap" class="ft14034">init_module</p>
<p style="position:absolute;top:592px;left:516px;white-space:nowrap" class="ft1408">system&#160;call&#160;and&#160;analyzes</p>
<p style="position:absolute;top:610px;left:150px;white-space:nowrap" class="ft14015">the&#160;ELF&#160;header&#160;section&#160;of&#160;the&#160;object&#160;file&#160;to&#160;get&#160;the&#160;module&#160;name&#160;and&#160;stores&#160;the&#160;name<br/>in&#160;the&#160;shadow&#160;module&#160;list.&#160;The&#160;hypervisor&#160;also&#160;traps&#160;the</p>
<p style="position:absolute;top:629px;left:502px;white-space:nowrap" class="ft14034">delete_module</p>
<p style="position:absolute;top:628px;left:624px;white-space:nowrap" class="ft1408">system</p>
<p style="position:absolute;top:646px;left:150px;white-space:nowrap" class="ft14014">call&#160;to&#160;remove&#160;entries&#160;from&#160;the&#160;shadow&#160;module&#160;list.&#160;As&#160;the&#160;hypervisor&#160;address&#160;space<br/>cannot&#160;be&#160;accessed&#160;by&#160;the&#160;PVM,&#160;the&#160;shadow&#160;module&#160;list&#160;cannot&#160;be&#160;altered&#160;by&#160;an&#160;in-<br/>truder.&#160;The&#160;Xen&#160;interface&#160;query&#160;shows&#160;the&#160;contents&#160;of&#160;the&#160;shadow&#160;module&#160;list&#160;and&#160;is<br/>taken&#160;as&#160;reference&#160;for&#160;comparison&#160;with&#160;the&#160;results&#160;of&#160;the&#160;native&#160;interface&#160;and&#160;frontDoor<br/>interface&#160;queries.&#160;If&#160;the&#160;results&#160;from&#160;the&#160;native&#160;interface&#160;and/or&#160;the&#160;frontDoor&#160;interface<br/>queries&#160;do&#160;not&#160;list&#160;an&#160;entry&#160;from&#160;the&#160;shadow&#160;module&#160;list,&#160;we&#160;conclude&#160;that&#160;the&#160;module<br/>in&#160;question&#160;is&#160;hidden.</p>
<p style="position:absolute;top:793px;left:150px;white-space:nowrap" class="ft14023"><b>Mounts</b></p>
<p style="position:absolute;top:793px;left:214px;white-space:nowrap" class="ft1408">The&#160;frontDoor&#160;interface&#160;uses&#160;the</p>
<p style="position:absolute;top:794px;left:414px;white-space:nowrap" class="ft14034">cat&#160;/proc/mounts</p>
<p style="position:absolute;top:793px;left:562px;white-space:nowrap" class="ft1408">command,&#160;which</p>
<p style="position:absolute;top:811px;left:150px;white-space:nowrap" class="ft14014">provides&#160;a&#160;list&#160;of&#160;all&#160;mounted&#160;file&#160;systems&#160;in&#160;the&#160;PVM.&#160;An&#160;obvious&#160;alternative&#160;would<br/>have&#160;been&#160;to&#160;use&#160;the&#160;output&#160;of&#160;the</p>
<p style="position:absolute;top:830px;left:377px;white-space:nowrap" class="ft14034">mount</p>
<p style="position:absolute;top:829px;left:429px;white-space:nowrap" class="ft1408">command;&#160;however&#160;that&#160;alternative&#160;is</p>
<p style="position:absolute;top:847px;left:150px;white-space:nowrap" class="ft1408">less&#160;useful&#160;and&#160;secure&#160;because&#160;the&#160;command&#160;merely&#160;outputs&#160;the&#160;contents&#160;of&#160;the</p>
<p style="position:absolute;top:866px;left:150px;white-space:nowrap" class="ft14034">/etc/mtab</p>
<p style="position:absolute;top:865px;left:234px;white-space:nowrap" class="ft1408">file,&#160;and&#160;it&#160;is&#160;easy&#160;to&#160;mount&#160;a&#160;file&#160;system&#160;without&#160;an&#160;entry&#160;showing&#160;up&#160;in</p>
<p style="position:absolute;top:883px;left:150px;white-space:nowrap" class="ft1408">the</p>
<p style="position:absolute;top:884px;left:172px;white-space:nowrap" class="ft14034">/etc/mtab</p>
<p style="position:absolute;top:883px;left:256px;white-space:nowrap" class="ft1408">file&#160;by&#160;using&#160;the</p>
<p style="position:absolute;top:884px;left:356px;white-space:nowrap" class="ft14034">mount&#160;-n</p>
<p style="position:absolute;top:883px;left:431px;white-space:nowrap" class="ft1408">command.</p>
<p style="position:absolute;top:901px;left:172px;white-space:nowrap" class="ft1408">The&#160;mount&#160;list&#160;library&#160;(MoL<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#140">L</a></p>
<p style="position:absolute;top:898px;left:353px;white-space:nowrap" class="ft14027"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#140">3</a></p>
<p style="position:absolute;top:901px;left:359px;white-space:nowrap" class="ft1408"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#140">)&#160;</a>operates&#160;on&#160;the&#160;PVM&#160;information&#160;about&#160;mounted</p>
<p style="position:absolute;top:919px;left:150px;white-space:nowrap" class="ft14014">file&#160;systems&#160;collected&#160;via&#160;the&#160;native&#160;interface&#160;query.&#160;The&#160;starting&#160;symbol&#160;for&#160;obtaining<br/>the&#160;information&#160;is&#160;the</p>
<p style="position:absolute;top:938px;left:288px;white-space:nowrap" class="ft14034">task_struct</p>
<p style="position:absolute;top:937px;left:391px;white-space:nowrap" class="ft1408">structure&#160;of&#160;the&#160;idle&#160;task&#160;(however,&#160;the&#160;entry</p>
<p style="position:absolute;top:955px;left:150px;white-space:nowrap" class="ft1408">for&#160;any&#160;task&#160;would&#160;be&#160;adequate),&#160;from&#160;where&#160;the&#160;MoLL&#160;gains&#160;access&#160;to&#160;the</p>
<p style="position:absolute;top:955px;left:612px;white-space:nowrap" class="ft14034">vfsmnt</p>
<p style="position:absolute;top:973px;left:150px;white-space:nowrap" class="ft14015">circular&#160;list.&#160;The&#160;list&#160;provides&#160;complete&#160;information&#160;about&#160;all&#160;file&#160;systems&#160;currently<br/>mounted.</p>
<p style="position:absolute;top:1014px;left:166px;white-space:nowrap" class="ft14028">2</p>
<p style="position:absolute;top:1016px;left:171px;white-space:nowrap" class="ft14019">Note&#160;that&#160;the&#160;frontDoor&#160;query&#160;is&#160;made&#160;through&#160;an&#160;SSH&#160;connection,&#160;which&#160;will&#160;show&#160;up&#160;only&#160;in&#160;the</p>
<p style="position:absolute;top:1031px;left:150px;white-space:nowrap" class="ft14019">frontDoor&#160;query&#160;but&#160;in&#160;neither&#160;of&#160;the&#160;interface&#160;queries.</p>
<p style="position:absolute;top:1043px;left:166px;white-space:nowrap" class="ft14028">3</p>
<p style="position:absolute;top:1045px;left:171px;white-space:nowrap" class="ft14019">The&#160;MoLL&#160;should&#160;not&#160;be&#160;confused&#160;with&#160;MLL,&#160;the&#160;module&#160;list&#160;library.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft14021">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 141 -->
<a name="141"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft141176{font-size:8px;line-height:9px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page141-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5141.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1418">CHAPTER&#160;10.&#160;TOWARDS&#160;DEPENDABILITY&#160;AND&#160;ATTACK&#160;RESISTANCE&#160;139</p>
<p style="position:absolute;top:194px;left:369px;white-space:nowrap" class="ft141174"><i><b>SSVM</b></i></p>
<p style="position:absolute;top:194px;left:560px;white-space:nowrap" class="ft141174"><i><b>PVM</b></i></p>
<p style="position:absolute;top:344px;left:476px;white-space:nowrap" class="ft14169">EHKM</p>
<p style="position:absolute;top:340px;left:369px;white-space:nowrap" class="ft14170"><b>Kernel</b></p>
<p style="position:absolute;top:364px;left:369px;white-space:nowrap" class="ft14170"><b>Xen</b></p>
<p style="position:absolute;top:210px;left:369px;white-space:nowrap" class="ft14170"><b>User&#160;Space</b></p>
<p style="position:absolute;top:391px;left:369px;white-space:nowrap" class="ft14170"><b>Hardware</b></p>
<p style="position:absolute;top:204px;left:436px;white-space:nowrap" class="ft14169">Event&#160;Handling</p>
<p style="position:absolute;top:269px;left:423px;white-space:nowrap" class="ft14169">Rules</p>
<p style="position:absolute;top:286px;left:532px;white-space:nowrap" class="ft14169">Application</p>
<p style="position:absolute;top:392px;left:546px;white-space:nowrap" class="ft14169">CPU</p>
<p style="position:absolute;top:369px;left:504px;white-space:nowrap" class="ft14169">SCI</p>
<p style="position:absolute;top:370px;left:455px;white-space:nowrap" class="ft14144">Rules</p>
<p style="position:absolute;top:313px;left:428px;white-space:nowrap" class="ft14169">PIT</p>
<p style="position:absolute;top:313px;left:559px;white-space:nowrap" class="ft141176">system<br/>calls</p>
<p style="position:absolute;top:439px;left:248px;white-space:nowrap" class="ft1418">The&#160;mount&#160;information&#160;gathered&#160;from&#160;the&#160;native&#160;interface&#160;query&#160;is&#160;used&#160;as&#160;the&#160;refer-</p>
<p style="position:absolute;top:457px;left:226px;white-space:nowrap" class="ft14114">ence&#160;against&#160;which&#160;the&#160;information&#160;from&#160;the&#160;frontDoor&#160;interface&#160;is&#160;compared.&#160;If&#160;there<br/>are&#160;mounted&#160;file&#160;systems&#160;that&#160;appear&#160;in&#160;the&#160;former&#160;but&#160;not&#160;in&#160;the&#160;latter,&#160;we&#160;take&#160;this<br/>as&#160;an&#160;indication&#160;of&#160;a&#160;hidden&#160;malicious&#160;process&#160;because&#160;mount&#160;information&#160;is&#160;relatively<br/>static,&#160;and&#160;hence&#160;false&#160;positives&#160;are&#160;not&#160;a&#160;big&#160;concern.</p>
<p style="position:absolute;top:551px;left:226px;white-space:nowrap" class="ft14123"><b>File&#160;system</b></p>
<p style="position:absolute;top:551px;left:313px;white-space:nowrap" class="ft1418">In&#160;the&#160;case&#160;of&#160;the&#160;file&#160;system,&#160;bridging&#160;the&#160;semantic&#160;gap&#160;in&#160;general&#160;im-</p>
<p style="position:absolute;top:569px;left:226px;white-space:nowrap" class="ft14114">plies&#160;the&#160;use&#160;of&#160;raw&#160;access&#160;to&#160;the&#160;physical&#160;disk&#160;and&#160;the&#160;related&#160;traffic&#160;to&#160;rebuild&#160;the<br/>file&#160;system&#160;structures&#160;of&#160;the&#160;guest&#160;operating&#160;system&#160;of&#160;the&#160;PVM&#160;in&#160;the&#160;context&#160;of&#160;the<br/>SSVM.&#160;Accessing&#160;file&#160;systems&#160;mounted&#160;by&#160;another&#160;operating&#160;system&#160;is&#160;feasible&#160;even<br/>for&#160;disparate&#160;operating&#160;systems,&#160;e.g.&#160;Microsoft&#160;Windows&#160;and&#160;Linux,&#160;as&#160;for&#160;example<br/>shown&#160;in&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">[57]</a>.&#160;Xen&#160;can&#160;use&#160;a&#160;Linux&#160;file&#160;system&#160;existing&#160;on&#160;the&#160;Xen/Dom0&#160;level&#160;to&#160;boot<br/>and&#160;launch&#160;guest&#160;domains.&#160;This&#160;same&#160;file&#160;system&#160;can&#160;then&#160;be&#160;mounted&#160;read-only&#160;by<br/>the&#160;SSVM.&#160;We&#160;then&#160;retrieve&#160;the&#160;file&#160;information&#160;via&#160;the&#160;frontDoor&#160;and&#160;compare&#160;it&#160;with<br/>the&#160;information&#160;of&#160;the&#160;file&#160;system&#160;mounted&#160;by&#160;the&#160;SSVM.</p>
<p style="position:absolute;top:712px;left:248px;white-space:nowrap" class="ft1418">For&#160;efficiency&#160;and&#160;simplified&#160;forensic&#160;recording,&#160;we&#160;use&#160;a&#160;basic&#160;read-only&#160;file&#160;sys-</p>
<p style="position:absolute;top:730px;left:226px;white-space:nowrap" class="ft14114">tem&#160;and&#160;add&#160;the&#160;CoWNFS&#160;<i>copy-on-write&#160;</i>file&#160;system&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">[67,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">94]</a>.&#160;This&#160;allows&#160;us&#160;to&#160;store<br/>the&#160;changes&#160;for&#160;multiple&#160;runs&#160;for&#160;later&#160;forensic&#160;analysis&#160;and&#160;protects&#160;the&#160;original&#160;state<br/>of&#160;the&#160;system&#160;from&#160;any&#160;(potentially&#160;malicious)&#160;changes.&#160;This&#160;combined&#160;file&#160;system&#160;was<br/>then&#160;used&#160;as&#160;an&#160;NFS&#160;mountable&#160;file&#160;system&#160;for&#160;booting&#160;the&#160;PVM.</p>
<p style="position:absolute;top:825px;left:226px;white-space:nowrap" class="ft14124"><b>10.3.4</b></p>
<p style="position:absolute;top:825px;left:289px;white-space:nowrap" class="ft141103"><b>Protection&#160;of&#160;System&#160;Integrity&#160;and&#160;Forensic&#160;Information&#160;by<br/>means&#160;of&#160;System&#160;Call&#160;Inspection</b></p>
<p style="position:absolute;top:876px;left:226px;white-space:nowrap" class="ft14115">We&#160;now&#160;outline&#160;how&#160;X-Spy’s&#160;System&#160;Call&#160;Inspection&#160;component&#160;is&#160;used&#160;to&#160;protect&#160;the<br/>system&#160;against&#160;intrusions.</p>
<p style="position:absolute;top:934px;left:226px;white-space:nowrap" class="ft14123"><b>Protection&#160;of&#160;Forensic&#160;Information</b></p>
<p style="position:absolute;top:962px;left:226px;white-space:nowrap" class="ft14115">In&#160;case&#160;of&#160;a&#160;successful&#160;intrusion&#160;it&#160;is&#160;highly&#160;desirable&#160;to&#160;protect&#160;as&#160;much&#160;forensic&#160;in-<br/>formation&#160;as&#160;possible.&#160;A&#160;smart&#160;intruder&#160;would&#160;want&#160;to&#160;hide&#160;all&#160;traces&#160;of&#160;the&#160;intrusion,<br/>e.g.,&#160;by&#160;altering&#160;log-file<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#141">s</a></p>
<p style="position:absolute;top:995px;left:374px;white-space:nowrap" class="ft14127"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#141">4</a></p>
<p style="position:absolute;top:997px;left:384px;white-space:nowrap" class="ft1418">such&#160;as&#160;the</p>
<p style="position:absolute;top:998px;left:456px;white-space:nowrap" class="ft14134">wtmp/utmp</p>
<p style="position:absolute;top:997px;left:541px;white-space:nowrap" class="ft1418">and&#160;the</p>
<p style="position:absolute;top:998px;left:589px;white-space:nowrap" class="ft14134">/var/log/messages</p>
<p style="position:absolute;top:1015px;left:226px;white-space:nowrap" class="ft1418">files.&#160;While&#160;these&#160;files&#160;cannot&#160;be&#160;modified&#160;by&#160;normal&#160;users,&#160;intruders&#160;with&#160;root&#160;access</p>
<p style="position:absolute;top:1042px;left:242px;white-space:nowrap" class="ft14128">4</p>
<p style="position:absolute;top:1044px;left:248px;white-space:nowrap" class="ft14119">Note&#160;that&#160;the&#160;above&#160;protection&#160;scheme&#160;for&#160;log&#160;files&#160;can&#160;easily&#160;be&#160;extended&#160;to&#160;protect&#160;other&#160;important</p>
<p style="position:absolute;top:1059px;left:226px;white-space:nowrap" class="ft14119">files,&#160;such&#160;as&#160;Xen&#160;VM&#160;configuration&#160;files,&#160;through&#160;additional&#160;rules&#160;in&#160;the&#160;rule&#160;set.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft14121">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 142 -->
<a name="142"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page142-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5142.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1428">140</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft14221">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft14214">can.&#160;One&#160;way&#160;to&#160;address&#160;this&#160;issue&#160;would&#160;be&#160;to&#160;use&#160;a&#160;hardened&#160;system&#160;(e.g.,&#160;SELinux).<br/>However,&#160;this&#160;protects&#160;only&#160;if&#160;the&#160;superuser&#160;is&#160;not&#160;allowed&#160;to&#160;change&#160;the&#160;SELinux&#160;rules<br/>in&#160;a&#160;running&#160;System.</p>
<p style="position:absolute;top:247px;left:172px;white-space:nowrap" class="ft1428">In&#160;a&#160;virtualized&#160;environment&#160;as&#160;considered&#160;here,&#160;we&#160;have&#160;the&#160;possibility&#160;to&#160;protect</p>
<p style="position:absolute;top:265px;left:150px;white-space:nowrap" class="ft14240">important&#160;files&#160;by&#160;intercepting&#160;the&#160;system&#160;call&#160;sequence&#160;in&#160;the&#160;PVM&#160;through&#160;the&#160;Xen<br/>hypervisor.&#160;For&#160;this&#160;purpose,&#160;we&#160;added&#160;a&#160;module&#160;to&#160;the&#160;Xen&#160;hypervisor,&#160;the&#160;<i>System<br/>Call&#160;Inspector&#160;</i>(SCI),&#160;which&#160;can&#160;inspect&#160;al<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#142">l</a></p>
<p style="position:absolute;top:299px;left:414px;white-space:nowrap" class="ft14227"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#142">5</a></p>
<p style="position:absolute;top:301px;left:425px;white-space:nowrap" class="ft1428">system&#160;calls&#160;occurring&#160;in&#160;the&#160;PVM&#160;and</p>
<p style="position:absolute;top:319px;left:150px;white-space:nowrap" class="ft14214">either&#160;block&#160;or&#160;accept&#160;calls&#160;depending&#160;on&#160;a&#160;set&#160;of&#160;<i>rules</i>.&#160;These&#160;rules&#160;are&#160;stored&#160;and<br/>edited&#160;in&#160;the&#160;SSVM&#160;(and&#160;therefore&#160;out&#160;of&#160;reach&#160;of&#160;any&#160;activity&#160;in&#160;the&#160;PVM),&#160;and&#160;can&#160;be<br/>loaded&#160;into&#160;the&#160;SCI&#160;(in&#160;binary&#160;form)&#160;via&#160;the&#160;Policy&#160;Installation&#160;Tool&#160;(PIT).</p>
<p style="position:absolute;top:373px;left:172px;white-space:nowrap" class="ft1428">X-Spy&#160;implements&#160;a&#160;functionality&#160;for&#160;checking&#160;and&#160;fine-tuning&#160;system&#160;calls&#160;by</p>
<p style="position:absolute;top:391px;left:150px;white-space:nowrap" class="ft1428">instrumenting&#160;the&#160;system&#160;call&#160;handling&#160;chain.&#160;An</p>
<p style="position:absolute;top:392px;left:444px;white-space:nowrap" class="ft14234">int&#160;0x80</p>
<p style="position:absolute;top:391px;left:519px;white-space:nowrap" class="ft1428">instruction&#160;is&#160;intercepted</p>
<p style="position:absolute;top:409px;left:150px;white-space:nowrap" class="ft14214">by&#160;an&#160;interrupt&#160;handler&#160;located&#160;in&#160;the&#160;Xen&#160;context&#160;where&#160;checks&#160;against&#160;the&#160;previously<br/>introduced&#160;rule&#160;set&#160;are&#160;done.&#160;Only&#160;after&#160;passing&#160;the&#160;checks&#160;is&#160;the&#160;call&#160;redirected&#160;to<br/>the&#160;PVM&#160;Kernel,&#160;where&#160;the&#160;normal&#160;system&#160;call&#160;handler&#160;is&#160;invoked;&#160;otherwise,&#160;the&#160;call<br/>returns&#160;without&#160;any&#160;action&#160;being&#160;taken.&#160;In&#160;certain&#160;cases,&#160;the&#160;system&#160;call&#160;is&#160;allowed&#160;after<br/>some&#160;fine-tuning,&#160;e.g.,&#160;a&#160;modification&#160;of&#160;the&#160;parameters&#160;so&#160;that&#160;the&#160;call&#160;conforms&#160;to&#160;the<br/>rule&#160;set&#160;specified.&#160;The&#160;amount&#160;of&#160;performance&#160;overhead&#160;depends&#160;on&#160;the&#160;type&#160;of&#160;checks<br/>and&#160;fine-tuning&#160;being&#160;done&#160;for&#160;a&#160;particular&#160;system&#160;call.</p>
<p style="position:absolute;top:534px;left:172px;white-space:nowrap" class="ft1428">As&#160;the&#160;interception&#160;of&#160;the&#160;system&#160;call&#160;happens&#160;in&#160;the&#160;Xen&#160;context,&#160;the&#160;problem&#160;of</p>
<p style="position:absolute;top:552px;left:150px;white-space:nowrap" class="ft14214">semantic&#160;gap&#160;has&#160;to&#160;be&#160;overcome&#160;to&#160;determine&#160;which&#160;system&#160;calls&#160;actually&#160;merit&#160;addi-<br/>tional&#160;checks.&#160;For&#160;our&#160;aim&#160;of&#160;protecting&#160;forensic&#160;information,&#160;system&#160;calls&#160;performing<br/>file&#160;operations&#160;are&#160;essential.&#160;We&#160;protect&#160;forensic&#160;information&#160;by&#160;preventing&#160;calls&#160;that<br/>rename,&#160;link,&#160;unlink,&#160;or&#160;delete&#160;log&#160;files.&#160;Furthermore,&#160;we&#160;limit&#160;access&#160;to&#160;log&#160;files&#160;by<br/>permitting&#160;only&#160;the&#160;append&#160;operation&#160;on&#160;them.&#160;To&#160;ensure&#160;that&#160;a&#160;malicious&#160;process<br/>cannot&#160;bypass&#160;the&#160;checking,&#160;we&#160;normalized&#160;the&#160;paths.</p>
<p style="position:absolute;top:660px;left:172px;white-space:nowrap" class="ft1428">If&#160;the&#160;SCI&#160;finds&#160;that&#160;an&#160;application&#160;in&#160;the&#160;PVM&#160;tries&#160;to&#160;initiate&#160;a&#160;system&#160;call&#160;that</p>
<p style="position:absolute;top:678px;left:150px;white-space:nowrap" class="ft14215">is&#160;not&#160;allowed&#160;according&#160;to&#160;the&#160;rule&#160;set,&#160;it&#160;will&#160;block&#160;or&#160;modify&#160;it&#160;and&#160;send&#160;a&#160;corre-<br/>sponding&#160;event&#160;through&#160;an&#160;<i>event&#160;handling&#160;kernel&#160;module&#160;</i>(EHKM)&#160;in&#160;the&#160;SSVM&#160;to&#160;the<br/>high-level&#160;event&#160;handling&#160;component&#160;with&#160;information&#160;about&#160;the&#160;violated&#160;rule&#160;and&#160;the<br/>corresponding&#160;process&#160;in&#160;the&#160;PVM.</p>
<p style="position:absolute;top:771px;left:150px;white-space:nowrap" class="ft14223"><b>Protection&#160;of&#160;Binaries&#160;against&#160;User-Space&#160;Rootkits</b></p>
<p style="position:absolute;top:799px;left:150px;white-space:nowrap" class="ft14215">The&#160;mechanism&#160;used&#160;for&#160;protecting&#160;forensic&#160;information&#160;can&#160;also&#160;be&#160;used&#160;to&#160;protect<br/>binaries&#160;from&#160;being&#160;altered&#160;by&#160;an&#160;intruder.&#160;Many&#160;user-space&#160;rootkits&#160;try&#160;to&#160;alter</p>
<p style="position:absolute;top:818px;left:631px;white-space:nowrap" class="ft14234">ps</p>
<p style="position:absolute;top:817px;left:653px;white-space:nowrap" class="ft1428">or</p>
<p style="position:absolute;top:836px;left:150px;white-space:nowrap" class="ft14234">netstat</p>
<p style="position:absolute;top:835px;left:217px;white-space:nowrap" class="ft1428">to&#160;hide&#160;their&#160;presence&#160;or&#160;to&#160;install&#160;a&#160;back&#160;door&#160;by&#160;modifying&#160;the</p>
<p style="position:absolute;top:836px;left:603px;white-space:nowrap" class="ft14234">openssh</p>
<p style="position:absolute;top:853px;left:150px;white-space:nowrap" class="ft14214">binary.&#160;While&#160;earlier&#160;tools,&#160;such&#160;as&#160;Tripwire,&#160;can&#160;<i>detect&#160;</i>the&#160;alteration&#160;of&#160;a&#160;binary&#160;or<br/>a&#160;library,&#160;our&#160;event-driven&#160;approach&#160;to&#160;check&#160;system&#160;calls&#160;and&#160;their&#160;arguments&#160;can<br/>actually&#160;<i>prevent&#160;</i>their&#160;alteration.</p>
<p style="position:absolute;top:907px;left:172px;white-space:nowrap" class="ft1428">In&#160;addition,&#160;it&#160;is&#160;possible&#160;to&#160;restrict&#160;read/write&#160;access&#160;to&#160;an&#160;executable,&#160;but&#160;still&#160;allow</p>
<p style="position:absolute;top:925px;left:150px;white-space:nowrap" class="ft14214">its&#160;execution.&#160;Based&#160;on&#160;the&#160;corresponding&#160;rule&#160;set,&#160;the&#160;module&#160;we&#160;have&#160;implemented<br/>in&#160;the&#160;Xen&#160;hypervisor&#160;checks&#160;whether&#160;a&#160;system&#160;call&#160;is&#160;trying&#160;to&#160;change,&#160;delete,&#160;link,<br/>or&#160;rename&#160;a&#160;binary,&#160;and&#160;if&#160;so,&#160;the&#160;call&#160;is&#160;denied.&#160;As&#160;execution&#160;of&#160;a&#160;binary&#160;normally<br/>happens&#160;through&#160;the</p>
<p style="position:absolute;top:979px;left:278px;white-space:nowrap" class="ft14234">execve</p>
<p style="position:absolute;top:979px;left:336px;white-space:nowrap" class="ft1428">system&#160;call&#160;without&#160;actually&#160;opening&#160;the&#160;binary&#160;file,&#160;it</p>
<p style="position:absolute;top:997px;left:150px;white-space:nowrap" class="ft14215">is&#160;even&#160;possible&#160;to&#160;add&#160;a&#160;rule&#160;that&#160;forbids&#160;the&#160;opening&#160;of&#160;certain&#160;binaries&#160;completely<br/>without&#160;disallowing&#160;their&#160;execution.</p>
<p style="position:absolute;top:1041px;left:166px;white-space:nowrap" class="ft14228">5</p>
<p style="position:absolute;top:1044px;left:171px;white-space:nowrap" class="ft14219">Note&#160;that&#160;Xen&#160;implements&#160;a&#160;“fast&#160;trap”&#160;mechanism&#160;to&#160;enhance&#160;performance.&#160;If&#160;Xen&#160;calls&#160;are&#160;to&#160;be</p>
<p style="position:absolute;top:1058px;left:150px;white-space:nowrap" class="ft14219">monitored&#160;as&#160;well,&#160;then&#160;this&#160;mechanism&#160;need&#160;to&#160;be&#160;disabled.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft14221">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 143 -->
<a name="143"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page143-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5143.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1438">CHAPTER&#160;10.&#160;TOWARDS&#160;DEPENDABILITY&#160;AND&#160;ATTACK&#160;RESISTANCE&#160;141</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft14323"><b>Kernel&#160;Sealing</b></p>
<p style="position:absolute;top:222px;left:226px;white-space:nowrap" class="ft14315">X-Spy&#160;also&#160;implements&#160;<i>kernel&#160;sealing</i>,&#160;a&#160;well-known&#160;method&#160;to&#160;protect&#160;a&#160;system&#160;or<br/>prevent&#160;intrusions.&#160;The&#160;kernel&#160;memory&#160;can&#160;be&#160;accessed&#160;directly&#160;by&#160;reading&#160;or,&#160;more<br/>dangerously,&#160;by&#160;writing&#160;to&#160;the</p>
<p style="position:absolute;top:258px;left:413px;white-space:nowrap" class="ft14334">/dev/mem</p>
<p style="position:absolute;top:257px;left:489px;white-space:nowrap" class="ft1438">or</p>
<p style="position:absolute;top:258px;left:506px;white-space:nowrap" class="ft14334">/dev/kmem</p>
<p style="position:absolute;top:257px;left:591px;white-space:nowrap" class="ft1438">device&#160;files.&#160;The&#160;rule&#160;set</p>
<p style="position:absolute;top:275px;left:226px;white-space:nowrap" class="ft14315">of&#160;the&#160;X-Spy&#160;event-driven&#160;module&#160;in&#160;the&#160;Xen&#160;hypervisor&#160;was&#160;updated&#160;to&#160;restrict&#160;access<br/>to&#160;those&#160;files,&#160;so&#160;that&#160;only&#160;read&#160;requests&#160;are&#160;allowed&#160;and&#160;write&#160;requests&#160;return&#160;an&#160;error<br/>result&#160;without&#160;performing&#160;the&#160;write&#160;operation.</p>
<p style="position:absolute;top:329px;left:248px;white-space:nowrap" class="ft1438">Accessing&#160;the&#160;kernel&#160;memory&#160;by&#160;loading&#160;a&#160;kernel&#160;module&#160;or&#160;writing&#160;directly&#160;to</p>
<p style="position:absolute;top:347px;left:226px;white-space:nowrap" class="ft14315">/dev/(k)mem&#160;is&#160;potentially&#160;dangerous&#160;because&#160;it&#160;allows&#160;an&#160;intruder&#160;to&#160;establish&#160;its&#160;own<br/>interface&#160;to&#160;the&#160;kernel;&#160;thereafter,&#160;the&#160;intruder&#160;can&#160;easily&#160;place&#160;malicious&#160;code&#160;in&#160;the<br/>kernel&#160;and&#160;have&#160;full&#160;access&#160;to&#160;the&#160;file&#160;system&#160;and&#160;other&#160;kernel&#160;internals.&#160;X-Spy&#160;uses<br/>a&#160;technique&#160;called&#160;<i>white-listing&#160;</i>by&#160;which&#160;all&#160;kernel&#160;modules&#160;allowed&#160;to&#160;be&#160;loaded&#160;are<br/>explicitly&#160;specified&#160;along&#160;with&#160;their&#160;respective&#160;SHA-1&#160;hash&#160;values.&#160;If&#160;the&#160;module&#160;to<br/>be&#160;loaded&#160;at&#160;run-time&#160;is&#160;not&#160;specified&#160;in&#160;the&#160;white-list&#160;or&#160;if&#160;it&#160;has&#160;an&#160;incorrect&#160;hash<br/>value,&#160;X-Spy&#160;prevents&#160;the&#160;module&#160;from&#160;being&#160;loaded&#160;by&#160;preventing&#160;the&#160;system&#160;call<br/>from&#160;reaching&#160;the&#160;PVM&#160;kernel&#160;space.&#160;Note&#160;that&#160;our&#160;X-Spy&#160;implementation&#160;does&#160;not<br/>offer&#160;protection&#160;against&#160;buffer&#160;overflows&#160;on&#160;systems&#160;calls.</p>
<p style="position:absolute;top:530px;left:226px;white-space:nowrap" class="ft14323"><b>Pre-Checking&#160;of&#160;Binaries</b></p>
<p style="position:absolute;top:558px;left:226px;white-space:nowrap" class="ft14315">An&#160;effective&#160;way&#160;of&#160;protecting&#160;a&#160;PVM&#160;from&#160;user-space&#160;rootkits&#160;or&#160;other&#160;malicious<br/>software&#160;is&#160;to&#160;check&#160;the&#160;hash&#160;of&#160;every&#160;binary,&#160;prior&#160;to&#160;its&#160;execution,&#160;against&#160;a&#160;white-list<br/>of&#160;pre-calculated&#160;hashes&#160;and&#160;to&#160;allow&#160;its&#160;execution&#160;only&#160;if&#160;there&#160;is&#160;a&#160;match.&#160;Computing<br/>the&#160;hash&#160;of&#160;the&#160;binary&#160;has&#160;to&#160;be&#160;done&#160;out&#160;of&#160;the&#160;reach&#160;of&#160;a&#160;potential&#160;intruder&#160;in&#160;the&#160;PVM<br/>and&#160;should&#160;also&#160;not&#160;require&#160;modification&#160;of&#160;the&#160;PVM’s&#160;OS.&#160;To&#160;meet&#160;these&#160;conditions,<br/>X-Spy&#160;computes&#160;the&#160;hash&#160;of&#160;the&#160;binary&#160;in&#160;the&#160;SSVM.&#160;To&#160;enable&#160;such&#160;a&#160;computation,<br/>it&#160;is&#160;necessary&#160;that&#160;the&#160;SSVM&#160;has&#160;all&#160;partitions&#160;of&#160;the&#160;PVM&#160;mounted;&#160;furthermore,&#160;the<br/>binary&#160;should&#160;not&#160;be&#160;on&#160;a&#160;RAM&#160;disk,&#160;on&#160;network&#160;file&#160;system,&#160;or&#160;on&#160;an&#160;encrypted&#160;file<br/>system&#160;that&#160;the&#160;SSVM&#160;cannot&#160;access.&#160;An&#160;alternative&#160;would&#160;be&#160;to&#160;do&#160;the&#160;computation<br/>in&#160;the&#160;hypervisor,&#160;which&#160;would&#160;require&#160;overcoming&#160;the&#160;semantic&#160;gap&#160;problem.</p>
<p style="position:absolute;top:737px;left:248px;white-space:nowrap" class="ft1438">For&#160;computing&#160;the&#160;hash&#160;of&#160;the&#160;binary&#160;in&#160;the&#160;SSVM,&#160;we&#160;use&#160;a&#160;technique&#160;called</p>
<p style="position:absolute;top:755px;left:226px;white-space:nowrap" class="ft14320"><i>memory&#160;scanning</i>,&#160;which&#160;involves&#160;loading&#160;the&#160;complete</p>
<p style="position:absolute;top:756px;left:568px;white-space:nowrap" class="ft14334">.text</p>
<p style="position:absolute;top:755px;left:618px;white-space:nowrap" class="ft1438">and</p>
<p style="position:absolute;top:756px;left:644px;white-space:nowrap" class="ft14334">.data</p>
<p style="position:absolute;top:755px;left:694px;white-space:nowrap" class="ft1438">sections</p>
<p style="position:absolute;top:773px;left:226px;white-space:nowrap" class="ft14314">of&#160;an&#160;ELF&#160;binary&#160;into&#160;memory&#160;by&#160;setting&#160;the&#160;program&#160;counter&#160;to&#160;the&#160;next&#160;page,&#160;asking<br/>the&#160;PVM&#160;kernel&#160;to&#160;load&#160;the&#160;page,&#160;and&#160;then&#160;hashing&#160;it&#160;while&#160;handling&#160;the&#160;page&#160;fault.</p>
<p style="position:absolute;top:809px;left:248px;white-space:nowrap" class="ft1438">If&#160;the&#160;hash&#160;cannot&#160;be&#160;verified&#160;the&#160;hypervisor&#160;invalidates&#160;all&#160;of&#160;the&#160;memory&#160;and</p>
<p style="position:absolute;top:827px;left:226px;white-space:nowrap" class="ft1438">returns&#160;the&#160;control&#160;back&#160;to&#160;the&#160;guest&#160;domain.&#160;Because&#160;of&#160;the&#160;invalid</p>
<p style="position:absolute;top:828px;left:650px;white-space:nowrap" class="ft14334">.text</p>
<p style="position:absolute;top:827px;left:699px;white-space:nowrap" class="ft1438">section</p>
<p style="position:absolute;top:845px;left:226px;white-space:nowrap" class="ft14314">to&#160;which&#160;the&#160;PC&#160;points,&#160;the&#160;process&#160;will&#160;crash.&#160;Note&#160;that&#160;relying&#160;on&#160;support&#160;from<br/>the&#160;PVM’s&#160;guest&#160;OS&#160;does&#160;not&#160;necessarily&#160;constitute&#160;a&#160;security&#160;gap,&#160;because&#160;a&#160;non-<br/>cooperative&#160;PVM&#160;kernel&#160;would&#160;lead&#160;to&#160;a&#160;wrong&#160;hash&#160;value&#160;and&#160;in&#160;this&#160;case,&#160;as&#160;seen<br/>above,&#160;the&#160;process&#160;will&#160;be&#160;forced&#160;to&#160;quit.</p>
<p style="position:absolute;top:939px;left:226px;white-space:nowrap" class="ft14324"><b>10.3.5</b></p>
<p style="position:absolute;top:939px;left:289px;white-space:nowrap" class="ft14324"><b>Evaluation</b></p>
<p style="position:absolute;top:969px;left:226px;white-space:nowrap" class="ft14314">While&#160;the&#160;conceptual&#160;limitations&#160;have&#160;been&#160;discussed&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#136">10.3.1,&#160;</a>we&#160;will&#160;now<br/>evaluate&#160;the&#160;effectiveness&#160;and&#160;efficiency&#160;of&#160;our&#160;implementation.</p>
<p style="position:absolute;top:1026px;left:226px;white-space:nowrap" class="ft14323"><b>Functional&#160;Evaluation</b></p>
<p style="position:absolute;top:1054px;left:226px;white-space:nowrap" class="ft14314">The&#160;goal&#160;of&#160;the&#160;Lie-Detector&#160;is&#160;to&#160;expose&#160;malicious&#160;code.&#160;Once&#160;all&#160;information&#160;is<br/>visible,&#160;we&#160;no&#160;longer&#160;focus&#160;on&#160;whether&#160;a&#160;particular&#160;LKM&#160;or&#160;process&#160;is&#160;hostile.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft14321">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 144 -->
<a name="144"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page144-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5144.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1448">142</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft14421">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:172px;white-space:nowrap" class="ft1448">We&#160;first&#160;evaluated&#160;our&#160;implementation&#160;using&#160;a&#160;set&#160;of&#160;functional&#160;tests&#160;that&#160;implement</p>
<p style="position:absolute;top:212px;left:150px;white-space:nowrap" class="ft14415">typical&#160;rootkit&#160;functionality,&#160;such&#160;as&#160;hiding&#160;processes,&#160;kernel&#160;modules,&#160;mounts,&#160;or&#160;net-<br/>work&#160;connections.&#160;Our&#160;Lie-Detector&#160;correctly&#160;exposed&#160;all&#160;attempts&#160;to&#160;hide&#160;such&#160;critical<br/>information.</p>
<p style="position:absolute;top:265px;left:172px;white-space:nowrap" class="ft1448">We&#160;then&#160;tested&#160;the&#160;system&#160;using&#160;the&#160;adore-ng&#160;rootkit&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[107]</a>.&#160;Adore-ng&#160;is&#160;an&#160;LKM-</p>
<p style="position:absolute;top:283px;left:150px;white-space:nowrap" class="ft14414">based&#160;rootkit&#160;for&#160;Linux&#160;kernels&#160;which&#160;allows&#160;one&#160;to&#160;hide&#160;files&#160;and&#160;directories,&#160;processes,<br/>and&#160;network&#160;connections.&#160;The&#160;basic&#160;rootkit&#160;consists&#160;of&#160;the&#160;kernel&#160;module&#160;and&#160;a&#160;user-<br/>space&#160;control&#160;program.&#160;While&#160;currently&#160;this&#160;is&#160;the&#160;only&#160;widely&#160;available&#160;rootkit&#160;for<br/>the&#160;Linux&#160;kernel&#160;2.6,&#160;other&#160;similar&#160;rootkits&#160;exist&#160;for&#160;earlier&#160;kernel&#160;versions&#160;and&#160;may&#160;be<br/>ported&#160;to&#160;the&#160;2.6&#160;kernel.</p>
<p style="position:absolute;top:373px;left:172px;white-space:nowrap" class="ft1448">In&#160;a&#160;fully&#160;protected&#160;X-Spy&#160;system,&#160;the&#160;rootkit&#160;cannot&#160;even&#160;be&#160;installed&#160;as&#160;the&#160;in-</p>
<p style="position:absolute;top:391px;left:150px;white-space:nowrap" class="ft14414">sertion&#160;of&#160;modules&#160;is&#160;restricted&#160;through&#160;the&#160;SCI&#160;interception&#160;of&#160;the&#160;respective&#160;system<br/>calls&#160;and&#160;the&#160;white-listing&#160;of&#160;allowed&#160;modules.&#160;After&#160;explicitly&#160;allowing&#160;the&#160;rootkit&#160;to<br/>insert&#160;itself&#160;into&#160;the&#160;kernel,&#160;we&#160;used&#160;its&#160;control&#160;program&#160;to&#160;hide&#160;processes,&#160;files,&#160;and&#160;net-<br/>work&#160;connections.&#160;The&#160;X-Spy&#160;Lie-Detector&#160;component&#160;reported&#160;these&#160;hidden&#160;resources<br/>faithfully&#160;by&#160;comparing&#160;the&#160;responses&#160;from&#160;the&#160;native&#160;and&#160;frontDoor&#160;interfaces&#160;as&#160;de-<br/>scribed&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#137">10.3.3.&#160;</a>Although&#160;the&#160;adore-ng&#160;kernel&#160;module&#160;will&#160;remove&#160;itself&#160;from<br/>the&#160;list&#160;of&#160;modules&#160;visible&#160;with</p>
<p style="position:absolute;top:499px;left:338px;white-space:nowrap" class="ft14434">lsmod</p>
<p style="position:absolute;top:498px;left:383px;white-space:nowrap" class="ft1448">,&#160;detection&#160;of&#160;the&#160;module&#160;by&#160;the&#160;Lie-Detector&#160;is</p>
<p style="position:absolute;top:516px;left:150px;white-space:nowrap" class="ft1448">possible&#160;with&#160;the&#160;help&#160;of&#160;the&#160;shadow&#160;module&#160;list&#160;(see&#160;discussion&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#141">10.3.4)</a>.</p>
<p style="position:absolute;top:534px;left:172px;white-space:nowrap" class="ft1448">The&#160;rule&#160;set&#160;used&#160;in&#160;X-Spy’s&#160;event-driven&#160;protection&#160;mechanism&#160;contained&#160;about</p>
<p style="position:absolute;top:552px;left:150px;white-space:nowrap" class="ft1448">110&#160;rules,&#160;e.g.&#160;to&#160;protect&#160;forensically&#160;relevant&#160;files&#160;(e.g.</p>
<p style="position:absolute;top:553px;left:487px;white-space:nowrap" class="ft14434">/var/log/messages</p>
<p style="position:absolute;top:552px;left:644px;white-space:nowrap" class="ft1448">and</p>
<p style="position:absolute;top:571px;left:150px;white-space:nowrap" class="ft14434">/var/log/wtmp</p>
<p style="position:absolute;top:570px;left:267px;white-space:nowrap" class="ft1448">)&#160;and&#160;to&#160;prevent&#160;access&#160;to&#160;raw&#160;memory&#160;(</p>
<p style="position:absolute;top:571px;left:517px;white-space:nowrap" class="ft14434">/dev/(k)mem)</p>
<p style="position:absolute;top:570px;left:625px;white-space:nowrap" class="ft1448">,&#160;secu-</p>
<p style="position:absolute;top:588px;left:150px;white-space:nowrap" class="ft1448">rity&#160;relevant&#160;configuration&#160;files&#160;(</p>
<p style="position:absolute;top:589px;left:350px;white-space:nowrap" class="ft14434">/etc/ssh.config</p>
<p style="position:absolute;top:588px;left:485px;white-space:nowrap" class="ft1448">),&#160;and&#160;operating&#160;system&#160;tools</p>
<p style="position:absolute;top:606px;left:150px;white-space:nowrap" class="ft1448">(</p>
<p style="position:absolute;top:607px;left:155px;white-space:nowrap" class="ft14434">/bin/ls</p>
<p style="position:absolute;top:606px;left:218px;white-space:nowrap" class="ft1448">).&#160;In&#160;addition,&#160;we&#160;specified&#160;an&#160;explicit&#160;list&#160;of&#160;allowed&#160;kernel&#160;modules&#160;(mod-</p>
<p style="position:absolute;top:624px;left:150px;white-space:nowrap" class="ft14414">ule&#160;white-listing).&#160;Once&#160;the&#160;rule&#160;set&#160;was&#160;active,&#160;it&#160;either&#160;generated&#160;security&#160;events&#160;with<br/>information&#160;about&#160;the&#160;offending&#160;processes&#160;in&#160;the&#160;PVM&#160;or&#160;successfully&#160;prevented&#160;the<br/>deletion&#160;or&#160;truncation&#160;of&#160;log-files&#160;and&#160;the&#160;modification&#160;of&#160;configuration&#160;and&#160;utility&#160;files.</p>
<p style="position:absolute;top:700px;left:150px;white-space:nowrap" class="ft14423"><b>Performance&#160;Impact</b></p>
<p style="position:absolute;top:728px;left:150px;white-space:nowrap" class="ft14456">To&#160;measure&#160;the&#160;performance&#160;impact&#160;of&#160;the&#160;Lie-Detector&#160;and&#160;the&#160;event-driven&#160;ap-<br/>proach,&#160;we&#160;used&#160;a&#160;single&#160;machine&#160;implementing&#160;a&#160;web&#160;server&#160;scenario.&#160;The&#160;PVM<br/>hosted&#160;an&#160;Apache&#160;web&#160;server,&#160;and&#160;multiple&#160;clients&#160;were&#160;simulated&#160;using&#160;the&#160;<i>ab<br/></i>performance&#160;benchmarking&#160;tool&#160;(see</p>
<p style="position:absolute;top:782px;left:370px;white-space:nowrap" class="ft14434"><a href="http://httpd.apache.org/docs/2.0/programs/ab.html">http://httpd.apache.org/docs/2.0/</a></p>
<p style="position:absolute;top:800px;left:150px;white-space:nowrap" class="ft14434"><a href="http://httpd.apache.org/docs/2.0/programs/ab.html">programs/ab.html</a></p>
<p style="position:absolute;top:799px;left:293px;white-space:nowrap" class="ft1448"><a href="http://httpd.apache.org/docs/2.0/programs/ab.html">)</a>.&#160;The&#160;networks&#160;were&#160;virtual&#160;and&#160;internal&#160;to&#160;this&#160;machine.</p>
<p style="position:absolute;top:817px;left:172px;white-space:nowrap" class="ft1448">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#145">10.2(a)&#160;</a>shows&#160;that&#160;the&#160;performance&#160;impact&#160;of&#160;the&#160;Lie-Detector&#160;depends&#160;on</p>
<p style="position:absolute;top:835px;left:150px;white-space:nowrap" class="ft14414">how&#160;often&#160;it&#160;is&#160;run.&#160;The&#160;overhead&#160;is&#160;roughly&#160;31%&#160;when&#160;it&#160;is&#160;running&#160;continuously,&#160;20%<br/>when&#160;it&#160;is&#160;run&#160;every&#160;10&#160;sec,&#160;and&#160;4%&#160;when&#160;it&#160;is&#160;run&#160;every&#160;30&#160;sec.</p>
<p style="position:absolute;top:871px;left:172px;white-space:nowrap" class="ft1448">Most&#160;practical&#160;applications&#160;will&#160;run&#160;infrequent&#160;scans.&#160;In&#160;this&#160;case,&#160;the&#160;performance</p>
<p style="position:absolute;top:889px;left:150px;white-space:nowrap" class="ft14414">impact&#160;of&#160;X-Spy&#160;is&#160;negligible,&#160;particularly&#160;when&#160;compared&#160;with&#160;the&#160;performance&#160;re-<br/>duction&#160;of&#160;moving&#160;Linux&#160;into&#160;a&#160;VM.</p>
<p style="position:absolute;top:925px;left:172px;white-space:nowrap" class="ft1448">In&#160;a&#160;real-world&#160;setting,&#160;the&#160;frequency&#160;of&#160;“Lie&#160;Detection”&#160;should&#160;be&#160;chosen&#160;based</p>
<p style="position:absolute;top:943px;left:150px;white-space:nowrap" class="ft14414">on&#160;the&#160;expected&#160;time&#160;until&#160;an&#160;intrusion&#160;occurs&#160;and&#160;the&#160;expected&#160;time&#160;until&#160;such&#160;an<br/>intrusion&#160;is&#160;detected.&#160;The&#160;latter&#160;is&#160;an&#160;important&#160;factor&#160;because&#160;it&#160;denotes&#160;the&#160;critical<br/>time&#160;window&#160;between&#160;the&#160;intrusion&#160;and&#160;its&#160;detection&#160;when&#160;the&#160;PVM&#160;is&#160;at&#160;the&#160;mercy<br/>of&#160;the&#160;intruder,&#160;who&#160;can&#160;take&#160;arbitrary&#160;actions&#160;(such&#160;as&#160;installing&#160;a&#160;fake&#160;website&#160;or<br/>copying&#160;private&#160;information&#160;onto&#160;a&#160;different&#160;system).&#160;If&#160;the&#160;PVM&#160;runs&#160;a&#160;critical&#160;service<br/>in&#160;which&#160;the&#160;critical&#160;time&#160;window&#160;should&#160;be&#160;minimized,&#160;then&#160;the&#160;Lie-Detector&#160;should<br/>be&#160;run&#160;continuously.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft14421">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 145 -->
<a name="145"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft145177{font-size:6px;font-family:Helvetica;color:#000000;-moz-transform: matrix(         0,         -1, 0.9986917139,          0, 0, 0);-webkit-transform: matrix(         0,         -1, 0.9986917139,          0, 0, 0);-o-transform: matrix(         0,         -1, 0.9986917139,          0, 0, 0);-ms-transform: matrix(         0,         -1, 0.9986917139,          0, 0, 0);-moz-transform-origin: left 75%;-webkit-transform-origin: left 75%;-o-transform-origin: left 75%;-ms-transform-origin: left 75%;}
-->
</style>
<div id="page145-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5145.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1458">CHAPTER&#160;10.&#160;TOWARDS&#160;DEPENDABILITY&#160;AND&#160;ATTACK&#160;RESISTANCE&#160;143</p>
<p style="position:absolute;top:339px;left:270px;white-space:nowrap" class="ft145162">0</p>
<p style="position:absolute;top:324px;left:263px;white-space:nowrap" class="ft145162">100</p>
<p style="position:absolute;top:308px;left:263px;white-space:nowrap" class="ft145162">200</p>
<p style="position:absolute;top:292px;left:263px;white-space:nowrap" class="ft145162">300</p>
<p style="position:absolute;top:276px;left:263px;white-space:nowrap" class="ft145162">400</p>
<p style="position:absolute;top:261px;left:263px;white-space:nowrap" class="ft145162">500</p>
<p style="position:absolute;top:245px;left:263px;white-space:nowrap" class="ft145162">600</p>
<p style="position:absolute;top:230px;left:263px;white-space:nowrap" class="ft145162">700</p>
<p style="position:absolute;top:214px;left:263px;white-space:nowrap" class="ft145162">800</p>
<p style="position:absolute;top:198px;left:263px;white-space:nowrap" class="ft145162">900</p>
<p style="position:absolute;top:348px;left:279px;white-space:nowrap" class="ft145162">No&#160;Lie&#160;Detection</p>
<p style="position:absolute;top:348px;left:330px;white-space:nowrap" class="ft145162">Lie&#160;Detection</p>
<p style="position:absolute;top:356px;left:334px;white-space:nowrap" class="ft145162">every&#160;30s</p>
<p style="position:absolute;top:348px;left:377px;white-space:nowrap" class="ft145162">Lie&#160;Detection</p>
<p style="position:absolute;top:356px;left:381px;white-space:nowrap" class="ft145162">every&#160;10s</p>
<p style="position:absolute;top:348px;left:423px;white-space:nowrap" class="ft145162">Lie&#160;Detection</p>
<p style="position:absolute;top:356px;left:425px;white-space:nowrap" class="ft145162">continously</p>
<p style="position:absolute;top:285px;left:258px;white-space:nowrap" class="ft145177"><b>R</b></p>
<p style="position:absolute;top:280px;left:258px;white-space:nowrap" class="ft145177"><b>e</b></p>
<p style="position:absolute;top:277px;left:258px;white-space:nowrap" class="ft145177"><b>q</b></p>
<p style="position:absolute;top:273px;left:258px;white-space:nowrap" class="ft145177"><b>u</b></p>
<p style="position:absolute;top:269px;left:258px;white-space:nowrap" class="ft145177"><b>e</b></p>
<p style="position:absolute;top:266px;left:258px;white-space:nowrap" class="ft145177"><b>s</b></p>
<p style="position:absolute;top:263px;left:258px;white-space:nowrap" class="ft145177"><b>ts</b></p>
<p style="position:absolute;top:257px;left:258px;white-space:nowrap" class="ft145177"><b>/s</b></p>
<p style="position:absolute;top:388px;left:294px;white-space:nowrap" class="ft14519">(a)&#160;Impact&#160;of&#160;Lie-Detector</p>
<p style="position:absolute;top:339px;left:510px;white-space:nowrap" class="ft145162">0</p>
<p style="position:absolute;top:322px;left:503px;white-space:nowrap" class="ft145162">100</p>
<p style="position:absolute;top:304px;left:503px;white-space:nowrap" class="ft145162">200</p>
<p style="position:absolute;top:286px;left:503px;white-space:nowrap" class="ft145162">300</p>
<p style="position:absolute;top:269px;left:503px;white-space:nowrap" class="ft145162">400</p>
<p style="position:absolute;top:251px;left:503px;white-space:nowrap" class="ft145162">500</p>
<p style="position:absolute;top:234px;left:503px;white-space:nowrap" class="ft145162">600</p>
<p style="position:absolute;top:215px;left:503px;white-space:nowrap" class="ft145162">700</p>
<p style="position:absolute;top:198px;left:503px;white-space:nowrap" class="ft145162">800</p>
<p style="position:absolute;top:348px;left:530px;white-space:nowrap" class="ft145162">Linux&#160;Native</p>
<p style="position:absolute;top:348px;left:576px;white-space:nowrap" class="ft145162">Linux&#160;Xen&#160;Unmodified</p>
<p style="position:absolute;top:348px;left:639px;white-space:nowrap" class="ft145162">Linux&#160;Xen&#160;w&#160;ith</p>
<p style="position:absolute;top:356px;left:642px;white-space:nowrap" class="ft145162">Event-Driven</p>
<p style="position:absolute;top:365px;left:647px;white-space:nowrap" class="ft145162">Detection</p>
<p style="position:absolute;top:285px;left:498px;white-space:nowrap" class="ft145177"><b>R</b></p>
<p style="position:absolute;top:280px;left:498px;white-space:nowrap" class="ft145177"><b>e</b></p>
<p style="position:absolute;top:277px;left:498px;white-space:nowrap" class="ft145177"><b>q</b></p>
<p style="position:absolute;top:273px;left:498px;white-space:nowrap" class="ft145177"><b>u</b></p>
<p style="position:absolute;top:269px;left:498px;white-space:nowrap" class="ft145177"><b>e</b></p>
<p style="position:absolute;top:266px;left:498px;white-space:nowrap" class="ft145177"><b>s</b></p>
<p style="position:absolute;top:263px;left:498px;white-space:nowrap" class="ft145177"><b>ts</b></p>
<p style="position:absolute;top:257px;left:498px;white-space:nowrap" class="ft145177"><b>/s</b></p>
<p style="position:absolute;top:388px;left:505px;white-space:nowrap" class="ft14519">(b)&#160;Impact&#160;of&#160;protective&#160;measures</p>
<p style="position:absolute;top:437px;left:226px;white-space:nowrap" class="ft14514">Figure&#160;10.2:&#160;Performance&#160;impact&#160;of&#160;X-Spy&#160;components:&#160;number&#160;of&#160;fulfilled&#160;requests<br/>per&#160;second&#160;in&#160;the&#160;HTTP&#160;benchmark.</p>
<p style="position:absolute;top:503px;left:248px;white-space:nowrap" class="ft1458">As&#160;seen&#160;in&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#145">10.2(b),&#160;</a>the&#160;event-driven&#160;method&#160;results&#160;in&#160;a&#160;performance&#160;loss</p>
<p style="position:absolute;top:521px;left:226px;white-space:nowrap" class="ft14514">of&#160;about&#160;4%.&#160;Compared&#160;with&#160;the&#160;34%&#160;overhead&#160;incurred&#160;by&#160;changing&#160;from&#160;a&#160;service<br/>running&#160;on&#160;a&#160;non-virtualized&#160;platform&#160;to&#160;that&#160;running&#160;on&#160;a&#160;Xen-based&#160;PVM,&#160;the&#160;loss<br/>incurred&#160;by&#160;the&#160;event-driven&#160;approach&#160;is&#160;minor.</p>
<p style="position:absolute;top:603px;left:226px;white-space:nowrap" class="ft14526"><b>10.4</b></p>
<p style="position:absolute;top:603px;left:285px;white-space:nowrap" class="ft145172"><b>Quantifying&#160;the&#160;Impact&#160;of&#160;Virtualization&#160;on&#160;Node<br/>Reliability</b></p>
<p style="position:absolute;top:668px;left:226px;white-space:nowrap" class="ft14514">In&#160;this&#160;section,&#160;we&#160;use&#160;combinatorial&#160;modeling&#160;to&#160;perform&#160;a&#160;reliability&#160;analysis&#160;of&#160;re-<br/>dundant&#160;fault-tolerant&#160;designs&#160;involving&#160;virtualization&#160;on&#160;a&#160;single&#160;physical&#160;node&#160;and<br/>compare&#160;them&#160;with&#160;the&#160;non-virtualized&#160;case.&#160;The&#160;results&#160;of&#160;the&#160;analysis&#160;highlight&#160;the<br/>importance&#160;of&#160;improving&#160;the&#160;reliability&#160;of&#160;the&#160;hypervisor.</p>
<p style="position:absolute;top:739px;left:248px;white-space:nowrap" class="ft1458">We&#160;consider&#160;a&#160;model&#160;in&#160;which&#160;multiple&#160;VMs&#160;run&#160;concurrently&#160;on&#160;the&#160;same&#160;node</p>
<p style="position:absolute;top:757px;left:226px;white-space:nowrap" class="ft14514">and&#160;offer&#160;identical&#160;service.&#160;We&#160;derive&#160;lower&#160;bounds&#160;on&#160;the&#160;VMM&#160;reliability&#160;and&#160;the<br/>number&#160;of&#160;VMs&#160;required&#160;for&#160;the&#160;virtualized&#160;node&#160;in&#160;order&#160;to&#160;have&#160;better&#160;reliability<br/>than&#160;in&#160;the&#160;non-virtualized&#160;case.&#160;We&#160;also&#160;analyze&#160;the&#160;reliability&#160;impact&#160;of&#160;moving&#160;a<br/>functionality&#160;common&#160;to&#160;all&#160;VMs&#160;out&#160;of&#160;the&#160;VMs&#160;and&#160;into&#160;the&#160;VMM.&#160;In&#160;addition,&#160;we<br/>analyze&#160;the&#160;reliability&#160;of&#160;a&#160;redundant&#160;execution&#160;scheme&#160;that&#160;can&#160;tolerate&#160;the&#160;corruption<br/>of&#160;one&#160;out&#160;of&#160;three&#160;VMs&#160;running&#160;on&#160;the&#160;same&#160;physical&#160;host,&#160;and&#160;compare&#160;it&#160;with&#160;the<br/>non-virtualized&#160;case.&#160;Our&#160;results&#160;point&#160;to&#160;the&#160;need&#160;for&#160;careful&#160;modeling&#160;and&#160;analysis<br/>before&#160;a&#160;design&#160;based&#160;on&#160;virtualization&#160;is&#160;used.</p>
<p style="position:absolute;top:901px;left:248px;white-space:nowrap" class="ft1458">Combinatorial&#160;modeling&#160;and&#160;Markov&#160;modeling&#160;are&#160;the&#160;two&#160;main&#160;methods&#160;used&#160;for</p>
<p style="position:absolute;top:919px;left:226px;white-space:nowrap" class="ft14514">reliability&#160;assessment&#160;of&#160;fault-tolerant&#160;designs&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">[58]</a>.&#160;We&#160;chose&#160;combinatorial&#160;modeling<br/>because&#160;its&#160;simplicity&#160;enables&#160;easy&#160;elimination&#160;of&#160;“hopeless”&#160;choices&#160;in&#160;the&#160;early&#160;stage<br/>of&#160;the&#160;design&#160;process.&#160;In&#160;combinatorial&#160;modeling,&#160;a&#160;system&#160;consists&#160;of&#160;series&#160;and&#160;paral-<br/>lel&#160;combinations&#160;of&#160;modules.&#160;The&#160;assumption&#160;is&#160;that&#160;module&#160;failures&#160;are&#160;independent.<br/>In&#160;a&#160;real-world&#160;setting,&#160;where&#160;module&#160;failures&#160;may&#160;not&#160;be&#160;independent,&#160;the&#160;reliability<br/>value&#160;obtained&#160;using&#160;combinatorial&#160;modeling&#160;should&#160;be&#160;taken&#160;as&#160;an&#160;upper&#160;bound&#160;on&#160;the<br/>system&#160;reliability.</p>
<p style="position:absolute;top:1044px;left:248px;white-space:nowrap" class="ft14523"><b>Non-Virtualized&#160;(NV)&#160;Node:&#160;</b>For&#160;our&#160;reliability&#160;assessment,&#160;we&#160;consider&#160;a&#160;non-</p>
<p style="position:absolute;top:1062px;left:226px;white-space:nowrap" class="ft1458">virtualized&#160;single&#160;physical&#160;node&#160;as&#160;the&#160;base&#160;case.&#160;We&#160;model&#160;the&#160;node&#160;using&#160;two&#160;mod-</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft14521">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 146 -->
<a name="146"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft146178{font-size:11px;font-family:Times;color:#000000;}
	.ft146179{font-size:13px;font-family:Times;color:#000000;}
	.ft146180{font-size:6px;font-family:Times;color:#000000;}
	.ft146181{font-size:9px;font-family:Times;color:#000000;}
	.ft146182{font-size:15px;font-family:SVDGWY+CMEX10;color:#231f20;}
	.ft146183{font-size:10px;line-height:12px;font-family:YTDDTT+CMMI7;color:#231f20;}
-->
</style>
<div id="page146-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5146.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1468">144</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft14621">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:273px;left:176px;white-space:nowrap" class="ft146178"><b>Hardware H</b></p>
<p style="position:absolute;top:204px;left:167px;white-space:nowrap" class="ft146178"><b>OS + Application</b></p>
<p style="position:absolute;top:227px;left:198px;white-space:nowrap" class="ft146178"><b>M</b></p>
<p style="position:absolute;top:306px;left:166px;white-space:nowrap" class="ft14619">(a)&#160;Architecture</p>
<p style="position:absolute;top:279px;left:308px;white-space:nowrap" class="ft146179"><b>H</b></p>
<p style="position:absolute;top:279px;left:357px;white-space:nowrap" class="ft146179"><b>M</b></p>
<p style="position:absolute;top:306px;left:277px;white-space:nowrap" class="ft14619">(b)&#160;Combinatorial&#160;Model</p>
<p style="position:absolute;top:348px;left:176px;white-space:nowrap" class="ft1468">Figure&#160;10.3:&#160;Non-virtualized&#160;node</p>
<p style="position:absolute;top:214px;left:463px;white-space:nowrap" class="ft14694"><b>. . .&#160;</b></p>
<p style="position:absolute;top:284px;left:446px;white-space:nowrap" class="ft14694"><b>Hardware H</b></p>
<p style="position:absolute;top:200px;left:482px;white-space:nowrap" class="ft14694"><b>Virtual</b></p>
<p style="position:absolute;top:214px;left:479px;white-space:nowrap" class="ft14694"><b>Machine</b></p>
<p style="position:absolute;top:227px;left:489px;white-space:nowrap" class="ft14694"><b>M</b></p>
<p style="position:absolute;top:229px;left:498px;white-space:nowrap" class="ft146180"><b>n</b></p>
<p style="position:absolute;top:200px;left:429px;white-space:nowrap" class="ft14694"><b>Virtual</b></p>
<p style="position:absolute;top:214px;left:425px;white-space:nowrap" class="ft14694"><b>Machine</b></p>
<p style="position:absolute;top:227px;left:436px;white-space:nowrap" class="ft14694"><b>M</b></p>
<p style="position:absolute;top:229px;left:444px;white-space:nowrap" class="ft146180"><b>1</b></p>
<p style="position:absolute;top:248px;left:441px;white-space:nowrap" class="ft14694"><b>Virtual Machine</b></p>
<p style="position:absolute;top:258px;left:449px;white-space:nowrap" class="ft14694"><b>Monitor V</b></p>
<p style="position:absolute;top:312px;left:429px;white-space:nowrap" class="ft14619">(a)&#160;Architecture</p>
<p style="position:absolute;top:293px;left:628px;white-space:nowrap" class="ft146180"><b>n</b></p>
<p style="position:absolute;top:290px;left:619px;white-space:nowrap" class="ft146181"><b>M</b></p>
<p style="position:absolute;top:252px;left:619px;white-space:nowrap" class="ft146181"><b>M</b></p>
<p style="position:absolute;top:262px;left:622px;white-space:nowrap" class="ft146181"><b>.</b></p>
<p style="position:absolute;top:268px;left:622px;white-space:nowrap" class="ft146181"><b>.</b></p>
<p style="position:absolute;top:274px;left:622px;white-space:nowrap" class="ft146181"><b>.</b></p>
<p style="position:absolute;top:271px;left:550px;white-space:nowrap" class="ft146181"><b>H</b></p>
<p style="position:absolute;top:271px;left:585px;white-space:nowrap" class="ft146181"><b>V</b></p>
<p style="position:absolute;top:255px;left:628px;white-space:nowrap" class="ft146180"><b>1</b></p>
<p style="position:absolute;top:312px;left:527px;white-space:nowrap" class="ft14619">(b)&#160;Combinatorial&#160;Model</p>
<p style="position:absolute;top:346px;left:446px;white-space:nowrap" class="ft1468">Figure&#160;10.4:&#160;Node&#160;with</p>
<p style="position:absolute;top:345px;left:590px;white-space:nowrap" class="ft14646">n</p>
<p style="position:absolute;top:346px;left:603px;white-space:nowrap" class="ft1468">VMs</p>
<p style="position:absolute;top:396px;left:150px;white-space:nowrap" class="ft1468">ules:&#160;hardware&#160;(</p>
<p style="position:absolute;top:395px;left:247px;white-space:nowrap" class="ft14646">H</p>
<p style="position:absolute;top:396px;left:261px;white-space:nowrap" class="ft1468">)&#160;and&#160;the&#160;software&#160;machine&#160;(</p>
<p style="position:absolute;top:395px;left:432px;white-space:nowrap" class="ft14646">M</p>
<p style="position:absolute;top:396px;left:448px;white-space:nowrap" class="ft1468">)&#160;consisting&#160;of&#160;the&#160;operating&#160;system,</p>
<p style="position:absolute;top:414px;left:150px;white-space:nowrap" class="ft14614">middleware,&#160;and&#160;applications&#160;(Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#146">10.3(</a>a))&#160;.&#160;Thus,&#160;the&#160;node&#160;is&#160;a&#160;simple&#160;serial&#160;sys-<br/>tem&#160;consisting&#160;of</p>
<p style="position:absolute;top:431px;left:256px;white-space:nowrap" class="ft14646">H</p>
<p style="position:absolute;top:432px;left:274px;white-space:nowrap" class="ft1468">and</p>
<p style="position:absolute;top:431px;left:299px;white-space:nowrap" class="ft14646">M</p>
<p style="position:absolute;top:432px;left:315px;white-space:nowrap" class="ft1468">,&#160;whose&#160;reliability&#160;is&#160;given&#160;by</p>
<p style="position:absolute;top:431px;left:495px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:429px;left:507px;white-space:nowrap" class="ft14647">N&#160;V</p>
<p style="position:absolute;top:439px;left:507px;white-space:nowrap" class="ft14647">sys</p>
<p style="position:absolute;top:431px;left:532px;white-space:nowrap" class="ft14648">=</p>
<p style="position:absolute;top:431px;left:548px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:437px;left:559px;white-space:nowrap" class="ft14647">H</p>
<p style="position:absolute;top:431px;left:570px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:437px;left:582px;white-space:nowrap" class="ft14647">M</p>
<p style="position:absolute;top:432px;left:595px;white-space:nowrap" class="ft1468">,&#160;where</p>
<p style="position:absolute;top:431px;left:643px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:437px;left:654px;white-space:nowrap" class="ft14647">X</p>
<p style="position:absolute;top:450px;left:150px;white-space:nowrap" class="ft1468">denotes&#160;the&#160;reliability&#160;of&#160;module</p>
<p style="position:absolute;top:449px;left:348px;white-space:nowrap" class="ft14646">X</p>
<p style="position:absolute;top:450px;left:365px;white-space:nowrap" class="ft1468">(Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#146">10.3(</a>b)).</p>
<p style="position:absolute;top:468px;left:172px;white-space:nowrap" class="ft14623"><b>Virtualized&#160;Node&#160;with</b></p>
<p style="position:absolute;top:467px;left:319px;white-space:nowrap" class="ft14646">n</p>
<p style="position:absolute;top:468px;left:333px;white-space:nowrap" class="ft14623"><b>Independent,&#160;Identical&#160;VMs:&#160;</b>Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#146">10.4(</a>a)&#160;shows&#160;a</p>
<p style="position:absolute;top:486px;left:150px;white-space:nowrap" class="ft1468">physical&#160;node&#160;consisting&#160;of</p>
<p style="position:absolute;top:485px;left:319px;white-space:nowrap" class="ft14646">H</p>
<p style="position:absolute;top:486px;left:332px;white-space:nowrap" class="ft1468">,&#160;a&#160;type-1&#160;VMM&#160;(</p>
<p style="position:absolute;top:485px;left:440px;white-space:nowrap" class="ft14646">V</p>
<p style="position:absolute;top:486px;left:453px;white-space:nowrap" class="ft1468">)&#160;that&#160;runs&#160;directly&#160;on&#160;the&#160;hardware</p>
<p style="position:absolute;top:504px;left:150px;white-space:nowrap" class="ft1468">(such&#160;a&#160;VMM&#160;is&#160;referred&#160;to&#160;as&#160;a&#160;<i>hypervisor</i>),&#160;and&#160;one&#160;or&#160;more&#160;VMs&#160;(</p>
<p style="position:absolute;top:503px;left:555px;white-space:nowrap" class="ft14650">{</p>
<p style="position:absolute;top:503px;left:563px;white-space:nowrap" class="ft14646">M</p>
<p style="position:absolute;top:509px;left:578px;white-space:nowrap" class="ft14647">i</p>
<p style="position:absolute;top:503px;left:582px;white-space:nowrap" class="ft14650">}</p>
<p style="position:absolute;top:503px;left:590px;white-space:nowrap" class="ft14646">,&#160;i</p>
<p style="position:absolute;top:503px;left:606px;white-space:nowrap" class="ft14650">≥</p>
<p style="position:absolute;top:503px;left:622px;white-space:nowrap" class="ft14648">1</p>
<p style="position:absolute;top:504px;left:629px;white-space:nowrap" class="ft1468">).&#160;The</p>
<p style="position:absolute;top:522px;left:150px;white-space:nowrap" class="ft14614">VMs&#160;provide&#160;identical&#160;service&#160;concurrently&#160;and&#160;independently&#160;(i.e.,&#160;without&#160;the&#160;need<br/>for&#160;strong&#160;synchronization).&#160;For&#160;example,&#160;each&#160;VM&#160;could&#160;be&#160;a&#160;virtual&#160;server&#160;answering<br/>client&#160;requests&#160;for&#160;static&#160;web&#160;content.&#160;Thus,&#160;the&#160;node&#160;is&#160;a&#160;series-parallel&#160;system&#160;(Fig-<br/>ure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#146">10.4(</a>b))&#160;whose&#160;overall&#160;reliability&#160;is&#160;given&#160;by</p>
<p style="position:absolute;top:574px;left:439px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:573px;left:451px;white-space:nowrap" class="ft14647">n</p>
<p style="position:absolute;top:582px;left:451px;white-space:nowrap" class="ft14647">sys</p>
<p style="position:absolute;top:574px;left:473px;white-space:nowrap" class="ft14648">=</p>
<p style="position:absolute;top:574px;left:489px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:580px;left:500px;white-space:nowrap" class="ft14647">H</p>
<p style="position:absolute;top:574px;left:512px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:580px;left:523px;white-space:nowrap" class="ft14647">V</p>
<p style="position:absolute;top:574px;left:533px;white-space:nowrap" class="ft14648">[1</p>
<p style="position:absolute;top:574px;left:547px;white-space:nowrap" class="ft14650">−</p>
<p style="position:absolute;top:574px;left:561px;white-space:nowrap" class="ft146182">Q</p>
<p style="position:absolute;top:571px;left:575px;white-space:nowrap" class="ft146183">n<br/>i</p>
<p style="position:absolute;top:583px;left:579px;white-space:nowrap" class="ft14672">=0</p>
<p style="position:absolute;top:574px;left:595px;white-space:nowrap" class="ft14648">(1</p>
<p style="position:absolute;top:574px;left:610px;white-space:nowrap" class="ft14650">−</p>
<p style="position:absolute;top:574px;left:624px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:580px;left:635px;white-space:nowrap" class="ft14647">M</p>
<p style="position:absolute;top:584px;left:646px;white-space:nowrap" class="ft14690">i</p>
<p style="position:absolute;top:574px;left:652px;white-space:nowrap" class="ft14648">)]</p>
<p style="position:absolute;top:575px;left:662px;white-space:nowrap" class="ft1468">.</p>
<p style="position:absolute;top:593px;left:150px;white-space:nowrap" class="ft14615">Here,&#160;we&#160;consider&#160;the&#160;reliability&#160;of&#160;the&#160;hardware&#160;to&#160;be&#160;the&#160;same&#160;as&#160;that&#160;in&#160;the&#160;non-<br/>virtualized&#160;case&#160;because&#160;the&#160;underlying&#160;hardware&#160;is&#160;the&#160;same&#160;in&#160;both&#160;cases.&#160;An&#160;obvious<br/>concern&#160;is&#160;whether&#160;the&#160;hardware&#160;in&#160;the&#160;virtualized&#160;node&#160;will&#160;register&#160;a&#160;significant&#160;drop<br/>in&#160;reliability&#160;due&#160;to&#160;load/stress&#160;compared&#160;with&#160;the&#160;non-virtualized&#160;node.&#160;However,&#160;this<br/>concern&#160;does&#160;not&#160;apply&#160;to&#160;our&#160;context&#160;of&#160;application&#160;servers&#160;in&#160;a&#160;data&#160;center,&#160;in&#160;which<br/>typical&#160;hardware&#160;utilization&#160;in&#160;a&#160;non-virtualized&#160;node&#160;is&#160;abysmally&#160;low&#160;(less&#160;than&#160;5%)<br/>and</p>
<p style="position:absolute;top:700px;left:175px;white-space:nowrap" class="ft14646">n</p>
<p style="position:absolute;top:701px;left:188px;white-space:nowrap" class="ft1468">is&#160;typically&#160;in&#160;the&#160;low&#160;tens&#160;of&#160;VMs.</p>
<p style="position:absolute;top:719px;left:172px;white-space:nowrap" class="ft1468">The&#160;condition&#160;for&#160;the</p>
<p style="position:absolute;top:718px;left:318px;white-space:nowrap" class="ft14646">n</p>
<p style="position:absolute;top:719px;left:327px;white-space:nowrap" class="ft1468">-replicated&#160;service&#160;to&#160;be&#160;more&#160;reliable&#160;than&#160;the&#160;non-</p>
<p style="position:absolute;top:737px;left:150px;white-space:nowrap" class="ft1468">virtualized&#160;service&#160;is&#160;given&#160;by</p>
<p style="position:absolute;top:736px;left:339px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:734px;left:350px;white-space:nowrap" class="ft14647">n</p>
<p style="position:absolute;top:743px;left:350px;white-space:nowrap" class="ft14647">sys</p>
<p style="position:absolute;top:736px;left:375px;white-space:nowrap" class="ft14646">&gt;&#160;R</p>
<p style="position:absolute;top:734px;left:405px;white-space:nowrap" class="ft14647">N&#160;V</p>
<p style="position:absolute;top:743px;left:404px;white-space:nowrap" class="ft14647">sys</p>
<p style="position:absolute;top:737px;left:426px;white-space:nowrap" class="ft1468">.&#160;i.e.,</p>
<p style="position:absolute;top:736px;left:465px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:742px;left:476px;white-space:nowrap" class="ft14647">H</p>
<p style="position:absolute;top:736px;left:488px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:742px;left:499px;white-space:nowrap" class="ft14647">V</p>
<p style="position:absolute;top:736px;left:510px;white-space:nowrap" class="ft14648">[1</p>
<p style="position:absolute;top:736px;left:525px;white-space:nowrap" class="ft14650">−</p>
<p style="position:absolute;top:735px;left:541px;white-space:nowrap" class="ft146182">Q</p>
<p style="position:absolute;top:732px;left:555px;white-space:nowrap" class="ft146183">n<br/>i</p>
<p style="position:absolute;top:744px;left:560px;white-space:nowrap" class="ft14672">=0</p>
<p style="position:absolute;top:736px;left:576px;white-space:nowrap" class="ft14648">(1</p>
<p style="position:absolute;top:736px;left:593px;white-space:nowrap" class="ft14650">−</p>
<p style="position:absolute;top:736px;left:609px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:742px;left:620px;white-space:nowrap" class="ft14647">M</p>
<p style="position:absolute;top:746px;left:632px;white-space:nowrap" class="ft14690">i</p>
<p style="position:absolute;top:736px;left:637px;white-space:nowrap" class="ft14648">)]</p>
<p style="position:absolute;top:736px;left:654px;white-space:nowrap" class="ft14646">&gt;</p>
<p style="position:absolute;top:754px;left:150px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:760px;left:161px;white-space:nowrap" class="ft14647">H</p>
<p style="position:absolute;top:754px;left:172px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:760px;left:184px;white-space:nowrap" class="ft14647">M</p>
<p style="position:absolute;top:755px;left:197px;white-space:nowrap" class="ft1468">.&#160;For&#160;simplicity,&#160;let</p>
<p style="position:absolute;top:754px;left:320px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:760px;left:332px;white-space:nowrap" class="ft14647">M</p>
<p style="position:absolute;top:763px;left:343px;white-space:nowrap" class="ft14690">i</p>
<p style="position:absolute;top:754px;left:355px;white-space:nowrap" class="ft14648">=</p>
<p style="position:absolute;top:754px;left:372px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:760px;left:383px;white-space:nowrap" class="ft14647">M</p>
<p style="position:absolute;top:755px;left:401px;white-space:nowrap" class="ft1468">for&#160;all</p>
<p style="position:absolute;top:754px;left:443px;white-space:nowrap" class="ft14648">1</p>
<p style="position:absolute;top:754px;left:456px;white-space:nowrap" class="ft14650">≤</p>
<p style="position:absolute;top:754px;left:474px;white-space:nowrap" class="ft14646">i</p>
<p style="position:absolute;top:754px;left:485px;white-space:nowrap" class="ft14650">≤</p>
<p style="position:absolute;top:754px;left:502px;white-space:nowrap" class="ft14646">n</p>
<p style="position:absolute;top:755px;left:511px;white-space:nowrap" class="ft1468">.&#160;This&#160;is&#160;a&#160;reasonable&#160;as-</p>
<p style="position:absolute;top:773px;left:150px;white-space:nowrap" class="ft1468">sumption,&#160;as&#160;each&#160;VM&#160;has&#160;the&#160;same&#160;functionality&#160;as&#160;the&#160;software&#160;machine</p>
<p style="position:absolute;top:772px;left:610px;white-space:nowrap" class="ft14646">M</p>
<p style="position:absolute;top:773px;left:631px;white-space:nowrap" class="ft1468">in&#160;the</p>
<p style="position:absolute;top:791px;left:150px;white-space:nowrap" class="ft1468">non-virtualized&#160;case.&#160;Then,&#160;the&#160;above&#160;condition&#160;becomes</p>
<p style="position:absolute;top:826px;left:320px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:831px;left:332px;white-space:nowrap" class="ft14647">V</p>
<p style="position:absolute;top:826px;left:342px;white-space:nowrap" class="ft14648">[1</p>
<p style="position:absolute;top:826px;left:357px;white-space:nowrap" class="ft14650">−</p>
<p style="position:absolute;top:826px;left:372px;white-space:nowrap" class="ft14648">(1</p>
<p style="position:absolute;top:826px;left:389px;white-space:nowrap" class="ft14650">−</p>
<p style="position:absolute;top:826px;left:404px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:831px;left:415px;white-space:nowrap" class="ft14647">M</p>
<p style="position:absolute;top:826px;left:428px;white-space:nowrap" class="ft14648">)</p>
<p style="position:absolute;top:823px;left:434px;white-space:nowrap" class="ft14647">n</p>
<p style="position:absolute;top:826px;left:442px;white-space:nowrap" class="ft14648">]</p>
<p style="position:absolute;top:826px;left:450px;white-space:nowrap" class="ft14646">&gt;&#160;R</p>
<p style="position:absolute;top:831px;left:478px;white-space:nowrap" class="ft14647">M</p>
<p style="position:absolute;top:826px;left:491px;white-space:nowrap" class="ft14646">.</p>
<p style="position:absolute;top:827px;left:629px;white-space:nowrap" class="ft1468">(10.1)</p>
<p style="position:absolute;top:853px;left:172px;white-space:nowrap" class="ft1468">Inequality&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#146">(10.1)&#160;</a>immediately&#160;yields&#160;two&#160;conclusions.&#160;First,&#160;if</p>
<p style="position:absolute;top:852px;left:555px;white-space:nowrap" class="ft14646">n</p>
<p style="position:absolute;top:852px;left:570px;white-space:nowrap" class="ft14648">=&#160;1</p>
<p style="position:absolute;top:853px;left:595px;white-space:nowrap" class="ft1468">,&#160;then&#160;again</p>
<p style="position:absolute;top:871px;left:150px;white-space:nowrap" class="ft1468">the&#160;above&#160;condition&#160;does&#160;not&#160;hold&#160;(</p>
<p style="position:absolute;top:870px;left:365px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:876px;left:376px;white-space:nowrap" class="ft14647">V</p>
<p style="position:absolute;top:870px;left:392px;white-space:nowrap" class="ft14646">&lt;</p>
<p style="position:absolute;top:870px;left:410px;white-space:nowrap" class="ft14648">1</p>
<p style="position:absolute;top:871px;left:417px;white-space:nowrap" class="ft1468">).&#160;What&#160;this&#160;means&#160;is&#160;that&#160;it&#160;is&#160;necessary</p>
<p style="position:absolute;top:889px;left:150px;white-space:nowrap" class="ft14615">to&#160;have&#160;some&#160;additional&#160;coordination&#160;mechanism&#160;or&#160;protocol&#160;built&#160;into&#160;the&#160;system&#160;to<br/>compensate&#160;for&#160;the&#160;reliability&#160;lost&#160;by&#160;the&#160;introduction&#160;of&#160;the&#160;hypervisor.&#160;In&#160;the&#160;absence<br/>of&#160;such&#160;a&#160;mechanism/protocol,&#160;simply&#160;adding&#160;a&#160;hypervisor&#160;layer&#160;to&#160;a&#160;node&#160;will&#160;only<br/>decrease&#160;node&#160;reliability.&#160;Second,&#160;if</p>
<p style="position:absolute;top:942px;left:366px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:948px;left:378px;white-space:nowrap" class="ft14647">V</p>
<p style="position:absolute;top:942px;left:392px;white-space:nowrap" class="ft14648">=</p>
<p style="position:absolute;top:942px;left:408px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:948px;left:419px;white-space:nowrap" class="ft14647">M</p>
<p style="position:absolute;top:943px;left:433px;white-space:nowrap" class="ft1468">,&#160;then&#160;it&#160;is&#160;obvious&#160;that&#160;above&#160;condition</p>
<p style="position:absolute;top:961px;left:150px;white-space:nowrap" class="ft1468">does&#160;not&#160;hold.</p>
<p style="position:absolute;top:979px;left:172px;white-space:nowrap" class="ft1468">It&#160;is&#160;clear&#160;that&#160;the&#160;<i>hypervisor&#160;has&#160;to&#160;be&#160;more&#160;reliable&#160;than&#160;the&#160;individual&#160;VMs</i>.&#160;The</p>
<p style="position:absolute;top:997px;left:150px;white-space:nowrap" class="ft1468">interesting&#160;question&#160;is&#160;how&#160;much&#160;more&#160;reliable.&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#147">10.5&#160;</a>shows&#160;that&#160;for&#160;a&#160;fixed</p>
<p style="position:absolute;top:1014px;left:150px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:1020px;left:161px;white-space:nowrap" class="ft14647">M</p>
<p style="position:absolute;top:1015px;left:179px;white-space:nowrap" class="ft1468">value,&#160;the&#160;hypervisor&#160;has&#160;to&#160;be&#160;more&#160;reliable&#160;when&#160;deploying&#160;fewer&#160;VMs.&#160;The</p>
<p style="position:absolute;top:1033px;left:150px;white-space:nowrap" class="ft1468">graph&#160;also&#160;shows&#160;that,&#160;for&#160;fixed&#160;values&#160;of</p>
<p style="position:absolute;top:1032px;left:403px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:1038px;left:414px;white-space:nowrap" class="ft14647">M</p>
<p style="position:absolute;top:1033px;left:432px;white-space:nowrap" class="ft1468">and</p>
<p style="position:absolute;top:1032px;left:458px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:1038px;left:469px;white-space:nowrap" class="ft14647">V</p>
<p style="position:absolute;top:1033px;left:480px;white-space:nowrap" class="ft1468">,&#160;there&#160;exists&#160;a&#160;lower&#160;bound&#160;on</p>
<p style="position:absolute;top:1050px;left:150px;white-space:nowrap" class="ft14646">n</p>
<p style="position:absolute;top:1051px;left:164px;white-space:nowrap" class="ft1468">below&#160;which&#160;the&#160;virtualized&#160;node&#160;reliability&#160;will&#160;definitely&#160;be&#160;lower&#160;than&#160;that&#160;of&#160;a</p>
<p style="position:absolute;top:1069px;left:150px;white-space:nowrap" class="ft1468">non-virtualized&#160;node.&#160;For&#160;example,&#160;when</p>
<p style="position:absolute;top:1068px;left:408px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:1074px;left:419px;white-space:nowrap" class="ft14647">M</p>
<p style="position:absolute;top:1069px;left:437px;white-space:nowrap" class="ft1468">=&#160;0.1&#160;and</p>
<p style="position:absolute;top:1068px;left:500px;white-space:nowrap" class="ft14646">R</p>
<p style="position:absolute;top:1074px;left:512px;white-space:nowrap" class="ft14647">V</p>
<p style="position:absolute;top:1069px;left:527px;white-space:nowrap" class="ft1468">=&#160;0.3,&#160;deploying&#160;fewer</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft14621">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 147 -->
<a name="147"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft147184{font-size:8px;font-family:Helvetica;color:#000000;-moz-transform: matrix(         0,         -1,          1,          0, 0, 0);-webkit-transform: matrix(         0,         -1,          1,          0, 0, 0);-o-transform: matrix(         0,         -1,          1,          0, 0, 0);-ms-transform: matrix(         0,         -1,          1,          0, 0, 0);-moz-transform-origin: left 75%;-webkit-transform-origin: left 75%;-o-transform-origin: left 75%;-ms-transform-origin: left 75%;}
	.ft147185{font-size:6px;font-family:Helvetica;color:#000000;-moz-transform: matrix(         0,         -1,          1,          0, 0, 0);-webkit-transform: matrix(         0,         -1,          1,          0, 0, 0);-o-transform: matrix(         0,         -1,          1,          0, 0, 0);-ms-transform: matrix(         0,         -1,          1,          0, 0, 0);-moz-transform-origin: left 75%;-webkit-transform-origin: left 75%;-o-transform-origin: left 75%;-ms-transform-origin: left 75%;}
	.ft147186{font-size:8px;line-height:7px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page147-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5147.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1478">CHAPTER&#160;10.&#160;TOWARDS&#160;DEPENDABILITY&#160;AND&#160;ATTACK&#160;RESISTANCE&#160;145</p>
<p style="position:absolute;top:335px;left:256px;white-space:nowrap" class="ft14744">&#160;0.1</p>
<p style="position:absolute;top:321px;left:256px;white-space:nowrap" class="ft14744">&#160;0.2</p>
<p style="position:absolute;top:306px;left:256px;white-space:nowrap" class="ft14744">&#160;0.3</p>
<p style="position:absolute;top:292px;left:256px;white-space:nowrap" class="ft14744">&#160;0.4</p>
<p style="position:absolute;top:277px;left:256px;white-space:nowrap" class="ft14744">&#160;0.5</p>
<p style="position:absolute;top:263px;left:256px;white-space:nowrap" class="ft14744">&#160;0.6</p>
<p style="position:absolute;top:248px;left:256px;white-space:nowrap" class="ft14744">&#160;0.7</p>
<p style="position:absolute;top:234px;left:256px;white-space:nowrap" class="ft14744">&#160;0.8</p>
<p style="position:absolute;top:220px;left:256px;white-space:nowrap" class="ft14744">&#160;0.9</p>
<p style="position:absolute;top:205px;left:262px;white-space:nowrap" class="ft14744">&#160;1</p>
<p style="position:absolute;top:343px;left:267px;white-space:nowrap" class="ft14744">&#160;0.1&#160;&#160;0.2&#160;&#160;0.3&#160;&#160;0.4&#160;&#160;0.5&#160;&#160;0.6&#160;&#160;0.7&#160;&#160;0.8&#160;&#160;0.9</p>
<p style="position:absolute;top:343px;left:442px;white-space:nowrap" class="ft14744">&#160;1</p>
<p style="position:absolute;top:314px;left:236px;white-space:nowrap" class="ft147184">Lower Bound on Reliability&#160;</p>
<p style="position:absolute;top:300px;left:243px;white-space:nowrap" class="ft147184">&#160;of Hypervisor (R</p>
<p style="position:absolute;top:243px;left:246px;white-space:nowrap" class="ft147185">V</p>
<p style="position:absolute;top:238px;left:243px;white-space:nowrap" class="ft147184">)</p>
<p style="position:absolute;top:354px;left:301px;white-space:nowrap" class="ft14744">Reliability of Virtual Machine (R</p>
<p style="position:absolute;top:357px;left:409px;white-space:nowrap" class="ft147162">M</p>
<p style="position:absolute;top:354px;left:414px;white-space:nowrap" class="ft14744">)</p>
<p style="position:absolute;top:211px;left:283px;white-space:nowrap" class="ft147186">n=2<br/>n=3<br/>n=4<br/>n=8</p>
<p style="position:absolute;top:242px;left:279px;white-space:nowrap" class="ft147186">n=16<br/>n=32</p>
<p style="position:absolute;top:384px;left:226px;white-space:nowrap" class="ft14714">Figure&#160;10.5:&#160;Lower&#160;bound&#160;on&#160;the&#160;hy-<br/>pervisor&#160;reliability&#160;for&#160;a&#160;physical&#160;node<br/>with</p>
<p style="position:absolute;top:419px;left:259px;white-space:nowrap" class="ft14746">n</p>
<p style="position:absolute;top:420px;left:275px;white-space:nowrap" class="ft1478">independent&#160;and&#160;concurrently</p>
<p style="position:absolute;top:438px;left:226px;white-space:nowrap" class="ft14715">operating&#160;VMs&#160;providing&#160;identical&#160;ser-<br/>vice.</p>
<p style="position:absolute;top:325px;left:533px;white-space:nowrap" class="ft14744">&#160;0</p>
<p style="position:absolute;top:307px;left:529px;white-space:nowrap" class="ft14744">&#160;10</p>
<p style="position:absolute;top:288px;left:529px;white-space:nowrap" class="ft14744">&#160;20</p>
<p style="position:absolute;top:270px;left:529px;white-space:nowrap" class="ft14744">&#160;30</p>
<p style="position:absolute;top:251px;left:529px;white-space:nowrap" class="ft14744">&#160;40</p>
<p style="position:absolute;top:232px;left:529px;white-space:nowrap" class="ft14744">&#160;50</p>
<p style="position:absolute;top:214px;left:529px;white-space:nowrap" class="ft14744">&#160;60</p>
<p style="position:absolute;top:195px;left:529px;white-space:nowrap" class="ft14744">&#160;70</p>
<p style="position:absolute;top:333px;left:538px;white-space:nowrap" class="ft14744">&#160;0.1</p>
<p style="position:absolute;top:333px;left:558px;white-space:nowrap" class="ft14744">&#160;0.2</p>
<p style="position:absolute;top:333px;left:579px;white-space:nowrap" class="ft14744">&#160;0.3</p>
<p style="position:absolute;top:333px;left:599px;white-space:nowrap" class="ft14744">&#160;0.4</p>
<p style="position:absolute;top:333px;left:620px;white-space:nowrap" class="ft14744">&#160;0.5</p>
<p style="position:absolute;top:333px;left:640px;white-space:nowrap" class="ft14744">&#160;0.6</p>
<p style="position:absolute;top:333px;left:661px;white-space:nowrap" class="ft14744">&#160;0.7</p>
<p style="position:absolute;top:333px;left:681px;white-space:nowrap" class="ft14744">&#160;0.8</p>
<p style="position:absolute;top:333px;left:701px;white-space:nowrap" class="ft14744">&#160;0.9</p>
<p style="position:absolute;top:333px;left:725px;white-space:nowrap" class="ft14744">&#160;1</p>
<p style="position:absolute;top:320px;left:520px;white-space:nowrap" class="ft147184">Lower Bound on Number of VMs (n)</p>
<p style="position:absolute;top:344px;left:579px;white-space:nowrap" class="ft14744">Reliability of Virtual Machine (R</p>
<p style="position:absolute;top:347px;left:686px;white-space:nowrap" class="ft147162">M</p>
<p style="position:absolute;top:344px;left:691px;white-space:nowrap" class="ft14744">)</p>
<p style="position:absolute;top:201px;left:664px;white-space:nowrap" class="ft14744">R = 0.98</p>
<p style="position:absolute;top:209px;left:660px;white-space:nowrap" class="ft14744">R = 0.998</p>
<p style="position:absolute;top:374px;left:510px;white-space:nowrap" class="ft14715">Figure&#160;10.6:&#160;Lower&#160;bound&#160;on&#160;the&#160;num-<br/>ber&#160;of&#160;VMs&#160;to&#160;achieve&#160;desired&#160;reliabil-<br/>ity</p>
<p style="position:absolute;top:409px;left:532px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:410px;left:549px;white-space:nowrap" class="ft1478">for&#160;a&#160;physical&#160;node&#160;with</p>
<p style="position:absolute;top:409px;left:710px;white-space:nowrap" class="ft14746">n</p>
<p style="position:absolute;top:410px;left:725px;white-space:nowrap" class="ft1478">in-</p>
<p style="position:absolute;top:428px;left:510px;white-space:nowrap" class="ft14714">dependent&#160;and&#160;concurrently&#160;operating<br/>VMs&#160;providing&#160;identical&#160;service&#160;when</p>
<p style="position:absolute;top:463px;left:510px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:468px;left:521px;white-space:nowrap" class="ft14747">V</p>
<p style="position:absolute;top:463px;left:536px;white-space:nowrap" class="ft14748">=&#160;0</p>
<p style="position:absolute;top:463px;left:559px;white-space:nowrap" class="ft14746">.</p>
<p style="position:absolute;top:463px;left:563px;white-space:nowrap" class="ft14748">999</p>
<p style="position:absolute;top:464px;left:586px;white-space:nowrap" class="ft1478">.</p>
<p style="position:absolute;top:511px;left:226px;white-space:nowrap" class="ft14715">than&#160;4&#160;VMs&#160;would&#160;only&#160;lower&#160;the&#160;node&#160;reliability.&#160;This&#160;is&#160;a&#160;useful&#160;result,&#160;as&#160;in&#160;many<br/>practical&#160;settings,</p>
<p style="position:absolute;top:528px;left:336px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:533px;left:348px;white-space:nowrap" class="ft14747">M</p>
<p style="position:absolute;top:529px;left:366px;white-space:nowrap" class="ft1478">and</p>
<p style="position:absolute;top:528px;left:392px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:533px;left:403px;white-space:nowrap" class="ft14747">V</p>
<p style="position:absolute;top:529px;left:418px;white-space:nowrap" class="ft1478">values&#160;may&#160;be&#160;fixed,&#160;e.g.,&#160;when&#160;the&#160;hypervisor,&#160;guest</p>
<p style="position:absolute;top:547px;left:226px;white-space:nowrap" class="ft14714">OS,&#160;and&#160;application&#160;are&#160;commercial&#160;off-the-shelf&#160;(COTS)&#160;components&#160;with&#160;no&#160;source-<br/>code&#160;access.</p>
<p style="position:absolute;top:582px;left:248px;white-space:nowrap" class="ft1478">The&#160;equation&#160;for</p>
<p style="position:absolute;top:581px;left:349px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:580px;left:361px;white-space:nowrap" class="ft14747">n</p>
<p style="position:absolute;top:589px;left:361px;white-space:nowrap" class="ft14747">sys</p>
<p style="position:absolute;top:582px;left:382px;white-space:nowrap" class="ft1478">also&#160;suggests&#160;that&#160;by&#160;increasing&#160;the&#160;number&#160;of&#160;VMs,&#160;the&#160;node</p>
<p style="position:absolute;top:600px;left:226px;white-space:nowrap" class="ft14714">reliability&#160;can&#160;be&#160;made&#160;as&#160;close&#160;to&#160;the&#160;hypervisor&#160;reliability&#160;as&#160;desired.&#160;Suppose&#160;we<br/>desire&#160;the&#160;node&#160;reliability&#160;to&#160;be</p>
<p style="position:absolute;top:617px;left:411px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:618px;left:423px;white-space:nowrap" class="ft1478">,&#160;where</p>
<p style="position:absolute;top:617px;left:469px;white-space:nowrap" class="ft14746">R&#160;&lt;&#160;R</p>
<p style="position:absolute;top:623px;left:512px;white-space:nowrap" class="ft14747">V</p>
<p style="position:absolute;top:618px;left:522px;white-space:nowrap" class="ft1478">.&#160;Then,</p>
<p style="position:absolute;top:617px;left:568px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:617px;left:584px;white-space:nowrap" class="ft14748">=</p>
<p style="position:absolute;top:617px;left:599px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:623px;left:611px;white-space:nowrap" class="ft14747">H</p>
<p style="position:absolute;top:617px;left:622px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:623px;left:633px;white-space:nowrap" class="ft14747">V</p>
<p style="position:absolute;top:617px;left:644px;white-space:nowrap" class="ft14748">[1</p>
<p style="position:absolute;top:617px;left:656px;white-space:nowrap" class="ft14750">−</p>
<p style="position:absolute;top:617px;left:669px;white-space:nowrap" class="ft14748">(1</p>
<p style="position:absolute;top:617px;left:683px;white-space:nowrap" class="ft14750">−</p>
<p style="position:absolute;top:617px;left:695px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:623px;left:707px;white-space:nowrap" class="ft14747">M</p>
<p style="position:absolute;top:617px;left:720px;white-space:nowrap" class="ft14748">)</p>
<p style="position:absolute;top:615px;left:726px;white-space:nowrap" class="ft14747">n</p>
<p style="position:absolute;top:617px;left:734px;white-space:nowrap" class="ft14748">]</p>
<p style="position:absolute;top:618px;left:738px;white-space:nowrap" class="ft1478">.</p>
<p style="position:absolute;top:636px;left:226px;white-space:nowrap" class="ft1478">Assume&#160;that&#160;the&#160;hardware&#160;is&#160;highly&#160;reliable,&#160;i.e.,</p>
<p style="position:absolute;top:635px;left:525px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:641px;left:537px;white-space:nowrap" class="ft14747">H</p>
<p style="position:absolute;top:635px;left:553px;white-space:nowrap" class="ft14750">≃</p>
<p style="position:absolute;top:635px;left:571px;white-space:nowrap" class="ft14748">1</p>
<p style="position:absolute;top:636px;left:578px;white-space:nowrap" class="ft1478">.&#160;Then,&#160;the&#160;above&#160;equation</p>
<p style="position:absolute;top:654px;left:226px;white-space:nowrap" class="ft1478">becomes&#160;the&#160;inequality,</p>
<p style="position:absolute;top:671px;left:248px;white-space:nowrap" class="ft14746">R&#160;&lt;&#160;R</p>
<p style="position:absolute;top:677px;left:291px;white-space:nowrap" class="ft14747">V</p>
<p style="position:absolute;top:671px;left:302px;white-space:nowrap" class="ft14748">[1</p>
<p style="position:absolute;top:671px;left:316px;white-space:nowrap" class="ft14750">−</p>
<p style="position:absolute;top:671px;left:332px;white-space:nowrap" class="ft14748">(1</p>
<p style="position:absolute;top:671px;left:348px;white-space:nowrap" class="ft14750">−</p>
<p style="position:absolute;top:671px;left:363px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:677px;left:374px;white-space:nowrap" class="ft14747">M</p>
<p style="position:absolute;top:671px;left:388px;white-space:nowrap" class="ft14748">)</p>
<p style="position:absolute;top:669px;left:393px;white-space:nowrap" class="ft14747">n</p>
<p style="position:absolute;top:671px;left:402px;white-space:nowrap" class="ft14748">]</p>
<p style="position:absolute;top:689px;left:226px;white-space:nowrap" class="ft14748">=</p>
<p style="position:absolute;top:689px;left:235px;white-space:nowrap" class="ft14750">⇒</p>
<p style="position:absolute;top:689px;left:254px;white-space:nowrap" class="ft14748">(1</p>
<p style="position:absolute;top:689px;left:271px;white-space:nowrap" class="ft14750">−</p>
<p style="position:absolute;top:689px;left:285px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:695px;left:297px;white-space:nowrap" class="ft14747">M</p>
<p style="position:absolute;top:689px;left:310px;white-space:nowrap" class="ft14748">)</p>
<p style="position:absolute;top:687px;left:316px;white-space:nowrap" class="ft14747">n</p>
<p style="position:absolute;top:689px;left:328px;white-space:nowrap" class="ft14746">&lt;</p>
<p style="position:absolute;top:689px;left:344px;white-space:nowrap" class="ft14748">1</p>
<p style="position:absolute;top:689px;left:355px;white-space:nowrap" class="ft14750">−</p>
<p style="position:absolute;top:687px;left:376px;white-space:nowrap" class="ft14747">R</p>
<p style="position:absolute;top:698px;left:372px;white-space:nowrap" class="ft14747">R</p>
<p style="position:absolute;top:702px;left:381px;white-space:nowrap" class="ft14790">V</p>
<p style="position:absolute;top:710px;left:226px;white-space:nowrap" class="ft14748">=</p>
<p style="position:absolute;top:710px;left:235px;white-space:nowrap" class="ft14750">⇒</p>
<p style="position:absolute;top:710px;left:254px;white-space:nowrap" class="ft14746">n.</p>
<p style="position:absolute;top:710px;left:270px;white-space:nowrap" class="ft14748">log(1</p>
<p style="position:absolute;top:710px;left:306px;white-space:nowrap" class="ft14750">−</p>
<p style="position:absolute;top:710px;left:321px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:716px;left:332px;white-space:nowrap" class="ft14747">M</p>
<p style="position:absolute;top:710px;left:345px;white-space:nowrap" class="ft14748">)</p>
<p style="position:absolute;top:710px;left:355px;white-space:nowrap" class="ft14746">&lt;</p>
<p style="position:absolute;top:710px;left:371px;white-space:nowrap" class="ft14748">log(1</p>
<p style="position:absolute;top:710px;left:407px;white-space:nowrap" class="ft14750">−</p>
<p style="position:absolute;top:708px;left:428px;white-space:nowrap" class="ft14747">R</p>
<p style="position:absolute;top:719px;left:424px;white-space:nowrap" class="ft14747">R</p>
<p style="position:absolute;top:723px;left:433px;white-space:nowrap" class="ft14790">V</p>
<p style="position:absolute;top:710px;left:444px;white-space:nowrap" class="ft14748">)</p>
<p style="position:absolute;top:729px;left:226px;white-space:nowrap" class="ft1478">Dividing&#160;by</p>
<p style="position:absolute;top:728px;left:301px;white-space:nowrap" class="ft14748">log(1</p>
<p style="position:absolute;top:728px;left:337px;white-space:nowrap" class="ft14750">−</p>
<p style="position:absolute;top:728px;left:352px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:734px;left:363px;white-space:nowrap" class="ft14747">M</p>
<p style="position:absolute;top:728px;left:377px;white-space:nowrap" class="ft14748">)</p>
<p style="position:absolute;top:729px;left:383px;white-space:nowrap" class="ft1478">,&#160;a&#160;negative&#160;number,&#160;we&#160;obtain,</p>
<p style="position:absolute;top:773px;left:425px;white-space:nowrap" class="ft14746">n&#160;&gt;</p>
<p style="position:absolute;top:761px;left:457px;white-space:nowrap" class="ft14748">log(1</p>
<p style="position:absolute;top:761px;left:493px;white-space:nowrap" class="ft14750">−</p>
<p style="position:absolute;top:758px;left:514px;white-space:nowrap" class="ft14747">R</p>
<p style="position:absolute;top:769px;left:510px;white-space:nowrap" class="ft14747">R</p>
<p style="position:absolute;top:773px;left:519px;white-space:nowrap" class="ft14790">V</p>
<p style="position:absolute;top:761px;left:530px;white-space:nowrap" class="ft14748">)</p>
<p style="position:absolute;top:783px;left:456px;white-space:nowrap" class="ft14748">log(1</p>
<p style="position:absolute;top:783px;left:491px;white-space:nowrap" class="ft14750">−</p>
<p style="position:absolute;top:783px;left:506px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:789px;left:518px;white-space:nowrap" class="ft14747">M</p>
<p style="position:absolute;top:783px;left:531px;white-space:nowrap" class="ft14748">)</p>
<p style="position:absolute;top:773px;left:539px;white-space:nowrap" class="ft14746">.</p>
<p style="position:absolute;top:774px;left:706px;white-space:nowrap" class="ft1478">(10.2)</p>
<p style="position:absolute;top:809px;left:248px;white-space:nowrap" class="ft1478">Inequality&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#147">(10.2)&#160;</a>gives&#160;a&#160;lower&#160;bound&#160;on&#160;the&#160;number&#160;of&#160;VMs&#160;required&#160;for&#160;a&#160;virtu-</p>
<p style="position:absolute;top:827px;left:226px;white-space:nowrap" class="ft14715">alized&#160;physical&#160;node&#160;to&#160;meet&#160;a&#160;given&#160;reliability&#160;requirement.&#160;In&#160;practice,&#160;the&#160;number<br/>of&#160;VMs&#160;that&#160;can&#160;be&#160;hosted&#160;on&#160;a&#160;physical&#160;node&#160;is&#160;ultimately&#160;limited&#160;by&#160;the&#160;resources<br/>available&#160;on&#160;that&#160;node.&#160;Comparing&#160;the&#160;lower&#160;bound&#160;with&#160;the&#160;number&#160;of&#160;VMs&#160;that&#160;can<br/>possibly&#160;be&#160;co-hosted&#160;provides&#160;an&#160;easy&#160;way&#160;of&#160;eliminating&#160;certain&#160;choices&#160;early&#160;in&#160;the<br/>design&#160;process.</p>
<p style="position:absolute;top:916px;left:248px;white-space:nowrap" class="ft1478">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#147">10.6&#160;</a>shows&#160;the&#160;lower&#160;bound&#160;for</p>
<p style="position:absolute;top:915px;left:499px;white-space:nowrap" class="ft14746">n</p>
<p style="position:absolute;top:916px;left:514px;white-space:nowrap" class="ft1478">for&#160;two&#160;different</p>
<p style="position:absolute;top:915px;left:622px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:916px;left:639px;white-space:nowrap" class="ft1478">values&#160;(0.98&#160;and</p>
<p style="position:absolute;top:934px;left:226px;white-space:nowrap" class="ft1478">0.998)&#160;as&#160;the&#160;VM&#160;reliability&#160;(</p>
<p style="position:absolute;top:933px;left:400px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:939px;left:411px;white-space:nowrap" class="ft14747">M</p>
<p style="position:absolute;top:934px;left:424px;white-space:nowrap" class="ft1478">)&#160;is&#160;increased&#160;from&#160;roughly&#160;0.1&#160;to&#160;1.0,&#160;with&#160;the&#160;hyper-</p>
<p style="position:absolute;top:952px;left:226px;white-space:nowrap" class="ft1478">visor&#160;reliability&#160;fixed&#160;at</p>
<p style="position:absolute;top:951px;left:372px;white-space:nowrap" class="ft14748">0</p>
<p style="position:absolute;top:951px;left:380px;white-space:nowrap" class="ft14746">.</p>
<p style="position:absolute;top:951px;left:384px;white-space:nowrap" class="ft14748">999</p>
<p style="position:absolute;top:952px;left:407px;white-space:nowrap" class="ft1478">.&#160;The&#160;figure&#160;shows&#160;that&#160;for&#160;fixed</p>
<p style="position:absolute;top:951px;left:608px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:957px;left:619px;white-space:nowrap" class="ft14747">V</p>
<p style="position:absolute;top:952px;left:634px;white-space:nowrap" class="ft1478">and</p>
<p style="position:absolute;top:951px;left:660px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:957px;left:671px;white-space:nowrap" class="ft14747">M</p>
<p style="position:absolute;top:952px;left:689px;white-space:nowrap" class="ft1478">values,&#160;a</p>
<p style="position:absolute;top:970px;left:226px;white-space:nowrap" class="ft1478">higher&#160;system&#160;reliability&#160;(up&#160;to</p>
<p style="position:absolute;top:969px;left:413px;white-space:nowrap" class="ft14746">R</p>
<p style="position:absolute;top:975px;left:425px;white-space:nowrap" class="ft14747">V</p>
<p style="position:absolute;top:970px;left:435px;white-space:nowrap" class="ft1478">)&#160;can&#160;be&#160;obtained&#160;by&#160;increasing&#160;the&#160;number&#160;of&#160;VMs</p>
<p style="position:absolute;top:988px;left:226px;white-space:nowrap" class="ft1478">hosted.&#160;However,&#160;when</p>
<p style="position:absolute;top:987px;left:369px;white-space:nowrap" class="ft14746">n</p>
<p style="position:absolute;top:988px;left:382px;white-space:nowrap" class="ft1478">is&#160;large,&#160;one&#160;is&#160;faced&#160;with&#160;the&#160;practical&#160;difficulty&#160;of&#160;obtaining</p>
<p style="position:absolute;top:1006px;left:226px;white-space:nowrap" class="ft1478">sufficient&#160;diversity&#160;to&#160;ensure&#160;that&#160;VM&#160;failures&#160;are&#160;independent.</p>
<p style="position:absolute;top:1024px;left:248px;white-space:nowrap" class="ft14723"><b>Moving&#160;Functionality&#160;out&#160;of&#160;the&#160;VMs&#160;into&#160;the&#160;Hypervisor:&#160;</b>We&#160;now&#160;analyze&#160;the</p>
<p style="position:absolute;top:1042px;left:226px;white-space:nowrap" class="ft14714">reliability&#160;impact&#160;of&#160;moving&#160;a&#160;functionality&#160;out&#160;of&#160;the&#160;VMs&#160;and&#160;into&#160;the&#160;hypervisor.<br/>As&#160;before,&#160;our&#160;system&#160;model&#160;is&#160;one&#160;in&#160;which&#160;a&#160;physical&#160;node&#160;has</p>
<p style="position:absolute;top:1059px;left:625px;white-space:nowrap" class="ft14746">n</p>
<p style="position:absolute;top:1059px;left:640px;white-space:nowrap" class="ft14750">≥</p>
<p style="position:absolute;top:1059px;left:657px;white-space:nowrap" class="ft14748">1</p>
<p style="position:absolute;top:1060px;left:669px;white-space:nowrap" class="ft1478">independent</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft14721">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 148 -->
<a name="148"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft148187{font-size:12px;font-family:Times;color:#000000;}
	.ft148188{font-size:7px;font-family:CNTUYP+CMSY5;color:#231f20;}
	.ft148189{font-size:7px;font-family:IQOCZL+CMR5;color:#231f20;}
-->
</style>
<div id="page148-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5148.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1488">146</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft14821">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:196px;left:355px;white-space:nowrap" class="ft14894"><b>’</b></p>
<p style="position:absolute;top:199px;left:342px;white-space:nowrap" class="ft148187"><b>M</b></p>
<p style="position:absolute;top:204px;left:355px;white-space:nowrap" class="ft14894"><b>1</b></p>
<p style="position:absolute;top:214px;left:330px;white-space:nowrap" class="ft148187"><b>.</b></p>
<p style="position:absolute;top:220px;left:330px;white-space:nowrap" class="ft148187"><b>.</b></p>
<p style="position:absolute;top:226px;left:330px;white-space:nowrap" class="ft148187"><b>.</b></p>
<p style="position:absolute;top:226px;left:213px;white-space:nowrap" class="ft148187"><b>H</b></p>
<p style="position:absolute;top:226px;left:262px;white-space:nowrap" class="ft148187"><b>V</b></p>
<p style="position:absolute;top:253px;left:314px;white-space:nowrap" class="ft148187"><b>f</b></p>
<p style="position:absolute;top:199px;left:314px;white-space:nowrap" class="ft148187"><b>f</b></p>
<p style="position:absolute;top:253px;left:342px;white-space:nowrap" class="ft148187"><b>M</b></p>
<p style="position:absolute;top:258px;left:355px;white-space:nowrap" class="ft14894"><b>n</b></p>
<p style="position:absolute;top:249px;left:355px;white-space:nowrap" class="ft14894"><b>’</b></p>
<p style="position:absolute;top:280px;left:167px;white-space:nowrap" class="ft14819">(a)&#160;Configuration</p>
<p style="position:absolute;top:279px;left:256px;white-space:nowrap" class="ft14879">C</p>
<p style="position:absolute;top:283px;left:265px;white-space:nowrap" class="ft14876">1</p>
<p style="position:absolute;top:280px;left:271px;white-space:nowrap" class="ft14819">:&#160;Functionality</p>
<p style="position:absolute;top:279px;left:348px;white-space:nowrap" class="ft14879">f</p>
<p style="position:absolute;top:280px;left:359px;white-space:nowrap" class="ft14819">imple-</p>
<p style="position:absolute;top:294px;left:167px;white-space:nowrap" class="ft14819">mented&#160;within&#160;each&#160;VM</p>
<p style="position:absolute;top:196px;left:613px;white-space:nowrap" class="ft14894"><b>’</b></p>
<p style="position:absolute;top:199px;left:600px;white-space:nowrap" class="ft148187"><b>M</b></p>
<p style="position:absolute;top:204px;left:613px;white-space:nowrap" class="ft14894"><b>1</b></p>
<p style="position:absolute;top:214px;left:604px;white-space:nowrap" class="ft148187"><b>.</b></p>
<p style="position:absolute;top:220px;left:604px;white-space:nowrap" class="ft148187"><b>.</b></p>
<p style="position:absolute;top:226px;left:604px;white-space:nowrap" class="ft148187"><b>.</b></p>
<p style="position:absolute;top:226px;left:470px;white-space:nowrap" class="ft148187"><b>H</b></p>
<p style="position:absolute;top:226px;left:520px;white-space:nowrap" class="ft148187"><b>V</b></p>
<p style="position:absolute;top:253px;left:600px;white-space:nowrap" class="ft148187"><b>M</b></p>
<p style="position:absolute;top:258px;left:613px;white-space:nowrap" class="ft14894"><b>n</b></p>
<p style="position:absolute;top:226px;left:555px;white-space:nowrap" class="ft148187"><b>F</b></p>
<p style="position:absolute;top:249px;left:613px;white-space:nowrap" class="ft14894"><b>’</b></p>
<p style="position:absolute;top:280px;left:425px;white-space:nowrap" class="ft14819">(b)&#160;Configuration</p>
<p style="position:absolute;top:279px;left:514px;white-space:nowrap" class="ft14879">C</p>
<p style="position:absolute;top:283px;left:523px;white-space:nowrap" class="ft14876">2</p>
<p style="position:absolute;top:280px;left:529px;white-space:nowrap" class="ft14819">:&#160;Functionality</p>
<p style="position:absolute;top:279px;left:604px;white-space:nowrap" class="ft14879">F</p>
<p style="position:absolute;top:280px;left:617px;white-space:nowrap" class="ft14819">imple-</p>
<p style="position:absolute;top:294px;left:425px;white-space:nowrap" class="ft14819">mented&#160;as&#160;part&#160;of&#160;Hypervisor</p>
<p style="position:absolute;top:328px;left:200px;white-space:nowrap" class="ft1488">Figure&#160;10.7:&#160;Moving&#160;functionality&#160;out&#160;of&#160;the&#160;VMs&#160;into&#160;the&#160;hypervisor</p>
<p style="position:absolute;top:376px;left:150px;white-space:nowrap" class="ft1488">and&#160;concurrently&#160;operating&#160;VMs&#160;providing&#160;identical&#160;service.&#160;Consider&#160;a&#160;functionality</p>
<p style="position:absolute;top:375px;left:656px;white-space:nowrap" class="ft14846">f</p>
<p style="position:absolute;top:394px;left:150px;white-space:nowrap" class="ft1488">implemented&#160;inside&#160;each&#160;VM.&#160;Then,&#160;each&#160;VM</p>
<p style="position:absolute;top:393px;left:427px;white-space:nowrap" class="ft14846">M</p>
<p style="position:absolute;top:399px;left:441px;white-space:nowrap" class="ft14847">i</p>
<p style="position:absolute;top:394px;left:449px;white-space:nowrap" class="ft1488">can&#160;be&#160;divided&#160;into&#160;two&#160;components,</p>
<p style="position:absolute;top:411px;left:150px;white-space:nowrap" class="ft14846">f</p>
<p style="position:absolute;top:412px;left:163px;white-space:nowrap" class="ft1488">and</p>
<p style="position:absolute;top:411px;left:190px;white-space:nowrap" class="ft14846">M</p>
<p style="position:absolute;top:408px;left:206px;white-space:nowrap" class="ft148188">′</p>
<p style="position:absolute;top:419px;left:204px;white-space:nowrap" class="ft14847">i</p>
<p style="position:absolute;top:412px;left:210px;white-space:nowrap" class="ft1488">,&#160;the&#160;latter&#160;representing&#160;the&#160;rest&#160;of</p>
<p style="position:absolute;top:411px;left:422px;white-space:nowrap" class="ft14846">M</p>
<p style="position:absolute;top:417px;left:436px;white-space:nowrap" class="ft14847">i</p>
<p style="position:absolute;top:412px;left:441px;white-space:nowrap" class="ft1488">.&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#148">10.7(</a>a)&#160;shows&#160;the&#160;reliability</p>
<p style="position:absolute;top:430px;left:150px;white-space:nowrap" class="ft1488">model&#160;for&#160;a&#160;node&#160;containing</p>
<p style="position:absolute;top:429px;left:332px;white-space:nowrap" class="ft14846">n</p>
<p style="position:absolute;top:430px;left:347px;white-space:nowrap" class="ft1488">such&#160;VMs.&#160;Let&#160;us&#160;call&#160;this&#160;node&#160;configuration</p>
<p style="position:absolute;top:429px;left:644px;white-space:nowrap" class="ft14846">C</p>
<p style="position:absolute;top:435px;left:655px;white-space:nowrap" class="ft14872">1</p>
<p style="position:absolute;top:430px;left:662px;white-space:nowrap" class="ft1488">.</p>
<p style="position:absolute;top:448px;left:150px;white-space:nowrap" class="ft1488">Further,&#160;suppose&#160;that&#160;the&#160;functionality</p>
<p style="position:absolute;top:447px;left:385px;white-space:nowrap" class="ft14846">f</p>
<p style="position:absolute;top:448px;left:398px;white-space:nowrap" class="ft1488">is&#160;moved&#160;out&#160;of&#160;the&#160;VMs&#160;and&#160;substituted&#160;by</p>
<p style="position:absolute;top:466px;left:150px;white-space:nowrap" class="ft1488">component</p>
<p style="position:absolute;top:465px;left:220px;white-space:nowrap" class="ft14846">F</p>
<p style="position:absolute;top:466px;left:235px;white-space:nowrap" class="ft1488">implemented&#160;as&#160;part&#160;of&#160;the&#160;hypervisor.&#160;Now,&#160;the&#160;new&#160;hypervisor&#160;consists</p>
<p style="position:absolute;top:484px;left:150px;white-space:nowrap" class="ft1488">of&#160;two&#160;components</p>
<p style="position:absolute;top:483px;left:271px;white-space:nowrap" class="ft14846">F</p>
<p style="position:absolute;top:484px;left:287px;white-space:nowrap" class="ft1488">and&#160;the&#160;old&#160;hypervisor</p>
<p style="position:absolute;top:483px;left:428px;white-space:nowrap" class="ft14846">V</p>
<p style="position:absolute;top:484px;left:440px;white-space:nowrap" class="ft1488">.&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#148">10.7(</a>b)&#160;shows&#160;the&#160;reliability</p>
<p style="position:absolute;top:502px;left:150px;white-space:nowrap" class="ft1488">model&#160;for&#160;a&#160;node&#160;with&#160;the&#160;modified&#160;hypervisor.&#160;Let&#160;us&#160;call&#160;this&#160;node&#160;configuration</p>
<p style="position:absolute;top:501px;left:643px;white-space:nowrap" class="ft14846">C</p>
<p style="position:absolute;top:507px;left:654px;white-space:nowrap" class="ft14872">2</p>
<p style="position:absolute;top:502px;left:661px;white-space:nowrap" class="ft1488">.</p>
<p style="position:absolute;top:520px;left:172px;white-space:nowrap" class="ft1488">We&#160;now&#160;derive&#160;the&#160;condition&#160;for</p>
<p style="position:absolute;top:519px;left:370px;white-space:nowrap" class="ft14846">C</p>
<p style="position:absolute;top:525px;left:380px;white-space:nowrap" class="ft14872">2</p>
<p style="position:absolute;top:520px;left:391px;white-space:nowrap" class="ft1488">to&#160;be&#160;at&#160;least&#160;as&#160;reliable&#160;as</p>
<p style="position:absolute;top:519px;left:552px;white-space:nowrap" class="ft14846">C</p>
<p style="position:absolute;top:525px;left:563px;white-space:nowrap" class="ft14872">1</p>
<p style="position:absolute;top:520px;left:570px;white-space:nowrap" class="ft1488">.&#160;For&#160;simplicity,</p>
<p style="position:absolute;top:538px;left:150px;white-space:nowrap" class="ft1488">let&#160;us&#160;assume&#160;that</p>
<p style="position:absolute;top:537px;left:259px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:545px;left:271px;white-space:nowrap" class="ft14847">M</p>
<p style="position:absolute;top:543px;left:283px;white-space:nowrap" class="ft148188">′</p>
<p style="position:absolute;top:551px;left:282px;white-space:nowrap" class="ft14890">i</p>
<p style="position:absolute;top:537px;left:293px;white-space:nowrap" class="ft14848">=</p>
<p style="position:absolute;top:537px;left:309px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:543px;left:320px;white-space:nowrap" class="ft14847">M</p>
<p style="position:absolute;top:543px;left:332px;white-space:nowrap" class="ft148188">′</p>
<p style="position:absolute;top:538px;left:341px;white-space:nowrap" class="ft1488">for&#160;all</p>
<p style="position:absolute;top:537px;left:381px;white-space:nowrap" class="ft14848">1</p>
<p style="position:absolute;top:537px;left:393px;white-space:nowrap" class="ft14850">≤</p>
<p style="position:absolute;top:537px;left:408px;white-space:nowrap" class="ft14846">i</p>
<p style="position:absolute;top:537px;left:418px;white-space:nowrap" class="ft14850">≤</p>
<p style="position:absolute;top:537px;left:433px;white-space:nowrap" class="ft14846">n</p>
<p style="position:absolute;top:538px;left:442px;white-space:nowrap" class="ft1488">.&#160;Then,&#160;the&#160;desired&#160;condition&#160;is</p>
<p style="position:absolute;top:559px;left:150px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:558px;left:161px;white-space:nowrap" class="ft14847">C</p>
<p style="position:absolute;top:561px;left:170px;white-space:nowrap" class="ft148189">2</p>
<p style="position:absolute;top:567px;left:161px;white-space:nowrap" class="ft14847">sys</p>
<p style="position:absolute;top:559px;left:184px;white-space:nowrap" class="ft14850">≥</p>
<p style="position:absolute;top:559px;left:200px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:558px;left:211px;white-space:nowrap" class="ft14847">C</p>
<p style="position:absolute;top:561px;left:220px;white-space:nowrap" class="ft148189">1</p>
<p style="position:absolute;top:567px;left:211px;white-space:nowrap" class="ft14847">sys</p>
<p style="position:absolute;top:595px;left:150px;white-space:nowrap" class="ft14848">=</p>
<p style="position:absolute;top:595px;left:159px;white-space:nowrap" class="ft14850">⇒</p>
<p style="position:absolute;top:595px;left:178px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:601px;left:189px;white-space:nowrap" class="ft14847">H</p>
<p style="position:absolute;top:595px;left:201px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:601px;left:212px;white-space:nowrap" class="ft14847">V</p>
<p style="position:absolute;top:595px;left:222px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:601px;left:234px;white-space:nowrap" class="ft14847">F</p>
<p style="position:absolute;top:595px;left:244px;white-space:nowrap" class="ft14848">[1</p>
<p style="position:absolute;top:595px;left:259px;white-space:nowrap" class="ft14850">−</p>
<p style="position:absolute;top:595px;left:274px;white-space:nowrap" class="ft14848">(1</p>
<p style="position:absolute;top:595px;left:290px;white-space:nowrap" class="ft14850">−</p>
<p style="position:absolute;top:595px;left:305px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:601px;left:317px;white-space:nowrap" class="ft14847">M</p>
<p style="position:absolute;top:601px;left:329px;white-space:nowrap" class="ft148188">′</p>
<p style="position:absolute;top:595px;left:334px;white-space:nowrap" class="ft14848">)</p>
<p style="position:absolute;top:593px;left:340px;white-space:nowrap" class="ft14847">n</p>
<p style="position:absolute;top:595px;left:348px;white-space:nowrap" class="ft14848">]</p>
<p style="position:absolute;top:595px;left:356px;white-space:nowrap" class="ft14850">≥</p>
<p style="position:absolute;top:595px;left:372px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:601px;left:383px;white-space:nowrap" class="ft14847">H</p>
<p style="position:absolute;top:595px;left:395px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:601px;left:406px;white-space:nowrap" class="ft14847">V</p>
<p style="position:absolute;top:595px;left:416px;white-space:nowrap" class="ft14848">[1</p>
<p style="position:absolute;top:595px;left:431px;white-space:nowrap" class="ft14850">−</p>
<p style="position:absolute;top:595px;left:446px;white-space:nowrap" class="ft14848">(1</p>
<p style="position:absolute;top:595px;left:463px;white-space:nowrap" class="ft14850">−</p>
<p style="position:absolute;top:595px;left:478px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:601px;left:489px;white-space:nowrap" class="ft14847">f</p>
<p style="position:absolute;top:595px;left:497px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:601px;left:508px;white-space:nowrap" class="ft14847">M</p>
<p style="position:absolute;top:601px;left:521px;white-space:nowrap" class="ft148188">′</p>
<p style="position:absolute;top:595px;left:525px;white-space:nowrap" class="ft14848">)</p>
<p style="position:absolute;top:593px;left:531px;white-space:nowrap" class="ft14847">n</p>
<p style="position:absolute;top:595px;left:539px;white-space:nowrap" class="ft14848">]</p>
<p style="position:absolute;top:636px;left:305px;white-space:nowrap" class="ft14848">=</p>
<p style="position:absolute;top:636px;left:315px;white-space:nowrap" class="ft14850">⇒</p>
<p style="position:absolute;top:636px;left:334px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:642px;left:345px;white-space:nowrap" class="ft14847">F</p>
<p style="position:absolute;top:636px;left:359px;white-space:nowrap" class="ft14850">≥</p>
<p style="position:absolute;top:626px;left:377px;white-space:nowrap" class="ft14848">[1</p>
<p style="position:absolute;top:626px;left:391px;white-space:nowrap" class="ft14850">−</p>
<p style="position:absolute;top:626px;left:406px;white-space:nowrap" class="ft14848">(1</p>
<p style="position:absolute;top:626px;left:423px;white-space:nowrap" class="ft14850">−</p>
<p style="position:absolute;top:626px;left:438px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:632px;left:449px;white-space:nowrap" class="ft14847">f</p>
<p style="position:absolute;top:626px;left:457px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:632px;left:469px;white-space:nowrap" class="ft14847">M</p>
<p style="position:absolute;top:632px;left:481px;white-space:nowrap" class="ft148188">′</p>
<p style="position:absolute;top:626px;left:486px;white-space:nowrap" class="ft14848">)</p>
<p style="position:absolute;top:624px;left:492px;white-space:nowrap" class="ft14847">n</p>
<p style="position:absolute;top:626px;left:500px;white-space:nowrap" class="ft14848">]</p>
<p style="position:absolute;top:646px;left:386px;white-space:nowrap" class="ft14848">[1</p>
<p style="position:absolute;top:646px;left:401px;white-space:nowrap" class="ft14850">−</p>
<p style="position:absolute;top:646px;left:416px;white-space:nowrap" class="ft14848">(1</p>
<p style="position:absolute;top:646px;left:433px;white-space:nowrap" class="ft14850">−</p>
<p style="position:absolute;top:646px;left:448px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:652px;left:459px;white-space:nowrap" class="ft14847">M</p>
<p style="position:absolute;top:652px;left:471px;white-space:nowrap" class="ft148188">′</p>
<p style="position:absolute;top:646px;left:476px;white-space:nowrap" class="ft14848">)</p>
<p style="position:absolute;top:645px;left:482px;white-space:nowrap" class="ft14847">n</p>
<p style="position:absolute;top:646px;left:490px;white-space:nowrap" class="ft14848">]</p>
<p style="position:absolute;top:636px;left:506px;white-space:nowrap" class="ft14846">.</p>
<p style="position:absolute;top:637px;left:629px;white-space:nowrap" class="ft1488">(10.3)</p>
<p style="position:absolute;top:671px;left:172px;white-space:nowrap" class="ft1488">It&#160;is&#160;easy&#160;to&#160;see&#160;from&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#148">10.7&#160;</a>that&#160;if&#160;there&#160;is&#160;only&#160;one&#160;VM,&#160;it&#160;does&#160;not&#160;matter</p>
<p style="position:absolute;top:689px;left:150px;white-space:nowrap" class="ft14814">whether&#160;the&#160;functionality&#160;is&#160;implemented&#160;in&#160;the&#160;hypervisor&#160;or&#160;in&#160;the&#160;VM.&#160;We&#160;can&#160;also<br/>confirm&#160;this&#160;observation&#160;by&#160;substituting</p>
<p style="position:absolute;top:706px;left:391px;white-space:nowrap" class="ft14846">n</p>
<p style="position:absolute;top:706px;left:404px;white-space:nowrap" class="ft14848">=&#160;1</p>
<p style="position:absolute;top:707px;left:431px;white-space:nowrap" class="ft1488">in&#160;inequality&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#148">(10.3)</a>.</p>
<p style="position:absolute;top:725px;left:172px;white-space:nowrap" class="ft1488">Figures&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#149">10.8(</a>a)&#160;and&#160;(b)&#160;illustrate&#160;how</p>
<p style="position:absolute;top:724px;left:402px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:730px;left:413px;white-space:nowrap" class="ft14847">F</p>
<p style="position:absolute;top:725px;left:428px;white-space:nowrap" class="ft1488">varies&#160;as</p>
<p style="position:absolute;top:724px;left:484px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:730px;left:495px;white-space:nowrap" class="ft14847">f</p>
<p style="position:absolute;top:725px;left:507px;white-space:nowrap" class="ft1488">is&#160;increased&#160;from&#160;0.1&#160;to&#160;1.</p>
<p style="position:absolute;top:743px;left:150px;white-space:nowrap" class="ft1488">The&#160;graphs&#160;show&#160;that&#160;for&#160;configuration</p>
<p style="position:absolute;top:742px;left:393px;white-space:nowrap" class="ft14846">C</p>
<p style="position:absolute;top:748px;left:404px;white-space:nowrap" class="ft14872">2</p>
<p style="position:absolute;top:743px;left:415px;white-space:nowrap" class="ft1488">to&#160;be&#160;more&#160;reliable&#160;than</p>
<p style="position:absolute;top:742px;left:567px;white-space:nowrap" class="ft14846">C</p>
<p style="position:absolute;top:748px;left:578px;white-space:nowrap" class="ft14872">1</p>
<p style="position:absolute;top:743px;left:584px;white-space:nowrap" class="ft1488">,</p>
<p style="position:absolute;top:742px;left:593px;white-space:nowrap" class="ft14846">F</p>
<p style="position:absolute;top:743px;left:610px;white-space:nowrap" class="ft1488">has&#160;to&#160;be</p>
<p style="position:absolute;top:761px;left:150px;white-space:nowrap" class="ft1488">more&#160;reliable&#160;than</p>
<p style="position:absolute;top:760px;left:262px;white-space:nowrap" class="ft14846">f</p>
<p style="position:absolute;top:761px;left:271px;white-space:nowrap" class="ft1488">.&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#149">10.8(</a>a)&#160;shows&#160;that&#160;as</p>
<p style="position:absolute;top:760px;left:451px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:766px;left:462px;white-space:nowrap" class="ft14847">M</p>
<p style="position:absolute;top:766px;left:475px;white-space:nowrap" class="ft148188">′</p>
<p style="position:absolute;top:761px;left:483px;white-space:nowrap" class="ft1488">increases,&#160;the&#160;degree&#160;by&#160;which</p>
<p style="position:absolute;top:778px;left:150px;white-space:nowrap" class="ft14846">F</p>
<p style="position:absolute;top:779px;left:165px;white-space:nowrap" class="ft1488">should&#160;be&#160;more&#160;reliable&#160;than</p>
<p style="position:absolute;top:778px;left:335px;white-space:nowrap" class="ft14846">f</p>
<p style="position:absolute;top:779px;left:347px;white-space:nowrap" class="ft1488">also&#160;increases.&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#149">10.8(</a>b)&#160;shows&#160;that&#160;the&#160;degree&#160;is</p>
<p style="position:absolute;top:797px;left:150px;white-space:nowrap" class="ft14814">also&#160;considerably&#160;higher&#160;when&#160;more&#160;VMs&#160;are&#160;co-hosted&#160;on&#160;the&#160;same&#160;physical&#160;host.&#160;For<br/>example,&#160;even&#160;with&#160;modest</p>
<p style="position:absolute;top:814px;left:316px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:820px;left:327px;white-space:nowrap" class="ft14847">M</p>
<p style="position:absolute;top:820px;left:339px;white-space:nowrap" class="ft148188">′</p>
<p style="position:absolute;top:815px;left:348px;white-space:nowrap" class="ft1488">and</p>
<p style="position:absolute;top:814px;left:373px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:820px;left:384px;white-space:nowrap" class="ft14847">f</p>
<p style="position:absolute;top:815px;left:396px;white-space:nowrap" class="ft1488">values&#160;of&#160;0.75,</p>
<p style="position:absolute;top:814px;left:487px;white-space:nowrap" class="ft14846">F</p>
<p style="position:absolute;top:815px;left:502px;white-space:nowrap" class="ft1488">has&#160;to&#160;be&#160;ultra-reliable:</p>
<p style="position:absolute;top:814px;left:644px;white-space:nowrap" class="ft14846">R</p>
<p style="position:absolute;top:820px;left:655px;white-space:nowrap" class="ft14847">F</p>
<p style="position:absolute;top:833px;left:150px;white-space:nowrap" class="ft1488">has&#160;to&#160;be&#160;more&#160;than&#160;0.9932&#160;and&#160;0.9994&#160;if</p>
<p style="position:absolute;top:832px;left:402px;white-space:nowrap" class="ft14846">n</p>
<p style="position:absolute;top:832px;left:416px;white-space:nowrap" class="ft14848">=&#160;6</p>
<p style="position:absolute;top:833px;left:444px;white-space:nowrap" class="ft1488">and</p>
<p style="position:absolute;top:832px;left:469px;white-space:nowrap" class="ft14846">n</p>
<p style="position:absolute;top:832px;left:483px;white-space:nowrap" class="ft14848">=&#160;9</p>
<p style="position:absolute;top:833px;left:507px;white-space:nowrap" class="ft1488">,&#160;respectively.&#160;Thus,&#160;when</p>
<p style="position:absolute;top:851px;left:150px;white-space:nowrap" class="ft14814">more&#160;than&#160;a&#160;handful&#160;of&#160;VMs&#160;are&#160;co-hosted&#160;on&#160;the&#160;same&#160;physical&#160;node,&#160;a&#160;better&#160;system<br/>reliability&#160;is&#160;more&#160;likely&#160;to&#160;be&#160;obtained&#160;by&#160;retaining&#160;a&#160;poorly&#160;reliable&#160;functionality&#160;in<br/>the&#160;VM&#160;rather&#160;than&#160;by&#160;moving&#160;the&#160;functionality&#160;into&#160;the&#160;hypervisor.</p>
<p style="position:absolute;top:905px;left:172px;white-space:nowrap" class="ft14823"><b>Virtualized&#160;Node&#160;with&#160;VMM-level&#160;Voting:&#160;</b>Consider&#160;a&#160;fault-tolerant&#160;2-out-of-3</p>
<p style="position:absolute;top:922px;left:150px;white-space:nowrap" class="ft14815">replication&#160;scheme&#160;in&#160;which&#160;three&#160;VMs&#160;providing&#160;identical&#160;service&#160;are&#160;co-hosted&#160;on&#160;a<br/>single&#160;physical&#160;node.&#160;The&#160;VMM&#160;layer&#160;receives&#160;client&#160;requests&#160;and&#160;forwards&#160;them&#160;to&#160;all<br/>three&#160;VMs&#160;in&#160;the&#160;same&#160;order.&#160;Assume&#160;that&#160;the&#160;service&#160;is&#160;a&#160;deterministic&#160;state&#160;machine;<br/>thus,&#160;the&#160;VM&#160;replicas&#160;yield&#160;the&#160;same&#160;result&#160;for&#160;the&#160;same&#160;request.&#160;The&#160;VMM&#160;receives&#160;the<br/>results&#160;from&#160;the&#160;VM&#160;replicas.&#160;Once&#160;the&#160;VMM&#160;has&#160;obtained&#160;replies&#160;from&#160;two&#160;replicas<br/>with&#160;identical&#160;result&#160;values&#160;for&#160;a&#160;given&#160;client&#160;request,&#160;it&#160;forwards&#160;the&#160;result&#160;value&#160;to<br/>the&#160;corresponding&#160;client.&#160;Such&#160;a&#160;scheme&#160;can&#160;tolerate&#160;the&#160;arbitrary&#160;failure&#160;of&#160;one&#160;VM<br/>replica,&#160;and&#160;is&#160;similar&#160;to&#160;the&#160;one&#160;suggested&#160;in&#160;the&#160;RESH&#160;architecture&#160;for&#160;fault-tolerant<br/>replication&#160;using&#160;virtualization&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">[92]</a>.&#160;Assuming&#160;that&#160;the&#160;VMs&#160;fail&#160;independently,&#160;the</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft14821">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 149 -->
<a name="149"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft149190{font-size:9px;font-family:Helvetica;color:#000000;-moz-transform: matrix(         0,         -1,          1,          0, 0, 0);-webkit-transform: matrix(         0,         -1,          1,          0, 0, 0);-o-transform: matrix(         0,         -1,          1,          0, 0, 0);-ms-transform: matrix(         0,         -1,          1,          0, 0, 0);-moz-transform-origin: left 75%;-webkit-transform-origin: left 75%;-o-transform-origin: left 75%;-ms-transform-origin: left 75%;}
	.ft149191{font-size:7px;font-family:Helvetica;color:#000000;-moz-transform: matrix(         0,         -1,          1,          0, 0, 0);-webkit-transform: matrix(         0,         -1,          1,          0, 0, 0);-o-transform: matrix(         0,         -1,          1,          0, 0, 0);-ms-transform: matrix(         0,         -1,          1,          0, 0, 0);-moz-transform-origin: left 75%;-webkit-transform-origin: left 75%;-o-transform-origin: left 75%;-ms-transform-origin: left 75%;}
	.ft149192{font-size:15px;line-height:20px;font-family:FEJUEM+CMR10;color:#231f20;}
-->
</style>
<div id="page149-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5149.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1498">CHAPTER&#160;10.&#160;TOWARDS&#160;DEPENDABILITY&#160;AND&#160;ATTACK&#160;RESISTANCE&#160;147</p>
<p style="position:absolute;top:341px;left:272px;white-space:nowrap" class="ft14943">&#160;0.2</p>
<p style="position:absolute;top:323px;left:272px;white-space:nowrap" class="ft14943">&#160;0.3</p>
<p style="position:absolute;top:305px;left:272px;white-space:nowrap" class="ft14943">&#160;0.4</p>
<p style="position:absolute;top:287px;left:272px;white-space:nowrap" class="ft14943">&#160;0.5</p>
<p style="position:absolute;top:268px;left:272px;white-space:nowrap" class="ft14943">&#160;0.6</p>
<p style="position:absolute;top:250px;left:272px;white-space:nowrap" class="ft14943">&#160;0.7</p>
<p style="position:absolute;top:232px;left:272px;white-space:nowrap" class="ft14943">&#160;0.8</p>
<p style="position:absolute;top:214px;left:272px;white-space:nowrap" class="ft14943">&#160;0.9</p>
<p style="position:absolute;top:196px;left:279px;white-space:nowrap" class="ft14943">&#160;1</p>
<p style="position:absolute;top:350px;left:284px;white-space:nowrap" class="ft14943">&#160;0.1&#160;&#160;0.2&#160;&#160;0.3&#160;&#160;0.4&#160;&#160;0.5&#160;&#160;0.6&#160;&#160;0.7&#160;&#160;0.8&#160;&#160;0.9</p>
<p style="position:absolute;top:350px;left:471px;white-space:nowrap" class="ft14943">&#160;1</p>
<p style="position:absolute;top:318px;left:241px;white-space:nowrap" class="ft149190">Lower Bound on Reliability&#160;</p>
<p style="position:absolute;top:309px;left:250px;white-space:nowrap" class="ft149190">&#160;of Functionality when&#160;</p>
<p style="position:absolute;top:316px;left:258px;white-space:nowrap" class="ft149190">&#160;Moved to Hypervisor (R</p>
<p style="position:absolute;top:224px;left:260px;white-space:nowrap" class="ft149191">F</p>
<p style="position:absolute;top:218px;left:258px;white-space:nowrap" class="ft149190">)</p>
<p style="position:absolute;top:362px;left:287px;white-space:nowrap" class="ft14943">Reliability of Functionality Implemented in VM (R</p>
<p style="position:absolute;top:366px;left:473px;white-space:nowrap" class="ft14958">f</p>
<p style="position:absolute;top:362px;left:475px;white-space:nowrap" class="ft14943">)</p>
<p style="position:absolute;top:308px;left:371px;white-space:nowrap" class="ft14943">R</p>
<p style="position:absolute;top:311px;left:378px;white-space:nowrap" class="ft14958">M’</p>
<p style="position:absolute;top:308px;left:385px;white-space:nowrap" class="ft14943">&#160;= 0.75, n = 3</p>
<p style="position:absolute;top:316px;left:371px;white-space:nowrap" class="ft14943">R</p>
<p style="position:absolute;top:320px;left:378px;white-space:nowrap" class="ft14958">M’</p>
<p style="position:absolute;top:316px;left:385px;white-space:nowrap" class="ft14943">&#160;= 0.90, n = 3</p>
<p style="position:absolute;top:325px;left:371px;white-space:nowrap" class="ft14943">R</p>
<p style="position:absolute;top:329px;left:378px;white-space:nowrap" class="ft14958">M’</p>
<p style="position:absolute;top:325px;left:385px;white-space:nowrap" class="ft14943">&#160;= 0.95, n = 3</p>
<p style="position:absolute;top:334px;left:371px;white-space:nowrap" class="ft14943">R</p>
<p style="position:absolute;top:337px;left:378px;white-space:nowrap" class="ft14958">M’</p>
<p style="position:absolute;top:334px;left:385px;white-space:nowrap" class="ft14943">&#160;= 0.99, n = 3</p>
<p style="position:absolute;top:380px;left:296px;white-space:nowrap" class="ft14919">(a)&#160;Fixed</p>
<p style="position:absolute;top:380px;left:344px;white-space:nowrap" class="ft14979">n</p>
<p style="position:absolute;top:380px;left:352px;white-space:nowrap" class="ft14919">,&#160;varying</p>
<p style="position:absolute;top:380px;left:397px;white-space:nowrap" class="ft14979">R</p>
<p style="position:absolute;top:385px;left:407px;white-space:nowrap" class="ft14975">M</p>
<p style="position:absolute;top:384px;left:418px;white-space:nowrap" class="ft149188">′</p>
<p style="position:absolute;top:341px;left:534px;white-space:nowrap" class="ft14943">&#160;0.2</p>
<p style="position:absolute;top:323px;left:534px;white-space:nowrap" class="ft14943">&#160;0.3</p>
<p style="position:absolute;top:305px;left:534px;white-space:nowrap" class="ft14943">&#160;0.4</p>
<p style="position:absolute;top:287px;left:534px;white-space:nowrap" class="ft14943">&#160;0.5</p>
<p style="position:absolute;top:268px;left:534px;white-space:nowrap" class="ft14943">&#160;0.6</p>
<p style="position:absolute;top:250px;left:534px;white-space:nowrap" class="ft14943">&#160;0.7</p>
<p style="position:absolute;top:232px;left:534px;white-space:nowrap" class="ft14943">&#160;0.8</p>
<p style="position:absolute;top:214px;left:534px;white-space:nowrap" class="ft14943">&#160;0.9</p>
<p style="position:absolute;top:196px;left:542px;white-space:nowrap" class="ft14943">&#160;1</p>
<p style="position:absolute;top:350px;left:547px;white-space:nowrap" class="ft14943">&#160;0.1&#160;&#160;0.2&#160;&#160;0.3&#160;&#160;0.4&#160;&#160;0.5&#160;&#160;0.6&#160;&#160;0.7&#160;&#160;0.8&#160;&#160;0.9</p>
<p style="position:absolute;top:350px;left:733px;white-space:nowrap" class="ft14943">&#160;1</p>
<p style="position:absolute;top:318px;left:504px;white-space:nowrap" class="ft149190">Lower Bound on Reliability&#160;</p>
<p style="position:absolute;top:309px;left:513px;white-space:nowrap" class="ft149190">&#160;of Functionality when&#160;</p>
<p style="position:absolute;top:316px;left:521px;white-space:nowrap" class="ft149190">&#160;Moved to Hypervisor (R</p>
<p style="position:absolute;top:224px;left:523px;white-space:nowrap" class="ft149191">F</p>
<p style="position:absolute;top:218px;left:521px;white-space:nowrap" class="ft149190">)</p>
<p style="position:absolute;top:362px;left:550px;white-space:nowrap" class="ft14943">Reliability of Functionality Implemented in VM (R</p>
<p style="position:absolute;top:366px;left:736px;white-space:nowrap" class="ft14958">f</p>
<p style="position:absolute;top:362px;left:738px;white-space:nowrap" class="ft14943">)</p>
<p style="position:absolute;top:316px;left:634px;white-space:nowrap" class="ft14943">R</p>
<p style="position:absolute;top:320px;left:640px;white-space:nowrap" class="ft14958">M’</p>
<p style="position:absolute;top:316px;left:648px;white-space:nowrap" class="ft14943">&#160;= 0.75, n = 3</p>
<p style="position:absolute;top:325px;left:634px;white-space:nowrap" class="ft14943">R</p>
<p style="position:absolute;top:329px;left:640px;white-space:nowrap" class="ft14958">M’</p>
<p style="position:absolute;top:325px;left:648px;white-space:nowrap" class="ft14943">&#160;= 0.75, n = 6</p>
<p style="position:absolute;top:334px;left:634px;white-space:nowrap" class="ft14943">R</p>
<p style="position:absolute;top:337px;left:640px;white-space:nowrap" class="ft14958">M’</p>
<p style="position:absolute;top:334px;left:648px;white-space:nowrap" class="ft14943">&#160;= 0.75, n = 9</p>
<p style="position:absolute;top:380px;left:559px;white-space:nowrap" class="ft14919">(b)&#160;Fixed</p>
<p style="position:absolute;top:380px;left:607px;white-space:nowrap" class="ft14979">R</p>
<p style="position:absolute;top:385px;left:617px;white-space:nowrap" class="ft14975">M</p>
<p style="position:absolute;top:384px;left:628px;white-space:nowrap" class="ft149188">′</p>
<p style="position:absolute;top:380px;left:633px;white-space:nowrap" class="ft14919">,&#160;varying</p>
<p style="position:absolute;top:380px;left:678px;white-space:nowrap" class="ft14979">n</p>
<p style="position:absolute;top:427px;left:337px;white-space:nowrap" class="ft1498">Figure&#160;10.8:&#160;Plot&#160;of</p>
<p style="position:absolute;top:426px;left:459px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:432px;left:470px;white-space:nowrap" class="ft14947">F</p>
<p style="position:absolute;top:426px;left:484px;white-space:nowrap" class="ft14950">≥</p>
<p style="position:absolute;top:416px;left:502px;white-space:nowrap" class="ft14948">[1</p>
<p style="position:absolute;top:416px;left:517px;white-space:nowrap" class="ft14950">−</p>
<p style="position:absolute;top:416px;left:532px;white-space:nowrap" class="ft14948">(1</p>
<p style="position:absolute;top:416px;left:548px;white-space:nowrap" class="ft14950">−</p>
<p style="position:absolute;top:416px;left:563px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:422px;left:574px;white-space:nowrap" class="ft14947">f</p>
<p style="position:absolute;top:416px;left:582px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:422px;left:593px;white-space:nowrap" class="ft14947">M</p>
<p style="position:absolute;top:423px;left:606px;white-space:nowrap" class="ft149188">′</p>
<p style="position:absolute;top:416px;left:611px;white-space:nowrap" class="ft14948">)</p>
<p style="position:absolute;top:415px;left:617px;white-space:nowrap" class="ft14947">n</p>
<p style="position:absolute;top:416px;left:625px;white-space:nowrap" class="ft14948">]</p>
<p style="position:absolute;top:437px;left:511px;white-space:nowrap" class="ft14948">[1</p>
<p style="position:absolute;top:437px;left:526px;white-space:nowrap" class="ft14950">−</p>
<p style="position:absolute;top:437px;left:541px;white-space:nowrap" class="ft14948">(1</p>
<p style="position:absolute;top:437px;left:558px;white-space:nowrap" class="ft14950">−</p>
<p style="position:absolute;top:437px;left:573px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:443px;left:584px;white-space:nowrap" class="ft14947">M</p>
<p style="position:absolute;top:443px;left:596px;white-space:nowrap" class="ft149188">′</p>
<p style="position:absolute;top:437px;left:601px;white-space:nowrap" class="ft14948">)</p>
<p style="position:absolute;top:436px;left:607px;white-space:nowrap" class="ft14947">n</p>
<p style="position:absolute;top:437px;left:615px;white-space:nowrap" class="ft14948">]</p>
<p style="position:absolute;top:483px;left:226px;white-space:nowrap" class="ft1498">system&#160;reliability&#160;is&#160;given&#160;by</p>
<p style="position:absolute;top:508px;left:248px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:506px;left:260px;white-space:nowrap" class="ft14972">2</p>
<p style="position:absolute;top:506px;left:266px;white-space:nowrap" class="ft149155">−</p>
<p style="position:absolute;top:506px;left:275px;white-space:nowrap" class="ft14972">of</p>
<p style="position:absolute;top:506px;left:286px;white-space:nowrap" class="ft149155">−</p>
<p style="position:absolute;top:506px;left:295px;white-space:nowrap" class="ft14972">3</p>
<p style="position:absolute;top:516px;left:260px;white-space:nowrap" class="ft14947">sys</p>
<p style="position:absolute;top:508px;left:306px;white-space:nowrap" class="ft14948">=</p>
<p style="position:absolute;top:508px;left:322px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:514px;left:333px;white-space:nowrap" class="ft14947">H</p>
<p style="position:absolute;top:508px;left:344px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:514px;left:356px;white-space:nowrap" class="ft14947">V</p>
<p style="position:absolute;top:508px;left:366px;white-space:nowrap" class="ft14948">[</p>
<p style="position:absolute;top:508px;left:370px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:506px;left:382px;white-space:nowrap" class="ft14972">3</p>
<p style="position:absolute;top:516px;left:382px;white-space:nowrap" class="ft14947">M</p>
<p style="position:absolute;top:508px;left:398px;white-space:nowrap" class="ft14948">+</p>
<p style="position:absolute;top:498px;left:413px;white-space:nowrap" class="ft149182"></p>
<p style="position:absolute;top:498px;left:424px;white-space:nowrap" class="ft149192">3<br/>2</p>
<p style="position:absolute;top:498px;left:432px;white-space:nowrap" class="ft149182"></p>
<p style="position:absolute;top:508px;left:443px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:506px;left:454px;white-space:nowrap" class="ft14972">2</p>
<p style="position:absolute;top:516px;left:454px;white-space:nowrap" class="ft14947">M</p>
<p style="position:absolute;top:508px;left:467px;white-space:nowrap" class="ft14948">(1</p>
<p style="position:absolute;top:508px;left:484px;white-space:nowrap" class="ft14950">−</p>
<p style="position:absolute;top:508px;left:499px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:514px;left:510px;white-space:nowrap" class="ft14947">M</p>
<p style="position:absolute;top:508px;left:523px;white-space:nowrap" class="ft14948">)]</p>
<p style="position:absolute;top:508px;left:533px;white-space:nowrap" class="ft14946">.</p>
<p style="position:absolute;top:538px;left:226px;white-space:nowrap" class="ft1498">Then,</p>
<p style="position:absolute;top:537px;left:264px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:535px;left:276px;white-space:nowrap" class="ft14972">2</p>
<p style="position:absolute;top:534px;left:282px;white-space:nowrap" class="ft149155">−</p>
<p style="position:absolute;top:535px;left:291px;white-space:nowrap" class="ft14972">of</p>
<p style="position:absolute;top:534px;left:302px;white-space:nowrap" class="ft149155">−</p>
<p style="position:absolute;top:535px;left:311px;white-space:nowrap" class="ft14972">3</p>
<p style="position:absolute;top:544px;left:275px;white-space:nowrap" class="ft14947">sys</p>
<p style="position:absolute;top:537px;left:321px;white-space:nowrap" class="ft14946">&gt;&#160;R</p>
<p style="position:absolute;top:535px;left:349px;white-space:nowrap" class="ft14947">N&#160;V</p>
<p style="position:absolute;top:544px;left:349px;white-space:nowrap" class="ft14947">sys</p>
<p style="position:absolute;top:538px;left:373px;white-space:nowrap" class="ft1498">gives&#160;the&#160;condition&#160;for&#160;the&#160;2-out-of-3&#160;replication&#160;scheme&#160;to&#160;be</p>
<p style="position:absolute;top:555px;left:226px;white-space:nowrap" class="ft1498">more&#160;reliable&#160;than&#160;the&#160;non-virtualized&#160;service.&#160;Thus,&#160;we&#160;obtain</p>
<p style="position:absolute;top:580px;left:248px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:586px;left:260px;white-space:nowrap" class="ft14947">H</p>
<p style="position:absolute;top:580px;left:271px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:586px;left:282px;white-space:nowrap" class="ft14947">V</p>
<p style="position:absolute;top:580px;left:293px;white-space:nowrap" class="ft14948">[</p>
<p style="position:absolute;top:580px;left:297px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:578px;left:309px;white-space:nowrap" class="ft14972">3</p>
<p style="position:absolute;top:588px;left:308px;white-space:nowrap" class="ft14947">M</p>
<p style="position:absolute;top:580px;left:325px;white-space:nowrap" class="ft14948">+</p>
<p style="position:absolute;top:569px;left:340px;white-space:nowrap" class="ft149182"></p>
<p style="position:absolute;top:570px;left:351px;white-space:nowrap" class="ft149192">3<br/>2</p>
<p style="position:absolute;top:569px;left:358px;white-space:nowrap" class="ft149182"></p>
<p style="position:absolute;top:580px;left:369px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:578px;left:381px;white-space:nowrap" class="ft14972">2</p>
<p style="position:absolute;top:588px;left:381px;white-space:nowrap" class="ft14947">M</p>
<p style="position:absolute;top:580px;left:394px;white-space:nowrap" class="ft14948">(1</p>
<p style="position:absolute;top:580px;left:411px;white-space:nowrap" class="ft14950">−</p>
<p style="position:absolute;top:580px;left:426px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:586px;left:437px;white-space:nowrap" class="ft14947">M</p>
<p style="position:absolute;top:580px;left:450px;white-space:nowrap" class="ft14948">)]</p>
<p style="position:absolute;top:580px;left:464px;white-space:nowrap" class="ft14946">&gt;&#160;R</p>
<p style="position:absolute;top:586px;left:491px;white-space:nowrap" class="ft14947">H</p>
<p style="position:absolute;top:580px;left:503px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:586px;left:514px;white-space:nowrap" class="ft14947">M</p>
<p style="position:absolute;top:626px;left:404px;white-space:nowrap" class="ft14948">=</p>
<p style="position:absolute;top:626px;left:413px;white-space:nowrap" class="ft14950">⇒</p>
<p style="position:absolute;top:626px;left:432px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:632px;left:443px;white-space:nowrap" class="ft14947">V</p>
<p style="position:absolute;top:626px;left:458px;white-space:nowrap" class="ft14946">&gt;</p>
<p style="position:absolute;top:616px;left:513px;white-space:nowrap" class="ft14948">1</p>
<p style="position:absolute;top:636px;left:476px;white-space:nowrap" class="ft14948">3</p>
<p style="position:absolute;top:636px;left:483px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:642px;left:494px;white-space:nowrap" class="ft14947">M</p>
<p style="position:absolute;top:636px;left:511px;white-space:nowrap" class="ft14950">−</p>
<p style="position:absolute;top:636px;left:526px;white-space:nowrap" class="ft14948">2</p>
<p style="position:absolute;top:636px;left:533px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:635px;left:545px;white-space:nowrap" class="ft14972">2</p>
<p style="position:absolute;top:644px;left:545px;white-space:nowrap" class="ft14947">M</p>
<p style="position:absolute;top:626px;left:560px;white-space:nowrap" class="ft14946">.</p>
<p style="position:absolute;top:627px;left:706px;white-space:nowrap" class="ft1498">(10.4)</p>
<p style="position:absolute;top:664px;left:248px;white-space:nowrap" class="ft1498">Inequality&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#149">(10.4)&#160;</a>gives&#160;a&#160;lower&#160;bound&#160;on&#160;the&#160;hypervisor&#160;reliability&#160;for&#160;the&#160;2-out-of-3</p>
<p style="position:absolute;top:682px;left:226px;white-space:nowrap" class="ft14914">replication&#160;scheme&#160;to&#160;have&#160;better&#160;reliability&#160;than&#160;the&#160;non-virtualized&#160;case.&#160;Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#150">10.9<br/></a>shows&#160;a&#160;plot&#160;of</p>
<p style="position:absolute;top:696px;left:352px;white-space:nowrap" class="ft14972">1</p>
<p style="position:absolute;top:708px;left:325px;white-space:nowrap" class="ft14972">3</p>
<p style="position:absolute;top:708px;left:330px;white-space:nowrap" class="ft14947">R</p>
<p style="position:absolute;top:712px;left:339px;white-space:nowrap" class="ft14990">M</p>
<p style="position:absolute;top:707px;left:351px;white-space:nowrap" class="ft149155">−</p>
<p style="position:absolute;top:708px;left:360px;white-space:nowrap" class="ft14972">2</p>
<p style="position:absolute;top:708px;left:366px;white-space:nowrap" class="ft14947">R</p>
<p style="position:absolute;top:707px;left:375px;white-space:nowrap" class="ft149189">2</p>
<p style="position:absolute;top:714px;left:375px;white-space:nowrap" class="ft14990">M</p>
<p style="position:absolute;top:699px;left:393px;white-space:nowrap" class="ft14946">&lt;&#160;R</p>
<p style="position:absolute;top:704px;left:422px;white-space:nowrap" class="ft14947">V</p>
<p style="position:absolute;top:699px;left:437px;white-space:nowrap" class="ft14946">&lt;</p>
<p style="position:absolute;top:699px;left:454px;white-space:nowrap" class="ft14948">1</p>
<p style="position:absolute;top:700px;left:462px;white-space:nowrap" class="ft1498">.&#160;It&#160;is&#160;clear&#160;from&#160;the&#160;graph&#160;that&#160;there&#160;exists&#160;no</p>
<p style="position:absolute;top:719px;left:226px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:725px;left:237px;white-space:nowrap" class="ft14947">V</p>
<p style="position:absolute;top:720px;left:252px;white-space:nowrap" class="ft1498">value&#160;that&#160;satisfies&#160;inequality&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#149">(10.4)&#160;</a>and&#160;is&#160;less&#160;than&#160;1&#160;when</p>
<p style="position:absolute;top:719px;left:618px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:725px;left:629px;white-space:nowrap" class="ft14947">M</p>
<p style="position:absolute;top:719px;left:648px;white-space:nowrap" class="ft14950">≤</p>
<p style="position:absolute;top:719px;left:665px;white-space:nowrap" class="ft14948">0</p>
<p style="position:absolute;top:719px;left:672px;white-space:nowrap" class="ft14946">.</p>
<p style="position:absolute;top:719px;left:676px;white-space:nowrap" class="ft14948">5</p>
<p style="position:absolute;top:720px;left:684px;white-space:nowrap" class="ft1498">.&#160;In&#160;other</p>
<p style="position:absolute;top:738px;left:226px;white-space:nowrap" class="ft14914">words,&#160;if&#160;the&#160;VM&#160;reliability&#160;(i.e.,&#160;the&#160;operating&#160;system&#160;and&#160;service&#160;reliability)&#160;is&#160;poor&#160;to<br/>begin&#160;with,&#160;then&#160;the&#160;2-out-of-3&#160;replication&#160;scheme&#160;will&#160;only&#160;make&#160;the&#160;node&#160;reliability<br/>worse&#160;even&#160;if&#160;the&#160;hypervisor&#160;is&#160;ultra-reliable.&#160;This&#160;result&#160;concurs&#160;with&#160;the&#160;well-known<br/>fact&#160;that&#160;any&#160;form&#160;of&#160;redundancy&#160;with&#160;majority&#160;voting&#160;is&#160;not&#160;helpful&#160;for&#160;improving&#160;over-<br/>all&#160;system&#160;reliability&#160;when&#160;the&#160;overall&#160;system&#160;is&#160;composed&#160;of&#160;modules&#160;with&#160;individual<br/>reliabilities&#160;of&#160;less&#160;than</p>
<p style="position:absolute;top:827px;left:371px;white-space:nowrap" class="ft14948">0</p>
<p style="position:absolute;top:827px;left:378px;white-space:nowrap" class="ft14946">.</p>
<p style="position:absolute;top:827px;left:383px;white-space:nowrap" class="ft14948">5</p>
<p style="position:absolute;top:828px;left:394px;white-space:nowrap" class="ft1498"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">[58]</a>.&#160;The&#160;graph&#160;also&#160;shows&#160;that&#160;the&#160;higher&#160;the&#160;hypervisor</p>
<p style="position:absolute;top:846px;left:226px;white-space:nowrap" class="ft14915">reliability,&#160;the&#160;larger&#160;the&#160;range&#160;of&#160;VM&#160;reliability&#160;values&#160;for&#160;which&#160;the&#160;2-out-of-3&#160;repli-<br/>cation&#160;scheme&#160;has&#160;better&#160;reliability&#160;than&#160;the&#160;non-virtualized&#160;case.&#160;For&#160;example,&#160;when</p>
<p style="position:absolute;top:881px;left:226px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:887px;left:237px;white-space:nowrap" class="ft14947">V</p>
<p style="position:absolute;top:881px;left:254px;white-space:nowrap" class="ft14948">=&#160;0</p>
<p style="position:absolute;top:881px;left:279px;white-space:nowrap" class="ft14946">.</p>
<p style="position:absolute;top:881px;left:283px;white-space:nowrap" class="ft14948">98</p>
<p style="position:absolute;top:882px;left:298px;white-space:nowrap" class="ft1498">,&#160;the&#160;range&#160;of&#160;VM&#160;reliability&#160;values&#160;that&#160;can&#160;be&#160;accommodated&#160;is&#160;greater</p>
<p style="position:absolute;top:900px;left:226px;white-space:nowrap" class="ft1498">than&#160;the&#160;range&#160;when</p>
<p style="position:absolute;top:899px;left:351px;white-space:nowrap" class="ft14946">R</p>
<p style="position:absolute;top:905px;left:362px;white-space:nowrap" class="ft14947">V</p>
<p style="position:absolute;top:899px;left:376px;white-space:nowrap" class="ft14948">=&#160;0</p>
<p style="position:absolute;top:899px;left:400px;white-space:nowrap" class="ft14946">.</p>
<p style="position:absolute;top:899px;left:404px;white-space:nowrap" class="ft14948">9</p>
<p style="position:absolute;top:900px;left:411px;white-space:nowrap" class="ft1498">.</p>
<p style="position:absolute;top:945px;left:226px;white-space:nowrap" class="ft14926"><b>10.5</b></p>
<p style="position:absolute;top:945px;left:285px;white-space:nowrap" class="ft14926"><b>An&#160;Architecture&#160;for&#160;a&#160;More&#160;Reliable&#160;Xen&#160;VMM</b></p>
<p style="position:absolute;top:983px;left:226px;white-space:nowrap" class="ft14914">As&#160;shown&#160;by&#160;the&#160;model-based&#160;analysis&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#145">10.4,&#160;</a>it&#160;is&#160;highly&#160;desirable&#160;to&#160;make&#160;the<br/>VMM&#160;as&#160;reliable&#160;as&#160;possible&#160;to&#160;improve&#160;the&#160;overall&#160;reliability&#160;of&#160;a&#160;virtualized&#160;node.&#160;In<br/>this&#160;section,&#160;we&#160;leverage&#160;our&#160;X-Spy&#160;implementation&#160;to&#160;propose&#160;a&#160;reliability-enhanced<br/>design&#160;of&#160;the&#160;popular&#160;Xen&#160;open-source&#160;VMM&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[11]</a>.</p>
<p style="position:absolute;top:1054px;left:248px;white-space:nowrap" class="ft1498">The&#160;Xen&#160;VMM&#160;(Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#150">10.10(</a>a))&#160;consists&#160;of&#160;a&#160;hypervisor&#160;core&#160;and&#160;a&#160;privileged</p>
<p style="position:absolute;top:1072px;left:226px;white-space:nowrap" class="ft1498">domain&#160;(or&#160;VM)&#160;called&#160;Dom0&#160;or&#160;domain&#160;zero.&#160;The&#160;hypervisor&#160;core&#160;is&#160;small&#160;in&#160;size&#160;and</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft14921">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 150 -->
<a name="150"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft150193{font-size:6px;line-height:7px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page150-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5150.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1508">148</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft15021">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:325px;left:322px;white-space:nowrap" class="ft15044">&#160;0.88</p>
<p style="position:absolute;top:303px;left:326px;white-space:nowrap" class="ft15044">&#160;0.9</p>
<p style="position:absolute;top:281px;left:322px;white-space:nowrap" class="ft15044">&#160;0.92</p>
<p style="position:absolute;top:260px;left:322px;white-space:nowrap" class="ft15044">&#160;0.94</p>
<p style="position:absolute;top:238px;left:322px;white-space:nowrap" class="ft15044">&#160;0.96</p>
<p style="position:absolute;top:217px;left:322px;white-space:nowrap" class="ft15044">&#160;0.98</p>
<p style="position:absolute;top:195px;left:333px;white-space:nowrap" class="ft15044">&#160;1</p>
<p style="position:absolute;top:332px;left:337px;white-space:nowrap" class="ft15044">&#160;0.1&#160;&#160;0.2&#160;&#160;0.3&#160;&#160;0.4&#160;&#160;0.5&#160;&#160;0.6&#160;&#160;0.7&#160;&#160;0.8&#160;&#160;0.9</p>
<p style="position:absolute;top:332px;left:507px;white-space:nowrap" class="ft15044">&#160;1</p>
<p style="position:absolute;top:304px;left:302px;white-space:nowrap" class="ft150184">Lower Bound on Reliability&#160;</p>
<p style="position:absolute;top:290px;left:309px;white-space:nowrap" class="ft150184">&#160;of Hypervisor (R</p>
<p style="position:absolute;top:233px;left:312px;white-space:nowrap" class="ft150185">V</p>
<p style="position:absolute;top:228px;left:309px;white-space:nowrap" class="ft150184">)</p>
<p style="position:absolute;top:343px;left:370px;white-space:nowrap" class="ft15044">Reliability of Virtual Machine (R</p>
<p style="position:absolute;top:347px;left:477px;white-space:nowrap" class="ft150162">M</p>
<p style="position:absolute;top:343px;left:482px;white-space:nowrap" class="ft15044">)</p>
<p style="position:absolute;top:374px;left:257px;white-space:nowrap" class="ft1508">Figure&#160;10.9:&#160;Plot&#160;of</p>
<p style="position:absolute;top:373px;left:379px;white-space:nowrap" class="ft15048">(3</p>
<p style="position:absolute;top:373px;left:392px;white-space:nowrap" class="ft15046">R</p>
<p style="position:absolute;top:378px;left:404px;white-space:nowrap" class="ft15047">M</p>
<p style="position:absolute;top:373px;left:420px;white-space:nowrap" class="ft15050">−</p>
<p style="position:absolute;top:373px;left:435px;white-space:nowrap" class="ft15048">2</p>
<p style="position:absolute;top:373px;left:443px;white-space:nowrap" class="ft15046">R</p>
<p style="position:absolute;top:371px;left:454px;white-space:nowrap" class="ft15072">2</p>
<p style="position:absolute;top:380px;left:454px;white-space:nowrap" class="ft15047">M</p>
<p style="position:absolute;top:373px;left:467px;white-space:nowrap" class="ft15048">)</p>
<p style="position:absolute;top:370px;left:473px;white-space:nowrap" class="ft150155">−</p>
<p style="position:absolute;top:371px;left:482px;white-space:nowrap" class="ft15072">1</p>
<p style="position:absolute;top:373px;left:493px;white-space:nowrap" class="ft15046">&lt;&#160;R</p>
<p style="position:absolute;top:378px;left:520px;white-space:nowrap" class="ft15047">V</p>
<p style="position:absolute;top:373px;left:535px;white-space:nowrap" class="ft15046">&lt;</p>
<p style="position:absolute;top:373px;left:551px;white-space:nowrap" class="ft15048">1</p>
<p style="position:absolute;top:524px;left:190px;white-space:nowrap" class="ft15045"><b>Physical&#160;Hardware</b></p>
<p style="position:absolute;top:437px;left:158px;white-space:nowrap" class="ft15045"><b>Management&#160;</b></p>
<p style="position:absolute;top:448px;left:170px;white-space:nowrap" class="ft15045"><b>of&#160;VMs,&#160;</b></p>
<p style="position:absolute;top:459px;left:158px;white-space:nowrap" class="ft15045"><b>Virt.&#160;Devices,&#160;</b></p>
<p style="position:absolute;top:469px;left:159px;white-space:nowrap" class="ft15045"><b>and&#160;security</b></p>
<p style="position:absolute;top:410px;left:170px;white-space:nowrap" class="ft15045"><b>Dom0</b></p>
<p style="position:absolute;top:502px;left:197px;white-space:nowrap" class="ft15045"><b>Xen&#160;Hypervisor</b></p>
<p style="position:absolute;top:410px;left:228px;white-space:nowrap" class="ft15045"><b>User&#160;domains</b></p>
<p style="position:absolute;top:545px;left:160px;white-space:nowrap" class="ft15019">(a)&#160;Normal&#160;Xen&#160;Architecture</p>
<p style="position:absolute;top:524px;left:456px;white-space:nowrap" class="ft15045"><b>Physical&#160;Hardware</b></p>
<p style="position:absolute;top:410px;left:432px;white-space:nowrap" class="ft15045"><b>R-Dom0</b></p>
<p style="position:absolute;top:410px;left:567px;white-space:nowrap" class="ft15045"><b>User&#160;domains</b></p>
<p style="position:absolute;top:503px;left:602px;white-space:nowrap" class="ft15045"><b>Xen&#160;Core</b></p>
<p style="position:absolute;top:455px;left:365px;white-space:nowrap" class="ft15045"><b>Dom0.A</b></p>
<p style="position:absolute;top:455px;left:432px;white-space:nowrap" class="ft15045"><b>Dom0.B</b></p>
<p style="position:absolute;top:455px;left:499px;white-space:nowrap" class="ft15045"><b>Dom0.C</b></p>
<p style="position:absolute;top:422px;left:347px;white-space:nowrap" class="ft150193">mutual&#160;intrusion<br/>monitoring</p>
<p style="position:absolute;top:490px;left:419px;white-space:nowrap" class="ft150162">periodic&#160;intrusion&#160;reports</p>
<p style="position:absolute;top:503px;left:410px;white-space:nowrap" class="ft150162">Leader&#160;Selection,&#160;Trust&#160;Vote,</p>
<p style="position:absolute;top:510px;left:409px;white-space:nowrap" class="ft150162">Termination,&#160;and&#160;Rejuvenation</p>
<p style="position:absolute;top:545px;left:437px;white-space:nowrap" class="ft15019">(b)&#160;R-Xen&#160;Architecture</p>
<p style="position:absolute;top:579px;left:235px;white-space:nowrap" class="ft1508">Figure&#160;10.10:&#160;Enhancing&#160;the&#160;Reliability&#160;of&#160;the&#160;Xen&#160;VMM</p>
<p style="position:absolute;top:627px;left:150px;white-space:nowrap" class="ft15015">concerned&#160;with&#160;virtualizing&#160;the&#160;memory&#160;and&#160;CPU.&#160;Dom0&#160;is&#160;a&#160;full-fledged&#160;VM&#160;running<br/>a&#160;guest&#160;OS&#160;(Linux)&#160;and&#160;virtualizes&#160;other&#160;hardware&#160;devices&#160;(such&#160;as&#160;disks&#160;and&#160;network<br/>interfaces).&#160;Dom0&#160;is&#160;the&#160;first&#160;domain&#160;that&#160;is&#160;created,&#160;and&#160;controls&#160;all&#160;other&#160;domains,<br/>called&#160;user&#160;domains&#160;or&#160;DomUs.&#160;For&#160;any&#160;given&#160;physical&#160;device&#160;in&#160;Xen,&#160;the&#160;native&#160;device<br/>driver&#160;is&#160;part&#160;of&#160;at&#160;most&#160;one&#160;VM.&#160;If&#160;the&#160;device&#160;is&#160;to&#160;be&#160;shared&#160;with&#160;other&#160;VMs,&#160;then&#160;the<br/>VM&#160;with&#160;the&#160;native&#160;device&#160;driver&#160;makes&#160;the&#160;device&#160;available&#160;through&#160;a&#160;<i>back-end&#160;driver</i>.<br/>Any&#160;VM&#160;that&#160;wants&#160;to&#160;share&#160;the&#160;device&#160;exports&#160;a&#160;virtual&#160;device&#160;driver&#160;called&#160;the&#160;<i>front-<br/>end&#160;driver&#160;</i>to&#160;the&#160;back-end&#160;driver.&#160;Every&#160;front-end&#160;virtual&#160;device&#160;has&#160;to&#160;be&#160;connected&#160;to<br/>a&#160;corresponding&#160;back-end&#160;virtual&#160;device;&#160;only&#160;then&#160;does&#160;the&#160;front-end&#160;device&#160;become<br/>active.&#160;The&#160;mapping&#160;is&#160;one-to-one,&#160;i.e.,&#160;each&#160;front-end&#160;virtual&#160;device&#160;from&#160;each&#160;user<br/>domain&#160;is&#160;mapped&#160;to&#160;a&#160;corresponding&#160;back-end&#160;virtual&#160;device.&#160;The&#160;communication<br/>between&#160;the&#160;back-end&#160;and&#160;front-end&#160;drivers&#160;takes&#160;places&#160;through&#160;shared&#160;memory&#160;and<br/>event&#160;channels.&#160;The&#160;event&#160;channel&#160;is&#160;used&#160;for&#160;sending&#160;simple&#160;lightweight&#160;notifications<br/>and&#160;the&#160;shared&#160;memory&#160;is&#160;used&#160;for&#160;sending&#160;requests&#160;and&#160;data.</p>
<p style="position:absolute;top:878px;left:172px;white-space:nowrap" class="ft1508">As&#160;Dom0&#160;is&#160;relatively&#160;large,&#160;we&#160;expect&#160;its&#160;reliability&#160;to&#160;be&#160;lower&#160;than&#160;that&#160;of&#160;the</p>
<p style="position:absolute;top:896px;left:150px;white-space:nowrap" class="ft15014">hypervisor&#160;core.&#160;Thus,&#160;improving&#160;the&#160;reliability&#160;of&#160;Dom0&#160;is&#160;crucial&#160;to&#160;improving&#160;the<br/>reliability&#160;of&#160;the&#160;Xen&#160;VMM&#160;as&#160;a&#160;whole.&#160;We&#160;combine&#160;some&#160;of&#160;the&#160;technologies&#160;de-<br/>scribed&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#133">10.2,&#160;</a>namely,&#160;intrusion&#160;detection,&#160;enforcing&#160;fail-stop&#160;behavior,&#160;and<br/>intrusion&#160;response&#160;in&#160;form&#160;of&#160;software&#160;rejuvenation,&#160;to&#160;architect&#160;a&#160;more&#160;reliable&#160;Xen<br/>VMM,&#160;which&#160;we&#160;call&#160;<i>R-Xen</i>.</p>
<p style="position:absolute;top:986px;left:172px;white-space:nowrap" class="ft1508">In&#160;R-Xen,&#160;we&#160;enhance&#160;the&#160;reliability&#160;of&#160;Dom0&#160;by&#160;replication&#160;(Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#150">10.10(</a>b)).</p>
<p style="position:absolute;top:1004px;left:150px;white-space:nowrap" class="ft15015">Dom0&#160;is&#160;a&#160;single&#160;logical&#160;entity&#160;that&#160;actually&#160;consists&#160;of&#160;three&#160;privileged&#160;domains,<br/><i>Dom0.A</i>,&#160;<i>Dom0.B</i>,&#160;and&#160;<i>Dom0.C</i>,&#160;with&#160;identical&#160;privilege&#160;levels.&#160;The&#160;three&#160;replicas<br/>mutually&#160;monitor&#160;each&#160;other&#160;using&#160;the&#160;techniques&#160;we&#160;described&#160;above&#160;in&#160;our&#160;X-Spy<br/>implementation.&#160;Specifically,&#160;each&#160;Dom0&#160;replica&#160;is&#160;simultaneously&#160;the&#160;PVM&#160;and&#160;the</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft15021">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 151 -->
<a name="151"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page151-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5151.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1518">CHAPTER&#160;10.&#160;TOWARDS&#160;DEPENDABILITY&#160;AND&#160;ATTACK&#160;RESISTANCE&#160;149</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft15114">SSVM&#160;for&#160;the&#160;other&#160;two&#160;Dom0s.&#160;Periodically,&#160;the&#160;Dom0&#160;replicas&#160;submit&#160;a&#160;fault&#160;detec-<br/>tion&#160;vote&#160;to&#160;the&#160;hypervisor&#160;core&#160;that&#160;indicates&#160;whether&#160;one&#160;of&#160;its&#160;two&#160;peers&#160;is&#160;thought&#160;to<br/>be&#160;compromised.&#160;If&#160;any&#160;given&#160;Dom0&#160;replica&#160;is&#160;labeled&#160;as&#160;being&#160;faulty&#160;by&#160;its&#160;two&#160;peer<br/>SSVMs,&#160;then&#160;the&#160;replica&#160;will&#160;be&#160;terminated&#160;and&#160;rejuvenated&#160;by&#160;the&#160;hypervisor.&#160;In&#160;this<br/>way,&#160;we&#160;enforce&#160;fail-stop&#160;behavior&#160;of&#160;the&#160;replica&#160;despite&#160;the&#160;presence&#160;of&#160;a&#160;more&#160;severe<br/>kind&#160;of&#160;fault&#160;in&#160;the&#160;replica.&#160;The&#160;hypervisor&#160;core&#160;then&#160;starts&#160;a&#160;new&#160;Dom0&#160;replica&#160;as&#160;a<br/>replacement&#160;of&#160;the&#160;terminated&#160;one.</p>
<p style="position:absolute;top:319px;left:248px;white-space:nowrap" class="ft1518">One&#160;of&#160;the&#160;Dom0&#160;replicas&#160;is&#160;designated&#160;as&#160;<i>active&#160;</i>by&#160;the&#160;hypervisor&#160;core,&#160;and&#160;it&#160;is</p>
<p style="position:absolute;top:337px;left:226px;white-space:nowrap" class="ft15115">this&#160;active&#160;replica&#160;that&#160;provides&#160;the&#160;back-end&#160;drivers&#160;for&#160;the&#160;devices&#160;of&#160;the&#160;user&#160;domains.<br/>The&#160;other&#160;two&#160;replicas&#160;are&#160;designated&#160;as&#160;<i>passive</i>,&#160;and&#160;do&#160;not&#160;provide&#160;any&#160;back-end&#160;de-<br/>vices.&#160;As&#160;mentioned&#160;above,&#160;each&#160;of&#160;the&#160;three&#160;Dom0&#160;replicas&#160;monitors&#160;and&#160;is&#160;being<br/>monitored&#160;by&#160;the&#160;other&#160;two.&#160;If&#160;the&#160;hypervisor&#160;gets&#160;reports&#160;from&#160;two&#160;independent&#160;repli-<br/>cas&#160;labeling&#160;the&#160;third&#160;replica&#160;as&#160;faulty,&#160;then&#160;the&#160;hypervisor&#160;terminates&#160;that&#160;replica&#160;and<br/>replaces&#160;it&#160;with&#160;a&#160;new&#160;Dom0&#160;replica.&#160;If&#160;the&#160;terminated&#160;replica&#160;is&#160;a&#160;primary,&#160;then&#160;the<br/>hypervisor&#160;designates&#160;one&#160;of&#160;the&#160;backups&#160;as&#160;the&#160;new&#160;primary&#160;replica&#160;by&#160;re-connecting<br/>the&#160;front-end&#160;devices&#160;of&#160;the&#160;user&#160;domain(s)&#160;to&#160;the&#160;replica’s&#160;back-end&#160;devices.&#160;The&#160;dis-<br/>connection&#160;and&#160;reconnection&#160;of&#160;the&#160;user&#160;domain(s)&#160;to&#160;a&#160;different&#160;Dom0&#160;has&#160;already<br/>been&#160;implemented&#160;in&#160;Xen&#160;and&#160;is&#160;used&#160;for&#160;live&#160;migration&#160;of&#160;domains.&#160;Therefore,&#160;the<br/>code&#160;can&#160;be&#160;reused.&#160;The&#160;hypervisor&#160;itself&#160;has&#160;to&#160;actively&#160;give&#160;permissions&#160;for&#160;doing<br/>the&#160;reconnection&#160;and&#160;re-routing&#160;the&#160;data&#160;from&#160;the&#160;old&#160;Dom0&#160;to&#160;the&#160;new&#160;one.&#160;It&#160;also&#160;has<br/>to&#160;shutdown&#160;the&#160;old&#160;Dom0&#160;after&#160;the&#160;reconnection&#160;process&#160;has&#160;been&#160;completed.&#160;Using<br/>a&#160;previously&#160;started&#160;backup&#160;as&#160;the&#160;new&#160;primary&#160;results&#160;in&#160;less&#160;interruption&#160;to&#160;the&#160;user<br/>domain&#160;than&#160;using&#160;the&#160;replacement&#160;replica&#160;(which&#160;has&#160;to&#160;be&#160;booted&#160;from&#160;scratch)&#160;as&#160;the<br/>new&#160;primary.&#160;It&#160;also&#160;enables&#160;the&#160;booting&#160;of&#160;the&#160;replacement&#160;replica&#160;to&#160;occur&#160;concur-<br/>rently&#160;to&#160;the&#160;re-connection&#160;of&#160;the&#160;front-end&#160;devices.&#160;Like&#160;other&#160;fault-detection-based<br/>techniques,&#160;there&#160;is&#160;the&#160;drawback&#160;of&#160;<i>detection&#160;latency</i>,&#160;i.e.,&#160;a&#160;time&#160;delay&#160;between&#160;the<br/>actual&#160;occurrence&#160;of&#160;the&#160;fault&#160;and&#160;its&#160;detection.&#160;I/O&#160;requests&#160;sent&#160;by&#160;the&#160;user&#160;domain(s)<br/>during&#160;this&#160;latency&#160;period&#160;may&#160;have&#160;to&#160;be&#160;re-issued.&#160;On&#160;the&#160;positive&#160;side,&#160;our&#160;technique<br/>can&#160;be&#160;implemented&#160;in&#160;a&#160;manner&#160;that&#160;is&#160;completely&#160;transparent&#160;to&#160;the&#160;user&#160;domain(s).<br/>In&#160;other&#160;words,&#160;a&#160;DomU&#160;running&#160;on&#160;normal&#160;Xen&#160;should&#160;be&#160;able&#160;to&#160;run&#160;without&#160;modifi-<br/>cation&#160;on&#160;this&#160;type&#160;of&#160;R-Xen&#160;as&#160;well.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft15121">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 152 -->
<a name="152"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page152-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5152.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1528">150</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft15221">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft15221">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 153 -->
<a name="153"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page153-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5153.png" alt="background image"/>
<p style="position:absolute;top:475px;left:433px;white-space:nowrap" class="ft15325"><b>Part&#160;III</b></p>
<p style="position:absolute;top:546px;left:293px;white-space:nowrap" class="ft15322"><b>Evaluation&#160;and&#160;Outlook</b></p>
<p style="position:absolute;top:1117px;left:473px;white-space:nowrap" class="ft1538">151</p>
</div>
<!-- Page 154 -->
<a name="154"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page154-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5154.png" alt="background image"/>
<p style="position:absolute;top:295px;left:150px;white-space:nowrap" class="ft15425"><b>Chapter&#160;11</b></p>
<p style="position:absolute;top:365px;left:150px;white-space:nowrap" class="ft15435"><b>Security&#160;Management<br/>Components&#160;of&#160;the&#160;OpenTC<br/>Virtual&#160;Datacenter&#160;Prototype</b></p>
<p style="position:absolute;top:552px;left:150px;white-space:nowrap" class="ft15426"><b>11.1</b></p>
<p style="position:absolute;top:552px;left:209px;white-space:nowrap" class="ft15426"><b>Overview</b></p>
<p style="position:absolute;top:590px;left:150px;white-space:nowrap" class="ft15414">We&#160;realized&#160;a&#160;prototype&#160;of&#160;a&#160;physical&#160;data&#160;center&#160;implementing&#160;multi-tenant&#160;virtual&#160;data<br/>centers.&#160;Each&#160;one,&#160;usually&#160;owned&#160;by&#160;a&#160;different&#160;customer,&#160;is&#160;mapped&#160;onto&#160;a&#160;different<br/>TVD.</p>
<p style="position:absolute;top:644px;left:172px;white-space:nowrap" class="ft1548">Our&#160;prototype&#160;is&#160;based&#160;on&#160;two&#160;classes&#160;of&#160;building&#160;blocks:&#160;Physical&#160;hosts&#160;providing</p>
<p style="position:absolute;top:662px;left:150px;white-space:nowrap" class="ft1548">VMs&#160;for&#160;the&#160;virtual&#160;domains&#160;and&#160;hosts&#160;running&#160;the&#160;data&#160;center&#160;services.</p>
<p style="position:absolute;top:680px;left:172px;white-space:nowrap" class="ft1548">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#155">11.1&#160;</a>shows&#160;a&#160;host&#160;of&#160;the&#160;first&#160;class,&#160;a&#160;single&#160;secure&#160;hypervisor&#160;platform&#160;(that</p>
<p style="position:absolute;top:698px;left:150px;white-space:nowrap" class="ft15414">we&#160;henceforth&#160;refer&#160;to&#160;as&#160;“the&#160;platform”)&#160;that&#160;is&#160;based&#160;on&#160;the&#160;Xen&#160;architecture&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[11]<br/></a>(Xen&#160;3.1.1&#160;and&#160;Linux&#160;kernel&#160;2.6.22).&#160;Following&#160;the&#160;Xen&#160;model,&#160;the&#160;platform&#160;consists<br/>of&#160;a&#160;core&#160;hypervisor,&#160;the&#160;privileged&#160;management&#160;VM&#160;called&#160;Domain-0,&#160;and&#160;the&#160;guest<br/>VMs.&#160;We&#160;have&#160;also&#160;implemented&#160;the&#160;TVD&#160;Master&#160;role&#160;that&#160;runs&#160;on&#160;a&#160;second&#160;class&#160;host<br/>and&#160;maintains&#160;policies&#160;and&#160;membership&#160;for&#160;a&#160;given&#160;virtual&#160;domain.</p>
<p style="position:absolute;top:787px;left:172px;white-space:nowrap" class="ft1548">The&#160;following&#160;components&#160;are&#160;provided&#160;by&#160;our&#160;platform.&#160;The&#160;<i>Compartment&#160;Man-</i></p>
<p style="position:absolute;top:805px;left:150px;white-space:nowrap" class="ft15415"><i>ager&#160;</i>manages&#160;the&#160;life-cycle&#160;and&#160;the&#160;integrity&#160;of&#160;the&#160;guest&#160;VMs&#160;(also&#160;called&#160;compart-<br/>ment<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#154">s</a></p>
<p style="position:absolute;top:821px;left:186px;white-space:nowrap" class="ft15427"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#154">1</a></p>
<p style="position:absolute;top:823px;left:192px;white-space:nowrap" class="ft1548"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#154">)</a>.&#160;The&#160;<i>TVD&#160;Proxy&#160;</i>is&#160;the&#160;local&#160;representative&#160;of&#160;the&#160;TVD&#160;Master&#160;running&#160;on</p>
<p style="position:absolute;top:841px;left:150px;white-space:nowrap" class="ft15414">the&#160;platform&#160;and&#160;enforcing&#160;the&#160;policies&#160;of&#160;that&#160;TVD.&#160;Each&#160;TVD&#160;Proxy&#160;is&#160;created&#160;and<br/>spawned&#160;by&#160;a&#160;TVD&#160;Proxy&#160;Factory,&#160;whenever&#160;a&#160;TVD&#160;needs&#160;to&#160;be&#160;extended&#160;to&#160;a&#160;new<br/>host.&#160;The&#160;<i>Secure&#160;Virtual&#160;Network&#160;subsystem&#160;</i>creates,&#160;manages,&#160;and&#160;makes&#160;secure&#160;the<br/>virtual&#160;LAN&#160;for&#160;each&#160;TVD.&#160;The&#160;<i>Trusted&#160;Channel&#160;Proxy&#160;</i>implements&#160;the&#160;Trusted&#160;Chan-<br/>nel&#160;needed&#160;for&#160;the&#160;pre-admission&#160;phase.&#160;In&#160;the&#160;current&#160;implementation,&#160;all&#160;these&#160;com-<br/>ponents&#160;run&#160;in&#160;Domain-0.&#160;Together&#160;with&#160;the&#160;Xen&#160;hypervisor&#160;and&#160;the&#160;other&#160;services&#160;in<br/>Domain-0,&#160;they&#160;constitute&#160;the&#160;Trusted&#160;Computing&#160;Base&#160;(TCB)&#160;of&#160;the&#160;platform,&#160;i.e.,&#160;the<br/>integrity&#160;of&#160;these&#160;components&#160;must&#160;be&#160;ensured&#160;to&#160;guarantee&#160;the&#160;correct&#160;enforcement&#160;of<br/>the&#160;TVD&#160;policies.</p>
<p style="position:absolute;top:1003px;left:172px;white-space:nowrap" class="ft1548">The&#160;integrity&#160;measurements&#160;of&#160;the&#160;TCB&#160;components&#160;are&#160;performed&#160;during&#160;the&#160;au-</p>
<p style="position:absolute;top:1029px;left:166px;white-space:nowrap" class="ft15428">1</p>
<p style="position:absolute;top:1032px;left:171px;white-space:nowrap" class="ft15419">A&#160;compartment&#160;is&#160;a&#160;protected&#160;execution&#160;environment,&#160;subject&#160;to&#160;information&#160;flow&#160;control&#160;policies&#160;en-</p>
<p style="position:absolute;top:1046px;left:150px;white-space:nowrap" class="ft15455">forced&#160;by&#160;the&#160;hypervisor:&#160;a&#160;compartment&#160;can&#160;securely&#160;host&#160;a&#160;single&#160;process&#160;running&#160;with&#160;threads&#160;as&#160;well&#160;as<br/>full-fledged&#160;VMs.</p>
<p style="position:absolute;top:1117px;left:396px;white-space:nowrap" class="ft1548">152</p>
</div>
<!-- Page 155 -->
<a name="155"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft155194{font-size:11px;font-family:Helvetica;color:#000000;-moz-transform: matrix(-0.0034706646, -0.9965293354, 0.9958262778, -0.0034706646, 0, 0);-webkit-transform: matrix(-0.0034706646, -0.9965293354, 0.9958262778, -0.0034706646, 0, 0);-o-transform: matrix(-0.0034706646, -0.9965293354, 0.9958262778, -0.0034706646, 0, 0);-ms-transform: matrix(-0.0034706646, -0.9965293354, 0.9958262778, -0.0034706646, 0, 0);-moz-transform-origin: left 75%;-webkit-transform-origin: left 75%;-o-transform-origin: left 75%;-ms-transform-origin: left 75%;}
	.ft155195{font-size:10px;line-height:13px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page155-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5155.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1558">CHAPTER&#160;11.&#160;SECURITY&#160;MANAGEMENT&#160;DEMONSTRATOR</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1558">153</p>
<p style="position:absolute;top:224px;left:315px;white-space:nowrap" class="ft15571">Dom0&#160;Compartment<br/>(Privileged&#160;VM)</p>
<p style="position:absolute;top:391px;left:421px;white-space:nowrap" class="ft15543">Xen&#160;Hypervisor</p>
<p style="position:absolute;top:417px;left:433px;white-space:nowrap" class="ft15543">Hardware</p>
<p style="position:absolute;top:417px;left:516px;white-space:nowrap" class="ft15543">CRTM&#160;CPU&#160;TPM</p>
<p style="position:absolute;top:486px;left:348px;white-space:nowrap" class="ft15569">Component&#160;Forming&#160;the&#160;TCB</p>
<p style="position:absolute;top:348px;left:441px;white-space:nowrap" class="ft15543">Linux&#160;Kernel</p>
<p style="position:absolute;top:278px;left:313px;white-space:nowrap" class="ft15593">Trusted&#160;<br/>Channel</p>
<p style="position:absolute;top:299px;left:319px;white-space:nowrap" class="ft15543">Proxy</p>
<p style="position:absolute;top:303px;left:360px;white-space:nowrap" class="ft15543">TVD&#160;A</p>
<p style="position:absolute;top:314px;left:362px;white-space:nowrap" class="ft15543">Proxy</p>
<p style="position:absolute;top:303px;left:441px;white-space:nowrap" class="ft15543">Compartment</p>
<p style="position:absolute;top:314px;left:450px;white-space:nowrap" class="ft15543">Manager&#160;</p>
<p style="position:absolute;top:417px;left:380px;white-space:nowrap" class="ft15543">NIC</p>
<p style="position:absolute;top:348px;left:372px;white-space:nowrap" class="ft15543">VNET</p>
<p style="position:absolute;top:224px;left:520px;white-space:nowrap" class="ft15571">VM:<br/>Dom1,<br/>TVD&#160;A</p>
<p style="position:absolute;top:264px;left:364px;white-space:nowrap" class="ft15543">TVD</p>
<p style="position:absolute;top:274px;left:359px;white-space:nowrap" class="ft15543">&#160;Policy</p>
<p style="position:absolute;top:284px;left:359px;white-space:nowrap" class="ft15543">Engine</p>
<p style="position:absolute;top:264px;left:459px;white-space:nowrap" class="ft15543">Local</p>
<p style="position:absolute;top:274px;left:456px;white-space:nowrap" class="ft15543">&#160;Policy</p>
<p style="position:absolute;top:284px;left:456px;white-space:nowrap" class="ft15543">Engine</p>
<p style="position:absolute;top:343px;left:522px;white-space:nowrap" class="ft15543">Linux&#160;</p>
<p style="position:absolute;top:354px;left:521px;white-space:nowrap" class="ft15543">Kernel</p>
<p style="position:absolute;top:224px;left:566px;white-space:nowrap" class="ft15571">VM:<br/>Dom2,<br/>TVD&#160;B</p>
<p style="position:absolute;top:343px;left:568px;white-space:nowrap" class="ft15543">Linux&#160;</p>
<p style="position:absolute;top:354px;left:567px;white-space:nowrap" class="ft15543">Kernel</p>
<p style="position:absolute;top:195px;left:312px;white-space:nowrap" class="ft15569">Platform&#160;providing&#160;VMs&#160;to&#160;TVDs</p>
<p style="position:absolute;top:471px;left:313px;white-space:nowrap" class="ft15580"><b>Legend:</b></p>
<p style="position:absolute;top:499px;left:349px;white-space:nowrap" class="ft15569">Control&#160;Flow&#160;Channel</p>
<p style="position:absolute;top:486px;left:530px;white-space:nowrap" class="ft155195">TVD&#160;A&#160;Data&#160;Flow<br/>TVD&#160;B&#160;Data&#160;Flow</p>
<p style="position:absolute;top:352px;left:640px;white-space:nowrap" class="ft155194">T</p>
<p style="position:absolute;top:345px;left:640px;white-space:nowrap" class="ft155194">V</p>
<p style="position:absolute;top:337px;left:640px;white-space:nowrap" class="ft155194">D</p>
<p style="position:absolute;top:328px;left:640px;white-space:nowrap" class="ft155194">&#160;M</p>
<p style="position:absolute;top:316px;left:640px;white-space:nowrap" class="ft155194">a</p>
<p style="position:absolute;top:309px;left:640px;white-space:nowrap" class="ft155194">s</p>
<p style="position:absolute;top:304px;left:640px;white-space:nowrap" class="ft155194">te</p>
<p style="position:absolute;top:294px;left:640px;white-space:nowrap" class="ft155194">r</p>
<p style="position:absolute;top:229px;left:448px;white-space:nowrap" class="ft15543">TVD&#160;Proxy</p>
<p style="position:absolute;top:240px;left:454px;white-space:nowrap" class="ft15543">&#160;Factory</p>
<p style="position:absolute;top:303px;left:402px;white-space:nowrap" class="ft15543">TVD&#160;B</p>
<p style="position:absolute;top:314px;left:404px;white-space:nowrap" class="ft15543">Proxy</p>
<p style="position:absolute;top:264px;left:406px;white-space:nowrap" class="ft15543">TVD</p>
<p style="position:absolute;top:274px;left:402px;white-space:nowrap" class="ft15543">&#160;Policy</p>
<p style="position:absolute;top:284px;left:401px;white-space:nowrap" class="ft15543">Engine</p>
<p style="position:absolute;top:537px;left:364px;white-space:nowrap" class="ft1558">Figure&#160;11.1:&#160;Xen&#160;Architecture&#160;for&#160;TVD.</p>
<p style="position:absolute;top:585px;left:226px;white-space:nowrap" class="ft15514">thenticated&#160;boot,&#160;when&#160;the&#160;chain&#160;of&#160;trust&#160;begun&#160;by&#160;the&#160;Core&#160;Root&#160;of&#160;Trust&#160;for&#160;Mea-<br/>surement&#160;(CRTM)&#160;is&#160;extended&#160;using&#160;TrustedGRUB&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[4]</a>,&#160;a&#160;TCG-enhanced&#160;version&#160;of<br/>the&#160;standard&#160;GRUB&#160;boot&#160;loader.&#160;The&#160;TVD&#160;Master&#160;implements&#160;one&#160;end&#160;of&#160;the&#160;Trusted<br/>Channel&#160;establishment&#160;protocol.&#160;The&#160;other&#160;end&#160;is&#160;the&#160;TVD&#160;Proxy&#160;Factory.</p>
<p style="position:absolute;top:657px;left:248px;white-space:nowrap" class="ft1558">Figure&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#156">11.2&#160;</a>shows&#160;the&#160;simplified&#160;layout&#160;of&#160;our&#160;prototype&#160;data&#160;center.&#160;It&#160;has&#160;two</p>
<p style="position:absolute;top:675px;left:226px;white-space:nowrap" class="ft15514">virtual&#160;networks&#160;per&#160;customer:&#160;a&#160;management&#160;network&#160;for&#160;managing&#160;the&#160;customer’s<br/>VMs&#160;within&#160;the&#160;TVD&#160;and&#160;a&#160;user&#160;data&#160;network&#160;for&#160;the&#160;actual&#160;communication&#160;between<br/>client&#160;VMs.&#160;Furthermore,&#160;the&#160;data&#160;center&#160;has&#160;a&#160;DMZ&#160;for&#160;external&#160;connections,&#160;a&#160;virtual<br/>data&#160;center&#160;management&#160;network&#160;(VDC)&#160;that&#160;is&#160;used&#160;for&#160;communication&#160;between&#160;our<br/>data&#160;center&#160;management&#160;components,&#160;and&#160;finally&#160;a&#160;SAN&#160;network&#160;that&#160;provides&#160;storage<br/>to&#160;the&#160;individual&#160;platforms.</p>
<p style="position:absolute;top:782px;left:248px;white-space:nowrap" class="ft1558">Each&#160;virtual&#160;domain&#160;has&#160;a&#160;intra-domain&#160;management&#160;VM&#160;that&#160;runs&#160;the&#160;management</p>
<p style="position:absolute;top:800px;left:226px;white-space:nowrap" class="ft15514">software&#160;of&#160;the&#160;customer&#160;and&#160;connects&#160;to&#160;the&#160;management&#160;network.&#160;This&#160;management<br/>software&#160;interacts&#160;with&#160;a&#160;filtered&#160;XenAPI&#160;(called&#160;XenAPI’)&#160;that&#160;hides&#160;infrastructure&#160;and<br/>machines&#160;belonging&#160;to&#160;other&#160;virtual&#160;domains&#160;and&#160;provides&#160;a&#160;virtual&#160;view&#160;of&#160;the&#160;data<br/>center.&#160;Each&#160;administrator&#160;in&#160;a&#160;virtual&#160;domain&#160;can&#160;then&#160;define&#160;and&#160;start&#160;any&#160;number&#160;of<br/>guest&#160;VMs&#160;that&#160;get&#160;connected&#160;to&#160;the&#160;corresponding&#160;data&#160;network.</p>
<p style="position:absolute;top:918px;left:226px;white-space:nowrap" class="ft15526"><b>11.2</b></p>
<p style="position:absolute;top:918px;left:285px;white-space:nowrap" class="ft15526"><b>Security&#160;Services</b></p>
<p style="position:absolute;top:956px;left:226px;white-space:nowrap" class="ft15515">In&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">[55]</a>,&#160;we&#160;have&#160;described&#160;a&#160;Xen-based&#160;prototype&#160;of&#160;our&#160;security&#160;services&#160;for&#160;integrity<br/>management&#160;and&#160;obtaining&#160;compliance&#160;proofs.&#160;The&#160;prototype&#160;enables&#160;the&#160;protection<br/>of&#160;security&#160;policies&#160;against&#160;modification&#160;and&#160;allows&#160;stakeholders&#160;to&#160;verify&#160;the&#160;poli-<br/>cies&#160;actually&#160;implemented.&#160;The&#160;paper&#160;also&#160;describes&#160;multiple&#160;use&#160;cases,&#160;in&#160;which&#160;we<br/>demonstrated&#160;the&#160;policy&#160;enforcement&#160;and&#160;compliance-checking&#160;capabilities&#160;of&#160;our&#160;im-<br/>plementation.&#160;For&#160;example,&#160;we&#160;showed&#160;how&#160;to&#160;validate&#160;the&#160;configuration&#160;of&#160;the&#160;virtual<br/>networking&#160;subsystem&#160;on&#160;each&#160;host&#160;(assuming&#160;that&#160;a&#160;TPM&#160;is&#160;embedded&#160;in&#160;each&#160;host).</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft15521">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 156 -->
<a name="156"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft156196{font-size:9px;font-family:Helvetica;color:#7f7f7f;}
	.ft156197{font-size:9px;font-family:Helvetica;color:#007f00;}
	.ft156198{font-size:9px;font-family:Helvetica;color:#0000ff;}
	.ft156199{font-size:9px;line-height:9px;font-family:Helvetica;color:#0000ff;}
-->
</style>
<div id="page156-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5156.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1568">154</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft15621">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:360px;left:217px;white-space:nowrap" class="ft156196">VDC</p>
<p style="position:absolute;top:369px;left:217px;white-space:nowrap" class="ft156197">SAN</p>
<p style="position:absolute;top:352px;left:217px;white-space:nowrap" class="ft15643">DMZ</p>
<p style="position:absolute;top:334px;left:202px;white-space:nowrap" class="ft156199">TVDdata<br/>TVDmgn</p>
<p style="position:absolute;top:239px;left:349px;white-space:nowrap" class="ft15643">TVDproxy</p>
<p style="position:absolute;top:249px;left:354px;white-space:nowrap" class="ft15643">Factory</p>
<p style="position:absolute;top:235px;left:288px;white-space:nowrap" class="ft15643">TVDproxy</p>
<p style="position:absolute;top:265px;left:276px;white-space:nowrap" class="ft15643">vSwitch</p>
<p style="position:absolute;top:275px;left:277px;white-space:nowrap" class="ft15643">(mgnt.)</p>
<p style="position:absolute;top:266px;left:324px;white-space:nowrap" class="ft15643">vSwitch</p>
<p style="position:absolute;top:276px;left:328px;white-space:nowrap" class="ft15643">(data)</p>
<p style="position:absolute;top:302px;left:229px;white-space:nowrap" class="ft15669">XenAPI</p>
<p style="position:absolute;top:268px;left:226px;white-space:nowrap" class="ft15643">XenAPI'</p>
<p style="position:absolute;top:302px;left:316px;white-space:nowrap" class="ft15669">Xen</p>
<p style="position:absolute;top:225px;left:216px;white-space:nowrap" class="ft15658">DC&#160;Host&#160;Platform</p>
<p style="position:absolute;top:231px;left:547px;white-space:nowrap" class="ft15644">TVD</p>
<p style="position:absolute;top:241px;left:543px;white-space:nowrap" class="ft15644">Master</p>
<p style="position:absolute;top:331px;left:570px;white-space:nowrap" class="ft156175">F</p>
<p style="position:absolute;top:337px;left:570px;white-space:nowrap" class="ft156175">ire</p>
<p style="position:absolute;top:348px;left:570px;white-space:nowrap" class="ft156175">w</p>
<p style="position:absolute;top:355px;left:570px;white-space:nowrap" class="ft156175">a</p>
<p style="position:absolute;top:360px;left:570px;white-space:nowrap" class="ft156175">ll</p>
<p style="position:absolute;top:331px;left:599px;white-space:nowrap" class="ft156175">In</p>
<p style="position:absolute;top:339px;left:599px;white-space:nowrap" class="ft156175">te</p>
<p style="position:absolute;top:347px;left:599px;white-space:nowrap" class="ft156175">rn</p>
<p style="position:absolute;top:356px;left:599px;white-space:nowrap" class="ft156175">e</p>
<p style="position:absolute;top:361px;left:599px;white-space:nowrap" class="ft156175">t</p>
<p style="position:absolute;top:266px;left:448px;white-space:nowrap" class="ft15684">DHCP<br/>Server</p>
<p style="position:absolute;top:239px;left:468px;white-space:nowrap" class="ft15643">PXEboot</p>
<p style="position:absolute;top:249px;left:473px;white-space:nowrap" class="ft15643">Server</p>
<p style="position:absolute;top:225px;left:404px;white-space:nowrap" class="ft15658">DC&#160;infrastructure&#160;components</p>
<p style="position:absolute;top:293px;left:499px;white-space:nowrap" class="ft15643">SAN/</p>
<p style="position:absolute;top:303px;left:501px;white-space:nowrap" class="ft15643">NFS</p>
<p style="position:absolute;top:266px;left:517px;white-space:nowrap" class="ft15643">Guest</p>
<p style="position:absolute;top:276px;left:520px;white-space:nowrap" class="ft15643">NFS</p>
<p style="position:absolute;top:192px;left:265px;white-space:nowrap" class="ft15684">Intra-TVD&#160;<br/>Mgmt.&#160;VM</p>
<p style="position:absolute;top:192px;left:322px;white-space:nowrap" class="ft15643">TVD&#160;Guest</p>
<p style="position:absolute;top:202px;left:335px;white-space:nowrap" class="ft15643">VMs</p>
<p style="position:absolute;top:239px;left:410px;white-space:nowrap" class="ft15643">VDC&#160;mgnt.</p>
<p style="position:absolute;top:249px;left:419px;white-space:nowrap" class="ft15643">Server</p>
<p style="position:absolute;top:194px;left:324px;white-space:nowrap" class="ft15643">TVD&#160;Guest</p>
<p style="position:absolute;top:204px;left:337px;white-space:nowrap" class="ft15643">VMs</p>
<p style="position:absolute;top:196px;left:325px;white-space:nowrap" class="ft15643">TVD&#160;Guest</p>
<p style="position:absolute;top:205px;left:338px;white-space:nowrap" class="ft15643">VMs</p>
<p style="position:absolute;top:197px;left:327px;white-space:nowrap" class="ft15643">TVD&#160;Guest</p>
<p style="position:absolute;top:207px;left:339px;white-space:nowrap" class="ft15643">VMs</p>
<p style="position:absolute;top:390px;left:254px;white-space:nowrap" class="ft15643">NOTE:&#160;dashed&#160;lines&#160;denote&#160;connections&#160;that&#160;are&#160;internal&#160;to&#160;the&#160;virtual&#160;domain</p>
<p style="position:absolute;top:425px;left:240px;white-space:nowrap" class="ft1568">Figure&#160;11.2:&#160;Layout&#160;of&#160;our&#160;prototype&#160;virtual&#160;data&#160;center.</p>
<p style="position:absolute;top:473px;left:172px;white-space:nowrap" class="ft1568">Here,&#160;we&#160;provide&#160;an&#160;overview&#160;of&#160;our&#160;security&#160;services&#160;implementation.&#160;The&#160;Com-</p>
<p style="position:absolute;top:491px;left:150px;white-space:nowrap" class="ft15615">partment&#160;Manager&#160;(CM)&#160;is&#160;responsible&#160;for&#160;the&#160;VM&#160;life-cycle&#160;management.&#160;As&#160;the<br/>sole&#160;entry&#160;point&#160;for&#160;VM-related&#160;user&#160;commands,&#160;it&#160;communicates&#160;directly&#160;with&#160;the<br/>hypervisor&#160;and&#160;orchestrates&#160;the&#160;Integrity&#160;Manager&#160;and&#160;the&#160;secure&#160;device&#160;virtualization<br/>functions&#160;of&#160;the&#160;platform.&#160;These&#160;functions&#160;base&#160;on&#160;the&#160;standard&#160;Xen&#160;management&#160;tools.</p>
<p style="position:absolute;top:562px;left:172px;white-space:nowrap" class="ft1568">The&#160;CM&#160;through&#160;the&#160;Integrity&#160;Manager&#160;(IM)&#160;is&#160;responsible&#160;for&#160;verifying&#160;the&#160;in-</p>
<p style="position:absolute;top:580px;left:150px;white-space:nowrap" class="ft15614">tegrity&#160;of&#160;the&#160;VMs.&#160;The&#160;root&#160;file&#160;system&#160;is&#160;made&#160;available&#160;to&#160;each&#160;VM,&#160;including<br/>Domain-0,&#160;through&#160;a&#160;pair&#160;of&#160;partitions&#160;or&#160;virtual&#160;disks.&#160;One&#160;of&#160;them&#160;is&#160;read-only,&#160;con-<br/>tains&#160;the&#160;initial&#160;root&#160;file&#160;system,&#160;and&#160;is&#160;measured&#160;together&#160;with&#160;the&#160;VM&#160;configuration<br/>file;&#160;the&#160;resulting&#160;whole&#160;integrity&#160;measurement&#160;of&#160;the&#160;VM&#160;is&#160;then&#160;accumulated&#160;into&#160;the<br/>TPM&#160;by&#160;extending&#160;one&#160;PCR.&#160;The&#160;other&#160;partition&#160;or&#160;virtual&#160;disk,&#160;which&#160;is&#160;read/write<br/>and&#160;empty&#160;at&#160;the&#160;beginning&#160;of&#160;the&#160;VM&#160;life,&#160;records&#160;the&#160;changes&#160;occurring&#160;on&#160;the&#160;root<br/>file&#160;system&#160;while&#160;the&#160;VM&#160;is&#160;running.&#160;This&#160;is&#160;done&#160;through&#160;the&#160;copy-on-write&#160;mecha-<br/>nism&#160;provided&#160;by&#160;<i>unionfs&#160;</i><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[5,&#160;1]&#160;</a>which&#160;allows&#160;the&#160;stacking&#160;of&#160;multiple&#160;file&#160;systems&#160;and<br/>provides&#160;the&#160;operating&#160;system&#160;with&#160;a&#160;unified&#160;view.&#160;CM&#160;and&#160;IM&#160;are&#160;also&#160;responsible&#160;for<br/>guaranteeing&#160;the&#160;confidentiality&#160;of&#160;a&#160;VM’s&#160;data&#160;(stored&#160;on&#160;the&#160;second&#160;read/write&#160;image)<br/>by&#160;encrypting&#160;it&#160;using&#160;<i>dm-crypt&#160;</i><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[2]</a>,&#160;which&#160;is&#160;the&#160;Linux&#160;device&#160;mapper&#160;with&#160;support&#160;for<br/>encrypting&#160;block&#160;devices&#160;(e.g.&#160;physical&#160;or&#160;virtual&#160;disks&#160;and&#160;partitions).&#160;Next,&#160;the&#160;en-<br/>cryption&#160;key&#160;is&#160;sealed&#160;against&#160;the&#160;measurement&#160;of&#160;the&#160;TCB&#160;and&#160;of&#160;the&#160;VM&#160;(stored&#160;in<br/>a&#160;set&#160;of&#160;PCRs).&#160;We&#160;use&#160;this&#160;“sealed&#160;disk”&#160;scheme&#160;to&#160;protect&#160;the&#160;VM’s&#160;confidential<br/>data.&#160;This&#160;scheme&#160;can&#160;be&#160;applied&#160;to&#160;all&#160;disks,&#160;except&#160;the&#160;root&#160;image,&#160;depending&#160;on&#160;the<br/>security&#160;requirements&#160;given.</p>
<p style="position:absolute;top:867px;left:172px;white-space:nowrap" class="ft1568">The&#160;TVD&#160;policy&#160;defines,&#160;for&#160;each&#160;VM,&#160;the&#160;disks&#160;that&#160;need&#160;to&#160;be&#160;measured,&#160;the</p>
<p style="position:absolute;top:885px;left:150px;white-space:nowrap" class="ft15614">PCR(s)&#160;in&#160;which&#160;the&#160;measurements&#160;need&#160;to&#160;be&#160;stored,&#160;and&#160;the&#160;disks&#160;that&#160;need&#160;to&#160;be<br/>sealed.</p>
<p style="position:absolute;top:903px;left:208px;white-space:nowrap" class="ft1568">Once&#160;the&#160;policy&#160;has&#160;been&#160;executed&#160;and&#160;all&#160;disks&#160;have&#160;been&#160;prepared&#160;(mea-</p>
<p style="position:absolute;top:921px;left:150px;white-space:nowrap" class="ft15615">sured/unsealed),&#160;the&#160;admission&#160;protocol&#160;involving&#160;the&#160;CM&#160;and&#160;the&#160;TVD&#160;Proxy&#160;(see<br/>Sections&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#28">3.4&#160;</a>and&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#157">11.3)&#160;</a>follows.&#160;Then&#160;the&#160;CM&#160;requests&#160;Xen&#160;to&#160;start&#160;the&#160;VM.&#160;To&#160;manage<br/>VMs,&#160;the&#160;CM&#160;maintains&#160;the&#160;association&#160;between&#160;a&#160;running&#160;VM&#160;and&#160;the&#160;policy&#160;that&#160;was<br/>used&#160;to&#160;start&#160;it.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft15621">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 157 -->
<a name="157"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page157-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5157.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1578">CHAPTER&#160;11.&#160;SECURITY&#160;MANAGEMENT&#160;DEMONSTRATOR</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1578">155</p>
<p style="position:absolute;top:189px;left:226px;white-space:nowrap" class="ft15726"><b>11.3</b></p>
<p style="position:absolute;top:189px;left:285px;white-space:nowrap" class="ft15726"><b>TVD&#160;Master,&#160;Proxies&#160;and&#160;Proxy&#160;Factories</b></p>
<p style="position:absolute;top:227px;left:226px;white-space:nowrap" class="ft15715">The&#160;TVD&#160;policy&#160;of&#160;our&#160;prototype&#160;lists&#160;all&#160;VMs&#160;that&#160;can&#160;potentially&#160;be&#160;admitted&#160;to&#160;the<br/>TVD.&#160;Each&#160;VM&#160;is&#160;identified&#160;by&#160;the&#160;Xen&#160;domain&#160;identifier.&#160;For&#160;each&#160;VM,&#160;the&#160;policy<br/>specifies&#160;the&#160;required&#160;integrity&#160;measurement&#160;value.&#160;Only&#160;if&#160;the&#160;VM’s&#160;actual&#160;measure-<br/>ment&#160;value&#160;(obtained&#160;by&#160;the&#160;CM)&#160;matches&#160;the&#160;required&#160;value&#160;the&#160;VM&#160;will&#160;be&#160;admitted<br/>to&#160;the&#160;TVD.&#160;The&#160;policy&#160;also&#160;specifies&#160;the&#160;MAC&#160;address&#160;assigned&#160;to&#160;the&#160;VM’s&#160;virtual<br/>NIC,&#160;if&#160;the&#160;admission&#160;is&#160;successful.&#160;Moreover,&#160;it&#160;identifies&#160;the&#160;VLAN&#160;corresponding<br/>to&#160;the&#160;TVD,&#160;and&#160;the&#160;VPN&#160;keys&#160;needed&#160;for&#160;establishing&#160;secure&#160;connections&#160;within&#160;the<br/>TVD.&#160;Currently&#160;one&#160;shared&#160;key&#160;per&#160;TVD&#160;is&#160;used&#160;to&#160;protect&#160;all&#160;insecure&#160;links.</p>
<p style="position:absolute;top:370px;left:248px;white-space:nowrap" class="ft1578">When&#160;a&#160;VM&#160;wants&#160;to&#160;be&#160;admitted&#160;to&#160;the&#160;TVD&#160;(i.e.,&#160;this&#160;is&#160;stated&#160;in&#160;the&#160;configuration</p>
<p style="position:absolute;top:388px;left:226px;white-space:nowrap" class="ft15714">file&#160;of&#160;the&#160;VM),&#160;the&#160;related&#160;TVD&#160;Proxy&#160;is&#160;contacted&#160;by&#160;CM&#160;using&#160;a&#160;stateless&#160;TCP-<br/>based&#160;protocol&#160;called&#160;Compartment&#160;Admission&#160;Protocol&#160;(CAP).&#160;Since&#160;a&#160;platform&#160;can<br/>host&#160;VMs&#160;belonging&#160;to&#160;different&#160;TVDs,&#160;the&#160;CM&#160;contacts&#160;the&#160;TVD&#160;Proxy&#160;Factory&#160;to<br/>obtain&#160;the&#160;TVD&#160;Proxy&#160;end-point&#160;for&#160;the&#160;requested&#160;TVD.&#160;If&#160;such&#160;TVD&#160;Proxy&#160;is&#160;not<br/>running&#160;yet,&#160;the&#160;TVD&#160;Proxy&#160;Factory&#160;creates&#160;and&#160;spawns&#160;it.&#160;Before&#160;starting&#160;the&#160;VM,<br/>CM&#160;measures&#160;it&#160;(as&#160;explained&#160;in&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#155">11.2)&#160;</a>and&#160;asks&#160;the&#160;TVD&#160;Proxy&#160;whether&#160;the<br/>VM&#160;can&#160;be&#160;admitted&#160;to&#160;the&#160;TVD&#160;by&#160;passing&#160;the&#160;identifier&#160;and&#160;the&#160;measurement&#160;of&#160;the<br/>VM.&#160;If&#160;the&#160;answer&#160;is&#160;positive,&#160;CM&#160;receives&#160;the&#160;MAC&#160;address&#160;specified&#160;in&#160;the&#160;policy<br/>from&#160;the&#160;TVD&#160;Proxy,&#160;creates&#160;the&#160;back-end&#160;network&#160;device&#160;(see&#160;Section&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#157">11.4&#160;</a>for&#160;further<br/>explanations&#160;about&#160;Xen&#160;back-end&#160;and&#160;front-end&#160;devices),&#160;and&#160;sets&#160;the&#160;MAC&#160;address<br/>for&#160;the&#160;front-end&#160;device.&#160;Finally,&#160;the&#160;CM&#160;requests&#160;the&#160;TVD&#160;Proxy&#160;to&#160;attach&#160;the&#160;VM&#160;to<br/>the&#160;virtual&#160;switch&#160;(vSwitch)&#160;of&#160;the&#160;VLAN&#160;corresponding&#160;to&#160;the&#160;TVD&#160;by&#160;specifying&#160;the<br/>identifier,&#160;measurement&#160;value,&#160;and&#160;the&#160;names&#160;of&#160;back-end&#160;devices&#160;for&#160;the&#160;VM&#160;being<br/>admitted.&#160;In&#160;the&#160;case&#160;of&#160;a&#160;negative&#160;response&#160;from&#160;the&#160;TVD&#160;Proxy,&#160;the&#160;CM&#160;can&#160;be<br/>configured&#160;to&#160;either&#160;start&#160;the&#160;VM&#160;even&#160;though&#160;it&#160;will&#160;not&#160;be&#160;connected&#160;to&#160;the&#160;TVD<br/>VLAN&#160;or&#160;not&#160;to&#160;start&#160;it&#160;at&#160;all.</p>
<p style="position:absolute;top:703px;left:226px;white-space:nowrap" class="ft15726"><b>11.4</b></p>
<p style="position:absolute;top:703px;left:285px;white-space:nowrap" class="ft15726"><b>Secure&#160;Virtual&#160;Network&#160;subsystem</b></p>
<p style="position:absolute;top:741px;left:226px;white-space:nowrap" class="ft15715">The&#160;prototype&#160;implementation&#160;of&#160;our&#160;Secure&#160;Virtual&#160;Network&#160;subsystem&#160;has&#160;been&#160;doc-<br/>umented&#160;in&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[18]&#160;</a>and&#160;has&#160;been&#160;integrated&#160;in&#160;the&#160;prototype&#160;being&#160;presented&#160;in&#160;this&#160;paper.<br/>Our&#160;networking&#160;extensions&#160;consist&#160;of&#160;vSwitches,&#160;VLAN&#160;tagging,&#160;and&#160;LAN&#160;encapsula-<br/>tion&#160;modules.&#160;They&#160;are&#160;implemented&#160;as&#160;kernel&#160;modules&#160;in&#160;Domain-0,&#160;which&#160;also&#160;acts<br/>as&#160;the&#160;driver&#160;VM&#160;for&#160;the&#160;physical&#160;NIC(s)&#160;of&#160;each&#160;physical&#160;host.</p>
<p style="position:absolute;top:831px;left:248px;white-space:nowrap" class="ft1578">To&#160;specify&#160;the&#160;particular&#160;vSwitch&#160;and&#160;the&#160;particular&#160;port&#160;in&#160;the&#160;vSwitch&#160;to&#160;which&#160;a</p>
<p style="position:absolute;top:849px;left:226px;white-space:nowrap" class="ft15714">VM’s&#160;Xen&#160;back-end&#160;device&#160;must&#160;be&#160;attached,&#160;the&#160;Xen&#160;VM&#160;configuration&#160;file&#160;is&#160;used.<br/>This&#160;file&#160;is&#160;generated&#160;by&#160;CM&#160;after&#160;having&#160;received&#160;information&#160;(MAC&#160;address&#160;and<br/>VLAN&#160;identifier)&#160;from&#160;the&#160;TVD&#160;Proxy.&#160;We&#160;use&#160;additional&#160;scripts&#160;to&#160;specify&#160;whether<br/>a&#160;particular&#160;vSwitch&#160;should&#160;use&#160;one&#160;or&#160;both&#160;of&#160;the&#160;VLAN&#160;tagging&#160;and&#160;encapsulation<br/>mechanisms&#160;for&#160;isolating&#160;separate&#160;virtual&#160;networks.</p>
<p style="position:absolute;top:939px;left:248px;white-space:nowrap" class="ft1578">The&#160;vSwitches&#160;maintain&#160;a&#160;table&#160;mapping&#160;virtual&#160;network&#160;devices&#160;to&#160;ports&#160;on&#160;a&#160;par-</p>
<p style="position:absolute;top:956px;left:226px;white-space:nowrap" class="ft15714">ticular&#160;vSwitch.&#160;The&#160;encapsulation&#160;module&#160;implements&#160;EtherIP&#160;processing&#160;for&#160;packets<br/>coming&#160;out&#160;of&#160;and&#160;destined&#160;for&#160;the&#160;VMs.&#160;The&#160;VLAN&#160;segments&#160;associated&#160;with&#160;dif-<br/>ferent&#160;TVDs&#160;and&#160;the&#160;corresponding&#160;vSwitches&#160;are&#160;assigned&#160;unique&#160;identifiers.&#160;The<br/>network&#160;identifier&#160;field&#160;in&#160;the&#160;EtherIP&#160;packets&#160;is&#160;set&#160;to&#160;the&#160;identifier&#160;of&#160;the&#160;vSwitch&#160;that<br/>the&#160;target&#160;VM&#160;is&#160;attached&#160;to.</p>
<p style="position:absolute;top:1046px;left:248px;white-space:nowrap" class="ft1578">The&#160;VLAN&#160;tagging&#160;module&#160;tags&#160;the&#160;packet&#160;with&#160;the&#160;VLAN&#160;identifier&#160;corresponding</p>
<p style="position:absolute;top:1064px;left:226px;white-space:nowrap" class="ft1578">to&#160;the&#160;VLAN&#160;that&#160;the&#160;target&#160;VM&#160;is&#160;a&#160;part&#160;of.&#160;At&#160;the&#160;destination&#160;platform,&#160;the&#160;VLAN</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft15721">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 158 -->
<a name="158"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page158-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5158.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1588">156</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft15821">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft15814">module&#160;removes&#160;the&#160;VLAN&#160;tags,&#160;and&#160;routes&#160;the&#160;packets&#160;to&#160;the&#160;appropriate&#160;vSwitch<br/>based&#160;on&#160;the&#160;VLAN&#160;tag.</p>
<p style="position:absolute;top:257px;left:150px;white-space:nowrap" class="ft15826"><b>11.5</b></p>
<p style="position:absolute;top:257px;left:209px;white-space:nowrap" class="ft15826"><b>Trusted&#160;Channel&#160;Proxies</b></p>
<p style="position:absolute;top:295px;left:150px;white-space:nowrap" class="ft15815">The&#160;Trusted&#160;Channel&#160;between&#160;TVD&#160;Proxy&#160;Factory&#160;and&#160;TVD&#160;Master&#160;used&#160;during&#160;the<br/>pre-admission&#160;phase&#160;is&#160;set&#160;up&#160;by&#160;means&#160;of&#160;a&#160;pair&#160;of&#160;services&#160;called&#160;Trusted&#160;Channel<br/>proxies.&#160;They&#160;implement&#160;the&#160;Trusted&#160;Channel&#160;at&#160;the&#160;application&#160;layer&#160;via&#160;a&#160;TLS&#160;tun-<br/>nel,&#160;made&#160;available&#160;to&#160;TVD&#160;Proxy&#160;Factory&#160;and&#160;Master&#160;once&#160;remote&#160;attestation&#160;has&#160;been<br/>successful.&#160;The&#160;remote&#160;attestation&#160;is&#160;done&#160;by&#160;performing&#160;the</p>
<p style="position:absolute;top:368px;left:520px;white-space:nowrap" class="ft15834">TPM_Quote</p>
<p style="position:absolute;top:367px;left:605px;white-space:nowrap" class="ft1588">operation,</p>
<p style="position:absolute;top:385px;left:150px;white-space:nowrap" class="ft15814">namely,&#160;digitally&#160;signing&#160;a&#160;set&#160;of&#160;PCRs&#160;and&#160;a&#160;challenge&#160;received&#160;from&#160;the&#160;remote&#160;at-<br/>tester&#160;using&#160;a&#160;TPM&#160;asymmetric&#160;key.&#160;The&#160;latter&#160;can&#160;be&#160;certified&#160;as&#160;Attestation&#160;Identity<br/>Key&#160;(AIK)&#160;by&#160;a&#160;Privacy&#160;CA.&#160;The&#160;result&#160;of&#160;the</p>
<p style="position:absolute;top:422px;left:419px;white-space:nowrap" class="ft15834">TPM_Quote</p>
<p style="position:absolute;top:421px;left:502px;white-space:nowrap" class="ft1588">operation&#160;(i.e.&#160;the&#160;signature</p>
<p style="position:absolute;top:439px;left:150px;white-space:nowrap" class="ft15814">over&#160;a&#160;set&#160;of&#160;PCR&#160;values),&#160;the&#160;actual&#160;PCR&#160;values&#160;and&#160;the&#160;AIK&#160;Public&#160;Key&#160;Certificate<br/>are&#160;sent&#160;by&#160;the&#160;TVD&#160;Proxy&#160;Factory&#160;to&#160;the&#160;TVD&#160;Master&#160;to&#160;be&#160;verified.&#160;If&#160;the&#160;verifi-<br/>cation&#160;is&#160;successful,&#160;then&#160;the&#160;remote&#160;attestation&#160;can&#160;be&#160;considered&#160;successful,&#160;and&#160;the<br/>two&#160;proxies&#160;start&#160;tunneling&#160;the&#160;incoming&#160;TCP&#160;packets&#160;through&#160;the&#160;TLS&#160;channel.&#160;An<br/>alternative&#160;implementation&#160;for&#160;attesting&#160;via&#160;Trusted&#160;Channel&#160;is&#160;documented&#160;in&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#167">[9]&#160;</a>and<br/>will&#160;be&#160;integrated&#160;in&#160;our&#160;prototype.&#160;This&#160;approach&#160;replaces&#160;the</p>
<p style="position:absolute;top:529px;left:525px;white-space:nowrap" class="ft15834">TPM_Quote</p>
<p style="position:absolute;top:529px;left:609px;white-space:nowrap" class="ft1588">operation</p>
<p style="position:absolute;top:546px;left:150px;white-space:nowrap" class="ft1588">with&#160;the&#160;usage&#160;of&#160;sealing&#160;and&#160;TPM&#160;certified&#160;keys.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft15821">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 159 -->
<a name="159"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page159-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5159.png" alt="background image"/>
<p style="position:absolute;top:295px;left:226px;white-space:nowrap" class="ft15925"><b>Chapter&#160;12</b></p>
<p style="position:absolute;top:365px;left:226px;white-space:nowrap" class="ft15922"><b>Evaluation&#160;of&#160;the&#160;Prototype</b></p>
<p style="position:absolute;top:463px;left:226px;white-space:nowrap" class="ft15926"><b>12.1</b></p>
<p style="position:absolute;top:463px;left:285px;white-space:nowrap" class="ft15926"><b>Performance&#160;Evaluation</b></p>
<p style="position:absolute;top:500px;left:226px;white-space:nowrap" class="ft15915">We&#160;implemented&#160;our&#160;data&#160;center&#160;prototype&#160;using&#160;HP&#160;ProLiant&#160;BL25p&#160;G2&#160;blade&#160;servers<br/>each&#160;fitted&#160;with&#160;two&#160;AMD&#160;Opteron&#160;processors&#160;running&#160;at&#160;2&#160;GHz,&#160;8GB&#160;system&#160;memory<br/>and&#160;a&#160;Gigabit&#160;Ethernet&#160;card.&#160;We&#160;now&#160;discuss&#160;the&#160;performance&#160;of&#160;our&#160;prototype.&#160;Most<br/>of&#160;our&#160;components&#160;implement&#160;or&#160;support&#160;management&#160;tasks.&#160;They&#160;are&#160;dedicated&#160;to<br/>automate&#160;the&#160;secure&#160;set-up&#160;of&#160;platforms,&#160;virtual&#160;machines&#160;and&#160;domains,&#160;if&#160;possible<br/>with&#160;minimal&#160;performance&#160;impact&#160;on&#160;the&#160;running&#160;system.</p>
<p style="position:absolute;top:608px;left:248px;white-space:nowrap" class="ft1598">Note&#160;that&#160;measuring&#160;performance&#160;of&#160;virtual&#160;systems&#160;is&#160;not&#160;straightforward.&#160;We</p>
<p style="position:absolute;top:626px;left:226px;white-space:nowrap" class="ft1598">first&#160;used</p>
<p style="position:absolute;top:627px;left:286px;white-space:nowrap" class="ft15934">iostat</p>
<p style="position:absolute;top:626px;left:345px;white-space:nowrap" class="ft1598">to&#160;retrieve&#160;CPU&#160;usage&#160;data&#160;from</p>
<p style="position:absolute;top:627px;left:546px;white-space:nowrap" class="ft15934"><a href="/proc/stat">/proc/stat</a></p>
<p style="position:absolute;top:626px;left:641px;white-space:nowrap" class="ft1598">under&#160;Linux&#160;and</p>
<p style="position:absolute;top:644px;left:226px;white-space:nowrap" class="ft15914">in&#160;Domain-0.&#160;This&#160;wrongly&#160;indicated&#160;that&#160;Xen&#160;needs&#160;half&#160;the&#160;CPU&#160;as&#160;compared&#160;to<br/>Linux.&#160;We&#160;then&#160;used&#160;the&#160;Xen&#160;tool</p>
<p style="position:absolute;top:663px;left:433px;white-space:nowrap" class="ft15934">xentop</p>
<p style="position:absolute;top:662px;left:491px;white-space:nowrap" class="ft1598">that&#160;gathers&#160;the&#160;data&#160;via&#160;hyper-calls&#160;to&#160;the</p>
<p style="position:absolute;top:680px;left:226px;white-space:nowrap" class="ft15914">hypervisor.&#160;Since&#160;this&#160;represents&#160;the&#160;time&#160;given&#160;to&#160;each&#160;VM&#160;(Domain-0,&#160;guest&#160;VM)&#160;by<br/>the&#160;hypervisor,&#160;the&#160;resulting&#160;data&#160;was&#160;no&#160;longer&#160;distorted&#160;by&#160;the&#160;virtual&#160;notion&#160;of&#160;time<br/>given&#160;to&#160;the&#160;VMs&#160;in&#160;Xen.</p>
<p style="position:absolute;top:756px;left:226px;white-space:nowrap" class="ft15924"><b>12.1.1</b></p>
<p style="position:absolute;top:756px;left:289px;white-space:nowrap" class="ft15924"><b>Management</b></p>
<p style="position:absolute;top:786px;left:226px;white-space:nowrap" class="ft15914">In&#160;Table&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#159">12.1&#160;</a>compares&#160;the&#160;boot-up&#160;and&#160;shut-down&#160;delay&#160;between&#160;for&#160;virtual&#160;machines<br/>using&#160;the&#160;unmodified&#160;Xen&#160;implementation&#160;and&#160;our&#160;components.&#160;Averaged&#160;over&#160;235<br/>measurements,&#160;our&#160;components&#160;add&#160;some&#160;10&#160;percent&#160;to&#160;the&#160;the&#160;original&#160;time-to&#160;boot.<br/>The&#160;delay&#160;is&#160;caused&#160;by&#160;measuring&#160;the&#160;configuration,&#160;attesting&#160;to&#160;the&#160;VM,&#160;transferring<br/>and&#160;checking&#160;configuration&#160;measurements,&#160;and&#160;(in&#160;case&#160;of&#160;success)&#160;attaching&#160;the&#160;VM<br/>to&#160;the&#160;corresponding&#160;network.&#160;Stopping&#160;a&#160;virtual&#160;machine&#160;requires&#160;2.4s&#160;instead&#160;of&#160;0.5s<br/>for&#160;the&#160;original&#160;Xen&#160;implementation.&#160;Here,&#160;the&#160;overhead&#160;is&#160;caused&#160;by&#160;the&#160;fact&#160;that<br/>the&#160;current&#160;implementation&#160;of&#160;the&#160;compartment&#160;manager&#160;polls&#160;the&#160;VM&#160;in&#160;rather&#160;long<br/>intervals&#160;to&#160;verify&#160;a&#160;successful&#160;shut-down.</p>
<p style="position:absolute;top:976px;left:498px;white-space:nowrap" class="ft15923"><b>System&#160;Measured</b></p>
<p style="position:absolute;top:993px;left:353px;white-space:nowrap" class="ft15923"><b>Operation</b></p>
<p style="position:absolute;top:993px;left:495px;white-space:nowrap" class="ft15923"><b>Prototype</b></p>
<p style="position:absolute;top:993px;left:582px;white-space:nowrap" class="ft15923"><b>Xen</b></p>
<p style="position:absolute;top:1012px;left:353px;white-space:nowrap" class="ft1598">Management</p>
<p style="position:absolute;top:1012px;left:449px;white-space:nowrap" class="ft1598">Start</p>
<p style="position:absolute;top:1012px;left:507px;white-space:nowrap" class="ft1598">3.601s</p>
<p style="position:absolute;top:1012px;left:576px;white-space:nowrap" class="ft1598">3.332s</p>
<p style="position:absolute;top:1030px;left:449px;white-space:nowrap" class="ft1598">Stop</p>
<p style="position:absolute;top:1030px;left:507px;white-space:nowrap" class="ft1598">2.371s</p>
<p style="position:absolute;top:1030px;left:576px;white-space:nowrap" class="ft1598">0.460s</p>
<p style="position:absolute;top:1062px;left:314px;white-space:nowrap" class="ft1598">Table&#160;12.1:&#160;Performance&#160;Measurements&#160;of&#160;our&#160;Prototype</p>
<p style="position:absolute;top:1117px;left:473px;white-space:nowrap" class="ft1598">157</p>
</div>
<!-- Page 160 -->
<a name="160"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page160-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5160.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1608">158</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft16021">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:191px;left:208px;white-space:nowrap" class="ft1608">Throughput</p>
<p style="position:absolute;top:191px;left:298px;white-space:nowrap" class="ft1608">Linux</p>
<p style="position:absolute;top:191px;left:351px;white-space:nowrap" class="ft1608">VLAN&#160;Tagging</p>
<p style="position:absolute;top:191px;left:463px;white-space:nowrap" class="ft1608">Xen&#160;Bridging</p>
<p style="position:absolute;top:191px;left:563px;white-space:nowrap" class="ft1608">EtherIP</p>
<p style="position:absolute;top:210px;left:209px;white-space:nowrap" class="ft1608">TX&#160;(Mbps)</p>
<p style="position:absolute;top:210px;left:304px;white-space:nowrap" class="ft1608">932</p>
<p style="position:absolute;top:210px;left:387px;white-space:nowrap" class="ft1608">883</p>
<p style="position:absolute;top:210px;left:493px;white-space:nowrap" class="ft1608">872</p>
<p style="position:absolute;top:210px;left:575px;white-space:nowrap" class="ft1608">847</p>
<p style="position:absolute;top:228px;left:209px;white-space:nowrap" class="ft1608">RX&#160;(Mbps)</p>
<p style="position:absolute;top:228px;left:304px;white-space:nowrap" class="ft1608">932</p>
<p style="position:absolute;top:228px;left:387px;white-space:nowrap" class="ft1608">881</p>
<p style="position:absolute;top:228px;left:493px;white-space:nowrap" class="ft1608">870</p>
<p style="position:absolute;top:228px;left:575px;white-space:nowrap" class="ft1608">851</p>
<p style="position:absolute;top:246px;left:206px;white-space:nowrap" class="ft1608">Comparison</p>
<p style="position:absolute;top:246px;left:298px;white-space:nowrap" class="ft1608">100%</p>
<p style="position:absolute;top:246px;left:375px;white-space:nowrap" class="ft1608">56.79%</p>
<p style="position:absolute;top:246px;left:481px;white-space:nowrap" class="ft1608">55.98%</p>
<p style="position:absolute;top:246px;left:563px;white-space:nowrap" class="ft1608">54.69%</p>
<p style="position:absolute;top:278px;left:197px;white-space:nowrap" class="ft1608">Table&#160;12.2:&#160;NetPerf&#160;Benchmark:&#160;Guest&#160;VM&#160;to&#160;Guest&#160;VM&#160;Throughput.</p>
<p style="position:absolute;top:311px;left:280px;white-space:nowrap" class="ft1608">Minimum</p>
<p style="position:absolute;top:311px;left:358px;white-space:nowrap" class="ft1608">Average</p>
<p style="position:absolute;top:311px;left:425px;white-space:nowrap" class="ft1608">Maximum</p>
<p style="position:absolute;top:311px;left:505px;white-space:nowrap" class="ft1608">Mean&#160;Deviation</p>
<p style="position:absolute;top:330px;left:214px;white-space:nowrap" class="ft1608">Bridged</p>
<p style="position:absolute;top:330px;left:290px;white-space:nowrap" class="ft1608">0.136s</p>
<p style="position:absolute;top:330px;left:363px;white-space:nowrap" class="ft1608">0.180s</p>
<p style="position:absolute;top:330px;left:436px;white-space:nowrap" class="ft1608">0.294s</p>
<p style="position:absolute;top:330px;left:534px;white-space:nowrap" class="ft1608">0.024s</p>
<p style="position:absolute;top:348px;left:217px;white-space:nowrap" class="ft1608">VLAN</p>
<p style="position:absolute;top:348px;left:290px;white-space:nowrap" class="ft1608">0.140s</p>
<p style="position:absolute;top:348px;left:363px;white-space:nowrap" class="ft1608">0.212s</p>
<p style="position:absolute;top:348px;left:436px;white-space:nowrap" class="ft1608">0.357s</p>
<p style="position:absolute;top:348px;left:534px;white-space:nowrap" class="ft1608">0.030s</p>
<p style="position:absolute;top:366px;left:215px;white-space:nowrap" class="ft1608">EtherIP</p>
<p style="position:absolute;top:366px;left:290px;white-space:nowrap" class="ft1608">0.151s</p>
<p style="position:absolute;top:366px;left:363px;white-space:nowrap" class="ft1608">0.246s</p>
<p style="position:absolute;top:366px;left:436px;white-space:nowrap" class="ft1608">0.378s</p>
<p style="position:absolute;top:366px;left:534px;white-space:nowrap" class="ft1608">0.034s</p>
<p style="position:absolute;top:398px;left:283px;white-space:nowrap" class="ft1608">Table&#160;12.3:&#160;Round-trip&#160;Times&#160;using&#160;Ping.</p>
<p style="position:absolute;top:460px;left:150px;white-space:nowrap" class="ft16024"><b>12.1.2</b></p>
<p style="position:absolute;top:460px;left:213px;white-space:nowrap" class="ft16024"><b>Networking</b></p>
<p style="position:absolute;top:490px;left:150px;white-space:nowrap" class="ft1608">We&#160;obtained&#160;the&#160;throughput&#160;results&#160;using&#160;the</p>
<p style="position:absolute;top:491px;left:428px;white-space:nowrap" class="ft16034">NetPerf</p>
<p style="position:absolute;top:490px;left:496px;white-space:nowrap" class="ft1608">network&#160;benchmark&#160;and&#160;the</p>
<p style="position:absolute;top:508px;left:150px;white-space:nowrap" class="ft1608">latency&#160;results&#160;using&#160;the</p>
<p style="position:absolute;top:509px;left:302px;white-space:nowrap" class="ft16034">ping</p>
<p style="position:absolute;top:508px;left:343px;white-space:nowrap" class="ft1608">tool.&#160;Using&#160;the&#160;former&#160;benchmark,&#160;we&#160;measured&#160;the</p>
<p style="position:absolute;top:526px;left:150px;white-space:nowrap" class="ft16014">Tx&#160;(outgoing)&#160;and&#160;Rx&#160;(incoming)&#160;throughput&#160;for&#160;traffic&#160;from&#160;one&#160;guest&#160;VM&#160;to&#160;another<br/>guest&#160;VM&#160;on&#160;the&#160;same&#160;physical&#160;host.&#160;To&#160;do&#160;so,&#160;we&#160;ran&#160;one&#160;instance&#160;of&#160;the&#160;benchmark<br/>on&#160;one&#160;guest&#160;VM&#160;as&#160;a&#160;server&#160;process&#160;and&#160;another&#160;instance&#160;on&#160;the&#160;second&#160;guest&#160;VM&#160;to<br/>do&#160;the&#160;actual&#160;benchmark.</p>
<p style="position:absolute;top:597px;left:172px;white-space:nowrap" class="ft1608">We&#160;report&#160;the&#160;throughput&#160;results&#160;for&#160;different&#160;networking&#160;schemes&#160;in&#160;Table&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#160">12.2.</a></p>
<p style="position:absolute;top:615px;left:150px;white-space:nowrap" class="ft16014">The&#160;figures&#160;show&#160;that&#160;the&#160;throughput&#160;results&#160;for&#160;both&#160;VLAN&#160;tagging&#160;and&#160;EtherIP<br/>schemes&#160;are&#160;comparable&#160;to&#160;that&#160;of&#160;the&#160;standard&#160;Xen&#160;(bridge)&#160;configuration.&#160;As&#160;ex-<br/>pected,&#160;VLAN&#160;tagging&#160;yields&#160;the&#160;best&#160;throughput&#160;in&#160;a&#160;virtualized&#160;system&#160;that&#160;outper-<br/>forms&#160;the&#160;standard&#160;Xen&#160;configuration.&#160;Both&#160;Xen&#160;bridging&#160;and&#160;VLAN&#160;tagging&#160;perform<br/>better&#160;on&#160;the&#160;<b>Tx&#160;path</b>.&#160;For&#160;EtherIP,&#160;the&#160;major&#160;cost&#160;in&#160;the&#160;Tx&#160;path&#160;is&#160;having&#160;to&#160;allocate&#160;a<br/>fresh&#160;socket&#160;buffer&#160;(</p>
<p style="position:absolute;top:706px;left:271px;white-space:nowrap" class="ft16034">skb</p>
<p style="position:absolute;top:705px;left:298px;white-space:nowrap" class="ft1608">)&#160;and&#160;copy&#160;the&#160;original&#160;buffer&#160;data&#160;into&#160;the&#160;fresh</p>
<p style="position:absolute;top:706px;left:593px;white-space:nowrap" class="ft16034">skb</p>
<p style="position:absolute;top:705px;left:620px;white-space:nowrap" class="ft1608">.&#160;When</p>
<p style="position:absolute;top:723px;left:150px;white-space:nowrap" class="ft1608">first&#160;allocating&#160;a</p>
<p style="position:absolute;top:724px;left:252px;white-space:nowrap" class="ft16034">skb</p>
<p style="position:absolute;top:723px;left:279px;white-space:nowrap" class="ft1608">,&#160;the&#160;Linux&#160;network&#160;stack&#160;allocates&#160;a&#160;fixed&#160;amount&#160;of&#160;headroom</p>
<p style="position:absolute;top:741px;left:150px;white-space:nowrap" class="ft16014">for&#160;the&#160;expected&#160;headers&#160;that&#160;will&#160;be&#160;added&#160;to&#160;the&#160;packet&#160;as&#160;it&#160;goes&#160;down&#160;the&#160;stack.<br/>Unfortunately,&#160;not&#160;enough&#160;space&#160;is&#160;allocated&#160;upfront&#160;to&#160;allow&#160;us&#160;to&#160;fit&#160;in&#160;the&#160;EtherIP<br/>header;&#160;so,&#160;we&#160;have&#160;to&#160;copy&#160;the&#160;data&#160;around,&#160;which&#160;is&#160;very&#160;costly.</p>
<p style="position:absolute;top:795px;left:172px;white-space:nowrap" class="ft1608">In&#160;the&#160;Rx&#160;path,&#160;there&#160;is&#160;no&#160;packet-copying&#160;overhead&#160;for&#160;the&#160;EtherIP&#160;approach;&#160;the</p>
<p style="position:absolute;top:813px;left:150px;white-space:nowrap" class="ft16014">extra&#160;EtherIP&#160;header&#160;merely&#160;has&#160;to&#160;be&#160;removed&#160;before&#160;the&#160;packet&#160;is&#160;sent&#160;to&#160;a&#160;VM.&#160;As<br/>compared&#160;to&#160;VLAN&#160;tagging,&#160;in&#160;which&#160;packets&#160;are&#160;grabbed&#160;from&#160;the&#160;Linux&#160;network<br/>stack,&#160;EtherIP&#160;requires&#160;that&#160;packets&#160;are&#160;passed&#160;to&#160;and&#160;processed&#160;by&#160;the&#160;host&#160;OS&#160;IP<br/>stack&#160;before&#160;they&#160;are&#160;handed&#160;over&#160;to&#160;the&#160;EtherIP&#160;packet&#160;handler&#160;of&#160;the&#160;vSwitch&#160;code.</p>
<p style="position:absolute;top:884px;left:172px;white-space:nowrap" class="ft1608">Table&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#160">12.3&#160;</a>shows&#160;the&#160;round-trip&#160;times&#160;between&#160;two&#160;guest&#160;VMs&#160;on&#160;a&#160;physical&#160;host</p>
<p style="position:absolute;top:902px;left:150px;white-space:nowrap" class="ft1608">for&#160;the&#160;bridged,&#160;VLAN,&#160;and&#160;EtherIP&#160;encapsulation&#160;cases&#160;obtained&#160;using&#160;the</p>
<p style="position:absolute;top:903px;left:603px;white-space:nowrap" class="ft16034">ping&#160;-c</p>
<p style="position:absolute;top:921px;left:150px;white-space:nowrap" class="ft16034">1000&#160;host</p>
<p style="position:absolute;top:920px;left:236px;white-space:nowrap" class="ft1608">command,&#160;i.e.,&#160;1000&#160;packets&#160;sent.&#160;The&#160;results&#160;show&#160;that&#160;the&#160;average</p>
<p style="position:absolute;top:938px;left:150px;white-space:nowrap" class="ft16014">round-trip&#160;times&#160;for&#160;VLAN&#160;and&#160;EtherIP&#160;encapsulation&#160;are&#160;17.8%&#160;and&#160;36.7%&#160;higher<br/>than&#160;that&#160;of&#160;the&#160;standard&#160;Xen&#160;bridged&#160;configuration.</p>
<p style="position:absolute;top:997px;left:150px;white-space:nowrap" class="ft16024"><b>12.1.3</b></p>
<p style="position:absolute;top:997px;left:213px;white-space:nowrap" class="ft16024"><b>Storage</b></p>
<p style="position:absolute;top:1027px;left:150px;white-space:nowrap" class="ft16014">Timing&#160;the&#160;set-up&#160;of&#160;storage&#160;has&#160;been&#160;part&#160;of&#160;the&#160;management&#160;evaluation.&#160;We&#160;now<br/>evaluate&#160;actual&#160;run-time&#160;performance&#160;of&#160;virtual&#160;disks.</p>
<p style="position:absolute;top:1063px;left:172px;white-space:nowrap" class="ft1608">We&#160;compared&#160;three&#160;set-ups&#160;using&#160;an&#160;IBM&#160;Thinkpad&#160;T60p:&#160;Disk&#160;access&#160;from&#160;Dom0,</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft16021">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 161 -->
<a name="161"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page161-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5161.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1618">CHAPTER&#160;12.&#160;EVALUATION&#160;OF&#160;THE&#160;PROTOTYPE</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1618">159</p>
<p style="position:absolute;top:191px;left:337px;white-space:nowrap" class="ft1618">CPU&#160;Utilization</p>
<p style="position:absolute;top:191px;left:452px;white-space:nowrap" class="ft1618">Linux</p>
<p style="position:absolute;top:191px;left:505px;white-space:nowrap" class="ft1618">Xen&#160;(Dom0+DomU)</p>
<p style="position:absolute;top:210px;left:355px;white-space:nowrap" class="ft1618">Encrypted</p>
<p style="position:absolute;top:210px;left:456px;white-space:nowrap" class="ft1618">42%</p>
<p style="position:absolute;top:210px;left:526px;white-space:nowrap" class="ft1618">45%&#160;(42+3%)</p>
<p style="position:absolute;top:228px;left:347px;white-space:nowrap" class="ft1618">Unencrypted</p>
<p style="position:absolute;top:228px;left:460px;white-space:nowrap" class="ft1618">5%</p>
<p style="position:absolute;top:228px;left:526px;white-space:nowrap" class="ft1618">13%&#160;(10+3%)</p>
<p style="position:absolute;top:260px;left:315px;white-space:nowrap" class="ft1618">Table&#160;12.4:&#160;CPU&#160;Utilization&#160;of&#160;Virtual&#160;Disks&#160;at&#160;30MB/s.</p>
<p style="position:absolute;top:305px;left:226px;white-space:nowrap" class="ft16114">disk&#160;access&#160;in&#160;a&#160;Linux&#160;without&#160;Xen,&#160;and&#160;disk&#160;access&#160;from&#160;a&#160;guest&#160;VM.&#160;For&#160;each&#160;of&#160;these<br/>three&#160;systems&#160;we&#160;compared&#160;encrypted&#160;and&#160;unencrypted&#160;access.</p>
<p style="position:absolute;top:340px;left:248px;white-space:nowrap" class="ft1618">We&#160;first&#160;measured&#160;read/write&#160;throughput.&#160;A&#160;first&#160;observation&#160;was&#160;that&#160;in&#160;all&#160;cases,</p>
<p style="position:absolute;top:358px;left:226px;white-space:nowrap" class="ft16115">the&#160;disk&#160;performance&#160;limited&#160;our&#160;overall&#160;performance,&#160;i.e.,&#160;encryption&#160;did&#160;not&#160;result&#160;in<br/>a&#160;performance&#160;penalty&#160;in&#160;a&#160;single-VM&#160;system&#160;(all&#160;6&#160;set-ups&#160;provided&#160;approx&#160;30MB/s<br/>throughput).</p>
<p style="position:absolute;top:412px;left:248px;white-space:nowrap" class="ft1618">As&#160;a&#160;consequence,&#160;we&#160;then&#160;measured&#160;the&#160;CPU&#160;utilization&#160;of&#160;the&#160;different&#160;set-ups</p>
<p style="position:absolute;top:430px;left:226px;white-space:nowrap" class="ft16114">(see&#160;Table&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#161">12.4)</a>.&#160;This&#160;figure&#160;points&#160;out&#160;that&#160;encrypting&#160;a&#160;disk&#160;at&#160;30MB/s&#160;requires&#160;42%<br/>CPU&#160;under&#160;Linux&#160;and&#160;45%&#160;under&#160;Xen&#160;while&#160;servicing&#160;a&#160;guest&#160;VM.&#160;This&#160;shows&#160;that<br/>the&#160;utilization&#160;is&#160;similar&#160;to&#160;a&#160;plain&#160;Linux.&#160;The&#160;fairly&#160;high&#160;CPU&#160;utilization&#160;substantially<br/>limits&#160;the&#160;usage&#160;of&#160;encryption&#160;in&#160;a&#160;data&#160;centers.&#160;Fortunately,&#160;encryption&#160;in&#160;a&#160;data&#160;center<br/>can&#160;often&#160;be&#160;replaced&#160;by&#160;physical&#160;security&#160;or&#160;other&#160;measures.&#160;The&#160;only&#160;exceptions&#160;are<br/>removable&#160;media&#160;that&#160;are&#160;moved&#160;between&#160;locations.</p>
<p style="position:absolute;top:566px;left:226px;white-space:nowrap" class="ft16126"><b>12.2</b></p>
<p style="position:absolute;top:566px;left:285px;white-space:nowrap" class="ft16126"><b>Limitations&#160;of&#160;our&#160;Prototype</b></p>
<p style="position:absolute;top:604px;left:226px;white-space:nowrap" class="ft16114">OpenTC&#160;has&#160;made&#160;substantial&#160;progress&#160;in&#160;design&#160;an&#160;implementation&#160;of&#160;secure&#160;virtual-<br/>ization.&#160;However,&#160;there&#160;are&#160;still&#160;open&#160;challenges&#160;to&#160;overcome.</p>
<p style="position:absolute;top:661px;left:226px;white-space:nowrap" class="ft16123"><b>Standardized&#160;Management&#160;APIs</b></p>
<p style="position:absolute;top:661px;left:451px;white-space:nowrap" class="ft1618">One&#160;goal&#160;of&#160;our&#160;prototype&#160;is&#160;to&#160;enable&#160;indepen-</p>
<p style="position:absolute;top:679px;left:226px;white-space:nowrap" class="ft1618">dent&#160;and&#160;transparen<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#161">t</a></p>
<p style="position:absolute;top:677px;left:350px;white-space:nowrap" class="ft16127"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#161">1</a></p>
<p style="position:absolute;top:679px;left:361px;white-space:nowrap" class="ft1618">management&#160;of&#160;the&#160;different&#160;virtual&#160;domains.&#160;In&#160;principle,&#160;we</p>
<p style="position:absolute;top:697px;left:226px;white-space:nowrap" class="ft16115">aimed&#160;at&#160;allowing&#160;each&#160;TVD&#160;administrator&#160;to&#160;manage&#160;a&#160;given&#160;TVD&#160;independently&#160;of<br/>all&#160;other&#160;domains.&#160;This&#160;would&#160;require&#160;that&#160;a&#160;TVD&#160;owner&#160;can&#160;define&#160;policies,&#160;define<br/>images,&#160;and&#160;start&#160;them&#160;while&#160;being&#160;independent&#160;of&#160;others&#160;and&#160;not&#160;being&#160;required&#160;to<br/>modify&#160;any&#160;tooling.&#160;While&#160;our&#160;prototype&#160;achieves&#160;management&#160;independence,&#160;we&#160;re-<br/>quire&#160;some&#160;modifications&#160;to&#160;existing&#160;tooling.&#160;While&#160;machines&#160;can&#160;be&#160;managed&#160;using<br/>the&#160;standard&#160;APIs&#160;libVirt&#160;or&#160;XenAPI&#160;(see</p>
<p style="position:absolute;top:788px;left:479px;white-space:nowrap" class="ft16134"><a href="libvirt.org">libvirt.org</a></p>
<p style="position:absolute;top:787px;left:581px;white-space:nowrap" class="ft1618">and</p>
<p style="position:absolute;top:788px;left:607px;white-space:nowrap" class="ft16134"><a href="wiki.xensource.com/xenwiki/XenApi">wiki.xensource.</a></p>
<p style="position:absolute;top:806px;left:226px;white-space:nowrap" class="ft16134"><a href="wiki.xensource.com/xenwiki/XenApi">com/xenwiki/XenApi</a></p>
<p style="position:absolute;top:805px;left:388px;white-space:nowrap" class="ft1618"><a href="wiki.xensource.com/xenwiki/XenApi">)</a>,&#160;there&#160;exists&#160;no&#160;similar&#160;API&#160;for&#160;managing&#160;virtual&#160;machine</p>
<p style="position:absolute;top:823px;left:226px;white-space:nowrap" class="ft16114">images.&#160;As&#160;a&#160;consequence,&#160;we&#160;require&#160;that&#160;each&#160;customer&#160;uploads&#160;images&#160;into&#160;per-<br/>domain&#160;sub-directories.&#160;Once&#160;the&#160;images&#160;are&#160;stored,&#160;they&#160;can&#160;then&#160;be&#160;referenced&#160;during<br/>machine&#160;creation.</p>
<p style="position:absolute;top:898px;left:226px;white-space:nowrap" class="ft16123"><b>Federated&#160;Identities</b></p>
<p style="position:absolute;top:898px;left:369px;white-space:nowrap" class="ft1618">The&#160;first&#160;limitation&#160;are&#160;globally&#160;unique&#160;identifiers.&#160;Our&#160;current</p>
<p style="position:absolute;top:916px;left:226px;white-space:nowrap" class="ft16114">prototype&#160;uses&#160;a&#160;naming&#160;authority.&#160;In&#160;the&#160;long&#160;run,&#160;TVDs&#160;should&#160;be&#160;federated&#160;without<br/>any&#160;mediation&#160;of&#160;a&#160;central&#160;authority,&#160;making&#160;an&#160;identification&#160;scheme&#160;like&#160;UUID&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#172">[72]<br/></a>necessary&#160;to&#160;guarantee&#160;the&#160;uniqueness&#160;beforehand.</p>
<p style="position:absolute;top:992px;left:226px;white-space:nowrap" class="ft16123"><b>Integrity&#160;Management&#160;Architecture</b></p>
<p style="position:absolute;top:992px;left:474px;white-space:nowrap" class="ft1618">The&#160;current&#160;scheme&#160;for&#160;measuring&#160;VM&#160;in-</p>
<p style="position:absolute;top:1010px;left:226px;white-space:nowrap" class="ft1618">tegrity&#160;is&#160;coarse-grained,&#160;because&#160;the&#160;entire&#160;file&#160;system&#160;is&#160;measured<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#161">.</a></p>
<p style="position:absolute;top:1007px;left:643px;white-space:nowrap" class="ft16127"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#161">2</a></p>
<p style="position:absolute;top:1010px;left:657px;white-space:nowrap" class="ft1618">It&#160;is&#160;a&#160;first&#160;at-</p>
<p style="position:absolute;top:1037px;left:242px;white-space:nowrap" class="ft16128">1</p>
<p style="position:absolute;top:1039px;left:248px;white-space:nowrap" class="ft16119">With&#160;transparent,&#160;we&#160;mean&#160;that&#160;each&#160;customer&#160;can&#160;use&#160;unmodified&#160;standard&#160;APIs&#160;to&#160;manage&#160;its&#160;machines</p>
<p style="position:absolute;top:1053px;left:226px;white-space:nowrap" class="ft16119">and&#160;resources.</p>
<p style="position:absolute;top:1066px;left:242px;white-space:nowrap" class="ft16128">2</p>
<p style="position:absolute;top:1068px;left:247px;white-space:nowrap" class="ft16119">Note&#160;that&#160;unlike&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[103]&#160;</a>we&#160;aimed&#160;at&#160;implementing&#160;integrity-protection&#160;at&#160;the&#160;virtualization&#160;layer.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft16121">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 162 -->
<a name="162"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page162-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5162.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1628">160</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft16221">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft16214">tempt&#160;of&#160;measuring&#160;the&#160;VMs&#160;while&#160;allowing&#160;a&#160;persistent&#160;storage;&#160;however&#160;it&#160;has&#160;a&#160;big<br/>shortcoming:&#160;the&#160;measurements&#160;do&#160;not&#160;capture&#160;the&#160;modifications&#160;that&#160;occurred&#160;on&#160;the<br/>file&#160;system&#160;because&#160;they&#160;are&#160;stored&#160;on&#160;the&#160;second&#160;read/write&#160;virtual&#160;disk,&#160;which&#160;is&#160;never<br/>measured.&#160;Moreover,&#160;the&#160;VM&#160;is&#160;measured&#160;only&#160;prior&#160;to&#160;being&#160;started,&#160;and&#160;so&#160;far&#160;there<br/>is&#160;no&#160;support&#160;for&#160;run-time&#160;monitoring&#160;yet.&#160;In&#160;the&#160;long&#160;run,&#160;we&#160;will&#160;use&#160;a&#160;finer-grained<br/>integrity&#160;measurements,&#160;e.g.,&#160;through&#160;a&#160;virtualization-enhanced&#160;version&#160;of&#160;the&#160;IMA<br/>proposed&#160;in&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[103]&#160;</a>while&#160;using&#160;integrity-enhanced&#160;storage&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#168">[24,&#160;</a><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">89]&#160;</a>to&#160;protect&#160;data&#160;at<br/>rest.&#160;However,&#160;these&#160;concepts&#160;are&#160;not&#160;widely&#160;available&#160;and&#160;come&#160;with&#160;a&#160;performance<br/>penalty.&#160;In&#160;the&#160;long&#160;run,&#160;integrity-protecting&#160;storage&#160;hardware&#160;would&#160;resolve&#160;these<br/>issue<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#162">s</a></p>
<p style="position:absolute;top:353px;left:185px;white-space:nowrap" class="ft16227"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#162">3</a></p>
<p style="position:absolute;top:355px;left:192px;white-space:nowrap" class="ft1628"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#162">.</a></p>
<p style="position:absolute;top:395px;left:150px;white-space:nowrap" class="ft16223"><b>Policy&#160;Management&#160;and&#160;Distribution</b></p>
<p style="position:absolute;top:395px;left:401px;white-space:nowrap" class="ft1628">Another&#160;part&#160;of&#160;our&#160;architecture&#160;that&#160;has&#160;not</p>
<p style="position:absolute;top:413px;left:150px;white-space:nowrap" class="ft16214">been&#160;fully&#160;implemented&#160;is&#160;the&#160;TVD&#160;Masters.&#160;Today,&#160;they&#160;only&#160;perform&#160;intra-TVD<br/>policy&#160;distribution.&#160;In&#160;the&#160;long&#160;run,&#160;they&#160;should&#160;enable&#160;trust&#160;brokering&#160;and&#160;delegation<br/>to&#160;allow&#160;trust&#160;establishment&#160;between&#160;multiple&#160;TVDs.</p>
<p style="position:absolute;top:467px;left:172px;white-space:nowrap" class="ft1628">Finally,&#160;in&#160;this&#160;first&#160;implementation,&#160;all&#160;TVD&#160;components&#160;reside&#160;in&#160;Domain-0,&#160;the</p>
<p style="position:absolute;top:484px;left:150px;white-space:nowrap" class="ft1628">Xen-privileged&#160;VM.&#160;Following&#160;the&#160;approach&#160;of&#160;Domain-0&#160;disaggregatio<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#162">n</a></p>
<p style="position:absolute;top:482px;left:602px;white-space:nowrap" class="ft16227"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#162">4</a></p>
<p style="position:absolute;top:484px;left:613px;white-space:nowrap" class="ft1628"><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">[83]</a>,&#160;the</p>
<p style="position:absolute;top:502px;left:150px;white-space:nowrap" class="ft16215">TVD&#160;Proxy&#160;and&#160;VNET&#160;components&#160;will&#160;be&#160;moved&#160;away&#160;from&#160;Domain-0&#160;to&#160;run&#160;in<br/>dedicated&#160;and&#160;isolated&#160;VMs.</p>
<p style="position:absolute;top:560px;left:150px;white-space:nowrap" class="ft16223"><b>Secure&#160;Virtual&#160;Networking</b></p>
<p style="position:absolute;top:560px;left:341px;white-space:nowrap" class="ft1628">Our&#160;networking&#160;approach&#160;adds&#160;security&#160;mechanisms</p>
<p style="position:absolute;top:578px;left:150px;white-space:nowrap" class="ft16214">in&#160;Dom0&#160;of&#160;Xen.&#160;In&#160;the&#160;long&#160;run,&#160;virtualization&#160;support&#160;in&#160;the&#160;networking&#160;hardware<br/>would&#160;be&#160;desirable&#160;to&#160;reduce&#160;context&#160;switches&#160;and&#160;thus&#160;increase&#160;performance.&#160;Note<br/>that&#160;this&#160;requirement&#160;is&#160;independent&#160;from&#160;security.&#160;However,&#160;for&#160;securing&#160;network,<br/>VPN&#160;support&#160;in&#160;the&#160;network&#160;cards&#160;would&#160;be&#160;desirable&#160;in&#160;particular&#160;for&#160;datacenters.</p>
<p style="position:absolute;top:1015px;left:166px;white-space:nowrap" class="ft16228">3</p>
<p style="position:absolute;top:1017px;left:171px;white-space:nowrap" class="ft16219">With&#160;integrity-protecting&#160;storage&#160;we&#160;mean&#160;that&#160;the&#160;hard&#160;disk&#160;can&#160;output&#160;a&#160;hash-value&#160;for&#160;a&#160;range&#160;of</p>
<p style="position:absolute;top:1031px;left:150px;white-space:nowrap" class="ft16255">blocks.&#160;Integrity-protection&#160;then&#160;means&#160;that&#160;only&#160;blocks&#160;corresponding&#160;to&#160;this&#160;hash-value&#160;are&#160;readable&#160;while<br/>modified&#160;blocks&#160;will&#160;produce&#160;read&#160;errors.</p>
<p style="position:absolute;top:1058px;left:166px;white-space:nowrap" class="ft16228">4</p>
<p style="position:absolute;top:1060px;left:171px;white-space:nowrap" class="ft16219">The&#160;OpenTC&#160;consortium&#160;is&#160;pursuing&#160;this&#160;approach&#160;to&#160;reduce&#160;the&#160;weight&#160;of&#160;the&#160;trust&#160;assumptions&#160;on</p>
<p style="position:absolute;top:1074px;left:150px;white-space:nowrap" class="ft16219">Domain-0.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft16221">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 163 -->
<a name="163"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page163-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5163.png" alt="background image"/>
<p style="position:absolute;top:295px;left:226px;white-space:nowrap" class="ft16325"><b>Chapter&#160;13</b></p>
<p style="position:absolute;top:365px;left:226px;white-space:nowrap" class="ft16322"><b>Conclusion&#160;and&#160;Outlook</b></p>
<p style="position:absolute;top:463px;left:226px;white-space:nowrap" class="ft16326"><b>13.1</b></p>
<p style="position:absolute;top:463px;left:285px;white-space:nowrap" class="ft16326"><b>Lessons&#160;Learned</b></p>
<p style="position:absolute;top:500px;left:226px;white-space:nowrap" class="ft16314">Embedding&#160;integrity&#160;verification&#160;mechanisms&#160;in&#160;a&#160;distributed&#160;security&#160;architecture&#160;cre-<br/>ates&#160;serious&#160;challenges.&#160;Conceptually,&#160;many&#160;of&#160;them&#160;can&#160;be&#160;addressed&#160;with&#160;property-<br/>based&#160;attestation.&#160;However,&#160;property-based&#160;attestation&#160;depends&#160;on&#160;well-defined&#160;and<br/>potentially&#160;institutionalized&#160;processes&#160;for&#160;validating&#160;the&#160;behavioral&#160;equivalence&#160;of&#160;dif-<br/>ferent&#160;configurations.&#160;Certifying&#160;that&#160;two&#160;configurations&#160;have&#160;identical&#160;properties&#160;is<br/>currently&#160;a&#160;manual&#160;and&#160;labor-intensive&#160;exercise,&#160;which&#160;is&#160;costly&#160;and&#160;does&#160;not&#160;scale<br/>beyond&#160;single&#160;TVD&#160;owners&#160;or&#160;data&#160;center&#160;administrators.</p>
<p style="position:absolute;top:626px;left:248px;white-space:nowrap" class="ft1638">While&#160;the&#160;migration&#160;of&#160;VMs&#160;between&#160;different&#160;physical&#160;hosts&#160;is&#160;well&#160;understood,</p>
<p style="position:absolute;top:644px;left:226px;white-space:nowrap" class="ft16314">the&#160;migration&#160;of&#160;a&#160;complete&#160;trust&#160;context&#160;associated&#160;with&#160;a&#160;VM&#160;has&#160;proved&#160;to&#160;be&#160;dif-<br/>ficult.&#160;The&#160;latter&#160;type&#160;of&#160;migration&#160;requires&#160;the&#160;migration&#160;of&#160;not&#160;only&#160;the&#160;virtual&#160;net-<br/>working&#160;and&#160;storage&#160;devices&#160;(with&#160;associated&#160;cryptographic&#160;keys,&#160;if&#160;necessary),&#160;but<br/>also&#160;of&#160;a&#160;virtual&#160;TPM,&#160;if&#160;present,&#160;which&#160;will&#160;be&#160;rooted&#160;in&#160;different&#160;hardware&#160;TPMs<br/>prior&#160;to&#160;and&#160;after&#160;the&#160;migration.&#160;During&#160;the&#160;migration&#160;process,&#160;the&#160;integrity&#160;of&#160;all&#160;these<br/>components&#160;has&#160;to&#160;be&#160;guaranteed&#160;while&#160;managing&#160;the&#160;handing-off&#160;of&#160;device&#160;access&#160;in<br/>a&#160;transactional&#160;fashion.&#160;Note&#160;that&#160;the&#160;importance&#160;of&#160;securing&#160;this&#160;transition&#160;has&#160;been<br/>further&#160;emphasized&#160;by&#160;recently&#160;published&#160;attacks&#160;on&#160;virtual&#160;machines&#160;in&#160;transit.</p>
<p style="position:absolute;top:787px;left:248px;white-space:nowrap" class="ft1638">Building&#160;a&#160;security&#160;API&#160;that&#160;is&#160;at&#160;the&#160;same&#160;time&#160;flexible,&#160;usable,&#160;and&#160;manageable</p>
<p style="position:absolute;top:805px;left:226px;white-space:nowrap" class="ft16314">has&#160;proved&#160;to&#160;be&#160;more&#160;difficult&#160;than&#160;expected.&#160;A&#160;key&#160;reason&#160;for&#160;this&#160;difficulty&#160;is&#160;the<br/>requirement&#160;that&#160;the&#160;API&#160;should&#160;be&#160;easily&#160;adaptable&#160;to&#160;other&#160;hypervisor&#160;architectures<br/>and&#160;to&#160;workstation&#160;scenarios&#160;with&#160;GUI&#160;interfaces.&#160;While&#160;addressing&#160;each&#160;of&#160;these<br/>requirements&#160;separately&#160;is&#160;feasible,&#160;their&#160;combination&#160;comes&#160;with&#160;many&#160;trade-offs.</p>
<p style="position:absolute;top:877px;left:248px;white-space:nowrap" class="ft1638">Yet&#160;another&#160;type&#160;of&#160;trade-off&#160;concerns&#160;our&#160;aim&#160;of&#160;decomposing&#160;the&#160;Xen&#160;architecture</p>
<p style="position:absolute;top:895px;left:226px;white-space:nowrap" class="ft16315">into&#160;multiple&#160;security&#160;services&#160;each&#160;running&#160;in&#160;dedicated&#160;tiny&#160;VMs&#160;while&#160;reducing&#160;the<br/>reliance&#160;on&#160;Domain-0,&#160;the&#160;privileged&#160;management&#160;VM.&#160;While&#160;such&#160;decomposition&#160;is<br/>advantageous&#160;from&#160;a&#160;security&#160;perspective,&#160;it&#160;tends&#160;to&#160;reduce&#160;flexibility.&#160;The&#160;availability<br/>of&#160;a&#160;full-fledged&#160;Linux&#160;management&#160;VM&#160;with&#160;access&#160;to&#160;all&#160;subsystems&#160;enables&#160;easy<br/>extensibility&#160;and&#160;rapid&#160;prototyping&#160;(scripting,&#160;adding&#160;devices,&#160;firewalls,&#160;VPNs&#160;etc),<br/>and&#160;also&#160;corresponds&#160;to&#160;the&#160;expectations&#160;of&#160;many&#160;Xen&#160;users.&#160;In&#160;general,&#160;however,<br/>considerations&#160;of&#160;usability&#160;tend&#160;to&#160;favor&#160;design&#160;decisions&#160;that&#160;are&#160;sub-optimal&#160;from&#160;a<br/>strict&#160;security&#160;perspective.</p>
<p style="position:absolute;top:1117px;left:473px;white-space:nowrap" class="ft1638">161</p>
</div>
<!-- Page 164 -->
<a name="164"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page164-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5164.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1648">162</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft16421">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:189px;left:150px;white-space:nowrap" class="ft16426"><b>13.2</b></p>
<p style="position:absolute;top:189px;left:209px;white-space:nowrap" class="ft164172"><b>The&#160;Future&#160;of&#160;Secure&#160;Virtualization&#160;and&#160;Trusted<br/>Computing</b></p>
<p style="position:absolute;top:254px;left:150px;white-space:nowrap" class="ft16414">WP5&#160;aimed&#160;at&#160;securing&#160;virtualization&#160;by&#160;using&#160;trusted&#160;computing&#160;technologies.&#160;We<br/>managed&#160;to&#160;prototype&#160;a&#160;secure&#160;virtual&#160;datacenter&#160;that&#160;uses&#160;trusted&#160;computing&#160;hardware<br/>for&#160;proving&#160;its&#160;integrity&#160;to&#160;stakeholders.</p>
<p style="position:absolute;top:330px;left:150px;white-space:nowrap" class="ft16424"><b>13.2.1</b></p>
<p style="position:absolute;top:330px;left:213px;white-space:nowrap" class="ft16424"><b>Trusted&#160;Computing</b></p>
<p style="position:absolute;top:361px;left:150px;white-space:nowrap" class="ft16423"><b>Observations</b></p>
<p style="position:absolute;top:361px;left:249px;white-space:nowrap" class="ft1648">During&#160;the&#160;course&#160;of&#160;our&#160;project,&#160;we&#160;have&#160;made&#160;several&#160;observations.</p>
<p style="position:absolute;top:379px;left:150px;white-space:nowrap" class="ft16414">The&#160;first&#160;is&#160;that&#160;trusted&#160;computing&#160;hardware&#160;(i.e.,&#160;TPM)&#160;is&#160;useful&#160;for&#160;protecting&#160;keys<br/>and&#160;cryptographic&#160;operations&#160;using&#160;these&#160;keys.&#160;This&#160;usage&#160;is&#160;establishes&#160;a&#160;hardware-<br/>protected&#160;machine&#160;identity.&#160;This&#160;is&#160;similar&#160;to&#160;today’s&#160;usage&#160;of&#160;smart-cards.</p>
<p style="position:absolute;top:432px;left:172px;white-space:nowrap" class="ft1648">We&#160;furthermore&#160;realized&#160;that&#160;integrity-protection&#160;using&#160;this&#160;hardware&#160;is&#160;very&#160;diffi-</p>
<p style="position:absolute;top:450px;left:150px;white-space:nowrap" class="ft16414">cult&#160;in&#160;practice.&#160;Due&#160;to&#160;the&#160;fact&#160;that&#160;minimal&#160;changes&#160;to&#160;the&#160;software&#160;render&#160;an&#160;attesta-<br/>tion&#160;invalid,&#160;maintaining&#160;the&#160;integrity&#160;of&#160;such&#160;a&#160;system&#160;is&#160;error-prone.</p>
<p style="position:absolute;top:486px;left:172px;white-space:nowrap" class="ft1648">We&#160;believe&#160;that&#160;there&#160;are&#160;several&#160;aspects&#160;that&#160;make&#160;integrity-validation&#160;challeng-</p>
<p style="position:absolute;top:504px;left:150px;white-space:nowrap" class="ft16414">ing.&#160;The&#160;first&#160;is&#160;the&#160;variety&#160;and&#160;variability&#160;of&#160;code.&#160;Even&#160;in&#160;our&#160;security&#160;project&#160;the<br/>code-based&#160;changed&#160;a&#160;lot.&#160;As&#160;a&#160;consequence,&#160;any&#160;practical&#160;integrity-validation&#160;mech-<br/>anism&#160;needs&#160;to&#160;be&#160;able&#160;to&#160;tackle&#160;this&#160;code&#160;evolution&#160;while&#160;distinguishing&#160;between&#160;de-<br/>sired&#160;(=secure)&#160;and&#160;undesired&#160;(=insecure)&#160;upgrades.&#160;One&#160;approach&#160;towards&#160;solving&#160;this<br/>problem&#160;is&#160;to&#160;use&#160;the&#160;Linux&#160;package&#160;management&#160;infrastructure&#160;to&#160;define&#160;acceptable<br/>code&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">[82]</a>.</p>
<p style="position:absolute;top:612px;left:172px;white-space:nowrap" class="ft1648">The&#160;other&#160;challenging&#160;aspect&#160;is&#160;the&#160;lack&#160;of&#160;isolation&#160;in&#160;today’s&#160;environments.&#160;To-</p>
<p style="position:absolute;top:629px;left:150px;white-space:nowrap" class="ft16414">day,&#160;any&#160;malicious&#160;code&#160;in&#160;a&#160;VM&#160;can&#160;essentially&#160;take&#160;over&#160;a&#160;complete&#160;VM.&#160;As&#160;a&#160;con-<br/>sequence,&#160;the&#160;integrity&#160;of&#160;any&#160;code&#160;in&#160;the&#160;VM&#160;depends&#160;on&#160;all&#160;other&#160;code.&#160;As&#160;a&#160;con-<br/>sequence,&#160;integrity&#160;of&#160;a&#160;component&#160;can&#160;usually&#160;not&#160;be&#160;evaluated&#160;in&#160;isolation.&#160;This<br/>substantially&#160;increases&#160;the&#160;overall&#160;complexity&#160;of&#160;an&#160;integrity&#160;assessment&#160;since&#160;in&#160;prin-<br/>ciple&#160;any&#160;untrusted&#160;component&#160;on&#160;the&#160;system&#160;threatens&#160;overall&#160;integrity&#160;of&#160;most&#160;other<br/>components.&#160;It&#160;also&#160;lowers&#160;the&#160;performance&#160;since&#160;any&#160;change&#160;in&#160;a&#160;VM&#160;needs&#160;to&#160;be<br/>assessed.&#160;While&#160;we&#160;provide&#160;isolation&#160;between&#160;VMs,&#160;a&#160;long-term&#160;solution&#160;would&#160;be&#160;to<br/>lower&#160;the&#160;granularity&#160;to&#160;provide&#160;strong&#160;isolation&#160;on&#160;an&#160;object&#160;or&#160;package&#160;level.</p>
<p style="position:absolute;top:795px;left:150px;white-space:nowrap" class="ft16423"><b>Consequences</b></p>
<p style="position:absolute;top:795px;left:255px;white-space:nowrap" class="ft1648">We&#160;believe&#160;that&#160;the&#160;pervasive&#160;deployment&#160;of&#160;TPM&#160;hardware&#160;will&#160;fur-</p>
<p style="position:absolute;top:813px;left:150px;white-space:nowrap" class="ft16414">ther&#160;enable&#160;and&#160;support&#160;the&#160;usage&#160;of&#160;TPMs&#160;as&#160;machine&#160;identities&#160;and&#160;for&#160;protecting<br/>cryptographic&#160;keys.&#160;However,&#160;based&#160;on&#160;our&#160;observations,&#160;we&#160;believe&#160;that&#160;the&#160;applica-<br/>bility&#160;of&#160;trusted&#160;computing&#160;in&#160;the&#160;near&#160;future&#160;will&#160;be&#160;limited&#160;to&#160;small-scale&#160;and&#160;stable<br/>high-assurance&#160;systems.&#160;Examples&#160;include&#160;embedded&#160;systems,&#160;or&#160;high-assurance&#160;sys-<br/>tems&#160;such&#160;as&#160;high-assurance&#160;workstations&#160;for&#160;defense&#160;or&#160;very&#160;integrity-critical&#160;appli-<br/>cations.&#160;Another&#160;example&#160;are&#160;virtualization&#160;platforms&#160;for&#160;executing&#160;virtual&#160;appliances.<br/>For&#160;these&#160;cases,&#160;the&#160;limited&#160;and&#160;stable&#160;trusted&#160;computing&#160;base&#160;is&#160;effectively&#160;verifiable<br/>using&#160;trusted&#160;computing.</p>
<p style="position:absolute;top:978px;left:150px;white-space:nowrap" class="ft16423"><b>Open&#160;Challenges</b></p>
<p style="position:absolute;top:978px;left:274px;white-space:nowrap" class="ft1648">The&#160;first&#160;open&#160;challenge&#160;is&#160;to&#160;provide&#160;and&#160;manage&#160;finer-grained</p>
<p style="position:absolute;top:996px;left:150px;white-space:nowrap" class="ft16414">isolation&#160;to&#160;enable&#160;more&#160;localized&#160;integrity&#160;verification&#160;of&#160;individual&#160;components.&#160;This<br/>would&#160;enable&#160;tree-like&#160;verification&#160;of&#160;a&#160;trusted&#160;computing&#160;base&#160;where&#160;siblings&#160;cannot<br/>destroy&#160;each&#160;others&#160;integrity.&#160;This&#160;is&#160;similar&#160;to&#160;the&#160;OpenTC&#160;approach&#160;of&#160;running&#160;in-<br/>dependent&#160;virtual&#160;machines&#160;that&#160;cannot&#160;invalidate&#160;each&#160;others&#160;integrity.&#160;However,&#160;for<br/>an&#160;actual&#160;operating&#160;platform&#160;based&#160;on&#160;these&#160;principles,&#160;the&#160;granularity&#160;would&#160;need&#160;to</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft16421">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 165 -->
<a name="165"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page165-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5165.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1658">CHAPTER&#160;13.&#160;CONCLUSION&#160;AND&#160;OUTLOOK</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1658">163</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft16515">be&#160;lowered&#160;from&#160;the&#160;VM&#160;to&#160;the&#160;object&#160;level.&#160;Overall,&#160;this&#160;concept&#160;is&#160;closer&#160;to&#160;the<br/>isolated-objects&#160;approach&#160;of&#160;L4.&#160;However,&#160;for&#160;practical&#160;applicability&#160;the&#160;performance<br/>and&#160;life-cycle&#160;management&#160;of&#160;thousands&#160;of&#160;isolated&#160;computing&#160;objects&#160;will&#160;remain<br/>challenging.</p>
<p style="position:absolute;top:265px;left:248px;white-space:nowrap" class="ft1658">A&#160;second&#160;open&#160;challenge&#160;is&#160;run-time&#160;attestation,&#160;i.e.,&#160;moving&#160;from&#160;boot-time&#160;val-</p>
<p style="position:absolute;top:283px;left:226px;white-space:nowrap" class="ft16515">idation&#160;of&#160;a&#160;system&#160;towards&#160;real-time&#160;validation.&#160;This&#160;means&#160;that&#160;whenever&#160;code&#160;is<br/>executed&#160;that&#160;this&#160;code&#160;has&#160;been&#160;validated.&#160;Without&#160;such&#160;near-time&#160;validation,&#160;in&#160;par-<br/>ticular&#160;long-running&#160;systems&#160;that&#160;were&#160;unmodified&#160;at&#160;boot-time&#160;can&#160;be&#160;attacked&#160;at&#160;run-<br/>time&#160;such&#160;that&#160;the&#160;code&#160;changes&#160;are&#160;not&#160;detected.</p>
<p style="position:absolute;top:355px;left:248px;white-space:nowrap" class="ft1658">A&#160;third&#160;open&#160;challenge&#160;is&#160;to&#160;develop&#160;new&#160;approaches&#160;towards&#160;integrity&#160;validation</p>
<p style="position:absolute;top:373px;left:226px;white-space:nowrap" class="ft16514">that&#160;are&#160;based&#160;on&#160;the&#160;integrity&#160;pedigree&#160;of&#160;isolated&#160;objects.&#160;We&#160;believe&#160;that&#160;such&#160;a<br/>method&#160;will&#160;require&#160;a&#160;high&#160;amount&#160;of&#160;initial&#160;validation&#160;but&#160;should&#160;then&#160;enable&#160;simplified<br/>updates&#160;to&#160;maintain&#160;running&#160;code&#160;along&#160;with&#160;its&#160;integrity&#160;assurance.</p>
<p style="position:absolute;top:450px;left:226px;white-space:nowrap" class="ft16524"><b>13.2.2</b></p>
<p style="position:absolute;top:450px;left:289px;white-space:nowrap" class="ft16524"><b>Secure&#160;Virtualization</b></p>
<p style="position:absolute;top:480px;left:226px;white-space:nowrap" class="ft16523"><b>Observations</b></p>
<p style="position:absolute;top:480px;left:325px;white-space:nowrap" class="ft1658">In&#160;OpenTC,&#160;we&#160;have&#160;implemented&#160;a&#160;virtual&#160;datacenter&#160;that&#160;shows&#160;that</p>
<p style="position:absolute;top:498px;left:226px;white-space:nowrap" class="ft16515">isolated&#160;machines&#160;with&#160;well-defined&#160;sharing.&#160;We&#160;managed&#160;to&#160;automated&#160;most&#160;man-<br/>agement&#160;tasks.&#160;This&#160;enabled&#160;us&#160;to&#160;hide&#160;implementation&#160;details&#160;from&#160;users&#160;such&#160;that<br/>users&#160;could&#160;concentrate&#160;on&#160;their&#160;computing&#160;resources&#160;that&#160;were&#160;independent&#160;of&#160;the&#160;re-<br/>sources&#160;of&#160;other&#160;customers.&#160;Automating&#160;management&#160;of&#160;security&#160;has&#160;been&#160;essential<br/>since&#160;manual&#160;management&#160;is&#160;costly&#160;and&#160;error-prone.</p>
<p style="position:absolute;top:609px;left:226px;white-space:nowrap" class="ft16523"><b>Consequences</b></p>
<p style="position:absolute;top:609px;left:331px;white-space:nowrap" class="ft1658">We&#160;believe&#160;that&#160;there&#160;is&#160;a&#160;trend&#160;towards&#160;such&#160;scalable&#160;virtual&#160;infras-</p>
<p style="position:absolute;top:627px;left:226px;white-space:nowrap" class="ft16515">tructures&#160;that&#160;are&#160;automatically&#160;managed&#160;and&#160;hide&#160;its&#160;implementation&#160;details&#160;from<br/>users.&#160;This&#160;so-called&#160;“Cloud&#160;Computing”&#160;approach&#160;has&#160;clear&#160;advantages&#160;from&#160;a&#160;us-<br/>ability&#160;perspective.&#160;Unfortunately,&#160;today’s&#160;cloud&#160;computing&#160;platforms&#160;do&#160;not&#160;provide<br/>sufficient&#160;security.&#160;Furthermore,&#160;from&#160;a&#160;security&#160;perspective,&#160;hiding&#160;implementation<br/>details&#160;no&#160;longer&#160;allows&#160;users&#160;to&#160;validate&#160;the&#160;security&#160;of&#160;the&#160;platform&#160;themselves.</p>
<p style="position:absolute;top:717px;left:248px;white-space:nowrap" class="ft1658">Overall,&#160;we&#160;believe&#160;that&#160;this&#160;in-transparent&#160;approach&#160;towards&#160;cloud&#160;computing&#160;will</p>
<p style="position:absolute;top:735px;left:226px;white-space:nowrap" class="ft16514">be&#160;limited&#160;to&#160;low-trust&#160;scenarios&#160;similar&#160;to&#160;today’s&#160;grid&#160;computing.&#160;These&#160;clouds&#160;will<br/>either&#160;be&#160;used&#160;within&#160;organizations&#160;that&#160;trust&#160;each&#160;other&#160;(within&#160;an&#160;enterprise&#160;or&#160;with<br/>a&#160;strong&#160;supplier-customer&#160;trust&#160;relationship).&#160;Another&#160;scenario&#160;are&#160;uncritical&#160;applica-<br/>tions&#160;such&#160;as&#160;web-servers&#160;or&#160;scientific&#160;computing&#160;on&#160;public&#160;data.</p>
<p style="position:absolute;top:828px;left:226px;white-space:nowrap" class="ft16523"><b>Open&#160;Challenges</b></p>
<p style="position:absolute;top:828px;left:350px;white-space:nowrap" class="ft1658">An&#160;open&#160;challenge&#160;is&#160;how&#160;to&#160;balance&#160;transparency&#160;with&#160;security</p>
<p style="position:absolute;top:846px;left:226px;white-space:nowrap" class="ft16515">assurance.&#160;In&#160;OpenTC,&#160;we&#160;aimed&#160;at&#160;full&#160;verifiability,&#160;i.e.,&#160;a&#160;customer&#160;can&#160;see&#160;all&#160;imple-<br/>mentation&#160;details&#160;of&#160;the&#160;infrastructure.&#160;Only&#160;actual&#160;configurations&#160;of&#160;peer&#160;customers<br/>are&#160;hidden&#160;from&#160;our&#160;users.&#160;In&#160;the&#160;long&#160;run,&#160;however,&#160;hiding&#160;these&#160;implementation<br/>details&#160;(which&#160;are&#160;secrets&#160;of&#160;the&#160;provider)&#160;from&#160;customers&#160;while&#160;guaranteeing&#160;security<br/>will&#160;remain&#160;challenging.&#160;In&#160;addition,&#160;secure&#160;composition&#160;of&#160;virtual&#160;services&#160;that&#160;are&#160;po-<br/>tentially&#160;provided&#160;by&#160;different&#160;cloud&#160;implementations&#160;operated&#160;by&#160;mutually&#160;mistrusting<br/>providers&#160;will&#160;remain&#160;a&#160;challenge.&#160;In&#160;particular&#160;for&#160;this&#160;cloud-of-clouds&#160;scenarios&#160;well-<br/>defined&#160;operation&#160;and&#160;implementation&#160;guidelines&#160;(and&#160;audits)&#160;as&#160;well&#160;as&#160;standardized<br/>assurance&#160;exchange&#160;interfaces&#160;will&#160;be&#160;required&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#171">[61]</a>.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft16521">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 166 -->
<a name="166"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page166-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5166.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1668">164</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft16621">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:189px;left:150px;white-space:nowrap" class="ft16626"><b>13.3</b></p>
<p style="position:absolute;top:189px;left:209px;white-space:nowrap" class="ft16626"><b>Conclusions</b></p>
<p style="position:absolute;top:227px;left:150px;white-space:nowrap" class="ft16615">In&#160;this&#160;report,&#160;we&#160;have&#160;described&#160;the&#160;OpenTC&#160;approach&#160;and&#160;components&#160;for&#160;a&#160;Trusted<br/>Virtual&#160;Datacenter.&#160;The&#160;core&#160;idea&#160;is&#160;to&#160;build&#160;a&#160;datacenter&#160;that&#160;allows&#160;for&#160;and&#160;isolates<br/>multiple&#160;customers&#160;while&#160;satisfying&#160;the&#160;security&#160;requirements&#160;of&#160;each&#160;customer.</p>
<p style="position:absolute;top:281px;left:172px;white-space:nowrap" class="ft1668">Securing&#160;the&#160;access&#160;to&#160;data&#160;on&#160;persistent&#160;media&#160;and&#160;during&#160;transfer&#160;over&#160;the&#160;network</p>
<p style="position:absolute;top:299px;left:150px;white-space:nowrap" class="ft16615">is&#160;a&#160;serious&#160;problem&#160;in&#160;distributed&#160;virtual&#160;data-center&#160;and&#160;cloud&#160;computing&#160;scenarios.<br/>We&#160;described&#160;a&#160;framework&#160;based&#160;on&#160;TVDs&#160;and&#160;Trusted&#160;Computing&#160;for&#160;secure&#160;network<br/>and&#160;storage&#160;virtualization&#160;that&#160;includes&#160;mechanisms&#160;for&#160;verifying&#160;the&#160;integrity&#160;of&#160;the<br/>hypervisor,&#160;VMs,&#160;and&#160;security&#160;policy&#160;enforcement&#160;points.</p>
<p style="position:absolute;top:370px;left:172px;white-space:nowrap" class="ft1668">This&#160;is&#160;achieved&#160;by&#160;means&#160;of&#160;so-called&#160;Trusted&#160;Virtual&#160;Domains&#160;that&#160;provide&#160;a&#160;vir-</p>
<p style="position:absolute;top:388px;left:150px;white-space:nowrap" class="ft16614">tual&#160;environment&#160;for&#160;each&#160;customer.&#160;Each&#160;trusted&#160;virtual&#160;domain&#160;exposes&#160;a&#160;standard-<br/>ized&#160;management&#160;interface&#160;that&#160;allows&#160;customers&#160;to&#160;run&#160;existing&#160;management&#160;software<br/>to&#160;manage&#160;their&#160;respective&#160;domains.&#160;The&#160;concept&#160;of&#160;TVDs&#160;is&#160;rigid&#160;enough&#160;to&#160;allow<br/>consistent&#160;policy&#160;enforcement&#160;across&#160;a&#160;group&#160;of&#160;domain&#160;elements,&#160;while&#160;being&#160;flexible<br/>enough&#160;to&#160;support&#160;policy-controlled&#160;interactions&#160;between&#160;different&#160;TVDs.&#160;TVD&#160;poli-<br/>cies&#160;and&#160;configurations&#160;are&#160;‘backward-compatible’&#160;in&#160;supporting&#160;options&#160;that&#160;could&#160;be<br/>taken&#160;for&#160;granted&#160;in&#160;non-virtualized&#160;data&#160;centers.&#160;For&#160;example,&#160;co-hosting&#160;of&#160;specific<br/>customer&#160;services&#160;with&#160;those&#160;of&#160;other&#160;data-center&#160;customers&#160;on&#160;the&#160;same&#160;physical&#160;plat-<br/>form&#160;could&#160;be&#160;inhibited&#160;if&#160;so&#160;desired.&#160;By&#160;incorporating&#160;hardware-based&#160;Trusted&#160;Com-<br/>puting&#160;technology,&#160;our&#160;framework&#160;allows&#160;the&#160;creation&#160;of&#160;policy&#160;domains&#160;with&#160;attestable<br/>trust&#160;properties&#160;for&#160;each&#160;of&#160;the&#160;domain&#160;nodes.</p>
<p style="position:absolute;top:586px;left:172px;white-space:nowrap" class="ft1668">In&#160;order&#160;to&#160;enforce&#160;the&#160;given&#160;security&#160;requirements,&#160;we&#160;deploy&#160;the&#160;security&#160;services</p>
<p style="position:absolute;top:604px;left:150px;white-space:nowrap" class="ft16614">described&#160;in&#160;Deliverable&#160;D05.4&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#173">[88]&#160;</a>that&#160;allow&#160;verifiable&#160;security&#160;within&#160;each&#160;domain.<br/>This&#160;includes&#160;validation&#160;of&#160;the&#160;trusted&#160;computing&#160;base&#160;as&#160;well&#160;as&#160;verifiable&#160;enforce-<br/>ment&#160;of&#160;given&#160;per-domain&#160;policies.&#160;The&#160;inclusion&#160;of&#160;integrity&#160;measurement&#160;and&#160;man-<br/>agement&#160;mechanisms&#160;as&#160;part&#160;of&#160;the&#160;physical&#160;platform’s&#160;TCBs&#160;provides&#160;both&#160;data-center<br/>customers&#160;and&#160;administrators&#160;with&#160;a&#160;much&#160;needed&#160;view&#160;of&#160;the&#160;elements&#160;(hypervisors,<br/>VMs,&#160;etc.)&#160;that&#160;are&#160;part&#160;of&#160;their&#160;virtual&#160;infrastructure&#160;as&#160;well&#160;as&#160;information&#160;on&#160;the<br/>configurations&#160;of&#160;those&#160;elements.&#160;Our&#160;framework&#160;can&#160;be&#160;used&#160;to&#160;obtain&#160;information<br/>about&#160;the&#160;elements&#160;on&#160;a&#160;‘need-to-know’&#160;basis&#160;without&#160;having&#160;to&#160;introduce&#160;all-powerful<br/>roles&#160;of&#160;administrators&#160;with&#160;access&#160;to&#160;every&#160;aspect&#160;of&#160;a&#160;platform.</p>
<p style="position:absolute;top:765px;left:172px;white-space:nowrap" class="ft1668">We&#160;have&#160;substantially&#160;contributed&#160;to&#160;the&#160;knowledge&#160;in&#160;secure&#160;virtualization&#160;and</p>
<p style="position:absolute;top:783px;left:150px;white-space:nowrap" class="ft16614">trusted&#160;computing.&#160;Overall,&#160;we&#160;managed&#160;to&#160;build&#160;the&#160;first&#160;large-scale&#160;virtual&#160;datacenter<br/>that&#160;can&#160;be&#160;validated&#160;using&#160;trusted&#160;computing&#160;technology.&#160;Nevertheless,&#160;despite&#160;our<br/>substantial&#160;progress,&#160;there&#160;are&#160;still&#160;several&#160;open&#160;research&#160;challenges.&#160;Examples&#160;include<br/>large-scale&#160;management&#160;and&#160;validation&#160;of&#160;integrity&#160;as&#160;well&#160;as&#160;efficient&#160;implementation<br/>strong&#160;isolation&#160;guarantees&#160;on&#160;a&#160;finer-grained&#160;level.&#160;In&#160;the&#160;long&#160;run,&#160;we&#160;hope&#160;that&#160;this<br/>will&#160;enable&#160;to&#160;lower&#160;the&#160;granularity&#160;of&#160;integrity&#160;guarantees&#160;from&#160;Virtual&#160;Machines&#160;to<br/>individual&#160;objects.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft16621">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 167 -->
<a name="167"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page167-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5167.png" alt="background image"/>
<p style="position:absolute;top:298px;left:226px;white-space:nowrap" class="ft16722"><b>Bibliography</b></p>
<p style="position:absolute;top:391px;left:241px;white-space:nowrap" class="ft1678">[1]&#160;Aufs&#160;–&#160;Another&#160;Unionfs.</p>
<p style="position:absolute;top:392px;left:420px;white-space:nowrap" class="ft16734"><a href="http://aufs.sourceforge.net/">http://aufs.sourceforge.net/</a></p>
<p style="position:absolute;top:391px;left:671px;white-space:nowrap" class="ft1678"><a href="http://aufs.sourceforge.net/">.</a></p>
<p style="position:absolute;top:419px;left:241px;white-space:nowrap" class="ft1678">[2]&#160;dm-crypt:&#160;a&#160;device-mapper&#160;crypto&#160;target.</p>
<p style="position:absolute;top:420px;left:518px;white-space:nowrap" class="ft16734"><a href="http://www.saout.de/misc/dm-crypt/">http://www.saout.de/misc/</a></p>
<p style="position:absolute;top:438px;left:266px;white-space:nowrap" class="ft16734"><a href="http://www.saout.de/misc/dm-crypt/">dm-crypt/</a></p>
<p style="position:absolute;top:437px;left:347px;white-space:nowrap" class="ft1678"><a href="http://www.saout.de/misc/dm-crypt/">.</a></p>
<p style="position:absolute;top:466px;left:241px;white-space:nowrap" class="ft1678">[3]&#160;Microsoft&#160;security&#160;advisories&#160;archive.</p>
<p style="position:absolute;top:466px;left:518px;white-space:nowrap" class="ft16734"><a href="http://www.microsoft.com/technet/security/advisory/archive.mspx">http://www.microsoft.com/</a></p>
<p style="position:absolute;top:484px;left:266px;white-space:nowrap" class="ft16734"><a href="http://www.microsoft.com/technet/security/advisory/archive.mspx">technet/security/advisory/archive.mspx</a></p>
<p style="position:absolute;top:484px;left:607px;white-space:nowrap" class="ft1678"><a href="http://www.microsoft.com/technet/security/advisory/archive.mspx">.</a></p>
<p style="position:absolute;top:512px;left:241px;white-space:nowrap" class="ft1678">[4]&#160;TrustedGRUB.</p>
<p style="position:absolute;top:513px;left:455px;white-space:nowrap" class="ft16734"><a href="http://sourceforge.net/projects/trustedgrub">http://sourceforge.net/projects/</a></p>
<p style="position:absolute;top:531px;left:266px;white-space:nowrap" class="ft16734"><a href="http://sourceforge.net/projects/trustedgrub">trustedgrub</a></p>
<p style="position:absolute;top:530px;left:365px;white-space:nowrap" class="ft1678"><a href="http://sourceforge.net/projects/trustedgrub">.</a></p>
<p style="position:absolute;top:558px;left:241px;white-space:nowrap" class="ft1678">[5]&#160;Unionfs:&#160;A&#160;Stackable&#160;Unification&#160;File&#160;System.</p>
<p style="position:absolute;top:559px;left:562px;white-space:nowrap" class="ft16734"><a href="http://www.am-utils.org/project-unionfs.html">http://www.am-utils.</a></p>
<p style="position:absolute;top:577px;left:266px;white-space:nowrap" class="ft16734"><a href="http://www.am-utils.org/project-unionfs.html">org/project-unionfs.html</a></p>
<p style="position:absolute;top:576px;left:482px;white-space:nowrap" class="ft1678"><a href="http://www.am-utils.org/project-unionfs.html">.</a></p>
<p style="position:absolute;top:604px;left:241px;white-space:nowrap" class="ft1678">[6]&#160;XSLT&#160;Transformations.</p>
<p style="position:absolute;top:605px;left:413px;white-space:nowrap" class="ft16734"><a href="http://www.w3.org/TR/xslt">http://www.w3.org/TR/xslt</a></p>
<p style="position:absolute;top:604px;left:637px;white-space:nowrap" class="ft1678"><a href="http://www.w3.org/TR/xslt">.</a></p>
<p style="position:absolute;top:633px;left:241px;white-space:nowrap" class="ft1678">[7]&#160;A.&#160;Agbaria&#160;and&#160;R.&#160;Friedman.&#160;Virtual&#160;Machine&#160;Based&#160;Heterogeneous&#160;Check-</p>
<p style="position:absolute;top:651px;left:266px;white-space:nowrap" class="ft1678">pointing.&#160;<i>Software:&#160;Practice&#160;and&#160;Experience</i>,&#160;32(1):1–19,&#160;2002.</p>
<p style="position:absolute;top:679px;left:241px;white-space:nowrap" class="ft1678">[8]&#160;M.&#160;J.&#160;Anderson,&#160;M.&#160;Moffie,&#160;and&#160;C.&#160;I.&#160;Dalton.&#160;Towards&#160;trustworthy&#160;virtualisation</p>
<p style="position:absolute;top:697px;left:266px;white-space:nowrap" class="ft16714">environments:&#160;Xen&#160;library&#160;os&#160;security&#160;service&#160;infrastructure.&#160;Research&#160;report,<br/>HP&#160;Labs,&#160;Bristol,&#160;UK,&#160;2007.</p>
<p style="position:absolute;top:744px;left:241px;white-space:nowrap" class="ft1678">[9]&#160;F.&#160;Armknecht,&#160;Y.&#160;Gasmi,&#160;A.-R.&#160;Sadeghi,&#160;P.&#160;Stewin,&#160;M.&#160;Unger,&#160;G.&#160;Ramunno,</p>
<p style="position:absolute;top:761px;left:266px;white-space:nowrap" class="ft16756">and&#160;D.&#160;Vernizzi.&#160;An&#160;efficient&#160;implementation&#160;of&#160;Trusted&#160;Channels&#160;based&#160;on<br/>Openssl.&#160;In&#160;<i>STC&#160;’08:&#160;Proceedings&#160;of&#160;the&#160;3rd&#160;ACM&#160;workshop&#160;on&#160;Scalable&#160;Trusted<br/>Computing</i>,&#160;pages&#160;41–50,&#160;New&#160;York,&#160;NY,&#160;USA,&#160;2008.&#160;ACM&#160;Press.</p>
<p style="position:absolute;top:826px;left:233px;white-space:nowrap" class="ft1678">[10]&#160;N.&#160;Asokan,&#160;Y.&#160;Gasmi,&#160;A.&#160;R.&#160;Sadeghi,&#160;P.&#160;Stewin,&#160;and&#160;M.&#160;Unger.&#160;Beyond&#160;secure</p>
<p style="position:absolute;top:844px;left:266px;white-space:nowrap" class="ft1678">channels.&#160;ACM-STC&#160;2007,&#160;June&#160;2007.</p>
<p style="position:absolute;top:872px;left:233px;white-space:nowrap" class="ft1678">[11]&#160;P.&#160;T.&#160;Barham,&#160;B.&#160;Dragovic,&#160;K.&#160;Fraser,&#160;S.&#160;Hand,&#160;T.&#160;L.&#160;Harris,&#160;A.&#160;Ho,&#160;R.&#160;Neuge-</p>
<p style="position:absolute;top:890px;left:266px;white-space:nowrap" class="ft16715">bauer,&#160;I.&#160;Pratt,&#160;and&#160;A.&#160;Warfield.&#160;Xen&#160;and&#160;the&#160;Art&#160;of&#160;Virtualization.&#160;In&#160;<i>Proc.&#160;19th<br/>ACM&#160;Symposium&#160;on&#160;Operating&#160;Systems&#160;Principles&#160;(SOSP-2003)</i>,&#160;pages&#160;164–<br/>177,&#160;October&#160;2003.</p>
<p style="position:absolute;top:954px;left:233px;white-space:nowrap" class="ft1678">[12]&#160;D.&#160;Beck,&#160;B.&#160;Vo,&#160;and&#160;C.&#160;Verbowski.&#160;Detecting&#160;Stealth&#160;Software&#160;with&#160;Strider</p>
<p style="position:absolute;top:972px;left:266px;white-space:nowrap" class="ft16714">GhostBuster.&#160;In&#160;<i>DSN&#160;’05:&#160;Proceedings&#160;of&#160;the&#160;2005&#160;International&#160;Conference<br/>on&#160;Dependable&#160;Systems&#160;and&#160;Networks&#160;(DSN’05)</i>,&#160;pages&#160;368–377,&#160;Washington,<br/>DC,&#160;USA,&#160;2005.&#160;IEEE&#160;Computer&#160;Society.</p>
<p style="position:absolute;top:1036px;left:233px;white-space:nowrap" class="ft1678">[13]&#160;S.&#160;Berger,&#160;R.&#160;Cáceres,&#160;K.&#160;Goldman,&#160;R.&#160;Perez,&#160;R.&#160;Sailer,&#160;and&#160;L.&#160;van&#160;Doorn.</p>
<p style="position:absolute;top:1054px;left:266px;white-space:nowrap" class="ft16740">vTPM:&#160;Virtualizing&#160;the&#160;Trusted&#160;Platform&#160;Module.&#160;In&#160;<i>Proc.&#160;15th&#160;USENIX&#160;Se-<br/>curity&#160;Symposium</i>,&#160;pages&#160;21–21,&#160;Aug.&#160;2006.</p>
<p style="position:absolute;top:1117px;left:473px;white-space:nowrap" class="ft1678">165</p>
</div>
<!-- Page 168 -->
<a name="168"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page168-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5168.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1688">166</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft16821">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:157px;white-space:nowrap" class="ft1688">[14]&#160;S.&#160;Berger,&#160;R.&#160;Cáceres,&#160;D.&#160;Pendarakis,&#160;R.&#160;Sailer,&#160;E.&#160;Valdez,&#160;R.&#160;Perez,&#160;W.&#160;Schild-</p>
<p style="position:absolute;top:212px;left:190px;white-space:nowrap" class="ft16814">hauer,&#160;and&#160;D.&#160;Srinivasan.&#160;TVDc:&#160;managing&#160;security&#160;in&#160;the&#160;trusted&#160;virtual&#160;data-<br/>center.&#160;<i>SIGOPS&#160;Operating&#160;Systems&#160;Review</i>,&#160;42(1):40–47,&#160;2008.</p>
<p style="position:absolute;top:259px;left:157px;white-space:nowrap" class="ft1688">[15]&#160;T.&#160;C.&#160;Bressoud&#160;and&#160;F.&#160;B.&#160;Schneider.&#160;Hypervisor-Based&#160;Fault&#160;Tolerance.&#160;<i>ACM</i></p>
<p style="position:absolute;top:277px;left:190px;white-space:nowrap" class="ft16820"><i>Trans.&#160;Comput.&#160;Syst.</i>,&#160;14(1):80–107,&#160;1996.</p>
<p style="position:absolute;top:307px;left:157px;white-space:nowrap" class="ft1688">[16]&#160;A.&#160;Bussani,&#160;J.&#160;L.&#160;Griffin,&#160;B.&#160;Jansen,&#160;K.&#160;Julisch,&#160;G.&#160;Karjoth,&#160;H.&#160;Maruyama,</p>
<p style="position:absolute;top:325px;left:190px;white-space:nowrap" class="ft16814">M.&#160;Nakamura,&#160;R.&#160;Perez,&#160;M.&#160;Schunter,&#160;A.&#160;Tanner,&#160;L.&#160;van&#160;Doorn,&#160;E.&#160;V.&#160;Her-<br/>reweghen,&#160;M.&#160;Waidner,&#160;and&#160;S.&#160;Yoshihama.&#160;Trusted&#160;Virtual&#160;Domains:&#160;Secure<br/>foundation&#160;for&#160;business&#160;and&#160;IT&#160;services.&#160;Research&#160;Report&#160;RC&#160;23792,&#160;IBM&#160;Re-<br/>search,&#160;Nov.&#160;2005.</p>
<p style="position:absolute;top:409px;left:157px;white-space:nowrap" class="ft1688">[17]&#160;A.&#160;C.&#160;C.&#160;Basile&#160;and&#160;A.&#160;Lioy.&#160;Algebraic&#160;models&#160;to&#160;detect&#160;and&#160;solve&#160;policy&#160;con-</p>
<p style="position:absolute;top:427px;left:190px;white-space:nowrap" class="ft16814">flicts.&#160;In&#160;I.&#160;K.&#160;V.&#160;Gorodetsky&#160;and&#160;V.&#160;Skormin,&#160;editors,&#160;<i>MMM-ACNS&#160;2007</i>,&#160;vol-<br/>ume&#160;1&#160;of&#160;<i>CCIS</i>,&#160;pages&#160;242–247.&#160;Springer-Verlag,&#160;2007.</p>
<p style="position:absolute;top:475px;left:157px;white-space:nowrap" class="ft1688">[18]&#160;S.&#160;Cabuk,&#160;C.&#160;Dalton,&#160;H.&#160;V.&#160;Ramasamy,&#160;and&#160;M.&#160;Schunter.&#160;Towards&#160;automated</p>
<p style="position:absolute;top:493px;left:190px;white-space:nowrap" class="ft16814">provisioning&#160;of&#160;secure&#160;virtualized&#160;networks.&#160;In&#160;<i>Proc.&#160;14th&#160;ACM&#160;Conference<br/>on&#160;Computer&#160;and&#160;Communications&#160;Security&#160;(CCS-2007)</i>,&#160;pages&#160;235–245,&#160;Oct.<br/>2007.</p>
<p style="position:absolute;top:558px;left:157px;white-space:nowrap" class="ft1688">[19]&#160;S.&#160;Cabuk&#160;and&#160;D.&#160;Plaquin.&#160;Security&#160;Services&#160;Management&#160;Interface&#160;(SSMI).</p>
<p style="position:absolute;top:576px;left:190px;white-space:nowrap" class="ft1688">Interface&#160;document,&#160;HP&#160;Labs,&#160;Bristol,&#160;UK,&#160;2007.</p>
<p style="position:absolute;top:606px;left:157px;white-space:nowrap" class="ft1688">[20]&#160;L.&#160;Chen,&#160;R.&#160;Landfermann,&#160;H.&#160;Loehr,&#160;M.&#160;Rohe,&#160;A.-R.&#160;Sadeghi,&#160;and&#160;C.&#160;Stüble.</p>
<p style="position:absolute;top:624px;left:190px;white-space:nowrap" class="ft16814">A&#160;protocol&#160;for&#160;property-based&#160;attestation.&#160;In&#160;<i>STC&#160;’06:&#160;Proceedings&#160;of&#160;the&#160;first<br/>ACM&#160;workshop&#160;on&#160;Scalable&#160;trusted&#160;computing</i>,&#160;pages&#160;7&#160;–&#160;16,&#160;New&#160;York,&#160;NY,<br/>USA,&#160;Nov.&#160;2006.&#160;ACM&#160;Press.</p>
<p style="position:absolute;top:690px;left:157px;white-space:nowrap" class="ft1688">[21]&#160;P.&#160;M.&#160;Chen&#160;and&#160;B.&#160;D.&#160;Noble.&#160;When&#160;Virtual&#160;is&#160;Better&#160;than&#160;Real.&#160;In&#160;<i>Proceedings&#160;of</i></p>
<p style="position:absolute;top:708px;left:190px;white-space:nowrap" class="ft16814"><i>HotOS-VIII:&#160;8th&#160;Workshop&#160;on&#160;Hot&#160;Topics&#160;in&#160;Operating&#160;Systems</i>,&#160;pages&#160;133–138,<br/>May&#160;2001.</p>
<p style="position:absolute;top:755px;left:157px;white-space:nowrap" class="ft1688">[22]&#160;D.&#160;Chess,&#160;J.&#160;Dyer,&#160;N.&#160;Itoi,&#160;J.&#160;Kravitz,&#160;E.&#160;Palmer,&#160;R.&#160;Perez,&#160;and&#160;S.&#160;Smith.&#160;Using</p>
<p style="position:absolute;top:773px;left:190px;white-space:nowrap" class="ft16815">trusted&#160;co-servers&#160;to&#160;enhance&#160;security&#160;of&#160;web&#160;interaction.&#160;United&#160;States&#160;Patent<br/>7,194,759:</p>
<p style="position:absolute;top:792px;left:258px;white-space:nowrap" class="ft16834"><a href="http://www.freepatentsonline.com/7194759.html">http://www.freepatentsonline.com/7194759.html</a></p>
<p style="position:absolute;top:791px;left:662px;white-space:nowrap" class="ft1688"><a href="http://www.freepatentsonline.com/7194759.html">,</a></p>
<p style="position:absolute;top:809px;left:190px;white-space:nowrap" class="ft1688">Mar.&#160;2007.</p>
<p style="position:absolute;top:839px;left:157px;white-space:nowrap" class="ft1688">[23]&#160;C.&#160;Clark,&#160;K.&#160;Fraser,&#160;S.&#160;Hand,&#160;J.&#160;G.&#160;Hansen,&#160;E.&#160;Jul,&#160;C.&#160;Limpach,&#160;I.&#160;Pratt,&#160;and</p>
<p style="position:absolute;top:857px;left:190px;white-space:nowrap" class="ft16814">A.&#160;Warfield.&#160;Live&#160;Migration&#160;of&#160;Virtual&#160;Machines.&#160;In&#160;<i>Proc.&#160;2nd&#160;Symposium&#160;on<br/>Networked&#160;Systems&#160;Design&#160;and&#160;Implementation&#160;(NSDI-2005)</i>,&#160;pages&#160;273–286,<br/>May&#160;2005.</p>
<p style="position:absolute;top:923px;left:157px;white-space:nowrap" class="ft1688">[24]&#160;D.&#160;E.&#160;Clarke,&#160;G.&#160;E.&#160;Suh,&#160;B.&#160;Gassend,&#160;A.&#160;Sudan,&#160;M.&#160;van&#160;Dijk,&#160;and&#160;S.&#160;Devadas.</p>
<p style="position:absolute;top:941px;left:190px;white-space:nowrap" class="ft16814">Towards&#160;constant&#160;bandwidth&#160;overhead&#160;integrity&#160;checking&#160;of&#160;untrusted&#160;data.&#160;In<br/><i>IEEE&#160;Symposium&#160;on&#160;Security&#160;and&#160;Privacy</i>,&#160;pages&#160;139–153.&#160;IEEE&#160;Computer&#160;So-<br/>ciety,&#160;2005.</p>
<p style="position:absolute;top:1007px;left:157px;white-space:nowrap" class="ft1688">[25]&#160;Common&#160;Criteria&#160;Project&#160;Sponsoring&#160;Organisations.&#160;Common&#160;Criteria&#160;for&#160;In-</p>
<p style="position:absolute;top:1024px;left:190px;white-space:nowrap" class="ft16814">formation&#160;Technology&#160;Security&#160;Evaluation&#160;(version&#160;2.0).&#160;dopted&#160;by&#160;ISO/IEC&#160;as<br/>Draft&#160;International&#160;Standard&#160;DIS&#160;15408&#160;1-3,&#160;May&#160;1998.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft16821">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 169 -->
<a name="169"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page169-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5169.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1698">BIBLIOGRAPHY</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1698">167</p>
<p style="position:absolute;top:194px;left:233px;white-space:nowrap" class="ft1698">[26]&#160;I.&#160;B.&#160;Damgård,&#160;T.&#160;P.&#160;Pedersen,&#160;and&#160;B.&#160;Pfitzmann.&#160;Statistical&#160;Secrecy&#160;and&#160;Multi-</p>
<p style="position:absolute;top:212px;left:266px;white-space:nowrap" class="ft1698">Bit&#160;Commitments.</p>
<p style="position:absolute;top:212px;left:393px;white-space:nowrap" class="ft16920"><i>IEEE&#160;Transactions&#160;on&#160;Information&#160;Theory</i>,&#160;44(3):1143–</p>
<p style="position:absolute;top:230px;left:266px;white-space:nowrap" class="ft1698">1151,&#160;1998.</p>
<p style="position:absolute;top:259px;left:233px;white-space:nowrap" class="ft1698">[27]&#160;T.&#160;Dierks&#160;and&#160;E.&#160;Rescorla.&#160;The&#160;Transport&#160;Layer&#160;Security&#160;(TLS)&#160;Protocol&#160;Ver-</p>
<p style="position:absolute;top:276px;left:266px;white-space:nowrap" class="ft1698">sion&#160;1.1.&#160;Internet&#160;Engineering&#160;Task&#160;Force:</p>
<p style="position:absolute;top:277px;left:527px;white-space:nowrap" class="ft16934"><a href="http://www.ietf.org/rfc/rfc4346.txt">http://www.ietf.org/rfc/</a></p>
<p style="position:absolute;top:295px;left:266px;white-space:nowrap" class="ft16934"><a href="http://www.ietf.org/rfc/rfc4346.txt">rfc4346.txt</a></p>
<p style="position:absolute;top:294px;left:365px;white-space:nowrap" class="ft1698"><a href="http://www.ietf.org/rfc/rfc4346.txt">,&#160;</a>Apr.&#160;2006.&#160;Network&#160;Working&#160;Group&#160;RFC&#160;4346.</p>
<p style="position:absolute;top:323px;left:233px;white-space:nowrap" class="ft1698">[28]&#160;J.&#160;Dike.&#160;A&#160;User-Mode&#160;Port&#160;of&#160;the&#160;Linux&#160;Kernel.&#160;In&#160;<i>ALS’00:&#160;Proceedings&#160;of</i></p>
<p style="position:absolute;top:341px;left:266px;white-space:nowrap" class="ft16914"><i>the&#160;4th&#160;conference&#160;on&#160;4th&#160;Annual&#160;Linux&#160;Showcase&#160;&amp;&#160;Conference,&#160;Atlanta</i>,&#160;pages<br/>7–7,&#160;Berkeley,&#160;CA,&#160;USA,&#160;2000.&#160;USENIX&#160;Association.</p>
<p style="position:absolute;top:388px;left:233px;white-space:nowrap" class="ft1698">[29]&#160;J.&#160;R.&#160;Douceur&#160;and&#160;J.&#160;Howell.&#160;Replicated&#160;Virtual&#160;Machines.&#160;Technical&#160;Report</p>
<p style="position:absolute;top:406px;left:266px;white-space:nowrap" class="ft1698">MSR&#160;TR-2005-119,&#160;Microsoft&#160;Research,&#160;September&#160;2005.</p>
<p style="position:absolute;top:435px;left:233px;white-space:nowrap" class="ft1698">[30]&#160;B.&#160;Dragovic,&#160;K.&#160;Fraser,&#160;S.&#160;Hand,&#160;T.&#160;Harris,&#160;A.&#160;Ho,&#160;I.&#160;Pratt,&#160;A.&#160;Warfield,</p>
<p style="position:absolute;top:453px;left:266px;white-space:nowrap" class="ft16940">P.&#160;Barham,&#160;and&#160;R.&#160;Neugebauer.&#160;Xen&#160;and&#160;the&#160;art&#160;of&#160;virtualization.&#160;In&#160;<i>Proceedings<br/>of&#160;the&#160;ACM&#160;Symposium&#160;on&#160;Operating&#160;Systems&#160;Principles</i>,&#160;October&#160;2003.</p>
<p style="position:absolute;top:500px;left:233px;white-space:nowrap" class="ft1698">[31]&#160;G.&#160;W.&#160;Dunlap,&#160;S.&#160;T.&#160;King,&#160;S.&#160;Cinar,&#160;M.&#160;A.&#160;Basrai,&#160;and&#160;P.&#160;M.&#160;Chen.</p>
<p style="position:absolute;top:500px;left:720px;white-space:nowrap" class="ft1698">Re-</p>
<p style="position:absolute;top:518px;left:266px;white-space:nowrap" class="ft16914">Virt:&#160;Enabling&#160;Intrusion&#160;Analysis&#160;through&#160;Virtual-Machine&#160;Logging&#160;and&#160;Replay.<br/><i>SIGOPS&#160;Operating&#160;System&#160;Review</i>,&#160;36(SI):211–224,&#160;2002.</p>
<p style="position:absolute;top:565px;left:233px;white-space:nowrap" class="ft1698">[32]&#160;N.&#160;Dunlop,&#160;J.&#160;Indulska,&#160;and&#160;K.&#160;A.&#160;Raymond.&#160;A&#160;formal&#160;specification&#160;of&#160;conflicts</p>
<p style="position:absolute;top:583px;left:266px;white-space:nowrap" class="ft16914">in&#160;dynamic&#160;policy-based&#160;management&#160;systems.&#160;DSTC&#160;Technical&#160;Report,&#160;CRC<br/>for&#160;Enterprise&#160;Distributed&#160;Systems,&#160;University&#160;of&#160;Queensland,&#160;Australia,&#160;Aug.<br/>2001.</p>
<p style="position:absolute;top:647px;left:233px;white-space:nowrap" class="ft1698">[33]&#160;H.&#160;H.&#160;E.&#160;Al-Shaer,&#160;R.&#160;Boutaba&#160;and&#160;M.&#160;Hasan.&#160;Conflict&#160;classification&#160;and&#160;analysis</p>
<p style="position:absolute;top:665px;left:266px;white-space:nowrap" class="ft16940">of&#160;distributed&#160;firewall&#160;policies.&#160;<i>IEEE&#160;Journal&#160;on&#160;Selected&#160;Areas&#160;in&#160;Communica-<br/>tions,&#160;IEEE</i>,&#160;23(10):2069–2084,&#160;Oct.&#160;2005.</p>
<p style="position:absolute;top:712px;left:233px;white-space:nowrap" class="ft1698">[34]&#160;D.&#160;Eastlake&#160;and&#160;P.&#160;Jones.&#160;US&#160;Secure&#160;Hash&#160;Algorithm&#160;1&#160;(SHA1).&#160;Internet&#160;Engi-</p>
<p style="position:absolute;top:730px;left:266px;white-space:nowrap" class="ft1698">neering&#160;Task&#160;Force&#160;(IETF):</p>
<p style="position:absolute;top:731px;left:433px;white-space:nowrap" class="ft16934"><a href="http://tools.ietf.org/html/rfc3174">http://tools.ietf.org/html/rfc3174</a></p>
<p style="position:absolute;top:730px;left:738px;white-space:nowrap" class="ft1698"><a href="http://tools.ietf.org/html/rfc3174">,</a></p>
<p style="position:absolute;top:748px;left:266px;white-space:nowrap" class="ft1698">Sept.&#160;2001.&#160;Network&#160;Working&#160;Group.</p>
<p style="position:absolute;top:777px;left:233px;white-space:nowrap" class="ft1698">[35]&#160;P.&#160;England,&#160;B.&#160;Lampson,&#160;J.&#160;Manferdelli,&#160;and&#160;B.&#160;Willman.&#160;A&#160;trusted&#160;open&#160;plat-</p>
<p style="position:absolute;top:795px;left:266px;white-space:nowrap" class="ft1698">form.&#160;<i>Computer</i>,&#160;36(7):55–62,&#160;2003.</p>
<p style="position:absolute;top:824px;left:233px;white-space:nowrap" class="ft1698">[36]&#160;European&#160;Multilaterally&#160;Secure&#160;Computing&#160;Base&#160;(EMSCB)&#160;Project.&#160;Towards</p>
<p style="position:absolute;top:842px;left:266px;white-space:nowrap" class="ft1698">Trustworthy&#160;Systems&#160;with&#160;Open&#160;Standards&#160;and&#160;Trusted&#160;Computing,&#160;2008.</p>
<p style="position:absolute;top:861px;left:266px;white-space:nowrap" class="ft16934"><a href="http://www.emscb.de">http://www.emscb.de</a></p>
<p style="position:absolute;top:860px;left:436px;white-space:nowrap" class="ft1698"><a href="http://www.emscb.de">.</a></p>
<p style="position:absolute;top:889px;left:233px;white-space:nowrap" class="ft1698">[37]&#160;M.&#160;Franz,&#160;D.&#160;Chandra,&#160;A.&#160;Gal,&#160;V.&#160;Haldar,&#160;C.&#160;W.&#160;Probst,&#160;F.&#160;Reig,&#160;and&#160;N.&#160;Wang.</p>
<p style="position:absolute;top:907px;left:266px;white-space:nowrap" class="ft16940">A&#160;portable&#160;virtual&#160;machine&#160;target&#160;for&#160;proof-carrying&#160;code.&#160;<i>Journal&#160;of&#160;Science<br/>of&#160;Computer&#160;Programming</i>,&#160;57(3):275–294,&#160;sep&#160;2005.</p>
<p style="position:absolute;top:925px;left:598px;white-space:nowrap" class="ft16934"><a href="http://www2.imm.dtu.dk/pubdb/p.php?4740">http://www2.imm.</a></p>
<p style="position:absolute;top:943px;left:266px;white-space:nowrap" class="ft16934"><a href="http://www2.imm.dtu.dk/pubdb/p.php?4740">dtu.dk/pubdb/p.php?4740</a></p>
<p style="position:absolute;top:943px;left:472px;white-space:nowrap" class="ft1698"><a href="http://www2.imm.dtu.dk/pubdb/p.php?4740">.</a></p>
<p style="position:absolute;top:972px;left:233px;white-space:nowrap" class="ft1698">[38]&#160;Z.&#160;Fu,&#160;S.&#160;F.&#160;Wu,&#160;H.&#160;Huang,&#160;K.&#160;Loh,&#160;F.&#160;Gong,&#160;I.&#160;Baldine,&#160;and&#160;C.&#160;Xu.&#160;IPSec/VPN</p>
<p style="position:absolute;top:989px;left:266px;white-space:nowrap" class="ft16914">security&#160;policy:&#160;Correctness,&#160;conflict&#160;detection,&#160;and&#160;resolution.&#160;In&#160;<i>POLICY</i>,<br/>pages&#160;39–56,&#160;2001.</p>
<p style="position:absolute;top:1036px;left:233px;white-space:nowrap" class="ft1698">[39]&#160;T.&#160;Garfinkel,&#160;B.&#160;Pfaff,&#160;J.&#160;Chow,&#160;M.&#160;Rosenblum,&#160;and&#160;D.&#160;Boneh.&#160;Terra:&#160;a&#160;virtual</p>
<p style="position:absolute;top:1054px;left:266px;white-space:nowrap" class="ft16940">machine-based&#160;platform&#160;for&#160;trusted&#160;computing.&#160;In&#160;<i>ACM&#160;Symposium&#160;on&#160;Operat-<br/>ing&#160;Systems&#160;Principles&#160;(ASOSP)</i>,&#160;pages&#160;193–206.&#160;ACM&#160;Press,&#160;2003.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft16921">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 170 -->
<a name="170"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page170-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5170.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1708">168</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft17021">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:157px;white-space:nowrap" class="ft1708">[40]&#160;T.&#160;Garfinkel&#160;and&#160;M.&#160;Rosenblum.&#160;A&#160;Virtual&#160;Machine&#160;Introspection&#160;Based&#160;Ar-</p>
<p style="position:absolute;top:212px;left:190px;white-space:nowrap" class="ft17040">chitecture&#160;for&#160;Intrusion&#160;Detection.&#160;In&#160;<i>Proc.&#160;Network&#160;and&#160;Distributed&#160;Systems<br/>Security&#160;Symposium</i>,&#160;February&#160;2003.</p>
<p style="position:absolute;top:259px;left:157px;white-space:nowrap" class="ft1708">[41]&#160;T.&#160;Garfinkel&#160;and&#160;M.&#160;Rosenblum.&#160;When&#160;Virtual&#160;is&#160;Harder&#160;than&#160;Real:&#160;Security</p>
<p style="position:absolute;top:277px;left:190px;white-space:nowrap" class="ft17040">Challenges&#160;in&#160;Virtual&#160;Machine&#160;Based&#160;Computing&#160;Environments.&#160;In&#160;<i>Proc.&#160;10th<br/>Workshop&#160;on&#160;Hot&#160;Topics&#160;in&#160;Operating&#160;Systems&#160;(HotOS-X)</i>,&#160;May&#160;2005.</p>
<p style="position:absolute;top:324px;left:157px;white-space:nowrap" class="ft1708">[42]&#160;Y.&#160;Gasmi,&#160;A.-R.&#160;Sadeghi,&#160;P.&#160;Stewin,&#160;M.&#160;Unger,&#160;and&#160;N.&#160;Asokan.&#160;Beyond&#160;Secure</p>
<p style="position:absolute;top:342px;left:190px;white-space:nowrap" class="ft17056">Channels.&#160;In&#160;<i>STC&#160;’07:&#160;Proceedings&#160;of&#160;the&#160;second&#160;ACM&#160;workshop&#160;on&#160;Scalable<br/>Trusted&#160;Computing</i>,&#160;pages&#160;30–40.&#160;ACM&#160;Press,&#160;2007.</p>
<p style="position:absolute;top:390px;left:157px;white-space:nowrap" class="ft1708">[43]&#160;K.&#160;Goldman,&#160;R.&#160;Perez,&#160;and&#160;R.&#160;Sailer.&#160;Linking&#160;remote&#160;attestation&#160;to&#160;secure&#160;tunnel</p>
<p style="position:absolute;top:408px;left:190px;white-space:nowrap" class="ft17056">endpoints.&#160;In&#160;<i>STC&#160;’06:&#160;Proceedings&#160;of&#160;the&#160;first&#160;ACM&#160;workshop&#160;on&#160;Scalable<br/>trusted&#160;computing</i>,&#160;pages&#160;21–24,&#160;New&#160;York,&#160;NY,&#160;USA,&#160;Nov.&#160;2006.&#160;ACM&#160;Press.</p>
<p style="position:absolute;top:455px;left:157px;white-space:nowrap" class="ft1708">[44]&#160;O.&#160;Goldreich,&#160;S.&#160;Micali,&#160;and&#160;A.&#160;Wigderson.&#160;Proofs&#160;that&#160;Yield&#160;Nothing&#160;but&#160;their</p>
<p style="position:absolute;top:473px;left:190px;white-space:nowrap" class="ft17056">Validity,&#160;or&#160;All&#160;Languages&#160;in&#160;NP&#160;have&#160;Zero-Knowledge&#160;Proof&#160;Systems.&#160;<i>Journal<br/>of&#160;the&#160;ACM</i>,&#160;38(3):690–728,&#160;1991.</p>
<p style="position:absolute;top:520px;left:157px;white-space:nowrap" class="ft1708">[45]&#160;J.&#160;Griffin,&#160;T.&#160;Jaeger,&#160;R.&#160;Perez,&#160;R.&#160;Sailer,&#160;L.&#160;V.&#160;Doorn,&#160;and&#160;R.&#160;Caceres.&#160;Trusted</p>
<p style="position:absolute;top:538px;left:190px;white-space:nowrap" class="ft17014">Virtual&#160;Domains:&#160;Toward&#160;secure&#160;distributed&#160;services.&#160;In&#160;<i>Proc.&#160;1st&#160;Workshop<br/>on&#160;Hot&#160;Topics&#160;in&#160;System&#160;Dependability&#160;(Hotdep-2005)</i>,&#160;Yokohama,&#160;Japan,&#160;June<br/>2005.&#160;IEEE&#160;Press.</p>
<p style="position:absolute;top:604px;left:157px;white-space:nowrap" class="ft1708">[46]&#160;M.&#160;D.&#160;H.&#160;Debar&#160;and&#160;A.&#160;Wespi.&#160;A&#160;Revised&#160;Taxonomy&#160;of&#160;Intrusion-Detection</p>
<p style="position:absolute;top:621px;left:190px;white-space:nowrap" class="ft1708">Systems.&#160;<i>Annales&#160;des&#160;Telecommunications</i>,&#160;55(7-8):83–100,&#160;2000.</p>
<p style="position:absolute;top:651px;left:157px;white-space:nowrap" class="ft1708">[47]&#160;V.&#160;Haldar,&#160;D.&#160;Chandra,&#160;and&#160;M.&#160;Franz.&#160;Semantic&#160;Remote&#160;Attestation&#160;-&#160;virtual</p>
<p style="position:absolute;top:669px;left:190px;white-space:nowrap" class="ft17015">machine&#160;directed&#160;approach&#160;to&#160;Trusted&#160;Computing.&#160;In&#160;<i>USENIX&#160;Virtual&#160;Machine<br/>Research&#160;and&#160;Technology&#160;Symposium</i>,&#160;pages&#160;29–41,&#160;2004.&#160;also&#160;Technical&#160;Re-<br/>port&#160;No.&#160;03-20,&#160;School&#160;of&#160;Information&#160;and&#160;Computer&#160;Science,&#160;University&#160;of<br/>California,&#160;Irvine.</p>
<p style="position:absolute;top:752px;left:157px;white-space:nowrap" class="ft1708">[48]&#160;R.&#160;Housley,&#160;W.&#160;Ford,&#160;W.&#160;Polk,&#160;and&#160;D.&#160;Solo.</p>
<p style="position:absolute;top:752px;left:525px;white-space:nowrap" class="ft1708">Internet&#160;X.509&#160;Public</p>
<p style="position:absolute;top:770px;left:190px;white-space:nowrap" class="ft1708">Key&#160;Infrastructure&#160;Certificate&#160;and&#160;CRL&#160;Profile5.</p>
<p style="position:absolute;top:770px;left:505px;white-space:nowrap" class="ft1708">Internet&#160;Engineering&#160;Task</p>
<p style="position:absolute;top:788px;left:190px;white-space:nowrap" class="ft1708">Force:</p>
<p style="position:absolute;top:789px;left:237px;white-space:nowrap" class="ft17034"><a href="http://www.ietf.org/rfc/rfc2459.txt">http://www.ietf.org/rfc/rfc2459.txt</a></p>
<p style="position:absolute;top:788px;left:551px;white-space:nowrap" class="ft1708"><a href="http://www.ietf.org/rfc/rfc2459.txt">,&#160;</a>Jan.&#160;1999.&#160;Net-</p>
<p style="position:absolute;top:806px;left:190px;white-space:nowrap" class="ft1708">work&#160;Working&#160;Group.</p>
<p style="position:absolute;top:835px;left:157px;white-space:nowrap" class="ft1708">[49]&#160;IEEE.&#160;Standards&#160;for&#160;local&#160;and&#160;metropolitan&#160;area&#160;networks:&#160;Virtual&#160;bridged&#160;local</p>
<p style="position:absolute;top:853px;left:190px;white-space:nowrap" class="ft1708">area&#160;networks.&#160;Technical&#160;Report&#160;ISBN&#160;0-7381-3662-X,&#160;IEEE,&#160;1998.</p>
<p style="position:absolute;top:883px;left:157px;white-space:nowrap" class="ft1708">[50]&#160;IEEE.&#160;802.1x:&#160;IEEE&#160;standard&#160;for&#160;local&#160;and&#160;metropolitan&#160;networks&#160;—&#160;port-based</p>
<p style="position:absolute;top:901px;left:190px;white-space:nowrap" class="ft1708">network&#160;access&#160;control.&#160;IEEE&#160;Standards,&#160;2004.&#160;Revision&#160;of&#160;802.1X-2001.</p>
<p style="position:absolute;top:930px;left:157px;white-space:nowrap" class="ft1708">[51]&#160;IETF.&#160;Certificate&#160;management&#160;messages&#160;over&#160;CMS.&#160;RFC&#160;2797.</p>
<p style="position:absolute;top:960px;left:157px;white-space:nowrap" class="ft1708">[52]&#160;IETF.&#160;EtherIP:&#160;Tunneling&#160;Ethernet&#160;Frames&#160;in&#160;IP&#160;Datagrams,&#160;2002.&#160;RFC&#160;3378.</p>
<p style="position:absolute;top:989px;left:157px;white-space:nowrap" class="ft1708">[53]&#160;IETF.&#160;SSL&#160;3.0&#160;specification.&#160;Netscape.com:</p>
<p style="position:absolute;top:990px;left:459px;white-space:nowrap" class="ft17034"><a href="http://wp.netscape.com/eng/ssl3/3-SPEC.HTM">http://wp.netscape.com/</a></p>
<p style="position:absolute;top:1008px;left:190px;white-space:nowrap" class="ft17034"><a href="http://wp.netscape.com/eng/ssl3/3-SPEC.HTM">eng/ssl3/3-SPEC.HTM</a></p>
<p style="position:absolute;top:1007px;left:361px;white-space:nowrap" class="ft1708"><a href="http://wp.netscape.com/eng/ssl3/3-SPEC.HTM">,&#160;</a>May&#160;2008.&#160;Network&#160;Working&#160;Group.</p>
<p style="position:absolute;top:1036px;left:157px;white-space:nowrap" class="ft1708">[54]&#160;B.&#160;Jansen,&#160;H.&#160;Ramasamy,&#160;and&#160;M.&#160;Schunter.&#160;Flexible&#160;integrity&#160;protection&#160;an</p>
<p style="position:absolute;top:1054px;left:190px;white-space:nowrap" class="ft17040">verification&#160;architecture&#160;for&#160;virtual&#160;machine&#160;monitors.&#160;In&#160;<i>The&#160;Second&#160;Workshop<br/>on&#160;Advances&#160;in&#160;Trusted&#160;Computing</i>,&#160;Tokyo,&#160;Japan,&#160;November&#160;2006.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft17021">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 171 -->
<a name="171"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page171-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5171.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1718">BIBLIOGRAPHY</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1718">169</p>
<p style="position:absolute;top:194px;left:233px;white-space:nowrap" class="ft1718">[55]&#160;B.&#160;Jansen,&#160;H.-G.&#160;V.&#160;Ramasamy,&#160;and&#160;M.&#160;Schunter.&#160;Policy&#160;enforcement&#160;and&#160;com-</p>
<p style="position:absolute;top:212px;left:266px;white-space:nowrap" class="ft17156">pliance&#160;proofs&#160;for&#160;xen&#160;virtual&#160;machines.&#160;In&#160;<i>VEE&#160;’08:&#160;Proceedings&#160;of&#160;the&#160;fourth<br/>ACM&#160;SIGPLAN/SIGOPS&#160;international&#160;conference&#160;on&#160;Virtual&#160;execution&#160;environ-<br/>ments</i>,&#160;pages&#160;101–110,&#160;New&#160;York,&#160;NY,&#160;USA,&#160;2008.&#160;ACM.</p>
<p style="position:absolute;top:277px;left:233px;white-space:nowrap" class="ft1718">[56]&#160;S.&#160;Jiang,&#160;S.&#160;Smith,&#160;and&#160;K.&#160;Minami.&#160;Securing&#160;Web&#160;Servers&#160;against&#160;Insider&#160;Attack.</p>
<p style="position:absolute;top:295px;left:266px;white-space:nowrap" class="ft17140">In&#160;<i>ACSAC&#160;’01:&#160;Proceedings&#160;of&#160;the&#160;17th&#160;Annual&#160;Computer&#160;Security&#160;Applications<br/>Conference</i>,&#160;page&#160;265,&#160;Washington,&#160;DC,&#160;USA,&#160;2001.&#160;IEEE&#160;Computer&#160;Society.</p>
<p style="position:absolute;top:343px;left:233px;white-space:nowrap" class="ft1718">[57]&#160;X.&#160;Jiang,&#160;X.&#160;Wang,&#160;and&#160;D.&#160;Xu.&#160;Stealthy&#160;malware&#160;detection&#160;through&#160;vmm-based</p>
<p style="position:absolute;top:361px;left:266px;white-space:nowrap" class="ft17115">&#34;out-of-the-box&#34;&#160;semantic&#160;view&#160;reconstruction.&#160;In&#160;<i>CCS&#160;’07:&#160;Proceedings&#160;of&#160;the<br/>14th&#160;ACM&#160;conference&#160;on&#160;Computer&#160;and&#160;communications&#160;security</i>,&#160;pages&#160;128–<br/>138,&#160;New&#160;York,&#160;NY,&#160;USA,&#160;2007.&#160;ACM.</p>
<p style="position:absolute;top:427px;left:233px;white-space:nowrap" class="ft1718">[58]&#160;B.&#160;W.&#160;Johnson.&#160;<i>Design&#160;and&#160;Analysis&#160;of&#160;Fault-Tolerant&#160;Digital&#160;Systems</i>.&#160;Addison-</p>
<p style="position:absolute;top:445px;left:266px;white-space:nowrap" class="ft1718">Wesley,&#160;1989.</p>
<p style="position:absolute;top:475px;left:233px;white-space:nowrap" class="ft1718">[59]&#160;A.&#160;Joshi,&#160;S.&#160;T.&#160;King,&#160;G.&#160;W.&#160;Dunlap,&#160;and&#160;P.&#160;M.&#160;Chen.&#160;Detecting&#160;Past&#160;and&#160;Present</p>
<p style="position:absolute;top:493px;left:266px;white-space:nowrap" class="ft17156">Intrusions&#160;through&#160;Vulnerability-Specific&#160;Predicates.&#160;In&#160;<i>Proc.&#160;20th&#160;ACM&#160;Sym-<br/>posium&#160;on&#160;Operating&#160;Systems&#160;Principles&#160;(SOSP-2005)</i>,&#160;pages&#160;91–104,&#160;2005.</p>
<p style="position:absolute;top:540px;left:233px;white-space:nowrap" class="ft1718">[60]&#160;B.&#160;S.&#160;K.&#160;Jr.&#160;An&#160;overview&#160;of&#160;the&#160;PKCS&#160;standards.&#160;Technical&#160;note,&#160;RSA&#160;Labora-</p>
<p style="position:absolute;top:558px;left:266px;white-space:nowrap" class="ft1718">tories,&#160;Nov.&#160;1993.</p>
<p style="position:absolute;top:588px;left:233px;white-space:nowrap" class="ft1718">[61]&#160;G.&#160;Karjoth,&#160;B.&#160;Pfitzmann,&#160;M.&#160;Schunter,&#160;and&#160;M.&#160;Waidner.&#160;Service-oriented&#160;assur-</p>
<p style="position:absolute;top:606px;left:266px;white-space:nowrap" class="ft17140">ance&#160;–&#160;comprehensive&#160;security&#160;by&#160;explicit&#160;assurances.&#160;In&#160;D.&#160;Gollmann,&#160;F.&#160;Mas-<br/>sacci,&#160;and&#160;A.&#160;Yautsiukhin,&#160;editors,&#160;<i>Quality&#160;of&#160;Protection:&#160;Security&#160;Measure-<br/>ments&#160;and&#160;Metrics</i>,&#160;LNCS,&#160;pages&#160;13–24.&#160;Springer–Verlag,&#160;Berlin,&#160;2006.</p>
<p style="position:absolute;top:672px;left:233px;white-space:nowrap" class="ft1718">[62]&#160;Y.&#160;Katsuno,&#160;M.&#160;Kudo,&#160;Y.&#160;Watanabe,&#160;S.&#160;Yoshihama,&#160;R.&#160;Perez,&#160;R.&#160;Sailer,&#160;and</p>
<p style="position:absolute;top:690px;left:266px;white-space:nowrap" class="ft17114">L.&#160;van&#160;Doorn.&#160;Towards&#160;Multi–Layer&#160;Trusted&#160;Virtual&#160;Domains.&#160;In&#160;<i>The&#160;Second<br/>Workshop&#160;on&#160;Advances&#160;in&#160;Trusted&#160;Computing&#160;(WATC&#160;’06&#160;Fall)</i>,&#160;Tokyo,&#160;Japan,<br/>Nov.&#160;2006.&#160;From&#160;http://www.trl.ibm.com/projects/watc/program.htm.</p>
<p style="position:absolute;top:755px;left:233px;white-space:nowrap" class="ft1718">[63]&#160;S.&#160;Kent&#160;and&#160;K.&#160;Seo.&#160;Security&#160;Architecture&#160;for&#160;the&#160;Internet&#160;Protocol.&#160;Internet</p>
<p style="position:absolute;top:773px;left:266px;white-space:nowrap" class="ft1718">Engineering&#160;Task&#160;Force:</p>
<p style="position:absolute;top:774px;left:424px;white-space:nowrap" class="ft17134"><a href="http://www.ietf.org/rfc/rfc4301.txt">http://www.ietf.org/rfc/rfc4301.txt</a></p>
<p style="position:absolute;top:773px;left:738px;white-space:nowrap" class="ft1718"><a href="http://www.ietf.org/rfc/rfc4301.txt">,</a></p>
<p style="position:absolute;top:791px;left:266px;white-space:nowrap" class="ft1718">Dec.&#160;2005.&#160;Network&#160;Working&#160;Group&#160;RFC&#160;4346.&#160;Obsoletes:&#160;RCF2401.</p>
<p style="position:absolute;top:821px;left:233px;white-space:nowrap" class="ft1718">[64]&#160;S.&#160;T.&#160;King&#160;and&#160;P.&#160;M.&#160;Chen.&#160;Backtracking&#160;Intrusions.&#160;In&#160;<i>Proc.&#160;19th&#160;ACM&#160;Sym-</i></p>
<p style="position:absolute;top:839px;left:266px;white-space:nowrap" class="ft17120"><i>posium&#160;on&#160;Operating&#160;Systems&#160;Principles&#160;(SOSP-2003)</i>,&#160;pages&#160;223–236,&#160;2003.</p>
<p style="position:absolute;top:869px;left:233px;white-space:nowrap" class="ft1718">[65]&#160;S.&#160;T.&#160;King,&#160;G.&#160;W.&#160;Dunlap,&#160;and&#160;P.&#160;M.&#160;Chen.&#160;Debugging&#160;Operating&#160;Systems&#160;with</p>
<p style="position:absolute;top:887px;left:266px;white-space:nowrap" class="ft17156">Time-Traveling&#160;Virtual&#160;Machines.&#160;In&#160;<i>Proc.&#160;2005&#160;Annual&#160;USENIX&#160;Technical<br/>Conference</i>,&#160;pages&#160;1–15,&#160;April&#160;2005.</p>
<p style="position:absolute;top:935px;left:233px;white-space:nowrap" class="ft1718">[66]&#160;S.&#160;T.&#160;King,&#160;Z.&#160;M.&#160;Mao,&#160;D.&#160;G.&#160;Lucchetti,&#160;and&#160;P.&#160;M.&#160;Chen.&#160;Enriching&#160;Intrusion</p>
<p style="position:absolute;top:953px;left:266px;white-space:nowrap" class="ft17156">Alerts&#160;through&#160;Multi-Host&#160;Causality.&#160;In&#160;<i>Proc.&#160;Network&#160;and&#160;Distributed&#160;System<br/>Security&#160;Symposium&#160;(NDSS-2005)</i>,&#160;2005.</p>
<p style="position:absolute;top:1001px;left:233px;white-space:nowrap" class="ft1718">[67]&#160;E.&#160;Kotsovinos,&#160;T.&#160;Moreton,&#160;I.&#160;Pratt,&#160;R.&#160;Ross,&#160;K.&#160;Fraser,&#160;S.&#160;Hand,&#160;and&#160;T.&#160;Harris.</p>
<p style="position:absolute;top:1018px;left:266px;white-space:nowrap" class="ft17156">Global-scale&#160;Service&#160;Deployment&#160;in&#160;the&#160;XenoServer&#160;Platform.&#160;In&#160;<i>Proceedings<br/>of&#160;the&#160;1st&#160;USENIX&#160;Workshop&#160;on&#160;Real,&#160;Large&#160;Distributed&#160;Systems&#160;(WORLDS<br/>’04)</i>,&#160;San&#160;Francisco,&#160;CA,&#160;December&#160;2004.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft17121">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 172 -->
<a name="172"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page172-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5172.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1728">170</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft17221">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:157px;white-space:nowrap" class="ft1728">[68]&#160;D.&#160;Kuhlmann,&#160;R.&#160;Landfermann,&#160;H.&#160;Ramasamy,&#160;M.&#160;Schunter,&#160;G.&#160;Ra-</p>
<p style="position:absolute;top:212px;left:190px;white-space:nowrap" class="ft1728">munno,</p>
<p style="position:absolute;top:212px;left:249px;white-space:nowrap" class="ft1728">and&#160;D.&#160;Vernizzi.</p>
<p style="position:absolute;top:212px;left:397px;white-space:nowrap" class="ft1728">An&#160;Open&#160;Trusted&#160;Computing&#160;Architec-</p>
<p style="position:absolute;top:230px;left:190px;white-space:nowrap" class="ft17215">ture&#160;-&#160;Secure&#160;virtual&#160;machines&#160;enabling&#160;user-defined&#160;policy&#160;enforcement,<br/>2006.</p>
<p style="position:absolute;top:248px;left:253px;white-space:nowrap" class="ft17234"><a href="http://www.opentc.net/images/otc_architecture_high_level_overview.pdf">http://www.opentc.net/images/otc_architecture_</a></p>
<p style="position:absolute;top:266px;left:190px;white-space:nowrap" class="ft17234"><a href="http://www.opentc.net/images/otc_architecture_high_level_overview.pdf">high_level_overview.pdf</a></p>
<p style="position:absolute;top:265px;left:396px;white-space:nowrap" class="ft1728"><a href="http://www.opentc.net/images/otc_architecture_high_level_overview.pdf">.</a></p>
<p style="position:absolute;top:294px;left:157px;white-space:nowrap" class="ft1728">[69]&#160;U.&#160;Kühn,&#160;M.&#160;Selhorst,&#160;and&#160;C.&#160;Stüble.&#160;Realizing&#160;property-based&#160;attestation&#160;and</p>
<p style="position:absolute;top:312px;left:190px;white-space:nowrap" class="ft17214">sealing&#160;with&#160;commonly&#160;available&#160;hard-&#160;and&#160;software.&#160;In&#160;<i>STC&#160;’07:&#160;Proceedings<br/>of&#160;the&#160;2007&#160;ACM&#160;workshop&#160;on&#160;Scalable&#160;trusted&#160;computing</i>,&#160;pages&#160;50–57,&#160;New<br/>York,&#160;NY,&#160;USA,&#160;2007.&#160;ACM.</p>
<p style="position:absolute;top:377px;left:157px;white-space:nowrap" class="ft1728">[70]&#160;The&#160;Fiasco&#160;micro-kernel,&#160;2004.</p>
<p style="position:absolute;top:377px;left:432px;white-space:nowrap" class="ft1728">Available&#160;from</p>
<p style="position:absolute;top:378px;left:540px;white-space:nowrap" class="ft17234"><a href="http://os.inf.tu-dresden.de/fiasco/">http://os.inf.</a></p>
<p style="position:absolute;top:396px;left:190px;white-space:nowrap" class="ft17234"><a href="http://os.inf.tu-dresden.de/fiasco/">tu-dresden.de/fiasco/</a></p>
<p style="position:absolute;top:395px;left:379px;white-space:nowrap" class="ft1728"><a href="http://os.inf.tu-dresden.de/fiasco/">.</a></p>
<p style="position:absolute;top:424px;left:157px;white-space:nowrap" class="ft1728">[71]&#160;M.&#160;Laureano,&#160;C.&#160;Maziero,&#160;and&#160;E.&#160;Jamhour.&#160;Intrusion&#160;Detection&#160;in&#160;Virtual&#160;Ma-</p>
<p style="position:absolute;top:442px;left:190px;white-space:nowrap" class="ft17214">chine&#160;Environments.&#160;In&#160;<i>EUROMICRO&#160;’04:&#160;Proceedings&#160;of&#160;the&#160;30th&#160;EUROMI-<br/>CRO&#160;Conference&#160;(EUROMICRO’04)</i>,&#160;pages&#160;520–525,&#160;Washington,&#160;DC,&#160;USA,<br/>2004.&#160;IEEE&#160;Computer&#160;Society.</p>
<p style="position:absolute;top:507px;left:157px;white-space:nowrap" class="ft1728">[72]&#160;P.&#160;Leach,&#160;M.&#160;Mealling,&#160;and&#160;R.&#160;Salz.&#160;A&#160;Universally&#160;Unique&#160;IDentifier&#160;(UUID)</p>
<p style="position:absolute;top:525px;left:190px;white-space:nowrap" class="ft1728">URN&#160;Namespace.&#160;Internet&#160;Engineering&#160;Task&#160;Force&#160;RFC&#160;4122,&#160;July&#160;2005.</p>
<p style="position:absolute;top:554px;left:157px;white-space:nowrap" class="ft1728">[73]&#160;M.&#160;Leech,&#160;M.&#160;Ganis,&#160;Y.&#160;Lee,&#160;R.&#160;Kuris,&#160;D.&#160;Koblas,&#160;and&#160;L.&#160;Jones.&#160;SOCKS&#160;Protocol</p>
<p style="position:absolute;top:572px;left:190px;white-space:nowrap" class="ft1728">Version&#160;5.&#160;Internet&#160;Engineering&#160;Task&#160;Force:</p>
<p style="position:absolute;top:572px;left:468px;white-space:nowrap" class="ft17234"><a href="http://tools.ietf.org/html/rfc1928">http://tools.ietf.org/</a></p>
<p style="position:absolute;top:590px;left:190px;white-space:nowrap" class="ft17234"><a href="http://tools.ietf.org/html/rfc1928">html/rfc1928</a></p>
<p style="position:absolute;top:590px;left:297px;white-space:nowrap" class="ft1728"><a href="http://tools.ietf.org/html/rfc1928">,&#160;</a>Mar.&#160;1996.&#160;Network&#160;Working&#160;Group.</p>
<p style="position:absolute;top:619px;left:157px;white-space:nowrap" class="ft1728">[74]&#160;J.&#160;Liedtke.&#160;On</p>
<p style="position:absolute;top:618px;left:282px;white-space:nowrap" class="ft17246">µ</p>
<p style="position:absolute;top:619px;left:291px;white-space:nowrap" class="ft1728">-kernel&#160;construction.&#160;In&#160;<i>Proceedings&#160;of&#160;the&#160;15th&#160;ACM&#160;Sympo-</i></p>
<p style="position:absolute;top:636px;left:190px;white-space:nowrap" class="ft17214"><i>sium&#160;on&#160;Operating&#160;System&#160;Principles&#160;(SOSP)</i>,&#160;pages&#160;237–250,&#160;Copper&#160;Mountain<br/>Resort,&#160;CO,&#160;December&#160;1995.</p>
<p style="position:absolute;top:683px;left:157px;white-space:nowrap" class="ft1728">[75]&#160;L.&#160;Litty.</p>
<p style="position:absolute;top:683px;left:255px;white-space:nowrap" class="ft17220"><i>Hypervisor-Based&#160;Intrusion&#160;Detection</i>.</p>
<p style="position:absolute;top:683px;left:506px;white-space:nowrap" class="ft1728">PhD&#160;thesis,&#160;University&#160;of</p>
<p style="position:absolute;top:701px;left:190px;white-space:nowrap" class="ft1728">Toronto,&#160;2005.</p>
<p style="position:absolute;top:730px;left:157px;white-space:nowrap" class="ft1728">[76]&#160;E.&#160;Lupu&#160;and&#160;M.&#160;Sloman.&#160;Conflicts&#160;in&#160;policy-based&#160;distributed&#160;system&#160;manage-</p>
<p style="position:absolute;top:748px;left:190px;white-space:nowrap" class="ft1728">ment.&#160;<i>IEEE&#160;Transaction&#160;on&#160;Software&#160;Engineering</i>,&#160;25(6):852–869,&#160;Nov.&#160;1999.</p>
<p style="position:absolute;top:777px;left:157px;white-space:nowrap" class="ft1728">[77]&#160;R.&#160;MacDonald,&#160;S.&#160;Smith,&#160;J.&#160;Marchesini,&#160;and&#160;O.&#160;Wild.&#160;Bear:&#160;An&#160;open-source</p>
<p style="position:absolute;top:795px;left:190px;white-space:nowrap" class="ft17215">virtual&#160;secure&#160;coprocessor&#160;based&#160;on&#160;TCPA.&#160;Technical&#160;Report&#160;TR2003-471,&#160;De-<br/>partment&#160;of&#160;Computer&#160;Science,&#160;Dartmouth&#160;College,&#160;Hanover,&#160;NH,&#160;USA,&#160;2003.</p>
<p style="position:absolute;top:842px;left:157px;white-space:nowrap" class="ft1728">[78]&#160;J.&#160;Marchesini,&#160;S.&#160;W.&#160;Smith,&#160;O.&#160;Wild,&#160;and&#160;R.&#160;MacDonald.&#160;Experimenting&#160;with</p>
<p style="position:absolute;top:860px;left:190px;white-space:nowrap" class="ft17214">TCPA/TCG&#160;hardware,&#160;or:&#160;How&#160;I&#160;learned&#160;to&#160;stop&#160;worrying&#160;and&#160;love&#160;the&#160;bear.<br/>Technical&#160;Report&#160;TR2003-476,&#160;Department&#160;of&#160;Computer&#160;Science,&#160;Dartmouth<br/>College,&#160;2003.</p>
<p style="position:absolute;top:925px;left:157px;white-space:nowrap" class="ft1728">[79]&#160;J.&#160;Marchesini,&#160;S.&#160;W.&#160;Smith,&#160;O.&#160;Wild,&#160;J.&#160;Stabiner,&#160;and&#160;A.&#160;Barsamian.&#160;Open-source</p>
<p style="position:absolute;top:943px;left:190px;white-space:nowrap" class="ft17214">applications&#160;of&#160;TCPA&#160;hardware.&#160;In&#160;<i>20th&#160;Annual&#160;Computer&#160;Security&#160;Applications<br/>Conference</i>,&#160;pages&#160;294–303,&#160;Washington,&#160;DC,&#160;USA,&#160;Dec.&#160;2004.&#160;ACM,&#160;IEEE<br/>Computer&#160;Society.</p>
<p style="position:absolute;top:1007px;left:157px;white-space:nowrap" class="ft1728">[80]&#160;A.&#160;Marx.&#160;Outbreak&#160;response&#160;times:&#160;Putting&#160;AV&#160;to&#160;the&#160;test.</p>
<p style="position:absolute;top:1008px;left:567px;white-space:nowrap" class="ft17234"><a href="http://www.avtest.org">http://www.</a></p>
<p style="position:absolute;top:1026px;left:190px;white-space:nowrap" class="ft17234"><a href="http://www.avtest.org">avtest.org</a></p>
<p style="position:absolute;top:1025px;left:279px;white-space:nowrap" class="ft1728"><a href="http://www.avtest.org">,&#160;</a>2004.</p>
<p style="position:absolute;top:1054px;left:157px;white-space:nowrap" class="ft1728">[81]&#160;C.&#160;Mundie,&#160;P.&#160;de&#160;Vries,&#160;P.&#160;Haynes,&#160;and&#160;M.&#160;Corwine.&#160;Trustworthy&#160;computing.</p>
<p style="position:absolute;top:1072px;left:190px;white-space:nowrap" class="ft1728">White&#160;paper,&#160;Microsoft&#160;Corporation,&#160;October&#160;2002.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft17221">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 173 -->
<a name="173"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page173-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5173.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1738">BIBLIOGRAPHY</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1738">171</p>
<p style="position:absolute;top:194px;left:233px;white-space:nowrap" class="ft1738">[82]&#160;S.&#160;Munetoh.</p>
<p style="position:absolute;top:194px;left:363px;white-space:nowrap" class="ft1738">Practical&#160;integrity&#160;measurement&#160;and&#160;remote&#160;verification&#160;for</p>
<p style="position:absolute;top:212px;left:266px;white-space:nowrap" class="ft17340">linux&#160;platform.&#160;In&#160;<i>The&#160;Second&#160;Workshop&#160;on&#160;Advances&#160;in&#160;Trusted&#160;Computing<br/>(WATC&#160;’06)</i>,&#160;2006.&#160;See</p>
<p style="position:absolute;top:230px;left:410px;white-space:nowrap" class="ft17334"><a href="http://www.trl.ibm.com/projects/watc/20061130d-WATC-Munetoh-Paper.pdf">http://www.trl.ibm.com/projects/watc/</a></p>
<p style="position:absolute;top:248px;left:266px;white-space:nowrap" class="ft17334"><a href="http://www.trl.ibm.com/projects/watc/20061130d-WATC-Munetoh-Paper.pdf">20061130d-WATC-Munetoh-Paper.pdf</a></p>
<p style="position:absolute;top:247px;left:555px;white-space:nowrap" class="ft1738"><a href="http://www.trl.ibm.com/projects/watc/20061130d-WATC-Munetoh-Paper.pdf">.</a></p>
<p style="position:absolute;top:277px;left:233px;white-space:nowrap" class="ft1738">[83]&#160;D.&#160;G.&#160;Murray,&#160;G.&#160;Milos,&#160;and&#160;S.&#160;Hand.&#160;Improving&#160;Xen&#160;security&#160;through&#160;disag-</p>
<p style="position:absolute;top:295px;left:266px;white-space:nowrap" class="ft17340">gregation.&#160;In&#160;<i>Proceedings&#160;of&#160;the&#160;ACM&#160;conference&#160;on&#160;Virtual&#160;Execution&#160;Environ-<br/>ments</i>,&#160;March&#160;2008.</p>
<p style="position:absolute;top:343px;left:233px;white-space:nowrap" class="ft1738">[84]&#160;Ned&#160;M.&#160;Smith.</p>
<p style="position:absolute;top:343px;left:377px;white-space:nowrap" class="ft1738">System&#160;and&#160;method&#160;for&#160;combining&#160;user&#160;and&#160;platform&#160;au-</p>
<p style="position:absolute;top:361px;left:266px;white-space:nowrap" class="ft1738">thentication&#160;in&#160;negotiated&#160;channel&#160;security&#160;protocols.</p>
<p style="position:absolute;top:361px;left:614px;white-space:nowrap" class="ft1738">United&#160;States&#160;Patent</p>
<p style="position:absolute;top:379px;left:266px;white-space:nowrap" class="ft1738">Application&#160;20050216736:</p>
<p style="position:absolute;top:380px;left:446px;white-space:nowrap" class="ft17334"><a href="http://www.freepatentsonline.com/20050216736.html">http://www.freepatentsonline.com/</a></p>
<p style="position:absolute;top:398px;left:266px;white-space:nowrap" class="ft17334"><a href="http://www.freepatentsonline.com/20050216736.html">20050216736.html</a></p>
<p style="position:absolute;top:397px;left:409px;white-space:nowrap" class="ft1738"><a href="http://www.freepatentsonline.com/20050216736.html">,&#160;</a>Sept.&#160;2005.</p>
<p style="position:absolute;top:427px;left:233px;white-space:nowrap" class="ft1738">[85]&#160;J.&#160;Nick&#160;L.&#160;Petroni,&#160;T.&#160;Fraser,&#160;J.&#160;Molina,&#160;and&#160;W.&#160;A.&#160;Arbaugh.</p>
<p style="position:absolute;top:427px;left:668px;white-space:nowrap" class="ft1738">Copilot&#160;-&#160;A</p>
<p style="position:absolute;top:445px;left:266px;white-space:nowrap" class="ft17315">Coprocessor-based&#160;Kernel&#160;Runtime&#160;Integrity&#160;Monitor.&#160;In&#160;<i>SSYM’04:&#160;Proceed-<br/>ings&#160;of&#160;the&#160;13th&#160;conference&#160;on&#160;USENIX&#160;Security&#160;Symposium</i>,&#160;pages&#160;13–13,<br/>Berkeley,&#160;CA,&#160;USA,&#160;2004.&#160;USENIX&#160;Association.</p>
<p style="position:absolute;top:510px;left:233px;white-space:nowrap" class="ft1738">[86]&#160;Open&#160;Trusted&#160;Computing&#160;(OpenTC)&#160;Project.&#160;The&#160;OpenTC&#160;Project&#160;Homepage,</p>
<p style="position:absolute;top:528px;left:266px;white-space:nowrap" class="ft1738">2008.</p>
<p style="position:absolute;top:529px;left:305px;white-space:nowrap" class="ft17334"><a href="http://www.opentc.net/">http://www.opentc.net/</a></p>
<p style="position:absolute;top:528px;left:502px;white-space:nowrap" class="ft1738"><a href="http://www.opentc.net/">.</a></p>
<p style="position:absolute;top:558px;left:233px;white-space:nowrap" class="ft1738">[87]&#160;OpenSSL&#160;Project.&#160;The&#160;OpenSSL&#160;Project&#160;Homepage,&#160;2007.</p>
<p style="position:absolute;top:559px;left:643px;white-space:nowrap" class="ft17334"><a href="http://www.openssl.org/">http://www.</a></p>
<p style="position:absolute;top:577px;left:266px;white-space:nowrap" class="ft17334"><a href="http://www.openssl.org/">openssl.org/</a></p>
<p style="position:absolute;top:576px;left:374px;white-space:nowrap" class="ft1738"><a href="http://www.openssl.org/">.</a></p>
<p style="position:absolute;top:606px;left:233px;white-space:nowrap" class="ft1738">[88]&#160;OpenTC&#160;Workpackage&#160;05.&#160;Design&#160;of&#160;the&#160;cross-domain&#160;security&#160;services.&#160;Deliv-</p>
<p style="position:absolute;top:624px;left:266px;white-space:nowrap" class="ft1738">erable&#160;D05.4,&#160;The&#160;OpenTC&#160;Project</p>
<p style="position:absolute;top:625px;left:479px;white-space:nowrap" class="ft17334"><a href="http://www.opentc.net">www.opentc.net</a></p>
<p style="position:absolute;top:624px;left:604px;white-space:nowrap" class="ft1738"><a href="http://www.opentc.net">,&#160;</a>05/26/2008.</p>
<p style="position:absolute;top:654px;left:233px;white-space:nowrap" class="ft1738">[89]&#160;A.&#160;Oprea,&#160;M.&#160;K.&#160;Reiter,&#160;and&#160;K.&#160;Yang.&#160;Space-efficient&#160;block&#160;storage&#160;integrity.</p>
<p style="position:absolute;top:672px;left:266px;white-space:nowrap" class="ft17340">In&#160;<i>Proceedings&#160;of&#160;the&#160;Symposium&#160;on&#160;Network&#160;and&#160;Distributed&#160;Systems&#160;Security<br/>(NDSS&#160;2005)</i>,&#160;San&#160;Diego,&#160;CA,&#160;Feb.&#160;2005.&#160;Internet&#160;Society.</p>
<p style="position:absolute;top:720px;left:233px;white-space:nowrap" class="ft1738">[90]&#160;J.&#160;Poritz,&#160;M.&#160;Schunter,&#160;E.&#160;Van&#160;Herreweghen,&#160;and&#160;M.&#160;Waidner.</p>
<p style="position:absolute;top:720px;left:690px;white-space:nowrap" class="ft1738">Property</p>
<p style="position:absolute;top:737px;left:266px;white-space:nowrap" class="ft17314">attestation—scalable&#160;and&#160;privacy-friendly&#160;security&#160;assessment&#160;of&#160;peer&#160;comput-<br/>ers.&#160;Technical&#160;Report&#160;RZ&#160;3548,&#160;IBM&#160;Research,&#160;May&#160;2004.</p>
<p style="position:absolute;top:785px;left:233px;white-space:nowrap" class="ft1738">[91]&#160;D.&#160;P.&#160;R.&#160;Yavatkar&#160;and&#160;R.&#160;Guerin.&#160;A&#160;framework&#160;for&#160;policy-based&#160;admission&#160;con-</p>
<p style="position:absolute;top:803px;left:266px;white-space:nowrap" class="ft1738">trol.&#160;RFC&#160;2753,&#160;January&#160;2000.</p>
<p style="position:absolute;top:833px;left:233px;white-space:nowrap" class="ft1738">[92]&#160;H.&#160;P.&#160;Reiser,&#160;F.&#160;J.&#160;Hauck,&#160;R.&#160;Kapitza,&#160;and&#160;W.&#160;Schröder-Preikschat.&#160;Hypervisor-</p>
<p style="position:absolute;top:851px;left:266px;white-space:nowrap" class="ft17340">Based&#160;Redundant&#160;Execution&#160;on&#160;a&#160;Single&#160;Physical&#160;Host.&#160;In&#160;<i>Proc.&#160;6th&#160;European<br/>Dependable&#160;Computing&#160;Conference&#160;(EDCC-2006)</i>,&#160;page&#160;S.2,&#160;Oct.&#160;2006.</p>
<p style="position:absolute;top:899px;left:233px;white-space:nowrap" class="ft1738">[93]&#160;H.&#160;P.&#160;Reiser&#160;and&#160;R.&#160;Kapitza.&#160;Hypervisor-Based&#160;Efficient&#160;Proactive&#160;Recovery.&#160;In</p>
<p style="position:absolute;top:917px;left:266px;white-space:nowrap" class="ft17356"><i>SRDS&#160;’07:&#160;Proc.&#160;26th&#160;IEEE&#160;International&#160;Symposium&#160;on&#160;Reliable&#160;Distributed<br/>Systems</i>,&#160;pages&#160;83–92.&#160;IEEE&#160;Computer&#160;Society,&#160;Washington,&#160;DC,&#160;USA,&#160;2007.</p>
<p style="position:absolute;top:965px;left:233px;white-space:nowrap" class="ft1738">[94]&#160;R.&#160;Ross.&#160;CoWNFS.&#160;http://www.russross.com/CoWNFS.html,&#160;2008.</p>
<p style="position:absolute;top:995px;left:233px;white-space:nowrap" class="ft1738">[95]&#160;S.&#160;Blake-Wilson&#160;et&#160;al.&#160;Transport&#160;Layer&#160;Security&#160;(TLS)&#160;Extensions.&#160;Internet</p>
<p style="position:absolute;top:1013px;left:266px;white-space:nowrap" class="ft1738">Engineering&#160;Task&#160;Force:</p>
<p style="position:absolute;top:1013px;left:424px;white-space:nowrap" class="ft17334"><a href="http://www.ietf.org/rfc/rfc4366.txt">http://www.ietf.org/rfc/rfc4366.txt</a></p>
<p style="position:absolute;top:1013px;left:738px;white-space:nowrap" class="ft1738"><a href="http://www.ietf.org/rfc/rfc4366.txt">,</a></p>
<p style="position:absolute;top:1031px;left:266px;white-space:nowrap" class="ft1738">Apr.&#160;2006.&#160;Network&#160;Working&#160;Group&#160;RFC&#160;4366.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft17321">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 174 -->
<a name="174"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page174-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5174.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1748">172</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft17421">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:157px;white-space:nowrap" class="ft1748">[96]&#160;A.-R.&#160;Sadeghi&#160;and&#160;C.&#160;Stüble.&#160;Property-based&#160;Attestation&#160;for&#160;Computing&#160;Plat-</p>
<p style="position:absolute;top:212px;left:190px;white-space:nowrap" class="ft17415">forms:&#160;Caring&#160;about&#160;Properties,&#160;not&#160;Mechanisms.&#160;In&#160;<i>Proc.&#160;2004&#160;Workshop<br/>on&#160;New&#160;Security&#160;Paradigms&#160;(NSPW-2004)</i>,&#160;pages&#160;67–77,&#160;New&#160;York,&#160;NY,&#160;USA,<br/>2005.&#160;ACM&#160;Press.</p>
<p style="position:absolute;top:277px;left:157px;white-space:nowrap" class="ft1748">[97]&#160;A.-R.&#160;Sadeghi,&#160;C.&#160;Stüble,&#160;and&#160;N.&#160;Pohlmann.&#160;European&#160;multilateral&#160;secure&#160;com-</p>
<p style="position:absolute;top:295px;left:190px;white-space:nowrap" class="ft17415">puting&#160;base&#160;–&#160;open&#160;trusted&#160;computing&#160;for&#160;you&#160;and&#160;me.&#160;<i>Datenschutz&#160;und&#160;Daten-<br/>sicherheit&#160;DuD</i>,&#160;28(9):548–554,&#160;2004.&#160;Verlag&#160;Friedrich&#160;Vierweg&#160;&amp;&#160;Sohn,&#160;Wies-<br/>baden.</p>
<p style="position:absolute;top:361px;left:157px;white-space:nowrap" class="ft1748">[98]&#160;A.-R.&#160;Sadeghi,&#160;C.&#160;Stüble,&#160;M.&#160;Wolf,&#160;N.&#160;Asokan,&#160;and&#160;J.-E.&#160;Ekberg.&#160;Enabling&#160;Fairer</p>
<p style="position:absolute;top:379px;left:190px;white-space:nowrap" class="ft17415">Digital&#160;Rights&#160;Management&#160;with&#160;Trusted&#160;Computing,&#160;2007.&#160;To&#160;be&#160;presented&#160;at<br/>ISC07,&#160;Information&#160;Security&#160;Conference&#160;2007.</p>
<p style="position:absolute;top:427px;left:157px;white-space:nowrap" class="ft1748">[99]&#160;D.&#160;Safford.</p>
<p style="position:absolute;top:427px;left:275px;white-space:nowrap" class="ft1748">Clarifying&#160;misinformation&#160;on&#160;TCPA.</p>
<p style="position:absolute;top:427px;left:521px;white-space:nowrap" class="ft1748">White&#160;paper,&#160;IBM&#160;Re-</p>
<p style="position:absolute;top:445px;left:190px;white-space:nowrap" class="ft1748">search,&#160;October&#160;2002.&#160;Available&#160;at</p>
<p style="position:absolute;top:445px;left:414px;white-space:nowrap" class="ft17434"><a href="http://www.research.ibm.com/gsal/tcpa/tcpa_rebuttal.pdf">http://www.research.ibm.com/</a></p>
<p style="position:absolute;top:463px;left:190px;white-space:nowrap" class="ft17434"><a href="http://www.research.ibm.com/gsal/tcpa/tcpa_rebuttal.pdf">gsal/tcpa/tcpa_rebuttal.pdf</a></p>
<p style="position:absolute;top:463px;left:432px;white-space:nowrap" class="ft1748"><a href="http://www.research.ibm.com/gsal/tcpa/tcpa_rebuttal.pdf">.&#160;</a>See&#160;also&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[100]&#160;</a>and</p>
<p style="position:absolute;top:463px;left:567px;white-space:nowrap" class="ft17434"><a href="http://www.research.ibm.com/gsal/tcpa/">http://www.</a></p>
<p style="position:absolute;top:481px;left:190px;white-space:nowrap" class="ft17434"><a href="http://www.research.ibm.com/gsal/tcpa/">research.ibm.com/gsal/tcpa/</a></p>
<p style="position:absolute;top:480px;left:432px;white-space:nowrap" class="ft1748"><a href="http://www.research.ibm.com/gsal/tcpa/">.</a></p>
<p style="position:absolute;top:510px;left:150px;white-space:nowrap" class="ft1748">[100]&#160;D.&#160;Safford.</p>
<p style="position:absolute;top:510px;left:277px;white-space:nowrap" class="ft1748">The&#160;need&#160;for&#160;TCPA.</p>
<p style="position:absolute;top:510px;left:426px;white-space:nowrap" class="ft1748">White&#160;paper,&#160;IBM&#160;Research,&#160;October</p>
<p style="position:absolute;top:528px;left:190px;white-space:nowrap" class="ft1748">2002.</p>
<p style="position:absolute;top:528px;left:242px;white-space:nowrap" class="ft1748">Available&#160;at</p>
<p style="position:absolute;top:529px;left:325px;white-space:nowrap" class="ft17434"><a href="http://www.research.ibm.com/gsal/tcpa/why_tcpa.pdf">http://www.research.ibm.com/gsal/tcpa/</a></p>
<p style="position:absolute;top:547px;left:190px;white-space:nowrap" class="ft17434"><a href="http://www.research.ibm.com/gsal/tcpa/why_tcpa.pdf">why_tcpa.pdf</a></p>
<p style="position:absolute;top:546px;left:297px;white-space:nowrap" class="ft1748"><a href="http://www.research.ibm.com/gsal/tcpa/why_tcpa.pdf">.&#160;</a>See&#160;also&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#174">[99]&#160;</a>and</p>
<p style="position:absolute;top:547px;left:414px;white-space:nowrap" class="ft17434"><a href="http://www.research.ibm.com/gsal/tcpa/">http://www.research.ibm.com/</a></p>
<p style="position:absolute;top:565px;left:190px;white-space:nowrap" class="ft17434"><a href="http://www.research.ibm.com/gsal/tcpa/">gsal/tcpa/</a></p>
<p style="position:absolute;top:564px;left:279px;white-space:nowrap" class="ft1748"><a href="http://www.research.ibm.com/gsal/tcpa/">.</a></p>
<p style="position:absolute;top:594px;left:150px;white-space:nowrap" class="ft1748">[101]&#160;R.&#160;Sailer,&#160;T.&#160;Jaeger,&#160;E.&#160;Valdez,&#160;R.&#160;Caceres,&#160;R.&#160;Perez,&#160;S.&#160;Berger,&#160;J.&#160;L.&#160;Griffin,</p>
<p style="position:absolute;top:612px;left:190px;white-space:nowrap" class="ft17456">and&#160;L.&#160;van&#160;Doorn.&#160;Building&#160;a&#160;MAC-Based&#160;Security&#160;Architecture&#160;for&#160;the&#160;Xen<br/>Open-Source&#160;Hypervisor.&#160;In&#160;<i>Proc.&#160;21st&#160;Annual&#160;Computer&#160;Security&#160;Applications<br/>Conference&#160;(ACSAC-2005)</i>,&#160;pages&#160;276–285,&#160;2005.</p>
<p style="position:absolute;top:678px;left:150px;white-space:nowrap" class="ft1748">[102]&#160;R.&#160;Sailer,&#160;E.&#160;Valdez,&#160;T.&#160;Jaeger,&#160;R.&#160;Perez,&#160;L.&#160;van&#160;Doorn,&#160;J.&#160;L.&#160;Griffin,&#160;and</p>
<p style="position:absolute;top:696px;left:190px;white-space:nowrap" class="ft17414">S.&#160;Berger.&#160;sHype:&#160;Secure&#160;hypervisor&#160;approach&#160;to&#160;trusted&#160;virtualized&#160;systems.<br/>Techn.&#160;Rep.&#160;RC23511,&#160;Feb.&#160;2005.&#160;IBM&#160;Research&#160;Division.</p>
<p style="position:absolute;top:744px;left:150px;white-space:nowrap" class="ft1748">[103]&#160;R.&#160;Sailer,&#160;X.&#160;Zhang,&#160;T.&#160;Jaeger,&#160;and&#160;L.&#160;van&#160;Doorn.&#160;Design&#160;and&#160;implementation</p>
<p style="position:absolute;top:761px;left:190px;white-space:nowrap" class="ft17415">of&#160;a&#160;TCG-based&#160;integrity&#160;measurement&#160;architecture.&#160;In&#160;<i>SSYM’04:&#160;Proceedings<br/>of&#160;the&#160;13th&#160;conference&#160;on&#160;USENIX&#160;Security&#160;Symposium</i>,&#160;pages&#160;16–16,&#160;Berkeley,<br/>CA,&#160;USA,&#160;2004.&#160;USENIX&#160;Association.</p>
<p style="position:absolute;top:827px;left:150px;white-space:nowrap" class="ft1748">[104]&#160;R.&#160;Sailer,&#160;X.&#160;Zhang,&#160;T.&#160;Jaeger,&#160;and&#160;L.&#160;van&#160;Doorn.&#160;Design&#160;and&#160;implementation&#160;of</p>
<p style="position:absolute;top:845px;left:190px;white-space:nowrap" class="ft17414">a&#160;TCG-based&#160;integrity&#160;measurement&#160;architecture.&#160;Technical&#160;Report&#160;RC23064,<br/>IBM&#160;Research&#160;Division,&#160;Jan.&#160;2004.</p>
<p style="position:absolute;top:893px;left:150px;white-space:nowrap" class="ft1748">[105]&#160;S.&#160;Santesson.&#160;TLS&#160;Handshake&#160;Message&#160;for&#160;Supplemental&#160;Data.&#160;IETF&#160;RFC</p>
<p style="position:absolute;top:911px;left:190px;white-space:nowrap" class="ft1748">4680,&#160;Sept.&#160;2006.</p>
<p style="position:absolute;top:912px;left:300px;white-space:nowrap" class="ft17434"><a href="http://tools.ietf.org/html/rfc4680">http://tools.ietf.org/html/rfc4680</a></p>
<p style="position:absolute;top:911px;left:605px;white-space:nowrap" class="ft1748"><a href="http://tools.ietf.org/html/rfc4680">.</a></p>
<p style="position:absolute;top:941px;left:150px;white-space:nowrap" class="ft1748">[106]&#160;squid&#160;cache.org.&#160;Squid:&#160;Optimising&#160;Web&#160;Delivery.&#160;SQUID&#160;website:</p>
<p style="position:absolute;top:942px;left:603px;white-space:nowrap" class="ft17434"><a href="http://www.squid-cache.org/">http://</a></p>
<p style="position:absolute;top:960px;left:190px;white-space:nowrap" class="ft17434"><a href="http://www.squid-cache.org/">www.squid-cache.org/</a></p>
<p style="position:absolute;top:959px;left:370px;white-space:nowrap" class="ft1748"><a href="http://www.squid-cache.org/">,&#160;</a>May&#160;2008.</p>
<p style="position:absolute;top:989px;left:150px;white-space:nowrap" class="ft1748">[107]&#160;stealth.&#160;Adore-ng&#160;v0.42.&#160;http://packetstormsecurity.org/,&#160;2001.</p>
<p style="position:absolute;top:1018px;left:150px;white-space:nowrap" class="ft1748">[108]&#160;F.&#160;Stumpf,&#160;O.&#160;Tafreschi,&#160;P.&#160;Röder,&#160;and&#160;C.&#160;Eckert.&#160;A&#160;robust&#160;Integrity&#160;Reporting</p>
<p style="position:absolute;top:1036px;left:190px;white-space:nowrap" class="ft17456">Protocol&#160;for&#160;Remote&#160;Attestation.&#160;In&#160;<i>Proceedings&#160;of&#160;the&#160;Second&#160;Workshop&#160;on<br/>Advances&#160;in&#160;Trusted&#160;Computing&#160;(WATC&#160;’06&#160;Fall),&#160;Tokyo</i>,&#160;Dec.&#160;2006.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft17421">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 175 -->
<a name="175"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page175-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5175.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1758">BIBLIOGRAPHY</p>
<p style="position:absolute;top:141px;left:719px;white-space:nowrap" class="ft1758">173</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft1758">[109]&#160;J.&#160;Sugerman,&#160;G.&#160;Venkitachalam,&#160;and&#160;B.-H.&#160;Lim.&#160;Virtualizing&#160;I/O&#160;devices&#160;on</p>
<p style="position:absolute;top:212px;left:266px;white-space:nowrap" class="ft1758">VMware&#160;workstation’s&#160;hosted&#160;virtual&#160;machine&#160;monitor.</p>
<p style="position:absolute;top:212px;left:629px;white-space:nowrap" class="ft1758">In&#160;<i>Proceedings&#160;of</i></p>
<p style="position:absolute;top:230px;left:266px;white-space:nowrap" class="ft17515"><i>the&#160;General&#160;Track:&#160;2002&#160;USENIX&#160;Annual&#160;Technical&#160;Conference</i>,&#160;pages&#160;1–14,<br/>Berkeley,&#160;CA,&#160;USA,&#160;2001.&#160;USENIX&#160;Association.</p>
<p style="position:absolute;top:277px;left:226px;white-space:nowrap" class="ft1758">[110]&#160;TCG&#160;Infrastructure&#160;Working&#160;Group&#160;(IWG).</p>
<p style="position:absolute;top:277px;left:573px;white-space:nowrap" class="ft1758">TCG&#160;Infrastructure&#160;Work-</p>
<p style="position:absolute;top:295px;left:266px;white-space:nowrap" class="ft1758">group&#160;Subject&#160;Key&#160;Attestation&#160;Evidence&#160;Extension.</p>
<p style="position:absolute;top:295px;left:633px;white-space:nowrap" class="ft1758">Trusted&#160;Comput-</p>
<p style="position:absolute;top:313px;left:266px;white-space:nowrap" class="ft1758">ing&#160;Group:</p>
<p style="position:absolute;top:314px;left:347px;white-space:nowrap" class="ft17534"><a href="https://www.trustedcomputinggroup.org/specs/IWG/IWG_SKAE_Extension_1-00.pdf">https://www.trustedcomputinggroup.org/specs/</a></p>
<p style="position:absolute;top:332px;left:266px;white-space:nowrap" class="ft17534"><a href="https://www.trustedcomputinggroup.org/specs/IWG/IWG_SKAE_Extension_1-00.pdf">IWG/IWG_SKAE_Extension_1-00.pdf</a></p>
<p style="position:absolute;top:331px;left:545px;white-space:nowrap" class="ft1758"><a href="https://www.trustedcomputinggroup.org/specs/IWG/IWG_SKAE_Extension_1-00.pdf">,&#160;</a>June&#160;2005.&#160;Specification&#160;Ver-</p>
<p style="position:absolute;top:349px;left:266px;white-space:nowrap" class="ft1758">sion&#160;1.0&#160;Revision&#160;7.</p>
<p style="position:absolute;top:379px;left:226px;white-space:nowrap" class="ft1758">[111]&#160;TCG&#160;Infrastructure&#160;Working&#160;Group&#160;(IWG).</p>
<p style="position:absolute;top:379px;left:562px;white-space:nowrap" class="ft1758">TCG&#160;Infrastructure&#160;Working</p>
<p style="position:absolute;top:397px;left:266px;white-space:nowrap" class="ft17514">Group&#160;Reference&#160;Architecture&#160;for&#160;Interoperability&#160;(Part&#160;I).&#160;Trusted&#160;Comput-<br/>ing&#160;Group:</p>
<p style="position:absolute;top:416px;left:347px;white-space:nowrap" class="ft17534"><a href="https://www.trustedcomputinggroup.org/specs/IWG/IWG_Architecture_v1_0_r1.pdf">https://www.trustedcomputinggroup.org/specs/</a></p>
<p style="position:absolute;top:434px;left:266px;white-space:nowrap" class="ft17534"><a href="https://www.trustedcomputinggroup.org/specs/IWG/IWG_Architecture_v1_0_r1.pdf">IWG/IWG_Architecture_v1_0_r1.pdf</a></p>
<p style="position:absolute;top:433px;left:553px;white-space:nowrap" class="ft1758"><a href="https://www.trustedcomputinggroup.org/specs/IWG/IWG_Architecture_v1_0_r1.pdf">,&#160;</a>June&#160;2005.&#160;Specification&#160;Ver-</p>
<p style="position:absolute;top:451px;left:266px;white-space:nowrap" class="ft1758">sion&#160;1.0&#160;Revision&#160;1.</p>
<p style="position:absolute;top:480px;left:226px;white-space:nowrap" class="ft1758">[112]&#160;U.&#160;S.&#160;C.&#160;S.&#160;R.&#160;Team.&#160;Technical&#160;Cyber&#160;Security&#160;Alert&#160;TA08-137A.&#160;United&#160;States</p>
<p style="position:absolute;top:498px;left:266px;white-space:nowrap" class="ft1758">Computer&#160;Security&#160;Readiness&#160;Team:</p>
<p style="position:absolute;top:499px;left:499px;white-space:nowrap" class="ft17534"><a href="http://www.us-cert.gov/cas/techalerts/TA08-137A.html">http://www.us-cert.gov/cas/</a></p>
<p style="position:absolute;top:517px;left:266px;white-space:nowrap" class="ft17534"><a href="http://www.us-cert.gov/cas/techalerts/TA08-137A.html">techalerts/TA08-137A.html</a></p>
<p style="position:absolute;top:516px;left:491px;white-space:nowrap" class="ft1758"><a href="http://www.us-cert.gov/cas/techalerts/TA08-137A.html">,&#160;</a>June&#160;2008.</p>
<p style="position:absolute;top:546px;left:226px;white-space:nowrap" class="ft1758">[113]&#160;Trusted&#160;Computing&#160;Group&#160;(TCG).</p>
<p style="position:absolute;top:565px;left:266px;white-space:nowrap" class="ft17534"><a href="http://www.trustedcomputinggroup.org">www.trustedcomputinggroup.org</a></p>
<p style="position:absolute;top:564px;left:526px;white-space:nowrap" class="ft1758"><a href="http://www.trustedcomputinggroup.org">.</a></p>
<p style="position:absolute;top:594px;left:226px;white-space:nowrap" class="ft1758">[114]&#160;Trusted&#160;Computing&#160;Group&#160;(TCG).&#160;TCG&#160;Specification&#160;Architecture&#160;Overview.</p>
<p style="position:absolute;top:612px;left:266px;white-space:nowrap" class="ft1758">Trusted&#160;Computing&#160;Group:</p>
<p style="position:absolute;top:613px;left:437px;white-space:nowrap" class="ft17534"><a href="https://www.trustedcomputinggroup.org/groups/TCG_1_3_Architecture_Overview.pdf">https://www.trustedcomputinggroup.</a></p>
<p style="position:absolute;top:631px;left:266px;white-space:nowrap" class="ft17534"><a href="https://www.trustedcomputinggroup.org/groups/TCG_1_3_Architecture_Overview.pdf">org/groups/TCG_1_3_Architecture_Overview.pdf</a></p>
<p style="position:absolute;top:630px;left:660px;white-space:nowrap" class="ft1758"><a href="https://www.trustedcomputinggroup.org/groups/TCG_1_3_Architecture_Overview.pdf">,&#160;</a>Mar.&#160;2003.</p>
<p style="position:absolute;top:648px;left:266px;white-space:nowrap" class="ft1758">Specification&#160;Revision&#160;1.3&#160;28th&#160;March&#160;2007.</p>
<p style="position:absolute;top:678px;left:226px;white-space:nowrap" class="ft1758">[115]&#160;Trusted&#160;Computing&#160;Group&#160;(TCG).&#160;TPM&#160;version&#160;1.2&#160;specification&#160;changes,&#160;Oct.</p>
<p style="position:absolute;top:696px;left:266px;white-space:nowrap" class="ft1758">2003.&#160;Available&#160;from</p>
<p style="position:absolute;top:697px;left:398px;white-space:nowrap" class="ft17534"><a href="https://www.trustedcomputinggroup.org">https://www.trustedcomputinggroup.org</a></p>
<p style="position:absolute;top:696px;left:730px;white-space:nowrap" class="ft1758"><a href="https://www.trustedcomputinggroup.org">.</a></p>
<p style="position:absolute;top:726px;left:226px;white-space:nowrap" class="ft1758">[116]&#160;Trusted&#160;Computing&#160;Group&#160;(TCG).</p>
<p style="position:absolute;top:726px;left:519px;white-space:nowrap" class="ft1758">TCG&#160;software&#160;stack&#160;specification.</p>
<p style="position:absolute;top:744px;left:266px;white-space:nowrap" class="ft17534"><a href="https://www.trustedcomputinggroup.org/specs/TSS/">https://www.trustedcomputinggroup.org/specs/TSS/</a></p>
<p style="position:absolute;top:744px;left:696px;white-space:nowrap" class="ft1758"><a href="https://www.trustedcomputinggroup.org/specs/TSS/">,&#160;</a>Aug.</p>
<p style="position:absolute;top:761px;left:266px;white-space:nowrap" class="ft1758">2006.&#160;TSS&#160;Version&#160;1.2.</p>
<p style="position:absolute;top:791px;left:226px;white-space:nowrap" class="ft1758">[117]&#160;Trusted&#160;Computing&#160;Group&#160;(TCG).</p>
<p style="position:absolute;top:791px;left:517px;white-space:nowrap" class="ft1758">TCG&#160;software&#160;stack&#160;(TSS)&#160;speci-</p>
<p style="position:absolute;top:809px;left:266px;white-space:nowrap" class="ft1758">fication&#160;version&#160;1.2.</p>
<p style="position:absolute;top:809px;left:434px;white-space:nowrap" class="ft1758">Trusted&#160;Computing&#160;Group:</p>
<p style="position:absolute;top:810px;left:634px;white-space:nowrap" class="ft17534"><a href="https://www.trustedcomputinggroup.org/specs/TSS/TSS_Version_1.2_Level_1_FINAL.pdf">https://www.</a></p>
<p style="position:absolute;top:828px;left:266px;white-space:nowrap" class="ft17534"><a href="https://www.trustedcomputinggroup.org/specs/TSS/TSS_Version_1.2_Level_1_FINAL.pdf">trustedcomputinggroup.org/specs/TSS/TSS_Version_1.</a></p>
<p style="position:absolute;top:846px;left:266px;white-space:nowrap" class="ft17534"><a href="https://www.trustedcomputinggroup.org/specs/TSS/TSS_Version_1.2_Level_1_FINAL.pdf">2_Level_1_FINAL.pdf</a></p>
<p style="position:absolute;top:845px;left:436px;white-space:nowrap" class="ft1758"><a href="https://www.trustedcomputinggroup.org/specs/TSS/TSS_Version_1.2_Level_1_FINAL.pdf">,&#160;</a>Jan.&#160;2006.</p>
<p style="position:absolute;top:845px;left:529px;white-space:nowrap" class="ft1758">Specification&#160;Version&#160;1.2&#160;Level&#160;1</p>
<p style="position:absolute;top:863px;left:266px;white-space:nowrap" class="ft1758">Final.</p>
<p style="position:absolute;top:893px;left:226px;white-space:nowrap" class="ft1758">[118]&#160;Trusted&#160;Computing&#160;Group&#160;(TCG).&#160;TCG&#160;TPM&#160;Main&#160;Part&#160;2&#160;TPM&#160;Structures.</p>
<p style="position:absolute;top:911px;left:266px;white-space:nowrap" class="ft1758">Trusted&#160;Computing&#160;Group:</p>
<p style="position:absolute;top:912px;left:437px;white-space:nowrap" class="ft17534"><a href="https://www.trustedcomputinggroup.org/specs/TPM/Main_Part2_Rev94.zip">https://www.trustedcomputinggroup.</a></p>
<p style="position:absolute;top:930px;left:266px;white-space:nowrap" class="ft17534"><a href="https://www.trustedcomputinggroup.org/specs/TPM/Main_Part2_Rev94.zip">org/specs/TPM/Main_Part2_Rev94.zip</a></p>
<p style="position:absolute;top:929px;left:571px;white-space:nowrap" class="ft1758"><a href="https://www.trustedcomputinggroup.org/specs/TPM/Main_Part2_Rev94.zip">,&#160;</a>Mar.&#160;2006.</p>
<p style="position:absolute;top:929px;left:664px;white-space:nowrap" class="ft1758">Specification</p>
<p style="position:absolute;top:947px;left:266px;white-space:nowrap" class="ft1758">Version&#160;1.2&#160;Level&#160;2&#160;Revision&#160;94.</p>
<p style="position:absolute;top:977px;left:226px;white-space:nowrap" class="ft1758">[119]&#160;Trusted&#160;Computing&#160;Group&#160;(TCG).</p>
<p style="position:absolute;top:977px;left:505px;white-space:nowrap" class="ft1758">TCG&#160;TPM&#160;Main&#160;Part&#160;3&#160;Commands.</p>
<p style="position:absolute;top:995px;left:266px;white-space:nowrap" class="ft1758">Trusted&#160;Computing&#160;Group:</p>
<p style="position:absolute;top:995px;left:437px;white-space:nowrap" class="ft17534"><a href="https://www.trustedcomputinggroup.org/specs/TPM/mainP3Commandsrev103.zip">https://www.trustedcomputinggroup.</a></p>
<p style="position:absolute;top:1013px;left:266px;white-space:nowrap" class="ft17534"><a href="https://www.trustedcomputinggroup.org/specs/TPM/mainP3Commandsrev103.zip">org/specs/TPM/mainP3Commandsrev103.zip</a></p>
<p style="position:absolute;top:1013px;left:607px;white-space:nowrap" class="ft1758"><a href="https://www.trustedcomputinggroup.org/specs/TPM/mainP3Commandsrev103.zip">,&#160;</a>July&#160;2007.&#160;Specifica-</p>
<p style="position:absolute;top:1031px;left:266px;white-space:nowrap" class="ft1758">tion&#160;Version&#160;1.2&#160;Level&#160;2&#160;Revision&#160;103.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft17521">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 176 -->
<a name="176"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page176-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5176.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1768">174</p>
<p style="position:absolute;top:141px;left:282px;white-space:nowrap" class="ft17621">OpenTC&#160;D05.6&#160;–&#160;Final&#160;Report&#160;of&#160;OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft1768">[120]&#160;Trusted&#160;Computing&#160;Group&#160;(TCG).</p>
<p style="position:absolute;top:194px;left:418px;white-space:nowrap" class="ft1768">TCG&#160;TPM&#160;specification&#160;version&#160;1.2&#160;re-</p>
<p style="position:absolute;top:212px;left:190px;white-space:nowrap" class="ft1768">vision&#160;103.</p>
<p style="position:absolute;top:212px;left:271px;white-space:nowrap" class="ft17634"><a href="https://www.trustedcomputinggroup.org/specs/TPM/">https://www.trustedcomputinggroup.org/specs/</a></p>
<p style="position:absolute;top:230px;left:190px;white-space:nowrap" class="ft17634"><a href="https://www.trustedcomputinggroup.org/specs/TPM/">TPM/</a></p>
<p style="position:absolute;top:230px;left:226px;white-space:nowrap" class="ft1768"><a href="https://www.trustedcomputinggroup.org/specs/TPM/">,&#160;</a>July&#160;2007.&#160;See&#160;also&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[122]&#160;</a>and</p>
<p style="position:absolute;top:230px;left:414px;white-space:nowrap" class="ft17634"><a href="http://www.trustedcomputing.org/">http://www.trustedcomputing.</a></p>
<p style="position:absolute;top:248px;left:190px;white-space:nowrap" class="ft17634"><a href="http://www.trustedcomputing.org/">org/</a></p>
<p style="position:absolute;top:247px;left:226px;white-space:nowrap" class="ft1768"><a href="http://www.trustedcomputing.org/">.</a></p>
<p style="position:absolute;top:277px;left:150px;white-space:nowrap" class="ft1768">[121]&#160;Trusted&#160;Computing&#160;Group&#160;(TCG).</p>
<p style="position:absolute;top:277px;left:456px;white-space:nowrap" class="ft1768">About&#160;us.</p>
<p style="position:absolute;top:278px;left:558px;white-space:nowrap" class="ft17634"><a href="https://www.trustedcomputinggroup.org/about/">https://www.</a></p>
<p style="position:absolute;top:296px;left:190px;white-space:nowrap" class="ft17634"><a href="https://www.trustedcomputinggroup.org/about/">trustedcomputinggroup.org/about/</a></p>
<p style="position:absolute;top:295px;left:477px;white-space:nowrap" class="ft1768"><a href="https://www.trustedcomputinggroup.org/about/">,&#160;</a>May&#160;2008.</p>
<p style="position:absolute;top:325px;left:150px;white-space:nowrap" class="ft1768">[122]&#160;Trusted&#160;Computing&#160;Platform&#160;Alliance&#160;(TCPA).</p>
<p style="position:absolute;top:325px;left:500px;white-space:nowrap" class="ft1768">Main&#160;specification&#160;version</p>
<p style="position:absolute;top:343px;left:190px;white-space:nowrap" class="ft1768">1.1b.</p>
<p style="position:absolute;top:344px;left:231px;white-space:nowrap" class="ft17634"><a href="https://www.trustedcomputinggroup.org/specs/TPM/">https://www.trustedcomputinggroup.org/specs/TPM/</a></p>
<p style="position:absolute;top:343px;left:662px;white-space:nowrap" class="ft1768"><a href="https://www.trustedcomputinggroup.org/specs/TPM/">,</a></p>
<p style="position:absolute;top:361px;left:190px;white-space:nowrap" class="ft1768">February&#160;2002.&#160;See&#160;also&#160;<a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#176">[120]&#160;</a>and</p>
<p style="position:absolute;top:362px;left:414px;white-space:nowrap" class="ft17634"><a href="http://www.trustedcomputing.org/">http://www.trustedcomputing.</a></p>
<p style="position:absolute;top:380px;left:190px;white-space:nowrap" class="ft17634"><a href="http://www.trustedcomputing.org/">org/</a></p>
<p style="position:absolute;top:379px;left:226px;white-space:nowrap" class="ft1768"><a href="http://www.trustedcomputing.org/">.</a></p>
<p style="position:absolute;top:409px;left:150px;white-space:nowrap" class="ft1768">[123]&#160;Trusted&#160;Network&#160;Connect&#160;Work&#160;Group.&#160;TCG&#160;Trusted&#160;Network&#160;Connect&#160;TNC</p>
<p style="position:absolute;top:427px;left:190px;white-space:nowrap" class="ft1768">Architecture&#160;for&#160;Interoperability.&#160;Trusted&#160;Computing&#160;Group:</p>
<p style="position:absolute;top:427px;left:558px;white-space:nowrap" class="ft17634"><a href="https://www.trustedcomputinggroup.org/specs/TNC/TNC_Architecture_v1_2_r4.pdf">https://www.</a></p>
<p style="position:absolute;top:445px;left:190px;white-space:nowrap" class="ft17634"><a href="https://www.trustedcomputinggroup.org/specs/TNC/TNC_Architecture_v1_2_r4.pdf">trustedcomputinggroup.org/specs/TNC/TNC_Architecture_</a></p>
<p style="position:absolute;top:463px;left:190px;white-space:nowrap" class="ft17634"><a href="https://www.trustedcomputinggroup.org/specs/TNC/TNC_Architecture_v1_2_r4.pdf">v1_2_r4.pdf</a></p>
<p style="position:absolute;top:463px;left:288px;white-space:nowrap" class="ft1768"><a href="https://www.trustedcomputinggroup.org/specs/TNC/TNC_Architecture_v1_2_r4.pdf">,&#160;</a>May&#160;2007.&#160;Specification&#160;Version&#160;1.2&#160;Revision&#160;4.</p>
<p style="position:absolute;top:493px;left:150px;white-space:nowrap" class="ft1768">[124]&#160;VMware.</p>
<p style="position:absolute;top:493px;left:268px;white-space:nowrap" class="ft1768">VMware&#160;Double-Take.</p>
<p style="position:absolute;top:493px;left:432px;white-space:nowrap" class="ft17634"><a href="http://www.vmware.com/pdf/vmware_doubletake.pdf">http://www.vmware.com/pdf/</a></p>
<p style="position:absolute;top:511px;left:190px;white-space:nowrap" class="ft17634"><a href="http://www.vmware.com/pdf/vmware_doubletake.pdf">vmware_doubletake.pdf</a></p>
<p style="position:absolute;top:510px;left:378px;white-space:nowrap" class="ft1768"><a href="http://www.vmware.com/pdf/vmware_doubletake.pdf">.</a></p>
<p style="position:absolute;top:540px;left:150px;white-space:nowrap" class="ft1768">[125]&#160;VMware&#160;In.&#160;VMware&#160;Virtualization&#160;Software,&#160;2008.</p>
<p style="position:absolute;top:541px;left:504px;white-space:nowrap" class="ft17634"><a href="http://www.vmware.com/">http://www.vmware.</a></p>
<p style="position:absolute;top:559px;left:190px;white-space:nowrap" class="ft17634"><a href="http://www.vmware.com/">com/</a></p>
<p style="position:absolute;top:558px;left:226px;white-space:nowrap" class="ft1768"><a href="http://www.vmware.com/">.</a></p>
<p style="position:absolute;top:588px;left:150px;white-space:nowrap" class="ft1768">[126]&#160;Washington&#160;Post.</p>
<p style="position:absolute;top:588px;left:341px;white-space:nowrap" class="ft1768">A</p>
<p style="position:absolute;top:588px;left:365px;white-space:nowrap" class="ft1768">Time</p>
<p style="position:absolute;top:588px;left:410px;white-space:nowrap" class="ft1768">to</p>
<p style="position:absolute;top:588px;left:435px;white-space:nowrap" class="ft1768">Patch,</p>
<p style="position:absolute;top:588px;left:487px;white-space:nowrap" class="ft1768">2006.</p>
<p style="position:absolute;top:589px;left:558px;white-space:nowrap" class="ft17634"><a href="http://blog.washingtonpost.com/securityfix/2006/01/a_time_to_patch.html">http://blog.</a></p>
<p style="position:absolute;top:607px;left:190px;white-space:nowrap" class="ft17634"><a href="http://blog.washingtonpost.com/securityfix/2006/01/a_time_to_patch.html">washingtonpost.com/securityfix/2006/01/a_time_to_</a></p>
<p style="position:absolute;top:625px;left:190px;white-space:nowrap" class="ft17634"><a href="http://blog.washingtonpost.com/securityfix/2006/01/a_time_to_patch.html">patch.html</a></p>
<p style="position:absolute;top:624px;left:279px;white-space:nowrap" class="ft1768"><a href="http://blog.washingtonpost.com/securityfix/2006/01/a_time_to_patch.html">.</a></p>
<p style="position:absolute;top:654px;left:150px;white-space:nowrap" class="ft1768">[127]&#160;A.&#160;Westerinen.&#160;Terminology&#160;for&#160;policy-based&#160;management.&#160;RFC&#160;3198,&#160;Novem-</p>
<p style="position:absolute;top:672px;left:190px;white-space:nowrap" class="ft1768">ber&#160;2001.</p>
<p style="position:absolute;top:702px;left:150px;white-space:nowrap" class="ft1768">[128]&#160;Xen&#160;Community.&#160;The&#160;Xen&#160;Hypervisor&#160;Open&#160;Source&#160;Project&#160;Homepage,&#160;2007.</p>
<p style="position:absolute;top:720px;left:190px;white-space:nowrap" class="ft17634"><a href="http://www.xen.org/">http://www.xen.org/</a></p>
<p style="position:absolute;top:720px;left:360px;white-space:nowrap" class="ft1768"><a href="http://www.xen.org/">.</a></p>
<p style="position:absolute;top:750px;left:150px;white-space:nowrap" class="ft1768">[129]&#160;XKMS&#160;key&#160;management&#160;standard&#160;2.0.</p>
<p style="position:absolute;top:750px;left:420px;white-space:nowrap" class="ft17634"><a href="http://www.w3.org/TR/xkms2/">http://www.w3.org/TR/xkms2/</a></p>
<p style="position:absolute;top:750px;left:662px;white-space:nowrap" class="ft1768"><a href="http://www.w3.org/TR/xkms2/">,</a></p>
<p style="position:absolute;top:767px;left:190px;white-space:nowrap" class="ft1768">June&#160;2005.</p>
<p style="position:absolute;top:797px;left:150px;white-space:nowrap" class="ft1768">[130]&#160;XML</p>
<p style="position:absolute;top:797px;left:241px;white-space:nowrap" class="ft1768">digital</p>
<p style="position:absolute;top:797px;left:298px;white-space:nowrap" class="ft1768">signature</p>
<p style="position:absolute;top:797px;left:371px;white-space:nowrap" class="ft1768">standard.</p>
<p style="position:absolute;top:798px;left:477px;white-space:nowrap" class="ft17634"><a href="http://www.w3.org/TR/xmldsig-core/">http://www.w3.org/TR/</a></p>
<p style="position:absolute;top:816px;left:190px;white-space:nowrap" class="ft17634"><a href="http://www.w3.org/TR/xmldsig-core/">xmldsig-core/</a></p>
<p style="position:absolute;top:815px;left:307px;white-space:nowrap" class="ft1768"><a href="http://www.w3.org/TR/xmldsig-core/">.</a></p>
<p style="position:absolute;top:845px;left:150px;white-space:nowrap" class="ft1768">[131]&#160;XML&#160;encryption&#160;standard.</p>
<p style="position:absolute;top:846px;left:354px;white-space:nowrap" class="ft17634"><a href="http://www.w3.org/TR/xmlenc-core/">http://www.w3.org/TR/xmlenc-core/</a></p>
<p style="position:absolute;top:845px;left:651px;white-space:nowrap" class="ft1768"><a href="http://www.w3.org/TR/xmlenc-core/">.</a></p>
<p style="position:absolute;top:875px;left:150px;white-space:nowrap" class="ft1768">[132]&#160;X.&#160;Zhang,&#160;L.&#160;van&#160;Doorn,&#160;T.&#160;Jaeger,&#160;R.&#160;Perez,&#160;and&#160;R.&#160;Sailer.&#160;Secure&#160;coprocessor-</p>
<p style="position:absolute;top:893px;left:190px;white-space:nowrap" class="ft17614">based&#160;intrusion&#160;detection.&#160;In&#160;<i>EW10:&#160;Proceedings&#160;of&#160;the&#160;10th&#160;workshop&#160;on<br/>ACM&#160;SIGOPS&#160;European&#160;workshop</i>,&#160;pages&#160;239–242,&#160;New&#160;York,&#160;NY,&#160;USA,&#160;2002.<br/>ACM.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft17621">OpenTC&#160;Document&#160;D05.6/V01&#160;–&#160;Final&#160;R7628/2009/01/15/OpenTC&#160;Public&#160;(PU)</p>
</div>
<hr/>
<a name="outline"></a><h1>Document Outline</h1>
<ul>
<li>otcD05-6-v01-WP5-FinalReport.pdf
<ul>
<li>otcD05-6-v01-WP5-FinalReport.pdf
<ul>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#9">Introduction and Outline</a>
<ul>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#9">Introduction</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#10">Our Contribution</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#10">Outline of this Report</a></li>
</ul>
</li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#13">I Overview and Related Work</a>
<ul>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#14">Dependability of Virtual Systems</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#17">Security Policies for Virtual Data Centers</a>
<ul>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#17">High-level Policy Model</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#18">Security Objectives and Policy Enforcement Points</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#20">Example Policy Refinements for Protected Resources</a></li>
</ul>
</li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#24">Unified Policy Enforcement for Virtual Data Centers</a>
<ul>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#24">TVD Infrastructure</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#25">Virtual Networking Infrastructure</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#27">Virtual Storage Infrastructure</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#28">TVD Admission Control</a></li>
</ul>
</li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#31">Background and Related Work</a>
<ul>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#31">Overview of Trusted Virtual Domains</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#32">Trusted Computing – The TCG Approach</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#33">Trusted Channels</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#33">Secure Network Virtualization</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#35">II Building Blocks of the OpenTC Security Architecture</a>
<ul>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#36">Policy Enforcement and Compliance</a>
<ul>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#36">Introduction</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#37">Formal Integrity Model for Virtual Machines</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#40">The PEV Integrity Architecture</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#43">Realization using Xen and Linux</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#45">Use Cases</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#51">Conclusion</a></li>
</ul>
</li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#53">Hierarchical Integrity Management</a>
<ul>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#53">Introduction</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#54">Design Overview</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#56">Basic Integrity Management</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#60">Hierarchical Integrity Management</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#65">Policy Verification for Security Services</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#66">Implementation in Xen</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#70">Conclusions</a></li>
</ul>
</li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#71">Secure Virtualized Networking</a>
<ul>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#71">Introduction</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#72">Design Overview</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#76">Networking Infrastructure</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#83">TVD Infrastructure</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#89">Auto-deployment of Trusted Virtual Domains</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#94">Implementation in Xen</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#97">Discussion</a></li>
</ul>
</li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#98">Public Key Infrastructure</a>
<ul>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#98">Introduction</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#99">Basic Trusted Computing PKI</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#102">Trusted Platform Agent</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#104">XKMS mapping</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#112">Open Issues</a></li>
</ul>
</li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#114">Trusted Channels using OpenSSL</a>
<ul>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#114">Motivation</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#116">Requirement Analysis</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#117">Basic Definitions</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#118">Adapted TLS Handshake</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#121">Detailed Description of Attestation Data Structures</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#124">Generic System Architecture</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#126">A Trusted Channel Implementation with OpenSSL</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#129">Security Considerations</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#130">Functional Considerations</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#131">Summary</a></li>
</ul>
</li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#132">Towards Dependability and Attack Resistance</a>
<ul>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#132">Introduction to Dependable Virtualization</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#133">Using Virtualization for Dependability and Security</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#136">Xen-based Implementation of Intrusion Detection and Protection</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#145">Quantifying the Impact of Virtualization on Node Reliability</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#149">An Architecture for a More Reliable Xen VMM</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#153">III Evaluation and Outlook</a>
<ul>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#154">Security Management Demonstrator</a>
<ul>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#154">Overview</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#155">Security Services</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#157">TVD Master, Proxies and Proxy Factories</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#157">Secure Virtual Network subsystem</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#158">Trusted Channel Proxies</a></li>
</ul>
</li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#159">Evaluation of the Prototype</a>
<ul>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#159">Performance Evaluation</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#161">Limitations of our Prototype</a></li>
</ul>
</li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#163">Conclusion and Outlook</a>
<ul>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#163">Lessons Learned</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#164">The Future of Secure Virtualization and Trusted Computing</a></li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#166">Conclusions</a></li>
</ul>
</li>
<li><a href="OpenTC_D05.6-Final-Report-of-OpenTC-Workpackage-5.html#166">Bibliography</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</body>
</html>
