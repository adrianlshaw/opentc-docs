<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>Porting Security Services to a Mobile Platform to Support a Trusted Mobile Application</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="generator" content="pdftohtml 0.36"/>
<meta name="author" content="Angelika Holzweber"/>
<meta name="keywords" content="Mobile Trusted Computing"/>
<meta name="date" content="2008-10-07T11:17:29+00:00"/>
<meta name="subject" content="Mobile Trusted Computing"/>
<style type="text/css">
<!--
.xflip {
    -moz-transform: scaleX(-1);
    -webkit-transform: scaleX(-1);
    -o-transform: scaleX(-1);
    transform: scaleX(-1);
    filter: fliph;
}
.yflip {
    -moz-transform: scaleY(-1);
    -webkit-transform: scaleY(-1);
    -o-transform: scaleY(-1);
    transform: scaleY(-1);
    filter: flipv;
}
.xyflip {
    -moz-transform: scaleX(-1) scaleY(-1);
    -webkit-transform: scaleX(-1) scaleY(-1);
    -o-transform: scaleX(-1) scaleY(-1);
    transform: scaleX(-1) scaleY(-1);
    filter: fliph + flipv;
}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<!-- Page 1 -->
<a name="1"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft10{font-size:13px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
	.ft11{font-size:19px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
	.ft12{font-size:21px;font-family:CAAAAA+DejaVuSans;color:#000000;}
	.ft13{font-size:15px;font-family:DAAAAA+DejaVuSerif;color:#000000;}
	.ft14{font-size:15px;font-family:EAAAAA+DejaVuSerif;color:#000000;}
	.ft15{font-size:9px;font-family:EAAAAA+DejaVuSerif;color:#000000;}
	.ft16{font-size:15px;font-family:CAAAAA+DejaVuSans;color:#000000;}
	.ft17{font-size:15px;font-family:FAAAAA+DejaVuSans;color:#000000;}
	.ft18{font-size:9px;font-family:FAAAAA+DejaVuSans;color:#000000;}
	.ft19{font-size:14px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
	.ft110{font-size:15px;line-height:17px;font-family:EAAAAA+DejaVuSerif;color:#000000;}
	.ft111{font-size:15px;line-height:17px;font-family:CAAAAA+DejaVuSans;color:#000000;}
-->
</style>
<div id="page1-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application001.png" alt="background image"/>
<p style="position:absolute;top:144px;left:132px;white-space:nowrap" class="ft10">&#160;</p>
<p style="position:absolute;top:83px;left:132px;white-space:nowrap" class="ft11">&#160;</p>
<p style="position:absolute;top:200px;left:185px;white-space:nowrap" class="ft12"><b>D08.2:&#160;Porting&#160;Security&#160;Services&#160;to&#160;a&#160;Mobile</b></p>
<p style="position:absolute;top:224px;left:154px;white-space:nowrap" class="ft12"><b>Platform&#160;to&#160;Support&#160;a&#160;Trusted&#160;Mobile&#160;Application</b></p>
<p style="position:absolute;top:271px;left:141px;white-space:nowrap" class="ft13"><b>Project&#160;number</b></p>
<p style="position:absolute;top:271px;left:411px;white-space:nowrap" class="ft14">IST-027635</p>
<p style="position:absolute;top:289px;left:141px;white-space:nowrap" class="ft13"><b>Project&#160;acronym</b></p>
<p style="position:absolute;top:289px;left:411px;white-space:nowrap" class="ft14">Open_TC</p>
<p style="position:absolute;top:306px;left:141px;white-space:nowrap" class="ft13"><b>Project&#160;title</b></p>
<p style="position:absolute;top:306px;left:411px;white-space:nowrap" class="ft14">Open&#160;Trusted&#160;Computing</p>
<p style="position:absolute;top:324px;left:141px;white-space:nowrap" class="ft13"><b>Deliverable&#160;type</b></p>
<p style="position:absolute;top:324px;left:411px;white-space:nowrap" class="ft14">Report</p>
<p style="position:absolute;top:359px;left:141px;white-space:nowrap" class="ft13"><b>Deliverable&#160;reference&#160;number</b></p>
<p style="position:absolute;top:359px;left:412px;white-space:nowrap" class="ft14">IST-027635/D08.2/Final</p>
<p style="position:absolute;top:394px;left:141px;white-space:nowrap" class="ft13"><b>Deliverable&#160;title</b></p>
<p style="position:absolute;top:377px;left:412px;white-space:nowrap" class="ft110">“Porting&#160;Security&#160;Services&#160;to&#160;a&#160;Mobile&#160;<br/>Platform&#160;to&#160;Support&#160;a&#160;Trusted&#160;Mobile&#160;</p>
<p style="position:absolute;top:412px;left:412px;white-space:nowrap" class="ft14">Application”</p>
<p style="position:absolute;top:429px;left:141px;white-space:nowrap" class="ft13"><b>WP&#160;contributing&#160;to&#160;the&#160;</b></p>
<p style="position:absolute;top:447px;left:141px;white-space:nowrap" class="ft13"><b>deliverable</b></p>
<p style="position:absolute;top:438px;left:412px;white-space:nowrap" class="ft14">WP8</p>
<p style="position:absolute;top:464px;left:141px;white-space:nowrap" class="ft13"><b>Due&#160;date</b></p>
<p style="position:absolute;top:464px;left:412px;white-space:nowrap" class="ft14">30</p>
<p style="position:absolute;top:464px;left:431px;white-space:nowrap" class="ft15">th</p>
<p style="position:absolute;top:464px;left:440px;white-space:nowrap" class="ft14">&#160;September&#160;2008&#160;-&#160;M35</p>
<p style="position:absolute;top:482px;left:141px;white-space:nowrap" class="ft13"><b>Actual&#160;submission&#160;date</b></p>
<p style="position:absolute;top:482px;left:412px;white-space:nowrap" class="ft14">7</p>
<p style="position:absolute;top:482px;left:422px;white-space:nowrap" class="ft15">th</p>
<p style="position:absolute;top:482px;left:431px;white-space:nowrap" class="ft14">&#160;October&#160;2008</p>
<p style="position:absolute;top:517px;left:141px;white-space:nowrap" class="ft13"><b>Responsible&#160;Organisation</b></p>
<p style="position:absolute;top:517px;left:411px;white-space:nowrap" class="ft14">RUB</p>
<p style="position:absolute;top:578px;left:141px;white-space:nowrap" class="ft13"><b>Authors</b></p>
<p style="position:absolute;top:535px;left:411px;white-space:nowrap" class="ft14">RUB&#160;&#160;&#160;(Alaa&#160;&#160;&#160;Abdul-Hadi,&#160;&#160;&#160;Andreas&#160;&#160;&#160;Krügersen,&#160;</p>
<p style="position:absolute;top:552px;left:411px;white-space:nowrap" class="ft110">Hans&#160;&#160;&#160;Löhr,&#160;&#160;&#160;Ahmad-Reza&#160;&#160;&#160;Sadeghi,&#160;&#160;&#160;Marcel&#160;<br/>Winandy),</p>
<p style="position:absolute;top:587px;left:411px;white-space:nowrap" class="ft110">COM2&#160;(Eckhard&#160;Delfs),<br/>IFX&#160;(David&#160;Jennings),</p>
<p style="position:absolute;top:622px;left:411px;white-space:nowrap" class="ft14">RHUL&#160;(Eimear&#160;Gallery)</p>
<p style="position:absolute;top:640px;left:141px;white-space:nowrap" class="ft13"><b>Abstract</b></p>
<p style="position:absolute;top:640px;left:411px;white-space:nowrap" class="ft14">This&#160;document&#160;presents&#160;the&#160;“Secure&#160;Wallet”,&#160;</p>
<p style="position:absolute;top:657px;left:411px;white-space:nowrap" class="ft110">a&#160;countermeasure&#160;against&#160;identity&#160;theft&#160;on&#160;the&#160;<br/>Internet.&#160;&#160;&#160;The&#160;&#160;&#160;Secure&#160;&#160;&#160;Wallet&#160;&#160;&#160;supports&#160;</p>
<p style="position:absolute;top:692px;left:411px;white-space:nowrap" class="ft110">automated&#160;secure&#160;logins&#160;on&#160;web-pages,&#160;using&#160;<br/>Trusted&#160;Computing&#160;and&#160;Virtualisation&#160;on&#160;the&#160;</p>
<p style="position:absolute;top:727px;left:411px;white-space:nowrap" class="ft110">client&#160;&#160;&#160;side.&#160;&#160;&#160;We&#160;&#160;&#160;analyse&#160;&#160;&#160;the&#160;&#160;&#160;security&#160;&#160;&#160;of&#160;&#160;&#160;our&#160;<br/>approach&#160;and&#160;discuss&#160;related&#160;work.&#160;Moreover,&#160;</p>
<p style="position:absolute;top:762px;left:411px;white-space:nowrap" class="ft110">a&#160;&#160;&#160;security&#160;&#160;&#160;kernel&#160;&#160;&#160;based&#160;&#160;&#160;architecture&#160;&#160;&#160;to&#160;<br/>support&#160;&#160;&#160;such&#160;&#160;&#160;a&#160;&#160;&#160;wallet&#160;&#160;&#160;is&#160;&#160;&#160;sketched,&#160;&#160;&#160;together&#160;</p>
<p style="position:absolute;top:797px;left:411px;white-space:nowrap" class="ft110">with&#160;&#160;&#160;an&#160;&#160;&#160;architecture&#160;&#160;&#160;for&#160;&#160;&#160;a&#160;&#160;&#160;prototype,&#160;&#160;&#160;where&#160;<br/>some&#160;part&#160;of&#160;the&#160;implementation&#160;is&#160;running&#160;on&#160;</p>
<p style="position:absolute;top:832px;left:411px;white-space:nowrap" class="ft110">a&#160;PC,&#160;and&#160;the&#160;other&#160;part&#160;on&#160;a&#160;mobile&#160;platform&#160;<br/>(Infineon's&#160;&#160;&#160;X-GOLD</p>
<p style="position:absolute;top:849px;left:564px;white-space:nowrap" class="ft15">TM&#160;&#160;</p>
<p style="position:absolute;top:849px;left:587px;white-space:nowrap" class="ft14">208&#160;&#160;&#160;platform).&#160;&#160;&#160;Recent&#160;</p>
<p style="position:absolute;top:867px;left:411px;white-space:nowrap" class="ft110">standardization&#160;&#160;&#160;activities,&#160;&#160;&#160;in&#160;&#160;&#160;particular&#160;&#160;&#160;the&#160;<br/>TCG&#160;&#160;&#160;Mobile&#160;&#160;&#160;Reference&#160;&#160;&#160;Architecture&#160;&#160;&#160;and&#160;</p>
<p style="position:absolute;top:902px;left:411px;white-space:nowrap" class="ft110">OMTP&#160;TR1&#160;specifications,&#160;are&#160;then&#160;examined&#160;<br/>in&#160;light&#160;of&#160;the&#160;Secure&#160;Wallet&#160;use&#160;case.</p>
<p style="position:absolute;top:945px;left:141px;white-space:nowrap" class="ft13"><b>Keywords</b></p>
<p style="position:absolute;top:937px;left:411px;white-space:nowrap" class="ft110">Trusted&#160;&#160;&#160;Computing,&#160;&#160;&#160;Secure&#160;&#160;&#160;Wallet,&#160;&#160;&#160;Identity&#160;<br/>Theft,&#160;Mobile&#160;Trusted&#160;Platform</p>
<p style="position:absolute;top:989px;left:142px;white-space:nowrap" class="ft13"><b>Dissemination&#160;level</b></p>
<p style="position:absolute;top:989px;left:411px;white-space:nowrap" class="ft14">Public</p>
<p style="position:absolute;top:1007px;left:142px;white-space:nowrap" class="ft13"><b>Revision</b></p>
<p style="position:absolute;top:1007px;left:411px;white-space:nowrap" class="ft14">FINAL</p>
<p style="position:absolute;top:1051px;left:140px;white-space:nowrap" class="ft16"><b>Instrument</b></p>
<p style="position:absolute;top:1051px;left:294px;white-space:nowrap" class="ft17">IP</p>
<p style="position:absolute;top:1042px;left:413px;white-space:nowrap" class="ft111"><b>Start&#160;&#160;&#160;date&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;<br/>project</b></p>
<p style="position:absolute;top:1051px;left:602px;white-space:nowrap" class="ft17">1</p>
<p style="position:absolute;top:1051px;left:612px;white-space:nowrap" class="ft18">st</p>
<p style="position:absolute;top:1051px;left:620px;white-space:nowrap" class="ft17">&#160;November&#160;2005</p>
<p style="position:absolute;top:1077px;left:140px;white-space:nowrap" class="ft111"><b>Thematic&#160;<br/>Priority</b></p>
<p style="position:absolute;top:1086px;left:294px;white-space:nowrap" class="ft17">IST</p>
<p style="position:absolute;top:1077px;left:413px;white-space:nowrap" class="ft16"><b>Duration</b></p>
<p style="position:absolute;top:1086px;left:602px;white-space:nowrap" class="ft17">42&#160;months</p>
<p style="position:absolute;top:82px;left:631px;white-space:nowrap" class="ft19">&#160;</p>
</div>
<!-- Page 2 -->
<a name="2"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft212{font-size:9px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
	.ft213{font-size:24px;font-family:CAAAAA+DejaVuSans;color:#000000;}
	.ft214{font-size:17px;font-family:EAAAAA+DejaVuSerif;color:#000000;}
	.ft215{font-size:17px;line-height:19px;font-family:EAAAAA+DejaVuSerif;color:#000000;}
-->
</style>
<div id="page2-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application002.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft212">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft20">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft24">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft24">Final</p>
<p style="position:absolute;top:169px;left:85px;white-space:nowrap" class="ft213"><b>Table&#160;of&#160;contents</b></p>
<p style="position:absolute;top:206px;left:85px;white-space:nowrap" class="ft215">1&#160;&#160;Introduction..................................................................................................................5<br/>2&#160;&#160;The&#160;Secure&#160;Wallet&#160;Use&#160;Case&#160;and&#160;Prototype................................................................7</p>
<p style="position:absolute;top:244px;left:94px;white-space:nowrap" class="ft214">2.1&#160;Overview&#160;of&#160;the&#160;Secure&#160;Wallet.................................................................................7</p>
<p style="position:absolute;top:264px;left:102px;white-space:nowrap" class="ft215">2.1.1&#160;Classical&#160;phishing&#160;...............................................................................................7<br/>2.1.2&#160;Malware&#160;phishing&#160;...............................................................................................9<br/>2.1.3&#160;Countering&#160;phishing&#160;.........................................................................................10</p>
<p style="position:absolute;top:321px;left:94px;white-space:nowrap" class="ft214">2.2&#160;Security&#160;Problem&#160;Definition&#160;..................................................................................11</p>
<p style="position:absolute;top:340px;left:102px;white-space:nowrap" class="ft215">2.2.1&#160;Threats...............................................................................................................11<br/>2.2.2&#160;Assumptions&#160;......................................................................................................12<br/>2.2.3&#160;Objectives...........................................................................................................14<br/>2.2.4&#160;Security&#160;Objective&#160;Rationale&#160;............................................................................15<br/>2.2.5&#160;Requirements&#160;....................................................................................................16</p>
<p style="position:absolute;top:436px;left:94px;white-space:nowrap" class="ft214">2.3&#160;Related&#160;Work&#160;.........................................................................................................18</p>
<p style="position:absolute;top:456px;left:102px;white-space:nowrap" class="ft215">2.3.1&#160;Client-based&#160;Phishing&#160;Countermeasures&#160;.........................................................18<br/>2.3.2&#160;Server-based&#160;Phishing&#160;Countermeasures&#160;........................................................20<br/>2.3.3&#160;Proxy&#160;Components&#160;............................................................................................20</p>
<p style="position:absolute;top:513px;left:94px;white-space:nowrap" class="ft214">2.4&#160;The&#160;General&#160;Secure&#160;Wallet&#160;Architecture&#160;..............................................................21</p>
<p style="position:absolute;top:532px;left:102px;white-space:nowrap" class="ft215">2.4.1&#160;Wallet&#160;Behavior&#160;.................................................................................................21<br/>2.4.2&#160;Design&#160;and&#160;Architecture&#160;...................................................................................24</p>
<p style="position:absolute;top:571px;left:94px;white-space:nowrap" class="ft214">2.5&#160;Security&#160;Analysis&#160;...................................................................................................28</p>
<p style="position:absolute;top:590px;left:102px;white-space:nowrap" class="ft215">2.5.1&#160;Attacks&#160;...............................................................................................................29<br/>2.5.2&#160;Assumptions&#160;......................................................................................................31<br/>2.5.3&#160;Protection&#160;against&#160;Classical&#160;Phishing&#160;Attacks&#160;.................................................31<br/>2.5.4&#160;Protection&#160;against&#160;Online&#160;Malware&#160;Phishing&#160;Attacks&#160;.....................................33<br/>2.5.5&#160;Protection&#160;against&#160;Offline&#160;Attacks&#160;...................................................................37<br/>2.5.6&#160;Attacks&#160;on&#160;the&#160;Passwords&#160;.................................................................................38<br/>2.5.7&#160;Discussion&#160;.........................................................................................................39<br/>2.5.8&#160;Other&#160;Attacks&#160;....................................................................................................40</p>
<p style="position:absolute;top:744px;left:94px;white-space:nowrap" class="ft214">2.6&#160;Architectural&#160;Overview&#160;.........................................................................................40</p>
<p style="position:absolute;top:763px;left:102px;white-space:nowrap" class="ft215">2.6.1&#160;Architecture&#160;on&#160;a&#160;PC..........................................................................................40<br/>2.6.2&#160;&#160;Storage&#160;Manager..............................................................................................41<br/>2.6.3&#160;X-GOLDTM&#160;208-Based&#160;Architecture.................................................................45<br/>2.6.4&#160;Hybrid&#160;Architecture&#160;for&#160;Demo-Prototype.........................................................45</p>
<p style="position:absolute;top:840px;left:94px;white-space:nowrap" class="ft214">2.7&#160;Porting&#160;and&#160;Test&#160;Concepts&#160;of&#160;the&#160;TPM&#160;emulator&#160;on&#160;X-GOLDTM&#160;208..................47</p>
<p style="position:absolute;top:859px;left:102px;white-space:nowrap" class="ft215">2.7.1&#160;Porting&#160;Concepts...............................................................................................48<br/>2.7.2&#160;Implementation&#160;strategy...................................................................................50<br/>2.7.3&#160;Architecture.......................................................................................................54<br/>2.7.4&#160;Test&#160;Architecture...............................................................................................57</p>
<p style="position:absolute;top:936px;left:85px;white-space:nowrap" class="ft214">3&#160;&#160;TCG&#160;Support&#160;for&#160;the&#160;Secure&#160;Wallet&#160;Prototype..........................................................59</p>
<p style="position:absolute;top:955px;left:94px;white-space:nowrap" class="ft214">3.1&#160;Requirements&#160;for&#160;a&#160;Robust&#160;Implementation&#160;of&#160;the&#160;Secure&#160;Wallet.......................59</p>
<p style="position:absolute;top:974px;left:102px;white-space:nowrap" class="ft215">3.1.1&#160;Secure&#160;Wallet&#160;Application&#160;Installation..............................................................59<br/>3.1.2&#160;Secure&#160;Wallet&#160;Protocol&#160;Suite.............................................................................59<br/>3.1.3&#160;Summary&#160;of&#160;Requirements................................................................................63</p>
<p style="position:absolute;top:1032px;left:94px;white-space:nowrap" class="ft215">3.2&#160;Requirements&#160;Analysis...........................................................................................64<br/>3.3&#160;TCG&#160;Mappings........................................................................................................66</p>
<p style="position:absolute;top:1070px;left:102px;white-space:nowrap" class="ft215">3.3.1&#160;Revised&#160;Architectural&#160;Model.............................................................................66<br/>3.3.2&#160;Fundamental&#160;MTM&#160;command&#160;runs...................................................................68<br/>3.3.3&#160;Authenticated&#160;Boot&#160;Process..............................................................................72</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft27">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft27">2/109</p>
</div>
<!-- Page 3 -->
<a name="3"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page3-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application003.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft312">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft30">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft34">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft34">Final</p>
<p style="position:absolute;top:151px;left:102px;white-space:nowrap" class="ft315">3.3.4&#160;Secure&#160;Boot&#160;Process..........................................................................................73<br/>3.3.5&#160;Maintaining&#160;Integrity.........................................................................................78<br/>3.3.6&#160;Secure&#160;Storage..................................................................................................80<br/>3.3.7&#160;Demonstrating&#160;Privilege....................................................................................82<br/>3.3.8&#160;Conclusions........................................................................................................85</p>
<p style="position:absolute;top:247px;left:85px;white-space:nowrap" class="ft314">4&#160;&#160;OMTP&#160;TR1&#160;and&#160;the&#160;Secure&#160;Wallet&#160;Prototype............................................................87</p>
<p style="position:absolute;top:266px;left:94px;white-space:nowrap" class="ft314">4.1&#160;OMTP&#160;TR1&#160;Summary..............................................................................................87</p>
<p style="position:absolute;top:285px;left:102px;white-space:nowrap" class="ft315">4.1.1&#160;Security&#160;Enablers...............................................................................................87<br/>4.1.2&#160;Threat&#160;Model......................................................................................................89<br/>4.1.3&#160;TR1&#160;Core&#160;Requirements....................................................................................91<br/>4.1.4&#160;Asset&#160;Protection.................................................................................................92<br/>4.1.5&#160;Trusted&#160;Execution&#160;Environment.......................................................................92<br/>4.1.6&#160;Use&#160;Case&#160;Overview............................................................................................94</p>
<p style="position:absolute;top:401px;left:94px;white-space:nowrap" class="ft315">4.2&#160;Secure&#160;Wallet&#160;Architecture&#160;in&#160;the&#160;context&#160;of&#160;TR1................................................97<br/>4.3&#160;Proposal&#160;of&#160;the&#160;final&#160;porting&#160;of&#160;the&#160;secure&#160;wallet&#160;to&#160;the&#160;X-GOLD&#160;208.................98<br/>4.4&#160;Platform&#160;Integrity&#160;and&#160;Authenticity.......................................................................98</p>
<p style="position:absolute;top:458px;left:102px;white-space:nowrap" class="ft315">4.4.1&#160;Trusted&#160;Execution&#160;Environments....................................................................100<br/>4.4.2&#160;Secure&#160;Storage................................................................................................100<br/>4.4.3&#160;Secure&#160;User&#160;IO.................................................................................................102<br/>4.4.4&#160;Software&#160;Threats.............................................................................................102</p>
<p style="position:absolute;top:535px;left:94px;white-space:nowrap" class="ft314">4.5&#160;Summary...............................................................................................................103</p>
<p style="position:absolute;top:554px;left:85px;white-space:nowrap" class="ft314">5&#160;&#160;Conclusions..............................................................................................................104</p>
<p style="position:absolute;top:611px;left:85px;white-space:nowrap" class="ft313"><b>Index&#160;of&#160;tables</b></p>
<p style="position:absolute;top:648px;left:85px;white-space:nowrap" class="ft315">Table&#160;1:&#160;Threats&#160;and&#160;the&#160;objectives&#160;addressing&#160;them...................................................15<br/>Table&#160;2:&#160;Secure&#160;wallet&#160;application&#160;installation..............................................................59<br/>Table&#160;3:&#160;Starting&#160;the&#160;secure&#160;wallet................................................................................60<br/>Table&#160;4:&#160;Starting&#160;the&#160;secure&#160;wallet&#160;(alternative)...........................................................60<br/>Table&#160;5:&#160;Selecting&#160;a&#160;passphrase.....................................................................................60<br/>Table&#160;6:&#160;Selecting&#160;a&#160;passphrase.....................................................................................60<br/>Table&#160;7:&#160;Authenticating&#160;a&#160;user.......................................................................................61<br/>Table&#160;8:&#160;Authenticating&#160;a&#160;user&#160;(alternative)..................................................................61<br/>Table&#160;9:&#160;Changing&#160;a&#160;passphrase....................................................................................62<br/>Table&#160;10:&#160;Changing&#160;a&#160;passphrase&#160;(alternative).............................................................62<br/>Table&#160;11:&#160;Storing&#160;sensitive&#160;data.....................................................................................62<br/>Table&#160;12:&#160;Storing&#160;sensitive&#160;data&#160;(alternative)...............................................................62<br/>Table&#160;13:&#160;Accessing&#160;secure&#160;storage&#160;(application).........................................................63<br/>Table&#160;14:&#160;Accessing&#160;secure&#160;storage&#160;(application)(alternative).....................................63<br/>Table&#160;15:&#160;MTM&#160;permanent&#160;flags....................................................................................69<br/>Table&#160;16:&#160;MTM&#160;initialisation...........................................................................................69<br/>Table&#160;17:&#160;MTM&#160;start-up..................................................................................................69<br/>Table&#160;18:&#160;MTM&#160;save&#160;state..............................................................................................69<br/>Table&#160;19:&#160;Self&#160;testing......................................................................................................70<br/>Table&#160;20:&#160;Retrieving&#160;self&#160;test&#160;results.............................................................................70<br/>Table&#160;21:&#160;Creating&#160;an&#160;endorsement&#160;key&#160;pair................................................................70<br/>Table&#160;22:&#160;Accessing&#160;the&#160;public&#160;endorsement&#160;key..........................................................71<br/>Table&#160;23:&#160;Physically&#160;enabling&#160;an&#160;MTM..........................................................................71<br/>Table&#160;24:&#160;Physically&#160;disabling&#160;an&#160;MTM.........................................................................71<br/>Table&#160;25:&#160;Enabling/Disabling&#160;an&#160;MTM...........................................................................71</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft37">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft37">3/109</p>
</div>
<!-- Page 4 -->
<a name="4"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page4-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application004.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft412">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft40">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft44">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft44">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft415">Table&#160;26:&#160;Setting&#160;the&#160;state&#160;of&#160;the&#160;'TPM_PF_OWNERSHIP'&#160;flag....................................72<br/>Table&#160;27:&#160;Taking&#160;ownership&#160;of&#160;an&#160;MTM.........................................................................72<br/>Table&#160;28:&#160;Activating&#160;an&#160;MTM.........................................................................................72<br/>Table&#160;29:&#160;MTM&#160;permanent&#160;flags....................................................................................74<br/>Table&#160;30:&#160;TPM_VERIFICATION_KEY&#160;structure.............................................................75<br/>Table&#160;31:&#160;TPM_RIM_CERTIFICATE&#160;structure................................................................76<br/>Table&#160;32:&#160;RIM&#160;installation...............................................................................................76<br/>Table&#160;33:&#160;RIM_Cert&#160;verification.....................................................................................76<br/>Table&#160;34:&#160;Loading&#160;a&#160;verification&#160;key..............................................................................76<br/>Table&#160;35:&#160;Disabling&#160;the&#160;loading&#160;of&#160;a&#160;root&#160;verification&#160;key.............................................77<br/>Table&#160;36:&#160;Incrementing&#160;a&#160;bootstrap&#160;counter.................................................................77<br/>Table&#160;37:&#160;Setting&#160;verified&#160;PCRs......................................................................................77<br/>Table&#160;38:&#160;Measurement&#160;verification&#160;and&#160;PCR&#160;extension...............................................77<br/>Table&#160;39:&#160;A&#160;transport&#160;session.........................................................................................81<br/>Table&#160;40:&#160;Creating&#160;a&#160;wrap&#160;key........................................................................................82<br/>Table&#160;41:&#160;Loading&#160;a&#160;key..................................................................................................82<br/>Table&#160;42:&#160;Sealing&#160;data&#160;using&#160;a&#160;storage&#160;key...................................................................82<br/>Table&#160;43:&#160;Authorising&#160;an&#160;MTM&#160;owner&#160;read&#160;of&#160;the&#160;public&#160;endorsement&#160;key................84<br/>Table&#160;44:&#160;Authorising&#160;a&#160;load&#160;key&#160;and&#160;an&#160;object&#160;seal.....................................................85<br/>Table&#160;45:&#160;MTM&#160;commands&#160;required&#160;in&#160;an&#160;MLTM&#160;and&#160;an&#160;MRTM&#160;in&#160;order&#160;to&#160;implement&#160;<br/>the&#160;secure&#160;wallet&#160;mechanism.........................................................................................86</p>
<p style="position:absolute;top:572px;left:85px;white-space:nowrap" class="ft413"><b>Index&#160;of&#160;figures</b></p>
<p style="position:absolute;top:609px;left:85px;white-space:nowrap" class="ft415">Figure&#160;1:&#160;Web&#160;Server&#160;Login..............................................................................................9<br/>Figure&#160;2:&#160;Classical&#160;Phishing&#160;Overview...........................................................................10<br/>Figure&#160;3:&#160;Malware&#160;Phishing&#160;Overview...........................................................................11<br/>Figure&#160;4:&#160;The&#160;Secure&#160;Wallet...........................................................................................22<br/>Figure&#160;5:&#160;Password&#160;fields&#160;are&#160;disabled&#160;automatically...................................................23<br/>Figure&#160;6:&#160;Setup&#160;dialog&#160;for&#160;a&#160;web&#160;site.............................................................................24<br/>Figure&#160;7:&#160;The&#160;Conventional&#160;System&#160;Model....................................................................27<br/>Figure&#160;8:&#160;The&#160;Secure&#160;Wallet&#160;System&#160;Model..................................................................27<br/>Figure&#160;9:&#160;Simplified&#160;system&#160;model&#160;for&#160;the&#160;Secure&#160;Wallet&#160;............................................30<br/>Figure&#160;10:&#160;The&#160;Internal&#160;Communication&#160;Channels.......................................................36<br/>Figure&#160;11:&#160;System&#160;architecture&#160;for&#160;PC&#160;hardware.........................................................42<br/>Figure&#160;12:&#160;Implementation&#160;of&#160;the&#160;Storage&#160;Manager.....................................................44<br/>Figure&#160;13:&#160;Architectural&#160;overview&#160;for&#160;a&#160;demo-prototype.&#160;............................................47<br/>Figure&#160;14:&#160;Development&#160;environment&#160;for&#160;TPM&#160;emulator&#160;on&#160;target.............................48<br/>Figure&#160;15:&#160;Basic&#160;target&#160;architecture&#160;for&#160;TPM&#160;emulator&#160;on&#160;L4/X-GOLDTM&#160;208..........49<br/>Figure&#160;16:&#160;Linux&#160;TPM&#160;emulator&#160;architecture................................................................52<br/>Figure&#160;17:&#160;Basic&#160;prototyping&#160;deployment&#160;view.............................................................54<br/>Figure&#160;18:&#160;Component&#160;view&#160;of&#160;target&#160;software&#160;architecture........................................55<br/>Figure&#160;19:&#160;TPM&#160;emulator&#160;procedures&#160;on&#160;L4..................................................................56<br/>Figure&#160;20:&#160;TPM&#160;Proxy&#160;procedures.................................................................................57<br/>Figure&#160;21:&#160;Deployment&#160;view&#160;used&#160;for&#160;target&#160;testing&#160;....................................................58<br/>Figure&#160;22:Message&#160;flow&#160;until&#160;start&#160;of&#160;Trousers&#160;daemon..............................................59<br/>Figure&#160;23:&#160;Example&#160;message&#160;exchange&#160;for&#160;a&#160;simple&#160;use&#160;case&#160;to&#160;read&#160;the&#160;public&#160;EK.&#160;59<br/>Figure&#160;24:&#160;Secure&#160;wallet&#160;architecture...........................................................................68<br/>Figure&#160;25:&#160;A&#160;sample&#160;key&#160;hierarchy&#160;from&#160;a&#160;secure&#160;wallet&#160;provider&#160;engine...................81<br/>Figure&#160;26:&#160;Proposed&#160;architecture&#160;for&#160;final&#160;secure&#160;wallet&#160;prototype&#160;.........................100</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft47">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft47">4/109</p>
</div>
<!-- Page 5 -->
<a name="5"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft516{font-size:17px;font-family:CAAAAA+DejaVuSans;color:#000000;}
	.ft517{font-size:10px;font-family:EAAAAA+DejaVuSerif;color:#000000;}
	.ft518{font-size:17px;line-height:28px;font-family:EAAAAA+DejaVuSerif;color:#000000;}
-->
</style>
<div id="page5-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application005.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft512">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft50">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft54">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft54">Final</p>
<p style="position:absolute;top:170px;left:85px;white-space:nowrap" class="ft53"><b>1&#160;</b></p>
<p style="position:absolute;top:169px;left:117px;white-space:nowrap" class="ft516"><b>Introduction</b></p>
<p style="position:absolute;top:197px;left:85px;white-space:nowrap" class="ft515">Identity&#160;theft&#160;has&#160;become&#160;one&#160;of&#160;the&#160;fastest&#160;growing&#160;crimes&#160;on&#160;the&#160;Internet,&#160;leading&#160;<br/>to&#160;&#160;&#160;huge&#160;&#160;&#160;financial&#160;&#160;&#160;losses&#160;&#160;&#160;and&#160;&#160;&#160;privacy&#160;&#160;&#160;violations&#160;&#160;&#160;[1,2].&#160;&#160;&#160;Various&#160;&#160;&#160;attacks&#160;&#160;&#160;have&#160;&#160;&#160;been&#160;<br/>identified&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;&#160;&#160;past.&#160;&#160;&#160;A&#160;&#160;&#160;prominent&#160;&#160;&#160;class&#160;&#160;&#160;of&#160;&#160;&#160;attacks&#160;&#160;&#160;are&#160;&#160;&#160;those&#160;&#160;&#160;termed&#160;&#160;&#160;as&#160;&#160;illusion&#160;<br/>attacks,&#160;such&#160;as&#160;phishing&#160;and&#160;pharming,&#160;where&#160;the&#160;user&#160;is&#160;lured&#160;to&#160;a&#160;faked&#160;site&#160;and&#160;<br/>asked&#160;to&#160;disclose&#160;her&#160;identity&#160;credential&#160;information.&#160;Essentially,&#160;the&#160;attackers&#160;make&#160;<br/>use&#160;of&#160;the&#160;fact&#160;that&#160;the&#160;average&#160;Internet&#160;user&#160;is&#160;unable&#160;to&#160;distinguish&#160;a&#160;legitimate&#160;site&#160;<br/>from&#160;&#160;&#160;a&#160;&#160;&#160;fake&#160;&#160;&#160;one,&#160;&#160;&#160;and&#160;&#160;&#160;the&#160;&#160;&#160;underlying&#160;&#160;&#160;security&#160;&#160;&#160;mechanisms&#160;&#160;&#160;and&#160;&#160;&#160;indicators&#160;&#160;&#160;do&#160;&#160;&#160;not&#160;<br/>efficiently&#160;and&#160;effectively&#160;support&#160;her&#160;in&#160;making&#160;the&#160;right&#160;decision&#160;[26].&#160;Hence,&#160;the&#160;<br/>first&#160;core&#160;security&#160;objective&#160;is&#160;to&#160;provide&#160;a&#160;strong&#160;password&#160;mechanism&#160;for&#160;the&#160;user&#160;<br/>while&#160;reducing&#160;the&#160;user’s&#160;intervention&#160;with&#160;the&#160;system&#160;as&#160;much&#160;as&#160;possible.&#160;Ideally,&#160;<br/>the&#160;user&#160;should&#160;not&#160;know&#160;the&#160;passwords.&#160;This&#160;requirement&#160;seems&#160;to&#160;be&#160;contradictory,&#160;<br/>however,&#160;relying&#160;on&#160;a&#160;system&#160;that&#160;knows&#160;the&#160;passwords&#160;and&#160;automatically&#160;performs&#160;<br/>the&#160;login&#160;on&#160;behalf&#160;of&#160;the&#160;user,&#160;including&#160;an&#160;automatic&#160;verification&#160;of&#160;the&#160;legitimacy&#160;<br/>of&#160;the&#160;web&#160;site,&#160;prevents&#160;the&#160;mentioned&#160;attacks.<br/>In&#160;&#160;&#160;addition&#160;&#160;&#160;to&#160;&#160;&#160;illusion&#160;&#160;&#160;attacks&#160;&#160;&#160;and&#160;&#160;&#160;the&#160;&#160;&#160;related&#160;&#160;&#160;social&#160;&#160;&#160;engineering&#160;&#160;&#160;attacks,&#160;&#160;&#160;a&#160;&#160;&#160;more&#160;<br/>powerful&#160;class&#160;of&#160;attacks&#160;is&#160;due&#160;to&#160;malware&#160;compromising&#160;and&#160;infiltrating&#160;the&#160;user’s&#160;<br/>computing&#160;&#160;&#160;platform&#160;&#160;&#160;with&#160;&#160;&#160;malicious&#160;&#160;&#160;code.&#160;&#160;&#160;Examples&#160;&#160;&#160;include&#160;&#160;&#160;Trojan&#160;&#160;&#160;horses&#160;&#160;&#160;like&#160;<br/>keylogger<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#5">s</a></p>
<p style="position:absolute;top:533px;left:177px;white-space:nowrap" class="ft517"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#5">1</a></p>
<p style="position:absolute;top:533px;left:183px;white-space:nowrap" class="ft514"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#5">&#160;</a>or&#160;transaction&#160;generator<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#5">s</a></p>
<p style="position:absolute;top:533px;left:404px;white-space:nowrap" class="ft517"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#5">2</a></p>
<p style="position:absolute;top:533px;left:410px;white-space:nowrap" class="ft514"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#5">&#160;</a>[12,3].&#160;Typical&#160;sources&#160;of&#160;malware&#160;are&#160;various&#160;</p>
<p style="position:absolute;top:552px;left:85px;white-space:nowrap" class="ft515">offers&#160;on&#160;supplementary&#160;software&#160;and&#160;plug-ins&#160;that&#160;may&#160;contain&#160;malicious&#160;code.&#160;In&#160;<br/>this&#160;context,&#160;&#160;commodity&#160;&#160;operating&#160;&#160;systems&#160;(OS’s)&#160;&#160;cannot&#160;appropriately&#160;&#160;prevent&#160;or&#160;<br/>even&#160;&#160;&#160;reduce&#160;&#160;&#160;the&#160;&#160;&#160;impact&#160;&#160;&#160;of&#160;&#160;&#160;these&#160;&#160;attacks&#160;&#160;&#160;since&#160;&#160;&#160;they&#160;&#160;&#160;still&#160;&#160;&#160;suffer&#160;&#160;&#160;from&#160;&#160;&#160;various&#160;<br/>conceptual&#160;&#160;&#160;shortcomings:&#160;&#160;&#160;beside&#160;&#160;&#160;architectural&#160;&#160;&#160;security&#160;&#160;&#160;problems&#160;&#160;&#160;and&#160;&#160;&#160;the&#160;&#160;&#160;inherent&#160;<br/>vulnerabilities&#160;&#160;&#160;resulting&#160;&#160;&#160;from&#160;&#160;&#160;high&#160;&#160;&#160;complexity,&#160;&#160;&#160;they&#160;&#160;&#160;require&#160;&#160;&#160;careful&#160;&#160;&#160;system&#160;<br/>administration&#160;skills&#160;which&#160;ordinary&#160;users&#160;typically&#160;do&#160;not&#160;have.&#160;Hence&#160;the&#160;second&#160;<br/>main&#160;security&#160;objective&#160;is&#160;to&#160;have&#160;a&#160;small&#160;Trusted&#160;Computing&#160;Base&#160;(TCB)&#160;that&#160;can&#160;<br/>provide&#160;the&#160;following&#160;security&#160;properties:</p>
<p style="position:absolute;top:723px;left:112px;white-space:nowrap" class="ft514">1.&#160;a&#160;secure&#160;execution&#160;environment&#160;for&#160;handling&#160;users’&#160;authentication&#160;credentials,&#160;</p>
<p style="position:absolute;top:742px;left:139px;white-space:nowrap" class="ft514">ideally&#160;isolated&#160;from&#160;potentially&#160;malicious&#160;programs&#160;(isolation);</p>
<p style="position:absolute;top:777px;left:112px;white-space:nowrap" class="ft514">2.&#160;a&#160;secure&#160;user&#160;interface&#160;to&#160;interact&#160;with&#160;trusted&#160;applications,&#160;which&#160;cannot&#160;be&#160;</p>
<p style="position:absolute;top:796px;left:139px;white-space:nowrap" class="ft514">faked&#160;or&#160;eavesdropped&#160;by&#160;malicious&#160;programs&#160;(trusted&#160;path);&#160;and&#160;</p>
<p style="position:absolute;top:830px;left:112px;white-space:nowrap" class="ft514">3.&#160;a&#160;secure&#160;environment&#160;for&#160;the&#160;credentials&#160;when&#160;the&#160;system&#160;is&#160;offline&#160;(secure&#160;</p>
<p style="position:absolute;top:849px;left:139px;white-space:nowrap" class="ft515">storage).&#160;In&#160;particular,&#160;credentials&#160;are&#160;bound&#160;to&#160;the&#160;TCB&#160;to&#160;prevent&#160;attacks&#160;<br/>where&#160;an&#160;adversary&#160;tries&#160;to&#160;gain&#160;access&#160;to&#160;the&#160;data&#160;by&#160;replacing&#160;software&#160;(e.g.,&#160;<br/>booting&#160;a&#160;different&#160;OS).</p>
<p style="position:absolute;top:933px;left:85px;white-space:nowrap" class="ft515">Both&#160;&#160;&#160;the&#160;&#160;&#160;scientific&#160;&#160;&#160;and&#160;&#160;&#160;industrial&#160;&#160;&#160;community&#160;&#160;&#160;have&#160;&#160;&#160;addressed&#160;&#160;&#160;many&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;known&#160;<br/>attacks&#160;&#160;&#160;on&#160;&#160;&#160;web&#160;&#160;&#160;authentication&#160;&#160;&#160;and&#160;&#160;&#160;proposed&#160;&#160;&#160;promising&#160;&#160;&#160;identity&#160;&#160;&#160;management&#160;<br/>solutions&#160;to&#160;alleviate&#160;the&#160;threat&#160;of&#160;identity&#160;theft.&#160;On&#160;the&#160;one&#160;hand,&#160;delegated&#160;identity&#160;<br/>management&#160;&#160;&#160;systems,&#160;&#160;&#160;where&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;calls&#160;&#160;&#160;a&#160;&#160;&#160;trusted&#160;&#160;&#160;third&#160;&#160;&#160;party&#160;&#160;&#160;in&#160;&#160;&#160;form&#160;&#160;&#160;of&#160;&#160;&#160;a&#160;<br/>distributed&#160;server&#160;for&#160;hosting&#160;and&#160;providing&#160;identity&#160;information,&#160;exist&#160;but&#160;showed&#160;to&#160;<br/>have&#160;deficiencies&#160;[32,34,62,54].&#160;For&#160;example,&#160;as&#160;analysed&#160;in&#160;[32],&#160;authentication&#160;tools&#160;</p>
<p style="position:absolute;top:1069px;left:85px;white-space:nowrap" class="ft510">1Keyloggers&#160;record&#160;all&#160;keystrokes&#160;of&#160;the&#160;user,&#160;especially&#160;during&#160;entering&#160;passwords,&#160;and&#160;<br/>transmit&#160;them&#160;to&#160;a&#160;phisher.&#160;</p>
<p style="position:absolute;top:1104px;left:85px;white-space:nowrap" class="ft510">2Transaction&#160;generators&#160;wait&#160;until&#160;the&#160;user&#160;has&#160;logged&#160;in,&#160;e.g.,&#160;to&#160;her&#160;financial&#160;online&#160;<br/>account,&#160;and&#160;create&#160;fraudulent&#160;transactions&#160;in&#160;the&#160;background.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft57">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft57">5/109</p>
</div>
<!-- Page 6 -->
<a name="6"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page6-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application006.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft612">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft60">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft64">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft64">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft615">such&#160;as&#160;Microsoft’s&#160;CardSpace&#160;[38]&#160;can&#160;successfully&#160;be&#160;attacked&#160;even&#160;in&#160;a&#160;weaker&#160;<br/>adversary&#160;model&#160;(assuming&#160;the&#160;DNS&#160;is&#160;under&#160;the&#160;control&#160;of&#160;the&#160;adversary),&#160;whereas&#160;<br/>our&#160;adversary&#160;model&#160;considers&#160;malware&#160;as&#160;well.<br/>On&#160;&#160;&#160;the&#160;&#160;&#160;other&#160;&#160;&#160;hand,&#160;&#160;&#160;wallet-like&#160;&#160;&#160;approaches&#160;&#160;&#160;such&#160;&#160;&#160;as&#160;&#160;SpyBlock&#160;&#160;[55,40,39],&#160;&#160;Delegate&#160;<br/>[43],&#160;Vault&#160;[45],&#160;or&#160;Wallet-Proxy&#160;[31]&#160;have&#160;gained&#160;more&#160;attention&#160;recently&#160;and&#160;seem&#160;<br/>to&#160;be&#160;very&#160;promising&#160;towards&#160;secure&#160;web&#160;authentication.&#160;Those&#160;approaches&#160;use&#160;a&#160;<br/>password&#160;wallet&#160;as&#160;authentication&#160;agent&#160;in&#160;an&#160;isolated&#160;trusted&#160;environment&#160;(using&#160;<br/>virtual&#160;machines,&#160;or&#160;as&#160;with&#160;Delegate,&#160;a&#160;separate&#160;physical&#160;machine)&#160;to&#160;separate&#160;the&#160;<br/>handling&#160;of&#160;credentials&#160;from&#160;the&#160;normal&#160;web&#160;browsing&#160;(see&#160;also&#160;[55,70]).&#160;The&#160;wallet-<br/>based&#160;&#160;&#160;approach&#160;&#160;&#160;has&#160;&#160;&#160;the&#160;&#160;&#160;advantage&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;owns&#160;&#160;&#160;a&#160;&#160;&#160;“guardian&#160;&#160;&#160;angel”&#160;&#160;&#160;who&#160;<br/>protects&#160;against&#160;disclosure&#160;of&#160;sensitive&#160;data&#160;and&#160;potentially&#160;prevents&#160;identity&#160;theft&#160;<br/>caused&#160;by&#160;wrong&#160;user&#160;behavior.&#160;Further,&#160;there&#160;is&#160;no&#160;need&#160;to&#160;trust&#160;a&#160;distributed&#160;server&#160;<br/>hosting&#160;&#160;the&#160;&#160;&#160;credentials.&#160;&#160;Another&#160;&#160;&#160;issue&#160;&#160;&#160;is&#160;&#160;&#160;that&#160;&#160;&#160;a&#160;&#160;&#160;wallet&#160;&#160;&#160;can&#160;&#160;&#160;perform&#160;&#160;&#160;cryptographic&#160;<br/>tasks&#160;&#160;&#160;that&#160;&#160;&#160;cannot&#160;&#160;&#160;be&#160;&#160;&#160;performed&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;or&#160;&#160;&#160;provided&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;current&#160;&#160;&#160;browser&#160;<br/>implementations.&#160;In&#160;this&#160;work,&#160;we&#160;focus&#160;on&#160;password&#160;phishing.&#160;To&#160;protect&#160;against&#160;<br/>transaction&#160;&#160;&#160;generators,&#160;&#160;&#160;the&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;&#160;&#160;could&#160;&#160;&#160;be&#160;&#160;&#160;extended&#160;&#160;&#160;according&#160;&#160;&#160;to&#160;&#160;&#160;ideas&#160;<br/>presented&#160;in&#160;[40].<br/>In&#160;this&#160;deliverable,&#160;we&#160;describe&#160;our&#160;approach&#160;to&#160;counter&#160;identity&#160;theft:&#160;the&#160;Secure&#160;<br/>Wallet&#160;&#160;&#160;use&#160;&#160;&#160;case&#160;&#160;&#160;and&#160;&#160;&#160;prototype.&#160;&#160;&#160;We&#160;&#160;&#160;present&#160;&#160;&#160;the&#160;&#160;&#160;requirements&#160;&#160;&#160;and&#160;&#160;&#160;architecture,&#160;<br/>analyse&#160;&#160;&#160;the&#160;&#160;&#160;security,&#160;&#160;&#160;and&#160;&#160;&#160;propose&#160;&#160;&#160;a&#160;&#160;&#160;prototype&#160;&#160;&#160;implementation.&#160;&#160;&#160;This&#160;&#160;&#160;includes&#160;&#160;&#160;the&#160;<br/>architecture&#160;for&#160;a&#160;demonstrator&#160;using&#160;Infineon's&#160;X-GOLD</p>
<p style="position:absolute;top:553px;left:584px;white-space:nowrap" class="ft617">TM&#160;&#160;</p>
<p style="position:absolute;top:553px;left:606px;white-space:nowrap" class="ft614">208&#160;(formerly&#160;called&#160;S-</p>
<p style="position:absolute;top:572px;left:85px;white-space:nowrap" class="ft614">GOLD3</p>
<p style="position:absolute;top:572px;left:147px;white-space:nowrap" class="ft617">TM</p>
<p style="position:absolute;top:572px;left:163px;white-space:nowrap" class="ft614">)&#160;mobile&#160;platform.&#160;Moreover,&#160;the&#160;relation&#160;of&#160;the&#160;Secure&#160;Wallet&#160;to&#160;current&#160;</p>
<p style="position:absolute;top:591px;left:85px;white-space:nowrap" class="ft615">mobile&#160;standards,&#160;in&#160;particular&#160;the&#160;TCG&#160;Mobile&#160;Reference&#160;Architecture&#160;and&#160;OMTP&#160;<br/>TR1&#160;specifications,&#160;is&#160;discussed.&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft67">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft67">6/109</p>
</div>
<!-- Page 7 -->
<a name="7"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft719{font-size:18px;font-family:CAAAAA+DejaVuSans;color:#000000;}
	.ft720{font-size:17px;font-family:GAAAAA+DejaVuSerif;color:#000000;}
-->
</style>
<div id="page7-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application007.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft712">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft70">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft74">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft74">Final</p>
<p style="position:absolute;top:172px;left:85px;white-space:nowrap" class="ft73"><b>2&#160;</b></p>
<p style="position:absolute;top:169px;left:117px;white-space:nowrap" class="ft719"><b>The&#160;Secure&#160;Wallet&#160;Use&#160;Case&#160;and&#160;Prototype</b></p>
<p style="position:absolute;top:199px;left:85px;white-space:nowrap" class="ft715">In&#160;this&#160;section,&#160;we&#160;describe&#160;the&#160;Secure&#160;Wallet,&#160;our&#160;solution&#160;to&#160;counter&#160;identity&#160;theft&#160;<br/>based&#160;on&#160;the&#160;concepts&#160;from&#160;[31],&#160;and&#160;give&#160;an&#160;overview&#160;of&#160;the&#160;system&#160;architecture.&#160;We&#160;<br/>sketch&#160;the&#160;system&#160;architecture&#160;(based&#160;on&#160;generic&#160;security&#160;services&#160;as&#160;developed&#160;in&#160;<br/>OpenTC&#160;WP05)&#160;that&#160;has&#160;been&#160;used&#160;for&#160;our&#160;prototype&#160;implementation&#160;on&#160;a&#160;PC.&#160;We&#160;<br/>describe&#160;an&#160;architecture&#160;for&#160;a&#160;mobile&#160;platform,&#160;and&#160;propose&#160;a&#160;“hybrid”&#160;architecture&#160;<br/>for&#160;&#160;&#160;a&#160;&#160;&#160;demo-prototype,&#160;&#160;&#160;where&#160;&#160;&#160;functionalities&#160;&#160;&#160;are&#160;&#160;&#160;split&#160;&#160;&#160;between&#160;&#160;&#160;a&#160;&#160;&#160;PC&#160;&#160;&#160;and&#160;&#160;&#160;a&#160;&#160;&#160;mobile&#160;<br/>platform.</p>
<p style="position:absolute;top:380px;left:85px;white-space:nowrap" class="ft716"><b>2.1&#160;Overview&#160;of&#160;the&#160;Secure&#160;Wallet</b></p>
<p style="position:absolute;top:408px;left:85px;white-space:nowrap" class="ft715">According&#160;to&#160;the&#160;Anti-Phishing&#160;Working&#160;Group&#160;(APWG)&#160;<a href="file:///swallet/final/latex/main/main.html#APWG1206">[1]</a>,&#160;phishing&#160;attacks&#160;are&#160;still&#160;<br/>on&#160;the&#160;rise.&#160;Especially&#160;crimeware&#160;attacks&#160;reached&#160;a&#160;new&#160;all-time&#160;high&#160;in&#160;December&#160;<br/>2006,&#160;when&#160;the&#160;APWG&#160;recorded&#160;340&#160;unique&#160;applications&#160;designed&#160;for&#160;phishing&#160;and&#160;<br/>identity&#160;theft.&#160;More&#160;than&#160;28.000&#160;different&#160;phishing&#160;sites&#160;were&#160;recorded&#160;during&#160;the&#160;<br/>same&#160;month,&#160;each&#160;with&#160;an&#160;average&#160;online&#160;time&#160;of&#160;4&#160;days.&#160;Although&#160;those&#160;were&#160;about&#160;<br/>10.000&#160;sites&#160;less&#160;than&#160;in&#160;October&#160;and&#160;November,&#160;the&#160;number&#160;of&#160;phishing&#160;sites&#160;has&#160;<br/>almost&#160;&#160;&#160;tripled&#160;&#160;&#160;since&#160;&#160;&#160;summer&#160;&#160;&#160;2006.&#160;&#160;&#160;In&#160;&#160;&#160;April&#160;&#160;&#160;2007&#160;&#160;&#160;that&#160;&#160;&#160;number&#160;&#160;&#160;almost&#160;&#160;&#160;doubled&#160;&#160;&#160;to&#160;<br/>55.000&#160;unique&#160;sites,&#160;whereas&#160;in&#160;the&#160;last&#160;months&#160;of&#160;2007&#160;it&#160;dropped&#160;to&#160;about&#160;30.000&#160;<br/>sites&#160;&#160;again.&#160;Gartner&#160;&#160;<a href="file:///swallet/final/latex/main/main.html#gartner06">[11]</a>&#160;&#160;estimates&#160;direct&#160;&#160;financial&#160;&#160;losses&#160;&#160;due&#160;&#160;to&#160;phishing&#160;to&#160;&#160;$2.8&#160;<br/>billion&#160;in&#160;2006,&#160;while&#160;indirect&#160;losses&#160;are&#160;much&#160;higher,&#160;including&#160;account&#160;replacement&#160;<br/>costs&#160;&#160;&#160;and&#160;&#160;&#160;higher&#160;&#160;&#160;expenses&#160;&#160;&#160;for&#160;&#160;&#160;mitigating&#160;&#160;&#160;damage&#160;&#160;&#160;in&#160;&#160;&#160;trust&#160;&#160;&#160;and&#160;&#160;&#160;brand&#160;&#160;&#160;values.&#160;&#160;&#160;As&#160;<br/>attacks&#160;increase&#160;in&#160;frequency&#160;and&#160;become&#160;more&#160;sophisticated&#160;with&#160;every&#160;generation,&#160;<br/>increasing&#160;losses&#160;can&#160;be&#160;expected&#160;as&#160;well.&#160;<br/>In&#160;this&#160;chapter,&#160;we&#160;describe&#160;the&#160;basic&#160;ideas&#160;underlying&#160;the&#160;secure&#160;wallet.&#160;Note&#160;that&#160;<br/>we&#160;focus&#160;on&#160;password&#160;phishing.&#160;To&#160;address&#160;transaction&#160;generators,&#160;ideas&#160;from&#160;[40]&#160;<br/>can&#160;be&#160;combined&#160;with&#160;our&#160;approach.</p>
<p style="position:absolute;top:751px;left:85px;white-space:nowrap" class="ft76"><b>2.1.1&#160;Classical&#160;phishing&#160;</b></p>
<p style="position:absolute;top:778px;left:85px;white-space:nowrap" class="ft715">Basically,&#160;there&#160;are&#160;two&#160;types&#160;of&#160;phishing&#160;attacks.&#160;We&#160;define&#160;the&#160;first&#160;category,&#160;which&#160;<br/>is&#160;the&#160;oldest&#160;and&#160;still&#160;most&#160;widespread&#160;attack,&#160;as&#160;</p>
<p style="position:absolute;top:797px;left:508px;white-space:nowrap" class="ft720"><i>classical&#160;phishing</i></p>
<p style="position:absolute;top:797px;left:657px;white-space:nowrap" class="ft714">.&#160;The&#160;normal&#160;user&#160;</p>
<p style="position:absolute;top:816px;left:85px;white-space:nowrap" class="ft715">login&#160;procedure&#160;for&#160;an&#160;arbitrary&#160;web&#160;server&#160;is&#160;shown&#160;in<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#8">&#160;Figure&#160;1.</a>&#160;The&#160;user&#160;enters&#160;her&#160;<br/>username&#160;and&#160;password&#160;into&#160;a&#160;web&#160;form&#160;provided&#160;by&#160;the&#160;web&#160;server&#160;and&#160;submits&#160;this&#160;<br/>form.&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft77">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft77">7/109</p>
</div>
<!-- Page 8 -->
<a name="8"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft821{font-size:17px;font-family:DAAAAA+DejaVuSerif;color:#000000;}
-->
</style>
<div id="page8-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application008.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft812">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft80">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft84">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft84">Final</p>
<p style="position:absolute;top:549px;left:674px;white-space:nowrap" class="ft814">&#160;</p>
<p style="position:absolute;top:570px;left:327px;white-space:nowrap" class="ft821"><b>Figure&#160;1:</b></p>
<p style="position:absolute;top:570px;left:411px;white-space:nowrap" class="ft814">&#160;Web&#160;Server&#160;Login</p>
<p style="position:absolute;top:617px;left:85px;white-space:nowrap" class="ft815">In&#160;the&#160;phishing&#160;attack,&#160;the&#160;phisher&#160;tries&#160;to&#160;lure&#160;the&#160;unwary&#160;victim&#160;to&#160;a&#160;faked&#160;web&#160;site,&#160;<br/>which&#160;&#160;&#160;is&#160;&#160;&#160;designed&#160;&#160;&#160;to&#160;&#160;&#160;mimic&#160;&#160;&#160;a&#160;&#160;&#160;known&#160;&#160;&#160;web&#160;&#160;&#160;site&#160;&#160;&#160;(e.g.&#160;&#160;&#160;an&#160;&#160;&#160;online&#160;&#160;&#160;banking&#160;&#160;&#160;site&#160;&#160;&#160;of&#160;&#160;&#160;a&#160;<br/>common&#160;bank),&#160;using&#160;social&#160;engineering&#160;techniques.&#160;Such&#160;a&#160;lure&#160;typically&#160;is&#160;a&#160;spoofed&#160;<br/>email&#160;that&#160;appears&#160;to&#160;come&#160;from&#160;the&#160;organization&#160;associated&#160;with&#160;the&#160;original&#160;web&#160;<br/>site,&#160;asking&#160;to&#160;fill&#160;out&#160;some&#160;web&#160;form&#160;or&#160;to&#160;log&#160;into&#160;the&#160;victim's&#160;account&#160;in&#160;order&#160;to&#160;<br/>prevent&#160;it&#160;from&#160;being&#160;locked&#160;down&#160;permanently.&#160;Those&#160;sites&#160;have&#160;in&#160;common&#160;that&#160;a&#160;<br/>user&#160;with&#160;a&#160;given&#160;technical&#160;knowledge&#160;can&#160;distinguish&#160;them&#160;from&#160;the&#160;original&#160;sites&#160;by&#160;<br/>comparing&#160;&#160;&#160;the&#160;&#160;&#160;URLs&#160;&#160;&#160;or&#160;&#160;&#160;other&#160;&#160;&#160;security&#160;&#160;&#160;indicators&#160;&#160;&#160;(e.g.&#160;&#160;&#160;an&#160;&#160;&#160;SSL&#160;&#160;&#160;certificate).&#160;&#160;&#160;More&#160;<br/>sophisticated&#160;&#160;&#160;attacks&#160;&#160;&#160;include&#160;&#160;&#160;DNS&#160;&#160;&#160;poisoning&#160;&#160;&#160;techniques&#160;&#160;&#160;(e.g.,&#160;&#160;&#160;see&#160;&#160;&#160;[75]),&#160;&#160;&#160;thereby&#160;<br/>using&#160;the&#160;URL&#160;of&#160;the&#160;original&#160;site&#160;and&#160;forwarding&#160;the&#160;request&#160;to&#160;the&#160;phisher's&#160;web&#160;<br/>server.&#160;If&#160;the&#160;phisher&#160;was&#160;able&#160;to&#160;fake&#160;the&#160;site&#160;well&#160;enough&#160;to&#160;be&#160;plausible&#160;for&#160;the&#160;<br/>victim,&#160;he&#160;hopes&#160;that&#160;the&#160;user&#160;enters&#160;her&#160;credential&#160;in&#160;order&#160;to&#160;use&#160;the&#160;site&#160;or&#160;to&#160;carry&#160;<br/>out&#160;the&#160;requested&#160;operation&#160;(e.g.&#160;confirm&#160;her&#160;account).&#160;Since&#160;the&#160;phisher&#160;controls&#160;the&#160;<br/>faked&#160;web&#160;site,&#160;he&#160;is&#160;in&#160;possession&#160;of&#160;the&#160;victim's&#160;credential&#160;afterwards.&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft87">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft87">8/109</p>
</div>
<!-- Page 9 -->
<a name="9"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page9-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application009.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft912">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft90">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft94">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft94">Final</p>
<p style="position:absolute;top:734px;left:762px;white-space:nowrap" class="ft914">&#160;</p>
<p style="position:absolute;top:756px;left:284px;white-space:nowrap" class="ft921"><b>Figure&#160;2:</b></p>
<p style="position:absolute;top:756px;left:368px;white-space:nowrap" class="ft914">&#160;Classical&#160;Phishing&#160;Overview</p>
<p style="position:absolute;top:803px;left:85px;white-space:nowrap" class="ft915">Websites&#160;that&#160;disclose&#160;personal&#160;information&#160;about&#160;their&#160;users,&#160;e.g.&#160;the&#160;fact&#160;whether&#160;a&#160;<br/>specific&#160;email&#160;address&#160;is&#160;registered&#160;with&#160;it&#160;or&#160;not,&#160;can&#160;be&#160;used&#160;by&#160;phishers&#160;to&#160;build&#160;up&#160;<br/>hostile&#160;profiles.&#160;Those&#160;profiles&#160;are&#160;then&#160;used&#160;by&#160;phishers&#160;to&#160;create&#160;custom&#160;phishing&#160;<br/>mails&#160;tailored&#160;to&#160;the&#160;respective&#160;user,&#160;increasing&#160;the&#160;likelihood&#160;that&#160;the&#160;user&#160;believes&#160;<br/>the&#160;mail&#160;<a href="file:///swallet/final/latex/main/main.html#personal">[9]</a>.&#160;</p>
<p style="position:absolute;top:926px;left:85px;white-space:nowrap" class="ft96"><b>2.1.2&#160;Malware&#160;phishing&#160;</b></p>
<p style="position:absolute;top:952px;left:85px;white-space:nowrap" class="ft914">The&#160;other&#160;type&#160;of&#160;phishing&#160;attacks&#160;we&#160;define&#160;as&#160;</p>
<p style="position:absolute;top:952px;left:505px;white-space:nowrap" class="ft920"><i>malware&#160;phishing</i></p>
<p style="position:absolute;top:952px;left:657px;white-space:nowrap" class="ft914">.&#160;Generally,&#160;those&#160;</p>
<p style="position:absolute;top:972px;left:85px;white-space:nowrap" class="ft915">attacks&#160;can&#160;be&#160;categorized&#160;as&#160;attempts&#160;to&#160;collect&#160;personal&#160;information&#160;directly&#160;at&#160;the&#160;<br/>client&#160;through&#160;the&#160;use&#160;of&#160;malware,&#160;i.e.&#160;malicious&#160;software&#160;like&#160;trojans&#160;or&#160;keyloggers.&#160;<br/>Malware&#160;can&#160;have&#160;various&#160;effects&#160;on&#160;the&#160;client&#160;system.&#160;Besides&#160;keyloggers,&#160;which&#160;<br/>gather&#160;keystrokes&#160;and&#160;send&#160;them&#160;to&#160;the&#160;phisher,&#160;trojans&#160;can&#160;hijack&#160;browsers&#160;and&#160;<br/>trick&#160;&#160;&#160;users&#160;&#160;&#160;by&#160;&#160;&#160;altering&#160;&#160;&#160;their&#160;&#160;&#160;user&#160;&#160;&#160;interface&#160;&#160;&#160;or&#160;&#160;&#160;redirecting&#160;&#160;&#160;data&#160;&#160;&#160;streams&#160;&#160;&#160;to&#160;&#160;&#160;rogue&#160;<br/>servers.&#160;&#160;&#160;More&#160;&#160;&#160;sophisticated&#160;&#160;&#160;tools&#160;&#160;&#160;make&#160;&#160;&#160;use&#160;&#160;&#160;of&#160;&#160;&#160;numerous&#160;&#160;&#160;distributed&#160;&#160;&#160;machines&#160;<br/>gathering&#160;and&#160;collecting&#160;&#160;data&#160;&#160;silently&#160;&#160;&#160;using&#160;covert&#160;&#160;channels&#160;<a href="file:///swallet/final/latex/main/main.html#jakobsson05">[42]</a>.&#160;Phishers&#160;exploit&#160;<br/>known&#160;&#160;&#160;flaws&#160;&#160;&#160;in&#160;&#160;&#160;widely&#160;&#160;&#160;used&#160;&#160;&#160;software&#160;&#160;&#160;(e.g.&#160;&#160;&#160;buffer&#160;&#160;&#160;overruns)&#160;&#160;&#160;to&#160;&#160;&#160;distribute&#160;&#160;&#160;their&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft97">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:765px;white-space:nowrap" class="ft97">9/109</p>
</div>
<!-- Page 10 -->
<a name="10"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1022{font-size:18px;font-family:HAAAAA+Arial;color:#006a6a;}
	.ft1023{font-size:18px;line-height:22px;font-family:HAAAAA+Arial;color:#006a6a;}
-->
</style>
<div id="page10-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application010.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1012">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft100">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft104">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft104">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft1015">malicious&#160;code.&#160;As&#160;malware&#160;improves&#160;more&#160;and&#160;more,&#160;becoming&#160;increasingly&#160;resilient&#160;<br/>to&#160;detection&#160;and&#160;countering&#160;techniques,&#160;phishing&#160;through&#160;malware&#160;seems&#160;appealing&#160;<br/>and&#160;can&#160;be&#160;expected&#160;to&#160;increase&#160;in&#160;frequency.&#160;This&#160;is&#160;confirmed&#160;by&#160;the&#160;fact&#160;that&#160;in&#160;<br/>December&#160;2006&#160;the&#160;number&#160;of&#160;unique&#160;variants&#160;of&#160;phishing&#160;malware&#160;increased&#160;by&#160;110&#160;<br/>to&#160;340&#160;<a href="file:///swallet/final/latex/main/main.html#APWG1206">[1]</a>.&#160;</p>
<p style="position:absolute;top:846px;left:846px;white-space:nowrap" class="ft1014">&#160;</p>
<p style="position:absolute;top:867px;left:284px;white-space:nowrap" class="ft1021"><b>Figure&#160;3:&#160;</b></p>
<p style="position:absolute;top:868px;left:374px;white-space:nowrap" class="ft1014">Malware&#160;Phishing&#160;Overview</p>
<p style="position:absolute;top:905px;left:85px;white-space:nowrap" class="ft106"><b>2.1.3&#160;Countering&#160;phishing&#160;</b></p>
<p style="position:absolute;top:931px;left:85px;white-space:nowrap" class="ft1018">What&#160;&#160;&#160;makes&#160;&#160;&#160;countering&#160;&#160;&#160;phishing&#160;&#160;&#160;attacks&#160;&#160;&#160;difficult&#160;&#160;&#160;is&#160;&#160;&#160;the&#160;&#160;&#160;broad&#160;&#160;&#160;range&#160;&#160;&#160;of&#160;&#160;&#160;different&#160;<br/>attack&#160;vectors.&#160;On&#160;the&#160;one&#160;hand,&#160;the&#160;security&#160;engineer&#160;has&#160;to&#160;account&#160;for&#160;the&#160;unwary,&#160;<br/>technically&#160;inexperienced&#160;user&#160;being&#160;tricked&#160;by&#160;a&#160;convincing&#160;web&#160;site&#160;fake.&#160;On&#160;the&#160;<br/>other&#160;hand,&#160;credentials&#160;could&#160;also&#160;leak&#160;directly&#160;at&#160;the&#160;client&#160;without&#160;the&#160;user&#160;ever&#160;<br/>noticing&#160;it&#160;(at&#160;least&#160;until&#160;the&#160;phisher&#160;makes&#160;use&#160;of&#160;the&#160;stolen&#160;data).&#160;While&#160;solutions&#160;<br/>exist,&#160;targeting&#160;either&#160;the&#160;first&#160;or&#160;the&#160;second&#160;type&#160;of&#160;attacks&#160;in&#160;more&#160;or&#160;less&#160;detail,&#160;<br/>there&#160;is&#160;still&#160;no&#160;technique&#160;available&#160;that&#160;protects&#160;against&#160;both&#160;threats&#160;equally.&#160;The&#160;<br/>related&#160;work&#160;section&#160;provides&#160;some&#160;examples&#160;of&#160;existing&#160;solutions&#160;and&#160;illustrate&#160;why&#160;<br/>they&#160;do&#160;not&#160;suffice&#160;to&#160;target&#160;both&#160;kinds&#160;of&#160;attacks.&#160;<br/>This&#160;document&#160;takes&#160;up&#160;the&#160;idea&#160;from&#160;&#160;<a href="file:///swallet/final/latex/main/main.html#CompSec">[31]</a>&#160;&#160;and&#160;presents&#160;an&#160;implementation&#160;for&#160;the&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft107">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft107">10/109</p>
<p style="position:absolute;top:433px;left:719px;white-space:nowrap" class="ft1023"><b>Server&#160;on&#160;<br/>the&#160;Internet</b></p>
</div>
<!-- Page 11 -->
<a name="11"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1124{font-size:17px;line-height:19px;font-family:GAAAAA+DejaVuSerif;color:#000000;}
-->
</style>
<div id="page11-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application011.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1112">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft110">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft114">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft114">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft1115">proposed&#160;&#160;&#160;trusted&#160;&#160;&#160;wallet.&#160;&#160;&#160;This&#160;&#160;&#160;wallet,&#160;&#160;&#160;hence&#160;&#160;&#160;called&#160;&#160;&#160;Secure&#160;&#160;&#160;Wallet,&#160;&#160;&#160;will&#160;&#160;&#160;be&#160;&#160;&#160;used&#160;&#160;&#160;to&#160;<br/>securely&#160;store&#160;user&#160;credentials&#160;and&#160;authenticate&#160;to&#160;remote&#160;services&#160;on&#160;behalf&#160;of&#160;the&#160;<br/>user&#160;without&#160;requiring&#160;specific&#160;security-related&#160;skills&#160;(i.e.&#160;as&#160;stated&#160;above,&#160;to&#160;be&#160;able&#160;<br/>to&#160;recognize&#160;a&#160;web&#160;site&#160;fake&#160;or&#160;detect&#160;malware&#160;on&#160;her&#160;computer).&#160;In&#160;contrast&#160;to&#160;most&#160;<br/>other&#160;solutions,&#160;the&#160;wallet&#160;will&#160;equally&#160;protect&#160;against&#160;classical&#160;and&#160;malware&#160;phishing&#160;<br/>attacks.&#160;<br/>The&#160;&#160;&#160;wallet&#160;&#160;&#160;will&#160;&#160;&#160;be&#160;&#160;&#160;executed&#160;&#160;&#160;on&#160;&#160;&#160;top&#160;&#160;&#160;of&#160;&#160;&#160;a&#160;&#160;&#160;virtualisation&#160;&#160;&#160;platform&#160;&#160;&#160;based&#160;&#160;&#160;on&#160;&#160;&#160;trusted&#160;<br/>computing&#160;functionality.&#160;This&#160;platform&#160;provides&#160;integrity&#160;and&#160;isolation&#160;by&#160;combining&#160;<br/>a&#160;security&#160;kernel&#160;and&#160;controlled&#160;access&#160;mechanisms.&#160;Running&#160;on&#160;top&#160;of&#160;this&#160;platform,&#160;<br/>no&#160;malicious&#160;software&#160;will&#160;be&#160;able&#160;to&#160;access&#160;or&#160;intercept&#160;the&#160;credentials&#160;stored&#160;in&#160;the&#160;<br/>wallet.&#160;</p>
<p style="position:absolute;top:398px;left:85px;white-space:nowrap" class="ft1116"><b>2.2&#160;Security&#160;Problem&#160;Definition&#160;</b></p>
<p style="position:absolute;top:444px;left:85px;white-space:nowrap" class="ft116"><b>2.2.1&#160;Threats</b></p>
<p style="position:absolute;top:471px;left:85px;white-space:nowrap" class="ft1114">Internet&#160;users&#160;are&#160;subject&#160;to&#160;the&#160;following&#160;security&#160;threats&#160;regarding&#160;their&#160;identities:&#160;</p>
<p style="position:absolute;top:499px;left:85px;white-space:nowrap" class="ft1121"><b>Threat&#160;1</b></p>
<p style="position:absolute;top:499px;left:166px;white-space:nowrap" class="ft1114">&#160;(Identity&#160;Theft&#160;through&#160;Faked&#160;Web&#160;Sites)&#160;&#160;&#160;</p>
<p style="position:absolute;top:499px;left:546px;white-space:nowrap" class="ft1120"><i>The&#160;user&#160;U&#160;is&#160;lured&#160;to&#160;a&#160;faked&#160;&#160;</i></p>
<p style="position:absolute;top:519px;left:85px;white-space:nowrap" class="ft1124"><i>web&#160;site&#160;A&#160;where&#160;she&#160;enters&#160;her&#160;credential&#160;for&#160;the&#160;original&#160;site&#160;P,&#160;thereby&#160;exposing&#160;<br/>them&#160;to&#160;the&#160;creator&#160;of&#160;the&#160;faked&#160;site.</i></p>
<p style="position:absolute;top:566px;left:85px;white-space:nowrap" class="ft1115">The&#160;user&#160;may&#160;arrive&#160;at&#160;the&#160;fake&#160;site&#160;through&#160;different&#160;means,&#160;e.g.,&#160;a&#160;spoofed&#160;email&#160;<br/>containing&#160;a&#160;link&#160;to&#160;the&#160;site,&#160;a&#160;link&#160;on&#160;some&#160;other&#160;(probably&#160;not&#160;even&#160;compromised)&#160;<br/>web&#160;site&#160;or&#160;through&#160;redirection&#160;by&#160;DNS&#160;poisoning.&#160;If&#160;the&#160;user&#160;disregards&#160;possible&#160;<br/>security&#160;warnings&#160;or&#160;does&#160;not&#160;notice&#160;that&#160;browser&#160;security&#160;indicators&#160;are&#160;missing&#160;and&#160;<br/>hence&#160;trusts&#160;the&#160;displayed&#160;content,&#160;she&#160;may&#160;be&#160;inclined&#160;to&#160;enter&#160;her&#160;credential&#160;</p>
<p style="position:absolute;top:643px;left:808px;white-space:nowrap" class="ft1114">&#160;</p>
<p style="position:absolute;top:670px;left:85px;white-space:nowrap" class="ft1115">for&#160;the&#160;original&#160;site&#160;P&#160;in&#160;order&#160;to&#160;log&#160;into&#160;the&#160;fake&#160;site&#160;A.&#160;The&#160;adversary&#160;and&#160;creator&#160;of&#160;<br/>the&#160;fake&#160;site&#160;A&#160;then&#160;can&#160;take&#160;&#160;possession&#160;of&#160;the&#160;user's&#160;credential&#160;for&#160;the&#160;original&#160;site.&#160;<br/>Afterwards,&#160;the&#160;adversary&#160;can&#160;use&#160;them&#160;to&#160;impersonate&#160;the&#160;user&#160;in&#160;order&#160;to&#160;perform&#160;<br/>transactions&#160;or&#160;gain&#160;access&#160;to&#160;other&#160;data&#160;belonging&#160;to&#160;the&#160;user.</p>
<p style="position:absolute;top:756px;left:85px;white-space:nowrap" class="ft1121"><b>Threat&#160;2</b></p>
<p style="position:absolute;top:756px;left:166px;white-space:nowrap" class="ft1114">&#160;&#160;(Malware&#160;Identity&#160;Theft)&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:756px;left:403px;white-space:nowrap" class="ft1120"><i>Malicious&#160;software&#160;installed&#160;by&#160;an&#160;adversary&#160;A&#160;</i></p>
<p style="position:absolute;top:775px;left:85px;white-space:nowrap" class="ft1124"><i>on&#160;user&#160;U's&#160;system&#160;gathers&#160;identity&#160;data&#160;and&#160;credentials&#160;when&#160;they&#160;are&#160;entered&#160;by&#160;U&#160;<br/>(for&#160;various&#160;applications).&#160;The&#160;software&#160;somehow&#160;exposes&#160;that&#160;data&#160;for&#160;A&#160;to&#160;retrieve.</i></p>
<p style="position:absolute;top:823px;left:85px;white-space:nowrap" class="ft1115">Malicious&#160;software&#160;(i.e.&#160;malware)&#160;can&#160;be&#160;various&#160;kinds&#160;of&#160;trojans&#160;–&#160;maybe&#160;containing&#160;<br/>keyloggers&#160;or&#160;other&#160;spyware&#160;–&#160;on&#160;the&#160;user's&#160;system.&#160;It&#160;could&#160;have&#160;been&#160;installed&#160;by&#160;<br/>intention&#160;(and&#160;perhaps&#160;the&#160;user&#160;does&#160;not&#160;notice&#160;the&#160;software&#160;contains&#160;spyware),&#160;or&#160;<br/>without&#160;the&#160;user&#160;ever&#160;noticing&#160;it.&#160;Depending&#160;on&#160;the&#160;type&#160;of&#160;malware,&#160;user&#160;credentials&#160;<br/>may&#160;leak&#160;through&#160;different&#160;means.&#160;A&#160;keylogger&#160;might&#160;log&#160;all&#160;characters&#160;entered&#160;into&#160;<br/>the&#160;target&#160;application,&#160;whereas&#160;a&#160;trojan&#160;might&#160;display&#160;a&#160;faked&#160;login&#160;dialog&#160;for&#160;the&#160;<br/>target&#160;application&#160;persuading&#160;the&#160;user&#160;that&#160;it&#160;is&#160;the&#160;real&#160;application.&#160;Note&#160;that&#160;this&#160;<br/>includes&#160;login&#160;forms&#160;on&#160;web&#160;sites&#160;as&#160;well,&#160;since&#160;the&#160;trojan&#160;could&#160;have&#160;altered&#160;the&#160;<br/>browser's&#160;behavior.&#160;<br/>As&#160;soon&#160;as&#160;the&#160;malware&#160;has&#160;gathered&#160;sufficient&#160;credentials,&#160;it&#160;will&#160;somehow&#160;contact&#160;<br/>the&#160;adversary&#160;to&#160;send&#160;the&#160;gathered&#160;data&#160;to&#160;A,&#160;or&#160;it&#160;uses&#160;covert&#160;channels&#160;to&#160;expose&#160;the&#160;<br/>data&#160;&#160;&#160;at&#160;&#160;&#160;some&#160;&#160;&#160;public&#160;&#160;place,&#160;&#160;&#160;where&#160;&#160;&#160;A&#160;&#160;can&#160;&#160;retrieve&#160;&#160;&#160;it.&#160;&#160;&#160;Afterwards,&#160;&#160;&#160;A&#160;can&#160;&#160;&#160;&#160;&#160;use&#160;&#160;&#160;those&#160;<br/>credentials&#160;to&#160;impersonate&#160;the&#160;user&#160;as&#160;described&#160;in&#160;Threat<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#11">&#160;1.</a>&#160;</p>
<p style="position:absolute;top:1090px;left:85px;white-space:nowrap" class="ft1121"><b>Threat&#160;3</b></p>
<p style="position:absolute;top:1091px;left:165px;white-space:nowrap" class="ft1114">&#160;(Wallet&#160;Credential&#160;Theft)&#160;&#160;&#160;</p>
<p style="position:absolute;top:1091px;left:400px;white-space:nowrap" class="ft1120"><i>Malicious&#160;software&#160;reads&#160;the&#160;wallet's&#160;credential&#160;</i></p>
<p style="position:absolute;top:1110px;left:85px;white-space:nowrap" class="ft1120"><i>store&#160;directly.</i></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft117">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft117">11/109</p>
</div>
<!-- Page 12 -->
<a name="12"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page12-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application012.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1212">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft120">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft124">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft124">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft1215">A&#160;reasonable&#160;approach&#160;for&#160;malicious&#160;software&#160;is&#160;to&#160;bypass&#160;all&#160;protection&#160;mechanisms&#160;<br/>supplied&#160;by&#160;the&#160;Secure&#160;Wallet&#160;during&#160;web&#160;site&#160;setup&#160;or&#160;login&#160;and&#160;read&#160;the&#160;wallet's&#160;<br/>credential&#160;&#160;&#160;store&#160;&#160;&#160;directly.&#160;&#160;&#160;If&#160;&#160;&#160;that&#160;&#160;&#160;credential&#160;&#160;&#160;store&#160;&#160;&#160;is&#160;&#160;&#160;not&#160;&#160;&#160;sufficiently&#160;&#160;&#160;protected,&#160;<br/>attackers&#160;can&#160;gain&#160;access&#160;to&#160;all&#160;credentials&#160;that&#160;U&#160;has&#160;already&#160;stored.&#160;</p>
<p style="position:absolute;top:237px;left:85px;white-space:nowrap" class="ft1221"><b>Threat&#160;&#160;&#160;4</b></p>
<p style="position:absolute;top:237px;left:169px;white-space:nowrap" class="ft1214">&#160;&#160;(Configuration&#160;&#160;&#160;Modification)&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:237px;left:450px;white-space:nowrap" class="ft1220"><i>Malicious&#160;&#160;&#160;software&#160;&#160;&#160;modifies&#160;&#160;&#160;the&#160;&#160;&#160;wallet's&#160;</i></p>
<p style="position:absolute;top:256px;left:85px;white-space:nowrap" class="ft1220"><i>configuration&#160;in&#160;order&#160;to&#160;somehow&#160;intercept&#160;unprotected&#160;credentials.</i></p>
<p style="position:absolute;top:285px;left:85px;white-space:nowrap" class="ft1215">If&#160;a&#160;malicious&#160;program&#160;cannot&#160;overcome&#160;the&#160;wallet's&#160;defences&#160;while&#160;interacting&#160;with&#160;<br/>a&#160;remote&#160;server&#160;or&#160;cannot&#160;read&#160;its&#160;credential&#160;store&#160;directly,&#160;it&#160;could&#160;try&#160;to&#160;change&#160;the&#160;<br/>wallet's&#160;configuration&#160;to&#160;weaken&#160;its&#160;security&#160;or&#160;disable&#160;it&#160;completely.&#160;If&#160;the&#160;wallet's&#160;<br/>configuration&#160;files&#160;are&#160;not&#160;protected&#160;from&#160;unauthorized&#160;access,&#160;malicious&#160;code&#160;could&#160;<br/>alter&#160;them&#160;in&#160;any&#160;possible&#160;way.&#160;</p>
<p style="position:absolute;top:390px;left:85px;white-space:nowrap" class="ft1221"><b>Threat&#160;5</b></p>
<p style="position:absolute;top:390px;left:164px;white-space:nowrap" class="ft1214">&#160;(Fake&#160;Dialog&#160;Attack)&#160;&#160;&#160;</p>
<p style="position:absolute;top:390px;left:359px;white-space:nowrap" class="ft1220"><i>Malicious&#160;software&#160;displays&#160;faked&#160;dialogs&#160;resembling&#160;</i></p>
<p style="position:absolute;top:409px;left:85px;white-space:nowrap" class="ft1224"><i>the&#160;wallet's&#160;user&#160;interface&#160;and&#160;lures&#160;the&#160;user&#160;to&#160;enter&#160;credentials&#160;into&#160;those&#160;faked&#160;&#160;<br/>dialogs.</i></p>
<p style="position:absolute;top:456px;left:85px;white-space:nowrap" class="ft1215">Instead&#160;of&#160;disguising&#160;as&#160;some&#160;other&#160;application&#160;where&#160;the&#160;user&#160;could&#160;possibly&#160;enter&#160;<br/>credentials,&#160;malware&#160;could&#160;also&#160;try&#160;to&#160;disguise&#160;as&#160;the&#160;wallet&#160;itself.&#160;If&#160;the&#160;user&#160;has&#160;<br/>learned&#160;&#160;&#160;to&#160;&#160;&#160;enter&#160;&#160;&#160;credentials&#160;&#160;&#160;only&#160;&#160;&#160;into&#160;&#160;&#160;the&#160;&#160;&#160;wallet,&#160;&#160;&#160;this&#160;&#160;&#160;approach&#160;&#160;&#160;would&#160;&#160;&#160;be&#160;&#160;&#160;more&#160;<br/>promising&#160;than&#160;faking&#160;another&#160;application.&#160;Once&#160;the&#160;user&#160;is&#160;convinced&#160;that&#160;she&#160;uses&#160;<br/>the&#160;original&#160;wallet,&#160;the&#160;malicious&#160;program&#160;can&#160;intercept&#160;any&#160;credentials&#160;entered.&#160;<br/>An&#160;&#160;&#160;additional&#160;&#160;&#160;threat,&#160;&#160;&#160;not&#160;&#160;&#160;directly&#160;&#160;&#160;addressed&#160;&#160;&#160;by&#160;&#160;&#160;this&#160;&#160;&#160;work,&#160;&#160;&#160;comprises&#160;&#160;&#160;the&#160;&#160;&#160;use&#160;&#160;&#160;of&#160;<br/>Transaction&#160;&#160;&#160;Generators&#160;&#160;&#160;<a href="file:///swallet/final/latex/main/main.html#TransGen">[40]&#160;</a>&#160;&#160;to&#160;&#160;&#160;generate&#160;&#160;&#160;an&#160;&#160;&#160;arbitrary&#160;&#160;&#160;amount&#160;&#160;&#160;of&#160;&#160;&#160;unauthorized&#160;<br/>transactions&#160;&#160;once&#160;&#160;&#160;the&#160;&#160;user&#160;&#160;&#160;has&#160;&#160;&#160;&#160;successfully&#160;&#160;&#160;logged&#160;&#160;into&#160;&#160;a&#160;&#160;specific&#160;&#160;web&#160;&#160;site.&#160;&#160;&#160;This&#160;<br/>threat&#160;&#160;&#160;is&#160;&#160;&#160;not&#160;&#160;&#160;introduced&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;concept&#160;&#160;&#160;though,&#160;&#160;&#160;but&#160;&#160;&#160;is&#160;&#160;&#160;a&#160;&#160;&#160;general&#160;&#160;&#160;threat&#160;<br/>regarding&#160;web&#160;sites&#160;allowing&#160;for&#160;commercial&#160;transactions.&#160;Therefore,&#160;it&#160;will&#160;(briefly)&#160;<br/>be&#160;discussed&#160;in&#160;the&#160;security&#160;analysis&#160;below.&#160;</p>
<p style="position:absolute;top:704px;left:85px;white-space:nowrap" class="ft126"><b>2.2.2&#160;Assumptions&#160;</b></p>
<p style="position:absolute;top:730px;left:85px;white-space:nowrap" class="ft1214">As&#160;outlined&#160;in&#160;<a href="file:///swallet/final/latex/main/main.html#CompSec">[31]</a>,&#160;the&#160;wallet&#160;solution&#160;is&#160;based&#160;on&#160;the&#160;following&#160;three&#160;assumptions:&#160;</p>
<p style="position:absolute;top:758px;left:85px;white-space:nowrap" class="ft1221"><b>Assumption&#160;1</b></p>
<p style="position:absolute;top:758px;left:215px;white-space:nowrap" class="ft1214">&#160;&#160;(Honest&#160;Provider)&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:758px;left:396px;white-space:nowrap" class="ft1220"><i>We&#160;assume&#160;that&#160;the&#160;service&#160;provider&#160;P&#160;and&#160;his&#160;&#160;</i></p>
<p style="position:absolute;top:778px;left:85px;white-space:nowrap" class="ft1220"><i>services&#160;used&#160;by&#160;the&#160;user&#160;U&#160;are&#160;not&#160;compromised.</i></p>
<p style="position:absolute;top:806px;left:85px;white-space:nowrap" class="ft1215">If&#160;the&#160;service&#160;provider&#160;P&#160;did&#160;not&#160;reliably&#160;protect&#160;his&#160;services,&#160;malicious&#160;users&#160;are&#160;able&#160;<br/>to&#160;steal&#160;identities&#160;directly&#160;from&#160;the&#160;provider's&#160;database.&#160;Therefore,&#160;P&#160;must&#160;enforce&#160;<br/>that&#160;&#160;&#160;his&#160;&#160;&#160;services&#160;&#160;&#160;cannot&#160;&#160;&#160;be&#160;&#160;&#160;exploited.&#160;&#160;&#160;This&#160;&#160;&#160;especially&#160;&#160;&#160;holds&#160;&#160;&#160;true&#160;&#160;&#160;for&#160;&#160;&#160;certifying&#160;<br/>services.&#160;We&#160;assume&#160;that&#160;appropriate&#160;protection&#160;of&#160;the&#160;services&#160;includes&#160;the&#160;use&#160;of&#160;<br/>secure&#160;communication&#160;protocols&#160;such&#160;as&#160;SSL/TLS.</p>
<p style="position:absolute;top:911px;left:85px;white-space:nowrap" class="ft1221"><b>Assumption&#160;&#160;&#160;2</b></p>
<p style="position:absolute;top:911px;left:217px;white-space:nowrap" class="ft1214">&#160;&#160;(Genuine&#160;&#160;&#160;Internet)&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:911px;left:415px;white-space:nowrap" class="ft1220"><i>We&#160;&#160;&#160;assume&#160;&#160;&#160;that&#160;&#160;&#160;U&#160;&#160;&#160;uses&#160;&#160;&#160;a&#160;&#160;&#160;genuine&#160;&#160;&#160;internet&#160;</i></p>
<p style="position:absolute;top:930px;left:85px;white-space:nowrap" class="ft1220"><i>connection,&#160;i.e.&#160;an&#160;adversary&#160;A&#160;cannot&#160;spoof&#160;the&#160;whole&#160;web.</i></p>
<p style="position:absolute;top:958px;left:85px;white-space:nowrap" class="ft1215">Web&#160;spoofing&#160;attacks&#160;were&#160;first&#160;described&#160;by&#160;Felten&#160;et&#160;al.&#160;[28,71],&#160;and&#160;comprise&#160;an&#160;<br/>attack&#160;where&#160;A&#160;is&#160;able&#160;to&#160;fake&#160;the&#160;whole&#160;internet&#160;and&#160;any&#160;associated&#160;service&#160;for&#160;a&#160;<br/>user&#160;U.&#160;If&#160;such&#160;attacks&#160;were&#160;taken&#160;into&#160;account,&#160;the&#160;user&#160;would&#160;already&#160;disclose&#160;her&#160;<br/>credentials&#160;to&#160;the&#160;adversary&#160;when&#160;signing&#160;up&#160;for&#160;a&#160;service.&#160;Therefore,&#160;it&#160;is&#160;assumed&#160;in&#160;<br/>the&#160;following&#160;that&#160;U&#160;always&#160;signs&#160;up&#160;at&#160;an&#160;honest&#160;provider&#160;P&#160;using&#160;an&#160;unspoofed&#160;<br/>internet&#160;connection.&#160;</p>
<p style="position:absolute;top:1083px;left:85px;white-space:nowrap" class="ft1221"><b>Assumption&#160;3</b></p>
<p style="position:absolute;top:1083px;left:213px;white-space:nowrap" class="ft1214">&#160;(Ordinary&#160;User)&#160;&#160;&#160;</p>
<p style="position:absolute;top:1083px;left:373px;white-space:nowrap" class="ft1220"><i>We&#160;assume&#160;that&#160;the&#160;user&#160;U&#160;is&#160;an&#160;ordinary&#160;Internet&#160;</i></p>
<p style="position:absolute;top:1102px;left:85px;white-space:nowrap" class="ft1220"><i>user&#160;unable&#160;to&#160;properly&#160;authenticate&#160;a&#160;service&#160;provider&#160;P.</i></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft127">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft127">12/109</p>
</div>
<!-- Page 13 -->
<a name="13"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page13-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application013.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1312">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft130">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft134">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft134">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft1315">In&#160;order&#160;to&#160;authenticate&#160;a&#160;web&#160;site&#160;provided&#160;by&#160;P,&#160;the&#160;user&#160;has&#160;to&#160;verify&#160;the&#160;service&#160;<br/>identifiers&#160;</p>
<p style="position:absolute;top:170px;left:207px;white-space:nowrap" class="ft1314">.&#160;Such&#160;identifiers&#160;are&#160;the&#160;domain&#160;name,&#160;the&#160;'https'&#160;protocol&#160;specifier&#160;in&#160;</p>
<p style="position:absolute;top:198px;left:85px;white-space:nowrap" class="ft1315">the&#160;URL,&#160;and&#160;the&#160;SSL&#160;server&#160;certificate.&#160;However,&#160;studies&#160;show&#160;that&#160;most&#160;Internet&#160;<br/>users&#160;cannot&#160;distinguish&#160;legitimate&#160;web&#160;sites&#160;from&#160;faked&#160;ones&#160;and&#160;do&#160;not&#160;understand&#160;<br/>indicators,&#160;which&#160;signal&#160;trustworthiness,&#160;or&#160;where&#160;to&#160;look&#160;for&#160;those&#160;[36,37].&#160;</p>
<p style="position:absolute;top:265px;left:85px;white-space:nowrap" class="ft1321"><b>Assumption&#160;&#160;&#160;4</b></p>
<p style="position:absolute;top:265px;left:220px;white-space:nowrap" class="ft1314">&#160;&#160;(Trustworthy&#160;&#160;&#160;Public&#160;&#160;&#160;Key&#160;&#160;&#160;Infrastructure)&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:265px;left:622px;white-space:nowrap" class="ft1320"><i>We&#160;&#160;&#160;assume&#160;&#160;&#160;that&#160;&#160;&#160;&#160;&#160;a&#160;</i></p>
<p style="position:absolute;top:284px;left:85px;white-space:nowrap" class="ft1324"><i>trustworthy&#160;PKI&#160;exists,&#160;whose&#160;Certificate&#160;Authorities&#160;(CA)&#160;issue&#160;certificates&#160;for&#160;a&#160;web&#160;&#160;<br/>site&#160;P&#160;only&#160;to&#160;individuals&#160;associated&#160;with&#160;P.</i></p>
<p style="position:absolute;top:331px;left:85px;white-space:nowrap" class="ft1315">The&#160;&#160;&#160;whole&#160;&#160;&#160;point&#160;&#160;&#160;of&#160;&#160;&#160;a&#160;&#160;&#160;public&#160;&#160;&#160;key&#160;&#160;&#160;infrastructure&#160;&#160;&#160;lies&#160;&#160;&#160;in&#160;&#160;&#160;trusting&#160;&#160;&#160;some&#160;&#160;&#160;distinct&#160;<br/>Certificate&#160;&#160;&#160;Authorities&#160;&#160;&#160;to&#160;&#160;&#160;issue&#160;&#160;&#160;certificates&#160;&#160;&#160;only&#160;&#160;&#160;to&#160;&#160;&#160;authorized&#160;&#160;&#160;individuals,&#160;&#160;&#160;e.g.&#160;&#160;&#160;a&#160;<br/>certificate&#160;for&#160;www.ebay.com&#160;should&#160;only&#160;be&#160;issued&#160;to&#160;eBay&#160;Inc.&#160;or&#160;another&#160;entity&#160;<br/>explicitly&#160;authorized&#160;by&#160;eBay&#160;Inc.&#160;If&#160;a&#160;CA&#160;does&#160;not&#160;conform&#160;to&#160;secure&#160;practices&#160;for&#160;the&#160;<br/>verification&#160;of&#160;an&#160;applicant's&#160;identity,&#160;an&#160;arbitrary&#160;individual&#160;could,&#160;in&#160;theory,&#160;acquire&#160;<br/>a&#160;certificate&#160;for&#160;any&#160;web&#160;site&#160;he&#160;desires,&#160;thus&#160;being&#160;able&#160;to&#160;impersonate&#160;that&#160;site&#160;in&#160;a&#160;<br/>man-in-the-middle&#160;attack.&#160;Such&#160;an&#160;attack&#160;has&#160;been&#160;effective&#160;in&#160;the&#160;past&#160;at&#160;least&#160;once&#160;<br/>for&#160;a&#160;prominent&#160;victim,&#160;when&#160;an&#160;attacker&#160;managed&#160;to&#160;disguise&#160;himself&#160;as&#160;a&#160;Microsoft&#160;<br/>employee&#160;and&#160;acquired&#160;two&#160;certificates&#160;issued&#160;to&#160;Microsoft&#160;from&#160;Verisign&#160;[6].&#160;</p>
<p style="position:absolute;top:513px;left:85px;white-space:nowrap" class="ft1321"><b>Assumption&#160;&#160;&#160;5</b></p>
<p style="position:absolute;top:513px;left:217px;white-space:nowrap" class="ft1314">&#160;&#160;(Private&#160;&#160;&#160;Key&#160;&#160;&#160;Protection)&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:513px;left:466px;white-space:nowrap" class="ft1320"><i>We&#160;&#160;&#160;assume&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;service&#160;&#160;&#160;providers&#160;</i></p>
<p style="position:absolute;top:533px;left:85px;white-space:nowrap" class="ft1324"><i>protect&#160;the&#160;private&#160;keys&#160;of&#160;their&#160;&#160;certificates&#160;sufficiently&#160;and&#160;revoke&#160;them&#160;as&#160;soon&#160;as&#160;&#160;<br/>they&#160;are&#160;compromised&#160;or&#160;not&#160;used&#160;anymore.</i></p>
<p style="position:absolute;top:580px;left:85px;white-space:nowrap" class="ft1315">If&#160;a&#160;service&#160;provider&#160;does&#160;not&#160;sufficiently&#160;protect&#160;his&#160;private&#160;keys,&#160;an&#160;adversary&#160;who&#160;<br/>manages&#160;&#160;to&#160;&#160;steal&#160;&#160;&#160;them&#160;&#160;can&#160;&#160;impersonate&#160;&#160;&#160;the&#160;&#160;service&#160;&#160;&#160;provider&#160;&#160;&#160;and&#160;&#160;trick&#160;&#160;users&#160;&#160;into&#160;<br/>disclosing&#160;&#160;&#160;their&#160;&#160;&#160;credentials.&#160;&#160;&#160;This&#160;&#160;&#160;kind&#160;&#160;&#160;of&#160;&#160;&#160;attack&#160;&#160;&#160;cannot&#160;&#160;&#160;be&#160;&#160;&#160;countered&#160;&#160;&#160;by&#160;&#160;&#160;any&#160;<br/>mechanisms&#160;on&#160;the&#160;client-side.</p>
<p style="position:absolute;top:666px;left:85px;white-space:nowrap" class="ft1321"><b>Assumption&#160;6</b></p>
<p style="position:absolute;top:666px;left:215px;white-space:nowrap" class="ft1314">&#160;&#160;(Single&#160;Credential&#160;Storage&#160;Mechanism)&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:666px;left:587px;white-space:nowrap" class="ft1320"><i>We&#160;assume&#160;that&#160;the&#160;user&#160;</i></p>
<p style="position:absolute;top:685px;left:85px;white-space:nowrap" class="ft1320"><i>enters&#160;all&#160;credentials&#160;into&#160;the&#160;wallet&#160;exclusively.</i></p>
<p style="position:absolute;top:713px;left:85px;white-space:nowrap" class="ft1315">The&#160;wallet&#160;can&#160;only&#160;work&#160;to&#160;its&#160;maximum&#160;effect&#160;if&#160;the&#160;user&#160;uses&#160;it&#160;exclusively&#160;to&#160;store&#160;<br/>her&#160;credentials&#160;for&#160;web&#160;sites.&#160;When&#160;she&#160;still&#160;attempts&#160;to&#160;enter&#160;credentials&#160;into&#160;web&#160;<br/>sites&#160;directly&#160;or&#160;into&#160;other&#160;applications&#160;not&#160;associated&#160;with&#160;the&#160;wallet,&#160;no&#160;assumptions&#160;<br/>can&#160;&#160;&#160;be&#160;&#160;&#160;made&#160;&#160;&#160;about&#160;&#160;&#160;the&#160;&#160;&#160;credentials'&#160;&#160;&#160;security&#160;&#160;&#160;since&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;cannot&#160;&#160;&#160;cover&#160;&#160;&#160;those&#160;<br/>external&#160;&#160;&#160;factors.&#160;&#160;&#160;This&#160;&#160;&#160;also&#160;&#160;&#160;includes&#160;&#160;&#160;“recovery&#160;&#160;&#160;options”&#160;&#160;&#160;for&#160;&#160;&#160;forgotten&#160;&#160;&#160;passwords&#160;<br/>offered&#160;by&#160;many&#160;websites.&#160;If&#160;the&#160;user&#160;uses&#160;such&#160;an&#160;option&#160;to&#160;get&#160;an&#160;email&#160;containing&#160;<br/>the&#160;password,&#160;the&#160;adversary&#160;might&#160;obtain&#160;the&#160;password&#160;from&#160;this&#160;email,&#160;hence&#160;we&#160;<br/>have&#160;to&#160;assume&#160;that&#160;the&#160;user&#160;does&#160;not&#160;use&#160;such&#160;options&#160;(which&#160;are&#160;not&#160;necessary&#160;in&#160;<br/>any&#160;&#160;&#160;case,&#160;&#160;&#160;because&#160;&#160;&#160;passwords&#160;&#160;&#160;are&#160;&#160;&#160;stored&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;secure&#160;&#160;&#160;wallet).&#160;&#160;&#160;In&#160;&#160;&#160;practice,&#160;&#160;&#160;this&#160;<br/>assumption&#160;&#160;&#160;is&#160;&#160;&#160;more&#160;&#160;&#160;realistic&#160;&#160;&#160;and&#160;&#160;&#160;thus&#160;&#160;&#160;weaker&#160;&#160;&#160;than&#160;&#160;&#160;the&#160;&#160;&#160;assumption&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;<br/>always&#160;verifies&#160;the&#160;results&#160;of&#160;SSL&#160;certificate&#160;verifications&#160;provided&#160;by&#160;the&#160;browser.&#160;</p>
<p style="position:absolute;top:934px;left:85px;white-space:nowrap" class="ft1321"><b>Assupmtion&#160;7&#160;&#160;</b></p>
<p style="position:absolute;top:934px;left:221px;white-space:nowrap" class="ft1314">(Feasability&#160;of&#160;Secure&#160;Software&#160;Development)&#160;&#160;&#160;</p>
<p style="position:absolute;top:934px;left:630px;white-space:nowrap" class="ft1320"><i>We&#160;assume&#160;that&#160;it&#160;is&#160;</i></p>
<p style="position:absolute;top:953px;left:85px;white-space:nowrap" class="ft1324"><i>possible&#160;to&#160;develop&#160;secure&#160;software&#160;components&#160;of&#160;limited&#160;complexity&#160;and&#160;to&#160;verify&#160;&#160;<br/>their&#160;correctness.</i></p>
<p style="position:absolute;top:1000px;left:85px;white-space:nowrap" class="ft1315">Without&#160;secure&#160;software,&#160;we&#160;cannot&#160;protect&#160;the&#160;user's&#160;credentials.&#160;However,&#160;we&#160;try&#160;<br/>to&#160;limit&#160;the&#160;number&#160;and&#160;complexity&#160;of&#160;trusted&#160;software&#160;components.&#160;For&#160;instance,&#160;we&#160;<br/>do&#160;not&#160;assume&#160;that&#160;a&#160;complete&#160;web&#160;browser&#160;or&#160;an&#160;operating&#160;system&#160;where&#160;the&#160;user&#160;<br/>can&#160;install&#160;software&#160;can&#160;be&#160;implemented&#160;securely.&#160;But&#160;we&#160;do&#160;assume&#160;that&#160;a&#160;basic&#160;<br/>“security&#160;&#160;&#160;kernel”&#160;&#160;&#160;and&#160;&#160;&#160;a&#160;&#160;&#160;simple&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;&#160;&#160;application&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;implemented&#160;<br/>securely,&#160;and&#160;that&#160;the&#160;correctness&#160;of&#160;their&#160;implementation&#160;can&#160;be&#160;verified.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft137">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft137">13/109</p>
</div>
<!-- Page 14 -->
<a name="14"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1425{font-size:17px;line-height:20px;font-family:EAAAAA+DejaVuSerif;color:#000000;}
-->
</style>
<div id="page14-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application014.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1412">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft140">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft144">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft144">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft146"><b>2.2.3&#160;Objectives</b></p>
<p style="position:absolute;top:178px;left:85px;white-space:nowrap" class="ft1414">The&#160;&#160;&#160;main&#160;&#160;&#160;objective&#160;&#160;&#160;is&#160;&#160;&#160;to&#160;&#160;&#160;preserve&#160;&#160;&#160;the&#160;&#160;</p>
<p style="position:absolute;top:178px;left:448px;white-space:nowrap" class="ft1420"><i>confidentiality&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;user's&#160;&#160;&#160;credentials</i></p>
<p style="position:absolute;top:178px;left:803px;white-space:nowrap" class="ft1414">.&#160;</p>
<p style="position:absolute;top:197px;left:85px;white-space:nowrap" class="ft1415">However,&#160;&#160;&#160;this&#160;&#160;is&#160;&#160;&#160;made&#160;&#160;&#160;difficult&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;fact&#160;&#160;&#160;that&#160;&#160;&#160;most&#160;&#160;&#160;service&#160;&#160;&#160;providers&#160;&#160;&#160;offer&#160;&#160;&#160;only&#160;<br/>entity&#160;authentication,&#160;i.e.,&#160;authentication&#160;is&#160;based&#160;on&#160;the&#160;credentials&#160;alone&#160;and&#160;does&#160;<br/>not&#160;&#160;&#160;include&#160;&#160;&#160;all&#160;&#160;&#160;components&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;&#160;&#160;communication&#160;&#160;&#160;path.&#160;&#160;&#160;This&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;exploited&#160;&#160;&#160;by&#160;<br/>compromising&#160;such&#160;an&#160;unauthorized&#160;component.&#160;Therefore,&#160;the&#160;Secure&#160;Wallet&#160;will&#160;<br/>attempt&#160;to&#160;achieve&#160;the&#160;following&#160;partial&#160;security&#160;objectives:&#160;</p>
<p style="position:absolute;top:302px;left:85px;white-space:nowrap" class="ft1421"><b>Objective&#160;&#160;&#160;1</b></p>
<p style="position:absolute;top:302px;left:193px;white-space:nowrap" class="ft1414">&#160;&#160;(Protection&#160;&#160;&#160;against&#160;&#160;&#160;Fake&#160;&#160;&#160;Sites)&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:302px;left:498px;white-space:nowrap" class="ft1420"><i>Let&#160;&#160;&#160;P&#160;&#160;&#160;be&#160;&#160;&#160;a&#160;&#160;&#160;web&#160;&#160;&#160;site&#160;&#160;&#160;for&#160;&#160;&#160;which&#160;&#160;&#160;the&#160;&#160;</i></p>
<p style="position:absolute;top:321px;left:85px;white-space:nowrap" class="ft1420"><i>Secure&#160;Wallet&#160;stores&#160;U's&#160;credential&#160;</i></p>
<p style="position:absolute;top:321px;left:602px;white-space:nowrap" class="ft1420"><i>.&#160;The&#160;wallet&#160;will&#160;change&#160;</i></p>
<p style="position:absolute;top:349px;left:85px;white-space:nowrap" class="ft1420"><i>the&#160;password&#160;</i></p>
<p style="position:absolute;top:349px;left:254px;white-space:nowrap" class="ft1420"><i>&#160;in&#160;order&#160;to&#160;prevent&#160;U&#160;from&#160;being&#160;able&#160;to&#160;disclose&#160;it&#160;to&#160;a&#160;fake&#160;site&#160;</i></p>
<p style="position:absolute;top:378px;left:104px;white-space:nowrap" class="ft1420"><i>.&#160;Moreover,&#160;the&#160;password&#160;generated&#160;by&#160;the&#160;wallet&#160;will&#160;be&#160;a&#160;</i></p>
<p style="position:absolute;top:378px;left:622px;white-space:nowrap" class="ft1414">strong</p>
<p style="position:absolute;top:378px;left:676px;white-space:nowrap" class="ft1420"><i>&#160;password&#160;with&#160;</i></p>
<p style="position:absolute;top:397px;left:85px;white-space:nowrap" class="ft1424"><i>high&#160;entropy,&#160;unique&#160;for&#160;each&#160;site,&#160;to&#160;protect&#160;against&#160;dictionary&#160;attacks&#160;and&#160;common&#160;&#160;<br/>password&#160;attacks.</i></p>
<p style="position:absolute;top:444px;left:85px;white-space:nowrap" class="ft1425">The&#160;&#160;&#160;user&#160;&#160;&#160;may&#160;&#160;&#160;possibly&#160;&#160;&#160;give&#160;&#160;&#160;away&#160;&#160;&#160;everything&#160;&#160;&#160;she&#160;&#160;&#160;knows&#160;&#160;&#160;to&#160;&#160;&#160;a&#160;&#160;&#160;phishing&#160;&#160;&#160;attack,&#160;<br/>especially&#160;her&#160;credentials&#160;for&#160;a&#160;specific&#160;web&#160;site&#160;P.&#160;An&#160;effective&#160;way&#160;of&#160;preventing&#160;<br/>credential&#160;leakage&#160;is&#160;not&#160;letting&#160;the&#160;user&#160;know&#160;those&#160;credentials.&#160;Thus,&#160;even&#160;if&#160;faced&#160;<br/>with&#160;a&#160;faked&#160;web&#160;site&#160;&#160;</p>
<p style="position:absolute;top:503px;left:302px;white-space:nowrap" class="ft1414">,&#160;U&#160;cannot&#160;disclose&#160;any&#160;secret&#160;information&#160;apart&#160;from&#160;the&#160;</p>
<p style="position:absolute;top:523px;left:85px;white-space:nowrap" class="ft1414">outdated&#160;credential&#160;</p>
<p style="position:absolute;top:523px;left:298px;white-space:nowrap" class="ft1414">&#160;that&#160;U&#160;knew&#160;before&#160;the&#160;wallet&#160;changed&#160;it&#160;to&#160;</p>
<p style="position:absolute;top:523px;left:727px;white-space:nowrap" class="ft1414">.&#160;In&#160;order&#160;</p>
<p style="position:absolute;top:552px;left:85px;white-space:nowrap" class="ft1414">to&#160;prevent&#160;the&#160;adversary&#160;from&#160;computing&#160;</p>
<p style="position:absolute;top:552px;left:497px;white-space:nowrap" class="ft1414">&#160;from&#160;</p>
<p style="position:absolute;top:552px;left:600px;white-space:nowrap" class="ft1414">&#160;(in&#160;case&#160;he&#160;managed&#160;to&#160;</p>
<p style="position:absolute;top:582px;left:85px;white-space:nowrap" class="ft1414">get&#160;&#160;</p>
<p style="position:absolute;top:582px;left:172px;white-space:nowrap" class="ft1414">&#160;&#160;from&#160;the&#160;unwary&#160;user),&#160;the&#160;wallet&#160;&#160;incorporates&#160;random&#160;values&#160;into&#160;the&#160;</p>
<p style="position:absolute;top:611px;left:85px;white-space:nowrap" class="ft1415">transformation.&#160;<br/>This&#160;seems&#160;to&#160;have&#160;a&#160;great&#160;impact&#160;on&#160;usability,&#160;since&#160;U&#160;cannot&#160;log&#160;into&#160;the&#160;web&#160;sites&#160;<br/>stored&#160;in&#160;the&#160;wallet&#160;from&#160;other&#160;computers&#160;anymore&#160;because&#160;she&#160;does&#160;not&#160;know&#160;the&#160;<br/>password.&#160;&#160;&#160;While&#160;&#160;&#160;the&#160;&#160;&#160;question&#160;&#160;&#160;remains&#160;&#160;&#160;whether&#160;&#160;&#160;it&#160;&#160;&#160;is&#160;&#160;&#160;wise&#160;&#160;&#160;for&#160;&#160;&#160;U&#160;&#160;&#160;to&#160;&#160;&#160;expose&#160;&#160;&#160;her&#160;<br/>password&#160;to&#160;a&#160;possibly&#160;insecure&#160;or&#160;compromised&#160;computer&#160;beyond&#160;her&#160;control,&#160;there&#160;<br/>are&#160;&#160;certain&#160;&#160;&#160;ways&#160;&#160;to&#160;&#160;improve&#160;&#160;&#160;usability,&#160;&#160;&#160;such&#160;&#160;&#160;as&#160;&#160;migrating&#160;&#160;the&#160;&#160;&#160;user's&#160;&#160;data&#160;&#160;to&#160;&#160;other&#160;<br/>platforms.&#160;Further&#160;work&#160;in&#160;this&#160;direction&#160;is&#160;needed.</p>
<p style="position:absolute;top:763px;left:85px;white-space:nowrap" class="ft1421"><b>Objective&#160;2</b></p>
<p style="position:absolute;top:763px;left:191px;white-space:nowrap" class="ft1414">&#160;&#160;(Secure&#160;Environment)&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:763px;left:405px;white-space:nowrap" class="ft1420"><i>The&#160;system&#160;S&#160;ensures&#160;that&#160;the&#160;Secure&#160;Wallet's&#160;</i></p>
<p style="position:absolute;top:782px;left:85px;white-space:nowrap" class="ft1424"><i>internal&#160;credential&#160;store&#160;can&#160;only&#160;be&#160;accessed&#160;if&#160;the&#160;wallet&#160;is&#160;executed&#160;in&#160;a&#160;secure&#160;<br/>and&#160;trusted&#160;environment.</i></p>
<p style="position:absolute;top:830px;left:85px;white-space:nowrap" class="ft1415">If&#160;the&#160;user&#160;attempts&#160;to&#160;execute&#160;the&#160;wallet&#160;in&#160;an&#160;insecure&#160;environment,&#160;the&#160;system&#160;<br/>must&#160;&#160;&#160;prohibit&#160;&#160;&#160;further&#160;&#160;&#160;access&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;to&#160;&#160;&#160;prevent&#160;&#160;&#160;leakage&#160;&#160;&#160;of&#160;&#160;&#160;credentials.&#160;<br/>Therefore,&#160;the&#160;system&#160;must&#160;ensure&#160;that&#160;no&#160;security-critical&#160;components&#160;have&#160;been&#160;<br/>compromised&#160;by&#160;verifying&#160;whether&#160;they&#160;have&#160;changed&#160;since&#160;the&#160;last&#160;time&#160;the&#160;wallet&#160;<br/>was&#160;used.&#160;</p>
<p style="position:absolute;top:935px;left:85px;white-space:nowrap" class="ft1421"><b>Objective&#160;3</b></p>
<p style="position:absolute;top:935px;left:190px;white-space:nowrap" class="ft1414">&#160;(Secure&#160;Storage)&#160;&#160;&#160;</p>
<p style="position:absolute;top:935px;left:357px;white-space:nowrap" class="ft1420"><i>The&#160;Secure&#160;Wallet&#160;uses&#160;a&#160;secure&#160;storage&#160;that&#160;cannot&#160;&#160;</i></p>
<p style="position:absolute;top:954px;left:85px;white-space:nowrap" class="ft1420"><i>be&#160;read&#160;by&#160;any&#160;other&#160;application.</i></p>
<p style="position:absolute;top:982px;left:85px;white-space:nowrap" class="ft1415">The&#160;storage&#160;is&#160;the&#160;wallet's&#160;most&#160;important&#160;component&#160;since&#160;it&#160;contains&#160;all&#160;credentials&#160;<br/>stored&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;user.&#160;&#160;&#160;Unauthorized&#160;&#160;&#160;applications&#160;&#160;&#160;that&#160;&#160;&#160;manage&#160;&#160;&#160;to&#160;&#160;&#160;read&#160;&#160;&#160;the&#160;&#160;&#160;wallet's&#160;<br/>storage&#160;directly,&#160;immediately&#160;gain&#160;access&#160;to&#160;all&#160;credentials,&#160;rendering&#160;all&#160;the&#160;wallet's&#160;<br/>other&#160;protection&#160;mechanisms&#160;useless.&#160;Therefore,&#160;the&#160;wallet&#160;must&#160;protect&#160;its&#160;storage&#160;<br/>or&#160;rely&#160;on&#160;the&#160;system&#160;to&#160;sufficiently&#160;protect&#160;it.&#160;No&#160;other&#160;application&#160;than&#160;the&#160;wallet&#160;<br/>should&#160;have&#160;access&#160;to&#160;that&#160;storage.&#160;</p>
<p style="position:absolute;top:1107px;left:85px;white-space:nowrap" class="ft1421"><b>Objective&#160;4</b></p>
<p style="position:absolute;top:1107px;left:191px;white-space:nowrap" class="ft1414">&#160;(Secure&#160;Configuration)&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:1107px;left:412px;white-space:nowrap" class="ft1420"><i>The&#160;Secure&#160;Wallet&#160;software&#160;and&#160;configuration&#160;</i></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft147">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft147">14/109</p>
</div>
<!-- Page 15 -->
<a name="15"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page15-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application015.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1512">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft150">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft154">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft154">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft1524"><i>cannot&#160;be&#160;altered&#160;by&#160;unauthorized&#160;applications&#160;in&#160;such&#160;a&#160;way&#160;that&#160;an&#160;adversary&#160;may&#160;<br/>gain&#160;access&#160;to&#160;the&#160;user's&#160;credentials.</i></p>
<p style="position:absolute;top:198px;left:85px;white-space:nowrap" class="ft1515">The&#160;configuration&#160;controls&#160;how&#160;the&#160;wallet&#160;is&#160;used&#160;or&#160;whether&#160;it&#160;is&#160;used&#160;at&#160;all.&#160;By&#160;<br/>altering&#160;&#160;&#160;the&#160;&#160;&#160;configuration,&#160;&#160;&#160;an&#160;&#160;&#160;adversary&#160;&#160;&#160;could&#160;&#160;&#160;disable&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;completely&#160;&#160;&#160;and&#160;<br/>prevent&#160;it&#160;from&#160;protecting&#160;the&#160;user's&#160;credentials&#160;during&#160;web&#160;site&#160;login.&#160;Alternatively,&#160;<br/>the&#160;wallet&#160;could&#160;be&#160;misconfigured&#160;to&#160;prevent&#160;affective&#160;protection&#160;of&#160;user&#160;credetials.&#160;<br/>By&#160;modification&#160;of&#160;untrusted&#160;software&#160;components,&#160;an&#160;adversary&#160;should&#160;only&#160;be&#160;able&#160;<br/>to&#160;prevent&#160;the&#160;automated&#160;login&#160;operations&#160;(i.e.,&#160;denial&#160;of&#160;service)&#160;but&#160;should&#160;never&#160;<br/>get&#160;&#160;&#160;access&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;wallet's&#160;&#160;&#160;credentials.&#160;&#160;&#160;To&#160;&#160;&#160;prevent&#160;&#160;&#160;any&#160;&#160;&#160;further&#160;&#160;&#160;modifications,&#160;&#160;&#160;the&#160;<br/>configuration&#160;&#160;&#160;files&#160;&#160;&#160;must&#160;&#160;&#160;be&#160;&#160;&#160;stored&#160;&#160;&#160;separately,&#160;&#160;&#160;so&#160;&#160;&#160;that&#160;&#160;&#160;unauthorized&#160;&#160;&#160;applications&#160;<br/>cannot&#160;reach&#160;them.&#160;Moreover,&#160;the&#160;wallet&#160;software&#160;must&#160;not&#160;contain&#160;security-critical&#160;<br/>implementation&#160;flaws,&#160;such&#160;as&#160;buffer&#160;overflows.</p>
<p style="position:absolute;top:400px;left:85px;white-space:nowrap" class="ft1521"><b>Objective&#160;&#160;&#160;5</b></p>
<p style="position:absolute;top:400px;left:198px;white-space:nowrap" class="ft1514">&#160;&#160;(Secure&#160;&#160;&#160;Input&#160;&#160;&#160;and&#160;&#160;&#160;Output)&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:400px;left:495px;white-space:nowrap" class="ft1520"><i>No&#160;&#160;&#160;other&#160;&#160;&#160;application&#160;&#160;&#160;should&#160;&#160;&#160;gain&#160;</i></p>
<p style="position:absolute;top:419px;left:85px;white-space:nowrap" class="ft1520"><i>unauthorized&#160;access&#160;to&#160;input&#160;or&#160;output&#160;of&#160;the&#160;Secure&#160;Wallet&#160;.</i></p>
<p style="position:absolute;top:447px;left:85px;white-space:nowrap" class="ft1515">A&#160;common&#160;attack&#160;of&#160;Trojan&#160;horse&#160;programs&#160;is&#160;to&#160;emulate&#160;password&#160;input&#160;dialogs.&#160;The&#160;<br/>unwary&#160;user&#160;believes&#160;to&#160;enter&#160;her&#160;credentials&#160;into&#160;the&#160;genuine&#160;password&#160;dialog&#160;she&#160;<br/>expects.&#160;Thus&#160;she&#160;exposes&#160;those&#160;credentials&#160;to&#160;the&#160;malicious&#160;program.&#160;Therefore,&#160;the&#160;<br/>user&#160;must&#160;feel&#160;confident&#160;about&#160;the&#160;integrity,&#160;authenticity&#160;and&#160;confidentiality&#160;of&#160;the&#160;<br/>communication&#160;path&#160;to&#160;the&#160;wallet&#160;application&#160;as&#160;well&#160;as&#160;the&#160;integrity&#160;and&#160;authenticity&#160;<br/>of&#160;the&#160;secure&#160;wallet&#160;itself.&#160;</p>
<p style="position:absolute;top:589px;left:85px;white-space:nowrap" class="ft156"><b>2.2.4&#160;Security&#160;Objective&#160;Rationale&#160;</b></p>
<p style="position:absolute;top:616px;left:85px;white-space:nowrap" class="ft1514">Objective&#160;1&#160;(</p>
<p style="position:absolute;top:616px;left:193px;white-space:nowrap" class="ft1520"><i>Protection&#160;against&#160;Fake&#160;Sites</i></p>
<p style="position:absolute;top:616px;left:441px;white-space:nowrap" class="ft1514">)&#160;counters&#160;Threat&#160;1&#160;(</p>
<p style="position:absolute;top:616px;left:618px;white-space:nowrap" class="ft1520"><i>Identity&#160;Theft&#160;through&#160;</i></p>
<p style="position:absolute;top:635px;left:85px;white-space:nowrap" class="ft1520"><i>Faked&#160;Web&#160;Sites</i></p>
<p style="position:absolute;top:635px;left:229px;white-space:nowrap" class="ft1514">).&#160;When&#160;the&#160;user&#160;does&#160;not&#160;know&#160;the&#160;password&#160;for&#160;a&#160;web&#160;site,&#160;she&#160;</p>
<p style="position:absolute;top:654px;left:85px;white-space:nowrap" class="ft1518">cannot&#160;&#160;&#160;give&#160;&#160;&#160;that&#160;&#160;&#160;password&#160;&#160;&#160;away&#160;&#160;&#160;to&#160;&#160;&#160;an&#160;&#160;&#160;adversary&#160;&#160;&#160;trying&#160;&#160;&#160;to&#160;&#160;&#160;fake&#160;&#160;&#160;the&#160;&#160;&#160;web&#160;&#160;&#160;site.&#160;<br/>Therefore,&#160;faked&#160;web&#160;sites&#160;no&#160;longer&#160;pose&#160;a&#160;risk&#160;for&#160;the&#160;user's&#160;credentials.&#160;<br/>Objective&#160;3&#160;&#160;&#160;(</p>
<p style="position:absolute;top:702px;left:201px;white-space:nowrap" class="ft1520"><i>Secure&#160;&#160;&#160;Storage</i></p>
<p style="position:absolute;top:702px;left:340px;white-space:nowrap" class="ft1514">)&#160;&#160;&#160;counters&#160;&#160;&#160;Threat&#160;3&#160;&#160;&#160;(</p>
<p style="position:absolute;top:702px;left:540px;white-space:nowrap" class="ft1520"><i>Credential&#160;&#160;&#160;Theft</i></p>
<p style="position:absolute;top:702px;left:687px;white-space:nowrap" class="ft1514">),&#160;&#160;&#160;Objective&#160;4&#160;</p>
<p style="position:absolute;top:721px;left:85px;white-space:nowrap" class="ft1514">(</p>
<p style="position:absolute;top:721px;left:92px;white-space:nowrap" class="ft1520"><i>Secure&#160;&#160;&#160;Configuration</i></p>
<p style="position:absolute;top:721px;left:287px;white-space:nowrap" class="ft1514">)&#160;&#160;&#160;counters&#160;&#160;&#160;Threat&#160;4&#160;&#160;&#160;(</p>
<p style="position:absolute;top:721px;left:507px;white-space:nowrap" class="ft1520"><i>Configuration&#160;&#160;&#160;Modification</i></p>
<p style="position:absolute;top:721px;left:750px;white-space:nowrap" class="ft1514">)&#160;&#160;&#160;and&#160;</p>
<p style="position:absolute;top:740px;left:85px;white-space:nowrap" class="ft1514">Objective&#160;5&#160;(</p>
<p style="position:absolute;top:740px;left:195px;white-space:nowrap" class="ft1520"><i>Secure&#160;Input&#160;and&#160;Output</i></p>
<p style="position:absolute;top:740px;left:412px;white-space:nowrap" class="ft1514">)&#160;is&#160;meant&#160;to&#160;prevent&#160;Threat&#160;5&#160;(</p>
<p style="position:absolute;top:740px;left:692px;white-space:nowrap" class="ft1520"><i>Disguising&#160;as&#160;</i></p>
<p style="position:absolute;top:759px;left:85px;white-space:nowrap" class="ft1520"><i>the&#160;Wallet</i></p>
<p style="position:absolute;top:759px;left:170px;white-space:nowrap" class="ft1514">),&#160;since&#160;no&#160;malicious&#160;code&#160;can&#160;pretend&#160;to&#160;be&#160;the&#160;Secure&#160;Wallet&#160;as&#160;long&#160;as&#160;a&#160;</p>
<p style="position:absolute;top:778px;left:85px;white-space:nowrap" class="ft1515">trusted&#160;path&#160;to&#160;the&#160;wallet&#160;exists&#160;and&#160;is&#160;used.&#160;In&#160;addition,&#160;when&#160;the&#160;system&#160;already&#160;<br/>recognizes&#160;&#160;&#160;unexpected&#160;&#160;changes&#160;&#160;&#160;to&#160;&#160;security-critical&#160;&#160;&#160;components,&#160;&#160;&#160;protection&#160;&#160;&#160;against&#160;<br/>malware&#160;&#160;&#160;is&#160;&#160;&#160;significantly&#160;&#160;&#160;increased.&#160;&#160;&#160;Thus,&#160;&#160;&#160;all&#160;&#160;&#160;three&#160;&#160;&#160;Objectives&#160;&#160;3&#160;to&#160;5&#160;&#160;&#160;together&#160;&#160;&#160;with&#160;<br/>Objective&#160;2&#160;(</p>
<p style="position:absolute;top:836px;left:192px;white-space:nowrap" class="ft1520"><i>Secure&#160;Environment</i></p>
<p style="position:absolute;top:836px;left:364px;white-space:nowrap" class="ft1514">)&#160;counter&#160;Threat&#160;2&#160;(</p>
<p style="position:absolute;top:836px;left:529px;white-space:nowrap" class="ft1520"><i>Malware&#160;Identity&#160;Theft</i></p>
<p style="position:absolute;top:836px;left:723px;white-space:nowrap" class="ft1514">).&#160;</p>
<p style="position:absolute;top:896px;left:85px;white-space:nowrap" class="ft153"><b>Table&#160;1:</b></p>
<p style="position:absolute;top:896px;left:152px;white-space:nowrap" class="ft154">&#160;Threats&#160;and&#160;the&#160;objectives&#160;addressing&#160;them</p>
<p style="position:absolute;top:921px;left:227px;white-space:nowrap" class="ft154">&#160;</p>
<p style="position:absolute;top:921px;left:389px;white-space:nowrap" class="ft153"><b>Objective</b></p>
<p style="position:absolute;top:955px;left:227px;white-space:nowrap" class="ft153"><b>Threat</b></p>
<p style="position:absolute;top:946px;left:389px;white-space:nowrap" class="ft1510">Fake&#160;<br/>Site</p>
<p style="position:absolute;top:955px;left:435px;white-space:nowrap" class="ft154">Env.&#160;Storage&#160;Config&#160;Input</p>
<p style="position:absolute;top:990px;left:227px;white-space:nowrap" class="ft154">Fake&#160;Sites</p>
<p style="position:absolute;top:990px;left:389px;white-space:nowrap" class="ft154">X</p>
<p style="position:absolute;top:990px;left:435px;white-space:nowrap" class="ft154">&#160;</p>
<p style="position:absolute;top:990px;left:481px;white-space:nowrap" class="ft154">&#160;</p>
<p style="position:absolute;top:990px;left:552px;white-space:nowrap" class="ft154">&#160;</p>
<p style="position:absolute;top:990px;left:609px;white-space:nowrap" class="ft154">&#160;</p>
<p style="position:absolute;top:1015px;left:227px;white-space:nowrap" class="ft154">Malware</p>
<p style="position:absolute;top:1015px;left:389px;white-space:nowrap" class="ft154">&#160;</p>
<p style="position:absolute;top:1015px;left:435px;white-space:nowrap" class="ft154">X</p>
<p style="position:absolute;top:1015px;left:481px;white-space:nowrap" class="ft154">X</p>
<p style="position:absolute;top:1015px;left:552px;white-space:nowrap" class="ft154">X</p>
<p style="position:absolute;top:1015px;left:609px;white-space:nowrap" class="ft154">X</p>
<p style="position:absolute;top:1041px;left:227px;white-space:nowrap" class="ft154">Credential&#160;Store</p>
<p style="position:absolute;top:1041px;left:389px;white-space:nowrap" class="ft154">&#160;</p>
<p style="position:absolute;top:1041px;left:435px;white-space:nowrap" class="ft154">&#160;</p>
<p style="position:absolute;top:1041px;left:481px;white-space:nowrap" class="ft154">X</p>
<p style="position:absolute;top:1041px;left:552px;white-space:nowrap" class="ft154">&#160;</p>
<p style="position:absolute;top:1041px;left:609px;white-space:nowrap" class="ft154">&#160;</p>
<p style="position:absolute;top:1067px;left:227px;white-space:nowrap" class="ft154">Config&#160;Modification&#160;&#160;</p>
<p style="position:absolute;top:1067px;left:435px;white-space:nowrap" class="ft154">&#160;</p>
<p style="position:absolute;top:1067px;left:481px;white-space:nowrap" class="ft154">&#160;</p>
<p style="position:absolute;top:1067px;left:552px;white-space:nowrap" class="ft154">X</p>
<p style="position:absolute;top:1067px;left:609px;white-space:nowrap" class="ft154">&#160;</p>
<p style="position:absolute;top:1092px;left:227px;white-space:nowrap" class="ft154">Fake&#160;Dialog</p>
<p style="position:absolute;top:1092px;left:389px;white-space:nowrap" class="ft154">&#160;</p>
<p style="position:absolute;top:1092px;left:435px;white-space:nowrap" class="ft154">&#160;</p>
<p style="position:absolute;top:1092px;left:481px;white-space:nowrap" class="ft154">&#160;</p>
<p style="position:absolute;top:1092px;left:552px;white-space:nowrap" class="ft154">&#160;</p>
<p style="position:absolute;top:1092px;left:609px;white-space:nowrap" class="ft154">X</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft157">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft157">15/109</p>
</div>
<!-- Page 16 -->
<a name="16"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1626{font-size:17px;line-height:21px;font-family:EAAAAA+DejaVuSerif;color:#000000;}
-->
</style>
<div id="page16-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application016.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1612">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft160">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft164">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft164">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft1615">By&#160;ensuring&#160;a&#160;secure&#160;authentication&#160;process&#160;and&#160;preventing&#160;insecure&#160;communication&#160;<br/>channels,&#160;both&#160;faked&#160;web&#160;sites&#160;and&#160;malicious&#160;programs&#160;lose&#160;their&#160;ability&#160;to&#160;disguise&#160;<br/>as&#160;a&#160;trusted&#160;entity.&#160;Thus,&#160;the&#160;overall&#160;security&#160;objective,&#160;being&#160;the&#160;preservation&#160;of&#160;the&#160;<br/>confidentiality&#160;of&#160;the&#160;user's&#160;credentials,&#160;is&#160;achieved&#160;if&#160;the&#160;partial&#160;objectives&#160;can&#160;be&#160;<br/>achieved.&#160;The&#160;following&#160;table&#160;provides&#160;a&#160;compact&#160;overview&#160;of&#160;the&#160;discussed&#160;relations&#160;<br/>between&#160;objectives&#160;and&#160;threats.&#160;</p>
<p style="position:absolute;top:303px;left:85px;white-space:nowrap" class="ft1614">Assumption&#160;1&#160;(</p>
<p style="position:absolute;top:303px;left:213px;white-space:nowrap" class="ft1620"><i>Honest&#160;Provider</i></p>
<p style="position:absolute;top:303px;left:351px;white-space:nowrap" class="ft1614">)&#160;is&#160;important&#160;to&#160;exclude&#160;the&#160;service&#160;provider&#160;system&#160;</p>
<p style="position:absolute;top:323px;left:85px;white-space:nowrap" class="ft1618">from&#160;all&#160;security&#160;considerations.&#160;If&#160;the&#160;adversary&#160;can&#160;steal&#160;identities&#160;directly&#160;at&#160;the&#160;<br/>provider,&#160;no&#160;action&#160;taken&#160;on&#160;the&#160;client&#160;can&#160;prevent&#160;that.&#160;Even&#160;if&#160;the&#160;adversary&#160;can&#160;<br/>“only”&#160;compromise&#160;the&#160;provider&#160;instead&#160;of&#160;stealing&#160;the&#160;identities&#160;at&#160;once,&#160;the&#160;client&#160;<br/>won't&#160;&#160;&#160;presumably&#160;&#160;&#160;detect&#160;&#160;&#160;that.&#160;&#160;&#160;Thus,&#160;&#160;&#160;Assumption&#160;1&#160;&#160;&#160;is&#160;&#160;&#160;crucial&#160;&#160;&#160;for&#160;&#160;&#160;all&#160;&#160;&#160;following&#160;<br/>considerations.&#160;<br/>As&#160;already&#160;described&#160;in&#160;Assumption&#160;2&#160;(</p>
<p style="position:absolute;top:428px;left:417px;white-space:nowrap" class="ft1620"><i>Genuine&#160;Internet</i></p>
<p style="position:absolute;top:428px;left:561px;white-space:nowrap" class="ft1614">),&#160;if&#160;an&#160;adversary&#160;was&#160;able&#160;to&#160;</p>
<p style="position:absolute;top:447px;left:85px;white-space:nowrap" class="ft1618">spoof&#160;the&#160;whole&#160;internet,&#160;the&#160;user&#160;U&#160;would&#160;already&#160;disclose&#160;her&#160;credentials&#160;when&#160;<br/>signing&#160;up&#160;for&#160;a&#160;service.&#160;In&#160;this&#160;case,&#160;no&#160;protections&#160;on&#160;the&#160;client&#160;side&#160;would&#160;have&#160;an&#160;<br/>effect&#160;either.&#160;<br/>On&#160;the&#160;other&#160;hand,&#160;if&#160;Assumption&#160;3&#160;(</p>
<p style="position:absolute;top:513px;left:410px;white-space:nowrap" class="ft1620"><i>Ordinary&#160;User</i></p>
<p style="position:absolute;top:513px;left:533px;white-space:nowrap" class="ft1614">)&#160;is&#160;not&#160;taken&#160;into&#160;account,&#160;the&#160;</p>
<p style="position:absolute;top:533px;left:85px;white-space:nowrap" class="ft1618">proposed&#160;solution&#160;will&#160;also&#160;work&#160;for&#160;a&#160;skilled&#160;user&#160;who&#160;knows&#160;how&#160;to&#160;distinguish&#160;a&#160;<br/>phishing&#160;site&#160;from&#160;an&#160;original&#160;site&#160;(in&#160;the&#160;case&#160;of&#160;Threat&#160;1).&#160;Regarding&#160;Threat&#160;1,&#160;a&#160;<br/>skilled&#160;user&#160;will&#160;probably&#160;refuse&#160;to&#160;install&#160;any&#160;kind&#160;of&#160;suspicious&#160;software&#160;in&#160;the&#160;first&#160;<br/>place&#160;or&#160;recognize&#160;faked&#160;login&#160;dialogs&#160;displayed&#160;on&#160;her&#160;system.&#160;The&#160;assumption&#160;is&#160;<br/>reasonable,&#160;though,&#160;because&#160;studies&#160;show&#160;that&#160;most&#160;Internet&#160;users&#160;do&#160;not&#160;possess&#160;<br/>such&#160;knowledge&#160;and&#160;therefore&#160;it&#160;helps&#160;to&#160;prevent&#160;phishing&#160;attacks&#160;for&#160;a&#160;larger&#160;user&#160;<br/>base.&#160;<br/>The&#160;&#160;&#160;importance&#160;&#160;&#160;of&#160;&#160;&#160;Assumption&#160;4&#160;&#160;&#160;(</p>
<p style="position:absolute;top:676px;left:386px;white-space:nowrap" class="ft1620"><i>Trustworthy&#160;&#160;&#160;Public&#160;&#160;&#160;Key&#160;&#160;&#160;Infrastructure</i></p>
<p style="position:absolute;top:676px;left:719px;white-space:nowrap" class="ft1614">)&#160;&#160;&#160;becomes&#160;</p>
<p style="position:absolute;top:695px;left:85px;white-space:nowrap" class="ft1615">immediately&#160;&#160;&#160;clear&#160;&#160;&#160;when&#160;&#160;&#160;dealing&#160;&#160;&#160;with&#160;&#160;&#160;certificates&#160;&#160;&#160;that&#160;&#160;&#160;have&#160;&#160;&#160;been&#160;&#160;&#160;issued&#160;&#160;&#160;without&#160;<br/>authorization.&#160;&#160;&#160;Certificates&#160;&#160;&#160;represent&#160;&#160;&#160;the&#160;&#160;&#160;primary&#160;&#160;&#160;source&#160;&#160;&#160;of&#160;&#160;&#160;trust&#160;&#160;&#160;in&#160;&#160;&#160;a&#160;&#160;&#160;public&#160;&#160;&#160;key&#160;<br/>infrastructure.&#160;If&#160;there&#160;exists&#160;a&#160;certificate&#160;that&#160;seems&#160;to&#160;belong&#160;to&#160;a&#160;certain&#160;web&#160;site&#160;P&#160;<br/>but&#160;was&#160;issued&#160;to&#160;an&#160;adversary&#160;A&#160;instead,&#160;A&#160;can&#160;impersonate&#160;P&#160;for&#160;arbitrary&#160;users&#160;<br/>without&#160;them&#160;noticing.&#160;<br/>If&#160;&#160;&#160;an&#160;&#160;&#160;adversary&#160;&#160;&#160;manages&#160;&#160;&#160;to&#160;&#160;&#160;steal&#160;&#160;&#160;a&#160;&#160;&#160;private&#160;&#160;&#160;key&#160;&#160;&#160;from&#160;&#160;&#160;a&#160;&#160;&#160;service&#160;&#160;&#160;provider&#160;&#160;&#160;and&#160;<br/>impersonates&#160;him&#160;&#160;in&#160;a&#160;&#160;form&#160;&#160;of&#160;redirection&#160;&#160;attack,&#160;there&#160;is&#160;nothing&#160;that&#160;&#160;the&#160;client&#160;<br/>could&#160;&#160;do&#160;to&#160;&#160;detect&#160;&#160;that&#160;&#160;apart&#160;&#160;from&#160;verifying&#160;the&#160;&#160;&#160;actual&#160;&#160;web&#160;site&#160;&#160;&#160;content.&#160;&#160;Without&#160;<br/>Assumption&#160;5,&#160;&#160;&#160;a&#160;&#160;&#160;client&#160;&#160;&#160;cannot&#160;&#160;&#160;trust&#160;&#160;&#160;a&#160;&#160;&#160;single&#160;&#160;&#160;certificate&#160;&#160;&#160;since&#160;&#160;&#160;it&#160;&#160;&#160;could&#160;&#160;&#160;possibly&#160;&#160;&#160;be&#160;<br/>stolen.&#160;</p>
<p style="position:absolute;top:923px;left:85px;white-space:nowrap" class="ft166"><b>2.2.5&#160;Requirements&#160;</b></p>
<p style="position:absolute;top:952px;left:85px;white-space:nowrap" class="ft1615">In&#160;order&#160;to&#160;achieve&#160;the&#160;security&#160;objectives&#160;introduced&#160;above,&#160;both&#160;the&#160;system&#160;&#160;&#160;(i.e.,&#160;<br/>the&#160;platform&#160;together&#160;with&#160;the&#160;operating&#160;system)&#160;and&#160;the&#160;wallet&#160;must&#160;meet&#160;several&#160;<br/>requirements.&#160;Those&#160;requirements&#160;are&#160;as&#160;follows:&#160;</p>
<p style="position:absolute;top:1019px;left:85px;white-space:nowrap" class="ft1621"><b>Requirement&#160;1</b></p>
<p style="position:absolute;top:1019px;left:225px;white-space:nowrap" class="ft1614">&#160;(System&#160;Integrity)&#160;&#160;&#160;</p>
<p style="position:absolute;top:1019px;left:404px;white-space:nowrap" class="ft1620"><i>The&#160;integrity&#160;of&#160;security-critical&#160;components&#160;in&#160;</i></p>
<p style="position:absolute;top:1038px;left:85px;white-space:nowrap" class="ft1620"><i>S&#160;should&#160;not&#160;be&#160;compromised.</i></p>
<p style="position:absolute;top:1069px;left:85px;white-space:nowrap" class="ft1626">If&#160;malicious&#160;software&#160;infects&#160;critical&#160;system&#160;components&#160;in&#160;&#160;&#160;,&#160;the&#160;system&#160;is&#160;rendered&#160;<br/>incapable&#160;of&#160;providing&#160;protection&#160;against&#160;attacks&#160;and&#160;cannot&#160;meet&#160;the&#160;other&#160;security&#160;<br/>requirements.&#160;Thus,&#160;security-critical&#160;components&#160;of&#160;&#160;&#160;have&#160;to&#160;be&#160;isolated&#160;from&#160;non-</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft167">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft167">16/109</p>
</div>
<!-- Page 17 -->
<a name="17"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page17-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application017.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1712">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft170">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft174">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft174">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft1715">critical&#160;&#160;&#160;components.&#160;&#160;&#160;While&#160;&#160;&#160;this&#160;&#160;&#160;preserves&#160;&#160;&#160;system&#160;&#160;&#160;integrity&#160;&#160;&#160;at&#160;&#160;&#160;runtime,&#160;&#160;&#160;additional&#160;<br/>measures&#160;&#160;&#160;must&#160;&#160;&#160;be&#160;&#160;&#160;taken&#160;&#160;&#160;to&#160;&#160;&#160;protect&#160;&#160;&#160;against&#160;&#160;&#160;offline-attacks,&#160;&#160;&#160;e.g.&#160;&#160;&#160;when&#160;&#160;&#160;a&#160;&#160;&#160;different&#160;<br/>operation&#160;&#160;&#160;system&#160;&#160;&#160;is&#160;&#160;&#160;booted.&#160;&#160;&#160;A&#160;&#160;&#160;secure&#160;&#160;&#160;boot&#160;&#160;&#160;mechanism&#160;&#160;&#160;is&#160;&#160;&#160;required&#160;&#160;&#160;to&#160;&#160;&#160;prevent&#160;<br/>modification&#160;of&#160;initial&#160;system&#160;components.&#160;</p>
<p style="position:absolute;top:237px;left:85px;white-space:nowrap" class="ft1721"><b>Requirement&#160;2</b></p>
<p style="position:absolute;top:237px;left:225px;white-space:nowrap" class="ft1714">&#160;(Isolation)&#160;&#160;&#160;</p>
<p style="position:absolute;top:237px;left:336px;white-space:nowrap" class="ft1720"><i>Runtime&#160;and&#160;offline&#160;protection&#160;of&#160;application&#160;code&#160;and&#160;</i></p>
<p style="position:absolute;top:256px;left:85px;white-space:nowrap" class="ft1720"><i>data&#160;in&#160;S&#160;must&#160;be&#160;assured.</i></p>
<p style="position:absolute;top:285px;left:85px;white-space:nowrap" class="ft1715">The&#160;internal&#160;state&#160;or&#160;persistently&#160;stored&#160;state&#160;of&#160;processes&#160;must&#160;not&#160;be&#160;accessible&#160;by&#160;<br/>malicious&#160;processes.&#160;Since&#160;malware&#160;may&#160;try&#160;to&#160;log&#160;the&#160;user's&#160;key&#160;strokes&#160;or&#160;modify&#160;<br/>the&#160;&#160;&#160;system&#160;&#160;&#160;configuration,&#160;&#160;&#160;applications&#160;&#160;&#160;for&#160;&#160;&#160;different&#160;&#160;&#160;tasks&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;should&#160;&#160;&#160;be&#160;<br/>separated,&#160;such&#160;that&#160;they&#160;cannot&#160;interfere&#160;with&#160;each&#160;other.&#160;The&#160;Secure&#160;Wallet&#160;should&#160;<br/>store&#160;the&#160;user's&#160;credentials&#160;securely.&#160;Thus,&#160;having&#160;a&#160;clearly&#160;security-related&#160;task,&#160;the&#160;<br/>wallet's&#160;internal&#160;credential&#160;store&#160;should&#160;never&#160;be&#160;read&#160;by&#160;applications&#160;unrelated&#160;to&#160;<br/>security&#160;tasks,&#160;e.g.&#160;a&#160;web&#160;browser&#160;or&#160;active&#160;scripts&#160;running&#160;therein.&#160;</p>
<p style="position:absolute;top:428px;left:85px;white-space:nowrap" class="ft1721"><b>Requirement&#160;&#160;3</b></p>
<p style="position:absolute;top:428px;left:227px;white-space:nowrap" class="ft1714">&#160;&#160;(Information&#160;&#160;Flow)&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:428px;left:421px;white-space:nowrap" class="ft1720"><i>Credentials&#160;&#160;should&#160;be&#160;&#160;relayed&#160;&#160;to&#160;&#160;authorized&#160;</i></p>
<p style="position:absolute;top:447px;left:85px;white-space:nowrap" class="ft1720"><i>applications&#160;only.</i></p>
<p style="position:absolute;top:475px;left:85px;white-space:nowrap" class="ft1715">Credentials&#160;&#160;&#160;must&#160;&#160;&#160;enter&#160;&#160;&#160;and&#160;&#160;&#160;leave&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;in&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;&#160;&#160;be&#160;&#160;&#160;used&#160;&#160;&#160;effectively.&#160;&#160;&#160;If&#160;<br/>credentials&#160;could&#160;not&#160;be&#160;passed&#160;on&#160;to&#160;other&#160;applications&#160;(e.g.&#160;in&#160;order&#160;to&#160;log&#160;into&#160;a&#160;<br/>web&#160;site),&#160;the&#160;wallet&#160;has&#160;no&#160;other&#160;use&#160;than&#160;storing&#160;them.&#160;Only&#160;trusted&#160;components&#160;<br/>known&#160;by&#160;the&#160;wallet&#160;or&#160;components&#160;that&#160;can&#160;identify&#160;and&#160;authorize&#160;themselves&#160;(e.g.&#160;a&#160;<br/>remote&#160;web&#160;server&#160;using&#160;a&#160;valid&#160;SSL&#160;certificate)&#160;should&#160;gain&#160;access&#160;to&#160;any&#160;of&#160;the&#160;<br/>stored&#160;&#160;&#160;credentials.&#160;&#160;&#160;The&#160;&#160;&#160;wallet&#160;&#160;&#160;should&#160;&#160;&#160;warn&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;when&#160;&#160;&#160;she&#160;&#160;&#160;attempts&#160;&#160;&#160;to&#160;&#160;&#160;send&#160;<br/>credentials&#160;over&#160;an&#160;insecure&#160;communication&#160;channel&#160;(e.g.&#160;to&#160;a&#160;web&#160;site&#160;without&#160;SSL&#160;<br/>encryption).&#160;&#160;&#160;Moreover,&#160;&#160;&#160;inter-process&#160;&#160;&#160;communication&#160;&#160;&#160;should&#160;&#160;&#160;only&#160;&#160;&#160;be&#160;&#160;&#160;performed&#160;<br/>through&#160;&#160;&#160;strictly&#160;&#160;&#160;controlled&#160;&#160;&#160;communication&#160;&#160;&#160;interfaces,&#160;&#160;&#160;i.e.&#160;&#160;&#160;no&#160;&#160;&#160;bypassing&#160;&#160;&#160;of&#160;&#160;&#160;those&#160;<br/>interfaces&#160;should&#160;be&#160;possible.&#160;</p>
<p style="position:absolute;top:677px;left:85px;white-space:nowrap" class="ft1721"><b>Requirement&#160;&#160;&#160;4</b></p>
<p style="position:absolute;top:677px;left:228px;white-space:nowrap" class="ft1714">&#160;&#160;(Trusted&#160;&#160;&#160;Path)&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:677px;left:390px;white-space:nowrap" class="ft1720"><i>No&#160;&#160;&#160;other&#160;&#160;&#160;application&#160;&#160;&#160;should&#160;&#160;&#160;gain&#160;&#160;&#160;unauthorized&#160;</i></p>
<p style="position:absolute;top:696px;left:85px;white-space:nowrap" class="ft1724"><i>access&#160;to&#160;input&#160;or&#160;output&#160;of&#160;the&#160;application&#160;in&#160;S&#160;used&#160;by&#160;U&#160;to&#160;enter&#160;her&#160;credentials&#160;&#160;<br/>(i.e.,&#160;the&#160;secure&#160;wallet).</i></p>
<p style="position:absolute;top:743px;left:85px;white-space:nowrap" class="ft1715">To&#160;&#160;&#160;ensure&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;enters&#160;&#160;&#160;credentials&#160;&#160;&#160;only&#160;&#160;&#160;into&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;and&#160;&#160;&#160;no&#160;&#160;&#160;other&#160;<br/>applications&#160;can&#160;access&#160;the&#160;user's&#160;input,&#160;the&#160;system&#160;must&#160;provide&#160;a&#160;mechanism&#160;which&#160;<br/>allows&#160;separation&#160;of&#160;input&#160;channels.&#160;While&#160;the&#160;user&#160;enters&#160;her&#160;credentials,&#160;she&#160;must&#160;<br/>feel&#160;confident&#160;that&#160;those&#160;credentials&#160;are&#160;sent&#160;over&#160;a&#160;secure&#160;communication&#160;channel.&#160;A&#160;<br/>visual&#160;proof&#160;of&#160;the&#160;current&#160;channel's&#160;security&#160;state&#160;should&#160;be&#160;displayed&#160;to&#160;the&#160;user&#160;at&#160;<br/>all&#160;times.&#160;</p>
<p style="position:absolute;top:868px;left:85px;white-space:nowrap" class="ft1721"><b>Requirement&#160;&#160;&#160;5</b></p>
<p style="position:absolute;top:868px;left:229px;white-space:nowrap" class="ft1714">&#160;&#160;(Robustness)&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:868px;left:374px;white-space:nowrap" class="ft1720"><i>Wrong&#160;&#160;&#160;configuration&#160;&#160;&#160;or&#160;&#160;&#160;setup&#160;&#160;&#160;of&#160;&#160;&#160;security-critical&#160;</i></p>
<p style="position:absolute;top:887px;left:85px;white-space:nowrap" class="ft1720"><i>components&#160;of&#160;S&#160;should&#160;not&#160;have&#160;adverse&#160;effects&#160;on&#160;the&#160;security&#160;features&#160;provided.</i></p>
<p style="position:absolute;top:915px;left:85px;white-space:nowrap" class="ft1714">As&#160;pointed&#160;out&#160;in&#160;Assumption&#160;3&#160;(</p>
<p style="position:absolute;top:915px;left:360px;white-space:nowrap" class="ft1720"><i>Ordinary&#160;User</i></p>
<p style="position:absolute;top:915px;left:481px;white-space:nowrap" class="ft1714">),&#160;this&#160;deliverable&#160;assumes&#160;an&#160;ordinary&#160;</p>
<p style="position:absolute;top:934px;left:85px;white-space:nowrap" class="ft1715">user&#160;&#160;&#160;without&#160;&#160;&#160;any&#160;&#160;&#160;technical&#160;&#160;&#160;knowledge&#160;&#160;&#160;to&#160;&#160;&#160;configure&#160;&#160;&#160;or&#160;&#160;&#160;understand&#160;&#160;&#160;security-critical&#160;<br/>applications&#160;&#160;&#160;or&#160;&#160;&#160;indicators.&#160;&#160;&#160;Thus,&#160;&#160;&#160;any&#160;&#160;&#160;configuration&#160;&#160;&#160;necessary&#160;&#160;&#160;to&#160;&#160;&#160;fulfil&#160;&#160;&#160;the&#160;&#160;&#160;security&#160;<br/>objective&#160;must&#160;be&#160;easy&#160;to&#160;understand&#160;and&#160;tolerate&#160;mistakes.&#160;In&#160;the&#160;context&#160;of&#160;the&#160;<br/>wallet&#160;this&#160;implies&#160;that&#160;the&#160;user&#160;should&#160;preferably&#160;only&#160;enter&#160;user&#160;credentials&#160;without&#160;<br/>having&#160;to&#160;worry&#160;about&#160;any&#160;inner&#160;workings.&#160;Because&#160;of&#160;assumption&#160;3&#160;(ordinary&#160;user),&#160;<br/>this&#160;requirement&#160;does&#160;not&#160;only&#160;address&#160;usability:&#160;in&#160;order&#160;to&#160;protect&#160;the&#160;credentials&#160;of&#160;<br/>unskilled&#160;users,&#160;the&#160;secure&#160;wallet&#160;</p>
<p style="position:absolute;top:1050px;left:371px;white-space:nowrap" class="ft1720"><i>must</i></p>
<p style="position:absolute;top:1050px;left:413px;white-space:nowrap" class="ft1714">&#160;be&#160;easy&#160;to&#160;setup&#160;ad&#160;configure.&#160;</p>
<p style="position:absolute;top:1078px;left:85px;white-space:nowrap" class="ft1721"><b>Requirement&#160;6</b></p>
<p style="position:absolute;top:1078px;left:227px;white-space:nowrap" class="ft1714">&#160;&#160;(Authentication)&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:1078px;left:394px;white-space:nowrap" class="ft1720"><i>Unauthorized&#160;individuals&#160;should&#160;not&#160;be&#160;able&#160;to&#160;</i></p>
<p style="position:absolute;top:1097px;left:85px;white-space:nowrap" class="ft1720"><i>access&#160;the&#160;wallet's&#160;data&#160;stored&#160;by&#160;other&#160;users.</i></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft177">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft177">17/109</p>
</div>
<!-- Page 18 -->
<a name="18"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page18-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application018.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1812">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft180">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft184">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft184">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft1815">On&#160;a&#160;multi-user&#160;system&#160;or&#160;in&#160;a&#160;multi-user&#160;environment&#160;(e.g.&#160;an&#160;open-plan&#160;office)&#160;the&#160;<br/>system&#160;must&#160;ensure&#160;that&#160;credentials&#160;stored&#160;by&#160;one&#160;user&#160;are&#160;not&#160;accessible&#160;by&#160;other&#160;<br/>users.&#160;A&#160;user&#160;has&#160;to&#160;authenticate&#160;herself&#160;before&#160;she&#160;can&#160;use&#160;the&#160;wallet&#160;and&#160;her&#160;stored&#160;<br/>credentials.&#160;The&#160;system&#160;must&#160;provide&#160;a&#160;method&#160;to&#160;let&#160;the&#160;user&#160;authenticate&#160;herself.&#160;<br/>This&#160;can&#160;either&#160;happen&#160;as&#160;part&#160;of&#160;a&#160;general&#160;user&#160;authentication&#160;or&#160;it&#160;can&#160;be&#160;specific&#160;to&#160;<br/>the&#160;wallet.&#160;Moreover,&#160;the&#160;system's&#160;security&#160;policy&#160;may&#160;define&#160;that&#160;the&#160;user&#160;has&#160;to&#160;<br/>reauthenticate&#160;herself&#160;after&#160;a&#160;specific&#160;timespan.&#160;</p>
<p style="position:absolute;top:312px;left:85px;white-space:nowrap" class="ft1816"><b>2.3&#160;Related&#160;Work&#160;</b></p>
<p style="position:absolute;top:359px;left:85px;white-space:nowrap" class="ft186"><b>2.3.1&#160;Client-based&#160;Phishing&#160;Countermeasures&#160;</b></p>
<p style="position:absolute;top:385px;left:85px;white-space:nowrap" class="ft1815">Several&#160;existing&#160;solutions&#160;add&#160;security&#160;toolbars&#160;to&#160;the&#160;browser's&#160;user&#160;interface&#160;that&#160;<br/>should&#160;warn&#160;the&#160;user&#160;of&#160;fraudulent&#160;sites&#160;by&#160;checking&#160;certain&#160;indicators&#160;like&#160;a&#160;valid&#160;<br/>SSL&#160;certificate&#160;or&#160;by&#160;maintaining&#160;a&#160;blacklist&#160;of&#160;known&#160;phishing&#160;sites.&#160;Examples&#160;of&#160;<br/>such&#160;toolbars&#160;are&#160;TrustBar&#160;<a href="file:///swallet/final/latex/main/main.html#TrustBar">[37]</a>,&#160;Netcraft&#160;Toolbar&#160;<a href="file:///swallet/final/latex/main/main.html#Netcraft">[7]</a>&#160;or&#160;SpoofGuard&#160;<a href="file:///swallet/final/latex/main/main.html#SpoofGuard">[22]</a>.&#160;While&#160;those&#160;<br/>solutions&#160;tend&#160;to&#160;lessen&#160;the&#160;success&#160;of&#160;phishing&#160;attacks,&#160;they&#160;are&#160;not&#160;sufficient&#160;to&#160;<br/>counter&#160;them&#160;completely,&#160;as&#160;a&#160;recent&#160;study&#160;shows&#160;<a href="file:///swallet/final/latex/main/main.html#Wu06">[69]</a>.&#160;Users&#160;fail&#160;to&#160;continuously&#160;<br/>check&#160;the&#160;displayed&#160;security&#160;indicators,&#160;since&#160;their&#160;primary&#160;goal&#160;is&#160;not&#160;security&#160;but&#160;to&#160;<br/>finish&#160;the&#160;task&#160;that&#160;led&#160;them&#160;to&#160;the&#160;phishing&#160;site.&#160;Even&#160;when&#160;the&#160;toolbars&#160;showed&#160;<br/>suspicious&#160;signs,&#160;users&#160;often&#160;did&#160;not&#160;know&#160;how&#160;to&#160;interpret&#160;them.&#160;They&#160;tend&#160;to&#160;trust&#160;<br/>the&#160;actual&#160;web&#160;site&#160;content&#160;more&#160;than&#160;the&#160;security&#160;indicators&#160;that&#160;were&#160;installed.&#160;This&#160;<br/>is&#160;especially&#160;harmful&#160;if&#160;a&#160;phishing&#160;site&#160;displays&#160;real&#160;web&#160;site&#160;content&#160;in&#160;a&#160;man-in-the-<br/>middle&#160;attack&#160;or&#160;in&#160;a&#160;picture-in-picture&#160;attack,&#160;where&#160;a&#160;picture&#160;of&#160;a&#160;browser&#160;window&#160;<br/>containing&#160;the&#160;image&#160;of&#160;a&#160;legitimate&#160;site&#160;is&#160;shown&#160;as&#160;the&#160;content&#160;of&#160;a&#160;fraudulent&#160;site&#160;<br/><a href="file:///swallet/final/latex/main/main.html#pic-in-pic">[41]</a>.&#160;<br/>Dynamic&#160;&#160;&#160;Security&#160;&#160;&#160;Skins&#160;&#160;&#160;<a href="file:///swallet/final/latex/main/main.html#DSS">[25]&#160;</a>&#160;&#160;offer&#160;&#160;&#160;a&#160;&#160;&#160;better&#160;&#160;&#160;alternative&#160;&#160;&#160;in&#160;&#160;&#160;requiring&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;to&#160;<br/>recognize&#160;only&#160;an&#160;image&#160;and&#160;a&#160;low-entropy&#160;password&#160;while&#160;freeing&#160;them&#160;from&#160;the&#160;<br/>burden&#160;of&#160;checking&#160;all&#160;browser&#160;security&#160;indicators,&#160;but&#160;they&#160;have&#160;two&#160;drawbacks.&#160;<br/>First,&#160;this&#160;approach&#160;is&#160;not&#160;resistant&#160;to&#160;malware&#160;attacks,&#160;since&#160;a&#160;trojan&#160;altering&#160;the&#160;<br/>browser's&#160;behavior&#160;or&#160;user&#160;interface&#160;could&#160;fake&#160;the&#160;images&#160;by&#160;generating&#160;a&#160;matching&#160;<br/>set&#160;&#160;&#160;of&#160;&#160;&#160;images&#160;&#160;&#160;itself.&#160;&#160;&#160;Second,&#160;&#160;&#160;they&#160;&#160;&#160;require&#160;&#160;&#160;a&#160;&#160;&#160;change&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;web&#160;&#160;&#160;server,&#160;&#160;&#160;which&#160;<br/>significantly&#160;lowers&#160;the&#160;chance&#160;for&#160;this&#160;technique&#160;to&#160;be&#160;deployed.&#160;<br/>A&#160;related&#160;approach&#160;was&#160;taken&#160;with&#160;Synchronized&#160;Random&#160;Dynamic&#160;Boundaries&#160;<a href="file:///swallet/final/latex/main/main.html#TrustedPath">[73]</a>.&#160;<br/>In&#160;&#160;&#160;an&#160;&#160;&#160;attempt&#160;&#160;&#160;to&#160;&#160;&#160;separate&#160;&#160;&#160;status&#160;&#160;&#160;information&#160;&#160;&#160;from&#160;&#160;&#160;web&#160;&#160;&#160;site&#160;&#160;&#160;content,&#160;&#160;&#160;the&#160;&#160;&#160;authors&#160;<br/>implemented&#160;a&#160;protection&#160;scheme&#160;that&#160;changed&#160;the&#160;border&#160;colours&#160;of&#160;the&#160;browser&#160;<br/>and&#160;its&#160;associated&#160;windows&#160;in&#160;random&#160;intervals,&#160;thereby&#160;exposing&#160;spoofed&#160;windows&#160;<br/>generated&#160;by&#160;malicious&#160;code.&#160;While&#160;this&#160;technique&#160;does&#160;not&#160;require&#160;a&#160;change&#160;to&#160;the&#160;<br/>web&#160;&#160;&#160;server,&#160;&#160;&#160;it&#160;&#160;&#160;still&#160;&#160;&#160;suffers&#160;&#160;&#160;from&#160;&#160;&#160;similar&#160;&#160;&#160;drawbacks&#160;&#160;&#160;as&#160;&#160;&#160;the&#160;&#160;&#160;dynamic&#160;&#160;&#160;security&#160;&#160;&#160;skin&#160;<br/>approach,&#160;e.g.,&#160;it&#160;is&#160;vulnerable&#160;to&#160;malware&#160;attacks.</p>
<p style="position:absolute;top:968px;left:85px;white-space:nowrap" class="ft186"><b>Password&#160;Managers&#160;</b></p>
<p style="position:absolute;top:994px;left:85px;white-space:nowrap" class="ft1818">Password&#160;managers&#160;are&#160;readily&#160;available&#160;for&#160;many&#160;different&#160;operating&#160;systems&#160;and&#160;<br/>desktop&#160;&#160;&#160;environments.&#160;&#160;&#160;A&#160;&#160;&#160;familiar&#160;&#160;&#160;example&#160;&#160;&#160;is&#160;&#160;&#160;KWallet&#160;&#160;&#160;<a href="file:///swallet/final/latex/main/main.html#kwallet">[59]&#160;</a>&#160;&#160;included&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;&#160;&#160;KDE&#160;<br/>Project.&#160;&#160;&#160;Passwords&#160;&#160;&#160;are&#160;&#160;&#160;encrypted&#160;&#160;&#160;and&#160;&#160;&#160;stored&#160;&#160;&#160;on&#160;&#160;&#160;the&#160;&#160;&#160;user's&#160;&#160;&#160;system&#160;&#160;&#160;and&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;<br/>automatically&#160;retrieved,&#160;e.g.&#160;by&#160;the&#160;Konqueror&#160;browser,&#160;whenever&#160;the&#160;user&#160;enters&#160;a&#160;<br/>web&#160;site&#160;that&#160;the&#160;wallet&#160;has&#160;a&#160;password&#160;for.&#160;Such&#160;wallet&#160;approaches&#160;neither&#160;provide&#160;<br/>Isolation&#160;nor&#160;a&#160;Trusted&#160;Path,&#160;though.&#160;<br/>The&#160;Web&#160;Wallet&#160;<a href="file:///swallet/final/latex/main/main.html#WebWallet">[70]</a>&#160;separates&#160;the&#160;input&#160;of&#160;credentials&#160;and&#160;the&#160;usage&#160;of&#160;a&#160;web&#160;site&#160;by&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft187">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft187">18/109</p>
</div>
<!-- Page 19 -->
<a name="19"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1927{font-size:15px;font-family:GAAAAA+DejaVuSerif;color:#000000;}
-->
</style>
<div id="page19-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application019.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft1912">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft190">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft194">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft194">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft1915">locking&#160;the&#160;HTML&#160;forms&#160;requiring&#160;credentials.&#160;After&#160;the&#160;user&#160;presses&#160;a&#160;predefined&#160;<br/>security&#160;key,&#160;the&#160;Web&#160;Wallet&#160;verifies&#160;the&#160;security&#160;properties&#160;of&#160;the&#160;target&#160;web&#160;site&#160;<br/>and&#160;displays&#160;a&#160;dialog&#160;to&#160;the&#160;user&#160;where&#160;she&#160;has&#160;to&#160;explicitly&#160;choose&#160;the&#160;destination&#160;<br/>site&#160;&#160;&#160;the&#160;&#160;&#160;credentials&#160;&#160;&#160;should&#160;&#160;&#160;be&#160;&#160;&#160;sent&#160;&#160;&#160;to,&#160;&#160;&#160;instead&#160;&#160;&#160;of&#160;&#160;&#160;displaying&#160;&#160;&#160;simple&#160;&#160;&#160;confirmation&#160;<br/>dialogs.&#160;The&#160;user&#160;can&#160;choose&#160;from&#160;a&#160;list&#160;of&#160;web&#160;sites&#160;previously&#160;stored&#160;by&#160;the&#160;wallet.&#160;<br/>While&#160;this&#160;is&#160;quite&#160;effective&#160;in&#160;countering&#160;classical&#160;phishing&#160;attacks,&#160;no&#160;protection&#160;<br/>against&#160;malware&#160;attacks&#160;is&#160;provided.&#160;<br/>Yee&#160;and&#160;Sitaker&#160;proposed&#160;the&#160;PassPet&#160;browser&#160;extension&#160;<a href="file:///swallet/final/latex/main/main.html#passpet">[72]</a>&#160;which&#160;addresses&#160;the&#160;<br/>issue&#160;of&#160;re-used&#160;passwords&#160;across&#160;multiple&#160;different&#160;web&#160;sites.&#160;It&#160;lets&#160;the&#160;user&#160;assign&#160;<br/>a&#160;&#160;</p>
<p style="position:absolute;top:333px;left:102px;white-space:nowrap" class="ft1920"><i>pet&#160;name</i></p>
<p style="position:absolute;top:333px;left:182px;white-space:nowrap" class="ft1914">&#160;&#160;for&#160;each&#160;of&#160;her&#160;used&#160;sites&#160;and&#160;generates&#160;a&#160;new&#160;password&#160;incorporating&#160;</p>
<p style="position:absolute;top:352px;left:85px;white-space:nowrap" class="ft1915">the&#160;domain&#160;name.&#160;When&#160;the&#160;user&#160;wants&#160;to&#160;log&#160;into&#160;one&#160;of&#160;her&#160;sites,&#160;she&#160;enters&#160;the&#160;pet&#160;<br/>name&#160;into&#160;the&#160;extension&#160;and&#160;it&#160;copies&#160;her&#160;password&#160;into&#160;the&#160;designated&#160;password&#160;<br/>fields.&#160;Similar&#160;to&#160;other&#160;password&#160;manager&#160;solutions,&#160;this&#160;is&#160;effective&#160;against&#160;classical&#160;<br/>phishing&#160;but&#160;lacks&#160;resistance&#160;to&#160;certain&#160;kinds&#160;of&#160;malware&#160;attacks.&#160;</p>
<p style="position:absolute;top:456px;left:85px;white-space:nowrap" class="ft196"><b>Platforms&#160;&amp;&#160;Operating&#160;Systems&#160;</b></p>
<p style="position:absolute;top:500px;left:85px;white-space:nowrap" class="ft1927"><i>Virtualisation&#160;</i></p>
<p style="position:absolute;top:527px;left:85px;white-space:nowrap" class="ft1915">To&#160;prevent&#160;malware&#160;attacks,&#160;a&#160;secure&#160;operating&#160;system&#160;is&#160;vital,&#160;and&#160;for&#160;the&#160;solution&#160;<br/>proposed&#160;in&#160;this&#160;deliverable,&#160;virtualisation&#160;is&#160;an&#160;important&#160;building&#160;block.&#160;Because&#160;of&#160;<br/>the&#160;abundance&#160;of&#160;literature&#160;on&#160;this&#160;topic,&#160;we&#160;do&#160;not&#160;provide&#160;a&#160;review&#160;of&#160;recent&#160;work&#160;<br/>here,&#160;but&#160;refer&#160;the&#160;reader&#160;to&#160;previous&#160;work,&#160;such&#160;as&#160;[33,46,57].<br/>Cox&#160;&#160;et&#160;&#160;al.&#160;<a href="file:///swallet/final/latex/main/main.html#tahoma">[24]</a>&#160;&#160;introduced&#160;&#160;the&#160;Tahoma&#160;&#160;Web&#160;&#160;browsing&#160;system&#160;which&#160;&#160;added&#160;&#160;a&#160;new&#160;<br/>separate&#160;&#160;&#160;trusted&#160;&#160;&#160;software&#160;&#160;&#160;layer&#160;&#160;&#160;called&#160;&#160;&#160;browser&#160;&#160;&#160;operating&#160;&#160;&#160;system&#160;&#160;&#160;(BOS)&#160;&#160;&#160;on&#160;&#160;&#160;which&#160;<br/>browsers&#160;&#160;&#160;execute.&#160;&#160;&#160;They&#160;&#160;&#160;separated&#160;&#160;&#160;several&#160;&#160;&#160;browser&#160;&#160;&#160;instances&#160;&#160;&#160;running&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;&#160;&#160;Xen&#160;<br/>virtual&#160;machine&#160;monitor&#160;<a href="file:///swallet/final/latex/main/main.html#xen">[18]</a>,&#160;thereby&#160;isolating&#160;different&#160;web&#160;applications&#160;from&#160;each&#160;<br/>other.&#160;While&#160;this&#160;approach&#160;proved&#160;to&#160;counter&#160;87%&#160;of&#160;the&#160;browser&#160;flaws&#160;and&#160;malware&#160;<br/>attacks&#160;presented&#160;in&#160;their&#160;paper,&#160;no&#160;protection&#160;against&#160;classical&#160;phishing&#160;is&#160;available.&#160;<br/>This&#160;is&#160;due&#160;to&#160;the&#160;fact&#160;that&#160;Tahoma&#160;can&#160;only&#160;provide&#160;an&#160;isolated&#160;browser&#160;instance&#160;<br/>when&#160;the&#160;user&#160;enters&#160;a&#160;phishing&#160;site&#160;but&#160;does&#160;not&#160;prevent&#160;her&#160;from&#160;actually&#160;entering&#160;<br/>her&#160;&#160;&#160;credentials.&#160;&#160;&#160;Moreover,&#160;&#160;&#160;offline&#160;&#160;&#160;modification&#160;&#160;&#160;of&#160;&#160;&#160;critical&#160;&#160;&#160;system&#160;&#160;&#160;components&#160;&#160;&#160;is&#160;<br/>possible.&#160;Thus,&#160;malware&#160;attacks&#160;targeting&#160;the&#160;BOS&#160;itself&#160;are&#160;still&#160;feasible.&#160;<br/>While&#160;&#160;&#160;not&#160;&#160;&#160;exactly&#160;&#160;&#160;related&#160;&#160;&#160;to&#160;&#160;&#160;protection&#160;&#160;&#160;of&#160;&#160;&#160;credentials,&#160;&#160;&#160;the&#160;&#160;&#160;SpyBlock&#160;<a href="file:///swallet/final/latex/main/main.html#TransGen">[40]&#160;</a>&#160;&#160;browser&#160;<br/>extension&#160;employs&#160;a&#160;similar&#160;approach&#160;by&#160;using&#160;VMWare&#160;to&#160;set&#160;up&#160;a&#160;virtual&#160;machine&#160;<br/>running&#160;an&#160;isolated&#160;web&#160;browser.&#160;While&#160;this&#160;defends&#160;against&#160;certain&#160;malware&#160;attacks,&#160;<br/>it&#160;&#160;&#160;suffers&#160;&#160;&#160;from&#160;&#160;&#160;the&#160;&#160;&#160;same&#160;&#160;&#160;problem&#160;&#160;&#160;as&#160;&#160;&#160;Tahoma,&#160;&#160;&#160;i.e.&#160;&#160;&#160;no&#160;&#160;&#160;protection&#160;&#160;&#160;against&#160;&#160;&#160;classical&#160;<br/>phishing&#160;attacks&#160;is&#160;provided.&#160;</p>
<p style="position:absolute;top:937px;left:85px;white-space:nowrap" class="ft1927"><i>Secure&#160;User&#160;Interfaces&#160;</i></p>
<p style="position:absolute;top:963px;left:85px;white-space:nowrap" class="ft1915">The&#160;&#160;&#160;security&#160;&#160;&#160;of&#160;&#160;&#160;user&#160;&#160;&#160;interfaces&#160;&#160;&#160;was&#160;&#160;&#160;examined&#160;&#160;&#160;by&#160;&#160;&#160;several&#160;&#160;&#160;papers.&#160;&#160;&#160;Epstein&#160;&#160;&#160;et&#160;&#160;&#160;al.&#160;<br/>introduced&#160;the&#160;Trusted&#160;X&#160;system&#160;<a href="file:///swallet/final/latex/main/main.html#trustedx">[27]</a>&#160;which&#160;aimed&#160;to&#160;replace&#160;the&#160;X&#160;windows&#160;system&#160;<br/>found&#160;on&#160;UNIX&#160;systems&#160;with&#160;a&#160;security-enhanced&#160;version.&#160;In&#160;the&#160;course&#160;of&#160;creating&#160;<br/>the&#160;&#160;&#160;EROS&#160;&#160;&#160;operating&#160;&#160;&#160;system,&#160;&#160;&#160;a&#160;&#160;&#160;secure&#160;&#160;&#160;GUI&#160;&#160;&#160;called&#160;&#160;&#160;EROS&#160;&#160;&#160;Trusted&#160;&#160;&#160;Window&#160;&#160;&#160;System&#160;<br/>(EWS)&#160;&#160;&#160;was&#160;&#160;&#160;also&#160;&#160;&#160;developed&#160;<a href="file:///swallet/final/latex/main/main.html#ews">[58]</a>.&#160;&#160;&#160;A&#160;&#160;&#160;minimum-complexity&#160;&#160;&#160;secure&#160;&#160;&#160;user&#160;&#160;&#160;interface&#160;&#160;&#160;was&#160;<br/>introduced&#160;&#160;&#160;with&#160;&#160;&#160;Nitpicker&#160;<a href="file:///swallet/final/latex/main/main.html#nitpicker">[29]</a>,&#160;&#160;&#160;which&#160;&#160;&#160;is&#160;&#160;&#160;an&#160;&#160;&#160;implementation&#160;&#160;&#160;based&#160;&#160;&#160;on&#160;&#160;&#160;an&#160;&#160;&#160;L4-<br/>microkernel&#160;[5]&#160;that&#160;adds&#160;floating&#160;labels&#160;to&#160;active&#160;views&#160;while&#160;dimming&#160;out&#160;inactive&#160;<br/>views.&#160;This&#160;allows&#160;users&#160;to&#160;authenticate&#160;the&#160;application&#160;they&#160;are&#160;currently&#160;using.&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft197">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft197">19/109</p>
</div>
<!-- Page 20 -->
<a name="20"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page20-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application020.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2012">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft200">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft204">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft204">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft2027"><i>Trusted&#160;Computing</i></p>
<p style="position:absolute;top:151px;left:233px;white-space:nowrap" class="ft204">&#160;</p>
<p style="position:absolute;top:178px;left:85px;white-space:nowrap" class="ft2015">Other&#160;&#160;&#160;more&#160;&#160;&#160;general&#160;&#160;&#160;work&#160;&#160;&#160;on&#160;&#160;&#160;preventing&#160;&#160;&#160;malware&#160;&#160;&#160;attacks&#160;&#160;&#160;focuses&#160;&#160;&#160;on&#160;&#160;&#160;integrity&#160;<br/>preservation&#160;&#160;&#160;and&#160;&#160;&#160;verification.&#160;&#160;&#160;The&#160;&#160;&#160;authors&#160;&#160;&#160;of&#160;&#160;&#160;<a href="file:///swallet/final/latex/main/main.html#aegis">[16]&#160;</a>&#160;&#160;construct&#160;&#160;&#160;a&#160;&#160;&#160;chain&#160;&#160;&#160;of&#160;&#160;&#160;integrity&#160;<br/>checks&#160;during&#160;the&#160;bootstrap&#160;process&#160;in&#160;an&#160;attempt&#160;to&#160;provide&#160;a&#160;&#160;</p>
<p style="position:absolute;top:216px;left:646px;white-space:nowrap" class="ft2020"><i>Secure&#160;Boot</i></p>
<p style="position:absolute;top:216px;left:751px;white-space:nowrap" class="ft2014">.&#160;Their&#160;</p>
<p style="position:absolute;top:235px;left:85px;white-space:nowrap" class="ft2015">AEGIS&#160;&#160;&#160;system&#160;&#160;&#160;compares&#160;&#160;&#160;computed&#160;&#160;&#160;cryptographic&#160;&#160;&#160;hash&#160;&#160;&#160;values&#160;&#160;&#160;with&#160;&#160;&#160;stored&#160;&#160;&#160;digital&#160;<br/>signatures&#160;previously&#160;associated&#160;with&#160;each&#160;bootstrap&#160;component&#160;utilizing&#160;a&#160;special&#160;<br/>hardware&#160;component&#160;for&#160;reference.&#160;An&#160;implementation&#160;of&#160;this&#160;approach&#160;using&#160;a&#160;TPM&#160;<br/>was&#160;shown&#160;in&#160;<a href="file:///swallet/final/latex/main/main.html#tcpa">[48]</a>.&#160;<br/>A&#160;similar&#160;attempt&#160;in&#160;secure&#160;booting&#160;was&#160;realized&#160;with&#160;TrustedGRUB&#160;<a href="file:///swallet/final/latex/main/main.html#trustedgrub">[10]</a>,&#160;which&#160;is&#160;an&#160;<br/>extension&#160;of&#160;the&#160;GNU&#160;GRUB&#160;bootloader.&#160;It&#160;allows&#160;detection&#160;of&#160;available&#160;TPMs&#160;and&#160;<br/>measurement&#160;of&#160;arbitrary&#160;files&#160;during&#160;the&#160;boot&#160;process.&#160;<br/>In&#160;<a href="file:///swallet/final/latex/main/main.html#ima">[56]&#160;</a>&#160;&#160;an&#160;&#160;&#160;integrity&#160;&#160;&#160;measurement&#160;&#160;&#160;system&#160;&#160;&#160;for&#160;&#160;&#160;Linux&#160;&#160;&#160;is&#160;&#160;&#160;presented.&#160;&#160;&#160;The&#160;&#160;&#160;system&#160;<br/>measures&#160;all&#160;executable&#160;content&#160;that&#160;is&#160;loaded&#160;into&#160;the&#160;Linux&#160;system&#160;and&#160;protects&#160;<br/>those&#160;measurements&#160;using&#160;a&#160;TPM.&#160;The&#160;loaded&#160;software&#160;stack&#160;can&#160;be&#160;proved&#160;to&#160;a&#160;third&#160;<br/>party&#160;by&#160;using&#160;the&#160;TCG&#160;&#160;attestation&#160;mechanisms.&#160;</p>
<p style="position:absolute;top:491px;left:85px;white-space:nowrap" class="ft206"><b>2.3.2&#160;Server-based&#160;Phishing&#160;Countermeasures&#160;</b></p>
<p style="position:absolute;top:518px;left:85px;white-space:nowrap" class="ft2015">Several&#160;server-based&#160;countermeasures&#160;attempt&#160;to&#160;extend&#160;the&#160;SSL&#160;protocol&#160;in&#160;order&#160;to&#160;<br/>effectively&#160;thwart&#160;man-in-the-middle&#160;attacks&#160;<a href="file:///swallet/final/latex/main/main.html#ssl-mitm">[21]</a>.&#160;For&#160;such&#160;attacks,&#160;the&#160;man-in-the-<br/>middle&#160;creates&#160;two&#160;SSL&#160;connections,&#160;one&#160;with&#160;the&#160;server&#160;and&#160;one&#160;with&#160;the&#160;client.&#160;To&#160;<br/>prevent&#160;such&#160;attacks,&#160;the&#160;authors&#160;of&#160;<a href="file:///swallet/final/latex/main/main.html#tls-password">[60]</a>&#160;propose&#160;a&#160;password-based&#160;extension,&#160;while&#160;<br/><a href="file:///swallet/final/latex/main/main.html#phoolproof">[52]</a>&#160;utilizes&#160;trusted&#160;mobile&#160;devices&#160;for&#160;automatic&#160;verification&#160;of&#160;web&#160;sites&#160;instead&#160;of&#160;<br/>using&#160;the&#160;web&#160;browser&#160;for&#160;that&#160;task.&#160;By&#160;linking&#160;passwords&#160;to&#160;SSL&#160;sessions,&#160;Oppliger&#160;<br/>et&#160;&#160;&#160;al.&#160;&#160;&#160;<a href="file:///swallet/final/latex/main/main.html#ssl-aware">[51]&#160;</a>&#160;&#160;successfully&#160;&#160;&#160;counter&#160;&#160;&#160;man-in-the-middle&#160;&#160;&#160;attacks&#160;&#160;&#160;since&#160;&#160;&#160;passwords&#160;&#160;&#160;now&#160;<br/>contain&#160;information&#160;about&#160;the&#160;parties&#160;involved&#160;in&#160;the&#160;communication.&#160;<br/>While&#160;&#160;&#160;these&#160;&#160;&#160;approaches&#160;&#160;&#160;are&#160;&#160;&#160;effective&#160;&#160;&#160;to&#160;&#160;&#160;counter&#160;&#160;&#160;classical&#160;&#160;&#160;phishing&#160;&#160;&#160;attacks,&#160;&#160;&#160;they&#160;<br/>provide&#160;no&#160;mechanisms&#160;for&#160;countering&#160;malware&#160;phishing&#160;attacks,&#160;since&#160;malware&#160;on&#160;<br/>the&#160;user's&#160;system&#160;can&#160;still&#160;modify&#160;the&#160;communication.&#160;<br/>A&#160;rather&#160;different&#160;anti-phishing&#160;approach&#160;was&#160;proposed&#160;by&#160;Birk&#160;et&#160;al.&#160;In&#160;their&#160;work&#160;<br/>the&#160;authors&#160;fill&#160;collection&#160;servers&#160;of&#160;phishers&#160;with&#160;fingerprinted&#160;credentials&#160;and&#160;lure&#160;<br/>them&#160;&#160;to&#160;&#160;virtual&#160;&#160;accounts.&#160;&#160;As&#160;&#160;a&#160;&#160;result,&#160;&#160;&#160;they&#160;&#160;&#160;attempt&#160;&#160;&#160;to&#160;&#160;profile&#160;&#160;&#160;phishers&#160;&#160;to&#160;&#160;prevent&#160;<br/>future&#160;&#160;&#160;misuse&#160;&#160;&#160;of&#160;&#160;&#160;stolen&#160;&#160;&#160;credentials.&#160;&#160;&#160;Since&#160;&#160;&#160;this&#160;&#160;&#160;approach&#160;&#160;&#160;does&#160;&#160;&#160;nothing&#160;&#160;&#160;to&#160;&#160;&#160;prevent&#160;<br/>current&#160;phishing&#160;attacks,&#160;it&#160;can&#160;be&#160;rather&#160;classified&#160;as&#160;a&#160;supporting&#160;measure&#160;<a href="file:///swallet/final/latex/main/main.html#honeypot">[20]</a>.&#160;</p>
<p style="position:absolute;top:870px;left:85px;white-space:nowrap" class="ft206"><b>2.3.3&#160;Proxy&#160;Components&#160;</b></p>
<p style="position:absolute;top:897px;left:85px;white-space:nowrap" class="ft2015">In&#160;1997,&#160;Gabber&#160;et&#160;al.&#160;proposed&#160;the&#160;Janus&#160;Personalized&#160;Web&#160;Anonymizer&#160;<a href="file:///swallet/final/latex/main/main.html#janus">[30]</a>&#160;which&#160;<br/>was&#160;an&#160;HTTP&#160;proxy&#160;that&#160;filtered&#160;incoming&#160;and&#160;outgoing&#160;traffic&#160;to&#160;anonymize&#160;the&#160;user.&#160;<br/>It&#160;&#160;&#160;was&#160;&#160;&#160;executed&#160;&#160;&#160;locally&#160;&#160;&#160;and&#160;&#160;&#160;set&#160;&#160;&#160;up&#160;&#160;&#160;as&#160;&#160;&#160;the&#160;&#160;&#160;browser's&#160;&#160;&#160;HTTP&#160;&#160;&#160;proxy.&#160;&#160;&#160;Since&#160;&#160;&#160;the&#160;&#160;&#160;SSL&#160;<br/>protocol&#160;&#160;&#160;had&#160;&#160;not&#160;&#160;&#160;been&#160;&#160;&#160;widely&#160;&#160;&#160;adopted&#160;&#160;yet,&#160;&#160;&#160;it&#160;&#160;&#160;provided&#160;&#160;no&#160;&#160;support&#160;&#160;&#160;for&#160;&#160;&#160;the&#160;&#160;&#160;HTTPS&#160;<br/>protocol.&#160;<br/>The&#160;PwdHash&#160;browser&#160;extension&#160;<a href="file:///swallet/final/latex/main/main.html#pwdhash">[55]</a>&#160;discussed&#160;the&#160;idea&#160;of&#160;an&#160;SSL-capable&#160;proxy&#160;that&#160;<br/>is&#160;able&#160;to&#160;forge&#160;SSL&#160;certificates&#160;on&#160;the&#160;fly&#160;to&#160;enable&#160;inspection&#160;and&#160;filtering&#160;of&#160;SSL-<br/>protected&#160;traffic.&#160;A&#160;related&#160;implementation&#160;approach&#160;is&#160;examined&#160;in&#160;<a href="file:///swallet/final/latex/main/main.html#sslspoof">[15]</a>.&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft207">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft207">20/109</p>
</div>
<!-- Page 21 -->
<a name="21"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page21-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application021.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2112">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft210">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft214">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft214">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft2116"><b>2.4&#160;The&#160;General&#160;Secure&#160;Wallet&#160;Architecture&#160;</b></p>
<p style="position:absolute;top:179px;left:85px;white-space:nowrap" class="ft2115">To&#160;&#160;&#160;prevent&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;from&#160;&#160;&#160;disclosing&#160;&#160;&#160;her&#160;&#160;&#160;credentials&#160;&#160;&#160;to&#160;&#160;&#160;any&#160;&#160;&#160;phishing&#160;&#160;&#160;site,&#160;&#160;&#160;a&#160;&#160;&#160;new&#160;<br/>trusted&#160;component&#160;is&#160;introduced.&#160;This&#160;component,&#160;hence&#160;called&#160;Secure&#160;Wallet,&#160;will&#160;<br/>store&#160;all&#160;of&#160;the&#160;user's&#160;credentials&#160;for&#160;web&#160;sites&#160;and&#160;will&#160;be&#160;used&#160;as&#160;a&#160;proxy&#160;for&#160;the&#160;web&#160;<br/>browser.&#160;</p>
<p style="position:absolute;top:472px;left:666px;white-space:nowrap" class="ft2114">&#160;</p>
<p style="position:absolute;top:494px;left:85px;white-space:nowrap" class="ft2121"><b>Figure&#160;4:</b></p>
<p style="position:absolute;top:494px;left:169px;white-space:nowrap" class="ft2114">&#160;The&#160;Secure&#160;Wallet</p>
<p style="position:absolute;top:541px;left:85px;white-space:nowrap" class="ft2115">The&#160;user&#160;will&#160;utilize&#160;her&#160;web&#160;browser&#160;for&#160;viewing&#160;web&#160;pages&#160;as&#160;before&#160;but&#160;will&#160;enter&#160;<br/>her&#160;passwords&#160;only&#160;into&#160;the&#160;wallet.&#160;In&#160;order&#160;to&#160;access&#160;the&#160;wallet,&#160;she&#160;needs&#160;to&#160;request&#160;<br/>a&#160;secure&#160;input&#160;path&#160;(i.e.&#160;a&#160;</p>
<p style="position:absolute;top:580px;left:306px;white-space:nowrap" class="ft2120"><i>trusted&#160;path</i></p>
<p style="position:absolute;top:580px;left:409px;white-space:nowrap" class="ft2114">)&#160;from&#160;the&#160;system&#160;to&#160;ensure&#160;that&#160;only&#160;the&#160;wallet&#160;</p>
<p style="position:absolute;top:599px;left:85px;white-space:nowrap" class="ft2115">receives&#160;her&#160;password&#160;inputs.&#160;Whenever&#160;she&#160;attempts&#160;to&#160;log&#160;into&#160;a&#160;web&#160;site&#160;with&#160;the&#160;<br/>browser,&#160;the&#160;wallet&#160;will&#160;handle&#160;those&#160;login&#160;operations&#160;automatically&#160;by&#160;modifying&#160;the&#160;<br/>browser's&#160;&#160;requests.&#160;&#160;&#160;Thus,&#160;&#160;&#160;she&#160;&#160;&#160;never&#160;&#160;&#160;needs&#160;&#160;to&#160;&#160;enter&#160;&#160;&#160;passwords&#160;&#160;&#160;into&#160;&#160;the&#160;&#160;&#160;untrusted&#160;<br/>browser&#160;again.&#160;In&#160;fact,&#160;password&#160;fields&#160;in&#160;the&#160;browser&#160;are&#160;locked&#160;to&#160;remind&#160;her&#160;that&#160;<br/>passwords&#160;are&#160;not&#160;to&#160;be&#160;entered&#160;into&#160;the&#160;browser&#160;anymore.&#160;<br/>By&#160;strengthening&#160;the&#160;user's&#160;passwords&#160;with&#160;random&#160;values&#160;and&#160;binding&#160;them&#160;to&#160;the&#160;<br/>domain&#160;&#160;&#160;they&#160;&#160;&#160;belong&#160;&#160;&#160;to,&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;also&#160;&#160;&#160;prevents&#160;&#160;&#160;common&#160;&#160;&#160;password&#160;&#160;&#160;attacks&#160;&#160;&#160;and&#160;<br/>dictionary&#160;&#160;&#160;attacks.&#160;&#160;&#160;Protection&#160;&#160;&#160;against&#160;&#160;&#160;malware&#160;&#160;&#160;attacks&#160;&#160;&#160;is&#160;&#160;&#160;provided&#160;&#160;&#160;by&#160;&#160;&#160;taking&#160;<br/>advantage&#160;&#160;&#160;of&#160;&#160;&#160;trusted&#160;&#160;&#160;computing&#160;&#160;&#160;functionality&#160;&#160;&#160;and&#160;&#160;&#160;strong&#160;&#160;&#160;isolation&#160;&#160;&#160;properties&#160;&#160;&#160;of&#160;&#160;&#160;a&#160;<br/>suitable&#160;system&#160;platform.&#160;</p>
<p style="position:absolute;top:855px;left:85px;white-space:nowrap" class="ft216"><b>2.4.1&#160;Wallet&#160;Behavior&#160;</b></p>
<p style="position:absolute;top:882px;left:85px;white-space:nowrap" class="ft2115">This&#160;&#160;&#160;section&#160;&#160;&#160;describes&#160;&#160;&#160;the&#160;&#160;&#160;general&#160;&#160;&#160;behavior&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;system&#160;&#160;&#160;from&#160;&#160;&#160;a&#160;&#160;&#160;user's&#160;<br/>perspective.&#160;</p>
<p style="position:absolute;top:947px;left:85px;white-space:nowrap" class="ft217">&#160;</p>
<p style="position:absolute;top:947px;left:90px;white-space:nowrap" class="ft216"><b>General&#160;Use&#160;</b></p>
<p style="position:absolute;top:974px;left:85px;white-space:nowrap" class="ft2114">The&#160;user&#160;opens&#160;her&#160;web&#160;browser&#160;and&#160;attempts&#160;to&#160;use&#160;a&#160;web&#160;site&#160;that&#160;requires&#160;a&#160;login.&#160;</p>
<p style="position:absolute;top:1002px;left:117px;white-space:nowrap" class="ft2114">1.&#160;The&#160;user&#160;enters&#160;the&#160;web&#160;page&#160;containing&#160;the&#160;login&#160;form&#160;for&#160;the&#160;web&#160;site.&#160;The&#160;</p>
<p style="position:absolute;top:1021px;left:138px;white-space:nowrap" class="ft2115">login&#160;&#160;&#160;form's&#160;&#160;&#160;password&#160;&#160;&#160;fields&#160;&#160;&#160;are&#160;&#160;&#160;disabled,&#160;&#160;&#160;i.e.&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;can&#160;&#160;&#160;only&#160;&#160;&#160;enter&#160;&#160;&#160;non-<br/>sensitive&#160;values&#160;directly&#160;into&#160;the&#160;browser&#160;(see&#160;also<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#22">&#160;Figure&#160;5)</a>.&#160;</p>
<p style="position:absolute;top:1059px;left:117px;white-space:nowrap" class="ft2114">2.&#160;After&#160;entering&#160;all&#160;required&#160;non-sensitive&#160;values&#160;into&#160;the&#160;login&#160;form,&#160;the&#160;user&#160;</p>
<p style="position:absolute;top:1079px;left:138px;white-space:nowrap" class="ft2114">clicks&#160;on&#160;the&#160;Submit&#160;button.&#160;</p>
<p style="position:absolute;top:1098px;left:117px;white-space:nowrap" class="ft2114">3.&#160;The&#160;browser&#160;receives&#160;the&#160;next&#160;site-specific&#160;web&#160;page&#160;indicating&#160;a&#160;successful&#160;</p>
<p style="position:absolute;top:1117px;left:138px;white-space:nowrap" class="ft2114">login&#160;and&#160;displays&#160;it.&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft217">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft217">21/109</p>
</div>
<!-- Page 22 -->
<a name="22"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page22-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application022.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2212">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft220">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft224">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft224">Final</p>
<p style="position:absolute;top:151px;left:117px;white-space:nowrap" class="ft2214">4.&#160;The&#160;user&#160;can&#160;now&#160;use&#160;the&#160;web&#160;site&#160;as&#160;usual.&#160;</p>
<p style="position:absolute;top:688px;left:678px;white-space:nowrap" class="ft2214">&#160;</p>
<p style="position:absolute;top:710px;left:85px;white-space:nowrap" class="ft2221"><b>Figure&#160;5:</b></p>
<p style="position:absolute;top:710px;left:169px;white-space:nowrap" class="ft2214">&#160;Password&#160;fields&#160;are&#160;disabled&#160;automatically</p>
<p style="position:absolute;top:747px;left:85px;white-space:nowrap" class="ft227">&#160;</p>
<p style="position:absolute;top:747px;left:90px;white-space:nowrap" class="ft226"><b>Web&#160;Site&#160;Setup&#160;</b></p>
<p style="position:absolute;top:773px;left:85px;white-space:nowrap" class="ft2215">To&#160;enable&#160;the&#160;automatic&#160;login&#160;described&#160;above,&#160;the&#160;user&#160;must&#160;set&#160;up&#160;a&#160;web&#160;site&#160;in&#160;the&#160;<br/>wallet.&#160;Setup&#160;for&#160;an&#160;existing&#160;account&#160;occurs&#160;the&#160;first&#160;time&#160;the&#160;user&#160;attempts&#160;to&#160;use&#160;it.&#160;</p>
<p style="position:absolute;top:821px;left:117px;white-space:nowrap" class="ft2214">1.&#160;The&#160;user&#160;enters&#160;a&#160;value&#160;for&#160;each&#160;non-sensitive&#160;field&#160;in&#160;the&#160;login&#160;form&#160;(e.g.&#160;the&#160;</p>
<p style="position:absolute;top:840px;left:138px;white-space:nowrap" class="ft2214">username)&#160;and&#160;clicks&#160;on&#160;the&#160;Submit&#160;button&#160;afterwards.&#160;</p>
<p style="position:absolute;top:859px;left:117px;white-space:nowrap" class="ft2214">2.&#160;The&#160;&#160;&#160;wallet&#160;&#160;&#160;displays&#160;&#160;&#160;a&#160;&#160;&#160;notification&#160;&#160;&#160;message&#160;&#160;&#160;indicating&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;should&#160;</p>
<p style="position:absolute;top:878px;left:138px;white-space:nowrap" class="ft2214">initiate&#160;the&#160;trusted&#160;path&#160;to&#160;the&#160;wallet.&#160;</p>
<p style="position:absolute;top:898px;left:117px;white-space:nowrap" class="ft2214">3.&#160;The&#160;user&#160;initiates&#160;the&#160;trusted&#160;path&#160;to&#160;the&#160;wallet&#160;and&#160;sees&#160;a&#160;dialog&#160;containing&#160;all&#160;</p>
<p style="position:absolute;top:917px;left:138px;white-space:nowrap" class="ft2214">password&#160;fields&#160;of&#160;the&#160;login&#160;form&#160;(s<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#23">ee&#160;Figure&#160;6)</a>.&#160;</p>
<p style="position:absolute;top:936px;left:117px;white-space:nowrap" class="ft2215">4.&#160;The&#160;user&#160;enters&#160;her&#160;credentials&#160;and&#160;clicks&#160;on&#160;the&#160;OK&#160;button&#160;afterwards.&#160;<br/>5.&#160;The&#160;&#160;&#160;wallet&#160;&#160;&#160;displays&#160;&#160;&#160;a&#160;&#160;&#160;security&#160;&#160;&#160;message&#160;&#160;&#160;requesting&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;to&#160;&#160;&#160;initiate&#160;&#160;&#160;the&#160;</p>
<p style="position:absolute;top:974px;left:138px;white-space:nowrap" class="ft2215">password&#160;&#160;&#160;changing&#160;&#160;&#160;process&#160;&#160;&#160;for&#160;&#160;&#160;the&#160;&#160;&#160;web&#160;&#160;&#160;site&#160;&#160;&#160;as&#160;&#160;&#160;soon&#160;&#160;&#160;as&#160;&#160;&#160;she&#160;&#160;&#160;returns&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;<br/>browser.&#160;</p>
<p style="position:absolute;top:1013px;left:117px;white-space:nowrap" class="ft2215">6.&#160;The&#160;user&#160;leaves&#160;the&#160;trusted&#160;path&#160;to&#160;the&#160;wallet&#160;and&#160;returns&#160;to&#160;her&#160;browser.&#160;<br/>7.&#160;The&#160;browser&#160;displays&#160;the&#160;site-specific&#160;web&#160;page&#160;indicating&#160;a&#160;successful&#160;login.&#160;<br/>8.&#160;The&#160;user&#160;changes&#160;her&#160;password&#160;for&#160;the&#160;web&#160;site&#160;(see&#160;below).&#160;<br/>9.&#160;The&#160;user&#160;can&#160;now&#160;use&#160;the&#160;web&#160;site&#160;as&#160;usual&#160;and&#160;any&#160;further&#160;login&#160;attempts&#160;are&#160;</p>
<p style="position:absolute;top:1090px;left:138px;white-space:nowrap" class="ft2214">carried&#160;out&#160;as&#160;described&#160;above.</p>
<p style="position:absolute;top:1118px;left:85px;white-space:nowrap" class="ft2214">Note&#160;that&#160;registering&#160;a&#160;new&#160;account&#160;for&#160;a&#160;web&#160;site&#160;works&#160;in&#160;a&#160;similar&#160;way.&#160;The&#160;user&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft227">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft227">22/109</p>
</div>
<!-- Page 23 -->
<a name="23"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page23-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application023.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2312">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft230">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft234">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft234">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft2315">can&#160;&#160;&#160;set&#160;&#160;&#160;up&#160;&#160;the&#160;&#160;page&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;&#160;wallet&#160;&#160;&#160;whether&#160;&#160;or&#160;&#160;&#160;not&#160;&#160;&#160;the&#160;&#160;registration&#160;&#160;&#160;form&#160;&#160;allows&#160;&#160;to&#160;<br/>choose&#160;the&#160;user&#160;password.&#160;If&#160;the&#160;registration&#160;form&#160;contains&#160;no&#160;password&#160;fields,&#160;some&#160;<br/>providers&#160;pre-generate&#160;the&#160;password&#160;and&#160;send&#160;it&#160;by&#160;email,&#160;i.e.&#160;web&#160;site&#160;setup&#160;occurs&#160;<br/>when&#160;the&#160;user&#160;first&#160;submits&#160;the&#160;login&#160;form&#160;and&#160;proceeds&#160;as&#160;described&#160;above.&#160;The&#160;<br/>setup&#160;process&#160;for&#160;a&#160;registration&#160;form&#160;with&#160;password&#160;fields&#160;is&#160;slightly&#160;different&#160;from&#160;<br/>the&#160;one&#160;shown&#160;above.</p>
<p style="position:absolute;top:599px;left:605px;white-space:nowrap" class="ft2314">&#160;</p>
<p style="position:absolute;top:620px;left:85px;white-space:nowrap" class="ft2321"><b>Figure&#160;6:</b></p>
<p style="position:absolute;top:620px;left:169px;white-space:nowrap" class="ft2314">&#160;Setup&#160;dialog&#160;for&#160;a&#160;web&#160;site</p>
<p style="position:absolute;top:657px;left:85px;white-space:nowrap" class="ft237">&#160;</p>
<p style="position:absolute;top:657px;left:90px;white-space:nowrap" class="ft236"><b>Password&#160;Change&#160;</b></p>
<p style="position:absolute;top:684px;left:85px;white-space:nowrap" class="ft2315">Changing&#160;of&#160;the&#160;user's&#160;password&#160;occurs&#160;in&#160;a&#160;similar&#160;way&#160;to&#160;setting&#160;up&#160;a&#160;web&#160;site&#160;in&#160;<br/>the&#160;wallet.&#160;</p>
<p style="position:absolute;top:731px;left:117px;white-space:nowrap" class="ft2314">1.&#160;The&#160;user&#160;enters&#160;the&#160;web&#160;page&#160;containing&#160;the&#160;form&#160;for&#160;changing&#160;her&#160;password&#160;</p>
<p style="position:absolute;top:750px;left:138px;white-space:nowrap" class="ft2315">for&#160;the&#160;web&#160;site.&#160;The&#160;form's&#160;password&#160;fields&#160;have&#160;been&#160;disabled&#160;just&#160;like&#160;the&#160;<br/>password&#160;fields&#160;in&#160;the&#160;login&#160;form&#160;had&#160;been&#160;before.&#160;</p>
<p style="position:absolute;top:789px;left:117px;white-space:nowrap" class="ft2314">2.&#160;If&#160;any&#160;non-sensitive&#160;values&#160;are&#160;required,&#160;the&#160;user&#160;enters&#160;them&#160;and&#160;then&#160;clicks&#160;</p>
<p style="position:absolute;top:808px;left:138px;white-space:nowrap" class="ft2314">on&#160;the&#160;Submit&#160;button.&#160;</p>
<p style="position:absolute;top:827px;left:117px;white-space:nowrap" class="ft2314">3.&#160;The&#160;wallet&#160;displays&#160;a&#160;notification&#160;message,&#160;indicating&#160;that&#160;she&#160;should&#160;initiate&#160;</p>
<p style="position:absolute;top:846px;left:138px;white-space:nowrap" class="ft2314">the&#160;trusted&#160;path&#160;to&#160;the&#160;wallet.&#160;</p>
<p style="position:absolute;top:866px;left:117px;white-space:nowrap" class="ft2314">4.&#160;The&#160;user&#160;initiates&#160;the&#160;trusted&#160;path&#160;to&#160;the&#160;wallet&#160;and&#160;sees&#160;a&#160;dialog&#160;containing&#160;all&#160;</p>
<p style="position:absolute;top:885px;left:138px;white-space:nowrap" class="ft2315">password&#160;&#160;fields&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;password&#160;&#160;changing&#160;&#160;form.&#160;&#160;A&#160;&#160;password&#160;&#160;changing&#160;&#160;form&#160;<br/>usually&#160;&#160;&#160;contains&#160;&#160;&#160;fields&#160;&#160;&#160;for&#160;&#160;&#160;entering&#160;&#160;&#160;the&#160;&#160;&#160;old&#160;&#160;&#160;password&#160;&#160;&#160;and&#160;&#160;&#160;the&#160;&#160;&#160;new&#160;&#160;&#160;desired&#160;<br/>password.&#160;</p>
<p style="position:absolute;top:942px;left:117px;white-space:nowrap" class="ft2314">5.&#160;For&#160;each&#160;field,&#160;the&#160;user&#160;chooses&#160;between&#160;the&#160;two&#160;options&#160;“Fill&#160;in&#160;old&#160;password”&#160;</p>
<p style="position:absolute;top:962px;left:138px;white-space:nowrap" class="ft2314">and&#160;“Generate&#160;new&#160;password”&#160;without&#160;entering&#160;passwords&#160;herself.&#160;</p>
<p style="position:absolute;top:981px;left:117px;white-space:nowrap" class="ft2314">6.&#160;The&#160;user&#160;clicks&#160;on&#160;the&#160;OK&#160;button,&#160;leaves&#160;the&#160;trusted&#160;path&#160;to&#160;the&#160;wallet&#160;and&#160;</p>
<p style="position:absolute;top:1000px;left:138px;white-space:nowrap" class="ft2314">returns&#160;to&#160;her&#160;browser.&#160;</p>
<p style="position:absolute;top:1046px;left:85px;white-space:nowrap" class="ft237">&#160;</p>
<p style="position:absolute;top:1046px;left:90px;white-space:nowrap" class="ft236"><b>Registration&#160;Forms&#160;</b></p>
<p style="position:absolute;top:1073px;left:85px;white-space:nowrap" class="ft2315">If&#160;&#160;&#160;the&#160;&#160;&#160;registration&#160;&#160;&#160;form&#160;&#160;&#160;contains&#160;&#160;&#160;fields&#160;&#160;&#160;for&#160;&#160;&#160;an&#160;&#160;&#160;initial&#160;&#160;&#160;password&#160;&#160;&#160;choice,&#160;&#160;&#160;the&#160;&#160;&#160;setup&#160;<br/>executes&#160;as&#160;described&#160;above.&#160;But&#160;when&#160;the&#160;user&#160;first&#160;submits&#160;the&#160;login&#160;form&#160;after&#160;<br/>registration,&#160;a&#160;setup&#160;dialog&#160;will&#160;be&#160;displayed&#160;once&#160;again.&#160;This&#160;dialog&#160;works&#160;just&#160;like&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft237">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft237">23/109</p>
</div>
<!-- Page 24 -->
<a name="24"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page24-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application024.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2412">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft240">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft244">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft244">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft2415">the&#160;password&#160;change&#160;dialog,&#160;i.e.&#160;the&#160;user&#160;has&#160;to&#160;choose&#160;whether&#160;to&#160;use&#160;the&#160;stored&#160;<br/>password&#160;for&#160;the&#160;password&#160;field&#160;in&#160;the&#160;login&#160;form&#160;(which&#160;is&#160;the&#160;obvious&#160;choice&#160;in&#160;this&#160;<br/>case)&#160;or&#160;a&#160;newly&#160;generated&#160;password.&#160;After&#160;that,&#160;each&#160;subsequent&#160;login&#160;attempt&#160;will&#160;<br/>execute&#160;as&#160;described&#160;above.</p>
<p style="position:absolute;top:255px;left:85px;white-space:nowrap" class="ft246"><b>2.4.2&#160;Design&#160;and&#160;Architecture&#160;</b></p>
<p style="position:absolute;top:281px;left:85px;white-space:nowrap" class="ft2415">The&#160;design&#160;and&#160;architecture&#160;presented&#160;in&#160;the&#160;following&#160;was&#160;developped&#160;to&#160;address&#160;<br/>the&#160;issues&#160;detailed&#160;in&#160;Section&#160;2.2.&#160;Many&#160;of&#160;the&#160;general&#160;design&#160;decisions&#160;described&#160;in&#160;<br/>this&#160;section&#160;have&#160;already&#160;been&#160;discussed&#160;in&#160;<a href="file:///swallet/final/latex/main/main.html#CompSec">[31]</a>.&#160;The&#160;purpose&#160;of&#160;this&#160;actual&#160;work&#160;was&#160;<br/>to&#160;find&#160;a&#160;concrete&#160;approach&#160;to&#160;implement&#160;the&#160;wallet&#160;as&#160;a&#160;demo&#160;application&#160;while&#160;still&#160;<br/>adding&#160;new&#160;ideas.&#160;In&#160;the&#160;process,&#160;some&#160;original&#160;ideas&#160;were&#160;refined&#160;or&#160;adapted&#160;to&#160;<br/>accommodate&#160;the&#160;actual&#160;implementation.</p>
<p style="position:absolute;top:424px;left:85px;white-space:nowrap" class="ft246"><b>Protection&#160;against&#160;Classical&#160;Phishing&#160;Attacks&#160;</b></p>
<p style="position:absolute;top:450px;left:85px;white-space:nowrap" class="ft2415">This&#160;&#160;&#160;section&#160;&#160;&#160;provides&#160;&#160;&#160;a&#160;&#160;&#160;short&#160;&#160;&#160;overview&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;general&#160;&#160;&#160;design&#160;&#160;&#160;decisions&#160;&#160;&#160;and&#160;&#160;&#160;their&#160;<br/>impact&#160;on&#160;usability.&#160;</p>
<p style="position:absolute;top:515px;left:85px;white-space:nowrap" class="ft2427"><i>Deny&#160;credential&#160;input&#160;into&#160;the&#160;browser&#160;</i></p>
<p style="position:absolute;top:542px;left:85px;white-space:nowrap" class="ft2415">An&#160;ordinary&#160;user&#160;is&#160;susceptible&#160;to&#160;all&#160;kinds&#160;of&#160;classical&#160;phishing&#160;attacks.&#160;For&#160;example,&#160;<br/>a&#160;faked&#160;web&#160;site&#160;could&#160;trick&#160;her&#160;to&#160;enter&#160;her&#160;credentials&#160;for&#160;her&#160;home&#160;bank.&#160;Letting&#160;<br/>the&#160;&#160;&#160;user&#160;&#160;&#160;enter&#160;&#160;&#160;credentials&#160;&#160;&#160;directly&#160;&#160;&#160;into&#160;&#160;&#160;the&#160;&#160;&#160;browser&#160;&#160;&#160;makes&#160;&#160;&#160;it&#160;&#160;&#160;hard&#160;&#160;&#160;to&#160;&#160;&#160;counter&#160;&#160;&#160;all&#160;<br/>various&#160;attacks.&#160;Thus,&#160;the&#160;first&#160;major&#160;design&#160;choice&#160;for&#160;the&#160;wallet&#160;was&#160;to&#160;deny&#160;the&#160;<br/>user&#160;the&#160;ability&#160;to&#160;enter&#160;credentials&#160;directly&#160;into&#160;web&#160;forms.&#160;Instead,&#160;the&#160;user&#160;should&#160;<br/>enter&#160;those&#160;credentials&#160;only&#160;into&#160;the&#160;wallet.&#160;<br/>The&#160;most&#160;efficient&#160;way&#160;of&#160;preventing&#160;the&#160;user&#160;to&#160;enter&#160;credentials&#160;into&#160;the&#160;browser&#160;is&#160;<br/>to&#160;simply&#160;lock&#160;all&#160;web&#160;forms&#160;by&#160;modifying&#160;the&#160;HTML&#160;source&#160;code&#160;and&#160;setting&#160;the&#160;<br/>disabled&#160;&#160;flag&#160;on&#160;all&#160;contained&#160;&#160;&lt;input&#160;type=”password”&gt;&#160;&#160;tags.&#160;The&#160;default&#160;behavior&#160;<br/>for&#160;&#160;&#160;logging&#160;&#160;&#160;into&#160;&#160;&#160;a&#160;&#160;&#160;web&#160;&#160;&#160;site&#160;&#160;&#160;is&#160;&#160;&#160;now&#160;&#160;&#160;equivalent&#160;&#160;&#160;to&#160;&#160;&#160;entering&#160;&#160;&#160;non-sensitive&#160;&#160;&#160;data&#160;&#160;&#160;and&#160;<br/>clicking&#160;on&#160;the&#160;Submit&#160;button,&#160;i.e.&#160;the&#160;user&#160;is&#160;trained&#160;to&#160;just&#160;express&#160;her&#160;intent&#160;of&#160;<br/>logging&#160;in&#160;without&#160;entering&#160;her&#160;password&#160;into&#160;the&#160;browser.&#160;All&#160;further&#160;steps&#160;required&#160;<br/>for&#160;&#160;&#160;logging&#160;&#160;&#160;in&#160;&#160;&#160;are&#160;&#160;&#160;then&#160;&#160;&#160;executed&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;internally.&#160;&#160;&#160;Usually&#160;&#160;&#160;that&#160;&#160;&#160;means&#160;<br/>replacing&#160;the&#160;empty&#160;web&#160;form&#160;variables&#160;for&#160;the&#160;password&#160;with&#160;the&#160;previously&#160;stored&#160;<br/>user&#160;credentials&#160;and&#160;forwarding&#160;the&#160;modified&#160;login&#160;request&#160;to&#160;the&#160;web&#160;server.&#160;Note&#160;<br/>that&#160;locking&#160;the&#160;password&#160;fields&#160;alone&#160;does&#160;not&#160;provide&#160;sufficient&#160;security&#160;since&#160;that&#160;<br/>mechanism&#160;can&#160;be&#160;countered&#160;quite&#160;easily.&#160;The&#160;next&#160;section&#160;discusses&#160;this&#160;attack&#160;more&#160;<br/>detailed.&#160;<br/>To&#160;allow&#160;the&#160;wallet&#160;access&#160;to&#160;received&#160;web&#160;pages,&#160;it&#160;needs&#160;to&#160;be&#160;able&#160;to&#160;read&#160;and&#160;<br/>modify&#160;the&#160;communication&#160;between&#160;the&#160;browser&#160;and&#160;the&#160;remote&#160;web&#160;server.&#160;Thus,&#160;<br/>the&#160;wallet&#160;is&#160;realized&#160;as&#160;a&#160;web&#160;proxy&#160;and&#160;set&#160;up&#160;as&#160;the&#160;browser's&#160;HTTP&#160;and&#160;HTTPS&#160;<br/>proxy.&#160;To&#160;free&#160;the&#160;user&#160;of&#160;the&#160;burden&#160;to&#160;verify&#160;the&#160;browser's&#160;security&#160;indicators&#160;of&#160;<br/>web&#160;pages,&#160;the&#160;wallet&#160;will&#160;also&#160;verify&#160;those&#160;indicators&#160;automatically,&#160;e.g.&#160;by&#160;verifying&#160;<br/>the&#160;remote&#160;server's&#160;SSL&#160;certificate&#160;and&#160;rejecting&#160;invalid&#160;connections.&#160;Furthermore,&#160;<br/>the&#160;wallet&#160;will&#160;issue&#160;a&#160;warning&#160;when&#160;the&#160;user&#160;attempts&#160;to&#160;set&#160;up&#160;credentials&#160;for&#160;a&#160;site&#160;<br/>unprotected&#160;by&#160;SSL&#160;since&#160;those&#160;credentials&#160;could&#160;be&#160;stolen&#160;by&#160;an&#160;eavesdropper.&#160;<br/>Whenever&#160;the&#160;user&#160;clicks&#160;on&#160;the&#160;Submit&#160;button&#160;of&#160;a&#160;locked&#160;login&#160;form&#160;for&#160;a&#160;web&#160;site&#160;<br/>that&#160;has&#160;not&#160;been&#160;set&#160;up&#160;in&#160;the&#160;wallet&#160;yet,&#160;the&#160;user&#160;has&#160;to&#160;enter&#160;her&#160;credentials&#160;into&#160;<br/>the&#160;wallet.&#160;Data&#160;fields&#160;required&#160;for&#160;a&#160;successful&#160;login&#160;are&#160;extracted&#160;from&#160;the&#160;submit&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft247">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft247">24/109</p>
</div>
<!-- Page 25 -->
<a name="25"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page25-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application025.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2512">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft250">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft254">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft254">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft2515">request&#160;and&#160;compared&#160;to&#160;previously&#160;encountered&#160;login&#160;forms,&#160;i.e.&#160;the&#160;user&#160;enters&#160;a&#160;<br/>value&#160;&#160;&#160;for&#160;&#160;&#160;all&#160;&#160;&#160;fields&#160;&#160;of&#160;&#160;the&#160;&#160;&#160;login&#160;&#160;&#160;form.&#160;&#160;This&#160;&#160;is&#160;&#160;the&#160;&#160;only&#160;&#160;&#160;time&#160;&#160;&#160;when&#160;&#160;&#160;the&#160;&#160;user&#160;&#160;&#160;should&#160;<br/>actually&#160;type&#160;in&#160;her&#160;password.&#160;After&#160;the&#160;site&#160;has&#160;been&#160;set&#160;up,&#160;the&#160;password&#160;should&#160;not&#160;<br/>have&#160;to&#160;be&#160;entered&#160;again.&#160;</p>
<p style="position:absolute;top:255px;left:85px;white-space:nowrap" class="ft2527"><i>Change&#160;the&#160;user's&#160;passwords&#160;</i></p>
<p style="position:absolute;top:281px;left:85px;white-space:nowrap" class="ft2515">Locking&#160;&#160;&#160;the&#160;&#160;&#160;login&#160;&#160;&#160;forms&#160;&#160;&#160;is&#160;&#160;&#160;just&#160;&#160;&#160;a&#160;&#160;&#160;visual&#160;&#160;&#160;support&#160;&#160;&#160;mechanism&#160;&#160;&#160;and&#160;&#160;&#160;not&#160;&#160;&#160;foolproof&#160;&#160;&#160;to&#160;<br/>prevent&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;from&#160;&#160;&#160;entering&#160;&#160;&#160;credentials.&#160;&#160;&#160;An&#160;&#160;&#160;adversary&#160;&#160;&#160;could&#160;&#160;&#160;embed&#160;&#160;JavaScript&#160;<br/>code&#160;into&#160;his&#160;fake&#160;site&#160;that&#160;automatically&#160;unlocks&#160;all&#160;locked&#160;forms.&#160;Or&#160;the&#160;user&#160;could&#160;<br/>be&#160;&#160;&#160;tricked&#160;&#160;&#160;by&#160;&#160;&#160;cleverly&#160;&#160;&#160;designed&#160;&#160;&#160;malware&#160;&#160;&#160;to&#160;&#160;&#160;enter&#160;&#160;&#160;her&#160;&#160;&#160;credentials&#160;&#160;&#160;into&#160;&#160;&#160;other&#160;<br/>applications&#160;&#160;than&#160;the&#160;&#160;browser&#160;&#160;or&#160;the&#160;&#160;wallet&#160;&#160;(also&#160;&#160;confer&#160;to&#160;the&#160;&#160;next&#160;section&#160;&#160;for&#160;a&#160;<br/>discussion&#160;of&#160;malware&#160;protection).&#160;The&#160;paradigm&#160;that&#160;users&#160;should&#160;not&#160;know&#160;their&#160;<br/>own&#160;passwords&#160;prevents&#160;such&#160;attacks&#160;to&#160;succeed.&#160;Furthermore,&#160;users&#160;tend&#160;to&#160;re-use&#160;<br/>passwords&#160;&#160;&#160;for&#160;&#160;&#160;several&#160;&#160;&#160;(or&#160;&#160;&#160;even&#160;&#160;&#160;all)&#160;&#160;&#160;web&#160;&#160;&#160;sites&#160;&#160;&#160;because&#160;&#160;&#160;it&#160;&#160;&#160;is&#160;&#160;&#160;tedious&#160;&#160;&#160;or&#160;&#160;&#160;even&#160;<br/>unmanageable&#160;&#160;&#160;to&#160;&#160;memorize&#160;&#160;&#160;a&#160;&#160;&#160;new&#160;&#160;&#160;password&#160;&#160;for&#160;&#160;&#160;each&#160;&#160;&#160;new&#160;&#160;&#160;site&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;registers&#160;<br/>with.&#160;&#160;&#160;This&#160;&#160;way&#160;&#160;&#160;an&#160;&#160;&#160;adversary&#160;&#160;&#160;could&#160;&#160;gain&#160;&#160;&#160;access&#160;&#160;to&#160;&#160;&#160;a&#160;&#160;whole&#160;&#160;&#160;range&#160;&#160;&#160;of&#160;&#160;&#160;web&#160;&#160;&#160;sites&#160;&#160;by&#160;<br/>phishing&#160;the&#160;password&#160;of&#160;just&#160;one&#160;site&#160;(i.e.&#160;a&#160;</p>
<p style="position:absolute;top:473px;left:475px;white-space:nowrap" class="ft2520"><i>common&#160;password&#160;attack</i></p>
<p style="position:absolute;top:473px;left:692px;white-space:nowrap" class="ft2514">).&#160;In&#160;practice,&#160;</p>
<p style="position:absolute;top:493px;left:85px;white-space:nowrap" class="ft2515">those&#160;passwords&#160;also&#160;tend&#160;to&#160;be&#160;quite&#160;weak,&#160;mostly&#160;consisting&#160;of&#160;common&#160;words&#160;or&#160;<br/>phrases,&#160;which&#160;makes&#160;them&#160;susceptible&#160;to&#160;dictionary&#160;attacks.&#160;<br/>Thus,&#160;&#160;&#160;the&#160;&#160;&#160;second&#160;&#160;&#160;major&#160;&#160;&#160;design&#160;&#160;&#160;choice&#160;&#160;&#160;for&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;was&#160;&#160;&#160;to&#160;&#160;&#160;replace&#160;&#160;&#160;the&#160;&#160;&#160;user's&#160;<br/>passwords&#160;with&#160;new&#160;passwords&#160;that&#160;are,&#160;on&#160;the&#160;one&#160;hand,&#160;unique&#160;to&#160;each&#160;web&#160;site&#160;<br/>and,&#160;on&#160;the&#160;other&#160;hand,&#160;stronger&#160;than&#160;the&#160;usual&#160;user&#160;passwords.&#160;While&#160;changing&#160;the&#160;<br/>passwords&#160;&#160;&#160;automatically&#160;&#160;&#160;(as&#160;&#160;&#160;proposed&#160;&#160;&#160;in&#160;<a href="file:///swallet/final/latex/main/main.html#CompSec">[31]</a>)&#160;&#160;&#160;would&#160;&#160;&#160;be&#160;&#160;&#160;desirable&#160;&#160;&#160;from&#160;&#160;&#160;a&#160;&#160;&#160;security&#160;<br/>perspective&#160;(this&#160;way&#160;the&#160;user&#160;could&#160;not&#160;omit&#160;the&#160;password&#160;changing&#160;process),&#160;this&#160;<br/>approach&#160;fails&#160;due&#160;to&#160;the&#160;diversity&#160;of&#160;web&#160;site&#160;structures&#160;and&#160;technologies.&#160;<br/>In&#160;&#160;&#160;practice,&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;has&#160;&#160;&#160;to&#160;&#160;&#160;initiate&#160;&#160;&#160;the&#160;&#160;&#160;password&#160;&#160;&#160;changing&#160;&#160;&#160;process&#160;&#160;&#160;herself.&#160;<br/>Consequently,&#160;the&#160;user&#160;could&#160;decide&#160;not&#160;to&#160;change&#160;her&#160;password&#160;but&#160;let&#160;the&#160;wallet&#160;<br/>only&#160;handle&#160;her&#160;known&#160;password.&#160;A&#160;common&#160;reason&#160;could&#160;be&#160;the&#160;inability&#160;to&#160;perform&#160;<br/>a&#160;&#160;&#160;login&#160;&#160;&#160;from&#160;&#160;&#160;other&#160;&#160;&#160;computers&#160;&#160;&#160;without&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;(at&#160;&#160;&#160;least&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;&#160;&#160;current&#160;<br/>implementation).&#160;&#160;&#160;Secure&#160;&#160;&#160;migration&#160;&#160;&#160;of&#160;&#160;&#160;wallet&#160;&#160;&#160;data&#160;&#160;&#160;could&#160;&#160;&#160;improve&#160;&#160;&#160;this&#160;&#160;&#160;situation,&#160;<br/>however,&#160;even&#160;in&#160;this&#160;case,&#160;a&#160;secure&#160;wallet&#160;is&#160;needed&#160;on&#160;all&#160;platforms&#160;from&#160;which&#160;the&#160;<br/>user&#160;wants&#160;to&#160;log&#160;in.&#160;While&#160;user-initiated&#160;password&#160;change&#160;is&#160;conceptually&#160;less&#160;secure&#160;<br/>than&#160;letting&#160;the&#160;wallet&#160;change&#160;the&#160;passwords,&#160;the&#160;wallet&#160;still&#160;provides&#160;a&#160;great&#160;deal&#160;of&#160;<br/>protection&#160;against&#160;a&#160;wide&#160;range&#160;of&#160;attacks&#160;(also&#160;see&#160;the&#160;security&#160;analysis&#160;below).&#160;It&#160;<br/>should&#160;be&#160;possible&#160;to&#160;enforce&#160;the&#160;decision&#160;to&#160;let&#160;the&#160;wallet&#160;change&#160;the&#160;passwords&#160;by&#160;a&#160;<br/>suitable&#160;user&#160;training,&#160;which&#160;is&#160;a&#160;point&#160;for&#160;future&#160;work,&#160;though.<br/>The&#160;password&#160;changing&#160;process&#160;does&#160;not&#160;require&#160;the&#160;user&#160;to&#160;type&#160;any&#160;passwords&#160;into&#160;<br/>wallet.&#160;The&#160;previously&#160;stored&#160;password&#160;is&#160;already&#160;known&#160;to&#160;the&#160;wallet&#160;and&#160;the&#160;new&#160;<br/>password&#160;is&#160;generated&#160;by&#160;the&#160;wallet&#160;and&#160;should&#160;not&#160;be&#160;known&#160;to&#160;the&#160;user.&#160;Thus,&#160;the&#160;<br/>password&#160;changing&#160;dialog&#160;just&#160;provides&#160;two&#160;options&#160;for&#160;filling&#160;in&#160;the&#160;old&#160;and&#160;the&#160;new&#160;<br/>password&#160;into&#160;the&#160;corresponding&#160;fields&#160;of&#160;the&#160;web&#160;form.&#160;</p>
<p style="position:absolute;top:1007px;left:85px;white-space:nowrap" class="ft257">&#160;</p>
<p style="position:absolute;top:1007px;left:90px;white-space:nowrap" class="ft256"><b>Protection&#160;against&#160;Malware&#160;Phishing&#160;Attacks&#160;</b></p>
<p style="position:absolute;top:1052px;left:85px;white-space:nowrap" class="ft2527"><i>Providing&#160;isolation&#160;</i></p>
<p style="position:absolute;top:1078px;left:85px;white-space:nowrap" class="ft2515">A&#160;conventional&#160;system&#160;model&#160;is&#160;not&#160;sufficient&#160;to&#160;protect&#160;against&#160;malware&#160;phishing&#160;<br/>attacks.&#160;The&#160;wallet&#160;will&#160;use&#160;a&#160;modified&#160;architecture&#160;based&#160;on&#160;a&#160;security&#160;kernel&#160;in&#160;<br/>order&#160;to&#160;protect&#160;itself&#160;against&#160;malware&#160;attacks.&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft257">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft257">25/109</p>
</div>
<!-- Page 26 -->
<a name="26"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page26-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application026.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2612">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft260">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft264">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft264">Final</p>
<p style="position:absolute;top:366px;left:694px;white-space:nowrap" class="ft2614">&#160;</p>
<p style="position:absolute;top:388px;left:85px;white-space:nowrap" class="ft2621"><b>Figure&#160;7:</b></p>
<p style="position:absolute;top:388px;left:169px;white-space:nowrap" class="ft2614">&#160;The&#160;Conventional&#160;System&#160;Model</p>
<p style="position:absolute;top:407px;left:85px;white-space:nowrap" class="ft2615"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#26">Figure&#160;7&#160;</a>shows&#160;the&#160;(simplified)&#160;conventional&#160;system&#160;model&#160;found&#160;in&#160;most&#160;desktop&#160;PCs&#160;<br/>with&#160;&#160;regard&#160;to&#160;internet&#160;&#160;access&#160;through&#160;a&#160;web&#160;browser.&#160;The&#160;user&#160;utilizes&#160;her&#160;web&#160;<br/>browser&#160;to&#160;connect&#160;to&#160;remote&#160;web&#160;servers&#160;and&#160;download&#160;web&#160;pages&#160;which&#160;can&#160;be&#160;<br/>viewed&#160;or&#160;modified&#160;in&#160;the&#160;browser.&#160;Everything&#160;done&#160;inside&#160;the&#160;browser&#160;could&#160;possibly&#160;<br/>affect&#160;&#160;&#160;the&#160;&#160;&#160;user's&#160;&#160;&#160;system,&#160;&#160;&#160;e.g.&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;could&#160;&#160;&#160;download&#160;&#160;&#160;and&#160;&#160;&#160;execute&#160;&#160;&#160;malicious&#160;<br/>applications&#160;&#160;&#160;or&#160;&#160;&#160;active&#160;&#160;&#160;content.&#160;&#160;&#160;Such&#160;&#160;&#160;applications&#160;&#160;&#160;could&#160;&#160;&#160;launch&#160;&#160;&#160;malware&#160;&#160;&#160;phishing&#160;<br/>attacks&#160;against&#160;the&#160;user&#160;and&#160;log&#160;all&#160;her&#160;inputs&#160;to&#160;the&#160;browser&#160;or&#160;modify&#160;the&#160;browser's&#160;<br/>appearance&#160;to&#160;deceive&#160;her.&#160;Whenever&#160;the&#160;user&#160;enters&#160;confidential&#160;information,&#160;such&#160;<br/>malware&#160;could&#160;intercept&#160;it.</p>
<p style="position:absolute;top:1029px;left:779px;white-space:nowrap" class="ft2614">&#160;</p>
<p style="position:absolute;top:1051px;left:85px;white-space:nowrap" class="ft2621"><b>Figure&#160;8:</b></p>
<p style="position:absolute;top:1051px;left:169px;white-space:nowrap" class="ft2614">&#160;The&#160;Secure&#160;Wallet&#160;System&#160;Model</p>
<p style="position:absolute;top:1098px;left:85px;white-space:nowrap" class="ft2615">In&#160;order&#160;to&#160;counter&#160;those&#160;threats&#160;and&#160;achieve&#160;the&#160;security&#160;objectives&#160;described&#160;above,&#160;<br/>a&#160;modified&#160;system&#160;model&#160;will&#160;be&#160;employed&#160;as&#160;shown&#160;in&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#26">&#160;Figure&#160;8.</a>&#160;The&#160;user&#160;PC&#160;in&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft267">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft267">26/109</p>
</div>
<!-- Page 27 -->
<a name="27"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page27-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application027.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2712">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft270">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft274">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft274">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft2714"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#26">Figure&#160;7&#160;</a>corresponds&#160;to&#160;the&#160;red&#160;box&#160;in<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#26">&#160;Figure&#160;8&#160;</a>which&#160;is&#160;marked&#160;as&#160;</p>
<p style="position:absolute;top:151px;left:676px;white-space:nowrap" class="ft2720"><i>Untrusted</i></p>
<p style="position:absolute;top:151px;left:761px;white-space:nowrap" class="ft2714">.&#160;This&#160;</p>
<p style="position:absolute;top:170px;left:85px;white-space:nowrap" class="ft2714">box,&#160;hence&#160;called&#160;&#160;</p>
<p style="position:absolute;top:170px;left:246px;white-space:nowrap" class="ft2720"><i>compartment</i></p>
<p style="position:absolute;top:170px;left:359px;white-space:nowrap" class="ft2714">,&#160;represents&#160;a&#160;separated&#160;part&#160;of&#160;the&#160;user's&#160;system,&#160;</p>
<p style="position:absolute;top:189px;left:85px;white-space:nowrap" class="ft2715">isolated&#160;&#160;&#160;from&#160;&#160;&#160;other&#160;&#160;&#160;such&#160;&#160;&#160;compartments.&#160;&#160;&#160;Inside&#160;&#160;&#160;&#160;&#160;that&#160;&#160;&#160;untrusted&#160;&#160;&#160;compartment,&#160;&#160;&#160;all&#160;<br/>security-uncritical&#160;applications&#160;are&#160;executed,&#160;including&#160;the&#160;web&#160;browser.&#160;Applications&#160;<br/>that&#160;&#160;&#160;have&#160;&#160;&#160;an&#160;&#160;&#160;impact&#160;&#160;&#160;on&#160;&#160;&#160;security&#160;&#160;&#160;will&#160;&#160;&#160;be&#160;&#160;&#160;executed&#160;&#160;&#160;in&#160;&#160;&#160;other&#160;&#160;&#160;isolated,&#160;&#160;</p>
<p style="position:absolute;top:228px;left:748px;white-space:nowrap" class="ft2720"><i>trusted&#160;</i></p>
<p style="position:absolute;top:247px;left:85px;white-space:nowrap" class="ft2715">compartments.&#160;No&#160;malicious&#160;software&#160;executed&#160;in&#160;the&#160;untrusted&#160;compartment&#160;should&#160;<br/>have&#160;any&#160;access&#160;to&#160;security&#160;critical&#160;applications&#160;running&#160;in&#160;other&#160;compartments.&#160;To&#160;<br/>achieve&#160;this,&#160;a&#160;security&#160;kernel&#160;is&#160;used&#160;to&#160;coordinate&#160;access&#160;between&#160;compartments&#160;<br/>and&#160;provide&#160;basic&#160;security&#160;services.<br/>To&#160;prevent&#160;malware&#160;from&#160;gaining&#160;access&#160;to&#160;the&#160;wallet's&#160;data,&#160;i.e.&#160;to&#160;prevent&#160;malware&#160;<br/>phishing&#160;attacks,&#160;it&#160;will&#160;run&#160;in&#160;such&#160;a&#160;trusted&#160;compartment,&#160;thereby&#160;being&#160;completely&#160;<br/>isolated&#160;&#160;&#160;from&#160;&#160;&#160;the&#160;&#160;&#160;untrusted&#160;&#160;&#160;user&#160;&#160;&#160;compartment.&#160;&#160;&#160;In&#160;&#160;&#160;contrast&#160;&#160;&#160;to&#160;&#160;&#160;existing&#160;&#160;&#160;solutions&#160;<br/>implementing&#160;&#160;&#160;a&#160;&#160;&#160;password&#160;&#160;&#160;manager&#160;&#160;&#160;as&#160;&#160;&#160;a&#160;&#160;&#160;browser&#160;&#160;&#160;plugin,&#160;&#160;&#160;this&#160;&#160;&#160;approach&#160;&#160;&#160;restricts&#160;<br/>communication&#160;&#160;&#160;between&#160;&#160;&#160;the&#160;&#160;&#160;browser&#160;&#160;&#160;and&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;to&#160;&#160;&#160;a&#160;&#160;&#160;single&#160;&#160;&#160;communication&#160;<br/>channel&#160;controlled&#160;by&#160;the&#160;security&#160;kernel.&#160;The&#160;wallet&#160;is&#160;set&#160;up&#160;as&#160;the&#160;browser's&#160;proxy&#160;<br/>server&#160;and&#160;effectively&#160;becomes&#160;the&#160;new&#160;communication&#160;endpoint,&#160;i.e.&#160;the&#160;browser&#160;is&#160;<br/>reset&#160;to&#160;its&#160;role&#160;as&#160;a&#160;graphical&#160;user&#160;interface,&#160;while&#160;the&#160;wallet&#160;handles&#160;all&#160;credentials&#160;<br/>and&#160;login&#160;operations.&#160;Thus,&#160;credentials&#160;never&#160;pass&#160;into&#160;or&#160;out&#160;of&#160;the&#160;browser&#160;and&#160;no&#160;<br/>malicious&#160;code&#160;running&#160;in&#160;the&#160;untrusted&#160;compartment&#160;can&#160;intercept&#160;them.&#160;To&#160;prevent&#160;<br/>malicious&#160;code&#160;from&#160;</p>
<p style="position:absolute;top:525px;left:260px;white-space:nowrap" class="ft2720"><i>using</i></p>
<p style="position:absolute;top:525px;left:305px;white-space:nowrap" class="ft2714">&#160;the&#160;user's&#160;credentials,&#160;the&#160;secure&#160;wallet&#160;might&#160;be&#160;extended&#160;</p>
<p style="position:absolute;top:544px;left:85px;white-space:nowrap" class="ft2714">with&#160;transaction&#160;confirmation&#160;[40].</p>
<p style="position:absolute;top:590px;left:85px;white-space:nowrap" class="ft2727"><i>Trusted&#160;Path&#160;</i></p>
<p style="position:absolute;top:617px;left:85px;white-space:nowrap" class="ft2715">In&#160;order&#160;to&#160;access&#160;the&#160;wallet&#160;directly&#160;for&#160;entering&#160;or&#160;retrieving&#160;credentials,&#160;the&#160;user&#160;<br/>has&#160;&#160;&#160;to&#160;&#160;&#160;initiate&#160;&#160;&#160;a&#160;&#160;&#160;trusted&#160;&#160;&#160;path&#160;&#160;&#160;which&#160;&#160;&#160;is&#160;&#160;&#160;also&#160;&#160;&#160;supplied&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;security&#160;&#160;&#160;kernel.&#160;&#160;&#160;The&#160;<br/>trusted&#160;path&#160;ensures&#160;that&#160;all&#160;input&#160;and&#160;output&#160;is&#160;handled&#160;by&#160;the&#160;wallet&#160;compartment&#160;<br/>and&#160;cannot&#160;be&#160;intercepted&#160;by&#160;malicious&#160;software&#160;in&#160;other&#160;compartments.&#160;Note&#160;that&#160;<br/>this&#160;is&#160;not&#160;&#160;possible&#160;with&#160;a&#160;legacy&#160;system&#160;(e.g.&#160;Windows&#160;or&#160;Linux).&#160;Malware&#160;&#160;could&#160;<br/>forge&#160;&#160;&#160;input&#160;&#160;&#160;dialogs&#160;&#160;&#160;to&#160;&#160;&#160;imitate&#160;&#160;&#160;the&#160;&#160;&#160;wallet's&#160;&#160;&#160;user&#160;&#160;&#160;interface&#160;&#160;&#160;and&#160;&#160;&#160;trick&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;into&#160;<br/>entering&#160;&#160;&#160;her&#160;&#160;&#160;credentials.&#160;&#160;&#160;Windows&#160;&#160;&#160;or&#160;&#160;&#160;Linux&#160;&#160;&#160;provide&#160;&#160;&#160;no&#160;&#160;&#160;inherent&#160;&#160;&#160;way&#160;&#160;&#160;to&#160;&#160;&#160;set&#160;&#160;&#160;up&#160;&#160;&#160;a&#160;<br/>trusted&#160;path&#160;to&#160;prevent&#160;such&#160;attacks.&#160;<br/>We&#160;use&#160;a&#160;secure&#160;graphical&#160;user&#160;interface,&#160;called&#160;mGUI&#160;(as&#160;developped&#160;within&#160;OpenTC&#160;<br/>workpackage&#160;5),&#160;to&#160;provide&#160;a&#160;trusted&#160;path&#160;between&#160;the&#160;user&#160;and&#160;the&#160;secure&#160;wallet.&#160;A&#160;<br/>secure&#160;attention&#160;key&#160;–&#160;in&#160;the&#160;current&#160;implementation&#160;F12&#160;–&#160;can&#160;be&#160;used&#160;to&#160;switch&#160;<br/>between&#160;&#160;compartments.&#160;&#160;No&#160;&#160;compartment&#160;&#160;or&#160;&#160;application&#160;&#160;other&#160;than&#160;the&#160;&#160;mGUI&#160;can&#160;<br/>intercept&#160;this&#160;key.&#160;Moreover,&#160;the&#160;topmost&#160;part&#160;of&#160;the&#160;screen&#160;is&#160;used&#160;by&#160;the&#160;mGUI&#160;to&#160;<br/>display&#160;the&#160;compartment&#160;the&#160;user&#160;is&#160;interacting&#160;with&#160;(in&#160;our&#160;case,&#160;either&#160;the&#160;user&#160;<br/>Linux&#160;&#160;&#160;or&#160;&#160;&#160;the&#160;&#160;&#160;Secure&#160;&#160;&#160;Wallet&#160;&#160;&#160;compartment).&#160;&#160;&#160;No&#160;&#160;&#160;application&#160;&#160;&#160;or&#160;&#160;&#160;compartment&#160;&#160;&#160;can&#160;<br/>overwrite&#160;this&#160;section&#160;of&#160;the&#160;screen.</p>
<p style="position:absolute;top:960px;left:85px;white-space:nowrap" class="ft2727"><i>Trusted&#160;Computing&#160;</i></p>
<p style="position:absolute;top:986px;left:85px;white-space:nowrap" class="ft2715">Virtualisation&#160;&#160;&#160;and&#160;&#160;a&#160;&#160;security&#160;&#160;&#160;kernel&#160;&#160;&#160;alone&#160;&#160;&#160;do&#160;&#160;not&#160;&#160;protect&#160;&#160;&#160;against&#160;&#160;&#160;malware&#160;&#160;&#160;attacks&#160;<br/>sufficiently.&#160;&#160;&#160;An&#160;&#160;&#160;attacker&#160;&#160;&#160;could&#160;&#160;&#160;still&#160;&#160;&#160;mount&#160;&#160;&#160;offline&#160;&#160;&#160;attacks&#160;&#160;&#160;against&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;<br/>compartment&#160;&#160;&#160;or&#160;&#160;&#160;the&#160;&#160;&#160;security&#160;&#160;&#160;kernel&#160;&#160;&#160;itself&#160;&#160;&#160;(e.g.&#160;&#160;&#160;by&#160;&#160;&#160;booting&#160;&#160;&#160;a&#160;&#160;&#160;different&#160;&#160;&#160;operating&#160;<br/>system&#160;from&#160;CD-ROM)&#160;and&#160;try&#160;to&#160;install&#160;malicious&#160;code.&#160;<br/>To&#160;prevent&#160;this&#160;kind&#160;of&#160;attacks,&#160;the&#160;security&#160;kernel&#160;is&#160;executed&#160;on&#160;top&#160;of&#160;hardware&#160;<br/>supporting&#160;&#160;&#160;Trusted&#160;&#160;&#160;Computing&#160;&#160;&#160;functionality&#160;&#160;&#160;based&#160;&#160;&#160;on&#160;&#160;&#160;a&#160;&#160;&#160;Trusted&#160;&#160;&#160;Platform&#160;&#160;&#160;Module.&#160;<br/>Such&#160;hardware&#160;is&#160;already&#160;shipped&#160;by&#160;several&#160;manufacturers&#160;and&#160;can&#160;be&#160;assumed&#160;to&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft277">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft277">27/109</p>
</div>
<!-- Page 28 -->
<a name="28"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page28-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application028.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2812">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft280">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft284">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft284">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft2815">be&#160;available.&#160;User&#160;credentials&#160;are&#160;encrypted&#160;with&#160;a&#160;sealed&#160;key&#160;that&#160;never&#160;leaves&#160;the&#160;<br/>TPM&#160;&#160;&#160;and&#160;&#160;&#160;which&#160;&#160;&#160;is&#160;&#160;&#160;bound&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;platform&#160;&#160;&#160;configuration&#160;&#160;&#160;at&#160;&#160;&#160;the&#160;&#160;&#160;time&#160;&#160;&#160;of&#160;&#160;&#160;sealing.&#160;&#160;&#160;If&#160;<br/>malicious&#160;software&#160;alters&#160;binaries&#160;in&#160;the&#160;chain&#160;of&#160;trust,&#160;the&#160;TPM&#160;will&#160;refuse&#160;to&#160;unseal&#160;<br/>the&#160;credentials&#160;that&#160;were&#160;stored&#160;using&#160;the&#160;original&#160;trustworthy&#160;system&#160;configuration.&#160;<br/>This&#160;&#160;&#160;way,&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;can&#160;&#160;&#160;only&#160;&#160;&#160;access&#160;&#160;&#160;the&#160;&#160;&#160;credentials&#160;&#160;&#160;if&#160;&#160;&#160;the&#160;&#160;&#160;integrity&#160;&#160;&#160;of&#160;&#160;&#160;its&#160;<br/>compartment&#160;is&#160;preserved&#160;and&#160;the&#160;environment&#160;is&#160;secure&#160;(cf.&#160;Objective&#160;2).</p>
<p style="position:absolute;top:293px;left:85px;white-space:nowrap" class="ft286"><b>Realization&#160;</b></p>
<p style="position:absolute;top:320px;left:85px;white-space:nowrap" class="ft2815">An&#160;&#160;&#160;important&#160;&#160;&#160;requirement&#160;&#160;&#160;for&#160;&#160;&#160;realizing&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;is&#160;&#160;&#160;the&#160;&#160;&#160;preservation&#160;&#160;&#160;of&#160;&#160;&#160;existing&#160;<br/>service&#160;&#160;&#160;providers&#160;&#160;&#160;and&#160;&#160;&#160;infrastructures,&#160;&#160;&#160;i.e.&#160;&#160;&#160;they&#160;&#160;&#160;should&#160;&#160;&#160;not&#160;&#160;&#160;require&#160;&#160;&#160;changes&#160;&#160;&#160;to&#160;<br/>accommodate&#160;&#160;&#160;the&#160;&#160;&#160;wallet.&#160;&#160;&#160;Without&#160;&#160;&#160;this&#160;&#160;&#160;requirement,&#160;&#160;&#160;the&#160;&#160;&#160;wallet's&#160;&#160;&#160;chance&#160;&#160;&#160;of&#160;&#160;&#160;being&#160;<br/>deployed&#160;and&#160;commercially&#160;used&#160;would&#160;be&#160;very&#160;low.&#160;Where&#160;changes&#160;to&#160;the&#160;user's&#160;<br/>system&#160;have&#160;to&#160;be&#160;made,&#160;they&#160;should&#160;not&#160;require&#160;high&#160;costs&#160;for&#160;the&#160;provider&#160;and&#160;the&#160;<br/>client.&#160;<br/>The&#160;wallet&#160;itself&#160;is&#160;written&#160;in&#160;Java&#160;and&#160;is&#160;as&#160;such&#160;platform-independent.&#160;In&#160;order&#160;to&#160;<br/>filter&#160;HTML&#160;web&#160;pages&#160;and&#160;HTTP&#160;requests,&#160;the&#160;Paros&#160;web&#160;proxy&#160;<a href="file:///swallet/final/latex/main/main.html#paros">[8]</a>&#160;is&#160;used,&#160;which&#160;is&#160;<br/>also&#160;a&#160;Java&#160;application.&#160;Both&#160;components&#160;in&#160;conjunction&#160;provide&#160;protection&#160;against&#160;<br/>classical&#160;phishing&#160;attacks&#160;and&#160;can&#160;be&#160;used&#160;on&#160;an&#160;arbitrary&#160;platform&#160;supporting&#160;Java.&#160;<br/>To&#160;protect&#160;against&#160;malware&#160;phishing&#160;attacks,&#160;the&#160;system&#160;architecture&#160;in&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#26">&#160;Figure&#160;8&#160;</a>is&#160;<br/>realized&#160;by&#160;using&#160;the&#160;system&#160;developped&#160;within&#160;OpenTC&#160;workpackages&#160;4&#160;and&#160;5.&#160;The&#160;<br/>framework&#160;&#160;&#160;uses&#160;&#160;&#160;virtualisation&#160;&#160;&#160;techniques&#160;&#160;&#160;to&#160;&#160;&#160;provide&#160;&#160;&#160;several&#160;&#160;&#160;instances&#160;&#160;&#160;of&#160;&#160;&#160;legacy&#160;<br/>operating&#160;&#160;&#160;systems&#160;&#160;&#160;running&#160;&#160;&#160;concurrently&#160;&#160;&#160;but&#160;&#160;&#160;each&#160;&#160;&#160;with&#160;&#160;&#160;its&#160;&#160;&#160;own&#160;&#160;&#160;set&#160;&#160;&#160;of&#160;&#160;&#160;virtual&#160;<br/>resources.&#160;&#160;&#160;Each&#160;&#160;&#160;instance&#160;&#160;&#160;will&#160;&#160;&#160;represent&#160;&#160;&#160;a&#160;&#160;&#160;single&#160;&#160;&#160;compartment,&#160;&#160;&#160;although&#160;&#160;&#160;a&#160;<br/>compartment&#160;&#160;&#160;generally&#160;&#160;&#160;does&#160;&#160;&#160;not&#160;&#160;&#160;need&#160;&#160;&#160;to&#160;&#160;&#160;include&#160;&#160;&#160;a&#160;&#160;&#160;complete&#160;&#160;&#160;operating&#160;&#160;&#160;system&#160;&#160;&#160;to&#160;<br/>work.&#160;&#160;&#160;The&#160;&#160;&#160;ability&#160;&#160;&#160;to&#160;&#160;&#160;use&#160;&#160;&#160;existing&#160;&#160;&#160;operating&#160;&#160;&#160;systems&#160;&#160;&#160;supports&#160;&#160;&#160;the&#160;&#160;&#160;preservation&#160;&#160;&#160;of&#160;<br/>existing&#160;infrastructures.&#160;Thus,&#160;the&#160;untrusted&#160;user&#160;compartment&#160;will&#160;contain&#160;a&#160;legacy&#160;<br/>operating&#160;system&#160;(i.e.&#160;L4Linux&#160;[4]&#160;in&#160;the&#160;case&#160;of&#160;this&#160;work).&#160;</p>
<p style="position:absolute;top:730px;left:85px;white-space:nowrap" class="ft2816"><b>2.5&#160;Security&#160;Analysis&#160;</b></p>
<p style="position:absolute;top:758px;left:85px;white-space:nowrap" class="ft2815">This&#160;chapter&#160;discusses&#160;all&#160;attacks&#160;that&#160;might&#160;be&#160;mounted&#160;against&#160;the&#160;Secure&#160;Wallet&#160;<br/>or&#160;&#160;&#160;any&#160;&#160;&#160;of&#160;&#160;&#160;its&#160;&#160;&#160;associated&#160;&#160;&#160;components&#160;&#160;&#160;or&#160;&#160;&#160;procedures.&#160;&#160;&#160;It&#160;&#160;&#160;will&#160;&#160;&#160;show&#160;&#160;&#160;that&#160;&#160;&#160;all&#160;&#160;&#160;threats&#160;<br/>introduced&#160;in&#160;Section&#160;2.1&#160;can&#160;be&#160;&#160;countered&#160;effectively&#160;&#160;with&#160;the&#160;wallet.&#160;As&#160;already&#160;<br/>pointed&#160;out&#160;before,&#160;there&#160;are&#160;two&#160;categories&#160;of&#160;phishing&#160;attacks:&#160;classical&#160;phishing&#160;<br/>attacks&#160;&#160;and&#160;malware&#160;phishing&#160;&#160;attacks.&#160;Both&#160;&#160;categories&#160;&#160;will&#160;&#160;be&#160;&#160;handled&#160;&#160;separately&#160;<br/>since&#160;they&#160;require&#160;different&#160;protection&#160;mechanisms.&#160;<br/><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#29">Figure&#160;9&#160;&#160;</a>shows&#160;an&#160;abstract&#160;overview&#160;of&#160;the&#160;system&#160;model&#160;employed&#160;by&#160;the&#160;wallet.&#160;<br/>The&#160;four&#160;involved&#160;entities&#160;are&#160;the&#160;user&#160;U,&#160;her&#160;system&#160;S,&#160;a&#160;remote&#160;web&#160;server&#160;P&#160;that&#160;U&#160;<br/>wants&#160;to&#160;communicate&#160;with&#160;and&#160;a&#160;phishing&#160;server&#160;A&#160;set&#160;up&#160;by&#160;an&#160;adversary&#160;to&#160;gain&#160;<br/>access&#160;&#160;&#160;to&#160;&#160;&#160;U's&#160;&#160;&#160;credentials.&#160;&#160;&#160;Several&#160;&#160;&#160;communication&#160;&#160;&#160;channels&#160;&#160;&#160;exist&#160;&#160;&#160;between&#160;&#160;&#160;those&#160;<br/>entities.&#160;&#160;&#160;The&#160;&#160;&#160;channel&#160;&#160;</p>
<p style="position:absolute;top:959px;left:327px;white-space:nowrap" class="ft2814">&#160;&#160;is&#160;&#160;&#160;the&#160;&#160;&#160;user's&#160;&#160;&#160;input&#160;&#160;&#160;channel&#160;&#160;&#160;into&#160;&#160;&#160;S&#160;&#160;&#160;while&#160;&#160;&#160;she&#160;&#160;&#160;receives&#160;</p>
<p style="position:absolute;top:984px;left:85px;white-space:nowrap" class="ft2814">output&#160;over&#160;the&#160;channel&#160;</p>
<p style="position:absolute;top:984px;left:352px;white-space:nowrap" class="ft2814">&#160;.&#160;</p>
<p style="position:absolute;top:984px;left:416px;white-space:nowrap" class="ft2814">&#160;is&#160;used&#160;by&#160;S&#160;to&#160;send&#160;HTTP&#160;requests&#160;to&#160;P&#160;and&#160;</p>
<p style="position:absolute;top:1011px;left:85px;white-space:nowrap" class="ft2814">returned&#160;HTML&#160;pages&#160;are&#160;received&#160;over&#160;</p>
<p style="position:absolute;top:1011px;left:492px;white-space:nowrap" class="ft2814">&#160;.&#160;The&#160;adversary&#160;uses&#160;</p>
<p style="position:absolute;top:1011px;left:738px;white-space:nowrap" class="ft2814">&#160;to&#160;send&#160;</p>
<p style="position:absolute;top:1038px;left:85px;white-space:nowrap" class="ft2814">fake&#160;messages&#160;or&#160;emails&#160;to&#160;S&#160;and&#160;receives&#160;HTTP&#160;requests&#160;from&#160;S&#160;on&#160;</p>
<p style="position:absolute;top:1038px;left:710px;white-space:nowrap" class="ft2814">&#160;.&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft287">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft287">28/109</p>
</div>
<!-- Page 29 -->
<a name="29"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2928{font-size:17px;line-height:26px;font-family:EAAAAA+DejaVuSerif;color:#000000;}
-->
</style>
<div id="page29-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application029.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft2912">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft290">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft294">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft294">Final</p>
<p style="position:absolute;top:401px;left:677px;white-space:nowrap" class="ft2914">&#160;</p>
<p style="position:absolute;top:423px;left:85px;white-space:nowrap" class="ft2921"><b>Figure&#160;9:</b></p>
<p style="position:absolute;top:423px;left:169px;white-space:nowrap" class="ft2914">&#160;Simplified&#160;system&#160;model&#160;for&#160;the&#160;Secure&#160;Wallet&#160;</p>
<p style="position:absolute;top:460px;left:85px;white-space:nowrap" class="ft296"><b>2.5.1&#160;Attacks&#160;</b></p>
<p style="position:absolute;top:486px;left:85px;white-space:nowrap" class="ft2915">The&#160;adversary&#160;can&#160;either&#160;directly&#160;target&#160;one&#160;of&#160;the&#160;entities&#160;or&#160;mount&#160;an&#160;attack&#160;on&#160;one&#160;<br/>of&#160;the&#160;communication&#160;channels.&#160;He&#160;can&#160;especially&#160;eavesdrop&#160;on&#160;and&#160;modify&#160;all&#160;of&#160;the&#160;<br/>network&#160;&#160;&#160;channels&#160;&#160;but&#160;&#160;&#160;cannot&#160;&#160;&#160;directly&#160;&#160;&#160;attack&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;channels&#160;&#160;</p>
<p style="position:absolute;top:525px;left:705px;white-space:nowrap" class="ft2914">&#160;&#160;and&#160;&#160;</p>
<p style="position:absolute;top:525px;left:803px;white-space:nowrap" class="ft2914">.&#160;</p>
<p style="position:absolute;top:551px;left:85px;white-space:nowrap" class="ft2915">Attacks&#160;on&#160;an&#160;entity&#160;always&#160;use&#160;one&#160;or&#160;more&#160;of&#160;the&#160;illustrated&#160;channels&#160;to&#160;send&#160;and&#160;<br/>receive&#160;messages.&#160;Furthermore,&#160;the&#160;phishing&#160;server&#160;A&#160;can&#160;be&#160;an&#160;arbitrary&#160;machine&#160;<br/>on&#160;the&#160;internet&#160;except&#160;S&#160;and&#160;P&#160;and&#160;is&#160;just&#160;noted&#160;as&#160;a&#160;single&#160;machine&#160;for&#160;convenience.&#160;<br/>Above,&#160;a&#160;list&#160;of&#160;potential&#160;threats&#160;for&#160;the&#160;user's&#160;credentials&#160;was&#160;given.&#160;Each&#160;of&#160;those&#160;<br/>threats&#160;corresponds&#160;to&#160;a&#160;specific&#160;class&#160;of&#160;attacks&#160;in&#160;the&#160;system&#160;model&#160;shown&#160;above.&#160;<br/>Threat&#160;1&#160;(</p>
<p style="position:absolute;top:656px;left:169px;white-space:nowrap" class="ft2920"><i>Identity&#160;Theft&#160;through&#160;Faked&#160;Web&#160;Sites</i></p>
<p style="position:absolute;top:656px;left:501px;white-space:nowrap" class="ft2914">)&#160;is&#160;an&#160;attack&#160;directly&#160;on&#160;U.&#160;Threat&#160;2&#160;</p>
<p style="position:absolute;top:675px;left:85px;white-space:nowrap" class="ft2914">(</p>
<p style="position:absolute;top:675px;left:92px;white-space:nowrap" class="ft2920"><i>Malware&#160;Identity&#160;Theft</i></p>
<p style="position:absolute;top:675px;left:289px;white-space:nowrap" class="ft2914">)&#160;can&#160;target&#160;the&#160;entities&#160;U&#160;(e.g.,&#160;by&#160;showing&#160;a&#160;message&#160;that&#160;</p>
<p style="position:absolute;top:695px;left:85px;white-space:nowrap" class="ft2915">tricks&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;into&#160;&#160;&#160;revealing&#160;&#160;&#160;her&#160;&#160;&#160;credentials)&#160;&#160;&#160;and&#160;&#160;&#160;S,&#160;&#160;&#160;the&#160;&#160;&#160;network&#160;&#160;&#160;channels&#160;&#160;&#160;and&#160;<br/>indirectly&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;channels&#160;&#160;&#160;as&#160;&#160;&#160;well.&#160;&#160;&#160;Thus,&#160;&#160;&#160;it&#160;&#160;&#160;is&#160;&#160;&#160;the&#160;&#160;&#160;most&#160;&#160;&#160;extensive&#160;&#160;&#160;threat&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;<br/>system&#160;model.&#160;Threats&#160;3&#160;(</p>
<p style="position:absolute;top:733px;left:311px;white-space:nowrap" class="ft2920"><i>Credential&#160;Theft</i></p>
<p style="position:absolute;top:733px;left:452px;white-space:nowrap" class="ft2914">)&#160;and&#160;4&#160;(</p>
<p style="position:absolute;top:733px;left:528px;white-space:nowrap" class="ft2920"><i>Configuration&#160;Modification</i></p>
<p style="position:absolute;top:733px;left:758px;white-space:nowrap" class="ft2914">)&#160;only&#160;</p>
<p style="position:absolute;top:752px;left:85px;white-space:nowrap" class="ft2914">target&#160;the&#160;entity&#160;S,&#160;while&#160;Threat&#160;5&#160;(</p>
<p style="position:absolute;top:752px;left:383px;white-space:nowrap" class="ft2920"><i>Fake&#160;Dialog&#160;Attack</i></p>
<p style="position:absolute;top:752px;left:541px;white-space:nowrap" class="ft2914">)&#160;targets&#160;both&#160;entities&#160;U&#160;and&#160;S.&#160;</p>
<p style="position:absolute;top:780px;left:85px;white-space:nowrap" class="ft2915">To&#160;show&#160;that&#160;those&#160;threats&#160;are&#160;ineffective&#160;and&#160;the&#160;security&#160;objectives&#160;have&#160;been&#160;met,&#160;<br/>it&#160;is&#160;sufficient&#160;to&#160;show&#160;that&#160;attacks&#160;on&#160;each&#160;channel&#160;or&#160;entity&#160;are&#160;countered&#160;by&#160;the&#160;<br/>wallet.&#160;</p>
<p style="position:absolute;top:865px;left:85px;white-space:nowrap" class="ft293"><b>Attacks&#160;on&#160;U&#160;</b></p>
<p style="position:absolute;top:892px;left:85px;white-space:nowrap" class="ft2915">Attacks&#160;&#160;&#160;on&#160;&#160;&#160;U&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;&#160;&#160;scope&#160;&#160;&#160;of&#160;&#160;&#160;Threat&#160;1&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;categorized&#160;&#160;&#160;as&#160;&#160;&#160;classical&#160;&#160;&#160;phishing&#160;<br/>attacks,&#160;&#160;&#160;which&#160;&#160;&#160;are&#160;&#160;&#160;a&#160;&#160;&#160;subclass&#160;&#160;&#160;of&#160;&#160;&#160;social&#160;&#160;&#160;engineering&#160;&#160;&#160;attacks&#160;&#160;&#160;where&#160;&#160;&#160;A&#160;&#160;&#160;sends&#160;&#160;&#160;fake&#160;<br/>messages&#160;to&#160;U&#160;in&#160;order&#160;to&#160;trick&#160;her&#160;to&#160;disclose&#160;credentials.&#160;For&#160;example,&#160;A&#160;creates&#160;a&#160;<br/>fake&#160;email&#160;that&#160;imitates&#160;a&#160;mail&#160;originating&#160;from&#160;P&#160;but&#160;contains&#160;a&#160;link&#160;to&#160;A&#160;and&#160;uses&#160;</p>
<p style="position:absolute;top:969px;left:140px;white-space:nowrap" class="ft2928">&#160;&#160;to&#160;deliver&#160;it&#160;to&#160;S.&#160;The&#160;user&#160;receives&#160;and&#160;reads&#160;that&#160;email&#160;using&#160;the&#160;channel&#160;<br/>&#160;and&#160;(if&#160;deceived&#160;by&#160;it)&#160;acts&#160;upon&#160;the&#160;email&#160;using&#160;the&#160;channel&#160;</p>
<p style="position:absolute;top:995px;left:723px;white-space:nowrap" class="ft2914">&#160;to&#160;access&#160;</p>
<p style="position:absolute;top:1022px;left:85px;white-space:nowrap" class="ft2914">A,&#160;&#160;&#160;i.e.&#160;&#160;&#160;S&#160;&#160;&#160;uses&#160;&#160;</p>
<p style="position:absolute;top:1022px;left:264px;white-space:nowrap" class="ft2914">&#160;&#160;for&#160;&#160;&#160;an&#160;&#160;&#160;HTTP&#160;&#160;&#160;request&#160;&#160;&#160;instead&#160;&#160;&#160;of&#160;&#160;</p>
<p style="position:absolute;top:1022px;left:611px;white-space:nowrap" class="ft2914">&#160;&#160;.&#160;&#160;&#160;Other&#160;&#160;&#160;attacks&#160;&#160;&#160;on&#160;&#160;&#160;U&#160;</p>
<p style="position:absolute;top:1048px;left:85px;white-space:nowrap" class="ft2915">involving&#160;the&#160;entity&#160;S&#160;as&#160;well&#160;are&#160;discussed&#160;in&#160;the&#160;next&#160;paragraph.&#160;An&#160;analysis&#160;of&#160;<br/>classical&#160;phishing&#160;attacks&#160;is&#160;provided&#160;below.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft297">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft297">29/109</p>
</div>
<!-- Page 30 -->
<a name="30"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page30-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application030.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3012">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft300">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft304">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft304">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft303"><b>Attacks&#160;on&#160;S&#160;</b></p>
<p style="position:absolute;top:178px;left:85px;white-space:nowrap" class="ft3018">Attacks&#160;on&#160;S&#160;attempt&#160;to&#160;gather&#160;or&#160;steal&#160;credentials&#160;on&#160;the&#160;user's&#160;system&#160;instead&#160;of&#160;<br/>trying&#160;to&#160;trick&#160;U&#160;to&#160;disclose&#160;credentials&#160;to&#160;a&#160;phishing&#160;site&#160;directly.&#160;Such&#160;an&#160;attack&#160;<br/>might&#160;either&#160;occur&#160;offline,&#160;e.g.&#160;by&#160;attempting&#160;to&#160;modify&#160;the&#160;system&#160;or&#160;to&#160;read&#160;the&#160;<br/>credential&#160;store&#160;directly.&#160;Or&#160;it&#160;might&#160;occur&#160;online,&#160;i.e.&#160;by&#160;actively&#160;installing&#160;malicious&#160;<br/>software&#160;on&#160;S&#160;while&#160;the&#160;system&#160;is&#160;running.&#160;Installation&#160;of&#160;such&#160;malware&#160;can&#160;occur&#160;by&#160;<br/>exploiting&#160;a&#160;known&#160;security&#160;weakness&#160;of&#160;an&#160;application&#160;running&#160;on&#160;S&#160;or&#160;the&#160;adversary&#160;<br/>might&#160;employ&#160;additional&#160;social&#160;engineering&#160;attacks&#160;to&#160;trick&#160;U&#160;to&#160;install&#160;the&#160;malware&#160;<br/>willingly.&#160;<br/>Depending&#160;on&#160;the&#160;kind&#160;of&#160;malicious&#160;software,&#160;it&#160;might&#160;attack&#160;the&#160;channel&#160;&#160;</p>
<p style="position:absolute;top:340px;left:784px;white-space:nowrap" class="ft3014">&#160;&#160;to&#160;</p>
<p style="position:absolute;top:367px;left:85px;white-space:nowrap" class="ft3015">eavesdrop&#160;&#160;&#160;on&#160;&#160;&#160;credentials&#160;&#160;&#160;entered&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;(keylogger),&#160;&#160;&#160;or&#160;&#160;&#160;it&#160;&#160;&#160;might&#160;&#160;&#160;attack&#160;&#160;&#160;the&#160;<br/>entity&#160;U&#160;and&#160;the&#160;channel&#160;</p>
<p style="position:absolute;top:386px;left:354px;white-space:nowrap" class="ft3014">&#160;by&#160;displaying&#160;a&#160;fake&#160;dialog&#160;where&#160;the&#160;user&#160;enters&#160;her&#160;</p>
<p style="position:absolute;top:413px;left:85px;white-space:nowrap" class="ft3014">credentials,&#160;thereby&#160;redirecting&#160;</p>
<p style="position:absolute;top:413px;left:411px;white-space:nowrap" class="ft3014">&#160;as&#160;well&#160;(fake&#160;dialog&#160;attack).&#160;Alternatively,&#160;the&#160;</p>
<p style="position:absolute;top:439px;left:85px;white-space:nowrap" class="ft3015">malware&#160;&#160;&#160;can&#160;&#160;&#160;target&#160;&#160;&#160;a&#160;&#160;&#160;specific&#160;&#160;&#160;system&#160;&#160;&#160;component&#160;&#160;&#160;or&#160;&#160;&#160;a&#160;&#160;&#160;communication&#160;&#160;&#160;channel&#160;<br/>between&#160;two&#160;of&#160;those&#160;components.&#160;Those&#160;online&#160;attacks,&#160;and&#160;also&#160;offline&#160;attacks,&#160;will&#160;<br/>be&#160;discussed&#160;in&#160;detail&#160;below.&#160;</p>
<p style="position:absolute;top:524px;left:85px;white-space:nowrap" class="ft303"><b>Attacks&#160;on&#160;P&#160;</b></p>
<p style="position:absolute;top:550px;left:85px;white-space:nowrap" class="ft3015">The&#160;adversary&#160;can&#160;also&#160;mount&#160;an&#160;attack&#160;on&#160;the&#160;remote&#160;web&#160;server&#160;P&#160;by&#160;breaking&#160;into&#160;<br/>the&#160;system&#160;in&#160;order&#160;to&#160;steal&#160;credentials&#160;directly&#160;from&#160;P's&#160;database.&#160;Since&#160;this&#160;work&#160;<br/>focuses&#160;on&#160;client-side&#160;defence&#160;against&#160;phishing&#160;attacks,&#160;this&#160;kind&#160;of&#160;attacks&#160;is&#160;out&#160;of&#160;<br/>scope&#160;and&#160;will&#160;not&#160;be&#160;discussed&#160;further.&#160;<br/>An&#160;&#160;even&#160;&#160;stronger&#160;&#160;attack&#160;&#160;is&#160;&#160;setting&#160;&#160;up&#160;an&#160;own&#160;&#160;web&#160;server&#160;&#160;(independent&#160;&#160;of&#160;&#160;P)&#160;and&#160;<br/>letting&#160;the&#160;user&#160;register&#160;to&#160;it.&#160;This&#160;way&#160;the&#160;adversary&#160;either&#160;receives&#160;the&#160;original&#160;user&#160;<br/>password&#160;&#160;&#160;(possibly&#160;&#160;&#160;re-used&#160;&#160;&#160;at&#160;&#160;&#160;P&#160;&#160;&#160;as&#160;&#160;&#160;well)&#160;&#160;&#160;or&#160;&#160;&#160;at&#160;&#160;&#160;least&#160;&#160;&#160;a&#160;&#160;&#160;wallet-generated&#160;&#160;&#160;password&#160;<br/>derived&#160;from&#160;this&#160;original&#160;password.&#160;With&#160;that&#160;information,&#160;A&#160;can&#160;mount&#160;a&#160;dictionary&#160;<br/>attack&#160;against&#160;the&#160;user's&#160;password&#160;and&#160;attempt&#160;to&#160;guess&#160;the&#160;password&#160;used&#160;for&#160;P.&#160;<br/>Attacks&#160;against&#160;the&#160;user's&#160;passwords&#160;are&#160;discussed&#160;below.&#160;</p>
<p style="position:absolute;top:779px;left:85px;white-space:nowrap" class="ft304">&#160;</p>
<p style="position:absolute;top:778px;left:90px;white-space:nowrap" class="ft303"><b>Attacks&#160;on&#160;the&#160;channels&#160;</b></p>
<p style="position:absolute;top:805px;left:85px;white-space:nowrap" class="ft3014">The&#160;channels&#160;</p>
<p style="position:absolute;top:805px;left:252px;white-space:nowrap" class="ft3014">&#160;and&#160;</p>
<p style="position:absolute;top:805px;left:350px;white-space:nowrap" class="ft3014">&#160;cannot&#160;be&#160;attacked&#160;directly&#160;by&#160;the&#160;adversary.&#160;He&#160;can&#160;</p>
<p style="position:absolute;top:832px;left:85px;white-space:nowrap" class="ft3018">only&#160;&#160;&#160;attack&#160;&#160;&#160;them&#160;&#160;&#160;indirectly&#160;&#160;&#160;through&#160;&#160;&#160;attacks&#160;&#160;&#160;on&#160;&#160;&#160;one&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;endpoints&#160;&#160;&#160;of&#160;&#160;&#160;those&#160;<br/>channels,&#160;i.e.&#160;by&#160;attacking&#160;U&#160;or&#160;S.&#160;Those&#160;attacks&#160;have&#160;already&#160;been&#160;described&#160;above.&#160;<br/>In&#160;&#160;&#160;contrast,&#160;&#160;&#160;A&#160;&#160;&#160;can&#160;&#160;&#160;attack&#160;&#160;&#160;the&#160;&#160;&#160;channels&#160;&#160;</p>
<p style="position:absolute;top:879px;left:487px;white-space:nowrap" class="ft3014">&#160;&#160;and&#160;&#160;</p>
<p style="position:absolute;top:879px;left:590px;white-space:nowrap" class="ft3014">&#160;&#160;directly&#160;&#160;&#160;since&#160;&#160;&#160;A&#160;&#160;&#160;can&#160;&#160;&#160;by&#160;</p>
<p style="position:absolute;top:906px;left:85px;white-space:nowrap" class="ft3015">definition&#160;be&#160;any&#160;machine&#160;on&#160;the&#160;internet&#160;apart&#160;from&#160;S&#160;and&#160;P.&#160;The&#160;adversary&#160;might&#160;<br/>either&#160;&#160;&#160;try&#160;&#160;&#160;to&#160;&#160;&#160;eavesdrop&#160;&#160;&#160;on&#160;&#160;&#160;those&#160;&#160;&#160;channels&#160;&#160;&#160;in&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;&#160;&#160;passively&#160;&#160;&#160;read&#160;&#160;&#160;transmitted&#160;<br/>credentials,&#160;or&#160;he&#160;could&#160;modify&#160;the&#160;communication.&#160;In&#160;addition,&#160;he&#160;could&#160;redirect&#160;the&#160;<br/>channels&#160;so&#160;that&#160;</p>
<p style="position:absolute;top:963px;left:278px;white-space:nowrap" class="ft3014">&#160;is&#160;replaced&#160;by&#160;</p>
<p style="position:absolute;top:963px;left:459px;white-space:nowrap" class="ft3014">&#160;and&#160;</p>
<p style="position:absolute;top:963px;left:557px;white-space:nowrap" class="ft3014">&#160;by&#160;</p>
<p style="position:absolute;top:963px;left:645px;white-space:nowrap" class="ft3014">&#160;without&#160;S&#160;noticing&#160;</p>
<p style="position:absolute;top:990px;left:85px;white-space:nowrap" class="ft3015">the&#160;redirection.&#160;<br/>Eavesdropping&#160;on&#160;and&#160;modification&#160;of&#160;an&#160;SSL-protected&#160;channel&#160;can&#160;be&#160;assumed&#160;to&#160;<br/>be&#160;&#160;&#160;unfeasible&#160;&#160;&#160;as&#160;&#160;&#160;long&#160;&#160;&#160;as&#160;&#160;&#160;the&#160;&#160;&#160;SSL&#160;&#160;&#160;protocol&#160;&#160;&#160;and&#160;&#160;&#160;its&#160;&#160;&#160;implementation&#160;&#160;&#160;are&#160;&#160;&#160;secure.&#160;<br/>Unprotected&#160;channels&#160;could&#160;be&#160;tapped&#160;at&#160;any&#160;point&#160;during&#160;the&#160;transport,&#160;though,&#160;and&#160;<br/>thus&#160;they&#160;are&#160;inherently&#160;insecure.&#160;As&#160;a&#160;result,&#160;if&#160;the&#160;user&#160;transmits&#160;credentials&#160;over&#160;a&#160;<br/>plain&#160;HTTP&#160;connection,&#160;the&#160;adversary&#160;can&#160;eavesdrop&#160;on&#160;those&#160;credentials,&#160;regardless&#160;<br/>of&#160;whether&#160;she&#160;uses&#160;the&#160;wallet&#160;or&#160;not.&#160;But&#160;even&#160;if&#160;the&#160;adversary&#160;gains&#160;the&#160;credentials&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft307">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft307">30/109</p>
</div>
<!-- Page 31 -->
<a name="31"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page31-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application031.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3112">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft310">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft314">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft314">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft3115">for&#160;P&#160;in&#160;this&#160;way,&#160;the&#160;wallet&#160;helps&#160;to&#160;confine&#160;the&#160;loss&#160;of&#160;credentials&#160;because&#160;each&#160;web&#160;<br/>site&#160;has&#160;its&#160;own&#160;unique&#160;password&#160;generated&#160;by&#160;the&#160;wallet&#160;previously.&#160;A&#160;cannot&#160;gain&#160;<br/>access&#160;to&#160;other&#160;servers&#160;than&#160;P&#160;with&#160;the&#160;stolen&#160;credential&#160;even&#160;if&#160;the&#160;user&#160;initially&#160;used&#160;<br/>the&#160;same&#160;passwords&#160;for&#160;different&#160;web&#160;sites.&#160;<br/>A&#160;&#160;&#160;redirection&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;channels&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;seen&#160;&#160;&#160;as&#160;&#160;&#160;a&#160;&#160;&#160;form&#160;&#160;&#160;of&#160;&#160;&#160;classical&#160;&#160;&#160;phishing&#160;&#160;&#160;attack&#160;<br/>because&#160;even&#160;if&#160;the&#160;user&#160;does&#160;not&#160;notice&#160;that&#160;the&#160;channel&#160;has&#160;been&#160;redirected&#160;(e.g.&#160;<br/>she&#160;enters&#160;the&#160;URL&#160;of&#160;P&#160;into&#160;her&#160;browser),&#160;she&#160;still&#160;expects&#160;to&#160;see&#160;the&#160;familiar&#160;web&#160;<br/>pages&#160;of&#160;the&#160;original&#160;web&#160;server&#160;P,&#160;i.e.&#160;the&#160;adversary&#160;needs&#160;to&#160;fake&#160;the&#160;web&#160;site&#160;just&#160;<br/>like&#160;in&#160;a&#160;normal&#160;classical&#160;attack.&#160;Therefore,&#160;redirection&#160;attacks&#160;are&#160;discussed&#160;as&#160;part&#160;<br/>of&#160;the&#160;classical&#160;phishing&#160;attacks&#160;below.&#160;</p>
<p style="position:absolute;top:379px;left:85px;white-space:nowrap" class="ft313"><b>2.5.2&#160;Assumptions&#160;</b></p>
<p style="position:absolute;top:406px;left:85px;white-space:nowrap" class="ft3115">Besides&#160;&#160;&#160;the&#160;&#160;&#160;assumptions&#160;&#160;&#160;introduced&#160;&#160;&#160;above,&#160;&#160;&#160;the&#160;&#160;&#160;security&#160;&#160;&#160;analysis&#160;&#160;&#160;suggests&#160;&#160;&#160;two&#160;<br/>additional&#160;&#160;&#160;assumptions.&#160;&#160;&#160;On&#160;&#160;&#160;the&#160;&#160;&#160;one&#160;&#160;&#160;hand,&#160;&#160;&#160;we&#160;&#160;&#160;assume&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;is&#160;&#160;&#160;trained&#160;&#160;&#160;to&#160;<br/>recognize&#160;the&#160;system's&#160;trusted&#160;path&#160;indicator&#160;(e.g.&#160;a&#160;red&#160;or&#160;green&#160;bar&#160;at&#160;the&#160;top&#160;of&#160;the&#160;<br/>screen)&#160;&#160;&#160;and&#160;&#160;&#160;acts&#160;&#160;&#160;upon&#160;&#160;&#160;it&#160;&#160;&#160;accordingly,&#160;&#160;&#160;i.e.&#160;&#160;&#160;she&#160;&#160;&#160;does&#160;&#160;&#160;not&#160;&#160;&#160;enter&#160;&#160;&#160;any&#160;&#160;&#160;confidential&#160;<br/>information&#160;if&#160;the&#160;trusted&#160;path&#160;indicator&#160;is&#160;red.&#160;On&#160;the&#160;other&#160;hand,&#160;we&#160;assume&#160;that&#160;<br/>the&#160;user&#160;always&#160;changes&#160;the&#160;password&#160;for&#160;a&#160;web&#160;site&#160;after&#160;she&#160;has&#160;set&#160;it&#160;up&#160;in&#160;the&#160;<br/>wallet,&#160;i.e.&#160;she&#160;does&#160;not&#160;know&#160;the&#160;password&#160;thereafter.&#160;</p>
<p style="position:absolute;top:567px;left:85px;white-space:nowrap" class="ft316"><b>2.5.3&#160;Protection&#160;against&#160;Classical&#160;Phishing&#160;Attacks&#160;</b></p>
<p style="position:absolute;top:594px;left:85px;white-space:nowrap" class="ft3115">Classical&#160;phishing&#160;attacks&#160;are&#160;based&#160;on&#160;the&#160;user&#160;U&#160;attempting&#160;to&#160;access&#160;a&#160;web&#160;site&#160;on&#160;<br/>web&#160;server&#160;P&#160;but&#160;instead&#160;arriving&#160;at&#160;a&#160;rogue&#160;web&#160;server&#160;A&#160;created&#160;by&#160;an&#160;adversary.&#160;U&#160;<br/>may&#160;arrive&#160;in&#160;one&#160;of&#160;two&#160;ways&#160;at&#160;A.&#160;Either&#160;she&#160;enters&#160;the&#160;address&#160;of&#160;the&#160;fake&#160;site&#160;<br/>directly&#160;&#160;into&#160;her&#160;browser&#160;&#160;or&#160;she&#160;&#160;enters&#160;&#160;the&#160;address&#160;&#160;of&#160;P&#160;&#160;and&#160;is&#160;redirected&#160;&#160;to&#160;&#160;the&#160;<br/>phishing&#160;server&#160;A&#160;by&#160;a&#160;redirection&#160;attack.&#160;In&#160;both&#160;cases&#160;she&#160;is&#160;presented&#160;a&#160;faked&#160;web&#160;<br/>site&#160;and&#160;might&#160;be&#160;persuaded&#160;to&#160;enter&#160;her&#160;credentials&#160;for&#160;the&#160;original&#160;site&#160;that&#160;has&#160;<br/>been&#160;&#160;&#160;faked.&#160;&#160;&#160;The&#160;&#160;&#160;difference&#160;&#160;&#160;between&#160;&#160;&#160;those&#160;&#160;&#160;two&#160;&#160;&#160;attacks&#160;&#160;&#160;is&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;&#160;&#160;way&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;<br/>handles&#160;&#160;&#160;them.&#160;&#160;&#160;In&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;&#160;&#160;meet&#160;&#160;&#160;Requirement&#160;3&#160;&#160;&#160;(</p>
<p style="position:absolute;top:728px;left:515px;white-space:nowrap" class="ft3120"><i>Information&#160;&#160;&#160;Flow</i></p>
<p style="position:absolute;top:728px;left:664px;white-space:nowrap" class="ft3114">)&#160;&#160;&#160;with&#160;&#160;&#160;regard&#160;&#160;to&#160;</p>
<p style="position:absolute;top:747px;left:85px;white-space:nowrap" class="ft3115">classical&#160;&#160;&#160;phishing&#160;&#160;&#160;attacks,&#160;&#160;&#160;it&#160;&#160;&#160;is&#160;&#160;&#160;sufficient&#160;&#160;&#160;to&#160;&#160;&#160;show&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;adversary&#160;&#160;&#160;cannot&#160;&#160;&#160;gain&#160;<br/>access&#160;to&#160;the&#160;user's&#160;credentials&#160;if&#160;she&#160;uses&#160;the&#160;wallet.&#160;</p>
<p style="position:absolute;top:813px;left:85px;white-space:nowrap" class="ft316"><b>Fake&#160;Site&#160;Attack&#160;</b></p>
<p style="position:absolute;top:839px;left:85px;white-space:nowrap" class="ft3115">If&#160;&#160;&#160;the&#160;&#160;&#160;adversary&#160;&#160;&#160;uses&#160;&#160;&#160;a&#160;&#160;&#160;faked&#160;&#160;&#160;SSL&#160;&#160;&#160;certificate,&#160;&#160;&#160;the&#160;&#160;&#160;attack&#160;&#160;&#160;is&#160;&#160;&#160;detected&#160;&#160;&#160;because&#160;&#160;&#160;the&#160;<br/>wallet&#160;&#160;verifies&#160;all&#160;received&#160;SSL&#160;&#160;certificates&#160;and&#160;&#160;rejects&#160;sites&#160;&#160;with&#160;&#160;invalid&#160;&#160;or&#160;&#160;faked&#160;<br/>certificates.&#160;&#160;&#160;If&#160;&#160;&#160;he&#160;&#160;&#160;uses&#160;&#160;&#160;a&#160;&#160;&#160;legitimate&#160;&#160;&#160;SSL&#160;&#160;&#160;certificate&#160;&#160;</p>
<p style="position:absolute;top:877px;left:593px;white-space:nowrap" class="ft3114">&#160;&#160;issued&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;fake&#160;&#160;&#160;host&#160;</p>
<p style="position:absolute;top:903px;left:85px;white-space:nowrap" class="ft3115">address&#160;or&#160;uses&#160;no&#160;SSL&#160;at&#160;all,&#160;the&#160;web&#160;site&#160;is&#160;handed&#160;over&#160;to&#160;the&#160;browser&#160;for&#160;display&#160;<br/>but&#160;the&#160;password&#160;fields&#160;of&#160;the&#160;login&#160;form&#160;are&#160;disabled.&#160;According&#160;to&#160;Assumption&#160;3&#160;<br/>(</p>
<p style="position:absolute;top:942px;left:92px;white-space:nowrap" class="ft3120"><i>Ordinary&#160;User</i></p>
<p style="position:absolute;top:942px;left:213px;white-space:nowrap" class="ft3114">),&#160;we&#160;assume&#160;that&#160;U&#160;does&#160;not&#160;detect&#160;the&#160;phishing&#160;attempt&#160;by&#160;verifying&#160;</p>
<p style="position:absolute;top:961px;left:85px;white-space:nowrap" class="ft3115">the&#160;browser's&#160;security&#160;indicators.&#160;Thus,&#160;the&#160;user&#160;clicks&#160;on&#160;the&#160;submit&#160;button&#160;to&#160;log&#160;in.&#160;<br/>Now&#160;the&#160;attack&#160;is&#160;also&#160;detected&#160;because&#160;the&#160;wallet&#160;has&#160;stored&#160;credentials&#160;&#160;</p>
<p style="position:absolute;top:980px;left:777px;white-space:nowrap" class="ft3114">&#160;&#160;for&#160;</p>
<p style="position:absolute;top:1007px;left:85px;white-space:nowrap" class="ft3114">the&#160;host&#160;address&#160;of&#160;P&#160;and&#160;not&#160;&#160;</p>
<p style="position:absolute;top:1007px;left:391px;white-space:nowrap" class="ft3114">&#160;&#160;for&#160;the&#160;host&#160;address&#160;of&#160;A.&#160;Therefore,&#160;the&#160;wallet&#160;</p>
<p style="position:absolute;top:1033px;left:85px;white-space:nowrap" class="ft3118">now&#160;runs&#160;the&#160;setup&#160;for&#160;A&#160;instead&#160;of&#160;using&#160;the&#160;credentials&#160;of&#160;P&#160;to&#160;log&#160;in.&#160;<br/>Even&#160;if&#160;U&#160;decides&#160;to&#160;run&#160;the&#160;setup&#160;for&#160;A&#160;using&#160;the&#160;credentials&#160;</p>
<p style="position:absolute;top:1062px;left:647px;white-space:nowrap" class="ft3114">,&#160;the&#160;adversary&#160;will&#160;</p>
<p style="position:absolute;top:1088px;left:85px;white-space:nowrap" class="ft3114">still&#160;not&#160;gain&#160;the&#160;credentials&#160;</p>
<p style="position:absolute;top:1088px;left:369px;white-space:nowrap" class="ft3114">&#160;because&#160;the&#160;wallet&#160;updates&#160;the&#160;entered&#160;credentials&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft317">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft317">31/109</p>
</div>
<!-- Page 32 -->
<a name="32"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page32-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application032.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3212">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft320">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft324">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft324">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft3214">to&#160;&#160;</p>
<p style="position:absolute;top:151px;left:215px;white-space:nowrap" class="ft3214">.&#160;&#160;&#160;The&#160;&#160;&#160;hash&#160;&#160;&#160;function&#160;&#160;&#160;used&#160;&#160;&#160;to&#160;&#160;&#160;generate&#160;&#160;</p>
<p style="position:absolute;top:151px;left:682px;white-space:nowrap" class="ft3214">&#160;&#160;is&#160;&#160;&#160;a&#160;&#160;&#160;one-way&#160;</p>
<p style="position:absolute;top:181px;left:85px;white-space:nowrap" class="ft3214">function&#160;&#160;&#160;and&#160;&#160;&#160;thus,&#160;&#160;&#160;a&#160;&#160;&#160;computationally&#160;&#160;&#160;bounded&#160;&#160;&#160;adversary&#160;&#160;&#160;is&#160;&#160;&#160;not&#160;&#160;&#160;able&#160;&#160;&#160;to&#160;&#160;&#160;deduce&#160;</p>
<p style="position:absolute;top:200px;left:195px;white-space:nowrap" class="ft3214">.&#160;</p>
<p style="position:absolute;top:257px;left:85px;white-space:nowrap" class="ft324">&#160;</p>
<p style="position:absolute;top:257px;left:90px;white-space:nowrap" class="ft323"><b>Unlocked&#160;Password&#160;Forms&#160;</b></p>
<p style="position:absolute;top:283px;left:85px;white-space:nowrap" class="ft3215">The&#160;&#160;&#160;wallet&#160;&#160;&#160;locks&#160;&#160;&#160;the&#160;&#160;&#160;password&#160;&#160;&#160;fields&#160;&#160;&#160;of&#160;&#160;&#160;each&#160;&#160;&#160;web&#160;&#160;&#160;form&#160;&#160;&#160;by&#160;&#160;&#160;inserting&#160;&#160;&#160;the&#160;&#160;disabled&#160;<br/>attribute&#160;into&#160;the&#160;corresponding&#160;&#160;&lt;input&gt;&#160;&#160;tags.&#160;Thus,&#160;the&#160;user&#160;can&#160;no&#160;longer&#160;enter&#160;<br/>values&#160;&#160;&#160;and&#160;&#160;cannot&#160;&#160;&#160;submit&#160;&#160;&#160;the&#160;&#160;&#160;form&#160;&#160;with&#160;&#160;&#160;valid&#160;&#160;content.&#160;&#160;&#160;Yet,&#160;&#160;&#160;it&#160;&#160;&#160;is&#160;&#160;&#160;also&#160;&#160;&#160;easy&#160;&#160;&#160;for&#160;&#160;&#160;an&#160;<br/>adversary&#160;to&#160;counter&#160;this.&#160;Each&#160;element&#160;of&#160;an&#160;HTML&#160;form&#160;is&#160;exposed&#160;through&#160;the&#160;<br/>Document&#160;Object&#160;Model&#160;and&#160;has&#160;a&#160;disabled&#160;property.&#160;This&#160;property&#160;can&#160;be&#160;accessed&#160;<br/>with&#160;&#160;&#160;JavaScript&#160;&#160;&#160;and&#160;&#160;edited&#160;&#160;&#160;while&#160;&#160;&#160;the&#160;&#160;&#160;page&#160;&#160;&#160;is&#160;&#160;&#160;displayed.&#160;&#160;&#160;Thus,&#160;&#160;&#160;an&#160;&#160;&#160;attacker&#160;&#160;&#160;who&#160;&#160;is&#160;<br/>aware&#160;of&#160;the&#160;wallet&#160;and&#160;wants&#160;to&#160;counter&#160;the&#160;wallet's&#160;locking&#160;mechanism&#160;after&#160;it&#160;has&#160;<br/>locked&#160;the&#160;password&#160;fields&#160;for&#160;his&#160;phishing&#160;site,&#160;could&#160;include&#160;a&#160;script&#160;that&#160;unlocks&#160;all&#160;<br/>login&#160;form&#160;elements&#160;either&#160;in&#160;the&#160;&#160;OnLoad&#160;&#160;event&#160;or&#160;after&#160;some&#160;arbitrary&#160;timespan.&#160;<br/>Since&#160;there&#160;is&#160;an&#160;almost&#160;endless&#160;number&#160;of&#160;possibilities&#160;for&#160;the&#160;attacker&#160;to&#160;execute&#160;<br/>this&#160;&#160;&#160;JavaScript&#160;&#160;&#160;code,&#160;&#160;&#160;it&#160;&#160;&#160;cannot&#160;&#160;&#160;be&#160;&#160;&#160;countered&#160;&#160;&#160;effectively.&#160;&#160;&#160;Basically&#160;&#160;&#160;every&#160;<br/>transformation&#160;the&#160;wallet&#160;applies&#160;to&#160;the&#160;login&#160;form&#160;could&#160;be&#160;reversed&#160;with&#160;JavaScript&#160;<br/>code.&#160;Even&#160;if&#160;the&#160;wallet&#160;removed&#160;the&#160;form&#160;elements&#160;completely,&#160;they&#160;could&#160;be&#160;added&#160;<br/>dynamically&#160;&#160;&#160;at&#160;&#160;&#160;runtime&#160;&#160;&#160;again,&#160;&#160;&#160;provided&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;attacker&#160;&#160;&#160;knows&#160;&#160;&#160;the&#160;&#160;&#160;wallet's&#160;<br/>transformation&#160;algorithm.&#160;Besides&#160;using&#160;JavaScript,&#160;the&#160;adversary&#160;could&#160;also&#160;employ&#160;<br/>malware&#160;installed&#160;in&#160;the&#160;browser&#160;compartment&#160;to&#160;unlock&#160;locked&#160;password&#160;forms,&#160;i.e.&#160;<br/>this&#160;attack&#160;is&#160;not&#160;confined&#160;to&#160;a&#160;JavaScript&#160;attack.&#160;An&#160;adversary&#160;targeting&#160;users&#160;with&#160;<br/>security&#160;knowledge&#160;far&#160;below&#160;the&#160;average&#160;could&#160;even&#160;decide&#160;to&#160;include&#160;simple&#160;text&#160;<br/>fields&#160;instead&#160;of&#160;password&#160;fields&#160;into&#160;his&#160;login&#160;forms&#160;so&#160;that&#160;the&#160;wallet&#160;would&#160;not&#160;lock&#160;<br/>them&#160;in&#160;the&#160;first&#160;place.&#160;<br/>As&#160;a&#160;result&#160;of&#160;all&#160;those&#160;considerations,&#160;the&#160;locking&#160;of&#160;password&#160;forms&#160;is&#160;not&#160;a&#160;security&#160;<br/>enhancement&#160;since&#160;there&#160;is&#160;no&#160;way&#160;to&#160;guarantee&#160;that&#160;a&#160;form&#160;will&#160;stay&#160;locked.&#160;The&#160;<br/>mechanism&#160;merely&#160;serves&#160;as&#160;a&#160;reminder&#160;for&#160;the&#160;user&#160;to&#160;use&#160;the&#160;Secure&#160;Wallet&#160;and&#160;not&#160;<br/>the&#160;web&#160;form&#160;itself&#160;to&#160;login.&#160;If&#160;the&#160;adversary&#160;manages&#160;to&#160;unlock&#160;the&#160;password&#160;form,&#160;<br/>the&#160;user&#160;might&#160;be&#160;tempted&#160;to&#160;enter&#160;her&#160;credentials&#160;into&#160;it,&#160;especially&#160;if&#160;she&#160;is&#160;not&#160;yet&#160;<br/>accustomed&#160;to&#160;using&#160;the&#160;wallet.&#160;Because&#160;she&#160;does&#160;not&#160;know&#160;</p>
<p style="position:absolute;top:772px;left:647px;white-space:nowrap" class="ft3214">&#160;,&#160;she&#160;enters&#160;</p>
<p style="position:absolute;top:772px;left:808px;white-space:nowrap" class="ft3214">&#160;</p>
<p style="position:absolute;top:802px;left:85px;white-space:nowrap" class="ft3215">into&#160;the&#160;password&#160;field&#160;and&#160;sends&#160;it&#160;to&#160;A.&#160;Thus,&#160;the&#160;adversary&#160;does&#160;not&#160;receive&#160;the&#160;<br/>current&#160;credentials&#160;for&#160;P&#160;but&#160;outdated&#160;ones.&#160;If&#160;U&#160;uses&#160;</p>
<p style="position:absolute;top:821px;left:605px;white-space:nowrap" class="ft3214">&#160;for&#160;other&#160;web&#160;sites&#160;not&#160;</p>
<p style="position:absolute;top:849px;left:85px;white-space:nowrap" class="ft3215">protected&#160;by&#160;the&#160;wallet&#160;as&#160;well,&#160;A&#160;might&#160;gain&#160;access&#160;to&#160;those&#160;sites,&#160;but&#160;the&#160;main&#160;<br/>objective&#160;&#160;&#160;being&#160;&#160;&#160;the&#160;&#160;&#160;preservation&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;confidentiality&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;user's&#160;&#160;&#160;credentials&#160;&#160;&#160;is&#160;<br/>fulfilled&#160;with&#160;respect&#160;to&#160;P&#160;and&#160;other&#160;sites&#160;protected&#160;by&#160;the&#160;wallet.&#160;</p>
<p style="position:absolute;top:934px;left:85px;white-space:nowrap" class="ft326"><b>Redirection&#160;Attack&#160;</b></p>
<p style="position:absolute;top:960px;left:85px;white-space:nowrap" class="ft3215">A&#160;redirection&#160;attack&#160;in&#160;the&#160;wallet&#160;model&#160;(see<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#29">&#160;Figure&#160;9)</a>&#160;is&#160;an&#160;attack&#160;that&#160;attempts&#160;to&#160;<br/>replace&#160;the&#160;channels&#160;</p>
<p style="position:absolute;top:979px;left:313px;white-space:nowrap" class="ft3214">&#160;and&#160;</p>
<p style="position:absolute;top:979px;left:410px;white-space:nowrap" class="ft3214">&#160;with&#160;</p>
<p style="position:absolute;top:979px;left:507px;white-space:nowrap" class="ft3214">&#160;and&#160;</p>
<p style="position:absolute;top:979px;left:605px;white-space:nowrap" class="ft3214">,&#160;respectively.&#160;Since&#160;the&#160;</p>
<p style="position:absolute;top:1006px;left:85px;white-space:nowrap" class="ft3215">wallet&#160;uses&#160;the&#160;host&#160;name&#160;of&#160;a&#160;web&#160;site&#160;to&#160;find&#160;the&#160;corresponding&#160;stored&#160;credentials,&#160;<br/>only&#160;redirection&#160;attacks&#160;that&#160;preserve&#160;the&#160;original&#160;host&#160;name&#160;of&#160;P&#160;are&#160;relevant&#160;to&#160;this&#160;<br/>discussion.&#160;A&#160;common&#160;example&#160;for&#160;this&#160;kind&#160;of&#160;attack&#160;is&#160;the&#160;DNS&#160;spoofing&#160;attack&#160;[19].&#160;<br/>Other&#160;forms&#160;of&#160;redirection&#160;attacks&#160;targeting&#160;lower&#160;layers&#160;of&#160;the&#160;TCP&#160;stack,&#160;e.g.&#160;ARP&#160;<br/>spoofing&#160;[68],&#160;have&#160;the&#160;same&#160;result&#160;as&#160;far&#160;as&#160;the&#160;wallet&#160;is&#160;concerned,&#160;i.e.&#160;the&#160;traffic&#160;is&#160;<br/>routed&#160;to&#160;the&#160;rogue&#160;server&#160;A&#160;while&#160;the&#160;wallet&#160;receives&#160;P&#160;as&#160;the&#160;host&#160;name.&#160;Note&#160;that&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft327">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft327">32/109</p>
</div>
<!-- Page 33 -->
<a name="33"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page33-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application033.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3312">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft330">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft334">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft334">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft3315">although&#160;this&#160;attack&#160;is&#160;discussed&#160;as&#160;part&#160;of&#160;the&#160;classical&#160;phishing&#160;attacks,&#160;it&#160;can&#160;also&#160;<br/>appear&#160;as&#160;a&#160;form&#160;of&#160;malware&#160;phishing&#160;attack&#160;if&#160;the&#160;redirection&#160;occurs&#160;inside&#160;of&#160;the&#160;<br/>user's&#160;machine.&#160;The&#160;implications&#160;are&#160;the&#160;same,&#160;though.&#160;</p>
<p style="position:absolute;top:220px;left:85px;white-space:nowrap" class="ft3314">If&#160;the&#160;adversary&#160;uses&#160;a&#160;legitimate&#160;SSL&#160;certificate&#160;</p>
<p style="position:absolute;top:220px;left:557px;white-space:nowrap" class="ft3314">&#160;issued&#160;to&#160;the&#160;fake&#160;host&#160;name&#160;</p>
<p style="position:absolute;top:253px;left:85px;white-space:nowrap" class="ft3315">A,&#160;the&#160;attack&#160;will&#160;be&#160;detected&#160;immediately&#160;because&#160;the&#160;host&#160;name&#160;in&#160;the&#160;certificate&#160;<br/>does&#160;not&#160;&#160;match&#160;the&#160;original&#160;host&#160;name&#160;of&#160;P.&#160;All&#160;&#160;other&#160;cases&#160;where&#160;the&#160;adversary&#160;<br/>presents&#160;a&#160;certificate&#160;with&#160;the&#160;original&#160;hostname&#160;are&#160;countered&#160;by&#160;comparing&#160;the&#160;<br/>digital&#160;fingerprints&#160;of&#160;the&#160;stored&#160;certificate&#160;and&#160;the&#160;certificate&#160;received&#160;during&#160;the&#160;<br/>current&#160;SSL&#160;handshake.&#160;<br/>There&#160;&#160;&#160;are&#160;&#160;&#160;several&#160;&#160;&#160;possible&#160;&#160;&#160;cases&#160;&#160;&#160;where&#160;&#160;&#160;the&#160;&#160;&#160;fingerprints&#160;&#160;&#160;do&#160;&#160;&#160;not&#160;&#160;&#160;match.&#160;&#160;&#160;If&#160;&#160;&#160;the&#160;<br/>adversary&#160;manages&#160;to&#160;obtain&#160;a&#160;valid&#160;certificate&#160;for&#160;the&#160;host&#160;address&#160;of&#160;P&#160;in&#160;spite&#160;of&#160;<br/>Assumption&#160;4&#160;&#160;&#160;(</p>
<p style="position:absolute;top:396px;left:216px;white-space:nowrap" class="ft3320"><i>Trustworthy&#160;&#160;&#160;PKI</i></p>
<p style="position:absolute;top:396px;left:360px;white-space:nowrap" class="ft3314">),&#160;&#160;&#160;the&#160;&#160;&#160;attack&#160;&#160;&#160;is&#160;&#160;&#160;detected&#160;&#160;&#160;as&#160;&#160;&#160;long&#160;&#160;&#160;as&#160;&#160;&#160;the&#160;&#160;&#160;received&#160;</p>
<p style="position:absolute;top:415px;left:85px;white-space:nowrap" class="ft3315">certificate&#160;&#160;&#160;contains&#160;&#160;&#160;another&#160;&#160;&#160;public&#160;&#160;&#160;key&#160;&#160;&#160;than&#160;&#160;&#160;the&#160;&#160;&#160;stored&#160;&#160;&#160;certificate.&#160;&#160;&#160;Should&#160;&#160;&#160;the&#160;<br/>adversary&#160;be&#160;able&#160;to&#160;steal&#160;the&#160;private&#160;key&#160;of&#160;the&#160;stored&#160;certificate,&#160;the&#160;attack&#160;will&#160;not&#160;<br/>be&#160;detected.&#160;It&#160;can&#160;only&#160;be&#160;detected&#160;if&#160;the&#160;key&#160;has&#160;been&#160;revoked&#160;because&#160;the&#160;wallet&#160;<br/>should&#160;check&#160;certificate&#160;revocation&#160;lists&#160;(CRLs)&#160;every&#160;time&#160;the&#160;fingerprints&#160;do&#160;not&#160;<br/>match.&#160;The&#160;case&#160;where&#160;the&#160;adversary&#160;can&#160;steal&#160;an&#160;active,&#160;unrevoked&#160;key&#160;is&#160;excluded&#160;<br/>by&#160;Assumption&#160;5&#160;(</p>
<p style="position:absolute;top:511px;left:236px;white-space:nowrap" class="ft3320"><i>Private&#160;key&#160;protection</i></p>
<p style="position:absolute;top:511px;left:422px;white-space:nowrap" class="ft3314">),&#160;though.&#160;</p>
<p style="position:absolute;top:539px;left:85px;white-space:nowrap" class="ft3315">As&#160;already&#160;pointed&#160;out&#160;above,&#160;the&#160;client&#160;is&#160;unable&#160;to&#160;detect&#160;a&#160;redirection&#160;attack&#160;if&#160;the&#160;<br/>connection&#160;is&#160;unprotected.&#160;Thus,&#160;the&#160;wallet&#160;will&#160;disclose&#160;the&#160;user's&#160;credentials&#160;if&#160;the&#160;<br/>adversary&#160;redirects&#160;a&#160;plain&#160;HTTP&#160;connection.&#160;Protecting&#160;against&#160;this&#160;kind&#160;of&#160;attacks&#160;<br/>is&#160;out&#160;of&#160;scope&#160;of&#160;this&#160;work.&#160;A&#160;service&#160;provider&#160;can&#160;provide&#160;protection&#160;by&#160;using&#160;the&#160;<br/>SSL&#160;protocol.</p>
<p style="position:absolute;top:662px;left:85px;white-space:nowrap" class="ft336"><b>2.5.4&#160;Protection&#160;against&#160;Online&#160;Malware&#160;Phishing&#160;Attacks&#160;</b></p>
<p style="position:absolute;top:689px;left:85px;white-space:nowrap" class="ft3315">A&#160;&#160;&#160;malware&#160;&#160;&#160;phishing&#160;&#160;&#160;attack&#160;&#160;&#160;attempts&#160;&#160;&#160;to&#160;&#160;&#160;steal&#160;&#160;&#160;credentials&#160;&#160;&#160;on&#160;&#160;&#160;the&#160;&#160;&#160;user's&#160;&#160;&#160;system,&#160;<br/>preferably&#160;without&#160;the&#160;user&#160;noticing&#160;the&#160;theft.&#160;Installation&#160;of&#160;malware&#160;can&#160;occur&#160;in&#160;<br/>two&#160;&#160;&#160;different&#160;&#160;&#160;ways.&#160;&#160;&#160;Either&#160;&#160;&#160;it&#160;&#160;&#160;may&#160;&#160;&#160;be&#160;&#160;&#160;installed&#160;&#160;</p>
<p style="position:absolute;top:727px;left:514px;white-space:nowrap" class="ft3320"><i>online</i></p>
<p style="position:absolute;top:727px;left:566px;white-space:nowrap" class="ft3314">,&#160;&#160;&#160;i.e.&#160;&#160;&#160;while&#160;&#160;&#160;the&#160;&#160;&#160;machine&#160;&#160;&#160;is&#160;</p>
<p style="position:absolute;top:746px;left:85px;white-space:nowrap" class="ft3314">running,&#160;or&#160;&#160;</p>
<p style="position:absolute;top:746px;left:189px;white-space:nowrap" class="ft3320"><i>offline</i></p>
<p style="position:absolute;top:746px;left:242px;white-space:nowrap" class="ft3314">,&#160;i.e.&#160;an&#160;adversary&#160;boots&#160;another&#160;operating&#160;system&#160;(e.g.&#160;from&#160;CD-</p>
<p style="position:absolute;top:766px;left:85px;white-space:nowrap" class="ft3315">ROM)&#160;and&#160;installs&#160;the&#160;malware.&#160;This&#160;section&#160;deals&#160;with&#160;the&#160;online&#160;attacks.&#160;Offline&#160;<br/>attacks&#160;are&#160;discussed&#160;in&#160;Section&#160;2.7.5.&#160;</p>
<p style="position:absolute;top:831px;left:85px;white-space:nowrap" class="ft336"><b>Confinement&#160;to&#160;the&#160;Untrusted&#160;Compartment&#160;</b></p>
<p style="position:absolute;top:858px;left:85px;white-space:nowrap" class="ft3315">Most&#160;of&#160;the&#160;user's&#160;work&#160;takes&#160;place&#160;in&#160;the&#160;untrusted&#160;compartment.&#160;This&#160;untrusted&#160;<br/>compartment&#160;represents&#160;the&#160;legacy&#160;system,&#160;i.e.&#160;a&#160;system&#160;without&#160;the&#160;security&#160;kernel&#160;<br/>and&#160;the&#160;wallet.&#160;Thus,&#160;malware&#160;can&#160;be&#160;installed&#160;in&#160;this&#160;compartment&#160;in&#160;the&#160;same&#160;way&#160;<br/>as&#160;on&#160;a&#160;legacy&#160;system.&#160;To&#160;meet&#160;Requirement&#160;1&#160;(</p>
<p style="position:absolute;top:915px;left:500px;white-space:nowrap" class="ft3320"><i>System&#160;Integrity</i></p>
<p style="position:absolute;top:915px;left:641px;white-space:nowrap" class="ft3314">),&#160;it&#160;must&#160;be&#160;shown&#160;</p>
<p style="position:absolute;top:934px;left:85px;white-space:nowrap" class="ft3315">that&#160;online&#160;malware&#160;attacks&#160;can&#160;only&#160;affect&#160;the&#160;untrusted&#160;compartment&#160;and&#160;cannot&#160;<br/>be&#160;installed&#160;outside&#160;of&#160;this&#160;compartment.&#160;<br/>The&#160;&#160;&#160;security&#160;&#160;&#160;kernel&#160;&#160;&#160;and&#160;&#160;&#160;all&#160;&#160;&#160;other&#160;&#160;&#160;compartments&#160;&#160;&#160;are&#160;&#160;&#160;not&#160;&#160;&#160;designed&#160;&#160;&#160;to&#160;&#160;&#160;offer&#160;&#160;&#160;any&#160;<br/>mechanisms&#160;to&#160;install&#160;software&#160;at&#160;runtime.&#160;They&#160;are&#160;installed&#160;once&#160;and&#160;need&#160;not&#160;to&#160;be&#160;<br/>changed&#160;&#160;&#160;afterwards.&#160;&#160;&#160;Ideally,&#160;&#160;&#160;the&#160;&#160;&#160;security&#160;&#160;&#160;kernel&#160;&#160;&#160;has&#160;&#160;&#160;been&#160;&#160;&#160;formally&#160;&#160;&#160;verified&#160;&#160;&#160;and&#160;<br/>contains&#160;no&#160;security&#160;vulnerabilities.&#160;Since&#160;the&#160;kernel&#160;is&#160;based&#160;on&#160;a&#160;microkernel,&#160;it&#160;has&#160;<br/>a&#160;very&#160;small&#160;size,&#160;which&#160;makes&#160;it&#160;easier&#160;to&#160;formally&#160;verify&#160;any&#160;security&#160;properties.&#160;<br/>Moreover,&#160;it&#160;was&#160;developed&#160;with&#160;special&#160;care&#160;and&#160;focused&#160;on&#160;the&#160;security&#160;tasks&#160;it&#160;<br/>provides.&#160;&#160;Thus,&#160;&#160;&#160;it&#160;&#160;&#160;will&#160;&#160;&#160;statistically&#160;&#160;&#160;have&#160;&#160;&#160;less&#160;&#160;security&#160;&#160;&#160;vulnerabilities&#160;&#160;and&#160;&#160;a&#160;&#160;smaller&#160;<br/>attack&#160;surface&#160;than&#160;legacy&#160;systems&#160;and&#160;hence,&#160;it&#160;is&#160;reasonable&#160;to&#160;assume&#160;that&#160;no&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft337">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft337">33/109</p>
</div>
<!-- Page 34 -->
<a name="34"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page34-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application034.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3412">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft340">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft344">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft344">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft3415">malware&#160;can&#160;successfully&#160;target&#160;the&#160;kernel&#160;itself.<br/>Assuming&#160;that&#160;the&#160;security&#160;kernel&#160;provides&#160;isolation&#160;for&#160;the&#160;different&#160;compartments&#160;<br/>(i.e.&#160;&#160;&#160;it&#160;&#160;&#160;meets&#160;&#160;&#160;Requirement&#160;2&#160;&#160;&#160;(</p>
<p style="position:absolute;top:198px;left:357px;white-space:nowrap" class="ft3420"><i>Isolation</i></p>
<p style="position:absolute;top:198px;left:429px;white-space:nowrap" class="ft3414">)),&#160;&#160;&#160;malware&#160;&#160;&#160;installed&#160;&#160;&#160;in&#160;&#160;&#160;one&#160;&#160;&#160;compartment&#160;</p>
<p style="position:absolute;top:218px;left:85px;white-space:nowrap" class="ft3415">cannot&#160;&#160;&#160;affect&#160;&#160;&#160;another&#160;&#160;&#160;compartment&#160;&#160;&#160;in&#160;&#160;&#160;any&#160;&#160;&#160;way.&#160;&#160;&#160;If&#160;&#160;&#160;the&#160;&#160;&#160;untrusted&#160;&#160;&#160;compartment&#160;<br/>contains&#160;&#160;&#160;any&#160;&#160;&#160;malware,&#160;&#160;&#160;it&#160;&#160;&#160;has&#160;&#160;&#160;no&#160;&#160;&#160;effect&#160;&#160;&#160;on&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;compartment&#160;&#160;&#160;or&#160;&#160;&#160;the&#160;&#160;&#160;virtual&#160;<br/>network&#160;&#160;&#160;compartment.&#160;&#160;&#160;Although&#160;&#160;&#160;the&#160;&#160;&#160;current&#160;&#160;&#160;implementations&#160;&#160;&#160;for&#160;&#160;&#160;those&#160;&#160;&#160;trusted&#160;<br/>compartments&#160;use&#160;a&#160;full&#160;Linux&#160;system&#160;including&#160;the&#160;kernel&#160;and&#160;numerous&#160;libraries&#160;<br/>and&#160;&#160;&#160;are&#160;&#160;&#160;as&#160;&#160;&#160;such&#160;&#160;&#160;vulnerable&#160;&#160;&#160;to&#160;&#160;&#160;various&#160;&#160;&#160;attacks,&#160;&#160;&#160;they&#160;&#160;&#160;are&#160;&#160;&#160;just&#160;&#160;&#160;prototype&#160;<br/>implementations.&#160;&#160;&#160;A&#160;&#160;&#160;release&#160;&#160;&#160;implementation&#160;&#160;&#160;could&#160;&#160;&#160;realize&#160;&#160;&#160;those&#160;&#160;&#160;compartments&#160;&#160;&#160;as&#160;<br/>native&#160;&#160;&#160;L4-services.&#160;&#160;&#160;This&#160;&#160;&#160;would&#160;&#160;&#160;reduce&#160;&#160;&#160;their&#160;&#160;&#160;size&#160;&#160;&#160;and&#160;&#160;&#160;lower&#160;&#160;&#160;their&#160;&#160;&#160;attack&#160;&#160;&#160;surface&#160;<br/>significantly&#160;and&#160;we&#160;can&#160;assume&#160;that&#160;they&#160;cannot&#160;be&#160;direct&#160;malware&#160;targets&#160;just&#160;as&#160;<br/>the&#160;security&#160;kernel&#160;itself.As&#160;a&#160;consequence,&#160;we&#160;can&#160;assume&#160;that&#160;the&#160;proposed&#160;system&#160;<br/>architecture&#160;&#160;&#160;only&#160;&#160;&#160;allows&#160;&#160;&#160;installation&#160;&#160;&#160;of&#160;&#160;&#160;malicious&#160;&#160;&#160;software&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;&#160;&#160;untrusted&#160;<br/>compartment&#160;and&#160;thus&#160;meets&#160;Requirement&#160;1&#160;(</p>
<p style="position:absolute;top:410px;left:475px;white-space:nowrap" class="ft3420"><i>System&#160;Integrity</i></p>
<p style="position:absolute;top:410px;left:615px;white-space:nowrap" class="ft3414">).&#160;The&#160;concrete&#160;attacks&#160;</p>
<p style="position:absolute;top:429px;left:85px;white-space:nowrap" class="ft3414">against&#160;the&#160;untrusted&#160;compartment&#160;are&#160;discussed&#160;in&#160;the&#160;next&#160;section.&#160;</p>
<p style="position:absolute;top:475px;left:85px;white-space:nowrap" class="ft347">&#160;</p>
<p style="position:absolute;top:475px;left:90px;white-space:nowrap" class="ft346"><b>Attacks&#160;against&#160;the&#160;Untrusted&#160;Compartment&#160;</b></p>
<p style="position:absolute;top:502px;left:85px;white-space:nowrap" class="ft3415">Numerous&#160;malware&#160;attacks&#160;against&#160;the&#160;untrusted&#160;compartment&#160;are&#160;imaginable,&#160;since&#160;<br/>this&#160;&#160;&#160;compartment&#160;&#160;&#160;represents&#160;&#160;&#160;a&#160;&#160;&#160;legacy&#160;&#160;&#160;system.&#160;&#160;&#160;Therefore,&#160;&#160;&#160;all&#160;&#160;&#160;attacks&#160;&#160;&#160;targeting&#160;&#160;&#160;a&#160;<br/>legacy&#160;system&#160;could&#160;be&#160;mounted&#160;against&#160;the&#160;untrusted&#160;compartment&#160;as&#160;well.&#160;In&#160;fact,&#160;<br/>we&#160;can&#160;assume&#160;that&#160;the&#160;whole&#160;compartment&#160;can&#160;be&#160;modified&#160;by&#160;an&#160;adversary&#160;in&#160;any&#160;<br/>way.&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#34">&#160;Figure&#160;&#160;&#160;10&#160;&#160;</a>shows&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;untrusted&#160;&#160;&#160;compartment&#160;&#160;&#160;has&#160;&#160;&#160;two&#160;&#160;&#160;primary&#160;<br/>communication&#160;&#160;&#160;channels,&#160;&#160;</p>
<p style="position:absolute;top:598px;left:388px;white-space:nowrap" class="ft3414">&#160;&#160;being&#160;&#160;&#160;user&#160;&#160;&#160;input&#160;&#160;&#160;and&#160;&#160;output&#160;&#160;&#160;and&#160;&#160;</p>
<p style="position:absolute;top:598px;left:808px;white-space:nowrap" class="ft3414">&#160;</p>
<p style="position:absolute;top:626px;left:85px;white-space:nowrap" class="ft3415">being&#160;the&#160;connection&#160;to&#160;the&#160;security&#160;kernel.&#160;To&#160;prove&#160;that&#160;the&#160;adversary&#160;can&#160;still&#160;not&#160;<br/>gain&#160;access&#160;to&#160;the&#160;user's&#160;credentials,&#160;it&#160;is&#160;sufficient&#160;to&#160;show&#160;that&#160;the&#160;credentials&#160;are&#160;<br/>(i)&#160;never&#160;sent&#160;over&#160;&#160;</p>
<p style="position:absolute;top:664px;left:368px;white-space:nowrap" class="ft3414">&#160;&#160;and&#160;(ii)&#160;never&#160;entered&#160;directly&#160;into&#160;the&#160;untrusted&#160;</p>
<p style="position:absolute;top:693px;left:85px;white-space:nowrap" class="ft3414">compartment&#160;over&#160;</p>
<p style="position:absolute;top:693px;left:320px;white-space:nowrap" class="ft3414">.&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft347">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft347">34/109</p>
</div>
<!-- Page 35 -->
<a name="35"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page35-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application035.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3512">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft350">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft354">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft354">Final</p>
<p style="position:absolute;top:588px;left:779px;white-space:nowrap" class="ft3514">&#160;</p>
<p style="position:absolute;top:609px;left:85px;white-space:nowrap" class="ft3521"><b>Figure&#160;10:</b></p>
<p style="position:absolute;top:609px;left:181px;white-space:nowrap" class="ft3514">&#160;The&#160;Internal&#160;Communication&#160;Channels</p>
<p style="position:absolute;top:657px;left:85px;white-space:nowrap" class="ft3515">The&#160;wallet&#160;discloses&#160;the&#160;user's&#160;credentials&#160;only&#160;as&#160;part&#160;of&#160;a&#160;HTTP&#160;POST&#160;request,&#160;i.e.&#160;<br/>the&#160;variables&#160;contained&#160;in&#160;the&#160;request&#160;body&#160;are&#160;replaced&#160;with&#160;stored&#160;values.&#160;This&#160;<br/>POST&#160;request,&#160;which&#160;is&#160;completely&#160;processed&#160;in&#160;the&#160;trusted&#160;wallet&#160;compartment,&#160;is&#160;<br/>never&#160;sent&#160;back&#160;to&#160;the&#160;untrusted&#160;compartment&#160;but&#160;&#160;&#160;directly&#160;to&#160;the&#160;intended&#160;remote&#160;<br/>server&#160;using&#160;</p>
<p style="position:absolute;top:734px;left:264px;white-space:nowrap" class="ft3514">&#160;or&#160;to&#160;another&#160;trusted&#160;compartment&#160;dedicated&#160;to&#160;network&#160;access&#160;</p>
<p style="position:absolute;top:761px;left:85px;white-space:nowrap" class="ft3514">using&#160;</p>
<p style="position:absolute;top:761px;left:230px;white-space:nowrap" class="ft3514">.&#160;This&#160;also&#160;holds&#160;true&#160;if&#160;the&#160;POST&#160;request&#160;never&#160;reaches&#160;the&#160;wallet,&#160;</p>
<p style="position:absolute;top:789px;left:85px;white-space:nowrap" class="ft3515">e.g.&#160;if&#160;the&#160;adversary&#160;prevents&#160;the&#160;requests&#160;from&#160;being&#160;sent&#160;to&#160;it.&#160;In&#160;this&#160;case&#160;the&#160;<br/>request&#160;is&#160;never&#160;modified&#160;by&#160;the&#160;wallet&#160;and&#160;can&#160;receive&#160;no&#160;credentials.&#160;As&#160;a&#160;result,&#160;<br/>credentials&#160;are&#160;never&#160;sent&#160;to&#160;the&#160;untrusted&#160;compartment&#160;or&#160;even&#160;forwarded&#160;through&#160;<br/>it.&#160;No&#160;modification&#160;of&#160;the&#160;untrusted&#160;compartment&#160;can&#160;affect&#160;the&#160;wallet&#160;or&#160;the&#160;network&#160;<br/>connection&#160;&#160;&#160;in&#160;&#160;&#160;such&#160;&#160;&#160;a&#160;&#160;&#160;way&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;adversary&#160;&#160;&#160;receives&#160;&#160;&#160;the&#160;&#160;&#160;user's&#160;&#160;&#160;credentials&#160;&#160;&#160;over&#160;</p>
<p style="position:absolute;top:885px;left:195px;white-space:nowrap" class="ft3514">.&#160;</p>
<p style="position:absolute;top:923px;left:85px;white-space:nowrap" class="ft3515">Nevertheless,&#160;the&#160;adversary&#160;can&#160;attempt&#160;to&#160;receive&#160;credentials&#160;from&#160;the&#160;user&#160;directly.&#160;<br/>Since&#160;we&#160;assume&#160;that&#160;he&#160;can&#160;modify&#160;the&#160;untrusted&#160;compartment&#160;in&#160;any&#160;way,&#160;he&#160;can&#160;<br/>also&#160;&#160;&#160;fake&#160;&#160;&#160;any&#160;&#160;&#160;user&#160;&#160;&#160;interfaces&#160;&#160;&#160;and&#160;&#160;&#160;persuade&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;to&#160;&#160;&#160;enter&#160;&#160;&#160;credentials&#160;&#160;&#160;using&#160;</p>
<p style="position:absolute;top:980px;left:161px;white-space:nowrap" class="ft3514">.&#160;But&#160;even&#160;if&#160;the&#160;user&#160;is&#160;tricked&#160;by&#160;those&#160;faked&#160;user&#160;interfaces,&#160;the&#160;adversary&#160;</p>
<p style="position:absolute;top:1008px;left:85px;white-space:nowrap" class="ft3515">still&#160;receives&#160;no&#160;current&#160;credentials&#160;because&#160;the&#160;user&#160;does&#160;not&#160;know&#160;them&#160;anymore.&#160;<br/>When&#160;the&#160;user&#160;set&#160;up&#160;the&#160;web&#160;site&#160;in&#160;the&#160;wallet,&#160;she&#160;also&#160;lets&#160;the&#160;wallet&#160;change&#160;her&#160;<br/>password&#160;afterwards,&#160;i.e.&#160;the&#160;only&#160;credentials&#160;she&#160;actually&#160;knows&#160;of&#160;are&#160;the&#160;outdated&#160;<br/>ones&#160;she&#160;used&#160;before.&#160;Thus,&#160;current&#160;credentials&#160;can&#160;never&#160;be&#160;sent&#160;to&#160;the&#160;untrusted&#160;<br/>compartment&#160;using&#160;</p>
<p style="position:absolute;top:1084px;left:329px;white-space:nowrap" class="ft3514">.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft357">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft357">35/109</p>
</div>
<!-- Page 36 -->
<a name="36"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page36-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application036.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3612">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft360">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft364">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft364">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft3615">In&#160;the&#160;following&#160;paragraphs&#160;some&#160;attacks&#160;that&#160;have&#160;been&#160;effective&#160;on&#160;legacy&#160;systems&#160;<br/>in&#160;the&#160;past&#160;are&#160;discussed.&#160;These&#160;are&#160;(i)&#160;the&#160;installation&#160;of&#160;a&#160;key&#160;logger&#160;and&#160;(ii)&#160;the&#160;<br/>display&#160;of&#160;fake&#160;dialogs&#160;to&#160;trick&#160;the&#160;user&#160;to&#160;enter&#160;her&#160;credentials.&#160;A&#160;third&#160;category&#160;of&#160;<br/>potential&#160;attacks&#160;covers&#160;attacks&#160;on&#160;the&#160;browser&#160;to&#160;(iii)&#160;unlock&#160;forms&#160;previously&#160;locked&#160;<br/>by&#160;the&#160;wallet&#160;or&#160;to&#160;(iv)&#160;remove&#160;the&#160;wallet's&#160;proxy&#160;assignment&#160;completely.&#160;</p>
<p style="position:absolute;top:274px;left:85px;white-space:nowrap" class="ft363"><b>Trusted&#160;Path&#160;</b></p>
<p style="position:absolute;top:301px;left:85px;white-space:nowrap" class="ft3615">Both&#160;the&#160;installation&#160;of&#160;a&#160;key&#160;logger&#160;and&#160;the&#160;display&#160;of&#160;a&#160;fake&#160;dialog&#160;are&#160;uncritical&#160;if&#160;<br/>Requirement&#160;4&#160;(</p>
<p style="position:absolute;top:320px;left:225px;white-space:nowrap" class="ft3620"><i>Trusted&#160;Path</i></p>
<p style="position:absolute;top:320px;left:336px;white-space:nowrap" class="ft3614">)&#160;is&#160;met&#160;and&#160;Assumption&#160;6&#160;(</p>
<p style="position:absolute;top:320px;left:582px;white-space:nowrap" class="ft3620"><i>Single&#160;Credential&#160;Storage&#160;</i></p>
<p style="position:absolute;top:339px;left:85px;white-space:nowrap" class="ft3620"><i>Mechanism</i></p>
<p style="position:absolute;top:339px;left:182px;white-space:nowrap" class="ft3614">)&#160;holds&#160;true.&#160;Thus,&#160;for&#160;both&#160;cases&#160;it&#160;is&#160;sufficient&#160;to&#160;show&#160;that&#160;the&#160;trusted&#160;</p>
<p style="position:absolute;top:358px;left:85px;white-space:nowrap" class="ft3615">path&#160;requirement&#160;is&#160;satisfied.&#160;<br/>Assuming&#160;that&#160;the&#160;user&#160;enters&#160;credentials&#160;only&#160;into&#160;the&#160;wallet&#160;she&#160;has&#160;to&#160;somehow&#160;<br/>access&#160;it.&#160;Since&#160;it&#160;resides&#160;in&#160;a&#160;separate&#160;compartment,&#160;in&#160;the&#160;current&#160;implementation&#160;<br/>the&#160;user&#160;has&#160;to&#160;press&#160;the&#160;F12&#160;key&#160;to&#160;switch&#160;compartments.&#160;The&#160;F12&#160;key&#160;is&#160;intercepted&#160;<br/>by&#160;&#160;&#160;the&#160;&#160;&#160;SecureGUI&#160;&#160;&#160;and&#160;&#160;&#160;cannot&#160;&#160;&#160;be&#160;&#160;&#160;received&#160;&#160;&#160;by&#160;&#160;&#160;any&#160;&#160;&#160;compartment.&#160;&#160;&#160;Therefore,&#160;&#160;&#160;no&#160;<br/>malware&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;&#160;&#160;untrusted&#160;&#160;&#160;compartment&#160;&#160;&#160;can&#160;&#160;&#160;prevent&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;from&#160;&#160;&#160;switching&#160;<br/>compartments.&#160;After&#160;the&#160;user&#160;has&#160;switched&#160;to&#160;the&#160;trusted&#160;wallet&#160;compartment,&#160;the&#160;<br/>untrusted&#160;&#160;&#160;compartment&#160;&#160;&#160;is&#160;&#160;&#160;made&#160;&#160;&#160;inactive&#160;&#160;&#160;and&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;compartment&#160;&#160;&#160;is&#160;&#160;&#160;now&#160;&#160;&#160;the&#160;<br/>active&#160;one.&#160;The&#160;SecureGUI&#160;asserts&#160;that&#160;all&#160;user&#160;input&#160;is&#160;received&#160;only&#160;by&#160;the&#160;active&#160;<br/>compartment,&#160;&#160;&#160;i.e.&#160;&#160;&#160;the&#160;&#160;&#160;malware&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;&#160;&#160;untrusted&#160;&#160;&#160;compartment&#160;&#160;&#160;never&#160;&#160;&#160;receives&#160;&#160;&#160;any&#160;<br/>keyboard&#160;events&#160;as&#160;long&#160;as&#160;the&#160;untrusted&#160;compartment&#160;&#160;in&#160;inactive.&#160;As&#160;a&#160;result,&#160;&#160;a&#160;<br/>keylogger&#160;never&#160;gains&#160;access&#160;to&#160;any&#160;credentials&#160;entered&#160;into&#160;the&#160;wallet.&#160;<br/>The&#160;display&#160;of&#160;faked&#160;dialogs,&#160;which&#160;is&#160;an&#160;attack&#160;commonly&#160;employed&#160;by&#160;trojan&#160;horse&#160;<br/>programs,&#160;can&#160;be&#160;constrained&#160;to&#160;dialogs&#160;resembling&#160;the&#160;wallet&#160;interface&#160;because&#160;of&#160;<br/>Assumption&#160;6&#160;&#160;&#160;(</p>
<p style="position:absolute;top:645px;left:217px;white-space:nowrap" class="ft3620"><i>Single&#160;&#160;&#160;Credential&#160;&#160;&#160;Storage&#160;&#160;&#160;Mechanism</i></p>
<p style="position:absolute;top:645px;left:554px;white-space:nowrap" class="ft3614">).&#160;&#160;&#160;When&#160;&#160;&#160;malware&#160;&#160;&#160;displays&#160;&#160;&#160;a&#160;</p>
<p style="position:absolute;top:664px;left:85px;white-space:nowrap" class="ft3615">dialog&#160;imitating&#160;the&#160;wallet&#160;in&#160;the&#160;untrusted&#160;compartment,&#160;the&#160;trusted&#160;path&#160;indicator&#160;<br/>still&#160;&#160;&#160;shows&#160;&#160;a&#160;&#160;&#160;red&#160;&#160;bar&#160;&#160;at&#160;&#160;the&#160;&#160;&#160;top&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;screen&#160;&#160;&#160;and&#160;&#160;clearly&#160;&#160;&#160;indicates&#160;&#160;that&#160;&#160;&#160;entering&#160;<br/>credentials&#160;is&#160;not&#160;secure.&#160;A&#160;trained&#160;user&#160;will&#160;&#160;notice&#160;this&#160;and&#160;be&#160;&#160;suspicious&#160;of&#160;the&#160;<br/>unexpected&#160;dialog&#160;because&#160;she&#160;knows&#160;that&#160;she&#160;normally&#160;has&#160;to&#160;press&#160;the&#160;F12&#160;key&#160;to&#160;<br/>invoke&#160;the&#160;wallet&#160;and&#160;that&#160;the&#160;wallet&#160;does&#160;not&#160;share&#160;its&#160;screen&#160;with&#160;her&#160;untrusted&#160;<br/>applications.&#160;&#160;&#160;Moreover,&#160;&#160;&#160;the&#160;&#160;&#160;Linux&#160;&#160;&#160;running&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;&#160;&#160;untrusted&#160;&#160;&#160;compartment&#160;&#160;&#160;has&#160;&#160;&#160;no&#160;<br/>access&#160;to&#160;the&#160;trusted&#160;path&#160;indicator&#160;and&#160;therefore,&#160;no&#160;malware&#160;can&#160;paint&#160;over&#160;the&#160;<br/>indicator&#160;&#160;&#160;or&#160;&#160;&#160;even&#160;&#160;&#160;read&#160;&#160;&#160;its&#160;&#160;&#160;state&#160;&#160;&#160;because&#160;&#160;&#160;it&#160;&#160;&#160;resides&#160;&#160;&#160;beyond&#160;&#160;&#160;the&#160;&#160;&#160;accessible&#160;&#160;&#160;screen&#160;<br/>region.&#160;</p>
<p style="position:absolute;top:864px;left:85px;white-space:nowrap" class="ft363"><b>Configuration&#160;Modification&#160;</b></p>
<p style="position:absolute;top:891px;left:85px;white-space:nowrap" class="ft3615">By&#160;using&#160;the&#160;Secure&#160;Wallet,&#160;two&#160;new&#160;potential&#160;threats&#160;specific&#160;to&#160;the&#160;implementation&#160;<br/>arise.&#160;&#160;&#160;Malware&#160;&#160;&#160;can&#160;&#160;&#160;try&#160;&#160;&#160;to&#160;&#160;&#160;re-enable&#160;&#160;&#160;locked&#160;&#160;&#160;password&#160;&#160;&#160;fields&#160;&#160;&#160;after&#160;&#160;&#160;they&#160;&#160;&#160;have&#160;&#160;&#160;been&#160;<br/>locked&#160;by&#160;the&#160;wallet&#160;and&#160;it&#160;can&#160;attempt&#160;to&#160;disable&#160;the&#160;wallet&#160;at&#160;all.&#160;The&#160;first&#160;attack&#160;<br/>was&#160;already&#160;&#160;discussed&#160;&#160;in&#160;&#160;the&#160;&#160;course&#160;&#160;&#160;of&#160;&#160;the&#160;&#160;fake&#160;&#160;site&#160;&#160;&#160;attack.&#160;Independently&#160;&#160;of&#160;&#160;the&#160;<br/>method&#160;with&#160;which&#160;the&#160;adversary&#160;unlocks&#160;the&#160;password&#160;fields,&#160;i.e.&#160;by&#160;using&#160;JavaScript&#160;<br/>or&#160;by&#160;installing&#160;malware&#160;on&#160;the&#160;user's&#160;system,&#160;he&#160;cannot&#160;gain&#160;current&#160;credentials&#160;for&#160;<br/>the&#160;site&#160;he&#160;is&#160;phishing&#160;passwords&#160;for.&#160;<br/>The&#160;&#160;&#160;second&#160;&#160;&#160;attack&#160;&#160;&#160;attempts&#160;&#160;&#160;to&#160;&#160;&#160;prevent&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;from&#160;&#160;&#160;protecting&#160;&#160;&#160;the&#160;&#160;&#160;user's&#160;<br/>credentials&#160;by&#160;removing&#160;the&#160;browser's&#160;proxy&#160;assignment.&#160;As&#160;a&#160;result,&#160;the&#160;wallet&#160;no&#160;<br/>longer&#160;receives&#160;the&#160;browser's&#160;HTTP&#160;requests&#160;and&#160;can&#160;neither&#160;lock&#160;password&#160;fields&#160;<br/>nor&#160;&#160;&#160;perform&#160;&#160;&#160;automatic&#160;&#160;&#160;login&#160;&#160;&#160;operations.&#160;&#160;&#160;The&#160;&#160;&#160;user&#160;&#160;&#160;will&#160;&#160;&#160;eventually&#160;&#160;&#160;notice&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;<br/>wallet&#160;is&#160;inactive.&#160;Assuming&#160;that&#160;she&#160;does&#160;not&#160;know&#160;how&#160;to&#160;repair&#160;this&#160;issue,&#160;she&#160;will&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft367">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft367">36/109</p>
</div>
<!-- Page 37 -->
<a name="37"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page37-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application037.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3712">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft370">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft374">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft374">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft3715">not&#160;&#160;&#160;be&#160;&#160;&#160;able&#160;&#160;&#160;to&#160;&#160;&#160;log&#160;&#160;&#160;into&#160;&#160;sites&#160;&#160;for&#160;&#160;&#160;which&#160;&#160;&#160;the&#160;&#160;&#160;password&#160;&#160;&#160;change&#160;&#160;&#160;has&#160;&#160;been&#160;&#160;&#160;completed&#160;<br/>because&#160;she&#160;does&#160;not&#160;know&#160;the&#160;passwords.&#160;The&#160;adversary&#160;does&#160;not&#160;learn&#160;her&#160;current&#160;<br/>credentials&#160;but&#160;at&#160;most&#160;her&#160;outdated&#160;ones&#160;if&#160;she&#160;tries&#160;to&#160;log&#160;in&#160;with&#160;those&#160;credentials.&#160;<br/>An&#160;advanced&#160;implementation&#160;might&#160;even&#160;redirect&#160;traffic&#160;to&#160;the&#160;wallet&#160;compartment&#160;<br/>independent&#160;of&#160;the&#160;actual&#160;source.&#160;This&#160;would&#160;render&#160;a&#160;manual&#160;proxy&#160;assignment&#160;in&#160;<br/>the&#160;browser&#160;unnecessary&#160;and&#160;the&#160;adversary&#160;could&#160;not&#160;disable&#160;the&#160;wallet&#160;in&#160;this&#160;way.&#160;<br/>However,&#160;for&#160;this&#160;to&#160;work,&#160;the&#160;wallet&#160;compartment&#160;must&#160;be&#160;able&#160;to&#160;determine&#160;for&#160;all&#160;<br/>network&#160;traffic&#160;if&#160;it&#160;should&#160;be&#160;allowed&#160;or&#160;denied,&#160;in&#160;order&#160;to&#160;prevent&#160;the&#160;adversary&#160;<br/>from&#160;&#160;&#160;circumventing&#160;&#160;&#160;the&#160;&#160;&#160;wallet.&#160;&#160;&#160;Future&#160;&#160;&#160;research&#160;&#160;&#160;is&#160;&#160;&#160;needed&#160;&#160;&#160;to&#160;&#160;&#160;decide&#160;&#160;&#160;if&#160;&#160;&#160;such&#160;&#160;&#160;an&#160;<br/>approach&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;used&#160;&#160;&#160;to&#160;&#160;&#160;support&#160;&#160;&#160;arbitrary&#160;&#160;&#160;web-based&#160;&#160;&#160;logins&#160;&#160;&#160;without&#160;&#160;&#160;giving&#160;&#160;&#160;the&#160;<br/>adversary&#160;the&#160;possibility&#160;to&#160;disable&#160;the&#160;wallet,&#160;e.g.,&#160;by&#160;tunneling&#160;web&#160;traffic&#160;through&#160;<br/>other&#160;protocols.</p>
<p style="position:absolute;top:417px;left:85px;white-space:nowrap" class="ft376"><b>2.5.5&#160;Protection&#160;against&#160;Offline&#160;Attacks&#160;</b></p>
<p style="position:absolute;top:444px;left:85px;white-space:nowrap" class="ft3715">Offline&#160;&#160;&#160;attacks&#160;&#160;&#160;denote&#160;&#160;&#160;attacks&#160;&#160;&#160;where&#160;&#160;&#160;the&#160;&#160;&#160;user's&#160;&#160;&#160;system&#160;&#160;&#160;S&#160;&#160;&#160;is&#160;&#160;&#160;not&#160;&#160;&#160;running&#160;&#160;&#160;and&#160;&#160;&#160;the&#160;<br/>adversary&#160;has&#160;physical&#160;access&#160;to&#160;it.&#160;For&#160;offline&#160;attacks,&#160;we&#160;can&#160;assume&#160;that&#160;booting&#160;<br/>the&#160;&#160;&#160;machine&#160;&#160;&#160;himself&#160;&#160;&#160;and&#160;&#160;&#160;trying&#160;&#160;&#160;to&#160;&#160;&#160;impersonate&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;is&#160;&#160;&#160;ineffective&#160;&#160;&#160;for&#160;&#160;&#160;the&#160;<br/>adversary.&#160;However,&#160;he&#160;can&#160;still&#160;try&#160;to&#160;attack&#160;the&#160;hardware&#160;or&#160;modify&#160;the&#160;system&#160;in&#160;<br/>order&#160;to&#160;break&#160;its&#160;security.&#160;</p>
<p style="position:absolute;top:567px;left:85px;white-space:nowrap" class="ft376"><b>General&#160;Attacks&#160;</b></p>
<p style="position:absolute;top:593px;left:85px;white-space:nowrap" class="ft3715">If&#160;the&#160;adversary&#160;has&#160;physical&#160;access&#160;to&#160;the&#160;system,&#160;he&#160;can&#160;directly&#160;attack&#160;a&#160;hardware&#160;<br/>component.&#160;&#160;&#160;He&#160;&#160;&#160;might&#160;&#160;&#160;either&#160;&#160;&#160;replace&#160;&#160;&#160;or&#160;&#160;&#160;modify&#160;&#160;&#160;a&#160;&#160;&#160;component&#160;&#160;&#160;or&#160;&#160;&#160;just&#160;&#160;&#160;take&#160;&#160;&#160;the&#160;<br/>credential&#160;store&#160;(i.e.,&#160;the&#160;hard&#160;drive)&#160;with&#160;him&#160;and&#160;try&#160;to&#160;read&#160;it&#160;out&#160;on&#160;a&#160;less&#160;secure&#160;<br/>system.&#160;<br/>Replacement&#160;&#160;&#160;or&#160;&#160;&#160;modification&#160;&#160;&#160;of&#160;&#160;&#160;a&#160;&#160;&#160;security-relevant&#160;&#160;&#160;component&#160;&#160;&#160;will&#160;&#160;&#160;be&#160;&#160;&#160;detected&#160;<br/>during&#160;the&#160;next&#160;boot&#160;process&#160;since&#160;the&#160;TPM&#160;will&#160;yield&#160;different&#160;hash&#160;values&#160;in&#160;its&#160;PCR&#160;<br/>registers&#160;&#160;&#160;and&#160;&#160;&#160;thus&#160;&#160;&#160;not&#160;&#160;&#160;be&#160;&#160;&#160;able&#160;&#160;&#160;to&#160;&#160;&#160;decrypt&#160;&#160;&#160;the&#160;&#160;&#160;credentials&#160;&#160;&#160;sealed&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;previous&#160;<br/>hardware&#160;configuration.&#160;<br/>Due&#160;to&#160;the&#160;same&#160;reason,&#160;reading&#160;the&#160;credential&#160;store&#160;directly&#160;fails,&#160;e.g.&#160;by&#160;removing&#160;<br/>the&#160;hard&#160;disk&#160;and&#160;mounting&#160;it&#160;in&#160;another&#160;system.&#160;The&#160;credentials&#160;are&#160;sealed&#160;to&#160;the&#160;<br/>hardware&#160;and&#160;software&#160;configuration&#160;present&#160;at&#160;the&#160;time&#160;of&#160;storing.&#160;Thus,&#160;without&#160;<br/>restoring&#160;the&#160;initial&#160;configuration&#160;which&#160;in&#160;turn&#160;also&#160;restores&#160;the&#160;system's&#160;security&#160;<br/>properties,&#160;the&#160;credentials&#160;cannot&#160;be&#160;unsealed.&#160;<br/>The&#160;key&#160;used&#160;to&#160;encrypt&#160;the&#160;credentials&#160;is&#160;stored&#160;in&#160;the&#160;TPM&#160;permanently.&#160;Thus,&#160;a&#160;<br/>conceivable&#160;attack&#160;is&#160;to&#160;attack&#160;the&#160;TPM&#160;itself&#160;in&#160;order&#160;to&#160;read&#160;out&#160;the&#160;encryption&#160;key.&#160;<br/>This&#160;attack&#160;is&#160;out&#160;&#160;of&#160;scope&#160;of&#160;this&#160;work,&#160;though.&#160;The&#160;TPM&#160;has&#160;to&#160;provide&#160;built-in&#160;<br/>protection&#160;mechanisms&#160;against&#160;this&#160;kind&#160;of&#160;attacks.&#160;</p>
<p style="position:absolute;top:974px;left:85px;white-space:nowrap" class="ft376"><b>Offline&#160;Malware&#160;Attacks</b></p>
<p style="position:absolute;top:974px;left:288px;white-space:nowrap" class="ft377">&#160;</p>
<p style="position:absolute;top:1000px;left:85px;white-space:nowrap" class="ft3715">Besides&#160;&#160;&#160;attacking&#160;&#160;&#160;the&#160;&#160;&#160;hardware,&#160;&#160;&#160;the&#160;&#160;&#160;adversary&#160;&#160;&#160;might&#160;&#160;&#160;also&#160;&#160;&#160;attempt&#160;&#160;&#160;to&#160;&#160;&#160;modify&#160;&#160;&#160;the&#160;<br/>software&#160;configuration&#160;of&#160;the&#160;system.&#160;Due&#160;to&#160;the&#160;system's&#160;protection&#160;mechanisms&#160;this&#160;<br/>is&#160;only&#160;possible&#160;in&#160;very&#160;limited&#160;ways&#160;while&#160;the&#160;system&#160;is&#160;booted.&#160;Thus,&#160;it&#160;might&#160;be&#160;<br/>more&#160;&#160;&#160;feasible&#160;&#160;to&#160;&#160;modify&#160;&#160;&#160;critical&#160;&#160;components&#160;&#160;(e.g.&#160;&#160;the&#160;&#160;security&#160;&#160;kernel&#160;&#160;&#160;or&#160;&#160;a&#160;&#160;trusted&#160;<br/>compartment)&#160;&#160;&#160;while&#160;&#160;&#160;it&#160;&#160;&#160;is&#160;&#160;&#160;offline.&#160;&#160;&#160;A&#160;&#160;&#160;simple&#160;&#160;&#160;way&#160;&#160;&#160;to&#160;&#160;&#160;do&#160;&#160;&#160;this&#160;&#160;&#160;would&#160;&#160;&#160;be&#160;&#160;&#160;booting&#160;&#160;&#160;the&#160;<br/>machine&#160;&#160;&#160;from&#160;&#160;&#160;an&#160;&#160;&#160;alternative&#160;&#160;&#160;medium,&#160;&#160;&#160;e.g.&#160;&#160;&#160;from&#160;&#160;&#160;CD-ROM,&#160;&#160;&#160;and&#160;&#160;&#160;accessing&#160;&#160;&#160;and&#160;<br/>modifying&#160;the&#160;hard&#160;drive&#160;afterwards.&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft377">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft377">37/109</p>
</div>
<!-- Page 38 -->
<a name="38"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page38-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application038.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3812">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft380">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft384">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft384">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft3815">Nevertheless&#160;&#160;&#160;this&#160;&#160;&#160;attack&#160;&#160;&#160;is&#160;&#160;also&#160;&#160;&#160;detected&#160;&#160;or&#160;&#160;&#160;at&#160;&#160;&#160;least&#160;&#160;&#160;ineffective&#160;&#160;&#160;depending&#160;&#160;on&#160;&#160;&#160;the&#160;<br/>modifications&#160;applied.&#160;If&#160;the&#160;adversary&#160;modifies&#160;components&#160;inside&#160;of&#160;the&#160;untrusted&#160;<br/>compartment&#160;he&#160;gains&#160;nothing&#160;as&#160;described&#160;above.&#160;If&#160;he&#160;modifies&#160;components&#160;that&#160;<br/>are&#160;part&#160;of&#160;the&#160;trusted&#160;computing&#160;base,&#160;e.g.&#160;the&#160;security&#160;kernel,&#160;this&#160;attack&#160;will&#160;be&#160;<br/>detected&#160;as&#160;described&#160;in&#160;the&#160;previous&#160;section.&#160;The&#160;TPM&#160;will&#160;compute&#160;different&#160;hash&#160;<br/>values&#160;while&#160;booting&#160;and&#160;not&#160;be&#160;able&#160;to&#160;unseal&#160;the&#160;user's&#160;credentials&#160;since&#160;they&#160;were&#160;<br/>encrypted&#160;with&#160;a&#160;different&#160;system&#160;configuration.&#160;Therefore,&#160;offline&#160;attacks&#160;are&#160;also&#160;<br/>insufficient&#160;to&#160;gain&#160;access&#160;to&#160;the&#160;user's&#160;credentials.&#160;</p>
<p style="position:absolute;top:332px;left:85px;white-space:nowrap" class="ft386"><b>2.5.6&#160;Attacks&#160;on&#160;the&#160;Passwords&#160;</b></p>
<p style="position:absolute;top:376px;left:85px;white-space:nowrap" class="ft383"><b>Common&#160;Password&#160;Attack&#160;</b></p>
<p style="position:absolute;top:403px;left:85px;white-space:nowrap" class="ft3815">Instead&#160;of&#160;attacking&#160;the&#160;user&#160;or&#160;her&#160;system&#160;directly,&#160;the&#160;adversary&#160;may&#160;also&#160;attempt&#160;<br/>to&#160;&#160;&#160;guess&#160;&#160;&#160;her&#160;&#160;&#160;password.&#160;&#160;&#160;Most&#160;&#160;&#160;users&#160;&#160;&#160;choose&#160;&#160;&#160;weak&#160;&#160;&#160;passwords&#160;&#160;&#160;or&#160;&#160;&#160;re-use&#160;&#160;&#160;a&#160;&#160;&#160;single&#160;<br/>password&#160;for&#160;several&#160;or&#160;even&#160;all&#160;web&#160;sites.&#160;The&#160;adversary&#160;can&#160;capitalize&#160;on&#160;that&#160;by&#160;<br/>phishing&#160;the&#160;password&#160;for&#160;a&#160;low-security&#160;site&#160;(e.g.&#160;a&#160;site&#160;without&#160;SSL&#160;protection)&#160;and&#160;<br/>testing&#160;this&#160;password&#160;for&#160;the&#160;user's&#160;other&#160;accounts&#160;on&#160;high-security&#160;sites.&#160;This&#160;is&#160;also&#160;<br/>known&#160;as&#160;a&#160;</p>
<p style="position:absolute;top:499px;left:185px;white-space:nowrap" class="ft3820"><i>Common&#160;Password&#160;Attack</i></p>
<p style="position:absolute;top:499px;left:403px;white-space:nowrap" class="ft3814">.&#160;</p>
<p style="position:absolute;top:527px;left:85px;white-space:nowrap" class="ft3815">Without&#160;the&#160;wallet,&#160;this&#160;attack&#160;has&#160;a&#160;high&#160;chance&#160;to&#160;succeed.&#160;By&#160;using&#160;the&#160;wallet,&#160;<br/>however,&#160;the&#160;user&#160;can&#160;no&#160;longer&#160;re-use&#160;a&#160;single&#160;password&#160;for&#160;multiple&#160;sites&#160;because&#160;<br/>the&#160;wallet&#160;&#160;changes&#160;the&#160;&#160;user's&#160;password&#160;and&#160;incorporates&#160;the&#160;domain&#160;name&#160;&#160;and&#160;a&#160;<br/>random&#160;value&#160;into&#160;it.&#160;Thus,&#160;even&#160;if&#160;the&#160;user&#160;still&#160;uses&#160;the&#160;same&#160;password&#160;for&#160;several&#160;<br/>sites,&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;will&#160;&#160;&#160;generate&#160;&#160;&#160;a&#160;&#160;&#160;distinct&#160;&#160;&#160;password&#160;&#160;&#160;for&#160;&#160;&#160;each&#160;&#160;&#160;site&#160;&#160;&#160;and&#160;&#160;&#160;provide&#160;&#160;&#160;an&#160;<br/>effective&#160;countermeasure&#160;against&#160;the&#160;common&#160;password&#160;attack.&#160;</p>
<p style="position:absolute;top:669px;left:85px;white-space:nowrap" class="ft383"><b>Dictionary&#160;attack&#160;without&#160;information&#160;</b></p>
<p style="position:absolute;top:696px;left:85px;white-space:nowrap" class="ft3815">Still,&#160;&#160;&#160;the&#160;&#160;&#160;adversary&#160;&#160;&#160;can&#160;&#160;&#160;attempt&#160;&#160;&#160;to&#160;&#160;&#160;mount&#160;&#160;&#160;a&#160;&#160;&#160;dictionary&#160;&#160;&#160;attack&#160;&#160;&#160;against&#160;&#160;&#160;a&#160;&#160;&#160;phished&#160;<br/>password&#160;&#160;&#160;because&#160;&#160;&#160;each&#160;&#160;&#160;wallet-generated&#160;&#160;&#160;password&#160;&#160;&#160;is&#160;&#160;&#160;a&#160;&#160;&#160;hash&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;original&#160;&#160;&#160;user&#160;<br/>password:</p>
<p style="position:absolute;top:754px;left:640px;white-space:nowrap" class="ft3814">(2.1)</p>
<p style="position:absolute;top:804px;left:85px;white-space:nowrap" class="ft3814">In&#160;order&#160;to&#160;perform&#160;the&#160;dictionary&#160;attack,&#160;the&#160;adversary&#160;has&#160;to&#160;guess&#160;</p>
<p style="position:absolute;top:804px;left:721px;white-space:nowrap" class="ft3814">&#160;as&#160;well&#160;as&#160;</p>
<p style="position:absolute;top:835px;left:131px;white-space:nowrap" class="ft3814">&#160;while&#160;the&#160;domain&#160;name&#160;is&#160;known&#160;to&#160;him.&#160;</p>
<p style="position:absolute;top:835px;left:537px;white-space:nowrap" class="ft3814">&#160;is&#160;an&#160;</p>
<p style="position:absolute;top:835px;left:590px;white-space:nowrap" class="ft3820"><i>x</i></p>
<p style="position:absolute;top:835px;left:600px;white-space:nowrap" class="ft3814">&#160;bit&#160;salt&#160;value&#160;and&#160;it&#160;will&#160;</p>
<p style="position:absolute;top:854px;left:85px;white-space:nowrap" class="ft3814">likely&#160;make&#160;guessing&#160;the&#160;password&#160;infeasible&#160;if&#160;</p>
<p style="position:absolute;top:854px;left:487px;white-space:nowrap" class="ft3820"><i>x</i></p>
<p style="position:absolute;top:854px;left:496px;white-space:nowrap" class="ft3814">&#160;is&#160;large&#160;enough.&#160;The&#160;next&#160;paragraph&#160;</p>
<p style="position:absolute;top:873px;left:85px;white-space:nowrap" class="ft3814">discusses&#160;the&#160;recommended&#160;value&#160;for&#160;</p>
<p style="position:absolute;top:873px;left:406px;white-space:nowrap" class="ft3820"><i>x</i></p>
<p style="position:absolute;top:873px;left:415px;white-space:nowrap" class="ft3814">.&#160;</p>
<p style="position:absolute;top:919px;left:85px;white-space:nowrap" class="ft383"><b>Dictionary&#160;attack&#160;with&#160;an&#160;old&#160;password&#160;</b></p>
<p style="position:absolute;top:946px;left:85px;white-space:nowrap" class="ft3815">There&#160;&#160;&#160;are&#160;&#160;&#160;some&#160;&#160;&#160;scenarios&#160;&#160;&#160;in&#160;&#160;&#160;which&#160;&#160;&#160;the&#160;&#160;&#160;adversary&#160;&#160;&#160;may&#160;&#160;&#160;get&#160;&#160;&#160;hold&#160;&#160;&#160;of&#160;&#160;&#160;an&#160;&#160;&#160;old&#160;&#160;&#160;user&#160;<br/>password&#160;&#160;</p>
<p style="position:absolute;top:965px;left:225px;white-space:nowrap" class="ft3814">.&#160;&#160;&#160;For&#160;&#160;&#160;example,&#160;&#160;&#160;the&#160;&#160;&#160;adversary&#160;&#160;&#160;might&#160;&#160;&#160;have&#160;&#160;&#160;managed&#160;&#160;&#160;to&#160;&#160;&#160;disable&#160;&#160;&#160;the&#160;</p>
<p style="position:absolute;top:993px;left:85px;white-space:nowrap" class="ft3818">wallet&#160;by&#160;removing&#160;the&#160;proxy&#160;assignment&#160;in&#160;the&#160;browser&#160;as&#160;discussed&#160;above.&#160;When&#160;<br/>the&#160;(unskilled)&#160;user&#160;now&#160;attempts&#160;to&#160;log&#160;into&#160;the&#160;adversary's&#160;phishing&#160;site,&#160;she&#160;might&#160;<br/>be&#160;tempted&#160;to&#160;enter&#160;her&#160;old&#160;password.&#160;<br/>If&#160;the&#160;adversary&#160;is&#160;in&#160;possession&#160;of&#160;an&#160;old&#160;user&#160;password&#160;</p>
<p style="position:absolute;top:1059px;left:621px;white-space:nowrap" class="ft3814">,&#160;the&#160;dictionary&#160;attack&#160;</p>
<p style="position:absolute;top:1087px;left:85px;white-space:nowrap" class="ft3814">becomes&#160;&#160;&#160;more&#160;&#160;&#160;feasible&#160;&#160;&#160;because&#160;&#160;&#160;the&#160;&#160;&#160;only&#160;&#160;&#160;unknown&#160;&#160;&#160;value&#160;&#160;&#160;in&#160;&#160;&#160;equation&#160;(2.1)&#160;&#160;&#160;is&#160;&#160;&#160;now&#160;</p>
<p style="position:absolute;top:1110px;left:131px;white-space:nowrap" class="ft3814">.&#160;Since&#160;it&#160;is&#160;a&#160;random&#160;value,&#160;the&#160;adversary&#160;has&#160;to&#160;mount&#160;a&#160;brute&#160;force&#160;attack&#160;on&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft387">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft387">38/109</p>
</div>
<!-- Page 39 -->
<a name="39"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3929{font-size:17px;line-height:23px;font-family:EAAAAA+DejaVuSerif;color:#000000;}
-->
</style>
<div id="page39-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application039.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft3912">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft390">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft394">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft394">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft3929">it.&#160;To&#160;prevent&#160;him&#160;from&#160;finding&#160;the&#160;correct&#160;salt&#160;value,&#160;it&#160;must&#160;be&#160;large&#160;enough&#160;to&#160;<br/>make&#160;a&#160;brute&#160;force&#160;search&#160;infeasible.&#160;<br/>A&#160;&#160;&#160;modern&#160;&#160;&#160;dual-core&#160;&#160;&#160;CPU&#160;&#160;&#160;is&#160;&#160;&#160;able&#160;&#160;&#160;to&#160;&#160;&#160;compute&#160;&#160;&#160;several&#160;&#160;&#160;million&#160;&#160;&#160;SHA-256&#160;&#160;&#160;hashes&#160;&#160;&#160;per&#160;<br/>second&#160;<a href="file:///swallet/final/latex/main/main.html#hash_benchmark">[44]</a>.&#160;Assuming&#160;an&#160;average&#160;of&#160;&#160;</p>
<p style="position:absolute;top:222px;left:442px;white-space:nowrap" class="ft3914">&#160;&#160;hashes&#160;per&#160;second,&#160;which&#160;corresponds&#160;to&#160;</p>
<p style="position:absolute;top:246px;left:85px;white-space:nowrap" class="ft3914">about&#160;</p>
<p style="position:absolute;top:246px;left:169px;white-space:nowrap" class="ft3914">&#160;hashes&#160;per&#160;day&#160;and&#160;CPU,&#160;a&#160;brute&#160;force&#160;search&#160;for&#160;a&#160;salt&#160;value&#160;with&#160;64&#160;bits&#160;</p>
<p style="position:absolute;top:271px;left:85px;white-space:nowrap" class="ft3914">would&#160;take&#160;about&#160;&#160;</p>
<p style="position:absolute;top:271px;left:276px;white-space:nowrap" class="ft3914">&#160;&#160;years&#160;on&#160;a&#160;single&#160;CPU.&#160;Even&#160;with&#160;clustered&#160;processors&#160;this&#160;</p>
<p style="position:absolute;top:291px;left:85px;white-space:nowrap" class="ft3915">should&#160;be&#160;sufficient&#160;to&#160;prevent&#160;dictionary&#160;attacks&#160;using&#160;a&#160;known&#160;original&#160;password.&#160;<br/>The&#160;time&#160;required&#160;for&#160;a&#160;dictionary&#160;attack&#160;can&#160;also&#160;be&#160;further&#160;increased&#160;by&#160;slowing&#160;the&#160;<br/>hash&#160;function,&#160;a&#160;technique&#160;described&#160;in&#160;<a href="file:///swallet/final/latex/main/main.html#slowhash">[35]</a>.&#160;</p>
<p style="position:absolute;top:375px;left:85px;white-space:nowrap" class="ft396"><b>2.5.7&#160;Discussion&#160;</b></p>
<p style="position:absolute;top:420px;left:85px;white-space:nowrap" class="ft396"><b>Assumptions&#160;</b></p>
<p style="position:absolute;top:446px;left:85px;white-space:nowrap" class="ft3915"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#39">Above,&#160;</a>two&#160;additional&#160;assumptions&#160;were&#160;made&#160;for&#160;the&#160;security&#160;analysis.&#160;In&#160;practice,&#160;it&#160;<br/>is&#160;not&#160;clear&#160;whether&#160;those&#160;assumptions&#160;actually&#160;hold&#160;true&#160;or&#160;whether&#160;the&#160;user&#160;acts&#160;<br/>against&#160;them.&#160;Still&#160;it&#160;can&#160;be&#160;argued&#160;that&#160;the&#160;assumptions&#160;are&#160;weak&#160;compared&#160;to&#160;those&#160;<br/>assumptions&#160;usually&#160;applied&#160;when&#160;not&#160;using&#160;the&#160;wallet.&#160;<br/>The&#160;first&#160;assumption,&#160;being&#160;that&#160;the&#160;user&#160;recognizes&#160;the&#160;simple&#160;trusted&#160;path&#160;indicator&#160;<br/>and&#160;acts&#160;upon&#160;it&#160;accordingly,&#160;is&#160;quite&#160;realistic&#160;and&#160;much&#160;weaker&#160;than&#160;the&#160;assumption&#160;<br/>that&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;is&#160;&#160;&#160;able&#160;&#160;&#160;to&#160;&#160;&#160;decide&#160;&#160;&#160;whether&#160;&#160;&#160;input&#160;&#160;&#160;into&#160;&#160;&#160;an&#160;&#160;&#160;application&#160;&#160;&#160;is&#160;&#160;&#160;secure,&#160;&#160;&#160;e.g.&#160;<br/>whether&#160;&#160;&#160;a&#160;&#160;&#160;dialog&#160;&#160;&#160;displayed&#160;&#160;&#160;to&#160;&#160;&#160;her&#160;&#160;&#160;belongs&#160;&#160;&#160;to&#160;&#160;&#160;malicious&#160;&#160;&#160;software.&#160;&#160;&#160;Of&#160;&#160;&#160;course,&#160;&#160;&#160;this&#160;<br/>assumption&#160;has&#160;to&#160;be&#160;confirmed&#160;by&#160;a&#160;representative&#160;user&#160;study.&#160;<br/>The&#160;second&#160;assumption&#160;is&#160;probably&#160;less&#160;realistic&#160;in&#160;practice.&#160;Users&#160;might&#160;be&#160;tempted&#160;<br/>to&#160;keep&#160;possession&#160;of&#160;their&#160;passwords&#160;to&#160;be&#160;able&#160;to&#160;log&#160;into&#160;web&#160;sites&#160;from&#160;other&#160;<br/>machines&#160;&#160;&#160;without&#160;&#160;&#160;using&#160;&#160;&#160;the&#160;&#160;&#160;wallet.&#160;&#160;&#160;Yet,&#160;&#160;&#160;this&#160;&#160;&#160;decision&#160;&#160;&#160;is&#160;&#160;&#160;prone&#160;&#160;&#160;to&#160;&#160;&#160;several&#160;&#160;&#160;attacks&#160;<br/>described&#160;in&#160;the&#160;course&#160;of&#160;the&#160;security&#160;analysis.&#160;For&#160;example,&#160;the&#160;user&#160;might&#160;ignore&#160;<br/>the&#160;&#160;&#160;trusted&#160;&#160;&#160;path&#160;&#160;&#160;indicator&#160;&#160;&#160;and&#160;&#160;&#160;enter&#160;&#160;&#160;her&#160;&#160;&#160;credentials&#160;&#160;&#160;into&#160;&#160;&#160;a&#160;&#160;&#160;fake&#160;&#160;&#160;dialog&#160;&#160;&#160;or&#160;&#160;&#160;the&#160;<br/>adversary&#160;removes&#160;the&#160;wallet&#160;proxy&#160;assignment&#160;and&#160;unlocks&#160;all&#160;browser&#160;forms&#160;so&#160;that&#160;<br/>the&#160;user&#160;is&#160;tempted&#160;to&#160;log&#160;in&#160;using&#160;the&#160;traditional&#160;way.&#160;<br/>All&#160;&#160;&#160;of&#160;&#160;&#160;those&#160;&#160;&#160;cases&#160;&#160;lead&#160;&#160;to&#160;&#160;disclosure&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;user's&#160;&#160;&#160;credentials&#160;&#160;if&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;has&#160;&#160;not&#160;<br/>changed&#160;&#160;&#160;the&#160;&#160;&#160;passwords&#160;&#160;&#160;before.&#160;&#160;&#160;This&#160;&#160;&#160;shows&#160;&#160;&#160;the&#160;&#160;&#160;importance&#160;&#160;&#160;of&#160;&#160;&#160;a&#160;&#160;&#160;thorough&#160;&#160;&#160;user&#160;<br/>training.&#160;It&#160;is&#160;important&#160;for&#160;users&#160;to&#160;realize&#160;that&#160;not&#160;letting&#160;the&#160;wallet&#160;change&#160;their&#160;<br/>passwords&#160;leaves&#160;room&#160;for&#160;potential&#160;phishing&#160;attacks.&#160;</p>
<p style="position:absolute;top:884px;left:85px;white-space:nowrap" class="ft393"><b>Metatag&#160;Approach&#160;</b></p>
<p style="position:absolute;top:911px;left:85px;white-space:nowrap" class="ft3915">If&#160;the&#160;assumption&#160;that&#160;users&#160;let&#160;the&#160;wallet&#160;change&#160;their&#160;passwords&#160;turns&#160;out&#160;to&#160;be&#160;too&#160;<br/>strong&#160;in&#160;practice,&#160;additional&#160;steps&#160;must&#160;be&#160;taken&#160;to&#160;automate&#160;the&#160;password&#160;changing&#160;<br/>process&#160;so&#160;that&#160;the&#160;user&#160;cannot&#160;avoid&#160;it.&#160;Providing&#160;metatags&#160;is&#160;a&#160;possible&#160;solution&#160;for&#160;<br/>this&#160;problem.&#160;If&#160;the&#160;wallet&#160;has&#160;enough&#160;information&#160;about&#160;a&#160;web&#160;site&#160;to&#160;trigger&#160;the&#160;<br/>password&#160;changing&#160;process&#160;itself,&#160;it&#160;can&#160;be&#160;integrated&#160;into&#160;the&#160;setup&#160;process&#160;and&#160;the&#160;<br/>user&#160;has&#160;no&#160;choice&#160;but&#160;to&#160;let&#160;the&#160;wallet&#160;change&#160;the&#160;passwords.&#160;<br/>While&#160;this&#160;is&#160;the&#160;optimal&#160;solution&#160;from&#160;a&#160;security&#160;standpoint,&#160;this&#160;approach&#160;has&#160;the&#160;<br/>significant&#160;drawback&#160;to&#160;require&#160;specialized&#160;metatags&#160;for&#160;each&#160;supported&#160;web&#160;site.&#160;<br/>Consequently,&#160;if&#160;the&#160;wallet&#160;has&#160;no&#160;metatags&#160;for&#160;a&#160;given&#160;web&#160;site,&#160;it&#160;cannot&#160;store&#160;the&#160;<br/>user's&#160;passwords&#160;for&#160;it&#160;and&#160;offers&#160;no&#160;protection&#160;at&#160;all.&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft397">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft397">39/109</p>
</div>
<!-- Page 40 -->
<a name="40"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page40-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application040.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft4012">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft400">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft404">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft404">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft406"><b>Password&#160;Knowledge&#160;</b></p>
<p style="position:absolute;top:178px;left:85px;white-space:nowrap" class="ft4015">This&#160;work&#160;generally&#160;assumes&#160;that&#160;the&#160;user&#160;does&#160;not&#160;know&#160;the&#160;passwords&#160;for&#160;her&#160;web&#160;<br/>sites&#160;after&#160;the&#160;wallet&#160;has&#160;changed&#160;them.&#160;Although&#160;the&#160;wallet&#160;does&#160;not&#160;initially&#160;display&#160;<br/>the&#160;&#160;&#160;changed&#160;&#160;&#160;value,&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;could&#160;&#160;&#160;still&#160;&#160;&#160;use&#160;&#160;&#160;the&#160;&#160;&#160;wallet's&#160;&#160;&#160;GUI&#160;&#160;&#160;to&#160;&#160;&#160;find&#160;&#160;&#160;out&#160;&#160;&#160;the&#160;&#160;&#160;new&#160;<br/>password.&#160;&#160;&#160;Thus,&#160;&#160;&#160;certain&#160;&#160;&#160;classical&#160;&#160;&#160;phishing&#160;&#160;&#160;attacks&#160;&#160;&#160;might&#160;&#160;&#160;still&#160;&#160;&#160;be&#160;&#160;&#160;feasible&#160;&#160;&#160;at&#160;&#160;&#160;first&#160;<br/>thought.&#160;<br/>Yet,&#160;&#160;&#160;it&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;argued&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;passwords&#160;&#160;&#160;generated&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;wallet&#160;&#160;&#160;are&#160;&#160;&#160;hard&#160;&#160;&#160;to&#160;<br/>remember.&#160;Most&#160;users&#160;re-use&#160;their&#160;(often&#160;simple)&#160;passwords&#160;across&#160;many&#160;different&#160;<br/>sites&#160;&#160;&#160;(the&#160;&#160;&#160;author&#160;&#160;&#160;cannot&#160;&#160;&#160;even&#160;&#160;&#160;absolve&#160;&#160;&#160;himself&#160;&#160;&#160;from&#160;&#160;&#160;that).&#160;&#160;&#160;This&#160;&#160;&#160;shows&#160;&#160;&#160;that&#160;<br/>remembering&#160;many&#160;different&#160;passwords&#160;is&#160;hard&#160;for&#160;most&#160;users.&#160;Taking&#160;into&#160;account&#160;<br/>that&#160;the&#160;wallet&#160;makes&#160;full&#160;use&#160;of&#160;the&#160;available&#160;password&#160;length&#160;and&#160;generates&#160;pseudo-<br/>random&#160;passwords&#160;(e.g.&#160;Xc7f3h2IK12u&#160;instead&#160;of&#160;mypassword23),&#160;it&#160;can&#160;be&#160;assumed&#160;<br/>that&#160;&#160;&#160;most&#160;&#160;&#160;users&#160;&#160;&#160;are&#160;&#160;&#160;not&#160;&#160;&#160;able&#160;&#160;&#160;to&#160;&#160;&#160;permanently&#160;&#160;&#160;remember&#160;&#160;&#160;the&#160;&#160;&#160;wallet-generated&#160;<br/>passwords&#160;even&#160;if&#160;they&#160;explicitly&#160;review&#160;them.&#160;However,&#160;as&#160;long&#160;as&#160;the&#160;user&#160;can&#160;still&#160;<br/>view&#160;the&#160;password,&#160;it&#160;is&#160;impossible&#160;to&#160;prevent&#160;the&#160;disclosure&#160;completely&#160;(e.g.,&#160;apart&#160;<br/>from&#160;memorizing&#160;passwords,&#160;the&#160;user&#160;could&#160;also&#160;write&#160;them&#160;down).</p>
<p style="position:absolute;top:502px;left:85px;white-space:nowrap" class="ft406"><b>2.5.8&#160;Other&#160;Attacks&#160;</b></p>
<p style="position:absolute;top:546px;left:85px;white-space:nowrap" class="ft406"><b>Transaction&#160;Generators&#160;</b></p>
<p style="position:absolute;top:573px;left:85px;white-space:nowrap" class="ft4015">Due&#160;to&#160;the&#160;automation&#160;of&#160;login&#160;operations,&#160;the&#160;user&#160;loses&#160;a&#160;certain&#160;degree&#160;of&#160;control&#160;<br/>over&#160;&#160;&#160;the&#160;&#160;&#160;browser's&#160;&#160;&#160;actions.&#160;&#160;&#160;A&#160;&#160;&#160;modified&#160;&#160;&#160;browser,&#160;&#160;&#160;aware&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;wallet,&#160;&#160;&#160;could&#160;&#160;&#160;take&#160;<br/>advantage&#160;of&#160;the&#160;fact&#160;that&#160;no&#160;user&#160;interaction&#160;is&#160;necessary&#160;to&#160;log&#160;into&#160;a&#160;specific&#160;web&#160;<br/>site&#160;and&#160;carry&#160;out&#160;an&#160;arbitrary&#160;amount&#160;of&#160;transactions&#160;impersonating&#160;the&#160;user&#160;without&#160;<br/>her&#160;&#160;&#160;noticing&#160;&#160;&#160;it.&#160;&#160;&#160;Such&#160;&#160;&#160;attacks&#160;&#160;&#160;called&#160;&#160;</p>
<p style="position:absolute;top:649px;left:424px;white-space:nowrap" class="ft4020"><i>Transaction&#160;&#160;&#160;Generators</i></p>
<p style="position:absolute;top:649px;left:629px;white-space:nowrap" class="ft4014">&#160;&#160;have&#160;&#160;&#160;already&#160;&#160;&#160;been&#160;</p>
<p style="position:absolute;top:669px;left:85px;white-space:nowrap" class="ft4015">described&#160;by&#160;Jackson&#160;et&#160;al.&#160;<a href="file:///swallet/final/latex/main/main.html#TransGen">[40]</a>.&#160;<br/>This&#160;kind&#160;of&#160;attacks&#160;is&#160;not&#160;specific&#160;to&#160;the&#160;Secure&#160;Wallet&#160;but&#160;rather&#160;a&#160;generic&#160;problem&#160;<br/>with&#160;transactions&#160;that&#160;can&#160;be&#160;committed&#160;without&#160;user&#160;interaction.&#160;A&#160;user&#160;without&#160;the&#160;<br/>wallet&#160;is&#160;susceptible&#160;to&#160;this&#160;attack&#160;after&#160;having&#160;logged&#160;into&#160;a&#160;web&#160;site&#160;in&#160;the&#160;same&#160;<br/>way&#160;&#160;&#160;as&#160;&#160;&#160;a&#160;&#160;&#160;wallet&#160;&#160;&#160;user.&#160;&#160;&#160;Therefore,&#160;&#160;&#160;it&#160;&#160;&#160;is&#160;&#160;&#160;out&#160;&#160;&#160;of&#160;&#160;&#160;scope&#160;&#160;&#160;of&#160;&#160;&#160;this&#160;&#160;&#160;work&#160;&#160;&#160;to&#160;&#160;&#160;present&#160;&#160;&#160;a&#160;<br/>countermeasure.&#160;&#160;&#160;Transaction&#160;&#160;&#160;confirmation&#160;&#160;&#160;(as&#160;&#160;&#160;described&#160;&#160;&#160;in&#160;&#160;&#160;[40])&#160;&#160;&#160;could&#160;&#160;&#160;be&#160;<br/>implemented&#160;in&#160;addition&#160;in&#160;the&#160;wallet&#160;compartment.&#160;</p>
<p style="position:absolute;top:839px;left:85px;white-space:nowrap" class="ft4016"><b>2.6&#160;Architectural&#160;Overview&#160;</b></p>
<p style="position:absolute;top:867px;left:85px;white-space:nowrap" class="ft4015">In&#160;this&#160;section,&#160;we&#160;sketch&#160;the&#160;architecture&#160;on&#160;a&#160;PC,&#160;describe&#160;an&#160;architecture&#160;for&#160;a&#160;<br/>mobile&#160;platform,&#160;and&#160;propose&#160;a&#160;“hybrid”&#160;architecture&#160;for&#160;a&#160;demo-prototype,&#160;where&#160;<br/>functionalities&#160;are&#160;split&#160;between&#160;a&#160;PC&#160;and&#160;a&#160;mobile&#160;(X-GOLD</p>
<p style="position:absolute;top:905px;left:593px;white-space:nowrap" class="ft4017">TM&#160;</p>
<p style="position:absolute;top:906px;left:612px;white-space:nowrap" class="ft4014">208-based)&#160;platform.</p>
<p style="position:absolute;top:934px;left:85px;white-space:nowrap" class="ft4014">Section&#160;2.7&#160;will&#160;then&#160;discuss&#160;the&#160;X-GOLD</p>
<p style="position:absolute;top:934px;left:430px;white-space:nowrap" class="ft4017">TM</p>
<p style="position:absolute;top:934px;left:446px;white-space:nowrap" class="ft4014">208-based&#160;demonstrator&#160;prototype&#160;in&#160;more&#160;</p>
<p style="position:absolute;top:953px;left:85px;white-space:nowrap" class="ft4015">detail.&#160;General&#160;information&#160;on&#160;this&#160;mobile&#160;platform&#160;can&#160;be&#160;obtained&#160;in&#160;[74].<br/>For&#160;&#160;&#160;the&#160;&#160;&#160;PC-based&#160;&#160;&#160;prototype,&#160;&#160;&#160;the&#160;&#160;&#160;Security&#160;&#160;&#160;Services&#160;&#160;&#160;developed&#160;&#160;&#160;within&#160;&#160;&#160;OpenTC&#160;<br/>Workpackage&#160;5&#160;could&#160;be&#160;re-used.</p>
<p style="position:absolute;top:1047px;left:85px;white-space:nowrap" class="ft406"><b>2.6.1&#160;Architecture&#160;on&#160;a&#160;PC</b></p>
<p style="position:absolute;top:1092px;left:85px;white-space:nowrap" class="ft4014"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#40">&#160;</a>shows&#160;the&#160;architecture,&#160;as&#160;it&#160;is&#160;currently&#160;implemented&#160;on&#160;PC&#160;hardware.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft407">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft407">40/109</p>
</div>
<!-- Page 41 -->
<a name="41"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4130{font-size:18px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
-->
</style>
<div id="page41-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application041.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft4112">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft410">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft414">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft414">Final</p>
<p style="position:absolute;top:804px;left:85px;white-space:nowrap" class="ft4115">We&#160;use&#160;TrustedGRUB&#160;as&#160;&#160;bootloader.&#160;TrustedGRUB&#160;measures&#160;the&#160;microkernel,&#160;L4env&#160;<br/>and&#160;the&#160;security&#160;services&#160;(Compartment&#160;Manager&#160;etc.),&#160;and&#160;extends&#160;the&#160;PCRs.<br/>The&#160;&#160;Compartment&#160;&#160;Manager&#160;&#160;measures&#160;&#160;and&#160;&#160;starts&#160;&#160;the&#160;Secure&#160;Wallet&#160;&#160;and&#160;other&#160;&#160;L4-<br/>Linux&#160;compartments.&#160;These&#160;measurements&#160;are&#160;not&#160;written&#160;into&#160;PCRs,&#160;but&#160;stored&#160;in&#160;<br/>memory&#160;only.&#160;In&#160;this&#160;manner,&#160;the&#160;Compartment&#160;Manager&#160;extends&#160;the&#160;authenticated&#160;<br/>boot.&#160;&#160;&#160;To&#160;&#160;&#160;verify&#160;&#160;&#160;the&#160;&#160;&#160;integrity&#160;&#160;&#160;of&#160;&#160;&#160;a&#160;&#160;&#160;compartment,&#160;&#160;&#160;a&#160;&#160;&#160;verifier&#160;&#160;&#160;has&#160;&#160;&#160;to&#160;&#160;&#160;rely&#160;&#160;&#160;on&#160;&#160;&#160;the&#160;<br/>conventional&#160;TCG&#160;chain&#160;of&#160;trust&#160;to&#160;verify&#160;the&#160;basic&#160;system&#160;(up&#160;to&#160;the&#160;Compartment&#160;<br/>Manager),&#160;and&#160;additionally,&#160;the&#160;measurements&#160;of&#160;the&#160;compartment&#160;(as&#160;provided&#160;by&#160;<br/>the&#160;Compartment&#160;Manager)&#160;have&#160;to&#160;be&#160;checked.</p>
<p style="position:absolute;top:1013px;left:85px;white-space:nowrap" class="ft416"><b>2.6.2&#160;&#160;Storage&#160;Manager</b></p>
<p style="position:absolute;top:1039px;left:85px;white-space:nowrap" class="ft4114">This&#160;section&#160;describes&#160;the&#160;implementation&#160;of&#160;the&#160;Storage&#160;Manager&#160;</p>
<p style="position:absolute;top:1039px;left:668px;white-space:nowrap" class="ft4120"><i>SM</i></p>
<p style="position:absolute;top:1039px;left:696px;white-space:nowrap" class="ft4114">&#160;that&#160;enables&#160;</p>
<p style="position:absolute;top:1058px;left:85px;white-space:nowrap" class="ft4115">other&#160;&#160;&#160;compartments&#160;&#160;&#160;to&#160;&#160;&#160;persistently&#160;&#160;&#160;bind&#160;&#160;&#160;their&#160;&#160;&#160;local&#160;&#160;&#160;states&#160;&#160;&#160;to&#160;&#160;&#160;their&#160;&#160;&#160;actual&#160;<br/>configuration&#160;while&#160;preserving&#160;integrity,&#160;confidentiality&#160;and&#160;freshness.&#160;A&#160;prototype&#160;of&#160;<br/>the&#160;Storage&#160;Manager&#160;has&#160;been&#160;implemented&#160;within&#160;OpenTC&#160;Workpackage&#160;5,&#160;which&#160;is&#160;<br/>re-used&#160;here.&#160;The&#160;freshness&#160;requirement&#160;is&#160;not&#160;important&#160;for&#160;the&#160;secure&#160;wallet&#160;use&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft417">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft417">41/109</p>
<p style="position:absolute;top:658px;left:204px;white-space:nowrap" class="ft4114">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:724px;left:242px;white-space:nowrap" class="ft413"><b>Figure&#160;11:&#160;System&#160;architecture&#160;for&#160;PC&#160;hardware.</b></p>
<p style="position:absolute;top:657px;left:363px;white-space:nowrap" class="ft4130">PC&#160;Hardware&#160;with&#160;TPM</p>
<p style="position:absolute;top:453px;left:351px;white-space:nowrap" class="ft4130">Compartment</p>
<p style="position:absolute;top:476px;left:367px;white-space:nowrap" class="ft4130">Manager</p>
<p style="position:absolute;top:464px;left:244px;white-space:nowrap" class="ft4130">Secure&#160;GUI</p>
<p style="position:absolute;top:451px;left:581px;white-space:nowrap" class="ft4130">Network</p>
<p style="position:absolute;top:473px;left:582px;white-space:nowrap" class="ft4130">Manager</p>
<p style="position:absolute;top:452px;left:477px;white-space:nowrap" class="ft4130">Storage</p>
<p style="position:absolute;top:474px;left:467px;white-space:nowrap" class="ft4130">&#160;&#160;Manager&#160;</p>
<p style="position:absolute;top:341px;left:525px;white-space:nowrap" class="ft4130">Legacy&#160;OS</p>
<p style="position:absolute;top:364px;left:506px;white-space:nowrap" class="ft4130">(Here, L4 Linux)</p>
<p style="position:absolute;top:267px;left:532px;white-space:nowrap" class="ft4130">Browser</p>
<p style="position:absolute;top:394px;left:509px;white-space:nowrap" class="ft4130">L4 Linux&#160;Kernel</p>
<p style="position:absolute;top:277px;left:277px;white-space:nowrap" class="ft4130">Secure&#160;Wallet</p>
<p style="position:absolute;top:299px;left:266px;white-space:nowrap" class="ft4130">“Current&#160;version&#160;</p>
<p style="position:absolute;top:322px;left:262px;white-space:nowrap" class="ft4130">implemented using</p>
<p style="position:absolute;top:344px;left:291px;white-space:nowrap" class="ft4130">L4 Linux”</p>
<p style="position:absolute;top:521px;left:395px;white-space:nowrap" class="ft4130">L4 Environment</p>
<p style="position:absolute;top:584px;left:394px;white-space:nowrap" class="ft4130">L4 Microkernel</p>
</div>
<!-- Page 42 -->
<a name="42"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4231{font-size:10px;font-family:GAAAAA+DejaVuSerif;color:#000000;}
	.ft4232{font-size:7px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
-->
</style>
<div id="page42-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application042.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft4212">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft420">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft424">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft424">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft4215">case&#160;because&#160;replay&#160;attacks&#160;are&#160;not&#160;an&#160;issue.&#160;However,&#160;in&#160;other&#160;use&#160;cases,&#160;freshness&#160;<br/>may&#160;be&#160;required.&#160;Thus,&#160;it&#160;should&#160;be&#160;considered&#160;in&#160;the&#160;design&#160;of&#160;the&#160;Storage&#160;Manager&#160;<br/>as&#160;a&#160;generic&#160;security&#160;service.&#160;We&#160;first&#160;give&#160;an&#160;short&#160;overview&#160;and&#160;then&#160;describe&#160;the&#160;<br/>realisation&#160;of&#160;secure&#160;storage&#160;that&#160;will&#160;be&#160;extended&#160;by&#160;an&#160;additional&#160;freshness&#160;layer&#160;to&#160;<br/>provide&#160;</p>
<p style="position:absolute;top:228px;left:155px;white-space:nowrap" class="ft4220"><i>trusted</i></p>
<p style="position:absolute;top:228px;left:216px;white-space:nowrap" class="ft4214">&#160;storage.&#160;At&#160;the&#160;end&#160;of&#160;this&#160;section,&#160;we&#160;briefly&#160;describe&#160;the&#160;protocols&#160;</p>
<p style="position:absolute;top:247px;left:85px;white-space:nowrap" class="ft4214">for&#160;the&#160;initialisation&#160;of&#160;</p>
<p style="position:absolute;top:247px;left:281px;white-space:nowrap" class="ft4220"><i>SM</i></p>
<p style="position:absolute;top:247px;left:309px;white-space:nowrap" class="ft4214">,&#160;as&#160;well&#160;as&#160;for&#160;storing&#160;to&#160;and&#160;loading&#160;from&#160;trusted&#160;storage&#160;</p>
<p style="position:absolute;top:266px;left:85px;white-space:nowrap" class="ft4214">(using&#160;</p>
<p style="position:absolute;top:266px;left:143px;white-space:nowrap" class="ft4220"><i>SM</i></p>
<p style="position:absolute;top:266px;left:171px;white-space:nowrap" class="ft4214">).</p>
<p style="position:absolute;top:314px;left:85px;white-space:nowrap" class="ft4221"><b>Overview:</b></p>
<p style="position:absolute;top:314px;left:175px;white-space:nowrap" class="ft4214">&#160;The&#160;Storage&#160;Manager&#160;is&#160;invoked&#160;by&#160;a&#160;compartment&#160;to&#160;store&#160;a&#160;data&#160;object&#160;</p>
<p style="position:absolute;top:333px;left:85px;white-space:nowrap" class="ft4215">persistently&#160;&#160;&#160;preserving&#160;&#160;&#160;confidentiality&#160;&#160;&#160;and&#160;&#160;&#160;integrity&#160;&#160;&#160;–&#160;&#160;&#160;optionally&#160;&#160;&#160;with&#160;&#160;&#160;additional&#160;<br/>restrictions&#160;&#160;</p>
<p style="position:absolute;top:352px;left:192px;white-space:nowrap" class="ft4220"><i>rest</i></p>
<p style="position:absolute;top:352px;left:225px;white-space:nowrap" class="ft4214">&#160;&#160;(e.g.,&#160;&#160;&#160;freshness,&#160;&#160;&#160;certain&#160;&#160;&#160;user&#160;&#160;&#160;id).&#160;&#160;</p>
<p style="position:absolute;top:352px;left:541px;white-space:nowrap" class="ft4220"><i>SM</i></p>
<p style="position:absolute;top:352px;left:569px;white-space:nowrap" class="ft4214">&#160;&#160;invokes&#160;&#160;&#160;the&#160;&#160;&#160;Compartment&#160;</p>
<p style="position:absolute;top:372px;left:85px;white-space:nowrap" class="ft4215">Manager&#160;to&#160;retrieve&#160;the&#160;actual&#160;configuration&#160;of&#160;the&#160;respective&#160;compartment&#160;and&#160;to&#160;<br/>bind&#160;&#160;&#160;the&#160;&#160;&#160;data&#160;&#160;&#160;object&#160;&#160;&#160;to&#160;&#160;&#160;that&#160;&#160;&#160;compartment&#160;&#160;&#160;configuration&#160;&#160;</p>
<p style="position:absolute;top:391px;left:675px;white-space:nowrap" class="ft4220"><i>cmp_conf</i></p>
<p style="position:absolute;top:391px;left:754px;white-space:nowrap" class="ft4214">.&#160;&#160;</p>
<p style="position:absolute;top:391px;left:780px;white-space:nowrap" class="ft4220"><i>SM&#160;</i></p>
<p style="position:absolute;top:410px;left:85px;white-space:nowrap" class="ft4215">creates/updates&#160;a&#160;metadata&#160;entry&#160;for&#160;the&#160;corresponding&#160;data&#160;object&#160;with&#160;the&#160;data&#160;<br/>object&#160;&#160;&#160;identifier&#160;&#160;</p>
<p style="position:absolute;top:429px;left:248px;white-space:nowrap" class="ft4220"><i>d</i></p>
<p style="position:absolute;top:437px;left:258px;white-space:nowrap" class="ft4231"><i>ID</i></p>
<p style="position:absolute;top:429px;left:269px;white-space:nowrap" class="ft4214">,&#160;&#160;&#160;its&#160;&#160;&#160;freshness&#160;&#160;&#160;detection&#160;&#160;&#160;information&#160;&#160;</p>
<p style="position:absolute;top:429px;left:637px;white-space:nowrap" class="ft4220"><i>f</i></p>
<p style="position:absolute;top:429px;left:642px;white-space:nowrap" class="ft4214">,&#160;&#160;&#160;i.e.,&#160;&#160;&#160;the&#160;&#160;&#160;actual&#160;</p>
<p style="position:absolute;top:448px;left:85px;white-space:nowrap" class="ft4214">cryptographic&#160;hash&#160;value,&#160;and&#160;all&#160;relevant&#160;access&#160;restrictions&#160;</p>
<p style="position:absolute;top:448px;left:616px;white-space:nowrap" class="ft4220"><i>res<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#42">t</a></i></p>
<p style="position:absolute;top:453px;left:649px;white-space:nowrap" class="ft4232"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#42">3</a></p>
<p style="position:absolute;top:448px;left:653px;white-space:nowrap" class="ft4214"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#42">&#160;</a>with&#160;its&#160;index&#160;</p>
<p style="position:absolute;top:448px;left:781px;white-space:nowrap" class="ft4220"><i>i</i></p>
<p style="position:absolute;top:456px;left:787px;white-space:nowrap" class="ft4231"><i>SM</i></p>
<p style="position:absolute;top:448px;left:803px;white-space:nowrap" class="ft4214">.&#160;</p>
<p style="position:absolute;top:468px;left:85px;white-space:nowrap" class="ft4220"><i>SM</i></p>
<p style="position:absolute;top:468px;left:113px;white-space:nowrap" class="ft4214">&#160;&#160;extends&#160;the&#160;data&#160;object&#160;with&#160;integrity&#160;verification&#160;information,&#160;synchronises&#160;its&#160;</p>
<p style="position:absolute;top:487px;left:85px;white-space:nowrap" class="ft4214">monotonic&#160;counter&#160;</p>
<p style="position:absolute;top:487px;left:250px;white-space:nowrap" class="ft4220"><i>c</i></p>
<p style="position:absolute;top:495px;left:259px;white-space:nowrap" class="ft4231"><i>SM</i></p>
<p style="position:absolute;top:487px;left:275px;white-space:nowrap" class="ft4214">,&#160;encrypts&#160;the&#160;data&#160;object&#160;and&#160;the&#160;updated&#160;index&#160;using&#160;the&#160;key&#160;</p>
<p style="position:absolute;top:506px;left:85px;white-space:nowrap" class="ft4220"><i>k</i></p>
<p style="position:absolute;top:514px;left:95px;white-space:nowrap" class="ft4231"><i>SM&#160;</i></p>
<p style="position:absolute;top:506px;left:116px;white-space:nowrap" class="ft4214">and&#160;writes&#160;it&#160;on&#160;untrusted&#160;persistent&#160;storage.&#160;Since&#160;</p>
<p style="position:absolute;top:506px;left:562px;white-space:nowrap" class="ft4220"><i>i</i></p>
<p style="position:absolute;top:514px;left:567px;white-space:nowrap" class="ft4231"><i>SM</i></p>
<p style="position:absolute;top:506px;left:584px;white-space:nowrap" class="ft4214">&#160;is&#160;the&#160;base&#160;of&#160;security&#160;for&#160;</p>
<p style="position:absolute;top:525px;left:85px;white-space:nowrap" class="ft4220"><i>SM</i></p>
<p style="position:absolute;top:525px;left:113px;white-space:nowrap" class="ft4214">,&#160;&#160;</p>
<p style="position:absolute;top:525px;left:126px;white-space:nowrap" class="ft4220"><i>i</i></p>
<p style="position:absolute;top:533px;left:131px;white-space:nowrap" class="ft4231"><i>SM</i></p>
<p style="position:absolute;top:525px;left:148px;white-space:nowrap" class="ft4214">&#160;&#160;is&#160;sealed&#160;to&#160;&#160;</p>
<p style="position:absolute;top:525px;left:261px;white-space:nowrap" class="ft4220"><i>SM</i></p>
<p style="position:absolute;top:525px;left:290px;white-space:nowrap" class="ft4214">’s&#160;configuration&#160;via&#160;the&#160;sealed&#160;key&#160;&#160;</p>
<p style="position:absolute;top:525px;left:595px;white-space:nowrap" class="ft4220"><i>k</i></p>
<p style="position:absolute;top:533px;left:605px;white-space:nowrap" class="ft4231"><i>SM</i></p>
<p style="position:absolute;top:525px;left:621px;white-space:nowrap" class="ft4214">.&#160;Thus&#160;only&#160;the&#160;same,&#160;</p>
<p style="position:absolute;top:544px;left:85px;white-space:nowrap" class="ft4214">trusted&#160;Storage&#160;Manager&#160;configuration&#160;is&#160;able&#160;to&#160;unseal&#160;and&#160;use&#160;</p>
<p style="position:absolute;top:544px;left:638px;white-space:nowrap" class="ft4220"><i>k</i></p>
<p style="position:absolute;top:552px;left:648px;white-space:nowrap" class="ft4231"><i>SM</i></p>
<p style="position:absolute;top:544px;left:664px;white-space:nowrap" class="ft4214">&#160;again.&#160;On&#160;a&#160;load&#160;</p>
<p style="position:absolute;top:564px;left:85px;white-space:nowrap" class="ft4214">request,&#160;&#160;</p>
<p style="position:absolute;top:564px;left:168px;white-space:nowrap" class="ft4220"><i>SM</i></p>
<p style="position:absolute;top:564px;left:196px;white-space:nowrap" class="ft4214">&#160;&#160;again&#160;&#160;&#160;uses&#160;&#160;&#160;the&#160;&#160;&#160;Compartment&#160;&#160;&#160;Manager&#160;&#160;&#160;to&#160;&#160;&#160;compare&#160;&#160;&#160;the&#160;&#160;&#160;invoking&#160;</p>
<p style="position:absolute;top:583px;left:85px;white-space:nowrap" class="ft4215">compartment&#160;&#160;&#160;configuration&#160;&#160;&#160;with&#160;&#160;&#160;the&#160;&#160;&#160;one&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;compartment&#160;&#160;&#160;that&#160;&#160;&#160;has&#160;&#160;&#160;stored&#160;&#160;&#160;the&#160;<br/>respective&#160;data&#160;object&#160;before.&#160;On&#160;a&#160;successful&#160;verification,&#160;&#160;</p>
<p style="position:absolute;top:602px;left:605px;white-space:nowrap" class="ft4220"><i>SM</i></p>
<p style="position:absolute;top:602px;left:634px;white-space:nowrap" class="ft4214">&#160;&#160;reads&#160;and&#160;decrypts&#160;</p>
<p style="position:absolute;top:621px;left:85px;white-space:nowrap" class="ft4215">the&#160;data&#160;object&#160;from&#160;the&#160;untrusted&#160;persistent&#160;storage&#160;and&#160;verifies&#160;its&#160;integrity.&#160;Before&#160;<br/>the&#160;&#160;&#160;data&#160;&#160;&#160;object&#160;&#160;&#160;is&#160;&#160;&#160;committed&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;requesting&#160;&#160;&#160;compartment,&#160;&#160;</p>
<p style="position:absolute;top:640px;left:661px;white-space:nowrap" class="ft4220"><i>SM</i></p>
<p style="position:absolute;top:640px;left:689px;white-space:nowrap" class="ft4214">&#160;&#160;also&#160;&#160;&#160;verifies&#160;</p>
<p style="position:absolute;top:660px;left:85px;white-space:nowrap" class="ft4214">possibly&#160;existing&#160;additional&#160;restrictions&#160;such&#160;as&#160;freshness&#160;or&#160;a&#160;certain&#160;user&#160;id.</p>
<p style="position:absolute;top:707px;left:85px;white-space:nowrap" class="ft4221"><b>Trusted&#160;Storage:</b></p>
<p style="position:absolute;top:707px;left:243px;white-space:nowrap" class="ft4214">&#160;</p>
<p style="position:absolute;top:707px;left:251px;white-space:nowrap" class="ft4220"><i>SM</i></p>
<p style="position:absolute;top:707px;left:279px;white-space:nowrap" class="ft4214">&#160;&#160;offers&#160;trusted&#160;storage&#160;to&#160;bind&#160;the&#160;data&#160;of&#160;a&#160;compartment&#160;to&#160;</p>
<p style="position:absolute;top:726px;left:85px;white-space:nowrap" class="ft4214">the&#160;compartment&#160;while&#160;preserving&#160;integrity&#160;and&#160;confidentiality.&#160;Therefore,&#160;</p>
<p style="position:absolute;top:726px;left:722px;white-space:nowrap" class="ft4220"><i>SM</i></p>
<p style="position:absolute;top:726px;left:750px;white-space:nowrap" class="ft4214">&#160;uses&#160;a&#160;</p>
<p style="position:absolute;top:745px;left:85px;white-space:nowrap" class="ft4214">cryptographic&#160;&#160;&#160;hash&#160;&#160;&#160;functio<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#42">n</a></p>
<p style="position:absolute;top:745px;left:338px;white-space:nowrap" class="ft4217"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#42">4</a></p>
<p style="position:absolute;top:745px;left:344px;white-space:nowrap" class="ft4214"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#42">&#160;&#160;</a>to&#160;&#160;&#160;calculate&#160;&#160;&#160;the&#160;&#160;&#160;data&#160;&#160;&#160;object’s&#160;&#160;&#160;hash&#160;&#160;&#160;value&#160;&#160;&#160;and&#160;&#160;&#160;a&#160;</p>
<p style="position:absolute;top:765px;left:85px;white-space:nowrap" class="ft4214">symmetric&#160;&#160;&#160;ciph<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#42">er</a></p>
<p style="position:absolute;top:765px;left:239px;white-space:nowrap" class="ft4217"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#42">5</a></p>
<p style="position:absolute;top:765px;left:245px;white-space:nowrap" class="ft4214"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#42">&#160;&#160;</a>with&#160;&#160;&#160;its&#160;&#160;&#160;internal&#160;&#160;&#160;cryptographic&#160;&#160;&#160;secret&#160;&#160;&#160;key&#160;&#160;</p>
<p style="position:absolute;top:765px;left:656px;white-space:nowrap" class="ft4220"><i>k</i></p>
<p style="position:absolute;top:773px;left:666px;white-space:nowrap" class="ft4231"><i>SM&#160;&#160;</i></p>
<p style="position:absolute;top:765px;left:693px;white-space:nowrap" class="ft4214">bound&#160;&#160;&#160;to&#160;&#160;&#160;its&#160;</p>
<p style="position:absolute;top:784px;left:85px;white-space:nowrap" class="ft4214">configuration&#160;to&#160;encrypt&#160;data&#160;objects&#160;together&#160;with&#160;their&#160;actual&#160;hash&#160;values.&#160;Then&#160;</p>
<p style="position:absolute;top:784px;left:780px;white-space:nowrap" class="ft4220"><i>SM&#160;</i></p>
<p style="position:absolute;top:803px;left:85px;white-space:nowrap" class="ft4215">writes&#160;&#160;&#160;the&#160;&#160;&#160;encrypted&#160;&#160;&#160;blob&#160;&#160;&#160;to&#160;&#160;untrusted&#160;&#160;&#160;persistent&#160;&#160;&#160;storage&#160;&#160;&#160;providing&#160;&#160;&#160;at&#160;&#160;&#160;least&#160;<br/>availability.&#160;&#160;&#160;The&#160;&#160;&#160;key&#160;&#160;</p>
<p style="position:absolute;top:822px;left:282px;white-space:nowrap" class="ft4220"><i>k</i></p>
<p style="position:absolute;top:830px;left:292px;white-space:nowrap" class="ft4231"><i>SM&#160;&#160;</i></p>
<p style="position:absolute;top:822px;left:319px;white-space:nowrap" class="ft4214">in&#160;&#160;&#160;turn&#160;&#160;&#160;is&#160;&#160;&#160;sealed&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;configuration&#160;&#160;&#160;of&#160;&#160;</p>
<p style="position:absolute;top:822px;left:716px;white-space:nowrap" class="ft4220"><i>SM,</i></p>
<p style="position:absolute;top:822px;left:749px;white-space:nowrap" class="ft4214">&#160;&#160;using&#160;</p>
<p style="position:absolute;top:841px;left:85px;white-space:nowrap" class="ft4215">functionality&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;TPM&#160;&#160;&#160;so&#160;&#160;&#160;that&#160;&#160;&#160;only&#160;&#160;&#160;the&#160;&#160;&#160;same,&#160;&#160;&#160;trusted&#160;&#160;&#160;Storage&#160;&#160;&#160;Manager&#160;<br/>configuration&#160;is&#160;able&#160;to&#160;unseal&#160;and&#160;use&#160;the&#160;key&#160;again.&#160;During&#160;a&#160;load&#160;operation,&#160;the&#160;<br/>data&#160;object&#160;is&#160;decrypted&#160;and&#160;verified&#160;for&#160;integrity&#160;using&#160;the&#160;appended&#160;hash&#160;value.</p>
<p style="position:absolute;top:1087px;left:85px;white-space:nowrap" class="ft424">3&#160;Further&#160;access&#160;restrictions&#160;can&#160;be&#160;a&#160;certain&#160;user&#160;id,&#160;group&#160;id&#160;or&#160;date&#160;of&#160;expiry.</p>
<p style="position:absolute;top:1104px;left:85px;white-space:nowrap" class="ft4210">4&#160;Our&#160;implementation&#160;currently&#160;uses&#160;SHA-1.<br/>5&#160;Our&#160;implementation&#160;currently&#160;uses&#160;AES.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft427">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft427">42/109</p>
</div>
<!-- Page 43 -->
<a name="43"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4333{font-size:15px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
-->
</style>
<div id="page43-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application043.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft4312">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft430">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft434">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft434">Final</p>
<p style="position:absolute;top:606px;left:85px;white-space:nowrap" class="ft4315"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#43">Figure&#160;&#160;&#160;12&#160;&#160;</a>depicts&#160;&#160;&#160;our&#160;&#160;&#160;trusted&#160;&#160;&#160;storage&#160;&#160;&#160;implementation.&#160;&#160;&#160;Our&#160;&#160;&#160;trusted&#160;&#160;&#160;storage&#160;<br/>compartment&#160;&#160;&#160;basically&#160;&#160;&#160;offers&#160;&#160;&#160;two&#160;&#160;&#160;trusted&#160;&#160;&#160;channels&#160;&#160;</p>
<p style="position:absolute;top:625px;left:554px;white-space:nowrap" class="ft4320"><i>load[]</i></p>
<p style="position:absolute;top:625px;left:603px;white-space:nowrap" class="ft4314">&#160;&#160;and&#160;&#160;</p>
<p style="position:absolute;top:625px;left:657px;white-space:nowrap" class="ft4320"><i>store[]</i></p>
<p style="position:absolute;top:625px;left:713px;white-space:nowrap" class="ft4314">&#160;&#160;while&#160;&#160;&#160;the&#160;</p>
<p style="position:absolute;top:644px;left:85px;white-space:nowrap" class="ft4314">storage&#160;compartment&#160;itself&#160;uses&#160;two&#160;&#160;untrusted&#160;&#160;channels&#160;namely&#160;&#160;</p>
<p style="position:absolute;top:644px;left:653px;white-space:nowrap" class="ft4320"><i>read[]</i></p>
<p style="position:absolute;top:644px;left:704px;white-space:nowrap" class="ft4314">&#160;&#160;and&#160;&#160;</p>
<p style="position:absolute;top:644px;left:752px;white-space:nowrap" class="ft4320"><i>write[]&#160;</i></p>
<p style="position:absolute;top:663px;left:85px;white-space:nowrap" class="ft4315">from&#160;an&#160;untrusted&#160;storage&#160;compartment&#160;to&#160;persistently&#160;write,&#160;respectively&#160;read,&#160;data&#160;<br/>(however,&#160;the&#160;untrusted&#160;storage&#160;should&#160;provide&#160;availability)<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#43">.</a></p>
<p style="position:absolute;top:682px;left:594px;white-space:nowrap" class="ft4317"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#43">6</a></p>
<p style="position:absolute;top:711px;left:85px;white-space:nowrap" class="ft4314">If&#160;</p>
<p style="position:absolute;top:711px;left:104px;white-space:nowrap" class="ft4320"><i>SM</i></p>
<p style="position:absolute;top:711px;left:132px;white-space:nowrap" class="ft4314">&#160;receives&#160;a&#160;data&#160;object&#160;</p>
<p style="position:absolute;top:711px;left:329px;white-space:nowrap" class="ft4320"><i>d</i></p>
<p style="position:absolute;top:711px;left:339px;white-space:nowrap" class="ft4314">&#160;via&#160;</p>
<p style="position:absolute;top:711px;left:376px;white-space:nowrap" class="ft4320"><i>store[d,&#160;rest]</i></p>
<p style="position:absolute;top:711px;left:486px;white-space:nowrap" class="ft4314">,&#160;</p>
<p style="position:absolute;top:711px;left:497px;white-space:nowrap" class="ft4320"><i>SM</i></p>
<p style="position:absolute;top:711px;left:525px;white-space:nowrap" class="ft4314">&#160;internally&#160;creates&#160;or&#160;updates&#160;the&#160;</p>
<p style="position:absolute;top:730px;left:85px;white-space:nowrap" class="ft4314">object’s&#160;metadat<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#43">a</a></p>
<p style="position:absolute;top:730px;left:237px;white-space:nowrap" class="ft4317"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#43">7</a></p>
<p style="position:absolute;top:730px;left:243px;white-space:nowrap" class="ft4314"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#43">&#160;&#160;</a>and&#160;calculates&#160;its&#160;hash&#160;value&#160;&#160;</p>
<p style="position:absolute;top:730px;left:509px;white-space:nowrap" class="ft4320"><i>i</i></p>
<p style="position:absolute;top:730px;left:514px;white-space:nowrap" class="ft4314">&#160;&#160;to&#160;verify&#160;integrity.&#160;Then&#160;the&#160;&#160;data&#160;</p>
<p style="position:absolute;top:749px;left:85px;white-space:nowrap" class="ft4314">together&#160;with&#160;</p>
<p style="position:absolute;top:749px;left:207px;white-space:nowrap" class="ft4320"><i>i</i></p>
<p style="position:absolute;top:749px;left:212px;white-space:nowrap" class="ft4314">&#160;is&#160;encrypted&#160;with&#160;the&#160;internal&#160;cryptographic&#160;secret&#160;key&#160;</p>
<p style="position:absolute;top:749px;left:696px;white-space:nowrap" class="ft4320"><i>k</i></p>
<p style="position:absolute;top:757px;left:706px;white-space:nowrap" class="ft4331"><i>SM</i></p>
<p style="position:absolute;top:749px;left:722px;white-space:nowrap" class="ft4314">&#160;using&#160;the&#160;</p>
<p style="position:absolute;top:768px;left:85px;white-space:nowrap" class="ft4314">function&#160;&#160;</p>
<p style="position:absolute;top:768px;left:162px;white-space:nowrap" class="ft4320"><i>e</i></p>
<p style="position:absolute;top:768px;left:172px;white-space:nowrap" class="ft4314">&#160;&#160;:=&#160;&#160;</p>
<p style="position:absolute;top:768px;left:207px;white-space:nowrap" class="ft4320"><i>encrypt&#160;&#160;</i></p>
<p style="position:absolute;top:768px;left:279px;white-space:nowrap" class="ft4314">[</p>
<p style="position:absolute;top:768px;left:285px;white-space:nowrap" class="ft4320"><i>d&#160;&#160;</i></p>
<p style="position:absolute;top:768px;left:304px;white-space:nowrap" class="ft4314">||&#160;&#160;</p>
<p style="position:absolute;top:768px;left:323px;white-space:nowrap" class="ft4320"><i>i</i></p>
<p style="position:absolute;top:768px;left:328px;white-space:nowrap" class="ft4314">]&#160;&#160;(to&#160;provide&#160;confidentiality).&#160;The&#160;encrypted&#160;data&#160;&#160;</p>
<p style="position:absolute;top:768px;left:760px;white-space:nowrap" class="ft4320"><i>e</i></p>
<p style="position:absolute;top:768px;left:770px;white-space:nowrap" class="ft4314">&#160;&#160;will&#160;</p>
<p style="position:absolute;top:787px;left:85px;white-space:nowrap" class="ft4314">afterwards&#160;&#160;be&#160;&#160;&#160;written&#160;&#160;&#160;on&#160;&#160;untrusted&#160;&#160;storage&#160;&#160;&#160;using&#160;&#160;</p>
<p style="position:absolute;top:787px;left:532px;white-space:nowrap" class="ft4320"><i>d</i></p>
<p style="position:absolute;top:796px;left:543px;white-space:nowrap" class="ft4331"><i>ID</i></p>
<p style="position:absolute;top:787px;left:554px;white-space:nowrap" class="ft4314">&#160;&#160;:=&#160;&#160;</p>
<p style="position:absolute;top:787px;left:592px;white-space:nowrap" class="ft4320"><i>write[e]</i></p>
<p style="position:absolute;top:787px;left:658px;white-space:nowrap" class="ft4314">&#160;&#160;that&#160;&#160;&#160;returns&#160;&#160;the&#160;</p>
<p style="position:absolute;top:807px;left:85px;white-space:nowrap" class="ft4314">object&#160;&#160;&#160;identifier&#160;&#160;</p>
<p style="position:absolute;top:807px;left:232px;white-space:nowrap" class="ft4320"><i>d</i></p>
<p style="position:absolute;top:815px;left:243px;white-space:nowrap" class="ft4331"><i>ID</i></p>
<p style="position:absolute;top:807px;left:254px;white-space:nowrap" class="ft4314">.&#160;&#160;&#160;Conversely,&#160;&#160;&#160;if&#160;&#160;</p>
<p style="position:absolute;top:807px;left:397px;white-space:nowrap" class="ft4320"><i>e</i></p>
<p style="position:absolute;top:807px;left:407px;white-space:nowrap" class="ft4314">&#160;&#160;is&#160;&#160;&#160;read&#160;&#160;&#160;from&#160;&#160;the&#160;&#160;&#160;untrusted&#160;&#160;&#160;storage&#160;&#160;&#160;via&#160;&#160;</p>
<p style="position:absolute;top:807px;left:770px;white-space:nowrap" class="ft4320"><i>e</i></p>
<p style="position:absolute;top:807px;left:779px;white-space:nowrap" class="ft4314">&#160;&#160;:=&#160;</p>
<p style="position:absolute;top:826px;left:85px;white-space:nowrap" class="ft4320"><i>read[d</i></p>
<p style="position:absolute;top:834px;left:140px;white-space:nowrap" class="ft4331"><i>ID</i></p>
<p style="position:absolute;top:826px;left:152px;white-space:nowrap" class="ft4320"><i>]</i></p>
<p style="position:absolute;top:826px;left:158px;white-space:nowrap" class="ft4314">&#160;it&#160;will&#160;be&#160;decrypted&#160;to&#160;</p>
<p style="position:absolute;top:826px;left:360px;white-space:nowrap" class="ft4320"><i>data</i></p>
<p style="position:absolute;top:826px;left:397px;white-space:nowrap" class="ft4314">&#160;and&#160;</p>
<p style="position:absolute;top:826px;left:440px;white-space:nowrap" class="ft4320"><i>i</i></p>
<p style="position:absolute;top:826px;left:446px;white-space:nowrap" class="ft4314">&#160;via&#160;</p>
<p style="position:absolute;top:826px;left:483px;white-space:nowrap" class="ft4320"><i>decrypt[e]</i></p>
<p style="position:absolute;top:826px;left:570px;white-space:nowrap" class="ft4314">&#160;using&#160;</p>
<p style="position:absolute;top:826px;left:628px;white-space:nowrap" class="ft4320"><i>k</i></p>
<p style="position:absolute;top:834px;left:638px;white-space:nowrap" class="ft4331"><i>SM</i></p>
<p style="position:absolute;top:826px;left:654px;white-space:nowrap" class="ft4314">.&#160;Before&#160;returning&#160;</p>
<p style="position:absolute;top:845px;left:85px;white-space:nowrap" class="ft4320"><i>d</i></p>
<p style="position:absolute;top:845px;left:96px;white-space:nowrap" class="ft4314">&#160;&#160;to&#160;&#160;</p>
<p style="position:absolute;top:845px;left:131px;white-space:nowrap" class="ft4320"><i>load[]</i></p>
<p style="position:absolute;top:845px;left:180px;white-space:nowrap" class="ft4314">,&#160;&#160;</p>
<p style="position:absolute;top:845px;left:195px;white-space:nowrap" class="ft4320"><i>SM</i></p>
<p style="position:absolute;top:845px;left:223px;white-space:nowrap" class="ft4314">&#160;&#160;verifies&#160;&#160;&#160;the&#160;&#160;&#160;integrity&#160;&#160;&#160;of&#160;&#160;</p>
<p style="position:absolute;top:845px;left:447px;white-space:nowrap" class="ft4320"><i>d</i></p>
<p style="position:absolute;top:845px;left:458px;white-space:nowrap" class="ft4314">&#160;&#160;and&#160;&#160;&#160;further&#160;&#160;&#160;access&#160;&#160;&#160;restrictions&#160;&#160;&#160;(e.g.,&#160;&#160;&#160;a&#160;</p>
<p style="position:absolute;top:864px;left:85px;white-space:nowrap" class="ft4314">certain&#160;&#160;&#160;user&#160;&#160;&#160;id)&#160;&#160;&#160;based&#160;&#160;&#160;on&#160;&#160;&#160;the&#160;&#160;&#160;corresponding&#160;&#160;&#160;metadata&#160;&#160;&#160;in&#160;&#160;</p>
<p style="position:absolute;top:864px;left:615px;white-space:nowrap" class="ft4320"><i>SM</i></p>
<p style="position:absolute;top:864px;left:643px;white-space:nowrap" class="ft4314">’s&#160;&#160;&#160;index&#160;&#160;&#160;using&#160;&#160;&#160;the&#160;</p>
<p style="position:absolute;top:883px;left:85px;white-space:nowrap" class="ft4314">function&#160;</p>
<p style="position:absolute;top:883px;left:160px;white-space:nowrap" class="ft4320"><i>verify[d,&#160;i]</i></p>
<p style="position:absolute;top:883px;left:246px;white-space:nowrap" class="ft4314">&#160;.</p>
<p style="position:absolute;top:931px;left:85px;white-space:nowrap" class="ft4314">In&#160;order&#160;to&#160;provide&#160;fresh&#160;trusted&#160;storage,&#160;we&#160;enhance&#160;</p>
<p style="position:absolute;top:931px;left:556px;white-space:nowrap" class="ft4320"><i>SM</i></p>
<p style="position:absolute;top:931px;left:584px;white-space:nowrap" class="ft4314">&#160;by&#160;an&#160;additional&#160;layer&#160;for&#160;</p>
<p style="position:absolute;top:950px;left:85px;white-space:nowrap" class="ft4315">managing&#160;freshness&#160;of&#160;data&#160;objects.&#160;This&#160;extension&#160;consists&#160;of&#160;a&#160;(currently&#160;abstract)&#160;<br/>function&#160;&#160;</p>
<p style="position:absolute;top:969px;left:162px;white-space:nowrap" class="ft4320"><i>f</i></p>
<p style="position:absolute;top:969px;left:168px;white-space:nowrap" class="ft4314">&#160;&#160;:=&#160;&#160;</p>
<p style="position:absolute;top:969px;left:202px;white-space:nowrap" class="ft4320"><i>memorize[d]</i></p>
<p style="position:absolute;top:969px;left:308px;white-space:nowrap" class="ft4314">&#160;&#160;that&#160;updates&#160;the&#160;internal&#160;data&#160;structure&#160;&#160;</p>
<p style="position:absolute;top:969px;left:668px;white-space:nowrap" class="ft4320"><i>FRESH</i></p>
<p style="position:absolute;top:969px;left:730px;white-space:nowrap" class="ft4314">&#160;&#160;with&#160;the&#160;</p>
<p style="position:absolute;top:988px;left:85px;white-space:nowrap" class="ft4314">freshness&#160;value&#160;</p>
<p style="position:absolute;top:988px;left:221px;white-space:nowrap" class="ft4320"><i>f</i></p>
<p style="position:absolute;top:988px;left:227px;white-space:nowrap" class="ft4314">.&#160;Afterwards,&#160;data&#160;will&#160;be&#160;stored&#160;persistently&#160;ensuring&#160;confidentiality&#160;</p>
<p style="position:absolute;top:1008px;left:85px;white-space:nowrap" class="ft4314">and&#160;&#160;&#160;integrity&#160;&#160;&#160;using&#160;&#160;&#160;secure&#160;&#160;&#160;storage.&#160;&#160;&#160;On&#160;&#160;</p>
<p style="position:absolute;top:1008px;left:446px;white-space:nowrap" class="ft4320"><i>load[]</i></p>
<p style="position:absolute;top:1008px;left:495px;white-space:nowrap" class="ft4314">&#160;&#160;from&#160;&#160;&#160;secure&#160;&#160;&#160;storage,&#160;&#160;&#160;the&#160;&#160;&#160;function&#160;</p>
<p style="position:absolute;top:1052px;left:85px;white-space:nowrap" class="ft4310">6&#160;For&#160;the&#160;realisation&#160;of&#160;availability&#160;we&#160;suggest&#160;solutions&#160;based&#160;on&#160;high&#160;redundancy,&#160;i.e.,&#160;by&#160;the&#160;<br/>utilisation&#160;of&#160;multiple&#160;distributed&#160;storage&#160;locations&#160;(e.g.,&#160;USB&#160;sticks&#160;or&#160;online&#160;sites)&#160;assisted&#160;</p>
<p style="position:absolute;top:1087px;left:85px;white-space:nowrap" class="ft4310">by&#160;an&#160;appropriate&#160;RAID&#160;system.&#160;In&#160;case&#160;of&#160;failure&#160;of&#160;a&#160;particular&#160;storage&#160;device,&#160;it&#160;is&#160;still&#160;<br/>possible&#160;to&#160;retrieve&#160;data&#160;from&#160;alternative&#160;storage&#160;mirrors.</p>
<p style="position:absolute;top:1122px;left:85px;white-space:nowrap" class="ft4333">7</p>
<p style="position:absolute;top:1127px;left:93px;white-space:nowrap" class="ft435">&#160;</p>
<p style="position:absolute;top:1122px;left:96px;white-space:nowrap" class="ft434">More&#160;details&#160;on&#160;storage&#160;metadata&#160;are&#160;given&#160;at&#160;the&#160;end&#160;of&#160;this&#160;section.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft437">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft437">43/109</p>
<p style="position:absolute;top:550px;left:231px;white-space:nowrap" class="ft433"><b>Figure&#160;12:&#160;Implementation&#160;of&#160;the&#160;Storage&#160;Manager</b></p>
</div>
<!-- Page 44 -->
<a name="44"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4434{font-size:8px;font-family:IAAAAA+OpenSymbol;color:#000000;}
-->
</style>
<div id="page44-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application044.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft4412">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft440">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft444">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft444">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft4420"><i>verify[d,&#160;&#160;f]</i></p>
<p style="position:absolute;top:151px;left:175px;white-space:nowrap" class="ft4414">&#160;&#160;additionally&#160;verifies&#160;that&#160;the&#160;received&#160;data&#160;object&#160;&#160;</p>
<p style="position:absolute;top:151px;left:613px;white-space:nowrap" class="ft4420"><i>d</i></p>
<p style="position:absolute;top:151px;left:624px;white-space:nowrap" class="ft4414">&#160;&#160;is&#160;the&#160;last&#160;one&#160;being&#160;</p>
<p style="position:absolute;top:170px;left:85px;white-space:nowrap" class="ft4418">stored.<br/>To&#160;provide&#160;such&#160;freshness&#160;detection,&#160;&#160;</p>
<p style="position:absolute;top:198px;left:410px;white-space:nowrap" class="ft4420"><i>SM</i></p>
<p style="position:absolute;top:198px;left:438px;white-space:nowrap" class="ft4414">&#160;&#160;uses&#160;an&#160;additional&#160;metadata&#160;field&#160;to&#160;store&#160;</p>
<p style="position:absolute;top:218px;left:85px;white-space:nowrap" class="ft4414">the&#160;cryptographic&#160;hash&#160;value&#160;&#160;</p>
<p style="position:absolute;top:218px;left:348px;white-space:nowrap" class="ft4420"><i>hash(d)</i></p>
<p style="position:absolute;top:218px;left:411px;white-space:nowrap" class="ft4414">&#160;&#160;that&#160;defines&#160;the&#160;last&#160;stored&#160;version&#160;of&#160;&#160;</p>
<p style="position:absolute;top:218px;left:760px;white-space:nowrap" class="ft4420"><i>d</i></p>
<p style="position:absolute;top:218px;left:770px;white-space:nowrap" class="ft4414">.&#160;On&#160;</p>
<p style="position:absolute;top:237px;left:85px;white-space:nowrap" class="ft4420"><i>load[]</i></p>
<p style="position:absolute;top:237px;left:134px;white-space:nowrap" class="ft4414">,&#160;</p>
<p style="position:absolute;top:237px;left:144px;white-space:nowrap" class="ft4420"><i>SM</i></p>
<p style="position:absolute;top:237px;left:173px;white-space:nowrap" class="ft4414">&#160;calculates&#160;</p>
<p style="position:absolute;top:237px;left:268px;white-space:nowrap" class="ft4420"><i>hash(d)</i></p>
<p style="position:absolute;top:237px;left:331px;white-space:nowrap" class="ft4414">&#160;again&#160;and&#160;checks&#160;if&#160;it&#160;matches&#160;the&#160;hash&#160;value&#160;of&#160;the&#160;last&#160;</p>
<p style="position:absolute;top:256px;left:85px;white-space:nowrap" class="ft4414">store.&#160;In&#160;order&#160;to&#160;ensure&#160;freshness&#160;of&#160;these&#160;metadata,&#160;the&#160;index&#160;of&#160;</p>
<p style="position:absolute;top:256px;left:650px;white-space:nowrap" class="ft4420"><i>SM</i></p>
<p style="position:absolute;top:256px;left:679px;white-space:nowrap" class="ft4414">&#160;itself&#160;has&#160;to&#160;be&#160;</p>
<p style="position:absolute;top:275px;left:85px;white-space:nowrap" class="ft4415">stored&#160;fresh.&#160;We&#160;therefore&#160;analysed&#160;to&#160;what&#160;extent&#160;TPMs&#160;of&#160;version&#160;1.1b&#160;and&#160;1.2&#160;can&#160;<br/>be&#160;used&#160;to&#160;realise&#160;a&#160;fresh&#160;index&#160;for&#160;</p>
<p style="position:absolute;top:294px;left:382px;white-space:nowrap" class="ft4420"><i>SM</i></p>
<p style="position:absolute;top:294px;left:410px;white-space:nowrap" class="ft4414">.</p>
<p style="position:absolute;top:338px;left:112px;white-space:nowrap" class="ft4434">●</p>
<p style="position:absolute;top:329px;left:139px;white-space:nowrap" class="ft4415">DI-Register:&#160;&#160;TPMs&#160;version&#160;1.1b&#160;provide&#160;a&#160;Data&#160;Integrity&#160;Register&#160;(DIR)&#160;that&#160;<br/>can&#160;persistently&#160;store&#160;a&#160;160&#160;bit&#160;value.&#160;Unfortunately,&#160;access&#160;to&#160;this&#160;register&#160;is&#160;<br/>only&#160;authorised&#160;by&#160;the&#160;TPM&#160;owner&#160;secret&#160;implying&#160;that&#160;the&#160;TPM&#160;owner&#160;can&#160;<br/>always&#160;&#160;&#160;perform&#160;&#160;&#160;replay&#160;&#160;&#160;attacks.&#160;&#160;&#160;The&#160;&#160;&#160;only&#160;&#160;&#160;solution&#160;&#160;&#160;would&#160;&#160;&#160;be&#160;&#160;&#160;to&#160;&#160;&#160;distribute&#160;<br/>platforms&#160;&#160;&#160;with&#160;&#160;&#160;an&#160;&#160;&#160;activated&#160;&#160;&#160;TPM&#160;&#160;&#160;and&#160;&#160;an&#160;&#160;&#160;owner&#160;&#160;&#160;authorisation&#160;&#160;&#160;secret&#160;&#160;&#160;that&#160;&#160;&#160;is&#160;<br/>unknown&#160;to&#160;the&#160;user.&#160;This&#160;solution&#160;does&#160;not&#160;conform&#160;to&#160;the&#160;TCG&#160;specification&#160;<br/>that&#160;demands&#160;that&#160;TCG-enabled&#160;platforms&#160;have&#160;to&#160;be&#160;shipped&#160;with&#160;no&#160;owner&#160;<br/>installed.</p>
<p style="position:absolute;top:503px;left:112px;white-space:nowrap" class="ft4434">●</p>
<p style="position:absolute;top:493px;left:139px;white-space:nowrap" class="ft4415">SRK&#160;&#160;&#160;Regeneration:&#160;&#160;&#160;An&#160;&#160;&#160;alternative&#160;&#160;&#160;way&#160;&#160;&#160;to&#160;&#160;&#160;prevent&#160;&#160;&#160;replay&#160;&#160;&#160;attacks&#160;&#160;&#160;based&#160;&#160;&#160;on&#160;<br/>TPMs&#160;&#160;version&#160;1.1b&#160;would&#160;be&#160;to&#160;create&#160;a&#160;new&#160;Storage&#160;Root&#160;Key&#160;(SRK)&#160;before&#160;<br/>the&#160;&#160;&#160;system&#160;&#160;&#160;is&#160;&#160;&#160;shut&#160;&#160;&#160;down.&#160;&#160;&#160;Regeneration&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;SRK&#160;&#160;&#160;would&#160;&#160;&#160;prevent&#160;&#160;&#160;that&#160;<br/>previously&#160;created&#160;TPM&#160;encryption&#160;keys&#160;can&#160;be&#160;used&#160;any&#160;more.&#160;Unfortunately,&#160;<br/>an&#160;&#160;&#160;SRK&#160;&#160;&#160;can&#160;&#160;&#160;only&#160;&#160;&#160;be&#160;&#160;&#160;renewed&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;</p>
<p style="position:absolute;top:570px;left:486px;white-space:nowrap" class="ft4420"><i>TakeOwnership</i></p>
<p style="position:absolute;top:570px;left:616px;white-space:nowrap" class="ft4414">&#160;&#160;function&#160;&#160;&#160;which&#160;&#160;&#160;itself&#160;</p>
<p style="position:absolute;top:589px;left:139px;white-space:nowrap" class="ft4414">requires&#160;a&#160;previously&#160;&#160;</p>
<p style="position:absolute;top:589px;left:329px;white-space:nowrap" class="ft4420"><i>OwnerClear</i></p>
<p style="position:absolute;top:589px;left:431px;white-space:nowrap" class="ft4414">&#160;&#160;that&#160;itself&#160;disables&#160;the&#160;TPM.&#160;Therefore,&#160;an&#160;</p>
<p style="position:absolute;top:609px;left:139px;white-space:nowrap" class="ft4414">online&#160;regeneration&#160;of&#160;the&#160;SRK&#160;seems&#160;to&#160;be&#160;impossible.</p>
<p style="position:absolute;top:648px;left:112px;white-space:nowrap" class="ft4434">●</p>
<p style="position:absolute;top:639px;left:139px;white-space:nowrap" class="ft4415">NV-RAM:&#160;TPMs&#160;version&#160;1.2&#160;provide&#160;a&#160;limited&#160;amount&#160;of&#160;non-volatile&#160;(NV-)&#160;RAM&#160;<br/>to&#160;&#160;which&#160;&#160;access&#160;&#160;is&#160;&#160;restricted&#160;&#160;to&#160;authorised&#160;&#160;entities.&#160;&#160;So&#160;called&#160;NV-Attributes&#160;<br/>define&#160;which&#160;entities&#160;are&#160;authorised&#160;to&#160;write&#160;to&#160;and/or&#160;read&#160;from&#160;the&#160;NV-RAM.&#160;<br/>Thus,&#160;data&#160;integrity&#160;can&#160;be&#160;preserved&#160;by&#160;storing&#160;a&#160;hash&#160;value&#160;of&#160;the&#160;data&#160;into&#160;<br/>the&#160;&#160;&#160;NV-RAM&#160;&#160;&#160;and&#160;&#160;&#160;ensuring&#160;&#160;&#160;that&#160;&#160;&#160;only&#160;&#160;&#160;the&#160;&#160;&#160;Storage&#160;&#160;&#160;Manager&#160;&#160;&#160;can&#160;&#160;&#160;access&#160;&#160;&#160;the&#160;<br/>authorisation&#160;secret.</p>
<p style="position:absolute;top:774px;left:112px;white-space:nowrap" class="ft4434">●</p>
<p style="position:absolute;top:765px;left:139px;white-space:nowrap" class="ft4415">Secure&#160;Counter:&#160;A&#160;TPM&#160;version&#160;1.2&#160;supports&#160;at&#160;least&#160;four&#160;monotonic&#160;counters.&#160;<br/>Based&#160;on&#160;this&#160;functionality,&#160;the&#160;freshness&#160;of&#160;data&#160;can&#160;be&#160;detected&#160;by&#160;securely&#160;<br/>concatenating&#160;it&#160;with&#160;the&#160;actual&#160;counter&#160;value.</p>
<p style="position:absolute;top:846px;left:85px;white-space:nowrap" class="ft4415">As&#160;a&#160;result&#160;of&#160;our&#160;previous&#160;analysis,&#160;we&#160;showed&#160;that&#160;TPMs&#160;version&#160;1.1b&#160;cannot&#160;be&#160;<br/>used&#160;&#160;&#160;to&#160;&#160;&#160;provide&#160;&#160;&#160;fresh&#160;&#160;&#160;storage&#160;&#160;&#160;as&#160;&#160;&#160;required&#160;&#160;&#160;to&#160;&#160;&#160;enforce&#160;&#160;&#160;stateful&#160;&#160;&#160;licenses&#160;&#160;&#160;and/or&#160;&#160;&#160;to&#160;<br/>transfer&#160;&#160;&#160;licenses,&#160;&#160;&#160;as&#160;&#160;&#160;it&#160;&#160;&#160;is&#160;&#160;&#160;needed&#160;&#160;&#160;for&#160;&#160;&#160;digital&#160;&#160;&#160;rights&#160;&#160;&#160;management,&#160;&#160;&#160;for&#160;&#160;&#160;example.&#160;<br/>Therefore,&#160;&#160;we&#160;&#160;decided&#160;to&#160;&#160;realise&#160;&#160;&#160;trusted&#160;storage&#160;&#160;&#160;based&#160;&#160;on&#160;&#160;the&#160;&#160;monotonic&#160;&#160;counter&#160;<br/>functionality&#160;of&#160;TPMs&#160;version&#160;1.2.&#160;For&#160;the&#160;secure&#160;wallet,&#160;however,&#160;freshness&#160;is&#160;not&#160;<br/>needed,&#160;hence&#160;the&#160;functionality&#160;provided&#160;by&#160;a&#160;TPM&#160;of&#160;version&#160;1.1b&#160;is&#160;sufficient.<br/>A&#160;&#160;&#160;monotonic&#160;&#160;&#160;hardware&#160;&#160;&#160;counter&#160;&#160;&#160;allows&#160;&#160;&#160;us&#160;&#160;&#160;to&#160;&#160;&#160;securely&#160;&#160;&#160;maintain&#160;&#160;&#160;versioning&#160;&#160;&#160;of&#160;&#160;&#160;an&#160;<br/>arbitrary&#160;data&#160;component,&#160;by&#160;keeping&#160;a&#160;software&#160;counter&#160;synchronised&#160;with&#160;one&#160;(of&#160;<br/>four&#160;guaranteed)&#160;hardware&#160;counters&#160;of&#160;the&#160;TPM.&#160;&#160;</p>
<p style="position:absolute;top:1008px;left:516px;white-space:nowrap" class="ft4420"><i>SM&#160;&#160;</i></p>
<p style="position:absolute;top:1008px;left:552px;white-space:nowrap" class="ft4414">manages&#160;an&#160;internal&#160;software&#160;</p>
<p style="position:absolute;top:1028px;left:85px;white-space:nowrap" class="ft4415">counter&#160;that,&#160;every&#160;time&#160;SM&#160;updates&#160;its&#160;index,&#160;is&#160;incremented&#160;synchronously&#160;with&#160;the&#160;<br/>monotonic&#160;&#160;&#160;hardware&#160;&#160;&#160;counter.&#160;&#160;&#160;If&#160;&#160;&#160;both&#160;&#160;&#160;mismatch&#160;&#160;&#160;at&#160;&#160;&#160;any&#160;&#160;&#160;time,&#160;&#160;&#160;outdated&#160;&#160;&#160;data&#160;&#160;&#160;is&#160;<br/>detected,&#160;which&#160;will&#160;be&#160;handled&#160;according&#160;to&#160;the&#160;actual&#160;security&#160;policy.&#160;However,&#160;in&#160;<br/>order&#160;to&#160;employ&#160;a&#160;TPM&#160;monotonic&#160;counter,&#160;</p>
<p style="position:absolute;top:1085px;left:458px;white-space:nowrap" class="ft4420"><i>SM</i></p>
<p style="position:absolute;top:1085px;left:486px;white-space:nowrap" class="ft4414">&#160;has&#160;to&#160;be&#160;initialised&#160;correctly.&#160;On&#160;the&#160;</p>
<p style="position:absolute;top:1104px;left:85px;white-space:nowrap" class="ft4414">initial&#160;setup&#160;SM&#160;uses&#160;the&#160;TPM&#160;to&#160;create&#160;its&#160;internal&#160;cryptographic&#160;key&#160;</p>
<p style="position:absolute;top:1104px;left:697px;white-space:nowrap" class="ft4420"><i>k</i></p>
<p style="position:absolute;top:1112px;left:707px;white-space:nowrap" class="ft4431"><i>SM</i></p>
<p style="position:absolute;top:1104px;left:723px;white-space:nowrap" class="ft4414">&#160;that&#160;then&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft447">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft447">44/109</p>
</div>
<!-- Page 45 -->
<a name="45"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4535{font-size:9px;font-family:CAAAAA+DejaVuSans;color:#000000;}
-->
</style>
<div id="page45-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application045.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft4512">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft450">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft454">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft454">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft4515">will&#160;be&#160;sealed&#160;to&#160;the&#160;actual&#160;platform&#160;configuration.<br/>To&#160;&#160;&#160;enable&#160;&#160;&#160;freshness&#160;&#160;&#160;detection&#160;&#160;&#160;and&#160;&#160;&#160;thus&#160;&#160;&#160;trusted&#160;&#160;&#160;storage,&#160;&#160;SM&#160;&#160;creates&#160;&#160;&#160;a&#160;&#160;&#160;monotonic&#160;<br/>counter&#160;</p>
<p style="position:absolute;top:198px;left:157px;white-space:nowrap" class="ft4520"><i>c</i></p>
<p style="position:absolute;top:206px;left:166px;white-space:nowrap" class="ft4531"><i>SM</i></p>
<p style="position:absolute;top:198px;left:182px;white-space:nowrap" class="ft4514">&#160;with&#160;&#160;authentication&#160;data&#160;</p>
<p style="position:absolute;top:198px;left:410px;white-space:nowrap" class="ft4520"><i>auth</i></p>
<p style="position:absolute;top:198px;left:448px;white-space:nowrap" class="ft4514">,&#160;e.g.,&#160;a&#160;secret&#160;password.&#160;The&#160;initial&#160;setup&#160;</p>
<p style="position:absolute;top:218px;left:85px;white-space:nowrap" class="ft4514">finishes&#160;with&#160;the&#160;creation&#160;of&#160;</p>
<p style="position:absolute;top:218px;left:335px;white-space:nowrap" class="ft4520"><i>SM</i></p>
<p style="position:absolute;top:218px;left:363px;white-space:nowrap" class="ft4514">’s&#160;internal&#160;metadata&#160;index&#160;&#160;</p>
<p style="position:absolute;top:218px;left:596px;white-space:nowrap" class="ft4520"><i>i</i></p>
<p style="position:absolute;top:226px;left:601px;white-space:nowrap" class="ft4531"><i>SM</i></p>
<p style="position:absolute;top:218px;left:617px;white-space:nowrap" class="ft4514">&#160;&#160;and&#160;the&#160;saving&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:237px;left:85px;white-space:nowrap" class="ft4518">sealed&#160;key&#160;blob&#160;and&#160;the&#160;encrypted&#160;index&#160;on&#160;untrusted&#160;storage.<br/>After&#160;a&#160;platform&#160;reboot,&#160;</p>
<p style="position:absolute;top:265px;left:296px;white-space:nowrap" class="ft4520"><i>SM</i></p>
<p style="position:absolute;top:265px;left:324px;white-space:nowrap" class="ft4514">&#160;reads&#160;the&#160;key&#160;blob&#160;from&#160;the&#160;untrusted&#160;storage&#160;and&#160;asks&#160;</p>
<p style="position:absolute;top:284px;left:85px;white-space:nowrap" class="ft4514">the&#160;TPM&#160;to&#160;unseal&#160;its&#160;internal&#160;key.&#160;The&#160;TPM&#160;is&#160;able&#160;to&#160;unseal&#160;</p>
<p style="position:absolute;top:284px;left:617px;white-space:nowrap" class="ft4520"><i>k</i></p>
<p style="position:absolute;top:292px;left:627px;white-space:nowrap" class="ft4531"><i>SM</i></p>
<p style="position:absolute;top:284px;left:643px;white-space:nowrap" class="ft4514">&#160;if&#160;the&#160;platform&#160;has&#160;</p>
<p style="position:absolute;top:303px;left:85px;white-space:nowrap" class="ft4514">the&#160;same&#160;configuration&#160;as&#160;it&#160;was&#160;at&#160;the&#160;sealing&#160;process,&#160;thus&#160;preventing&#160;a&#160;modified&#160;</p>
<p style="position:absolute;top:323px;left:85px;white-space:nowrap" class="ft4520"><i>SM</i></p>
<p style="position:absolute;top:323px;left:113px;white-space:nowrap" class="ft4514">&#160;to&#160;access&#160;</p>
<p style="position:absolute;top:323px;left:201px;white-space:nowrap" class="ft4520"><i>i</i></p>
<p style="position:absolute;top:331px;left:206px;white-space:nowrap" class="ft4531"><i>SM&#160;</i></p>
<p style="position:absolute;top:323px;left:225px;white-space:nowrap" class="ft4514">.</p>
<p style="position:absolute;top:351px;left:85px;white-space:nowrap" class="ft4514">Then&#160;&#160;</p>
<p style="position:absolute;top:351px;left:136px;white-space:nowrap" class="ft4520"><i>SM</i></p>
<p style="position:absolute;top:351px;left:164px;white-space:nowrap" class="ft4514">&#160;&#160;uses&#160;&#160;</p>
<p style="position:absolute;top:351px;left:218px;white-space:nowrap" class="ft4520"><i>k</i></p>
<p style="position:absolute;top:359px;left:228px;white-space:nowrap" class="ft4531"><i>SM&#160;&#160;</i></p>
<p style="position:absolute;top:351px;left:251px;white-space:nowrap" class="ft4514">to&#160;decrypt&#160;its&#160;metadata&#160;index&#160;read&#160;from&#160;the&#160;untrusted&#160;storage.&#160;</p>
<p style="position:absolute;top:370px;left:85px;white-space:nowrap" class="ft4514">Finally,&#160;&#160;</p>
<p style="position:absolute;top:370px;left:155px;white-space:nowrap" class="ft4520"><i>SM</i></p>
<p style="position:absolute;top:370px;left:184px;white-space:nowrap" class="ft4514">&#160;&#160;verifies&#160;the&#160;freshness&#160;of&#160;&#160;</p>
<p style="position:absolute;top:370px;left:408px;white-space:nowrap" class="ft4520"><i>i</i></p>
<p style="position:absolute;top:378px;left:413px;white-space:nowrap" class="ft4531"><i>SM</i></p>
<p style="position:absolute;top:370px;left:430px;white-space:nowrap" class="ft4514">&#160;&#160;by&#160;comparing&#160;the&#160;decrypted&#160;counter&#160;&#160;of&#160;</p>
<p style="position:absolute;top:370px;left:786px;white-space:nowrap" class="ft4520"><i>i</i></p>
<p style="position:absolute;top:378px;left:792px;white-space:nowrap" class="ft4531"><i>SM&#160;</i></p>
<p style="position:absolute;top:389px;left:85px;white-space:nowrap" class="ft4514">with&#160;the&#160;actual&#160;counter&#160;value&#160;of&#160;the&#160;corresponding&#160;TPM&#160;counter&#160;</p>
<p style="position:absolute;top:389px;left:630px;white-space:nowrap" class="ft4520"><i>c</i></p>
<p style="position:absolute;top:397px;left:640px;white-space:nowrap" class="ft4531"><i>SM&#160;</i></p>
<p style="position:absolute;top:389px;left:659px;white-space:nowrap" class="ft4514">.</p>
<p style="position:absolute;top:417px;left:85px;white-space:nowrap" class="ft4515">To&#160;&#160;&#160;bind&#160;&#160;&#160;a&#160;&#160;&#160;compartment’s&#160;&#160;&#160;data&#160;&#160;&#160;object&#160;&#160;&#160;persistently&#160;&#160;&#160;to&#160;&#160;&#160;its&#160;&#160;&#160;actual&#160;&#160;&#160;configuration&#160;&#160;&#160;the&#160;<br/>following&#160;has&#160;to&#160;be&#160;done:&#160;After&#160;the&#160;mapping&#160;of&#160;compartment&#160;identifier&#160;to&#160;the&#160;actual&#160;<br/>compartment&#160;&#160;&#160;configuration&#160;&#160;&#160;using&#160;&#160;&#160;the&#160;&#160;&#160;Compartment&#160;&#160;&#160;Manager&#160;&#160;</p>
<p style="position:absolute;top:456px;left:629px;white-space:nowrap" class="ft4520"><i>CM</i></p>
<p style="position:absolute;top:456px;left:659px;white-space:nowrap" class="ft4514">,&#160;&#160;</p>
<p style="position:absolute;top:456px;left:673px;white-space:nowrap" class="ft4520"><i>SM</i></p>
<p style="position:absolute;top:456px;left:702px;white-space:nowrap" class="ft4514">&#160;&#160;updates&#160;&#160;</p>
<p style="position:absolute;top:456px;left:786px;white-space:nowrap" class="ft4520"><i>i</i></p>
<p style="position:absolute;top:464px;left:792px;white-space:nowrap" class="ft4531"><i>SM&#160;</i></p>
<p style="position:absolute;top:475px;left:85px;white-space:nowrap" class="ft4515">with&#160;&#160;&#160;the&#160;&#160;&#160;corresponding&#160;&#160;&#160;metadata&#160;&#160;&#160;as&#160;&#160;well&#160;&#160;&#160;as&#160;&#160;the&#160;&#160;&#160;incremented&#160;&#160;software&#160;&#160;&#160;counter&#160;&#160;&#160;to&#160;<br/>enable&#160;freshness&#160;detection&#160;for&#160;</p>
<p style="position:absolute;top:494px;left:351px;white-space:nowrap" class="ft4520"><i>i</i></p>
<p style="position:absolute;top:502px;left:356px;white-space:nowrap" class="ft4531"><i>SM</i></p>
<p style="position:absolute;top:494px;left:372px;white-space:nowrap" class="ft4514">.&#160;Afterwards,&#160;</p>
<p style="position:absolute;top:494px;left:489px;white-space:nowrap" class="ft4520"><i>SM</i></p>
<p style="position:absolute;top:494px;left:518px;white-space:nowrap" class="ft4514">&#160;writes&#160;both,&#160;the&#160;data&#160;objects&#160;and&#160;</p>
<p style="position:absolute;top:513px;left:85px;white-space:nowrap" class="ft4514">the&#160;&#160;&#160;updated&#160;&#160;&#160;index,&#160;&#160;&#160;on&#160;&#160;&#160;the&#160;&#160;&#160;untrusted&#160;&#160;&#160;storage,&#160;&#160;&#160;encrypted&#160;&#160;&#160;with&#160;&#160;&#160;k</p>
<p style="position:absolute;top:521px;left:671px;white-space:nowrap" class="ft4531"><i>SM</i></p>
<p style="position:absolute;top:513px;left:688px;white-space:nowrap" class="ft4514">.&#160;&#160;&#160;Finally,&#160;&#160;</p>
<p style="position:absolute;top:513px;left:780px;white-space:nowrap" class="ft4520"><i>SM&#160;</i></p>
<p style="position:absolute;top:533px;left:85px;white-space:nowrap" class="ft4515">synchronises&#160;its&#160;software&#160;counter&#160;with&#160;the&#160;TPM’s&#160;monotonic&#160;hardware&#160;counter&#160;and&#160;<br/>returns&#160;the&#160;data&#160;object&#160;identifier.<br/>We&#160;complete&#160;the&#160;scenario&#160;with&#160;loading&#160;a&#160;compartment’s&#160;data&#160;object&#160;again:&#160;After&#160;the&#160;<br/>mapping&#160;&#160;&#160;of&#160;&#160;&#160;requesting&#160;&#160;&#160;compartment&#160;&#160;&#160;identifier&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;actual&#160;&#160;&#160;compartment&#160;<br/>configuration&#160;using&#160;</p>
<p style="position:absolute;top:618px;left:256px;white-space:nowrap" class="ft4520"><i>CM</i></p>
<p style="position:absolute;top:618px;left:286px;white-space:nowrap" class="ft4514">,&#160;</p>
<p style="position:absolute;top:618px;left:298px;white-space:nowrap" class="ft4520"><i>SM</i></p>
<p style="position:absolute;top:618px;left:326px;white-space:nowrap" class="ft4514">&#160;reads&#160;the&#160;requested&#160;data&#160;object&#160;from&#160;untrusted&#160;storage&#160;</p>
<p style="position:absolute;top:638px;left:85px;white-space:nowrap" class="ft4514">and&#160;decrypts&#160;it&#160;using&#160;</p>
<p style="position:absolute;top:638px;left:274px;white-space:nowrap" class="ft4520"><i>k</i></p>
<p style="position:absolute;top:646px;left:284px;white-space:nowrap" class="ft4531"><i>SM</i></p>
<p style="position:absolute;top:638px;left:300px;white-space:nowrap" class="ft4514">.&#160;Before&#160;returning&#160;data&#160;to&#160;the&#160;corresponding&#160;compartment,&#160;</p>
<p style="position:absolute;top:657px;left:85px;white-space:nowrap" class="ft4520"><i>SM</i></p>
<p style="position:absolute;top:657px;left:113px;white-space:nowrap" class="ft4514">&#160;verifies&#160;all&#160;access&#160;restrictions&#160;(e.g.,&#160;freshness,&#160;or&#160;a&#160;certain&#160;user&#160;id)&#160;given&#160;on&#160;store&#160;</p>
<p style="position:absolute;top:676px;left:85px;white-space:nowrap" class="ft4514">via&#160;</p>
<p style="position:absolute;top:676px;left:116px;white-space:nowrap" class="ft4520"><i>rest</i></p>
<p style="position:absolute;top:676px;left:149px;white-space:nowrap" class="ft4514">&#160;based&#160;on&#160;the&#160;corresponding&#160;metadata&#160;in&#160;</p>
<p style="position:absolute;top:676px;left:509px;white-space:nowrap" class="ft4520"><i>i</i></p>
<p style="position:absolute;top:684px;left:514px;white-space:nowrap" class="ft4531"><i>SM</i></p>
<p style="position:absolute;top:676px;left:531px;white-space:nowrap" class="ft4514">&#160;and&#160;verifies&#160;that&#160;the&#160;requesting&#160;</p>
<p style="position:absolute;top:695px;left:85px;white-space:nowrap" class="ft4514">compartment&#160;has&#160;the&#160;same&#160;configuration&#160;as&#160;it&#160;was&#160;on&#160;</p>
<p style="position:absolute;top:695px;left:540px;white-space:nowrap" class="ft4520"><i>store[]</i></p>
<p style="position:absolute;top:695px;left:596px;white-space:nowrap" class="ft4514">.</p>
<p style="position:absolute;top:741px;left:85px;white-space:nowrap" class="ft456"><b>2.6.3&#160;X-GOLD</b></p>
<p style="position:absolute;top:741px;left:209px;white-space:nowrap" class="ft4535"><b>TM&#160;</b></p>
<p style="position:absolute;top:741px;left:227px;white-space:nowrap" class="ft456"><b>208-Based&#160;Architecture</b></p>
<p style="position:absolute;top:768px;left:85px;white-space:nowrap" class="ft4514">Ideally,&#160;&#160;&#160;the&#160;&#160;&#160;architecture&#160;&#160;&#160;on&#160;&#160;&#160;the&#160;&#160;&#160;X-GOLD</p>
<p style="position:absolute;top:768px;left:447px;white-space:nowrap" class="ft4517">TM&#160;&#160;</p>
<p style="position:absolute;top:768px;left:471px;white-space:nowrap" class="ft4514">208&#160;&#160;&#160;platform&#160;&#160;&#160;[74]&#160;&#160;&#160;should&#160;&#160;&#160;look&#160;&#160;&#160;almost&#160;</p>
<p style="position:absolute;top:787px;left:85px;white-space:nowrap" class="ft4514">identical&#160;to&#160;the&#160;PC-based&#160;architecture.&#160;However,&#160;there&#160;are&#160;some&#160;differences:</p>
<p style="position:absolute;top:815px;left:112px;white-space:nowrap" class="ft4514">1.&#160;The&#160;L4&#160;microkernel,&#160;L4env,&#160;and&#160;the&#160;Security&#160;Services&#160;must&#160;be&#160;protected&#160;by&#160;the&#160;</p>
<p style="position:absolute;top:835px;left:139px;white-space:nowrap" class="ft4514">secure&#160;boot&#160;feature&#160;of&#160;X-GOLD</p>
<p style="position:absolute;top:835px;left:398px;white-space:nowrap" class="ft4517">TM&#160;</p>
<p style="position:absolute;top:835px;left:417px;white-space:nowrap" class="ft4514">208,&#160;instead&#160;of&#160;the&#160;authenticated&#160;boot&#160;used&#160;by&#160;</p>
<p style="position:absolute;top:854px;left:139px;white-space:nowrap" class="ft4515">TCG-compliant&#160;PCs.&#160;Compartments&#160;are&#160;measured&#160;the&#160;same&#160;way&#160;as&#160;on&#160;the&#160;PC&#160;<br/>platform&#160;(i.e.,&#160;it&#160;is&#160;not&#160;necessary&#160;to&#160;protect&#160;them&#160;by&#160;secure&#160;boot).</p>
<p style="position:absolute;top:901px;left:112px;white-space:nowrap" class="ft4514">2.&#160;For&#160;&#160;&#160;the&#160;&#160;&#160;trusted&#160;&#160;&#160;storage,&#160;&#160;&#160;the&#160;&#160;&#160;mobile&#160;&#160;&#160;system&#160;&#160;&#160;must&#160;&#160;&#160;use&#160;&#160;&#160;the&#160;&#160;&#160;cryptographic&#160;</p>
<p style="position:absolute;top:920px;left:139px;white-space:nowrap" class="ft4514">functionality&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;X-GOLD</p>
<p style="position:absolute;top:920px;left:389px;white-space:nowrap" class="ft4517">TM&#160;&#160;</p>
<p style="position:absolute;top:920px;left:414px;white-space:nowrap" class="ft4514">208&#160;&#160;&#160;instead&#160;&#160;&#160;of&#160;&#160;&#160;a&#160;&#160;&#160;hardware&#160;&#160;&#160;TPM.&#160;&#160;&#160;As&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;</p>
<p style="position:absolute;top:940px;left:139px;white-space:nowrap" class="ft4515">demonstration&#160;architecture&#160;presented&#160;below,&#160;this&#160;can&#160;be&#160;achieved&#160;by&#160;using&#160;a&#160;<br/>(modified)&#160;TPM&#160;“emulator”,&#160;which&#160;is&#160;implemented&#160;on&#160;top&#160;of&#160;X-GOLD</p>
<p style="position:absolute;top:959px;left:720px;white-space:nowrap" class="ft4517">TM&#160;</p>
<p style="position:absolute;top:959px;left:740px;white-space:nowrap" class="ft4514">208&#160;and&#160;</p>
<p style="position:absolute;top:978px;left:139px;white-space:nowrap" class="ft4514">provides&#160;a&#160;TPM&#160;(or&#160;MTM)&#160;compatible&#160;interface.</p>
<p style="position:absolute;top:1024px;left:85px;white-space:nowrap" class="ft456"><b>2.6.4&#160;Hybrid&#160;Architecture&#160;for&#160;Demo-Prototype</b></p>
<p style="position:absolute;top:1051px;left:85px;white-space:nowrap" class="ft4515">Unfortunately,&#160;&#160;it&#160;&#160;&#160;is&#160;not&#160;&#160;&#160;possible&#160;&#160;&#160;to&#160;implement&#160;&#160;&#160;the&#160;&#160;entire&#160;&#160;system&#160;on&#160;&#160;&#160;the&#160;&#160;mobile&#160;&#160;X-<br/>GOLD</p>
<p style="position:absolute;top:1070px;left:136px;white-space:nowrap" class="ft4517">TM&#160;&#160;</p>
<p style="position:absolute;top:1070px;left:158px;white-space:nowrap" class="ft4514">208&#160;platform&#160;within&#160;the&#160;scope&#160;of&#160;the&#160;OpenTC&#160;project&#160;(for&#160;instance,&#160;porting&#160;</p>
<p style="position:absolute;top:1089px;left:85px;white-space:nowrap" class="ft4515">drivers&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;microkernel-based&#160;&#160;&#160;system&#160;&#160;&#160;is&#160;&#160;&#160;a&#160;&#160;&#160;substantial&#160;&#160;&#160;effort).&#160;&#160;&#160;However,&#160;&#160;&#160;some&#160;<br/>functionalities&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;implemented&#160;&#160;&#160;on&#160;&#160;&#160;the&#160;&#160;&#160;mobile&#160;&#160;&#160;platform&#160;&#160;&#160;to&#160;&#160;&#160;demonstrate&#160;&#160;&#160;the&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft457">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft457">45/109</p>
</div>
<!-- Page 46 -->
<a name="46"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4636{font-size:11px;font-family:EAAAAA+DejaVuSerif;color:#000000;}
-->
</style>
<div id="page46-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application046.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft4612">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft460">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft464">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft464">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft4615">concept.&#160;&#160;&#160;We&#160;&#160;&#160;propose&#160;&#160;&#160;to&#160;&#160;adapt&#160;&#160;&#160;the&#160;&#160;&#160;architecture&#160;&#160;&#160;shown&#160;&#160;&#160;in&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#41">&#160;Figure&#160;&#160;&#160;11&#160;&#160;</a>for&#160;&#160;&#160;a&#160;&#160;&#160;system,&#160;<br/>where&#160;some&#160;parts&#160;are&#160;still&#160;running&#160;on&#160;a&#160;PC.&#160;The&#160;result&#160;is&#160;shown&#160;in<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#46">&#160;Figure&#160;13:</a>&#160;the&#160;PC&#160;<br/>platform&#160;communicates&#160;with&#160;the&#160;mobile&#160;platform&#160;via&#160;a&#160;serial&#160;interface.</p>
<p style="position:absolute;top:933px;left:85px;white-space:nowrap" class="ft466"><b>Communication&#160;between&#160;PC&#160;and&#160;X-GOLD</b></p>
<p style="position:absolute;top:933px;left:429px;white-space:nowrap" class="ft4635"><b>TM&#160;</b></p>
<p style="position:absolute;top:933px;left:447px;white-space:nowrap" class="ft466"><b>208&#160;platform</b></p>
<p style="position:absolute;top:959px;left:85px;white-space:nowrap" class="ft4615">We&#160;use&#160;a&#160;serial&#160;line&#160;for&#160;the&#160;communication&#160;between&#160;the&#160;PC&#160;and&#160;mobile&#160;platform.&#160;The&#160;<br/>functions&#160;needed&#160;by&#160;the&#160;(modified)&#160;Storage&#160;Manager&#160;for&#160;sealing&#160;will&#160;be&#160;executed&#160;on&#160;<br/>the&#160;X-GOLD</p>
<p style="position:absolute;top:998px;left:187px;white-space:nowrap" class="ft4617">TM&#160;</p>
<p style="position:absolute;top:998px;left:207px;white-space:nowrap" class="ft4614">208&#160;platform.&#160;For&#160;the&#160;communication,&#160;with&#160;the&#160;X-GOLD</p>
<p style="position:absolute;top:998px;left:680px;white-space:nowrap" class="ft4617">TM&#160;</p>
<p style="position:absolute;top:998px;left:700px;white-space:nowrap" class="ft4614">208&#160;board,&#160;a&#160;</p>
<p style="position:absolute;top:1017px;left:85px;white-space:nowrap" class="ft4615">proxy&#160;is&#160;used,&#160;hence&#160;the&#160;Wallet-PC&#160;does&#160;not&#160;have&#160;to&#160;handle&#160;the&#160;serial&#160;communication&#160;<br/>directly.&#160;Instead,&#160;TCP&#160;sockets&#160;are&#160;used&#160;for&#160;the&#160;communication&#160;between&#160;the&#160;Wallet-PC&#160;<br/>and&#160;proxy&#160;(see&#160;below).</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft467">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft467">46/109</p>
<p style="position:absolute;top:498px;left:85px;white-space:nowrap" class="ft4614">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:503px;left:437px;white-space:nowrap" class="ft4636">Serial&#160;Line</p>
<p style="position:absolute;top:786px;left:85px;white-space:nowrap" class="ft4614">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:852px;left:85px;white-space:nowrap" class="ft463"><b>Figure&#160;13:&#160;Architectural&#160;overview&#160;for&#160;a&#160;demo-prototype.&#160;</b></p>
<p style="position:absolute;top:870px;left:85px;white-space:nowrap" class="ft464">Only&#160;some&#160;core&#160;functionalities&#160;are&#160;implemented&#160;on&#160;the&#160;mobile&#160;platform,&#160;the&#160;rest&#160;has&#160;to&#160;be&#160;</p>
<p style="position:absolute;top:887px;left:85px;white-space:nowrap" class="ft464">provided&#160;by&#160;the&#160;PC.</p>
<p style="position:absolute;top:785px;left:186px;white-space:nowrap" class="ft4630">PC&#160;Hardware&#160;with&#160;TPM</p>
<p style="position:absolute;top:783px;left:578px;white-space:nowrap" class="ft4630">X-GOLD&#160;Hardware&#160;</p>
<p style="position:absolute;top:717px;left:217px;white-space:nowrap" class="ft4630">L4 Microkernel</p>
<p style="position:absolute;top:719px;left:596px;white-space:nowrap" class="ft4630">L4 Microkernel</p>
<p style="position:absolute;top:653px;left:217px;white-space:nowrap" class="ft4630">L4 Environment</p>
<p style="position:absolute;top:656px;left:594px;white-space:nowrap" class="ft4630">L4 Environment</p>
<p style="position:absolute;top:581px;left:540px;white-space:nowrap" class="ft4630">X-GOLD&#160;</p>
<p style="position:absolute;top:603px;left:528px;white-space:nowrap" class="ft4630">Crypto Driver</p>
<p style="position:absolute;top:585px;left:191px;white-space:nowrap" class="ft4633">Compartment</p>
<p style="position:absolute;top:603px;left:204px;white-space:nowrap" class="ft4633">Manager</p>
<p style="position:absolute;top:594px;left:118px;white-space:nowrap" class="ft4633">Secure&#160;GUI</p>
<p style="position:absolute;top:583px;left:366px;white-space:nowrap" class="ft4633">Network</p>
<p style="position:absolute;top:601px;left:364px;white-space:nowrap" class="ft4633">Manager</p>
<p style="position:absolute;top:584px;left:290px;white-space:nowrap" class="ft4633">Storage</p>
<p style="position:absolute;top:602px;left:281px;white-space:nowrap" class="ft4633">&#160;&#160;Manager&#160;</p>
<p style="position:absolute;top:536px;left:252px;white-space:nowrap" class="ft4633">L4&#160;Linux&#160;Kernel</p>
<p style="position:absolute;top:563px;left:692px;white-space:nowrap" class="ft4630">L4 Linux</p>
<p style="position:absolute;top:517px;left:355px;white-space:nowrap" class="ft4633">Comm.Serv.</p>
<p style="position:absolute;top:535px;left:356px;white-space:nowrap" class="ft4633">to&#160;X-GOLD</p>
<p style="position:absolute;top:476px;left:531px;white-space:nowrap" class="ft4633">Communication&#160;</p>
<p style="position:absolute;top:494px;left:540px;white-space:nowrap" class="ft4633">Service&#160;to&#160;PC</p>
<p style="position:absolute;top:478px;left:266px;white-space:nowrap" class="ft4633">Legacy&#160;OS</p>
<p style="position:absolute;top:498px;left:253px;white-space:nowrap" class="ft469">(Here,&#160;L4&#160;Linux)</p>
<p style="position:absolute;top:530px;left:527px;white-space:nowrap" class="ft4630">TPM&#160;Emulator</p>
<p style="position:absolute;top:401px;left:270px;white-space:nowrap" class="ft4630">Browser</p>
<p style="position:absolute;top:423px;left:131px;white-space:nowrap" class="ft4630">Secure&#160;Wallet</p>
<p style="position:absolute;top:445px;left:128px;white-space:nowrap" class="ft4633">(Current&#160;version&#160;</p>
<p style="position:absolute;top:463px;left:122px;white-space:nowrap" class="ft4633">implemented&#160;using</p>
<p style="position:absolute;top:481px;left:151px;white-space:nowrap" class="ft4633">L4&#160;Linux)</p>
</div>
<!-- Page 47 -->
<a name="47"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4737{font-size:10px;font-family:DAAAAA+DejaVuSerif;color:#000000;}
-->
</style>
<div id="page47-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application047.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft4712">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft470">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft474">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft474">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft4721"><b>2.7&#160;Porting&#160;and&#160;Test&#160;Concepts&#160;of&#160;the&#160;TPM&#160;emulator&#160;on&#160;X-GOLD</b></p>
<p style="position:absolute;top:151px;left:683px;white-space:nowrap" class="ft4737"><b>TM&#160;</b></p>
<p style="position:absolute;top:151px;left:704px;white-space:nowrap" class="ft4721"><b>208</b></p>
<p style="position:absolute;top:179px;left:85px;white-space:nowrap" class="ft4715">In&#160;&#160;&#160;this&#160;&#160;&#160;section&#160;&#160;&#160;we&#160;&#160;&#160;will&#160;&#160;&#160;focus&#160;&#160;&#160;on&#160;&#160;&#160;development&#160;&#160;&#160;and&#160;&#160;&#160;test&#160;&#160;&#160;aspects&#160;&#160;&#160;related&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;<br/>implementation&#160;of&#160;the&#160;TPM&#160;emulator&#160;on&#160;the&#160;Infineon&#160;X-GOLD</p>
<p style="position:absolute;top:199px;left:614px;white-space:nowrap" class="ft4717">TM&#160;&#160;</p>
<p style="position:absolute;top:199px;left:635px;white-space:nowrap" class="ft4714">208&#160;(formerly&#160;called&#160;</p>
<p style="position:absolute;top:218px;left:85px;white-space:nowrap" class="ft4714">S-GOLD3</p>
<p style="position:absolute;top:218px;left:164px;white-space:nowrap" class="ft4717">TM</p>
<p style="position:absolute;top:218px;left:180px;white-space:nowrap" class="ft4714">)&#160;platform.&#160;The&#160;following&#160;three&#160;components&#160;were&#160;used&#160;as&#160;a&#160;starting&#160;point:</p>
<p style="position:absolute;top:275px;left:112px;white-space:nowrap" class="ft4734">●</p>
<p style="position:absolute;top:265px;left:139px;white-space:nowrap" class="ft4714">The&#160;L4Linux&#160;port&#160;on&#160;X-GOLD</p>
<p style="position:absolute;top:265px;left:395px;white-space:nowrap" class="ft4717">TM&#160;&#160;</p>
<p style="position:absolute;top:265px;left:417px;white-space:nowrap" class="ft4714">208&#160;done&#160;by&#160;Technische&#160;Universität&#160;Dresden&#160;</p>
<p style="position:absolute;top:284px;left:139px;white-space:nowrap" class="ft4714">within&#160;the&#160;OpenTC&#160;project;</p>
<p style="position:absolute;top:313px;left:112px;white-space:nowrap" class="ft4734">●</p>
<p style="position:absolute;top:304px;left:139px;white-space:nowrap" class="ft4715">The&#160;GNU&#160;cross-compile&#160;tool&#160;chain&#160;configured&#160;for&#160;ARM&#160;cores&#160;(GCC&#160;4.1.2,&#160;bin-<br/>tools&#160;2.17);</p>
<p style="position:absolute;top:351px;left:112px;white-space:nowrap" class="ft4734">●</p>
<p style="position:absolute;top:342px;left:139px;white-space:nowrap" class="ft4714">The&#160;Linux&#160;TPM&#160;Emulator&#160;developed&#160;by&#160;Mario&#160;Strasser&#160;[61],&#160;ETH&#160;Zürich.</p>
<p style="position:absolute;top:380px;left:85px;white-space:nowrap" class="ft4715">In&#160;order&#160;to&#160;be&#160;able&#160;to&#160;test&#160;the&#160;target&#160;application&#160;using&#160;existing&#160;open-source&#160;TPM&#160;tools&#160;<br/>the&#160;following&#160;software&#160;packages&#160;were&#160;deployed:</p>
<p style="position:absolute;top:456px;left:112px;white-space:nowrap" class="ft4734">●</p>
<p style="position:absolute;top:447px;left:139px;white-space:nowrap" class="ft4714">The&#160;TSS&#160;TrouSerS&#160;&#160;Software&#160;Stack&#160;[13,67],&#160;developed&#160;by&#160;IBM;</p>
<p style="position:absolute;top:476px;left:112px;white-space:nowrap" class="ft4734">●</p>
<p style="position:absolute;top:466px;left:139px;white-space:nowrap" class="ft4714">The&#160;TPM&#160;toolset&#160;on&#160;top&#160;of&#160;TrouSerS,&#160;developed&#160;by&#160;IBM;</p>
<p style="position:absolute;top:495px;left:112px;white-space:nowrap" class="ft4734">●</p>
<p style="position:absolute;top:485px;left:139px;white-space:nowrap" class="ft4715">The&#160;TPM&#160;Manager&#160;[14],&#160;an&#160;open&#160;source&#160;GUI&#160;to&#160;configure&#160;TPMs,&#160;developed&#160;by&#160;<br/>Ruhr-Universität&#160;Bochum&#160;and&#160;Sirrix&#160;AG&#160;within&#160;the&#160;EMSCB&#160;project.</p>
<p style="position:absolute;top:543px;left:85px;white-space:nowrap" class="ft4715">Furthermore,&#160;the&#160;L4&#160;build&#160;environment&#160;from&#160;TU&#160;Dresden&#160;was&#160;deployed&#160;to&#160;generate&#160;<br/>code&#160;&#160;&#160;images&#160;&#160;&#160;executable&#160;&#160;&#160;on&#160;&#160;&#160;the&#160;&#160;&#160;X-GOLD</p>
<p style="position:absolute;top:562px;left:478px;white-space:nowrap" class="ft4717">TM</p>
<p style="position:absolute;top:562px;left:494px;white-space:nowrap" class="ft4714">-208&#160;&#160;&#160;based&#160;&#160;&#160;platform.&#160;&#160;&#160;The&#160;&#160;&#160;entire&#160;</p>
<p style="position:absolute;top:581px;left:85px;white-space:nowrap" class="ft4714">development&#160;environment&#160;is&#160;depicted&#160;in&#160;Figur<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#47">e&#160;14.</a></p>
<p style="position:absolute;top:1103px;left:170px;white-space:nowrap" class="ft473"><b>Figure&#160;14:&#160;Development&#160;environment&#160;for&#160;TPM&#160;emulator&#160;on&#160;target</b></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft477">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft477">47/109</p>
</div>
<!-- Page 48 -->
<a name="48"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4838{font-size:9px;font-family:DAAAAA+DejaVuSerif;color:#000000;}
	.ft4839{font-size:10px;font-family:HAAAAA+Arial;color:#000000;}
-->
</style>
<div id="page48-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application048.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft4812">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft480">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft484">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft484">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft486"><b>2.7.1&#160;Porting&#160;Concepts</b></p>
<p style="position:absolute;top:178px;left:85px;white-space:nowrap" class="ft4815">The&#160;basic&#160;target&#160;architecture&#160;for&#160;the&#160;TPM&#160;emulator&#160;running&#160;on&#160;the&#160;L4&#160;platform&#160;is&#160;<br/>depicted&#160;in&#160;Figur<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#48">e&#160;15.</a></p>
<p style="position:absolute;top:687px;left:123px;white-space:nowrap" class="ft483"><b>Figure&#160;15:&#160;Basic&#160;target&#160;architecture&#160;for&#160;TPM&#160;</b></p>
<p style="position:absolute;top:705px;left:186px;white-space:nowrap" class="ft483"><b>emulator&#160;on&#160;L4/X-GOLD</b></p>
<p style="position:absolute;top:705px;left:388px;white-space:nowrap" class="ft4838"><b>TM&#160;</b></p>
<p style="position:absolute;top:705px;left:407px;white-space:nowrap" class="ft483"><b>208</b></p>
<p style="position:absolute;top:325px;left:543px;white-space:nowrap" class="ft4814">L4&#160;Application&#160;Layer</p>
<p style="position:absolute;top:383px;left:543px;white-space:nowrap" class="ft4815">L4&#160;&#160;&#160;Server&#160;&#160;&#160;+&#160;&#160;&#160;Application&#160;<br/>Library&#160;Layer&#160;</p>
<p style="position:absolute;top:440px;left:543px;white-space:nowrap" class="ft4815">-&#160;&#160;&#160;Management&#160;&#160;&#160;of&#160;&#160;&#160;physical&#160;<br/>memory<br/>-&#160;Loading&#160;L4&#160;Applications<br/>-&#160;Console&#160;I/O&#160;<br/>-&#160;Semaphores&#160;<br/>-&#160;...</p>
<p style="position:absolute;top:575px;left:543px;white-space:nowrap" class="ft4814">The&#160;L4&#160;Microkernel</p>
<p style="position:absolute;top:651px;left:543px;white-space:nowrap" class="ft4814">The&#160;Hardware&#160;Platform</p>
<p style="position:absolute;top:752px;left:85px;white-space:nowrap" class="ft4815">As&#160;can&#160;be&#160;seen&#160;in&#160;the&#160;diagram,&#160;the&#160;TPM&#160;emulator&#160;is&#160;configured&#160;as&#160;a&#160;dedicated&#160;L4&#160;<br/>application&#160;which&#160;runs&#160;independently&#160;of&#160;Linux.&#160;The&#160;benefit&#160;of&#160;this&#160;architecture&#160;can&#160;be&#160;<br/>seen&#160;in&#160;the&#160;fact&#160;that&#160;it&#160;provides&#160;a&#160;fair&#160;amount&#160;of&#160;isolation&#160;which&#160;is&#160;important&#160;when&#160;<br/>considering&#160;various&#160;types&#160;of&#160;software&#160;attacks.</p>
<p style="position:absolute;top:857px;left:85px;white-space:nowrap" class="ft4815">Since&#160;the&#160;TPM&#160;emulator&#160;was&#160;actually&#160;developed&#160;as&#160;a&#160;Linux&#160;kernel&#160;module,&#160;see&#160;ref.<br/>[61],&#160;and&#160;given&#160;the&#160;limited&#160;scope&#160;of&#160;this&#160;demonstrator,&#160;it&#160;would&#160;also&#160;have&#160;been&#160;an&#160;<br/>option&#160;to&#160;deploy&#160;a&#160;dedicated&#160;Linux&#160;compartment&#160;instead.&#160;But&#160;the&#160;practical&#160;drawback&#160;<br/>of&#160;that&#160;approach&#160;is&#160;clearly&#160;given&#160;by&#160;the&#160;fact&#160;that&#160;it&#160;requires&#160;to&#160;include&#160;the&#160;entire&#160;<br/>Linux&#160;kernel&#160;into&#160;the&#160;target&#160;application&#160;software&#160;build.&#160;Given&#160;the&#160;complex&#160;and&#160;time-<br/>consuming&#160;software&#160;build&#160;procedure&#160;and&#160;taking&#160;into&#160;account&#160;the&#160;time&#160;to&#160;load&#160;a&#160;large&#160;<br/>software&#160;&#160;&#160;image&#160;&#160;&#160;via&#160;&#160;&#160;the&#160;&#160;&#160;Debugger&#160;&#160;&#160;onto&#160;&#160;&#160;the&#160;&#160;&#160;target,&#160;&#160;&#160;this&#160;&#160;&#160;procedure&#160;&#160;&#160;would&#160;&#160;&#160;have&#160;<br/>significantly&#160;slowed&#160;down&#160;the&#160;development&#160;and&#160;test&#160;phase&#160;of&#160;the&#160;TPM&#160;emulator.</p>
<p style="position:absolute;top:1038px;left:85px;white-space:nowrap" class="ft4815">On&#160;&#160;&#160;the&#160;&#160;&#160;contrary,&#160;&#160;&#160;the&#160;&#160;&#160;chosen&#160;&#160;&#160;concept&#160;&#160;&#160;to&#160;&#160;&#160;restrict&#160;&#160;&#160;the&#160;&#160;&#160;TPM&#160;&#160;&#160;emulator&#160;&#160;&#160;to&#160;&#160;&#160;services&#160;<br/>available&#160;in&#160;the&#160;L4env&#160;environment&#160;enables&#160;to&#160;omit&#160;L4Linux&#160;from&#160;the&#160;software&#160;build&#160;<br/>and&#160;thus,&#160;keep&#160;the&#160;target&#160;software&#160;image&#160;footprint&#160;low.&#160;This&#160;benefit&#160;has&#160;to&#160;be&#160;paid&#160;<br/>with&#160;slightly&#160;increased&#160;software&#160;porting&#160;effort.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft487">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft487">48/109</p>
<p style="position:absolute;top:268px;left:126px;white-space:nowrap" class="ft4839"><b>cmp&#160;Basic&#160;Architecture</b></p>
<p style="position:absolute;top:540px;left:369px;white-space:nowrap" class="ft4839"><b>L4&#160;Kernel</b></p>
<p style="position:absolute;top:383px;left:327px;white-space:nowrap" class="ft4839"><b>L4env&#160;Servers</b></p>
<p style="position:absolute;top:292px;left:267px;white-space:nowrap" class="ft4839"><b>L4Linu&#160;x</b></p>
<p style="position:absolute;top:331px;left:167px;white-space:nowrap" class="ft4839"><b>TPM&#160;emulator</b></p>
<p style="position:absolute;top:639px;left:384px;white-space:nowrap" class="ft4839"><b>X-GOLD208</b></p>
<p style="position:absolute;top:481px;left:432px;white-space:nowrap" class="ft4839"><b>Loade&#160;r</b></p>
<p style="position:absolute;top:427px;left:347px;white-space:nowrap" class="ft4839"><b>DMPhys</b></p>
<p style="position:absolute;top:427px;left:431px;white-space:nowrap" class="ft4839"><b>Name&#160;s</b></p>
<p style="position:absolute;top:481px;left:355px;white-space:nowrap" class="ft4839"><b>Ex&#160;ec</b></p>
<p style="position:absolute;top:400px;left:143px;white-space:nowrap" class="ft4839"><b>L4&#160;Application&#160;Libraries</b></p>
<p style="position:absolute;top:447px;left:159px;white-space:nowrap" class="ft4839"><b>Thread</b></p>
<p style="position:absolute;top:449px;left:236px;white-space:nowrap" class="ft4839"><b>l4rm</b></p>
</div>
<!-- Page 49 -->
<a name="49"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page49-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application049.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft4912">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft490">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft494">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft494">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft4921"><b>Assumptions&#160;and&#160;development&#160;constraints</b></p>
<p style="position:absolute;top:190px;left:85px;white-space:nowrap" class="ft4915">In&#160;this&#160;section&#160;we&#160;will&#160;briefly&#160;address&#160;the&#160;development&#160;constraints,&#160;mainly&#160;given&#160;by&#160;<br/>the&#160;limited&#160;scope&#160;of&#160;the&#160;demonstrator:</p>
<p style="position:absolute;top:266px;left:112px;white-space:nowrap" class="ft4934">●</p>
<p style="position:absolute;top:256px;left:139px;white-space:nowrap" class="ft4915">Only&#160;minimalistic&#160;support&#160;of&#160;TPM&#160;commands&#160;required&#160;for&#160;the&#160;secure&#160;wallet&#160;<br/>demonstrator</p>
<p style="position:absolute;top:314px;left:107px;white-space:nowrap" class="ft4915">It&#160;&#160;&#160;is&#160;&#160;&#160;not&#160;&#160;&#160;required&#160;&#160;&#160;to&#160;&#160;&#160;support&#160;&#160;&#160;the&#160;&#160;&#160;full&#160;&#160;&#160;scope&#160;&#160;&#160;of&#160;&#160;&#160;TPM&#160;&#160;&#160;commands&#160;&#160;&#160;in&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;<br/>demonstrate&#160;the&#160;use&#160;of&#160;an&#160;embedded&#160;TPM&#160;emulator&#160;for&#160;a&#160;specific&#160;secure&#160;wallet&#160;use&#160;<br/>case.&#160;Instead&#160;only&#160;a&#160;subset&#160;of&#160;commands&#160;is&#160;required.&#160;Within&#160;the&#160;WP08&#160;work&#160;group&#160;<br/>it&#160;was&#160;suggested&#160;that&#160;a&#160;TPM&#160;sealing&#160;procedure&#160;could&#160;be&#160;a&#160;good&#160;example.&#160;On&#160;the&#160;<br/>other&#160;hand,&#160;also&#160;a&#160;sealing&#160;procedure&#160;requires&#160;the&#160;TPM&#160;to&#160;be&#160;in&#160;a&#160;certain&#160;state,&#160;e.g.&#160;<br/>a&#160;&#160;&#160;storage&#160;&#160;&#160;root&#160;&#160;&#160;key&#160;&#160;&#160;needs&#160;&#160;&#160;to&#160;&#160;&#160;be&#160;&#160;&#160;present&#160;&#160;&#160;and&#160;&#160;&#160;ownership&#160;&#160;&#160;credentials&#160;&#160;&#160;need&#160;&#160;&#160;to&#160;&#160;&#160;be&#160;<br/>known.&#160;&#160;&#160;Also&#160;&#160;&#160;the&#160;&#160;&#160;platform&#160;&#160;&#160;configuration&#160;&#160;&#160;registers&#160;&#160;&#160;need&#160;&#160;&#160;to&#160;&#160;&#160;contain&#160;&#160;&#160;a&#160;&#160;&#160;reasonable&#160;<br/>value&#160;in&#160;order&#160;to&#160;resemble&#160;a&#160;realistic&#160;scenario.</p>
<p style="position:absolute;top:505px;left:112px;white-space:nowrap" class="ft4934">●</p>
<p style="position:absolute;top:496px;left:139px;white-space:nowrap" class="ft4915">No&#160;support&#160;of&#160;secure&#160;or&#160;authenticated&#160;boot&#160;for&#160;the&#160;software&#160;running&#160;on&#160;the&#160;<br/>target</p>
<p style="position:absolute;top:553px;left:139px;white-space:nowrap" class="ft4915">We&#160;saw&#160;virtually&#160;no&#160;benefit&#160;in&#160;implementing&#160;a&#160;procedure&#160;measuring&#160;the&#160;L4&#160;<br/>software&#160;image,&#160;since&#160;the&#160;mechanism&#160;as&#160;such&#160;is&#160;already&#160;known&#160;and&#160;deployed&#160;<br/>in&#160;&#160;&#160;mobile&#160;&#160;&#160;phones&#160;&#160;&#160;(OMTP&#160;&#160;&#160;TR0&#160;&#160;&#160;[49]).&#160;&#160;&#160;Also,&#160;&#160;&#160;it&#160;&#160;&#160;needs&#160;&#160;&#160;to&#160;&#160;&#160;be&#160;&#160;&#160;taken&#160;&#160;&#160;into&#160;<br/>consideration,&#160;that&#160;the&#160;target&#160;software&#160;build&#160;basically&#160;contains&#160;the&#160;L4/L4env&#160;<br/>and&#160;the&#160;TPM&#160;emulator&#160;application.&#160;On&#160;the&#160;other&#160;hand,&#160;the&#160;PC&#160;containing&#160;the&#160;<br/>software&#160;&#160;&#160;wallet&#160;&#160;&#160;application&#160;&#160;&#160;runs&#160;&#160;&#160;on&#160;&#160;&#160;a&#160;&#160;&#160;different&#160;&#160;&#160;architecture&#160;&#160;&#160;and&#160;&#160;&#160;includes&#160;<br/>different&#160;&#160;&#160;software&#160;&#160;&#160;images.&#160;&#160;&#160;So&#160;&#160;&#160;the&#160;&#160;&#160;measurement&#160;&#160;&#160;results&#160;&#160;&#160;on&#160;&#160;&#160;these&#160;&#160;&#160;platforms&#160;<br/>would&#160;be&#160;different&#160;which&#160;prevents&#160;a&#160;simple&#160;re-use.&#160;Furthermore,&#160;right&#160;after&#160;<br/>booting&#160;the&#160;target,&#160;the&#160;TPM&#160;emulator&#160;with&#160;its&#160;measuring&#160;capabilities&#160;does&#160;not&#160;<br/>even&#160;exist,&#160;so&#160;it&#160;would&#160;need&#160;to&#160;be&#160;preceded&#160;by&#160;other&#160;mechanisms.&#160;The&#160;results&#160;<br/>of&#160;these&#160;measurements&#160;would&#160;then&#160;need&#160;to&#160;be&#160;passed&#160;to&#160;the&#160;TPM&#160;emulator&#160;<br/>once&#160;it&#160;is&#160;started&#160;in&#160;its&#160;L4&#160;domain.&#160;</p>
<p style="position:absolute;top:831px;left:112px;white-space:nowrap" class="ft4934">●</p>
<p style="position:absolute;top:822px;left:139px;white-space:nowrap" class="ft4914">No&#160;software&#160;driver&#160;available&#160;for&#160;on-board&#160;storage&#160;of&#160;non-volatile&#160;data</p>
<p style="position:absolute;top:860px;left:107px;white-space:nowrap" class="ft4915">Whereas&#160;the&#160;memory&#160;extension&#160;module&#160;of&#160;the&#160;evaluation&#160;board&#160;features&#160;a&#160;non-&#160;<br/>volatile&#160;&#160;&#160;NOR&#160;&#160;&#160;flash&#160;&#160;&#160;device,&#160;&#160;&#160;it&#160;&#160;&#160;was&#160;&#160;not&#160;&#160;&#160;considered&#160;&#160;realistic&#160;&#160;&#160;to&#160;&#160;develop&#160;&#160;&#160;a&#160;&#160;&#160;suitable&#160;<br/>driver&#160;&#160;&#160;within&#160;&#160;&#160;the&#160;&#160;&#160;L4&#160;&#160;&#160;environment.&#160;&#160;&#160;Flash&#160;&#160;&#160;drivers&#160;&#160;&#160;usually&#160;&#160;&#160;turn&#160;&#160;&#160;out&#160;&#160;&#160;to&#160;&#160;&#160;be&#160;&#160;&#160;rather&#160;<br/>complex&#160;software&#160;components,&#160;taking&#160;into&#160;consideration&#160;the&#160;various&#160;requirements&#160;<br/>which&#160;need&#160;to&#160;be&#160;addressed:&#160;management&#160;of&#160;power-failure,&#160;wear&#160;levelling&#160;of&#160;erase&#160;<br/>units&#160;and&#160;so&#160;forth.&#160;It&#160;would&#160;also&#160;have&#160;been&#160;possible&#160;to&#160;provide&#160;a&#160;NOR&#160;flash&#160;driver&#160;<br/>in&#160;the&#160;L4Linux&#160;environment,&#160;and&#160;provide&#160;a&#160;basic&#160;file&#160;store/retrieve&#160;API&#160;towards&#160;the&#160;<br/>TPM&#160;emulator&#160;via&#160;L4.&#160;This&#160;would&#160;generally&#160;be&#160;a&#160;recommendable&#160;solution,&#160;as&#160;it&#160;<br/>avoids&#160;the&#160;problems&#160;arising&#160;from&#160;sharing&#160;peripheral&#160;ownership&#160;between&#160;different&#160;<br/>execution&#160;&#160;&#160;domains&#160;&#160;&#160;(L4Linux,&#160;&#160;&#160;TPM&#160;&#160;&#160;emulator).&#160;&#160;&#160;But,&#160;&#160;&#160;in&#160;&#160;&#160;addition&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;<br/>implementation&#160;&#160;effort,&#160;&#160;a&#160;&#160;drawback&#160;&#160;of&#160;&#160;this&#160;approach&#160;&#160;is&#160;&#160;given&#160;&#160;&#160;by&#160;&#160;the&#160;&#160;fact&#160;&#160;that&#160;&#160;it&#160;<br/>requires&#160;the&#160;inclusion&#160;of&#160;L4Linux&#160;into&#160;the&#160;target&#160;software&#160;build,&#160;which&#160;we&#160;wanted&#160;<br/>to&#160;avoid,&#160;see&#160;previous&#160;section.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft497">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft497">49/109</p>
</div>
<!-- Page 50 -->
<a name="50"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page50-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application050.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft5012">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft500">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft504">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft504">Final</p>
<p style="position:absolute;top:160px;left:112px;white-space:nowrap" class="ft5034">●</p>
<p style="position:absolute;top:151px;left:139px;white-space:nowrap" class="ft5014">Only&#160;serial&#160;interface&#160;available&#160;for&#160;communication&#160;with&#160;external&#160;host</p>
<p style="position:absolute;top:189px;left:107px;white-space:nowrap" class="ft5015">This&#160;&#160;&#160;is&#160;&#160;&#160;not&#160;&#160;&#160;a&#160;&#160;&#160;major&#160;&#160;&#160;obstacle,&#160;&#160;&#160;since&#160;&#160;&#160;a&#160;&#160;&#160;TPM&#160;&#160;&#160;does&#160;&#160;&#160;not&#160;&#160;&#160;have&#160;&#160;&#160;to&#160;&#160;&#160;deal&#160;&#160;&#160;with&#160;&#160;&#160;large&#160;<br/>messages.&#160;The&#160;evaluation&#160;board&#160;also&#160;features&#160;connectors&#160;with&#160;higher&#160;bandwidths&#160;<br/>such&#160;as&#160;USB&#160;or&#160;MMC,&#160;but&#160;we&#160;saw&#160;little&#160;value&#160;in&#160;developing&#160;driver&#160;functionality&#160;for&#160;<br/>these&#160;devices.&#160;For&#160;that&#160;reason&#160;we&#160;stayed&#160;with&#160;using&#160;the&#160;serial&#160;interface&#160;(115&#160;kbit/s)&#160;<br/>which&#160;is&#160;already&#160;used&#160;for&#160;the&#160;L4&#160;console&#160;I/O&#160;and&#160;the&#160;L4&#160;kernel&#160;debugger.</p>
<p style="position:absolute;top:323px;left:112px;white-space:nowrap" class="ft5034">●</p>
<p style="position:absolute;top:314px;left:139px;white-space:nowrap" class="ft5014">No&#160;usage&#160;of&#160;GNU&#160;multi-precision&#160;library&#160;(GMP)</p>
<p style="position:absolute;top:352px;left:107px;white-space:nowrap" class="ft5015">The&#160;standard&#160;Linux&#160;TPM&#160;emulator&#160;makes&#160;use&#160;of&#160;the&#160;GNU&#160;multi-precision&#160;library&#160;in&#160;<br/>order&#160;to&#160;perform&#160;big&#160;integer&#160;arithmetic.&#160;For&#160;two&#160;reasons&#160;we&#160;decided&#160;to&#160;not&#160;use&#160;this&#160;<br/>library&#160;for&#160;the&#160;emulator&#160;running&#160;on&#160;L4.&#160;First,&#160;the&#160;library&#160;is&#160;rather&#160;large&#160;and&#160;has&#160;<br/>further&#160;dependencies&#160;to&#160;other&#160;system&#160;libraries.&#160;In&#160;a&#160;realistic&#160;deployment&#160;scenario,&#160;<br/>the&#160;TPM&#160;emulator&#160;software&#160;footprint&#160;should&#160;be&#160;kept&#160;as&#160;small&#160;as&#160;possible&#160;in&#160;order&#160;<br/>to&#160;reduce&#160;weaknesses&#160;arising&#160;from&#160;complexity.&#160;Second,&#160;the&#160;X-GOLD</p>
<p style="position:absolute;top:448px;left:687px;white-space:nowrap" class="ft5017">TM&#160;&#160;</p>
<p style="position:absolute;top:448px;left:708px;white-space:nowrap" class="ft5014">208&#160;already&#160;</p>
<p style="position:absolute;top:467px;left:107px;white-space:nowrap" class="ft5015">features&#160;hardware&#160;acceleration&#160;for&#160;big&#160;integer&#160;exponentiation&#160;which&#160;enables&#160;the&#160;<br/>deployment&#160;of&#160;a&#160;suitable&#160;driver&#160;with&#160;a&#160;rather&#160;small&#160;memory&#160;footprint.</p>
<p style="position:absolute;top:533px;left:85px;white-space:nowrap" class="ft503"><b>2.7.2&#160;Implementation&#160;strategy</b></p>
<p style="position:absolute;top:559px;left:85px;white-space:nowrap" class="ft5015">After&#160;analysing&#160;the&#160;Linux&#160;TPM&#160;emulator&#160;code&#160;structure&#160;and&#160;taking&#160;into&#160;account&#160;the&#160;<br/>restrictions&#160;listed&#160;in&#160;the&#160;previous&#160;section,&#160;the&#160;following&#160;decisions&#160;were&#160;taken:</p>
<p style="position:absolute;top:635px;left:112px;white-space:nowrap" class="ft5034">●</p>
<p style="position:absolute;top:626px;left:139px;white-space:nowrap" class="ft5015">Replacing&#160;the&#160;software&#160;cryptographic&#160;functions&#160;of&#160;the&#160;Linux&#160;emulator&#160;with&#160;a&#160;<br/>driver&#160;using&#160;the&#160;X-GOLD</p>
<p style="position:absolute;top:645px;left:347px;white-space:nowrap" class="ft5017">TM&#160;</p>
<p style="position:absolute;top:645px;left:366px;white-space:nowrap" class="ft5014">208&#160;cryptographic&#160;hardware&#160;facilities.&#160;</p>
<p style="position:absolute;top:684px;left:139px;white-space:nowrap" class="ft5015">In&#160;&#160;&#160;particular&#160;&#160;&#160;this&#160;&#160;&#160;concerns&#160;&#160;&#160;almost&#160;&#160;&#160;all&#160;&#160;&#160;functions&#160;&#160;&#160;contained&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;&#160;&#160;/crypto&#160;<br/>directory&#160;of&#160;the&#160;Linux&#160;emulator.</p>
<p style="position:absolute;top:731px;left:139px;white-space:nowrap" class="ft5034">○</p>
<p style="position:absolute;top:722px;left:166px;white-space:nowrap" class="ft5014">Public&#160;RSA&#160;key&#160;exponentiation</p>
<p style="position:absolute;top:750px;left:139px;white-space:nowrap" class="ft5034">○</p>
<p style="position:absolute;top:741px;left:166px;white-space:nowrap" class="ft5014">Private&#160;RSA&#160;key&#160;exponentiation</p>
<p style="position:absolute;top:770px;left:139px;white-space:nowrap" class="ft5034">○</p>
<p style="position:absolute;top:760px;left:166px;white-space:nowrap" class="ft5014">Hashing&#160;according&#160;to&#160;SHA-1</p>
<p style="position:absolute;top:789px;left:139px;white-space:nowrap" class="ft5034">○</p>
<p style="position:absolute;top:780px;left:166px;white-space:nowrap" class="ft5014">Generation&#160;of&#160;RSA&#160;key&#160;pairs</p>
<p style="position:absolute;top:818px;left:107px;white-space:nowrap" class="ft5015">Whereas&#160;&#160;&#160;in&#160;&#160;&#160;a&#160;&#160;&#160;realistic&#160;&#160;&#160;scenario&#160;&#160;&#160;the&#160;&#160;&#160;driver&#160;&#160;&#160;would&#160;&#160;&#160;be&#160;&#160;&#160;implemented&#160;&#160;&#160;in&#160;&#160;&#160;an&#160;&#160;&#160;event-&#160;<br/>driven&#160;&#160;&#160;state,&#160;&#160;&#160;e.g.&#160;&#160;&#160;triggered&#160;&#160;&#160;by&#160;&#160;&#160;interrupts&#160;&#160;&#160;signalling&#160;&#160;&#160;the&#160;&#160;&#160;completion&#160;&#160;&#160;of&#160;&#160;&#160;certain&#160;<br/>hardware&#160;procedures,&#160;it&#160;was&#160;decided&#160;to&#160;go&#160;for&#160;a&#160;simpler&#160;solution,&#160;where&#160;the&#160;driver&#160;<br/>basically&#160;polls&#160;status&#160;registers.&#160;The&#160;benefit&#160;of&#160;this&#160;approach&#160;is&#160;that&#160;it&#160;has&#160;no&#160;impact&#160;<br/>on&#160;the&#160;L4&#160;microkernel,&#160;since&#160;no&#160;interrupt&#160;routines&#160;need&#160;to&#160;be&#160;registered.&#160;The&#160;only&#160;<br/>required&#160;step&#160;for&#160;the&#160;L4&#160;task&#160;running&#160;the&#160;TPM&#160;emulator&#160;is&#160;to&#160;map&#160;the&#160;associated&#160;<br/>peripheral&#160;&#160;&#160;address&#160;&#160;&#160;range&#160;&#160;&#160;into&#160;&#160;&#160;its&#160;&#160;&#160;own&#160;&#160;&#160;memory&#160;&#160;&#160;space&#160;&#160;&#160;and&#160;&#160;&#160;request&#160;&#160;&#160;it&#160;&#160;&#160;to&#160;&#160;&#160;be&#160;<br/>configured&#160;as&#160;non-cacheable.<br/>In&#160;&#160;&#160;a&#160;&#160;&#160;later&#160;&#160;&#160;step&#160;&#160;&#160;the&#160;&#160;&#160;microkernel&#160;&#160;&#160;and&#160;&#160;&#160;the&#160;&#160;&#160;driver&#160;&#160;&#160;may&#160;&#160;&#160;be&#160;&#160;&#160;updated&#160;&#160;&#160;to&#160;&#160;&#160;support&#160;&#160;&#160;an&#160;<br/>interrupt-driven&#160;behavior.</p>
<p style="position:absolute;top:1056px;left:112px;white-space:nowrap" class="ft5034">●</p>
<p style="position:absolute;top:1047px;left:139px;white-space:nowrap" class="ft5015">Design&#160;the&#160;TPM&#160;emulator&#160;as&#160;a&#160;dedicated&#160;L4&#160;task&#160;communicating&#160;via&#160;a&#160;serial&#160;<br/>connection&#160;with&#160;the&#160;external&#160;PC&#160;running&#160;the&#160;secure&#160;wallet&#160;demonstrator</p>
<p style="position:absolute;top:1105px;left:107px;white-space:nowrap" class="ft5014">In&#160;Figure<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#51">&#160;16&#160;</a>a&#160;component&#160;diagram&#160;of&#160;the&#160;Linux&#160;TPM&#160;emulator&#160;is&#160;presented.&#160;In&#160;the&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft507">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft507">50/109</p>
</div>
<!-- Page 51 -->
<a name="51"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page51-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application051.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft5112">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft510">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft514">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft514">Final</p>
<p style="position:absolute;top:151px;left:107px;white-space:nowrap" class="ft5115">Linux&#160;user&#160;space&#160;a&#160;possible&#160;use&#160;case&#160;scenario&#160;based&#160;on&#160;the&#160;IBM&#160;TrouSerS&#160;TPM&#160;<br/>software&#160;stack&#160;is&#160;included.</p>
<p style="position:absolute;top:756px;left:260px;white-space:nowrap" class="ft513"><b>Figure&#160;16:&#160;Linux&#160;TPM&#160;emulator&#160;architecture</b></p>
<p style="position:absolute;top:793px;left:107px;white-space:nowrap" class="ft5115">In&#160;&#160;&#160;the&#160;&#160;&#160;Linux&#160;&#160;&#160;world&#160;&#160;&#160;the&#160;&#160;&#160;TPM&#160;&#160;&#160;emulator&#160;&#160;&#160;is&#160;&#160;&#160;designed&#160;&#160;&#160;as&#160;&#160;&#160;a&#160;&#160;&#160;kernel&#160;&#160;&#160;module&#160;&#160;&#160;which&#160;<br/>basically&#160;behaves&#160;as&#160;a&#160;daemon&#160;being&#160;triggered&#160;by&#160;TPM&#160;commands&#160;received&#160;via&#160;the&#160;<br/>/dev/tpm&#160;interface.</p>
<p style="position:absolute;top:879px;left:107px;white-space:nowrap" class="ft5115">Whereas&#160;the&#160;Linux&#160;kernel&#160;provides&#160;a&#160;substantially&#160;richer&#160;set&#160;of&#160;services&#160;compared&#160;<br/>to&#160;the&#160;L4/L4env&#160;scenario,&#160;fortunately&#160;the&#160;TPM&#160;emulator&#160;core&#160;itself&#160;has&#160;only&#160;very&#160;<br/>few&#160;platform&#160;dependencies.&#160;For&#160;this&#160;reason&#160;the&#160;layer&#160;containing&#160;the&#160;Linux&#160;kernel&#160;<br/>dependent&#160;parts&#160;could&#160;be&#160;easily&#160;stripped&#160;off,&#160;so&#160;that&#160;the&#160;emulator&#160;in&#160;L4&#160;becomes&#160;a&#160;<br/>simple&#160;task&#160;which&#160;is&#160;launched&#160;immediately&#160;after&#160;starting&#160;the&#160;target.&#160;Afterwards&#160;the&#160;<br/>emulator&#160;behaves&#160;like&#160;a&#160;server&#160;which&#160;waits&#160;for&#160;commands&#160;from&#160;the&#160;remote&#160;host.</p>
<p style="position:absolute;top:1032px;left:112px;white-space:nowrap" class="ft5134">●</p>
<p style="position:absolute;top:1022px;left:139px;white-space:nowrap" class="ft5115">Deploy&#160;&#160;&#160;dedicated&#160;&#160;&#160;serial&#160;&#160;&#160;interface&#160;&#160;&#160;for&#160;&#160;&#160;exchanging&#160;&#160;&#160;TPM&#160;&#160;&#160;commands&#160;&#160;&#160;and&#160;&#160;&#160;TPM&#160;<br/>emulator&#160;control&#160;data&#160;between&#160;target&#160;and&#160;host</p>
<p style="position:absolute;top:1080px;left:139px;white-space:nowrap" class="ft5115">The&#160;&#160;&#160;L4&#160;&#160;&#160;already&#160;&#160;&#160;uses&#160;&#160;&#160;one&#160;&#160;&#160;Universal&#160;&#160;&#160;Serial&#160;&#160;&#160;Interface&#160;&#160;&#160;(USIF)&#160;&#160;&#160;peripheral&#160;&#160;&#160;for&#160;<br/>general&#160;&#160;&#160;console&#160;&#160;&#160;I/O&#160;&#160;&#160;and&#160;&#160;&#160;kernel&#160;&#160;&#160;debugging&#160;&#160;&#160;purposes.&#160;&#160;&#160;In&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;&#160;&#160;keep&#160;&#160;&#160;this&#160;<br/>functionality&#160;independent&#160;from&#160;the&#160;TPM&#160;command/response&#160;exchange,&#160;it&#160;was&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft517">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft517">51/109</p>
<p style="position:absolute;top:203px;left:162px;white-space:nowrap" class="ft5139"><b>cmp&#160;TPM&#160;emulator&#160;on&#160;Linux</b></p>
<p style="position:absolute;top:632px;left:579px;white-space:nowrap" class="ft5139"><b>TPM&#160;Crypto&#160;Services</b></p>
<p style="position:absolute;top:630px;left:306px;white-space:nowrap" class="ft5139"><b>TPM&#160;Emulator&#160;Execution&#160;Engine</b></p>
<p style="position:absolute;top:541px;left:314px;white-space:nowrap" class="ft5139"><b>TPM&#160;Command&#160;</b></p>
<p style="position:absolute;top:554px;left:304px;white-space:nowrap" class="ft5139"><b>Marshalling&#160;Engine</b></p>
<p style="position:absolute;top:709px;left:437px;white-space:nowrap" class="ft5139"><b>GNU&#160;Multiprecision&#160;Library</b></p>
<p style="position:absolute;top:544px;left:638px;white-space:nowrap" class="ft5139"><b>TPM&#160;NVM&#160;</b></p>
<p style="position:absolute;top:557px;left:641px;white-space:nowrap" class="ft5139"><b>Manage&#160;r</b></p>
<p style="position:absolute;top:400px;left:475px;white-space:nowrap" class="ft5139"><b>/dev/tpm</b></p>
<p style="position:absolute;top:427px;left:197px;white-space:nowrap" class="ft5139"><b>Linux&#160;&#160;</b></p>
<p style="position:absolute;top:439px;left:194px;white-space:nowrap" class="ft5139"><b>Kernel&#160;</b></p>
<p style="position:absolute;top:452px;left:192px;white-space:nowrap" class="ft5139"><b>services&#160;</b></p>
<p style="position:absolute;top:465px;left:188px;white-space:nowrap" class="ft5139"><b>(random,&#160;</b></p>
<p style="position:absolute;top:478px;left:182px;white-space:nowrap" class="ft5139"><b>log,&#160;debug,&#160;&#160;</b></p>
<p style="position:absolute;top:490px;left:183px;white-space:nowrap" class="ft5139"><b>file&#160;access,&#160;</b></p>
<p style="position:absolute;top:503px;left:192px;white-space:nowrap" class="ft5139"><b>sockets,&#160;</b></p>
<p style="position:absolute;top:516px;left:192px;white-space:nowrap" class="ft5139"><b>signals,&#160;</b></p>
<p style="position:absolute;top:528px;left:191px;white-space:nowrap" class="ft5139"><b>time,&#160;...,)</b></p>
<p style="position:absolute;top:323px;left:407px;white-space:nowrap" class="ft5139"><b>TPM&#160;software&#160;stack&#160;e.g.&#160;TrouSerS</b></p>
<p style="position:absolute;top:243px;left:196px;white-space:nowrap" class="ft5139"><b>Linux&#160;&#160;</b></p>
<p style="position:absolute;top:256px;left:185px;white-space:nowrap" class="ft5139"><b>Userspace</b></p>
<p style="position:absolute;top:243px;left:329px;white-space:nowrap" class="ft5139"><b>TPM&#160;Command&#160;Tools</b></p>
<p style="position:absolute;top:243px;left:585px;white-space:nowrap" class="ft5139"><b>TPM&#160;Manager</b></p>
<p style="position:absolute;top:473px;left:402px;white-space:nowrap" class="ft5139"><b>TPM&#160;daemon</b></p>
</div>
<!-- Page 52 -->
<a name="52"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page52-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application052.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft5212">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft520">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft524">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft524">Final</p>
<p style="position:absolute;top:151px;left:139px;white-space:nowrap" class="ft5215">decided&#160;to&#160;use&#160;a&#160;second&#160;dedicated&#160;serial&#160;peripheral&#160;exclusively&#160;for&#160;the&#160;L4&#160;task&#160;<br/>running&#160;&#160;&#160;the&#160;&#160;&#160;TPM&#160;&#160;&#160;emulator.&#160;&#160;&#160;As&#160;&#160;&#160;the&#160;&#160;&#160;X-GOLD</p>
<p style="position:absolute;top:170px;left:536px;white-space:nowrap" class="ft5217">TM&#160;&#160;</p>
<p style="position:absolute;top:170px;left:561px;white-space:nowrap" class="ft5214">208&#160;&#160;&#160;features&#160;&#160;&#160;multiple&#160;&#160;&#160;USIF&#160;</p>
<p style="position:absolute;top:189px;left:139px;white-space:nowrap" class="ft5215">peripherals&#160;and&#160;the&#160;evaluation&#160;board&#160;hosts&#160;a&#160;corresponding&#160;number&#160;of&#160;serial&#160;<br/>connectors,&#160;this&#160;was&#160;a&#160;straight-forward&#160;approach.&#160;Similar&#160;to&#160;the&#160;management&#160;<br/>of&#160;&#160;&#160;the&#160;&#160;&#160;crypto&#160;&#160;&#160;peripheral,&#160;&#160;&#160;the&#160;&#160;&#160;driver&#160;&#160;&#160;functionality&#160;&#160;&#160;was&#160;&#160;&#160;included&#160;&#160;&#160;into&#160;&#160;&#160;the&#160;<br/>emulator&#160;task&#160;and&#160;the&#160;peripheral&#160;address&#160;range&#160;was&#160;mapped&#160;into&#160;its&#160;address&#160;<br/>space.&#160;An&#160;interrupt-driven&#160;behavior&#160;may&#160;be&#160;later&#160;on&#160;added&#160;here&#160;as&#160;well.<br/>For&#160;reliability&#160;reasons&#160;this&#160;USIF&#160;peripheral&#160;is&#160;operated&#160;using&#160;hardware&#160;flow&#160;<br/>control,&#160;which&#160;also&#160;needs&#160;to&#160;be&#160;configured&#160;at&#160;the&#160;host&#160;site.</p>
<p style="position:absolute;top:352px;left:112px;white-space:nowrap" class="ft5234">●</p>
<p style="position:absolute;top:343px;left:139px;white-space:nowrap" class="ft5214">Use&#160;host&#160;to&#160;store&#160;and&#160;retrieve&#160;non-volatile&#160;TPM&#160;data</p>
<p style="position:absolute;top:381px;left:107px;white-space:nowrap" class="ft5215">For&#160;a&#160;reasonable&#160;deployment&#160;the&#160;TPM&#160;emulator&#160;needs&#160;to&#160;be&#160;able&#160;to&#160;store&#160;its&#160;non-<br/>volatile&#160;&#160;&#160;data&#160;&#160;&#160;generated&#160;&#160;&#160;during&#160;&#160;&#160;a&#160;&#160;&#160;session&#160;&#160;&#160;of&#160;&#160;&#160;TPM&#160;&#160;&#160;commands&#160;&#160;&#160;and&#160;&#160;&#160;to&#160;&#160;&#160;retrieve&#160;&#160;&#160;it&#160;<br/>during&#160;initialization.&#160;In&#160;order&#160;to&#160;overcome&#160;the&#160;aforementioned&#160;problem&#160;of&#160;missing&#160;<br/>flash&#160;driver&#160;software&#160;for&#160;the&#160;L4&#160;environment,&#160;we&#160;decided&#160;to&#160;deploy&#160;a&#160;thin&#160;protocol&#160;<br/>to&#160;&#160;&#160;be&#160;&#160;&#160;terminated&#160;&#160;&#160;by&#160;&#160;&#160;both&#160;&#160;&#160;TPM&#160;&#160;&#160;emulator&#160;&#160;&#160;on&#160;&#160;&#160;the&#160;&#160;&#160;target&#160;&#160;&#160;and&#160;&#160;&#160;the&#160;&#160;&#160;host&#160;&#160;&#160;PC.&#160;&#160;&#160;This&#160;<br/>protocol&#160;should&#160;not&#160;only&#160;carry&#160;TPM&#160;commands&#160;and&#160;their&#160;responses&#160;but&#160;as&#160;well&#160;<br/>some&#160;&#160;dedicated&#160;commands&#160;to&#160;be&#160;able&#160;&#160;to&#160;store&#160;&#160;and&#160;retrieve&#160;TPM&#160;data&#160;remotely&#160;<br/>from&#160;the&#160;host.<br/>When&#160;it&#160;comes&#160;to&#160;storing&#160;confidential&#160;TPM&#160;data&#160;such&#160;as&#160;private&#160;key&#160;exponents&#160;or&#160;<br/>authentication&#160;&#160;&#160;credentials&#160;&#160;&#160;in&#160;&#160;&#160;a&#160;&#160;&#160;non-volatile&#160;&#160;&#160;memory&#160;&#160;&#160;device,&#160;&#160;&#160;it&#160;&#160;&#160;is&#160;&#160;&#160;apparent&#160;&#160;&#160;that&#160;<br/>appropriate&#160;&#160;&#160;protection&#160;&#160;&#160;facilities&#160;&#160;&#160;are&#160;&#160;&#160;required&#160;&#160;&#160;which&#160;&#160;&#160;address&#160;&#160;&#160;all&#160;&#160;&#160;relevant&#160;&#160;&#160;threat&#160;<br/>scenarios.&#160;The&#160;standard&#160;Linux&#160;TPM&#160;emulator&#160;does&#160;not&#160;provide&#160;any&#160;measures&#160;for&#160;<br/>this,&#160;it&#160;simply&#160;streams&#160;all&#160;data&#160;into&#160;a&#160;single&#160;large&#160;byte&#160;packet&#160;and&#160;stores&#160;it&#160;in&#160;a&#160;<br/>kernel&#160;&#160;&#160;file&#160;&#160;&#160;system.&#160;&#160;&#160;For&#160;&#160;&#160;simplicity&#160;&#160;&#160;reasons&#160;&#160;&#160;we&#160;&#160;&#160;also&#160;&#160;&#160;did&#160;&#160;&#160;not&#160;&#160;&#160;apply&#160;&#160;&#160;any&#160;&#160;&#160;explicit&#160;<br/>measures.&#160;In&#160;a&#160;real&#160;deployment&#160;scenario&#160;of&#160;course&#160;a&#160;suitable&#160;protection&#160;scheme&#160;is&#160;<br/>required.&#160;General&#160;recommendations&#160;on&#160;a&#160;secure&#160;data&#160;storage&#160;have&#160;been&#160;defined&#160;in&#160;<br/>OMTP&#160;TR1&#160;[50].</p>
<p style="position:absolute;top:754px;left:112px;white-space:nowrap" class="ft5234">●</p>
<p style="position:absolute;top:745px;left:139px;white-space:nowrap" class="ft5214">Remove&#160;Direct&#160;Anonymous&#160;Attestation&#160;(DAA)&#160;from&#160;the&#160;emulator</p>
<p style="position:absolute;top:783px;left:107px;white-space:nowrap" class="ft5215">After&#160;investigating&#160;the&#160;implementation&#160;of&#160;the&#160;DAA&#160;related&#160;functions&#160;we&#160;decided&#160;to&#160;<br/>omit&#160;the&#160;related&#160;TPM&#160;commands&#160;from&#160;the&#160;target&#160;build.&#160;The&#160;reason&#160;was&#160;that&#160;the&#160;<br/>porting&#160;effort&#160;for&#160;the&#160;respective&#160;big&#160;integer&#160;arithmetic&#160;operations&#160;was&#160;considered&#160;<br/>too&#160;high&#160;and&#160;we&#160;did&#160;not&#160;have&#160;any&#160;use&#160;case&#160;within&#160;the&#160;scope&#160;of&#160;the&#160;secure&#160;wallet&#160;<br/>demonstrator.</p>
<p style="position:absolute;top:917px;left:112px;white-space:nowrap" class="ft5234">●</p>
<p style="position:absolute;top:908px;left:139px;white-space:nowrap" class="ft5214">Use&#160;Lauterbach&#160;scripting&#160;for&#160;static&#160;configuration&#160;of&#160;on-chip&#160;peripherals</p>
<p style="position:absolute;top:946px;left:107px;white-space:nowrap" class="ft5214">From&#160;the&#160;TPM&#160;emulator&#160;perspective,&#160;most&#160;of&#160;the&#160;X-GOLD</p>
<p style="position:absolute;top:946px;left:612px;white-space:nowrap" class="ft5217">TM&#160;&#160;</p>
<p style="position:absolute;top:946px;left:634px;white-space:nowrap" class="ft5214">208&#160;peripherals&#160;and&#160;</p>
<p style="position:absolute;top:965px;left:107px;white-space:nowrap" class="ft5215">system&#160;core&#160;functions&#160;can&#160;be&#160;configured&#160;statically.&#160;For&#160;example&#160;it&#160;is&#160;not&#160;necessary&#160;<br/>for&#160;the&#160;prototype&#160;to&#160;apply&#160;power&#160;measurement&#160;optimizations&#160;by&#160;changing&#160;clock&#160;<br/>settings&#160;or&#160;voltage&#160;levels.&#160;For&#160;this&#160;reason&#160;it&#160;became&#160;apparent&#160;to&#160;assemble&#160;all&#160;static&#160;<br/>configurations&#160;into&#160;a&#160;single&#160;Lauterbach&#160;script,&#160;which&#160;configures&#160;all&#160;necessary&#160;chip&#160;<br/>functions&#160;before&#160;the&#160;target&#160;software&#160;is&#160;loaded&#160;and&#160;started.</p>
<p style="position:absolute;top:1099px;left:112px;white-space:nowrap" class="ft5234">●</p>
<p style="position:absolute;top:1089px;left:139px;white-space:nowrap" class="ft5214">Use&#160;a&#160;proxy&#160;at&#160;the&#160;host&#160;site&#160;for&#160;direct&#160;communication&#160;with&#160;the&#160;target</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft527">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft527">52/109</p>
</div>
<!-- Page 53 -->
<a name="53"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft5340{font-size:11px;font-family:HAAAAA+Arial;color:#000000;}
	.ft5341{font-size:11px;font-family:JAAAAA+ArialMT;color:#000000;}
	.ft5342{font-size:11px;line-height:13px;font-family:JAAAAA+ArialMT;color:#000000;}
-->
</style>
<div id="page53-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application053.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft5312">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft530">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft534">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft534">Final</p>
<p style="position:absolute;top:151px;left:107px;white-space:nowrap" class="ft5315">Instead&#160;&#160;&#160;of&#160;&#160;&#160;communicating&#160;&#160;&#160;directly&#160;&#160;&#160;between&#160;&#160;&#160;the&#160;&#160;&#160;target&#160;&#160;&#160;and&#160;&#160;&#160;the&#160;&#160;&#160;PC&#160;&#160;&#160;running&#160;&#160;&#160;the&#160;<br/>secure&#160;wallet&#160;application,&#160;a&#160;proxy&#160;is&#160;inserted&#160;in&#160;between.&#160;The&#160;tasks&#160;of&#160;this&#160;proxy&#160;<br/>are:</p>
<p style="position:absolute;top:246px;left:165px;white-space:nowrap" class="ft5334">●</p>
<p style="position:absolute;top:237px;left:192px;white-space:nowrap" class="ft5314">Initiate&#160;the&#160;serial&#160;communication&#160;path&#160;towards&#160;the&#160;target;</p>
<p style="position:absolute;top:265px;left:165px;white-space:nowrap" class="ft5334">●</p>
<p style="position:absolute;top:256px;left:192px;white-space:nowrap" class="ft5315">Set&#160;up&#160;a&#160;TCP&#160;server&#160;socket&#160;for&#160;exchange&#160;of&#160;TPM&#160;commands&#160;with&#160;the&#160;<br/>client&#160;(i.e.&#160;the&#160;secure&#160;wallet&#160;PC);</p>
<p style="position:absolute;top:304px;left:165px;white-space:nowrap" class="ft5334">●</p>
<p style="position:absolute;top:294px;left:192px;white-space:nowrap" class="ft5315">Provide&#160;the&#160;TPM&#160;emulator&#160;non-volatile&#160;data&#160;and&#160;request&#160;its&#160;initialisation&#160;<br/>based&#160;on&#160;this&#160;data;</p>
<p style="position:absolute;top:342px;left:165px;white-space:nowrap" class="ft5334">●</p>
<p style="position:absolute;top:333px;left:192px;white-space:nowrap" class="ft5315">Request&#160;the&#160;TPM&#160;emulator&#160;to&#160;transmit&#160;its&#160;current&#160;non-volatile&#160;data&#160;to&#160;<br/>the&#160;proxy&#160;and&#160;store&#160;it&#160;locally&#160;in&#160;a&#160;file&#160;system;</p>
<p style="position:absolute;top:381px;left:165px;white-space:nowrap" class="ft5334">●</p>
<p style="position:absolute;top:371px;left:192px;white-space:nowrap" class="ft5315">Transparently&#160;&#160;&#160;pass&#160;&#160;&#160;TPM&#160;&#160;&#160;commands&#160;&#160;&#160;received&#160;&#160;&#160;over&#160;&#160;&#160;the&#160;&#160;&#160;TCP&#160;&#160;&#160;socket&#160;<br/>connection&#160;from&#160;the&#160;client&#160;via&#160;the&#160;serial&#160;link&#160;to&#160;the&#160;target&#160;and&#160;wait&#160;for&#160;<br/>the&#160;response;&#160;</p>
<p style="position:absolute;top:438px;left:165px;white-space:nowrap" class="ft5334">●</p>
<p style="position:absolute;top:429px;left:192px;white-space:nowrap" class="ft5315">Transparently&#160;&#160;&#160;pass&#160;&#160;&#160;TPM&#160;&#160;&#160;responses&#160;&#160;&#160;received&#160;&#160;&#160;over&#160;&#160;&#160;the&#160;&#160;&#160;serial&#160;&#160;&#160;interface&#160;<br/>from&#160;the&#160;target,&#160;return&#160;it&#160;via&#160;the&#160;TCP&#160;socket&#160;to&#160;the&#160;client&#160;and&#160;wait&#160;for&#160;the&#160;<br/>next&#160;command&#160;from&#160;the&#160;client.</p>
<p style="position:absolute;top:847px;left:253px;white-space:nowrap" class="ft533"><b>Figure&#160;17:&#160;Basic&#160;prototyping&#160;deployment&#160;view</b></p>
<p style="position:absolute;top:884px;left:107px;white-space:nowrap" class="ft5315">The&#160;benefit&#160;of&#160;this&#160;approach&#160;is&#160;that&#160;the&#160;secure&#160;wallet&#160;PC&#160;does&#160;not&#160;have&#160;to&#160;deal&#160;with&#160;<br/>setting&#160;up&#160;the&#160;TPM&#160;emulator,&#160;managing&#160;its&#160;non-volatile&#160;data&#160;and&#160;taking&#160;care&#160;of&#160;the&#160;<br/>proprietary&#160;protocol&#160;on&#160;the&#160;serial&#160;interface.&#160;From&#160;a&#160;secure&#160;wallet&#160;PC&#160;perspective,&#160;<br/>the&#160;proxy&#160;simply&#160;behaves&#160;as&#160;a&#160;remote&#160;TPM&#160;connected&#160;via&#160;a&#160;TCP&#160;socket.<br/>As&#160;&#160;&#160;the&#160;&#160;&#160;L4&#160;&#160;&#160;target&#160;&#160;&#160;is&#160;&#160;&#160;loaded&#160;&#160;&#160;and&#160;&#160;&#160;started&#160;&#160;&#160;via&#160;&#160;&#160;a&#160;&#160;&#160;Lauterbach&#160;&#160;&#160;Debugger&#160;&#160;&#160;application&#160;<br/>running&#160;under&#160;Windows</p>
<p style="position:absolute;top:989px;left:311px;white-space:nowrap" class="ft5317">TM</p>
<p style="position:absolute;top:989px;left:327px;white-space:nowrap" class="ft5314">,&#160;and&#160;since&#160;the&#160;L4&#160;console&#160;I/O&#160;can&#160;also&#160;be&#160;operated&#160;by&#160;a&#160;</p>
<p style="position:absolute;top:1008px;left:107px;white-space:nowrap" class="ft5315">serial&#160;terminal&#160;running&#160;in&#160;this&#160;domain&#160;(e.g.&#160;HyperTerminal),&#160;it&#160;was&#160;a&#160;&#160;natural&#160;&#160;&#160;step&#160;<br/>to&#160;also&#160;implement&#160;the&#160;proxy&#160;under&#160;this&#160;operating&#160;system.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft537">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft537">53/109</p>
<p style="position:absolute;top:519px;left:198px;white-space:nowrap" class="ft5340"><b>deployment&#160;Basic</b></p>
<p style="position:absolute;top:756px;left:252px;white-space:nowrap" class="ft5341">«device»</p>
<p style="position:absolute;top:770px;left:240px;white-space:nowrap" class="ft5340"><b>X-GOLD&#160;208&#160;</b></p>
<p style="position:absolute;top:784px;left:243px;white-space:nowrap" class="ft5340"><b>EVA&#160;Board</b></p>
<p style="position:absolute;top:624px;left:226px;white-space:nowrap" class="ft5341">«execution&#160;environment»</p>
<p style="position:absolute;top:638px;left:220px;white-space:nowrap" class="ft5340"><b>L4/L4env&#160;on&#160;X-GOLD&#160;208</b></p>
<p style="position:absolute;top:755px;left:447px;white-space:nowrap" class="ft5341">«device»</p>
<p style="position:absolute;top:769px;left:461px;white-space:nowrap" class="ft5340"><b>PC</b></p>
<p style="position:absolute;top:756px;left:644px;white-space:nowrap" class="ft5341">«device»</p>
<p style="position:absolute;top:771px;left:657px;white-space:nowrap" class="ft5340"><b>PC</b></p>
<p style="position:absolute;top:624px;left:420px;white-space:nowrap" class="ft5341">«execution&#160;environment»</p>
<p style="position:absolute;top:638px;left:416px;white-space:nowrap" class="ft5340"><b>Microsoft&#160;Windows&#160;2000</b></p>
<p style="position:absolute;top:623px;left:618px;white-space:nowrap" class="ft5341">«execution&#160;environment»</p>
<p style="position:absolute;top:638px;left:663px;white-space:nowrap" class="ft5340"><b>Linux</b></p>
<p style="position:absolute;top:558px;left:237px;white-space:nowrap" class="ft5341">TPM&#160;emulator</p>
<p style="position:absolute;top:557px;left:434px;white-space:nowrap" class="ft5342">Proxy<br/>Console&#160;I/O</p>
<p style="position:absolute;top:557px;left:629px;white-space:nowrap" class="ft5341">Secure&#160;Wallet&#160;</p>
<p style="position:absolute;top:757px;left:356px;white-space:nowrap" class="ft5341">serial&#160;1</p>
<p style="position:absolute;top:781px;left:356px;white-space:nowrap" class="ft5341">serial&#160;2</p>
<p style="position:absolute;top:770px;left:560px;white-space:nowrap" class="ft5341">LAN</p>
</div>
<!-- Page 54 -->
<a name="54"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft5443{font-size:10px;font-family:JAAAAA+ArialMT;color:#000000;}
	.ft5444{font-size:10px;line-height:11px;font-family:JAAAAA+ArialMT;color:#000000;}
-->
</style>
<div id="page54-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application054.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft5412">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft540">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft544">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft544">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft546"><b>2.7.3&#160;Architecture</b></p>
<p style="position:absolute;top:178px;left:85px;white-space:nowrap" class="ft5415">In&#160;&#160;&#160;this&#160;&#160;&#160;section&#160;&#160;&#160;we&#160;&#160;&#160;will&#160;&#160;&#160;present&#160;&#160;&#160;some&#160;&#160;&#160;architectural&#160;&#160;&#160;details&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;TPM&#160;&#160;&#160;emulator&#160;<br/>running&#160;under&#160;L4.&#160;A&#160;basic&#160;overview&#160;of&#160;the&#160;software&#160;components&#160;and&#160;how&#160;they&#160;are&#160;<br/>related&#160;to&#160;each&#160;other&#160;is&#160;given&#160;in&#160;Figur<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#54">e&#160;18.</a></p>
<p style="position:absolute;top:815px;left:199px;white-space:nowrap" class="ft543"><b>Figure&#160;18:&#160;Component&#160;view&#160;of&#160;target&#160;software&#160;architecture</b></p>
<p style="position:absolute;top:852px;left:85px;white-space:nowrap" class="ft5415">As&#160;can&#160;be&#160;seen&#160;from&#160;the&#160;diagram,&#160;the&#160;platform&#160;specific&#160;services&#160;are&#160;integrated&#160;into&#160;a&#160;<br/>single&#160;component&#160;(ISG3-Service-Driver).&#160;This&#160;is&#160;done&#160;in&#160;order&#160;to&#160;keep&#160;the&#160;changes&#160;to&#160;<br/>the&#160;original&#160;Linux&#160;TPM&#160;emulator&#160;source&#160;components&#160;as&#160;limited&#160;as&#160;possible.&#160;The&#160;‘TPM&#160;<br/>Emulator&#160;Main’&#160;component&#160;is&#160;basically&#160;a&#160;replacement&#160;of&#160;the&#160;Linux&#160;TPM&#160;daemon.&#160;It&#160;<br/>takes&#160;care&#160;of&#160;all&#160;communication&#160;towards&#160;the&#160;proxy,&#160;initialises&#160;the&#160;emulator&#160;with&#160;non-<br/>volatile&#160;&#160;&#160;data&#160;&#160;&#160;and&#160;&#160;&#160;passes/fetches&#160;&#160;&#160;TPM&#160;&#160;&#160;commands/responses&#160;&#160;&#160;to/from&#160;&#160;&#160;the&#160;&#160;&#160;emulator&#160;<br/>core.<br/>Note&#160;that&#160;the&#160;diagram&#160;only&#160;lists&#160;one&#160;dependency&#160;towards&#160;the&#160;L4/L4env&#160;environment,&#160;<br/>which&#160;reflects&#160;the&#160;memory&#160;mapping&#160;functionality&#160;in&#160;order&#160;to&#160;map&#160;two&#160;peripherals&#160;<br/>into&#160;&#160;&#160;the&#160;&#160;&#160;emulator&#160;&#160;&#160;task&#160;&#160;&#160;space.&#160;&#160;&#160;This&#160;&#160;&#160;is&#160;&#160;&#160;apparently&#160;&#160;&#160;a&#160;&#160;&#160;simplification,&#160;&#160;&#160;since&#160;&#160;&#160;the&#160;&#160;&#160;TPM&#160;<br/>emulator&#160;also&#160;makes&#160;use&#160;of&#160;a&#160;few&#160;other&#160;basic&#160;L4&#160;services.&#160;An&#160;example&#160;is&#160;the&#160;console&#160;<br/>output&#160;(debug&#160;printout)&#160;which&#160;is&#160;routed&#160;via&#160;L4&#160;kernel&#160;services&#160;to&#160;the&#160;second&#160;serial&#160;<br/>interface&#160;(USIF2)&#160;of&#160;the&#160;baseband&#160;processor.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft547">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft547">54/109</p>
<p style="position:absolute;top:280px;left:96px;white-space:nowrap" class="ft5439"><b>cmp&#160;TPM&#160;emulator&#160;on&#160;L4/X-GOLD(TM)&#160;208</b></p>
<p style="position:absolute;top:636px;left:572px;white-space:nowrap" class="ft5439"><b>ISG3&#160;Service&#160;Driver</b></p>
<p style="position:absolute;top:578px;left:692px;white-space:nowrap" class="ft5443">KeyGen&#160;IF</p>
<p style="position:absolute;top:578px;left:582px;white-space:nowrap" class="ft5443">RSA&#160;IF</p>
<p style="position:absolute;top:644px;left:456px;white-space:nowrap" class="ft5443">Random&#160;IF</p>
<p style="position:absolute;top:649px;left:733px;white-space:nowrap" class="ft5443">USIF1&#160;IF</p>
<p style="position:absolute;top:577px;left:515px;white-space:nowrap" class="ft5443">Hash&#160;IF</p>
<p style="position:absolute;top:317px;left:485px;white-space:nowrap" class="ft5439"><b>TPM&#160;Emulator&#160;Main</b></p>
<p style="position:absolute;top:718px;left:515px;white-space:nowrap" class="ft5439"><b>X-GOLD&#160;208</b></p>
<p style="position:absolute;top:752px;left:388px;white-space:nowrap" class="ft5439"><b>ARM9</b></p>
<p style="position:absolute;top:750px;left:665px;white-space:nowrap" class="ft5439"><b>Crypto</b></p>
<p style="position:absolute;top:751px;left:586px;white-space:nowrap" class="ft5439"><b>USIF1</b></p>
<p style="position:absolute;top:752px;left:458px;white-space:nowrap" class="ft5439"><b>USIF2</b></p>
<p style="position:absolute;top:503px;left:570px;white-space:nowrap" class="ft5439"><b>TPM&#160;Crypto&#160;Services</b></p>
<p style="position:absolute;top:413px;left:476px;white-space:nowrap" class="ft5439"><b>TPM&#160;NVM&#160;</b></p>
<p style="position:absolute;top:424px;left:479px;white-space:nowrap" class="ft5439"><b>Manage&#160;r</b></p>
<p style="position:absolute;top:366px;left:516px;white-space:nowrap" class="ft5443">Load/Store&#160;NV&#160;mem&#160;IF</p>
<p style="position:absolute;top:635px;left:259px;white-space:nowrap" class="ft5439"><b>TPM&#160;Emulator&#160;Execution&#160;Engine</b></p>
<p style="position:absolute;top:554px;left:275px;white-space:nowrap" class="ft5444">Emulator<br/>Init/Shutdown&#160;IF</p>
<p style="position:absolute;top:411px;left:273px;white-space:nowrap" class="ft5439"><b>TPM&#160;Command&#160;</b></p>
<p style="position:absolute;top:423px;left:264px;white-space:nowrap" class="ft5439"><b>Marshalling&#160;Engine</b></p>
<p style="position:absolute;top:320px;left:125px;white-space:nowrap" class="ft5439"><b>L4&#160;/&#160;L4env</b></p>
<p style="position:absolute;top:334px;left:199px;white-space:nowrap" class="ft5443">L4&#160;I/O&#160;map&#160;IF</p>
</div>
<!-- Page 55 -->
<a name="55"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page55-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application055.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft5512">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft550">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft554">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft554">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft5515">The&#160;&#160;following&#160;&#160;Figure&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#55">&#160;19&#160;&#160;</a>gives&#160;an&#160;&#160;overview&#160;&#160;of&#160;&#160;the&#160;functional&#160;&#160;behavior&#160;of&#160;&#160;the&#160;&#160;TPM&#160;<br/>emulator.</p>
<p style="position:absolute;top:798px;left:264px;white-space:nowrap" class="ft553"><b>Figure&#160;19:&#160;TPM&#160;emulator&#160;procedures&#160;on&#160;L4</b></p>
<p style="position:absolute;top:835px;left:85px;white-space:nowrap" class="ft5515">The&#160;corresponding&#160;procedures&#160;of&#160;the&#160;TPM&#160;proxy&#160;running&#160;at&#160;the&#160;host&#160;site&#160;are&#160;depicted&#160;<br/>in&#160;Figure<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#56">&#160;20.</a>&#160;In&#160;order&#160;to&#160;set&#160;up&#160;a&#160;complete&#160;processing&#160;chain,&#160;the&#160;following&#160;steps&#160;need&#160;<br/>to&#160;be&#160;executed:</p>
<p style="position:absolute;top:921px;left:112px;white-space:nowrap" class="ft5515">1.&#160;Configure&#160;the&#160;target&#160;and&#160;load&#160;target&#160;software&#160;image&#160;via&#160;Lauterbach&#160;Debugger<br/>2.&#160;Start&#160;of&#160;L4&#160;kernel&#160;on&#160;target<br/>3.&#160;Start&#160;of&#160;TPM&#160;emulator&#160;on&#160;target<br/>4.&#160;Start&#160;of&#160;TPM&#160;proxy<br/>5.&#160;Start&#160;of&#160;TPM&#160;client&#160;(Secure&#160;Wallet&#160;PC&#160;or&#160;patch<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#55">ed</a></p>
<p style="position:absolute;top:998px;left:553px;white-space:nowrap" class="ft5517"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#55">8</a></p>
<p style="position:absolute;top:998px;left:559px;white-space:nowrap" class="ft5514"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#55">&#160;</a>TrouSerS&#160;daemon)</p>
<p style="position:absolute;top:1104px;left:85px;white-space:nowrap" class="ft554">8&#160;The&#160;device&#160;driver&#160;(TDDL)&#160;layer&#160;of&#160;the&#160;TrouSerS&#160;daemon&#160;needs&#160;to&#160;be&#160;patched&#160;in&#160;order&#160;to&#160;</p>
<p style="position:absolute;top:1122px;left:107px;white-space:nowrap" class="ft554">support&#160;communication&#160;with&#160;a&#160;remote&#160;TPM&#160;connected&#160;via&#160;a&#160;TCP&#160;socket.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft557">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft557">55/109</p>
<p style="position:absolute;top:223px;left:145px;white-space:nowrap" class="ft5540"><b>stm&#160;States&#160;TPM&#160;Emulator</b></p>
<p style="position:absolute;top:287px;left:166px;white-space:nowrap" class="ft5541">Start</p>
<p style="position:absolute;top:335px;left:227px;white-space:nowrap" class="ft5540"><b>Wait&#160;for&#160;Proxy&#160;</b></p>
<p style="position:absolute;top:348px;left:239px;white-space:nowrap" class="ft5540"><b>Command</b></p>
<p style="position:absolute;top:432px;left:162px;white-space:nowrap" class="ft5541">Hello&#160;Command</p>
<p style="position:absolute;top:335px;left:487px;white-space:nowrap" class="ft5540"><b>Send&#160;Response&#160;to&#160;Prox&#160;y</b></p>
<p style="position:absolute;top:250px;left:242px;white-space:nowrap" class="ft5540"><b>Check&#160;Target&#160;</b></p>
<p style="position:absolute;top:264px;left:231px;white-space:nowrap" class="ft5540"><b>Peripheral&#160;Access</b></p>
<p style="position:absolute;top:556px;left:430px;white-space:nowrap" class="ft5540"><b>Initialize&#160;Emulator&#160;</b></p>
<p style="position:absolute;top:569px;left:427px;white-space:nowrap" class="ft5540"><b>engine&#160;with&#160;NV&#160;data</b></p>
<p style="position:absolute;top:481px;left:350px;white-space:nowrap" class="ft5540"><b>Initialize&#160;Emulator&#160;</b></p>
<p style="position:absolute;top:494px;left:347px;white-space:nowrap" class="ft5540"><b>engine&#160;with&#160;default&#160;</b></p>
<p style="position:absolute;top:508px;left:390px;white-space:nowrap" class="ft5540"><b>data</b></p>
<p style="position:absolute;top:626px;left:357px;white-space:nowrap" class="ft5540"><b>Get&#160;NV&#160;data&#160;from&#160;</b></p>
<p style="position:absolute;top:640px;left:361px;white-space:nowrap" class="ft5540"><b>Emulator&#160;engine</b></p>
<p style="position:absolute;top:635px;left:156px;white-space:nowrap" class="ft5542">Retrieve&#160;NV&#160;data<br/>Command</p>
<p style="position:absolute;top:491px;left:158px;white-space:nowrap" class="ft5542">Reset&#160;Emulator<br/>Command</p>
<p style="position:absolute;top:558px;left:154px;white-space:nowrap" class="ft5542">Init&#160;Emulator<br/>Command&#160;(NV&#160;data)</p>
<p style="position:absolute;top:622px;left:539px;white-space:nowrap" class="ft5540"><b>Emulator&#160;</b></p>
<p style="position:absolute;top:636px;left:538px;white-space:nowrap" class="ft5540"><b>Shutdow&#160;n</b></p>
<p style="position:absolute;top:706px;left:596px;white-space:nowrap" class="ft5540"><b>Execute&#160;TPM&#160;</b></p>
<p style="position:absolute;top:720px;left:606px;white-space:nowrap" class="ft5540"><b>command</b></p>
<p style="position:absolute;top:716px;left:159px;white-space:nowrap" class="ft5541">TPM&#160;Command</p>
<p style="position:absolute;top:420px;left:362px;white-space:nowrap" class="ft5541">OK</p>
<p style="position:absolute;top:452px;left:460px;white-space:nowrap" class="ft5541">OK&#160;or&#160;FAILURE</p>
<p style="position:absolute;top:433px;left:418px;white-space:nowrap" class="ft5541">OK</p>
<p style="position:absolute;top:756px;left:312px;white-space:nowrap" class="ft5541">Return&#160;message&#160;type&#160;with&#160;zero&#160;message&#160;content</p>
<p style="position:absolute;top:559px;left:332px;white-space:nowrap" class="ft5541">NV&#160;data</p>
<p style="position:absolute;top:475px;left:547px;white-space:nowrap" class="ft5541">OK&#160;(NV&#160;data)</p>
<p style="position:absolute;top:548px;left:591px;white-space:nowrap" class="ft5541">OK&#160;(TPM&#160;Response)</p>
<p style="position:absolute;top:713px;left:396px;white-space:nowrap" class="ft5541">TPM&#160;Command</p>
</div>
<!-- Page 56 -->
<a name="56"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft5645{font-size:12px;font-family:HAAAAA+Arial;color:#000000;}
	.ft5646{font-size:12px;font-family:JAAAAA+ArialMT;color:#000000;}
	.ft5647{font-size:12px;line-height:14px;font-family:JAAAAA+ArialMT;color:#000000;}
-->
</style>
<div id="page56-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application056.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft5612">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft560">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft564">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft564">Final</p>
<p style="position:absolute;top:1092px;left:305px;white-space:nowrap" class="ft563"><b>Figure&#160;20:&#160;TPM&#160;Proxy&#160;procedures</b></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft567">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft567">56/109</p>
<p style="position:absolute;top:157px;left:161px;white-space:nowrap" class="ft5645"><b>stm&#160;Proxy&#160;procedures</b></p>
<p style="position:absolute;top:193px;left:311px;white-space:nowrap" class="ft5646">Start</p>
<p style="position:absolute;top:186px;left:418px;white-space:nowrap" class="ft5645"><b>Setup&#160;TCP&#160;server&#160;to&#160;</b></p>
<p style="position:absolute;top:200px;left:440px;white-space:nowrap" class="ft5645"><b>TPM&#160;Daemon</b></p>
<p style="position:absolute;top:256px;left:419px;white-space:nowrap" class="ft5645"><b>Setup&#160;serial&#160;link&#160;to&#160;</b></p>
<p style="position:absolute;top:271px;left:457px;white-space:nowrap" class="ft5645"><b>Target</b></p>
<p style="position:absolute;top:365px;left:436px;white-space:nowrap" class="ft5645"><b>Check&#160;serial&#160;</b></p>
<p style="position:absolute;top:379px;left:410px;white-space:nowrap" class="ft5645"><b>communication&#160;using&#160;</b></p>
<p style="position:absolute;top:394px;left:428px;white-space:nowrap" class="ft5645"><b>HELLO&#160;protocol</b></p>
<p style="position:absolute;top:453px;left:490px;white-space:nowrap" class="ft5646">Target&#160;online?</p>
<p style="position:absolute;top:428px;left:211px;white-space:nowrap" class="ft5646">End</p>
<p style="position:absolute;top:570px;left:424px;white-space:nowrap" class="ft5645"><b>Initialise&#160;Target&#160;</b></p>
<p style="position:absolute;top:584px;left:435px;white-space:nowrap" class="ft5645"><b>with&#160;NV&#160;data</b></p>
<p style="position:absolute;top:563px;left:289px;white-space:nowrap" class="ft5645"><b>Initalise&#160;Target&#160;</b></p>
<p style="position:absolute;top:578px;left:286px;white-space:nowrap" class="ft5645"><b>with&#160;default&#160;data</b></p>
<p style="position:absolute;top:511px;left:495px;white-space:nowrap" class="ft5647">NV&#160;data&#160;present&#160;in<br/>local&#160;file&#160;system</p>
<p style="position:absolute;top:637px;left:362px;white-space:nowrap" class="ft5646">Initialisation&#160;OK?</p>
<p style="position:absolute;top:650px;left:497px;white-space:nowrap" class="ft5646">Initialisation&#160;OK?</p>
<p style="position:absolute;top:715px;left:434px;white-space:nowrap" class="ft5645"><b>Wait&#160;for&#160;TPM&#160;</b></p>
<p style="position:absolute;top:730px;left:424px;white-space:nowrap" class="ft5645"><b>client&#160;to&#160;connect</b></p>
<p style="position:absolute;top:785px;left:434px;white-space:nowrap" class="ft5645"><b>Wait&#160;for&#160;TPM&#160;</b></p>
<p style="position:absolute;top:799px;left:427px;white-space:nowrap" class="ft5645"><b>command&#160;from&#160;</b></p>
<p style="position:absolute;top:814px;left:443px;white-space:nowrap" class="ft5645"><b>TPM&#160;client</b></p>
<p style="position:absolute;top:865px;left:432px;white-space:nowrap" class="ft5645"><b>Forward&#160;TPM&#160;</b></p>
<p style="position:absolute;top:880px;left:434px;white-space:nowrap" class="ft5645"><b>command&#160;to&#160;</b></p>
<p style="position:absolute;top:894px;left:454px;white-space:nowrap" class="ft5645"><b>Target</b></p>
<p style="position:absolute;top:946px;left:425px;white-space:nowrap" class="ft5645"><b>Wait&#160;for&#160;response&#160;</b></p>
<p style="position:absolute;top:961px;left:444px;white-space:nowrap" class="ft5645"><b>from&#160;Target</b></p>
<p style="position:absolute;top:1018px;left:443px;white-space:nowrap" class="ft5645"><b>Send&#160;target&#160;</b></p>
<p style="position:absolute;top:1032px;left:429px;white-space:nowrap" class="ft5645"><b>response&#160;to&#160;TPM&#160;</b></p>
<p style="position:absolute;top:1047px;left:462px;white-space:nowrap" class="ft5645"><b>client</b></p>
<p style="position:absolute;top:318px;left:414px;white-space:nowrap" class="ft5646">Junction</p>
<p style="position:absolute;top:794px;left:677px;white-space:nowrap" class="ft5646">Junction</p>
<p style="position:absolute;top:691px;left:617px;white-space:nowrap" class="ft5645"><b>Fetch&#160;NV&#160;data&#160;</b></p>
<p style="position:absolute;top:705px;left:612px;white-space:nowrap" class="ft5645"><b>from&#160;Target&#160;and&#160;</b></p>
<p style="position:absolute;top:720px;left:616px;white-space:nowrap" class="ft5645"><b>store&#160;it&#160;in&#160;local&#160;</b></p>
<p style="position:absolute;top:734px;left:629px;white-space:nowrap" class="ft5645"><b>file&#160;system</b></p>
<p style="position:absolute;top:869px;left:223px;white-space:nowrap" class="ft5646">Target&#160;communication&#160;failure</p>
<p style="position:absolute;top:445px;left:359px;white-space:nowrap" class="ft5646">No</p>
<p style="position:absolute;top:505px;left:371px;white-space:nowrap" class="ft5646">No</p>
<p style="position:absolute;top:611px;left:265px;white-space:nowrap" class="ft5646">No</p>
<p style="position:absolute;top:586px;left:210px;white-space:nowrap" class="ft5646">No</p>
<p style="position:absolute;top:809px;left:562px;white-space:nowrap" class="ft5646">Client&#160;link</p>
<p style="position:absolute;top:823px;left:563px;white-space:nowrap" class="ft5646">terrmination</p>
<p style="position:absolute;top:1025px;left:221px;white-space:nowrap" class="ft5646">Target&#160;communication&#160;failure</p>
<p style="position:absolute;top:1005px;left:569px;white-space:nowrap" class="ft5646">Client&#160;link</p>
<p style="position:absolute;top:1019px;left:570px;white-space:nowrap" class="ft5646">termination</p>
</div>
<!-- Page 57 -->
<a name="57"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft5748{font-size:9px;font-family:HAAAAA+Arial;color:#000000;}
	.ft5749{font-size:9px;font-family:JAAAAA+ArialMT;color:#000000;}
	.ft5750{font-size:9px;line-height:10px;font-family:JAAAAA+ArialMT;color:#000000;}
-->
</style>
<div id="page57-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application057.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft5712">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft570">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft574">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft574">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft576"><b>2.7.4&#160;Test&#160;Architecture</b></p>
<p style="position:absolute;top:178px;left:85px;white-space:nowrap" class="ft5715">The&#160;&#160;&#160;entire&#160;&#160;&#160;deployment&#160;&#160;&#160;view&#160;&#160;&#160;for&#160;&#160;&#160;the&#160;&#160;&#160;test&#160;&#160;&#160;architecture&#160;&#160;&#160;is&#160;&#160;&#160;given&#160;&#160;&#160;in&#160;&#160;&#160;Figure&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#57">&#160;21.&#160;</a>&#160;&#160;An&#160;<br/>example&#160;which&#160;visualises&#160;the&#160;message&#160;exchange&#160;between&#160;the&#160;involved&#160;nodes&#160;is&#160;given&#160;<br/>in&#160;figures<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#58">&#160;22&#160;</a>and<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#58">&#160;23.</a>&#160;In&#160;the&#160;chosen&#160;scenario&#160;the&#160;TPM&#160;owner&#160;running&#160;a&#160;TPM&#160;command&#160;<br/>tool&#160;requests&#160;the&#160;public&#160;endorsement&#160;key&#160;(EK)&#160;to&#160;be&#160;read&#160;from&#160;the&#160;TPM.</p>
<p style="position:absolute;top:1098px;left:229px;white-space:nowrap" class="ft573"><b>Figure&#160;21:&#160;Deployment&#160;view&#160;used&#160;for&#160;target&#160;testing&#160;</b></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft577">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft577">57/109</p>
<p style="position:absolute;top:273px;left:90px;white-space:nowrap" class="ft5748"><b>deployment&#160;Detailed</b></p>
<p style="position:absolute;top:396px;left:598px;white-space:nowrap" class="ft5749">Linux&#160;Test&#160;Environment</p>
<p style="position:absolute;top:394px;left:273px;white-space:nowrap" class="ft5749">Windows&#160;-&#160;Target&#160;Control&#160;and&#160;interface&#160;to&#160;Test</p>
<p style="position:absolute;top:405px;left:339px;white-space:nowrap" class="ft5749">Environment</p>
<p style="position:absolute;top:392px;left:148px;white-space:nowrap" class="ft5749">L4&#160;on&#160;Target</p>
<p style="position:absolute;top:790px;left:120px;white-space:nowrap" class="ft5749">«execution&#160;environment»</p>
<p style="position:absolute;top:801px;left:114px;white-space:nowrap" class="ft5748"><b>L4/L4env&#160;on&#160;X-GOLD&#160;208</b></p>
<p style="position:absolute;top:914px;left:139px;white-space:nowrap" class="ft5749">«device»</p>
<p style="position:absolute;top:925px;left:130px;white-space:nowrap" class="ft5748"><b>X-GOLD&#160;208&#160;</b></p>
<p style="position:absolute;top:936px;left:133px;white-space:nowrap" class="ft5748"><b>EVA&#160;Board</b></p>
<p style="position:absolute;top:911px;left:329px;white-space:nowrap" class="ft5749">«device»</p>
<p style="position:absolute;top:922px;left:340px;white-space:nowrap" class="ft5748"><b>PC</b></p>
<p style="position:absolute;top:914px;left:617px;white-space:nowrap" class="ft5749">«device»</p>
<p style="position:absolute;top:924px;left:627px;white-space:nowrap" class="ft5748"><b>PC</b></p>
<p style="position:absolute;top:787px;left:577px;white-space:nowrap" class="ft5749">«execution&#160;environment»</p>
<p style="position:absolute;top:798px;left:613px;white-space:nowrap" class="ft5748"><b>Linux</b></p>
<p style="position:absolute;top:787px;left:311px;white-space:nowrap" class="ft5749">«execution&#160;environment»</p>
<p style="position:absolute;top:798px;left:321px;white-space:nowrap" class="ft5748"><b>MS&#160;Windows&#160;2000</b></p>
<p style="position:absolute;top:1028px;left:142px;white-space:nowrap" class="ft5749">«device»</p>
<p style="position:absolute;top:1039px;left:133px;white-space:nowrap" class="ft5748"><b>Lauterbach&#160;</b></p>
<p style="position:absolute;top:1049px;left:131px;white-space:nowrap" class="ft5748"><b>Power&#160;Trace</b></p>
<p style="position:absolute;top:588px;left:141px;white-space:nowrap" class="ft5748"><b>TPM&#160;Emulator&#160;</b></p>
<p style="position:absolute;top:599px;left:153px;white-space:nowrap" class="ft5748"><b>Program</b></p>
<p style="position:absolute;top:711px;left:289px;white-space:nowrap" class="ft5748"><b>Lauterbach&#160;</b></p>
<p style="position:absolute;top:722px;left:279px;white-space:nowrap" class="ft5748"><b>Trace32&#160;Program</b></p>
<p style="position:absolute;top:448px;left:395px;white-space:nowrap" class="ft5748"><b>TPM&#160;Proxy&#160;</b></p>
<p style="position:absolute;top:459px;left:400px;white-space:nowrap" class="ft5748"><b>Program</b></p>
<p style="position:absolute;top:452px;left:550px;white-space:nowrap" class="ft5748"><b>Trousers&#160;</b></p>
<p style="position:absolute;top:463px;left:551px;white-space:nowrap" class="ft5748"><b>Daemon</b></p>
<p style="position:absolute;top:710px;left:626px;white-space:nowrap" class="ft5748"><b>TPM&#160;Command&#160;</b></p>
<p style="position:absolute;top:721px;left:650px;white-space:nowrap" class="ft5748"><b>Tool</b></p>
<p style="position:absolute;top:585px;left:323px;white-space:nowrap" class="ft5748"><b>USIF&#160;Terminal&#160;</b></p>
<p style="position:absolute;top:596px;left:332px;white-space:nowrap" class="ft5748"><b>Application</b></p>
<p style="position:absolute;top:301px;left:129px;white-space:nowrap" class="ft5750">Initializing&#160;TPM&#160;Emulator<br/>Loading/Storing&#160;NV&#160;mem&#160;data&#160;to&#160;Target<br/>Forwarding&#160;TPM&#160;commands&#160;from&#160;Trousers&#160;Daemon&#160;to&#160;TPM&#160;Emulator<br/>Returning&#160;TPM&#160;responses&#160;from&#160;TPM&#160;Emulator&#160;to&#160;Trousers&#160;Daemon<br/>Converting&#160;TPM&#160;commands/responses&#160;from&#160;UART&#160;to&#160;TCP/IP</p>
<p style="position:absolute;top:332px;left:471px;white-space:nowrap" class="ft5750">Translating&#160;TSS&#160;related&#160;function&#160;calls&#160;to&#160;TPM&#160;commmands<br/>Exchange&#160;of&#160;TPM&#160;commands/responses&#160;with&#160;TPM&#160;Proxy</p>
<p style="position:absolute;top:521px;left:270px;white-space:nowrap" class="ft5750">L4&#160;Kernel&#160;Debugger&#160;Access<br/>Start&#160;of&#160;TPM&#160;Emulator&#160;<br/>Console&#160;I/O&#160;of&#160;L4&#160;and&#160;TPM&#160;Emulator</p>
<p style="position:absolute;top:666px;left:388px;white-space:nowrap" class="ft5750">Loading&#160;and&#160;<br/>Starting&#160;Target</p>
<p style="position:absolute;top:642px;left:674px;white-space:nowrap" class="ft5750">Command&#160;line&#160;based&#160;<br/>tool&#160;to&#160;execute&#160;TPM&#160;<br/>commands</p>
<p style="position:absolute;top:956px;left:216px;white-space:nowrap" class="ft5749">USIF1</p>
<p style="position:absolute;top:923px;left:216px;white-space:nowrap" class="ft5749">USIF2</p>
<p style="position:absolute;top:989px;left:135px;white-space:nowrap" class="ft5749">JTAG</p>
<p style="position:absolute;top:920px;left:484px;white-space:nowrap" class="ft5749">LAN</p>
<p style="position:absolute;top:1033px;left:321px;white-space:nowrap" class="ft5749">USB</p>
<p style="position:absolute;top:599px;left:262px;white-space:nowrap" class="ft5750">Console&#160;I/O<br/>over&#160;serial</p>
<p style="position:absolute;top:458px;left:470px;white-space:nowrap" class="ft5749">TPM</p>
<p style="position:absolute;top:469px;left:470px;white-space:nowrap" class="ft5750">commands<br/>over&#160;TCP/IP</p>
<p style="position:absolute;top:433px;left:111px;white-space:nowrap" class="ft5749">TPM&#160;commands/responses</p>
<p style="position:absolute;top:443px;left:111px;white-space:nowrap" class="ft5749">over&#160;serial</p>
</div>
<!-- Page 58 -->
<a name="58"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft5851{font-size:6px;font-family:JAAAAA+ArialMT;color:#000000;}
	.ft5852{font-size:6px;line-height:8px;font-family:JAAAAA+ArialMT;color:#000000;}
	.ft5853{font-size:9px;line-height:11px;font-family:JAAAAA+ArialMT;color:#000000;}
-->
</style>
<div id="page58-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application058.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft5812">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft580">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft584">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft584">Final</p>
<p style="position:absolute;top:515px;left:215px;white-space:nowrap" class="ft583"><b>Figure&#160;22:Message&#160;flow&#160;until&#160;start&#160;of&#160;Trousers&#160;daemon</b></p>
<p style="position:absolute;top:1091px;left:101px;white-space:nowrap" class="ft583"><b>Figure&#160;23:&#160;Example&#160;message&#160;exchange&#160;for&#160;a&#160;simple&#160;use&#160;case&#160;to&#160;read&#160;the&#160;public&#160;EK</b></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft587">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft587">58/109</p>
<p style="position:absolute;top:570px;left:112px;white-space:nowrap" class="ft5848"><b>sd&#160;Read&#160;protected&#160;public&#160;EK</b></p>
<p style="position:absolute;top:593px;left:182px;white-space:nowrap" class="ft5849">TPM&#160;Emulator</p>
<p style="position:absolute;top:593px;left:346px;white-space:nowrap" class="ft5849">TPM&#160;Proxy</p>
<p style="position:absolute;top:593px;left:468px;white-space:nowrap" class="ft5849">Trousers</p>
<p style="position:absolute;top:604px;left:469px;white-space:nowrap" class="ft5849">Daemon</p>
<p style="position:absolute;top:593px;left:583px;white-space:nowrap" class="ft5849">TPM</p>
<p style="position:absolute;top:604px;left:571px;white-space:nowrap" class="ft5849">Command</p>
<p style="position:absolute;top:616px;left:584px;white-space:nowrap" class="ft5849">Tool</p>
<p style="position:absolute;top:616px;left:673px;white-space:nowrap" class="ft5849">TPM&#160;Owner</p>
<p style="position:absolute;top:644px;left:708px;white-space:nowrap" class="ft5852">TPM&#160;Owner&#160;enters&#160;<br/>command&#160;to&#160;read&#160;<br/>public&#160;EK</p>
<p style="position:absolute;top:755px;left:711px;white-space:nowrap" class="ft5852">TPM&#160;Owner&#160;is&#160;<br/>prompted&#160;to&#160;enter&#160;<br/>the&#160;authorization&#160;<br/>password</p>
<p style="position:absolute;top:1048px;left:710px;white-space:nowrap" class="ft5852">TPM&#160;Owner&#160;gets&#160;<br/>public&#160;EK</p>
<p style="position:absolute;top:954px;left:128px;white-space:nowrap" class="ft5853">TPM&#160;verifies&#160;<br/>authentication&#160;<br/>credentials</p>
<p style="position:absolute;top:872px;left:605px;white-space:nowrap" class="ft5853">Calculate&#160;<br/>authentication&#160;<br/>credentials&#160;based&#160;<br/>on&#160;on&#160;nonce&#160;and&#160;<br/>passphrase</p>
<p style="position:absolute;top:836px;left:131px;white-space:nowrap" class="ft5849">Generate&#160;nonce</p>
<p style="position:absolute;top:639px;left:612px;white-space:nowrap" class="ft5849">get&#160;Public&#160;EK()</p>
<p style="position:absolute;top:673px;left:375px;white-space:nowrap" class="ft5849">TPM_ORD_ReadPubEK()</p>
<p style="position:absolute;top:682px;left:238px;white-space:nowrap" class="ft5849">TPM_ORD_ReadPubEK()</p>
<p style="position:absolute;top:708px;left:233px;white-space:nowrap" class="ft5849">FAILURE(TPM_DISABLED)</p>
<p style="position:absolute;top:714px;left:382px;white-space:nowrap" class="ft5849">FAILURE(DISABLED)</p>
<p style="position:absolute;top:739px;left:608px;white-space:nowrap" class="ft5849">Authenticate&#160;Req()</p>
<p style="position:absolute;top:781px;left:604px;white-space:nowrap" class="ft5849">Authent.</p>
<p style="position:absolute;top:792px;left:603px;white-space:nowrap" class="ft5849">Response(Password)</p>
<p style="position:absolute;top:804px;left:389px;white-space:nowrap" class="ft5849">TPM_ORD_OIAP()</p>
<p style="position:absolute;top:816px;left:252px;white-space:nowrap" class="ft5849">TPM_ORD_OIAP()</p>
<p style="position:absolute;top:841px;left:267px;white-space:nowrap" class="ft5849">OK(Nonce)</p>
<p style="position:absolute;top:855px;left:404px;white-space:nowrap" class="ft5849">OK(Nonce)</p>
<p style="position:absolute;top:912px;left:361px;white-space:nowrap" class="ft5849">OwnerReadInternalPubEK(Auth)</p>
<p style="position:absolute;top:937px;left:224px;white-space:nowrap" class="ft5849">OwnerReadInternalPubEK(Auth)</p>
<p style="position:absolute;top:962px;left:266px;white-space:nowrap" class="ft5849">OK(PubEK)</p>
<p style="position:absolute;top:987px;left:402px;white-space:nowrap" class="ft5849">OK(PubEK)</p>
<p style="position:absolute;top:172px;left:210px;white-space:nowrap" class="ft5848"><b>sd&#160;Initial_messages</b></p>
<p style="position:absolute;top:195px;left:283px;white-space:nowrap" class="ft5849">TPM&#160;Emulator</p>
<p style="position:absolute;top:195px;left:444px;white-space:nowrap" class="ft5849">TPM&#160;Proxy</p>
<p style="position:absolute;top:195px;left:589px;white-space:nowrap" class="ft5849">Trousers</p>
<p style="position:absolute;top:206px;left:590px;white-space:nowrap" class="ft5849">Daemon</p>
<p style="position:absolute;top:302px;left:226px;white-space:nowrap" class="ft5851">TPM&#160;Self&#160;test&#160;with&#160;NV&#160;data</p>
<p style="position:absolute;top:322px;left:226px;white-space:nowrap" class="ft5852">Fallback&#160;to&#160;def&#160;ault&#160;if&#160;&#160;NV&#160;<br/>data&#160;corrupt</p>
<p style="position:absolute;top:348px;left:622px;white-space:nowrap" class="ft5852">Capability&#160;&#160;Inv&#160;estigation&#160;<br/>executed&#160;multiple&#160;times...</p>
<p style="position:absolute;top:241px;left:371px;white-space:nowrap" class="ft5849">HELLO()</p>
<p style="position:absolute;top:261px;left:362px;white-space:nowrap" class="ft5849">HELLO_OK()</p>
<p style="position:absolute;top:280px;left:349px;white-space:nowrap" class="ft5849">INIT_TPM(NV_data)</p>
<p style="position:absolute;top:305px;left:369px;white-space:nowrap" class="ft5849">INIT_OK()</p>
<p style="position:absolute;top:330px;left:503px;white-space:nowrap" class="ft5849">Get_Capability()</p>
<p style="position:absolute;top:347px;left:357px;white-space:nowrap" class="ft5849">Get_Capability()</p>
<p style="position:absolute;top:368px;left:372px;white-space:nowrap" class="ft5849">OK(cap)</p>
<p style="position:absolute;top:377px;left:519px;white-space:nowrap" class="ft5849">OK(cap)</p>
<p style="position:absolute;top:396px;left:503px;white-space:nowrap" class="ft5849">Get_Capability()</p>
<p style="position:absolute;top:408px;left:357px;white-space:nowrap" class="ft5849">Get_Capability()</p>
<p style="position:absolute;top:431px;left:379px;white-space:nowrap" class="ft5849">cap()</p>
<p style="position:absolute;top:453px;left:519px;white-space:nowrap" class="ft5849">OK(cap)</p>
</div>
<!-- Page 59 -->
<a name="59"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft5954{font-size:15px;font-family:EAAAAA+DejaVuSerif;color:#ffffff;}
	.ft5955{font-size:17px;font-family:FAAAAA+DejaVuSans;color:#000000;}
-->
</style>
<div id="page59-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application059.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft5912">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft590">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft594">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft594">Final</p>
<p style="position:absolute;top:172px;left:85px;white-space:nowrap" class="ft593"><b>3&#160;</b></p>
<p style="position:absolute;top:169px;left:117px;white-space:nowrap" class="ft5919"><b>TCG&#160;Support&#160;for&#160;the&#160;Secure&#160;Wallet&#160;Prototype</b></p>
<p style="position:absolute;top:199px;left:85px;white-space:nowrap" class="ft5915">In&#160;&#160;&#160;this&#160;&#160;&#160;chapter&#160;&#160;&#160;we&#160;&#160;&#160;examine&#160;&#160;&#160;the&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;&#160;&#160;with&#160;&#160;&#160;a&#160;&#160;&#160;view&#160;&#160;&#160;to&#160;&#160;&#160;specifying&#160;&#160;&#160;what&#160;<br/>functionality&#160;is&#160;required&#160;of&#160;a&#160;Trusted&#160;Mobile&#160;Platform&#160;(TMP)&#160;if&#160;it&#160;is&#160;to&#160;facilitate&#160;a&#160;<br/>robust&#160;&#160;&#160;implementation&#160;&#160;&#160;of&#160;&#160;&#160;this&#160;&#160;&#160;mechanism.&#160;&#160;&#160;The&#160;&#160;numbered&#160;&#160;&#160;list&#160;&#160;&#160;of&#160;&#160;&#160;functional&#160;<br/>requirements&#160;&#160;&#160;accumulated&#160;&#160;&#160;is&#160;&#160;&#160;then&#160;&#160;&#160;utilised&#160;&#160;&#160;to&#160;&#160;&#160;determine&#160;&#160;the&#160;&#160;&#160;architectural&#160;<br/>components,&#160;based&#160;on&#160;the&#160;TCG&#160;mobile&#160;reference&#160;architecture&#160;[63],&#160;and&#160;the&#160;functions,&#160;<br/>as&#160;specified&#160;in&#160;the&#160;TCG&#160;MTM&#160;specification&#160;[64],&#160;which&#160;meet&#160;these&#160;requirements.</p>
<p style="position:absolute;top:332px;left:85px;white-space:nowrap" class="ft5916"><b>3.1&#160;Requirements&#160;for&#160;a&#160;Robust&#160;Implementation&#160;of&#160;the&#160;Secure&#160;Wallet</b></p>
<p style="position:absolute;top:360px;left:85px;white-space:nowrap" class="ft5915">Section&#160;3.1.1&#160;describes&#160;the&#160;process&#160;by&#160;which&#160;a&#160;secure&#160;wallet&#160;application&#160;is&#160;installed&#160;<br/>on&#160;&#160;&#160;a&#160;&#160;&#160;device.&#160;&#160;&#160;This&#160;&#160;&#160;process&#160;&#160;&#160;is&#160;&#160;&#160;analysed&#160;&#160;&#160;in&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;&#160;&#160;extract&#160;&#160;&#160;any&#160;&#160;&#160;threats&#160;&#160;&#160;which&#160;&#160;&#160;may&#160;<br/>impact&#160;upon&#160;the&#160;device&#160;if&#160;the&#160;secure&#160;wallet&#160;application&#160;is&#160;not&#160;robustly&#160;implemented.&#160;<br/>Following&#160;this,&#160;the&#160;functionality&#160;required&#160;of&#160;a&#160;TMP&#160;in&#160;order&#160;to&#160;mitigate&#160;these&#160;threats&#160;<br/>is&#160;described.</p>
<p style="position:absolute;top:476px;left:85px;white-space:nowrap" class="ft5915">Section&#160;3.1.2&#160;examines&#160;the&#160;fundamental&#160;steps&#160;in&#160;each&#160;of&#160;the&#160;protocols&#160;defined&#160;within&#160;<br/>the&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;&#160;&#160;suite&#160;&#160;&#160;described&#160;&#160;&#160;in&#160;&#160;&#160;section&#160;&#160;&#160;2.4.&#160;&#160;&#160;Following&#160;&#160;&#160;each&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;protocol&#160;<br/>descriptions,&#160;the&#160;threats&#160;which&#160;may&#160;impact&#160;upon&#160;the&#160;security&#160;of&#160;the&#160;protocols,&#160;if&#160;the&#160;<br/>secure&#160;wallet&#160;application&#160;is&#160;not&#160;robustly&#160;implemented,&#160;are&#160;highlighted.&#160;As&#160;above,&#160;the&#160;<br/>functionality&#160;required&#160;of&#160;a&#160;TMP&#160;in&#160;order&#160;to&#160;mitigate&#160;these&#160;threats&#160;is&#160;also&#160;described.</p>
<p style="position:absolute;top:591px;left:85px;white-space:nowrap" class="ft5915">Section&#160;3.1.3&#160;summarises&#160;the&#160;requirements&#160;extracted&#160;throughout&#160;sections&#160;3.1.1&#160;and&#160;<br/>3.1.2.</p>
<p style="position:absolute;top:647px;left:85px;white-space:nowrap" class="ft596"><b>3.1.1&#160;Secure&#160;Wallet&#160;Application&#160;Installation</b></p>
<p style="position:absolute;top:674px;left:85px;white-space:nowrap" class="ft5915">Before&#160;a&#160;secure&#160;wallet&#160;application&#160;can&#160;be&#160;executed&#160;by&#160;a&#160;mobile&#160;device&#160;user,&#160;it&#160;must&#160;<br/>be&#160;installed&#160;on&#160;the&#160;mobile&#160;device.&#160;The&#160;following&#160;step,&#160;described&#160;in&#160;table&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#59">&#160;2,</a>&#160;must&#160;be&#160;<br/>completed&#160;when&#160;installing&#160;a&#160;secure&#160;wallet&#160;application&#160;on&#160;a&#160;mobile&#160;device.&#160;</p>
<p style="position:absolute;top:751px;left:134px;white-space:nowrap" class="ft5954">Step&#160;</p>
<p style="position:absolute;top:751px;left:248px;white-space:nowrap" class="ft5954">Description&#160;</p>
<p style="position:absolute;top:768px;left:134px;white-space:nowrap" class="ft594">1&#160;</p>
<p style="position:absolute;top:768px;left:248px;white-space:nowrap" class="ft594">The&#160;secure&#160;wallet&#160;application&#160;code&#160;must&#160;be&#160;installed&#160;on&#160;the&#160;device.&#160;</p>
<p style="position:absolute;top:794px;left:254px;white-space:nowrap" class="ft593"><b>Table&#160;2:&#160;Secure&#160;wallet&#160;application&#160;installation</b></p>
<p style="position:absolute;top:820px;left:85px;white-space:nowrap" class="ft5915">Unless&#160;&#160;&#160;the&#160;&#160;&#160;device&#160;&#160;&#160;implementation&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;&#160;&#160;mechanism&#160;&#160;&#160;is&#160;&#160;&#160;robust,&#160;&#160;&#160;a&#160;<br/>number&#160;of&#160;threats&#160;may&#160;impact&#160;on&#160;the&#160;device.&#160;</p>
<p style="position:absolute;top:868px;left:112px;white-space:nowrap" class="ft5934">●</p>
<p style="position:absolute;top:859px;left:139px;white-space:nowrap" class="ft5915">Unauthorised&#160;modification&#160;of&#160;the&#160;secure&#160;wallet&#160;application&#160;code&#160;on&#160;installation&#160;<br/>into&#160;the&#160;device.</p>
<p style="position:absolute;top:906px;left:112px;white-space:nowrap" class="ft5934">●</p>
<p style="position:absolute;top:897px;left:139px;white-space:nowrap" class="ft5915">Unauthorised&#160;&#160;&#160;modification&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;&#160;&#160;application&#160;&#160;&#160;code&#160;&#160;&#160;while&#160;&#160;&#160;in&#160;<br/>storage&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:955px;left:85px;white-space:nowrap" class="ft5915">Using&#160;the&#160;list&#160;of&#160;threats&#160;outlined&#160;above,&#160;the&#160;following&#160;requirement&#160;can&#160;be&#160;derived&#160;for&#160;<br/>a&#160;TMP,&#160;if&#160;it&#160;is&#160;to&#160;facilitate&#160;the&#160;secure&#160;installation&#160;of&#160;a&#160;secure&#160;wallet&#160;application.</p>
<p style="position:absolute;top:993px;left:112px;white-space:nowrap" class="ft5914">1.&#160;The&#160;TMP&#160;SHALL&#160;provide&#160;a&#160;mechanism&#160;so&#160;that&#160;the&#160;secure&#160;wallet&#160;application&#160;</p>
<p style="position:absolute;top:1012px;left:139px;white-space:nowrap" class="ft5915">code&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;integrity-protected&#160;&#160;&#160;on&#160;&#160;&#160;installation&#160;&#160;&#160;into&#160;&#160;&#160;and&#160;&#160;&#160;in&#160;&#160;&#160;storage&#160;&#160;&#160;on&#160;&#160;&#160;the&#160;<br/>device.</p>
<p style="position:absolute;top:1069px;left:85px;white-space:nowrap" class="ft596"><b>3.1.2&#160;Secure&#160;Wallet&#160;Protocol&#160;Suite</b></p>
<p style="position:absolute;top:1095px;left:85px;white-space:nowrap" class="ft5914">The&#160;secure&#160;wallet&#160;mechanism&#160;has&#160;been&#160;defined&#160;as&#160;a&#160;set&#160;of&#160;six&#160;protocols&#160;</p>
<p style="position:absolute;top:1095px;left:689px;white-space:nowrap" class="ft5955">[47]</p>
<p style="position:absolute;top:1095px;left:723px;white-space:nowrap" class="ft5914">:</p>
<p style="position:absolute;top:1124px;left:112px;white-space:nowrap" class="ft5934">●</p>
<p style="position:absolute;top:1114px;left:139px;white-space:nowrap" class="ft5914">Starting&#160;the&#160;secure&#160;wallet;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft597">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft597">59/109</p>
</div>
<!-- Page 60 -->
<a name="60"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft6056{font-size:17px;font-family:Symbol;color:#000000;}
-->
</style>
<div id="page60-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application060.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft6012">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft600">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft604">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft604">Final</p>
<p style="position:absolute;top:160px;left:112px;white-space:nowrap" class="ft6034">●</p>
<p style="position:absolute;top:151px;left:139px;white-space:nowrap" class="ft6014">Setting&#160;a&#160;user&#160;passphrase;</p>
<p style="position:absolute;top:180px;left:112px;white-space:nowrap" class="ft6034">●</p>
<p style="position:absolute;top:170px;left:139px;white-space:nowrap" class="ft6014">Authenticating&#160;a&#160;user;</p>
<p style="position:absolute;top:199px;left:112px;white-space:nowrap" class="ft6034">●</p>
<p style="position:absolute;top:189px;left:139px;white-space:nowrap" class="ft6014">Changing&#160;a&#160;passphrase;</p>
<p style="position:absolute;top:218px;left:112px;white-space:nowrap" class="ft6034">●</p>
<p style="position:absolute;top:209px;left:139px;white-space:nowrap" class="ft6014">Storing&#160;sensitive&#160;data;&#160;and</p>
<p style="position:absolute;top:237px;left:112px;white-space:nowrap" class="ft6034">●</p>
<p style="position:absolute;top:228px;left:139px;white-space:nowrap" class="ft6014">Accessing&#160;secure&#160;storage&#160;(by&#160;an&#160;application).</p>
<p style="position:absolute;top:265px;left:85px;white-space:nowrap" class="ft606"><b>3.1.2.1&#160;Starting&#160;the&#160;Secure&#160;Wallet</b></p>
<p style="position:absolute;top:292px;left:85px;white-space:nowrap" class="ft6015">There&#160;are&#160;two&#160;possible&#160;ways&#160;by&#160;which&#160;a&#160;secure&#160;wallet&#160;application&#160;can&#160;be&#160;started,&#160;as&#160;<br/>shown&#160;in&#160;tables<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#60">&#160;3&#160;</a>and<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#60">&#160;4.</a></p>
<p style="position:absolute;top:349px;left:134px;white-space:nowrap" class="ft6054">Step&#160;</p>
<p style="position:absolute;top:349px;left:248px;white-space:nowrap" class="ft6054">Description&#160;</p>
<p style="position:absolute;top:367px;left:134px;white-space:nowrap" class="ft604">1&#160;</p>
<p style="position:absolute;top:367px;left:248px;white-space:nowrap" class="ft604">The&#160;user&#160;clicks&#160;on&#160;the&#160;secure&#160;wallet&#160;icon&#160;or&#160;menu&#160;item.&#160;</p>
<p style="position:absolute;top:384px;left:134px;white-space:nowrap" class="ft604">2</p>
<p style="position:absolute;top:384px;left:248px;white-space:nowrap" class="ft604">The&#160;secure&#160;wallet&#160;is&#160;started.</p>
<p style="position:absolute;top:411px;left:302px;white-space:nowrap" class="ft603"><b>Table&#160;3:&#160;Starting&#160;the&#160;secure&#160;wallet</b></p>
<p style="position:absolute;top:456px;left:134px;white-space:nowrap" class="ft6054">Step&#160;</p>
<p style="position:absolute;top:456px;left:248px;white-space:nowrap" class="ft6054">Description&#160;</p>
<p style="position:absolute;top:473px;left:134px;white-space:nowrap" class="ft604">1&#160;</p>
<p style="position:absolute;top:473px;left:248px;white-space:nowrap" class="ft604">The&#160;secure&#160;wallet&#160;is&#160;started&#160;automatically&#160;at&#160;system&#160;boot.&#160;</p>
<p style="position:absolute;top:500px;left:246px;white-space:nowrap" class="ft603"><b>Table&#160;4:&#160;Starting&#160;the&#160;secure&#160;wallet&#160;(alternative)</b></p>
<p style="position:absolute;top:545px;left:85px;white-space:nowrap" class="ft6015">Unless&#160;the&#160;implementation&#160;of&#160;the&#160;secure&#160;wallet&#160;mechanism&#160;is&#160;robust,&#160;the&#160;following&#160;<br/>threat&#160;may&#160;impact&#160;upon&#160;the&#160;device.</p>
<p style="position:absolute;top:583px;left:112px;white-space:nowrap" class="ft6056">•</p>
<p style="position:absolute;top:585px;left:139px;white-space:nowrap" class="ft6015">Unauthorised&#160;&#160;&#160;modification&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;&#160;&#160;application&#160;&#160;&#160;code&#160;&#160;&#160;while&#160;<br/>executing&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:642px;left:85px;white-space:nowrap" class="ft6015">Using&#160;the&#160;threat&#160;outlined&#160;above,&#160;the&#160;following&#160;additional&#160;requirement&#160;can&#160;be&#160;derived&#160;<br/>for&#160;&#160;&#160;a&#160;&#160;&#160;TMP,&#160;&#160;&#160;if&#160;&#160;&#160;it&#160;&#160;&#160;is&#160;&#160;&#160;to&#160;&#160;&#160;facilitate&#160;&#160;&#160;a&#160;&#160;&#160;robust&#160;&#160;&#160;implementation&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;<br/>mechanism.&#160;</p>
<p style="position:absolute;top:700px;left:112px;white-space:nowrap" class="ft6014">2.&#160;The&#160;TMP&#160;SHALL&#160;provide&#160;a&#160;mechanism&#160;so&#160;that&#160;the&#160;secure&#160;wallet&#160;application&#160;</p>
<p style="position:absolute;top:719px;left:139px;white-space:nowrap" class="ft6014">code&#160;can&#160;be&#160;integrity-protected&#160;while&#160;executing&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:756px;left:85px;white-space:nowrap" class="ft606"><b>3.1.2.2&#160;Setting&#160;a&#160;User&#160;Passphrase</b></p>
<p style="position:absolute;top:783px;left:85px;white-space:nowrap" class="ft6015">Once&#160;&#160;a&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;&#160;&#160;application&#160;&#160;&#160;has&#160;&#160;been&#160;&#160;&#160;installed,&#160;&#160;&#160;a&#160;&#160;user&#160;&#160;&#160;can&#160;&#160;set&#160;&#160;&#160;a&#160;&#160;passphrase&#160;<br/>which&#160;is&#160;used&#160;by&#160;the&#160;secure&#160;wallet&#160;application&#160;to&#160;authenticate&#160;him/her.</p>
<p style="position:absolute;top:841px;left:134px;white-space:nowrap" class="ft6054">Step&#160;</p>
<p style="position:absolute;top:841px;left:248px;white-space:nowrap" class="ft6054">Description&#160;</p>
<p style="position:absolute;top:858px;left:134px;white-space:nowrap" class="ft604">1&#160;</p>
<p style="position:absolute;top:858px;left:248px;white-space:nowrap" class="ft604">The&#160;user&#160;selects&#160;“passphrase”.</p>
<p style="position:absolute;top:876px;left:134px;white-space:nowrap" class="ft604">2</p>
<p style="position:absolute;top:876px;left:248px;white-space:nowrap" class="ft604">The&#160;secure&#160;wallet&#160;asks&#160;the&#160;user&#160;for&#160;a&#160;new&#160;passphrase.</p>
<p style="position:absolute;top:893px;left:134px;white-space:nowrap" class="ft604">3</p>
<p style="position:absolute;top:893px;left:248px;white-space:nowrap" class="ft604">The&#160;user&#160;enters&#160;his&#160;new&#160;passphrase&#160;twice.</p>
<p style="position:absolute;top:920px;left:134px;white-space:nowrap" class="ft604">4</p>
<p style="position:absolute;top:911px;left:248px;white-space:nowrap" class="ft6010">The&#160;secure&#160;wallet&#160;stores&#160;the&#160;passphrase&#160;if&#160;both&#160;passphrases&#160;are&#160;<br/>identical.</p>
<p style="position:absolute;top:955px;left:314px;white-space:nowrap" class="ft606"><b>T</b></p>
<p style="position:absolute;top:954px;left:324px;white-space:nowrap" class="ft603"><b>able&#160;5:&#160;Selecting&#160;a&#160;passphrase</b></p>
<p style="position:absolute;top:1000px;left:134px;white-space:nowrap" class="ft6054">Step&#160;</p>
<p style="position:absolute;top:1000px;left:248px;white-space:nowrap" class="ft6054">Description&#160;</p>
<p style="position:absolute;top:1017px;left:134px;white-space:nowrap" class="ft604">1&#160;</p>
<p style="position:absolute;top:1017px;left:248px;white-space:nowrap" class="ft604">The&#160;user&#160;selects&#160;“passphrase”.</p>
<p style="position:absolute;top:1035px;left:134px;white-space:nowrap" class="ft604">2</p>
<p style="position:absolute;top:1035px;left:248px;white-space:nowrap" class="ft604">The&#160;secure&#160;wallet&#160;asks&#160;the&#160;user&#160;for&#160;a&#160;new&#160;passphrase.</p>
<p style="position:absolute;top:1053px;left:134px;white-space:nowrap" class="ft604">3</p>
<p style="position:absolute;top:1053px;left:248px;white-space:nowrap" class="ft604">The&#160;user&#160;enters&#160;his&#160;new&#160;passphrase&#160;twice.</p>
<p style="position:absolute;top:1079px;left:134px;white-space:nowrap" class="ft604">4</p>
<p style="position:absolute;top:1070px;left:248px;white-space:nowrap" class="ft6010">The&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;&#160;&#160;does&#160;&#160;&#160;not&#160;&#160;&#160;store&#160;&#160;&#160;the&#160;&#160;&#160;passphrase&#160;&#160;&#160;if&#160;&#160;&#160;both&#160;<br/>passphrases&#160;are&#160;different.</p>
<p style="position:absolute;top:1114px;left:314px;white-space:nowrap" class="ft603"><b>Table&#160;6:&#160;Selecting&#160;a&#160;passphrase</b></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft607">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft607">60/109</p>
</div>
<!-- Page 61 -->
<a name="61"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page61-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application061.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft6112">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft610">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft614">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft614">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft6115">Unless&#160;the&#160;implementation&#160;of&#160;the&#160;secure&#160;wallet&#160;mechanism&#160;is&#160;robust,&#160;the&#160;following&#160;<br/>additional&#160;threats&#160;may&#160;impact&#160;upon&#160;the&#160;device.</p>
<p style="position:absolute;top:199px;left:112px;white-space:nowrap" class="ft6134">●</p>
<p style="position:absolute;top:189px;left:139px;white-space:nowrap" class="ft6115">Unauthorised&#160;reading/copying&#160;of&#160;the&#160;passphrase&#160;on&#160;installation/input&#160;into&#160;the&#160;<br/>device.</p>
<p style="position:absolute;top:237px;left:112px;white-space:nowrap" class="ft6134">●</p>
<p style="position:absolute;top:228px;left:139px;white-space:nowrap" class="ft6115">Unauthorised&#160;&#160;&#160;modification&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;passphrase&#160;&#160;&#160;on&#160;&#160;&#160;installation/input&#160;&#160;&#160;into&#160;&#160;&#160;the&#160;<br/>device.</p>
<p style="position:absolute;top:276px;left:112px;white-space:nowrap" class="ft6134">●</p>
<p style="position:absolute;top:266px;left:139px;white-space:nowrap" class="ft6115">Unauthorised&#160;&#160;&#160;reading/copying&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;passphrase&#160;&#160;&#160;while&#160;&#160;&#160;in&#160;&#160;&#160;storage&#160;&#160;&#160;on&#160;&#160;&#160;the&#160;<br/>device.</p>
<p style="position:absolute;top:314px;left:112px;white-space:nowrap" class="ft6134">●</p>
<p style="position:absolute;top:305px;left:139px;white-space:nowrap" class="ft6114">Unauthorised&#160;modification&#160;of&#160;the&#160;passphrase&#160;while&#160;in&#160;storage&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:343px;left:85px;white-space:nowrap" class="ft6115">Using&#160;the&#160;list&#160;of&#160;threats&#160;outlined&#160;above,&#160;the&#160;following&#160;additional&#160;requirements&#160;can&#160;be&#160;<br/>derived&#160;for&#160;a&#160;TMP,&#160;if&#160;it&#160;is&#160;to&#160;facilitate&#160;a&#160;robust&#160;implementation&#160;of&#160;the&#160;secure&#160;wallet&#160;<br/>mechanism.&#160;</p>
<p style="position:absolute;top:401px;left:112px;white-space:nowrap" class="ft6114">3.&#160;The&#160;&#160;&#160;TMP&#160;&#160;&#160;SHALL&#160;&#160;&#160;provide&#160;&#160;&#160;a&#160;&#160;&#160;mechanism&#160;&#160;&#160;so&#160;&#160;&#160;that&#160;&#160;&#160;a&#160;&#160;&#160;passphrase&#160;&#160;can&#160;&#160;&#160;be&#160;</p>
<p style="position:absolute;top:420px;left:139px;white-space:nowrap" class="ft6114">confidentiality-protected&#160;during&#160;its&#160;installation/input.</p>
<p style="position:absolute;top:439px;left:112px;white-space:nowrap" class="ft6114">4.&#160;The&#160;TMP&#160;SHALL&#160;provide&#160;a&#160;mechanism&#160;so&#160;that&#160;a&#160;passphrase&#160;&#160;can&#160;be&#160;integrity-</p>
<p style="position:absolute;top:458px;left:139px;white-space:nowrap" class="ft6114">protected&#160;during&#160;its&#160;installation/input.</p>
<p style="position:absolute;top:477px;left:112px;white-space:nowrap" class="ft6114">5.&#160;The&#160;TMP&#160;SHALL&#160;provide&#160;an&#160;access&#160;control&#160;mechanism&#160;so&#160;that&#160;a&#160;passphrase&#160;</p>
<p style="position:absolute;top:497px;left:139px;white-space:nowrap" class="ft6114">can&#160;only&#160;be&#160;accessed&#160;by&#160;authorised&#160;entities.</p>
<p style="position:absolute;top:516px;left:112px;white-space:nowrap" class="ft6114">6.&#160;The&#160;&#160;&#160;TMP&#160;&#160;&#160;SHALL&#160;&#160;&#160;provide&#160;&#160;&#160;a&#160;&#160;&#160;mechanism&#160;&#160;&#160;so&#160;&#160;&#160;that&#160;&#160;&#160;a&#160;&#160;&#160;passphrase&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;</p>
<p style="position:absolute;top:535px;left:139px;white-space:nowrap" class="ft6114">confidentiality-protected&#160;while&#160;in&#160;storage&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:554px;left:112px;white-space:nowrap" class="ft6114">7.&#160;The&#160;TMP&#160;SHALL&#160;provide&#160;a&#160;mechanism&#160;so&#160;that&#160;a&#160;passphrase&#160;can&#160;be&#160;integrity-</p>
<p style="position:absolute;top:573px;left:139px;white-space:nowrap" class="ft6114">protected&#160;while&#160;in&#160;storage&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:611px;left:85px;white-space:nowrap" class="ft616"><b>3.1.2.3&#160;Authenticating&#160;a&#160;User</b></p>
<p style="position:absolute;top:637px;left:85px;white-space:nowrap" class="ft6115">The&#160;passphrase&#160;set&#160;by&#160;the&#160;user,&#160;as&#160;described&#160;in&#160;section&#160;3.1.2.2,&#160;is&#160;subsequently&#160;used&#160;<br/>by&#160;the&#160;secure&#160;wallet&#160;application&#160;in&#160;order&#160;to&#160;authenticate&#160;a&#160;user&#160;attempting&#160;to&#160;gain&#160;<br/>access&#160;as&#160;described&#160;in&#160;tables<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#61">&#160;7&#160;</a>and<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#61">&#160;8.</a></p>
<p style="position:absolute;top:714px;left:134px;white-space:nowrap" class="ft6154">Step&#160;</p>
<p style="position:absolute;top:714px;left:248px;white-space:nowrap" class="ft6154">Description</p>
<p style="position:absolute;top:732px;left:134px;white-space:nowrap" class="ft614">1&#160;</p>
<p style="position:absolute;top:732px;left:248px;white-space:nowrap" class="ft614">The&#160;system&#160;asks&#160;the&#160;user&#160;to&#160;authenticate&#160;him/herself.&#160;</p>
<p style="position:absolute;top:749px;left:134px;white-space:nowrap" class="ft614">2</p>
<p style="position:absolute;top:749px;left:248px;white-space:nowrap" class="ft614">The&#160;user&#160;enters&#160;a&#160;passphrase.</p>
<p style="position:absolute;top:776px;left:134px;white-space:nowrap" class="ft614">3</p>
<p style="position:absolute;top:767px;left:248px;white-space:nowrap" class="ft6110">The&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;&#160;&#160;compares&#160;&#160;&#160;the&#160;&#160;&#160;passphrase&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;stored&#160;<br/>passphrase.</p>
<p style="position:absolute;top:802px;left:134px;white-space:nowrap" class="ft614">4</p>
<p style="position:absolute;top:802px;left:248px;white-space:nowrap" class="ft614">The&#160;secure&#160;wallet&#160;grants&#160;the&#160;user&#160;access.</p>
<p style="position:absolute;top:828px;left:319px;white-space:nowrap" class="ft613"><b>Table&#160;7:&#160;Authenticating&#160;a&#160;user</b></p>
<p style="position:absolute;top:873px;left:134px;white-space:nowrap" class="ft6154">Step&#160;</p>
<p style="position:absolute;top:873px;left:248px;white-space:nowrap" class="ft6154">Description</p>
<p style="position:absolute;top:891px;left:134px;white-space:nowrap" class="ft614">1&#160;</p>
<p style="position:absolute;top:891px;left:248px;white-space:nowrap" class="ft614">The&#160;system&#160;asks&#160;the&#160;user&#160;to&#160;authenticate&#160;himself.&#160;</p>
<p style="position:absolute;top:909px;left:134px;white-space:nowrap" class="ft614">2</p>
<p style="position:absolute;top:909px;left:248px;white-space:nowrap" class="ft614">The&#160;user&#160;enters&#160;a&#160;passphrase.</p>
<p style="position:absolute;top:935px;left:134px;white-space:nowrap" class="ft614">3</p>
<p style="position:absolute;top:926px;left:248px;white-space:nowrap" class="ft6110">The&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;&#160;&#160;compares&#160;&#160;&#160;the&#160;&#160;&#160;passphrase&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;stored&#160;<br/>passphrase.</p>
<p style="position:absolute;top:961px;left:134px;white-space:nowrap" class="ft614">4</p>
<p style="position:absolute;top:961px;left:248px;white-space:nowrap" class="ft614">The&#160;secure&#160;wallet&#160;denies&#160;the&#160;user&#160;access.</p>
<p style="position:absolute;top:987px;left:264px;white-space:nowrap" class="ft613"><b>Table&#160;8:&#160;Authenticating&#160;a&#160;user&#160;(alternative)</b></p>
<p style="position:absolute;top:1013px;left:85px;white-space:nowrap" class="ft6114">This&#160;protocol&#160;does&#160;not&#160;introduce&#160;any&#160;additional&#160;threats.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft617">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft617">61/109</p>
</div>
<!-- Page 62 -->
<a name="62"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page62-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application062.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft6212">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft620">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft624">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft624">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft626"><b>3.1.2.4&#160;Changing&#160;a&#160;Passphrase</b></p>
<p style="position:absolute;top:178px;left:85px;white-space:nowrap" class="ft6214">A&#160;user&#160;passphrase&#160;may&#160;be&#160;changed&#160;using&#160;the&#160;processes&#160;described&#160;in&#160;tables<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#62">&#160;9&#160;</a>and<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#62">&#160;10.</a></p>
<p style="position:absolute;top:197px;left:85px;white-space:nowrap" class="ft627">&#160;</p>
<p style="position:absolute;top:214px;left:134px;white-space:nowrap" class="ft6254">Step&#160;</p>
<p style="position:absolute;top:214px;left:248px;white-space:nowrap" class="ft6254">Description&#160;</p>
<p style="position:absolute;top:232px;left:134px;white-space:nowrap" class="ft624">1&#160;</p>
<p style="position:absolute;top:232px;left:248px;white-space:nowrap" class="ft624">The&#160;user&#160;selects&#160;“change&#160;passphrase”.&#160;</p>
<p style="position:absolute;top:249px;left:134px;white-space:nowrap" class="ft624">2</p>
<p style="position:absolute;top:249px;left:248px;white-space:nowrap" class="ft624">The&#160;secure&#160;wallet&#160;asks&#160;for&#160;a&#160;new&#160;passphrase.</p>
<p style="position:absolute;top:267px;left:134px;white-space:nowrap" class="ft624">3</p>
<p style="position:absolute;top:267px;left:248px;white-space:nowrap" class="ft624">The&#160;user&#160;enters&#160;his&#160;new&#160;passphrase&#160;twice.</p>
<p style="position:absolute;top:293px;left:134px;white-space:nowrap" class="ft624">4</p>
<p style="position:absolute;top:285px;left:248px;white-space:nowrap" class="ft6210">The&#160;secure&#160;wallet&#160;updates&#160;the&#160;passphrase&#160;if&#160;both&#160;passphrases&#160;are&#160;<br/>identical.</p>
<p style="position:absolute;top:328px;left:313px;white-space:nowrap" class="ft623"><b>Table&#160;9:&#160;Changing&#160;a&#160;passphrase</b></p>
<p style="position:absolute;top:374px;left:134px;white-space:nowrap" class="ft6254">Step&#160;</p>
<p style="position:absolute;top:374px;left:248px;white-space:nowrap" class="ft6254">Description&#160;</p>
<p style="position:absolute;top:391px;left:134px;white-space:nowrap" class="ft624">1&#160;</p>
<p style="position:absolute;top:391px;left:248px;white-space:nowrap" class="ft624">The&#160;user&#160;selects&#160;“change&#160;passphrase”.&#160;</p>
<p style="position:absolute;top:409px;left:134px;white-space:nowrap" class="ft624">2</p>
<p style="position:absolute;top:409px;left:248px;white-space:nowrap" class="ft624">The&#160;secure&#160;wallet&#160;asks&#160;for&#160;a&#160;new&#160;passphrase.</p>
<p style="position:absolute;top:426px;left:134px;white-space:nowrap" class="ft624">3</p>
<p style="position:absolute;top:426px;left:248px;white-space:nowrap" class="ft624">The&#160;user&#160;enters&#160;his&#160;new&#160;passphrase&#160;twice.</p>
<p style="position:absolute;top:453px;left:134px;white-space:nowrap" class="ft624">4</p>
<p style="position:absolute;top:444px;left:248px;white-space:nowrap" class="ft6210">If&#160;&#160;&#160;both&#160;&#160;&#160;new&#160;&#160;&#160;passphrases&#160;&#160;&#160;are&#160;&#160;&#160;not&#160;&#160;&#160;identical&#160;&#160;&#160;the&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;<br/>displays&#160;an&#160;error&#160;message.</p>
<p style="position:absolute;top:488px;left:253px;white-space:nowrap" class="ft623"><b>Table&#160;10:&#160;Changing&#160;a&#160;passphrase&#160;(alternative)</b></p>
<p style="position:absolute;top:533px;left:85px;white-space:nowrap" class="ft6214">This&#160;protocol&#160;does&#160;not&#160;introduce&#160;any&#160;additional&#160;threats.</p>
<p style="position:absolute;top:570px;left:85px;white-space:nowrap" class="ft626"><b>3.1.2.5&#160;Storing&#160;Sensitive&#160;Data</b></p>
<p style="position:absolute;top:597px;left:85px;white-space:nowrap" class="ft6215">Tables&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#62">&#160;11&#160;&#160;</a>and&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#62">&#160;12&#160;&#160;</a>describe&#160;the&#160;process&#160;by&#160;which&#160;a&#160;user&#160;can&#160;store&#160;data&#160;(e.g.&#160;user&#160;<br/>credentials)&#160;using&#160;the&#160;secure&#160;wallet&#160;mechanism.</p>
<p style="position:absolute;top:654px;left:134px;white-space:nowrap" class="ft6254">Step&#160;</p>
<p style="position:absolute;top:654px;left:248px;white-space:nowrap" class="ft6254">Description&#160;</p>
<p style="position:absolute;top:672px;left:134px;white-space:nowrap" class="ft624">1&#160;</p>
<p style="position:absolute;top:672px;left:248px;white-space:nowrap" class="ft624">The&#160;user&#160;selects&#160;“enter&#160;secret&#160;data”.</p>
<p style="position:absolute;top:689px;left:134px;white-space:nowrap" class="ft624">2</p>
<p style="position:absolute;top:689px;left:248px;white-space:nowrap" class="ft624">The&#160;user&#160;enters&#160;the&#160;data.</p>
<p style="position:absolute;top:707px;left:134px;white-space:nowrap" class="ft624">3</p>
<p style="position:absolute;top:707px;left:248px;white-space:nowrap" class="ft624">The&#160;user&#160;presses&#160;“OK”&#160;to&#160;confirm&#160;data&#160;storage.</p>
<p style="position:absolute;top:725px;left:134px;white-space:nowrap" class="ft624">4</p>
<p style="position:absolute;top:725px;left:248px;white-space:nowrap" class="ft624">The&#160;secure&#160;wallet&#160;presents&#160;a&#160;list&#160;of&#160;applications.</p>
<p style="position:absolute;top:751px;left:134px;white-space:nowrap" class="ft624">5</p>
<p style="position:absolute;top:742px;left:248px;white-space:nowrap" class="ft6210">The&#160;user&#160;may&#160;select&#160;an&#160;application&#160;which&#160;may&#160;access&#160;the&#160;sensitive&#160;<br/>data,&#160;e.g.&#160;a&#160;particular&#160;browser.</p>
<p style="position:absolute;top:777px;left:134px;white-space:nowrap" class="ft624">6</p>
<p style="position:absolute;top:777px;left:248px;white-space:nowrap" class="ft624">The&#160;sensitive&#160;data&#160;is&#160;securely&#160;stored&#160;for&#160;the&#160;chosen&#160;application.</p>
<p style="position:absolute;top:803px;left:314px;white-space:nowrap" class="ft623"><b>Table&#160;11:&#160;Storing&#160;sensitive&#160;data</b></p>
<p style="position:absolute;top:849px;left:134px;white-space:nowrap" class="ft6254">Step&#160;</p>
<p style="position:absolute;top:849px;left:248px;white-space:nowrap" class="ft6254">Description&#160;</p>
<p style="position:absolute;top:866px;left:134px;white-space:nowrap" class="ft624">1&#160;</p>
<p style="position:absolute;top:866px;left:248px;white-space:nowrap" class="ft624">The&#160;user&#160;selects&#160;“enter&#160;secret&#160;data”.</p>
<p style="position:absolute;top:884px;left:134px;white-space:nowrap" class="ft624">2</p>
<p style="position:absolute;top:884px;left:248px;white-space:nowrap" class="ft624">The&#160;user&#160;enters&#160;the&#160;data.</p>
<p style="position:absolute;top:910px;left:134px;white-space:nowrap" class="ft624">3</p>
<p style="position:absolute;top:902px;left:248px;white-space:nowrap" class="ft6210">The&#160;&#160;user&#160;&#160;presses&#160;&#160;“cancel”&#160;&#160;to&#160;&#160;abort&#160;&#160;data&#160;&#160;storage&#160;&#160;and&#160;&#160;nothing&#160;&#160;is&#160;<br/>stored.</p>
<p style="position:absolute;top:945px;left:258px;white-space:nowrap" class="ft623"><b>Table&#160;12:&#160;Storing&#160;sensitive&#160;data&#160;(alternative)</b></p>
<p style="position:absolute;top:971px;left:85px;white-space:nowrap" class="ft6215">Unless&#160;the&#160;implementation&#160;of&#160;the&#160;secure&#160;wallet&#160;mechanism&#160;is&#160;robust,&#160;the&#160;following&#160;<br/>additional&#160;threats&#160;may&#160;impact&#160;upon&#160;the&#160;device.</p>
<p style="position:absolute;top:1019px;left:112px;white-space:nowrap" class="ft6234">●</p>
<p style="position:absolute;top:1009px;left:139px;white-space:nowrap" class="ft6214">Unauthorised&#160;reading/copying&#160;of&#160;sensitive&#160;data&#160;on&#160;installation&#160;into&#160;the&#160;device.</p>
<p style="position:absolute;top:1038px;left:112px;white-space:nowrap" class="ft6234">●</p>
<p style="position:absolute;top:1029px;left:139px;white-space:nowrap" class="ft6214">Unauthorised&#160;modification&#160;of&#160;sensitive&#160;data&#160;on&#160;installation&#160;into&#160;the&#160;device.</p>
<p style="position:absolute;top:1057px;left:112px;white-space:nowrap" class="ft6234">●</p>
<p style="position:absolute;top:1048px;left:139px;white-space:nowrap" class="ft6214">Unauthorised&#160;reading/copying&#160;of&#160;sensitive&#160;data&#160;while&#160;in&#160;storage&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:1076px;left:112px;white-space:nowrap" class="ft6234">●</p>
<p style="position:absolute;top:1067px;left:139px;white-space:nowrap" class="ft6214">Unauthorised&#160;modification&#160;of&#160;sensitive&#160;data&#160;while&#160;in&#160;storage&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:1105px;left:85px;white-space:nowrap" class="ft6214">Using&#160;the&#160;list&#160;of&#160;threats&#160;outlined&#160;above,&#160;the&#160;following&#160;additional&#160;requirements&#160;can&#160;be&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft627">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft627">62/109</p>
</div>
<!-- Page 63 -->
<a name="63"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page63-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application063.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft6312">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft630">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft634">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft634">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft6315">derived&#160;for&#160;a&#160;trusted&#160;mobile&#160;platform,&#160;if&#160;it&#160;is&#160;to&#160;facilitate&#160;a&#160;robust&#160;implementation&#160;of&#160;<br/>the&#160;secure&#160;wallet&#160;mechanism.&#160;</p>
<p style="position:absolute;top:189px;left:112px;white-space:nowrap" class="ft6314">8.&#160;The&#160;&#160;&#160;TMP&#160;&#160;&#160;SHALL&#160;&#160;&#160;provide&#160;&#160;&#160;a&#160;&#160;&#160;mechanism&#160;&#160;&#160;so&#160;&#160;&#160;that&#160;&#160;&#160;sensitive&#160;&#160;&#160;data&#160;&#160;can&#160;&#160;&#160;be&#160;</p>
<p style="position:absolute;top:209px;left:139px;white-space:nowrap" class="ft6314">confidentiality-protected&#160;during&#160;its&#160;installation.</p>
<p style="position:absolute;top:228px;left:112px;white-space:nowrap" class="ft6314">9.&#160;The&#160;TMP&#160;SHALL&#160;provide&#160;a&#160;mechanism&#160;so&#160;that&#160;sensitive&#160;data&#160;can&#160;be&#160;integrity-</p>
<p style="position:absolute;top:247px;left:139px;white-space:nowrap" class="ft6314">protected&#160;during&#160;its&#160;installation.</p>
<p style="position:absolute;top:266px;left:112px;white-space:nowrap" class="ft6314">10.The&#160;TMP&#160;SHALL&#160;provide&#160;an&#160;access&#160;control&#160;mechanism&#160;so&#160;that&#160;sensitive&#160;data&#160;</p>
<p style="position:absolute;top:285px;left:139px;white-space:nowrap" class="ft6314">can&#160;only&#160;be&#160;accessed&#160;by&#160;authorised&#160;entities.</p>
<p style="position:absolute;top:305px;left:112px;white-space:nowrap" class="ft6314">11.The&#160;&#160;&#160;TMP&#160;&#160;&#160;SHALL&#160;&#160;&#160;provide&#160;&#160;&#160;a&#160;&#160;&#160;mechanism&#160;&#160;&#160;so&#160;&#160;&#160;that&#160;&#160;&#160;sensitive&#160;&#160;&#160;data&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;</p>
<p style="position:absolute;top:324px;left:139px;white-space:nowrap" class="ft6314">confidentiality-protected&#160;while&#160;in&#160;storage&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:343px;left:112px;white-space:nowrap" class="ft6314">12.The&#160;TMP&#160;SHALL&#160;provide&#160;a&#160;mechanism&#160;so&#160;that&#160;sensitive&#160;data&#160;can&#160;be&#160;integrity-</p>
<p style="position:absolute;top:362px;left:139px;white-space:nowrap" class="ft6314">protected&#160;while&#160;in&#160;storage&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:399px;left:85px;white-space:nowrap" class="ft636"><b>3.1.2.6&#160;Accessing&#160;Secure&#160;Storage</b></p>
<p style="position:absolute;top:426px;left:85px;white-space:nowrap" class="ft6315">Tables&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#63">&#160;13&#160;&#160;</a>and&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#63">&#160;14&#160;&#160;</a>describe&#160;&#160;&#160;how&#160;&#160;&#160;data&#160;&#160;&#160;may&#160;&#160;&#160;be&#160;&#160;&#160;accessed&#160;&#160;&#160;by&#160;&#160;&#160;an&#160;&#160;&#160;application.&#160;&#160;&#160;In&#160;&#160;&#160;the&#160;<br/>current&#160;wallet&#160;implementation&#160;(which&#160;targets&#160;web&#160;logins),&#160;an&#160;http&#160;proxy&#160;that&#160;handles&#160;<br/>the&#160;authentication&#160;(see&#160;Sec.&#160;2.4)&#160;is&#160;the&#160;only&#160;application&#160;using&#160;the&#160;wallet.&#160;</p>
<p style="position:absolute;top:501px;left:134px;white-space:nowrap" class="ft6354">Step&#160;</p>
<p style="position:absolute;top:501px;left:248px;white-space:nowrap" class="ft6354">Description&#160;</p>
<p style="position:absolute;top:519px;left:134px;white-space:nowrap" class="ft634">1&#160;</p>
<p style="position:absolute;top:519px;left:248px;white-space:nowrap" class="ft634">An&#160;end-user&#160;works&#160;with&#160;an&#160;application.&#160;</p>
<p style="position:absolute;top:545px;left:134px;white-space:nowrap" class="ft634">2</p>
<p style="position:absolute;top:536px;left:248px;white-space:nowrap" class="ft6310">The&#160;&#160;&#160;application&#160;&#160;&#160;requires&#160;&#160;&#160;sensitive&#160;&#160;&#160;data&#160;&#160;&#160;(for&#160;&#160;&#160;example,&#160;&#160;&#160;when&#160;<br/>connecting&#160;to&#160;a&#160;banking&#160;web&#160;server).</p>
<p style="position:absolute;top:572px;left:134px;white-space:nowrap" class="ft634">3</p>
<p style="position:absolute;top:572px;left:248px;white-space:nowrap" class="ft634">The&#160;application&#160;contacts&#160;the&#160;secure&#160;wallet.</p>
<p style="position:absolute;top:598px;left:134px;white-space:nowrap" class="ft634">4</p>
<p style="position:absolute;top:589px;left:248px;white-space:nowrap" class="ft6310">The&#160;secure&#160;wallet&#160;gives&#160;the&#160;&#160;&#160;&#160;application&#160;access&#160;&#160;to&#160;the&#160;&#160;sensitive&#160;<br/>data.</p>
<p style="position:absolute;top:624px;left:134px;white-space:nowrap" class="ft634">5</p>
<p style="position:absolute;top:624px;left:248px;white-space:nowrap" class="ft634">The&#160;application&#160;uses&#160;the&#160;sensitive&#160;data.</p>
<p style="position:absolute;top:650px;left:243px;white-space:nowrap" class="ft633"><b>Table&#160;13:&#160;Accessing&#160;secure&#160;storage&#160;(application)</b></p>
<p style="position:absolute;top:676px;left:134px;white-space:nowrap" class="ft6354">Step&#160;</p>
<p style="position:absolute;top:676px;left:248px;white-space:nowrap" class="ft6354">Description&#160;</p>
<p style="position:absolute;top:694px;left:134px;white-space:nowrap" class="ft634">1&#160;</p>
<p style="position:absolute;top:694px;left:248px;white-space:nowrap" class="ft634">The&#160;user&#160;works&#160;with&#160;an&#160;application.&#160;</p>
<p style="position:absolute;top:720px;left:134px;white-space:nowrap" class="ft634">2</p>
<p style="position:absolute;top:712px;left:248px;white-space:nowrap" class="ft634">The&#160;&#160;&#160;application&#160;&#160;&#160;requires&#160;&#160;&#160;sensitive&#160;&#160;&#160;data&#160;&#160;&#160;(for&#160;&#160;&#160;example&#160;&#160;&#160;when&#160;</p>
<p style="position:absolute;top:729px;left:248px;white-space:nowrap" class="ft634">connecting&#160;to&#160;a&#160;banking&#160;site).</p>
<p style="position:absolute;top:747px;left:134px;white-space:nowrap" class="ft634">3</p>
<p style="position:absolute;top:747px;left:248px;white-space:nowrap" class="ft634">The&#160;application&#160;contacts&#160;the&#160;secure&#160;wallet.</p>
<p style="position:absolute;top:773px;left:134px;white-space:nowrap" class="ft634">4</p>
<p style="position:absolute;top:764px;left:248px;white-space:nowrap" class="ft634">The&#160;secure&#160;wallet&#160;denies&#160;the&#160;application&#160;access&#160;to&#160;the&#160;sensitive&#160;</p>
<p style="position:absolute;top:782px;left:248px;white-space:nowrap" class="ft634">data.</p>
<p style="position:absolute;top:808px;left:190px;white-space:nowrap" class="ft633"><b>Table&#160;14:&#160;Accessing&#160;secure&#160;storage&#160;(application)(alternative)</b></p>
<p style="position:absolute;top:834px;left:85px;white-space:nowrap" class="ft6315">Unless&#160;the&#160;implementation&#160;of&#160;the&#160;secure&#160;wallet&#160;mechanism&#160;is&#160;robust,&#160;the&#160;following&#160;<br/>additional&#160;threats&#160;may&#160;impact&#160;upon&#160;the&#160;device.</p>
<p style="position:absolute;top:882px;left:112px;white-space:nowrap" class="ft6334">●</p>
<p style="position:absolute;top:872px;left:139px;white-space:nowrap" class="ft6314">Unauthorised&#160;reading/copying&#160;of&#160;the&#160;sensitive&#160;data&#160;while&#160;in&#160;use&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:901px;left:112px;white-space:nowrap" class="ft6334">●</p>
<p style="position:absolute;top:891px;left:139px;white-space:nowrap" class="ft6314">Unauthorised&#160;modification&#160;of&#160;the&#160;sensitive&#160;data&#160;while&#160;in&#160;use&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:930px;left:85px;white-space:nowrap" class="ft6315">Using&#160;the&#160;list&#160;of&#160;threats&#160;outlined&#160;above,&#160;the&#160;following&#160;additional&#160;requirements&#160;can&#160;be&#160;<br/>derived&#160;for&#160;a&#160;TMP,&#160;if&#160;it&#160;is&#160;to&#160;facilitate&#160;a&#160;robust&#160;implementation&#160;of&#160;the&#160;secure&#160;wallet&#160;<br/>mechanism.&#160;</p>
<p style="position:absolute;top:987px;left:112px;white-space:nowrap" class="ft6314">13.The&#160;&#160;&#160;TMP&#160;&#160;&#160;SHALL&#160;&#160;&#160;provide&#160;&#160;&#160;a&#160;&#160;&#160;mechanism&#160;&#160;&#160;so&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;sensitive&#160;&#160;&#160;data&#160;&#160;can&#160;&#160;&#160;be&#160;</p>
<p style="position:absolute;top:1007px;left:139px;white-space:nowrap" class="ft6314">confidentiality-protected&#160;while&#160;in&#160;use&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:1026px;left:112px;white-space:nowrap" class="ft6314">14.The&#160;&#160;&#160;TMP&#160;&#160;&#160;SHALL&#160;&#160;&#160;provide&#160;&#160;&#160;a&#160;&#160;&#160;mechanism&#160;&#160;&#160;so&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;sensitive&#160;&#160;&#160;data&#160;&#160;can&#160;&#160;&#160;be&#160;</p>
<p style="position:absolute;top:1045px;left:139px;white-space:nowrap" class="ft6314">integrity-protected&#160;while&#160;in&#160;use&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:1082px;left:85px;white-space:nowrap" class="ft636"><b>3.1.3&#160;Summary&#160;of&#160;Requirements</b></p>
<p style="position:absolute;top:1109px;left:85px;white-space:nowrap" class="ft6314">This&#160;section&#160;summarises&#160;the&#160;requirements&#160;from&#160;the&#160;secure&#160;wallet&#160;use-case.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft637">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft637">63/109</p>
</div>
<!-- Page 64 -->
<a name="64"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page64-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application064.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft6412">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft640">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft644">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft644">Final</p>
<p style="position:absolute;top:170px;left:85px;white-space:nowrap" class="ft6421"><b>SecureWallet1:</b></p>
<p style="position:absolute;top:171px;left:226px;white-space:nowrap" class="ft6414">&#160;&#160;The&#160;TMP&#160;SHALL&#160;&#160;provide&#160;&#160;a&#160;mechanism&#160;so&#160;that&#160;the&#160;secure&#160;wallet&#160;</p>
<p style="position:absolute;top:190px;left:85px;white-space:nowrap" class="ft6415">application&#160;code&#160;can&#160;be&#160;integrity-protected&#160;on&#160;installation&#160;into&#160;and&#160;in&#160;storage&#160;on&#160;the&#160;<br/>device.</p>
<p style="position:absolute;top:247px;left:85px;white-space:nowrap" class="ft6421"><b>SecureWallet2:&#160;&#160;</b></p>
<p style="position:absolute;top:247px;left:236px;white-space:nowrap" class="ft6414">The&#160;&#160;TMP&#160;SHALL&#160;provide&#160;a&#160;mechanism&#160;so&#160;that&#160;&#160;the&#160;secure&#160;wallet&#160;</p>
<p style="position:absolute;top:267px;left:85px;white-space:nowrap" class="ft6414">application&#160;code&#160;can&#160;be&#160;integrity-protected&#160;while&#160;executing&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:305px;left:85px;white-space:nowrap" class="ft6421"><b>SecureWallet3:&#160;</b></p>
<p style="position:absolute;top:305px;left:233px;white-space:nowrap" class="ft6414">The&#160;TMP&#160;SHALL&#160;provide&#160;a&#160;mechanism&#160;so&#160;that&#160;a&#160;passphrase&#160;can&#160;be&#160;</p>
<p style="position:absolute;top:325px;left:85px;white-space:nowrap" class="ft6414">confidentiality-protected&#160;during&#160;its&#160;installation/input.</p>
<p style="position:absolute;top:363px;left:85px;white-space:nowrap" class="ft6421"><b>SecureWallet4:&#160;</b></p>
<p style="position:absolute;top:363px;left:233px;white-space:nowrap" class="ft6414">The&#160;TMP&#160;SHALL&#160;provide&#160;a&#160;mechanism&#160;so&#160;that&#160;a&#160;passphrase&#160;can&#160;be&#160;</p>
<p style="position:absolute;top:382px;left:85px;white-space:nowrap" class="ft6414">integrity-protected&#160;during&#160;its&#160;installation/input.</p>
<p style="position:absolute;top:421px;left:85px;white-space:nowrap" class="ft6421"><b>SecureWallet5:&#160;&#160;</b></p>
<p style="position:absolute;top:421px;left:236px;white-space:nowrap" class="ft6414">The&#160;TMP&#160;SHALL&#160;provide&#160;an&#160;access&#160;control&#160;mechanism&#160;so&#160;that&#160;a&#160;</p>
<p style="position:absolute;top:440px;left:85px;white-space:nowrap" class="ft6414">passphrase&#160;can&#160;only&#160;be&#160;accessed&#160;by&#160;authorised&#160;entities.</p>
<p style="position:absolute;top:479px;left:85px;white-space:nowrap" class="ft6421"><b>SecureWallet6:&#160;</b></p>
<p style="position:absolute;top:479px;left:233px;white-space:nowrap" class="ft6414">The&#160;TMP&#160;SHALL&#160;provide&#160;a&#160;mechanism&#160;so&#160;that&#160;a&#160;passphrase&#160;can&#160;be&#160;</p>
<p style="position:absolute;top:498px;left:85px;white-space:nowrap" class="ft6414">confidentiality-protected&#160;while&#160;in&#160;storage&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:537px;left:85px;white-space:nowrap" class="ft6421"><b>SecureWallet7:&#160;</b></p>
<p style="position:absolute;top:537px;left:233px;white-space:nowrap" class="ft6414">The&#160;TMP&#160;SHALL&#160;provide&#160;a&#160;mechanism&#160;so&#160;that&#160;a&#160;passphrase&#160;can&#160;be&#160;</p>
<p style="position:absolute;top:556px;left:85px;white-space:nowrap" class="ft6414">integrity-protected&#160;while&#160;in&#160;storage&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:613px;left:85px;white-space:nowrap" class="ft6421"><b>SecureWallet8:&#160;</b></p>
<p style="position:absolute;top:614px;left:232px;white-space:nowrap" class="ft6414">The&#160;TMP&#160;SHALL&#160;provide&#160;a&#160;mechanism&#160;so&#160;that&#160;the&#160;sensitive&#160;data&#160;can&#160;</p>
<p style="position:absolute;top:633px;left:85px;white-space:nowrap" class="ft6414">be&#160;confidentiality-protected&#160;during&#160;its&#160;installation.</p>
<p style="position:absolute;top:672px;left:85px;white-space:nowrap" class="ft6421"><b>SecureWallet9:&#160;</b></p>
<p style="position:absolute;top:672px;left:232px;white-space:nowrap" class="ft6414">The&#160;TMP&#160;SHALL&#160;provide&#160;a&#160;mechanism&#160;so&#160;that&#160;the&#160;sensitive&#160;data&#160;can&#160;</p>
<p style="position:absolute;top:691px;left:85px;white-space:nowrap" class="ft6414">be&#160;integrity-protected&#160;during&#160;its&#160;installation.</p>
<p style="position:absolute;top:729px;left:85px;white-space:nowrap" class="ft6421"><b>SecureWallet10:&#160;</b></p>
<p style="position:absolute;top:729px;left:244px;white-space:nowrap" class="ft6414">The&#160;TMP&#160;SHALL&#160;provide&#160;an&#160;access&#160;control&#160;mechanism&#160;so&#160;that&#160;the&#160;</p>
<p style="position:absolute;top:749px;left:85px;white-space:nowrap" class="ft6414">sensitive&#160;data&#160;can&#160;only&#160;be&#160;accessed&#160;by&#160;authorised&#160;entities.</p>
<p style="position:absolute;top:787px;left:85px;white-space:nowrap" class="ft6421"><b>SecureWallet11:&#160;&#160;</b></p>
<p style="position:absolute;top:787px;left:246px;white-space:nowrap" class="ft6414">The&#160;TMP&#160;SHALL&#160;provide&#160;a&#160;mechanism&#160;so&#160;that&#160;sensitive&#160;data&#160;can&#160;</p>
<p style="position:absolute;top:807px;left:85px;white-space:nowrap" class="ft6414">be&#160;confidentiality-protected&#160;while&#160;in&#160;storage&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:845px;left:85px;white-space:nowrap" class="ft6421"><b>SecureWallet12:&#160;&#160;</b></p>
<p style="position:absolute;top:845px;left:246px;white-space:nowrap" class="ft6414">The&#160;TMP&#160;SHALL&#160;provide&#160;a&#160;mechanism&#160;so&#160;that&#160;sensitive&#160;data&#160;can&#160;</p>
<p style="position:absolute;top:864px;left:85px;white-space:nowrap" class="ft6414">be&#160;integrity-protected&#160;while&#160;in&#160;storage&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:903px;left:85px;white-space:nowrap" class="ft6421"><b>SecureWallet13:&#160;&#160;</b></p>
<p style="position:absolute;top:903px;left:246px;white-space:nowrap" class="ft6414">The&#160;TMP&#160;SHALL&#160;provide&#160;a&#160;mechanism&#160;so&#160;that&#160;sensitive&#160;data&#160;&#160;can&#160;</p>
<p style="position:absolute;top:922px;left:85px;white-space:nowrap" class="ft6414">be&#160;confidentiality-protected&#160;while&#160;in&#160;use&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:961px;left:85px;white-space:nowrap" class="ft6421"><b>SecureWallet14:&#160;&#160;</b></p>
<p style="position:absolute;top:961px;left:246px;white-space:nowrap" class="ft6414">The&#160;TMP&#160;SHALL&#160;provide&#160;a&#160;mechanism&#160;so&#160;that&#160;sensitive&#160;data&#160;can&#160;</p>
<p style="position:absolute;top:980px;left:85px;white-space:nowrap" class="ft6414">be&#160;integrity-protected&#160;while&#160;in&#160;use&#160;on&#160;the&#160;device.</p>
<p style="position:absolute;top:1017px;left:85px;white-space:nowrap" class="ft6416"><b>3.2&#160;Requirements&#160;Analysis</b></p>
<p style="position:absolute;top:1046px;left:85px;white-space:nowrap" class="ft6414">Requirements&#160;</p>
<p style="position:absolute;top:1045px;left:209px;white-space:nowrap" class="ft6421"><b>SecureWallet1</b></p>
<p style="position:absolute;top:1046px;left:344px;white-space:nowrap" class="ft6414">&#160;and&#160;</p>
<p style="position:absolute;top:1045px;left:389px;white-space:nowrap" class="ft6421"><b>SecureWallet2</b></p>
<p style="position:absolute;top:1046px;left:524px;white-space:nowrap" class="ft6414">&#160;&#160;&#160;necessitate&#160;that&#160;the&#160;integrity&#160;of&#160;</p>
<p style="position:absolute;top:1065px;left:85px;white-space:nowrap" class="ft6415">software&#160;(i.e.&#160;the&#160;secure&#160;wallet&#160;application)&#160;can&#160;be&#160;checked,&#160;and,&#160;that&#160;if&#160;unauthorised&#160;<br/>modification&#160;is&#160;detected,&#160;that&#160;appropriate&#160;action&#160;is&#160;taken.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft647">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft647">64/109</p>
</div>
<!-- Page 65 -->
<a name="65"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft6557{font-size:17px;font-family:LAAAAA+CourierNewPSMT;color:#000000;}
-->
</style>
<div id="page65-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application065.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft6512">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft650">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft654">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft654">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft6514">In&#160;order&#160;to&#160;meet&#160;requirement&#160;&#160;</p>
<p style="position:absolute;top:151px;left:350px;white-space:nowrap" class="ft6521"><b>SecureWallet1</b></p>
<p style="position:absolute;top:151px;left:485px;white-space:nowrap" class="ft6514">&#160;&#160;an&#160;authenticated&#160;boot&#160;mechanism&#160;in&#160;</p>
<p style="position:absolute;top:171px;left:85px;white-space:nowrap" class="ft6514">combination&#160;with&#160;a&#160;secure&#160;storage&#160;mechanism&#160;could&#160;be&#160;used.</p>
<p style="position:absolute;top:199px;left:112px;white-space:nowrap" class="ft6534">●</p>
<p style="position:absolute;top:190px;left:139px;white-space:nowrap" class="ft6515">An&#160;&#160;&#160;authenticated&#160;&#160;&#160;boot&#160;&#160;&#160;mechanism&#160;&#160;&#160;facilitates&#160;&#160;&#160;the&#160;&#160;&#160;reliable&#160;&#160;&#160;measurement&#160;&#160;&#160;and&#160;<br/>storage&#160;of&#160;the&#160;software&#160;state&#160;of&#160;a&#160;TMP;&#160;and</p>
<p style="position:absolute;top:237px;left:112px;white-space:nowrap" class="ft6534">●</p>
<p style="position:absolute;top:228px;left:139px;white-space:nowrap" class="ft6515">A&#160;secure&#160;storage&#160;mechanism&#160;ensures&#160;that&#160;security&#160;sensitive&#160;information,&#160;such&#160;<br/>as&#160;a&#160;user&#160;passphrase,&#160;cannot&#160;be&#160;accessed&#160;and/or&#160;utilised&#160;if&#160;a&#160;specified&#160;platform&#160;<br/>component,&#160;&#160;&#160;for&#160;&#160;&#160;example,&#160;&#160;&#160;the&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;&#160;&#160;code,&#160;&#160;&#160;has&#160;&#160;&#160;been&#160;&#160;&#160;modified&#160;&#160;&#160;in&#160;&#160;&#160;an&#160;<br/>unauthorised&#160;way.</p>
<p style="position:absolute;top:324px;left:85px;white-space:nowrap" class="ft6514">Alternatively,&#160;in&#160;order&#160;to&#160;meet&#160;requirements&#160;</p>
<p style="position:absolute;top:324px;left:472px;white-space:nowrap" class="ft6521"><b>SecureWallet1</b></p>
<p style="position:absolute;top:324px;left:607px;white-space:nowrap" class="ft6514">&#160;and&#160;</p>
<p style="position:absolute;top:324px;left:651px;white-space:nowrap" class="ft6521"><b>SecureWallet2</b></p>
<p style="position:absolute;top:324px;left:786px;white-space:nowrap" class="ft6514">,&#160;a&#160;</p>
<p style="position:absolute;top:343px;left:85px;white-space:nowrap" class="ft6515">secure&#160;&#160;&#160;boot&#160;&#160;&#160;mechanism&#160;&#160;&#160;could&#160;&#160;&#160;be&#160;&#160;&#160;deployed&#160;&#160;&#160;to&#160;&#160;&#160;ensure&#160;&#160;&#160;that&#160;&#160;&#160;only&#160;&#160;&#160;legitimate&#160;&#160;&#160;and&#160;<br/>authorised&#160;software&#160;can&#160;be&#160;loaded&#160;at&#160;boot&#160;time.&#160;Run-time&#160;integrity&#160;protection&#160;and/or&#160;<br/>verification&#160;&#160;&#160;mechanisms&#160;&#160;&#160;could&#160;&#160;&#160;then&#160;&#160;&#160;be&#160;&#160;&#160;used&#160;&#160;&#160;in&#160;&#160;&#160;conjunction&#160;&#160;&#160;with&#160;&#160;&#160;a&#160;&#160;&#160;secure&#160;&#160;&#160;boot&#160;<br/>mechanism&#160;&#160;&#160;in&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;&#160;&#160;ensure&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;software&#160;&#160;&#160;environment&#160;&#160;&#160;remains&#160;&#160;&#160;in&#160;&#160;&#160;a&#160;<br/>trustworthy&#160;state&#160;after&#160;boot.</p>
<p style="position:absolute;top:449px;left:112px;white-space:nowrap" class="ft6534">●</p>
<p style="position:absolute;top:439px;left:139px;white-space:nowrap" class="ft6515">A&#160;secure&#160;boot&#160;mechanism&#160;enables&#160;the&#160;reliable&#160;measurement&#160;and&#160;verification&#160;of&#160;<br/>a&#160;TMP's&#160;software&#160;state&#160;at&#160;start-up.&#160;Any&#160;unauthorised,&#160;yet&#160;successful,&#160;attempt&#160;<br/>to&#160;modify&#160;a&#160;protected&#160;software&#160;component&#160;should&#160;result&#160;in&#160;one&#160;of&#160;the&#160;following&#160;<br/>three&#160;scenarios&#160;[23]&#160;at&#160;boot&#160;time.</p>
<p style="position:absolute;top:526px;left:139px;white-space:nowrap" class="ft6534">○</p>
<p style="position:absolute;top:516px;left:166px;white-space:nowrap" class="ft6515">The&#160;&#160;&#160;system&#160;&#160;&#160;could&#160;&#160;&#160;continue&#160;&#160;&#160;booting&#160;&#160;&#160;as&#160;&#160;normal&#160;&#160;&#160;but&#160;&#160;&#160;issue&#160;&#160;&#160;a&#160;&#160;&#160;warning.&#160;&#160;&#160;This&#160;<br/>approach&#160;&#160;&#160;gives&#160;&#160;&#160;little&#160;&#160;&#160;protection&#160;&#160;&#160;against&#160;&#160;&#160;attack.&#160;&#160;&#160;Malicious&#160;&#160;&#160;or&#160;&#160;&#160;corrupted&#160;<br/>software&#160;components&#160;can&#160;still&#160;be&#160;executed.</p>
<p style="position:absolute;top:583px;left:139px;white-space:nowrap" class="ft6534">○</p>
<p style="position:absolute;top:574px;left:166px;white-space:nowrap" class="ft6515">The&#160;&#160;&#160;system&#160;&#160;&#160;could&#160;&#160;&#160;opt&#160;&#160;&#160;not&#160;&#160;&#160;to&#160;&#160;&#160;execute&#160;&#160;&#160;the&#160;&#160;&#160;component&#160;&#160;&#160;whose&#160;&#160;&#160;integrity&#160;&#160;&#160;is&#160;<br/>compromised.&#160;This,&#160;however,&#160;leaves&#160;the&#160;system&#160;open&#160;to&#160;denial&#160;of&#160;service&#160;<br/>attacks.</p>
<p style="position:absolute;top:641px;left:139px;white-space:nowrap" class="ft6534">○</p>
<p style="position:absolute;top:631px;left:166px;white-space:nowrap" class="ft6515">Finally,&#160;the&#160;system&#160;could&#160;attempt&#160;to&#160;recover&#160;and&#160;correct&#160;the&#160;inconsistency&#160;<br/>using&#160;a&#160;trusted&#160;source&#160;before&#160;executing&#160;or&#160;using&#160;the&#160;component.</p>
<p style="position:absolute;top:679px;left:112px;white-space:nowrap" class="ft6534">●</p>
<p style="position:absolute;top:670px;left:139px;white-space:nowrap" class="ft6515">A&#160;runtime&#160;integrity-checking&#160;mechanism&#160;facilitates&#160;the&#160;accurate&#160;measurement&#160;<br/>and&#160;&#160;&#160;verification&#160;&#160;&#160;a&#160;&#160;&#160;TMP's&#160;&#160;&#160;software&#160;&#160;&#160;state&#160;&#160;&#160;while&#160;&#160;&#160;it&#160;&#160;&#160;is&#160;&#160;&#160;in&#160;&#160;&#160;operation.&#160;&#160;&#160;Any&#160;<br/>unauthorised&#160;&#160;&#160;yet&#160;&#160;&#160;successful&#160;&#160;&#160;attempt&#160;&#160;&#160;to&#160;&#160;&#160;modify&#160;&#160;&#160;a&#160;&#160;&#160;protected&#160;&#160;&#160;software&#160;<br/>component,&#160;for&#160;example,&#160;the&#160;secure&#160;wallet&#160;application&#160;code,&#160;during&#160;runtime,&#160;<br/>should&#160;result&#160;in&#160;one&#160;of&#160;the&#160;following&#160;two&#160;scenarios.</p>
<p style="position:absolute;top:775px;left:139px;white-space:nowrap" class="ft6534">●</p>
<p style="position:absolute;top:766px;left:166px;white-space:nowrap" class="ft6515">The&#160;system&#160;could&#160;continue&#160;as&#160;normal&#160;but&#160;issue&#160;a&#160;warning.&#160;This&#160;approach,&#160;<br/>however,&#160;&#160;&#160;gives&#160;&#160;&#160;little&#160;&#160;&#160;protection&#160;&#160;&#160;against&#160;&#160;&#160;attack.&#160;&#160;&#160;Attacks&#160;&#160;&#160;may&#160;&#160;&#160;still&#160;&#160;&#160;be&#160;<br/>successfully&#160;&#160;&#160;executed&#160;&#160;&#160;against&#160;&#160;&#160;software&#160;&#160;&#160;components&#160;&#160;&#160;running&#160;&#160;&#160;on&#160;&#160;&#160;the&#160;<br/>platform.</p>
<p style="position:absolute;top:852px;left:139px;white-space:nowrap" class="ft6534">●</p>
<p style="position:absolute;top:843px;left:166px;white-space:nowrap" class="ft6515">The&#160;&#160;&#160;system&#160;&#160;&#160;could&#160;&#160;&#160;make&#160;&#160;&#160;the&#160;&#160;&#160;majority&#160;&#160;&#160;of&#160;&#160;&#160;its&#160;&#160;&#160;services&#160;&#160;&#160;unavailable&#160;&#160;&#160;if&#160;&#160;&#160;the&#160;<br/>integrity&#160;of&#160;a&#160;software&#160;component&#160;is&#160;compromised.&#160;The&#160;platform&#160;would&#160;then&#160;<br/>have&#160;to&#160;be&#160;rebooted&#160;in&#160;order&#160;to&#160;transition&#160;back&#160;into&#160;a&#160;trusted&#160;state.&#160;This,&#160;<br/>however,&#160;leaves&#160;the&#160;system&#160;open&#160;to&#160;denial&#160;of&#160;service&#160;attacks.</p>
<p style="position:absolute;top:929px;left:112px;white-space:nowrap" class="ft6534">●</p>
<p style="position:absolute;top:919px;left:139px;white-space:nowrap" class="ft6515">Alternatively,&#160;a&#160;mechanism,&#160;such&#160;as&#160;software&#160;isolation,&#160;which&#160;aims&#160;to&#160;prevent&#160;<br/>an&#160;attack&#160;impacting&#160;the&#160;runtime&#160;integrity&#160;of&#160;the&#160;platform&#160;could&#160;be&#160;adopted.</p>
<p style="position:absolute;top:977px;left:85px;white-space:nowrap" class="ft6514">Requirements&#160;</p>
<p style="position:absolute;top:977px;left:208px;white-space:nowrap" class="ft6521"><b>SecureWallet3</b></p>
<p style="position:absolute;top:977px;left:343px;white-space:nowrap" class="ft6514">&#160;to&#160;</p>
<p style="position:absolute;top:977px;left:370px;white-space:nowrap" class="ft6521"><b>SecureWallet14</b></p>
<p style="position:absolute;top:977px;left:516px;white-space:nowrap" class="ft6514">&#160;can&#160;be&#160;summarised&#160;as&#160;follows.</p>
<p style="position:absolute;top:1006px;left:112px;white-space:nowrap" class="ft6534">●</p>
<p style="position:absolute;top:997px;left:139px;white-space:nowrap" class="ft6515">A&#160;mechanism&#160;is&#160;required&#160;so&#160;that&#160;data&#160;may&#160;be&#160;input&#160;into&#160;the&#160;TMP,&#160;where&#160;either&#160;<br/>its:&#160;</p>
<p style="position:absolute;top:1037px;left:166px;white-space:nowrap" class="ft6557">o</p>
<p style="position:absolute;top:1035px;left:193px;white-space:nowrap" class="ft6514">Integrity;&#160;or</p>
<p style="position:absolute;top:1057px;left:166px;white-space:nowrap" class="ft6557">o</p>
<p style="position:absolute;top:1055px;left:193px;white-space:nowrap" class="ft6525">Integrity&#160;&#160;&#160;and&#160;&#160;&#160;confidentiality&#160;&#160;&#160;must&#160;&#160;&#160;be&#160;&#160;&#160;protected&#160;&#160;&#160;(i.e.&#160;&#160;&#160;a&#160;&#160;&#160;trusted&#160;&#160;&#160;path&#160;&#160;&#160;is&#160;<br/>required).</p>
<p style="position:absolute;top:1095px;left:112px;white-space:nowrap" class="ft6556">•</p>
<p style="position:absolute;top:1096px;left:139px;white-space:nowrap" class="ft6515">A&#160;mechanism&#160;is&#160;required&#160;so&#160;that&#160;data&#160;stored&#160;on&#160;the&#160;TMP&#160;is&#160;protected&#160;with&#160;<br/>respect&#160;to&#160;its:&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft657">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft657">65/109</p>
</div>
<!-- Page 66 -->
<a name="66"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page66-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application066.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft6612">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft660">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft664">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft664">Final</p>
<p style="position:absolute;top:153px;left:166px;white-space:nowrap" class="ft6657">o</p>
<p style="position:absolute;top:151px;left:193px;white-space:nowrap" class="ft6614">Integrity;&#160;or</p>
<p style="position:absolute;top:173px;left:166px;white-space:nowrap" class="ft6657">o</p>
<p style="position:absolute;top:171px;left:193px;white-space:nowrap" class="ft6614">Integrity&#160;and&#160;confidentiality.</p>
<p style="position:absolute;top:192px;left:112px;white-space:nowrap" class="ft6656">•</p>
<p style="position:absolute;top:193px;left:139px;white-space:nowrap" class="ft6615">A&#160;mechanism&#160;is&#160;required&#160;so&#160;that&#160;confidentiality&#160;and&#160;integrity-protected&#160;data&#160;<br/>can&#160;&#160;&#160;only&#160;&#160;&#160;be&#160;&#160;&#160;accessed&#160;&#160;&#160;by&#160;&#160;&#160;authorised&#160;&#160;&#160;entities,&#160;&#160;&#160;for&#160;&#160;&#160;example&#160;&#160;&#160;the&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;<br/>mechanism&#160;running&#160;as&#160;expected.</p>
<p style="position:absolute;top:250px;left:112px;white-space:nowrap" class="ft6656">•</p>
<p style="position:absolute;top:252px;left:139px;white-space:nowrap" class="ft6615">A&#160;mechanism&#160;is&#160;required&#160;so&#160;that&#160;data&#160;in&#160;use&#160;on&#160;the&#160;TMP&#160;is&#160;protected&#160;with&#160;<br/>respect&#160;to&#160;its:&#160;</p>
<p style="position:absolute;top:292px;left:166px;white-space:nowrap" class="ft6657">o</p>
<p style="position:absolute;top:290px;left:193px;white-space:nowrap" class="ft6614">Integrity;&#160;or</p>
<p style="position:absolute;top:312px;left:166px;white-space:nowrap" class="ft6657">o</p>
<p style="position:absolute;top:310px;left:193px;white-space:nowrap" class="ft6614">Integrity&#160;and&#160;confidentiality.</p>
<p style="position:absolute;top:350px;left:85px;white-space:nowrap" class="ft6615">Protected&#160;storage&#160;functionality,&#160;which&#160;enables&#160;data&#160;to&#160;be&#160;protected&#160;on&#160;input&#160;into,&#160;<br/>while&#160;in&#160;storage&#160;on&#160;and&#160;while&#160;in&#160;use&#160;on&#160;a&#160;device&#160;is&#160;necessary&#160;so&#160;that&#160;requirements&#160;</p>
<p style="position:absolute;top:388px;left:85px;white-space:nowrap" class="ft6621"><b>SecureWallet3</b></p>
<p style="position:absolute;top:388px;left:220px;white-space:nowrap" class="ft6614">&#160;to&#160;</p>
<p style="position:absolute;top:388px;left:247px;white-space:nowrap" class="ft6621"><b>SecureWallet14</b></p>
<p style="position:absolute;top:388px;left:394px;white-space:nowrap" class="ft6614">&#160;can&#160;be&#160;met.</p>
<p style="position:absolute;top:426px;left:85px;white-space:nowrap" class="ft6616"><b>3.3&#160;TCG&#160;Mappings</b></p>
<p style="position:absolute;top:454px;left:85px;white-space:nowrap" class="ft6615">In&#160;this&#160;section&#160;we&#160;consider&#160;whether&#160;and&#160;how&#160;the&#160;functional&#160;requirements&#160;summarised&#160;<br/>in&#160;section&#160;3.1.3&#160;can&#160;be&#160;met&#160;assuming&#160;a&#160;TMP&#160;as&#160;defined&#160;by&#160;the&#160;TCG&#160;Mobile&#160;Phone&#160;<br/>Working&#160;Group&#160;(MPWG)&#160;in&#160;[63]&#160;and&#160;[64]&#160;which&#160;also&#160;incorporates&#160;an&#160;isolation&#160;layer&#160;<br/>(namely,&#160;an&#160;L4&#160;microkernel).</p>
<p style="position:absolute;top:550px;left:85px;white-space:nowrap" class="ft6615">In&#160;section&#160;3.3.1&#160;the&#160;model&#160;defined&#160;in&#160;section&#160;2.4.2&#160;is&#160;re-examined&#160;and&#160;modified&#160;to&#160;<br/>support&#160;a&#160;TMP.&#160;This&#160;section&#160;also&#160;describes&#160;the&#160;properties&#160;of&#160;a&#160;TMP,&#160;as&#160;defined&#160;in&#160;the&#160;<br/>previous&#160;&#160;paragraph,&#160;&#160;and&#160;&#160;assumed&#160;for&#160;the&#160;&#160;remainder&#160;&#160;of&#160;this&#160;&#160;section.&#160;Section&#160;3.3.2&#160;<br/>explores&#160;the&#160;fundamental&#160;command&#160;runs&#160;which&#160;need&#160;to&#160;be&#160;completed&#160;on&#160;any&#160;TCG&#160;<br/>compliant&#160;MTM&#160;before&#160;its&#160;security&#160;mechanisms&#160;can&#160;be&#160;utilised.&#160;Sections&#160;3.3.3&#160;and&#160;<br/>3.3.4&#160;examine&#160;authenticated&#160;and&#160;secure&#160;boot&#160;mechanisms.&#160;Section&#160;3.3.5&#160;examines&#160;<br/>runtime&#160;integrity&#160;protection&#160;and&#160;verification&#160;mechanisms.&#160;Section&#160;3.3.6&#160;shows&#160;how&#160;<br/>secure&#160;&#160;storage&#160;&#160;can&#160;&#160;be&#160;&#160;&#160;provided.&#160;&#160;Section&#160;&#160;&#160;3.3.7&#160;&#160;&#160;describes&#160;&#160;the&#160;&#160;process&#160;&#160;by&#160;&#160;which&#160;&#160;an&#160;<br/>entity&#160;can&#160;demonstrate&#160;knowledge&#160;of&#160;an&#160;authorisation&#160;value/secret&#160;bound&#160;to&#160;a&#160;key&#160;<br/>object,&#160;data&#160;object,&#160;or&#160;an&#160;'owner&#160;authorised&#160;command'&#160;so&#160;that&#160;access&#160;to&#160;the&#160;object&#160;or&#160;<br/>use&#160;of&#160;an&#160;'owner&#160;authorised&#160;command'&#160;can&#160;be&#160;permitted&#160;by&#160;an&#160;MTM.&#160;We&#160;conclude&#160;in&#160;<br/>section&#160;3.3.8.</p>
<p style="position:absolute;top:798px;left:85px;white-space:nowrap" class="ft666"><b>3.3.1&#160;Revised&#160;Architectural&#160;Model</b></p>
<p style="position:absolute;top:825px;left:85px;white-space:nowrap" class="ft6615">We&#160;now&#160;revisit&#160;the&#160;secure&#160;wallet&#160;use-case&#160;architectural&#160;model&#160;&#160;described&#160;in&#160;section&#160;<br/>2.4.2.&#160;&#160;We&#160;&#160;require&#160;&#160;&#160;the&#160;&#160;addition&#160;&#160;&#160;of&#160;&#160;a&#160;&#160;new&#160;&#160;&#160;functional&#160;&#160;&#160;component,&#160;&#160;&#160;namely&#160;&#160;&#160;a&#160;&#160;&#160;TMP,&#160;&#160;in&#160;<br/>place&#160;of&#160;the&#160;mobile&#160;device&#160;shown&#160;in&#160;figur<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#67">e&#160;24.</a></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft667">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft667">66/109</p>
</div>
<!-- Page 67 -->
<a name="67"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page67-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application067.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft6712">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft670">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft674">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft674">Final</p>
<p style="position:absolute;top:432px;left:289px;white-space:nowrap" class="ft673"><b>Figure&#160;24:&#160;Secure&#160;wallet&#160;architecture</b></p>
<p style="position:absolute;top:469px;left:85px;white-space:nowrap" class="ft6714">A&#160;TMP,&#160;as&#160;defined&#160;by&#160;the&#160;TCG&#160;</p>
<p style="position:absolute;top:469px;left:355px;white-space:nowrap" class="ft6755">[63,64]</p>
<p style="position:absolute;top:469px;left:415px;white-space:nowrap" class="ft6714">&#160;is&#160;comprised&#160;of&#160;a&#160;set&#160;of&#160;engines,&#160;whereby&#160;an&#160;</p>
<p style="position:absolute;top:488px;left:85px;white-space:nowrap" class="ft6715">engine&#160;is&#160;described&#160;as&#160;a&#160;construct&#160;capable&#160;of&#160;manipulating&#160;data,&#160;providing&#160;evidence&#160;<br/>that&#160;it&#160;can&#160;be&#160;trusted&#160;to&#160;report&#160;the&#160;current&#160;state&#160;of&#160;the&#160;host&#160;platform&#160;and&#160;providing&#160;<br/>evidence&#160;&#160;&#160;about&#160;&#160;&#160;the&#160;&#160;&#160;host&#160;&#160;&#160;platform's&#160;&#160;&#160;current&#160;&#160;&#160;state.&#160;&#160;&#160;Each&#160;&#160;&#160;trusted&#160;&#160;&#160;mobile&#160;&#160;&#160;platform&#160;<br/>stakeholder&#160;has&#160;its&#160;own&#160;engine,&#160;where&#160;the&#160;principal&#160;stakeholders&#160;in&#160;a&#160;mobile&#160;phone&#160;<br/>include&#160;&#160;&#160;the&#160;&#160;&#160;device&#160;&#160;&#160;manufacturer,&#160;&#160;&#160;network&#160;&#160;&#160;operator,&#160;&#160;&#160;service&#160;&#160;&#160;providers&#160;&#160;&#160;and&#160;&#160;&#160;users.&#160;<br/>Each&#160;&#160;&#160;engine&#160;&#160;&#160;provides&#160;&#160;&#160;platform&#160;&#160;&#160;services&#160;&#160;&#160;on&#160;&#160;&#160;behalf&#160;&#160;&#160;of&#160;&#160;&#160;its&#160;&#160;&#160;stakeholder&#160;&#160;&#160;and&#160;&#160;&#160;also&#160;<br/>incorporates&#160;&#160;functionality&#160;&#160;similar&#160;&#160;in&#160;many&#160;&#160;ways&#160;&#160;to&#160;a&#160;&#160;traditional&#160;&#160;TCG&#160;&#160;PC&#160;&#160;platform.&#160;<br/>Each&#160;engine&#160;</p>
<p style="position:absolute;top:622px;left:194px;white-space:nowrap" class="ft6755">[63]</p>
<p style="position:absolute;top:622px;left:228px;white-space:nowrap" class="ft6714">:</p>
<p style="position:absolute;top:651px;left:112px;white-space:nowrap" class="ft6734">●</p>
<p style="position:absolute;top:642px;left:139px;white-space:nowrap" class="ft6715">has&#160;protected&#160;capabilities&#160;and&#160;shielded&#160;locations&#160;such&#160;that&#160;trusted&#160;services,&#160;<br/>which&#160;must&#160;not&#160;be&#160;subverted,&#160;can&#160;be&#160;implemented;</p>
<p style="position:absolute;top:689px;left:112px;white-space:nowrap" class="ft6734">●</p>
<p style="position:absolute;top:680px;left:139px;white-space:nowrap" class="ft6715">can&#160;&#160;&#160;use&#160;&#160;&#160;attestation&#160;&#160;&#160;identities&#160;&#160;&#160;to&#160;&#160;&#160;prove&#160;&#160;&#160;that&#160;&#160;&#160;information&#160;&#160;&#160;originated&#160;&#160;&#160;from&#160;&#160;&#160;a&#160;<br/>trusted&#160;platform;</p>
<p style="position:absolute;top:728px;left:112px;white-space:nowrap" class="ft6734">●</p>
<p style="position:absolute;top:718px;left:139px;white-space:nowrap" class="ft6715">has&#160;access&#160;to&#160;a&#160;set&#160;of&#160;'roots-of&#160;trust'&#160;such&#160;that&#160;'normal&#160;services'&#160;provided&#160;by&#160;the&#160;<br/>engine&#160;can&#160;be&#160;measured&#160;and&#160;those&#160;measurements&#160;reported;</p>
<p style="position:absolute;top:766px;left:112px;white-space:nowrap" class="ft6734">●</p>
<p style="position:absolute;top:757px;left:139px;white-space:nowrap" class="ft6715">has&#160;access&#160;to&#160;protected&#160;storage&#160;functionality,&#160;with&#160;a&#160;Storage&#160;Root&#160;Key&#160;and&#160;its&#160;<br/>subsequent&#160;hierarchy;&#160;and</p>
<p style="position:absolute;top:805px;left:112px;white-space:nowrap" class="ft6734">●</p>
<p style="position:absolute;top:795px;left:139px;white-space:nowrap" class="ft6715">may&#160;implement&#160;other&#160;TCG&#160;functions&#160;depending&#160;on&#160;the&#160;intended&#160;functionality&#160;of&#160;<br/>the&#160;engine's&#160;'measured&#160;normal&#160;services'&#160;(see&#160;bullet&#160;three&#160;above).</p>
<p style="position:absolute;top:853px;left:85px;white-space:nowrap" class="ft6714">TMP&#160;engines&#160;may&#160;be&#160;categorised&#160;as&#160;either&#160;mandatory&#160;or&#160;discretionary.</p>
<p style="position:absolute;top:881px;left:112px;white-space:nowrap" class="ft6734">●</p>
<p style="position:absolute;top:872px;left:139px;white-space:nowrap" class="ft6715">A&#160;&#160;&#160;mandatory&#160;&#160;&#160;engine&#160;&#160;&#160;provides&#160;&#160;&#160;the&#160;&#160;&#160;prerequisite&#160;&#160;&#160;functionality&#160;&#160;&#160;of&#160;&#160;&#160;a&#160;&#160;&#160;TMP,&#160;&#160;&#160;for&#160;<br/>example&#160;that&#160;required&#160;to&#160;comply&#160;with&#160;regulations&#160;which&#160;govern&#160;the&#160;operation&#160;<br/>of&#160;&#160;&#160;mobile&#160;&#160;&#160;platforms&#160;&#160;&#160;in&#160;&#160;&#160;cellular&#160;&#160;&#160;radio&#160;&#160;&#160;systems.&#160;&#160;&#160;Mandatory&#160;&#160;&#160;engines&#160;&#160;&#160;must&#160;&#160;&#160;be&#160;<br/>supported&#160;by&#160;a&#160;Mobile&#160;Remote&#160;owner&#160;Trusted&#160;Module&#160;(MRTM),&#160;which&#160;supports&#160;<br/>secure&#160;boot&#160;and&#160;does&#160;not&#160;permit&#160;a&#160;local&#160;operator&#160;to&#160;remove&#160;the&#160;stakeholder&#160;<br/>from&#160;the&#160;engine.</p>
<p style="position:absolute;top:997px;left:112px;white-space:nowrap" class="ft6734">●</p>
<p style="position:absolute;top:987px;left:139px;white-space:nowrap" class="ft6715">A&#160;&#160;&#160;discretionary&#160;&#160;&#160;engine&#160;&#160;&#160;provides&#160;&#160;&#160;services&#160;&#160;&#160;that&#160;&#160;&#160;may&#160;&#160;&#160;be&#160;&#160;&#160;added,&#160;&#160;&#160;removed&#160;&#160;&#160;and&#160;<br/>turned&#160;&#160;&#160;on/of&#160;&#160;&#160;without&#160;&#160;&#160;the&#160;&#160;&#160;consent&#160;&#160;&#160;of&#160;&#160;&#160;any&#160;&#160;&#160;external&#160;&#160;&#160;service&#160;&#160;&#160;provider.&#160;<br/>Discretionary&#160;&#160;&#160;engines&#160;&#160;&#160;must&#160;&#160;&#160;be&#160;&#160;&#160;supported&#160;&#160;&#160;by&#160;&#160;&#160;a&#160;&#160;&#160;Mobile&#160;&#160;&#160;Local&#160;&#160;&#160;owner&#160;&#160;&#160;Trusted&#160;<br/>Module&#160;(MLTM),&#160;which&#160;is&#160;not&#160;required&#160;to&#160;support&#160;secure&#160;boot&#160;and&#160;permits&#160;a&#160;<br/>local&#160;operator&#160;to&#160;remove&#160;the&#160;stakeholder&#160;from&#160;the&#160;engine.</p>
<p style="position:absolute;top:1083px;left:85px;white-space:nowrap" class="ft6715">The&#160;device&#160;manufacturer&#160;and&#160;device&#160;owner&#160;define&#160;the&#160;mandatory&#160;engines&#160;which&#160;may&#160;<br/>exist&#160;&#160;&#160;on&#160;&#160;&#160;their&#160;&#160;&#160;platforms.&#160;&#160;&#160;A&#160;&#160;&#160;device&#160;&#160;&#160;owner&#160;&#160;&#160;may&#160;&#160;&#160;also&#160;&#160;&#160;list&#160;&#160;&#160;the&#160;&#160;&#160;discretionary&#160;&#160;&#160;engines&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft677">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft677">67/109</p>
</div>
<!-- Page 68 -->
<a name="68"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft6858{font-size:15px;font-family:FAAAAA+DejaVuSans;color:#ffffff;}
-->
</style>
<div id="page68-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application068.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft6812">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft680">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft684">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft684">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft6814">permitted.</p>
<p style="position:absolute;top:189px;left:85px;white-space:nowrap" class="ft6815">An&#160;engine&#160;may&#160;be&#160;implemented&#160;using&#160;trusted&#160;and/or&#160;measured&#160;resources.&#160;In&#160;order&#160;to&#160;<br/>construct&#160;a&#160;trusted&#160;resource,&#160;namely&#160;a&#160;'root&#160;of&#160;trust',&#160;a&#160;trusted&#160;entity&#160;must&#160;vouch&#160;for&#160;<br/>a&#160;specific&#160;instantiation&#160;of&#160;that&#160;resource&#160;</p>
<p style="position:absolute;top:228px;left:425px;white-space:nowrap" class="ft6855">[63]</p>
<p style="position:absolute;top:228px;left:459px;white-space:nowrap" class="ft6814">.&#160;Alternatively,&#160;in&#160;the&#160;case&#160;of&#160;a&#160;measured&#160;</p>
<p style="position:absolute;top:247px;left:85px;white-space:nowrap" class="ft6815">resource,&#160;&#160;&#160;a&#160;&#160;&#160;reliable&#160;&#160;&#160;entity&#160;&#160;&#160;measures&#160;&#160;&#160;an&#160;&#160;&#160;instantiation&#160;&#160;&#160;of&#160;&#160;&#160;a&#160;&#160;&#160;resource&#160;&#160;&#160;and&#160;&#160;&#160;a&#160;&#160;&#160;second&#160;<br/>reliable&#160;entity&#160;provides&#160;a&#160;trustworthy&#160;reference&#160;measurement&#160;for&#160;comparison&#160;</p>
<p style="position:absolute;top:266px;left:751px;white-space:nowrap" class="ft6855">[63]</p>
<p style="position:absolute;top:266px;left:785px;white-space:nowrap" class="ft6814">.&#160;A&#160;</p>
<p style="position:absolute;top:285px;left:85px;white-space:nowrap" class="ft6814">TMP,&#160;as&#160;defined&#160;here,&#160;is&#160;also&#160;assumed&#160;to&#160;enable&#160;isolated&#160;execution&#160;of&#160;software.</p>
<p style="position:absolute;top:324px;left:85px;white-space:nowrap" class="ft6815">There&#160;are&#160;numerous&#160;scenarios&#160;which&#160;may&#160;result&#160;in&#160;the&#160;implementation&#160;of&#160;a&#160;secure&#160;<br/>wallet&#160;mechanism&#160;as&#160;described&#160;in&#160;section&#160;2.1.&#160;The&#160;secure&#160;wallet&#160;may,&#160;for&#160;example,&#160;be&#160;<br/>provided&#160;by&#160;a&#160;third&#160;party&#160;service&#160;provider&#160;and&#160;implemented&#160;by&#160;a&#160;TMP&#160;end-user&#160;who&#160;<br/>may&#160;be&#160;the&#160;device&#160;owner.&#160;Such&#160;a&#160;service&#160;is&#160;non-essential&#160;and&#160;therefore&#160;provided&#160;on&#160;<br/>the&#160;device&#160;by&#160;a&#160;service&#160;provider&#160;discretionary&#160;engine.&#160;This&#160;particular&#160;service&#160;provider&#160;<br/>engine&#160;would&#160;be&#160;listed&#160;in&#160;the&#160;DeviceOwner_discretionaryEngineList&#160;and&#160;is&#160;supported&#160;<br/>by&#160;&#160;&#160;an&#160;&#160;&#160;MLTM.&#160;&#160;&#160;In&#160;&#160;&#160;this&#160;&#160;&#160;case,&#160;&#160;&#160;the&#160;&#160;&#160;local&#160;&#160;&#160;operator/end&#160;&#160;&#160;user&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;device&#160;&#160;&#160;would&#160;&#160;&#160;be&#160;<br/>permitted&#160;to&#160;remove&#160;the&#160;service&#160;provider&#160;from&#160;the&#160;engine&#160;at&#160;any&#160;stage.</p>
<p style="position:absolute;top:497px;left:85px;white-space:nowrap" class="ft6815">Alternatively,&#160;we&#160;can&#160;envisage&#160;a&#160;scenario&#160;in&#160;which&#160;a&#160;corporate&#160;entity&#160;is&#160;the&#160;device&#160;<br/>owner&#160;and&#160;requires&#160;all&#160;device&#160;operators&#160;(namely&#160;employees)&#160;to&#160;use&#160;the&#160;secure&#160;wallet&#160;<br/>mechanism.&#160;In&#160;this&#160;case,&#160;the&#160;device&#160;owner&#160;may&#160;list&#160;the&#160;agent&#160;installer&#160;engine&#160;which&#160;<br/>provides&#160;the&#160;&#160;secure&#160;&#160;wallet&#160;&#160;functionality&#160;&#160;in&#160;the&#160;&#160;DeviceOwner_mandatoryEngineList.&#160;<br/>This&#160;implies&#160;that&#160;the&#160;engine&#160;would&#160;be&#160;supported&#160;by&#160;an&#160;MRTM&#160;and&#160;would&#160;not&#160;permit&#160;a&#160;<br/>local&#160;operator&#160;to&#160;remove&#160;the&#160;stakeholder&#160;from&#160;the&#160;engine.</p>
<p style="position:absolute;top:631px;left:85px;white-space:nowrap" class="ft6815">In&#160;short,&#160;we&#160;can&#160;imagine&#160;scenarios&#160;in&#160;which&#160;the&#160;engine&#160;providing&#160;the&#160;secure&#160;wallet&#160;<br/>mechanism&#160;is&#160;discretionary&#160;and&#160;supported&#160;by&#160;an&#160;MLTM&#160;and,&#160;equally,&#160;scenarios&#160;in&#160;<br/>which&#160;the&#160;engine&#160;is&#160;mandatory&#160;and&#160;therefore&#160;supported&#160;by&#160;an&#160;MRTM.</p>
<p style="position:absolute;top:708px;left:85px;white-space:nowrap" class="ft6815">In&#160;&#160;&#160;the&#160;&#160;&#160;remainder&#160;&#160;&#160;of&#160;&#160;&#160;this&#160;&#160;&#160;chapter,&#160;&#160;&#160;we&#160;&#160;&#160;investigate&#160;&#160;&#160;whether&#160;&#160;&#160;the&#160;&#160;&#160;trusted&#160;&#160;&#160;computing&#160;<br/>mechanisms&#160;&#160;&#160;provided&#160;&#160;&#160;by&#160;&#160;&#160;discretionary&#160;&#160;&#160;and&#160;&#160;&#160;mandatory&#160;&#160;&#160;TMP&#160;&#160;&#160;engines&#160;&#160;&#160;meet&#160;&#160;&#160;the&#160;<br/>requirements&#160;described&#160;in&#160;section&#160;3.1.3.&#160;If&#160;a&#160;particular&#160;mechanism&#160;is&#160;provided&#160;by&#160;a&#160;<br/>TMP,&#160;we&#160;examine&#160;the&#160;architecture&#160;components&#160;and&#160;commands&#160;required&#160;to&#160;leverage&#160;<br/>it.</p>
<p style="position:absolute;top:822px;left:85px;white-space:nowrap" class="ft686"><b>3.3.2&#160;Fundamental&#160;MTM&#160;command&#160;runs</b></p>
<p style="position:absolute;top:848px;left:85px;white-space:nowrap" class="ft6815">Before&#160;we&#160;examine&#160;the&#160;MTM&#160;commands,&#160;which&#160;can&#160;be&#160;used&#160;to&#160;fulfil&#160;authenticated&#160;<br/>boot,&#160;secure&#160;boot&#160;and&#160;secure&#160;storage&#160;requirements,&#160;as&#160;described&#160;in&#160;section&#160;3.2,&#160;we&#160;<br/>review&#160;a&#160;number&#160;of&#160;MTM&#160;commands&#160;which&#160;need&#160;to&#160;be&#160;executed&#160;in&#160;order&#160;to&#160;initialise&#160;<br/>an&#160;MTM&#160;for&#160;use.</p>
<p style="position:absolute;top:943px;left:85px;white-space:nowrap" class="ft686"><b>3.3.2.1&#160;MTM&#160;Permanent&#160;Flags</b></p>
<p style="position:absolute;top:970px;left:85px;white-space:nowrap" class="ft6815">Firstly,&#160;in&#160;table<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#69">&#160;15,</a>&#160;we&#160;define&#160;a&#160;number&#160;of&#160;MTM&#160;permanent&#160;flags&#160;the&#160;use&#160;of&#160;which&#160;is&#160;<br/>discussed&#160;&#160;&#160;in&#160;&#160;&#160;this&#160;&#160;&#160;chapter.&#160;&#160;&#160;MTM&#160;&#160;&#160;permanent&#160;&#160;&#160;flags&#160;&#160;&#160;are&#160;&#160;&#160;used&#160;&#160;&#160;to&#160;&#160;&#160;maintain&#160;&#160;&#160;the&#160;&#160;&#160;state&#160;<br/>information&#160;for&#160;the&#160;MTM&#160;[65].&#160;The&#160;values&#160;of&#160;these&#160;commands&#160;are&#160;not&#160;affected&#160;by&#160;the&#160;</p>
<p style="position:absolute;top:1027px;left:85px;white-space:nowrap" class="ft6820"><i>TPM_Startup&#160;</i></p>
<p style="position:absolute;top:1027px;left:201px;white-space:nowrap" class="ft6814">command.</p>
<p style="position:absolute;top:1070px;left:89px;white-space:nowrap" class="ft6858">Name</p>
<p style="position:absolute;top:1070px;left:305px;white-space:nowrap" class="ft6858">Description</p>
<p style="position:absolute;top:1096px;left:89px;white-space:nowrap" class="ft6827"><i>TPM_PF_READPUBEK</i></p>
<p style="position:absolute;top:1096px;left:305px;white-space:nowrap" class="ft684">This&#160;flag&#160;may&#160;be&#160;set&#160;to&#160;</p>
<p style="position:absolute;top:1096px;left:483px;white-space:nowrap" class="ft6827"><i>TRUE&#160;</i></p>
<p style="position:absolute;top:1096px;left:533px;white-space:nowrap" class="ft684">or&#160;</p>
<p style="position:absolute;top:1096px;left:554px;white-space:nowrap" class="ft6827"><i>FALSE</i></p>
<p style="position:absolute;top:1096px;left:605px;white-space:nowrap" class="ft684">.&#160;It&#160;indicates&#160;whether&#160;the&#160;</p>
<p style="position:absolute;top:1113px;left:305px;white-space:nowrap" class="ft684">public&#160;endorsement&#160;key&#160;can&#160;be&#160;read&#160;with&#160;or&#160;without&#160;owner&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft687">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft687">68/109</p>
</div>
<!-- Page 69 -->
<a name="69"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page69-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application069.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft6912">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft690">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft694">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft694">Final</p>
<p style="position:absolute;top:155px;left:89px;white-space:nowrap" class="ft6958">Name</p>
<p style="position:absolute;top:155px;left:305px;white-space:nowrap" class="ft6958">Description</p>
<p style="position:absolute;top:181px;left:305px;white-space:nowrap" class="ft694">authorisation.&#160;The&#160;default&#160;value&#160;is&#160;</p>
<p style="position:absolute;top:181px;left:571px;white-space:nowrap" class="ft6927"><i>TRUE</i></p>
<p style="position:absolute;top:181px;left:616px;white-space:nowrap" class="ft694">.</p>
<p style="position:absolute;top:207px;left:89px;white-space:nowrap" class="ft6927"><i>TPM_PF_DISABLE</i></p>
<p style="position:absolute;top:207px;left:305px;white-space:nowrap" class="ft694">This&#160;flag&#160;may&#160;be&#160;set&#160;to&#160;</p>
<p style="position:absolute;top:207px;left:483px;white-space:nowrap" class="ft6927"><i>TRUE&#160;</i></p>
<p style="position:absolute;top:207px;left:533px;white-space:nowrap" class="ft694">or&#160;</p>
<p style="position:absolute;top:207px;left:554px;white-space:nowrap" class="ft6927"><i>FALSE&#160;</i></p>
<p style="position:absolute;top:207px;left:609px;white-space:nowrap" class="ft694">and&#160;indicates&#160;whether&#160;</p>
<p style="position:absolute;top:224px;left:305px;white-space:nowrap" class="ft694">MTM&#160;is&#160;disabled&#160;or&#160;enabled.&#160;The&#160;default&#160;value&#160;is&#160;</p>
<p style="position:absolute;top:224px;left:682px;white-space:nowrap" class="ft6927"><i>TRUE</i></p>
<p style="position:absolute;top:224px;left:727px;white-space:nowrap" class="ft694">.</p>
<p style="position:absolute;top:250px;left:89px;white-space:nowrap" class="ft6927"><i>TPM_PF_OWNERSHIP</i></p>
<p style="position:absolute;top:250px;left:305px;white-space:nowrap" class="ft694">This&#160;flag&#160;may&#160;be&#160;set&#160;to&#160;</p>
<p style="position:absolute;top:250px;left:483px;white-space:nowrap" class="ft6927"><i>TRUE&#160;</i></p>
<p style="position:absolute;top:250px;left:533px;white-space:nowrap" class="ft694">or&#160;</p>
<p style="position:absolute;top:250px;left:554px;white-space:nowrap" class="ft6927"><i>FALSE&#160;</i></p>
<p style="position:absolute;top:250px;left:609px;white-space:nowrap" class="ft694">and&#160;indicates&#160;whether&#160;or&#160;</p>
<p style="position:absolute;top:268px;left:305px;white-space:nowrap" class="ft6910">not&#160;an&#160;entity&#160;can&#160;be&#160;take&#160;ownership&#160;of&#160;the&#160;MTM.&#160;The&#160;default&#160;<br/>value&#160;is&#160;</p>
<p style="position:absolute;top:285px;left:368px;white-space:nowrap" class="ft6927"><i>TRUE</i></p>
<p style="position:absolute;top:285px;left:413px;white-space:nowrap" class="ft694">.</p>
<p style="position:absolute;top:311px;left:89px;white-space:nowrap" class="ft6927"><i>TPM_PF_DEACTIVATED</i></p>
<p style="position:absolute;top:311px;left:305px;white-space:nowrap" class="ft694">This&#160;flag&#160;may&#160;be&#160;set&#160;to&#160;</p>
<p style="position:absolute;top:311px;left:483px;white-space:nowrap" class="ft6927"><i>TRUE&#160;</i></p>
<p style="position:absolute;top:311px;left:533px;white-space:nowrap" class="ft694">or&#160;</p>
<p style="position:absolute;top:311px;left:554px;white-space:nowrap" class="ft6927"><i>FALSE&#160;</i></p>
<p style="position:absolute;top:311px;left:609px;white-space:nowrap" class="ft694">and&#160;indicates&#160;whether&#160;</p>
<p style="position:absolute;top:328px;left:305px;white-space:nowrap" class="ft694">the&#160;MTM&#160;is&#160;deactivated&#160;or&#160;activated.&#160;The&#160;default&#160;value&#160;is&#160;</p>
<p style="position:absolute;top:328px;left:746px;white-space:nowrap" class="ft6927"><i>TRUE</i></p>
<p style="position:absolute;top:328px;left:791px;white-space:nowrap" class="ft694">.</p>
<p style="position:absolute;top:359px;left:312px;white-space:nowrap" class="ft693"><b>Table&#160;15:&#160;MTM&#160;permanent&#160;flags</b></p>
<p style="position:absolute;top:403px;left:85px;white-space:nowrap" class="ft696"><b>3.3.2.2&#160;MTM&#160;Initialisation</b></p>
<p style="position:absolute;top:429px;left:85px;white-space:nowrap" class="ft6914">The&#160;MTM&#160;must&#160;be&#160;first&#160;be&#160;initialised.&#160;</p>
<p style="position:absolute;top:429px;left:405px;white-space:nowrap" class="ft6920"><i>TPM_Init</i></p>
<p style="position:absolute;top:429px;left:482px;white-space:nowrap" class="ft6914">&#160;is&#160;a&#160;physical&#160;method&#160;of&#160;initialising&#160;the&#160;</p>
<p style="position:absolute;top:448px;left:85px;white-space:nowrap" class="ft6914">MTM.&#160;This&#160;command&#160;puts&#160;the&#160;MTM&#160;into&#160;a&#160;state&#160;where&#160;it&#160;waits&#160;for&#160;&#160;</p>
<p style="position:absolute;top:448px;left:675px;white-space:nowrap" class="ft6920"><i>TPM_Startup</i></p>
<p style="position:absolute;top:448px;left:785px;white-space:nowrap" class="ft6914">,&#160;a&#160;</p>
<p style="position:absolute;top:468px;left:85px;white-space:nowrap" class="ft6915">command&#160;&#160;&#160;which&#160;&#160;&#160;specifies&#160;&#160;&#160;the&#160;&#160;&#160;type&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;initialisation&#160;&#160;&#160;required.&#160;&#160;&#160;The&#160;&#160;&#160;MTM&#160;<br/>initialisation&#160;command&#160;is&#160;shown&#160;in&#160;table<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#69">&#160;16.</a>&#160;This&#160;command&#160;must&#160;be&#160;implemented&#160;in&#160;<br/>both&#160;an&#160;MRTM&#160;and&#160;an&#160;MLTM.</p>
<p style="position:absolute;top:544px;left:134px;white-space:nowrap" class="ft6927"><i>TPM_Init</i></p>
<p style="position:absolute;top:572px;left:326px;white-space:nowrap" class="ft6916"><b>T</b></p>
<p style="position:absolute;top:573px;left:338px;white-space:nowrap" class="ft693"><b>able&#160;16:&#160;MTM&#160;initialisation</b></p>
<p style="position:absolute;top:618px;left:85px;white-space:nowrap" class="ft696"><b>3.3.2.3&#160;MTM&#160;Start-up</b></p>
<p style="position:absolute;top:644px;left:85px;white-space:nowrap" class="ft6914">After&#160;MTM&#160;initialisation&#160;the&#160;MTM&#160;must&#160;be&#160;started&#160;up.&#160;The&#160;</p>
<p style="position:absolute;top:644px;left:590px;white-space:nowrap" class="ft6920"><i>TPM_Startup</i></p>
<p style="position:absolute;top:644px;left:701px;white-space:nowrap" class="ft6914">&#160;command&#160;is&#160;</p>
<p style="position:absolute;top:663px;left:85px;white-space:nowrap" class="ft6914">always&#160;preceded&#160;by&#160;</p>
<p style="position:absolute;top:663px;left:257px;white-space:nowrap" class="ft6920"><i>TPM_Init</i></p>
<p style="position:absolute;top:663px;left:333px;white-space:nowrap" class="ft6914">.&#160;This&#160;command&#160;must&#160;be&#160;implemented&#160;in&#160;both&#160;an&#160;MRTM&#160;</p>
<p style="position:absolute;top:683px;left:85px;white-space:nowrap" class="ft6915">and&#160;an&#160;MLTM.&#160;An&#160;MTM&#160;can&#160;startup&#160;in&#160;one&#160;of&#160;three&#160;possible&#160;modes.&#160;The&#160;chosen&#160;mode&#160;<br/>depends&#160;on&#160;the&#160;event&#160;that&#160;caused&#160;the&#160;reset&#160;and&#160;the&#160;operations&#160;on&#160;the&#160;MTM&#160;that&#160;need&#160;<br/>to&#160;be&#160;completed&#160;in&#160;response&#160;to&#160;the&#160;event.&#160;The&#160;3&#160;modes&#160;include:&#160;</p>
<p style="position:absolute;top:721px;left:627px;white-space:nowrap" class="ft6920"><i>clear</i></p>
<p style="position:absolute;top:721px;left:669px;white-space:nowrap" class="ft6914">&#160;start,&#160;</p>
<p style="position:absolute;top:721px;left:726px;white-space:nowrap" class="ft6920"><i>save</i></p>
<p style="position:absolute;top:721px;left:763px;white-space:nowrap" class="ft6914">&#160;start&#160;</p>
<p style="position:absolute;top:740px;left:85px;white-space:nowrap" class="ft6914">and&#160;</p>
<p style="position:absolute;top:740px;left:123px;white-space:nowrap" class="ft6920"><i>deactivated</i></p>
<p style="position:absolute;top:740px;left:220px;white-space:nowrap" class="ft6914">&#160;state.&#160;For&#160;an&#160;initial&#160;engine&#160;start&#160;up,&#160;a&#160;</p>
<p style="position:absolute;top:740px;left:556px;white-space:nowrap" class="ft6920"><i>clear</i></p>
<p style="position:absolute;top:740px;left:598px;white-space:nowrap" class="ft6914">&#160;start&#160;would&#160;normally&#160;be&#160;</p>
<p style="position:absolute;top:759px;left:85px;white-space:nowrap" class="ft6914">used,&#160;where&#160;all&#160;variables&#160;go&#160;to&#160;their&#160;default&#160;or&#160;non-volatile&#160;values.&#160;During&#160;a&#160;</p>
<p style="position:absolute;top:759px;left:726px;white-space:nowrap" class="ft6920"><i>save</i></p>
<p style="position:absolute;top:759px;left:763px;white-space:nowrap" class="ft6914">&#160;start&#160;</p>
<p style="position:absolute;top:779px;left:85px;white-space:nowrap" class="ft6914">the&#160;&#160;&#160;MTM&#160;&#160;&#160;recovers&#160;&#160;&#160;and&#160;&#160;&#160;restores&#160;&#160;variable&#160;&#160;&#160;values&#160;&#160;saved&#160;&#160;&#160;on&#160;&#160;&#160;a&#160;&#160;&#160;prior&#160;&#160;</p>
<p style="position:absolute;top:779px;left:671px;white-space:nowrap" class="ft6920"><i>TPM_SaveState</i></p>
<p style="position:absolute;top:779px;left:803px;white-space:nowrap" class="ft6914">.&#160;</p>
<p style="position:absolute;top:798px;left:85px;white-space:nowrap" class="ft6914">During&#160;a&#160;&#160;</p>
<p style="position:absolute;top:798px;left:170px;white-space:nowrap" class="ft6920"><i>deactivated</i></p>
<p style="position:absolute;top:798px;left:268px;white-space:nowrap" class="ft6914">&#160;&#160;start&#160;an&#160;MTM&#160;turns&#160;itself&#160;off&#160;and&#160;requires&#160;another&#160;&#160;</p>
<p style="position:absolute;top:798px;left:732px;white-space:nowrap" class="ft6920"><i>TPM_Init&#160;</i></p>
<p style="position:absolute;top:817px;left:85px;white-space:nowrap" class="ft6914">before&#160;the&#160;MTM&#160;will&#160;execute&#160;in&#160;a&#160;fully&#160;operational&#160;state.&#160;A&#160;</p>
<p style="position:absolute;top:817px;left:587px;white-space:nowrap" class="ft6920"><i>clear</i></p>
<p style="position:absolute;top:817px;left:629px;white-space:nowrap" class="ft6914">&#160;start&#160;is&#160;permitted&#160;by&#160;</p>
<p style="position:absolute;top:836px;left:85px;white-space:nowrap" class="ft6914">an&#160;&#160;&#160;MRTM&#160;&#160;&#160;and&#160;&#160;&#160;an&#160;&#160;&#160;MLTM.&#160;&#160;&#160;A&#160;&#160;</p>
<p style="position:absolute;top:836px;left:355px;white-space:nowrap" class="ft6920"><i>save</i></p>
<p style="position:absolute;top:836px;left:392px;white-space:nowrap" class="ft6914">&#160;&#160;start&#160;&#160;&#160;is&#160;&#160;&#160;dependent&#160;&#160;&#160;on&#160;&#160;&#160;the&#160;&#160;&#160;implementation&#160;&#160;&#160;of&#160;</p>
<p style="position:absolute;top:855px;left:85px;white-space:nowrap" class="ft6920"><i>TPM_SaveState</i></p>
<p style="position:absolute;top:855px;left:217px;white-space:nowrap" class="ft6914">,&#160;which&#160;is&#160;an&#160;optional&#160;command&#160;on&#160;both&#160;an&#160;MRTM&#160;and&#160;an&#160;MLTM.&#160;A&#160;</p>
<p style="position:absolute;top:875px;left:85px;white-space:nowrap" class="ft6920"><i>deactivated</i></p>
<p style="position:absolute;top:875px;left:183px;white-space:nowrap" class="ft6914">&#160;&#160;start&#160;&#160;&#160;must&#160;&#160;&#160;not&#160;&#160;&#160;be&#160;&#160;&#160;supported&#160;&#160;&#160;by&#160;&#160;&#160;an&#160;&#160;&#160;MRTM&#160;&#160;&#160;and&#160;&#160;&#160;may&#160;&#160;&#160;be&#160;&#160;&#160;optionally&#160;</p>
<p style="position:absolute;top:894px;left:85px;white-space:nowrap" class="ft6914">supported&#160;by&#160;an&#160;MLTM.&#160;&#160;The&#160;&#160;</p>
<p style="position:absolute;top:894px;left:345px;white-space:nowrap" class="ft6920"><i>TPM_Startup</i></p>
<p style="position:absolute;top:894px;left:455px;white-space:nowrap" class="ft6914">&#160;&#160;command&#160;is&#160;shown&#160;in&#160;table&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#69">&#160;17&#160;&#160;</a>and&#160;the&#160;</p>
<p style="position:absolute;top:913px;left:85px;white-space:nowrap" class="ft6914">T</p>
<p style="position:absolute;top:913px;left:96px;white-space:nowrap" class="ft6920"><i>PM_SaveState</i></p>
<p style="position:absolute;top:913px;left:217px;white-space:nowrap" class="ft6914">&#160;is&#160;shown&#160;in&#160;tabl<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#69">e&#160;18.</a></p>
<p style="position:absolute;top:952px;left:134px;white-space:nowrap" class="ft6927"><i>TPM_Startup</i></p>
<p style="position:absolute;top:979px;left:347px;white-space:nowrap" class="ft693"><b>Table&#160;17:&#160;MTM&#160;start-up</b></p>
<p style="position:absolute;top:1025px;left:134px;white-space:nowrap" class="ft6927"><i>TPM_SaveState</i></p>
<p style="position:absolute;top:1052px;left:339px;white-space:nowrap" class="ft693"><b>Table&#160;18:&#160;MTM&#160;save&#160;state</b></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft697">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft697">69/109</p>
</div>
<!-- Page 70 -->
<a name="70"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page70-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application070.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7012">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft700">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft704">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft704">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft706"><b>3.3.2.4&#160;MTM&#160;Self-testing</b></p>
<p style="position:absolute;top:178px;left:85px;white-space:nowrap" class="ft7015">During&#160;the&#160;initialisation&#160;process,&#160;there&#160;are&#160;a&#160;minimal&#160;set&#160;of&#160;self&#160;tests&#160;completed&#160;by&#160;<br/>the&#160;MTM.&#160;In&#160;order&#160;to&#160;ensure&#160;a&#160;more&#160;thorough&#160;self&#160;test&#160;the&#160;commands&#160;shown&#160;in&#160;table&#160;<br/><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#70">19&#160;</a>may&#160;be&#160;executed.&#160;Results&#160;of&#160;self&#160;tests&#160;are&#160;held&#160;in&#160;the&#160;MTM&#160;and&#160;can&#160;be&#160;retrieved&#160;<br/>using&#160;the&#160;command&#160;described&#160;in&#160;table&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#70">&#160;20.</a>&#160;These&#160;three&#160;commands&#160;are&#160;required&#160;in&#160;<br/>both&#160;an&#160;MRTM&#160;and&#160;an&#160;MLTM.</p>
<p style="position:absolute;top:293px;left:128px;white-space:nowrap" class="ft703"><b>Continue&#160;self-test&#160;process:</b></p>
<p style="position:absolute;top:328px;left:128px;white-space:nowrap" class="ft7027"><i>TPM&#160;ContinueSelfTest</i></p>
<p style="position:absolute;top:328px;left:443px;white-space:nowrap" class="ft7010">This&#160;command&#160;causes&#160;the&#160;MTM&#160;to&#160;test&#160;<br/>the&#160;MTM&#160;internal&#160;functions&#160;not&#160;tested&#160;</p>
<p style="position:absolute;top:363px;left:443px;white-space:nowrap" class="ft704">at&#160;initialisation.</p>
<p style="position:absolute;top:398px;left:128px;white-space:nowrap" class="ft703"><b>Complete&#160;a&#160;full&#160;self-test:</b></p>
<p style="position:absolute;top:433px;left:128px;white-space:nowrap" class="ft7027"><i>TPM_SelfTestFull</i></p>
<p style="position:absolute;top:433px;left:443px;white-space:nowrap" class="ft7010">Requests&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;MTM&#160;&#160;&#160;completes&#160;&#160;&#160;a&#160;<br/>full&#160;self&#160;test.</p>
<p style="position:absolute;top:477px;left:357px;white-space:nowrap" class="ft703"><b>Table&#160;19:&#160;Self&#160;testing</b></p>
<p style="position:absolute;top:522px;left:134px;white-space:nowrap" class="ft7027"><i>TPM_GetTestResult</i></p>
<p style="position:absolute;top:550px;left:294px;white-space:nowrap" class="ft703"><b>Table&#160;20:&#160;Retrieving&#160;self&#160;test&#160;results</b></p>
<p style="position:absolute;top:594px;left:85px;white-space:nowrap" class="ft706"><b>3.3.2.5&#160;Endorsement&#160;Key&#160;Generation</b></p>
<p style="position:absolute;top:620px;left:85px;white-space:nowrap" class="ft7015">The&#160;endorsement&#160;key&#160;pair&#160;is&#160;defined&#160;as&#160;optional&#160;in&#160;a&#160;TMP&#160;MRTM&#160;and&#160;mandatory&#160;in&#160;a&#160;<br/>TMP&#160;MLTM.&#160;If&#160;an&#160;endorsement&#160;key&#160;pair&#160;is&#160;used&#160;however,&#160;the&#160;command&#160;set&#160;which&#160;<br/>enables&#160;&#160;&#160;its&#160;&#160;&#160;handling&#160;&#160;&#160;must&#160;&#160;&#160;be&#160;&#160;&#160;implemented.&#160;&#160;An&#160;&#160;&#160;endorsement&#160;&#160;&#160;key&#160;&#160;&#160;pair&#160;&#160;&#160;may&#160;&#160;&#160;be&#160;<br/>generated&#160;using&#160;an&#160;external&#160;key&#160;generator.&#160;Alternatively,&#160;an&#160;&#160;endorsement&#160;key&#160;pair&#160;<br/>may&#160;&#160;&#160;be&#160;&#160;&#160;generated&#160;&#160;&#160;using&#160;&#160;&#160;either&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;commands&#160;&#160;&#160;shown&#160;&#160;&#160;in&#160;&#160;&#160;table&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#70">&#160;21.&#160;</a>&#160;&#160;The&#160;</p>
<p style="position:absolute;top:716px;left:85px;white-space:nowrap" class="ft7020"><i>TPM_CreateEndorsementKeyPair</i></p>
<p style="position:absolute;top:716px;left:365px;white-space:nowrap" class="ft7014">&#160;&#160;command&#160;&#160;&#160;may&#160;&#160;&#160;be&#160;&#160;&#160;optionally&#160;&#160;&#160;implemented&#160;&#160;&#160;in&#160;&#160;&#160;an&#160;</p>
<p style="position:absolute;top:736px;left:85px;white-space:nowrap" class="ft7014">MRTM&#160;but&#160;is&#160;required&#160;in&#160;an&#160;MLTM.&#160;The&#160;</p>
<p style="position:absolute;top:736px;left:442px;white-space:nowrap" class="ft7020"><i>TPM_CreateRevokableEK&#160;&#160;</i></p>
<p style="position:absolute;top:736px;left:664px;white-space:nowrap" class="ft7014">command,&#160;which&#160;</p>
<p style="position:absolute;top:755px;left:85px;white-space:nowrap" class="ft7015">causes&#160;a&#160;revocable&#160;endorsement&#160;key&#160;pair&#160;to&#160;be&#160;generated,&#160;may&#160;also&#160;be&#160;implemented&#160;<br/>on&#160;an&#160;MRTM&#160;and&#160;an&#160;MLTM&#160;as&#160;it&#160;is&#160;considered&#160;optional&#160;for&#160;both.</p>
<p style="position:absolute;top:812px;left:85px;white-space:nowrap" class="ft7014">Before&#160;&#160;&#160;generating&#160;&#160;&#160;an&#160;&#160;&#160;endorsement&#160;&#160;&#160;key&#160;&#160;&#160;pair,&#160;&#160;calls&#160;&#160;&#160;may&#160;&#160;&#160;be&#160;&#160;&#160;made&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;</p>
<p style="position:absolute;top:832px;left:85px;white-space:nowrap" class="ft7020"><i>TPM_GetCapability</i></p>
<p style="position:absolute;top:832px;left:247px;white-space:nowrap" class="ft7014">&#160;to&#160;determine&#160;whether&#160;or&#160;not&#160;an&#160;endorsement&#160;key&#160;already&#160;exists.</p>
<p style="position:absolute;top:870px;left:143px;white-space:nowrap" class="ft7027"><i>TPM_CreateEndorsementKeyPair</i></p>
<p style="position:absolute;top:905px;left:143px;white-space:nowrap" class="ft7027"><i>TPM_CreateRevokableEK</i></p>
<p style="position:absolute;top:931px;left:262px;white-space:nowrap" class="ft703"><b>Table&#160;21:&#160;Creating&#160;an&#160;endorsement&#160;key&#160;pair</b></p>
<p style="position:absolute;top:975px;left:85px;white-space:nowrap" class="ft706"><b>3.3.2.6&#160;Accessing&#160;a&#160;Public&#160;Endorsement&#160;Key</b></p>
<p style="position:absolute;top:1002px;left:85px;white-space:nowrap" class="ft7015">Table<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#71">&#160;22&#160;</a>shows&#160;how&#160;a&#160;public&#160;endorsement&#160;key&#160;can&#160;be&#160;accessed.&#160;Access&#160;to&#160;the&#160;public&#160;<br/>endorsement&#160;key&#160;is&#160;necessary&#160;before&#160;an&#160;entity&#160;can&#160;take&#160;ownership&#160;of&#160;an&#160;MTM&#160;as&#160;it&#160;is&#160;<br/>used&#160;during&#160;the&#160;take&#160;ownership&#160;process&#160;in&#160;order&#160;to&#160;input&#160;data&#160;into&#160;the&#160;MTM&#160;securely.&#160;</p>
<p style="position:absolute;top:1059px;left:85px;white-space:nowrap" class="ft7020"><i>TPM_ReadPubek</i></p>
<p style="position:absolute;top:1059px;left:227px;white-space:nowrap" class="ft7014">&#160;</p>
<p style="position:absolute;top:1059px;left:265px;white-space:nowrap" class="ft7014">is&#160;&#160;&#160;required&#160;&#160;&#160;in&#160;&#160;&#160;an&#160;&#160;&#160;MRTM&#160;&#160;&#160;if&#160;&#160;&#160;indeed&#160;&#160;&#160;the&#160;</p>
<p style="position:absolute;top:1078px;left:85px;white-space:nowrap" class="ft7020"><i>TPM_CreateEndorsementKeyPair&#160;</i></p>
<p style="position:absolute;top:1078px;left:372px;white-space:nowrap" class="ft7014">has&#160;been&#160;implemented.&#160;Otherwise,&#160;the&#160;command&#160;is&#160;</p>
<p style="position:absolute;top:1098px;left:85px;white-space:nowrap" class="ft7014">unnecessary.&#160;&#160;&#160;The&#160;&#160;</p>
<p style="position:absolute;top:1098px;left:258px;white-space:nowrap" class="ft7020"><i>TPM_ReadPubek&#160;&#160;</i></p>
<p style="position:absolute;top:1098px;left:416px;white-space:nowrap" class="ft7014">command&#160;&#160;&#160;is&#160;&#160;&#160;required&#160;&#160;&#160;in&#160;&#160;&#160;an&#160;&#160;&#160;MLTM.&#160;&#160;&#160;The&#160;</p>
<p style="position:absolute;top:1117px;left:85px;white-space:nowrap" class="ft7020"><i>TPM_OwnerReadInternalPub&#160;&#160;</i></p>
<p style="position:absolute;top:1117px;left:346px;white-space:nowrap" class="ft7014">is&#160;&#160;&#160;optional&#160;&#160;&#160;in&#160;&#160;&#160;an&#160;&#160;&#160;MRTM&#160;&#160;&#160;(as&#160;&#160;&#160;was&#160;&#160;&#160;the&#160;&#160;&#160;case&#160;&#160;&#160;for&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft707">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft707">70/109</p>
</div>
<!-- Page 71 -->
<a name="71"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page71-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application071.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7112">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft710">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft714">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft714">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft7120"><i>RPM_ReadPubek;&#160;&#160;</i></p>
<p style="position:absolute;top:151px;left:244px;white-space:nowrap" class="ft7114">its&#160;&#160;&#160;implementation&#160;&#160;&#160;will&#160;&#160;&#160;be&#160;&#160;&#160;dependent&#160;&#160;&#160;on&#160;&#160;&#160;the&#160;&#160;&#160;implementation&#160;&#160;&#160;of&#160;</p>
<p style="position:absolute;top:170px;left:85px;white-space:nowrap" class="ft7120"><i>TPM_CreateEndorsementKeyPair</i></p>
<p style="position:absolute;top:170px;left:365px;white-space:nowrap" class="ft7114">)&#160;and&#160;required&#160;in&#160;an&#160;MLTM.</p>
<p style="position:absolute;top:209px;left:143px;white-space:nowrap" class="ft713"><b>Open&#160;access&#160;to&#160;the&#160;public&#160;endorsement&#160;key:</b></p>
<p style="position:absolute;top:248px;left:143px;white-space:nowrap" class="ft7127"><i>TPM_ReadPubek</i></p>
<p style="position:absolute;top:283px;left:143px;white-space:nowrap" class="ft713"><b>Disable&#160;the&#160;public&#160;read&#160;of&#160;public&#160;endorsement&#160;key:</b></p>
<p style="position:absolute;top:318px;left:143px;white-space:nowrap" class="ft7110">Often&#160;&#160;&#160;by&#160;&#160;&#160;default,&#160;&#160;&#160;once&#160;&#160;&#160;the&#160;&#160;&#160;MTM&#160;&#160;&#160;has&#160;&#160;&#160;acquired&#160;&#160;&#160;an&#160;&#160;&#160;owner,&#160;&#160;&#160;the&#160;&#160;&#160;flag&#160;&#160;&#160;which&#160;<br/>indicates&#160;whether&#160;or&#160;not&#160;open&#160;access&#160;to&#160;the&#160;public&#160;endorsement&#160;key&#160;is&#160;allowed,&#160;</p>
<p style="position:absolute;top:353px;left:143px;white-space:nowrap" class="ft7127"><i>TPM_PF_READPUBEK</i></p>
<p style="position:absolute;top:353px;left:314px;white-space:nowrap" class="ft714">,&#160;is&#160;set&#160;to&#160;</p>
<p style="position:absolute;top:353px;left:390px;white-space:nowrap" class="ft7127"><i>FALSE</i></p>
<p style="position:absolute;top:353px;left:442px;white-space:nowrap" class="ft714">&#160;so&#160;that&#160;the&#160;public&#160;endorsement&#160;key&#160;can&#160;</p>
<p style="position:absolute;top:371px;left:143px;white-space:nowrap" class="ft714">only&#160;be&#160;read&#160;by&#160;the&#160;MTM&#160;owner.&#160;This&#160;flag&#160;may&#160;however&#160;be&#160;changed&#160;using&#160;the&#160;</p>
<p style="position:absolute;top:388px;left:143px;white-space:nowrap" class="ft714">optional&#160;</p>
<p style="position:absolute;top:388px;left:209px;white-space:nowrap" class="ft7127"><i>TPM_SetCapability</i></p>
<p style="position:absolute;top:388px;left:355px;white-space:nowrap" class="ft714">&#160;command&#160;which&#160;requires&#160;owner&#160;authorisation.</p>
<p style="position:absolute;top:423px;left:143px;white-space:nowrap" class="ft7127"><i>TPM_SetCapability</i></p>
<p style="position:absolute;top:458px;left:143px;white-space:nowrap" class="ft713"><b>MTM&#160;owner&#160;read&#160;of&#160;public&#160;endorsement&#160;key:</b></p>
<p style="position:absolute;top:493px;left:143px;white-space:nowrap" class="ft7127"><i>TPM_OwnerReadInternalPub</i></p>
<p style="position:absolute;top:537px;left:244px;white-space:nowrap" class="ft713"><b>Table&#160;22:&#160;Accessing&#160;the&#160;public&#160;endorsement&#160;key</b></p>
<p style="position:absolute;top:581px;left:85px;white-space:nowrap" class="ft716"><b>3.3.2.7&#160;Enabling&#160;an&#160;MTM</b></p>
<p style="position:absolute;top:607px;left:85px;white-space:nowrap" class="ft7114">The&#160;MTM&#160;must&#160;be&#160;enabled;&#160;that&#160;is&#160;the&#160;</p>
<p style="position:absolute;top:607px;left:414px;white-space:nowrap" class="ft7120"><i>PM_PF_DISABLE</i></p>
<p style="position:absolute;top:607px;left:559px;white-space:nowrap" class="ft7114">&#160;flag&#160;must&#160;be&#160;set&#160;to&#160;</p>
<p style="position:absolute;top:607px;left:728px;white-space:nowrap" class="ft7120"><i>FALSE</i></p>
<p style="position:absolute;top:607px;left:784px;white-space:nowrap" class="ft7114">.&#160;It&#160;</p>
<p style="position:absolute;top:627px;left:85px;white-space:nowrap" class="ft7115">is&#160;assumed&#160;that&#160;an&#160;MRTM&#160;is&#160;always&#160;enabled.&#160;In&#160;the&#160;case&#160;of&#160;an&#160;MLTM,&#160;this&#160;may&#160;be&#160;<br/>achieved&#160;using&#160;the&#160;required&#160;commands&#160;shown&#160;in&#160;table<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#71">&#160;23.</a></p>
<p style="position:absolute;top:684px;left:128px;white-space:nowrap" class="ft7127"><i>TPM_PhysicalEnable&#160;</i></p>
<p style="position:absolute;top:684px;left:326px;white-space:nowrap" class="ft7110">The&#160;MTM&#160;owner&#160;must&#160;enable&#160;the&#160;platform&#160;before&#160;any&#160;<br/>MTM&#160;commands&#160;can&#160;be&#160;utilised.</p>
<p style="position:absolute;top:728px;left:287px;white-space:nowrap" class="ft713"><b>Table&#160;23:&#160;Physically&#160;enabling&#160;an&#160;MTM</b></p>
<p style="position:absolute;top:754px;left:85px;white-space:nowrap" class="ft7115">In&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;&#160;&#160;physically&#160;&#160;&#160;disable&#160;&#160;&#160;the&#160;&#160;&#160;MLTM&#160;&#160;&#160;before&#160;&#160;&#160;it&#160;&#160;&#160;has&#160;&#160;&#160;acquired&#160;&#160;&#160;an&#160;&#160;&#160;owner,&#160;&#160;&#160;the&#160;<br/>commands&#160;shown&#160;in&#160;table<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#71">&#160;24&#160;</a>can&#160;be&#160;executed.</p>
<p style="position:absolute;top:812px;left:128px;white-space:nowrap" class="ft7127"><i>TPM_PhysicalDisable</i></p>
<p style="position:absolute;top:838px;left:285px;white-space:nowrap" class="ft713"><b>Table&#160;24:&#160;Physically&#160;disabling&#160;an&#160;MTM</b></p>
<p style="position:absolute;top:864px;left:85px;white-space:nowrap" class="ft7115">Once&#160;an&#160;MLTM&#160;has&#160;acquired&#160;an&#160;owner,&#160;he&#160;or&#160;she&#160;may&#160;also&#160;enable&#160;or&#160;disable&#160;the&#160;<br/>MTM&#160;using&#160;the&#160;required&#160;</p>
<p style="position:absolute;top:883px;left:297px;white-space:nowrap" class="ft7120"><i>TPM_OwnerSetDisable</i></p>
<p style="position:absolute;top:883px;left:490px;white-space:nowrap" class="ft7114">&#160;command&#160;which&#160;changes&#160;the&#160;state&#160;of&#160;</p>
<p style="position:absolute;top:902px;left:85px;white-space:nowrap" class="ft7114">the&#160;</p>
<p style="position:absolute;top:902px;left:118px;white-space:nowrap" class="ft7120"><i>TPM_PF_DISABLE</i></p>
<p style="position:absolute;top:902px;left:274px;white-space:nowrap" class="ft7114">&#160;flag&#160;to&#160;either&#160;</p>
<p style="position:absolute;top:902px;left:394px;white-space:nowrap" class="ft7120"><i>TRUE</i></p>
<p style="position:absolute;top:902px;left:443px;white-space:nowrap" class="ft7114">&#160;or&#160;</p>
<p style="position:absolute;top:902px;left:472px;white-space:nowrap" class="ft7120"><i>FALSE</i></p>
<p style="position:absolute;top:902px;left:528px;white-space:nowrap" class="ft7114">.&#160;This&#160;command&#160;is&#160;shown&#160;in&#160;table&#160;</p>
<p style="position:absolute;top:921px;left:85px;white-space:nowrap" class="ft7114"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#71">25.</a>&#160;</p>
<p style="position:absolute;top:960px;left:125px;white-space:nowrap" class="ft7127"><i>TPM_OwnerSetDisable</i></p>
<p style="position:absolute;top:960px;left:337px;white-space:nowrap" class="ft714">Used&#160;to&#160;change&#160;the&#160;status&#160;of&#160;the&#160;&#160;</p>
<p style="position:absolute;top:960px;left:603px;white-space:nowrap" class="ft7127"><i>TPM_PF_DISABLE&#160;</i></p>
<p style="position:absolute;top:977px;left:337px;white-space:nowrap" class="ft714">flag.</p>
<p style="position:absolute;top:1003px;left:287px;white-space:nowrap" class="ft713"><b>Table&#160;25:&#160;Enabling/Disabling&#160;an&#160;MTM</b></p>
<p style="position:absolute;top:1047px;left:85px;white-space:nowrap" class="ft716"><b>3.3.2.8&#160;The&#160;Ownership&#160;Flag</b></p>
<p style="position:absolute;top:1074px;left:85px;white-space:nowrap" class="ft7114">In&#160;&#160;&#160;order&#160;&#160;&#160;for&#160;&#160;&#160;a&#160;&#160;&#160;user&#160;&#160;&#160;to&#160;&#160;&#160;take&#160;&#160;&#160;ownership&#160;&#160;&#160;of&#160;&#160;&#160;an&#160;&#160;&#160;MTM,&#160;&#160;&#160;the&#160;&#160;&#160;ownership&#160;&#160;&#160;flag,&#160;</p>
<p style="position:absolute;top:1093px;left:85px;white-space:nowrap" class="ft7120"><i>TPM_PF_OWNERSHIP</i></p>
<p style="position:absolute;top:1093px;left:276px;white-space:nowrap" class="ft7114">&#160;flag&#160;must&#160;be&#160;set&#160;to&#160;</p>
<p style="position:absolute;top:1093px;left:448px;white-space:nowrap" class="ft7120"><i>TRUE</i></p>
<p style="position:absolute;top:1093px;left:497px;white-space:nowrap" class="ft7114">&#160;using&#160;the&#160;commands&#160;shown&#160;in&#160;table&#160;</p>
<p style="position:absolute;top:1112px;left:85px;white-space:nowrap" class="ft7114"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#72">26.</a>&#160;In&#160;an&#160;MRTM&#160;the&#160;default&#160;value&#160;for&#160;this&#160;flag&#160;is&#160;</p>
<p style="position:absolute;top:1112px;left:504px;white-space:nowrap" class="ft7120"><i>TRUE</i></p>
<p style="position:absolute;top:1112px;left:553px;white-space:nowrap" class="ft7114">,&#160;so&#160;this&#160;command&#160;is&#160;excluded&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft717">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft717">71/109</p>
</div>
<!-- Page 72 -->
<a name="72"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft7259{font-size:15px;font-family:MAAAAA+DejaVuSerif;color:#000000;}
-->
</style>
<div id="page72-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application072.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7212">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft720">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft724">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft724">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft7214">and&#160;in&#160;an&#160;MLTM&#160;this&#160;command&#160;is&#160;required.</p>
<p style="position:absolute;top:190px;left:124px;white-space:nowrap" class="ft7227"><i>&#160;TPM_SetOwnerInstall</i></p>
<p style="position:absolute;top:190px;left:340px;white-space:nowrap" class="ft724">Used&#160;to&#160;set&#160;the&#160;value&#160;of&#160;the&#160;&#160;</p>
<p style="position:absolute;top:190px;left:571px;white-space:nowrap" class="ft7227"><i>TPM_PF_OWNERSHIP&#160;</i></p>
<p style="position:absolute;top:207px;left:340px;white-space:nowrap" class="ft724">flag&#160;to&#160;</p>
<p style="position:absolute;top:207px;left:395px;white-space:nowrap" class="ft7227"><i>TRUE</i></p>
<p style="position:absolute;top:207px;left:440px;white-space:nowrap" class="ft724">&#160;so&#160;that&#160;an&#160;entity&#160;can&#160;take&#160;ownership&#160;of&#160;</p>
<p style="position:absolute;top:225px;left:340px;white-space:nowrap" class="ft724">an&#160;MTM.</p>
<p style="position:absolute;top:251px;left:189px;white-space:nowrap" class="ft723"><b>Table&#160;26:&#160;Setting&#160;the&#160;state&#160;of&#160;the&#160;'</b></p>
<p style="position:absolute;top:251px;left:476px;white-space:nowrap" class="ft7259"><i><b>TPM_PF_OWNERSHIP</b></i></p>
<p style="position:absolute;top:251px;left:662px;white-space:nowrap" class="ft723"><b>'&#160;flag</b></p>
<p style="position:absolute;top:295px;left:85px;white-space:nowrap" class="ft726"><b>3.3.2.9&#160;Taking&#160;Ownership&#160;of&#160;an&#160;MTM</b></p>
<p style="position:absolute;top:321px;left:85px;white-space:nowrap" class="ft7214">In&#160;an&#160;MRTM&#160;the&#160;</p>
<p style="position:absolute;top:321px;left:235px;white-space:nowrap" class="ft7220"><i>TPM_TakeOwnership</i></p>
<p style="position:absolute;top:321px;left:412px;white-space:nowrap" class="ft7214">&#160;command&#160;is&#160;optional.&#160;This&#160;command&#160;may&#160;not&#160;</p>
<p style="position:absolute;top:340px;left:85px;white-space:nowrap" class="ft7215">be&#160;necessary&#160;if&#160;there&#160;is&#160;no&#160;endorsement&#160;key&#160;pair&#160;and&#160;an&#160;AIK&#160;and&#160;SRK&#160;have&#160;been&#160;pre-<br/>installed.&#160;In&#160;order&#160;for&#160;an&#160;entity&#160;to&#160;take&#160;ownership&#160;of&#160;an&#160;MLTM,&#160;the&#160;following&#160;steps&#160;<br/>must&#160;be&#160;completed.</p>
<p style="position:absolute;top:417px;left:112px;white-space:nowrap" class="ft7215">1.&#160;The&#160;public&#160;endorsement&#160;key&#160;must&#160;be&#160;accessed,&#160;as&#160;described&#160;in&#160;tabl<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#71">e&#160;22.<br/></a>2.&#160;MTM&#160;owner&#160;authorisation&#160;data&#160;must&#160;be&#160;input&#160;into&#160;the&#160;MTM.&#160;<br/>3.&#160;An&#160;SRK&#160;must&#160;be&#160;generated&#160;inside&#160;the&#160;MTM.<br/>4.&#160;The&#160;authorisation&#160;data&#160;for&#160;the&#160;SRK&#160;must&#160;be&#160;input&#160;(if&#160;required)&#160;into&#160;the&#160;MTM.<br/>5.&#160;A&#160;tpmproof&#160;must&#160;be&#160;generated.&#160;A&#160;tmpProof&#160;is&#160;a&#160;160-bit&#160;secret&#160;that&#160;is&#160;generated&#160;</p>
<p style="position:absolute;top:513px;left:139px;white-space:nowrap" class="ft7214">by&#160;the&#160;MTM&#160;when&#160;the&#160;</p>
<p style="position:absolute;top:513px;left:335px;white-space:nowrap" class="ft7220"><i>TPM_TakeOwnership&#160;</i></p>
<p style="position:absolute;top:513px;left:519px;white-space:nowrap" class="ft7214">command&#160;is&#160;executed.&#160;This&#160;secret&#160;</p>
<p style="position:absolute;top:532px;left:139px;white-space:nowrap" class="ft7215">is&#160;&#160;&#160;associated&#160;&#160;&#160;with&#160;&#160;&#160;non-migratable&#160;&#160;&#160;objects&#160;&#160;&#160;so&#160;&#160;&#160;that&#160;&#160;&#160;an&#160;&#160;&#160;MTM&#160;&#160;&#160;can&#160;&#160;&#160;identify&#160;&#160;&#160;the&#160;<br/>objects&#160;which&#160;it&#160;has&#160;created.</p>
<p style="position:absolute;top:590px;left:85px;white-space:nowrap" class="ft7214">Steps&#160;2&#160;to&#160;5&#160;can&#160;be&#160;completed&#160;using&#160;the&#160;take&#160;ownership&#160;command&#160;shown&#160;in&#160;tabl<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#72">e&#160;27.</a></p>
<p style="position:absolute;top:628px;left:126px;white-space:nowrap" class="ft7227"><i>TPM_TakeOwnership</i></p>
<p style="position:absolute;top:656px;left:283px;white-space:nowrap" class="ft723"><b>Table&#160;27:&#160;Taking&#160;ownership&#160;of&#160;an&#160;MTM</b></p>
<p style="position:absolute;top:700px;left:85px;white-space:nowrap" class="ft726"><b>3.3.2.10&#160;MTM&#160;Activation</b></p>
<p style="position:absolute;top:727px;left:85px;white-space:nowrap" class="ft7214">Finally,&#160;an&#160;MTM&#160;must&#160;be&#160;activated;&#160;this&#160;will&#160;result&#160;in&#160;the&#160;&#160;</p>
<p style="position:absolute;top:727px;left:591px;white-space:nowrap" class="ft7220"><i>TPM_PF_ACTIVATED</i></p>
<p style="position:absolute;top:727px;left:769px;white-space:nowrap" class="ft7214">&#160;&#160;flag&#160;</p>
<p style="position:absolute;top:746px;left:85px;white-space:nowrap" class="ft7214">being&#160;set&#160;to&#160;</p>
<p style="position:absolute;top:746px;left:189px;white-space:nowrap" class="ft7220"><i>FALSE</i></p>
<p style="position:absolute;top:746px;left:246px;white-space:nowrap" class="ft7214">.&#160;It&#160;is&#160;assumed&#160;that&#160;an&#160;MRTM&#160;is&#160;always&#160;activated.&#160;In&#160;the&#160;case&#160;of&#160;an&#160;</p>
<p style="position:absolute;top:765px;left:85px;white-space:nowrap" class="ft7214">MLTM,&#160;this&#160;may&#160;be&#160;achieved&#160;using&#160;the&#160;required&#160;command&#160;shown&#160;in&#160;tabl<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#72">e&#160;28.</a></p>
<p style="position:absolute;top:803px;left:128px;white-space:nowrap" class="ft7227"><i>TPM_PhysicalSetDeactivated</i></p>
<p style="position:absolute;top:830px;left:325px;white-space:nowrap" class="ft723"><b>Table&#160;28:&#160;Activating&#160;an&#160;MTM</b></p>
<p style="position:absolute;top:874px;left:85px;white-space:nowrap" class="ft726"><b>3.3.3&#160;Authenticated&#160;Boot&#160;Process</b></p>
<p style="position:absolute;top:900px;left:85px;white-space:nowrap" class="ft7221"><b>SecureWallet1</b></p>
<p style="position:absolute;top:900px;left:220px;white-space:nowrap" class="ft7214">&#160;&#160;to&#160;&#160;</p>
<p style="position:absolute;top:900px;left:254px;white-space:nowrap" class="ft7221"><b>SecureWallet14</b></p>
<p style="position:absolute;top:900px;left:401px;white-space:nowrap" class="ft7214">,&#160;as&#160;described&#160;in&#160;section&#160;3.2,&#160;may&#160;be&#160;partially&#160;</p>
<p style="position:absolute;top:919px;left:85px;white-space:nowrap" class="ft7215">met&#160;&#160;&#160;through&#160;&#160;&#160;the&#160;&#160;&#160;deployment&#160;&#160;&#160;of&#160;&#160;&#160;an&#160;&#160;&#160;authenticated&#160;&#160;&#160;boot&#160;&#160;&#160;mechanism,&#160;&#160;&#160;where&#160;&#160;&#160;an&#160;<br/>authenticated&#160;boot&#160;is&#160;defined&#160;as&#160;the&#160;process&#160;by&#160;which&#160;the&#160;state&#160;of&#160;a&#160;platform&#160;engine&#160;<br/>can&#160;be&#160;reliably&#160;measured&#160;and&#160;stored.</p>
<p style="position:absolute;top:996px;left:85px;white-space:nowrap" class="ft7215">An&#160;authenticated&#160;boot&#160;is&#160;supported&#160;by&#160;both&#160;a&#160;mandatory&#160;and&#160;a&#160;discretionary&#160;TMP&#160;<br/>engine&#160;as&#160;defined&#160;in&#160;&#160;[63].&#160;In&#160;order&#160;to&#160;support&#160;such&#160;a&#160;mechanism&#160;an&#160;engine&#160;must&#160;<br/>comprise&#160;of&#160;a&#160;Root&#160;of&#160;Trust&#160;for&#160;Measurement&#160;(RTM)&#160;and&#160;a&#160;Root&#160;of&#160;Trust&#160;for&#160;Storage&#160;<br/>(RTS).</p>
<p style="position:absolute;top:1082px;left:112px;white-space:nowrap" class="ft7234">●</p>
<p style="position:absolute;top:1073px;left:139px;white-space:nowrap" class="ft7215">A&#160;RTM&#160;is&#160;required&#160;to&#160;accurately&#160;measure&#160;at&#160;least&#160;one&#160;integrity&#160;measurement&#160;in&#160;<br/>an&#160;&#160;&#160;engine,&#160;&#160;&#160;and&#160;&#160;&#160;report&#160;&#160;&#160;the&#160;&#160;&#160;integrity&#160;&#160;&#160;measurement&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;RTS.&#160;&#160;&#160;This&#160;&#160;&#160;may&#160;&#160;&#160;be&#160;<br/>accomplished&#160;using&#160;the&#160;MTM&#160;PCR&#160;extension&#160;command,&#160;</p>
<p style="position:absolute;top:1111px;left:611px;white-space:nowrap" class="ft7220"><i>TPM_Extend.</i></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft727">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft727">72/109</p>
</div>
<!-- Page 73 -->
<a name="73"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page73-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application073.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7312">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft730">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft734">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft734">Final</p>
<p style="position:absolute;top:160px;left:112px;white-space:nowrap" class="ft7334">●</p>
<p style="position:absolute;top:151px;left:139px;white-space:nowrap" class="ft7315">A&#160;RTS&#160;is&#160;required&#160;to&#160;accept&#160;integrity&#160;measurements&#160;and&#160;record&#160;them.&#160;Both&#160;an&#160;<br/>MRTM&#160;&#160;&#160;and&#160;&#160;&#160;an&#160;&#160;&#160;MLTM,&#160;&#160;&#160;which&#160;&#160;&#160;incorporate&#160;&#160;&#160;the&#160;&#160;&#160;RTS&#160;&#160;&#160;in&#160;&#160;&#160;a&#160;&#160;&#160;mandatory&#160;&#160;&#160;and&#160;&#160;&#160;a&#160;<br/>discretionary&#160;&#160;&#160;engine&#160;&#160;&#160;respectively,&#160;&#160;&#160;are&#160;&#160;&#160;required&#160;&#160;&#160;to&#160;&#160;&#160;have&#160;&#160;&#160;a&#160;&#160;&#160;set&#160;&#160;&#160;of&#160;&#160;&#160;Platform&#160;<br/>Configuration&#160;Registers.</p>
<p style="position:absolute;top:247px;left:85px;white-space:nowrap" class="ft7315">It&#160;&#160;&#160;is&#160;&#160;&#160;envisaged&#160;&#160;&#160;that&#160;&#160;&#160;an&#160;&#160;&#160;authenticated&#160;&#160;&#160;boot&#160;&#160;&#160;process&#160;&#160;&#160;for&#160;&#160;&#160;a&#160;&#160;&#160;TMP&#160;&#160;&#160;engine&#160;&#160;&#160;will&#160;&#160;&#160;closely&#160;<br/>resemble&#160;&#160;&#160;that&#160;&#160;&#160;of&#160;&#160;&#160;a&#160;&#160;&#160;PC&#160;&#160;&#160;platform.&#160;&#160;&#160;Very&#160;&#160;&#160;basically,&#160;&#160;&#160;an&#160;&#160;&#160;engine&#160;&#160;&#160;RTM&#160;&#160;&#160;may&#160;&#160;&#160;for&#160;&#160;&#160;example&#160;<br/>measure&#160;&#160;&#160;its&#160;&#160;&#160;own&#160;&#160;&#160;configuration&#160;&#160;&#160;and&#160;&#160;&#160;the&#160;&#160;&#160;configuration&#160;&#160;&#160;of&#160;&#160;&#160;img1&#160;&#160;&#160;(the&#160;&#160;&#160;next&#160;&#160;&#160;software&#160;<br/>component&#160;&#160;&#160;to&#160;&#160;&#160;be&#160;&#160;&#160;loaded&#160;&#160;&#160;and&#160;&#160;&#160;executed&#160;&#160;&#160;on&#160;&#160;&#160;the&#160;&#160;&#160;platform&#160;&#160;&#160;engine),&#160;&#160;&#160;saving&#160;&#160;&#160;the&#160;<br/>measurement&#160;to&#160;an&#160;MTM&#160;PCR&#160;and&#160;a&#160;summary&#160;of&#160;the&#160;measurement&#160;to&#160;a&#160;log&#160;file&#160;stored&#160;<br/>on&#160;&#160;&#160;the&#160;&#160;&#160;engine.&#160;&#160;&#160;Measurement&#160;&#160;&#160;functionality&#160;&#160;&#160;integrated&#160;&#160;&#160;into&#160;&#160;&#160;img1&#160;&#160;&#160;continues&#160;&#160;&#160;the&#160;<br/>measurement&#160;&#160;&#160;process,&#160;&#160;&#160;saving&#160;&#160;&#160;the&#160;&#160;&#160;measurement&#160;&#160;&#160;of&#160;&#160;&#160;img2&#160;&#160;&#160;(the&#160;&#160;&#160;next&#160;&#160;&#160;software&#160;<br/>component&#160;to&#160;be&#160;loaded&#160;and&#160;executed&#160;on&#160;the&#160;platform&#160;engine),&#160;to&#160;an&#160;MTM&#160;PCR&#160;and&#160;a&#160;<br/>summary&#160;to&#160;the&#160;log&#160;file.&#160;It&#160;then&#160;passes&#160;control&#160;to&#160;img2.&#160;This&#160;process&#160;continues&#160;until&#160;<br/>all&#160;the&#160;specified&#160;software&#160;in&#160;the&#160;engine&#160;has&#160;been&#160;reliably&#160;measured.&#160;Measurements&#160;<br/>stored&#160;during&#160;the&#160;authenticated&#160;boot&#160;process&#160;may&#160;be&#160;utilised&#160;in&#160;secure&#160;storage&#160;and&#160;<br/>attestation&#160;&#160;&#160;mechanisms.&#160;&#160;&#160;The&#160;&#160;&#160;exact&#160;&#160;&#160;process&#160;&#160;&#160;by&#160;&#160;&#160;which&#160;&#160;&#160;a&#160;&#160;&#160;trusted&#160;&#160;mobile&#160;&#160;&#160;platform&#160;&#160;is&#160;<br/>booted,&#160;its&#160;integrity&#160;measured&#160;and&#160;its&#160;integrity&#160;measurements&#160;stored,&#160;needs&#160;to&#160;be&#160;<br/>specified&#160;for&#160;each&#160;TMP&#160;architecture,&#160;just&#160;as&#160;for&#160;the&#160;PC&#160;client&#160;in&#160;[66].</p>
<p style="position:absolute;top:534px;left:85px;white-space:nowrap" class="ft736"><b>3.3.4&#160;Secure&#160;Boot&#160;Process</b></p>
<p style="position:absolute;top:560px;left:85px;white-space:nowrap" class="ft7321"><b>SecureWallet1</b></p>
<p style="position:absolute;top:561px;left:220px;white-space:nowrap" class="ft7314">&#160;&#160;and&#160;</p>
<p style="position:absolute;top:560px;left:266px;white-space:nowrap" class="ft7321"><b>SecureWallet2</b></p>
<p style="position:absolute;top:561px;left:401px;white-space:nowrap" class="ft7314">&#160;&#160;as&#160;defined&#160;&#160;in&#160;section&#160;3.2,&#160;may&#160;be&#160;met&#160;through&#160;</p>
<p style="position:absolute;top:580px;left:85px;white-space:nowrap" class="ft7315">the&#160;deployment&#160;of&#160;a&#160;secure&#160;boot&#160;mechanism,&#160;where&#160;a&#160;secure&#160;boot&#160;is&#160;defined&#160;as&#160;the&#160;<br/>process&#160;&#160;&#160;by&#160;&#160;&#160;which&#160;&#160;&#160;the&#160;&#160;&#160;state&#160;&#160;&#160;of&#160;&#160;&#160;an&#160;&#160;&#160;engine&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;reliably&#160;&#160;&#160;measured,&#160;&#160;&#160;verified&#160;&#160;&#160;and&#160;<br/>stored.&#160;<br/>A&#160;secure&#160;boot&#160;mechanism&#160;must&#160;be&#160;supported&#160;by&#160;a&#160;mandatory&#160;device&#160;manufacturer&#160;<br/>engine,&#160;should&#160;be&#160;supported&#160;by&#160;all&#160;other&#160;mandatory&#160;engines&#160;and&#160;may&#160;be&#160;supported&#160;by&#160;<br/>discretionary&#160;&#160;&#160;engines.&#160;&#160;&#160;In&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;&#160;&#160;support&#160;&#160;&#160;such&#160;&#160;&#160;a&#160;&#160;&#160;mechanism&#160;&#160;&#160;an&#160;&#160;&#160;engine&#160;&#160;&#160;must&#160;<br/>incorporate&#160;a&#160;RTM,&#160;a&#160;RTS&#160;and&#160;a&#160;Root&#160;of&#160;Trust&#160;for&#160;Verification&#160;(RTV).</p>
<p style="position:absolute;top:723px;left:112px;white-space:nowrap" class="ft7334">●</p>
<p style="position:absolute;top:714px;left:139px;white-space:nowrap" class="ft7315">A&#160;RTM&#160;is&#160;required&#160;to&#160;accurately&#160;measure&#160;at&#160;least&#160;one&#160;integrity&#160;measurement&#160;in&#160;<br/>an&#160;engine,&#160;and&#160;report&#160;the&#160;integrity&#160;measurement&#160;to&#160;the&#160;RTV.</p>
<p style="position:absolute;top:762px;left:112px;white-space:nowrap" class="ft7334">●</p>
<p style="position:absolute;top:753px;left:139px;white-space:nowrap" class="ft7315">A&#160;RTV&#160;is&#160;required&#160;to&#160;accept&#160;an&#160;integrity&#160;measurement&#160;from&#160;the&#160;RTM&#160;and&#160;verify&#160;<br/>it&#160;against&#160;the&#160;corresponding&#160;reference&#160;integrity&#160;measurement&#160;before&#160;reporting&#160;<br/>it&#160;to&#160;the&#160;RTS.&#160;This&#160;is&#160;accomplished&#160;using&#160;the&#160;</p>
<p style="position:absolute;top:791px;left:518px;white-space:nowrap" class="ft7320"><i>MTM_VerifyRIMCertAndExtend</i></p>
<p style="position:absolute;top:791px;left:785px;white-space:nowrap" class="ft7314">.</p>
<p style="position:absolute;top:819px;left:112px;white-space:nowrap" class="ft7334">●</p>
<p style="position:absolute;top:810px;left:139px;white-space:nowrap" class="ft7315">A&#160;RTS&#160;is&#160;required&#160;to&#160;accept&#160;integrity&#160;measurements&#160;from&#160;the&#160;RTV&#160;and&#160;record&#160;<br/>them.&#160;&#160;&#160;Both&#160;&#160;&#160;an&#160;&#160;&#160;MRTM&#160;&#160;&#160;and&#160;&#160;&#160;an&#160;&#160;&#160;MLTM,&#160;&#160;&#160;which&#160;&#160;&#160;incorporate&#160;&#160;&#160;the&#160;&#160;&#160;RTS&#160;&#160;&#160;for&#160;&#160;&#160;a&#160;<br/>mandatory&#160;and&#160;a&#160;discretionary&#160;engine&#160;respectively,&#160;are&#160;required&#160;to&#160;have&#160;a&#160;set&#160;<br/>of&#160;PCRs.</p>
<p style="position:absolute;top:906px;left:85px;white-space:nowrap" class="ft7315">Before&#160;an&#160;engine&#160;can&#160;be&#160;securely&#160;booted,&#160;it&#160;must&#160;be&#160;provisioned&#160;with&#160;an&#160;asymmetric&#160;<br/>public&#160;key&#160;called&#160;a&#160;Root&#160;Verification&#160;Authority&#160;Identifier&#160;(RVAI).&#160;The&#160;RVAI&#160;must&#160;be&#160;<br/>integrity-protected&#160;&#160;&#160;within&#160;&#160;&#160;an&#160;&#160;&#160;MTM.&#160;&#160;&#160;For&#160;&#160;&#160;example,&#160;&#160;&#160;an&#160;&#160;&#160;integrity&#160;&#160;&#160;check&#160;&#160;&#160;sum&#160;&#160;&#160;for&#160;&#160;&#160;the&#160;<br/>asymmetric&#160;public&#160;key&#160;may&#160;be&#160;stored&#160;in&#160;an&#160;MTM&#160;shielded&#160;location.&#160;Alternatively,&#160;the&#160;<br/>asymmetric&#160;public&#160;key&#160;may&#160;be&#160;signed&#160;using&#160;a&#160;private&#160;key&#160;associated&#160;with&#160;the&#160;MTM.</p>
<p style="position:absolute;top:1021px;left:85px;white-space:nowrap" class="ft7315">The&#160;corresponding&#160;RVAI&#160;private&#160;key&#160;is&#160;securely&#160;stored&#160;by&#160;the&#160;engine's&#160;stakeholder.&#160;<br/>The&#160;root&#160;verification&#160;authority,&#160;i.e.&#160;the&#160;engine's&#160;stakeholder,&#160;may&#160;use&#160;the&#160;private&#160;key&#160;<br/>to&#160;either&#160;sign:</p>
<p style="position:absolute;top:1088px;left:112px;white-space:nowrap" class="ft7334">●</p>
<p style="position:absolute;top:1079px;left:139px;white-space:nowrap" class="ft7315">a&#160;certificate&#160;which&#160;contains&#160;a&#160;reference&#160;integrity&#160;measurement&#160;for&#160;a&#160;particular&#160;<br/>software&#160;component,&#160;namely&#160;a&#160;RIM_Cert;&#160;or&#160;</p>
<p style="position:absolute;top:1127px;left:112px;white-space:nowrap" class="ft7334">●</p>
<p style="position:absolute;top:1117px;left:139px;white-space:nowrap" class="ft7314">a&#160;&#160;&#160;Rim_Auth_Cert,&#160;&#160;&#160;in&#160;&#160;&#160;which&#160;&#160;&#160;the&#160;&#160;&#160;public&#160;&#160;&#160;key&#160;&#160;&#160;of&#160;&#160;&#160;another&#160;&#160;&#160;authority&#160;&#160;&#160;(a&#160;&#160;&#160;so-called&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft737">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft737">73/109</p>
</div>
<!-- Page 74 -->
<a name="74"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft7460{font-size:15px;font-family:DAAAAA+DejaVuSerif;color:#ffffff;}
-->
</style>
<div id="page74-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application074.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7412">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft740">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft744">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft744">Final</p>
<p style="position:absolute;top:151px;left:139px;white-space:nowrap" class="ft7414">RIM_Auth)&#160;is&#160;authorised&#160;to&#160;create/sign&#160;RIM_Certs</p>
<p style="position:absolute;top:151px;left:559px;white-space:nowrap" class="ft7420"><i>.</i></p>
<p style="position:absolute;top:189px;left:85px;white-space:nowrap" class="ft7415">A&#160;&#160;&#160;RIM_Cert&#160;&#160;&#160;may&#160;&#160;&#160;be&#160;&#160;&#160;classified&#160;&#160;&#160;as&#160;&#160;&#160;external&#160;&#160;&#160;or&#160;&#160;&#160;internal.&#160;&#160;&#160;External&#160;&#160;&#160;RIM_Certs&#160;&#160;&#160;are&#160;<br/>generated&#160;outside&#160;the&#160;MTM,&#160;may&#160;be&#160;valid&#160;for&#160;a&#160;number&#160;of&#160;platforms&#160;and&#160;are&#160;signed&#160;<br/>by&#160;&#160;&#160;RIM_Auths.&#160;&#160;&#160;Internal&#160;&#160;&#160;RIM_Certs&#160;&#160;&#160;are&#160;&#160;&#160;generated&#160;&#160;&#160;from&#160;&#160;&#160;external&#160;&#160;&#160;RIM_Certs&#160;&#160;&#160;and&#160;<br/>authorised&#160;by&#160;the&#160;engine&#160;itself.&#160;Internal&#160;RIM_Certs&#160;are&#160;integrity&#160;protected&#160;using&#160;an&#160;<br/>engine's&#160;internal&#160;verification&#160;key,&#160;a&#160;secret&#160;unique&#160;to&#160;the&#160;engine's&#160;MTM.</p>
<p style="position:absolute;top:305px;left:85px;white-space:nowrap" class="ft7414">An&#160;MTM&#160;which&#160;enables&#160;a&#160;secure&#160;boot&#160;must&#160;also&#160;support&#160;two&#160;monotonic&#160;counters:</p>
<p style="position:absolute;top:333px;left:112px;white-space:nowrap" class="ft7434">●</p>
<p style="position:absolute;top:324px;left:139px;white-space:nowrap" class="ft7420"><i>counterBootstrap</i></p>
<p style="position:absolute;top:324px;left:286px;white-space:nowrap" class="ft7414">,&#160;&#160;&#160;which&#160;&#160;&#160;is&#160;&#160;&#160;used&#160;&#160;&#160;in&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;&#160;&#160;verify&#160;&#160;&#160;the&#160;&#160;&#160;validity&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;first&#160;</p>
<p style="position:absolute;top:343px;left:139px;white-space:nowrap" class="ft7414">executable&#160;image;&#160;and</p>
<p style="position:absolute;top:372px;left:112px;white-space:nowrap" class="ft7434">●</p>
<p style="position:absolute;top:362px;left:139px;white-space:nowrap" class="ft7420"><i>counterRIMProtect</i></p>
<p style="position:absolute;top:362px;left:301px;white-space:nowrap" class="ft7414">,&#160;which&#160;is&#160;used&#160;to&#160;protect&#160;internal&#160;RIM_Certs&#160;from&#160;re-flash&#160;</p>
<p style="position:absolute;top:381px;left:139px;white-space:nowrap" class="ft7414">attacks.</p>
<p style="position:absolute;top:420px;left:85px;white-space:nowrap" class="ft7415">To&#160;summarise,&#160;in&#160;table&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#74">&#160;29,</a>&#160;we&#160;define&#160;the&#160;MTM&#160;permanent&#160;data&#160;associated&#160;with&#160;an&#160;<br/>engine's&#160;secure&#160;boot&#160;mechanism.</p>
<p style="position:absolute;top:482px;left:89px;white-space:nowrap" class="ft7454">Name</p>
<p style="position:absolute;top:482px;left:305px;white-space:nowrap" class="ft7454">Description</p>
<p style="position:absolute;top:507px;left:89px;white-space:nowrap" class="ft7427"><i>counterBootstrap</i></p>
<p style="position:absolute;top:507px;left:305px;white-space:nowrap" class="ft7410">This&#160;field&#160;contains&#160;the&#160;current&#160;value&#160;of&#160;the&#160;counterBootstrap&#160;<br/>monotonic&#160;counter.&#160;</p>
<p style="position:absolute;top:551px;left:89px;white-space:nowrap" class="ft7427"><i>counterRimProtectId</i></p>
<p style="position:absolute;top:551px;left:305px;white-space:nowrap" class="ft744">This&#160;field&#160;contains&#160;the&#160;current&#160;value&#160;of&#160;the&#160;counterRIMProtect&#160;</p>
<p style="position:absolute;top:568px;left:305px;white-space:nowrap" class="ft744">monotonic&#160;counter.&#160;</p>
<p style="position:absolute;top:594px;left:89px;white-space:nowrap" class="ft7427"><i>integrityCheckRootSize</i></p>
<p style="position:absolute;top:594px;left:305px;white-space:nowrap" class="ft744">This&#160;field&#160;indicates&#160;the&#160;length&#160;of&#160;the&#160;data&#160;held&#160;in&#160;the&#160;</p>
<p style="position:absolute;top:612px;left:305px;white-space:nowrap" class="ft7427"><i>integrityCheckRootData&#160;</i></p>
<p style="position:absolute;top:612px;left:494px;white-space:nowrap" class="ft744">field&#160;in&#160;bytes.</p>
<p style="position:absolute;top:637px;left:89px;white-space:nowrap" class="ft7427"><i>integrityCheckRootData</i></p>
<p style="position:absolute;top:637px;left:305px;white-space:nowrap" class="ft744">This&#160;field&#160;contains&#160;an&#160;immutable&#160;cryptographic&#160;binding&#160;of&#160;a&#160;</p>
<p style="position:absolute;top:655px;left:305px;white-space:nowrap" class="ft7410">single&#160;MRTM&#160;instance&#160;to&#160;(a)&#160;RVAI(s)&#160;in&#160;the&#160;case&#160;of&#160;a&#160;mandatory&#160;<br/>engine&#160;or&#160;an&#160;immutable&#160;cryptographic&#160;binding&#160;of&#160;a&#160;single&#160;MLTM&#160;</p>
<p style="position:absolute;top:690px;left:305px;white-space:nowrap" class="ft744">instance&#160;to&#160;(a)&#160;RVAI(s)&#160;in&#160;the&#160;case&#160;of&#160;a&#160;discretionary&#160;engine.</p>
<p style="position:absolute;top:716px;left:89px;white-space:nowrap" class="ft7427"><i>internalVerificationKey</i></p>
<p style="position:absolute;top:716px;left:305px;white-space:nowrap" class="ft7410">This&#160;field&#160;contains&#160;a&#160;secret&#160;unique&#160;to&#160;an&#160;MTM&#160;used&#160;in&#160;the&#160;<br/>creation&#160;(i.e.&#160;authorisation&#160;and&#160;integrity&#160;protection)&#160;of&#160;internal&#160;</p>
<p style="position:absolute;top:750px;left:305px;white-space:nowrap" class="ft744">RIM_Certs&#160;from&#160;external&#160;RIM_certs.</p>
<p style="position:absolute;top:781px;left:312px;white-space:nowrap" class="ft743"><b>Table&#160;29:&#160;MTM&#160;permanent&#160;flags</b></p>
<p style="position:absolute;top:826px;left:85px;white-space:nowrap" class="ft7414">A&#160;&#160;&#160;RVAI&#160;&#160;&#160;and&#160;&#160;&#160;a&#160;&#160;&#160;Rim_Auth_Cert&#160;&#160;&#160;are&#160;&#160;&#160;represented&#160;&#160;&#160;in&#160;&#160;&#160;an&#160;&#160;&#160;MTM&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;</p>
<p style="position:absolute;top:845px;left:85px;white-space:nowrap" class="ft7420"><i>TPM_VERIFICATION_KEY&#160;</i></p>
<p style="position:absolute;top:845px;left:312px;white-space:nowrap" class="ft7414">structure</p>
<p style="position:absolute;top:845px;left:390px;white-space:nowrap" class="ft7420"><i>&#160;</i></p>
<p style="position:absolute;top:845px;left:397px;white-space:nowrap" class="ft7414">which&#160;is&#160;composed&#160;of&#160;the&#160;parameters&#160;defined&#160;in&#160;</p>
<p style="position:absolute;top:864px;left:85px;white-space:nowrap" class="ft7414">table<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#75">&#160;30.</a></p>
<p style="position:absolute;top:907px;left:242px;white-space:nowrap" class="ft7460"><b>Name</b></p>
<p style="position:absolute;top:907px;left:579px;white-space:nowrap" class="ft7460"><b>Description</b></p>
<p style="position:absolute;top:933px;left:89px;white-space:nowrap" class="ft7427"><i>tag</i></p>
<p style="position:absolute;top:933px;left:451px;white-space:nowrap" class="ft744">This&#160;&#160;&#160;field&#160;&#160;</p>
<p style="position:absolute;top:933px;left:596px;white-space:nowrap" class="ft744">contains&#160;&#160;</p>
<p style="position:absolute;top:933px;left:699px;white-space:nowrap" class="ft744">the&#160;&#160;</p>
<p style="position:absolute;top:933px;left:763px;white-space:nowrap" class="ft744">value&#160;</p>
<p style="position:absolute;top:950px;left:451px;white-space:nowrap" class="ft744">'</p>
<p style="position:absolute;top:950px;left:455px;white-space:nowrap" class="ft7427"><i>TPM_TAG_VERIFICATION_KEY</i></p>
<p style="position:absolute;top:950px;left:695px;white-space:nowrap" class="ft744">'.</p>
<p style="position:absolute;top:976px;left:89px;white-space:nowrap" class="ft7427"><i>usageFlags</i></p>
<p style="position:absolute;top:976px;left:451px;white-space:nowrap" class="ft744">This&#160;field&#160;define&#160;the&#160;capabilities&#160;associated&#160;</p>
<p style="position:absolute;top:994px;left:451px;white-space:nowrap" class="ft744">with&#160;the&#160;key.</p>
<p style="position:absolute;top:1019px;left:89px;white-space:nowrap" class="ft7427"><i>parentId</i></p>
<p style="position:absolute;top:1019px;left:451px;white-space:nowrap" class="ft7410">This&#160;field&#160;contains&#160;an&#160;identifier&#160;for&#160;the&#160;key's&#160;<br/>parent&#160;key,&#160;if&#160;indeed&#160;one&#160;exists.</p>
<p style="position:absolute;top:1063px;left:89px;white-space:nowrap" class="ft7427"><i>myId</i></p>
<p style="position:absolute;top:1063px;left:451px;white-space:nowrap" class="ft744">This&#160;field&#160;contains&#160;an&#160;identifier&#160;for&#160;the&#160;key&#160;</p>
<p style="position:absolute;top:1080px;left:451px;white-space:nowrap" class="ft744">defined&#160;in&#160;the&#160;structure.</p>
<p style="position:absolute;top:1106px;left:89px;white-space:nowrap" class="ft7427"><i>referenceCounter</i></p>
<p style="position:absolute;top:1106px;left:451px;white-space:nowrap" class="ft744">This&#160;field&#160;defines&#160;the&#160;name&#160;and&#160;the&#160;value&#160;of&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft747">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft747">74/109</p>
</div>
<!-- Page 75 -->
<a name="75"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page75-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application075.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7512">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft750">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft754">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft754">Final</p>
<p style="position:absolute;top:155px;left:451px;white-space:nowrap" class="ft7510">the&#160;counter&#160;to&#160;which&#160;the&#160;key&#160;structure&#160;is&#160;<br/>bound.</p>
<p style="position:absolute;top:199px;left:89px;white-space:nowrap" class="ft7527"><i>keyAlgorithm</i></p>
<p style="position:absolute;top:199px;left:451px;white-space:nowrap" class="ft754">This&#160;field&#160;contains&#160;an&#160;algorithm&#160;identifier&#160;for&#160;</p>
<p style="position:absolute;top:216px;left:451px;white-space:nowrap" class="ft754">the&#160;key.</p>
<p style="position:absolute;top:242px;left:89px;white-space:nowrap" class="ft7527"><i>keyScheme</i></p>
<p style="position:absolute;top:242px;left:451px;white-space:nowrap" class="ft754">This&#160;field&#160;defines&#160;the&#160;manner&#160;by&#160;which&#160;the&#160;</p>
<p style="position:absolute;top:259px;left:451px;white-space:nowrap" class="ft7527"><i>integrityCheckData</i></p>
<p style="position:absolute;top:259px;left:600px;white-space:nowrap" class="ft754">&#160;field&#160;can&#160;be&#160;validated&#160;</p>
<p style="position:absolute;top:277px;left:451px;white-space:nowrap" class="ft754">using&#160;the&#160;</p>
<p style="position:absolute;top:277px;left:526px;white-space:nowrap" class="ft7527"><i>keyData</i></p>
<p style="position:absolute;top:277px;left:589px;white-space:nowrap" class="ft754">.</p>
<p style="position:absolute;top:303px;left:89px;white-space:nowrap" class="ft7527"><i>extensionDigestSize</i></p>
<p style="position:absolute;top:303px;left:451px;white-space:nowrap" class="ft754">The&#160;length&#160;in&#160;bytes&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:303px;left:651px;white-space:nowrap" class="ft7527"><i>extensionDigest&#160;</i></p>
<p style="position:absolute;top:320px;left:451px;white-space:nowrap" class="ft754">field</p>
<p style="position:absolute;top:346px;left:89px;white-space:nowrap" class="ft7527"><i>extensionDigest</i></p>
<p style="position:absolute;top:346px;left:451px;white-space:nowrap" class="ft754">A&#160;buffer&#160;containing&#160;a&#160;hash&#160;of&#160;the&#160;proprietary&#160;</p>
<p style="position:absolute;top:363px;left:451px;white-space:nowrap" class="ft754">extension&#160;data.</p>
<p style="position:absolute;top:389px;left:89px;white-space:nowrap" class="ft7527"><i>keySize</i></p>
<p style="position:absolute;top:389px;left:451px;white-space:nowrap" class="ft754">The&#160;length&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:389px;left:586px;white-space:nowrap" class="ft7527"><i>keyData</i></p>
<p style="position:absolute;top:389px;left:648px;white-space:nowrap" class="ft754">&#160;field.</p>
<p style="position:absolute;top:415px;left:89px;white-space:nowrap" class="ft7527"><i>keyData</i></p>
<p style="position:absolute;top:415px;left:451px;white-space:nowrap" class="ft7510">The&#160;verification&#160;key,&#160;be&#160;it&#160;a&#160;RVAI&#160;or&#160;indeed&#160;a&#160;<br/>RIM_Auth&#160;key.</p>
<p style="position:absolute;top:458px;left:89px;white-space:nowrap" class="ft7527"><i>integrityCheckSize</i></p>
<p style="position:absolute;top:458px;left:451px;white-space:nowrap" class="ft754">The&#160;length&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:458px;left:586px;white-space:nowrap" class="ft7527"><i>integrityCheckData</i></p>
<p style="position:absolute;top:458px;left:735px;white-space:nowrap" class="ft754">&#160;field.</p>
<p style="position:absolute;top:484px;left:89px;white-space:nowrap" class="ft7527"><i>integrityCheckData</i></p>
<p style="position:absolute;top:484px;left:451px;white-space:nowrap" class="ft754">An&#160;integrity&#160;check&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:501px;left:451px;white-space:nowrap" class="ft7527"><i>TPM_VERIFICATION_KEY</i></p>
<p style="position:absolute;top:501px;left:650px;white-space:nowrap" class="ft754">.</p>
<p style="position:absolute;top:532px;left:255px;white-space:nowrap" class="ft753"><b>Table&#160;30:&#160;</b></p>
<p style="position:absolute;top:532px;left:337px;white-space:nowrap" class="ft7559"><i><b>TPM_VERIFICATION_KEY</b></i></p>
<p style="position:absolute;top:532px;left:554px;white-space:nowrap" class="ft753"><b>&#160;structure</b></p>
<p style="position:absolute;top:558px;left:85px;white-space:nowrap" class="ft7514">A&#160;Rim_Cert&#160;takes&#160;the&#160;form&#160;of&#160;a&#160;</p>
<p style="position:absolute;top:558px;left:351px;white-space:nowrap" class="ft7520"><i>TPM_RIM_CERTIFICATE&#160;</i></p>
<p style="position:absolute;top:558px;left:566px;white-space:nowrap" class="ft7514">structure&#160;which&#160;is&#160;composed&#160;</p>
<p style="position:absolute;top:577px;left:85px;white-space:nowrap" class="ft7514">of&#160;the&#160;parameters&#160;defined&#160;in&#160;tabl<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#76">e&#160;31.</a></p>
<p style="position:absolute;top:620px;left:242px;white-space:nowrap" class="ft7560"><b>Name</b></p>
<p style="position:absolute;top:620px;left:579px;white-space:nowrap" class="ft7560"><b>Description</b></p>
<p style="position:absolute;top:645px;left:89px;white-space:nowrap" class="ft7527"><i>tag</i></p>
<p style="position:absolute;top:645px;left:451px;white-space:nowrap" class="ft754">Must&#160;be&#160;set&#160;to&#160;</p>
<p style="position:absolute;top:645px;left:565px;white-space:nowrap" class="ft7527"><i>TPM_TAG_RIM_CERTIFIC</i></p>
<p style="position:absolute;top:645px;left:764px;white-space:nowrap" class="ft754">ATE</p>
<p style="position:absolute;top:671px;left:89px;white-space:nowrap" class="ft7527"><i>label</i></p>
<p style="position:absolute;top:671px;left:451px;white-space:nowrap" class="ft754">A&#160;proprietary&#160;label.</p>
<p style="position:absolute;top:697px;left:89px;white-space:nowrap" class="ft7527"><i>rimVersion</i></p>
<p style="position:absolute;top:697px;left:451px;white-space:nowrap" class="ft754">A&#160;version&#160;number&#160;for&#160;the&#160;RIM&#160;certificate.</p>
<p style="position:absolute;top:723px;left:89px;white-space:nowrap" class="ft7527"><i>referenceCounter</i></p>
<p style="position:absolute;top:723px;left:451px;white-space:nowrap" class="ft7510">This&#160;field&#160;defines&#160;the&#160;name&#160;and&#160;the&#160;value&#160;of&#160;<br/>the&#160;counter&#160;to&#160;which&#160;the&#160;key&#160;structure&#160;is&#160;</p>
<p style="position:absolute;top:758px;left:451px;white-space:nowrap" class="ft754">bound.</p>
<p style="position:absolute;top:784px;left:89px;white-space:nowrap" class="ft7527"><i>state</i></p>
<p style="position:absolute;top:784px;left:451px;white-space:nowrap" class="ft7510">This&#160;field&#160;contains&#160;the&#160;expected&#160;values&#160;of&#160;the&#160;<br/>engine's&#160;PCRs&#160;at&#160;the&#160;time&#160;of&#160;certificate&#160;use.&#160;</p>
<p style="position:absolute;top:819px;left:451px;white-space:nowrap" class="ft7510">Unless&#160;the&#160;value&#160;in&#160;this&#160;field&#160;matches&#160;that&#160;of&#160;<br/>the&#160;engine's&#160;PCRs&#160;the&#160;certificate&#160;will&#160;not&#160;be&#160;</p>
<p style="position:absolute;top:854px;left:451px;white-space:nowrap" class="ft754">accepted.</p>
<p style="position:absolute;top:879px;left:89px;white-space:nowrap" class="ft7527"><i>measurementPcrIndex</i></p>
<p style="position:absolute;top:879px;left:451px;white-space:nowrap" class="ft7510">This&#160;field&#160;specifies&#160;the&#160;PCR&#160;that&#160;is&#160;to&#160;be&#160;<br/>extended&#160;with&#160;</p>
<p style="position:absolute;top:897px;left:564px;white-space:nowrap" class="ft7527"><i>measurementValue</i></p>
<p style="position:absolute;top:897px;left:710px;white-space:nowrap" class="ft754">&#160;using&#160;the&#160;</p>
<p style="position:absolute;top:914px;left:451px;white-space:nowrap" class="ft7527"><i>TPM_VerifyRIMCertAndExtend</i></p>
<p style="position:absolute;top:914px;left:688px;white-space:nowrap" class="ft754">&#160;command.</p>
<p style="position:absolute;top:940px;left:89px;white-space:nowrap" class="ft7527"><i>measurementValue</i></p>
<p style="position:absolute;top:940px;left:451px;white-space:nowrap" class="ft7510">This&#160;field&#160;contains&#160;the&#160;value&#160;to&#160;be&#160;extended&#160;<br/>into&#160;the&#160;PCR&#160;–&#160;'</p>
<p style="position:absolute;top:958px;left:568px;white-space:nowrap" class="ft7527"><i>measurementPcrIndex</i></p>
<p style="position:absolute;top:958px;left:741px;white-space:nowrap" class="ft754">'.</p>
<p style="position:absolute;top:983px;left:89px;white-space:nowrap" class="ft7527"><i>parentId</i></p>
<p style="position:absolute;top:983px;left:451px;white-space:nowrap" class="ft754">The&#160;identity&#160;of&#160;the&#160;key&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:1001px;left:451px;white-space:nowrap" class="ft7527"><i>TPM_VERIFICATION_KEY</i></p>
<p style="position:absolute;top:1001px;left:651px;white-space:nowrap" class="ft754">&#160;used&#160;to&#160;verify&#160;the&#160;</p>
<p style="position:absolute;top:1018px;left:451px;white-space:nowrap" class="ft754">structure.</p>
<p style="position:absolute;top:1044px;left:89px;white-space:nowrap" class="ft7527"><i>extensionDigestSize</i></p>
<p style="position:absolute;top:1044px;left:451px;white-space:nowrap" class="ft754">The&#160;length&#160;in&#160;bytes&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:1044px;left:651px;white-space:nowrap" class="ft7527"><i>extensionDigest</i></p>
<p style="position:absolute;top:1044px;left:773px;white-space:nowrap" class="ft754">.</p>
<p style="position:absolute;top:1070px;left:89px;white-space:nowrap" class="ft7527"><i>extensionDigest</i></p>
<p style="position:absolute;top:1070px;left:451px;white-space:nowrap" class="ft754">This&#160;field&#160;contains&#160;a&#160;hash&#160;of&#160;the&#160;proprietary&#160;</p>
<p style="position:absolute;top:1087px;left:451px;white-space:nowrap" class="ft754">extension&#160;data.</p>
<p style="position:absolute;top:1113px;left:89px;white-space:nowrap" class="ft7527"><i>integrityCheckSize</i></p>
<p style="position:absolute;top:1113px;left:451px;white-space:nowrap" class="ft754">The&#160;length&#160;of&#160;the&#160;data&#160;in&#160;the&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft757">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft757">75/109</p>
</div>
<!-- Page 76 -->
<a name="76"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page76-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application076.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7612">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft760">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft764">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft764">Final</p>
<p style="position:absolute;top:155px;left:451px;white-space:nowrap" class="ft764">'</p>
<p style="position:absolute;top:155px;left:455px;white-space:nowrap" class="ft7627"><i>integrityCheckData</i></p>
<p style="position:absolute;top:155px;left:604px;white-space:nowrap" class="ft764">'&#160;field.</p>
<p style="position:absolute;top:181px;left:89px;white-space:nowrap" class="ft7627"><i>integrityCheckData</i></p>
<p style="position:absolute;top:181px;left:451px;white-space:nowrap" class="ft764">An&#160;integrity&#160;check&#160;on&#160;the&#160;</p>
<p style="position:absolute;top:199px;left:451px;white-space:nowrap" class="ft7627"><i>TPM_RIM_CERTIFICATE</i></p>
<p style="position:absolute;top:199px;left:642px;white-space:nowrap" class="ft764">.</p>
<p style="position:absolute;top:229px;left:260px;white-space:nowrap" class="ft763"><b>Table&#160;31:&#160;</b></p>
<p style="position:absolute;top:229px;left:342px;white-space:nowrap" class="ft7659"><i><b>TPM_RIM_CERTIFICATE</b></i></p>
<p style="position:absolute;top:229px;left:549px;white-space:nowrap" class="ft763"><b>&#160;structure</b></p>
<p style="position:absolute;top:255px;left:85px;white-space:nowrap" class="ft7615">In&#160;order&#160;to&#160;enable&#160;a&#160;secure&#160;boot&#160;process,&#160;RIM_Certs&#160;must&#160;initially&#160;be&#160;installed&#160;in&#160;an&#160;<br/>engine.&#160;The&#160;command&#160;used&#160;for&#160;RIM&#160;installation&#160;is&#160;shown&#160;in&#160;table<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#76">&#160;32.</a>&#160;This&#160;command&#160;<br/>is&#160;used&#160;to&#160;generate&#160;internal&#160;RIM&#160;certificates&#160;from&#160;external&#160;RIM&#160;certificates.&#160;&#160;During&#160;<br/>this&#160;conversion:</p>
<p style="position:absolute;top:341px;left:112px;white-space:nowrap" class="ft7634">●</p>
<p style="position:absolute;top:332px;left:139px;white-space:nowrap" class="ft7615">all&#160;fields&#160;of&#160;the&#160;external&#160;RIM_Cert&#160;input&#160;are&#160;written&#160;to&#160;the&#160;structure&#160;for&#160;an&#160;<br/>internal&#160;RIM_Cert.</p>
<p style="position:absolute;top:379px;left:112px;white-space:nowrap" class="ft7634">●</p>
<p style="position:absolute;top:370px;left:139px;white-space:nowrap" class="ft7614">the</p>
<p style="position:absolute;top:370px;left:195px;white-space:nowrap" class="ft7614">&#160;</p>
<p style="position:absolute;top:370px;left:200px;white-space:nowrap" class="ft7620"><i>counterReference</i></p>
<p style="position:absolute;top:370px;left:350px;white-space:nowrap" class="ft7614">&#160;</p>
<p style="position:absolute;top:370px;left:384px;white-space:nowrap" class="ft7614">-&gt;</p>
<p style="position:absolute;top:370px;left:432px;white-space:nowrap" class="ft7614">&#160;</p>
<p style="position:absolute;top:370px;left:438px;white-space:nowrap" class="ft7620"><i>counterSelection</i></p>
<p style="position:absolute;top:370px;left:580px;white-space:nowrap" class="ft7614">&#160;</p>
<p style="position:absolute;top:370px;left:614px;white-space:nowrap" class="ft7614">field&#160;&#160;&#160;is&#160;&#160;&#160;set&#160;&#160;&#160;to&#160;</p>
<p style="position:absolute;top:389px;left:139px;white-space:nowrap" class="ft7620"><i>MTM_COUNTER_SELECT_RIMPROTECT</i></p>
<p style="position:absolute;top:389px;left:486px;white-space:nowrap" class="ft7614">.</p>
<p style="position:absolute;top:418px;left:112px;white-space:nowrap" class="ft7634">●</p>
<p style="position:absolute;top:408px;left:139px;white-space:nowrap" class="ft7615">the&#160;value&#160;of&#160;the&#160;permanent&#160;data&#160;field&#160;counterRIMProtectId&#160;+1&#160;is&#160;inserted&#160;into&#160;<br/>the&#160;</p>
<p style="position:absolute;top:428px;left:171px;white-space:nowrap" class="ft7620"><i>counterReference</i></p>
<p style="position:absolute;top:428px;left:322px;white-space:nowrap" class="ft7614">&#160;-&gt;&#160;</p>
<p style="position:absolute;top:428px;left:351px;white-space:nowrap" class="ft7620"><i>counterValue</i></p>
<p style="position:absolute;top:428px;left:462px;white-space:nowrap" class="ft7614">&#160;field.&#160;</p>
<p style="position:absolute;top:456px;left:112px;white-space:nowrap" class="ft7634">●</p>
<p style="position:absolute;top:447px;left:139px;white-space:nowrap" class="ft7614">the&#160;&#160;</p>
<p style="position:absolute;top:447px;left:179px;white-space:nowrap" class="ft7620"><i>integrityCheckdata</i></p>
<p style="position:absolute;top:447px;left:340px;white-space:nowrap" class="ft7614">&#160;&#160;for&#160;&#160;&#160;the&#160;&#160;&#160;internal&#160;&#160;&#160;RIM_Cert&#160;&#160;&#160;is&#160;&#160;&#160;generated&#160;&#160;&#160;using&#160;&#160;&#160;the&#160;</p>
<p style="position:absolute;top:466px;left:139px;white-space:nowrap" class="ft7620"><i>TPM_Internal_Verification_Key</i></p>
<p style="position:absolute;top:466px;left:397px;white-space:nowrap" class="ft7614">&#160;&#160;as&#160;a&#160;HMAC&#160;key&#160;and&#160;written&#160;to&#160;&#160;</p>
<p style="position:absolute;top:466px;left:684px;white-space:nowrap" class="ft7620"><i>rimCertOut</i></p>
<p style="position:absolute;top:466px;left:781px;white-space:nowrap" class="ft7614">&#160;&#160;-&gt;&#160;</p>
<p style="position:absolute;top:485px;left:139px;white-space:nowrap" class="ft7620"><i>integrityCheckData</i></p>
<p style="position:absolute;top:485px;left:303px;white-space:nowrap" class="ft7614">.</p>
<p style="position:absolute;top:514px;left:112px;white-space:nowrap" class="ft7634">●</p>
<p style="position:absolute;top:504px;left:139px;white-space:nowrap" class="ft7614">The&#160;&#160;&#160;size&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;</p>
<p style="position:absolute;top:504px;left:305px;white-space:nowrap" class="ft7620"><i>integrityCheckData</i></p>
<p style="position:absolute;top:504px;left:469px;white-space:nowrap" class="ft7614">&#160;&#160;is&#160;&#160;&#160;written&#160;&#160;&#160;into&#160;&#160;&#160;the&#160;&#160;</p>
<p style="position:absolute;top:504px;left:677px;white-space:nowrap" class="ft7620"><i>rimCertOut</i></p>
<p style="position:absolute;top:504px;left:774px;white-space:nowrap" class="ft7614">&#160;&#160;-&gt;&#160;</p>
<p style="position:absolute;top:524px;left:139px;white-space:nowrap" class="ft7620"><i>integrityCheckDataSize</i></p>
<p style="position:absolute;top:524px;left:338px;white-space:nowrap" class="ft7614">.</p>
<p style="position:absolute;top:562px;left:134px;white-space:nowrap" class="ft7627"><i>TPM_InstallRIM</i></p>
<p style="position:absolute;top:588px;left:337px;white-space:nowrap" class="ft763"><b>Table&#160;32:&#160;RIM&#160;installation</b></p>
<p style="position:absolute;top:633px;left:85px;white-space:nowrap" class="ft7614">The&#160;resultant&#160;internal&#160;RIM_Certs&#160;can&#160;be&#160;checked&#160;using&#160;</p>
<p style="position:absolute;top:633px;left:556px;white-space:nowrap" class="ft7620"><i>TPM_VerifyRIMCert</i></p>
<p style="position:absolute;top:633px;left:725px;white-space:nowrap" class="ft7614">&#160;as&#160;shown&#160;</p>
<p style="position:absolute;top:653px;left:85px;white-space:nowrap" class="ft7614">in&#160;table<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#76">&#160;33.</a></p>
<p style="position:absolute;top:691px;left:134px;white-space:nowrap" class="ft7627"><i>TPM_VerifyRIMCert</i></p>
<p style="position:absolute;top:691px;left:397px;white-space:nowrap" class="ft7610">When&#160;&#160;&#160;this&#160;&#160;&#160;command&#160;&#160;&#160;is&#160;&#160;&#160;called&#160;&#160;&#160;the&#160;&#160;&#160;RIM_Cert&#160;<br/>syntax,&#160;&#160;&#160;verification&#160;&#160;&#160;key,&#160;&#160;&#160;counter&#160;&#160;&#160;value&#160;&#160;&#160;and&#160;</p>
<p style="position:absolute;top:726px;left:397px;white-space:nowrap" class="ft764">integrityCheckData&#160;are&#160;validated.</p>
<p style="position:absolute;top:752px;left:315px;white-space:nowrap" class="ft763"><b>Table&#160;33:&#160;RIM_Cert&#160;verification</b></p>
<p style="position:absolute;top:797px;left:85px;white-space:nowrap" class="ft7614">The&#160;&#160;</p>
<p style="position:absolute;top:797px;left:131px;white-space:nowrap" class="ft7620"><i>TPM_LoadVerificationKey</i></p>
<p style="position:absolute;top:797px;left:347px;white-space:nowrap" class="ft7614">&#160;&#160;command,&#160;&#160;&#160;shown&#160;&#160;&#160;in&#160;&#160;&#160;table&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#76">&#160;34,&#160;</a>&#160;&#160;is&#160;&#160;&#160;used&#160;&#160;&#160;to&#160;&#160;&#160;load&#160;</p>
<p style="position:absolute;top:817px;left:85px;white-space:nowrap" class="ft7615">verification&#160;keys&#160;into&#160;an&#160;MTM&#160;(including&#160;the&#160;RVAI).&#160;Verification&#160;key&#160;loading&#160;can&#160;be&#160;<br/>authorised&#160;using&#160;one&#160;of&#160;the&#160;following&#160;means.</p>
<p style="position:absolute;top:855px;left:112px;white-space:nowrap" class="ft7614">1.&#160;The&#160;&#160;&#160;key&#160;&#160;&#160;may&#160;&#160;&#160;be&#160;&#160;&#160;loaded&#160;&#160;&#160;into&#160;&#160;&#160;the&#160;&#160;&#160;MTM&#160;&#160;&#160;before&#160;&#160;&#160;integrity&#160;&#160;&#160;checking&#160;&#160;&#160;has&#160;&#160;&#160;been&#160;</p>
<p style="position:absolute;top:874px;left:139px;white-space:nowrap" class="ft7614">enabled,&#160;&#160;&#160;i.e.&#160;&#160;&#160;the&#160;&#160;</p>
<p style="position:absolute;top:874px;left:302px;white-space:nowrap" class="ft7620"><i>MTM_STANY_FLAG</i></p>
<p style="position:absolute;top:874px;left:470px;white-space:nowrap" class="ft7614">&#160;&#160;-&gt;&#160;&#160;</p>
<p style="position:absolute;top:874px;left:515px;white-space:nowrap" class="ft7620"><i>loadVerificationrootKeyEnabled</i></p>
<p style="position:absolute;top:874px;left:781px;white-space:nowrap" class="ft7614">&#160;&#160;=&#160;</p>
<p style="position:absolute;top:893px;left:139px;white-space:nowrap" class="ft7620"><i>TRUE</i></p>
<p style="position:absolute;top:893px;left:189px;white-space:nowrap" class="ft7614">.</p>
<p style="position:absolute;top:913px;left:138px;white-space:nowrap" class="ft7614">This&#160;enables&#160;a&#160;verification&#160;root&#160;key&#160;(namely&#160;a&#160;RVAI)&#160;to&#160;be&#160;loaded&#160;when&#160;the&#160;</p>
<p style="position:absolute;top:932px;left:85px;white-space:nowrap" class="ft7614">MTM&#160;&#160;is&#160;first&#160;manufactured&#160;or&#160;customised&#160;for&#160;a&#160;particular&#160;engine.</p>
<p style="position:absolute;top:951px;left:112px;white-space:nowrap" class="ft7614">2.&#160;A&#160;&#160;&#160;cryptographic&#160;&#160;&#160;hash&#160;&#160;&#160;or&#160;&#160;&#160;equivalent&#160;&#160;&#160;may&#160;&#160;&#160;be&#160;&#160;&#160;embedded&#160;&#160;&#160;in&#160;</p>
<p style="position:absolute;top:970px;left:139px;white-space:nowrap" class="ft7620"><i>MTM_PERMANANT_DATA</i></p>
<p style="position:absolute;top:970px;left:363px;white-space:nowrap" class="ft7614">&#160;-&gt;&#160;</p>
<p style="position:absolute;top:970px;left:393px;white-space:nowrap" class="ft7620"><i>integrityCheckRootData</i></p>
<p style="position:absolute;top:970px;left:596px;white-space:nowrap" class="ft7614">&#160;in&#160;the&#160;MTM.</p>
<p style="position:absolute;top:989px;left:112px;white-space:nowrap" class="ft7615">3.&#160;The&#160;loading&#160;may&#160;be&#160;authorised&#160;by&#160;the&#160;MTM&#160;owner.<br/>4.&#160;The&#160;key&#160;to&#160;be&#160;loaded&#160;may&#160;be&#160;signed&#160;by&#160;an&#160;authentic,&#160;authorised&#160;and&#160;already&#160;</p>
<p style="position:absolute;top:1028px;left:139px;white-space:nowrap" class="ft7614">loaded&#160;</p>
<p style="position:absolute;top:1028px;left:200px;white-space:nowrap" class="ft7620"><i>TPM_VERIFICATION_KEY</i></p>
<p style="position:absolute;top:1028px;left:419px;white-space:nowrap" class="ft7614">.</p>
<p style="position:absolute;top:1066px;left:134px;white-space:nowrap" class="ft7627"><i>TPM_LoadVerificationKey</i></p>
<p style="position:absolute;top:1092px;left:297px;white-space:nowrap" class="ft763"><b>Table&#160;34:&#160;Loading&#160;a&#160;verification&#160;key</b></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft767">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft767">76/109</p>
</div>
<!-- Page 77 -->
<a name="77"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page77-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application077.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7712">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft770">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft774">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft774">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft7714">The</p>
<p style="position:absolute;top:151px;left:117px;white-space:nowrap" class="ft7720"><i>&#160;&#160;TPM_LoadVerificationRootKeyDisable&#160;&#160;</i></p>
<p style="position:absolute;top:151px;left:450px;white-space:nowrap" class="ft7714">command,&#160;as&#160;shown&#160;in&#160;table&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#77">&#160;35,</a></p>
<p style="position:absolute;top:151px;left:732px;white-space:nowrap" class="ft7720"><i>&#160;</i></p>
<p style="position:absolute;top:151px;left:740px;white-space:nowrap" class="ft7714">disables&#160;</p>
<p style="position:absolute;top:170px;left:85px;white-space:nowrap" class="ft7714">the&#160;functionality&#160;to&#160;load&#160;a&#160;verification&#160;root&#160;key&#160;as&#160;described&#160;in&#160;step&#160;1&#160;above.</p>
<p style="position:absolute;top:209px;left:134px;white-space:nowrap" class="ft7727"><i>TPM_LoadVerificationRootKeyDisable</i></p>
<p style="position:absolute;top:209px;left:441px;white-space:nowrap" class="ft774">This</p>
<p style="position:absolute;top:209px;left:516px;white-space:nowrap" class="ft774">&#160;</p>
<p style="position:absolute;top:209px;left:564px;white-space:nowrap" class="ft774">command</p>
<p style="position:absolute;top:209px;left:681px;white-space:nowrap" class="ft774">&#160;</p>
<p style="position:absolute;top:209px;left:729px;white-space:nowrap" class="ft774">sets&#160;</p>
<p style="position:absolute;top:226px;left:441px;white-space:nowrap" class="ft774">loadVerificationrootKeyEnabled&#160;=&#160;FALSE</p>
<p style="position:absolute;top:252px;left:209px;white-space:nowrap" class="ft773"><b>Table&#160;35:&#160;Disabling&#160;the&#160;loading&#160;of&#160;a&#160;root&#160;verification&#160;key</b></p>
<p style="position:absolute;top:278px;left:85px;white-space:nowrap" class="ft7714">The</p>
<p style="position:absolute;top:278px;left:117px;white-space:nowrap" class="ft7720"><i>&#160;TPM_IncrementBootstrapCounter&#160;</i></p>
<p style="position:absolute;top:278px;left:413px;white-space:nowrap" class="ft7714">command&#160;increments&#160;</p>
<p style="position:absolute;top:278px;left:602px;white-space:nowrap" class="ft7720"><i>MTM_Permanent_Data</i></p>
<p style="position:absolute;top:278px;left:794px;white-space:nowrap" class="ft7714">&#160;–</p>
<p style="position:absolute;top:298px;left:85px;white-space:nowrap" class="ft7714">&gt;&#160;&#160;</p>
<p style="position:absolute;top:298px;left:107px;white-space:nowrap" class="ft7720"><i>CounterBootstrap</i></p>
<p style="position:absolute;top:298px;left:257px;white-space:nowrap" class="ft7714">.&#160;In&#160;order&#160;to&#160;execute&#160;this&#160;command&#160;a&#160;RIM_Cert&#160;containing&#160;the&#160;</p>
<p style="position:absolute;top:317px;left:85px;white-space:nowrap" class="ft7714">incremented&#160;&#160;&#160;counter&#160;&#160;&#160;value&#160;&#160;&#160;and&#160;&#160;&#160;signed&#160;&#160;&#160;using&#160;&#160;&#160;as&#160;&#160;</p>
<p style="position:absolute;top:317px;left:524px;white-space:nowrap" class="ft7720"><i>TPM_VERIFICATION_KEY</i></p>
<p style="position:absolute;top:317px;left:745px;white-space:nowrap" class="ft7714">&#160;&#160;whose&#160;</p>
<p style="position:absolute;top:336px;left:85px;white-space:nowrap" class="ft7714">usage&#160;&#160;&#160;flags&#160;&#160;&#160;have</p>
<p style="position:absolute;top:336px;left:297px;white-space:nowrap" class="ft7714">&#160;</p>
<p style="position:absolute;top:336px;left:303px;white-space:nowrap" class="ft7720"><i>TPM_VERIFICATION_KEY_USAGE_SIGN_RIM_CERT</i></p>
<p style="position:absolute;top:336px;left:748px;white-space:nowrap" class="ft7714">&#160;</p>
<p style="position:absolute;top:336px;left:777px;white-space:nowrap" class="ft7714">and&#160;</p>
<p style="position:absolute;top:355px;left:85px;white-space:nowrap" class="ft7720"><i>TPM_VERIFICATION&#160;_KEY_USAGE_INCREMENT_BOOTSTRAP</i></p>
<p style="position:absolute;top:355px;left:619px;white-space:nowrap" class="ft7714">&#160;set&#160;must&#160;be&#160;input.</p>
<p style="position:absolute;top:394px;left:134px;white-space:nowrap" class="ft7727"><i>TPM_IncrementBootstrapCounter</i></p>
<p style="position:absolute;top:420px;left:263px;white-space:nowrap" class="ft773"><b>Table&#160;36:&#160;Incrementing&#160;a&#160;bootstrap&#160;counter</b></p>
<p style="position:absolute;top:446px;left:85px;white-space:nowrap" class="ft7714">The</p>
<p style="position:absolute;top:446px;left:155px;white-space:nowrap" class="ft7714">&#160;</p>
<p style="position:absolute;top:446px;left:160px;white-space:nowrap" class="ft7720"><i>TPM_SetVerifiedPCRSelection</i></p>
<p style="position:absolute;top:446px;left:414px;white-space:nowrap" class="ft7714">&#160;</p>
<p style="position:absolute;top:446px;left:458px;white-space:nowrap" class="ft7714">command&#160;&#160;</p>
<p style="position:absolute;top:446px;left:583px;white-space:nowrap" class="ft7714">is&#160;&#160;</p>
<p style="position:absolute;top:446px;left:640px;white-space:nowrap" class="ft7714">used&#160;&#160;</p>
<p style="position:absolute;top:446px;left:723px;white-space:nowrap" class="ft7714">to&#160;&#160;</p>
<p style="position:absolute;top:446px;left:783px;white-space:nowrap" class="ft7714">set&#160;</p>
<p style="position:absolute;top:465px;left:85px;white-space:nowrap" class="ft7715">MTM_PERMANANT_DATA&#160;-&gt;&#160;verifiedPCRs.&#160;This&#160;field&#160;lists&#160;the&#160;PCRs&#160;into&#160;which&#160;only&#160;<br/>verified&#160;&#160;&#160;measurement&#160;&#160;&#160;values&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;written.&#160;&#160;&#160;This&#160;&#160;&#160;command&#160;&#160;&#160;may&#160;&#160;&#160;be&#160;&#160;&#160;called&#160;&#160;&#160;when&#160;</p>
<p style="position:absolute;top:503px;left:85px;white-space:nowrap" class="ft7720"><i>MTM_STANY_FLAG</i></p>
<p style="position:absolute;top:503px;left:253px;white-space:nowrap" class="ft7714">&#160;&#160;-&gt;&#160;&#160;</p>
<p style="position:absolute;top:503px;left:297px;white-space:nowrap" class="ft7720"><i>loadVerificationrootKeyEnabled</i></p>
<p style="position:absolute;top:503px;left:563px;white-space:nowrap" class="ft7714">&#160;&#160;=&#160;&#160;</p>
<p style="position:absolute;top:503px;left:601px;white-space:nowrap" class="ft7720"><i>TRUE</i></p>
<p style="position:absolute;top:503px;left:650px;white-space:nowrap" class="ft7714">,&#160;&#160;else&#160;&#160;&#160;it&#160;&#160;&#160;requires&#160;</p>
<p style="position:absolute;top:523px;left:85px;white-space:nowrap" class="ft7714">MTM&#160;owner&#160;authorisation.</p>
<p style="position:absolute;top:561px;left:134px;white-space:nowrap" class="ft7727"><i>TPM_SetVerifiedPCRSelection</i></p>
<p style="position:absolute;top:587px;left:316px;white-space:nowrap" class="ft773"><b>Table&#160;37:&#160;Setting&#160;verified&#160;PCRs</b></p>
<p style="position:absolute;top:613px;left:85px;white-space:nowrap" class="ft7714">As&#160;&#160;&#160;stated&#160;&#160;&#160;above,&#160;&#160;&#160;the&#160;&#160;</p>
<p style="position:absolute;top:613px;left:277px;white-space:nowrap" class="ft7720"><i>TPM_VerifiyRIMCertAndExtend</i></p>
<p style="position:absolute;top:613px;left:543px;white-space:nowrap" class="ft7714">&#160;&#160;command&#160;&#160;&#160;is&#160;&#160;&#160;used&#160;&#160;&#160;to&#160;&#160;&#160;verify&#160;&#160;&#160;a&#160;</p>
<p style="position:absolute;top:632px;left:85px;white-space:nowrap" class="ft7715">measurement&#160;against&#160;a&#160;RIM&#160;contained&#160;in&#160;the&#160;corresponding&#160;RIM_Cert&#160;and,&#160;given&#160;a&#160;<br/>successful&#160;&#160;&#160;validation,&#160;&#160;&#160;to&#160;&#160;&#160;extend&#160;&#160;&#160;the&#160;&#160;&#160;PCR&#160;&#160;&#160;listed&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;&#160;&#160;RIM_Cert&#160;&#160;&#160;with&#160;&#160;&#160;the&#160;<br/>measurement.</p>
<p style="position:absolute;top:709px;left:134px;white-space:nowrap" class="ft7727"><i>TPM_&#160;VerifiyRIMCertAndExtend</i></p>
<p style="position:absolute;top:735px;left:215px;white-space:nowrap" class="ft773"><b>Table&#160;38:&#160;Measurement&#160;verification&#160;and&#160;PCR&#160;extension</b></p>
<p style="position:absolute;top:761px;left:85px;white-space:nowrap" class="ft7715">Given&#160;the&#160;scenario&#160;in&#160;which&#160;a&#160;corporate&#160;entity&#160;is&#160;the&#160;device&#160;owner&#160;who&#160;requires&#160;all&#160;<br/>device&#160;&#160;&#160;operators&#160;&#160;&#160;(namely&#160;&#160;&#160;employees)&#160;&#160;&#160;to&#160;&#160;&#160;use&#160;&#160;&#160;the&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;&#160;&#160;mechanism&#160;&#160;&#160;and&#160;<br/>assuming&#160;&#160;&#160;therefore&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;device&#160;&#160;&#160;owner&#160;&#160;&#160;has&#160;&#160;&#160;listed&#160;&#160;&#160;the&#160;&#160;&#160;service&#160;&#160;&#160;provider&#160;&#160;&#160;engine&#160;<br/>which</p>
<p style="position:absolute;top:819px;left:155px;white-space:nowrap" class="ft7714">&#160;</p>
<p style="position:absolute;top:819px;left:181px;white-space:nowrap" class="ft7714">provides</p>
<p style="position:absolute;top:819px;left:273px;white-space:nowrap" class="ft7714">&#160;</p>
<p style="position:absolute;top:819px;left:298px;white-space:nowrap" class="ft7714">the</p>
<p style="position:absolute;top:819px;left:345px;white-space:nowrap" class="ft7714">&#160;</p>
<p style="position:absolute;top:819px;left:371px;white-space:nowrap" class="ft7714">secure</p>
<p style="position:absolute;top:819px;left:447px;white-space:nowrap" class="ft7714">&#160;</p>
<p style="position:absolute;top:819px;left:472px;white-space:nowrap" class="ft7714">wallet</p>
<p style="position:absolute;top:819px;left:543px;white-space:nowrap" class="ft7714">&#160;</p>
<p style="position:absolute;top:819px;left:568px;white-space:nowrap" class="ft7714">functionality</p>
<p style="position:absolute;top:819px;left:694px;white-space:nowrap" class="ft7714">&#160;</p>
<p style="position:absolute;top:819px;left:719px;white-space:nowrap" class="ft7714">in</p>
<p style="position:absolute;top:819px;left:756px;white-space:nowrap" class="ft7714">&#160;</p>
<p style="position:absolute;top:819px;left:781px;white-space:nowrap" class="ft7714">the&#160;</p>
<p style="position:absolute;top:838px;left:85px;white-space:nowrap" class="ft7720"><i>DeviceOwner_mandatoryEngineList</i></p>
<p style="position:absolute;top:838px;left:387px;white-space:nowrap" class="ft7714">,&#160;&#160;&#160;and&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;service&#160;&#160;&#160;provider&#160;&#160;&#160;engine&#160;&#160;&#160;is&#160;</p>
<p style="position:absolute;top:857px;left:85px;white-space:nowrap" class="ft7714">supported&#160;by&#160;an&#160;MRTM,&#160;the&#160;secure&#160;boot&#160;of&#160;this&#160;engine&#160;may&#160;proceed&#160;as&#160;follows.</p>
<p style="position:absolute;top:896px;left:85px;white-space:nowrap" class="ft7714">Prior&#160;to&#160;a&#160;secure&#160;boot:</p>
<p style="position:absolute;top:915px;left:112px;white-space:nowrap" class="ft7714">1.&#160;A&#160;service&#160;provider&#160;RVAI&#160;must&#160;be&#160;loaded&#160;using&#160;</p>
<p style="position:absolute;top:915px;left:530px;white-space:nowrap" class="ft7720"><i>MTM_LoadVerificationKey</i></p>
<p style="position:absolute;top:915px;left:749px;white-space:nowrap" class="ft7714">.</p>
<p style="position:absolute;top:934px;left:112px;white-space:nowrap" class="ft7714">2.&#160;Once&#160;the&#160;RVAI&#160;has&#160;been&#160;loaded,&#160;the&#160;flag&#160;which&#160;enables&#160;a&#160;</p>
<p style="position:absolute;top:953px;left:139px;white-space:nowrap" class="ft7720"><i>TPM_VERIFICATION_KEY</i></p>
<p style="position:absolute;top:953px;left:360px;white-space:nowrap" class="ft7714">&#160;to&#160;be&#160;loaded&#160;without&#160;the&#160;completion&#160;of&#160;any&#160;integrity&#160;</p>
<p style="position:absolute;top:973px;left:139px;white-space:nowrap" class="ft7714">checks,&#160;must&#160;be&#160;set&#160;to&#160;false,&#160;</p>
<p style="position:absolute;top:973px;left:381px;white-space:nowrap" class="ft7720"><i>MTM_STANY_FLAGS</i></p>
<p style="position:absolute;top:973px;left:560px;white-space:nowrap" class="ft7714">&#160;-&gt;&#160;</p>
<p style="position:absolute;top:992px;left:139px;white-space:nowrap" class="ft7720"><i>loadVerificationrootKeyEnabled</i></p>
<p style="position:absolute;top:992px;left:405px;white-space:nowrap" class="ft7714">&#160;=&#160;</p>
<p style="position:absolute;top:992px;left:429px;white-space:nowrap" class="ft7720"><i>FALSE</i></p>
<p style="position:absolute;top:992px;left:486px;white-space:nowrap" class="ft7714">,&#160;using&#160;the&#160;</p>
<p style="position:absolute;top:1011px;left:139px;white-space:nowrap" class="ft7720"><i>MTM_LoadVerificationRootKeyDisable</i></p>
<p style="position:absolute;top:1011px;left:462px;white-space:nowrap" class="ft7714">&#160;command.</p>
<p style="position:absolute;top:1030px;left:112px;white-space:nowrap" class="ft7714">3.&#160;MTM&#160;permanent&#160;data&#160;must&#160;be&#160;set:</p>
<p style="position:absolute;top:1049px;left:138px;white-space:nowrap" class="ft7720"><i>MTM_PERMANENT_DATA</i></p>
<p style="position:absolute;top:1049px;left:362px;white-space:nowrap" class="ft7714">&#160;-&gt;</p>
<p style="position:absolute;top:1069px;left:138px;white-space:nowrap" class="ft7720"><i>counterBootstrap</i></p>
<p style="position:absolute;top:1069px;left:285px;white-space:nowrap" class="ft7714">&#160;=&#160;the&#160;current&#160;value&#160;of&#160;the&#160;Bootstrap&#160;counter</p>
<p style="position:absolute;top:1088px;left:138px;white-space:nowrap" class="ft7720"><i>counterRIMProtectId</i></p>
<p style="position:absolute;top:1088px;left:317px;white-space:nowrap" class="ft7714">&#160;=&#160;the&#160;current&#160;value&#160;of&#160;the&#160;RIMProtect&#160;counter</p>
<p style="position:absolute;top:1107px;left:138px;white-space:nowrap" class="ft7720"><i>integrityCheckRootSize</i></p>
<p style="position:absolute;top:1107px;left:337px;white-space:nowrap" class="ft7714">&#160;=&#160;the&#160;size&#160;of&#160;an&#160;integrity&#160;value&#160;for&#160;the&#160;RVAI</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft777">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft777">77/109</p>
</div>
<!-- Page 78 -->
<a name="78"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft7861{font-size:17px;line-height:27px;font-family:EAAAAA+DejaVuSerif;color:#000000;}
-->
</style>
<div id="page78-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application078.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7812">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft780">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft784">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft784">Final</p>
<p style="position:absolute;top:151px;left:138px;white-space:nowrap" class="ft7820"><i>integrityCheckRootData</i></p>
<p style="position:absolute;top:151px;left:341px;white-space:nowrap" class="ft7814">&#160;=&#160;the&#160;value&#160;of&#160;an&#160;integrity&#160;value&#160;for&#160;the&#160;RVAI</p>
<p style="position:absolute;top:170px;left:138px;white-space:nowrap" class="ft7820"><i>internalVerificationData</i></p>
<p style="position:absolute;top:170px;left:340px;white-space:nowrap" class="ft7814">&#160;=&#160;the&#160;engine's&#160;internal&#160;verification&#160;key</p>
<p style="position:absolute;top:189px;left:139px;white-space:nowrap" class="ft7820"><i>verificationAuth</i></p>
<p style="position:absolute;top:189px;left:274px;white-space:nowrap" class="ft7814">&#160;=&#160;the&#160;</p>
<p style="position:absolute;top:189px;left:334px;white-space:nowrap" class="ft7820"><i>verificationAuth</i></p>
<p style="position:absolute;top:189px;left:469px;white-space:nowrap" class="ft7814">&#160;used&#160;to&#160;authorise&#160;</p>
<p style="position:absolute;top:189px;left:629px;white-space:nowrap" class="ft7820"><i>MTM_InstallRIM</i></p>
<p style="position:absolute;top:189px;left:771px;white-space:nowrap" class="ft7814">&#160;and&#160;</p>
<p style="position:absolute;top:209px;left:139px;white-space:nowrap" class="ft7814">updates&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:209px;left:264px;white-space:nowrap" class="ft7820"><i>counterRIMProtect</i></p>
<p style="position:absolute;top:209px;left:426px;white-space:nowrap" class="ft7814">.</p>
<p style="position:absolute;top:228px;left:112px;white-space:nowrap" class="ft7814">4.&#160;While&#160;&#160;&#160;the&#160;&#160;&#160;RVAI&#160;&#160;&#160;may&#160;&#160;&#160;be&#160;&#160;&#160;used&#160;&#160;&#160;either&#160;&#160;&#160;to&#160;&#160;&#160;sign&#160;&#160;&#160;a&#160;&#160;&#160;RIM_Auth_Certs&#160;&#160;&#160;or&#160;&#160;&#160;sign&#160;&#160;&#160;a&#160;</p>
<p style="position:absolute;top:247px;left:139px;white-space:nowrap" class="ft7815">RIM_Cert&#160;&#160;&#160;it&#160;&#160;&#160;is&#160;&#160;&#160;considered&#160;&#160;&#160;best&#160;&#160;&#160;policy&#160;&#160;&#160;to&#160;&#160;&#160;use&#160;&#160;&#160;the&#160;&#160;&#160;RVAI&#160;&#160;&#160;for&#160;&#160;&#160;signing&#160;<br/>RIM_Auth_Certs&#160;only.&#160;<br/>For&#160;this&#160;use-case&#160;we&#160;therefore&#160;require&#160;the&#160;generation&#160;and&#160;upload&#160;of&#160;a&#160;second&#160;<br/>public&#160;key&#160;pair&#160;which&#160;is&#160;then&#160;used&#160;in&#160;order&#160;to&#160;protect&#160;secure&#160;wallet&#160;data&#160;using&#160;</p>
<p style="position:absolute;top:324px;left:139px;white-space:nowrap" class="ft7820"><i>MTM_LoadVerificationKey</i></p>
<p style="position:absolute;top:324px;left:359px;white-space:nowrap" class="ft7814">.</p>
<p style="position:absolute;top:343px;left:112px;white-space:nowrap" class="ft7814">5.&#160;The&#160;&#160;&#160;private&#160;&#160;&#160;key&#160;&#160;&#160;from&#160;&#160;&#160;this&#160;&#160;&#160;newly&#160;&#160;&#160;loaded&#160;&#160;&#160;RIM_Auth&#160;&#160;&#160;key&#160;&#160;&#160;is&#160;&#160;&#160;then&#160;&#160;&#160;used&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;</p>
<p style="position:absolute;top:362px;left:139px;white-space:nowrap" class="ft7815">service&#160;provider&#160;to&#160;sign&#160;an&#160;external&#160;RIM_Cert&#160;for&#160;the&#160;secure&#160;wallet&#160;application.<br/>This&#160;&#160;RIM_Cert&#160;&#160;&#160;must&#160;&#160;&#160;then&#160;&#160;&#160;be&#160;&#160;&#160;installed&#160;&#160;on&#160;&#160;&#160;the&#160;&#160;&#160;service&#160;&#160;&#160;provider&#160;&#160;&#160;engine&#160;&#160;&#160;using&#160;</p>
<p style="position:absolute;top:401px;left:139px;white-space:nowrap" class="ft7820"><i>MTM_InstallRIM.</i></p>
<p style="position:absolute;top:420px;left:112px;white-space:nowrap" class="ft7814">6.&#160;Once&#160;&#160;&#160;an&#160;&#160;&#160;internal&#160;&#160;&#160;RIM_Cert&#160;&#160;&#160;has&#160;&#160;&#160;been&#160;&#160;&#160;created&#160;&#160;&#160;it&#160;&#160;&#160;may&#160;&#160;&#160;be&#160;&#160;&#160;verified&#160;&#160;&#160;within&#160;&#160;&#160;the&#160;</p>
<p style="position:absolute;top:439px;left:139px;white-space:nowrap" class="ft7814">engine&#160;using&#160;the&#160;</p>
<p style="position:absolute;top:439px;left:284px;white-space:nowrap" class="ft7820"><i>MTM_VerifyRIMCert</i></p>
<p style="position:absolute;top:439px;left:459px;white-space:nowrap" class="ft7814">&#160;command.</p>
<p style="position:absolute;top:458px;left:112px;white-space:nowrap" class="ft7814">7.&#160;Finally,&#160;the&#160;MTM&#160;owner&#160;must&#160;specify&#160;the&#160;PCR&#160;which&#160;is&#160;to&#160;be&#160;extended&#160;with&#160;a&#160;</p>
<p style="position:absolute;top:477px;left:139px;white-space:nowrap" class="ft7814">verified&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;&#160;&#160;application&#160;&#160;&#160;measurement&#160;&#160;&#160;using&#160;&#160;&#160;the&#160;</p>
<p style="position:absolute;top:497px;left:139px;white-space:nowrap" class="ft7820"><i>MTM_SetVerifiedPCRSelection</i></p>
<p style="position:absolute;top:497px;left:399px;white-space:nowrap" class="ft7814">&#160;command.</p>
<p style="position:absolute;top:535px;left:85px;white-space:nowrap" class="ft7815">Following&#160;this&#160;the&#160;RTM,&#160;i.e.&#160;the&#160;first&#160;measurement&#160;agent&#160;running&#160;within&#160;an&#160;engine,&#160;<br/>can&#160;retrieve&#160;a&#160;list&#160;of&#160;components&#160;to&#160;be&#160;measured&#160;(for&#160;simplicity&#160;sake,&#160;we&#160;assume&#160;that&#160;<br/>the&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;&#160;&#160;is&#160;&#160;&#160;the&#160;&#160;&#160;only&#160;&#160;&#160;component&#160;&#160;&#160;within&#160;&#160;&#160;this&#160;&#160;&#160;engine&#160;&#160;&#160;to&#160;&#160;&#160;be&#160;&#160;&#160;measured&#160;&#160;&#160;and&#160;<br/>verified)&#160;and&#160;measures&#160;the&#160;first&#160;component.&#160;The&#160;RTV,&#160;i.e.&#160;the&#160;first&#160;verification&#160;engine&#160;<br/>agent&#160;running&#160;within&#160;an&#160;engine,&#160;then&#160;retrieves&#160;the&#160;expected&#160;value&#160;of&#160;the&#160;measured&#160;<br/>component&#160;and&#160;calls&#160;</p>
<p style="position:absolute;top:631px;left:265px;white-space:nowrap" class="ft7820"><i>MTM_VerifyRIMCertAndExtend</i></p>
<p style="position:absolute;top:631px;left:531px;white-space:nowrap" class="ft7814">&#160;which&#160;results&#160;in&#160;the&#160;comparison&#160;</p>
<p style="position:absolute;top:650px;left:85px;white-space:nowrap" class="ft7815">of&#160;&#160;&#160;the&#160;&#160;&#160;calculated&#160;&#160;&#160;measurement&#160;&#160;&#160;against&#160;&#160;&#160;the&#160;&#160;&#160;expected&#160;&#160;&#160;software&#160;&#160;&#160;component's&#160;<br/>measurement.&#160;The&#160;measurement&#160;is&#160;then&#160;stored&#160;to&#160;an&#160;MTM&#160;PCR&#160;by&#160;the&#160;RTS&#160;and&#160;a&#160;<br/>summary&#160;of&#160;the&#160;measurement&#160;stored&#160;to&#160;a&#160;log&#160;file&#160;in&#160;the&#160;engine.&#160;If&#160;at&#160;any&#160;point&#160;the&#160;<br/>expected&#160;value&#160;of&#160;a&#160;software&#160;component&#160;cannot&#160;be&#160;located&#160;or&#160;indeed&#160;an&#160;expected&#160;<br/>value&#160;does&#160;not&#160;match&#160;the&#160;measured&#160;value&#160;then&#160;the&#160;boot&#160;process&#160;is&#160;aborted.</p>
<p style="position:absolute;top:765px;left:85px;white-space:nowrap" class="ft7815">The&#160;exact&#160;process&#160;by&#160;which&#160;a&#160;trusted&#160;mobile&#160;platform&#160;is&#160;securely&#160;booted,&#160;its&#160;integrity&#160;<br/>measured,&#160;verified&#160;and&#160;its&#160;integrity&#160;measurements&#160;stored,&#160;needs&#160;to&#160;be&#160;specified&#160;for&#160;<br/>each&#160;TMP&#160;architecture,&#160;just&#160;as&#160;for&#160;the&#160;PC&#160;client&#160;in&#160;[66].</p>
<p style="position:absolute;top:841px;left:85px;white-space:nowrap" class="ft786"><b>3.3.5&#160;Maintaining&#160;Integrity</b></p>
<p style="position:absolute;top:876px;left:85px;white-space:nowrap" class="ft7815">As&#160;&#160;stated&#160;&#160;in&#160;&#160;the&#160;&#160;&#160;previous&#160;&#160;section,&#160;&#160;TMP&#160;&#160;&#160;engines&#160;&#160;(with&#160;&#160;&#160;the&#160;&#160;&#160;exception&#160;&#160;&#160;of&#160;&#160;the&#160;&#160;&#160;device&#160;<br/>manufacturer&#160;&#160;&#160;engine)&#160;&#160;&#160;are&#160;&#160;&#160;not&#160;&#160;&#160;required&#160;&#160;&#160;to&#160;&#160;&#160;support&#160;&#160;&#160;a&#160;&#160;&#160;RTV.&#160;&#160;&#160;An&#160;&#160;&#160;engine&#160;&#160;&#160;which&#160;&#160;&#160;does&#160;<br/>support&#160;&#160;&#160;a&#160;&#160;&#160;RTV,&#160;&#160;&#160;and&#160;&#160;&#160;therefore&#160;&#160;&#160;a&#160;&#160;&#160;secure&#160;&#160;&#160;boot&#160;&#160;&#160;mechanism,&#160;&#160;&#160;may&#160;&#160;&#160;also&#160;&#160;&#160;support&#160;&#160;&#160;a&#160;<br/>mechanism&#160;which&#160;enables&#160;the&#160;integrity&#160;of&#160;an&#160;engine&#160;to&#160;be&#160;maintained&#160;after&#160;boot.<br/>Within&#160;&#160;&#160;the&#160;&#160;&#160;mobile&#160;&#160;&#160;reference&#160;&#160;&#160;architecture&#160;&#160;[63]&#160;&#160;three&#160;&#160;engine&#160;&#160;&#160;states&#160;&#160;&#160;are&#160;&#160;&#160;described,&#160;<br/>namely&#160;</p>
<p style="position:absolute;top:981px;left:151px;white-space:nowrap" class="ft7820"><i>initialisation</i></p>
<p style="position:absolute;top:981px;left:255px;white-space:nowrap" class="ft7814">,&#160;</p>
<p style="position:absolute;top:981px;left:266px;white-space:nowrap" class="ft7820"><i>success</i></p>
<p style="position:absolute;top:981px;left:330px;white-space:nowrap" class="ft7814">&#160;and&#160;</p>
<p style="position:absolute;top:981px;left:372px;white-space:nowrap" class="ft7820"><i>failed</i></p>
<p style="position:absolute;top:981px;left:418px;white-space:nowrap" class="ft7814">:</p>
<p style="position:absolute;top:1009px;left:112px;white-space:nowrap" class="ft7834">●</p>
<p style="position:absolute;top:1000px;left:139px;white-space:nowrap" class="ft7814">An&#160;&#160;</p>
<p style="position:absolute;top:1000px;left:170px;white-space:nowrap" class="ft7820"><i>initialisation</i></p>
<p style="position:absolute;top:1000px;left:274px;white-space:nowrap" class="ft7814">&#160;&#160;state&#160;&#160;indicates&#160;that&#160;the&#160;RTS&#160;is&#160;not&#160;fully&#160;operational&#160;and&#160;that&#160;</p>
<p style="position:absolute;top:1019px;left:139px;white-space:nowrap" class="ft7814">since&#160;start-up&#160;no&#160;software&#160;measurements&#160;have&#160;yet&#160;been&#160;verified.&#160;</p>
<p style="position:absolute;top:1047px;left:112px;white-space:nowrap" class="ft7834">●</p>
<p style="position:absolute;top:1038px;left:139px;white-space:nowrap" class="ft7814">A&#160;</p>
<p style="position:absolute;top:1038px;left:158px;white-space:nowrap" class="ft7820"><i>success</i></p>
<p style="position:absolute;top:1038px;left:222px;white-space:nowrap" class="ft7814">&#160;state&#160;represents&#160;the&#160;state&#160;of&#160;an&#160;engine&#160;when&#160;the&#160;RTS&#160;is&#160;operational&#160;</p>
<p style="position:absolute;top:1057px;left:139px;white-space:nowrap" class="ft7815">and&#160;all&#160;software&#160;measurements&#160;which&#160;require&#160;verification&#160;have&#160;been&#160;matched&#160;<br/>to&#160;their&#160;corresponding&#160;RIMs.&#160;</p>
<p style="position:absolute;top:1105px;left:112px;white-space:nowrap" class="ft7834">●</p>
<p style="position:absolute;top:1096px;left:139px;white-space:nowrap" class="ft7814">A&#160;</p>
<p style="position:absolute;top:1096px;left:157px;white-space:nowrap" class="ft7820"><i>failed</i></p>
<p style="position:absolute;top:1096px;left:204px;white-space:nowrap" class="ft7814">&#160;state&#160;indicates&#160;that&#160;the&#160;RTS&#160;is&#160;not&#160;operational&#160;(and&#160;cannot&#160;become&#160;so)&#160;</p>
<p style="position:absolute;top:1115px;left:139px;white-space:nowrap" class="ft7814">or&#160;that,&#160;since&#160;start-up,&#160;some&#160;integrity&#160;measurement&#160;which&#160;required&#160;verification&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft787">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft787">78/109</p>
</div>
<!-- Page 79 -->
<a name="79"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page79-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application079.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft7912">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft790">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft794">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft794">Final</p>
<p style="position:absolute;top:151px;left:139px;white-space:nowrap" class="ft7914">has&#160;failed&#160;to&#160;a&#160;match&#160;its&#160;expected&#160;RIM.</p>
<p style="position:absolute;top:179px;left:85px;white-space:nowrap" class="ft7914">Ideally,&#160;&#160;&#160;a&#160;&#160;&#160;platform&#160;&#160;&#160;would&#160;&#160;&#160;remain&#160;&#160;&#160;in&#160;&#160;&#160;a&#160;&#160;</p>
<p style="position:absolute;top:179px;left:432px;white-space:nowrap" class="ft7920"><i>success</i></p>
<p style="position:absolute;top:179px;left:496px;white-space:nowrap" class="ft7914">&#160;&#160;state&#160;&#160;&#160;during&#160;&#160;&#160;run-time.&#160;&#160;&#160;In&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;</p>
<p style="position:absolute;top:198px;left:85px;white-space:nowrap" class="ft7915">achieve&#160;this&#160;a&#160;preventative&#160;approach&#160;is&#160;required&#160;to&#160;run-time&#160;integrity&#160;maintenance.&#160;<br/>Suggested&#160;mechanisms&#160;which&#160;enable&#160;an&#160;engine&#160;to&#160;remain&#160;in&#160;a&#160;</p>
<p style="position:absolute;top:217px;left:628px;white-space:nowrap" class="ft7920"><i>success</i></p>
<p style="position:absolute;top:217px;left:692px;white-space:nowrap" class="ft7914">&#160;state&#160;include&#160;</p>
<p style="position:absolute;top:236px;left:85px;white-space:nowrap" class="ft7914">but&#160;are&#160;not&#160;limited&#160;to&#160;the&#160;following.</p>
<p style="position:absolute;top:282px;left:112px;white-space:nowrap" class="ft7934">●</p>
<p style="position:absolute;top:273px;left:139px;white-space:nowrap" class="ft7915">The&#160;protection&#160;of&#160;critical&#160;functions&#160;using&#160;hardware.&#160;In&#160;this&#160;case&#160;program&#160;code&#160;<br/>or&#160;&#160;&#160;critical&#160;&#160;&#160;data&#160;&#160;&#160;could&#160;&#160;&#160;be&#160;&#160;&#160;stored&#160;&#160;&#160;in&#160;&#160;&#160;Read&#160;&#160;&#160;Only&#160;&#160;&#160;Memory&#160;&#160;&#160;(ROM)&#160;&#160;&#160;or&#160;&#160;&#160;one-time&#160;<br/>programmable&#160;memory,&#160;for&#160;example.</p>
<p style="position:absolute;top:356px;left:112px;white-space:nowrap" class="ft7934">●</p>
<p style="position:absolute;top:347px;left:139px;white-space:nowrap" class="ft7915">Software&#160;may&#160;be&#160;isolated&#160;using&#160;hardware&#160;mechanisms&#160;(whereby&#160;critical&#160;MTM&#160;<br/>functionality&#160;&#160;&#160;is&#160;&#160;&#160;implemented&#160;&#160;&#160;on&#160;&#160;&#160;a&#160;&#160;&#160;separate&#160;&#160;&#160;chip&#160;&#160;&#160;for&#160;&#160;&#160;example)&#160;&#160;&#160;or,&#160;&#160;&#160;indeed,&#160;<br/>software&#160;mechanisms&#160;(through&#160;the&#160;use&#160;of&#160;a&#160;trusted&#160;execution&#160;environment&#160;or&#160;<br/>full&#160;virtualisation).</p>
<p style="position:absolute;top:450px;left:112px;white-space:nowrap" class="ft7934">●</p>
<p style="position:absolute;top:441px;left:139px;white-space:nowrap" class="ft7915">Software&#160;may&#160;be&#160;simplified.&#160;By&#160;reducing&#160;the&#160;complexity&#160;and&#160;size&#160;of&#160;software&#160;it&#160;<br/>becomes&#160;easier&#160;to&#160;make&#160;it&#160;error&#160;free&#160;and&#160;verify&#160;it&#160;as&#160;such.</p>
<p style="position:absolute;top:506px;left:112px;white-space:nowrap" class="ft7934">●</p>
<p style="position:absolute;top:496px;left:139px;white-space:nowrap" class="ft7915">The&#160;installation&#160;of&#160;particular&#160;types&#160;of&#160;software&#160;may&#160;be&#160;heavily&#160;restricted.&#160;For&#160;<br/>example,&#160;&#160;&#160;the&#160;&#160;&#160;installation&#160;&#160;&#160;of&#160;&#160;&#160;native&#160;&#160;&#160;software&#160;&#160;&#160;may&#160;&#160;&#160;not&#160;&#160;&#160;be&#160;&#160;&#160;permitted.&#160;<br/>Alternatively,&#160;an&#160;operating&#160;system&#160;may&#160;enforce&#160;strong&#160;access&#160;controls&#160;which&#160;<br/>restrict&#160;the&#160;installation&#160;of&#160;certain&#160;software.&#160;</p>
<p style="position:absolute;top:599px;left:112px;white-space:nowrap" class="ft7934">●</p>
<p style="position:absolute;top:590px;left:139px;white-space:nowrap" class="ft7915">Certain&#160;&#160;&#160;security&#160;&#160;&#160;checks&#160;&#160;&#160;may&#160;&#160;&#160;be&#160;&#160;&#160;completed&#160;&#160;&#160;on&#160;&#160;&#160;software&#160;&#160;&#160;at&#160;&#160;&#160;installation,&#160;&#160;&#160;for&#160;<br/>example,&#160;&#160;&#160;verification&#160;&#160;&#160;of&#160;&#160;&#160;integrity&#160;&#160;&#160;checks,&#160;&#160;&#160;public&#160;&#160;&#160;key&#160;&#160;&#160;certificates,&#160;&#160;&#160;digital&#160;<br/>signatures&#160;&#160;&#160;and&#160;&#160;&#160;the&#160;&#160;&#160;code&#160;&#160;&#160;itself.&#160;&#160;&#160;Given&#160;&#160;&#160;a&#160;&#160;&#160;failed&#160;&#160;&#160;integrity&#160;&#160;&#160;check,&#160;&#160;&#160;certificate&#160;<br/>revocation,&#160;a&#160;failed&#160;digital&#160;signature&#160;verification&#160;or&#160;indeed&#160;if&#160;on&#160;examination&#160;<br/>code&#160;&#160;&#160;contains&#160;&#160;&#160;the&#160;&#160;&#160;signature&#160;&#160;&#160;of&#160;&#160;&#160;known&#160;&#160;&#160;malware,&#160;&#160;&#160;the&#160;&#160;&#160;application&#160;&#160;&#160;will&#160;&#160;&#160;not&#160;&#160;&#160;be&#160;<br/>loaded&#160;onto&#160;the&#160;device.</p>
<p style="position:absolute;top:722px;left:85px;white-space:nowrap" class="ft7914">Alternatively,&#160;a&#160;platform&#160;may&#160;transition&#160;from&#160;a&#160;</p>
<p style="position:absolute;top:722px;left:490px;white-space:nowrap" class="ft7920"><i>success</i></p>
<p style="position:absolute;top:722px;left:554px;white-space:nowrap" class="ft7914">&#160;state&#160;to&#160;a&#160;</p>
<p style="position:absolute;top:722px;left:647px;white-space:nowrap" class="ft7920"><i>failed</i></p>
<p style="position:absolute;top:722px;left:694px;white-space:nowrap" class="ft7914">&#160;state.&#160;In&#160;this&#160;</p>
<p style="position:absolute;top:741px;left:85px;white-space:nowrap" class="ft7915">case,&#160;&#160;&#160;the&#160;&#160;&#160;transition&#160;&#160;&#160;must&#160;&#160;&#160;be&#160;&#160;&#160;detected&#160;&#160;&#160;and&#160;&#160;&#160;the&#160;&#160;&#160;consequences&#160;&#160;&#160;of&#160;&#160;&#160;such&#160;&#160;&#160;a&#160;&#160;&#160;transition&#160;<br/>limited.&#160;A&#160;reactive&#160;approach&#160;to&#160;run-time&#160;integrity&#160;is&#160;comprised&#160;of&#160;two&#160;elements:&#160;a&#160;<br/>detection&#160;element&#160;and&#160;a&#160;reaction&#160;element.</p>
<p style="position:absolute;top:816px;left:85px;white-space:nowrap" class="ft7915">The&#160;&#160;&#160;detection&#160;&#160;&#160;element&#160;&#160;&#160;described&#160;&#160;&#160;within&#160;&#160;&#160;the&#160;&#160;&#160;mobile&#160;&#160;&#160;reference&#160;&#160;&#160;architecture&#160;&#160;&#160;is&#160;<br/>essentially&#160;an&#160;extension&#160;of&#160;the&#160;secure&#160;boot&#160;mechanism.&#160;It&#160;requires&#160;a&#160;Primary&#160;Run-<br/>time&#160;&#160;&#160;Measurement/Verification&#160;&#160;&#160;Agent&#160;&#160;&#160;(PRMVA)&#160;&#160;&#160;which&#160;&#160;&#160;must&#160;&#160;&#160;reliably&#160;&#160;&#160;measure&#160;&#160;&#160;and&#160;<br/>verify&#160;&#160;&#160;at&#160;&#160;&#160;least&#160;&#160;&#160;one&#160;&#160;&#160;software&#160;&#160;&#160;component&#160;&#160;&#160;running&#160;&#160;&#160;on&#160;&#160;&#160;the&#160;&#160;&#160;host&#160;&#160;&#160;engine.&#160;&#160;&#160;A&#160;&#160;&#160;secondary&#160;<br/>RMVA,&#160;which&#160;is&#160;measured&#160;and&#160;verified&#160;by&#160;the&#160;PRMVA&#160;may&#160;also&#160;exist&#160;if&#160;the&#160;PRMVA&#160;is&#160;<br/>unable&#160;to&#160;perform&#160;all&#160;the&#160;necessary&#160;checks&#160;alone.<br/>The&#160;expected&#160;runtime&#160;RIM&#160;of&#160;a&#160;software&#160;component&#160;may&#160;be&#160;different&#160;to&#160;the&#160;expected&#160;<br/>boot&#160;time&#160;RIM.&#160;Therefore,&#160;run-time&#160;measurements&#160;are&#160;verified&#160;against&#160;run-time&#160;RIMs&#160;<br/>contained&#160;within&#160;RIM_run&#160;Certs.&#160;A&#160;RIM_run&#160;Cert&#160;may&#160;be&#160;classified&#160;as&#160;external&#160;or&#160;<br/>internal&#160;and&#160;may&#160;be&#160;in&#160;the&#160;form&#160;of&#160;a&#160;RIM_Cert&#160;or&#160;indeed&#160;in&#160;a&#160;proprietary&#160;format.&#160;An&#160;<br/>external&#160;RIM_run&#160;Cert&#160;may&#160;be&#160;created&#160;by&#160;the&#160;engine's&#160;stakeholder&#160;and&#160;input&#160;into&#160;the&#160;<br/>device.&#160;&#160;&#160;Alternatively,&#160;&#160;&#160;RIM_run&#160;&#160;&#160;Certs&#160;&#160;&#160;may&#160;&#160;&#160;be&#160;&#160;&#160;generated&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;engine&#160;&#160;&#160;itself&#160;&#160;&#160;by&#160;<br/>measuring&#160;each&#160;code&#160;image&#160;just&#160;after&#160;it&#160;has&#160;been&#160;launched.&#160;It&#160;is&#160;pivotal,&#160;however,&#160;<br/>that&#160;every&#160;effort&#160;is&#160;made&#160;to&#160;ensure&#160;that&#160;false&#160;negatives&#160;between&#160;run-time&#160;software&#160;<br/>component&#160;measurements&#160;and&#160;RIM_run&#160;Certs&#160;are&#160;avoided.&#160;In&#160;order&#160;to&#160;achieve&#160;this&#160;a&#160;<br/>software&#160;image&#160;may&#160;be&#160;loaded&#160;into&#160;the&#160;same&#160;memory&#160;location&#160;each&#160;time,&#160;for&#160;example,&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft797">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft797">79/109</p>
</div>
<!-- Page 80 -->
<a name="80"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page80-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application080.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft8012">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft800">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft804">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft804">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft8015">or&#160;the&#160;static&#160;part&#160;of&#160;a&#160;software&#160;component&#160;may&#160;be&#160;measured&#160;as&#160;opposed&#160;to&#160;the&#160;entire&#160;<br/>component.</p>
<p style="position:absolute;top:209px;left:85px;white-space:nowrap" class="ft8015">An&#160;engine's&#160;stakeholder&#160;specifies&#160;how&#160;often&#160;and/or&#160;under&#160;what&#160;conditions&#160;runtime&#160;<br/>measurement&#160;&#160;&#160;and&#160;&#160;&#160;verification&#160;&#160;&#160;occurs.&#160;&#160;&#160;Policies&#160;&#160;&#160;for&#160;&#160;&#160;run-time&#160;&#160;&#160;measurement&#160;&#160;&#160;and&#160;<br/>verification&#160;&#160;&#160;essentially&#160;&#160;&#160;fall&#160;&#160;&#160;into&#160;&#160;&#160;one&#160;&#160;&#160;of&#160;&#160;&#160;two&#160;&#160;&#160;classes,&#160;&#160;&#160;time-based&#160;&#160;&#160;checks&#160;&#160;&#160;which&#160;&#160;&#160;are&#160;<br/>completed&#160;at&#160;regular&#160;intervals&#160;or&#160;alternatively,&#160;event-based&#160;checks.</p>
<p style="position:absolute;top:303px;left:85px;white-space:nowrap" class="ft806"><b>3.3.6&#160;Secure&#160;Storage</b></p>
<p style="position:absolute;top:330px;left:85px;white-space:nowrap" class="ft8014">Requirements&#160;</p>
<p style="position:absolute;top:330px;left:210px;white-space:nowrap" class="ft8021"><b>SecureWallet3</b></p>
<p style="position:absolute;top:330px;left:345px;white-space:nowrap" class="ft8014">&#160;to&#160;</p>
<p style="position:absolute;top:330px;left:375px;white-space:nowrap" class="ft8021"><b>SecureWallet14</b></p>
<p style="position:absolute;top:330px;left:521px;white-space:nowrap" class="ft8014">&#160;can&#160;be&#160;partially&#160;met&#160;through&#160;the&#160;</p>
<p style="position:absolute;top:349px;left:85px;white-space:nowrap" class="ft8014">deployment&#160;of&#160;a&#160;secure&#160;storage&#160;mechanism.</p>
<p style="position:absolute;top:387px;left:85px;white-space:nowrap" class="ft806"><b>3.3.6.1&#160;Key&#160;Hierarchy</b></p>
<p style="position:absolute;top:413px;left:85px;white-space:nowrap" class="ft8015">Each&#160;TMP&#160;stakeholder&#160;can&#160;incorporate&#160;his&#160;own&#160;key&#160;hierarchy.&#160;Here&#160;the&#160;focus&#160;is&#160;on&#160;<br/>the&#160;secure&#160;wallet&#160;provider.&#160;A&#160;sample&#160;key&#160;hierarchy&#160;from&#160;a&#160;secure&#160;wallet&#160;provider&#160;<br/>engine&#160;is&#160;represented&#160;in&#160;figur<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#80">e&#160;25.</a></p>
<p style="position:absolute;top:922px;left:145px;white-space:nowrap" class="ft803"><b>Figure&#160;25:&#160;A&#160;sample&#160;key&#160;hierarchy&#160;from&#160;a&#160;secure&#160;wallet&#160;provider&#160;engine</b></p>
<p style="position:absolute;top:977px;left:85px;white-space:nowrap" class="ft806"><b>3.3.6.2&#160;Installing&#160;Integrity&#160;and&#160;Confidentiality&#160;Sensitive&#160;Data</b></p>
<p style="position:absolute;top:1003px;left:85px;white-space:nowrap" class="ft8015">In&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;&#160;&#160;import&#160;&#160;&#160;sensitive&#160;&#160;&#160;data&#160;&#160;&#160;into&#160;&#160;&#160;a&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;&#160;&#160;for&#160;&#160;&#160;protection,&#160;&#160;&#160;a&#160;&#160;&#160;secure&#160;<br/>transport&#160;session&#160;can&#160;be&#160;set&#160;up&#160;with&#160;the&#160;engine's&#160;MTM&#160;so&#160;that&#160;all&#160;input&#160;parameters&#160;<br/>into&#160;&#160;the&#160;&#160;&#160;secure&#160;&#160;&#160;storage&#160;&#160;&#160;commands&#160;&#160;described&#160;&#160;below&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;protected&#160;&#160;while&#160;&#160;&#160;being&#160;<br/>communicated&#160;to&#160;the&#160;MTM.</p>
<p style="position:absolute;top:1099px;left:85px;white-space:nowrap" class="ft8014">Transport&#160;security&#160;enables&#160;the&#160;establishment&#160;of&#160;a&#160;secure&#160;channel&#160;between&#160;the&#160;MTM&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft807">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft807">80/109</p>
</div>
<!-- Page 81 -->
<a name="81"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft8162{font-size:17px;font-family:NAAAAA+PalatinoLinotype;color:#000000;}
-->
</style>
<div id="page81-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application081.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft8112">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft810">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft814">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft814">Final</p>
<p style="position:absolute;top:153px;left:85px;white-space:nowrap" class="ft8114">and&#160;secure&#160;processes,&#160;o</p>
<p style="position:absolute;top:151px;left:292px;white-space:nowrap" class="ft8162">ff</p>
<p style="position:absolute;top:153px;left:303px;white-space:nowrap" class="ft8114">ering&#160;confidentiality&#160;and&#160;integrity&#160;protection&#160;of&#160;commands&#160;</p>
<p style="position:absolute;top:173px;left:85px;white-space:nowrap" class="ft8115">sent&#160;to&#160;the&#160;MTM.&#160;It&#160;also&#160;provides&#160;a&#160;logging&#160;function&#160;such&#160;that&#160;all&#160;commands&#160;sent&#160;to&#160;<br/>the&#160;MTM&#160;during&#160;a&#160;transport&#160;session&#160;can&#160;be&#160;recorded.</p>
<p style="position:absolute;top:231px;left:85px;white-space:nowrap" class="ft8115">Session&#160;establishment&#160;involves&#160;the&#160;generation&#160;of&#160;20&#160;bytes&#160;of&#160;transport&#160;authorisation&#160;<br/>data&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;caller,&#160;&#160;&#160;for&#160;&#160;&#160;use&#160;&#160;&#160;between&#160;&#160;&#160;the&#160;&#160;&#160;caller&#160;&#160;&#160;and&#160;&#160;&#160;the&#160;&#160;&#160;MTM.&#160;&#160;&#160;This&#160;&#160;&#160;transport&#160;<br/>authorisation&#160;data&#160;has&#160;two&#160;purposes:</p>
<p style="position:absolute;top:298px;left:112px;white-space:nowrap" class="ft8134">●</p>
<p style="position:absolute;top:289px;left:139px;white-space:nowrap" class="ft8115">It&#160;is&#160;used&#160;to&#160;generate&#160;a&#160;secret&#160;key&#160;for&#160;use&#160;in&#160;encrypting&#160;commands&#160;from&#160;the&#160;<br/>application&#160;to&#160;the&#160;MTM;&#160;and</p>
<p style="position:absolute;top:336px;left:112px;white-space:nowrap" class="ft8134">●</p>
<p style="position:absolute;top:327px;left:139px;white-space:nowrap" class="ft8115">It&#160;is&#160;also&#160;used&#160;to&#160;generate&#160;a&#160;secret&#160;HMAC&#160;key&#160;to&#160;provide&#160;origin&#160;authentication&#160;<br/>and&#160;integrity&#160;protection&#160;for&#160;the&#160;</p>
<p style="position:absolute;top:346px;left:406px;white-space:nowrap" class="ft8120"><i>TPM_ExecuteTransport</i></p>
<p style="position:absolute;top:346px;left:603px;white-space:nowrap" class="ft8114">&#160;command.</p>
<p style="position:absolute;top:385px;left:85px;white-space:nowrap" class="ft8115">The&#160;authorisation&#160;data&#160;is&#160;generated&#160;by&#160;the&#160;caller&#160;and&#160;encrypted&#160;under&#160;a&#160;public&#160;key&#160;<br/>whose&#160;&#160;&#160;corresponding&#160;&#160;&#160;private&#160;&#160;&#160;key&#160;&#160;&#160;is&#160;&#160;&#160;available&#160;&#160;&#160;only&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;MTM.&#160;&#160;&#160;The&#160;&#160;&#160;key&#160;&#160;&#160;used&#160;&#160;&#160;is&#160;<br/>pointed&#160;to&#160;in&#160;the&#160;</p>
<p style="position:absolute;top:423px;left:229px;white-space:nowrap" class="ft8120"><i>encHandle</i></p>
<p style="position:absolute;top:423px;left:319px;white-space:nowrap" class="ft8114">&#160;field&#160;of&#160;the&#160;</p>
<p style="position:absolute;top:423px;left:420px;white-space:nowrap" class="ft8120"><i>TPM_EstablishTransport</i></p>
<p style="position:absolute;top:423px;left:627px;white-space:nowrap" class="ft8114">&#160;command.</p>
<p style="position:absolute;top:461px;left:85px;white-space:nowrap" class="ft8115">A&#160;transport&#160;session&#160;is&#160;established,&#160;used&#160;and&#160;terminated&#160;using&#160;the&#160;commands&#160;shown&#160;<br/>in&#160;table<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#81">&#160;39.</a></p>
<p style="position:absolute;top:519px;left:139px;white-space:nowrap" class="ft813"><b>Establish&#160;transport&#160;session:</b></p>
<p style="position:absolute;top:554px;left:139px;white-space:nowrap" class="ft8127"><i>TPM_EstablishTransport</i></p>
<p style="position:absolute;top:589px;left:139px;white-space:nowrap" class="ft813"><b>Execute&#160;transport&#160;session:</b></p>
<p style="position:absolute;top:624px;left:139px;white-space:nowrap" class="ft8127"><i>TPM_ExecuteTransport</i></p>
<p style="position:absolute;top:659px;left:139px;white-space:nowrap" class="ft813"><b>Close&#160;transport&#160;session:</b></p>
<p style="position:absolute;top:694px;left:139px;white-space:nowrap" class="ft8110">This&#160;command&#160;completes&#160;the&#160;transport&#160;session,&#160;and&#160;if&#160;logging&#160;is&#160;switched&#160;on,&#160;a&#160;<br/>signed&#160;hash&#160;of&#160;all&#160;operations&#160;completed&#160;during&#160;the&#160;session&#160;is&#160;output.&#160;In&#160;order&#160;to&#160;</p>
<p style="position:absolute;top:729px;left:139px;white-space:nowrap" class="ft8110">complete&#160;&#160;&#160;this&#160;&#160;&#160;command&#160;&#160;&#160;run,&#160;&#160;&#160;a&#160;&#160;&#160;signing&#160;&#160;&#160;key&#160;&#160;&#160;must&#160;&#160;&#160;have&#160;&#160;&#160;been&#160;&#160;&#160;created&#160;&#160;&#160;for&#160;&#160;&#160;this&#160;<br/>purpose&#160;and&#160;its&#160;handle&#160;communicated&#160;as&#160;input&#160;to&#160;the:</p>
<p style="position:absolute;top:782px;left:139px;white-space:nowrap" class="ft8127"><i>TPM_ReleaseTransportSigned</i></p>
<p style="position:absolute;top:827px;left:323px;white-space:nowrap" class="ft816"><b>Table&#160;39:</b></p>
<p style="position:absolute;top:827px;left:402px;white-space:nowrap" class="ft813"><b>&#160;A&#160;transport&#160;session</b></p>
<p style="position:absolute;top:853px;left:85px;white-space:nowrap" class="ft8115">If&#160;an&#160;inherent&#160;confidentiality-protected&#160;channel&#160;exists&#160;between&#160;the&#160;MTM&#160;and&#160;its&#160;RTM&#160;<br/>and&#160;RTV&#160;transport&#160;session&#160;functionality&#160;is&#160;considered&#160;optional&#160;on&#160;both&#160;an&#160;MRTM&#160;and&#160;<br/>an&#160;MLTM.&#160;Else&#160;this&#160;functionality&#160;is&#160;required&#160;in&#160;both&#160;cases.</p>
<p style="position:absolute;top:929px;left:85px;white-space:nowrap" class="ft816"><b>3.3.6.3&#160;Secure&#160;Storage&#160;of&#160;and&#160;Access&#160;Control&#160;to&#160;Sensitive&#160;Data</b></p>
<p style="position:absolute;top:955px;left:85px;white-space:nowrap" class="ft8115">Data&#160;which&#160;needs&#160;to&#160;be&#160;both&#160;integrity&#160;and&#160;confidentiality&#160;protected,&#160;may&#160;be&#160;MACed&#160;<br/>and&#160;encrypted&#160;using&#160;cryptographic&#160;functionality&#160;provided&#160;for&#160;by&#160;a&#160;TCG&#160;independent&#160;<br/>Cryptographic&#160;&#160;Infrastructure&#160;&#160;(CI)&#160;&#160;implemented&#160;&#160;on&#160;&#160;the&#160;&#160;platform.&#160;&#160;This&#160;&#160;CI&#160;may&#160;&#160;then&#160;<br/>utilise&#160;the&#160;MTM&#160;so&#160;that&#160;a&#160;</p>
<p style="position:absolute;top:1013px;left:309px;white-space:nowrap" class="ft8120"><i>TPM_Seal</i></p>
<p style="position:absolute;top:1013px;left:392px;white-space:nowrap" class="ft8114">&#160;can&#160;be&#160;called&#160;and&#160;the&#160;MAC&#160;and&#160;encryption&#160;keys&#160;</p>
<p style="position:absolute;top:1032px;left:85px;white-space:nowrap" class="ft8115">stored&#160;&#160;&#160;securely,&#160;&#160;&#160;where&#160;&#160;&#160;the&#160;&#160;&#160;sealing&#160;&#160;&#160;mechanism&#160;&#160;&#160;can&#160;&#160;&#160;confidentiality&#160;&#160;&#160;protect&#160;&#160;&#160;the&#160;<br/>symmetric&#160;&#160;&#160;keys&#160;&#160;&#160;and&#160;&#160;&#160;ensure&#160;&#160;&#160;that&#160;&#160;&#160;they&#160;&#160;&#160;are&#160;&#160;&#160;only&#160;&#160;&#160;accessible&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;legitimate&#160;<br/>application,&#160;namely&#160;the&#160;secure&#160;wallet&#160;application.</p>
<p style="position:absolute;top:1109px;left:85px;white-space:nowrap" class="ft8114">Alternatively,&#160;&#160;&#160;sensitive&#160;&#160;&#160;data&#160;&#160;&#160;which&#160;&#160;&#160;needs&#160;&#160;&#160;to&#160;&#160;&#160;be&#160;&#160;&#160;both&#160;&#160;&#160;integrity&#160;&#160;&#160;and&#160;&#160;&#160;confidentiality&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft817">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft817">81/109</p>
</div>
<!-- Page 82 -->
<a name="82"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page82-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application082.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft8212">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft820">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft824">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft824">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft8215">protected,&#160;may&#160;be&#160;directly&#160;sealed&#160;by&#160;the&#160;MTM&#160;such&#160;that&#160;it&#160;is&#160;only&#160;accessible&#160;to&#160;a&#160;<br/>particular&#160;legitimate&#160;secure&#160;wallet&#160;application.</p>
<p style="position:absolute;top:209px;left:85px;white-space:nowrap" class="ft8215">Integrity&#160;protection&#160;is&#160;not&#160;explicitly&#160;provided&#160;by&#160;the&#160;sealing&#160;mechanism.&#160;In&#160;order&#160;to&#160;<br/>integrity&#160;protect&#160;sealed&#160;data,&#160;20&#160;bytes&#160;of&#160;authorisation&#160;data&#160;needs&#160;to&#160;be&#160;associated&#160;<br/>with&#160;it.&#160;This&#160;authorisation&#160;data&#160;then&#160;needs&#160;to&#160;be&#160;sealed&#160;to&#160;a&#160;particular&#160;application&#160;(or&#160;<br/>PCR&#160;values&#160;which&#160;represent&#160;a&#160;trustworthy&#160;platform&#160;environment&#160;in&#160;which&#160;a&#160;correctly&#160;<br/>functioning&#160;version&#160;&#160;of&#160;the&#160;particular&#160;application&#160;&#160;is&#160;running).&#160;In&#160;this&#160;way,&#160;only&#160;&#160;the&#160;<br/>correctly&#160;functioning&#160;application&#160;can&#160;unseal&#160;the&#160;authorisation&#160;data&#160;and&#160;then&#160;unseal&#160;<br/>the&#160;protected&#160;data.&#160;Data&#160;protected&#160;in&#160;this&#160;way&#160;can&#160;only&#160;be&#160;unsealed&#160;if&#160;knowledge&#160;of&#160;<br/>the&#160;correct&#160;authorisation&#160;data&#160;is&#160;demonstrated&#160;and&#160;the&#160;current&#160;platform&#160;environment&#160;<br/>is&#160;represented&#160;by&#160;the&#160;PCR&#160;values&#160;bound&#160;to&#160;the&#160;data&#160;when&#160;it&#160;was&#160;sealed.</p>
<p style="position:absolute;top:401px;left:85px;white-space:nowrap" class="ft8215">In&#160;&#160;&#160;order&#160;&#160;to&#160;&#160;protect&#160;&#160;data&#160;&#160;input&#160;&#160;to&#160;&#160;the&#160;&#160;secure&#160;&#160;wallet,&#160;&#160;&#160;a&#160;key&#160;&#160;hierarchy&#160;&#160;&#160;as&#160;&#160;described&#160;<br/>above&#160;must&#160;initially&#160;be&#160;set-up&#160;and&#160;then&#160;the&#160;data&#160;sealed&#160;to&#160;the&#160;appropriate&#160;PCRs&#160;using&#160;<br/>the&#160;'Secure&#160;Wallet&#160;Storage&#160;Key&#160;(SWSK)'&#160;(a&#160;non-migratable&#160;storage&#160;key)&#160;such&#160;that&#160;it&#160;<br/>can&#160;only&#160;be&#160;accessed&#160;by&#160;the&#160;secure&#160;wallet&#160;application.&#160;</p>
<p style="position:absolute;top:497px;left:112px;white-space:nowrap" class="ft8215">1.&#160;Load&#160;the&#160;secure&#160;wallet&#160;provider&#160;SRK&#160;and&#160;obtain&#160;a&#160;handle&#160;to&#160;the&#160;SRK.&#160;<br/>2.&#160;The&#160;secure&#160;wallet&#160;storage&#160;key&#160;needs&#160;to&#160;be&#160;created&#160;under&#160;the&#160;secure&#160;wallet&#160;</p>
<p style="position:absolute;top:535px;left:139px;white-space:nowrap" class="ft8214">SRK,&#160;as&#160;shown&#160;in&#160;table<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#82">&#160;40.</a></p>
<p style="position:absolute;top:574px;left:140px;white-space:nowrap" class="ft8227"><i>TPM_CreateWrapKey</i></p>
<p style="position:absolute;top:602px;left:321px;white-space:nowrap" class="ft826"><b>Table&#160;40:</b></p>
<p style="position:absolute;top:602px;left:399px;white-space:nowrap" class="ft823"><b>&#160;Creating&#160;a&#160;wrap&#160;key</b></p>
<p style="position:absolute;top:628px;left:112px;white-space:nowrap" class="ft8214">3.&#160;Load&#160;the&#160;SWSK,&#160;as&#160;shown&#160;in&#160;table<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#82">&#160;41.</a></p>
<p style="position:absolute;top:667px;left:142px;white-space:nowrap" class="ft8227"><i>TPM_LoadKey2</i></p>
<p style="position:absolute;top:696px;left:347px;white-space:nowrap" class="ft826"><b>Table&#160;41:</b></p>
<p style="position:absolute;top:696px;left:425px;white-space:nowrap" class="ft823"><b>&#160;Loading&#160;a&#160;key</b></p>
<p style="position:absolute;top:722px;left:112px;white-space:nowrap" class="ft8214">4.&#160;Finally,&#160;seal&#160;the&#160;secure&#160;wallet&#160;sensitive&#160;data&#160;or,&#160;indeed,&#160;the&#160;symmetric&#160;keys&#160;</p>
<p style="position:absolute;top:741px;left:139px;white-space:nowrap" class="ft8215">used&#160;to&#160;confidentiality&#160;and&#160;integrity-protect&#160;the&#160;secure&#160;wallet&#160;sensitive&#160;data,&#160;<br/>using&#160;the&#160;SWSK,&#160;as&#160;shown&#160;in&#160;table<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#82">&#160;42.</a></p>
<p style="position:absolute;top:799px;left:149px;white-space:nowrap" class="ft8227"><i>TPM_Seal</i></p>
<p style="position:absolute;top:827px;left:268px;white-space:nowrap" class="ft826"><b>Table&#160;42:</b></p>
<p style="position:absolute;top:827px;left:347px;white-space:nowrap" class="ft823"><b>&#160;Sealing&#160;data&#160;using&#160;a&#160;storage&#160;key</b></p>
<p style="position:absolute;top:873px;left:85px;white-space:nowrap" class="ft8215">Secure&#160;&#160;&#160;storage&#160;&#160;&#160;functionality,&#160;&#160;&#160;as&#160;&#160;&#160;described&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;TCG,&#160;&#160;&#160;cannot&#160;&#160;&#160;prevent&#160;&#160;&#160;the&#160;<br/>unauthorised&#160;deletion&#160;of&#160;stored&#160;data.&#160;Both&#160;an&#160;MRTM&#160;and&#160;an&#160;MLTM&#160;are&#160;required&#160;to&#160;<br/>implement&#160;the&#160;commands&#160;shown&#160;in&#160;table<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#82">&#160;40,&#160;41&#160;</a>and<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#82">&#160;42.</a>&#160;</p>
<p style="position:absolute;top:948px;left:85px;white-space:nowrap" class="ft826"><b>3.3.6.4&#160;Security&#160;of&#160;the&#160;Secure&#160;Wallet&#160;Sensitive&#160;Data&#160;While&#160;in&#160;Use</b></p>
<p style="position:absolute;top:975px;left:85px;white-space:nowrap" class="ft8215">The&#160;PCRs&#160;which&#160;represent&#160;the&#160;execution&#160;environment&#160;into&#160;which&#160;the&#160;secure&#160;wallet&#160;<br/>data&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;released&#160;&#160;&#160;are&#160;&#160;&#160;presumed&#160;&#160;&#160;to&#160;&#160;&#160;represent&#160;&#160;&#160;be&#160;&#160;&#160;a&#160;&#160;&#160;secure&#160;&#160;&#160;and&#160;&#160;&#160;trustworthy&#160;<br/>environment.&#160;&#160;&#160;Isolation&#160;&#160;&#160;techniques&#160;&#160;&#160;described&#160;&#160;&#160;in&#160;&#160;&#160;chapter&#160;&#160;&#160;2&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;used&#160;&#160;&#160;to&#160;&#160;&#160;protect&#160;<br/>sensitive&#160;secure&#160;wallet&#160;data&#160;while&#160;in&#160;use&#160;on&#160;the&#160;platform.</p>
<p style="position:absolute;top:1070px;left:85px;white-space:nowrap" class="ft826"><b>3.3.7&#160;Demonstrating&#160;Privilege</b></p>
<p style="position:absolute;top:1096px;left:85px;white-space:nowrap" class="ft8215">In&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;&#160;&#160;demonstrate&#160;&#160;&#160;the&#160;&#160;&#160;level&#160;&#160;&#160;of&#160;&#160;&#160;privilege&#160;&#160;&#160;required&#160;&#160;&#160;to&#160;&#160;&#160;execute&#160;&#160;&#160;various&#160;&#160;&#160;MTM&#160;<br/>commands:</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft827">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft827">82/109</p>
</div>
<!-- Page 83 -->
<a name="83"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page83-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application083.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft8312">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft830">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft834">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft834">Final</p>
<p style="position:absolute;top:160px;left:112px;white-space:nowrap" class="ft8334">●</p>
<p style="position:absolute;top:151px;left:139px;white-space:nowrap" class="ft8314">An&#160;entity&#160;may&#160;demonstrate&#160;physical&#160;presence&#160;at&#160;the&#160;platform;&#160;or,&#160;alternatively,</p>
<p style="position:absolute;top:180px;left:112px;white-space:nowrap" class="ft8334">●</p>
<p style="position:absolute;top:170px;left:139px;white-space:nowrap" class="ft8314">An&#160;entity&#160;may&#160;demonstrate&#160;knowledge&#160;of&#160;the&#160;required&#160;authorisation&#160;data.</p>
<p style="position:absolute;top:209px;left:85px;white-space:nowrap" class="ft8315">There&#160;are&#160;three&#160;particular&#160;occasions&#160;where&#160;demonstration&#160;of&#160;physical&#160;presence&#160;at&#160;the&#160;<br/>platform&#160;may&#160;be&#160;necessary&#160;in&#160;order&#160;to&#160;execute&#160;particular&#160;MLTM&#160;commands.&#160;These&#160;<br/>occasions&#160;include&#160;the&#160;operation&#160;of&#160;commands&#160;that&#160;control&#160;the&#160;MLTM&#160;when&#160;the&#160;MLTM&#160;<br/>owner&#160;&#160;&#160;has&#160;&#160;&#160;lost&#160;&#160;&#160;cryptographic&#160;&#160;&#160;authorisation&#160;&#160;&#160;information;&#160;&#160;&#160;to&#160;&#160;&#160;authorise&#160;&#160;&#160;an&#160;&#160;&#160;MLTM&#160;<br/>command&#160;in&#160;a&#160;way&#160;that&#160;can&#160;not&#160;be&#160;subverted&#160;by&#160;rogue&#160;software;&#160;or&#160;to&#160;temporarily&#160;<br/>deactivate&#160;an&#160;MLTM.</p>
<p style="position:absolute;top:343px;left:85px;white-space:nowrap" class="ft8315">Physical&#160;presence&#160;must&#160;not,&#160;however,&#160;be&#160;supported&#160;in&#160;an&#160;MRTM&#160;as&#160;the&#160;entity&#160;who&#160;is&#160;<br/>in&#160;control&#160;of&#160;the&#160;engine&#160;is&#160;assumed&#160;to&#160;be&#160;absent&#160;and&#160;the&#160;operator&#160;of&#160;the&#160;phone&#160;is&#160;not&#160;<br/>considered&#160;to&#160;be&#160;in&#160;control&#160;of&#160;the&#160;phone.&#160;In&#160;conjunction&#160;with&#160;this,&#160;owner&#160;authorised&#160;<br/>commands&#160;may&#160;not&#160;be&#160;implemented&#160;on&#160;a&#160;mandatory&#160;engine&#160;and&#160;if&#160;owner&#160;authorised&#160;<br/>commands&#160;&#160;&#160;are&#160;&#160;&#160;implemented&#160;&#160;&#160;it&#160;&#160;&#160;is&#160;&#160;&#160;assumed&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;owner-authorisation&#160;&#160;&#160;data&#160;&#160;&#160;is&#160;<br/>backed-up&#160;remotely.</p>
<p style="position:absolute;top:477px;left:85px;white-space:nowrap" class="ft8315">As&#160;an&#160;alternative&#160;to&#160;physical&#160;presence,&#160;cryptographic&#160;authorisation&#160;mechanisms&#160;may&#160;<br/>be&#160;used&#160;to&#160;authenticate&#160;an&#160;owner&#160;to&#160;their&#160;MTM,&#160;or&#160;to&#160;authorise&#160;the&#160;release&#160;and&#160;use&#160;of&#160;<br/>MTM&#160;protected&#160;objects.&#160;An&#160;authorisation&#160;value&#160;must&#160;be&#160;20&#160;bytes&#160;long,&#160;for&#160;example,&#160;a&#160;<br/>hashed&#160;password&#160;or&#160;20&#160;bytes&#160;from&#160;a&#160;smartcard.&#160;It&#160;must&#160;always&#160;be&#160;treated&#160;as&#160;shielded&#160;<br/>data&#160;and&#160;only&#160;ever&#160;used&#160;in&#160;the&#160;authorisation&#160;process.</p>
<p style="position:absolute;top:593px;left:85px;white-space:nowrap" class="ft8315">Many&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;MTM&#160;&#160;&#160;commands&#160;&#160;&#160;described&#160;&#160;&#160;throughout&#160;&#160;&#160;this&#160;&#160;&#160;chapter&#160;&#160;(specifically&#160;&#160;&#160;the&#160;<br/>MTM&#160;&#160;&#160;owner&#160;&#160;&#160;authorised&#160;&#160;&#160;commands)&#160;&#160;may&#160;&#160;&#160;require&#160;&#160;&#160;knowledge&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;required&#160;<br/>authorisation&#160;&#160;&#160;data&#160;&#160;&#160;to&#160;&#160;&#160;be&#160;&#160;&#160;demonstrated&#160;&#160;&#160;before&#160;&#160;&#160;access&#160;&#160;&#160;to&#160;&#160;&#160;either&#160;&#160;&#160;an&#160;&#160;&#160;MTM&#160;&#160;&#160;owner&#160;<br/>authorised&#160;&#160;&#160;command,&#160;&#160;&#160;a&#160;&#160;&#160;key&#160;&#160;&#160;or&#160;&#160;&#160;even&#160;&#160;&#160;a&#160;&#160;&#160;data&#160;&#160;&#160;object&#160;&#160;&#160;is&#160;&#160;&#160;permitted.&#160;&#160;&#160;A&#160;&#160;&#160;variety&#160;&#160;&#160;of&#160;<br/>authorisation&#160;data&#160;is&#160;held&#160;by&#160;an&#160;MTM,&#160;including:</p>
<p style="position:absolute;top:698px;left:112px;white-space:nowrap" class="ft8334">●</p>
<p style="position:absolute;top:689px;left:139px;white-space:nowrap" class="ft8315">Unique&#160;MTM&#160;owner&#160;authorisation&#160;data,&#160;input&#160;of&#160;which&#160;is&#160;required&#160;before&#160;any&#160;<br/>'owner-authorised&#160;MTM&#160;command'&#160;may&#160;be&#160;executed;</p>
<p style="position:absolute;top:736px;left:112px;white-space:nowrap" class="ft8334">●</p>
<p style="position:absolute;top:727px;left:139px;white-space:nowrap" class="ft8315">MTM&#160;&#160;object&#160;&#160;&#160;usage&#160;&#160;&#160;authorisation&#160;&#160;&#160;data,&#160;&#160;input&#160;&#160;&#160;of&#160;&#160;which&#160;&#160;is&#160;required&#160;before&#160;&#160;an&#160;<br/>object&#160;protected&#160;by&#160;the&#160;MTM&#160;may&#160;be&#160;accessed;&#160;and</p>
<p style="position:absolute;top:775px;left:112px;white-space:nowrap" class="ft8334">●</p>
<p style="position:absolute;top:765px;left:139px;white-space:nowrap" class="ft8315">MTM&#160;object&#160;migration&#160;authorisation&#160;data,&#160;input&#160;of&#160;which&#160;is&#160;required&#160;before&#160;an&#160;<br/>MTM&#160;key&#160;object&#160;can&#160;be&#160;migrated.</p>
<p style="position:absolute;top:823px;left:85px;white-space:nowrap" class="ft8315">In&#160;order&#160;to&#160;demonstrate&#160;knowledge&#160;of&#160;the&#160;relevant&#160;authorisation&#160;data&#160;to&#160;the&#160;MTM,&#160;an&#160;<br/>entity&#160;&#160;&#160;may&#160;&#160;&#160;deploy&#160;&#160;&#160;one&#160;&#160;&#160;of&#160;&#160;&#160;two&#160;&#160;&#160;challenge-response&#160;&#160;&#160;protocols,&#160;&#160;&#160;namely&#160;&#160;&#160;the&#160;&#160;&#160;Object&#160;<br/>Independent&#160;&#160;&#160;Authorisation&#160;&#160;&#160;Protocol&#160;&#160;&#160;(OIAP)&#160;&#160;&#160;or&#160;&#160;&#160;the&#160;&#160;&#160;Object&#160;&#160;&#160;Specific&#160;&#160;&#160;Authorisation&#160;<br/>Protocol&#160;(OSAP).</p>
<p style="position:absolute;top:919px;left:85px;white-space:nowrap" class="ft8315">OIAP&#160;is&#160;the&#160;more&#160;flexible&#160;and&#160;efficient&#160;of&#160;the&#160;two&#160;challenge-response&#160;authorisation&#160;<br/>protocols.&#160;Once&#160;an&#160;OIAP&#160;session&#160;has&#160;been&#160;established,&#160;it&#160;can&#160;be&#160;used&#160;to&#160;demonstrate&#160;<br/>knowledge&#160;of&#160;the&#160;authorisation&#160;data&#160;associated&#160;with&#160;a&#160;particular&#160;MTM&#160;object&#160;or&#160;MTM&#160;<br/>command.</p>
<p style="position:absolute;top:1015px;left:85px;white-space:nowrap" class="ft8315">For&#160;&#160;&#160;example,&#160;&#160;&#160;if&#160;&#160;&#160;the&#160;&#160;&#160;MTM&#160;&#160;&#160;owner&#160;&#160;&#160;wishes&#160;&#160;&#160;to&#160;&#160;&#160;read&#160;&#160;&#160;the&#160;&#160;&#160;public&#160;&#160;&#160;endorsement&#160;&#160;&#160;key&#160;<br/>knowledge&#160;of&#160;the&#160;owner&#160;authorisation&#160;data&#160;must&#160;be&#160;initially&#160;demonstrated,&#160;in&#160;order&#160;to&#160;<br/>gain&#160;access&#160;to&#160;the&#160;public&#160;endorsement&#160;key,&#160;as&#160;shown&#160;in&#160;table<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#84">&#160;43.</a></p>
<p style="position:absolute;top:1109px;left:139px;white-space:nowrap" class="ft8327"><i>TPM_OIAP</i></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft837">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft837">83/109</p>
</div>
<!-- Page 84 -->
<a name="84"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page84-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application084.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft8412">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft840">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft844">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft844">Final</p>
<p style="position:absolute;top:169px;left:139px;white-space:nowrap" class="ft8427"><i>TPM_OwnerReadInternalPub</i></p>
<p style="position:absolute;top:212px;left:139px;white-space:nowrap" class="ft8455">T</p>
<p style="position:absolute;top:213px;left:146px;white-space:nowrap" class="ft846"><b>able&#160;43:</b></p>
<p style="position:absolute;top:213px;left:214px;white-space:nowrap" class="ft843"><b>&#160;Authorising&#160;an&#160;MTM&#160;owner&#160;read&#160;of&#160;the&#160;public&#160;endorsement&#160;key</b></p>
<p style="position:absolute;top:240px;left:85px;white-space:nowrap" class="ft8415">The&#160;second&#160;protocol&#160;defined&#160;in&#160;the&#160;TCG&#160;specifications&#160;is&#160;OSAP.&#160;This&#160;protocol&#160;allows&#160;<br/>for&#160;the&#160;establishment&#160;of&#160;a&#160;session&#160;to&#160;prove&#160;knowledge&#160;of&#160;the&#160;authorisation&#160;data&#160;for&#160;a&#160;<br/>single&#160;MTM&#160;object,&#160;and&#160;minimises&#160;the&#160;exposure&#160;of&#160;long-term&#160;authorisation&#160;values.&#160;It&#160;<br/>may&#160;&#160;&#160;be&#160;&#160;&#160;used&#160;&#160;&#160;to&#160;&#160;&#160;authorise&#160;&#160;&#160;multiple&#160;&#160;&#160;commands&#160;&#160;&#160;without&#160;&#160;&#160;additional&#160;&#160;&#160;session&#160;<br/>establishment&#160;&#160;&#160;but,&#160;&#160;&#160;as&#160;&#160;&#160;we&#160;&#160;&#160;discuss&#160;&#160;&#160;below,&#160;&#160;&#160;the&#160;&#160;</p>
<p style="position:absolute;top:317px;left:486px;white-space:nowrap" class="ft8420"><i>TPM_OSAP</i></p>
<p style="position:absolute;top:317px;left:581px;white-space:nowrap" class="ft8414">&#160;&#160;handle&#160;&#160;&#160;specifies&#160;&#160;&#160;a&#160;&#160;&#160;single&#160;</p>
<p style="position:absolute;top:336px;left:85px;white-space:nowrap" class="ft8414">object&#160;to&#160;which&#160;all&#160;authorisations&#160;are&#160;bound.</p>
<p style="position:absolute;top:374px;left:85px;white-space:nowrap" class="ft8415">During&#160;this&#160;protocol&#160;an&#160;ephemeral&#160;secret&#160;is&#160;generated&#160;(via&#160;the&#160;HMAC&#160;of&#160;the&#160;session&#160;<br/>nonces&#160;exchanged&#160;at&#160;the&#160;beginning&#160;of&#160;the&#160;protocol,&#160;with&#160;the&#160;target&#160;MTM&#160;object's&#160;<br/>authorisation&#160;data&#160;used&#160;as&#160;the&#160;HMAC&#160;key)&#160;by&#160;the&#160;MTM&#160;and&#160;the&#160;caller,&#160;which&#160;is&#160;used&#160;<br/>to&#160;prove&#160;knowledge&#160;of&#160;the&#160;MTM&#160;object&#160;authorisation&#160;data.</p>
<p style="position:absolute;top:470px;left:85px;white-space:nowrap" class="ft8415">This&#160;&#160;&#160;particular&#160;&#160;&#160;protocol&#160;&#160;&#160;must&#160;&#160;&#160;also&#160;&#160;&#160;be&#160;&#160;&#160;used&#160;&#160;&#160;with&#160;&#160;&#160;operations&#160;&#160;&#160;that&#160;&#160;&#160;set&#160;&#160;&#160;or&#160;&#160;&#160;reset&#160;<br/>authorisation&#160;data,&#160;e.g.&#160;sealing&#160;or&#160;creating&#160;a&#160;wrap&#160;key.&#160;In&#160;order&#160;to&#160;input&#160;the&#160;required&#160;<br/>authorisation&#160;data&#160;a&#160;number&#160;of&#160;steps&#160;must&#160;be&#160;followed:</p>
<p style="position:absolute;top:547px;left:112px;white-space:nowrap" class="ft8414">1.&#160;The&#160;</p>
<p style="position:absolute;top:547px;left:176px;white-space:nowrap" class="ft8420"><i>TPM_OSAP</i></p>
<p style="position:absolute;top:547px;left:271px;white-space:nowrap" class="ft8414">&#160;command&#160;must&#160;be&#160;called.&#160;</p>
<p style="position:absolute;top:547px;left:496px;white-space:nowrap" class="ft8420"><i>TPM_OSAP</i></p>
<p style="position:absolute;top:547px;left:591px;white-space:nowrap" class="ft8414">&#160;creates&#160;the&#160;authorization&#160;</p>
<p style="position:absolute;top:566px;left:139px;white-space:nowrap" class="ft8414">handle,&#160;the&#160;shared&#160;secret&#160;and&#160;generates&#160;</p>
<p style="position:absolute;top:566px;left:483px;white-space:nowrap" class="ft8420"><i>nonceEven</i></p>
<p style="position:absolute;top:566px;left:575px;white-space:nowrap" class="ft8414">&#160;and&#160;</p>
<p style="position:absolute;top:566px;left:616px;white-space:nowrap" class="ft8420"><i>nonceEvenOSAP</i></p>
<p style="position:absolute;top:566px;left:753px;white-space:nowrap" class="ft8414">.</p>
<p style="position:absolute;top:585px;left:112px;white-space:nowrap" class="ft8415">2.&#160;The&#160;required&#160;MTM&#160;command&#160;is&#160;called.<br/>3.&#160;The&#160;shared&#160;secret&#160;which&#160;is&#160;generated&#160;can&#160;be&#160;used&#160;not&#160;only&#160;to&#160;authorise&#160;use&#160;of&#160;</p>
<p style="position:absolute;top:624px;left:139px;white-space:nowrap" class="ft8415">the&#160;parent&#160;object&#160;but&#160;also&#160;to&#160;input&#160;the&#160;authorisation&#160;data&#160;for&#160;a&#160;newly&#160;created&#160;<br/>child&#160;object,&#160;for&#160;example&#160;a&#160;new&#160;key&#160;or&#160;sealed&#160;data&#160;object.</p>
<p style="position:absolute;top:662px;left:112px;white-space:nowrap" class="ft8414">4.&#160;Once&#160;this&#160;has&#160;been&#160;completed,&#160;the&#160;OSAP&#160;session&#160;can&#160;be&#160;kept&#160;open&#160;in&#160;order&#160;to&#160;</p>
<p style="position:absolute;top:681px;left:139px;white-space:nowrap" class="ft8414">authorise&#160;another&#160;command&#160;which&#160;is&#160;bound&#160;to&#160;the&#160;same&#160;parent&#160;object.</p>
<p style="position:absolute;top:720px;left:85px;white-space:nowrap" class="ft8415">We&#160;will&#160;now&#160;re-examine&#160;the&#160;load&#160;key&#160;command&#160;run&#160;shown&#160;in&#160;table&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#82">&#160;41,</a>&#160;where&#160;we&#160;<br/>assume&#160;that&#160;the&#160;key,&#160;SWSK,&#160;is&#160;to&#160;be&#160;loaded&#160;by&#160;the&#160;input&#160;of&#160;a&#160;wrapped&#160;key&#160;blob.&#160;It&#160;is&#160;<br/>also&#160;assumed&#160;that&#160;the&#160;engine's&#160;SRK&#160;is&#160;loaded&#160;and&#160;its&#160;handle&#160;is&#160;available,&#160;and&#160;that&#160;the&#160;<br/>parent&#160;key,&#160;the&#160;engine's&#160;SRK,&#160;requires&#160;authorisation.</p>
<p style="position:absolute;top:816px;left:85px;white-space:nowrap" class="ft8415">In&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;&#160;&#160;load&#160;&#160;&#160;the&#160;&#160;&#160;SWSK,&#160;&#160;&#160;knowledge&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;SRK&#160;&#160;&#160;authorisation&#160;&#160;&#160;data&#160;&#160;&#160;must&#160;&#160;&#160;be&#160;<br/>demonstrated.&#160;When&#160;the&#160;SWSK&#160;has&#160;been&#160;loaded,&#160;a&#160;seal&#160;command,&#160;as&#160;described&#160;in&#160;<br/>table<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#82">&#160;42,</a>&#160;is&#160;called.&#160;Use&#160;of&#160;the&#160;SWSK&#160;must&#160;also&#160;be&#160;authorised.</p>
<p style="position:absolute;top:893px;left:85px;white-space:nowrap" class="ft8415">In&#160;this&#160;case,&#160;the&#160;user&#160;can&#160;demonstrate&#160;knowledge&#160;of&#160;the&#160;parent&#160;wrapping&#160;key&#160;(the&#160;<br/>SRK)&#160;authorisation&#160;data&#160;when&#160;loading&#160;the&#160;non-migratable&#160;key,&#160;SWSK,&#160;using&#160;an&#160;OIAP,&#160;<br/>for&#160;example.&#160;When&#160;sealing&#160;the&#160;secure&#160;wallet&#160;data&#160;using&#160;the&#160;SWSK,&#160;knowledge&#160;of&#160;the&#160;<br/>SWSK&#160;&#160;authorisation&#160;&#160;data&#160;can&#160;&#160;be&#160;&#160;demonstrated&#160;&#160;and&#160;&#160;the&#160;&#160;authorisation&#160;&#160;data&#160;for&#160;the&#160;<br/>sealed&#160;data&#160;inserted&#160;using&#160;the&#160;shared&#160;key&#160;established&#160;during&#160;the&#160;initial&#160;steps&#160;of&#160;the&#160;<br/>OSAP.&#160;This&#160;process&#160;is&#160;shown&#160;in&#160;tabl<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#85">e&#160;44.</a></p>
<p style="position:absolute;top:1046px;left:139px;white-space:nowrap" class="ft843"><b>Assume&#160;we&#160;have&#160;the&#160;handle&#160;of&#160;the&#160;engine's&#160;SRK</b></p>
<p style="position:absolute;top:1081px;left:139px;white-space:nowrap" class="ft8427"><i>TPM_OIAP</i></p>
<p style="position:absolute;top:1116px;left:139px;white-space:nowrap" class="ft8427"><i>TPM_LoadKey2</i></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft847">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft847">84/109</p>
</div>
<!-- Page 85 -->
<a name="85"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page85-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application085.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft8512">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft850">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft854">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft854">Final</p>
<p style="position:absolute;top:169px;left:139px;white-space:nowrap" class="ft853"><b>Now&#160;we&#160;have&#160;the&#160;handle&#160;to&#160;SWSK&#160;seal&#160;data:</b></p>
<p style="position:absolute;top:204px;left:139px;white-space:nowrap" class="ft8527"><i>TPM_OSAP</i></p>
<p style="position:absolute;top:239px;left:139px;white-space:nowrap" class="ft8527"><i>TPM_Seal</i></p>
<p style="position:absolute;top:282px;left:232px;white-space:nowrap" class="ft853"><b>Table&#160;44:&#160;Authorising&#160;a&#160;load&#160;key&#160;and&#160;an&#160;object&#160;seal</b></p>
<p style="position:absolute;top:345px;left:85px;white-space:nowrap" class="ft856"><b>3.3.8&#160;Conclusions</b></p>
<p style="position:absolute;top:372px;left:85px;white-space:nowrap" class="ft8515">We&#160;have&#160;utilised&#160;the&#160;requirements&#160;extracted&#160;in&#160;section&#160;3.2&#160;from&#160;the&#160;analysis&#160;of&#160;the&#160;<br/>secure&#160;&#160;&#160;wallet&#160;&#160;&#160;use-case&#160;&#160;&#160;designed&#160;&#160;&#160;by&#160;&#160;&#160;RUB&#160;&#160;&#160;in&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;&#160;&#160;examine&#160;&#160;&#160;which&#160;&#160;&#160;architectural&#160;<br/>components,&#160;based&#160;on&#160;TCG&#160;mobile&#160;reference&#160;architecture&#160;[63],&#160;and&#160;which&#160;functions,&#160;<br/>as&#160;specified&#160;in&#160;the&#160;TCG&#160;MTM&#160;specification&#160;[64],&#160;could&#160;be&#160;used&#160;to&#160;facilitate&#160;its&#160;robust&#160;<br/>implementation.&#160;The&#160;&#160;components&#160;and&#160;functionality&#160;required&#160;in&#160;order&#160;to&#160;implement&#160;<br/>the&#160;secure&#160;wallet&#160;mechanism&#160;will&#160;be&#160;used&#160;in&#160;specifying&#160;and&#160;analysing&#160;the&#160;methods&#160;by&#160;<br/>which&#160;&#160;&#160;a&#160;&#160;&#160;subset&#160;&#160;&#160;of&#160;&#160;MTM&#160;&#160;functionality&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;provided&#160;&#160;&#160;given&#160;&#160;&#160;an&#160;&#160;&#160;X-GOLD</p>
<p style="position:absolute;top:487px;left:737px;white-space:nowrap" class="ft8517">TM&#160;&#160;</p>
<p style="position:absolute;top:487px;left:761px;white-space:nowrap" class="ft8514">208/a&#160;</p>
<p style="position:absolute;top:506px;left:85px;white-space:nowrap" class="ft8514">generic&#160;OMTP&#160;TR1&#160;device.</p>
<p style="position:absolute;top:545px;left:85px;white-space:nowrap" class="ft8515">Table&#160;<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#86">&#160;45&#160;&#160;</a>summaries&#160;the&#160;subset&#160;of&#160;MTM&#160;commands&#160;required&#160;in&#160;order&#160;to&#160;enable&#160;this&#160;<br/>use-case.&#160;Regardless&#160;of&#160;whether&#160;the&#160;secure&#160;wallet&#160;mechanism&#160;is&#160;implemented&#160;on&#160;a&#160;<br/>mandatory&#160;or&#160;a&#160;discretionary&#160;engine,&#160;an&#160;authenticated&#160;boot&#160;mechanism&#160;is&#160;required.&#160;<br/>In&#160;order&#160;to&#160;implement&#160;an&#160;authenticated&#160;boot&#160;mechanism,&#160;the&#160;TMP&#160;must&#160;incorporate:</p>
<p style="position:absolute;top:631px;left:112px;white-space:nowrap" class="ft8534">●</p>
<p style="position:absolute;top:622px;left:139px;white-space:nowrap" class="ft8514">A&#160;RTM;&#160;and</p>
<p style="position:absolute;top:650px;left:112px;white-space:nowrap" class="ft8534">●</p>
<p style="position:absolute;top:641px;left:139px;white-space:nowrap" class="ft8514">A&#160;RTS&#160;(including&#160;PCRs).</p>
<p style="position:absolute;top:679px;left:85px;white-space:nowrap" class="ft8515">If&#160;the&#160;secure&#160;wallet&#160;mechanism&#160;is&#160;implemented&#160;on&#160;a&#160;mandatory&#160;engine,&#160;a&#160;secure&#160;boot&#160;<br/>mechanism&#160;may&#160;be&#160;leveraged.&#160;In&#160;order&#160;to&#160;implement&#160;a&#160;secure&#160;boot&#160;mechanism,&#160;the&#160;<br/>TMP&#160;must&#160;incorporate:</p>
<p style="position:absolute;top:746px;left:112px;white-space:nowrap" class="ft8534">●</p>
<p style="position:absolute;top:737px;left:139px;white-space:nowrap" class="ft8514">A&#160;RTM;</p>
<p style="position:absolute;top:765px;left:112px;white-space:nowrap" class="ft8534">●</p>
<p style="position:absolute;top:756px;left:139px;white-space:nowrap" class="ft8514">A&#160;RTV;</p>
<p style="position:absolute;top:785px;left:112px;white-space:nowrap" class="ft8534">●</p>
<p style="position:absolute;top:775px;left:139px;white-space:nowrap" class="ft8514">A&#160;RTS&#160;(incorporating&#160;PCRs).</p>
<p style="position:absolute;top:804px;left:112px;white-space:nowrap" class="ft8534">●</p>
<p style="position:absolute;top:794px;left:139px;white-space:nowrap" class="ft8514">A&#160;RVAI;</p>
<p style="position:absolute;top:823px;left:112px;white-space:nowrap" class="ft8534">●</p>
<p style="position:absolute;top:814px;left:139px;white-space:nowrap" class="ft8514">A&#160;list&#160;of&#160;keys&#160;authorised&#160;to&#160;sign&#160;RIM_Certs;</p>
<p style="position:absolute;top:842px;left:112px;white-space:nowrap" class="ft8534">●</p>
<p style="position:absolute;top:833px;left:139px;white-space:nowrap" class="ft8514">An&#160;internal&#160;verification&#160;key;</p>
<p style="position:absolute;top:861px;left:112px;white-space:nowrap" class="ft8534">●</p>
<p style="position:absolute;top:852px;left:139px;white-space:nowrap" class="ft8514">Two&#160;monotonic&#160;counters:</p>
<p style="position:absolute;top:881px;left:139px;white-space:nowrap" class="ft8534">○</p>
<p style="position:absolute;top:871px;left:166px;white-space:nowrap" class="ft8514">counterRIMProtect</p>
<p style="position:absolute;top:900px;left:139px;white-space:nowrap" class="ft8534">○</p>
<p style="position:absolute;top:890px;left:166px;white-space:nowrap" class="ft8514">counterBootstrap</p>
<p style="position:absolute;top:919px;left:112px;white-space:nowrap" class="ft8534">●</p>
<p style="position:absolute;top:910px;left:139px;white-space:nowrap" class="ft8514">Platform&#160;component&#160;RIM_Certs;</p>
<p style="position:absolute;top:938px;left:112px;white-space:nowrap" class="ft8534">●</p>
<p style="position:absolute;top:929px;left:139px;white-space:nowrap" class="ft8514">A&#160;policy&#160;for&#160;platform&#160;recovery;&#160;and</p>
<p style="position:absolute;top:957px;left:112px;white-space:nowrap" class="ft8534">●</p>
<p style="position:absolute;top:948px;left:139px;white-space:nowrap" class="ft8514">Policies&#160;for&#160;RIM&#160;certificate&#160;revocation&#160;and&#160;update.</p>
<p style="position:absolute;top:986px;left:85px;white-space:nowrap" class="ft8515">In&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;&#160;&#160;maintain&#160;&#160;&#160;integrity&#160;&#160;&#160;after&#160;&#160;&#160;boot,&#160;&#160;&#160;a&#160;&#160;&#160;number&#160;&#160;&#160;of&#160;&#160;&#160;preventative&#160;&#160;&#160;and&#160;&#160;&#160;reactive&#160;<br/>approaches&#160;may&#160;be&#160;deployed.&#160;We&#160;assume&#160;the&#160;use&#160;of&#160;software&#160;isolation&#160;through&#160;the&#160;<br/>deployment&#160;of&#160;virtualisation&#160;technology&#160;(namely,&#160;an&#160;L4&#160;microkernel).</p>
<p style="position:absolute;top:1063px;left:85px;white-space:nowrap" class="ft8515">In&#160;order&#160;to&#160;implement&#160;this&#160;use-cases,&#160;it&#160;is&#160;also&#160;required&#160;that&#160;the&#160;TMP&#160;engine&#160;can&#160;be&#160;<br/>taken&#160;ownership&#160;of.&#160;In&#160;conjunction&#160;with&#160;this,&#160;basic&#160;functionality,&#160;such&#160;as&#160;self&#160;testing,&#160;<br/>is&#160;&#160;&#160;also&#160;&#160;&#160;needed.&#160;&#160;&#160;Secure&#160;&#160;&#160;storage&#160;&#160;&#160;and&#160;&#160;&#160;command&#160;&#160;&#160;authorisation&#160;&#160;&#160;functionality&#160;&#160;&#160;is&#160;&#160;&#160;also&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft857">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft857">85/109</p>
</div>
<!-- Page 86 -->
<a name="86"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft8663{font-size:17px;font-family:EAAAAA+DejaVuSerif;color:#ffffff;}
	.ft8664{font-size:12px;font-family:EAAAAA+DejaVuSerif;color:#000000;}
-->
</style>
<div id="page86-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application086.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft8612">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft860">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft864">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft864">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft8614">mandatory&#160;in&#160;order&#160;to&#160;robustly&#160;implement&#160;the&#160;secure&#160;wallet&#160;mechanism.</p>
<p style="position:absolute;top:189px;left:86px;white-space:nowrap" class="ft863"><b>Table&#160;45:&#160;MTM&#160;commands&#160;required&#160;in&#160;an&#160;MLTM&#160;and&#160;an&#160;MRTM&#160;in&#160;order&#160;to&#160;implement&#160;</b></p>
<p style="position:absolute;top:207px;left:324px;white-space:nowrap" class="ft863"><b>the&#160;secure&#160;wallet&#160;mechanism</b></p>
<p style="position:absolute;top:229px;left:238px;white-space:nowrap" class="ft8663">MLTM</p>
<p style="position:absolute;top:229px;left:547px;white-space:nowrap" class="ft8663">MRTM</p>
<p style="position:absolute;top:229px;left:604px;white-space:nowrap" class="ft8614">&#160;device&#160;TPM</p>
<p style="position:absolute;top:256px;left:89px;white-space:nowrap" class="ft8664">TPM_Init</p>
<p style="position:absolute;top:256px;left:451px;white-space:nowrap" class="ft8664">TPM_Init</p>
<p style="position:absolute;top:279px;left:89px;white-space:nowrap" class="ft8664">TPM_Startup</p>
<p style="position:absolute;top:279px;left:451px;white-space:nowrap" class="ft8664">TPM_Startup</p>
<p style="position:absolute;top:301px;left:89px;white-space:nowrap" class="ft8664">TPM_SelfTestFull</p>
<p style="position:absolute;top:301px;left:451px;white-space:nowrap" class="ft8664">TPM_SelfTestFull</p>
<p style="position:absolute;top:323px;left:89px;white-space:nowrap" class="ft8664">TPM_ContinueSelfTest&#160;</p>
<p style="position:absolute;top:323px;left:451px;white-space:nowrap" class="ft8664">TPM_ContinueSelfTest&#160;</p>
<p style="position:absolute;top:346px;left:89px;white-space:nowrap" class="ft8664">TPM_GetTestResult</p>
<p style="position:absolute;top:346px;left:451px;white-space:nowrap" class="ft8664">TPM_GetTestResult</p>
<p style="position:absolute;top:368px;left:89px;white-space:nowrap" class="ft8664">TPM_SetOwnerInstall&#160;</p>
<p style="position:absolute;top:368px;left:451px;white-space:nowrap" class="ft8664">This&#160;command&#160;may&#160;not&#160;be&#160;required&#160;in&#160;an&#160;MRTM&#160;as&#160;it&#160;</p>
<p style="position:absolute;top:382px;left:451px;white-space:nowrap" class="ft8664">may&#160;be&#160;pre-installed&#160;with&#160;an&#160;SRK&#160;and&#160;an&#160;AIK.</p>
<p style="position:absolute;top:404px;left:89px;white-space:nowrap" class="ft8664">TPM_OwnerSetDisable</p>
<p style="position:absolute;top:404px;left:451px;white-space:nowrap" class="ft8664">An&#160;MRTM&#160;can&#160;never&#160;be&#160;disabled.</p>
<p style="position:absolute;top:426px;left:89px;white-space:nowrap" class="ft8664">TPM_PhysicalEnable&#160;</p>
<p style="position:absolute;top:426px;left:451px;white-space:nowrap" class="ft8664">An&#160;MRTM&#160;is&#160;always&#160;enabled&#160;so&#160;this&#160;command&#160;is&#160;not&#160;</p>
<p style="position:absolute;top:440px;left:451px;white-space:nowrap" class="ft8664">required.</p>
<p style="position:absolute;top:463px;left:89px;white-space:nowrap" class="ft8664">TPM_PhysicalDisable&#160;</p>
<p style="position:absolute;top:463px;left:451px;white-space:nowrap" class="ft8664">An&#160;MRTM&#160;can&#160;never&#160;be&#160;disabled.</p>
<p style="position:absolute;top:485px;left:89px;white-space:nowrap" class="ft8664">TPM_PhysicalSetDeactivated&#160;</p>
<p style="position:absolute;top:485px;left:451px;white-space:nowrap" class="ft8664">An&#160;MRTM&#160;can&#160;never&#160;be&#160;deactivated.</p>
<p style="position:absolute;top:507px;left:89px;white-space:nowrap" class="ft8664">TPM_TakeOwnership&#160;</p>
<p style="position:absolute;top:507px;left:451px;white-space:nowrap" class="ft8664">This&#160;command&#160;may&#160;not&#160;be&#160;required&#160;in&#160;an&#160;MRTM&#160;as&#160;it&#160;</p>
<p style="position:absolute;top:521px;left:451px;white-space:nowrap" class="ft8664">may&#160;be&#160;pre-installed&#160;with&#160;an&#160;SRK&#160;and&#160;an&#160;AIK.</p>
<p style="position:absolute;top:543px;left:89px;white-space:nowrap" class="ft8664">TPM_Seal&#160;</p>
<p style="position:absolute;top:543px;left:451px;white-space:nowrap" class="ft8664">TPM_Seal</p>
<p style="position:absolute;top:566px;left:89px;white-space:nowrap" class="ft8664">TPM_CreateWrapKey&#160;</p>
<p style="position:absolute;top:566px;left:451px;white-space:nowrap" class="ft8664">TPM_CreateWrapKey&#160;</p>
<p style="position:absolute;top:588px;left:89px;white-space:nowrap" class="ft8664">TPM_LoadKey2&#160;</p>
<p style="position:absolute;top:588px;left:451px;white-space:nowrap" class="ft8664">TPM_LoadKey2&#160;</p>
<p style="position:absolute;top:610px;left:89px;white-space:nowrap" class="ft8664">TPM&#160;CreateEndorsementKeyPair&#160;</p>
<p style="position:absolute;top:610px;left:451px;white-space:nowrap" class="ft8664">An&#160;MRTM&#160;may&#160;not&#160;contain&#160;an&#160;endorsement&#160;key&#160;pair&#160;so&#160;</p>
<p style="position:absolute;top:624px;left:451px;white-space:nowrap" class="ft8664">this&#160;command&#160;is&#160;considered&#160;optional.</p>
<p style="position:absolute;top:646px;left:89px;white-space:nowrap" class="ft8664">TPM_ReadPubek&#160;</p>
<p style="position:absolute;top:646px;left:451px;white-space:nowrap" class="ft8664">An&#160;MRTM&#160;may&#160;not&#160;contain&#160;an&#160;endorsement&#160;key&#160;pair&#160;so&#160;</p>
<p style="position:absolute;top:660px;left:451px;white-space:nowrap" class="ft8664">this&#160;command&#160;is&#160;considered&#160;optional.</p>
<p style="position:absolute;top:683px;left:89px;white-space:nowrap" class="ft8664">TPM_OwnerReadInternalPub&#160;(optional)</p>
<p style="position:absolute;top:683px;left:451px;white-space:nowrap" class="ft8664">An&#160;MRTM&#160;may&#160;not&#160;contain&#160;an&#160;endorsement&#160;key&#160;pair&#160;so&#160;</p>
<p style="position:absolute;top:697px;left:451px;white-space:nowrap" class="ft8664">this&#160;command&#160;is&#160;considered&#160;optional.</p>
<p style="position:absolute;top:719px;left:89px;white-space:nowrap" class="ft8664">TPM_Extend&#160;</p>
<p style="position:absolute;top:719px;left:451px;white-space:nowrap" class="ft8664">TPM_Extend&#160;</p>
<p style="position:absolute;top:741px;left:89px;white-space:nowrap" class="ft8664">TPM_OIAP&#160;</p>
<p style="position:absolute;top:741px;left:451px;white-space:nowrap" class="ft8664">TPM_OIAP&#160;</p>
<p style="position:absolute;top:763px;left:89px;white-space:nowrap" class="ft8664">TPM_OSAP&#160;</p>
<p style="position:absolute;top:763px;left:451px;white-space:nowrap" class="ft8664">TPM_OSAP&#160;</p>
<p style="position:absolute;top:786px;left:89px;white-space:nowrap" class="ft8664">TPM_EstablishTransport&#160;(required&#160;if&#160;no&#160;inherent&#160;</p>
<p style="position:absolute;top:800px;left:89px;white-space:nowrap" class="ft8664">confidentiality-protected&#160;channel&#160;exists&#160;between&#160;the&#160;</p>
<p style="position:absolute;top:814px;left:89px;white-space:nowrap" class="ft8664">MTM&#160;and&#160;the&#160;RTM/RTV)</p>
<p style="position:absolute;top:786px;left:451px;white-space:nowrap" class="ft8664">TPM_EstablishTransport&#160;(required&#160;if&#160;no&#160;inherent&#160;</p>
<p style="position:absolute;top:800px;left:451px;white-space:nowrap" class="ft8664">confidentiality-protected&#160;channel&#160;exists&#160;between&#160;the&#160;</p>
<p style="position:absolute;top:814px;left:451px;white-space:nowrap" class="ft8664">MTM&#160;and&#160;the&#160;RTM/RTV)</p>
<p style="position:absolute;top:836px;left:89px;white-space:nowrap" class="ft8664">TPM_ExecuteTransport&#160;(required&#160;if&#160;no&#160;inherent&#160;</p>
<p style="position:absolute;top:850px;left:89px;white-space:nowrap" class="ft8664">confidentiality-protected&#160;channel&#160;exists&#160;between&#160;the&#160;</p>
<p style="position:absolute;top:864px;left:89px;white-space:nowrap" class="ft8664">MTM&#160;and&#160;the&#160;RTM/RTV)</p>
<p style="position:absolute;top:836px;left:451px;white-space:nowrap" class="ft8664">TPM_ExecuteTransport&#160;(required&#160;if&#160;no&#160;inherent&#160;</p>
<p style="position:absolute;top:850px;left:451px;white-space:nowrap" class="ft8664">confidentiality-protected&#160;channel&#160;exists&#160;between&#160;the&#160;</p>
<p style="position:absolute;top:864px;left:451px;white-space:nowrap" class="ft8664">MTM&#160;and&#160;the&#160;RTM/RTV)</p>
<p style="position:absolute;top:886px;left:89px;white-space:nowrap" class="ft8664">TPM_ReleaseTransportSigned&#160;(required&#160;if&#160;no&#160;inherent&#160;</p>
<p style="position:absolute;top:900px;left:89px;white-space:nowrap" class="ft8664">confidentiality-protected&#160;channel&#160;exists&#160;between&#160;the&#160;</p>
<p style="position:absolute;top:914px;left:89px;white-space:nowrap" class="ft8664">MTM&#160;and&#160;the&#160;RTM/RTV)</p>
<p style="position:absolute;top:886px;left:451px;white-space:nowrap" class="ft8664">TPM_ReleaseTransportSigned&#160;(required&#160;if&#160;no&#160;inherent&#160;</p>
<p style="position:absolute;top:900px;left:451px;white-space:nowrap" class="ft8664">confidentiality-protected&#160;channel&#160;exists&#160;between&#160;the&#160;</p>
<p style="position:absolute;top:914px;left:451px;white-space:nowrap" class="ft8664">MTM&#160;and&#160;the&#160;RTM/RTV)</p>
<p style="position:absolute;top:936px;left:89px;white-space:nowrap" class="ft8664">TPM_ReadCounter&#160;</p>
<p style="position:absolute;top:936px;left:451px;white-space:nowrap" class="ft8664">TPM_ReadCounter&#160;</p>
<p style="position:absolute;top:958px;left:89px;white-space:nowrap" class="ft8664">-</p>
<p style="position:absolute;top:958px;left:451px;white-space:nowrap" class="ft8664">TPM_InstallRIM</p>
<p style="position:absolute;top:981px;left:89px;white-space:nowrap" class="ft8664">-</p>
<p style="position:absolute;top:981px;left:451px;white-space:nowrap" class="ft8664">TPM_VerifyRIMCert</p>
<p style="position:absolute;top:1003px;left:89px;white-space:nowrap" class="ft8664">-</p>
<p style="position:absolute;top:1003px;left:451px;white-space:nowrap" class="ft8664">TPM_LoadVerificationKey</p>
<p style="position:absolute;top:1025px;left:89px;white-space:nowrap" class="ft8664">-</p>
<p style="position:absolute;top:1025px;left:451px;white-space:nowrap" class="ft8664">TPM_LoadVerificationRootKeyDisable</p>
<p style="position:absolute;top:1048px;left:89px;white-space:nowrap" class="ft8664">-</p>
<p style="position:absolute;top:1048px;left:451px;white-space:nowrap" class="ft8664">TPM_IncrementBootstrapCounter</p>
<p style="position:absolute;top:1070px;left:89px;white-space:nowrap" class="ft8664">-</p>
<p style="position:absolute;top:1070px;left:451px;white-space:nowrap" class="ft8664">TPM_SetVerifiedPCRSelection</p>
<p style="position:absolute;top:1092px;left:89px;white-space:nowrap" class="ft8664">-</p>
<p style="position:absolute;top:1092px;left:451px;white-space:nowrap" class="ft8664">TPM_VerifyRIMCertAndExtend</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft867">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft867">86/109</p>
</div>
<!-- Page 87 -->
<a name="87"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page87-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application087.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft8712">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft870">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft874">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft874">Final</p>
<p style="position:absolute;top:191px;left:85px;white-space:nowrap" class="ft873"><b>4&#160;</b></p>
<p style="position:absolute;top:188px;left:117px;white-space:nowrap" class="ft8719"><b>OMTP&#160;TR1&#160;and&#160;the&#160;Secure&#160;Wallet&#160;Prototype</b></p>
<p style="position:absolute;top:218px;left:85px;white-space:nowrap" class="ft8715">In&#160;this&#160;section&#160;we&#160;consider&#160;the&#160;secure&#160;wallet&#160;prototype&#160;in&#160;the&#160;context&#160;of&#160;the&#160;recently&#160;<br/>published&#160;&#160;&#160;OMTP&#160;&#160;&#160;(Open&#160;&#160;&#160;Mobile&#160;&#160;&#160;Terminal&#160;&#160;&#160;Platform)&#160;&#160;&#160;TR1&#160;&#160;&#160;Advanced&#160;&#160;&#160;Trusted&#160;<br/>Environment&#160;recommendations&#160;document&#160;[50].&#160;We&#160;will&#160;consider&#160;a&#160;final&#160;architecture&#160;<br/>where&#160;the&#160;secure&#160;wallet&#160;has&#160;been&#160;completely&#160;ported&#160;to&#160;the&#160;X-GOLD</p>
<p style="position:absolute;top:276px;left:652px;white-space:nowrap" class="ft8717">TM&#160;</p>
<p style="position:absolute;top:276px;left:671px;white-space:nowrap" class="ft8714">208.</p>
<p style="position:absolute;top:314px;left:85px;white-space:nowrap" class="ft8715">First&#160;of&#160;all&#160;we&#160;briefly&#160;summarize&#160;the&#160;main&#160;features&#160;of&#160;the&#160;OMTP&#160;TR1&#160;document.&#160;For&#160;<br/>details,&#160;the&#160;reader&#160;is&#160;advised&#160;to&#160;consult&#160;the&#160;original&#160;document.</p>
<p style="position:absolute;top:390px;left:85px;white-space:nowrap" class="ft8716"><b>4.1&#160;OMTP&#160;TR1&#160;Summary</b></p>
<p style="position:absolute;top:437px;left:85px;white-space:nowrap" class="ft8715">OMTP&#160;TR1&#160;is&#160;a&#160;successor&#160;to&#160;the&#160;OMTP&#160;TR0&#160;Trusted&#160;Environment&#160;document&#160;[49].&#160;<br/>OMTP&#160;&#160;&#160;TR1&#160;&#160;&#160;has&#160;&#160;&#160;been&#160;&#160;&#160;aligned&#160;&#160;&#160;with&#160;&#160;&#160;current&#160;&#160;&#160;threats&#160;&#160;&#160;and&#160;&#160;&#160;business&#160;&#160;&#160;requirements.&#160;<br/>Although&#160;&#160;&#160;TR1&#160;&#160;&#160;is&#160;&#160;&#160;concerned&#160;&#160;&#160;with&#160;&#160;&#160;mobile&#160;&#160;&#160;equipment&#160;&#160;&#160;security,&#160;&#160;&#160;which&#160;&#160;&#160;means&#160;&#160;&#160;the&#160;<br/>handset,&#160;it&#160;also&#160;acknowledges&#160;that&#160;a&#160;UICC&#160;(Universal&#160;Integrated&#160;Circuit&#160;Card)&#160;would&#160;<br/>in&#160;&#160;&#160;many&#160;&#160;&#160;cases&#160;&#160;&#160;meet,&#160;&#160;&#160;and&#160;&#160;&#160;exceeds&#160;&#160;&#160;the&#160;&#160;&#160;security&#160;&#160;&#160;requirements&#160;&#160;&#160;defined&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;&#160;&#160;TR1&#160;<br/>recommendations&#160;document.&#160;The&#160;UICC&#160;is&#160;the&#160;chip&#160;card&#160;used&#160;in&#160;mobile&#160;phones&#160;on&#160;<br/>GSM&#160;and&#160;UMTS&#160;networks.&#160;It&#160;is&#160;best&#160;known&#160;as&#160;the&#160;location&#160;of&#160;the&#160;SIM&#160;application.&#160;It&#160;<br/>can&#160;&#160;&#160;also&#160;&#160;&#160;host&#160;&#160;&#160;other&#160;&#160;&#160;applications.&#160;&#160;&#160;Many&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;OMTP&#160;&#160;&#160;TR1&#160;&#160;&#160;Security&#160;&#160;&#160;Enabler&#160;<br/>requirements&#160;and&#160;the&#160;TR1&#160;use&#160;cases&#160;make&#160;reference&#160;to&#160;the&#160;UICC.</p>
<p style="position:absolute;top:629px;left:85px;white-space:nowrap" class="ft8715">Where&#160;as&#160;OMTP&#160;TR0&#160;defines&#160;a&#160;basic&#160;threat&#160;model,&#160;TR1&#160;has&#160;a&#160;much&#160;more&#160;detailed&#160;<br/>threat&#160;model,&#160;and&#160;all&#160;requirements&#160;reference&#160;the&#160;threat&#160;model&#160;where&#160;relevant.&#160;Two&#160;<br/>security&#160;profiles&#160;called&#160;profile&#160;1&#160;and&#160;profile&#160;2&#160;are&#160;defined.&#160;Profile&#160;1&#160;is&#160;a&#160;subset&#160;of&#160;<br/>profile&#160;2,&#160;and&#160;these&#160;profiles&#160;define&#160;which&#160;threats&#160;have&#160;to&#160;be&#160;defended&#160;against.&#160;Profile&#160;<br/>1&#160;&#160;&#160;assets&#160;&#160;&#160;must&#160;&#160;&#160;mostly&#160;&#160;&#160;be&#160;&#160;&#160;only&#160;&#160;&#160;defended&#160;&#160;&#160;against&#160;&#160;&#160;software&#160;&#160;&#160;attacks&#160;&#160;&#160;and&#160;&#160;&#160;some&#160;&#160;&#160;basic&#160;<br/>hardware&#160;attacks.&#160;Profile&#160;2&#160;assets&#160;must&#160;be&#160;defended&#160;against&#160;software&#160;attacks&#160;and&#160;<br/>more&#160;advanced&#160;hardware&#160;attacks.</p>
<p style="position:absolute;top:783px;left:85px;white-space:nowrap" class="ft8715">The&#160;document&#160;is&#160;partitioned&#160;into&#160;two&#160;parts.&#160;Part&#160;1&#160;consists&#160;of&#160;security&#160;enablers.&#160;Part&#160;<br/>2&#160;consists&#160;of&#160;some&#160;example&#160;use&#160;cases.</p>
<p style="position:absolute;top:878px;left:85px;white-space:nowrap" class="ft876"><b>4.1.1&#160;Security&#160;Enablers</b></p>
<p style="position:absolute;top:904px;left:85px;white-space:nowrap" class="ft8714">In&#160;this&#160;section&#160;we&#160;summarize&#160;the&#160;security&#160;enablers&#160;defined&#160;in&#160;the&#160;TR1&#160;document.</p>
<p style="position:absolute;top:952px;left:112px;white-space:nowrap" class="ft8734">●</p>
<p style="position:absolute;top:943px;left:139px;white-space:nowrap" class="ft8714">Trusted&#160;Execution&#160;Environment&#160;(TEE)</p>
<p style="position:absolute;top:981px;left:85px;white-space:nowrap" class="ft8715">This&#160;is&#160;an&#160;execution&#160;environment&#160;for&#160;executing&#160;security&#160;sensitive&#160;programs.&#160;It&#160;meets&#160;<br/>a&#160;defined&#160;set&#160;of&#160;security&#160;requirements,&#160;resists&#160;a&#160;defined&#160;set&#160;of&#160;threats,&#160;and&#160;within&#160;this&#160;<br/>scope&#160;ensures&#160;that&#160;a&#160;program&#160;executes&#160;as&#160;it&#160;was&#160;designed&#160;to&#160;execute.</p>
<p style="position:absolute;top:1067px;left:112px;white-space:nowrap" class="ft8734">●</p>
<p style="position:absolute;top:1058px;left:139px;white-space:nowrap" class="ft8714">Secure&#160;Storage&#160;(SST)</p>
<p style="position:absolute;top:1096px;left:85px;white-space:nowrap" class="ft8715">The&#160;&#160;&#160;secure&#160;&#160;&#160;storage&#160;&#160;&#160;facility&#160;&#160;&#160;helps&#160;&#160;&#160;the&#160;&#160;&#160;TEE&#160;&#160;&#160;to&#160;&#160;&#160;handle&#160;&#160;&#160;security&#160;&#160;&#160;sensitive&#160;&#160;&#160;objects.&#160;&#160;&#160;It&#160;<br/>stores&#160;the&#160;sensitive&#160;objects&#160;in&#160;a&#160;way&#160;that&#160;the&#160;security&#160;properties&#160;of&#160;the&#160;objects&#160;are&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft877">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft877">87/109</p>
</div>
<!-- Page 88 -->
<a name="88"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page88-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application088.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft8812">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft880">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft884">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft884">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft8814">maintained&#160;within&#160;the&#160;scope&#160;of&#160;a&#160;defined&#160;set&#160;of&#160;threats.</p>
<p style="position:absolute;top:199px;left:112px;white-space:nowrap" class="ft8834">●</p>
<p style="position:absolute;top:189px;left:139px;white-space:nowrap" class="ft8814">Flexible&#160;Secure&#160;Boot&#160;(FSB)</p>
<p style="position:absolute;top:228px;left:85px;white-space:nowrap" class="ft8815">FSB&#160;requirements&#160;ensure&#160;the&#160;integrity&#160;of&#160;the&#160;ME&#160;(Mobile&#160;Equipment)&#160;code&#160;base&#160;at&#160;<br/>boot&#160;time,&#160;and&#160;also&#160;defines&#160;requirements&#160;for&#160;securely&#160;updating&#160;the&#160;code&#160;image&#160;via&#160;an&#160;<br/>external&#160;connection&#160;to&#160;the&#160;ME.&#160;Again&#160;these&#160;requirements&#160;are&#160;within&#160;the&#160;scope&#160;of&#160;a&#160;<br/>defined&#160;set&#160;of&#160;threats.</p>
<p style="position:absolute;top:333px;left:112px;white-space:nowrap" class="ft8834">●</p>
<p style="position:absolute;top:324px;left:139px;white-space:nowrap" class="ft8814">Generic&#160;Bootstrap&#160;Architecture&#160;(GBA)</p>
<p style="position:absolute;top:362px;left:85px;white-space:nowrap" class="ft8815">3GPP&#160;GBA&#160;is&#160;a&#160;generic&#160;method&#160;which&#160;can&#160;be&#160;used&#160;by&#160;arbitrary&#160;application&#160;functions&#160;<br/>in&#160;the&#160;mobile&#160;network&#160;to&#160;authenticate&#160;users&#160;and&#160;establish&#160;a&#160;shared&#160;secret.&#160;It&#160;is&#160;based&#160;<br/>on&#160;the&#160;fact&#160;that&#160;both&#160;network&#160;and&#160;USIM&#160;share&#160;a&#160;128-bit&#160;secret&#160;key&#160;K</p>
<p style="position:absolute;top:407px;left:706px;white-space:nowrap" class="ft8817">i</p>
<p style="position:absolute;top:401px;left:709px;white-space:nowrap" class="ft8814">.&#160;The&#160;MNO&#160;</p>
<p style="position:absolute;top:420px;left:85px;white-space:nowrap" class="ft8815">(Mobile&#160;&#160;&#160;Network&#160;&#160;&#160;Operator)&#160;&#160;&#160;stores&#160;&#160;&#160;the&#160;&#160;&#160;secret&#160;&#160;&#160;keys&#160;&#160;&#160;for&#160;&#160;&#160;all&#160;&#160;&#160;subscribers&#160;&#160;&#160;in&#160;&#160;&#160;a&#160;<br/>Authentication&#160;Center&#160;(AUC),&#160;which&#160;is&#160;connected&#160;to&#160;the&#160;Home&#160;Location&#160;Register.&#160;The&#160;<br/>secret&#160;keys&#160;never&#160;leave&#160;the&#160;AUC&#160;and&#160;SIM&#160;domain.</p>
<p style="position:absolute;top:497px;left:85px;white-space:nowrap" class="ft8815">An&#160;AKA&#160;(Authentication&#160;and&#160;Key&#160;Agreement)&#160;protocol&#160;is&#160;executed&#160;between&#160;the&#160;USIM/<br/>ISIM&#160;and&#160;the&#160;mobile&#160;network&#160;in&#160;order&#160;to&#160;generate&#160;a&#160;confidentiality&#160;session&#160;key&#160;(CK)&#160;<br/>and&#160;integrity&#160;session&#160;key&#160;(IK).&#160;An&#160;ISIM&#160;is&#160;a&#160;further&#160;application&#160;which&#160;can&#160;run&#160;on&#160;the&#160;<br/>UICC.&#160;It&#160;is&#160;part&#160;&#160;of&#160;the&#160;IMS&#160;(Internet&#160;Protocol&#160;Multimedia&#160;Subsystem),&#160;which&#160;is&#160;a&#160;<br/>framework&#160;&#160;for&#160;&#160;delivering&#160;IP&#160;&#160;Multimedia&#160;over&#160;&#160;GSM/UMTS&#160;mobile&#160;&#160;networks.&#160;&#160;In&#160;&#160;the&#160;<br/>case&#160;&#160;&#160;of&#160;&#160;&#160;ME&#160;&#160;&#160;based&#160;&#160;&#160;GBA&#160;&#160;&#160;,&#160;&#160;&#160;upon&#160;&#160;&#160;successful&#160;&#160;&#160;network&#160;&#160;&#160;verification,&#160;&#160;&#160;the&#160;&#160;&#160;USIM/ISIM&#160;<br/>delivers&#160;the&#160;confidentiality&#160;and&#160;integrity&#160;keys&#160;CK&#160;and&#160;IK&#160;to&#160;the&#160;mobile&#160;station,&#160;where&#160;<br/>they&#160;&#160;&#160;are&#160;&#160;&#160;used&#160;&#160;&#160;to&#160;&#160;&#160;generate&#160;&#160;&#160;the&#160;&#160;&#160;shared&#160;&#160;&#160;secret&#160;&#160;&#160;with&#160;&#160;&#160;the&#160;&#160;&#160;target&#160;&#160;&#160;network&#160;&#160;&#160;application&#160;<br/>function.</p>
<p style="position:absolute;top:689px;left:85px;white-space:nowrap" class="ft8815">The&#160;&#160;&#160;GBA&#160;&#160;requirements&#160;&#160;are&#160;&#160;&#160;concerned&#160;&#160;&#160;with&#160;&#160;&#160;which&#160;&#160;&#160;level&#160;&#160;&#160;of&#160;&#160;&#160;TEE&#160;&#160;&#160;the&#160;&#160;&#160;sensitive&#160;&#160;&#160;GBA&#160;<br/>software&#160;should&#160;run&#160;on&#160;the&#160;ME.&#160;There&#160;are&#160;also&#160;requirements&#160;regarding&#160;protection&#160;of&#160;<br/>the&#160;confidentiality&#160;and&#160;integrity&#160;of&#160;the&#160;CK&#160;and&#160;IK&#160;if&#160;delivered&#160;to&#160;the&#160;ME.&#160;There&#160;are&#160;<br/>also&#160;further&#160;requirements&#160;regarding&#160;access&#160;restriction&#160;for&#160;applications&#160;running&#160;on&#160;<br/>the&#160;UE&#160;(User&#160;Equipment)&#160;which&#160;request&#160;access&#160;to&#160;the&#160;GBA&#160;functions&#160;on&#160;the&#160;USIM.&#160;<br/>These&#160;access&#160;controls&#160;are&#160;not&#160;specifically&#160;supported&#160;by&#160;any&#160;additional&#160;cryptographic&#160;<br/>mechanisms,&#160;&#160;&#160;and&#160;&#160;&#160;would&#160;&#160;&#160;therefore&#160;&#160;&#160;need&#160;&#160;&#160;to&#160;&#160;&#160;be&#160;&#160;&#160;by&#160;&#160;&#160;supported&#160;&#160;&#160;access&#160;&#160;&#160;control&#160;<br/>mechanisms&#160;&#160;&#160;built&#160;&#160;&#160;into&#160;&#160;&#160;the&#160;&#160;&#160;software&#160;&#160;&#160;architecture&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;ME.&#160;&#160;&#160;Most&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;OMTP&#160;<br/>requirements&#160;are&#160;based&#160;on&#160;references&#160;to&#160;the&#160;relevant&#160;3GPP&#160;specifications.</p>
<p style="position:absolute;top:890px;left:112px;white-space:nowrap" class="ft8834">●</p>
<p style="position:absolute;top:881px;left:139px;white-space:nowrap" class="ft8814">Run-Time&#160;Integrity&#160;Checking&#160;(RIC)</p>
<p style="position:absolute;top:919px;left:85px;white-space:nowrap" class="ft8815">TR0&#160;&#160;&#160;was&#160;&#160;&#160;mostly&#160;&#160;&#160;concerned&#160;&#160;&#160;with&#160;&#160;&#160;boot&#160;&#160;&#160;time&#160;&#160;&#160;security&#160;&#160;&#160;when&#160;&#160;&#160;considering&#160;&#160;&#160;platform&#160;<br/>integrity.&#160;Where&#160;as&#160;TR0&#160;did&#160;make&#160;references&#160;to&#160;run-time&#160;checking,&#160;there&#160;were&#160;no&#160;<br/>detailed&#160;requirements.&#160;The&#160;purpose&#160;of&#160;RIC&#160;is&#160;to&#160;check&#160;system&#160;integrity,&#160;post&#160;of&#160;boot.&#160;<br/>The&#160;RIC&#160;requirements&#160;do&#160;not&#160;define&#160;what&#160;must&#160;be&#160;checked&#160;by&#160;the&#160;RIC,&#160;but&#160;rather&#160;the&#160;<br/>robustness&#160;rules&#160;for&#160;the&#160;RIC&#160;mechanisms.</p>
<p style="position:absolute;top:1034px;left:85px;white-space:nowrap" class="ft8815">Some&#160;important&#160;principles&#160;are&#160;laid&#160;out.&#160;For&#160;&#160;example&#160;the&#160;RIC&#160;&#160;may&#160;be&#160;a&#160;hardware&#160;<br/>mechanism&#160;or&#160;could&#160;also&#160;be&#160;software&#160;mechanism&#160;in&#160;a&#160;TEE.&#160;The&#160;RIC&#160;cannot&#160;be&#160;used&#160;to&#160;<br/>check&#160;resources&#160;upon&#160;which&#160;it&#160;relies.&#160;For&#160;example,&#160;if&#160;the&#160;RIC&#160;is&#160;executed&#160;within&#160;a&#160;<br/>TEE,&#160;it&#160;cannot&#160;be&#160;used&#160;to&#160;check&#160;the&#160;integrity&#160;of&#160;that&#160;TEE.&#160;Also,&#160;it&#160;must&#160;not&#160;be&#160;possible&#160;<br/>for&#160;&#160;&#160;less&#160;&#160;&#160;trusted&#160;&#160;&#160;software&#160;&#160;&#160;to&#160;&#160;&#160;manipulate&#160;&#160;&#160;this&#160;&#160;&#160;TEE&#160;&#160;&#160;or&#160;&#160;&#160;other&#160;&#160;&#160;RIC&#160;&#160;&#160;assets.&#160;&#160;&#160;All&#160;&#160;&#160;the&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft887">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft887">88/109</p>
</div>
<!-- Page 89 -->
<a name="89"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page89-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application089.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft8912">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft890">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft894">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft894">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft8914">requirements&#160;are&#160;made&#160;with&#160;reference&#160;to&#160;the&#160;threat&#160;model.</p>
<p style="position:absolute;top:189px;left:85px;white-space:nowrap" class="ft8915">What&#160;is&#160;actually&#160;checked&#160;depends&#160;on&#160;the&#160;system.&#160;This&#160;could&#160;be&#160;the&#160;main&#160;OS.&#160;Access&#160;<br/>Control&#160;&#160;&#160;Lists&#160;&#160;&#160;or&#160;&#160;&#160;other&#160;&#160;&#160;sensitive&#160;&#160;&#160;system&#160;&#160;&#160;assets.&#160;&#160;&#160;The&#160;&#160;&#160;specification&#160;&#160;&#160;also&#160;&#160;&#160;considers&#160;&#160;&#160;a&#160;<br/>primary&#160;and&#160;secondary&#160;RIC.&#160;The&#160;secondary&#160;RIC&#160;could&#160;be&#160;a&#160;software&#160;mechanism&#160;used&#160;<br/>by&#160;the&#160;main&#160;OS.&#160;TR1&#160;states&#160;that&#160;the&#160;primary&#160;RIC&#160;must&#160;verify&#160;the&#160;integrity&#160;of&#160;the&#160;<br/>secondary&#160;RIC.</p>
<p style="position:absolute;top:314px;left:112px;white-space:nowrap" class="ft8934">●</p>
<p style="position:absolute;top:305px;left:139px;white-space:nowrap" class="ft8914">Secure&#160;Access&#160;to&#160;User&#160;Input/Output&#160;Facility&#160;(SUIO)</p>
<p style="position:absolute;top:343px;left:85px;white-space:nowrap" class="ft8915">The&#160;SUIO&#160;requirements&#160;are&#160;concerned&#160;with&#160;the&#160;input&#160;and&#160;output&#160;of&#160;data&#160;between&#160;the&#160;<br/>user&#160;&#160;and&#160;the&#160;&#160;TEE&#160;where&#160;&#160;a&#160;trusted&#160;application&#160;&#160;is&#160;executing.&#160;&#160;SUIO&#160;&#160;&#160;assets&#160;&#160;are&#160;&#160;only&#160;<br/>required&#160;to&#160;be&#160;defending&#160;against&#160;software&#160;attacks.&#160;The&#160;IO&#160;facilities&#160;here&#160;could&#160;be&#160;a&#160;<br/>keyboard,&#160;touch-screen,&#160;display&#160;etc.</p>
<p style="position:absolute;top:448px;left:112px;white-space:nowrap" class="ft8934">●</p>
<p style="position:absolute;top:439px;left:139px;white-space:nowrap" class="ft8914">Secure&#160;Interaction&#160;of&#160;UICC&#160;with&#160;Mobile&#160;Equipment&#160;(SUM)</p>
<p style="position:absolute;top:477px;left:85px;white-space:nowrap" class="ft8915">The&#160;&#160;&#160;SUM&#160;&#160;&#160;requirements&#160;&#160;&#160;are&#160;&#160;&#160;concerned&#160;&#160;&#160;with&#160;&#160;&#160;creating&#160;&#160;&#160;and&#160;&#160;&#160;maintaining&#160;&#160;&#160;a&#160;&#160;&#160;secure&#160;<br/>channel&#160;between&#160;the&#160;ME&#160;and&#160;the&#160;UICC.&#160;The&#160;required&#160;function&#160;is&#160;that&#160;the&#160;UICC&#160;can&#160;<br/>authenticate&#160;the&#160;ME,&#160;or&#160;perhaps&#160;a&#160;specific&#160;TEE&#160;running&#160;in&#160;the&#160;ME,&#160;and&#160;a&#160;secure&#160;<br/>channel&#160;can&#160;be&#160;created&#160;between&#160;the&#160;ME&#160;(or&#160;TEE)&#160;and&#160;the&#160;UICC.&#160;This&#160;allows&#160;a&#160;secure&#160;<br/>application&#160;to&#160;be&#160;partitioned&#160;between&#160;the&#160;ME&#160;and&#160;the&#160;UICC.</p>
<p style="position:absolute;top:611px;left:85px;white-space:nowrap" class="ft896"><b>4.1.2&#160;Threat&#160;Model</b></p>
<p style="position:absolute;top:637px;left:85px;white-space:nowrap" class="ft8915">As&#160;already&#160;mentioned&#160;TR1&#160;has&#160;a&#160;much&#160;more&#160;detailed&#160;threat&#160;model&#160;than&#160;TR0.&#160;Seven&#160;<br/>threat&#160;groups&#160;have&#160;been&#160;defined.</p>
<p style="position:absolute;top:713px;left:85px;white-space:nowrap" class="ft896"><b>4.1.2.1&#160;Group&#160;1&#160;(Hardware&#160;Modules&#160;used&#160;for&#160;Accessing&#160;Memories)</b></p>
<p style="position:absolute;top:758px;left:85px;white-space:nowrap" class="ft8915">These&#160;are&#160;threats&#160;which&#160;are&#160;based&#160;on&#160;misuse&#160;of&#160;on&#160;chip&#160;bus&#160;master&#160;modules,&#160;other&#160;<br/>than&#160;the&#160;main&#160;CPU,&#160;which&#160;could&#160;be&#160;used&#160;to&#160;access&#160;security&#160;sensitive&#160;memory&#160;ranges&#160;<br/>for&#160;example.&#160;These&#160;types&#160;of&#160;attacks&#160;are&#160;considered,&#160;especially&#160;since&#160;master&#160;modules&#160;<br/>usually&#160;do&#160;not&#160;have&#160;any&#160;MMU&#160;type&#160;hardware&#160;built&#160;into&#160;them.</p>
<p style="position:absolute;top:872px;left:85px;white-space:nowrap" class="ft8911"><b>4.1.2.2&#160;Group&#160;&#160;&#160;2&#160;&#160;&#160;(CLCD&#160;&#160;&#160;(Color&#160;&#160;&#160;LCD&#160;&#160;&#160;Controller)&#160;&#160;&#160;used&#160;&#160;&#160;for&#160;&#160;&#160;displaying&#160;&#160;&#160;memories&#160;&#160;&#160;and&#160;<br/>interfering&#160;with&#160;displayed&#160;data)</b></p>
<p style="position:absolute;top:936px;left:85px;white-space:nowrap" class="ft8915">These&#160;threats&#160;are&#160;similar&#160;to&#160;group&#160;1,&#160;but&#160;allow&#160;any&#160;accessed&#160;sensitive&#160;data&#160;to&#160;be&#160;<br/>displayed.</p>
<p style="position:absolute;top:1011px;left:85px;white-space:nowrap" class="ft8911"><b>4.1.2.3&#160;Group&#160;&#160;&#160;3&#160;&#160;&#160;(Bypass&#160;&#160;&#160;security&#160;&#160;&#160;by&#160;&#160;&#160;removal&#160;&#160;&#160;of&#160;&#160;&#160;battery&#160;&#160;&#160;power&#160;&#160;&#160;or&#160;&#160;&#160;removal&#160;&#160;&#160;of&#160;<br/>external&#160;memory&#160;card)</b></p>
<p style="position:absolute;top:1055px;left:85px;white-space:nowrap" class="ft8915">These&#160;threats&#160;are&#160;concerned&#160;with&#160;putting&#160;the&#160;ME&#160;in&#160;an&#160;unknown&#160;state,&#160;or&#160;preventing&#160;<br/>it&#160;from&#160;completing&#160;a&#160;sensitive&#160;operation&#160;by&#160;power&#160;removal.&#160;Memory&#160;card&#160;is&#160;included&#160;<br/>as&#160;if&#160;sensitive&#160;information&#160;were&#160;stored&#160;on&#160;it,&#160;it&#160;may&#160;be&#160;possible&#160;to&#160;manipulate&#160;the&#160;<br/>handset&#160;behavior&#160;with&#160;respect&#160;to&#160;these&#160;sensitive&#160;objects&#160;by&#160;removing&#160;the&#160;memory&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft897">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft897">89/109</p>
</div>
<!-- Page 90 -->
<a name="90"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft9065{font-size:18px;font-family:HAAAAA+Arial;color:#000000;}
-->
</style>
<div id="page90-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application090.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft9012">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft900">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft904">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft904">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft9014">card.</p>
<p style="position:absolute;top:207px;left:85px;white-space:nowrap" class="ft906"><b>4.1.2.4&#160;Group&#160;4&#160;(Attack&#160;by&#160;replacement&#160;of&#160;flash&#160;when&#160;power&#160;is&#160;off&#160;(pre-boot))</b></p>
<p style="position:absolute;top:234px;left:85px;white-space:nowrap" class="ft9015">A&#160;secured&#160;handset&#160;which&#160;does&#160;not&#160;allow&#160;the&#160;code&#160;image&#160;in&#160;flash&#160;to&#160;be&#160;altered&#160;could&#160;<br/>still&#160;be&#160;attacked&#160;by&#160;de-soldering&#160;the&#160;flash&#160;and&#160;replacing&#160;it&#160;with&#160;hacked&#160;code.</p>
<p style="position:absolute;top:310px;left:85px;white-space:nowrap" class="ft906"><b>4.1.2.5&#160;Group&#160;5&#160;(Extract&#160;secret&#160;via&#160;bus&#160;monitoring)</b></p>
<p style="position:absolute;top:336px;left:85px;white-space:nowrap" class="ft9015">Confidential&#160;&#160;&#160;data&#160;&#160;&#160;could&#160;&#160;&#160;be&#160;&#160;&#160;extracted&#160;&#160;&#160;from&#160;&#160;&#160;the&#160;&#160;&#160;ME&#160;&#160;&#160;if&#160;&#160;&#160;it&#160;&#160;&#160;passes&#160;&#160;&#160;between&#160;&#160;&#160;the&#160;&#160;&#160;main&#160;<br/>processor&#160;and&#160;external&#160;flash&#160;or&#160;DRAM,&#160;by&#160;probing&#160;the&#160;connections&#160;between&#160;these&#160;<br/>components.</p>
<p style="position:absolute;top:431px;left:85px;white-space:nowrap" class="ft906"><b>4.1.2.6&#160;Group&#160;6&#160;(Mod&#160;chip&#160;attacks&#160;on&#160;data&#160;in&#160;external&#160;RAM)</b></p>
<p style="position:absolute;top:457px;left:85px;white-space:nowrap" class="ft9015">These&#160;&#160;&#160;are&#160;&#160;&#160;quite&#160;&#160;&#160;advanced&#160;&#160;&#160;threats.&#160;&#160;&#160;They&#160;&#160;&#160;are&#160;&#160;&#160;concerned&#160;&#160;with&#160;&#160;&#160;the&#160;&#160;&#160;use&#160;&#160;&#160;of&#160;&#160;&#160;additional&#160;<br/>hardware&#160;built&#160;into&#160;the&#160;ME&#160;which&#160;can&#160;be&#160;used&#160;to&#160;manipulate&#160;data&#160;or&#160;code&#160;at&#160;runtime,&#160;<br/>as&#160;it&#160;is&#160;in&#160;transit&#160;between&#160;the&#160;main&#160;CPU&#160;and&#160;external&#160;memory.&#160;This&#160;could&#160;alter&#160;the&#160;<br/>behaviour&#160;of&#160;the&#160;ME.</p>
<p style="position:absolute;top:571px;left:85px;white-space:nowrap" class="ft906"><b>4.1.2.7&#160;Group&#160;7&#160;(Attack&#160;by&#160;replacement&#160;of&#160;flash&#160;when&#160;power&#160;is&#160;on&#160;(post-boot))</b></p>
<p style="position:absolute;top:598px;left:85px;white-space:nowrap" class="ft9015">This&#160;threat&#160;is&#160;based&#160;on&#160;a&#160;physical&#160;attack&#160;on&#160;the&#160;handset.&#160;The&#160;handset&#160;is&#160;modified&#160;with&#160;<br/>additional&#160;&#160;&#160;logic&#160;&#160;&#160;(and&#160;&#160;&#160;perhaps&#160;&#160;&#160;memory&#160;&#160;&#160;components)&#160;&#160;&#160;so&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;memory&#160;&#160;&#160;image&#160;&#160;&#160;is&#160;<br/>swapped&#160;post&#160;boot,&#160;with&#160;modified&#160;code.</p>
<p style="position:absolute;top:693px;left:85px;white-space:nowrap" class="ft906"><b>4.1.2.8&#160;Software&#160;Threats</b></p>
<p style="position:absolute;top:719px;left:85px;white-space:nowrap" class="ft9014">Software&#160;threats&#160;are&#160;handled&#160;as&#160;a&#160;set&#160;of&#160;best&#160;practices.</p>
<p style="position:absolute;top:776px;left:112px;white-space:nowrap" class="ft9065"><b>Software&#160;Quality&#160;Measures</b></p>
<p style="position:absolute;top:805px;left:85px;white-space:nowrap" class="ft9015">Improving&#160;&#160;&#160;the&#160;&#160;&#160;quality&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;software&#160;&#160;&#160;is&#160;&#160;&#160;concerned&#160;&#160;&#160;with&#160;&#160;&#160;removing&#160;&#160;&#160;security&#160;<br/>vulnerabilities&#160;which&#160;could&#160;be&#160;exploited.&#160;The&#160;types&#160;of&#160;measures&#160;which&#160;are&#160;advised&#160;<br/>include&#160;special&#160;attention&#160;to&#160;validation&#160;of&#160;security&#160;code,&#160;external&#160;review,&#160;reduce&#160;size&#160;of&#160;<br/>the&#160;security&#160;code,&#160;and&#160;use&#160;of&#160;an&#160;execution&#160;environment&#160;with&#160;reduced&#160;instruction&#160;set&#160;<br/>(Java&#160;for&#160;example).</p>
<p style="position:absolute;top:939px;left:112px;white-space:nowrap" class="ft9065"><b>Definition&#160;of&#160;API&#160;Related&#160;Coding&#160;Techniques</b></p>
<p style="position:absolute;top:968px;left:85px;white-space:nowrap" class="ft9015">Techniques&#160;are&#160;described&#160;which&#160;avoid&#160;problems&#160;due&#160;to&#160;poorly&#160;designed&#160;APIs.&#160;These&#160;<br/>include&#160;separation&#160;of&#160;security&#160;APIs&#160;from&#160;other&#160;APIs,&#160;isolation&#160;of&#160;security&#160;code&#160;from&#160;<br/>other&#160;code&#160;so&#160;that&#160;a&#160;different&#160;boundary&#160;is&#160;crossed&#160;when&#160;calling&#160;security&#160;APIs&#160;than&#160;<br/>when&#160;calling&#160;standard&#160;APIs,&#160;and&#160;use&#160;type&#160;safe&#160;APIs&#160;on&#160;the&#160;security&#160;boundary.</p>
<p style="position:absolute;top:1063px;left:112px;white-space:nowrap" class="ft9065"><b>Definition&#160;of&#160;buffer&#160;overflow&#160;techniques</b></p>
<p style="position:absolute;top:1092px;left:85px;white-space:nowrap" class="ft9015">Buffer&#160;overflow&#160;attacks&#160;are&#160;a&#160;common&#160;method&#160;used&#160;to&#160;attack&#160;systems.&#160;TR1&#160;describes&#160;<br/>some&#160;techniques&#160;to&#160;counter&#160;such&#160;attacks.&#160;They&#160;include&#160;use&#160;of&#160;type&#160;safe&#160;API&#160;(which&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft907">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft907">90/109</p>
</div>
<!-- Page 91 -->
<a name="91"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page91-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application091.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft9112">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft910">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft914">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft914">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft9115">keep&#160;track&#160;of&#160;buffer&#160;sizes),&#160;and&#160;using&#160;verification&#160;tools&#160;which&#160;analyse&#160;source&#160;code&#160;for&#160;<br/>buffer&#160;overflow&#160;vulnerabilities,&#160;prevent&#160;areas&#160;used&#160;for&#160;stacks&#160;and&#160;heaps&#160;from&#160;being&#160;<br/>executable.</p>
<p style="position:absolute;top:246px;left:112px;white-space:nowrap" class="ft9165"><b>Definition&#160;of&#160;execution&#160;isolation&#160;techniques&#160;to&#160;address&#160;software&#160;attacks</b></p>
<p style="position:absolute;top:275px;left:85px;white-space:nowrap" class="ft9115">These&#160;techniques&#160;are&#160;concerned&#160;with&#160;isolating&#160;the&#160;scope&#160;of&#160;an&#160;attack.&#160;This&#160;means&#160;<br/>that&#160;if&#160;a&#160;vulnerability&#160;is&#160;found,&#160;it&#160;does&#160;not&#160;mean&#160;that&#160;the&#160;whole&#160;system&#160;is&#160;vulnerable.&#160;<br/>Methods&#160;including&#160;hardware&#160;isolation,&#160;and&#160;use&#160;of&#160;microkernel&#160;architectures,&#160;can&#160;be&#160;<br/>used&#160;to&#160;achieve&#160;this&#160;security&#160;goal.</p>
<p style="position:absolute;top:390px;left:112px;white-space:nowrap" class="ft9165"><b>Definition&#160;of&#160;concurrent&#160;processing&#160;threats</b></p>
<p style="position:absolute;top:419px;left:85px;white-space:nowrap" class="ft9115">This&#160;is&#160;concerned&#160;with&#160;vulnerabilities&#160;due&#160;to&#160;race&#160;conditions&#160;in&#160;the&#160;operating&#160;system.&#160;<br/>Possible&#160;ways&#160;to&#160;combat&#160;these&#160;types&#160;of&#160;attacks&#160;is&#160;to&#160;use&#160;a&#160;simple&#160;thread&#160;model&#160;in&#160;the&#160;<br/>the&#160;security&#160;software&#160;domain.</p>
<p style="position:absolute;top:514px;left:85px;white-space:nowrap" class="ft916"><b>4.1.3&#160;TR1&#160;Core&#160;Requirements</b></p>
<p style="position:absolute;top:540px;left:85px;white-space:nowrap" class="ft9115">TR1&#160;has&#160;a&#160;set&#160;of&#160;requirements&#160;which&#160;are&#160;valid&#160;throughout&#160;the&#160;whole&#160;document&#160;for&#160;all&#160;<br/>Security&#160;Enabler&#160;and&#160;use&#160;case&#160;requirements.&#160;It&#160;starts&#160;by&#160;defining&#160;asset&#160;grouping.&#160;<br/>These&#160;are&#160;split&#160;into&#160;sensitive&#160;TR1&#160;code&#160;assets,&#160;data&#160;assets,&#160;hardware&#160;assets,&#160;and&#160;key&#160;<br/>assets.</p>
<p style="position:absolute;top:636px;left:85px;white-space:nowrap" class="ft9115">TR1&#160;&#160;&#160;then&#160;&#160;&#160;defines&#160;&#160;&#160;some&#160;&#160;&#160;base&#160;&#160;&#160;requirements&#160;&#160;&#160;for&#160;&#160;&#160;software&#160;&#160;&#160;threats,&#160;&#160;&#160;and&#160;&#160;&#160;hardware&#160;<br/>threats,&#160;&#160;&#160;and&#160;&#160;&#160;specifies&#160;&#160;&#160;which&#160;&#160;&#160;for&#160;&#160;&#160;profile&#160;&#160;&#160;1&#160;&#160;&#160;and&#160;&#160;&#160;2&#160;&#160;&#160;which&#160;&#160;&#160;threats&#160;&#160;&#160;must&#160;&#160;&#160;be&#160;&#160;&#160;defended&#160;<br/>against.</p>
<p style="position:absolute;top:731px;left:85px;white-space:nowrap" class="ft916"><b>4.1.3.1&#160;Requirements&#160;to&#160;protect&#160;against&#160;software&#160;threats</b></p>
<p style="position:absolute;top:757px;left:85px;white-space:nowrap" class="ft9115">For&#160;&#160;&#160;both&#160;&#160;&#160;profile&#160;&#160;&#160;1&#160;&#160;&#160;and&#160;&#160;profile&#160;&#160;&#160;2,&#160;&#160;TR1&#160;&#160;&#160;requires&#160;&#160;use&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;techniques&#160;&#160;proposed&#160;&#160;in&#160;<br/>‘Definition&#160;&#160;&#160;of&#160;&#160;&#160;software&#160;&#160;&#160;Quality&#160;&#160;&#160;Measures’,&#160;&#160;&#160;‘Definition&#160;&#160;&#160;of&#160;&#160;&#160;API&#160;&#160;&#160;Related&#160;&#160;&#160;Coding&#160;<br/>Techniques,&#160;‘Definition&#160;of&#160;Buffer&#160;Overflow&#160;Protection&#160;Mechanisms’.</p>
<p style="position:absolute;top:834px;left:85px;white-space:nowrap" class="ft9115">Only&#160;profile&#160;2&#160;is&#160;required&#160;to&#160;defend&#160;the&#160;TR1&#160;asset’s&#160;security&#160;properties&#160;against&#160;the&#160;<br/>threats&#160;&#160;&#160;described&#160;&#160;&#160;in&#160;&#160;&#160;‘Hardware&#160;&#160;&#160;Modules&#160;&#160;&#160;used&#160;&#160;&#160;for&#160;&#160;&#160;Accessing&#160;&#160;&#160;Memory’&#160;&#160;&#160;and&#160;&#160;&#160;‘CLCD&#160;<br/>used&#160;for&#160;Displaying&#160;Memories&#160;and&#160;Interfering&#160;with&#160;Displayed&#160;Data’.</p>
<p style="position:absolute;top:911px;left:85px;white-space:nowrap" class="ft9115">Further,&#160;&#160;&#160;only&#160;&#160;&#160;profile&#160;&#160;&#160;2&#160;&#160;&#160;is&#160;&#160;&#160;recommended&#160;&#160;&#160;to&#160;&#160;&#160;make&#160;&#160;&#160;use&#160;&#160;&#160;of&#160;&#160;&#160;methods&#160;&#160;&#160;described&#160;&#160;&#160;in&#160;<br/>‘Definition&#160;of&#160;Concurrent&#160;Processing&#160;Threats’,&#160;and&#160;‘Definition&#160;of&#160;Execution&#160;Isolation&#160;<br/>Techniques&#160;to&#160;Address&#160;Software&#160;Attacks’.</p>
<p style="position:absolute;top:1006px;left:85px;white-space:nowrap" class="ft916"><b>4.1.3.2&#160;Requirements&#160;to&#160;protect&#160;against&#160;hardware&#160;threats</b></p>
<p style="position:absolute;top:1032px;left:85px;white-space:nowrap" class="ft9115">The&#160;security&#160;properties&#160;of&#160;TR1&#160;profile&#160;1&#160;and&#160;2&#160;code,&#160;data,&#160;and&#160;key&#160;assets&#160;are&#160;required&#160;<br/>to&#160;be&#160;protected&#160;against&#160;attacks&#160;based&#160;on&#160;battery&#160;or&#160;card&#160;removal&#160;(threat&#160;group&#160;3),&#160;<br/>and&#160;attacks&#160;based&#160;on&#160;the&#160;removal&#160;of&#160;flash&#160;when&#160;the&#160;mobile&#160;phone&#160;is&#160;not&#160;powered&#160;<br/>(threat&#160;group&#160;4).</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft917">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft917">91/109</p>
</div>
<!-- Page 92 -->
<a name="92"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page92-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application092.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft9212">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft920">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft924">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft924">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft9215">Only&#160;&#160;&#160;profile&#160;&#160;&#160;2&#160;&#160;&#160;TR1&#160;&#160;&#160;confidential&#160;&#160;&#160;assets&#160;&#160;&#160;are&#160;&#160;&#160;required&#160;&#160;&#160;to&#160;&#160;&#160;be&#160;&#160;&#160;defended&#160;&#160;&#160;against&#160;&#160;&#160;bus&#160;<br/>probing&#160;threats&#160;(threat&#160;group&#160;5),&#160;and&#160;only&#160;profile&#160;2&#160;TR1&#160;Key&#160;Assets&#160;are&#160;required&#160;to&#160;be&#160;<br/>protected&#160;against&#160;‘Mod&#160;chip&#160;attacks&#160;on&#160;data&#160;in&#160;external&#160;memory’&#160;(threat&#160;group&#160;6),&#160;<br/>and&#160;‘Attack&#160;by&#160;replacement&#160;of&#160;flash&#160;when&#160;power&#160;is&#160;on’&#160;(threat&#160;group&#160;7).</p>
<p style="position:absolute;top:265px;left:85px;white-space:nowrap" class="ft926"><b>4.1.3.3&#160;Debug&#160;Requirements</b></p>
<p style="position:absolute;top:292px;left:85px;white-space:nowrap" class="ft9215">The&#160;debug&#160;requirements&#160;refer&#160;to&#160;the&#160;TR0&#160;debug&#160;requirements,&#160;but&#160;are&#160;a&#160;little&#160;more&#160;<br/>specific&#160;regarding&#160;threat&#160;profile.&#160;The&#160;most&#160;important&#160;point&#160;is&#160;that&#160;debug&#160;assets&#160;which&#160;<br/>are&#160;used&#160;to&#160;debug&#160;a&#160;profile&#160;2&#160;TEE&#160;must&#160;also&#160;be&#160;of&#160;profile&#160;2.</p>
<p style="position:absolute;top:367px;left:85px;white-space:nowrap" class="ft926"><b>4.1.3.4&#160;Cryptographic&#160;Requirements</b></p>
<p style="position:absolute;top:394px;left:85px;white-space:nowrap" class="ft9215">TR1&#160;also&#160;defines&#160;a&#160;set&#160;of&#160;cryptographic&#160;requirements.&#160;These&#160;are&#160;quite&#160;similar&#160;to&#160;TR0&#160;<br/>HUK&#160;&#160;&#160;(Hardware&#160;&#160;&#160;Unique&#160;&#160;&#160;Key)&#160;&#160;&#160;requirements.&#160;&#160;&#160;Some&#160;&#160;&#160;changes&#160;&#160;&#160;are&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;RSA&#160;&#160;&#160;key&#160;<br/>length&#160;was&#160;increased&#160;from&#160;1024&#160;to&#160;2048&#160;bit,&#160;and&#160;the&#160;SHA&#160;digest&#160;length&#160;was&#160;also&#160;<br/>increased&#160;from&#160;SHA1&#160;(160&#160;bit)&#160;to&#160;SHA-256&#160;for&#160;protecting&#160;authenticity.</p>
<p style="position:absolute;top:508px;left:85px;white-space:nowrap" class="ft926"><b>4.1.4&#160;Asset&#160;Protection</b></p>
<p style="position:absolute;top:534px;left:85px;white-space:nowrap" class="ft9215">Each&#160;TR1&#160;enabler&#160;or&#160;Use&#160;Case&#160;description&#160;has&#160;an&#160;asset&#160;table.&#160;Each&#160;asset&#160;has&#160;its&#160;type&#160;<br/>defined&#160;(data,&#160;code,&#160;keys&#160;etc.),&#160;and&#160;the&#160;security&#160;property&#160;required&#160;for&#160;this&#160;property&#160;is&#160;<br/>defined.&#160;All&#160;the&#160;TR1&#160;enablers&#160;and&#160;Use&#160;Cases&#160;specifically&#160;refer&#160;to&#160;an&#160;HUK&#160;as&#160;an&#160;asset.&#160;<br/>The&#160;security&#160;properties&#160;which&#160;are&#160;defined&#160;are&#160;integrity,&#160;confidentiality,&#160;authenticity,&#160;<br/>and&#160;non-replay.&#160;Often&#160;the&#160;requirement&#160;for&#160;defending&#160;a&#160;property&#160;is&#160;very&#160;specific&#160;to&#160;the&#160;<br/>use&#160;case.</p>
<p style="position:absolute;top:687px;left:85px;white-space:nowrap" class="ft926"><b>4.1.5&#160;Trusted&#160;Execution&#160;Environment</b></p>
<p style="position:absolute;top:713px;left:85px;white-space:nowrap" class="ft9215">In&#160;this&#160;section&#160;we&#160;look&#160;at&#160;the&#160;TEE&#160;is&#160;a&#160;little&#160;more&#160;detail&#160;since&#160;this&#160;is&#160;one&#160;of&#160;the&#160;most&#160;<br/>important&#160;security&#160;enablers&#160;for&#160;TR1.&#160;TR1&#160;begins&#160;by&#160;introducing&#160;the&#160;concept&#160;of&#160;an&#160;<br/>Execution&#160;Environment&#160;(EE),&#160;being&#160;a&#160;set&#160;of&#160;hardware/software&#160;components.</p>
<p style="position:absolute;top:790px;left:85px;white-space:nowrap" class="ft9215">Further,&#160;&#160;&#160;TR1&#160;&#160;&#160;describes&#160;&#160;&#160;a&#160;&#160;&#160;typical&#160;&#160;&#160;set&#160;&#160;&#160;of&#160;&#160;&#160;core&#160;&#160;&#160;components&#160;&#160;&#160;for&#160;&#160;&#160;the&#160;&#160;&#160;execution&#160;<br/>environment&#160;itself.&#160;These&#160;are&#160;a&#160;processing&#160;unit&#160;which&#160;define&#160;the&#160;EE&#160;Instruction&#160;Set&#160;<br/>Architecture&#160;(ISA),&#160;a&#160;set&#160;&#160;of&#160;connections&#160;(buses&#160;for&#160;example),&#160;&#160;physical&#160;memory&#160;for&#160;<br/>storing&#160;data&#160;&#160;and&#160;&#160;code,&#160;&#160;a&#160;&#160;mechanism&#160;&#160;for&#160;&#160;initializing&#160;the&#160;&#160;boot&#160;&#160;process,&#160;&#160;and&#160;&#160;the&#160;&#160;EE&#160;<br/>code,&#160;data&#160;and&#160;keys.</p>
<p style="position:absolute;top:905px;left:85px;white-space:nowrap" class="ft9218">The&#160;EE&#160;has&#160;a&#160;set&#160;of&#160;facilities&#160;which&#160;it&#160;makes&#160;available&#160;to&#160;Applications.<br/>The&#160;applications&#160;need&#160;some&#160;form&#160;of&#160;interface.&#160;This&#160;could&#160;be&#160;an&#160;API&#160;or&#160;an&#160;ISA.</p>
<p style="position:absolute;top:981px;left:85px;white-space:nowrap" class="ft9215">EEs&#160;will&#160;vary&#160;in&#160;complexity,&#160;they&#160;may&#160;provide&#160;dynamic&#160;management&#160;of&#160;code&#160;(thread&#160;<br/>management,&#160;&#160;&#160;task&#160;&#160;&#160;switching,&#160;&#160;&#160;the&#160;&#160;&#160;possibility&#160;&#160;&#160;to&#160;&#160;&#160;load&#160;&#160;and&#160;&#160;&#160;unload&#160;&#160;&#160;applications&#160;&#160;&#160;etc.).&#160;<br/>Further,&#160;the&#160;code&#160;may&#160;be&#160;natively&#160;executed&#160;or&#160;interpreted.</p>
<p style="position:absolute;top:1066px;left:85px;white-space:nowrap" class="ft9215">The&#160;&#160;&#160;environment&#160;&#160;&#160;may&#160;&#160;&#160;also&#160;&#160;&#160;provide&#160;&#160;&#160;memory&#160;&#160;&#160;management.&#160;&#160;&#160;This&#160;&#160;&#160;allows&#160;&#160;&#160;areas&#160;&#160;&#160;of&#160;<br/>memory&#160;&#160;to&#160;be&#160;&#160;allocated/de-allocated,&#160;&#160;and&#160;control&#160;&#160;access&#160;&#160;to&#160;memory&#160;&#160;depending&#160;&#160;on&#160;<br/>what&#160;&#160;&#160;application&#160;&#160;is&#160;&#160;currently&#160;&#160;&#160;running&#160;&#160;in&#160;&#160;the&#160;&#160;&#160;environment.&#160;&#160;&#160;Other&#160;&#160;facilities&#160;&#160;such&#160;&#160;as&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft927">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft927">92/109</p>
</div>
<!-- Page 93 -->
<a name="93"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page93-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application093.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft9312">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft930">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft934">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft934">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft9314">storage&#160;and&#160;retrieval&#160;of&#160;data&#160;in&#160;non&#160;volatile&#160;memory&#160;may&#160;also&#160;be&#160;provided.</p>
<p style="position:absolute;top:198px;left:85px;white-space:nowrap" class="ft9315">The&#160;EE&#160;may&#160;also&#160;offer&#160;facilities&#160;which&#160;allow&#160;an&#160;application&#160;to&#160;communicate&#160;with&#160;the&#160;<br/>external&#160;world.&#160;This&#160;could&#160;be&#160;to&#160;something&#160;local&#160;such&#160;as&#160;keyboard&#160;and&#160;display,&#160;or&#160;<br/>something&#160;remote&#160;such&#160;as&#160;a&#160;network&#160;connection.</p>
<p style="position:absolute;top:284px;left:85px;white-space:nowrap" class="ft9315">As&#160;already&#160;mentioned&#160;more&#160;than&#160;one&#160;application&#160;may&#160;execute&#160;in&#160;an&#160;EE.&#160;The&#160;EE&#160;may&#160;<br/>provide&#160;facilities&#160;to&#160;allow&#160;the&#160;applications&#160;to&#160;communicate&#160;with&#160;each&#160;other.&#160;The&#160;EE&#160;<br/>may&#160;also&#160;provide&#160;facilities&#160;to&#160;install,&#160;upgrade&#160;and&#160;generally&#160;manage&#160;applications.&#160;This&#160;<br/>may&#160;&#160;&#160;include&#160;&#160;&#160;identifying&#160;&#160;&#160;users&#160;&#160;&#160;and&#160;&#160;&#160;processes,&#160;&#160;&#160;and&#160;&#160;&#160;assign&#160;&#160;&#160;them&#160;&#160;&#160;credentials&#160;&#160;&#160;and&#160;<br/>permissions&#160;so&#160;that&#160;access&#160;control&#160;policies&#160;may&#160;be&#160;enforced.</p>
<p style="position:absolute;top:408px;left:85px;white-space:nowrap" class="ft9315">A&#160;&#160;&#160;system&#160;&#160;&#160;may&#160;&#160;&#160;contain&#160;&#160;&#160;multiple&#160;&#160;&#160;Execution&#160;&#160;&#160;Environments,&#160;&#160;&#160;and&#160;&#160;&#160;they&#160;&#160;&#160;may&#160;&#160;&#160;share&#160;<br/>resources,&#160;or&#160;have&#160;resources&#160;allocated&#160;to&#160;a&#160;particular&#160;EE.&#160;In&#160;this&#160;case,&#160;the&#160;resource&#160;<br/>must&#160;&#160;&#160;be&#160;&#160;&#160;protected&#160;&#160;&#160;from&#160;&#160;&#160;other&#160;&#160;&#160;EEs.&#160;&#160;&#160;TR1&#160;&#160;&#160;assumes&#160;&#160;&#160;that&#160;&#160;&#160;some&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;EEs&#160;&#160;&#160;will&#160;&#160;&#160;have&#160;<br/>access&#160;to&#160;a&#160;Hardware&#160;Unique&#160;Key&#160;as&#160;defined&#160;in&#160;TR0.&#160;TR1&#160;also&#160;assumes&#160;that&#160;a&#160;TEE&#160;<br/>will&#160;always&#160;have&#160;access&#160;to&#160;secure&#160;storage&#160;facilities.</p>
<p style="position:absolute;top:533px;left:85px;white-space:nowrap" class="ft9315">Applications&#160;running&#160;in&#160;an&#160;EE&#160;could&#160;be&#160;a&#160;service&#160;to&#160;a&#160;user,&#160;or&#160;to&#160;another&#160;application.&#160;<br/>An&#160;application&#160;running&#160;in&#160;an&#160;EE&#160;could&#160;be&#160;another&#160;EE.&#160;Example&#160;of&#160;EEs&#160;are&#160;a&#160;CPU,&#160;an&#160;<br/>Operating&#160;System,&#160;a&#160;Virtual&#160;Machine&#160;or&#160;a&#160;UICC.</p>
<p style="position:absolute;top:618px;left:85px;white-space:nowrap" class="ft9315">TR1&#160;considers&#160;two&#160;sets&#160;of&#160;security&#160;requirements&#160;(profile&#160;1&#160;and&#160;profile&#160;2)&#160;as&#160;already&#160;<br/>mentioned.&#160;If&#160;an&#160;EE&#160;meets&#160;these&#160;security&#160;requirements&#160;of&#160;a&#160;particular&#160;profile,&#160;it&#160;can&#160;<br/>then&#160;be&#160;referred&#160;to&#160;as&#160;a&#160;TEE&#160;of&#160;this&#160;profile.</p>
<p style="position:absolute;top:703px;left:85px;white-space:nowrap" class="ft936"><b>4.1.5.1&#160;Open&#160;Trusted&#160;Execution&#160;Environment</b></p>
<p style="position:absolute;top:730px;left:85px;white-space:nowrap" class="ft9315">TR1&#160;also&#160;defines&#160;an&#160;Open&#160;Trusted&#160;Execution&#160;Environment.&#160;This&#160;type&#160;of&#160;TEE&#160;is&#160;quite&#160;<br/>specific&#160;to&#160;operator&#160;requirements.&#160;An&#160;Open&#160;TEE&#160;is&#160;a&#160;TEE&#160;which&#160;allow&#160;the&#160;MNO&#160;to&#160;<br/>install&#160;applications&#160;into&#160;it&#160;‘post&#160;manufacturing’.&#160;Further,&#160;an&#160;Open&#160;TEE&#160;must&#160;support&#160;a&#160;<br/>UICC&#160;secure&#160;channel,&#160;the&#160;Generic&#160;Bootstrap&#160;Architecture,&#160;and&#160;secure&#160;user&#160;IO.</p>
<p style="position:absolute;top:844px;left:85px;white-space:nowrap" class="ft936"><b>4.1.5.2&#160;Trusted&#160;Execution&#160;Environment&#160;Requirements</b></p>
<p style="position:absolute;top:870px;left:85px;white-space:nowrap" class="ft9314">The&#160;TR1&#160;TEE&#160;requirements&#160;are&#160;partitioned&#160;into&#160;groups.&#160;These&#160;are:</p>
<p style="position:absolute;top:918px;left:112px;white-space:nowrap" class="ft9334">●</p>
<p style="position:absolute;top:908px;left:139px;white-space:nowrap" class="ft9314">TEE&#160;Core&#160;Requirements</p>
<p style="position:absolute;top:947px;left:85px;white-space:nowrap" class="ft9314">These&#160;are&#160;generally&#160;concerned&#160;with&#160;TEE&#160;HUK&#160;requirements</p>
<p style="position:absolute;top:995px;left:112px;white-space:nowrap" class="ft9334">●</p>
<p style="position:absolute;top:985px;left:139px;white-space:nowrap" class="ft9314">TEE&#160;Cryptographic&#160;Requirements</p>
<p style="position:absolute;top:1024px;left:85px;white-space:nowrap" class="ft9314">These&#160;are&#160;concerned&#160;the&#160;level&#160;of&#160;cryptographic&#160;support&#160;required&#160;by&#160;a&#160;TEE</p>
<p style="position:absolute;top:1071px;left:112px;white-space:nowrap" class="ft9334">●</p>
<p style="position:absolute;top:1062px;left:139px;white-space:nowrap" class="ft9314">TEE&#160;Keys</p>
<p style="position:absolute;top:1100px;left:85px;white-space:nowrap" class="ft9314">This&#160;is&#160;a&#160;set&#160;of&#160;requirements&#160;concerned&#160;with&#160;key&#160;handling&#160;within&#160;the&#160;TEE.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft937">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft937">93/109</p>
</div>
<!-- Page 94 -->
<a name="94"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page94-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application094.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft9412">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft940">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft944">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft944">Final</p>
<p style="position:absolute;top:160px;left:112px;white-space:nowrap" class="ft9434">●</p>
<p style="position:absolute;top:151px;left:139px;white-space:nowrap" class="ft9414">TEE&#160;Facilities</p>
<p style="position:absolute;top:189px;left:85px;white-space:nowrap" class="ft9415">These&#160;requirements&#160;are&#160;concerned&#160;with&#160;the&#160;facilities&#160;required&#160;for&#160;the&#160;different&#160;types&#160;<br/>of&#160;TEE.&#160;Examples&#160;of&#160;required&#160;facilities&#160;are&#160;SUIO,&#160;SST&#160;and&#160;SUM.</p>
<p style="position:absolute;top:256px;left:112px;white-space:nowrap" class="ft9434">●</p>
<p style="position:absolute;top:247px;left:139px;white-space:nowrap" class="ft9414">TEE&#160;Application&#160;Lifecycle</p>
<p style="position:absolute;top:285px;left:85px;white-space:nowrap" class="ft9415">These&#160;requirements&#160;are&#160;concerned&#160;with&#160;the&#160;rules&#160;for&#160;installing&#160;applications&#160;within&#160;a&#160;<br/>TEE.</p>
<p style="position:absolute;top:352px;left:112px;white-space:nowrap" class="ft9434">●</p>
<p style="position:absolute;top:343px;left:139px;white-space:nowrap" class="ft9414">TEE&#160;Application&#160;Requirements</p>
<p style="position:absolute;top:381px;left:85px;white-space:nowrap" class="ft9415">The&#160;requirements&#160;are&#160;mostly&#160;concerned&#160;with&#160;isolation&#160;of&#160;applications&#160;within&#160;a&#160;TEE,&#160;<br/>and&#160;also&#160;checking&#160;the&#160;authenticity/integrity&#160;of&#160;applications&#160;before&#160;letting&#160;them&#160;run.</p>
<p style="position:absolute;top:448px;left:112px;white-space:nowrap" class="ft9434">●</p>
<p style="position:absolute;top:439px;left:139px;white-space:nowrap" class="ft9414">TEE&#160;Self&#160;Protection&#160;Requirements</p>
<p style="position:absolute;top:477px;left:85px;white-space:nowrap" class="ft9415">These&#160;requirements&#160;are&#160;mostly&#160;concerned&#160;with&#160;securely&#160;booting&#160;the&#160;TEE,&#160;and&#160;make&#160;<br/>references&#160;to&#160;the&#160;FSB&#160;facility.</p>
<p style="position:absolute;top:544px;left:112px;white-space:nowrap" class="ft9434">●</p>
<p style="position:absolute;top:535px;left:139px;white-space:nowrap" class="ft9414">TEE&#160;Isolation&#160;Requirements</p>
<p style="position:absolute;top:573px;left:85px;white-space:nowrap" class="ft9415">These&#160;requirements&#160;are&#160;mostly&#160;concerned&#160;with&#160;protecting&#160;the&#160;TEE&#160;and&#160;its&#160;resources&#160;<br/>from&#160;others&#160;EEs.</p>
<p style="position:absolute;top:640px;left:112px;white-space:nowrap" class="ft9434">●</p>
<p style="position:absolute;top:631px;left:139px;white-space:nowrap" class="ft9414">Inter-Execution&#160;Environment&#160;Communications</p>
<p style="position:absolute;top:669px;left:85px;white-space:nowrap" class="ft9415">This&#160;&#160;&#160;is&#160;&#160;&#160;a&#160;&#160;&#160;set&#160;&#160;&#160;of&#160;&#160;&#160;requirements&#160;&#160;&#160;which&#160;&#160;&#160;are&#160;&#160;&#160;concerned&#160;&#160;&#160;with&#160;&#160;&#160;how&#160;&#160;&#160;TEEs&#160;&#160;&#160;and&#160;&#160;&#160;EEs&#160;&#160;&#160;can&#160;<br/>securely&#160;communicate&#160;with&#160;each&#160;other.</p>
<p style="position:absolute;top:727px;left:85px;white-space:nowrap" class="ft9415">One&#160;of&#160;the&#160;basic&#160;TEE&#160;requirements&#160;is&#160;access&#160;to&#160;a&#160;Secure&#160;Storage&#160;facility.&#160;We&#160;will&#160;look&#160;<br/>at&#160;the&#160;OMTP&#160;T1&#160;Secure&#160;Storage&#160;structures&#160;and&#160;requirements&#160;when&#160;we&#160;analyse&#160;the&#160;<br/>Secure&#160;Wallet&#160;prototype&#160;architecture.</p>
<p style="position:absolute;top:822px;left:85px;white-space:nowrap" class="ft946"><b>4.1.6&#160;Use&#160;Case&#160;Overview</b></p>
<p style="position:absolute;top:848px;left:85px;white-space:nowrap" class="ft9415">TR1&#160;&#160;&#160;includes&#160;&#160;&#160;three&#160;&#160;&#160;use&#160;&#160;&#160;cases.&#160;&#160;&#160;These&#160;&#160;&#160;are&#160;&#160;&#160;Broadcast&#160;&#160;&#160;Service&#160;&#160;&#160;Protection,&#160;&#160;&#160;Trusted&#160;<br/>Device&#160;Management,&#160;and&#160;Mobile&#160;Commerce.&#160;We&#160;will&#160;briefly&#160;look&#160;at&#160;them&#160;here,&#160;and&#160;<br/>summarize&#160;which&#160;of&#160;the&#160;TR1&#160;security&#160;enablers&#160;are&#160;made&#160;use&#160;of&#160;for&#160;each&#160;of&#160;them.</p>
<p style="position:absolute;top:943px;left:85px;white-space:nowrap" class="ft946"><b>4.1.6.1&#160;Broadcast&#160;Service&#160;Protection</b></p>
<p style="position:absolute;top:970px;left:85px;white-space:nowrap" class="ft9415">The&#160;broadcast&#160;service&#160;protection&#160;use&#160;case&#160;concentrates&#160;on&#160;the&#160;Open&#160;Mobile&#160;Alliance&#160;<br/>(OMA)&#160;BCAST&#160;Smart&#160;Card&#160;Profile.&#160;OMA&#160;BCAST&#160;is&#160;concerned&#160;with&#160;content&#160;broadcast&#160;<br/>services&#160;which&#160;are&#160;encrypted&#160;in&#160;order&#160;to&#160;control&#160;the&#160;consumption&#160;of&#160;these&#160;services.</p>
<p style="position:absolute;top:1046px;left:85px;white-space:nowrap" class="ft9415">In&#160;the&#160;Smart&#160;Card&#160;profile&#160;much&#160;of&#160;the&#160;security&#160;is&#160;centered&#160;on&#160;the&#160;use&#160;of&#160;a&#160;UICC.&#160;As&#160;<br/>TR1&#160;points&#160;out,&#160;the&#160;UICC&#160;has&#160;a&#160;Trusted&#160;Execution&#160;Environment&#160;like&#160;facility&#160;with&#160;on&#160;<br/>chip&#160;card&#160;secure&#160;storage.&#160;The&#160;UICCs&#160;are&#160;generally&#160;designed&#160;to&#160;defend&#160;against&#160;threats&#160;<br/>which&#160;are&#160;often&#160;out&#160;of&#160;scope&#160;for&#160;a&#160;mobile&#160;phone&#160;baseband&#160;controller.&#160;OMA&#160;BCAST&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft947">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft947">94/109</p>
</div>
<!-- Page 95 -->
<a name="95"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page95-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application095.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft9512">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft950">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft954">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft954">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft9514">Smart&#160;Card&#160;Profile&#160;defines&#160;that&#160;the&#160;long&#160;term&#160;keys&#160;are&#160;stored&#160;on&#160;the&#160;UICC.</p>
<p style="position:absolute;top:189px;left:85px;white-space:nowrap" class="ft9515">The&#160;TR1&#160;Broadcast&#160;requirements&#160;mostly&#160;deal&#160;with&#160;the&#160;protection&#160;of&#160;the&#160;keys&#160;which&#160;<br/>are&#160;in&#160;the&#160;ME.&#160;These&#160;are&#160;short&#160;terms&#160;keys,&#160;such&#160;as&#160;traffic&#160;keys,&#160;or&#160;binding&#160;keys&#160;for&#160;<br/>binding&#160;&#160;&#160;the&#160;&#160;&#160;UICC&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;ME.&#160;&#160;&#160;The&#160;&#160;&#160;requirements&#160;&#160;&#160;reference&#160;&#160;&#160;the&#160;&#160;&#160;TR1&#160;&#160;&#160;SUM&#160;&#160;&#160;(Secure&#160;<br/>Interaction&#160;&#160;&#160;of&#160;&#160;&#160;UICC&#160;&#160;&#160;with&#160;&#160;&#160;Mobile&#160;&#160;&#160;Equipment).&#160;&#160;&#160;The&#160;&#160;&#160;Broadcast&#160;&#160;&#160;Service&#160;&#160;&#160;Protection&#160;<br/>requirements&#160;&#160;&#160;also&#160;&#160;&#160;define&#160;&#160;&#160;the&#160;&#160;&#160;use&#160;&#160;&#160;of&#160;&#160;&#160;TEEs&#160;&#160;&#160;and&#160;&#160;&#160;SSTs&#160;&#160;&#160;in&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;&#160;&#160;protect&#160;&#160;&#160;the&#160;&#160;&#160;key&#160;<br/>objects.&#160;This&#160;also&#160;means&#160;that&#160;the&#160;FSB&#160;requirements&#160;must&#160;be&#160;met&#160;for&#160;this&#160;use&#160;case.</p>
<p style="position:absolute;top:324px;left:85px;white-space:nowrap" class="ft9515">OMA&#160;&#160;&#160;BCAST&#160;&#160;&#160;also&#160;&#160;&#160;makes&#160;&#160;&#160;use&#160;&#160;&#160;of&#160;&#160;&#160;GBA&#160;&#160;&#160;for&#160;&#160;&#160;key&#160;&#160;&#160;distribution,&#160;&#160;&#160;so&#160;&#160;&#160;the&#160;&#160;&#160;TR1&#160;&#160;&#160;GBA&#160;<br/>requirements&#160;are&#160;also&#160;relevant.</p>
<p style="position:absolute;top:399px;left:85px;white-space:nowrap" class="ft956"><b>4.1.6.2&#160;Trusted&#160;Device&#160;Management</b></p>
<p style="position:absolute;top:426px;left:85px;white-space:nowrap" class="ft9515">The&#160;Trusted&#160;Device&#160;Management&#160;use&#160;case&#160;is&#160;concerned&#160;with&#160;the&#160;requirements&#160;for&#160;a&#160;<br/>secure&#160;&#160;&#160;TR1&#160;&#160;&#160;implementation&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;Open&#160;&#160;&#160;Mobile&#160;&#160;&#160;Alliance&#160;&#160;&#160;Device&#160;&#160;&#160;Management&#160;<br/>protocol.&#160;&#160;This&#160;use&#160;case&#160;is&#160;divided&#160;into&#160;two&#160;sub&#160;use&#160;cases.</p>
<p style="position:absolute;top:503px;left:85px;white-space:nowrap" class="ft9514">These&#160;are:</p>
<p style="position:absolute;top:551px;left:112px;white-space:nowrap" class="ft9534">●</p>
<p style="position:absolute;top:541px;left:139px;white-space:nowrap" class="ft9514">Trusted&#160;Firmware&#160;Management&#160;(Update)</p>
<p style="position:absolute;top:580px;left:85px;white-space:nowrap" class="ft9514">Firmware&#160;refers&#160;here&#160;top&#160;the&#160;basic&#160;software&#160;of&#160;the&#160;ME&#160;including&#160;device&#160;drivers.</p>
<p style="position:absolute;top:627px;left:112px;white-space:nowrap" class="ft9534">●</p>
<p style="position:absolute;top:618px;left:139px;white-space:nowrap" class="ft9514">Trusted&#160;Software&#160;Management</p>
<p style="position:absolute;top:656px;left:85px;white-space:nowrap" class="ft9515">This&#160;refers&#160;to&#160;any&#160;software&#160;other&#160;than&#160;the&#160;firmware.&#160;The&#160;types&#160;of&#160;functions&#160;required&#160;<br/>are&#160;installation,&#160;update,&#160;removal,&#160;activation&#160;and&#160;deactivation.</p>
<p style="position:absolute;top:714px;left:85px;white-space:nowrap" class="ft9515">In&#160;OMA&#160;Device&#160;Management,&#160;the&#160;firmware/software&#160;on&#160;a&#160;device&#160;is&#160;managed&#160;by&#160;a&#160;<br/>management&#160;server.</p>
<p style="position:absolute;top:772px;left:85px;white-space:nowrap" class="ft9515">The&#160;Access&#160;Control&#160;List&#160;is&#160;one&#160;of&#160;the&#160;most&#160;security&#160;sensitive&#160;assets.&#160;This&#160;defines&#160;for&#160;<br/>each&#160;management&#160;server&#160;what&#160;types&#160;of&#160;management&#160;commands&#160;can&#160;be&#160;executed&#160;on&#160;<br/>the&#160;&#160;&#160;device.&#160;&#160;&#160;If&#160;&#160;&#160;the&#160;&#160;&#160;Access&#160;&#160;&#160;Control&#160;&#160;&#160;List&#160;&#160;&#160;is&#160;&#160;&#160;manipulated,&#160;&#160;&#160;then&#160;&#160;&#160;the&#160;&#160;&#160;device&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;<br/>compromised&#160;by&#160;an&#160;attacker.</p>
<p style="position:absolute;top:868px;left:85px;white-space:nowrap" class="ft9515">The&#160;actual&#160;requirements&#160;are&#160;centred&#160;on&#160;the&#160;protection&#160;of&#160;a&#160;device&#160;management&#160;key.&#160;<br/>This&#160;is&#160;classified&#160;as&#160;a&#160;sensitive&#160;object&#160;which&#160;must&#160;be&#160;handled&#160;by&#160;an&#160;SST&#160;facility.&#160;The&#160;<br/>requirements&#160;also&#160;define&#160;that&#160;the&#160;security&#160;properties&#160;of&#160;the&#160;device&#160;management&#160;keys&#160;<br/>shall&#160;be&#160;protected,&#160;and&#160;that&#160;the&#160;key&#160;is&#160;only&#160;accessible&#160;by&#160;the&#160;appropriate&#160;firmware&#160;or&#160;<br/>software&#160;management&#160;code.</p>
<p style="position:absolute;top:983px;left:85px;white-space:nowrap" class="ft9515">The&#160;download&#160;and&#160;update&#160;management&#160;code&#160;must&#160;be&#160;verified&#160;before&#160;execution.&#160;This&#160;<br/>could&#160;be&#160;at&#160;boot,&#160;in&#160;which&#160;case&#160;this&#160;can&#160;be&#160;managed&#160;by&#160;the&#160;secure&#160;boot.&#160;The&#160;Trusted&#160;<br/>Device&#160;Management&#160;use&#160;case&#160;also&#160;has&#160;some&#160;optional&#160;requirements&#160;for&#160;Secure&#160;User&#160;<br/>IO.&#160;TR1&#160;does&#160;not&#160;go&#160;into&#160;this&#160;in&#160;detail,&#160;but&#160;one&#160;possible&#160;reason&#160;would&#160;be&#160;so&#160;that&#160;the&#160;<br/>end&#160;user&#160;can&#160;safely&#160;make&#160;a&#160;decision&#160;on&#160;whether&#160;to&#160;carry&#160;out&#160;a&#160;software&#160;update&#160;based&#160;<br/>on&#160;the&#160;information&#160;displayed&#160;on&#160;the&#160;screen.</p>
<p style="position:absolute;top:1117px;left:85px;white-space:nowrap" class="ft9514">Requirements&#160;for&#160;handling&#160;of&#160;a&#160;download&#160;package&#160;are&#160;handled&#160;by&#160;referring&#160;to&#160;the&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft957">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft957">95/109</p>
</div>
<!-- Page 96 -->
<a name="96"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page96-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application096.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft9612">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft960">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft964">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft964">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft9615">Flexible&#160;Secure&#160;Boot&#160;security&#160;enabler.&#160;Further,&#160;if&#160;the&#160;downloaded&#160;application&#160;is&#160;to&#160;be&#160;<br/>installed&#160;&#160;&#160;into&#160;&#160;&#160;a&#160;&#160;&#160;TEE,&#160;&#160;&#160;then&#160;&#160;&#160;the&#160;&#160;&#160;installation&#160;&#160;&#160;process&#160;&#160;&#160;must&#160;&#160;&#160;follow&#160;&#160;&#160;the&#160;&#160;&#160;TEE&#160;&#160;&#160;Lifecycle&#160;<br/>Requirements.</p>
<p style="position:absolute;top:246px;left:85px;white-space:nowrap" class="ft966"><b>4.1.6.3&#160;Mobile&#160;Commerce</b></p>
<p style="position:absolute;top:272px;left:85px;white-space:nowrap" class="ft9615">The&#160;mobile&#160;commerce&#160;use&#160;case&#160;referred&#160;to&#160;by&#160;TR1&#160;is&#160;quite&#160;specific.&#160;It&#160;focuses&#160;on&#160;<br/>proximity&#160;payment&#160;where&#160;the&#160;most&#160;sensitive&#160;part&#160;of&#160;the&#160;application&#160;is&#160;in&#160;the&#160;UICC.&#160;<br/>The&#160;ME&#160;provides&#160;a&#160;User&#160;Interface&#160;(UI)&#160;to&#160;the&#160;payment&#160;application.</p>
<p style="position:absolute;top:349px;left:85px;white-space:nowrap" class="ft9615">The&#160;ME&#160;has&#160;a&#160;browser&#160;which&#160;communicates&#160;with&#160;a&#160;web&#160;server&#160;situated&#160;on&#160;the&#160;UICC&#160;<br/>via&#160;&#160;&#160;an&#160;&#160;&#160;HTTP&#160;&#160;&#160;connection.&#160;&#160;&#160;This&#160;&#160;&#160;partitioning&#160;&#160;&#160;is&#160;&#160;&#160;based&#160;&#160;&#160;on&#160;&#160;&#160;the&#160;&#160;&#160;proximity&#160;&#160;&#160;payment&#160;<br/>architecture&#160;&#160;&#160;as&#160;&#160;&#160;recommended&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;&#160;&#160;GSM&#160;&#160;&#160;Association&#160;&#160;&#160;NFC&#160;&#160;&#160;(Near&#160;&#160;&#160;Field&#160;<br/>Communication)&#160;technical&#160;guidelines.</p>
<p style="position:absolute;top:445px;left:85px;white-space:nowrap" class="ft9614">The&#160;use&#160;case&#160;is&#160;broken&#160;up&#160;into&#160;two&#160;parts</p>
<p style="position:absolute;top:484px;left:112px;white-space:nowrap" class="ft9614">1.&#160;The&#160;user&#160;has&#160;an&#160;application&#160;activated&#160;in&#160;her&#160;UICC&#160;by&#160;holding&#160;it&#160;close&#160;to&#160;a&#160;Point&#160;</p>
<p style="position:absolute;top:503px;left:139px;white-space:nowrap" class="ft9615">of&#160;&#160;&#160;Sale.&#160;&#160;&#160;The&#160;&#160;&#160;mobile&#160;&#160;&#160;commerce&#160;&#160;&#160;application&#160;&#160;&#160;indicates&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;that&#160;&#160;&#160;a&#160;<br/>transaction&#160;&#160;&#160;is&#160;&#160;&#160;pending.&#160;&#160;&#160;The&#160;&#160;&#160;user&#160;&#160;&#160;enters&#160;&#160;&#160;a&#160;&#160;&#160;PIN&#160;&#160;&#160;so&#160;&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;transaction&#160;&#160;&#160;can&#160;<br/>complete.</p>
<p style="position:absolute;top:580px;left:112px;white-space:nowrap" class="ft9614">2.&#160;The&#160;user&#160;has&#160;an&#160;application&#160;activated&#160;in&#160;her&#160;UICC&#160;by&#160;holding&#160;it&#160;close&#160;to&#160;a&#160;Point&#160;</p>
<p style="position:absolute;top:599px;left:139px;white-space:nowrap" class="ft9615">of&#160;&#160;&#160;Sale.&#160;&#160;&#160;The&#160;&#160;&#160;mobile&#160;&#160;&#160;commerce&#160;&#160;&#160;application&#160;&#160;&#160;indicates&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;that&#160;&#160;&#160;a&#160;<br/>transaction&#160;is&#160;pending.&#160;The&#160;user&#160;is&#160;only&#160;required&#160;to&#160;enter&#160;a&#160;PIN&#160;if&#160;the&#160;amount&#160;<br/>of&#160;money&#160;involved&#160;is&#160;above&#160;a&#160;certain&#160;limit.&#160;</p>
<p style="position:absolute;top:676px;left:85px;white-space:nowrap" class="ft9614">The&#160;main&#160;assets&#160;involved&#160;in&#160;this&#160;use&#160;case&#160;are:</p>
<p style="position:absolute;top:723px;left:112px;white-space:nowrap" class="ft9634">●</p>
<p style="position:absolute;top:714px;left:139px;white-space:nowrap" class="ft9615">a&#160;&#160;&#160;mobile&#160;&#160;&#160;application&#160;&#160;&#160;certificate&#160;&#160;&#160;used&#160;&#160;&#160;to&#160;&#160;&#160;allow&#160;&#160;&#160;the&#160;&#160;&#160;mobile&#160;&#160;&#160;application&#160;&#160;&#160;to&#160;<br/>authenticate&#160;itself&#160;to&#160;the&#160;UICC,&#160;and&#160;a&#160;root&#160;certificate&#160;for&#160;authenticating&#160;the&#160;<br/>mobile&#160;application&#160;certificate.</p>
<p style="position:absolute;top:781px;left:139px;white-space:nowrap" class="ft9634">○</p>
<p style="position:absolute;top:772px;left:166px;white-space:nowrap" class="ft9614">Each&#160;with&#160;the&#160;security&#160;properties&#160;integrity&#160;and&#160;authenticity</p>
<p style="position:absolute;top:819px;left:112px;white-space:nowrap" class="ft9634">●</p>
<p style="position:absolute;top:810px;left:139px;white-space:nowrap" class="ft9614">The&#160;mobile&#160;application&#160;code,&#160;data,&#160;and&#160;keys.</p>
<p style="position:absolute;top:839px;left:139px;white-space:nowrap" class="ft9634">○</p>
<p style="position:absolute;top:829px;left:166px;white-space:nowrap" class="ft9615">All&#160;with&#160;security&#160;properties&#160;integrity&#160;and&#160;authenticity&#160;plus&#160;confidentiality&#160;<br/>for&#160;the&#160;keys.</p>
<p style="position:absolute;top:877px;left:112px;white-space:nowrap" class="ft9634">●</p>
<p style="position:absolute;top:868px;left:139px;white-space:nowrap" class="ft9615">Data&#160;exchanged&#160;between&#160;the&#160;user&#160;and&#160;the&#160;mobile&#160;application&#160;via&#160;the&#160;keyboard&#160;<br/>and&#160;display.</p>
<p style="position:absolute;top:915px;left:139px;white-space:nowrap" class="ft9634">○</p>
<p style="position:absolute;top:906px;left:166px;white-space:nowrap" class="ft9615">With&#160;&#160;&#160;security&#160;&#160;&#160;properties&#160;&#160;&#160;integrity,&#160;&#160;&#160;authenticity,&#160;&#160;&#160;non-replay&#160;&#160;&#160;plus&#160;<br/>confidentiality&#160;for&#160;the&#160;keypad&#160;interface.</p>
<p style="position:absolute;top:954px;left:112px;white-space:nowrap" class="ft9634">●</p>
<p style="position:absolute;top:944px;left:139px;white-space:nowrap" class="ft9615">A&#160;session&#160;key&#160;for&#160;creating&#160;a&#160;secure&#160;channel&#160;between&#160;the&#160;mobile&#160;application&#160;<br/>and&#160;the&#160;UICC.</p>
<p style="position:absolute;top:992px;left:139px;white-space:nowrap" class="ft9634">○</p>
<p style="position:absolute;top:983px;left:166px;white-space:nowrap" class="ft9614">With&#160;security&#160;properties&#160;integrity&#160;and&#160;confidentiality.</p>
<p style="position:absolute;top:1011px;left:112px;white-space:nowrap" class="ft9634">●</p>
<p style="position:absolute;top:1002px;left:139px;white-space:nowrap" class="ft9614">A&#160;PIN&#160;for&#160;activating&#160;the&#160;payment&#160;service</p>
<p style="position:absolute;top:1031px;left:139px;white-space:nowrap" class="ft9634">○</p>
<p style="position:absolute;top:1021px;left:166px;white-space:nowrap" class="ft9614">With&#160;security&#160;properties&#160;integrity,&#160;confidentiality&#160;and&#160;non-replay.</p>
<p style="position:absolute;top:1078px;left:112px;white-space:nowrap" class="ft9665"><b>Threats&#160;to&#160;the&#160;Mobile&#160;Commerce&#160;Application</b></p>
<p style="position:absolute;top:1107px;left:85px;white-space:nowrap" class="ft9614">The&#160;mobile&#160;commerce&#160;application&#160;code,&#160;data,&#160;and&#160;certificates&#160;need&#160;to&#160;be&#160;protected&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft967">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft967">96/109</p>
</div>
<!-- Page 97 -->
<a name="97"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page97-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application097.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft9712">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft970">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft974">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft974">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft9715">from<br/>&#160;</p>
<p style="position:absolute;top:199px;left:112px;white-space:nowrap" class="ft9734">●</p>
<p style="position:absolute;top:189px;left:139px;white-space:nowrap" class="ft9715">Bypass&#160;security&#160;by&#160;removal&#160;of&#160;battery&#160;power&#160;or&#160;removal&#160;of&#160;external&#160;memory&#160;<br/>card</p>
<p style="position:absolute;top:237px;left:112px;white-space:nowrap" class="ft9734">●</p>
<p style="position:absolute;top:228px;left:139px;white-space:nowrap" class="ft9714">Attack&#160;by&#160;replacement&#160;of&#160;flash&#160;when&#160;power&#160;is&#160;off&#160;(pre-boot)</p>
<p style="position:absolute;top:266px;left:85px;white-space:nowrap" class="ft9714">This&#160;is&#160;for&#160;profile&#160;1&#160;and&#160;profile&#160;2&#160;applications.</p>
<p style="position:absolute;top:305px;left:85px;white-space:nowrap" class="ft9715">To&#160;&#160;recap,&#160;&#160;&#160;only&#160;&#160;&#160;profile&#160;&#160;&#160;2&#160;&#160;mobile&#160;&#160;&#160;commerce&#160;&#160;&#160;application&#160;&#160;&#160;code,&#160;&#160;&#160;data,&#160;&#160;&#160;and&#160;&#160;certificates&#160;<br/>need&#160;to&#160;be&#160;protected&#160;against&#160;threats</p>
<p style="position:absolute;top:372px;left:112px;white-space:nowrap" class="ft9734">●</p>
<p style="position:absolute;top:362px;left:139px;white-space:nowrap" class="ft9714">Hardware&#160;Modules&#160;used&#160;for&#160;Accessing&#160;Memories</p>
<p style="position:absolute;top:391px;left:112px;white-space:nowrap" class="ft9734">●</p>
<p style="position:absolute;top:381px;left:139px;white-space:nowrap" class="ft9714">CLCD&#160;used&#160;for&#160;displaying&#160;memories&#160;and&#160;interfering&#160;with&#160;displayed&#160;data</p>
<p style="position:absolute;top:410px;left:112px;white-space:nowrap" class="ft9734">●</p>
<p style="position:absolute;top:401px;left:139px;white-space:nowrap" class="ft9714">Extract&#160;secret&#160;via&#160;bus&#160;monitoring&#160;</p>
<p style="position:absolute;top:429px;left:112px;white-space:nowrap" class="ft9734">●</p>
<p style="position:absolute;top:420px;left:139px;white-space:nowrap" class="ft9714">Mod&#160;chip&#160;attacks&#160;on&#160;data&#160;in&#160;external&#160;RAM</p>
<p style="position:absolute;top:448px;left:112px;white-space:nowrap" class="ft9734">●</p>
<p style="position:absolute;top:439px;left:139px;white-space:nowrap" class="ft9714">Attack&#160;by&#160;replacement&#160;of&#160;flash&#160;when&#160;power&#160;is&#160;on(post-boot)</p>
<p style="position:absolute;top:477px;left:85px;white-space:nowrap" class="ft9714">Further,&#160;only&#160;profile&#160;2&#160;mobile&#160;commerce&#160;application&#160;keys&#160;need&#160;to&#160;be&#160;protected&#160;from</p>
<p style="position:absolute;top:525px;left:112px;white-space:nowrap" class="ft9734">●</p>
<p style="position:absolute;top:516px;left:139px;white-space:nowrap" class="ft9714">Extract&#160;secret&#160;via&#160;bus&#160;monitoring</p>
<p style="position:absolute;top:544px;left:112px;white-space:nowrap" class="ft9734">●</p>
<p style="position:absolute;top:535px;left:139px;white-space:nowrap" class="ft9714">Mod&#160;chip&#160;attacks&#160;on&#160;data&#160;in&#160;external&#160;RAM</p>
<p style="position:absolute;top:573px;left:85px;white-space:nowrap" class="ft9715">The&#160;mobile&#160;commerce&#160;use&#160;case&#160;also&#160;specifically&#160;has&#160;requirements&#160;for&#160;secure&#160;user&#160;IO&#160;<br/>for&#160;keyboard&#160;and&#160;display&#160;for&#160;both&#160;profile&#160;1&#160;and&#160;profile&#160;2.&#160;But&#160;it&#160;must&#160;be&#160;noted&#160;that&#160;<br/>TR1&#160;only&#160;defines&#160;a&#160;profile&#160;1&#160;SUIO.</p>
<p style="position:absolute;top:650px;left:85px;white-space:nowrap" class="ft9715">There&#160;are&#160;also&#160;requirements&#160;for&#160;a&#160;secure&#160;storage&#160;utility&#160;if&#160;PIN&#160;and&#160;session&#160;key&#160;data&#160;<br/>are&#160;to&#160;survive&#160;for&#160;more&#160;than&#160;one&#160;session.</p>
<p style="position:absolute;top:717px;left:85px;white-space:nowrap" class="ft9715">The&#160;certificates&#160;that&#160;are&#160;used&#160;must&#160;also&#160;be&#160;integrity&#160;protected.&#160;Although&#160;not&#160;stated&#160;in&#160;<br/>the&#160;TR1&#160;requirements&#160;document,&#160;this&#160;could&#160;be&#160;managed&#160;by&#160;including&#160;them&#160;in&#160;the&#160;<br/>secure&#160;boot,&#160;or&#160;secure&#160;application&#160;loading&#160;mechanisms&#160;and&#160;then&#160;isolating&#160;them&#160;in&#160;a&#160;<br/>TEE.</p>
<p style="position:absolute;top:822px;left:85px;white-space:nowrap" class="ft9715">The&#160;mobile&#160;commerce&#160;application&#160;must&#160;be&#160;checked&#160;at&#160;installation.&#160;It&#160;is&#160;advised&#160;to&#160;<br/>check&#160;it&#160;prior&#160;to&#160;execution,&#160;and&#160;optionally&#160;it&#160;can&#160;be&#160;checked&#160;at&#160;run&#160;time&#160;using&#160;a&#160;RIC.</p>
<p style="position:absolute;top:888px;left:85px;white-space:nowrap" class="ft9715">Although&#160;not&#160;specifically&#160;stated,&#160;the&#160;mobile&#160;commerce&#160;use&#160;case&#160;could&#160;make&#160;good&#160;use&#160;<br/>of&#160;a&#160;TEE,&#160;SST,&#160;FSB.</p>
<p style="position:absolute;top:973px;left:85px;white-space:nowrap" class="ft9716"><b>4.2&#160;Secure&#160;Wallet&#160;Architecture&#160;in&#160;the&#160;context&#160;of&#160;TR1</b></p>
<p style="position:absolute;top:1001px;left:85px;white-space:nowrap" class="ft9715">In&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;&#160;&#160;understand&#160;&#160;&#160;the&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;&#160;&#160;architecture&#160;&#160;&#160;in&#160;&#160;&#160;the&#160;&#160;&#160;scope&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;TR1&#160;<br/>recommendations&#160;&#160;&#160;document,&#160;&#160;&#160;we&#160;&#160;&#160;will&#160;&#160;&#160;briefly&#160;&#160;&#160;compare&#160;&#160;&#160;it&#160;&#160;&#160;with&#160;&#160;&#160;one&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;TR1&#160;&#160;&#160;use&#160;<br/>cases.&#160;The&#160;mobile&#160;TV&#160;and&#160;the&#160;device&#160;management&#160;use&#160;cases&#160;are&#160;too&#160;dissimilar&#160;to&#160;the&#160;<br/>secure&#160;&#160;&#160;wallet&#160;&#160;&#160;use&#160;&#160;&#160;case,&#160;&#160;&#160;and&#160;&#160;&#160;we&#160;&#160;&#160;will&#160;&#160;&#160;not&#160;&#160;&#160;discuss&#160;&#160;&#160;them&#160;&#160;&#160;further.&#160;&#160;&#160;The&#160;&#160;&#160;TR1&#160;&#160;&#160;mobile&#160;<br/>commerce&#160;example&#160;is&#160;the&#160;closest&#160;use&#160;case&#160;to&#160;the&#160;secure&#160;wallet&#160;mobile&#160;application,&#160;so&#160;<br/>we&#160;will&#160;now&#160;contrast&#160;and&#160;compare&#160;them.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft977">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft977">97/109</p>
</div>
<!-- Page 98 -->
<a name="98"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft9866{font-size:17px;font-family:EAAAAA+DejaVuSerif;color:#000080;}
-->
</style>
<div id="page98-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application098.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft9812">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft980">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft984">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft984">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft9815">Both&#160;&#160;&#160;use&#160;&#160;&#160;cases&#160;&#160;&#160;are&#160;&#160;&#160;concerned&#160;&#160;&#160;with&#160;&#160;&#160;a&#160;&#160;&#160;form&#160;&#160;&#160;of&#160;&#160;&#160;payment,&#160;&#160;&#160;but&#160;&#160;&#160;they&#160;&#160;&#160;are&#160;&#160;&#160;still&#160;&#160;&#160;quite&#160;<br/>different.&#160;The&#160;TR1&#160;mobile&#160;commerce&#160;use&#160;case&#160;is&#160;very&#160;UICC&#160;centric,&#160;where&#160;as&#160;the&#160;<br/>secure&#160;wallet,&#160;in&#160;its&#160;final&#160;form&#160;would&#160;be&#160;completely&#160;implemented&#160;on&#160;the&#160;baseband&#160;<br/>controller.</p>
<p style="position:absolute;top:247px;left:85px;white-space:nowrap" class="ft9815">Although&#160;the&#160;TR1&#160;use&#160;case&#160;makes&#160;intensive&#160;use&#160;of&#160;the&#160;UICC&#160;security&#160;capabilities&#160;it&#160;<br/>also&#160;does&#160;place&#160;security&#160;requirements&#160;on&#160;the&#160;baseband&#160;controller,&#160;as&#160;does&#160;the&#160;secure&#160;<br/>wallet.</p>
<p style="position:absolute;top:324px;left:85px;white-space:nowrap" class="ft9815">The&#160;&#160;TR1&#160;mobile&#160;commerce&#160;application&#160;makes&#160;use&#160;&#160;of&#160;the&#160;security&#160;&#160;enablers&#160;Secure&#160;<br/>User&#160;IO,&#160;Trusted&#160;Execution&#160;Environment,&#160;Secure&#160;Storage,&#160;and&#160;the&#160;basic&#160;trust&#160;in&#160;the&#160;<br/>platform&#160;is&#160;established&#160;by&#160;a&#160;secure&#160;boot.&#160;In&#160;the&#160;following&#160;sections&#160;we&#160;show&#160;that&#160;the&#160;<br/>Secure&#160;&#160;&#160;Wallet&#160;&#160;&#160;also&#160;&#160;&#160;has&#160;&#160;&#160;these&#160;&#160;&#160;requirements,&#160;&#160;&#160;and&#160;&#160;&#160;we&#160;&#160;&#160;will&#160;&#160;&#160;map&#160;&#160;&#160;the&#160;&#160;&#160;the&#160;&#160;&#160;basic&#160;<br/>architecture&#160;of&#160;the&#160;secure&#160;wallet&#160;to&#160;TR1&#160;security&#160;enablers.&#160;The&#160;TR1&#160;security&#160;enablers,&#160;<br/>Generic&#160;Bootstrap&#160;Architecture&#160;and&#160;Secure&#160;Interaction&#160;of&#160;the&#160;UICC&#160;with&#160;the&#160;Mobile&#160;<br/>Equipment&#160;are&#160;not&#160;relevant&#160;to&#160;the&#160;secure&#160;wallet&#160;use&#160;case,&#160;and&#160;will&#160;not&#160;be&#160;considered&#160;<br/>further.</p>
<p style="position:absolute;top:497px;left:85px;white-space:nowrap" class="ft9815">Before&#160;we&#160;begin&#160;this&#160;it&#160;should&#160;be&#160;stated&#160;that&#160;the&#160;secure&#160;wallet&#160;is&#160;defined&#160;to&#160;defend&#160;<br/>against&#160;software&#160;attacks.&#160;For&#160;this&#160;reason&#160;we&#160;consider&#160;the&#160;architecture&#160;in&#160;terms&#160;of&#160;a&#160;<br/>TR1&#160;profile&#160;1&#160;requirements.</p>
<p style="position:absolute;top:572px;left:85px;white-space:nowrap" class="ft9816"><b>4.3&#160;Proposal&#160;of&#160;the&#160;final&#160;porting&#160;of&#160;the&#160;secure&#160;wallet&#160;to&#160;the&#160;X-GOLD&#160;208</b></p>
<p style="position:absolute;top:600px;left:85px;white-space:nowrap" class="ft9814">In&#160;the&#160;current&#160;prototype,&#160;a&#160;TPM&#160;emulator,&#160;which&#160;makes&#160;use&#160;of&#160;the&#160;X-GOLD</p>
<p style="position:absolute;top:600px;left:754px;white-space:nowrap" class="ft9817">TM&#160;&#160;</p>
<p style="position:absolute;top:600px;left:777px;white-space:nowrap" class="ft9814">208&#160;</p>
<p style="position:absolute;top:620px;left:85px;white-space:nowrap" class="ft9814">cryptographic&#160;hardware,&#160;has&#160;been&#160;ported&#160;to&#160;the&#160;X-GOLD</p>
<p style="position:absolute;top:620px;left:572px;white-space:nowrap" class="ft9817">TM&#160;&#160;</p>
<p style="position:absolute;top:620px;left:592px;white-space:nowrap" class="ft9814">208,&#160;see&#160;section<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#47">&#160;</a></p>
<p style="position:absolute;top:620px;left:737px;white-space:nowrap" class="ft9866"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#47">2.7</a></p>
<p style="position:absolute;top:620px;left:763px;white-space:nowrap" class="ft9814"><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#47">.</a>&#160;In&#160;a&#160;</p>
<p style="position:absolute;top:639px;left:85px;white-space:nowrap" class="ft9815">final&#160;architecture,&#160;the&#160;complete&#160;secure&#160;wallet&#160;prototype&#160;would&#160;be&#160;ported&#160;to&#160;the&#160;X-<br/>GOLD</p>
<p style="position:absolute;top:658px;left:136px;white-space:nowrap" class="ft9817">TM&#160;</p>
<p style="position:absolute;top:658px;left:155px;white-space:nowrap" class="ft9814">208.</p>
<p style="position:absolute;top:696px;left:85px;white-space:nowrap" class="ft9815">In&#160;this&#160;final&#160;prototype,&#160;the&#160;L4&#160;microkernel&#160;and&#160;L4&#160;environment&#160;would&#160;run&#160;on&#160;top&#160;of&#160;<br/>the&#160;X-GOLD</p>
<p style="position:absolute;top:716px;left:186px;white-space:nowrap" class="ft9817">TM</p>
<p style="position:absolute;top:716px;left:202px;white-space:nowrap" class="ft9814">&#160;208&#160;hardware.&#160;There&#160;would&#160;be&#160;seven&#160;L4&#160;applications&#160;running&#160;in&#160;the&#160;L4&#160;</p>
<p style="position:absolute;top:735px;left:85px;white-space:nowrap" class="ft9815">environment.&#160;&#160;&#160;These&#160;&#160;&#160;would&#160;&#160;&#160;be&#160;&#160;&#160;the&#160;&#160;&#160;secure&#160;&#160;&#160;GUI,&#160;&#160;&#160;the&#160;&#160;&#160;Compartment&#160;&#160;&#160;Manager,&#160;&#160;&#160;the&#160;<br/>Storage&#160;Manager,&#160;the&#160;Network&#160;Manager,&#160;the&#160;TPM&#160;emulator,&#160;the&#160;wallet&#160;application,&#160;<br/>and&#160;the&#160;legacy&#160;browser.</p>
<p style="position:absolute;top:812px;left:85px;white-space:nowrap" class="ft9814">The&#160;TPM&#160;emulator&#160;would&#160;make&#160;use&#160;of&#160;the&#160;X-GOLD</p>
<p style="position:absolute;top:812px;left:532px;white-space:nowrap" class="ft9817">TM</p>
<p style="position:absolute;top:812px;left:548px;white-space:nowrap" class="ft9814">&#160;&#160;208&#160;hardware&#160;as&#160;it&#160;currently&#160;</p>
<p style="position:absolute;top:831px;left:85px;white-space:nowrap" class="ft9814">does,&#160;but&#160;in&#160;addition,&#160;the&#160;Storage&#160;Manager&#160;could&#160;also&#160;make&#160;use&#160;of&#160;the&#160;X-GOLD</p>
<p style="position:absolute;top:831px;left:755px;white-space:nowrap" class="ft9817">TM</p>
<p style="position:absolute;top:831px;left:771px;white-space:nowrap" class="ft9814">&#160;208&#160;</p>
<p style="position:absolute;top:850px;left:85px;white-space:nowrap" class="ft9814">hardware.&#160;The&#160;X-GOLD</p>
<p style="position:absolute;top:850px;left:288px;white-space:nowrap" class="ft9817">TM</p>
<p style="position:absolute;top:850px;left:304px;white-space:nowrap" class="ft9814">&#160;&#160;208&#160;has&#160;a&#160;hardware&#160;key&#160;which&#160;can&#160;be&#160;used&#160;by&#160;the&#160;AES&#160;</p>
<p style="position:absolute;top:869px;left:85px;white-space:nowrap" class="ft9814">hardware&#160;in&#160;order&#160;to&#160;encrypt&#160;and&#160;decrypt&#160;sensitive&#160;objects.</p>
<p style="position:absolute;top:908px;left:85px;white-space:nowrap" class="ft9815">The&#160;L4&#160;microkernel&#160;would&#160;also&#160;provide&#160;isolation&#160;between&#160;the&#160;L4&#160;applications.&#160;Some&#160;<br/>form&#160;of&#160;policy&#160;manager&#160;would&#160;be&#160;required&#160;so&#160;that&#160;only&#160;authorized&#160;communication&#160;<br/>between&#160;the&#160;L4&#160;applications&#160;would&#160;be&#160;possible.</p>
<p style="position:absolute;top:984px;left:85px;white-space:nowrap" class="ft9815">As&#160;in&#160;the&#160;current&#160;prototype,&#160;two&#160;versions&#160;of&#160;the&#160;L4&#160;Linux&#160;could&#160;be&#160;ported.&#160;One&#160;would&#160;<br/>contain&#160;the&#160;secure&#160;wallet&#160;application,&#160;and&#160;the&#160;other&#160;would&#160;be&#160;the&#160;legacy&#160;OS&#160;in&#160;which&#160;<br/>all&#160;the&#160;‘non-secure’&#160;software&#160;could&#160;run.&#160;This&#160;scenario&#160;is&#160;depicted&#160;in&#160;Figur<a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#99">e&#160;26.</a></p>
<p style="position:absolute;top:1060px;left:85px;white-space:nowrap" class="ft9816"><b>4.4&#160;Platform&#160;Integrity&#160;and&#160;Authenticity</b></p>
<p style="position:absolute;top:1088px;left:85px;white-space:nowrap" class="ft9815">One&#160;&#160;&#160;of&#160;&#160;&#160;OMTP&#160;&#160;&#160;TR0&#160;&#160;&#160;and&#160;&#160;&#160;TR1’s&#160;&#160;&#160;most&#160;&#160;&#160;basic&#160;&#160;&#160;requirements&#160;&#160;&#160;is&#160;&#160;&#160;the&#160;&#160;&#160;establishment&#160;&#160;&#160;of&#160;<br/>platform&#160;integrity&#160;through&#160;a&#160;secure&#160;boot.&#160;Platform&#160;integrity&#160;and&#160;authenticity&#160;can&#160;be&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft987">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft987">98/109</p>
</div>
<!-- Page 99 -->
<a name="99"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft9967{font-size:11px;line-height:13px;font-family:HAAAAA+Arial;color:#000000;}
-->
</style>
<div id="page99-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application099.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft9912">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft990">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft994">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft994">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft9914">provided&#160;by&#160;the&#160;X-GOLD</p>
<p style="position:absolute;top:151px;left:290px;white-space:nowrap" class="ft9917">TM&#160;</p>
<p style="position:absolute;top:151px;left:309px;white-space:nowrap" class="ft9914">208&#160;secure&#160;boot.</p>
<p style="position:absolute;top:893px;left:166px;white-space:nowrap" class="ft993"><b>Figure&#160;26:&#160;Proposed&#160;architecture&#160;for&#160;final&#160;secure&#160;wallet&#160;prototype&#160;</b></p>
<p style="position:absolute;top:949px;left:85px;white-space:nowrap" class="ft9915">In&#160;this&#160;architecture,&#160;the&#160;X-GOLD&#160;208&#160;secure&#160;boot&#160;would&#160;be&#160;used&#160;as&#160;the&#160;first&#160;stage&#160;of&#160;a&#160;<br/>boot&#160;process&#160;which&#160;securely&#160;instantiates&#160;an&#160;'immutable'&#160;&#160;Root&#160;Trust&#160;of&#160;Enforcement&#160;<br/>(RTE),&#160;as&#160;defined&#160;in&#160;the&#160;Trusted&#160;Computing&#160;Group&#160;Mobile&#160;Reference&#160;Architecture.&#160;<br/>This&#160;RTE&#160;would&#160;then&#160;build&#160;further&#160;Roots&#160;of&#160;Trusts&#160;in&#160;the&#160;platform.&#160;These&#160;Roots&#160;of&#160;<br/>Trust&#160;&#160;&#160;would&#160;&#160;&#160;then&#160;&#160;&#160;be&#160;&#160;&#160;used&#160;&#160;&#160;to&#160;&#160;&#160;establish&#160;&#160;&#160;the&#160;&#160;&#160;integrity&#160;&#160;&#160;and&#160;&#160;&#160;authenticity&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;L4&#160;<br/>microkernel,&#160;&#160;&#160;the&#160;&#160;&#160;L4&#160;&#160;&#160;environment,&#160;&#160;&#160;and&#160;&#160;&#160;the&#160;&#160;&#160;L4&#160;&#160;&#160;applications&#160;&#160;&#160;including&#160;&#160;&#160;the&#160;&#160;&#160;TPM&#160;<br/>emulator.&#160;Although&#160;not&#160;shown&#160;here,&#160;a&#160;measurement&#160;agent&#160;could&#160;then&#160;make&#160;use&#160;of&#160;the&#160;<br/>TPM&#160;in&#160;order&#160;to&#160;verify&#160;the&#160;integrity&#160;of&#160;the&#160;the&#160;rest&#160;of&#160;the&#160;software&#160;as&#160;it&#160;was&#160;loaded.&#160;<br/>This&#160;would&#160;possibly&#160;be&#160;handled&#160;by&#160;the&#160;compartment&#160;manager.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft997">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:755px;white-space:nowrap" class="ft997">99/109</p>
<p style="position:absolute;top:252px;left:127px;white-space:nowrap" class="ft9940"><b>cmp&#160;Final&#160;Architecture</b></p>
<p style="position:absolute;top:737px;left:626px;white-space:nowrap" class="ft9940"><b>L4&#160;Kernel</b></p>
<p style="position:absolute;top:570px;left:584px;white-space:nowrap" class="ft9940"><b>L4env&#160;Servers</b></p>
<p style="position:absolute;top:294px;left:583px;white-space:nowrap" class="ft9940"><b>L4Linux&#160;(Instance&#160;1)</b></p>
<p style="position:absolute;top:511px;left:163px;white-space:nowrap" class="ft9940"><b>TPM&#160;</b></p>
<p style="position:absolute;top:524px;left:152px;white-space:nowrap" class="ft9940"><b>emulator</b></p>
<p style="position:absolute;top:842px;left:640px;white-space:nowrap" class="ft9940"><b>X-GOLD&#160;208</b></p>
<p style="position:absolute;top:675px;left:689px;white-space:nowrap" class="ft9940"><b>Loade&#160;r</b></p>
<p style="position:absolute;top:617px;left:605px;white-space:nowrap" class="ft9940"><b>DMPhys</b></p>
<p style="position:absolute;top:617px;left:688px;white-space:nowrap" class="ft9940"><b>Name&#160;s</b></p>
<p style="position:absolute;top:674px;left:613px;white-space:nowrap" class="ft9940"><b>Ex&#160;ec</b></p>
<p style="position:absolute;top:587px;left:154px;white-space:nowrap" class="ft9940"><b>L4&#160;Application&#160;Libraries</b></p>
<p style="position:absolute;top:633px;left:218px;white-space:nowrap" class="ft9940"><b>Thread</b></p>
<p style="position:absolute;top:634px;left:302px;white-space:nowrap" class="ft9940"><b>l4rm</b></p>
<p style="position:absolute;top:633px;left:389px;white-space:nowrap" class="ft9940"><b>...</b></p>
<p style="position:absolute;top:448px;left:209px;white-space:nowrap" class="ft9940"><b>Storage&#160;</b></p>
<p style="position:absolute;top:461px;left:208px;white-space:nowrap" class="ft9940"><b>Manage&#160;r</b></p>
<p style="position:absolute;top:515px;left:251px;white-space:nowrap" class="ft9940"><b>Compartment&#160;</b></p>
<p style="position:absolute;top:528px;left:264px;white-space:nowrap" class="ft9940"><b>Manage&#160;r</b></p>
<p style="position:absolute;top:278px;left:404px;white-space:nowrap" class="ft9940"><b>L4&#160;Linux&#160;(Instance&#160;2)</b></p>
<p style="position:absolute;top:332px;left:422px;white-space:nowrap" class="ft9940"><b>Secure&#160;Wallet&#160;</b></p>
<p style="position:absolute;top:345px;left:432px;white-space:nowrap" class="ft9940"><b>Application</b></p>
<p style="position:absolute;top:402px;left:420px;white-space:nowrap" class="ft9940"><b>JVM</b></p>
<p style="position:absolute;top:450px;left:319px;white-space:nowrap" class="ft9940"><b>Secure&#160;</b></p>
<p style="position:absolute;top:463px;left:331px;white-space:nowrap" class="ft9940"><b>GUI</b></p>
<p style="position:absolute;top:519px;left:371px;white-space:nowrap" class="ft9967"><b>Network&#160;<br/>Manage&#160;r</b></p>
<p style="position:absolute;top:372px;left:630px;white-space:nowrap" class="ft9940"><b>Legacy&#160;</b></p>
<p style="position:absolute;top:385px;left:629px;white-space:nowrap" class="ft9940"><b>Browser</b></p>
</div>
<!-- Page 100 -->
<a name="100"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page100-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application100.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft10012">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft1000">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft1004">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft1004">Final</p>
<p style="position:absolute;top:188px;left:85px;white-space:nowrap" class="ft1006"><b>4.4.1&#160;Trusted&#160;Execution&#160;Environments</b></p>
<p style="position:absolute;top:215px;left:85px;white-space:nowrap" class="ft10015">The&#160;secure&#160;wallet&#160;prototype&#160;is&#160;actually&#160;a&#160;set&#160;of&#160;communicating&#160;Trusted&#160;Execution&#160;<br/>Environments.</p>
<p style="position:absolute;top:311px;left:85px;white-space:nowrap" class="ft10014">We&#160;list&#160;the&#160;TEEs&#160;in&#160;the&#160;architecture&#160;below.</p>
<p style="position:absolute;top:359px;left:112px;white-space:nowrap" class="ft10034">●</p>
<p style="position:absolute;top:349px;left:139px;white-space:nowrap" class="ft10015">L4&#160;microkernel:&#160;This&#160;is&#160;the&#160;most&#160;basic&#160;TEE&#160;in&#160;the&#160;system.&#160;All&#160;other&#160;TEEs&#160;run&#160;<br/>on&#160;top&#160;of&#160;this&#160;TEE.</p>
<p style="position:absolute;top:397px;left:112px;white-space:nowrap" class="ft10034">●</p>
<p style="position:absolute;top:388px;left:139px;white-space:nowrap" class="ft10015">L4&#160;environment:&#160;&#160;This&#160;is&#160;the&#160;TEE&#160;in&#160;which&#160;all&#160;the&#160;L4&#160;applications&#160;run.&#160;The&#160;L4&#160;<br/>microkernel&#160;provides&#160;the&#160;isolation&#160;between&#160;these&#160;TEE&#160;applications.</p>
<p style="position:absolute;top:435px;left:112px;white-space:nowrap" class="ft10034">●</p>
<p style="position:absolute;top:426px;left:139px;white-space:nowrap" class="ft10015">L4&#160;Linux&#160;for&#160;secure&#160;wallet:&#160;The&#160;L4&#160;Linux&#160;is&#160;also&#160;a&#160;TEE&#160;since&#160;it&#160;is&#160;isolated&#160;from&#160;<br/>the&#160;legacy&#160;Linux&#160;which&#160;would&#160;be&#160;open&#160;to&#160;untrusted&#160;applications.</p>
<p style="position:absolute;top:474px;left:112px;white-space:nowrap" class="ft10034">●</p>
<p style="position:absolute;top:464px;left:139px;white-space:nowrap" class="ft10015">JVM&#160;running&#160;in&#160;trusted&#160;L4&#160;Linux:&#160;&#160;The&#160;JVM&#160;is&#160;also&#160;a&#160;TEE.&#160;In&#160;this&#160;application&#160;<br/>only&#160;the&#160;single&#160;secure&#160;wallet&#160;application&#160;runs&#160;in&#160;the&#160;JVM,&#160;but&#160;the&#160;JVM&#160;could&#160;<br/>offer&#160;isolation&#160;for&#160;other&#160;secure&#160;applications.</p>
<p style="position:absolute;top:541px;left:85px;white-space:nowrap" class="ft10015">Authorized&#160;&#160;&#160;Communication&#160;&#160;&#160;between&#160;&#160;&#160;the&#160;&#160;&#160;TEEs&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;provided&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;L4&#160;<br/>Environment&#160;as&#160;long&#160;as&#160;a&#160;policy&#160;manager&#160;is&#160;implemented.&#160;In&#160;this&#160;architecture,&#160;if&#160;we&#160;<br/>consider&#160;the&#160;secure&#160;application&#160;to&#160;be&#160;running&#160;in&#160;the&#160;JVM,&#160;then&#160;it&#160;would&#160;have&#160;access&#160;<br/>to&#160;&#160;&#160;secure&#160;&#160;&#160;storage,&#160;&#160;&#160;and&#160;&#160;&#160;cryptographic&#160;&#160;&#160;services&#160;&#160;&#160;(possibly&#160;&#160;&#160;provided&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;TPM&#160;<br/>emulator)&#160;via&#160;the&#160;L4&#160;environment.</p>
<p style="position:absolute;top:674px;left:85px;white-space:nowrap" class="ft1006"><b>4.4.2&#160;Secure&#160;Storage</b></p>
<p style="position:absolute;top:701px;left:85px;white-space:nowrap" class="ft10015">In&#160;this&#160;section&#160;we&#160;look&#160;at&#160;the&#160;secure&#160;storage&#160;utility&#160;of&#160;the&#160;secure&#160;wallet&#160;prototype.&#160;We&#160;<br/>also&#160;briefly&#160;look&#160;at&#160;some&#160;OMTP&#160;TR1&#160;Secure&#160;Storage&#160;requirements.</p>
<p style="position:absolute;top:758px;left:85px;white-space:nowrap" class="ft10014">The&#160;Secure&#160;Wallet&#160;prototype&#160;architecture&#160;makes&#160;use&#160;of&#160;two&#160;types&#160;of&#160;secure&#160;storage.</p>
<p style="position:absolute;top:806px;left:112px;white-space:nowrap" class="ft10034">●</p>
<p style="position:absolute;top:797px;left:139px;white-space:nowrap" class="ft10014">Secure&#160;storage&#160;as&#160;part&#160;of&#160;the&#160;TPM&#160;emulator</p>
<p style="position:absolute;top:825px;left:139px;white-space:nowrap" class="ft10034">○</p>
<p style="position:absolute;top:816px;left:166px;white-space:nowrap" class="ft10014">Hardware&#160;support&#160;provided&#160;by&#160;the&#160;X-GOLD</p>
<p style="position:absolute;top:816px;left:530px;white-space:nowrap" class="ft10017">TM&#160;</p>
<p style="position:absolute;top:816px;left:550px;white-space:nowrap" class="ft10014">208&#160;cryptographic&#160;hardware</p>
<p style="position:absolute;top:845px;left:139px;white-space:nowrap" class="ft10034">○</p>
<p style="position:absolute;top:835px;left:166px;white-space:nowrap" class="ft10015">The&#160;TPM&#160;emulator&#160;only&#160;offers&#160;asymmetric&#160;cryptographic&#160;operations&#160;as&#160;TPM&#160;<br/>commands</p>
<p style="position:absolute;top:883px;left:112px;white-space:nowrap" class="ft10034">●</p>
<p style="position:absolute;top:874px;left:139px;white-space:nowrap" class="ft10014">Secure&#160;storage&#160;used&#160;by&#160;the&#160;storage&#160;manager</p>
<p style="position:absolute;top:902px;left:139px;white-space:nowrap" class="ft10034">○</p>
<p style="position:absolute;top:893px;left:166px;white-space:nowrap" class="ft10014">This&#160;would&#160;also&#160;make&#160;use&#160;of&#160;the&#160;X-GOLD</p>
<p style="position:absolute;top:893px;left:533px;white-space:nowrap" class="ft10017">TM&#160;&#160;</p>
<p style="position:absolute;top:893px;left:556px;white-space:nowrap" class="ft10014">208&#160;cryptographic&#160;hardware,&#160;</p>
<p style="position:absolute;top:912px;left:166px;white-space:nowrap" class="ft10015">and&#160;&#160;&#160;could&#160;&#160;&#160;make&#160;&#160;&#160;direct&#160;&#160;&#160;use&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;symmetric&#160;&#160;&#160;encryption/decryption&#160;<br/>hardware.</p>
<p style="position:absolute;top:970px;left:85px;white-space:nowrap" class="ft10015">We&#160;&#160;&#160;consider&#160;&#160;&#160;the&#160;&#160;&#160;storage&#160;&#160;&#160;manager&#160;&#160;&#160;first.&#160;&#160;&#160;The&#160;&#160;&#160;storage&#160;&#160;&#160;manager&#160;&#160;&#160;runs&#160;&#160;&#160;in&#160;&#160;&#160;its&#160;&#160;&#160;own&#160;<br/>compartment.&#160;Its&#160;purpose&#160;&#160;is&#160;to&#160;store&#160;components&#160;whilst&#160;preserving&#160;their&#160;integrity&#160;<br/>and&#160;confidentiality.</p>
<p style="position:absolute;top:1046px;left:85px;white-space:nowrap" class="ft10015">We&#160;briefly&#160;review&#160;the&#160;operation&#160;of&#160;the&#160;Storage&#160;Manager&#160;before&#160;we&#160;look&#160;at&#160;out&#160;it&#160;mpas&#160;<br/>to&#160;the&#160;TR1&#160;definition&#160;of&#160;SST.&#160;When&#160;the&#160;Storage&#160;Manager&#160;is&#160;invoked&#160;to&#160;store&#160;data&#160;by&#160;a&#160;<br/>compartment,&#160;the&#160;storage&#160;manager&#160;calls&#160;the&#160;compartment&#160;manager&#160;in&#160;order&#160;to&#160;get&#160;<br/>the&#160;configuration&#160;data&#160;of&#160;the&#160;invoking&#160;compartment.&#160;The&#160;Storage&#160;Manager&#160;stores&#160;a&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1007">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:746px;white-space:nowrap" class="ft1007">100/109</p>
</div>
<!-- Page 101 -->
<a name="101"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft10168{font-size:20px;font-family:EAAAAA+DejaVuSerif;color:#000000;}
	.ft10169{font-size:17px;line-height:22px;font-family:EAAAAA+DejaVuSerif;color:#000000;}
-->
</style>
<div id="page101-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application101.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft10112">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft1010">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft1014">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft1014">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft10115">data&#160;object&#160;with&#160;an&#160;index&#160;value,&#160;which&#160;contains&#160;the&#160;meta&#160;data&#160;belonging&#160;to&#160;the&#160;data&#160;<br/>object.&#160;&#160;&#160;This&#160;&#160;&#160;includes&#160;&#160;&#160;a&#160;&#160;&#160;hash&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;invoking&#160;&#160;&#160;compartment,&#160;&#160;&#160;and&#160;&#160;&#160;possibly&#160;&#160;&#160;access&#160;<br/>restriction&#160;rules&#160;for&#160;this&#160;data&#160;object.</p>
<p style="position:absolute;top:228px;left:85px;white-space:nowrap" class="ft10169">The&#160;index&#160;value&#160;is&#160;critical&#160;to&#160;the&#160;security&#160;properties&#160;of&#160;the&#160;stored&#160;object.&#160;The&#160;stored&#160;<br/>object&#160;and&#160;its&#160;index&#160;value&#160;are&#160;encrypted&#160;using&#160;the&#160;storage&#160;manager&#160;symmetric&#160;key&#160;<br/>k</p>
<p style="position:absolute;top:276px;left:95px;white-space:nowrap" class="ft10136">SM</p>
<p style="position:absolute;top:269px;left:114px;white-space:nowrap" class="ft10114">.&#160;We&#160;will&#160;consider&#160;the&#160;k</p>
<p style="position:absolute;top:276px;left:311px;white-space:nowrap" class="ft10136">SM&#160;</p>
<p style="position:absolute;top:269px;left:334px;white-space:nowrap" class="ft10114">later.</p>
<p style="position:absolute;top:308px;left:85px;white-space:nowrap" class="ft10115">If&#160;a&#160;compartment&#160;makes&#160;a&#160;request&#160;to&#160;the&#160;Storage&#160;Manager&#160;to&#160;retrieve&#160;an&#160;object,&#160;the&#160;<br/>Storage&#160;Manager&#160;checks&#160;that&#160;this&#160;particular&#160;compartment&#160;has&#160;the&#160;rights&#160;to&#160;retrieve&#160;<br/>this&#160;object.&#160;It&#160;does&#160;this&#160;by&#160;invoking&#160;the&#160;compartment&#160;manager&#160;to&#160;compare&#160;the&#160;index&#160;<br/>value&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;calling&#160;&#160;&#160;compartment&#160;&#160;&#160;(which&#160;&#160;&#160;will&#160;&#160;&#160;have&#160;&#160;&#160;been&#160;&#160;&#160;measured&#160;&#160;&#160;and&#160;&#160;&#160;stored&#160;&#160;&#160;at&#160;<br/>system&#160;&#160;&#160;boot),&#160;&#160;&#160;with&#160;&#160;&#160;the&#160;&#160;&#160;index&#160;&#160;&#160;value&#160;&#160;&#160;stored&#160;&#160;&#160;with&#160;&#160;&#160;the&#160;&#160;&#160;retrieved&#160;&#160;&#160;object.&#160;&#160;&#160;The&#160;&#160;&#160;storage&#160;<br/>manager&#160;&#160;&#160;may&#160;&#160;&#160;also&#160;&#160;check&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;id&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;calling&#160;&#160;entity&#160;&#160;&#160;from&#160;&#160;&#160;within&#160;&#160;&#160;the&#160;&#160;&#160;calling&#160;<br/>compartment.&#160;The&#160;retrieved&#160;object&#160;is&#160;only&#160;delivered&#160;to&#160;the&#160;calling&#160;compartment&#160;if&#160;the&#160;<br/>index&#160;check&#160;passes,&#160;and&#160;if&#160;the&#160;user&#160;requesting&#160;the&#160;object&#160;is&#160;authorized&#160;to&#160;receive&#160;the&#160;<br/>retrieved&#160;object.</p>
<p style="position:absolute;top:503px;left:85px;white-space:nowrap" class="ft10114">The&#160;retrieved&#160;object&#160;and&#160;index&#160;value&#160;are&#160;decrypted&#160;using&#160;the&#160;k</p>
<p style="position:absolute;top:510px;left:619px;white-space:nowrap" class="ft10136">SM.&#160;</p>
<p style="position:absolute;top:500px;left:646px;white-space:nowrap" class="ft10168">k</p>
<p style="position:absolute;top:511px;left:657px;white-space:nowrap" class="ft10117">SM</p>
<p style="position:absolute;top:503px;left:674px;white-space:nowrap" class="ft10114">&#160;is&#160;sealed&#160;to&#160;the&#160;</p>
<p style="position:absolute;top:523px;left:85px;white-space:nowrap" class="ft10114">storage&#160;&#160;&#160;manager.&#160;&#160;&#160;This&#160;&#160;&#160;is&#160;&#160;&#160;done&#160;&#160;&#160;using&#160;&#160;&#160;the&#160;&#160;&#160;TPM&#160;&#160;&#160;sealing&#160;&#160;&#160;function.&#160;&#160;&#160;k</p>
<p style="position:absolute;top:531px;left:676px;white-space:nowrap" class="ft10117">SM</p>
<p style="position:absolute;top:523px;left:692px;white-space:nowrap" class="ft10114">&#160;&#160;can&#160;&#160;&#160;only&#160;&#160;&#160;be&#160;</p>
<p style="position:absolute;top:542px;left:85px;white-space:nowrap" class="ft10115">unsealed&#160;by&#160;the&#160;TPM&#160;if&#160;the&#160;configuration&#160;of&#160;the&#160;storage&#160;manager&#160;matches&#160;that&#160;of&#160;the&#160;<br/>storage&#160;manager&#160;which&#160;sealed&#160;it&#160;in&#160;the&#160;first&#160;place.&#160;A&#160;modified&#160;storage&#160;manager&#160;would&#160;<br/>therefore&#160;not&#160;be&#160;able&#160;to&#160;access&#160;the&#160;k</p>
<p style="position:absolute;top:589px;left:392px;white-space:nowrap" class="ft10117">SM</p>
<p style="position:absolute;top:580px;left:408px;white-space:nowrap" class="ft10114">.</p>
<p style="position:absolute;top:619px;left:85px;white-space:nowrap" class="ft10115">We&#160;consider&#160;now&#160;how&#160;the&#160;secure&#160;wallet&#160;Storage&#160;Manager&#160;maps&#160;to&#160;the&#160;structures&#160;<br/>defined&#160;in&#160;the&#160;OMTP&#160;TR1&#160;Secure&#160;Store&#160;requirements.&#160;OMTP&#160;TR1&#160;SST&#160;defines&#160;a&#160;key&#160;<br/>manager&#160;which&#160;is&#160;responsible&#160;for&#160;handling&#160;secure&#160;storage&#160;keys.&#160;In&#160;the&#160;case&#160;of&#160;the&#160;<br/>secure&#160;wallet&#160;prototype,&#160;the&#160;key&#160;manager&#160;is&#160;partitioned&#160;between&#160;the&#160;TPM&#160;emulator&#160;<br/>and&#160;the&#160;Secure&#160;Storage&#160;compartment.&#160;The&#160;Secure&#160;Storage&#160;root&#160;key&#160;is&#160;protected&#160;by&#160;<br/>the&#160;TPM&#160;emulator.&#160;TR1&#160;refers&#160;to&#160;this&#160;key&#160;as&#160;the&#160;SST&#160;key&#160;manager&#160;key.&#160;It&#160;should&#160;be&#160;<br/>noted&#160;&#160;&#160;that&#160;&#160;&#160;even&#160;&#160;&#160;in&#160;&#160;&#160;a&#160;&#160;&#160;profile&#160;&#160;&#160;1&#160;&#160;&#160;system,&#160;&#160;&#160;the&#160;&#160;&#160;key&#160;&#160;&#160;manager&#160;&#160;&#160;key&#160;&#160;&#160;has&#160;&#160;&#160;to&#160;&#160;&#160;be&#160;&#160;&#160;protected&#160;<br/>against&#160;all&#160;of&#160;the&#160;defined&#160;hardware&#160;threats,&#160;as&#160;well&#160;as&#160;the&#160;profile&#160;1&#160;software&#160;threats.&#160;<br/>Care&#160;would&#160;have&#160;to&#160;taken&#160;with&#160;the&#160;final&#160;implementation,&#160;if&#160;these&#160;requirements&#160;were&#160;<br/>to&#160;be&#160;met.&#160;Further,&#160;the&#160;storage&#160;manager&#160;key&#160;needs&#160;to&#160;be&#160;securely&#160;passed&#160;from&#160;the&#160;<br/>TPM&#160;emulator&#160;to&#160;the&#160;storage&#160;manager&#160;compartment.&#160;OMTP&#160;TR1&#160;places&#160;requirements&#160;<br/>on&#160;inter&#160;TEE&#160;secure&#160;communication&#160;when&#160;sensitive&#160;objects&#160;need&#160;to&#160;passed&#160;between&#160;<br/>TEEs.</p>
<p style="position:absolute;top:888px;left:85px;white-space:nowrap" class="ft10115">OMTP&#160;TR1&#160;SST&#160;also&#160;defines&#160;an&#160;Applications&#160;Assets&#160;Manager.&#160;The&#160;Application&#160;Asset&#160;<br/>Manager&#160;is&#160;the&#160;heart&#160;of&#160;the&#160;SST&#160;utility.&#160;It&#160;is&#160;the&#160;Application&#160;Asset&#160;Manager&#160;which&#160;<br/>calls&#160;&#160;&#160;the&#160;&#160;&#160;SST&#160;&#160;&#160;Key&#160;&#160;&#160;Manager.&#160;&#160;&#160;OMTP&#160;&#160;&#160;TR1&#160;&#160;&#160;defines&#160;&#160;&#160;that&#160;&#160;&#160;only&#160;&#160;&#160;the&#160;&#160;&#160;Application&#160;&#160;&#160;Asset&#160;<br/>Manager&#160;must&#160;have&#160;access&#160;to&#160;the&#160;SST&#160;Key&#160;Manager.&#160;In&#160;the&#160;Secure&#160;Wallet&#160;Prototype,&#160;<br/>the&#160;Application&#160;Asset&#160;Manager&#160;roughly&#160;maps&#160;to&#160;the&#160;secure&#160;wallet&#160;prototype's&#160;Storage&#160;<br/>Manager.&#160;As&#160;the&#160;key&#160;manager&#160;runs&#160;inside&#160;the&#160;storage&#160;manager&#160;compartment,&#160;access&#160;<br/>to&#160;&#160;&#160;the&#160;&#160;&#160;key&#160;&#160;&#160;manager&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;controlled&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;storage&#160;&#160;&#160;manager.&#160;&#160;&#160;The&#160;&#160;&#160;TR1&#160;&#160;&#160;SST&#160;<br/>requirements&#160;can&#160;then&#160;be&#160;met&#160;as&#160;long&#160;as&#160;the&#160;compartment&#160;manager&#160;ensures&#160;that&#160;only&#160;<br/>the&#160;key&#160;manager&#160;has&#160;access&#160;to&#160;the&#160;Secure&#160;Storage&#160;root&#160;key.</p>
<p style="position:absolute;top:1080px;left:85px;white-space:nowrap" class="ft10115">In&#160;the&#160;OMTP&#160;TR1&#160;Secure&#160;Storage&#160;requirements,&#160;it&#160;is&#160;suggested&#160;that&#160;the&#160;Application&#160;<br/>Assets&#160;Manager&#160;could&#160;store&#160;the&#160;security&#160;properties&#160;and&#160;access&#160;policies&#160;for&#160;a&#160;sensitive&#160;<br/>object.&#160;The&#160;secure&#160;wallet&#160;prototype's&#160;Storage&#160;Manager&#160;implements&#160;these&#160;functions&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1017">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:746px;white-space:nowrap" class="ft1017">101/109</p>
</div>
<!-- Page 102 -->
<a name="102"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page102-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application102.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft10212">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft1020">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft1024">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft1024">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft10214">through&#160;the&#160;use&#160;of&#160;the&#160;index&#160;value&#160;which&#160;is&#160;stored&#160;with&#160;the&#160;sensitive&#160;object.</p>
<p style="position:absolute;top:189px;left:85px;white-space:nowrap" class="ft10215">OMTP&#160;TR1&#160;places&#160;additional&#160;requirements&#160;on&#160;the&#160;Application&#160;Asset&#160;Manager.&#160;Two&#160;of&#160;<br/>the&#160;fundamental&#160;requirements&#160;are</p>
<p style="position:absolute;top:247px;left:112px;white-space:nowrap" class="ft10214">1.&#160;The&#160;&#160;&#160;Application&#160;&#160;&#160;Asset&#160;&#160;&#160;Manager&#160;&#160;&#160;must&#160;&#160;&#160;be&#160;&#160;&#160;able&#160;&#160;&#160;to&#160;&#160;&#160;bind&#160;&#160;&#160;the&#160;&#160;&#160;identity&#160;&#160;&#160;of&#160;&#160;&#160;an&#160;</p>
<p style="position:absolute;top:266px;left:139px;white-space:nowrap" class="ft10215">application&#160;supplied&#160;by&#160;a&#160;TEE&#160;or&#160;EE&#160;to&#160;a&#160;sensitive&#160;object,&#160;and&#160;limit&#160;access&#160;to&#160;<br/>the&#160;sensitive&#160;object&#160;to&#160;this&#160;particular&#160;application.&#160;</p>
<p style="position:absolute;top:305px;left:112px;white-space:nowrap" class="ft10214">2.&#160;The&#160;Application&#160;Asset&#160;Manager&#160;must&#160;also&#160;maintain&#160;an&#160;access&#160;control&#160;policy&#160;for&#160;</p>
<p style="position:absolute;top:324px;left:139px;white-space:nowrap" class="ft10214">the&#160;sensitive&#160;objects&#160;under&#160;its&#160;control.&#160;</p>
<p style="position:absolute;top:362px;left:85px;white-space:nowrap" class="ft10215">The&#160;secure&#160;wallet&#160;prototype&#160;can&#160;meet&#160;these&#160;requirements.&#160;It&#160;achieves&#160;this&#160;through&#160;<br/>the&#160;process&#160;of&#160;binding&#160;objects&#160;to&#160;the&#160;configuration&#160;of&#160;the&#160;compartments&#160;which&#160;use&#160;<br/>the&#160;secure&#160;storage&#160;utility.&#160;This&#160;functionality&#160;is&#160;not&#160;concentrated&#160;in&#160;the&#160;secure&#160;wallet&#160;<br/>prototype&#160;storage&#160;manger.&#160;The&#160;storage&#160;manager&#160;provides&#160;this&#160;functionality&#160;through&#160;<br/>the&#160;use&#160;of&#160;the&#160;compartment&#160;manager.</p>
<p style="position:absolute;top:477px;left:85px;white-space:nowrap" class="ft10215">TR1&#160;SST&#160;also&#160;has&#160;requirements&#160;which&#160;state&#160;that&#160;an&#160;application&#160;should&#160;not&#160;be&#160;able&#160;to&#160;<br/>compute&#160;the&#160;storage&#160;key&#160;of&#160;another&#160;application.&#160;Again&#160;this&#160;is&#160;achieved&#160;in&#160;the&#160;secure&#160;<br/>wallet&#160;&#160;prototype&#160;through&#160;the&#160;use&#160;of&#160;the&#160;&#160;configuration&#160;checking&#160;capabilities&#160;of&#160;the&#160;<br/>compartment&#160;manager.</p>
<p style="position:absolute;top:591px;left:85px;white-space:nowrap" class="ft1026"><b>4.4.3&#160;Secure&#160;User&#160;IO</b></p>
<p style="position:absolute;top:618px;left:85px;white-space:nowrap" class="ft10218">As&#160;previously&#160;mentioned,&#160;the&#160;SUIO&#160;requirements&#160;are&#160;concerned&#160;with&#160;the&#160;input&#160;and&#160;<br/>output&#160;&#160;&#160;of&#160;&#160;&#160;data&#160;&#160;&#160;between&#160;&#160;&#160;the&#160;&#160;&#160;user&#160;&#160;&#160;and&#160;&#160;&#160;the&#160;&#160;&#160;TEE&#160;&#160;&#160;where&#160;&#160;&#160;a&#160;&#160;&#160;trusted&#160;&#160;&#160;application&#160;&#160;&#160;is&#160;<br/>executing.<br/>This&#160;fits&#160;quite&#160;well&#160;with&#160;the&#160;secure&#160;wallet&#160;architecture.</p>
<p style="position:absolute;top:732px;left:85px;white-space:nowrap" class="ft10215">The&#160;architecture&#160;defines&#160;a&#160;trusted&#160;path&#160;between&#160;the&#160;secure&#160;GUI,&#160;the&#160;keyboard&#160;and&#160;<br/>the&#160;secure&#160;wallet&#160;application,&#160;which&#160;is&#160;running&#160;in&#160;a&#160;TEE.&#160;The&#160;secure&#160;wallet&#160;prototype&#160;<br/>provides&#160;&#160;&#160;such&#160;&#160;&#160;a&#160;&#160;&#160;trusted&#160;&#160;&#160;path.&#160;&#160;&#160;The&#160;&#160;&#160;security&#160;&#160;&#160;and&#160;&#160;&#160;isolation&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;trusted&#160;&#160;&#160;path&#160;&#160;&#160;is&#160;<br/>enforced&#160;by&#160;the&#160;L4&#160;environment.</p>
<p style="position:absolute;top:836px;left:85px;white-space:nowrap" class="ft1026"><b>4.4.4&#160;Software&#160;Threats</b></p>
<p style="position:absolute;top:862px;left:85px;white-space:nowrap" class="ft10215">We&#160;&#160;&#160;already&#160;&#160;&#160;mentioned&#160;&#160;that&#160;&#160;&#160;the&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;&#160;&#160;has&#160;&#160;been&#160;&#160;&#160;defined&#160;&#160;to&#160;&#160;be&#160;&#160;&#160;resistant&#160;&#160;&#160;to&#160;<br/>software&#160;threats.&#160;This&#160;generally&#160;aligned&#160;to&#160;a&#160;TR1&#160;profile&#160;1&#160;security&#160;level.&#160;TR1&#160;Secure&#160;<br/>Storage&#160;&#160;&#160;key&#160;&#160;&#160;management&#160;&#160;&#160;requirements&#160;&#160;&#160;are&#160;&#160;&#160;an&#160;&#160;&#160;exception&#160;&#160;&#160;and&#160;&#160;&#160;TR1&#160;&#160;&#160;still&#160;&#160;&#160;require&#160;<br/>protection&#160;from&#160;hardware&#160;threats.</p>
<p style="position:absolute;top:958px;left:85px;white-space:nowrap" class="ft10215">The&#160;&#160;&#160;profile&#160;&#160;&#160;1&#160;&#160;&#160;software&#160;&#160;&#160;required&#160;&#160;&#160;software&#160;&#160;&#160;measures&#160;&#160;&#160;are&#160;&#160;&#160;covered&#160;&#160;&#160;by&#160;&#160;&#160;‘Definition&#160;&#160;&#160;of&#160;<br/>software&#160;Quality&#160;Measures’,&#160;‘Definition&#160;of&#160;API&#160;Related&#160;Coding&#160;Techniques,&#160;‘Definition&#160;<br/>of&#160;Buffer&#160;Overflow&#160;Protection&#160;Mechanisms’.</p>
<p style="position:absolute;top:1035px;left:85px;white-space:nowrap" class="ft10215">These&#160;can&#160;only&#160;be&#160;met&#160;by&#160;careful&#160;coding,&#160;code&#160;reviews,&#160;and&#160;especially&#160;careful&#160;design&#160;<br/>of&#160;TEE&#160;interfaces.&#160;The&#160;secure&#160;wallet&#160;architecture&#160;assists&#160;in&#160;the&#160;implementation&#160;of&#160;<br/>these&#160;measures&#160;by&#160;concentrating&#160;the&#160;security&#160;facilities&#160;in&#160;isolated&#160;Trusted&#160;Execution&#160;<br/>Environments.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1027">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:746px;white-space:nowrap" class="ft1027">102/109</p>
</div>
<!-- Page 103 -->
<a name="103"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page103-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application103.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft10312">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft1030">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft1034">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft1034">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft10315">In&#160;fact,&#160;the&#160;secure&#160;wallet&#160;prototype&#160;architecture&#160;implements&#160;the&#160;security&#160;measure&#160;<br/>proposed&#160;&#160;&#160;in&#160;&#160;&#160;TR1&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;‘Definition&#160;&#160;&#160;of&#160;&#160;&#160;Execution&#160;&#160;&#160;Isolation&#160;&#160;&#160;Techniques&#160;&#160;&#160;to&#160;&#160;&#160;Address&#160;<br/>Software&#160;Attacks’.&#160;This&#160;is&#160;a&#160;profile&#160;2&#160;requirement,&#160;but&#160;the&#160;secure&#160;wallet&#160;architecture&#160;<br/>makes&#160;extensive&#160;use&#160;of&#160;these&#160;techniques.&#160;This&#160;locates&#160;the&#160;TR1&#160;security&#160;classification&#160;<br/>of&#160;the&#160;secure&#160;wallet&#160;prototype&#160;software&#160;architecture&#160;somewhere&#160;between&#160;a&#160;profile&#160;1&#160;<br/>and&#160;profile&#160;2.</p>
<p style="position:absolute;top:303px;left:85px;white-space:nowrap" class="ft10316"><b>4.5&#160;Summary</b></p>
<p style="position:absolute;top:332px;left:85px;white-space:nowrap" class="ft10315">In&#160;Section&#160;4,&#160;we&#160;first&#160;summarized&#160;the&#160;OMTP&#160;TR1&#160;recommendations.&#160;We&#160;selected&#160;the&#160;<br/>OMTP&#160;TR1&#160;security&#160;enablers&#160;and&#160;use&#160;cases&#160;which&#160;were&#160;most&#160;relevant&#160;to&#160;the&#160;secure&#160;<br/>wallet&#160;prototype&#160;architecture.&#160;These&#160;were&#160;the&#160;security&#160;enablers&#160;Trusted&#160;Execution&#160;<br/>Environment,&#160;Secure&#160;Storage,&#160;Secure&#160;Access&#160;the&#160;User&#160;Input/Output&#160;facility,&#160;Flexible&#160;<br/>Secure&#160;&#160;&#160;Boot/Secure&#160;&#160;&#160;Boot,&#160;&#160;&#160;and&#160;&#160;&#160;Runtime&#160;&#160;&#160;Integrity&#160;&#160;&#160;Checking.&#160;&#160;&#160;Generic&#160;&#160;&#160;Bootstrap&#160;<br/>Architecture&#160;and&#160;Secure&#160;Interaction&#160;of&#160;the&#160;UICC&#160;and&#160;Mobile&#160;Equipment&#160;were&#160;not&#160;<br/>considered&#160;as&#160;these&#160;UICC&#160;centric&#160;security&#160;enablers&#160;were&#160;not&#160;relevant&#160;to&#160;the&#160;secure&#160;<br/>wallet&#160;prototype.</p>
<p style="position:absolute;top:504px;left:85px;white-space:nowrap" class="ft10315">We&#160;compared&#160;the&#160;Secure&#160;Wallet&#160;use&#160;case&#160;with&#160;the&#160;OMTP&#160;TR1&#160;mobile&#160;commerce&#160;use&#160;<br/>case,&#160;and&#160;although&#160;we&#160;found&#160;some&#160;similarities,&#160;there&#160;were&#160;also&#160;many&#160;differences.&#160;The&#160;<br/>security&#160;enablers&#160;were&#160;seen&#160;as&#160;more&#160;promising&#160;for&#160;our&#160;work.</p>
<p style="position:absolute;top:581px;left:85px;white-space:nowrap" class="ft10315">An&#160;&#160;&#160;initial&#160;&#160;&#160;and&#160;&#160;&#160;non-exhaustive&#160;&#160;&#160;analysis&#160;&#160;was&#160;&#160;carried&#160;&#160;&#160;out&#160;&#160;&#160;in&#160;&#160;&#160;order&#160;&#160;&#160;to&#160;&#160;judge&#160;&#160;&#160;how&#160;&#160;&#160;the&#160;<br/>secure&#160;&#160;&#160;wallet&#160;&#160;&#160;prototype&#160;&#160;&#160;architecture&#160;&#160;&#160;mapped&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;TR1&#160;&#160;&#160;requirements.&#160;&#160;&#160;The&#160;<br/>implemented&#160;&#160;&#160;prototype&#160;&#160;&#160;was&#160;&#160;&#160;not&#160;&#160;&#160;used&#160;&#160;&#160;for&#160;&#160;&#160;the&#160;&#160;&#160;analysis.&#160;&#160;&#160;Instead&#160;&#160;&#160;we&#160;&#160;&#160;considered&#160;&#160;&#160;a&#160;<br/>theoretical&#160;successor&#160;to&#160;the&#160;secure&#160;wallet&#160;prototype,&#160;where&#160;the&#160;complete&#160;system&#160;had&#160;<br/>been&#160;ported&#160;to&#160;the&#160;X-GOLD</p>
<p style="position:absolute;top:658px;left:314px;white-space:nowrap" class="ft10317">TM&#160;</p>
<p style="position:absolute;top:658px;left:333px;white-space:nowrap" class="ft10314">208.</p>
<p style="position:absolute;top:696px;left:85px;white-space:nowrap" class="ft10315">We&#160;found&#160;that&#160;the&#160;basic&#160;platform&#160;security&#160;for&#160;OMTP&#160;TR0&#160;and&#160;TR1&#160;are&#160;based&#160;on&#160;a&#160;<br/>secure&#160;boot.&#160;The&#160;X-GOLD</p>
<p style="position:absolute;top:716px;left:304px;white-space:nowrap" class="ft10317">TM&#160;&#160;</p>
<p style="position:absolute;top:716px;left:325px;white-space:nowrap" class="ft10314">208&#160;can&#160;also&#160;provide&#160;general&#160;platform&#160;integrity&#160;through&#160;</p>
<p style="position:absolute;top:735px;left:85px;white-space:nowrap" class="ft10315">its&#160;secure&#160;boot&#160;feature.&#160;One&#160;of&#160;the&#160;most&#160;important&#160;security&#160;enablers&#160;of&#160;TR1&#160;is&#160;the&#160;<br/>TEE.&#160;We&#160;saw&#160;that&#160;the&#160;secure&#160;wallet&#160;prototype&#160;architecture&#160;can&#160;be&#160;viewed&#160;as&#160;a&#160;set&#160;of&#160;<br/>communicating&#160;&#160;&#160;Trusted&#160;&#160;&#160;Execution&#160;&#160;&#160;Engines.&#160;&#160;&#160;The&#160;&#160;&#160;prototype&#160;&#160;&#160;also&#160;&#160;&#160;provides&#160;&#160;&#160;a&#160;&#160;&#160;Secure&#160;<br/>Storage&#160;and&#160;Secure&#160;Access&#160;to&#160;User&#160;Input/Output&#160;facility&#160;generally&#160;in&#160;line&#160;with&#160;an&#160;<br/>OMTP&#160;TR1&#160;profile&#160;1&#160;classification.&#160;The&#160;secure&#160;storage&#160;was&#160;made&#160;possible&#160;due&#160;to&#160;the&#160;<br/>hardware&#160;&#160;&#160;cryptographic&#160;&#160;&#160;functions&#160;&#160;&#160;and&#160;&#160;&#160;unique&#160;&#160;&#160;key&#160;&#160;&#160;provided&#160;&#160;&#160;by&#160;&#160;&#160;the&#160;&#160;&#160;X-GOLD</p>
<p style="position:absolute;top:831px;left:753px;white-space:nowrap" class="ft10317">TM&#160;&#160;</p>
<p style="position:absolute;top:831px;left:777px;white-space:nowrap" class="ft10314">208&#160;</p>
<p style="position:absolute;top:850px;left:85px;white-space:nowrap" class="ft10314">hardware.</p>
<p style="position:absolute;top:888px;left:85px;white-space:nowrap" class="ft10315">The&#160;major&#160;security&#160;strength&#160;of&#160;the&#160;prototype&#160;was&#160;due&#160;to&#160;the&#160;strong&#160;isolation&#160;provided&#160;<br/>by&#160;&#160;&#160;the&#160;&#160;&#160;compartment&#160;&#160;&#160;manager.&#160;&#160;&#160;This&#160;&#160;&#160;isolation&#160;&#160;&#160;is&#160;&#160;&#160;generally&#160;&#160;&#160;only&#160;&#160;&#160;found&#160;&#160;&#160;in&#160;&#160;&#160;an&#160;&#160;&#160;OMTP&#160;<br/>profile&#160;2&#160;architecture.&#160;The&#160;prototype&#160;would&#160;not&#160;meet&#160;all&#160;profile&#160;2&#160;requirements,&#160;as&#160;it&#160;<br/>was&#160;not&#160;defined&#160;to&#160;protect&#160;against&#160;all&#160;of&#160;the&#160;OMTP&#160;TR1&#160;physical&#160;threats.</p>
<p style="position:absolute;top:984px;left:85px;white-space:nowrap" class="ft10315">Areas&#160;&#160;&#160;for&#160;&#160;&#160;further&#160;&#160;&#160;work&#160;&#160;&#160;would&#160;&#160;&#160;be&#160;&#160;&#160;a&#160;&#160;&#160;more&#160;&#160;&#160;detailed&#160;&#160;&#160;analysis&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;secure&#160;&#160;&#160;wallet&#160;<br/>prototype&#160;and&#160;the&#160;OMTP&#160;TR1&#160;requirements.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1037">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:746px;white-space:nowrap" class="ft1037">103/109</p>
</div>
<!-- Page 104 -->
<a name="104"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page104-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application104.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft10412">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft1040">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft1044">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft1044">Final</p>
<p style="position:absolute;top:172px;left:85px;white-space:nowrap" class="ft1043"><b>5&#160;</b></p>
<p style="position:absolute;top:169px;left:117px;white-space:nowrap" class="ft10419"><b>Conclusions</b></p>
<p style="position:absolute;top:199px;left:85px;white-space:nowrap" class="ft10414">In&#160;&#160;&#160;this&#160;&#160;&#160;deliverable,&#160;&#160;&#160;we&#160;&#160;&#160;proposed&#160;&#160;&#160;the&#160;&#160;</p>
<p style="position:absolute;top:199px;left:421px;white-space:nowrap" class="ft10420"><i>Secure&#160;&#160;&#160;Wallet</i></p>
<p style="position:absolute;top:199px;left:542px;white-space:nowrap" class="ft10414">&#160;&#160;as&#160;&#160;&#160;a&#160;&#160;&#160;countermeasure&#160;&#160;&#160;against&#160;</p>
<p style="position:absolute;top:218px;left:87px;white-space:nowrap" class="ft10415">identity&#160;theft&#160;and&#160;examined&#160;the&#160;use&#160;case&#160;from&#160;different&#160;points&#160;of&#160;view.&#160;In&#160;particular,&#160;<br/>the&#160;&#160;&#160;realization&#160;&#160;&#160;of&#160;&#160;&#160;such&#160;&#160;&#160;a&#160;&#160;&#160;solution&#160;&#160;&#160;on&#160;&#160;&#160;a&#160;&#160;&#160;mobile&#160;&#160;&#160;platform&#160;&#160;&#160;and&#160;&#160;&#160;its&#160;&#160;&#160;deployment&#160;&#160;&#160;with&#160;<br/>respect&#160;to&#160;relevant&#160;mobile&#160;standards&#160;have&#160;been&#160;considered.</p>
<p style="position:absolute;top:295px;left:85px;white-space:nowrap" class="ft10415">A&#160;&#160;&#160;PC-based&#160;&#160;&#160;prototype&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;Secure&#160;&#160;&#160;Wallet&#160;&#160;&#160;has&#160;&#160;&#160;been&#160;&#160;&#160;implemented,&#160;&#160;&#160;whereas&#160;&#160;&#160;the&#160;<br/>realization&#160;of&#160;the&#160;demonstrator&#160;described&#160;in&#160;Section&#160;2.7&#160;is&#160;still&#160;ongoing.&#160;Given&#160;that&#160;<br/>the&#160;TCG&#160;Mobile&#160;Trusted&#160;Module&#160;(MTM)&#160;specification&#160;was&#160;published&#160;when&#160;much&#160;of&#160;<br/>the&#160;&#160;&#160;work&#160;&#160;&#160;for&#160;&#160;&#160;our&#160;&#160;&#160;prototype&#160;&#160;&#160;was&#160;&#160;&#160;already&#160;&#160;&#160;in&#160;&#160;&#160;progress,&#160;&#160;&#160;and&#160;&#160;&#160;since&#160;&#160;&#160;the&#160;&#160;&#160;sealing&#160;<br/>functionality&#160;&#160;&#160;(which&#160;&#160;&#160;is&#160;&#160;&#160;the&#160;&#160;&#160;major&#160;&#160;&#160;Trusted&#160;&#160;&#160;Computing&#160;&#160;&#160;functionality&#160;&#160;&#160;needed&#160;&#160;&#160;for&#160;&#160;&#160;the&#160;<br/>Secure&#160;Wallet)&#160;provided&#160;by&#160;MTMs&#160;does&#160;not&#160;deviate&#160;from&#160;the&#160;TPM&#160;1.2&#160;specification,&#160;it&#160;<br/>seems&#160;&#160;&#160;reasonable&#160;&#160;&#160;to&#160;&#160;&#160;use&#160;&#160;&#160;a&#160;&#160;&#160;modified&#160;&#160;&#160;TPM&#160;&#160;&#160;emulator&#160;&#160;&#160;–&#160;&#160;&#160;equipped&#160;&#160;&#160;with&#160;&#160;&#160;a&#160;&#160;&#160;driver&#160;&#160;&#160;for&#160;<br/>accessing&#160;the&#160;existing&#160;security&#160;chip&#160;–&#160;to&#160;provide&#160;Trusted&#160;Computing&#160;functionality&#160;for&#160;<br/>the&#160;demonstrator.&#160;However,&#160;it&#160;is&#160;anticipated&#160;that&#160;in&#160;the&#160;future&#160;MTMs&#160;(possibly&#160;based&#160;<br/>on&#160;a&#160;similar&#160;mechanism&#160;to&#160;access&#160;vendor-specific&#160;mobile&#160;hardware)&#160;will&#160;be&#160;employed&#160;<br/>instead.</p>
<p style="position:absolute;top:525px;left:85px;white-space:nowrap" class="ft10414">In&#160;&#160;&#160;our&#160;&#160;&#160;theoretical&#160;&#160;&#160;work,&#160;&#160;&#160;we&#160;&#160;&#160;addressed&#160;&#160;&#160;the&#160;&#160;&#160;most&#160;&#160;&#160;relevant&#160;&#160;&#160;and&#160;&#160;&#160;recent&#160;&#160;&#160;standards&#160;</p>
<p style="position:absolute;top:545px;left:87px;white-space:nowrap" class="ft10415">relating&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;implementation&#160;&#160;&#160;of&#160;&#160;&#160;a&#160;&#160;&#160;trusted&#160;&#160;&#160;mobile&#160;&#160;&#160;platform.&#160;&#160;We&#160;&#160;&#160;examined&#160;&#160;&#160;which&#160;<br/>architectural&#160;components,&#160;based&#160;on&#160;the&#160;TCG&#160;mobile&#160;reference&#160;architecture&#160;[63],&#160;and&#160;<br/>which&#160;functions,&#160;as&#160;specified&#160;in&#160;the&#160;TCG&#160;MTM&#160;specification&#160;[64],&#160;could&#160;be&#160;used&#160;to&#160;<br/>facilitate&#160;a&#160;robust&#160;implementation&#160;of&#160;the&#160;secure&#160;wallet&#160;mechanism.&#160;The&#160;components&#160;<br/>and&#160;functionality&#160;required&#160;in&#160;order&#160;to&#160;implement&#160;the&#160;secure&#160;wallet&#160;will&#160;be&#160;used&#160;in&#160;<br/>specifying&#160;and&#160;analysing&#160;the&#160;methods&#160;by&#160;which&#160;a&#160;subset&#160;of&#160;MTM&#160;functionality&#160;can&#160;be&#160;<br/>provided&#160;given&#160;an&#160;X-GOLD</p>
<p style="position:absolute;top:660px;left:314px;white-space:nowrap" class="ft10417">TM&#160;</p>
<p style="position:absolute;top:660px;left:334px;white-space:nowrap" class="ft10414">208/a&#160;generic&#160;OMTP&#160;TR1&#160;device.&#160;We&#160;also&#160;examined&#160;the&#160;</p>
<p style="position:absolute;top:679px;left:87px;white-space:nowrap" class="ft10414">secure&#160;wallet&#160;use&#160;case&#160;in&#160;light&#160;of&#160;OMTP&#160;TR1.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1047">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:746px;white-space:nowrap" class="ft1047">104/109</p>
</div>
<!-- Page 105 -->
<a name="105"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft10570{font-size:24px;font-family:HAAAAA+Arial;color:#000000;}
-->
</style>
<div id="page105-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application105.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft10512">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft1050">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft1054">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft1054">Final</p>
<p style="position:absolute;top:189px;left:85px;white-space:nowrap" class="ft10570"><b>Bibliography</b></p>
<p style="position:absolute;top:231px;left:85px;white-space:nowrap" class="ft10514">[1]&#160;&#160;&#160;Anti&#160;&#160;&#160;Phishing&#160;&#160;&#160;Working&#160;&#160;&#160;Group.&#160;&#160;&#160;Phishing&#160;&#160;&#160;Activity&#160;&#160;&#160;Trends&#160;&#160;&#160;Report(s),&#160;&#160;&#160;2005-2007.&#160;</p>
<p style="position:absolute;top:251px;left:85px;white-space:nowrap" class="ft10566"><a href="http://www.antiphishing.org/">http://www.antiphishing.org</a></p>
<p style="position:absolute;top:251px;left:322px;white-space:nowrap" class="ft10514"><a href="http://www.antiphishing.org/">.</a></p>
<p style="position:absolute;top:285px;left:85px;white-space:nowrap" class="ft10514">[2]&#160;ID&#160;theft&#160;ring&#160;hits&#160;50&#160;banks,&#160;security&#160;firm&#160;says,&#160;2005.&#160;</p>
<p style="position:absolute;top:304px;left:85px;white-space:nowrap" class="ft10566"><a href="http://news.cnet.com/2100-7349_3-5823591.html">http://news.cnet.com/2100-7349_3-5823591.html</a></p>
<p style="position:absolute;top:304px;left:497px;white-space:nowrap" class="ft10514"><a href="http://news.cnet.com/2100-7349_3-5823591.html">.</a></p>
<p style="position:absolute;top:338px;left:85px;white-space:nowrap" class="ft10514">[3]&#160;New&#160;Trojans&#160;plunder&#160;bank&#160;accounts,&#160;2006.&#160;</p>
<p style="position:absolute;top:358px;left:85px;white-space:nowrap" class="ft10566"><a href="http://news.cnet.com/2100-7349_3-6041173.html">http://news.cnet.com/2100-7349_3-6041173.html</a></p>
<p style="position:absolute;top:358px;left:497px;white-space:nowrap" class="ft10514"><a href="http://news.cnet.com/2100-7349_3-6041173.html">.</a></p>
<p style="position:absolute;top:385px;left:85px;white-space:nowrap" class="ft10514">[4]&#160;L4&#160;linux.<a href="http://os.inf.tu-dresden.de/L4/LinuxOnL4/">&#160;</a></p>
<p style="position:absolute;top:385px;left:192px;white-space:nowrap" class="ft10566"><a href="http://os.inf.tu-dresden.de/L4/LinuxOnL4/">http://os.inf.tu-dresden.de/L4/LinuxOnL4/</a></p>
<p style="position:absolute;top:385px;left:541px;white-space:nowrap" class="ft10514"><a href="http://os.inf.tu-dresden.de/L4/LinuxOnL4/">.</a></p>
<p style="position:absolute;top:414px;left:85px;white-space:nowrap" class="ft10514">[5]&#160;The&#160;l4&#160;μ-kernel.<a href="http://os.inf.tu-dresden.de/L4/">&#160;</a></p>
<p style="position:absolute;top:414px;left:252px;white-space:nowrap" class="ft10566"><a href="http://os.inf.tu-dresden.de/L4/">http://os.inf.tu-dresden.de/L4/</a></p>
<p style="position:absolute;top:414px;left:502px;white-space:nowrap" class="ft10514"><a href="http://os.inf.tu-dresden.de/L4/">.</a></p>
<p style="position:absolute;top:442px;left:85px;white-space:nowrap" class="ft10514">[6]&#160;Microsoft&#160;warns&#160;of&#160;hijacked&#160;certificates.&#160;</p>
<p style="position:absolute;top:461px;left:85px;white-space:nowrap" class="ft10566"><a href="http://www.news.com/2100-1001-254586.html">http://www.news.com/2100-1001-254586.html</a></p>
<p style="position:absolute;top:461px;left:474px;white-space:nowrap" class="ft10514"><a href="http://www.news.com/2100-1001-254586.html">.</a></p>
<p style="position:absolute;top:489px;left:85px;white-space:nowrap" class="ft10514">[7]&#160;Netcraft&#160;toolbar.&#160;2004.<a href="http://toolbar.netcraft.com/">&#160;</a></p>
<p style="position:absolute;top:489px;left:313px;white-space:nowrap" class="ft10566"><a href="http://toolbar.netcraft.com/">http://toolbar.netcraft.com</a></p>
<p style="position:absolute;top:489px;left:536px;white-space:nowrap" class="ft10514"><a href="http://toolbar.netcraft.com/">.</a></p>
<p style="position:absolute;top:517px;left:85px;white-space:nowrap" class="ft10514">[8]&#160;Paros&#160;Java&#160;Proxy.<a href="http://www.parosproxy.org/">&#160;</a></p>
<p style="position:absolute;top:517px;left:265px;white-space:nowrap" class="ft10566"><a href="http://www.parosproxy.org/">http://www.parosproxy.org/</a></p>
<p style="position:absolute;top:517px;left:497px;white-space:nowrap" class="ft10514"><a href="http://www.parosproxy.org/">.</a></p>
<p style="position:absolute;top:546px;left:85px;white-space:nowrap" class="ft10514">[9]&#160;Phishers&#160;get&#160;personal.&#160;</p>
<p style="position:absolute;top:565px;left:85px;white-space:nowrap" class="ft10566"><a href="http://news.com.com/Phishers+get+personal/2100-7349_3-5720672.html">http://news.com.com/Phishers+get+personal/2100-7349_3-5720672.html</a></p>
<p style="position:absolute;top:565px;left:701px;white-space:nowrap" class="ft10514"><a href="http://news.com.com/Phishers+get+personal/2100-7349_3-5720672.html">.</a></p>
<p style="position:absolute;top:593px;left:85px;white-space:nowrap" class="ft10514">[10]&#160;TrustedGRUB.<a href="http://www.trust.rub.de/home/concluded-projects/trustedgrub/">&#160;</a></p>
<p style="position:absolute;top:593px;left:251px;white-space:nowrap" class="ft10566"><a href="http://www.trust.rub.de/home/concluded-projects/trustedgrub/">Http://www.trust.rub.de/home/concluded-projects/trustedgrub/</a></p>
<p style="position:absolute;top:593px;left:782px;white-space:nowrap" class="ft10514"><a href="http://www.trust.rub.de/home/concluded-projects/trustedgrub/">.</a></p>
<p style="position:absolute;top:621px;left:85px;white-space:nowrap" class="ft10514">[11]&#160;Gartner&#160;Press&#160;Releases&#160;2006.<a href="http://www.gartner.com/it/page.jsp?id=498245">&#160;</a></p>
<p style="position:absolute;top:621px;left:378px;white-space:nowrap" class="ft10566"><a href="http://www.gartner.com/it/page.jsp?id=498245">http://www.gartner.com/it/page.jsp?id=498245</a></p>
<p style="position:absolute;top:621px;left:774px;white-space:nowrap" class="ft10514"><a href="http://www.gartner.com/it/page.jsp?id=498245">.</a></p>
<p style="position:absolute;top:656px;left:85px;white-space:nowrap" class="ft10514">[12]&#160;Pop-up&#160;program&#160;reads&#160;keystrokes,&#160;steals&#160;passwords,&#160;2004.<a href="http://news.cnet.com/2100-7349_3-5251981.html">&#160;</a></p>
<p style="position:absolute;top:656px;left:627px;white-space:nowrap" class="ft10566"><a href="http://news.cnet.com/2100-7349_3-5251981.html">http://news.cnet.com/</a></p>
<p style="position:absolute;top:675px;left:85px;white-space:nowrap" class="ft10566"><a href="http://news.cnet.com/2100-7349_3-5251981.html">2100-7349_3-5251981.html</a></p>
<p style="position:absolute;top:675px;left:316px;white-space:nowrap" class="ft10514"><a href="http://news.cnet.com/2100-7349_3-5251981.html">.</a></p>
<p style="position:absolute;top:709px;left:85px;white-space:nowrap" class="ft10514">[13]</p>
<p style="position:absolute;top:709px;left:138px;white-space:nowrap" class="ft10514">TrouSerS&#160;–&#160;the&#160;Open-Source&#160;TCG&#160;Software&#160;Stack,&#160;</p>
<p style="position:absolute;top:729px;left:85px;white-space:nowrap" class="ft10566"><a href="http://trousers.sourceforge.net/">http://trousers.sourceforge.net/</a></p>
<p style="position:absolute;top:763px;left:85px;white-space:nowrap" class="ft10514">[14]</p>
<p style="position:absolute;top:763px;left:138px;white-space:nowrap" class="ft10514">TPM&#160;Manager&#160;v0.5,&#160;April&#160;2008,<a href="http://sourceforge.net/projects/tpmmanager">&#160;</a></p>
<p style="position:absolute;top:763px;left:408px;white-space:nowrap" class="ft10566"><a href="http://sourceforge.net/projects/tpmmanager">http://sourceforge.net/projects/tpmmanager</a></p>
<p style="position:absolute;top:791px;left:85px;white-space:nowrap" class="ft10515">[15]&#160;Andre&#160;Adelsbach,&#160;Sebastian&#160;Gajek,&#160;and&#160;Joerg&#160;Schwenk.&#160;Visual&#160;Spoofing&#160;of&#160;SSL-&#160;<br/>Protected&#160;Web&#160;Sites&#160;and&#160;Effective&#160;Countermeasures.&#160;In&#160;Information&#160;Security&#160;Practice&#160;<br/>and&#160;Experience,&#160;First&#160;International&#160;Conference,&#160;ISPEC&#160;2005,&#160;Singapore,&#160;April&#160;11-14,&#160;<br/>2005,&#160;Proceedings,&#160;pages&#160;204-216.&#160;Springer,&#160;2005.<br/>[16]&#160;W.&#160;A.&#160;Arbaugh,&#160;D.&#160;J.&#160;Farber,&#160;and&#160;J.&#160;M.&#160;Smith.&#160;A&#160;secure&#160;and&#160;reliable&#160;bootstrap&#160;<br/>architecture.&#160;In&#160;S&amp;P&#160;‘97:&#160;Proceedings&#160;of&#160;the&#160;1997&#160;IEEE&#160;Symposium&#160;on&#160;Security&#160;and&#160;<br/>Privacy,&#160;page&#160;65,&#160;Washington,&#160;DC,&#160;USA,&#160;1997.&#160;IEEE&#160;Computer&#160;Society.</p>
<p style="position:absolute;top:949px;left:85px;white-space:nowrap" class="ft10518">[17]&#160;&#160;&#160;B.&#160;&#160;&#160;Balacheff,&#160;&#160;&#160;L.&#160;&#160;&#160;Chen,&#160;&#160;&#160;S.&#160;&#160;&#160;Pearson,&#160;&#160;&#160;D.&#160;&#160;&#160;Plaquin,&#160;&#160;&#160;and&#160;&#160;&#160;G.&#160;&#160;&#160;Proudler.&#160;&#160;&#160;Trusted&#160;<br/>Computing&#160;&#160;&#160;Platforms:&#160;&#160;&#160;TCPA&#160;&#160;&#160;Technology&#160;&#160;&#160;in&#160;&#160;&#160;Context.&#160;&#160;&#160;Prentice&#160;&#160;&#160;Hall,&#160;&#160;&#160;Upper&#160;&#160;&#160;Saddle&#160;<br/>River,&#160;New&#160;Jersey,&#160;USA,&#160;2003.<br/>[18]&#160;Paul&#160;Barham,&#160;Boris&#160;Dragovic,&#160;Keir&#160;Fraser,&#160;Steven&#160;Hand,&#160;Tim&#160;Harris,&#160;Alex&#160;Ho,&#160;<br/>Rolf&#160;Neugebauer,&#160;Ian&#160;Pratt,&#160;and&#160;Andrew&#160;Wareld.&#160;Xen&#160;and&#160;the&#160;art&#160;of&#160;virtualization.&#160;In&#160;<br/>SOSP&#160;&#160;&#160;‘03:&#160;&#160;&#160;Proceedings&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;nineteenth&#160;&#160;&#160;ACM&#160;&#160;&#160;symposium&#160;&#160;&#160;on&#160;&#160;&#160;Operating&#160;&#160;&#160;systems&#160;<br/>principles,&#160;pages&#160;164-177,&#160;New&#160;York,&#160;NY,&#160;USA,&#160;2003.&#160;ACM.<br/>[19]&#160;&#160;&#160;Steven&#160;&#160;&#160;M.&#160;&#160;&#160;Bellovin.&#160;&#160;&#160;Using&#160;&#160;&#160;the&#160;&#160;&#160;domain&#160;&#160;&#160;name&#160;&#160;&#160;system&#160;&#160;&#160;for&#160;&#160;&#160;system&#160;&#160;&#160;breakins.&#160;&#160;&#160;In&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1057">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:746px;white-space:nowrap" class="ft1057">105/109</p>
</div>
<!-- Page 106 -->
<a name="106"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page106-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application106.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft10612">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft1060">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft1064">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft1064">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft10614">SSYM’95:&#160;Proceedings&#160;of&#160;the&#160;5</p>
<p style="position:absolute;top:151px;left:353px;white-space:nowrap" class="ft10617">th</p>
<p style="position:absolute;top:151px;left:363px;white-space:nowrap" class="ft10614">&#160;&#160;conference&#160;on&#160;USENIX&#160;UNIX&#160;Security&#160;Symposium,&#160;</p>
<p style="position:absolute;top:170px;left:85px;white-space:nowrap" class="ft10618">Berkeley,&#160;CA,&#160;USA,&#160;1995.&#160;USENIX&#160;Association.<br/>[20]&#160;&#160;&#160;Dominik&#160;&#160;&#160;Birk,&#160;&#160;&#160;Sebastian&#160;&#160;&#160;Gajek,&#160;&#160;&#160;Felix&#160;&#160;&#160;Grobert,&#160;&#160;&#160;and&#160;&#160;&#160;Ahmad-Reza&#160;&#160;&#160;Sadeghi.&#160;<br/>Phishing&#160;&#160;&#160;phishers&#160;&#160;&#160;–&#160;&#160;&#160;observing&#160;&#160;&#160;and&#160;&#160;&#160;tracing&#160;&#160;&#160;organized&#160;&#160;&#160;cybercrime.&#160;&#160;&#160;In&#160;&#160;ICIMP&#160;&#160;&#160;‘07:&#160;<br/>Proceedings&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;Second&#160;&#160;&#160;International&#160;&#160;&#160;Conference&#160;&#160;&#160;on&#160;&#160;&#160;Internet&#160;&#160;&#160;Monitoring&#160;&#160;&#160;and&#160;<br/>Protection,&#160;page&#160;3,&#160;Washington,&#160;DC,&#160;USA,&#160;2007.&#160;IEEE&#160;Computer&#160;Society.<br/>[21]&#160;Peter&#160;Burkholder.&#160;SSL&#160;Man-in-the-Middle&#160;Attacks.</p>
<p style="position:absolute;top:303px;left:85px;white-space:nowrap" class="ft10666"><a href="http://www.sans.org/rr/papers/60/480.pdf">http://www.sans.org/rr/papers/60/480.pdf</a></p>
<p style="position:absolute;top:303px;left:435px;white-space:nowrap" class="ft10614"><a href="http://www.sans.org/rr/papers/60/480.pdf">.</a></p>
<p style="position:absolute;top:332px;left:85px;white-space:nowrap" class="ft10615">[22]&#160;Neil&#160;Chou,&#160;Robert&#160;Ledesma,&#160;Yuka&#160;Teraguchi,&#160;and&#160;John&#160;C.&#160;Mitchell.&#160;Client-side&#160;<br/>defense&#160;&#160;&#160;against&#160;&#160;&#160;web-based&#160;&#160;&#160;identity&#160;&#160;&#160;theft.&#160;&#160;&#160;In&#160;&#160;Proceedings&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;Network&#160;&#160;&#160;and&#160;<br/>Distributed&#160;&#160;System&#160;Security&#160;&#160;Symposium,&#160;&#160;&#160;NDSS&#160;&#160;2004,&#160;&#160;San&#160;&#160;Diego,&#160;&#160;California,&#160;&#160;USA,&#160;<br/>2004.</p>
<p style="position:absolute;top:424px;left:85px;white-space:nowrap" class="ft10615">[23]&#160;P.C.&#160;Clark&#160;and&#160;L.J.&#160;Hoffman.&#160;BITS:&#160;A&#160;Smartcard&#160;Protected&#160;Operating&#160;System.&#160;<br/>Communications&#160;of&#160;the&#160;ACM,&#160;37(11):&#160;66-94,&#160;November,&#160;1994.<br/>[24]&#160;Richard&#160;S.&#160;Cox,&#160;Steven&#160;D.&#160;Gribble,&#160;Henry&#160;M.&#160;Levy,&#160;and&#160;Jacob&#160;Gorm&#160;Hansen.&#160;A&#160;<br/>safety-oriented&#160;&#160;platform&#160;&#160;for&#160;&#160;&#160;web&#160;&#160;applications.&#160;&#160;&#160;In&#160;&#160;SP&#160;&#160;&#160;‘06:&#160;&#160;Proceedings&#160;&#160;of&#160;&#160;the&#160;&#160;&#160;2006&#160;<br/>IEEE&#160;Symposium&#160;on&#160;Security&#160;and&#160;Privacy&#160;(S&amp;P’06),&#160;pages&#160;350-364,&#160;Washington,&#160;DC,&#160;<br/>USA,&#160;2006.&#160;IEEE&#160;Computer&#160;Society.<br/>[25]&#160;Rachna&#160;Dhamija&#160;and&#160;J.&#160;D.&#160;Tygar.&#160;The&#160;battle&#160;against&#160;phishing:&#160;Dynamic&#160;security&#160;<br/>skins.&#160;&#160;&#160;In&#160;&#160;SOUPS&#160;&#160;&#160;‘05:&#160;&#160;&#160;Proceedings&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;2005&#160;&#160;&#160;symposium&#160;&#160;&#160;on&#160;&#160;&#160;Usable&#160;&#160;&#160;privacy&#160;&#160;&#160;and&#160;<br/>security,&#160;pages&#160;77-88,&#160;New&#160;York,&#160;NY,&#160;USA,&#160;2005.&#160;ACM.</p>
<p style="position:absolute;top:630px;left:85px;white-space:nowrap" class="ft10615">[26]&#160;R.&#160;Dhamija,&#160;J.&#160;D.&#160;Tygar,&#160;and&#160;M.&#160;Hearst.&#160;Why&#160;Phishing&#160;Works.&#160;In&#160;Proceedings&#160;of&#160;<br/>the&#160;Conference&#160;on&#160;Human&#160;Factors&#160;in&#160;Computing&#160;Systems&#160;(CHI2006),&#160;2006.<br/>[27]&#160;Jeremy&#160;Epstein,&#160;John&#160;McHugh,&#160;Hilarie&#160;K.&#160;Orman,&#160;R.&#160;Pascale,&#160;Ann&#160;B.&#160;Marmor-<br/>Squires,&#160;&#160;&#160;B.&#160;&#160;&#160;Danner,&#160;&#160;&#160;C.&#160;&#160;&#160;Martin,&#160;&#160;&#160;M.&#160;&#160;&#160;Branstad,&#160;&#160;&#160;J.&#160;&#160;&#160;Benson,&#160;&#160;&#160;and&#160;&#160;&#160;D.&#160;&#160;&#160;Rothnie.&#160;&#160;&#160;A&#160;&#160;&#160;high&#160;<br/>assurance&#160;window&#160;system&#160;prototype.&#160;&#160;Journal&#160;of&#160;Computer&#160;Security,&#160;2(2-3):159-190,&#160;<br/>1993.<br/>[28]&#160;E.W&#160;Felten,&#160;D.&#160;Balfanz,&#160;D.&#160;Dean,&#160;and&#160;D.&#160;Wallach.&#160;Web&#160;spoofing:&#160;An&#160;internet&#160;con&#160;<br/>game.&#160;&#160;Technical&#160;&#160;&#160;Report&#160;&#160;&#160;540-96,&#160;&#160;Dept.&#160;&#160;&#160;of&#160;&#160;Computer&#160;&#160;Science,&#160;&#160;&#160;Princeton&#160;&#160;&#160;University,&#160;<br/>1996.<br/>[29]&#160;&#160;&#160;Norman&#160;&#160;&#160;Feske&#160;&#160;&#160;and&#160;&#160;&#160;Christian&#160;&#160;&#160;Helmuth.&#160;&#160;&#160;A&#160;&#160;&#160;Nitpicker’s&#160;&#160;&#160;guide&#160;&#160;&#160;to&#160;&#160;&#160;a&#160;&#160;&#160;minimal&#160;<br/>complexity&#160;&#160;&#160;secure&#160;&#160;&#160;GUI.&#160;&#160;&#160;In&#160;&#160;ACSAC&#160;&#160;&#160;‘05:&#160;&#160;&#160;Proceedings&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;21</p>
<p style="position:absolute;top:848px;left:637px;white-space:nowrap" class="ft10617">st</p>
<p style="position:absolute;top:848px;left:646px;white-space:nowrap" class="ft10614">&#160;&#160;Annual&#160;&#160;&#160;Computer&#160;</p>
<p style="position:absolute;top:867px;left:85px;white-space:nowrap" class="ft10615">Security&#160;Applications&#160;Conference,&#160;pages&#160;85-94,&#160;Washington,&#160;DC,&#160;USA,&#160;2005.&#160;IEEE&#160;<br/>Computer&#160;Society.<br/>[30]&#160;Eran&#160;Gabber,&#160;Phillip&#160;B.&#160;Gibbons,&#160;Yossi&#160;Matias,&#160;and&#160;Alain&#160;J.&#160;Mayer.&#160;How&#160;to&#160;make&#160;<br/>personalized&#160;&#160;&#160;web&#160;&#160;&#160;browsing&#160;&#160;&#160;simple,&#160;&#160;&#160;secure,&#160;&#160;&#160;and&#160;&#160;&#160;anonymous.&#160;&#160;&#160;In&#160;&#160;Financial&#160;<br/>Cryptography,&#160;First&#160;International&#160;Conference,&#160;FC&#160;‘97,&#160;Anguilla,&#160;British&#160;West&#160;Indies,&#160;<br/>February&#160;&#160;&#160;24-28,&#160;&#160;&#160;1997,&#160;&#160;&#160;Proceedings,&#160;&#160;&#160;volume&#160;&#160;&#160;1318&#160;&#160;&#160;of&#160;&#160;Lecture&#160;&#160;&#160;Notes&#160;&#160;&#160;in&#160;&#160;&#160;Computer&#160;<br/>Science,&#160;pages&#160;17-32.&#160;Springer,&#160;1997.</p>
<p style="position:absolute;top:1026px;left:85px;white-space:nowrap" class="ft10615">[31]&#160;&#160;Sebastian&#160;&#160;Gajek,&#160;&#160;Ahma-Reza&#160;&#160;Sadeghi,&#160;&#160;&#160;Christian&#160;&#160;Stüble,&#160;&#160;and&#160;&#160;Marcel&#160;&#160;Winandy.&#160;<br/>Compartmented&#160;&#160;&#160;security&#160;&#160;&#160;for&#160;&#160;&#160;browsers&#160;&#160;&#160;–&#160;&#160;&#160;or&#160;&#160;&#160;how&#160;&#160;&#160;to&#160;&#160;&#160;thwart&#160;&#160;&#160;a&#160;&#160;&#160;phisher&#160;&#160;&#160;with&#160;&#160;&#160;trusted&#160;<br/>computing.&#160;In&#160;&#160;Proceedings&#160;of&#160;the&#160;Second&#160;International&#160;Conference&#160;on&#160;Availability,&#160;<br/>Reliability&#160;and&#160;Security&#160;(ARES&#160;2007),&#160;pages&#160;120-127.&#160;IEEE,&#160;2007.</p>
<p style="position:absolute;top:1118px;left:85px;white-space:nowrap" class="ft10614">[32]&#160;&#160;&#160;S.&#160;&#160;&#160;Gajek,&#160;&#160;&#160;J.&#160;&#160;&#160;Schwenk,&#160;&#160;&#160;and&#160;&#160;X.&#160;&#160;&#160;Chen.&#160;&#160;&#160;On&#160;&#160;&#160;the&#160;&#160;&#160;insecurity&#160;&#160;&#160;of&#160;&#160;&#160;Microsoft’s&#160;&#160;&#160;identity&#160;</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1067">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:746px;white-space:nowrap" class="ft1067">106/109</p>
</div>
<!-- Page 107 -->
<a name="107"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft10771{font-size:17px;font-family:EAAAAA+DejaVuSerif;color:#0000ff;}
	.ft10772{font-size:17px;line-height:19px;font-family:EAAAAA+DejaVuSerif;color:#000080;}
-->
</style>
<div id="page107-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application107.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft10712">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft1070">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft1074">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft1074">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft10715">metasystem&#160;cardspace.&#160;Technical&#160;Report&#160;HGI&#160;TR-2008-004,&#160;Horst&#160;Goertz&#160;Institute&#160;for&#160;<br/>IT-Security,&#160;2008.<br/>[33]&#160;Tal&#160;Garfinkel,&#160;Ben&#160;Pfaff,&#160;Jim&#160;Chow,&#160;Mendel&#160;Rosenblum,&#160;and&#160;Dan&#160;Boneh.&#160;Terra:&#160;a&#160;<br/>virtual&#160;machine-based&#160;platform&#160;for&#160;trusted&#160;computing.&#160;In&#160;&#160;SOSP&#160;‘03:&#160;Proceedings&#160;of&#160;<br/>the&#160;&#160;&#160;nineteenth&#160;&#160;&#160;ACM&#160;&#160;&#160;symposium&#160;&#160;&#160;on&#160;&#160;&#160;Operating&#160;&#160;&#160;systems&#160;&#160;&#160;principles,&#160;&#160;&#160;pages&#160;&#160;&#160;193-206,&#160;<br/>New&#160;York,&#160;NY,&#160;USA,&#160;2003.&#160;ACM.</p>
<p style="position:absolute;top:290px;left:85px;white-space:nowrap" class="ft10715">[34]&#160;&#160;&#160;T.&#160;&#160;Groß&#160;&#160;and&#160;&#160;B.&#160;&#160;Pfitzmann.&#160;&#160;SAML&#160;&#160;&#160;artifact&#160;&#160;&#160;information&#160;&#160;&#160;flow&#160;&#160;&#160;revisited.&#160;&#160;&#160;In&#160;&#160;IEEE&#160;<br/>Workshop&#160;on&#160;Web&#160;Services&#160;Security,&#160;2006.<br/>[35]&#160;J.&#160;Alex&#160;Halderman,&#160;Brent&#160;Waters,&#160;and&#160;Edward&#160;W.&#160;Felten.&#160;A&#160;convenient&#160;method&#160;<br/>for&#160;securely&#160;managing&#160;passwords.&#160;In&#160;WWW&#160;‘05:&#160;Proceedings&#160;of&#160;the&#160;14</p>
<p style="position:absolute;top:356px;left:684px;white-space:nowrap" class="ft10717">th</p>
<p style="position:absolute;top:357px;left:694px;white-space:nowrap" class="ft10714">&#160;international&#160;</p>
<p style="position:absolute;top:376px;left:85px;white-space:nowrap" class="ft10715">conference&#160;on&#160;World&#160;Wide&#160;Web,&#160;pages&#160;471-479,&#160;New&#160;York,&#160;NY,&#160;USA,&#160;2005.&#160;ACM.<br/>[36]&#160;&#160;&#160;Amir&#160;&#160;&#160;Herzberg.&#160;&#160;&#160;Browsers&#160;&#160;&#160;defenses&#160;&#160;&#160;against&#160;&#160;&#160;phishing,&#160;&#160;&#160;spoofing&#160;&#160;&#160;and&#160;&#160;&#160;malware.&#160;<br/>Cryptology&#160;ePrint&#160;Archive,&#160;Report&#160;2006/083,&#160;2006.<a href="http://eprint.iacr.org/2006/083">&#160;</a></p>
<p style="position:absolute;top:423px;left:518px;white-space:nowrap" class="ft10766"><a href="http://eprint.iacr.org/2006/083">http://eprint.iacr.org/2006/083</a></p>
<p style="position:absolute;top:423px;left:776px;white-space:nowrap" class="ft10714"><a href="http://eprint.iacr.org/2006/083">.</a></p>
<p style="position:absolute;top:451px;left:85px;white-space:nowrap" class="ft10715">[37]&#160;&#160;&#160;Amir&#160;&#160;&#160;Herzberg&#160;&#160;&#160;and&#160;&#160;&#160;Ahmad&#160;&#160;&#160;Gbara.&#160;&#160;&#160;Security&#160;&#160;&#160;and&#160;&#160;&#160;identication&#160;&#160;&#160;indicators&#160;&#160;&#160;for&#160;<br/>browsers&#160;against&#160;spoofing&#160;and&#160;phishing&#160;attacks.&#160;Cryptology&#160;ePrint&#160;Archive,&#160;Report&#160;<br/>2004/155,&#160;2004.<a href="http://eprint.iacr.org/2004/155">&#160;</a></p>
<p style="position:absolute;top:490px;left:227px;white-space:nowrap" class="ft10766"><a href="http://eprint.iacr.org/2004/155">http://eprint.iacr.org/2004/155</a></p>
<p style="position:absolute;top:490px;left:485px;white-space:nowrap" class="ft10714"><a href="http://eprint.iacr.org/2004/155">.</a></p>
<p style="position:absolute;top:524px;left:85px;white-space:nowrap" class="ft10715">[38]&#160;&#160;&#160;D.&#160;&#160;&#160;P.&#160;&#160;&#160;Jablon.&#160;&#160;&#160;Strong&#160;&#160;&#160;password-only&#160;&#160;&#160;authenticated&#160;&#160;&#160;key&#160;&#160;&#160;exchange.&#160;&#160;Computer&#160;<br/>Communication&#160;Review,&#160;26(5):5–26,&#160;1996.</p>
<p style="position:absolute;top:578px;left:85px;white-space:nowrap" class="ft10715">[39]&#160;&#160;&#160;C.&#160;&#160;&#160;Jackson,&#160;&#160;&#160;D.&#160;&#160;&#160;Boneh,&#160;&#160;&#160;and&#160;&#160;&#160;J.&#160;&#160;&#160;Mitchell.&#160;&#160;&#160;Spyware&#160;&#160;&#160;resistant&#160;&#160;&#160;web&#160;&#160;&#160;authentication&#160;<br/>using&#160;virtual&#160;machines.<a href="http://crypto.stanford.edu/spyblock/">&#160;</a></p>
<p style="position:absolute;top:597px;left:286px;white-space:nowrap" class="ft10771"><a href="http://crypto.stanford.edu/spyblock/">http://crypto.stanford.edu/spyblock/</a></p>
<p style="position:absolute;top:597px;left:587px;white-space:nowrap" class="ft10714"><a href="http://crypto.stanford.edu/spyblock/">,</a>&#160;2006.</p>
<p style="position:absolute;top:631px;left:85px;white-space:nowrap" class="ft10715">[40]&#160;C.&#160;Jackson,&#160;D.&#160;Boneh,&#160;and&#160;J.&#160;Mitchell.&#160;Transaction&#160;generators:&#160;Root&#160;kits&#160;for&#160;web.&#160;<br/>In&#160;2nd&#160;USENIX&#160;Workshop&#160;on&#160;Hot&#160;Topics&#160;in&#160;Security&#160;(HotSec&#160;’07),&#160;2007.</p>
<p style="position:absolute;top:685px;left:85px;white-space:nowrap" class="ft10715">[41]&#160;Collin&#160;Jackson,&#160;Daniel&#160;R.&#160;Simon,&#160;Desney&#160;S.&#160;Tan,&#160;and&#160;Adam&#160;Barth.&#160;An&#160;evaluation&#160;<br/>of&#160;&#160;&#160;extended&#160;&#160;&#160;validation&#160;&#160;&#160;and&#160;&#160;&#160;picture-in-picture&#160;&#160;&#160;phishing&#160;&#160;&#160;attacks.&#160;&#160;&#160;In&#160;&#160;Financial&#160;<br/>Cryptography&#160;&#160;&#160;and&#160;&#160;&#160;Data&#160;&#160;&#160;Security,&#160;&#160;&#160;11</p>
<p style="position:absolute;top:723px;left:407px;white-space:nowrap" class="ft10717">th</p>
<p style="position:absolute;top:723px;left:417px;white-space:nowrap" class="ft10714">&#160;&#160;International&#160;&#160;&#160;Conference,&#160;&#160;&#160;FC&#160;&#160;&#160;2007,&#160;&#160;&#160;and&#160;&#160;&#160;1</p>
<p style="position:absolute;top:723px;left:799px;white-space:nowrap" class="ft10717">st&#160;</p>
<p style="position:absolute;top:742px;left:85px;white-space:nowrap" class="ft10715">International&#160;Workshop&#160;on&#160;Usable&#160;Security,&#160;USEC&#160;2007,&#160;Scarborough,&#160;Trinidad&#160;and&#160;<br/>Tobago,&#160;February&#160;12-16,&#160;2007.&#160;Revised&#160;Selected&#160;Papers,&#160;pages&#160;281-293.&#160;Springer,&#160;<br/>2007.<br/>[42]&#160;Markus&#160;Jakobsson&#160;and&#160;Adam&#160;Young.&#160;Distributed&#160;phishing&#160;attacks.&#160;Cryptology&#160;<br/>ePrint&#160;Archive,&#160;Report&#160;2005/091,&#160;2005.<a href="http://eprint.iacr.org/2005/091">&#160;</a></p>
<p style="position:absolute;top:828px;left:421px;white-space:nowrap" class="ft10766"><a href="http://eprint.iacr.org/2005/091">http://eprint.iacr.org/2005/091</a></p>
<p style="position:absolute;top:828px;left:678px;white-space:nowrap" class="ft10714"><a href="http://eprint.iacr.org/2005/091">.</a></p>
<p style="position:absolute;top:862px;left:85px;white-space:nowrap" class="ft10715">[43]&#160;R.&#160;C.&#160;Jammalamadaka,&#160;T.&#160;W.&#160;van&#160;der&#160;Horst,&#160;S.&#160;Mehrotra,&#160;K.&#160;E.&#160;Seamons,&#160;and&#160;N.&#160;<br/>Venkasubramanian.&#160;Delegate:&#160;A&#160;proxy-based&#160;architecture&#160;for&#160;secure&#160;website&#160;access&#160;<br/>from&#160;&#160;&#160;an&#160;&#160;&#160;untrusted&#160;&#160;&#160;machine.&#160;&#160;&#160;In&#160;&#160;22nd&#160;&#160;&#160;Annual&#160;&#160;&#160;Computer&#160;&#160;&#160;Security&#160;&#160;&#160;Applications&#160;<br/>Conference&#160;(ACSAC’06),&#160;pages&#160;57–66.&#160;IEEE&#160;Computer&#160;Society,&#160;2006.</p>
<p style="position:absolute;top:954px;left:85px;white-space:nowrap" class="ft10714">[44]&#160;&#160;&#160;Stephen&#160;&#160;&#160;Kost.&#160;&#160;&#160;Hashing&#160;&#160;&#160;Credit&#160;&#160;&#160;Card&#160;&#160;&#160;Numbers:&#160;&#160;&#160;Unsafe&#160;&#160;&#160;Application&#160;&#160;&#160;Practices.&#160;</p>
<p style="position:absolute;top:974px;left:85px;white-space:nowrap" class="ft10772"><a href="http://www.integrigy.com/security-resources/whitepapers/Integrigy_Hashing_Credit_Card_Numbers_Unsafe_Practices.pdf">http://www.integrigy.com/security-<br/>resources/whitepapers/Integrigy_Hashing_Credit_Card_Numbers_Unsafe_Practices.p<br/>df</a></p>
<p style="position:absolute;top:1012px;left:102px;white-space:nowrap" class="ft10714"><a href="http://www.integrigy.com/security-resources/whitepapers/Integrigy_Hashing_Credit_Card_Numbers_Unsafe_Practices.pdf">.</a></p>
<p style="position:absolute;top:1046px;left:85px;white-space:nowrap" class="ft10761">[45]&#160;P.&#160;C.&#160;S.&#160;Kwan&#160;and&#160;G.&#160;Durfee.&#160;Practical&#160;uses&#160;of&#160;virtual&#160;machines&#160;for&#160;protection&#160;of&#160;<br/>sensitive&#160;&#160;&#160;user&#160;&#160;&#160;data.&#160;&#160;&#160;In&#160;&#160;Information&#160;&#160;&#160;Security&#160;&#160;&#160;Practice&#160;&#160;&#160;and&#160;&#160;&#160;Experience&#160;&#160;&#160;Conference&#160;<br/>(ISPEC&#160;2007).&#160;Springer,&#160;2007.<br/>[46]&#160;Jochen&#160;Liedtke.&#160;On&#160;micro-kernel&#160;construction.&#160;In&#160;SOSP,&#160;pages&#160;237-250,&#160;1995.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1077">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:746px;white-space:nowrap" class="ft1077">107/109</p>
</div>
<!-- Page 108 -->
<a name="108"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page108-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application108.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft10812">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft1080">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft1084">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft1084">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft10815">[47]&#160;H.&#160;Löhr,&#160;A.-R.&#160;Sadeghi,&#160;C.&#160;Stüble,&#160;M.&#160;Winandy.&#160;Secure&#160;Wallet.&#160;Open_TC&#160;Internal&#160;<br/>Deliverable.&#160;Ruhr-Universitat&#160;Bochum,&#160;Horst&#160;Gortz&#160;Institute&#160;for&#160;IT&#160;Security,&#160;Bochum,&#160;<br/>Germany,&#160;January,&#160;2007.<br/>[48]&#160;John&#160;Marchesini,&#160;Sean&#160;W.&#160;Smith,&#160;Omen&#160;Wild,&#160;Josh&#160;Stabiner,&#160;and&#160;Alex&#160;Barsamian.&#160;<br/>Open-Source&#160;Applications&#160;of&#160;TCPA&#160;Hardware.&#160;In&#160;ACSAC&#160;‘04:&#160;Proceedings&#160;of&#160;the&#160;20</p>
<p style="position:absolute;top:236px;left:798px;white-space:nowrap" class="ft10817">th&#160;</p>
<p style="position:absolute;top:256px;left:85px;white-space:nowrap" class="ft10815">Annual&#160;&#160;&#160;Computer&#160;&#160;&#160;Security&#160;&#160;&#160;Applications&#160;&#160;&#160;Conference&#160;&#160;&#160;(ACSAC’04),&#160;&#160;&#160;pages&#160;&#160;&#160;294-303,&#160;<br/>Washington,&#160;DC,&#160;USA,&#160;2004.&#160;IEEE&#160;Computer&#160;Society.</p>
<p style="position:absolute;top:310px;left:85px;white-space:nowrap" class="ft10814">[49]</p>
<p style="position:absolute;top:310px;left:138px;white-space:nowrap" class="ft10814">OMTP&#160;&#160;&#160;(Open&#160;&#160;&#160;Mobile&#160;&#160;&#160;Terminal&#160;&#160;&#160;Platform)&#160;&#160;&#160;Trusted&#160;&#160;&#160;Environment&#160;&#160;&#160;TR0,&#160;&#160;&#160;March&#160;</p>
<p style="position:absolute;top:329px;left:85px;white-space:nowrap" class="ft10814">2006,<a href="http://www.omtp.org/Publications.aspx">&#160;</a></p>
<p style="position:absolute;top:329px;left:138px;white-space:nowrap" class="ft10866"><a href="http://www.omtp.org/Publications.aspx">http://www.omtp.org/Publications.aspx</a></p>
<p style="position:absolute;top:363px;left:85px;white-space:nowrap" class="ft10814">[50]</p>
<p style="position:absolute;top:363px;left:138px;white-space:nowrap" class="ft10814">OMTP&#160;(Open&#160;Mobile&#160;Terminal&#160;Platform)&#160;Advanced&#160;Trusted&#160;Environment&#160;TR1,&#160;</p>
<p style="position:absolute;top:382px;left:85px;white-space:nowrap" class="ft10814">May&#160;2008,<a href="http://www.omtp.org/Publications.aspx">&#160;</a></p>
<p style="position:absolute;top:382px;left:179px;white-space:nowrap" class="ft10866"><a href="http://www.omtp.org/Publications.aspx">http://www.omtp.org/Publications.aspx</a></p>
<p style="position:absolute;top:410px;left:85px;white-space:nowrap" class="ft10815">[51]&#160;&#160;&#160;Rolf&#160;&#160;&#160;Oppliger,&#160;&#160;&#160;Ralf&#160;&#160;&#160;Hauser,&#160;&#160;&#160;and&#160;&#160;&#160;David&#160;&#160;&#160;A.&#160;&#160;Basin.&#160;&#160;&#160;SSL/TLS&#160;&#160;&#160;session-aware&#160;&#160;&#160;user&#160;<br/>authentication&#160;&#160;&#160;–&#160;&#160;&#160;Or&#160;&#160;&#160;how&#160;&#160;&#160;to&#160;&#160;&#160;effectively&#160;&#160;&#160;thwart&#160;&#160;&#160;the&#160;&#160;&#160;man-in&#160;&#160;&#160;the-middle.&#160;&#160;Computer&#160;<br/>Communications,&#160;29(12):2238-2246,&#160;2006.<br/>[52]&#160;Bryan&#160;Parno,&#160;Cynthia&#160;Kuo,&#160;and&#160;Adrian&#160;Perrig.&#160;Phool-proof&#160;Phishing&#160;Prevention.&#160;<br/>In&#160;Financial&#160;Cryptography&#160;and&#160;Data&#160;Security,&#160;10</p>
<p style="position:absolute;top:496px;left:494px;white-space:nowrap" class="ft10817">th</p>
<p style="position:absolute;top:496px;left:504px;white-space:nowrap" class="ft10814">&#160;International&#160;Conference,&#160;FC&#160;2006,&#160;</p>
<p style="position:absolute;top:515px;left:85px;white-space:nowrap" class="ft10815">Anguilla,&#160;British&#160;West&#160;Indies,&#160;February&#160;27-March&#160;2,&#160;2006,&#160;Revised&#160;Selected&#160;Papers,&#160;<br/>pages&#160;1-19.&#160;Springer,&#160;2006.<br/>[53]&#160;Birgit&#160;Pfitzmann,&#160;James&#160;Riordan,&#160;Christian&#160;Stüble,&#160;Michael&#160;Waidner,&#160;and&#160;Arnd&#160;<br/>Weber.&#160;&#160;&#160;The&#160;&#160;&#160;PERSEUS&#160;&#160;&#160;system&#160;&#160;&#160;architecture.&#160;&#160;&#160;In&#160;&#160;&#160;Dirk&#160;&#160;&#160;Fox,&#160;&#160;&#160;Marit&#160;&#160;&#160;Kuehntopp,&#160;&#160;&#160;and&#160;<br/>Andreas&#160;Pfitzmann,&#160;editors,&#160;&#160;VIS&#160;&#160;2001,&#160;Sicherheit&#160;&#160;in&#160;komplexen&#160;&#160;IT-Infrastrukturen,&#160;<br/>pages&#160;1-18.&#160;Vieweg&#160;Verlag,&#160;2001.</p>
<p style="position:absolute;top:655px;left:85px;white-space:nowrap" class="ft10815">[54]&#160;&#160;&#160;B.&#160;&#160;&#160;Pfitzmann&#160;&#160;&#160;and&#160;&#160;&#160;M.Waidner.&#160;&#160;&#160;Analysis&#160;&#160;&#160;of&#160;&#160;&#160;liberty&#160;&#160;&#160;single-sign-on&#160;&#160;&#160;with&#160;&#160;&#160;enabled&#160;<br/>clients.&#160;IEEE&#160;Internet&#160;Computing,&#160;7(6):38–44,&#160;2003.<br/>[55]&#160;&#160;&#160;Blake&#160;&#160;&#160;Ross,&#160;&#160;&#160;Collin&#160;&#160;&#160;Jackson,&#160;&#160;&#160;Nick&#160;&#160;&#160;Miyake,&#160;&#160;&#160;Dan&#160;&#160;&#160;Boneh,&#160;&#160;&#160;and&#160;&#160;&#160;John&#160;&#160;&#160;C.&#160;&#160;&#160;Mitchell.&#160;<br/>Stronger&#160;&#160;&#160;password&#160;&#160;&#160;authentication&#160;&#160;&#160;using&#160;&#160;&#160;browser&#160;&#160;&#160;extensions.&#160;&#160;&#160;In&#160;&#160;SSYM’05:&#160;<br/>Proceedings&#160;of&#160;the&#160;14</p>
<p style="position:absolute;top:740px;left:277px;white-space:nowrap" class="ft10817">th</p>
<p style="position:absolute;top:740px;left:287px;white-space:nowrap" class="ft10814">&#160;&#160;conference&#160;on&#160;USENIX&#160;Security&#160;Symposium,&#160;Berkeley,&#160;CA,&#160;</p>
<p style="position:absolute;top:759px;left:85px;white-space:nowrap" class="ft10815">USA,&#160;2005.&#160;USENIX&#160;Association.<br/>[56]&#160;Reiner&#160;Sailer,&#160;Xiaolan&#160;Zhang,&#160;Trent&#160;Jaeger,&#160;and&#160;Leendert&#160;van&#160;Doorn.&#160;Design&#160;and&#160;<br/>implementation&#160;&#160;&#160;of&#160;&#160;&#160;a&#160;&#160;&#160;TCG-based&#160;&#160;&#160;integrity&#160;&#160;&#160;measurement&#160;&#160;&#160;architecture.&#160;&#160;&#160;In&#160;&#160;SSYM’04:&#160;<br/>Proceedings&#160;of&#160;the&#160;13</p>
<p style="position:absolute;top:826px;left:277px;white-space:nowrap" class="ft10817">th</p>
<p style="position:absolute;top:826px;left:287px;white-space:nowrap" class="ft10814">&#160;&#160;conference&#160;on&#160;USENIX&#160;Security&#160;Symposium,&#160;Berkeley,&#160;CA,&#160;</p>
<p style="position:absolute;top:845px;left:85px;white-space:nowrap" class="ft10815">USA,&#160;2004.&#160;USENIX&#160;Association.<br/>[57]&#160;&#160;&#160;Jonathan&#160;&#160;&#160;S.&#160;&#160;&#160;Shapiro&#160;&#160;&#160;and&#160;&#160;&#160;Norman&#160;&#160;&#160;Hardy.&#160;&#160;&#160;Eros:&#160;&#160;&#160;A&#160;&#160;&#160;principle-driven&#160;&#160;&#160;operating&#160;<br/>system&#160;from&#160;the&#160;ground&#160;up.&#160;IEEE&#160;Software,&#160;19(1):26-33,&#160;2002.<br/>[58]&#160;&#160;Jonathan&#160;S.&#160;Shapiro,&#160;&#160;John&#160;Vanderburgh,&#160;&#160;Eric&#160;&#160;Northup,&#160;&#160;and&#160;David&#160;Chizmadia.&#160;<br/>Design&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;eros&#160;&#160;&#160;trusted&#160;&#160;&#160;window&#160;&#160;&#160;system.&#160;&#160;&#160;In&#160;&#160;Proceedings&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;13</p>
<p style="position:absolute;top:940px;left:717px;white-space:nowrap" class="ft10817">th</p>
<p style="position:absolute;top:940px;left:727px;white-space:nowrap" class="ft10814">&#160;&#160;USENIX&#160;</p>
<p style="position:absolute;top:959px;left:85px;white-space:nowrap" class="ft10818">Security&#160;Symposium,&#160;August&#160;9-13,&#160;2004,&#160;San&#160;Diego,&#160;CA,&#160;USA,&#160;pages&#160;165-178,&#160;2004.<br/>[59]&#160;George&#160;Staikos.&#160;Kwallet&#160;-&#160;The&#160;KDE&#160;Wallet&#160;System.&#160;</p>
<p style="position:absolute;top:1006px;left:85px;white-space:nowrap" class="ft10866"><a href="http://www.staikos.on.ca/staikos/papers/2003/kwallet-kastle-2003.ps">http://www.staikos.on.ca/staikos/papers/2003/kwallet-kastle-2003.ps</a></p>
<p style="position:absolute;top:1006px;left:661px;white-space:nowrap" class="ft10814"><a href="http://www.staikos.on.ca/staikos/papers/2003/kwallet-kastle-2003.ps">.</a></p>
<p style="position:absolute;top:1041px;left:85px;white-space:nowrap" class="ft10815">[60]&#160;&#160;&#160;Michael&#160;&#160;&#160;Steiner,&#160;&#160;&#160;Peter&#160;&#160;&#160;Buhler,&#160;&#160;&#160;Thomas&#160;&#160;&#160;Eirich,&#160;&#160;&#160;and&#160;&#160;&#160;Michael&#160;&#160;&#160;Waidner.&#160;&#160;&#160;Secure&#160;<br/>password-based&#160;cipher&#160;suite&#160;for&#160;tls.&#160;ACM&#160;Trans.&#160;Inf.&#160;Syst.&#160;Secur.,&#160;4(2):134-157,&#160;2001.</p>
<p style="position:absolute;top:1095px;left:85px;white-space:nowrap" class="ft10815">[61]&#160;Mario&#160;Strasser&#160;(ETH&#160;Zurich),&#160;Heiko&#160;Stamer,&#160;Jesus&#160;Molina.&#160;The&#160;TPM&#160;Emulator&#160;–&#160;<br/>Software&#160;based&#160;TPM&#160;Emulator&#160;for&#160;Unix),<a href="http://tpm-emulator.berlios.de/">&#160;</a></p>
<p style="position:absolute;top:1114px;left:433px;white-space:nowrap" class="ft10866"><a href="http://tpm-emulator.berlios.de/">http://tpm-emulator.berlios.de/</a></p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1087">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:746px;white-space:nowrap" class="ft1087">108/109</p>
</div>
<!-- Page 109 -->
<a name="109"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page109-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application109.png" alt="background image"/>
<p style="position:absolute;top:128px;left:98px;white-space:nowrap" class="ft10912">&#160;</p>
<p style="position:absolute;top:85px;left:98px;white-space:nowrap" class="ft1090">&#160;</p>
<p style="position:absolute;top:92px;left:233px;white-space:nowrap" class="ft1094">Security&#160;Services&#160;for&#160;a&#160;Trusted&#160;Mobile&#160;Application</p>
<p style="position:absolute;top:92px;left:727px;white-space:nowrap" class="ft1094">Final</p>
<p style="position:absolute;top:151px;left:85px;white-space:nowrap" class="ft10915">[62]&#160;F.&#160;Stumpf,&#160;O.&#160;Tafreschi,&#160;P.&#160;Roeder,&#160;and&#160;C.&#160;Eckert.&#160;A&#160;robust&#160;integrity&#160;reporting&#160;<br/>protocol&#160;for&#160;remote&#160;attestation.&#160;In&#160;Proceedings&#160;of&#160;the&#160;Second&#160;Workshop&#160;on&#160;Advances&#160;<br/>in&#160;Trusted&#160;Computing&#160;(WATC’06&#160;Fall),&#160;Tokyo,&#160;December&#160;2006.</p>
<p style="position:absolute;top:224px;left:85px;white-space:nowrap" class="ft10915">[63]&#160;TCG&#160;MPWG.&#160;TCG&#160;Mobile&#160;Reference&#160;Architecture.&#160;TCG&#160;specification&#160;Version&#160;1.0&#160;<br/>Revision&#160;1,&#160;The&#160;Trusted&#160;Computing&#160;Group&#160;(TCG),&#160;Portland,&#160;Oregon,&#160;USA,&#160;June,&#160;2007.</p>
<p style="position:absolute;top:277px;left:85px;white-space:nowrap" class="ft10915">[64]&#160;&#160;&#160;TCG&#160;&#160;&#160;MPWG.&#160;&#160;&#160;TCG&#160;&#160;&#160;Mobile&#160;&#160;&#160;Trusted&#160;&#160;&#160;Module&#160;&#160;&#160;Specification.&#160;&#160;&#160;TCG&#160;&#160;&#160;specification&#160;<br/>Version&#160;1.0&#160;Revision&#160;1,&#160;The&#160;Trusted&#160;Computing&#160;Group&#160;(TCG),&#160;Portland,&#160;Oregon,&#160;USA,&#160;<br/>June,&#160;2007.</p>
<p style="position:absolute;top:350px;left:85px;white-space:nowrap" class="ft10915">[65]&#160;TCG.&#160;TPM&#160;Main,&#160;Part&#160;2&#160;TPM&#160;Data&#160;Structures.&#160;TCG&#160;Specification&#160;Version&#160;1.2&#160;<br/>Level&#160;2&#160;Revision&#160;85,&#160;The&#160;Trusted&#160;Computing&#160;Group&#160;(TCG),&#160;Portland,&#160;Oregon,&#160;USA,&#160;<br/>February,&#160;2005.</p>
<p style="position:absolute;top:422px;left:85px;white-space:nowrap" class="ft10915">[66]&#160;&#160;&#160;TCG.&#160;&#160;&#160;TCG&#160;&#160;&#160;PC&#160;&#160;&#160;Client&#160;&#160;&#160;Specific&#160;&#160;&#160;Implementation&#160;&#160;&#160;Specification&#160;&#160;&#160;for&#160;&#160;&#160;Conventional&#160;<br/>BIOS.&#160;&#160;&#160;TCG&#160;&#160;&#160;specification&#160;&#160;&#160;Version&#160;&#160;&#160;1.2&#160;&#160;&#160;Final,&#160;&#160;&#160;The&#160;&#160;&#160;Trusted&#160;&#160;&#160;Computing&#160;&#160;&#160;Group&#160;&#160;&#160;(TCG),&#160;<br/>Portland,&#160;Oregon,&#160;USA,&#160;July,&#160;2005.</p>
<p style="position:absolute;top:495px;left:85px;white-space:nowrap" class="ft10915">[67]&#160;TCG.&#160;TCG&#160;Software&#160;Stack&#160;Specification.&#160;TCG&#160;Specification&#160;Version&#160;1.2&#160;Level&#160;1,&#160;<br/>The&#160;Trusted&#160;Computing&#160;Group&#160;(TCG),&#160;Portland,&#160;Oregon,&#160;USA,&#160;January,&#160;2006.</p>
<p style="position:absolute;top:548px;left:85px;white-space:nowrap" class="ft10915">[68]&#160;&#160;&#160;Sean&#160;&#160;&#160;Whalen,&#160;&#160;&#160;Sophie&#160;&#160;&#160;Engle,&#160;&#160;&#160;and&#160;&#160;&#160;Dominic&#160;&#160;&#160;Romeo.&#160;&#160;&#160;An&#160;&#160;&#160;Introduction&#160;&#160;&#160;to&#160;&#160;&#160;ARP&#160;<br/>Spoofing,</p>
<p style="position:absolute;top:567px;left:460px;white-space:nowrap" class="ft10914">&#160;</p>
<p style="position:absolute;top:567px;left:761px;white-space:nowrap" class="ft10914">2001.&#160;</p>
<p style="position:absolute;top:586px;left:85px;white-space:nowrap" class="ft10966"><a href="http://www.rootsecure.net/content/downloads/pdf/arp_spoofing_slides.pdf">http://www.rootsecure.net/content/downloads/pdf/arp_spoofing_slides.pdf</a></p>
<p style="position:absolute;top:586px;left:705px;white-space:nowrap" class="ft10914"><a href="http://www.rootsecure.net/content/downloads/pdf/arp_spoofing_slides.pdf">.</a></p>
<p style="position:absolute;top:621px;left:85px;white-space:nowrap" class="ft10915">[69]&#160;Min&#160;Wu,&#160;Robert&#160;C.&#160;Miller,&#160;and&#160;Simson&#160;L.&#160;Garfinkel.&#160;Do&#160;security&#160;toolbars&#160;actually&#160;<br/>prevent&#160;&#160;&#160;phishing&#160;&#160;&#160;attacks?&#160;&#160;&#160;In&#160;&#160;CHI&#160;&#160;&#160;'06:&#160;&#160;&#160;Proceedings&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;SIGCHI&#160;&#160;&#160;conference&#160;&#160;&#160;on&#160;<br/>Human&#160;Factors&#160;in&#160;computing&#160;systems,&#160;pages&#160;601-610,&#160;New&#160;York,&#160;NY,&#160;USA,&#160;2006.&#160;<br/>ACM.</p>
<p style="position:absolute;top:713px;left:85px;white-space:nowrap" class="ft10915">[70]&#160;&#160;&#160;Min&#160;&#160;&#160;Wu,&#160;&#160;&#160;Robert&#160;&#160;&#160;C.&#160;&#160;&#160;Miller,&#160;&#160;&#160;and&#160;&#160;&#160;Greg&#160;&#160;&#160;Little.&#160;&#160;&#160;Web&#160;&#160;&#160;wallet:&#160;&#160;&#160;preventing&#160;&#160;&#160;phishing&#160;<br/>attacks&#160;&#160;&#160;by&#160;&#160;&#160;revealing&#160;&#160;&#160;user&#160;&#160;&#160;intentions.&#160;&#160;&#160;In&#160;&#160;SOUPS&#160;&#160;&#160;'06:&#160;&#160;&#160;Proceedings&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;second&#160;<br/>symposium&#160;&#160;&#160;on&#160;&#160;&#160;Usable&#160;&#160;&#160;privacy&#160;&#160;&#160;and&#160;&#160;&#160;security,&#160;&#160;&#160;pages&#160;&#160;&#160;102-113,&#160;&#160;&#160;New&#160;&#160;&#160;York,&#160;&#160;&#160;NY,&#160;&#160;&#160;USA,&#160;<br/>2006.&#160;ACM.</p>
<p style="position:absolute;top:804px;left:85px;white-space:nowrap" class="ft10915">[71]&#160;&#160;&#160;E.&#160;&#160;&#160;Ye,&#160;&#160;&#160;Y.&#160;&#160;&#160;Yuan,&#160;&#160;&#160;and&#160;&#160;&#160;S.&#160;&#160;&#160;Smith.&#160;&#160;&#160;Web&#160;&#160;&#160;Spoofing&#160;&#160;&#160;Revisited:&#160;&#160;&#160;SSL&#160;&#160;&#160;and&#160;&#160;&#160;Beyond.&#160;<br/>Technical&#160;&#160;&#160;Report&#160;&#160;&#160;2002-417,&#160;&#160;&#160;Dartmouth&#160;&#160;&#160;College,&#160;&#160;&#160;Hanover,&#160;&#160;&#160;2002.&#160;</p>
<p style="position:absolute;top:843px;left:85px;white-space:nowrap" class="ft10966"><a href="http://www.cs.dartmouth.edu/~sws/pubs/TR2002-417.pdf">http://www.cs.dartmouth.edu/~sws/pubs/TR2002-417.pdf</a></p>
<p style="position:absolute;top:843px;left:568px;white-space:nowrap" class="ft10914"><a href="http://www.cs.dartmouth.edu/~sws/pubs/TR2002-417.pdf">.</a></p>
<p style="position:absolute;top:877px;left:85px;white-space:nowrap" class="ft10915">[72]&#160;Ka-Ping&#160;Yee&#160;and&#160;Kragen&#160;Sitaker.&#160;Passpet:&#160;convenient&#160;password&#160;management&#160;and&#160;<br/>phishing&#160;protection.&#160;In&#160;SOUPS&#160;'06:&#160;Proceedings&#160;of&#160;the&#160;second&#160;symposium&#160;on&#160;Usable&#160;<br/>privacy&#160;and&#160;security,&#160;pages&#160;32-43,&#160;New&#160;York,&#160;NY,&#160;USA,&#160;2006.&#160;ACM.</p>
<p style="position:absolute;top:950px;left:85px;white-space:nowrap" class="ft10915">[73]&#160;&#160;&#160;Zishuang&#160;&#160;&#160;(Eileen)&#160;&#160;&#160;Ye,&#160;&#160;&#160;Sean&#160;&#160;&#160;Smith,&#160;&#160;&#160;and&#160;&#160;&#160;Denise&#160;&#160;&#160;Anthony.&#160;&#160;&#160;Trusted&#160;&#160;&#160;paths&#160;&#160;&#160;for&#160;<br/>browsers.&#160;ACM&#160;Trans.&#160;Inf.&#160;Syst.&#160;Secur.,&#160;8(2):153-186,&#160;2005.</p>
<p style="position:absolute;top:1003px;left:85px;white-space:nowrap" class="ft10914">[74]</p>
<p style="position:absolute;top:1003px;left:138px;white-space:nowrap" class="ft10914">Infineon,&#160;Product&#160;Brief&#160;PMB&#160;8877,&#160;S-GOLD3,&#160;Turbo&#160;engine&#160;for&#160;EDGE-enabled&#160;</p>
<p style="position:absolute;top:1023px;left:85px;white-space:nowrap" class="ft10914">multimedia&#160;phones,<a href="http://www.infineon.com/mobilesolutions">&#160;</a></p>
<p style="position:absolute;top:1023px;left:255px;white-space:nowrap" class="ft10966"><a href="http://www.infineon.com/mobilesolutions">www.infineon.com/mobilesolutions</a></p>
<p style="position:absolute;top:1057px;left:85px;white-space:nowrap" class="ft10915">[75]&#160;Steven&#160;Bellovin.&#160;&#160;Security&#160;Problems&#160;in&#160;the&#160;TCP/IP&#160;Protocol&#160;Suite.&#160;In&#160;Computer&#160;<br/>Communications&#160;Review&#160;2:19,&#160;pp.&#160;32-48,&#160;1989.</p>
<p style="position:absolute;top:1160px;left:85px;white-space:nowrap" class="ft1097">Open_TC&#160;Deliverable&#160;D08.2</p>
<p style="position:absolute;top:1160px;left:746px;white-space:nowrap" class="ft1097">109/109</p>
</div>
<hr/>
<a name="outline"></a><h1>Document Outline</h1>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#5">1 Introduction</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#7">2 The Secure Wallet Use Case and Prototype</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#7">2.1Overview of the Secure Wallet</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#7">2.1.1Classical phishing&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#9">2.1.2Malware phishing&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#10">2.1.3Countering phishing&#160;</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#11">2.2Security Problem Definition&#160;</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#11">2.2.1Threats</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#12">2.2.2Assumptions&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#14">2.2.3Objectives</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#15">2.2.4Security Objective Rationale&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#16">2.2.5Requirements&#160;</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#18">2.3Related Work&#160;</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#18">2.3.1Client-based Phishing Countermeasures&#160;</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#18">Password Managers&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#19">Platforms &amp; Operating Systems&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#19">Virtualisation&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#19">Secure User Interfaces&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#20">Trusted Computing&#160;</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#20">2.3.2Server-based Phishing Countermeasures&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#20">2.3.3Proxy Components&#160;</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#21">2.4The General Secure Wallet Architecture&#160;</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#21">2.4.1Wallet Behavior&#160;</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#21">&#160;General Use&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#22">&#160;Web Site Setup&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#23">&#160;Password Change&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#23">&#160;Registration Forms&#160;</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#24">2.4.2Design and Architecture&#160;</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#24">Protection against Classical Phishing Attacks&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#24">Deny credential input into the browser&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#25">Change the user's passwords&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#25">&#160;Protection against Malware Phishing Attacks&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#25">Providing isolation&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#27">Trusted Path&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#27">Trusted Computing&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#28">Realization&#160;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#28">2.5Security Analysis&#160;</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#29">2.5.1Attacks&#160;</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#29">Attacks on U&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#30">Attacks on S&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#30">Attacks on P&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#30">&#160;Attacks on the channels&#160;</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#31">2.5.2Assumptions&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#31">2.5.3Protection against Classical Phishing Attacks&#160;</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#31">Fake Site Attack&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#32">&#160;Unlocked Password Forms&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#32">Redirection Attack&#160;</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#33">2.5.4Protection against Online Malware Phishing Attacks&#160;</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#33">Confinement to the Untrusted Compartment&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#34">&#160;Attacks against the Untrusted Compartment&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#36">Trusted Path&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#36">Configuration Modification&#160;</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#37">2.5.5Protection against Offline Attacks&#160;</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#37">General Attacks&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#37">Offline Malware Attacks&#160;</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#38">2.5.6Attacks on the Passwords&#160;</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#38">Common Password Attack&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#38">Dictionary attack without information&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#38">Dictionary attack with an old password&#160;</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#39">2.5.7Discussion&#160;</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#39">Assumptions&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#39">Metatag Approach&#160;</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#40">Password Knowledge&#160;</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#40">2.5.8Other Attacks&#160;</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#40">Transaction Generators&#160;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#40">2.6Architectural Overview&#160;</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#40">2.6.1Architecture on a PC</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#41">2.6.2 Storage Manager</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#45">2.6.3X-GOLDTM 208-Based Architecture</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#45">2.6.4Hybrid Architecture for Demo-Prototype</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#46">Communication between PC and X-GOLDTM 208 platform</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#47">2.7Porting and Test Concepts of the TPM emulator on X-GOLDTM 208</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#48">2.7.1Porting Concepts</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#50">2.7.2Implementation strategy</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#54">2.7.3Architecture</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#57">2.7.4Test Architecture</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#59">3 TCG Support for the Secure Wallet Prototype</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#59">3.1Requirements for a Robust Implementation of the Secure Wallet</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#59">3.1.1Secure Wallet Application Installation</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#59">3.1.2Secure Wallet Protocol Suite</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#60">3.1.2.1Starting the Secure Wallet</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#60">3.1.2.2Setting a User Passphrase</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#61">3.1.2.3Authenticating a User</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#62">3.1.2.4Changing a Passphrase</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#62">3.1.2.5Storing Sensitive Data</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#63">3.1.2.6Accessing Secure Storage</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#63">3.1.3Summary of Requirements</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#64">3.2Requirements Analysis</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#66">3.3TCG Mappings</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#66">3.3.1Revised Architectural Model</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#68">3.3.2Fundamental MTM command runs</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#68">3.3.2.1MTM Permanent Flags</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#69">3.3.2.2MTM Initialisation</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#69">3.3.2.3MTM Start-up</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#70">3.3.2.4MTM Self-testing</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#70">3.3.2.5Endorsement Key Generation</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#70">3.3.2.6Accessing a Public Endorsement Key</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#71">3.3.2.7Enabling an MTM</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#71">3.3.2.8The Ownership Flag</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#72">3.3.2.9Taking Ownership of an MTM</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#72">3.3.2.10MTM Activation</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#72">3.3.3Authenticated Boot Process</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#73">3.3.4Secure Boot Process</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#78">3.3.5Maintaining Integrity</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#80">3.3.6Secure Storage</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#80">3.3.6.1Key Hierarchy</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#80">3.3.6.2Installing Integrity and Confidentiality Sensitive Data</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#81">3.3.6.3Secure Storage of and Access Control to Sensitive Data</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#82">3.3.6.4Security of the Secure Wallet Sensitive Data While in Use</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#82">3.3.7Demonstrating Privilege</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#85">3.3.8Conclusions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#87">4 OMTP TR1 and the Secure Wallet Prototype</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#87">4.1OMTP TR1 Summary</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#87">4.1.1Security Enablers</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#89">4.1.2Threat Model</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#89">4.1.2.1Group 1 (Hardware Modules used for Accessing Memories)</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#89">4.1.2.2Group 2 (CLCD (Color LCD Controller) used for displaying memories and interfering with displayed data)</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#89">4.1.2.3Group 3 (Bypass security by removal of battery power or removal of external memory card)</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#90">4.1.2.4Group 4 (Attack by replacement of flash when power is off (pre-boot))</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#90">4.1.2.5Group 5 (Extract secret via bus monitoring)</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#90">4.1.2.6Group 6 (Mod chip attacks on data in external RAM)</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#90">4.1.2.7Group 7 (Attack by replacement of flash when power is on (post-boot))</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#90">4.1.2.8Software Threats</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#91">4.1.3TR1 Core Requirements</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#91">4.1.3.1Requirements to protect against software threats</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#91">4.1.3.2Requirements to protect against hardware threats</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#92">4.1.3.3Debug Requirements</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#92">4.1.3.4Cryptographic Requirements</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#92">4.1.4Asset Protection</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#92">4.1.5Trusted Execution Environment</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#93">4.1.5.1Open Trusted Execution Environment</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#93">4.1.5.2Trusted Execution Environment Requirements</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#94">4.1.6Use Case Overview</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#94">4.1.6.1Broadcast Service Protection</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#95">4.1.6.2Trusted Device Management</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#96">4.1.6.3Mobile Commerce</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#97">4.2Secure Wallet Architecture in the context of TR1</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#98">4.3Proposal of the final porting of the secure wallet to the X-GOLD 208</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#98">4.4Platform Integrity and Authenticity</a>
<ul>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#100">4.4.1Trusted Execution Environments</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#100">4.4.2Secure Storage</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#102">4.4.3Secure User IO</a></li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#102">4.4.4Software Threats</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#103">4.5Summary</a></li>
</ul>
</li>
<li><a href="OpenTC_D08.2_Security_Services_for_a_Trusted_Mobile_Application.html#104">5 Conclusions</a></li>
</ul>
</body>
</html>
