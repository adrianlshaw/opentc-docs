<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>html/Open_TC_D05.2_SecServicesPoC</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="generator" content="pdftohtml 0.36"/>
<meta name="date" content="2007-11-28T10:12:24+00:00"/>
<style type="text/css">
<!--
.xflip {
    -moz-transform: scaleX(-1);
    -webkit-transform: scaleX(-1);
    -o-transform: scaleX(-1);
    transform: scaleX(-1);
    filter: fliph;
}
.yflip {
    -moz-transform: scaleY(-1);
    -webkit-transform: scaleY(-1);
    -o-transform: scaleY(-1);
    transform: scaleY(-1);
    filter: flipv;
}
.xyflip {
    -moz-transform: scaleX(-1) scaleY(-1);
    -webkit-transform: scaleX(-1) scaleY(-1);
    -o-transform: scaleX(-1) scaleY(-1);
    transform: scaleX(-1) scaleY(-1);
    filter: fliph + flipv;
}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<!-- Page 1 -->
<a name="1"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft10{font-size:13px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
	.ft11{font-size:19px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
	.ft12{font-size:27px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
	.ft13{font-size:17px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
	.ft14{font-size:17px;font-family:DAAAAA+BitstreamVeraSans;color:#000000;}
	.ft15{font-size:10px;font-family:DAAAAA+BitstreamVeraSans;color:#000000;}
	.ft16{font-size:14px;font-family:BAAAAA+TimesNewRomanPSMT;color:#000000;}
	.ft17{font-size:17px;line-height:19px;font-family:DAAAAA+BitstreamVeraSans;color:#000000;}
	.ft18{font-size:17px;line-height:19px;font-family:CAAAAA+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page1-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC001.png" alt="background image"/>
<p style="position:absolute;top:137px;left:92px;white-space:nowrap" class="ft10">&#160;</p>
<p style="position:absolute;top:76px;left:91px;white-space:nowrap" class="ft11">&#160;</p>
<p style="position:absolute;top:242px;left:152px;white-space:nowrap" class="ft12"><b>D05.2&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;</b></p>
<p style="position:absolute;top:273px;left:382px;white-space:nowrap" class="ft12"><b>Services</b></p>
<p style="position:absolute;top:351px;left:91px;white-space:nowrap" class="ft13"><b>Project&#160;number</b></p>
<p style="position:absolute;top:351px;left:425px;white-space:nowrap" class="ft14">IST-027635</p>
<p style="position:absolute;top:376px;left:91px;white-space:nowrap" class="ft13"><b>Project&#160;acronym</b></p>
<p style="position:absolute;top:376px;left:425px;white-space:nowrap" class="ft14">Open_TC</p>
<p style="position:absolute;top:402px;left:91px;white-space:nowrap" class="ft13"><b>Project&#160;title</b></p>
<p style="position:absolute;top:402px;left:425px;white-space:nowrap" class="ft14">Open&#160;Trusted&#160;Computing</p>
<p style="position:absolute;top:427px;left:91px;white-space:nowrap" class="ft13"><b>Deliverable&#160;type</b></p>
<p style="position:absolute;top:427px;left:425px;white-space:nowrap" class="ft14">Report&#160;(see&#160;p&#160;84/85 Annex&#160;1 -&#160;Nature)</p>
<p style="position:absolute;top:470px;left:91px;white-space:nowrap" class="ft13"><b>Deliverable&#160;reference&#160;number</b></p>
<p style="position:absolute;top:470px;left:425px;white-space:nowrap" class="ft14">IST-027635/D05.2/Final</p>
<p style="position:absolute;top:496px;left:91px;white-space:nowrap" class="ft13"><b>Deliverable&#160;title</b></p>
<p style="position:absolute;top:496px;left:425px;white-space:nowrap" class="ft14">Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:521px;left:91px;white-space:nowrap" class="ft13"><b>WP&#160;contributing&#160;to&#160;the&#160;deliverable</b></p>
<p style="position:absolute;top:521px;left:425px;white-space:nowrap" class="ft14">WP05</p>
<p style="position:absolute;top:547px;left:91px;white-space:nowrap" class="ft13"><b>Due&#160;date</b></p>
<p style="position:absolute;top:547px;left:425px;white-space:nowrap" class="ft14">Oct&#160;2007 -&#160;M24</p>
<p style="position:absolute;top:572px;left:91px;white-space:nowrap" class="ft13"><b>Actual&#160;submission&#160;date</b></p>
<p style="position:absolute;top:572px;left:425px;white-space:nowrap" class="ft14">November&#160;23, 2007</p>
<p style="position:absolute;top:615px;left:91px;white-space:nowrap" class="ft13"><b>Responsible&#160;Organisation</b></p>
<p style="position:absolute;top:615px;left:424px;white-space:nowrap" class="ft14">IBM</p>
<p style="position:absolute;top:647px;left:91px;white-space:nowrap" class="ft13"><b>Authors</b></p>
<p style="position:absolute;top:638px;left:424px;white-space:nowrap" class="ft17">IBM&#160;(Matthias&#160;Schunter), KUL&#160;(Dries&#160;<br/>Schellekens)</p>
<p style="position:absolute;top:676px;left:91px;white-space:nowrap" class="ft13"><b>Abstract</b></p>
<p style="position:absolute;top:676px;left:424px;white-space:nowrap" class="ft17">This&#160;report&#160;describes&#160;the&#160;design&#160;of&#160;core&#160;<br/>components&#160;of&#160;the&#160;OpenTC&#160;2007&#160;<br/>demonstrator&#160;for&#160;“Corporate&#160;Computing&#160;at&#160;<br/>Home”. It&#160;is&#160;based&#160;on&#160;the&#160;research&#160;<br/>documented&#160;in&#160;Deliverable&#160;D05.1 &#34;Basic&#160;<br/>Security&#160;Services” and&#160;is&#160;accompanied&#160;by&#160;<br/>source&#160;code&#160;documented&#160;in&#160;Deliverable&#160;<br/>D05.3.</p>
<p style="position:absolute;top:908px;left:91px;white-space:nowrap" class="ft13"><b>Keywords</b></p>
<p style="position:absolute;top:889px;left:424px;white-space:nowrap" class="ft17">Security&#160;management, isolation&#160;policy, policy&#160;<br/>enforcement, corporate&#160;computing&#160;at&#160;home,&#160;<br/>2007 demonstrator</p>
<p style="position:absolute;top:967px;left:92px;white-space:nowrap" class="ft13"><b>Dissemination&#160;level</b></p>
<p style="position:absolute;top:967px;left:423px;white-space:nowrap" class="ft14">Public&#160;</p>
<p style="position:absolute;top:993px;left:92px;white-space:nowrap" class="ft13"><b>Revision</b></p>
<p style="position:absolute;top:993px;left:423px;white-space:nowrap" class="ft14">Final</p>
<p style="position:absolute;top:1044px;left:90px;white-space:nowrap" class="ft13"><b>Instrument</b></p>
<p style="position:absolute;top:1044px;left:271px;white-space:nowrap" class="ft14">IP</p>
<p style="position:absolute;top:1034px;left:452px;white-space:nowrap" class="ft18"><b>Start&#160;date&#160;of&#160;the&#160;<br/>project</b></p>
<p style="position:absolute;top:1044px;left:632px;white-space:nowrap" class="ft14">1</p>
<p style="position:absolute;top:1044px;left:643px;white-space:nowrap" class="ft15">st</p>
<p style="position:absolute;top:1044px;left:652px;white-space:nowrap" class="ft14">&#160;November&#160;2005</p>
<p style="position:absolute;top:1073px;left:90px;white-space:nowrap" class="ft13"><b>Thematic&#160;Priority</b></p>
<p style="position:absolute;top:1073px;left:271px;white-space:nowrap" class="ft14">IST</p>
<p style="position:absolute;top:1073px;left:452px;white-space:nowrap" class="ft13"><b>Duration</b></p>
<p style="position:absolute;top:1073px;left:632px;white-space:nowrap" class="ft14">42 months</p>
<p style="position:absolute;top:75px;left:674px;white-space:nowrap" class="ft16">&#160;</p>
</div>
<!-- Page 2 -->
<a name="2"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft29{font-size:26px;font-family:Helvetica;color:#231f20;}
	.ft210{font-size:21px;font-family:Helvetica;color:#231f20;}
	.ft211{font-size:15px;font-family:Times;color:#231f20;}
	.ft212{font-size:15px;line-height:18px;font-family:Times;color:#231f20;}
	.ft213{font-size:15px;line-height:17px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page2-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC002.png" alt="background image"/>
<p style="position:absolute;top:189px;left:345px;white-space:nowrap" class="ft29"><b>A</b></p>
<p style="position:absolute;top:193px;left:365px;white-space:nowrap" class="ft210"><b>BSTRACT</b></p>
<p style="position:absolute;top:230px;left:150px;white-space:nowrap" class="ft213">This&#160;report&#160;describes&#160;the&#160;design&#160;of&#160;core&#160;components&#160;of&#160;the&#160;OpenTC&#160;2007&#160;demonstra-<br/>tor&#160;for&#160;“Corporate&#160;Computing&#160;at&#160;Home”.&#160;It&#160;is&#160;based&#160;on&#160;the&#160;research&#160;documented&#160;in<br/>Deliverable&#160;D05.1&#160;&#34;Basic&#160;Security&#160;Services”&#160;and&#160;is&#160;accompanied&#160;by&#160;source&#160;code&#160;doc-<br/>umented&#160;in&#160;Deliverable&#160;D05.3.</p>
<p style="position:absolute;top:302px;left:172px;white-space:nowrap" class="ft211">The&#160;goal&#160;of&#160;this&#160;deliverable&#160;is&#160;to&#160;describe&#160;and&#160;explain&#160;the&#160;actual&#160;design&#160;and&#160;im-</p>
<p style="position:absolute;top:320px;left:150px;white-space:nowrap" class="ft213">plementation&#160;of&#160;our&#160;demonstrator.&#160;A&#160;particular&#160;focus&#160;of&#160;this&#160;deliverable&#160;is&#160;how&#160;we<br/>addressed&#160;the&#160;security&#160;challenges&#160;of&#160;the&#160;the&#160;given&#160;scenario&#160;“Corporate&#160;Computing&#160;at<br/>Home”.&#160;Nevertheless,&#160;most&#160;chapters&#160;describe&#160;infrastructure&#160;that&#160;goes&#160;beyond&#160;the&#160;par-<br/>ticular&#160;needs&#160;of&#160;this&#160;demonstrator.</p>
<p style="position:absolute;top:401px;left:278px;white-space:nowrap" class="ft29"><b>A</b></p>
<p style="position:absolute;top:405px;left:297px;white-space:nowrap" class="ft210"><b>CKNOWLEDGEMENTS</b></p>
<p style="position:absolute;top:442px;left:150px;white-space:nowrap" class="ft212">The&#160;following&#160;people&#160;were&#160;the&#160;main&#160;contributors&#160;to&#160;this&#160;report&#160;(alphabetically&#160;by&#160;or-<br/>ganisation):&#160;Soeren&#160;Bleikertz,&#160;Serdar&#160;Cabuk,&#160;Philipp&#160;Grete&#160;(HP&#160;Labs,&#160;Bristol);&#160;Kon-<br/>rad&#160;Eriksson,&#160;Augustin&#160;Fievet,&#160;Bernhard&#160;Jansen,&#160;HariGovind&#160;Ramasamy,&#160;Matthias<br/>Schunter&#160;(IBM&#160;Research,&#160;Rüschlikon);&#160;Rainer&#160;Landfermann,&#160;Hans&#160;Löhr,&#160;Ahmad-<br/>Reza&#160;Sadeghi,&#160;Michael&#160;Scheibel,&#160;Stefan&#160;Schulz,&#160;Patrick&#160;Stewin,&#160;Christian&#160;Stüble,&#160;Mar-<br/>tin&#160;Unger,&#160;Marko&#160;Wolf&#160;(Ruhr&#160;University,&#160;Bochum).</p>
<p style="position:absolute;top:550px;left:172px;white-space:nowrap" class="ft211">We&#160;would&#160;like&#160;to&#160;thank&#160;our&#160;reviewer&#160;Dries&#160;Schellekens&#160;from&#160;Katholieke&#160;Univer-</p>
<p style="position:absolute;top:568px;left:150px;white-space:nowrap" class="ft213">siteit&#160;Leuven&#160;for&#160;substantial&#160;feedback&#160;after&#160;a&#160;thorough&#160;review.&#160;Furthermore,&#160;we&#160;would<br/>like&#160;to&#160;thank&#160;the&#160;other&#160;members&#160;of&#160;the&#160;OpenTC&#160;project&#160;for&#160;helpful&#160;discussions&#160;and<br/>valuable&#160;contributions&#160;to&#160;the&#160;research&#160;that&#160;is&#160;documented&#160;in&#160;this&#160;report.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft211">2</p>
</div>
<!-- Page 3 -->
<a name="3"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft314{font-size:26px;font-family:Times;color:#231f20;}
	.ft315{font-size:18px;font-family:Times;color:#231f20;}
	.ft316{font-size:12px;font-family:Times;color:#231f20;}
	.ft317{font-size:15px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page3-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC003.png" alt="background image"/>
<p style="position:absolute;top:508px;left:269px;white-space:nowrap" class="ft314">Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:580px;left:391px;white-space:nowrap" class="ft315">OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:577px;left:570px;white-space:nowrap" class="ft316">1</p>
<p style="position:absolute;top:622px;left:402px;white-space:nowrap" class="ft317"><i>OpenTC&#160;</i>Deliverable&#160;D05.2</p>
<p style="position:absolute;top:640px;left:331px;white-space:nowrap" class="ft311">V01&#160;–&#160;Final&#160;Revision.&#160;4948&#160;(OpenTC&#160;Public&#160;(PU))</p>
<p style="position:absolute;top:658px;left:450px;white-space:nowrap" class="ft311">2007/11/23</p>
</div>
<!-- Page 4 -->
<a name="4"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft418{font-size:15px;font-family:Helvetica;color:#231f20;}
-->
</style>
<div id="page4-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC004.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft411">2</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft418">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft418">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 5 -->
<a name="5"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft519{font-size:37px;font-family:Times;color:#231f20;}
	.ft520{font-size:15px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page5-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC005.png" alt="background image"/>
<p style="position:absolute;top:298px;left:226px;white-space:nowrap" class="ft519"><b>Contents</b></p>
<p style="position:absolute;top:406px;left:226px;white-space:nowrap" class="ft520"><a href="Open_TC_D05.2_SecServicesPoC.html#7"><b>1</b></a></p>
<p style="position:absolute;top:406px;left:248px;white-space:nowrap" class="ft520"><a href="Open_TC_D05.2_SecServicesPoC.html#7"><b>Corporate&#160;Computing&#160;at&#160;Home&#160;Scenario&#160;Analysis</b></a></p>
<p style="position:absolute;top:406px;left:734px;white-space:nowrap" class="ft520"><b>5</b></p>
<p style="position:absolute;top:424px;left:248px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#7">1.1</a></p>
<p style="position:absolute;top:424px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#7">Basic&#160;Setting&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:424px;left:734px;white-space:nowrap" class="ft511">5</p>
<p style="position:absolute;top:442px;left:248px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#8">1.2</a></p>
<p style="position:absolute;top:442px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#8">Threats</a></p>
<p style="position:absolute;top:442px;left:342px;white-space:nowrap" class="ft511">.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:442px;left:734px;white-space:nowrap" class="ft511">6</p>
<p style="position:absolute;top:475px;left:226px;white-space:nowrap" class="ft520"><a href="Open_TC_D05.2_SecServicesPoC.html#10"><b>2</b></a></p>
<p style="position:absolute;top:475px;left:248px;white-space:nowrap" class="ft520"><a href="Open_TC_D05.2_SecServicesPoC.html#10"><b>Xen&#160;Security&#160;Services</b></a></p>
<p style="position:absolute;top:475px;left:734px;white-space:nowrap" class="ft520"><b>8</b></p>
<p style="position:absolute;top:493px;left:248px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#10">2.1</a></p>
<p style="position:absolute;top:493px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#10">Xen&#160;Security&#160;Services&#160;Overview&#160;and&#160;Implementation&#160;Status</a></p>
<p style="position:absolute;top:493px;left:656px;white-space:nowrap" class="ft511">.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:493px;left:734px;white-space:nowrap" class="ft511">8</p>
<p style="position:absolute;top:510px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#10">2.1.1</a></p>
<p style="position:absolute;top:510px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#10">Overview&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:510px;left:734px;white-space:nowrap" class="ft511">8</p>
<p style="position:absolute;top:528px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#11">2.1.2</a></p>
<p style="position:absolute;top:528px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#11">TVD&#160;network&#160;infrastructure&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:528px;left:734px;white-space:nowrap" class="ft511">9</p>
<p style="position:absolute;top:546px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#12">2.1.3</a></p>
<p style="position:absolute;top:546px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#12">Bridge&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:546px;left:727px;white-space:nowrap" class="ft511">10</p>
<p style="position:absolute;top:564px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#12">2.1.4</a></p>
<p style="position:absolute;top:564px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#12">Virtual&#160;Private&#160;Network</a></p>
<p style="position:absolute;top:564px;left:488px;white-space:nowrap" class="ft511">.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:564px;left:727px;white-space:nowrap" class="ft511">10</p>
<p style="position:absolute;top:582px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#12">2.1.5</a></p>
<p style="position:absolute;top:582px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#12">VM&#160;admission&#160;control&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:582px;left:727px;white-space:nowrap" class="ft511">10</p>
<p style="position:absolute;top:600px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#15">2.1.6</a></p>
<p style="position:absolute;top:600px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#15">Summary&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:600px;left:727px;white-space:nowrap" class="ft511">13</p>
<p style="position:absolute;top:618px;left:248px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#16">2.2</a></p>
<p style="position:absolute;top:618px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#16">Xen&#160;Virtual&#160;Networking&#160;Devices&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:618px;left:727px;white-space:nowrap" class="ft511">14</p>
<p style="position:absolute;top:636px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#16">2.2.1</a></p>
<p style="position:absolute;top:636px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#16">Overview&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:636px;left:727px;white-space:nowrap" class="ft511">14</p>
<p style="position:absolute;top:654px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#17">2.2.2</a></p>
<p style="position:absolute;top:654px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#17">Background&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:654px;left:727px;white-space:nowrap" class="ft511">15</p>
<p style="position:absolute;top:672px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#18">2.2.3</a></p>
<p style="position:absolute;top:672px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#18">Virtual&#160;Switch</a></p>
<p style="position:absolute;top:672px;left:431px;white-space:nowrap" class="ft511">.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:672px;left:727px;white-space:nowrap" class="ft511">16</p>
<p style="position:absolute;top:690px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#19">2.2.4</a></p>
<p style="position:absolute;top:690px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#19">Linux&#160;Dom0&#160;Prototype&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:690px;left:727px;white-space:nowrap" class="ft511">17</p>
<p style="position:absolute;top:708px;left:248px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#21">2.3</a></p>
<p style="position:absolute;top:708px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#21">Management&#160;of&#160;Trusted&#160;Virtual&#160;Networking&#160;Domains&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:708px;left:727px;white-space:nowrap" class="ft511">19</p>
<p style="position:absolute;top:726px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#24">2.3.1</a></p>
<p style="position:absolute;top:726px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#24">Auto-deployment&#160;of&#160;TVDs&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:726px;left:727px;white-space:nowrap" class="ft511">22</p>
<p style="position:absolute;top:744px;left:248px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#28">2.4</a></p>
<p style="position:absolute;top:744px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#28">Xen&#160;Hierarchical&#160;Integrity&#160;Management&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:744px;left:727px;white-space:nowrap" class="ft511">26</p>
<p style="position:absolute;top:761px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#28">2.4.1</a></p>
<p style="position:absolute;top:761px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#28">Our&#160;Solution&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:761px;left:727px;white-space:nowrap" class="ft511">26</p>
<p style="position:absolute;top:779px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#30">2.4.2</a></p>
<p style="position:absolute;top:779px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#30">Use&#160;Cases&#160;for&#160;Dynamic&#160;Registers&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:779px;left:727px;white-space:nowrap" class="ft511">28</p>
<p style="position:absolute;top:797px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#31">2.4.3</a></p>
<p style="position:absolute;top:797px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#31">Conclusion&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:797px;left:727px;white-space:nowrap" class="ft511">29</p>
<p style="position:absolute;top:815px;left:248px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#31">2.5</a></p>
<p style="position:absolute;top:815px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#31">Xen&#160;Cross-resource&#160;Policy&#160;Validation&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:815px;left:727px;white-space:nowrap" class="ft511">29</p>
<p style="position:absolute;top:833px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#31">2.5.1</a></p>
<p style="position:absolute;top:833px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#31">Introduction&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:833px;left:727px;white-space:nowrap" class="ft511">29</p>
<p style="position:absolute;top:851px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#32">2.5.2</a></p>
<p style="position:absolute;top:851px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#32">Formal&#160;Integrity&#160;Model&#160;for&#160;Virtual&#160;Machines&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:851px;left:727px;white-space:nowrap" class="ft511">30</p>
<p style="position:absolute;top:869px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#36">2.5.3</a></p>
<p style="position:absolute;top:869px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#36">The&#160;PEV&#160;Integrity&#160;Architecture&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:869px;left:727px;white-space:nowrap" class="ft511">34</p>
<p style="position:absolute;top:887px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#39">2.5.4</a></p>
<p style="position:absolute;top:887px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#39">Realisation&#160;using&#160;Xen&#160;and&#160;Linux&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:887px;left:727px;white-space:nowrap" class="ft511">37</p>
<p style="position:absolute;top:905px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#41">2.5.5</a></p>
<p style="position:absolute;top:905px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#41">Use&#160;Cases&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:905px;left:727px;white-space:nowrap" class="ft511">39</p>
<p style="position:absolute;top:923px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#46">2.5.6</a></p>
<p style="position:absolute;top:923px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#46">Conclusion&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:923px;left:727px;white-space:nowrap" class="ft511">44</p>
<p style="position:absolute;top:941px;left:248px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#47">2.6</a></p>
<p style="position:absolute;top:941px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#47">Xen&#160;Secure&#160;GUI&#160;Services&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:941px;left:727px;white-space:nowrap" class="ft511">45</p>
<p style="position:absolute;top:959px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#47">2.6.1</a></p>
<p style="position:absolute;top:959px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#47">An&#160;Example&#160;Secure&#160;GUI&#160;Use&#160;Case</a></p>
<p style="position:absolute;top:959px;left:555px;white-space:nowrap" class="ft511">.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:959px;left:727px;white-space:nowrap" class="ft511">45</p>
<p style="position:absolute;top:977px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#47">2.6.2</a></p>
<p style="position:absolute;top:977px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#47">Current&#160;State&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:977px;left:727px;white-space:nowrap" class="ft511">45</p>
<p style="position:absolute;top:995px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#48">2.6.3</a></p>
<p style="position:absolute;top:995px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#48">Prototype&#160;Design&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:995px;left:727px;white-space:nowrap" class="ft511">46</p>
<p style="position:absolute;top:1013px;left:283px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#51">2.6.4</a></p>
<p style="position:absolute;top:1013px;left:331px;white-space:nowrap" class="ft511"><a href="Open_TC_D05.2_SecServicesPoC.html#51">Conclusion&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:1013px;left:727px;white-space:nowrap" class="ft511">49</p>
<p style="position:absolute;top:1117px;left:480px;white-space:nowrap" class="ft511">3</p>
</div>
<!-- Page 6 -->
<a name="6"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page6-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC006.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft611">4</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft618">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft620"><a href="Open_TC_D05.2_SecServicesPoC.html#52"><b>3</b></a></p>
<p style="position:absolute;top:194px;left:172px;white-space:nowrap" class="ft620"><a href="Open_TC_D05.2_SecServicesPoC.html#52"><b>L4&#160;Security&#160;Services</b></a></p>
<p style="position:absolute;top:194px;left:651px;white-space:nowrap" class="ft620"><b>50</b></p>
<p style="position:absolute;top:212px;left:172px;white-space:nowrap" class="ft611"><a href="Open_TC_D05.2_SecServicesPoC.html#52">3.1</a></p>
<p style="position:absolute;top:212px;left:207px;white-space:nowrap" class="ft611"><a href="Open_TC_D05.2_SecServicesPoC.html#52">Introduction&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:212px;left:651px;white-space:nowrap" class="ft611">50</p>
<p style="position:absolute;top:230px;left:207px;white-space:nowrap" class="ft611"><a href="Open_TC_D05.2_SecServicesPoC.html#52">3.1.1</a></p>
<p style="position:absolute;top:230px;left:255px;white-space:nowrap" class="ft611"><a href="Open_TC_D05.2_SecServicesPoC.html#52">Basic&#160;Concepts&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:230px;left:651px;white-space:nowrap" class="ft611">50</p>
<p style="position:absolute;top:247px;left:207px;white-space:nowrap" class="ft611"><a href="Open_TC_D05.2_SecServicesPoC.html#55">3.1.2</a></p>
<p style="position:absolute;top:247px;left:255px;white-space:nowrap" class="ft611"><a href="Open_TC_D05.2_SecServicesPoC.html#55">Implementation&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:247px;left:651px;white-space:nowrap" class="ft611">53</p>
<p style="position:absolute;top:265px;left:207px;white-space:nowrap" class="ft611"><a href="Open_TC_D05.2_SecServicesPoC.html#62">3.1.3</a></p>
<p style="position:absolute;top:265px;left:255px;white-space:nowrap" class="ft611"><a href="Open_TC_D05.2_SecServicesPoC.html#62">Secure&#160;Virtual&#160;Private&#160;Network</a></p>
<p style="position:absolute;top:265px;left:456px;white-space:nowrap" class="ft611">.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:265px;left:651px;white-space:nowrap" class="ft611">60</p>
<p style="position:absolute;top:283px;left:172px;white-space:nowrap" class="ft611"><a href="Open_TC_D05.2_SecServicesPoC.html#65">3.2</a></p>
<p style="position:absolute;top:283px;left:207px;white-space:nowrap" class="ft611"><a href="Open_TC_D05.2_SecServicesPoC.html#65">Security&#160;Considerations&#160;for&#160;the&#160;CC@H&#160;Scenario&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:283px;left:651px;white-space:nowrap" class="ft611">63</p>
<p style="position:absolute;top:301px;left:207px;white-space:nowrap" class="ft611"><a href="Open_TC_D05.2_SecServicesPoC.html#65">3.2.1</a></p>
<p style="position:absolute;top:301px;left:255px;white-space:nowrap" class="ft611"><a href="Open_TC_D05.2_SecServicesPoC.html#65">Basic&#160;Security&#160;Concepts&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:301px;left:651px;white-space:nowrap" class="ft611">63</p>
<p style="position:absolute;top:319px;left:207px;white-space:nowrap" class="ft611"><a href="Open_TC_D05.2_SecServicesPoC.html#66">3.2.2</a></p>
<p style="position:absolute;top:319px;left:255px;white-space:nowrap" class="ft611"><a href="Open_TC_D05.2_SecServicesPoC.html#66">Facing&#160;Threats&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:319px;left:651px;white-space:nowrap" class="ft611">64</p>
<p style="position:absolute;top:352px;left:150px;white-space:nowrap" class="ft620"><a href="Open_TC_D05.2_SecServicesPoC.html#68"><b>Bibliography</b></a></p>
<p style="position:absolute;top:352px;left:651px;white-space:nowrap" class="ft620"><b>67</b></p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft618">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 7 -->
<a name="7"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft721{font-size:31px;font-family:Times;color:#231f20;}
	.ft722{font-size:22px;font-family:Times;color:#231f20;}
	.ft723{font-size:37px;line-height:44px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page7-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC007.png" alt="background image"/>
<p style="position:absolute;top:295px;left:226px;white-space:nowrap" class="ft721"><b>Chapter&#160;1</b></p>
<p style="position:absolute;top:365px;left:226px;white-space:nowrap" class="ft723"><b>Corporate&#160;Computing&#160;at&#160;Home<br/>Scenario&#160;Analysis</b></p>
<p style="position:absolute;top:467px;left:640px;white-space:nowrap" class="ft711">M.&#160;Unger&#160;(RUB)</p>
<p style="position:absolute;top:500px;left:248px;white-space:nowrap" class="ft711">This&#160;chapter&#160;presents&#160;the&#160;security&#160;requirements&#160;of&#160;the&#160;Corporate&#160;Computing&#160;at</p>
<p style="position:absolute;top:518px;left:226px;white-space:nowrap" class="ft712">Home&#160;(CC@H)&#160;scenario&#160;from&#160;a&#160;security&#160;infrastructure&#160;perspective.&#160;The&#160;corresponding<br/>prototype&#160;will&#160;be&#160;presented&#160;at&#160;the&#160;2007&#160;project&#160;review&#160;meeting.</p>
<p style="position:absolute;top:600px;left:226px;white-space:nowrap" class="ft722"><b>1.1</b></p>
<p style="position:absolute;top:600px;left:274px;white-space:nowrap" class="ft722"><b>Basic&#160;Setting</b></p>
<p style="position:absolute;top:638px;left:226px;white-space:nowrap" class="ft712">The&#160;background&#160;of&#160;corporate&#160;computing&#160;at&#160;home&#160;is&#160;that&#160;employees&#160;often&#160;have&#160;more<br/>powerful&#160;computers&#160;at&#160;home&#160;as&#160;compared&#160;to&#160;the&#160;office.&#160;Furthermore,&#160;computing&#160;is<br/>ubiquitous&#160;and&#160;employees&#160;get&#160;increasingly&#160;mobile.&#160;As&#160;a&#160;consequence,&#160;it&#160;would&#160;be<br/>desirable&#160;to&#160;perform&#160;potentially&#160;confidential&#160;corporate&#160;tasks&#160;on&#160;arbitrary&#160;computers.<br/>The&#160;envisioned&#160;main&#160;usage&#160;is&#160;to&#160;expand&#160;the&#160;corporate&#160;network&#160;to&#160;a&#160;home&#160;computer<br/>such&#160;that&#160;the&#160;home&#160;computer&#160;is&#160;guaranteed&#160;to&#160;enforce&#160;corporate&#160;policies.</p>
<p style="position:absolute;top:745px;left:248px;white-space:nowrap" class="ft711">Within&#160;the&#160;CC@H&#160;demonstrator&#160;an&#160;employee&#160;has&#160;to&#160;be&#160;able&#160;to&#160;work&#160;at&#160;home&#160;using</p>
<p style="position:absolute;top:763px;left:226px;white-space:nowrap" class="ft713">his&#160;own&#160;computer&#160;and&#160;to&#160;access,&#160;e.g.,&#160;the&#160;company’s&#160;intranet&#160;(see&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#8">1.1)</a>.&#160;For<br/>that&#160;purpose&#160;a&#160;special,&#160;trusted&#160;corporate&#160;compartment&#160;runs&#160;on&#160;top&#160;of&#160;a&#160;virtualisation<br/>layer&#160;on&#160;the&#160;employee’s&#160;computer.&#160;This&#160;compartment&#160;has&#160;to&#160;be&#160;secure&#160;against&#160;certain<br/>attacks&#160;(see&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#8">1.2)&#160;</a>and&#160;fully&#160;independent&#160;of&#160;OSes&#160;or&#160;applications&#160;running&#160;in&#160;parallel&#160;on<br/>the&#160;virtualisation&#160;layer.&#160;The&#160;virtualisation&#160;layer&#160;either&#160;consists&#160;of&#160;the&#160;Xen&#160;hypervisor<br/>and&#160;its&#160;security&#160;services&#160;or&#160;the&#160;L4&#160;microkernel&#160;and&#160;security&#160;services.</p>
<p style="position:absolute;top:871px;left:248px;white-space:nowrap" class="ft711">The&#160;corporate&#160;compartment&#160;has&#160;to&#160;be&#160;able&#160;to&#160;set&#160;up&#160;a&#160;secure&#160;connection&#160;between</p>
<p style="position:absolute;top:889px;left:226px;white-space:nowrap" class="ft712">itself&#160;and&#160;a&#160;server&#160;of&#160;the&#160;company,&#160;e.g.,&#160;a&#160;VPN&#160;gateway.&#160;While&#160;setting&#160;up&#160;this&#160;secure<br/>connection,&#160;attestation&#160;is&#160;done&#160;to&#160;ensure&#160;that&#160;the&#160;client’s&#160;corporate&#160;compartment&#160;run-<br/>ning&#160;on&#160;the&#160;employee’s&#160;computer&#160;is&#160;in&#160;a&#160;proper&#160;state&#160;and&#160;can&#160;be&#160;given&#160;allowance&#160;to<br/>connect&#160;to&#160;the&#160;company’s&#160;intranet.</p>
<p style="position:absolute;top:960px;left:248px;white-space:nowrap" class="ft711">On&#160;the&#160;server-side&#160;no&#160;special&#160;virtualisation&#160;techniques&#160;are&#160;used&#160;in&#160;this&#160;prototype</p>
<p style="position:absolute;top:978px;left:226px;white-space:nowrap" class="ft713">scenario.&#160;But&#160;of&#160;course&#160;mechanisms&#160;to&#160;verify&#160;the&#160;client’s&#160;state&#160;and&#160;to&#160;mediate&#160;access<br/>according&#160;to&#160;the&#160;results&#160;of&#160;this&#160;verification&#160;have&#160;to&#160;be&#160;in&#160;place.</p>
<p style="position:absolute;top:1014px;left:248px;white-space:nowrap" class="ft711">In&#160;the&#160;following&#160;section&#160;we&#160;enlist&#160;the&#160;possible&#160;threats&#160;that&#160;have&#160;to&#160;be&#160;countered&#160;by</p>
<p style="position:absolute;top:1032px;left:226px;white-space:nowrap" class="ft713">the&#160;security&#160;services.&#160;How&#160;this&#160;is&#160;done&#160;is&#160;described&#160;within&#160;the&#160;security&#160;considerations<br/>sections&#160;of&#160;the&#160;Xen&#160;(see&#160;chapter&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#10">2)&#160;</a>or&#160;L4&#160;security&#160;services&#160;(cf.&#160;chapter&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#52">3)</a>,&#160;respectively.</p>
<p style="position:absolute;top:1117px;left:480px;white-space:nowrap" class="ft711">5</p>
</div>
<!-- Page 8 -->
<a name="8"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft824{font-size:10px;font-family:Helvetica;color:#ffffff;}
	.ft825{font-size:10px;font-family:Helvetica;color:#000000;}
	.ft826{font-size:10px;font-family:Helvetica;color:#ffffff;}
	.ft827{font-size:10px;font-family:Helvetica;color:#000000;-moz-transform: matrix(         0,          1, -0.9997700529,          0, 0, 0);-webkit-transform: matrix(         0,          1, -0.9997700529,          0, 0, 0);-o-transform: matrix(         0,          1, -0.9997700529,          0, 0, 0);-ms-transform: matrix(         0,          1, -0.9997700529,          0, 0, 0);-moz-transform-origin: left 75%;-webkit-transform-origin: left 75%;-o-transform-origin: left 75%;-ms-transform-origin: left 75%;}
	.ft828{font-size:10px;font-family:Helvetica;color:#ffffff;-moz-transform: matrix(         0,          1, -0.9997700529,          0, 0, 0);-webkit-transform: matrix(         0,          1, -0.9997700529,          0, 0, 0);-o-transform: matrix(         0,          1, -0.9997700529,          0, 0, 0);-ms-transform: matrix(         0,          1, -0.9997700529,          0, 0, 0);-moz-transform-origin: left 75%;-webkit-transform-origin: left 75%;-o-transform-origin: left 75%;-ms-transform-origin: left 75%;}
	.ft829{font-size:10px;font-family:Times;color:#231f20;}
	.ft830{font-size:15px;font-family:LIXFZR+CMSY10;color:#231f20;}
	.ft831{font-size:9px;font-family:Times;color:#231f20;}
	.ft832{font-size:10px;line-height:11px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page8-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC008.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft811">6</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft818">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:304px;left:379px;white-space:nowrap" class="ft824"><b>Hypervisor</b></p>
<p style="position:absolute;top:278px;left:202px;white-space:nowrap" class="ft825">Internet&#160;+&#160;Game&#160;overlay&#160;network</p>
<p style="position:absolute;top:278px;left:497px;white-space:nowrap" class="ft826">Corporate&#160;network</p>
<p style="position:absolute;top:229px;left:367px;white-space:nowrap" class="ft827">P</p>
<p style="position:absolute;top:235px;left:367px;white-space:nowrap" class="ft827">e</p>
<p style="position:absolute;top:241px;left:367px;white-space:nowrap" class="ft827">rs</p>
<p style="position:absolute;top:248px;left:367px;white-space:nowrap" class="ft827">o</p>
<p style="position:absolute;top:254px;left:367px;white-space:nowrap" class="ft827">n</p>
<p style="position:absolute;top:259px;left:367px;white-space:nowrap" class="ft827">a</p>
<p style="position:absolute;top:264px;left:367px;white-space:nowrap" class="ft827">l</p>
<p style="position:absolute;top:227px;left:355px;white-space:nowrap" class="ft827">M</p>
<p style="position:absolute;top:235px;left:355px;white-space:nowrap" class="ft827">a</p>
<p style="position:absolute;top:241px;left:355px;white-space:nowrap" class="ft827">c</p>
<p style="position:absolute;top:245px;left:355px;white-space:nowrap" class="ft827">h</p>
<p style="position:absolute;top:251px;left:355px;white-space:nowrap" class="ft827">in</p>
<p style="position:absolute;top:258px;left:355px;white-space:nowrap" class="ft827">e</p>
<p style="position:absolute;top:263px;left:355px;white-space:nowrap" class="ft827">s</p>
<p style="position:absolute;top:237px;left:375px;white-space:nowrap" class="ft827">P</p>
<p style="position:absolute;top:243px;left:375px;white-space:nowrap" class="ft827">e</p>
<p style="position:absolute;top:249px;left:375px;white-space:nowrap" class="ft827">rs</p>
<p style="position:absolute;top:257px;left:375px;white-space:nowrap" class="ft827">o</p>
<p style="position:absolute;top:262px;left:375px;white-space:nowrap" class="ft827">n</p>
<p style="position:absolute;top:267px;left:375px;white-space:nowrap" class="ft827">a</p>
<p style="position:absolute;top:272px;left:375px;white-space:nowrap" class="ft827">l</p>
<p style="position:absolute;top:235px;left:364px;white-space:nowrap" class="ft827">M</p>
<p style="position:absolute;top:243px;left:364px;white-space:nowrap" class="ft827">a</p>
<p style="position:absolute;top:249px;left:364px;white-space:nowrap" class="ft827">c</p>
<p style="position:absolute;top:253px;left:364px;white-space:nowrap" class="ft827">h</p>
<p style="position:absolute;top:259px;left:364px;white-space:nowrap" class="ft827">in</p>
<p style="position:absolute;top:266px;left:364px;white-space:nowrap" class="ft827">e</p>
<p style="position:absolute;top:271px;left:364px;white-space:nowrap" class="ft827">s</p>
<p style="position:absolute;top:229px;left:424px;white-space:nowrap" class="ft827">P</p>
<p style="position:absolute;top:235px;left:424px;white-space:nowrap" class="ft827">e</p>
<p style="position:absolute;top:241px;left:424px;white-space:nowrap" class="ft827">rs</p>
<p style="position:absolute;top:248px;left:424px;white-space:nowrap" class="ft827">o</p>
<p style="position:absolute;top:254px;left:424px;white-space:nowrap" class="ft827">n</p>
<p style="position:absolute;top:259px;left:424px;white-space:nowrap" class="ft827">a</p>
<p style="position:absolute;top:264px;left:424px;white-space:nowrap" class="ft827">l</p>
<p style="position:absolute;top:227px;left:413px;white-space:nowrap" class="ft827">M</p>
<p style="position:absolute;top:235px;left:413px;white-space:nowrap" class="ft827">a</p>
<p style="position:absolute;top:241px;left:413px;white-space:nowrap" class="ft827">c</p>
<p style="position:absolute;top:245px;left:413px;white-space:nowrap" class="ft827">h</p>
<p style="position:absolute;top:251px;left:413px;white-space:nowrap" class="ft827">in</p>
<p style="position:absolute;top:258px;left:413px;white-space:nowrap" class="ft827">e</p>
<p style="position:absolute;top:263px;left:413px;white-space:nowrap" class="ft827">s</p>
<p style="position:absolute;top:235px;left:432px;white-space:nowrap" class="ft828">C</p>
<p style="position:absolute;top:242px;left:432px;white-space:nowrap" class="ft828">o</p>
<p style="position:absolute;top:247px;left:432px;white-space:nowrap" class="ft828">rp</p>
<p style="position:absolute;top:255px;left:432px;white-space:nowrap" class="ft828">o</p>
<p style="position:absolute;top:261px;left:432px;white-space:nowrap" class="ft828">ra</p>
<p style="position:absolute;top:269px;left:432px;white-space:nowrap" class="ft828">te</p>
<p style="position:absolute;top:235px;left:421px;white-space:nowrap" class="ft828">M</p>
<p style="position:absolute;top:243px;left:421px;white-space:nowrap" class="ft828">a</p>
<p style="position:absolute;top:249px;left:421px;white-space:nowrap" class="ft828">c</p>
<p style="position:absolute;top:253px;left:421px;white-space:nowrap" class="ft828">h</p>
<p style="position:absolute;top:259px;left:421px;white-space:nowrap" class="ft828">in</p>
<p style="position:absolute;top:266px;left:421px;white-space:nowrap" class="ft828">e</p>
<p style="position:absolute;top:271px;left:421px;white-space:nowrap" class="ft828">s</p>
<p style="position:absolute;top:194px;left:361px;white-space:nowrap" class="ft824"><b>Resource&#160;Isolating</b></p>
<p style="position:absolute;top:239px;left:531px;white-space:nowrap" class="ft832">Corporate<br/>Trusted&#160;Virtual&#160;Domain</p>
<p style="position:absolute;top:251px;left:213px;white-space:nowrap" class="ft825">Internet</p>
<p style="position:absolute;top:367px;left:150px;white-space:nowrap" class="ft812">Figure&#160;1.1:&#160;Basic&#160;Setting:&#160;Corporate&#160;and&#160;game&#160;computers&#160;hosted&#160;on&#160;a&#160;single&#160;home<br/>computer.</p>
<p style="position:absolute;top:429px;left:150px;white-space:nowrap" class="ft822"><b>1.2</b></p>
<p style="position:absolute;top:429px;left:198px;white-space:nowrap" class="ft822"><b>Threats</b></p>
<p style="position:absolute;top:467px;left:150px;white-space:nowrap" class="ft812">The&#160;following&#160;threats&#160;have&#160;to&#160;be&#160;addressed&#160;by&#160;the&#160;security&#160;services&#160;or&#160;by&#160;the&#160;architec-<br/>ture&#160;as&#160;a&#160;whole<a href="Open_TC_D05.2_SecServicesPoC.html#8">.</a></p>
<p style="position:absolute;top:482px;left:244px;white-space:nowrap" class="ft829"><a href="Open_TC_D05.2_SecServicesPoC.html#8">1</a></p>
<p style="position:absolute;top:543px;left:150px;white-space:nowrap" class="ft820"><b>Threats&#160;to&#160;the&#160;Corporation</b></p>
<p style="position:absolute;top:570px;left:150px;white-space:nowrap" class="ft811">There&#160;are&#160;threats&#160;that&#160;have&#160;to&#160;be&#160;addressed&#160;with&#160;regard&#160;to&#160;corporate&#160;data:</p>
<p style="position:absolute;top:617px;left:172px;white-space:nowrap" class="ft830">•</p>
<p style="position:absolute;top:618px;left:187px;white-space:nowrap" class="ft812">The&#160;PC&#160;of&#160;the&#160;employee&#160;gets&#160;lost,&#160;and&#160;the&#160;finder/thief&#160;is&#160;able&#160;to&#160;read&#160;confidential<br/>corporate&#160;data&#160;stored&#160;on&#160;the&#160;computer.</p>
<p style="position:absolute;top:665px;left:172px;white-space:nowrap" class="ft830">•</p>
<p style="position:absolute;top:666px;left:187px;white-space:nowrap" class="ft812">An&#160;attacker&#160;gains&#160;illegitimate&#160;access&#160;to&#160;the&#160;network&#160;of&#160;the&#160;corporation&#160;using&#160;its<br/>own&#160;or&#160;an&#160;employee’s&#160;computer.&#160;This&#160;includes&#160;replacing&#160;the&#160;trusted&#160;computing<br/>base&#160;(e.g.,&#160;hypervisor)&#160;with&#160;a&#160;bogus&#160;version&#160;to&#160;obtain&#160;secret&#160;information.</p>
<p style="position:absolute;top:731px;left:172px;white-space:nowrap" class="ft830">•</p>
<p style="position:absolute;top:732px;left:187px;white-space:nowrap" class="ft811">An&#160;employee&#160;deletes&#160;corporate&#160;data&#160;accidentally&#160;or&#160;on&#160;purpose*.</p>
<p style="position:absolute;top:802px;left:150px;white-space:nowrap" class="ft820"><b>Threats&#160;to&#160;the&#160;Employee</b></p>
<p style="position:absolute;top:830px;left:150px;white-space:nowrap" class="ft811">Threats&#160;that&#160;have&#160;to&#160;be&#160;considered&#160;from&#160;the&#160;perspective&#160;of&#160;the&#160;employee:</p>
<p style="position:absolute;top:876px;left:172px;white-space:nowrap" class="ft830">•</p>
<p style="position:absolute;top:877px;left:187px;white-space:nowrap" class="ft812">The&#160;employee’s&#160;system&#160;is&#160;altered&#160;by&#160;the&#160;installation&#160;of&#160;the&#160;corporate&#160;compart-<br/>ment&#160;resulting&#160;in&#160;a&#160;situation&#160;that&#160;the&#160;computer&#160;is&#160;no&#160;longer&#160;usable&#160;for&#160;private<br/>purposes&#160;because&#160;of,&#160;e.g.,&#160;restrictive&#160;security&#160;guidelines.</p>
<p style="position:absolute;top:942px;left:172px;white-space:nowrap" class="ft830">•</p>
<p style="position:absolute;top:943px;left:187px;white-space:nowrap" class="ft813">Access&#160;to&#160;private&#160;data&#160;stored&#160;on&#160;the&#160;employee’s&#160;system&#160;may&#160;be&#160;possible&#160;for&#160;other<br/>company&#160;members,&#160;e.g.,&#160;the&#160;administrator.</p>
<p style="position:absolute;top:1015px;left:166px;white-space:nowrap" class="ft831">1</p>
<p style="position:absolute;top:1017px;left:171px;white-space:nowrap" class="ft816">Threats&#160;marked&#160;with&#160;*&#160;are&#160;not&#160;related&#160;to&#160;the&#160;security&#160;services.&#160;These&#160;have&#160;to&#160;be&#160;considered&#160;generally</p>
<p style="position:absolute;top:1031px;left:150px;white-space:nowrap" class="ft816">and&#160;thus&#160;are&#160;not&#160;included&#160;within&#160;the&#160;security&#160;considerations&#160;of&#160;the&#160;security&#160;services.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft818">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 9 -->
<a name="9"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page9-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC009.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft911">CHAPTER&#160;1.&#160;CORPORATE&#160;COMPUTING&#160;AT&#160;HOME&#160;SCENARIO&#160;ANALYSIS</p>
<p style="position:absolute;top:141px;left:734px;white-space:nowrap" class="ft911">7</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft920"><b>Threats&#160;to&#160;both</b></p>
<p style="position:absolute;top:222px;left:226px;white-space:nowrap" class="ft912">Threats&#160;and&#160;attacks&#160;that&#160;have&#160;to&#160;be&#160;considered&#160;for&#160;company&#160;and&#160;employee&#160;are&#160;listed<br/>below:</p>
<p style="position:absolute;top:286px;left:248px;white-space:nowrap" class="ft930">•</p>
<p style="position:absolute;top:287px;left:263px;white-space:nowrap" class="ft911">Direct&#160;Memory&#160;Access&#160;by&#160;devices</p>
<p style="position:absolute;top:316px;left:248px;white-space:nowrap" class="ft930">•</p>
<p style="position:absolute;top:317px;left:263px;white-space:nowrap" class="ft911">Illegitimately&#160;modified&#160;compartments</p>
<p style="position:absolute;top:346px;left:248px;white-space:nowrap" class="ft930">•</p>
<p style="position:absolute;top:347px;left:263px;white-space:nowrap" class="ft911">Malware&#160;installed/executed&#160;within&#160;compartments&#160;or&#160;in&#160;the&#160;core&#160;hypervisor</p>
<p style="position:absolute;top:376px;left:248px;white-space:nowrap" class="ft930">•</p>
<p style="position:absolute;top:377px;left:263px;white-space:nowrap" class="ft911">Software&#160;vulnerabilities&#160;in&#160;the&#160;hypervisor&#160;or&#160;security&#160;services</p>
<p style="position:absolute;top:406px;left:248px;white-space:nowrap" class="ft930">•</p>
<p style="position:absolute;top:407px;left:263px;white-space:nowrap" class="ft911">Illegitimate&#160;program&#160;execution&#160;or&#160;data&#160;usage</p>
<p style="position:absolute;top:436px;left:248px;white-space:nowrap" class="ft930">•</p>
<p style="position:absolute;top:437px;left:263px;white-space:nowrap" class="ft911">Denial&#160;of&#160;Service&#160;attack*</p>
<p style="position:absolute;top:466px;left:248px;white-space:nowrap" class="ft930">•</p>
<p style="position:absolute;top:467px;left:263px;white-space:nowrap" class="ft911">User&#160;connects&#160;to&#160;a&#160;fake&#160;corporate&#160;server&#160;(phishing)</p>
<p style="position:absolute;top:496px;left:248px;white-space:nowrap" class="ft930">•</p>
<p style="position:absolute;top:497px;left:263px;white-space:nowrap" class="ft911">Loss&#160;of&#160;user&#160;credentials*</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft918">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 10 -->
<a name="10"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1033{font-size:18px;font-family:Times;color:#231f20;}
	.ft1034{font-size:22px;line-height:27px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page10-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC010.png" alt="background image"/>
<p style="position:absolute;top:295px;left:150px;white-space:nowrap" class="ft1021"><b>Chapter&#160;2</b></p>
<p style="position:absolute;top:365px;left:150px;white-space:nowrap" class="ft1019"><b>Xen&#160;Security&#160;Services</b></p>
<p style="position:absolute;top:422px;left:178px;white-space:nowrap" class="ft1011">S.&#160;Bleikertz,&#160;S.&#160;Cabuk,&#160;P.&#160;Grete&#160;(HPL),&#160;K.&#160;Eriksson,&#160;B.&#160;Jansen,&#160;H.&#160;Ramasamy,&#160;M.</p>
<p style="position:absolute;top:440px;left:570px;white-space:nowrap" class="ft1011">Schunter&#160;(IBM)</p>
<p style="position:absolute;top:473px;left:172px;white-space:nowrap" class="ft1011">This&#160;chapter&#160;describes&#160;different&#160;aspects&#160;of&#160;the&#160;Xen&#160;Security&#160;Services.&#160;Section&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#10">2.1</a></p>
<p style="position:absolute;top:491px;left:150px;white-space:nowrap" class="ft1012">gives&#160;an&#160;overview&#160;and&#160;identifies&#160;the&#160;current&#160;status&#160;of&#160;the&#160;implementation.&#160;Section&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#16">2.2<br/></a>provides&#160;an&#160;in-depth&#160;description&#160;of&#160;the&#160;design&#160;of&#160;the&#160;individual&#160;virtual&#160;networking&#160;com-<br/>ponents.&#160;Section&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#21">2.3&#160;</a>describes&#160;the&#160;network&#160;management&#160;concepts&#160;in&#160;detail.&#160;Section&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#28">2.4<br/></a>describes&#160;how&#160;to&#160;expand&#160;the&#160;core&#160;trusted&#160;computing&#160;base&#160;provided&#160;by&#160;the&#160;hypervisor<br/>to&#160;cover&#160;the&#160;executables&#160;of&#160;the&#160;security&#160;services&#160;as&#160;well.&#160;Section&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#31">2.5&#160;</a>shows&#160;how&#160;–<br/>given&#160;correct&#160;executables&#160;–&#160;integrity&#160;of&#160;the&#160;used&#160;policies&#160;can&#160;be&#160;proven.&#160;Furthermore,<br/>it&#160;describes&#160;how&#160;to&#160;bind&#160;secrets&#160;to&#160;correct&#160;enforcement&#160;of&#160;policies&#160;and&#160;other&#160;conditions.<br/>Section&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#47">2.6&#160;</a>describes&#160;the&#160;design&#160;of&#160;the&#160;secure&#160;GUI.</p>
<p style="position:absolute;top:680px;left:150px;white-space:nowrap" class="ft1022"><b>2.1</b></p>
<p style="position:absolute;top:680px;left:198px;white-space:nowrap" class="ft1034"><b>Xen&#160;Security&#160;Services&#160;Overview&#160;and&#160;Implementa-<br/>tion&#160;Status</b></p>
<p style="position:absolute;top:775px;left:380px;white-space:nowrap" class="ft1011">K.&#160;Eriksson,&#160;H.&#160;Ramasamy,&#160;M.&#160;Schunter&#160;(IBM)</p>
<p style="position:absolute;top:845px;left:150px;white-space:nowrap" class="ft1033"><b>2.1.1</b></p>
<p style="position:absolute;top:845px;left:204px;white-space:nowrap" class="ft1033"><b>Overview</b></p>
<p style="position:absolute;top:875px;left:150px;white-space:nowrap" class="ft1012">The&#160;security&#160;services&#160;manage&#160;the&#160;security&#160;configuration&#160;of&#160;the&#160;hypervisor&#160;and&#160;provide<br/>secure&#160;virtualization&#160;of&#160;resources&#160;to&#160;the&#160;virtual&#160;machines.</p>
<p style="position:absolute;top:911px;left:172px;white-space:nowrap" class="ft1011">The&#160;current&#160;implementation&#160;of&#160;the&#160;Security&#160;Services&#160;is&#160;an&#160;extension&#160;of&#160;the&#160;2006</p>
<p style="position:absolute;top:929px;left:150px;white-space:nowrap" class="ft1012">security&#160;services.&#160;The&#160;concept&#160;of&#160;TVDs&#160;(Trusted&#160;Virtual&#160;Domains)&#160;has&#160;been&#160;added&#160;to<br/>the&#160;networking&#160;component.&#160;The&#160;core&#160;idea&#160;of&#160;TVDs&#160;is&#160;to&#160;define&#160;virtual&#160;trust&#160;zones&#160;that<br/>can&#160;span&#160;multiple&#160;machines.&#160;Each&#160;trust&#160;zone&#160;then&#160;determines&#160;the&#160;security&#160;policies&#160;for<br/>the&#160;physical&#160;and&#160;virtual&#160;machines&#160;joining&#160;this&#160;zone.&#160;It&#160;also&#160;determines&#160;the&#160;transport<br/>protection&#160;used&#160;in&#160;a&#160;given&#160;zone.</p>
<p style="position:absolute;top:1018px;left:172px;white-space:nowrap" class="ft1011">The&#160;updated&#160;networking&#160;component&#160;includes&#160;a&#160;first&#160;version&#160;of&#160;admission&#160;control</p>
<p style="position:absolute;top:1036px;left:150px;white-space:nowrap" class="ft1011">for&#160;VMs.&#160;This&#160;ensures&#160;that&#160;only&#160;VMs&#160;that&#160;satisfy&#160;the&#160;TVD&#160;policies&#160;can&#160;join.</p>
<p style="position:absolute;top:1054px;left:172px;white-space:nowrap" class="ft1011">To&#160;be&#160;able&#160;to&#160;provide&#160;these&#160;services&#160;a&#160;management&#160;entity&#160;called&#160;“TVD&#160;proxy”&#160;was</p>
<p style="position:absolute;top:1072px;left:150px;white-space:nowrap" class="ft1011">implemented&#160;to&#160;manage&#160;and&#160;enforce&#160;the&#160;virtual&#160;domain&#160;policies&#160;on&#160;each&#160;physical&#160;host</p>
<p style="position:absolute;top:1117px;left:404px;white-space:nowrap" class="ft1011">8</p>
</div>
<!-- Page 11 -->
<a name="11"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1135{font-size:12px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page11-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC011.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1111">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:734px;white-space:nowrap" class="ft1111">9</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft1112">that&#160;a&#160;TVD&#160;is&#160;residing&#160;on.&#160;This&#160;means&#160;that&#160;on&#160;a&#160;physical&#160;host&#160;one&#160;TVD&#160;proxy&#160;is&#160;running<br/>for&#160;each&#160;TVD&#160;that&#160;can&#160;deploy&#160;VMs&#160;on&#160;that&#160;specific&#160;host.</p>
<p style="position:absolute;top:230px;left:248px;white-space:nowrap" class="ft1111">Each&#160;TVD&#160;proxy&#160;gets&#160;its&#160;portion&#160;of&#160;the&#160;needed&#160;TVD&#160;policies&#160;from&#160;the&#160;TVD&#160;Master</p>
<p style="position:absolute;top:247px;left:226px;white-space:nowrap" class="ft1113">that&#160;manage&#160;all&#160;policies&#160;for&#160;a&#160;specific&#160;TVD.&#160;Policies&#160;sent&#160;to&#160;a&#160;TVD&#160;proxy&#160;include&#160;al-<br/>lowed&#160;VMs,&#160;their&#160;reference&#160;measurements,&#160;extra&#160;configuration,&#160;TVD&#160;network&#160;settings,<br/>and&#160;configuration&#160;for&#160;secure&#160;channels&#160;if&#160;TVD&#160;spans&#160;several&#160;physical&#160;hosts.</p>
<p style="position:absolute;top:342px;left:226px;white-space:nowrap" class="ft1133"><b>2.1.2</b></p>
<p style="position:absolute;top:342px;left:280px;white-space:nowrap" class="ft1133"><b>TVD&#160;network&#160;infrastructure</b></p>
<p style="position:absolute;top:372px;left:226px;white-space:nowrap" class="ft1112">The&#160;TVD&#160;networking&#160;functionality&#160;enables&#160;a&#160;network&#160;infrastructure&#160;than&#160;can&#160;inter-<br/>connect&#160;multiple&#160;virtual&#160;machines&#160;running&#160;on&#160;multiple&#160;physical&#160;hosts.</p>
<p style="position:absolute;top:408px;left:248px;white-space:nowrap" class="ft1111">The&#160;implemented&#160;network&#160;infrastructure&#160;enables&#160;a&#160;private&#160;virtual&#160;network&#160;for&#160;each</p>
<p style="position:absolute;top:426px;left:226px;white-space:nowrap" class="ft1112">TVD&#160;and&#160;ensures&#160;network&#160;separation&#160;by&#160;inter-connecting&#160;VMs&#160;at&#160;the&#160;Ethernet&#160;level.<br/>This&#160;means&#160;that&#160;logically,&#160;we&#160;provide&#160;a&#160;separate&#160;virtual&#160;wiring&#160;for&#160;each&#160;TVD.&#160;As&#160;a<br/>consequence,&#160;different&#160;TVDs&#160;do&#160;not&#160;share&#160;any&#160;virtual&#160;cables&#160;to&#160;prevent&#160;that&#160;packets<br/>from&#160;different&#160;TVDs&#160;are&#160;traversing&#160;any&#160;shared&#160;routing&#160;tables&#160;and&#160;TCP/IP&#160;stacks.&#160;It&#160;also<br/>gives&#160;the&#160;freedom&#160;to&#160;deploy&#160;a&#160;wide&#160;range&#160;of&#160;networking&#160;solutions&#160;on&#160;top&#160;of&#160;the&#160;TVD<br/>network&#160;infrastructure.&#160;Network&#160;address&#160;allocations,&#160;transport&#160;protocols&#160;and&#160;other&#160;ser-<br/>vices&#160;are&#160;then&#160;fully&#160;customizable&#160;by&#160;the&#160;TVD&#160;owner&#160;and&#160;work&#160;transparently&#160;as&#160;if&#160;the<br/>VMs&#160;were&#160;in&#160;an&#160;isolated&#160;physical&#160;network.</p>
<p style="position:absolute;top:569px;left:248px;white-space:nowrap" class="ft1111">To&#160;maintain&#160;secrecy&#160;and&#160;confidentiality&#160;of&#160;network&#160;data&#160;when&#160;a&#160;TVD&#160;network&#160;spans</p>
<p style="position:absolute;top:587px;left:226px;white-space:nowrap" class="ft1113">several&#160;physical&#160;hosts&#160;the&#160;data&#160;is&#160;transferred&#160;over&#160;encrypted&#160;VPN&#160;tunnels.&#160;This&#160;enables<br/>the&#160;use&#160;of&#160;untrusted&#160;networks&#160;between&#160;physical&#160;hosts&#160;that&#160;contains&#160;VMs&#160;within&#160;the<br/>same&#160;TVD&#160;to&#160;provide&#160;a&#160;seamless&#160;view&#160;of&#160;the&#160;TVD&#160;network.</p>
<p style="position:absolute;top:665px;left:408px;white-space:nowrap" class="ft1135">TVD1</p>
<p style="position:absolute;top:689px;left:408px;white-space:nowrap" class="ft1135">VM1</p>
<p style="position:absolute;top:713px;left:456px;white-space:nowrap" class="ft1135">VM2</p>
<p style="position:absolute;top:719px;left:366px;white-space:nowrap" class="ft1135">VM3</p>
<p style="position:absolute;top:755px;left:289px;white-space:nowrap" class="ft1135">TVD2</p>
<p style="position:absolute;top:779px;left:289px;white-space:nowrap" class="ft1135">VM1</p>
<p style="position:absolute;top:808px;left:337px;white-space:nowrap" class="ft1135">VM2</p>
<p style="position:absolute;top:808px;left:247px;white-space:nowrap" class="ft1135">VM3</p>
<p style="position:absolute;top:689px;left:608px;white-space:nowrap" class="ft1135">TVD1</p>
<p style="position:absolute;top:713px;left:587px;white-space:nowrap" class="ft1135">VM4</p>
<p style="position:absolute;top:719px;left:635px;white-space:nowrap" class="ft1135">VM5</p>
<p style="position:absolute;top:785px;left:677px;white-space:nowrap" class="ft1135">TVD2</p>
<p style="position:absolute;top:808px;left:680px;white-space:nowrap" class="ft1135">VM4</p>
<p style="position:absolute;top:663px;left:235px;white-space:nowrap" class="ft1135">Host&#160;1</p>
<p style="position:absolute;top:662px;left:569px;white-space:nowrap" class="ft1135">Host&#160;2</p>
<p style="position:absolute;top:928px;left:237px;white-space:nowrap" class="ft1135">LAN/WAN</p>
<p style="position:absolute;top:838px;left:287px;white-space:nowrap" class="ft1135">Bridge</p>
<p style="position:absolute;top:862px;left:292px;white-space:nowrap" class="ft1135">VPN</p>
<p style="position:absolute;top:838px;left:675px;white-space:nowrap" class="ft1135">Bridge</p>
<p style="position:absolute;top:862px;left:680px;white-space:nowrap" class="ft1135">VPN</p>
<p style="position:absolute;top:749px;left:406px;white-space:nowrap" class="ft1135">Bridge</p>
<p style="position:absolute;top:773px;left:411px;white-space:nowrap" class="ft1135">VPN</p>
<p style="position:absolute;top:749px;left:609px;white-space:nowrap" class="ft1135">Bridge</p>
<p style="position:absolute;top:773px;left:614px;white-space:nowrap" class="ft1135">VPN</p>
<p style="position:absolute;top:966px;left:374px;white-space:nowrap" class="ft1111">Figure&#160;2.1:&#160;TVD&#160;Network&#160;Overview</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft1118">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 12 -->
<a name="12"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page12-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC012.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1211">10</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft1218">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:191px;left:150px;white-space:nowrap" class="ft1233"><b>2.1.3</b></p>
<p style="position:absolute;top:191px;left:204px;white-space:nowrap" class="ft1233"><b>Bridge</b></p>
<p style="position:absolute;top:222px;left:150px;white-space:nowrap" class="ft1212">For&#160;bridging&#160;VMs&#160;within&#160;a&#160;physical&#160;host&#160;there&#160;are&#160;two&#160;options,&#160;either&#160;using&#160;the&#160;Linux<br/>Kernel&#160;Ethernet&#160;Bridge&#160;functionality&#160;or&#160;the&#160;OpenTC&#160;vSwitch&#160;from&#160;HP&#160;Labs.</p>
<p style="position:absolute;top:257px;left:172px;white-space:nowrap" class="ft1211">Both&#160;work&#160;in&#160;a&#160;similar&#160;way&#160;when&#160;it&#160;comes&#160;to&#160;plugging&#160;in&#160;VMs,&#160;and&#160;it&#160;is&#160;done</p>
<p style="position:absolute;top:275px;left:150px;white-space:nowrap" class="ft1212">by&#160;attaching&#160;a&#160;VM’s&#160;back-end&#160;virtual&#160;network&#160;interface&#160;(vif)&#160;to&#160;the&#160;bridge/vSwitch<br/>at&#160;Ethernet&#160;level&#160;and&#160;therefore&#160;all&#160;ingoing&#160;and&#160;outgoing&#160;packets&#160;from&#160;a&#160;VM&#160;will&#160;be<br/>directly&#160;going&#160;to/from&#160;the&#160;attached&#160;bridge&#160;only&#160;and&#160;bypassing&#160;all&#160;higher&#160;level&#160;packet<br/>routing/mangling/filtering&#160;outside&#160;the&#160;TVD&#160;network&#160;infrastructure.</p>
<p style="position:absolute;top:347px;left:172px;white-space:nowrap" class="ft1211">Each&#160;bridge&#160;works&#160;in&#160;the&#160;same&#160;way&#160;as&#160;a&#160;physical&#160;Ethernet&#160;switch&#160;does&#160;by&#160;main-</p>
<p style="position:absolute;top:365px;left:150px;white-space:nowrap" class="ft1212">taining&#160;MAC&#160;tables&#160;(with&#160;age&#160;counters)&#160;for&#160;each&#160;port&#160;(in&#160;this&#160;case&#160;connected&#160;vifs)&#160;to<br/>keep&#160;track&#160;of&#160;where&#160;to&#160;route&#160;packets.</p>
<p style="position:absolute;top:401px;left:172px;white-space:nowrap" class="ft1211">The&#160;Linux&#160;bridge&#160;can&#160;also&#160;handle&#160;the&#160;link&#160;management&#160;protocol&#160;STP&#160;(Spanning</p>
<p style="position:absolute;top:419px;left:150px;white-space:nowrap" class="ft1213">Tree&#160;Protocol,&#160;IEEE&#160;802.1D)&#160;to&#160;handle&#160;multiple&#160;hops&#160;and&#160;avoid&#160;cyclic&#160;routes&#160;if&#160;a&#160;more<br/>complex&#160;TVD&#160;network&#160;layout&#160;is&#160;deployed.&#160;This&#160;is&#160;useful&#160;when&#160;several&#160;local&#160;TVD<br/>networks&#160;on&#160;different&#160;physical&#160;hosts&#160;are&#160;inter-connected&#160;via&#160;multiple&#160;secure&#160;channels.</p>
<p style="position:absolute;top:473px;left:172px;white-space:nowrap" class="ft1211">The&#160;vSwitch&#160;has&#160;capability&#160;to&#160;do&#160;VLAN&#160;tagging&#160;(IEEE&#160;802.1Q)&#160;which&#160;is&#160;useful</p>
<p style="position:absolute;top:491px;left:150px;white-space:nowrap" class="ft1212">when&#160;inter-connecting&#160;physical&#160;hosts&#160;with&#160;several&#160;TVDs&#160;over&#160;a&#160;trusted&#160;network&#160;such&#160;a<br/>internal&#160;Data&#160;Center&#160;network.&#160;It&#160;works&#160;by&#160;adding&#160;tag&#160;information&#160;in&#160;the&#160;Ethernet&#160;frame<br/>header&#160;that&#160;identifies&#160;to&#160;which&#160;VLAN&#160;a&#160;frame&#160;belongs&#160;and&#160;then&#160;send&#160;out&#160;the&#160;frame&#160;on<br/>a&#160;shared&#160;network.&#160;Receiver&#160;and&#160;intermediate&#160;VLAN-enabled&#160;switches&#160;can&#160;then&#160;apply<br/>rules&#160;and&#160;routing&#160;depending&#160;on&#160;which&#160;VLAN&#160;a&#160;frame&#160;belongs&#160;to.&#160;This&#160;enables&#160;better<br/>network&#160;separation&#160;but&#160;not&#160;confidentiality.</p>
<p style="position:absolute;top:639px;left:150px;white-space:nowrap" class="ft1233"><b>2.1.4</b></p>
<p style="position:absolute;top:639px;left:204px;white-space:nowrap" class="ft1233"><b>Virtual&#160;Private&#160;Network</b></p>
<p style="position:absolute;top:669px;left:150px;white-space:nowrap" class="ft1212">To&#160;add&#160;confidentiality&#160;to&#160;data&#160;between&#160;VMs,&#160;that&#160;belong&#160;to&#160;the&#160;same&#160;TVD&#160;but&#160;are<br/>located&#160;on&#160;different&#160;physical&#160;hosts,&#160;the&#160;data&#160;is&#160;transferred&#160;over&#160;a&#160;secure&#160;channel&#160;between<br/>the&#160;local&#160;bridges&#160;on&#160;each&#160;physical&#160;host.</p>
<p style="position:absolute;top:723px;left:172px;white-space:nowrap" class="ft1211">The&#160;relaying&#160;is&#160;done&#160;on&#160;Ethernet&#160;level&#160;to&#160;keep&#160;the&#160;TVD&#160;network&#160;transparent&#160;no</p>
<p style="position:absolute;top:741px;left:150px;white-space:nowrap" class="ft1213">matter&#160;if&#160;the&#160;VMs&#160;are&#160;residing&#160;on&#160;the&#160;same&#160;or&#160;on&#160;different&#160;physical&#160;hosts.&#160;The&#160;imple-<br/>mented&#160;solution&#160;of&#160;secure&#160;channels&#160;uses&#160;point-to-point&#160;VPN&#160;tunnels&#160;with&#160;OpenVPN<br/>that&#160;are&#160;configured&#160;via&#160;the&#160;TVD&#160;proxy&#160;from&#160;the&#160;TVD&#160;policies.&#160;This&#160;enables&#160;reconfigu-<br/>ration&#160;of&#160;topology&#160;and&#160;the&#160;involved&#160;VPNs&#160;within&#160;a&#160;TVD&#160;from&#160;a&#160;single&#160;administration<br/>point,&#160;the&#160;TVD&#160;Master.</p>
<p style="position:absolute;top:830px;left:172px;white-space:nowrap" class="ft1211">The&#160;TVD&#160;policies&#160;distributed&#160;from&#160;the&#160;TVD&#160;Master&#160;to&#160;the&#160;TVD&#160;proxy&#160;also&#160;include</p>
<p style="position:absolute;top:848px;left:150px;white-space:nowrap" class="ft1213">the&#160;secret&#160;key&#160;for&#160;the&#160;VPN&#160;along&#160;with&#160;other&#160;VPN&#160;specific&#160;settings.&#160;On&#160;a&#160;physical<br/>host&#160;the&#160;VPN’s&#160;endpoint&#160;is&#160;represented&#160;as&#160;a&#160;local&#160;virtual&#160;network&#160;interface&#160;(vif)&#160;that&#160;is<br/>plugged&#160;into&#160;the&#160;appropriate&#160;bridge&#160;controlled&#160;by&#160;the&#160;TVD&#160;proxy.&#160;The&#160;bridge’s&#160;MAC<br/>tables&#160;are&#160;then&#160;updated&#160;in&#160;the&#160;same&#160;fashion&#160;as&#160;physical&#160;switches&#160;learn&#160;what&#160;port&#160;they<br/>need&#160;to&#160;send&#160;on&#160;for&#160;a&#160;specific&#160;host.</p>
<p style="position:absolute;top:979px;left:150px;white-space:nowrap" class="ft1233"><b>2.1.5</b></p>
<p style="position:absolute;top:979px;left:204px;white-space:nowrap" class="ft1233"><b>VM&#160;admission&#160;control</b></p>
<p style="position:absolute;top:1009px;left:150px;white-space:nowrap" class="ft1213">When&#160;a&#160;VM&#160;is&#160;about&#160;to&#160;join&#160;a&#160;TVD&#160;its&#160;state&#160;will&#160;be&#160;verified&#160;by&#160;the&#160;local&#160;TVD&#160;proxy&#160;to<br/>see&#160;if&#160;it&#160;complies&#160;to&#160;the&#160;policies&#160;of&#160;that&#160;TVD.&#160;If&#160;it&#160;is&#160;accepted&#160;then&#160;it&#160;will&#160;be&#160;connected<br/>to&#160;the&#160;TVD&#160;network.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft1218">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 13 -->
<a name="13"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page13-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC013.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1311">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft1311">11</p>
<p style="position:absolute;top:315px;left:541px;white-space:nowrap" class="ft1335">vSwitch/</p>
<p style="position:absolute;top:328px;left:546px;white-space:nowrap" class="ft1335">Bridge</p>
<p style="position:absolute;top:252px;left:385px;white-space:nowrap" class="ft1335">eth0</p>
<p style="position:absolute;top:281px;left:382px;white-space:nowrap" class="ft1335">vif1.0</p>
<p style="position:absolute;top:252px;left:472px;white-space:nowrap" class="ft1335">eth0</p>
<p style="position:absolute;top:281px;left:470px;white-space:nowrap" class="ft1335">vif2.0</p>
<p style="position:absolute;top:411px;left:363px;white-space:nowrap" class="ft1335">Dom0</p>
<p style="position:absolute;top:195px;left:453px;white-space:nowrap" class="ft1335">DomT1</p>
<p style="position:absolute;top:208px;left:449px;white-space:nowrap" class="ft1335">(paravirt)</p>
<p style="position:absolute;top:195px;left:361px;white-space:nowrap" class="ft1335">DomU</p>
<p style="position:absolute;top:195px;left:542px;white-space:nowrap" class="ft1335">DomT2</p>
<p style="position:absolute;top:208px;left:536px;white-space:nowrap" class="ft1335">(fully&#160;virt.)</p>
<p style="position:absolute;top:252px;left:560px;white-space:nowrap" class="ft1335">eth0</p>
<p style="position:absolute;top:281px;left:560px;white-space:nowrap" class="ft1335">tap0</p>
<p style="position:absolute;top:336px;left:386px;white-space:nowrap" class="ft1335">Def.</p>
<p style="position:absolute;top:349px;left:380px;white-space:nowrap" class="ft1335">Bridge</p>
<p style="position:absolute;top:414px;left:469px;white-space:nowrap" class="ft1335">peth0</p>
<p style="position:absolute;top:374px;left:551px;white-space:nowrap" class="ft1335">VPN</p>
<p style="position:absolute;top:298px;left:575px;white-space:nowrap" class="ft1335">eth</p>
<p style="position:absolute;top:309px;left:465px;white-space:nowrap" class="ft1335">eth</p>
<p style="position:absolute;top:350px;left:570px;white-space:nowrap" class="ft1335">eth</p>
<p style="position:absolute;top:391px;left:517px;white-space:nowrap" class="ft1335">udp/ip</p>
<p style="position:absolute;top:310px;left:377px;white-space:nowrap" class="ft1335">eth</p>
<p style="position:absolute;top:361px;left:468px;white-space:nowrap" class="ft1335">Dom0</p>
<p style="position:absolute;top:374px;left:474px;white-space:nowrap" class="ft1335">NW</p>
<p style="position:absolute;top:386px;left:470px;white-space:nowrap" class="ft1335">stack</p>
<p style="position:absolute;top:443px;left:436px;white-space:nowrap" class="ft1335">Untrusted&#160;network</p>
<p style="position:absolute;top:481px;left:313px;white-space:nowrap" class="ft1311">Figure&#160;2.2:&#160;TVD&#160;Network&#160;Modules&#160;within&#160;Physical&#160;Host</p>
<p style="position:absolute;top:529px;left:248px;white-space:nowrap" class="ft1311">In&#160;the&#160;implementation&#160;this&#160;is&#160;done&#160;by&#160;having&#160;the&#160;Compartment&#160;Manager&#160;(Comp-</p>
<p style="position:absolute;top:547px;left:226px;white-space:nowrap" class="ft1313">Mgr)&#160;do&#160;a&#160;two&#160;step&#160;interaction&#160;with&#160;the&#160;TVD&#160;proxy&#160;during&#160;startup&#160;of&#160;a&#160;VM,&#160;namely<br/>compartment&#160;attest&#160;and&#160;compartment&#160;network&#160;attach&#160;.&#160;This&#160;is&#160;done&#160;over&#160;a&#160;socket&#160;con-<br/>nection&#160;using&#160;the&#160;Compartment&#160;Admission&#160;Protocol&#160;(CAP)&#160;specifically&#160;designed&#160;for<br/>this&#160;purpose.</p>
<p style="position:absolute;top:619px;left:248px;white-space:nowrap" class="ft1311">The&#160;CompMgr&#160;makes&#160;use&#160;of&#160;a&#160;module&#160;called&#160;Integrity&#160;Service&#160;Manager&#160;to&#160;measure</p>
<p style="position:absolute;top:637px;left:226px;white-space:nowrap" class="ft1313">the&#160;state&#160;of&#160;the&#160;VM&#160;to&#160;start.&#160;The&#160;measurements&#160;can&#160;include&#160;state&#160;of&#160;VM&#160;configuration,<br/>kernel&#160;and&#160;disk(s)&#160;that&#160;are&#160;going&#160;to&#160;be&#160;attached&#160;to&#160;the&#160;VM.</p>
<p style="position:absolute;top:712px;left:226px;white-space:nowrap" class="ft1320"><b>Compartment&#160;attestation:</b></p>
<p style="position:absolute;top:742px;left:245px;white-space:nowrap" class="ft1311">1.&#160;CompMgr&#160;loads&#160;the&#160;VM&#160;configuration&#160;and&#160;applies&#160;security&#160;directives&#160;such&#160;as</p>
<p style="position:absolute;top:760px;left:263px;white-space:nowrap" class="ft1312">measuring&#160;compartment&#160;image&#160;(with&#160;help&#160;of&#160;Integrity&#160;Service&#160;Manager),&#160;unseal-<br/>ing&#160;key&#160;and&#160;setting&#160;up&#160;encrypted&#160;storage&#160;(with&#160;help&#160;of&#160;SVDM&#160;)&#160;and&#160;checks&#160;if<br/>VM&#160;should&#160;be&#160;part&#160;of&#160;a&#160;TVD.</p>
<p style="position:absolute;top:826px;left:245px;white-space:nowrap" class="ft1311">2.&#160;If&#160;security&#160;directives&#160;state&#160;that&#160;the&#160;VM&#160;should&#160;be&#160;part&#160;of&#160;TVD&#160;network&#160;then&#160;the</p>
<p style="position:absolute;top:844px;left:263px;white-space:nowrap" class="ft1313">CompMgr&#160;sends&#160;prior&#160;to&#160;VM&#160;startup&#160;an&#160;attestation&#160;request&#160;to&#160;the&#160;TVD&#160;proxy<br/>containing&#160;the&#160;measurements&#160;of&#160;the&#160;VM.</p>
<p style="position:absolute;top:892px;left:245px;white-space:nowrap" class="ft1311">3.&#160;The&#160;TVD&#160;proxy&#160;looks&#160;up&#160;the&#160;settings&#160;for&#160;the&#160;VM&#160;in&#160;the&#160;policies&#160;and&#160;validates</p>
<p style="position:absolute;top:910px;left:263px;white-space:nowrap" class="ft1312">the&#160;measurements&#160;and&#160;returns&#160;accept&#160;or&#160;deny&#160;depending&#160;on&#160;the&#160;validation&#160;result<br/>along&#160;with&#160;optional&#160;extra&#160;settings&#160;(such&#160;a&#160;MAC&#160;address)&#160;that&#160;TVD&#160;proxy&#160;wants<br/>CompMgr&#160;to&#160;apply&#160;on&#160;VM&#160;at&#160;startup.</p>
<p style="position:absolute;top:985px;left:226px;white-space:nowrap" class="ft1320"><b>Compartment&#160;network&#160;attach:</b></p>
<p style="position:absolute;top:1015px;left:245px;white-space:nowrap" class="ft1311">4.&#160;Once&#160;the&#160;CompMgr&#160;has&#160;started&#160;the&#160;VM&#160;it&#160;sends&#160;an&#160;attach&#160;request&#160;to&#160;the&#160;TVD</p>
<p style="position:absolute;top:1033px;left:263px;white-space:nowrap" class="ft1313">proxy&#160;containing&#160;the&#160;virtual&#160;network&#160;interface&#160;(vif)&#160;of&#160;the&#160;newly&#160;started&#160;VM&#160;that<br/>should&#160;be&#160;part&#160;of&#160;the&#160;TVD&#160;network,&#160;and&#160;also&#160;the&#160;measurements&#160;of&#160;the&#160;VM.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft1318">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 14 -->
<a name="14"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1436{font-size:12px;font-family:Helvetica;color:#b84646;}
	.ft1437{font-size:8px;font-family:Helvetica;color:#b84646;}
	.ft1438{font-size:10px;font-family:Helvetica;color:#7f7f7f;}
-->
</style>
<div id="page14-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC014.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1411">12</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft1418">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:194px;left:168px;white-space:nowrap" class="ft1411">5.&#160;The&#160;TVD&#160;proxy&#160;once&#160;again&#160;verifies&#160;the&#160;VM&#160;measurements&#160;and&#160;if&#160;everything&#160;is</p>
<p style="position:absolute;top:212px;left:187px;white-space:nowrap" class="ft1412">according&#160;to&#160;TVD&#160;policies&#160;then&#160;connects&#160;the&#160;vif&#160;to&#160;the&#160;bridge&#160;of&#160;the&#160;local&#160;part&#160;of<br/>the&#160;TVD&#160;network&#160;and&#160;returns&#160;that&#160;attachment&#160;was&#160;successful.</p>
<p style="position:absolute;top:259px;left:172px;white-space:nowrap" class="ft1411">The&#160;CompMgr&#160;will&#160;not&#160;start&#160;the&#160;VM&#160;if&#160;the&#160;TVD&#160;proxy&#160;returns&#160;deny&#160;during&#160;the</p>
<p style="position:absolute;top:277px;left:150px;white-space:nowrap" class="ft1411">attestation&#160;procedure.</p>
<p style="position:absolute;top:295px;left:172px;white-space:nowrap" class="ft1411">If&#160;the&#160;attestation&#160;step&#160;would&#160;be&#160;skipt&#160;and&#160;the&#160;CompMgr&#160;requests&#160;the&#160;TVD&#160;proxy</p>
<p style="position:absolute;top:313px;left:150px;white-space:nowrap" class="ft1412">to&#160;attach&#160;a&#160;started&#160;VM&#160;with&#160;“bad”&#160;measurements&#160;to&#160;the&#160;TVD&#160;network&#160;then&#160;the&#160;TVD<br/>proxy&#160;will&#160;respond&#160;saying&#160;that&#160;it&#160;failed&#160;and&#160;leave&#160;the&#160;vif&#160;unconnected,&#160;thus&#160;leaving&#160;the<br/>TVD&#160;network&#160;unreachable&#160;by&#160;the&#160;VM&#160;by&#160;not&#160;attaching&#160;it&#160;the&#160;bridge.</p>
<p style="position:absolute;top:367px;left:172px;white-space:nowrap" class="ft1411">The&#160;admission&#160;control&#160;protocol&#160;is&#160;depicted&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#14">2.3.&#160;</a>The&#160;implementation&#160;de-</p>
<p style="position:absolute;top:385px;left:150px;white-space:nowrap" class="ft1411">tails&#160;are&#160;depicted&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#15">2.4.</a></p>
<p style="position:absolute;top:428px;left:170px;white-space:nowrap" class="ft1436">Compartment&#160;Manager</p>
<p style="position:absolute;top:423px;left:556px;white-space:nowrap" class="ft1436">TVD&#160;Proxy</p>
<p style="position:absolute;top:436px;left:536px;white-space:nowrap" class="ft1437">(Listens&#160;on&#160;TCP&#160;port&#160;6150)</p>
<p style="position:absolute;top:466px;left:296px;white-space:nowrap" class="ft1425">Query:&#160;Attest&#160;Compartment&#160;(Comp.&#160;ID,&#160;Comp.&#160;Meas.)</p>
<p style="position:absolute;top:503px;left:305px;white-space:nowrap" class="ft1425">Response:&#160;Attest&#160;Granted&#160;(Comp.&#160;ID,&#160;MAC&#160;addr.)</p>
<p style="position:absolute;top:531px;left:332px;white-space:nowrap" class="ft1438">Response:&#160;Attest&#160;Denied&#160;(Comp.&#160;ID)</p>
<p style="position:absolute;top:525px;left:594px;white-space:nowrap" class="ft1425">or</p>
<p style="position:absolute;top:421px;left:382px;white-space:nowrap" class="ft1425">TCP&#160;Socket</p>
<p style="position:absolute;top:564px;left:286px;white-space:nowrap" class="ft1425">Query:&#160;Attach&#160;Compartment&#160;(Comp.&#160;ID,&#160;Comp.&#160;Meas.,&#160;vif)</p>
<p style="position:absolute;top:601px;left:339px;white-space:nowrap" class="ft1425">Response:&#160;Attach&#160;Ok&#160;(Comp.&#160;ID)</p>
<p style="position:absolute;top:629px;left:338px;white-space:nowrap" class="ft1438">Response:&#160;Attach&#160;Fail&#160;(Comp.&#160;ID)</p>
<p style="position:absolute;top:623px;left:593px;white-space:nowrap" class="ft1425">or</p>
<p style="position:absolute;top:501px;left:167px;white-space:nowrap" class="ft1425">Step&#160;1</p>
<p style="position:absolute;top:512px;left:158px;white-space:nowrap" class="ft1425">Attestation</p>
<p style="position:absolute;top:600px;left:167px;white-space:nowrap" class="ft1425">Step&#160;2</p>
<p style="position:absolute;top:611px;left:161px;white-space:nowrap" class="ft1425">Attaching</p>
<p style="position:absolute;top:667px;left:323px;white-space:nowrap" class="ft1425">Query:&#160;Detach&#160;Compartment&#160;(Comp.&#160;ID)</p>
<p style="position:absolute;top:704px;left:337px;white-space:nowrap" class="ft1425">Response:&#160;Detach&#160;Ok&#160;(Comp.&#160;ID)</p>
<p style="position:absolute;top:732px;left:335px;white-space:nowrap" class="ft1438">Response:&#160;Detach&#160;Fail&#160;(Comp.&#160;ID)</p>
<p style="position:absolute;top:726px;left:593px;white-space:nowrap" class="ft1425">or</p>
<p style="position:absolute;top:703px;left:167px;white-space:nowrap" class="ft1425">Step&#160;3</p>
<p style="position:absolute;top:714px;left:159px;white-space:nowrap" class="ft1425">Detaching</p>
<p style="position:absolute;top:781px;left:228px;white-space:nowrap" class="ft1411">Figure&#160;2.3:&#160;Compartment&#160;Admission&#160;Protocol&#160;towards&#160;TVD</p>
<p style="position:absolute;top:817px;left:172px;white-space:nowrap" class="ft1411">The&#160;extended&#160;implementation&#160;added&#160;a&#160;couple&#160;of&#160;modules&#160;to&#160;the&#160;original&#160;Security</p>
<p style="position:absolute;top:835px;left:150px;white-space:nowrap" class="ft1412">Services&#160;architecture.&#160;Most&#160;notable&#160;is&#160;the&#160;TVD&#160;proxy&#160;that&#160;handles&#160;the&#160;enforcing&#160;of<br/>TVD&#160;policies&#160;on&#160;a&#160;physical&#160;host.&#160;The&#160;enforcing&#160;covers&#160;accept/deny&#160;of&#160;starting&#160;a&#160;VM<br/>depending&#160;on&#160;measurements&#160;and&#160;also&#160;admission&#160;to&#160;TVD&#160;network.</p>
<p style="position:absolute;top:889px;left:172px;white-space:nowrap" class="ft1411">The&#160;TVD&#160;proxy&#160;further&#160;contains&#160;sub-modules&#160;that&#160;handles&#160;various&#160;networking</p>
<p style="position:absolute;top:907px;left:150px;white-space:nowrap" class="ft1412">tasks&#160;needed&#160;to&#160;be&#160;able&#160;to&#160;provide&#160;the&#160;TVD&#160;networking&#160;infrastructure&#160;to&#160;attached&#160;VMs.<br/>It&#160;includes&#160;modules&#160;for&#160;controlling&#160;Kernel&#160;bridge,&#160;vSwitch&#160;and&#160;VPN.</p>
<p style="position:absolute;top:964px;left:150px;white-space:nowrap" class="ft1420"><b>Compartment&#160;Manager</b></p>
<p style="position:absolute;top:964px;left:317px;white-space:nowrap" class="ft1411">This&#160;module</p>
<p style="position:absolute;top:993px;left:172px;white-space:nowrap" class="ft1430">•</p>
<p style="position:absolute;top:994px;left:187px;white-space:nowrap" class="ft1411">Manages&#160;starting&#160;and&#160;stopping&#160;of&#160;VMs.</p>
<p style="position:absolute;top:1023px;left:172px;white-space:nowrap" class="ft1430">•</p>
<p style="position:absolute;top:1024px;left:187px;white-space:nowrap" class="ft1411">Verifies&#160;VM&#160;image&#160;and&#160;configuration&#160;towards&#160;TPM.</p>
<p style="position:absolute;top:1053px;left:172px;white-space:nowrap" class="ft1430">•</p>
<p style="position:absolute;top:1054px;left:187px;white-space:nowrap" class="ft1412">Sets&#160;up&#160;needed&#160;resources&#160;for&#160;a&#160;VM,&#160;such&#160;as&#160;memory,&#160;encrypted&#160;storage&#160;and&#160;so<br/>on.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft1418">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 15 -->
<a name="15"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1539{font-size:12px;font-family:Helvetica;color:#b84646;}
	.ft1540{font-size:8px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page15-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC015.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1511">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft1511">13</p>
<p style="position:absolute;top:221px;left:262px;white-space:nowrap" class="ft1539"><b>Compartment&#160;Manager</b></p>
<p style="position:absolute;top:234px;left:288px;white-space:nowrap" class="ft1537">(starting/stopping&#160;VM)</p>
<p style="position:absolute;top:217px;left:503px;white-space:nowrap" class="ft1539"><b>TVD&#160;Proxy</b></p>
<p style="position:absolute;top:230px;left:472px;white-space:nowrap" class="ft1537">(Enforcing&#160;TVD&#160;policies,&#160;controlling&#160;</p>
<p style="position:absolute;top:238px;left:524px;white-space:nowrap" class="ft1537">vNet)</p>
<p style="position:absolute;top:193px;left:657px;white-space:nowrap" class="ft1539"><b>TVD&#160;Master</b></p>
<p style="position:absolute;top:206px;left:649px;white-space:nowrap" class="ft1537">(Web-server&#160;containing&#160;</p>
<p style="position:absolute;top:215px;left:663px;white-space:nowrap" class="ft1537">policy&#160;XML-file)</p>
<p style="position:absolute;top:329px;left:614px;white-space:nowrap" class="ft1536">vSwitch&#160;ctrl.</p>
<p style="position:absolute;top:342px;left:605px;white-space:nowrap" class="ft1537">(userland&#160;lib&#160;interfacing</p>
<p style="position:absolute;top:350px;left:619px;white-space:nowrap" class="ft1537">kernel&#160;module)</p>
<p style="position:absolute;top:338px;left:510px;white-space:nowrap" class="ft1536">VPN&#160;ctrl.</p>
<p style="position:absolute;top:405px;left:575px;white-space:nowrap" class="ft1536">OpenVPN</p>
<p style="position:absolute;top:417px;left:555px;white-space:nowrap" class="ft1537">(TCP&#160;interface&#160;to&#160;daemon)</p>
<p style="position:absolute;top:409px;left:454px;white-space:nowrap" class="ft1536">GUI&#160;user&#160;auth.</p>
<p style="position:absolute;top:276px;left:662px;white-space:nowrap" class="ft1536">Bridge&#160;ctrl.</p>
<p style="position:absolute;top:289px;left:659px;white-space:nowrap" class="ft1537">(interfacing&#160;kernel</p>
<p style="position:absolute;top:297px;left:647px;white-space:nowrap" class="ft1537">module&#160;via&#160;user-land&#160;lib)</p>
<p style="position:absolute;top:332px;left:372px;white-space:nowrap" class="ft1536">SVDM</p>
<p style="position:absolute;top:345px;left:334px;white-space:nowrap" class="ft1537">Secure&#160;Virtual&#160;Device&#160;Manager</p>
<p style="position:absolute;top:353px;left:337px;white-space:nowrap" class="ft1537">(Resource&#160;allocation&#160;&amp;&#160;setup)</p>
<p style="position:absolute;top:287px;left:233px;white-space:nowrap" class="ft1536">Integrity&#160;Service&#160;Manager</p>
<p style="position:absolute;top:299px;left:248px;white-space:nowrap" class="ft1537">(Measuring&#160;cfg.,&#160;kernel,&#160;disks)</p>
<p style="position:absolute;top:446px;left:262px;white-space:nowrap" class="ft1540">New&#160;implementation</p>
<p style="position:absolute;top:464px;left:262px;white-space:nowrap" class="ft1540">Extended&#160;implementation</p>
<p style="position:absolute;top:482px;left:262px;white-space:nowrap" class="ft1540">Not&#160;implemented</p>
<p style="position:absolute;top:399px;left:260px;white-space:nowrap" class="ft1540">Linked&#160;function&#160;call</p>
<p style="position:absolute;top:423px;left:260px;white-space:nowrap" class="ft1540">Protocol&#160;over&#160;socket</p>
<p style="position:absolute;top:520px;left:356px;white-space:nowrap" class="ft1511">Figure&#160;2.4:&#160;Implementation&#160;module&#160;details</p>
<p style="position:absolute;top:564px;left:248px;white-space:nowrap" class="ft1530">•</p>
<p style="position:absolute;top:565px;left:263px;white-space:nowrap" class="ft1513">Interacts&#160;with&#160;Xen&#160;(via&#160;command-line&#160;interaction)&#160;for&#160;loading&#160;a&#160;VM,&#160;starting&#160;it<br/>and&#160;stopping&#160;it.</p>
<p style="position:absolute;top:610px;left:248px;white-space:nowrap" class="ft1530">•</p>
<p style="position:absolute;top:611px;left:263px;white-space:nowrap" class="ft1511">Asks&#160;TVD-proxy&#160;for&#160;VM&#160;attestation&#160;and&#160;network&#160;access&#160;via&#160;the&#160;CAP&#160;protocol.</p>
<p style="position:absolute;top:650px;left:226px;white-space:nowrap" class="ft1520"><b>TVD&#160;proxy</b></p>
<p style="position:absolute;top:650px;left:314px;white-space:nowrap" class="ft1511">The&#160;TVD&#160;proxy&#160;runs&#160;as&#160;a&#160;separate&#160;process&#160;controlling&#160;the&#160;network&#160;re-</p>
<p style="position:absolute;top:668px;left:226px;white-space:nowrap" class="ft1511">sources&#160;on&#160;a&#160;physical&#160;host.</p>
<p style="position:absolute;top:686px;left:248px;white-space:nowrap" class="ft1511">It&#160;loads&#160;and&#160;parses&#160;the&#160;polices&#160;at&#160;startup&#160;and&#160;then&#160;waits&#160;for&#160;requests&#160;from&#160;the&#160;Cmp-</p>
<p style="position:absolute;top:704px;left:226px;white-space:nowrap" class="ft1512">Mgr.&#160;The&#160;policies&#160;are&#160;specified&#160;in&#160;XML&#160;and&#160;can&#160;be&#160;read&#160;from&#160;file&#160;or&#160;remotely&#160;over&#160;any<br/>protocol&#160;that&#160;the&#160;Linux&#160;Curl&#160;library&#160;can&#160;handle&#160;(http,&#160;https,&#160;ftp&#160;and&#160;so&#160;on).</p>
<p style="position:absolute;top:740px;left:248px;white-space:nowrap" class="ft1511">The&#160;TVD&#160;proxy&#160;sets&#160;up&#160;the&#160;Kernel&#160;bridge&#160;or&#160;vSwitch&#160;at&#160;startup&#160;and&#160;then&#160;later&#160;starts</p>
<p style="position:absolute;top:758px;left:226px;white-space:nowrap" class="ft1511">the&#160;VPN&#160;when&#160;the&#160;first&#160;VM&#160;is&#160;attached.</p>
<p style="position:absolute;top:776px;left:248px;white-space:nowrap" class="ft1511">Controlling&#160;of&#160;the&#160;VPN&#160;is&#160;done&#160;via&#160;command-line&#160;interaction&#160;and&#160;using&#160;the&#160;Open-</p>
<p style="position:absolute;top:794px;left:226px;white-space:nowrap" class="ft1511">VPN&#160;management&#160;interface&#160;which&#160;runs&#160;over&#160;a&#160;TCP&#160;socket.</p>
<p style="position:absolute;top:834px;left:226px;white-space:nowrap" class="ft1533"><b>2.1.6</b></p>
<p style="position:absolute;top:834px;left:280px;white-space:nowrap" class="ft1533"><b>Summary</b></p>
<p style="position:absolute;top:864px;left:226px;white-space:nowrap" class="ft1511">The&#160;current&#160;implementation&#160;of&#160;the&#160;Security&#160;Services&#160;can&#160;handle&#160;at&#160;least&#160;the&#160;following:</p>
<p style="position:absolute;top:889px;left:248px;white-space:nowrap" class="ft1530">•</p>
<p style="position:absolute;top:890px;left:263px;white-space:nowrap" class="ft1512">Integrity&#160;enforcement&#160;of&#160;compartment&#160;configuration,&#160;kernel&#160;and&#160;system&#160;image.<br/>The&#160;parts&#160;to&#160;be&#160;included&#160;in&#160;measurement&#160;are&#160;configurable&#160;(config,&#160;kernel,&#160;sys.<br/>Image&#160;).&#160;Measurements&#160;can&#160;extend&#160;a&#160;PCR&#160;in&#160;the&#160;TPM&#160;for&#160;later&#160;use&#160;in&#160;unsealing<br/>of&#160;keys.</p>
<p style="position:absolute;top:971px;left:248px;white-space:nowrap" class="ft1530">•</p>
<p style="position:absolute;top:972px;left:263px;white-space:nowrap" class="ft1512">System&#160;image&#160;and&#160;additional&#160;disks&#160;to&#160;attach&#160;can&#160;be&#160;encrypted&#160;and&#160;key(s)&#160;sealed<br/>to&#160;TPM’s&#160;base&#160;PCRs&#160;and&#160;optional&#160;an&#160;extra&#160;PCR&#160;to&#160;include&#160;earlier&#160;selected&#160;mea-<br/>surements.</p>
<p style="position:absolute;top:1035px;left:248px;white-space:nowrap" class="ft1530">•</p>
<p style="position:absolute;top:1036px;left:263px;white-space:nowrap" class="ft1512">Compartment&#160;Manager&#160;handles&#160;running&#160;VMs&#160;paravirtualised&#160;and&#160;fully&#160;virtu-<br/>alised.&#160;VMs&#160;stated&#160;to&#160;be&#160;part&#160;of&#160;a&#160;TVD&#160;will&#160;be&#160;attested&#160;and&#160;attached&#160;against<br/>the&#160;TVD&#160;proxy.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft1518">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 16 -->
<a name="16"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page16-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC016.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1611">14</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft1618">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:193px;left:172px;white-space:nowrap" class="ft1630">•</p>
<p style="position:absolute;top:194px;left:187px;white-space:nowrap" class="ft1612">The&#160;TVD&#160;proxy&#160;reads&#160;policies&#160;in&#160;XML&#160;format&#160;from&#160;file&#160;or&#160;remote&#160;via&#160;HTTP,<br/>which&#160;should&#160;be&#160;over&#160;an&#160;prior&#160;setup&#160;secure&#160;tunnel&#160;(like&#160;a&#160;TLS&#160;tunnel&#160;using&#160;a<br/>remote&#160;attestation&#160;protocol).</p>
<p style="position:absolute;top:258px;left:172px;white-space:nowrap" class="ft1630">•</p>
<p style="position:absolute;top:259px;left:187px;white-space:nowrap" class="ft1613">The&#160;TVD&#160;proxy&#160;handles&#160;using&#160;both&#160;the&#160;Kernel&#160;Bridge&#160;and&#160;the&#160;vSwitch&#160;(se-<br/>lectable)&#160;is&#160;the&#160;local&#160;bridge&#160;for&#160;the&#160;TVD&#160;network.</p>
<p style="position:absolute;top:306px;left:172px;white-space:nowrap" class="ft1630">•</p>
<p style="position:absolute;top:307px;left:187px;white-space:nowrap" class="ft1612">OpenVPN&#160;is&#160;used&#160;as&#160;VPN&#160;tunnel&#160;and&#160;is&#160;setup&#160;on&#160;demand&#160;and&#160;controlled&#160;by&#160;the<br/>TVD-proxy.</p>
<p style="position:absolute;top:371px;left:150px;white-space:nowrap" class="ft1622"><b>2.2</b></p>
<p style="position:absolute;top:371px;left:198px;white-space:nowrap" class="ft1622"><b>Xen&#160;Virtual&#160;Networking&#160;Devices</b></p>
<p style="position:absolute;top:409px;left:443px;white-space:nowrap" class="ft1611">S.&#160;Bleikertz,&#160;S.&#160;Cabuk&#160;(editor)&#160;(HPL)</p>
<p style="position:absolute;top:442px;left:172px;white-space:nowrap" class="ft1611">This&#160;section&#160;provides&#160;details&#160;on&#160;the&#160;virtual&#160;networking&#160;prototype&#160;developed&#160;by</p>
<p style="position:absolute;top:460px;left:150px;white-space:nowrap" class="ft1613">HPL.&#160;The&#160;prototype&#160;was&#160;fully&#160;incorporated&#160;into&#160;the&#160;demonstrator&#160;to&#160;help&#160;isolate&#160;the<br/>corporate&#160;networking&#160;from&#160;a&#160;non-corporate&#160;one&#160;(with&#160;the&#160;difference&#160;that&#160;in&#160;the&#160;demo<br/>OpenVPN&#160;is&#160;used&#160;instead&#160;of&#160;IPSec).</p>
<p style="position:absolute;top:554px;left:150px;white-space:nowrap" class="ft1633"><b>2.2.1</b></p>
<p style="position:absolute;top:554px;left:204px;white-space:nowrap" class="ft1633"><b>Overview</b></p>
<p style="position:absolute;top:584px;left:150px;white-space:nowrap" class="ft1612">Virtualisation&#160;technology&#160;can&#160;be&#160;applied&#160;to&#160;several&#160;different&#160;resources&#160;in&#160;an&#160;IT&#160;envi-<br/>ronment&#160;and&#160;is&#160;nowadays&#160;popularly&#160;used&#160;for&#160;server&#160;consolidation.&#160;Another&#160;area&#160;of<br/>virtualisation&#160;in&#160;IT&#160;environments&#160;and&#160;datacenters&#160;is&#160;network&#160;virtualisation,&#160;which&#160;is<br/>used&#160;to&#160;create&#160;virtual&#160;networks&#160;on&#160;top&#160;of&#160;the&#160;physical&#160;infrastructure&#160;independently&#160;of<br/>the&#160;physical&#160;topology.&#160;Several&#160;virtual&#160;networks,&#160;each&#160;with&#160;a&#160;different&#160;topology,&#160;can&#160;be<br/>deployed&#160;simultaneously&#160;on&#160;the&#160;same&#160;physical&#160;network,&#160;which&#160;allows&#160;consolidation&#160;of<br/>networks&#160;and&#160;a&#160;flexible&#160;topology&#160;configuration.</p>
<p style="position:absolute;top:710px;left:172px;white-space:nowrap" class="ft1611">A&#160;typical&#160;use&#160;case&#160;for&#160;virtual&#160;networking&#160;in&#160;datacenter&#160;environments&#160;is&#160;when&#160;sev-</p>
<p style="position:absolute;top:728px;left:150px;white-space:nowrap" class="ft1612">eral&#160;customers&#160;share&#160;the&#160;physical&#160;resources&#160;such&#160;as&#160;servers&#160;and&#160;network&#160;infrastructure,<br/>but&#160;each&#160;customer&#160;wants&#160;to&#160;configure&#160;and&#160;operate&#160;a&#160;network&#160;for&#160;her&#160;own&#160;servers.&#160;With-<br/>out&#160;virtualisation&#160;technology&#160;each&#160;customer&#160;would&#160;need&#160;a&#160;dedicated&#160;physical&#160;network<br/>infrastructure&#160;and&#160;servers&#160;to&#160;do&#160;so,&#160;which&#160;is&#160;cost-intensive&#160;and&#160;inflexible.&#160;Virtualisation<br/>of&#160;servers&#160;and&#160;network&#160;allows&#160;the&#160;sharing&#160;of&#160;physical&#160;resources&#160;with&#160;strong&#160;isolation,<br/>which&#160;increases&#160;the&#160;overall&#160;datacenter&#160;utilisation&#160;and&#160;reduces&#160;the&#160;costs&#160;for&#160;the&#160;cus-<br/>tomers.</p>
<p style="position:absolute;top:853px;left:172px;white-space:nowrap" class="ft1611">Virtualisation&#160;allows&#160;customers&#160;to&#160;specify&#160;a&#160;flexible&#160;configuration&#160;of&#160;their&#160;network</p>
<p style="position:absolute;top:871px;left:150px;white-space:nowrap" class="ft1612">topology&#160;and&#160;server&#160;arrangement.&#160;This&#160;is&#160;because,&#160;thanks&#160;to&#160;virtualisation,&#160;no&#160;physical<br/>reconfiguration&#160;such&#160;as&#160;changing&#160;cabling&#160;or&#160;adding&#160;new&#160;servers&#160;to&#160;a&#160;rack&#160;is&#160;needed.<br/>This&#160;is&#160;beneficial&#160;for&#160;customers&#160;in&#160;order&#160;to&#160;rapidly&#160;react&#160;to&#160;growing&#160;demands&#160;of&#160;their<br/>IT&#160;infrastructure.</p>
<p style="position:absolute;top:943px;left:172px;white-space:nowrap" class="ft1611">Customers&#160;have&#160;a&#160;high&#160;demand&#160;for&#160;strong&#160;isolation&#160;to&#160;protect&#160;their&#160;confidential&#160;busi-</p>
<p style="position:absolute;top:961px;left:150px;white-space:nowrap" class="ft1612">ness&#160;information&#160;from&#160;other&#160;parties&#160;sharing&#160;the&#160;same&#160;physical&#160;resources.&#160;Virtualisation<br/>does&#160;not&#160;provide&#160;the&#160;same&#160;isolation&#160;as&#160;dedicated&#160;physical&#160;resources&#160;do,&#160;but&#160;allows&#160;the<br/>introduction&#160;of&#160;further&#160;security&#160;mechanisms&#160;due&#160;to&#160;the&#160;gained&#160;flexibility&#160;of&#160;virtualisa-<br/>tion.&#160;This&#160;section&#160;discusses&#160;how&#160;network&#160;virtualisation&#160;can&#160;be&#160;utilised&#160;to&#160;implement&#160;a<br/>security&#160;mechanism&#160;for&#160;fine-grained&#160;isolation&#160;and&#160;policy&#160;enforcement.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft1618">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 17 -->
<a name="17"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page17-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC017.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1711">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft1711">15</p>
<p style="position:absolute;top:191px;left:226px;white-space:nowrap" class="ft1733"><b>2.2.2</b></p>
<p style="position:absolute;top:191px;left:280px;white-space:nowrap" class="ft1733"><b>Background</b></p>
<p style="position:absolute;top:261px;left:226px;white-space:nowrap" class="ft1720"><b>Switch&#160;Functionality</b></p>
<p style="position:absolute;top:289px;left:226px;white-space:nowrap" class="ft1713">A&#160;switch,&#160;compared&#160;to&#160;a&#160;hub,&#160;only&#160;sends&#160;incoming&#160;packets&#160;to&#160;the&#160;port,&#160;where&#160;the<br/>destination&#160;host&#160;is&#160;connected,&#160;and&#160;not&#160;to&#160;all&#160;ports.&#160;In&#160;order&#160;to&#160;make&#160;this&#160;decision,&#160;the<br/>switch&#160;has&#160;to&#160;know&#160;which&#160;host&#160;is&#160;connected&#160;to&#160;which&#160;port&#160;and&#160;manages&#160;this&#160;mapping<br/>in&#160;a&#160;table.&#160;A&#160;physical&#160;Ethernet&#160;switch&#160;manages&#160;a&#160;MAC&#160;table,&#160;which&#160;maps&#160;a&#160;Layer&#160;2<br/>address&#160;(MAC)&#160;to&#160;a&#160;physical&#160;port.</p>
<p style="position:absolute;top:379px;left:248px;white-space:nowrap" class="ft1711">Switch&#160;table&#160;management&#160;consists&#160;of&#160;two&#160;procedures&#160;for&#160;adding&#160;a&#160;new&#160;table&#160;entry</p>
<p style="position:absolute;top:397px;left:226px;white-space:nowrap" class="ft1712">and&#160;removing&#160;an&#160;old&#160;one,&#160;which&#160;are&#160;called&#160;Learning&#160;and&#160;Ageing.&#160;In&#160;the&#160;Learning&#160;pro-<br/>cedure&#160;every&#160;incoming&#160;packet&#160;is&#160;analysed&#160;and&#160;the&#160;source&#160;MAC&#160;address&#160;is&#160;extracted.<br/>The&#160;switch&#160;knows&#160;on&#160;which&#160;port&#160;the&#160;packet&#160;was&#160;received&#160;and&#160;adds&#160;a&#160;new&#160;or&#160;updates<br/>an&#160;existing&#160;table&#160;entry&#160;for&#160;the&#160;source&#160;MAC&#160;address&#160;with&#160;this&#160;port&#160;number.&#160;The&#160;Ageing<br/>procedure&#160;removes&#160;obsolete&#160;entries&#160;from&#160;the&#160;table&#160;by&#160;using&#160;a&#160;time&#160;stamp&#160;for&#160;each&#160;en-<br/>try,&#160;which&#160;indicates&#160;when&#160;the&#160;entry&#160;was&#160;lastly&#160;updated.&#160;If&#160;a&#160;certain&#160;time&#160;difference&#160;is<br/>reached,&#160;the&#160;entry&#160;will&#160;be&#160;removed&#160;from&#160;the&#160;table.&#160;In&#160;order&#160;to&#160;have&#160;an&#160;efficient&#160;packet<br/>transportation&#160;within&#160;the&#160;switch,&#160;these&#160;two&#160;procedures&#160;keep&#160;the&#160;table&#160;consistent&#160;and<br/>accurate.&#160;A&#160;special&#160;case&#160;is&#160;when&#160;the&#160;destination&#160;MAC&#160;address&#160;of&#160;an&#160;incoming&#160;packet<br/>is&#160;not&#160;in&#160;the&#160;table&#160;yet.&#160;In&#160;this&#160;case,&#160;the&#160;switch&#160;can&#160;not&#160;decide&#160;to&#160;which&#160;port&#160;the&#160;packet<br/>have&#160;to&#160;be&#160;forwarded,&#160;so&#160;it&#160;will&#160;broadcast&#160;it&#160;to&#160;all&#160;ports,&#160;in&#160;order&#160;to&#160;try&#160;to&#160;reach&#160;the<br/>destination&#160;host.&#160;If&#160;the&#160;host&#160;is&#160;connected&#160;to&#160;the&#160;switch&#160;it&#160;might&#160;send&#160;a&#160;response,&#160;which<br/>the&#160;switch&#160;can&#160;use&#160;to&#160;add&#160;the&#160;table&#160;entry&#160;for&#160;this&#160;host.</p>
<p style="position:absolute;top:670px;left:226px;white-space:nowrap" class="ft1720"><b>Link&#160;Modes</b></p>
<p style="position:absolute;top:698px;left:226px;white-space:nowrap" class="ft1712">As&#160;depicted&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#18">2.5,&#160;</a>vSwitches&#160;are&#160;linked&#160;to&#160;each&#160;other&#160;using&#160;several&#160;different<br/>protocols&#160;depending&#160;on&#160;the&#160;type&#160;of&#160;link&#160;between&#160;them.&#160;This&#160;section&#160;gives&#160;an&#160;overview<br/>of&#160;these&#160;protocols,&#160;describing&#160;their&#160;functionalities,&#160;and&#160;best&#160;usage&#160;scenarios.</p>
<p style="position:absolute;top:791px;left:226px;white-space:nowrap" class="ft1720"><b>EtherIP</b></p>
<p style="position:absolute;top:791px;left:293px;white-space:nowrap" class="ft1711">is&#160;a&#160;protocol&#160;for&#160;tunnelling&#160;Ethernet&#160;and&#160;802.3&#160;packets&#160;via&#160;IP,&#160;which&#160;allows</p>
<p style="position:absolute;top:809px;left:226px;white-space:nowrap" class="ft1713">the&#160;expansion&#160;of&#160;a&#160;LAN&#160;over&#160;a&#160;Wide&#160;or&#160;Metropolitan&#160;Area&#160;Networks.&#160;Each&#160;tunnel&#160;end-<br/>point&#160;uses&#160;a&#160;special&#160;network&#160;device&#160;provided&#160;by&#160;the&#160;operating&#160;system,&#160;which&#160;encapsu-<br/>lates&#160;the&#160;whole&#160;outgoing&#160;Ethernet/802.3&#160;packet&#160;in&#160;a&#160;new&#160;IP&#160;packet&#160;and&#160;then&#160;transmits<br/>it&#160;to&#160;the&#160;other&#160;side&#160;of&#160;the&#160;tunnel.&#160;From&#160;incoming&#160;packets&#160;the&#160;embedded&#160;Ethernet/802.3<br/>packet&#160;is&#160;extracted&#160;and&#160;transmitted&#160;to&#160;the&#160;LAN.</p>
<p style="position:absolute;top:899px;left:248px;white-space:nowrap" class="ft1711">EtherIP&#160;does&#160;not&#160;provide&#160;confidentiality&#160;or&#160;integrity,&#160;which&#160;makes&#160;it&#160;only&#160;suitable</p>
<p style="position:absolute;top:917px;left:226px;white-space:nowrap" class="ft1712">for&#160;routed&#160;and&#160;trusted&#160;networks&#160;in&#160;a&#160;corporate&#160;or&#160;datacenter&#160;environment,&#160;for&#160;example<br/>when&#160;two&#160;vSwitches&#160;are&#160;located&#160;in&#160;a&#160;datacenter,&#160;but&#160;are&#160;hosted&#160;on&#160;different&#160;servers,<br/>which&#160;are&#160;not&#160;connected&#160;on&#160;the&#160;same&#160;VLAN&#160;switch.</p>
<p style="position:absolute;top:993px;left:226px;white-space:nowrap" class="ft1720"><b>VLAN&#160;tagging</b></p>
<p style="position:absolute;top:993px;left:335px;white-space:nowrap" class="ft1711">is&#160;a&#160;well-established&#160;standard&#160;for&#160;network&#160;isolation&#160;on&#160;physical&#160;net-</p>
<p style="position:absolute;top:1011px;left:226px;white-space:nowrap" class="ft1712">work&#160;equipment&#160;in&#160;datacenters.&#160;The&#160;standard&#160;is&#160;described&#160;in&#160;IEEE&#160;802.1Q&#160;and&#160;uses<br/>tagging&#160;of&#160;Ethernet&#160;packets&#160;for&#160;isolation&#160;between&#160;networks.&#160;As&#160;an&#160;example,&#160;a&#160;host&#160;in<br/>the&#160;VLAN&#160;42&#160;uses&#160;a&#160;special&#160;network&#160;device&#160;provided&#160;by&#160;the&#160;operating&#160;system&#160;to&#160;apply</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft1718">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 18 -->
<a name="18"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page18-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC018.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1811">16</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft1818">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:526px;left:283px;white-space:nowrap" class="ft1811">Figure&#160;2.5:&#160;General&#160;vSwitch&#160;Architecture</p>
<p style="position:absolute;top:574px;left:150px;white-space:nowrap" class="ft1812">a&#160;VLAN&#160;tag,&#160;which&#160;contains&#160;the&#160;VLAN&#160;ID&#160;42,&#160;to&#160;outgoing&#160;packets&#160;and&#160;to&#160;remove&#160;the<br/>tag&#160;from&#160;incoming&#160;packets&#160;before&#160;they&#160;are&#160;processed&#160;by&#160;the&#160;upper&#160;network&#160;stack.</p>
<p style="position:absolute;top:610px;left:172px;white-space:nowrap" class="ft1811">In&#160;order&#160;to&#160;handle&#160;VLAN&#160;tagged&#160;packets,&#160;the&#160;physical&#160;network&#160;equipment&#160;has&#160;to</p>
<p style="position:absolute;top:628px;left:150px;white-space:nowrap" class="ft1812">support&#160;IEEE&#160;802.1Q&#160;and&#160;be&#160;configured&#160;appropriately.&#160;The&#160;port&#160;of&#160;the&#160;VLAN&#160;switch,<br/>which&#160;is&#160;used&#160;by&#160;the&#160;host&#160;of&#160;VLAN&#160;42,&#160;has&#160;to&#160;be&#160;assigned&#160;to&#160;VLAN&#160;42&#160;as&#160;well&#160;as<br/>the&#160;port&#160;of&#160;the&#160;destination&#160;host.&#160;The&#160;VLAN&#160;Switch&#160;will&#160;analyse&#160;the&#160;VLAN&#160;Tag,&#160;in<br/>particular&#160;the&#160;VLAN&#160;ID,&#160;of&#160;incoming&#160;packets&#160;and&#160;only&#160;send&#160;them&#160;to&#160;ports,&#160;which&#160;are<br/>assigned&#160;to&#160;this&#160;particular&#160;VLAN&#160;ID.</p>
<p style="position:absolute;top:739px;left:150px;white-space:nowrap" class="ft1820"><b>IPSec</b></p>
<p style="position:absolute;top:739px;left:201px;white-space:nowrap" class="ft1811">addresses&#160;the&#160;issues&#160;of&#160;packet&#160;confidentiality&#160;and&#160;integrity,&#160;which&#160;are&#160;miss-</p>
<p style="position:absolute;top:757px;left:150px;white-space:nowrap" class="ft1812">ing&#160;both&#160;in&#160;EtherIP&#160;and&#160;VLAN&#160;tagging.&#160;This&#160;section&#160;gives&#160;only&#160;a&#160;brief&#160;explanation<br/>of&#160;IPSec.&#160;For&#160;further&#160;details&#160;refer&#160;to&#160;RFC&#160;4301&#160;to&#160;4309,&#160;which&#160;covers&#160;the&#160;technical<br/>specifications.</p>
<p style="position:absolute;top:811px;left:172px;white-space:nowrap" class="ft1811">We&#160;focus&#160;on&#160;the&#160;Encapsulating&#160;Security&#160;Payload&#160;(ESP)&#160;of&#160;IPSec,&#160;which&#160;encapsu-</p>
<p style="position:absolute;top:829px;left:150px;white-space:nowrap" class="ft1812">lates&#160;a&#160;IP&#160;packet&#160;and&#160;applies&#160;an&#160;encryption&#160;mechanism&#160;to&#160;provide&#160;confidentiality&#160;and<br/>integrity&#160;of&#160;this&#160;packet.&#160;The&#160;usage&#160;scenario&#160;for&#160;IPSec&#160;is&#160;when&#160;two&#160;vSwitches&#160;are&#160;linked<br/>to&#160;each&#160;other&#160;over&#160;an&#160;untrusted&#160;network&#160;such&#160;as&#160;the&#160;Internet.&#160;Outgoing&#160;Ethernet/802.3<br/>packets&#160;are&#160;first&#160;encapsulated&#160;using&#160;EtherIP,&#160;and&#160;then&#160;encapsulated&#160;and&#160;encrypted&#160;us-<br/>ing&#160;IPSec.&#160;The&#160;double&#160;encapsulation&#160;is&#160;needed,&#160;because&#160;IPSec&#160;only&#160;encapsulates&#160;IP<br/>packets&#160;and&#160;not&#160;Ethernet/802.3&#160;ones.</p>
<p style="position:absolute;top:959px;left:150px;white-space:nowrap" class="ft1833"><b>2.2.3</b></p>
<p style="position:absolute;top:959px;left:204px;white-space:nowrap" class="ft1833"><b>Virtual&#160;Switch</b></p>
<p style="position:absolute;top:989px;left:150px;white-space:nowrap" class="ft1820"><b>Overview</b></p>
<p style="position:absolute;top:1017px;left:150px;white-space:nowrap" class="ft1813">The&#160;Virtual&#160;Switch&#160;(vSwitch)&#160;is&#160;the&#160;core&#160;component&#160;of&#160;virtual&#160;networking&#160;and&#160;oper-<br/>ates&#160;similar&#160;to&#160;a&#160;physical&#160;switch.&#160;It&#160;is&#160;responsible&#160;for&#160;network&#160;virtualisation,&#160;isolation,<br/>and&#160;spanning&#160;a&#160;virtual&#160;network&#160;across&#160;physical&#160;hosts.&#160;The&#160;vSwitch&#160;provides&#160;the&#160;primi-</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft1818">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 19 -->
<a name="19"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page19-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC019.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1911">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft1911">17</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft1912">tives&#160;for&#160;implementing&#160;higher-level&#160;security&#160;policies&#160;for&#160;networking&#160;and&#160;it&#160;needs&#160;to&#160;be<br/>configured&#160;by&#160;a&#160;higher-level&#160;management&#160;layer&#160;(e.g.,&#160;security&#160;services&#160;management)&#160;.</p>
<p style="position:absolute;top:251px;left:226px;white-space:nowrap" class="ft1920"><b>Architecture</b></p>
<p style="position:absolute;top:279px;left:226px;white-space:nowrap" class="ft1912">Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#18">2.5&#160;</a>illustrates&#160;the&#160;general&#160;architecture&#160;of&#160;virtual&#160;networking&#160;and&#160;how&#160;several<br/>vSwitches&#160;are&#160;linked&#160;together&#160;in&#160;a&#160;sample&#160;environment.&#160;In&#160;this&#160;scenario&#160;we&#160;have&#160;three<br/>physical&#160;hosts,&#160;which&#160;are&#160;connected&#160;to&#160;each&#160;other&#160;using&#160;different&#160;networks&#160;and&#160;hosting<br/>VMs&#160;of&#160;different&#160;customers&#160;or&#160;TVDs.&#160;The&#160;green&#160;TVD&#160;consists&#160;of&#160;VM&#160;2&#160;and&#160;VM&#160;3<br/>hosted&#160;on&#160;A&#160;and&#160;B,&#160;which&#160;are&#160;connected&#160;to&#160;each&#160;other&#160;using&#160;a&#160;local&#160;VLAN&#160;switch.&#160;The<br/>isolation&#160;of&#160;the&#160;green&#160;TVD&#160;to&#160;other&#160;parties&#160;connected&#160;to&#160;this&#160;switch&#160;is&#160;realised&#160;using<br/>the&#160;built-in&#160;VLAN&#160;tagging&#160;with&#160;the&#160;TVD&#160;ID&#160;as&#160;VLAN&#160;ID.&#160;VM&#160;1&#160;and&#160;VM&#160;4&#160;of&#160;the&#160;blue<br/>TVD,&#160;also&#160;located&#160;on&#160;the&#160;physical&#160;hosts&#160;A&#160;and&#160;B,&#160;are&#160;using&#160;EtherIP&#160;encapsulation&#160;over<br/>an&#160;IP-based&#160;Metropolitan&#160;Area&#160;Network&#160;(MAN),&#160;like&#160;a&#160;routed&#160;corporate&#160;network.&#160;The<br/>members&#160;of&#160;the&#160;red&#160;TVD&#160;VM&#160;5&#160;and&#160;VM&#160;6&#160;are&#160;on&#160;physical&#160;hosts,&#160;which&#160;are&#160;connected<br/>only&#160;through&#160;a&#160;Wide&#160;Area&#160;Network&#160;(WAN),&#160;like&#160;the&#160;Internet,&#160;and&#160;an&#160;IPSec&#160;channel&#160;is<br/>needed,&#160;in&#160;order&#160;to&#160;ensure&#160;confidentiality&#160;and&#160;integrity.</p>
<p style="position:absolute;top:494px;left:248px;white-space:nowrap" class="ft1911">The&#160;goal&#160;is&#160;that&#160;every&#160;VM&#160;thinks&#160;it&#160;is&#160;on&#160;the&#160;same&#160;LAN&#160;with&#160;the&#160;other&#160;VMs&#160;of&#160;its</p>
<p style="position:absolute;top:512px;left:226px;white-space:nowrap" class="ft1912">TVD&#160;and&#160;all&#160;traffic&#160;is&#160;transmitted&#160;in&#160;an&#160;efficient&#160;and&#160;secure&#160;manner&#160;depending&#160;on&#160;the<br/>link&#160;type&#160;and&#160;the&#160;chosen&#160;protocol.&#160;Security&#160;issues,&#160;such&#160;as&#160;communicating&#160;securely<br/>over&#160;a&#160;WAN&#160;link,&#160;are&#160;addressed&#160;by&#160;the&#160;network&#160;infrastructure&#160;and&#160;the&#160;VMs&#160;can&#160;rely&#160;on<br/>this&#160;mechanism&#160;and&#160;do&#160;not&#160;have&#160;to&#160;address&#160;these&#160;issues&#160;themselves.</p>
<p style="position:absolute;top:607px;left:226px;white-space:nowrap" class="ft1933"><b>2.2.4</b></p>
<p style="position:absolute;top:607px;left:280px;white-space:nowrap" class="ft1933"><b>Linux&#160;Dom0&#160;Prototype</b></p>
<p style="position:absolute;top:637px;left:226px;white-space:nowrap" class="ft1913">The&#160;first&#160;version&#160;of&#160;the&#160;vSwitch&#160;prototype&#160;is&#160;realised&#160;as&#160;a&#160;Linux&#160;kernel&#160;module&#160;for&#160;the<br/>vSwitch&#160;core&#160;component&#160;and&#160;a&#160;stack&#160;of&#160;user&#160;land&#160;configuration&#160;tools.&#160;This&#160;vSwitch<br/>is&#160;intended&#160;to&#160;operate&#160;from&#160;a&#160;Linux-based&#160;dom0,&#160;which&#160;acts&#160;as&#160;a&#160;net-backend&#160;for&#160;the<br/>VMs&#160;and&#160;has&#160;access&#160;to&#160;the&#160;physical&#160;network&#160;interface.&#160;The&#160;current&#160;implementation&#160;is<br/>limited&#160;to&#160;VLAN&#160;Tagging&#160;and&#160;EtherIP&#160;encapsulation&#160;as&#160;vSwitch&#160;linking&#160;modes.&#160;An<br/>additional&#160;VPN&#160;module&#160;is&#160;employed&#160;to&#160;provide&#160;IPSec&#160;encapsulation&#160;functionality.</p>
<p style="position:absolute;top:766px;left:226px;white-space:nowrap" class="ft1920"><b>Implementation&#160;in&#160;Xen</b></p>
<p style="position:absolute;top:795px;left:226px;white-space:nowrap" class="ft1912">Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#20">2.6&#160;</a>depicts&#160;the&#160;Linux-based&#160;implementation&#160;of&#160;the&#160;vSwitch&#160;on&#160;a&#160;Xen&#160;platform.<br/>The&#160;Xen&#160;dom0&#160;acts&#160;as&#160;a&#160;net-backend&#160;for&#160;the&#160;VMs&#160;on&#160;the&#160;same&#160;host&#160;and&#160;has&#160;virtual<br/>network&#160;interfaces&#160;called&#160;vif,&#160;where&#160;each&#160;vif&#160;has&#160;a&#160;corresponding&#160;net-frontend&#160;device<br/>in&#160;the&#160;VM.&#160;A&#160;VM&#160;can&#160;be&#160;associated&#160;with&#160;a&#160;vSwitch&#160;using&#160;the&#160;appropriate&#160;vif&#160;device<br/>and&#160;all&#160;traffic&#160;for&#160;a&#160;VM&#160;is&#160;processed&#160;by&#160;the&#160;vSwitch,&#160;in&#160;particular&#160;outgoing&#160;traffic&#160;is<br/>tagged&#160;or&#160;encapsulated.</p>
<p style="position:absolute;top:902px;left:248px;white-space:nowrap" class="ft1911">There&#160;exists&#160;two&#160;versions&#160;of&#160;the&#160;vSwitch&#160;implementation,&#160;which&#160;differs&#160;in&#160;the&#160;im-</p>
<p style="position:absolute;top:920px;left:226px;white-space:nowrap" class="ft1912">plementation&#160;of&#160;VLAN&#160;tagging.&#160;The&#160;first&#160;version&#160;uses&#160;the&#160;pseudo&#160;device&#160;for&#160;VLAN<br/>tagging&#160;provided&#160;by&#160;the&#160;Linux&#160;kernel.&#160;The&#160;second&#160;one&#160;has&#160;its&#160;own&#160;functionality&#160;for<br/>VLAN&#160;and&#160;EtherIP&#160;processing,&#160;making&#160;the&#160;architecture&#160;for&#160;packet&#160;processing&#160;more<br/>consistent.&#160;The&#160;latter&#160;also&#160;prevents&#160;the&#160;extra&#160;overhead&#160;for&#160;transmitting&#160;packets&#160;through<br/>another&#160;networking&#160;layer.</p>
<p style="position:absolute;top:1010px;left:248px;white-space:nowrap" class="ft1911">From&#160;an&#160;implementation&#160;point&#160;of&#160;view&#160;this&#160;vSwitch&#160;version&#160;is&#160;highly&#160;coupled&#160;to</p>
<p style="position:absolute;top:1028px;left:226px;white-space:nowrap" class="ft1913">dom0&#160;and&#160;Linux.&#160;Communication&#160;with&#160;the&#160;connected&#160;VMs&#160;is&#160;realised&#160;through&#160;the<br/>Linux&#160;dom0&#160;bridging&#160;and&#160;its&#160;hooks&#160;for&#160;packet&#160;interception.&#160;Furthermore,&#160;the&#160;vSwitch<br/>registers&#160;several&#160;handlers&#160;for&#160;VLAN&#160;and&#160;EtherIP&#160;handling&#160;within&#160;the&#160;Linux&#160;kernel’s</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft1918">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 20 -->
<a name="20"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2041{font-size:6px;font-family:Helvetica;color:#000000;}
	.ft2042{font-size:12px;font-family:KPSHBO+TT10B97o00;color:#000000;}
	.ft2043{font-size:153px;font-family:Times;color:#000000;}
	.ft2044{font-size:9px;font-family:KPSHBO+TT10B99o00;color:#000000;}
	.ft2045{font-size:9px;font-family:KPSHBO+TT10B9Bo00;color:#000000;}
	.ft2046{font-size:15px;font-family:Courier;color:#231f20;}
	.ft2047{font-size:6px;line-height:7px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page20-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC020.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft2011">18</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft2018">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:193px;left:266px;white-space:nowrap" class="ft2041"><b>Host&#160;A</b></p>
<p style="position:absolute;top:211px;left:331px;white-space:nowrap" class="ft2041"><b>Dom&#160;1</b></p>
<p style="position:absolute;top:211px;left:229px;white-space:nowrap" class="ft2041"><b>Dom&#160;0</b></p>
<p style="position:absolute;top:256px;left:257px;white-space:nowrap" class="ft2042">α</p>
<p style="position:absolute;top:258px;left:219px;white-space:nowrap" class="ft2041"><b>encap.</b></p>
<p style="position:absolute;top:265px;left:218px;white-space:nowrap" class="ft2041"><b>module</b></p>
<p style="position:absolute;top:256px;left:179px;white-space:nowrap" class="ft2041"><b>VLAN&#160;</b></p>
<p style="position:absolute;top:263px;left:178px;white-space:nowrap" class="ft2047"><b>tagging<br/>module</b></p>
<p style="position:absolute;top:228px;left:271px;white-space:nowrap" class="ft2041"><b>Policy</b></p>
<p style="position:absolute;top:235px;left:270px;white-space:nowrap" class="ft2041"><b>Engine</b></p>
<p style="position:absolute;top:246px;left:265px;white-space:nowrap" class="ft2041"><b>vSwitches</b></p>
<p style="position:absolute;top:326px;left:344px;white-space:nowrap" class="ft2041"><b>eth0</b></p>
<p style="position:absolute;top:326px;left:384px;white-space:nowrap" class="ft2041"><b>eth0</b></p>
<p style="position:absolute;top:326px;left:302px;white-space:nowrap" class="ft2041"><b>vif2.0</b></p>
<p style="position:absolute;top:326px;left:265px;white-space:nowrap" class="ft2041"><b>vif1.0</b></p>
<p style="position:absolute;top:326px;left:232px;white-space:nowrap" class="ft2041"><b>eth0</b></p>
<p style="position:absolute;top:181px;left:194px;white-space:nowrap" class="ft2043"></p>
<p style="position:absolute;top:326px;left:159px;white-space:nowrap" class="ft2041"><b>eth0.</b></p>
<p style="position:absolute;top:322px;left:173px;white-space:nowrap" class="ft2044">α</p>
<p style="position:absolute;top:311px;left:336px;white-space:nowrap" class="ft2041"><b>front-end&#160;devices</b></p>
<p style="position:absolute;top:303px;left:262px;white-space:nowrap" class="ft2041"><b>back-end&#160;</b></p>
<p style="position:absolute;top:310px;left:265px;white-space:nowrap" class="ft2041"><b>devices</b></p>
<p style="position:absolute;top:306px;left:231px;white-space:nowrap" class="ft2047"><b>physical<br/>NIC</b></p>
<p style="position:absolute;top:384px;left:367px;white-space:nowrap" class="ft2041"><b>VLAN-capable</b></p>
<p style="position:absolute;top:391px;left:365px;white-space:nowrap" class="ft2041"><b>physical&#160;switch</b></p>
<p style="position:absolute;top:193px;left:530px;white-space:nowrap" class="ft2041"><b>Host&#160;B</b></p>
<p style="position:absolute;top:211px;left:595px;white-space:nowrap" class="ft2041"><b>Dom&#160;1</b></p>
<p style="position:absolute;top:211px;left:492px;white-space:nowrap" class="ft2041"><b>Dom&#160;0</b></p>
<p style="position:absolute;top:256px;left:520px;white-space:nowrap" class="ft2042">α</p>
<p style="position:absolute;top:258px;left:483px;white-space:nowrap" class="ft2041"><b>encap.</b></p>
<p style="position:absolute;top:265px;left:481px;white-space:nowrap" class="ft2041"><b>module</b></p>
<p style="position:absolute;top:256px;left:443px;white-space:nowrap" class="ft2041"><b>VLAN&#160;</b></p>
<p style="position:absolute;top:263px;left:441px;white-space:nowrap" class="ft2047"><b>tagging<br/>module</b></p>
<p style="position:absolute;top:228px;left:535px;white-space:nowrap" class="ft2041"><b>Policy</b></p>
<p style="position:absolute;top:235px;left:534px;white-space:nowrap" class="ft2041"><b>Engine</b></p>
<p style="position:absolute;top:246px;left:528px;white-space:nowrap" class="ft2041"><b>vSwitches</b></p>
<p style="position:absolute;top:326px;left:607px;white-space:nowrap" class="ft2041"><b>eth0</b></p>
<p style="position:absolute;top:326px;left:648px;white-space:nowrap" class="ft2041"><b>eth0</b></p>
<p style="position:absolute;top:326px;left:566px;white-space:nowrap" class="ft2041"><b>vif2.0</b></p>
<p style="position:absolute;top:326px;left:528px;white-space:nowrap" class="ft2041"><b>vif1.0</b></p>
<p style="position:absolute;top:326px;left:496px;white-space:nowrap" class="ft2041"><b>eth0</b></p>
<p style="position:absolute;top:181px;left:458px;white-space:nowrap" class="ft2043"></p>
<p style="position:absolute;top:311px;left:599px;white-space:nowrap" class="ft2041"><b>front-end&#160;devices</b></p>
<p style="position:absolute;top:303px;left:526px;white-space:nowrap" class="ft2041"><b>back-end&#160;</b></p>
<p style="position:absolute;top:310px;left:529px;white-space:nowrap" class="ft2041"><b>devices</b></p>
<p style="position:absolute;top:306px;left:495px;white-space:nowrap" class="ft2047"><b>physical<br/>NIC</b></p>
<p style="position:absolute;top:412px;left:219px;white-space:nowrap" class="ft2041"><b>Host&#160;C</b></p>
<p style="position:absolute;top:455px;left:232px;white-space:nowrap" class="ft2041"><b>eth0</b></p>
<p style="position:absolute;top:431px;left:213px;white-space:nowrap" class="ft2041"><b>physical&#160;NIC</b></p>
<p style="position:absolute;top:438px;left:207px;white-space:nowrap" class="ft2041"><b>(VLAN&#160;un-aware)</b></p>
<p style="position:absolute;top:397px;left:300px;white-space:nowrap" class="ft2041"><b>C</b></p>
<p style="position:absolute;top:397px;left:290px;white-space:nowrap" class="ft2041"><b>A1</b></p>
<p style="position:absolute;top:397px;left:439px;white-space:nowrap" class="ft2041"><b>C</b></p>
<p style="position:absolute;top:397px;left:428px;white-space:nowrap" class="ft2041"><b>B1</b></p>
<p style="position:absolute;top:473px;left:282px;white-space:nowrap" class="ft2041"><b>C</b></p>
<p style="position:absolute;top:473px;left:272px;white-space:nowrap" class="ft2041"><b>A1</b></p>
<p style="position:absolute;top:473px;left:340px;white-space:nowrap" class="ft2041"><b>C</b></p>
<p style="position:absolute;top:473px;left:330px;white-space:nowrap" class="ft2041"><b>B1</b></p>
<p style="position:absolute;top:374px;left:299px;white-space:nowrap" class="ft2041"><b>A1</b></p>
<p style="position:absolute;top:374px;left:291px;white-space:nowrap" class="ft2041"><b>C</b></p>
<p style="position:absolute;top:374px;left:437px;white-space:nowrap" class="ft2041"><b>B1</b></p>
<p style="position:absolute;top:374px;left:430px;white-space:nowrap" class="ft2041"><b>C</b></p>
<p style="position:absolute;top:450px;left:281px;white-space:nowrap" class="ft2041"><b>A1</b></p>
<p style="position:absolute;top:450px;left:273px;white-space:nowrap" class="ft2041"><b>C</b></p>
<p style="position:absolute;top:450px;left:339px;white-space:nowrap" class="ft2041"><b>B1</b></p>
<p style="position:absolute;top:450px;left:332px;white-space:nowrap" class="ft2041"><b>C</b></p>
<p style="position:absolute;top:213px;left:635px;white-space:nowrap" class="ft2041"><b>Dom&#160;2</b></p>
<p style="position:absolute;top:213px;left:371px;white-space:nowrap" class="ft2041"><b>Dom&#160;2</b></p>
<p style="position:absolute;top:258px;left:293px;white-space:nowrap" class="ft2045">β</p>
<p style="position:absolute;top:258px;left:557px;white-space:nowrap" class="ft2045">β</p>
<p style="position:absolute;top:325px;left:422px;white-space:nowrap" class="ft2041"><b>eth0.</b></p>
<p style="position:absolute;top:321px;left:436px;white-space:nowrap" class="ft2044">α</p>
<p style="position:absolute;top:510px;left:247px;white-space:nowrap" class="ft2011">Figure&#160;2.6:&#160;Prototype&#160;Implementation&#160;of&#160;the&#160;vSwitch.</p>
<p style="position:absolute;top:573px;left:150px;white-space:nowrap" class="ft2013">networking&#160;subsystem.&#160;The&#160;vSwitch&#160;consists&#160;of&#160;the&#160;general&#160;switch&#160;functionality,&#160;im-<br/>plementing&#160;the&#160;learning&#160;and&#160;ageing&#160;procedure&#160;for&#160;a&#160;table&#160;mapping&#160;MAC&#160;addresses&#160;to<br/>virtual&#160;ports.</p>
<p style="position:absolute;top:649px;left:150px;white-space:nowrap" class="ft2020"><b>Configuration</b></p>
<p style="position:absolute;top:677px;left:150px;white-space:nowrap" class="ft2012">The&#160;configuration&#160;of&#160;the&#160;vSwitch&#160;is&#160;also&#160;done&#160;within&#160;dom0.&#160;The&#160;vSwitch&#160;kernel&#160;module<br/>provides&#160;two&#160;interfaces,&#160;one&#160;for&#160;issuing&#160;configuration&#160;commands&#160;and&#160;another&#160;one&#160;for<br/>configuration&#160;examination.&#160;For&#160;configuration&#160;commands&#160;the&#160;vSwitch&#160;provides&#160;a&#160;device<br/>called</p>
<p style="position:absolute;top:731px;left:189px;white-space:nowrap" class="ft2046">/dev/hplvnet0</p>
<p style="position:absolute;top:731px;left:306px;white-space:nowrap" class="ft2011">,&#160;which&#160;can&#160;be&#160;used&#160;to&#160;issue&#160;the&#160;following&#160;<i>ioctl&#160;</i>commands:</p>
<p style="position:absolute;top:764px;left:150px;white-space:nowrap" class="ft2020"><b>VNET_IOC_ADD_NET&#160;</b>Create&#160;a&#160;new&#160;virtual&#160;network</p>
<p style="position:absolute;top:793px;left:150px;white-space:nowrap" class="ft2020"><b>VNET_IOC_DEL_NET&#160;</b>Delete&#160;a&#160;virtual&#160;network</p>
<p style="position:absolute;top:823px;left:150px;white-space:nowrap" class="ft2020"><b>VNET_IOC_ADD_PORT_IF&#160;</b>Assign&#160;a&#160;VM’s&#160;NIC&#160;to&#160;a&#160;VNet</p>
<p style="position:absolute;top:853px;left:150px;white-space:nowrap" class="ft2020"><b>VNET_IOC_DEL_PORT_IF&#160;</b>Remove&#160;a&#160;VM’s&#160;NIC&#160;of&#160;a&#160;VNet</p>
<p style="position:absolute;top:886px;left:172px;white-space:nowrap" class="ft2012">These&#160;commands&#160;allow&#160;a&#160;basic&#160;vSwitch&#160;management.<br/>The&#160;configuration&#160;can&#160;be&#160;examined&#160;through&#160;two&#160;<i>sysfs&#160;</i>directories&#160;located&#160;in</p>
<p style="position:absolute;top:923px;left:150px;white-space:nowrap" class="ft2046">/sys/class/vswitch/</p>
<p style="position:absolute;top:922px;left:331px;white-space:nowrap" class="ft2011">and</p>
<p style="position:absolute;top:923px;left:363px;white-space:nowrap" class="ft2046">/sys/class/vport/</p>
<p style="position:absolute;top:922px;left:516px;white-space:nowrap" class="ft2011">.</p>
<p style="position:absolute;top:922px;left:543px;white-space:nowrap" class="ft2011">The&#160;vSwitch&#160;class</p>
<p style="position:absolute;top:940px;left:150px;white-space:nowrap" class="ft2011">is&#160;ordered&#160;by&#160;VNet&#160;IDs,&#160;like</p>
<p style="position:absolute;top:941px;left:352px;white-space:nowrap" class="ft2046">/sys/class/vswitch/0x00000017/</p>
<p style="position:absolute;top:940px;left:629px;white-space:nowrap" class="ft2011">where</p>
<p style="position:absolute;top:958px;left:150px;white-space:nowrap" class="ft2012"><i>0x00000017&#160;</i>is&#160;the&#160;VNet&#160;ID&#160;23&#160;in&#160;hex,&#160;and&#160;each&#160;entry&#160;holds&#160;specific&#160;VNet&#160;information<br/>and&#160;links&#160;to&#160;the&#160;associated&#160;VM’s&#160;NICs&#160;such&#160;as</p>
<p style="position:absolute;top:977px;left:431px;white-space:nowrap" class="ft2046">/sys/class/vport/vif10.0/</p>
<p style="position:absolute;top:976px;left:656px;white-space:nowrap" class="ft2011">.</p>
<p style="position:absolute;top:994px;left:172px;white-space:nowrap" class="ft2011">These&#160;two&#160;interfaces&#160;are&#160;normally&#160;not&#160;used&#160;directly&#160;by&#160;the&#160;user,&#160;but&#160;through&#160;a&#160;bunch</p>
<p style="position:absolute;top:1012px;left:150px;white-space:nowrap" class="ft2012">of&#160;user&#160;land&#160;configuration&#160;tools.&#160;These&#160;tools&#160;provide&#160;an&#160;easy&#160;to&#160;use&#160;configuration&#160;in-<br/>terface,&#160;abstract&#160;the&#160;issuing&#160;of&#160;ioctl&#160;commands&#160;and&#160;interpret&#160;the&#160;hierarchy&#160;of&#160;the&#160;sysfs<br/>entries.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft2018">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 21 -->
<a name="21"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page21-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC021.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft2111">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft2111">19</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft2120"><b>vnet_add&#160;id&#160;saddr&#160;daddr&#160;</b>Create&#160;a&#160;new&#160;VNet&#160;with&#160;the&#160;given&#160;ID,&#160;source&#160;and&#160;destina-</p>
<p style="position:absolute;top:212px;left:263px;white-space:nowrap" class="ft2111">tion&#160;IP&#160;address</p>
<p style="position:absolute;top:241px;left:226px;white-space:nowrap" class="ft2120"><b>vnet_control&#160;</b>Interactive&#160;configuration&#160;shell</p>
<p style="position:absolute;top:271px;left:226px;white-space:nowrap" class="ft2120"><b>vnet_list&#160;</b>List&#160;all&#160;configured&#160;VNets</p>
<p style="position:absolute;top:301px;left:226px;white-space:nowrap" class="ft2120"><b>vnet_remove&#160;id&#160;</b>Remove&#160;VNet&#160;with&#160;given&#160;ID</p>
<p style="position:absolute;top:331px;left:226px;white-space:nowrap" class="ft2120"><b>vnet_show&#160;id&#160;</b>Show&#160;information&#160;of&#160;a&#160;VNet&#160;with&#160;the&#160;given&#160;ID</p>
<p style="position:absolute;top:361px;left:226px;white-space:nowrap" class="ft2120"><b>vport_add&#160;id&#160;devname&#160;</b>Add&#160;the&#160;VM’s&#160;NIC&#160;given&#160;by&#160;devname&#160;to&#160;a&#160;VNet&#160;with&#160;the</p>
<p style="position:absolute;top:379px;left:263px;white-space:nowrap" class="ft2111">given&#160;ID</p>
<p style="position:absolute;top:409px;left:226px;white-space:nowrap" class="ft2120"><b>vport_remove&#160;devname&#160;</b>Remove&#160;a&#160;VM’s&#160;NIC</p>
<p style="position:absolute;top:439px;left:226px;white-space:nowrap" class="ft2120"><b>vport_show&#160;devname&#160;</b>Show&#160;information&#160;of&#160;a&#160;VM’s&#160;NIC</p>
<p style="position:absolute;top:478px;left:226px;white-space:nowrap" class="ft2120"><b>Problems</b></p>
<p style="position:absolute;top:507px;left:226px;white-space:nowrap" class="ft2112">The&#160;main&#160;problem&#160;with&#160;this&#160;solution&#160;is&#160;that&#160;it&#160;operates&#160;within&#160;the&#160;privileged&#160;domain,<br/>which&#160;should&#160;be&#160;kept&#160;minimal&#160;and&#160;only&#160;for&#160;VM&#160;management&#160;purposes.&#160;For&#160;stronger<br/>isolation&#160;between&#160;the&#160;VMs,&#160;a&#160;disaggregation&#160;of&#160;dom0&#160;is&#160;desired&#160;by&#160;splitting&#160;up&#160;the<br/>functionality&#160;of&#160;dom0&#160;into&#160;several&#160;VMs.&#160;The&#160;future&#160;versions&#160;of&#160;the&#160;vSwitch&#160;prototype<br/>will&#160;focus&#160;on&#160;building&#160;a&#160;vSwitch&#160;as&#160;a&#160;lightweight&#160;VM&#160;only&#160;for&#160;networking&#160;purposes.</p>
<p style="position:absolute;top:624px;left:226px;white-space:nowrap" class="ft2122"><b>2.3</b></p>
<p style="position:absolute;top:624px;left:274px;white-space:nowrap" class="ft2134"><b>Management&#160;of&#160;Trusted&#160;Virtual&#160;Networking&#160;Do-<br/>mains</b></p>
<p style="position:absolute;top:689px;left:353px;white-space:nowrap" class="ft2111">S.&#160;Cabuk&#160;(HPL),&#160;K.&#160;Eriksson,&#160;H.&#160;Ramasamy,&#160;M.&#160;Schunter&#160;(IBM)</p>
<p style="position:absolute;top:722px;left:226px;white-space:nowrap" class="ft2113">We&#160;now&#160;describe&#160;the&#160;infrastructure&#160;for&#160;managing&#160;our&#160;virtual&#160;networks.&#160;The&#160;core&#160;con-<br/>cept&#160;is&#160;the&#160;notion&#160;of&#160;a&#160;Trusted&#160;Virtual&#160;Domain&#160;(TVD).&#160;The&#160;entities&#160;managing&#160;each&#160;TVD<br/>are&#160;called&#160;TVD&#160;Master&#160;and&#160;TVD&#160;proxy.</p>
<p style="position:absolute;top:776px;left:248px;white-space:nowrap" class="ft2111">The&#160;TVD&#160;master&#160;plays&#160;a&#160;central&#160;role&#160;in&#160;the&#160;management&#160;and&#160;auto-deployment&#160;of</p>
<p style="position:absolute;top:793px;left:226px;white-space:nowrap" class="ft2113">TVDs.&#160;There&#160;is&#160;one&#160;TVD&#160;master&#160;per&#160;TVD.&#160;We&#160;refer&#160;to&#160;the&#160;TVD&#160;master&#160;as&#160;a&#160;single<br/>logical&#160;entity,&#160;although&#160;its&#160;implementation&#160;may&#160;be&#160;a&#160;distributed&#160;one.&#160;The&#160;TVD&#160;master<br/>is&#160;trusted&#160;by&#160;the&#160;rest&#160;of&#160;the&#160;TVD&#160;infrastructure&#160;and&#160;the&#160;VPEs&#160;that&#160;are&#160;members&#160;of&#160;the<br/>TVD.&#160;Known&#160;techniques&#160;based&#160;on&#160;Trusted&#160;Computing&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#71">[36]&#160;</a>can&#160;be&#160;used&#160;to&#160;determine<br/>the&#160;trustworthiness&#160;of&#160;the&#160;TVD&#160;master&#160;by&#160;verifying&#160;its&#160;software&#160;configuration.&#160;The<br/>TVD&#160;master&#160;can&#160;be&#160;hosted&#160;on&#160;a&#160;physical&#160;machine&#160;or&#160;a&#160;virtual&#160;machine.&#160;In&#160;the&#160;case&#160;of&#160;a<br/>VM&#160;implementation,&#160;the&#160;PEV&#160;(protection,&#160;enforcement,&#160;verification)&#160;architecture&#160;pro-<br/>posed&#160;by&#160;Jansen&#160;et.&#160;al.&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#70">[14]&#160;</a>can&#160;be&#160;used&#160;to&#160;obtain&#160;policy&#160;enforcement&#160;and&#160;compliance<br/>proofs&#160;for&#160;the&#160;purpose&#160;of&#160;assessing&#160;the&#160;TVD&#160;master’s&#160;trustworthiness.</p>
<p style="position:absolute;top:955px;left:248px;white-space:nowrap" class="ft2111">The&#160;TVD&#160;policy&#160;is&#160;defined&#160;at&#160;the&#160;TVD&#160;master&#160;by&#160;the&#160;system&#160;administrator&#160;(e.g.,</p>
<p style="position:absolute;top:973px;left:226px;white-space:nowrap" class="ft2113">the&#160;administrator&#160;of&#160;a&#160;data&#160;center&#160;hosting&#160;multiple&#160;TVDs,&#160;each&#160;belonging&#160;to&#160;a&#160;different<br/>customer).&#160;The&#160;TVD&#160;master&#160;has&#160;the&#160;following&#160;main&#160;responsibilities:</p>
<p style="position:absolute;top:1039px;left:245px;white-space:nowrap" class="ft2111">1.&#160;distributing&#160;the&#160;TVD&#160;policy&#160;and&#160;other&#160;TVD&#160;credentials&#160;(such&#160;as&#160;VPN&#160;key)&#160;to&#160;the</p>
<p style="position:absolute;top:1057px;left:263px;white-space:nowrap" class="ft2111">TVD&#160;proxies&#160;and&#160;informing&#160;them&#160;of&#160;any&#160;updates,</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft2118">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 22 -->
<a name="22"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page22-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC022.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft2211">20</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft2218">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:194px;left:168px;white-space:nowrap" class="ft2211">2.&#160;determining&#160;the&#160;suitability&#160;of&#160;a&#160;platform&#160;to&#160;host&#160;a&#160;TVD&#160;proxy&#160;(described&#160;below),</p>
<p style="position:absolute;top:212px;left:187px;white-space:nowrap" class="ft2212">and&#160;thereafter,&#160;periodically&#160;assessing&#160;the&#160;platform’s&#160;continued&#160;suitability&#160;to&#160;host<br/>VPEs&#160;belonging&#160;to&#160;the&#160;TVD,</p>
<p style="position:absolute;top:259px;left:168px;white-space:nowrap" class="ft2211">3.&#160;maintaining&#160;an&#160;up-to-date&#160;view&#160;of&#160;the&#160;TVD&#160;membership,&#160;which&#160;includes&#160;a&#160;list</p>
<p style="position:absolute;top:277px;left:187px;white-space:nowrap" class="ft2211">of&#160;TVD&#160;proxies&#160;and&#160;the&#160;VPEs&#160;hosted&#160;on&#160;their&#160;respective&#160;platforms.</p>
<p style="position:absolute;top:347px;left:150px;white-space:nowrap" class="ft2220"><b>TVD&#160;proxy</b></p>
<p style="position:absolute;top:347px;left:238px;white-space:nowrap" class="ft2211">On&#160;every&#160;host&#160;that&#160;may&#160;potentially&#160;host&#160;a&#160;VM&#160;belonging&#160;to&#160;the&#160;TVD,</p>
<p style="position:absolute;top:365px;left:150px;white-space:nowrap" class="ft2212">there&#160;is&#160;a&#160;local&#160;delegate&#160;of&#160;the&#160;TVD&#160;master,&#160;called&#160;the&#160;<i>TVD&#160;proxy</i>.&#160;Like&#160;the&#160;TVD<br/>master,&#160;the&#160;TVD&#160;proxy&#160;is&#160;also&#160;trusted.&#160;The&#160;TVD&#160;proxy&#160;is&#160;the&#160;local&#160;enforcer&#160;of&#160;the<br/>TVD&#160;policies&#160;on&#160;a&#160;given&#160;physical&#160;platform.&#160;At&#160;the&#160;time&#160;of&#160;its&#160;creation,&#160;the&#160;TVD&#160;proxy<br/>receives&#160;the&#160;TVD&#160;policy&#160;from&#160;the&#160;TVD&#160;master.&#160;Upon&#160;an&#160;update&#160;to&#160;the&#160;TVD&#160;policy&#160;(by<br/>a&#160;system&#160;administrator),&#160;renewal&#160;of&#160;TVD&#160;credentials,&#160;or&#160;refresh&#160;of&#160;TVD&#160;VPN&#160;keys&#160;at<br/>the&#160;TVD&#160;master,&#160;the&#160;master&#160;conveys&#160;the&#160;update&#160;to&#160;the&#160;TVD&#160;proxies.</p>
<p style="position:absolute;top:473px;left:172px;white-space:nowrap" class="ft2211">The&#160;TVD&#160;proxies&#160;on&#160;a&#160;given&#160;platform&#160;are&#160;independent.&#160;Although&#160;TVD&#160;proxies</p>
<p style="position:absolute;top:490px;left:150px;white-space:nowrap" class="ft2213">are&#160;trusted,&#160;TVD&#160;proxies&#160;on&#160;the&#160;same&#160;platform&#160;should&#160;be&#160;sufficiently&#160;isolated&#160;from<br/>each&#160;other.&#160;For&#160;example,&#160;a&#160;TVD&#160;proxy&#160;should&#160;not&#160;be&#160;able&#160;to&#160;access&#160;private&#160;TVD<br/>information&#160;(such&#160;as&#160;policies,&#160;certificates,&#160;and&#160;VPN&#160;keys)&#160;belonging&#160;to&#160;another&#160;TVD<br/>proxy.&#160;For&#160;improved&#160;isolation,&#160;each&#160;TVD&#160;proxy&#160;on&#160;the&#160;platform&#160;may&#160;be&#160;hosted&#160;in<br/>a&#160;separate&#160;<i>infrastructure&#160;</i>VM,&#160;which&#160;is&#160;different&#160;from&#160;a&#160;VM&#160;hosting&#160;regular&#160;services,<br/>called&#160;<i>production&#160;</i>VM.&#160;On&#160;a&#160;platform&#160;with&#160;the&#160;Trusted&#160;Platform&#160;Module&#160;or&#160;TPM&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#71">[37]</a>,<br/>isolation&#160;can&#160;further&#160;be&#160;improved&#160;by&#160;TPM&#160;virtualisation&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#69">[3]</a>,&#160;assigning&#160;a&#160;separate&#160;virtual<br/>TPM&#160;to&#160;each&#160;infrastructure&#160;VM,&#160;and&#160;using&#160;the&#160;virtual&#160;TPM&#160;as&#160;the&#160;basis&#160;for&#160;storing<br/>private&#160;TVD&#160;information.</p>
<p style="position:absolute;top:652px;left:172px;white-space:nowrap" class="ft2211">A&#160;TVD&#160;proxy&#160;must&#160;only&#160;be&#160;able&#160;to&#160;interact&#160;with&#160;VMs&#160;hosted&#160;on&#160;the&#160;platform&#160;be-</p>
<p style="position:absolute;top:670px;left:150px;white-space:nowrap" class="ft2213">longing&#160;to&#160;the&#160;same&#160;TVD.&#160;As&#160;we&#160;describe&#160;below,&#160;that&#160;requirement&#160;is&#160;enforced&#160;by&#160;the<br/>Local&#160;Common&#160;TVD&#160;Coordinator&#160;(LCTC).</p>
<p style="position:absolute;top:706px;left:172px;white-space:nowrap" class="ft2211">The&#160;main&#160;responsibilities&#160;of&#160;the&#160;TVD&#160;proxy&#160;are:</p>
<p style="position:absolute;top:736px;left:150px;white-space:nowrap" class="ft2220"><b>Configuration&#160;of&#160;the&#160;Local&#160;TVD&#160;vSwitch&#160;</b>The&#160;TVD&#160;proxy&#160;configures&#160;the&#160;local&#160;TVD</p>
<p style="position:absolute;top:754px;left:187px;white-space:nowrap" class="ft2213">vSwitch&#160;based&#160;on&#160;the&#160;TVD&#160;policy.&#160;For&#160;example,&#160;if&#160;the&#160;TVD&#160;policy&#160;specifies&#160;that<br/>information&#160;confidentiality&#160;is&#160;an&#160;objective,&#160;then&#160;the&#160;TVD&#160;proxy&#160;enables&#160;all&#160;traffic<br/>through&#160;the&#160;vSwitch&#160;to&#160;pass&#160;through&#160;the&#160;VPN&#160;module&#160;and&#160;provides&#160;the&#160;VPN&#160;key<br/>to&#160;the&#160;module.</p>
<p style="position:absolute;top:837px;left:150px;white-space:nowrap" class="ft2220"><b>Maintenance&#160;of&#160;Private&#160;TVD&#160;Information&#160;</b>The&#160;TVD&#160;proxy&#160;maintains&#160;private&#160;TVD</p>
<p style="position:absolute;top:855px;left:187px;white-space:nowrap" class="ft2211">information&#160;such&#160;as&#160;policies,&#160;certificates,&#160;and&#160;VPN&#160;keys.</p>
<p style="position:absolute;top:885px;left:150px;white-space:nowrap" class="ft2220"><b>Status&#160;Reports&#160;to&#160;the&#160;TVD&#160;Master&#160;</b>Upon&#160;request&#160;or&#160;periodically,&#160;the&#160;TVD&#160;proxy</p>
<p style="position:absolute;top:903px;left:187px;white-space:nowrap" class="ft2213">provides&#160;a&#160;platform&#160;status&#160;report&#160;to&#160;the&#160;TVD&#160;master.&#160;The&#160;report&#160;includes&#160;in-<br/>formation&#160;such&#160;as&#160;the&#160;number&#160;of&#160;VMs&#160;belonging&#160;to&#160;the&#160;TVD&#160;and&#160;their&#160;unique<br/>addressable&#160;identifiers&#160;and&#160;the&#160;current&#160;vSwitch&#160;configuration.&#160;The&#160;status&#160;report<br/>also&#160;serves&#160;as&#160;an&#160;“I&#160;am&#160;alive”&#160;message&#160;to&#160;the&#160;TVD&#160;master,&#160;and&#160;helps&#160;the&#160;TVD<br/>master&#160;to&#160;keep&#160;an&#160;updated&#160;list&#160;of&#160;TVD&#160;proxies&#160;that&#160;are&#160;connected&#160;to&#160;it.</p>
<p style="position:absolute;top:1004px;left:150px;white-space:nowrap" class="ft2220"><b>Enforcement&#160;of&#160;Admission&#160;Requirements&#160;for&#160;VMs&#160;into&#160;the&#160;TVD&#160;</b>A&#160;VM’s&#160;virtual</p>
<p style="position:absolute;top:1022px;left:187px;white-space:nowrap" class="ft2212">NIC&#160;is&#160;attached&#160;to&#160;a&#160;vSwitch&#160;only&#160;after&#160;the&#160;TVD&#160;proxy&#160;checks&#160;that&#160;the&#160;VM<br/>satisfies&#160;TVD&#160;membership&#160;requirements.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft2218">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 23 -->
<a name="23"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page23-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC023.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft2311">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft2311">21</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft2320"><b>Enforcement&#160;of&#160;Co-Location&#160;Restrictions&#160;</b>The&#160;Local&#160;Common&#160;TVD&#160;Coordinator</p>
<p style="position:absolute;top:212px;left:263px;white-space:nowrap" class="ft2312">(LCTC)&#160;checks&#160;with&#160;each&#160;TVD&#160;proxy&#160;already&#160;existing&#160;on&#160;the&#160;platform&#160;for&#160;co-<br/>location&#160;compatibility&#160;before&#160;instantiating&#160;a&#160;new&#160;TVD&#160;proxy.</p>
<p style="position:absolute;top:259px;left:226px;white-space:nowrap" class="ft2320"><b>Enforcement&#160;of&#160;Multi-TVD&#160;Membership&#160;Restrictions&#160;</b>A&#160;VM&#160;may&#160;belong&#160;to&#160;multi-</p>
<p style="position:absolute;top:277px;left:263px;white-space:nowrap" class="ft2312">ple&#160;TVDs&#160;simultaneously.&#160;However,&#160;approval&#160;from&#160;TVD&#160;proxies&#160;corresponding<br/>to&#160;the&#160;TVDs&#160;in&#160;which&#160;the&#160;VM&#160;holds&#160;membership&#160;is&#160;needed&#160;before&#160;the&#160;VM&#160;can<br/>join&#160;a&#160;new&#160;TVD.</p>
<p style="position:absolute;top:343px;left:226px;white-space:nowrap" class="ft2320"><b>Continuous&#160;Enforcement&#160;of&#160;TVD&#160;Policy&#160;</b>The&#160;TVD&#160;proxy&#160;is&#160;responsible&#160;for&#160;contin-</p>
<p style="position:absolute;top:361px;left:263px;white-space:nowrap" class="ft2313">uous&#160;enforcement&#160;of&#160;the&#160;TVD&#160;policy&#160;despite&#160;updates&#160;to&#160;the&#160;policy&#160;and&#160;changing<br/>configuration&#160;of&#160;the&#160;platform&#160;and&#160;member&#160;VMs.&#160;Upon&#160;receiving&#160;an&#160;update&#160;to<br/>the&#160;TVD&#160;policy&#160;from&#160;the&#160;TVD&#160;master,&#160;the&#160;TVD&#160;proxy&#160;may&#160;re-configure&#160;the<br/>vSwitch,&#160;and&#160;re-assess&#160;member&#160;VMs’&#160;status&#160;to&#160;reflect&#160;the&#160;updated&#160;policy.&#160;Even<br/>without&#160;any&#160;policy&#160;update,&#160;the&#160;TVD&#160;proxy&#160;may&#160;be&#160;required&#160;by&#160;the&#160;TVD&#160;policy<br/>to&#160;periodically&#160;do&#160;such&#160;re-configuration&#160;and&#160;re-assessment.</p>
<p style="position:absolute;top:490px;left:226px;white-space:nowrap" class="ft2320"><b>Local&#160;Common&#160;TVD&#160;Coordinator&#160;(LCTC)</b></p>
<p style="position:absolute;top:490px;left:512px;white-space:nowrap" class="ft2311">The&#160;Local&#160;Common&#160;TVD&#160;Coordinator</p>
<p style="position:absolute;top:508px;left:226px;white-space:nowrap" class="ft2313">or&#160;LCTC&#160;is&#160;present&#160;on&#160;every&#160;platform&#160;(hence,&#160;the&#160;word&#160;<i>local&#160;</i>in&#160;the&#160;name)&#160;on&#160;which&#160;a<br/>TVD&#160;element&#160;has&#160;to&#160;be&#160;hosted.&#160;The&#160;LCTC&#160;itself&#160;does&#160;not&#160;belong&#160;to&#160;any&#160;single&#160;TVD<br/>(hence,&#160;the&#160;word&#160;<i>common&#160;</i>in&#160;the&#160;name).&#160;The&#160;LCTC&#160;is&#160;part&#160;of&#160;the&#160;minimal&#160;TC<a href="Open_TC_D05.2_SecServicesPoC.html#23">B</a></p>
<p style="position:absolute;top:542px;left:716px;white-space:nowrap" class="ft2329"><a href="Open_TC_D05.2_SecServicesPoC.html#23">1</a></p>
<p style="position:absolute;top:544px;left:727px;white-space:nowrap" class="ft2311">on</p>
<p style="position:absolute;top:562px;left:226px;white-space:nowrap" class="ft2311">every&#160;TVD-enabled&#160;platform.</p>
<p style="position:absolute;top:580px;left:248px;white-space:nowrap" class="ft2311">The&#160;LCTC&#160;is&#160;the&#160;entity&#160;that&#160;a&#160;TVD&#160;master&#160;or&#160;a&#160;system&#160;administrator&#160;contacts&#160;to</p>
<p style="position:absolute;top:598px;left:226px;white-space:nowrap" class="ft2313">create&#160;a&#160;new&#160;TVD&#160;proxy&#160;on&#160;the&#160;platform.&#160;For&#160;this&#160;purpose,&#160;the&#160;LCTC&#160;must&#160;be&#160;made<br/>publicly&#160;addressable&#160;and&#160;knowledgeable&#160;about&#160;the&#160;identities&#160;of&#160;the&#160;entities&#160;that&#160;may<br/>potentially&#160;request&#160;the&#160;creation.</p>
<p style="position:absolute;top:652px;left:248px;white-space:nowrap" class="ft2311">The&#160;LCTC&#160;has&#160;three&#160;main&#160;responsibilities,&#160;namely&#160;(1)&#160;creation&#160;of&#160;new&#160;TVD&#160;proxies</p>
<p style="position:absolute;top:670px;left:226px;white-space:nowrap" class="ft2313">on&#160;the&#160;local&#160;platform,&#160;(2)&#160;determining&#160;whether&#160;a&#160;new&#160;TVD&#160;proxy&#160;can&#160;be&#160;co-hosted<br/>along&#160;with&#160;TVD&#160;proxies&#160;already&#160;existing&#160;on&#160;the&#160;platform,&#160;and&#160;(3)&#160;restricting&#160;access&#160;of<br/>TVD&#160;proxies&#160;only&#160;to&#160;VMs&#160;belonging&#160;to&#160;their&#160;respective&#160;TVDs.&#160;The&#160;LCTC&#160;maintains&#160;a<br/>list&#160;of&#160;VMs&#160;currently&#160;hosted&#160;on&#160;the&#160;platform,&#160;a&#160;list&#160;of&#160;TVD&#160;proxies&#160;currently&#160;hosted&#160;on<br/>the&#160;platform,&#160;and&#160;a&#160;mapping&#160;between&#160;the&#160;VMs&#160;and&#160;the&#160;TVDs&#160;they&#160;belong&#160;to.</p>
<p style="position:absolute;top:759px;left:248px;white-space:nowrap" class="ft2311">The&#160;actual&#160;creation&#160;of&#160;the&#160;TVD&#160;proxy&#160;is&#160;preceded&#160;by&#160;a&#160;<i>prepare&#160;phase</i>,&#160;which&#160;in-</p>
<p style="position:absolute;top:777px;left:226px;white-space:nowrap" class="ft2311">volves</p>
<p style="position:absolute;top:807px;left:245px;white-space:nowrap" class="ft2311">1.&#160;Mutual&#160;authentication&#160;and&#160;authorisation&#160;between&#160;the&#160;LCTC&#160;and&#160;the&#160;entity&#160;(e.g.,</p>
<p style="position:absolute;top:825px;left:263px;white-space:nowrap" class="ft2312">the&#160;TVD&#160;master&#160;or&#160;system&#160;administrator)&#160;requesting&#160;the&#160;creation&#160;of&#160;the&#160;TVD<br/>proxy,</p>
<p style="position:absolute;top:873px;left:245px;white-space:nowrap" class="ft2311">2.&#160;Determining&#160;the&#160;suitability&#160;of&#160;the&#160;platform&#160;for&#160;hosting&#160;the&#160;new&#160;TVD&#160;proxy,&#160;from</p>
<p style="position:absolute;top:891px;left:263px;white-space:nowrap" class="ft2312">the&#160;point&#160;of&#160;view&#160;of&#160;both&#160;the&#160;requesting&#160;TVD&#160;master&#160;and&#160;the&#160;TVDs&#160;already<br/>hosted&#160;on&#160;the&#160;platform.</p>
<p style="position:absolute;top:939px;left:248px;white-space:nowrap" class="ft2311">The&#160;second&#160;step&#160;above&#160;involves&#160;determining&#160;whether&#160;a&#160;new&#160;TVD&#160;proxy&#160;can&#160;be</p>
<p style="position:absolute;top:957px;left:226px;white-space:nowrap" class="ft2312">co-hosted&#160;along&#160;with&#160;TVD&#160;proxies&#160;already&#160;existing&#160;on&#160;the&#160;platform.&#160;The&#160;LCTC&#160;is&#160;a<br/>thin&#160;implementation;&#160;it&#160;simply&#160;asks&#160;each&#160;TVD&#160;proxy&#160;whether&#160;a&#160;new&#160;TVD&#160;proxy&#160;can<br/>be&#160;co-hosted&#160;on&#160;the&#160;platform.&#160;Based&#160;on&#160;their&#160;internal&#160;security&#160;policies,&#160;the&#160;individual<br/>TVD&#160;proxies&#160;simply&#160;return&#160;a&#160;“yes”&#160;or&#160;“no”&#160;answer.&#160;The&#160;LCTC&#160;replies&#160;positively&#160;to&#160;the</p>
<p style="position:absolute;top:1037px;left:242px;white-space:nowrap" class="ft2331">1</p>
<p style="position:absolute;top:1039px;left:248px;white-space:nowrap" class="ft2316">On&#160;a&#160;Xen-based&#160;platform,&#160;the&#160;minimal&#160;TCB&#160;consists&#160;of&#160;the&#160;LCTC,&#160;Xen&#160;Dom0,&#160;the&#160;Xen&#160;hypervisor,&#160;and</p>
<p style="position:absolute;top:1054px;left:226px;white-space:nowrap" class="ft2316">the&#160;underlying&#160;hardware.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft2318">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 24 -->
<a name="24"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2448{font-size:14px;font-family:Helvetica;color:#000000;}
	.ft2449{font-size:9px;font-family:Helvetica;color:#000000;}
	.ft2450{font-size:14px;font-family:Helvetica;color:#000000;}
	.ft2451{font-size:13px;font-family:KPSHBO+TT22EAo00;color:#000000;}
	.ft2452{font-size:15px;line-height:17px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page24-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC024.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft2411">22</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft2418">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:224px;left:468px;white-space:nowrap" class="ft2448">TVD&#160;Master</p>
<p style="position:absolute;top:206px;left:347px;white-space:nowrap" class="ft2448">DomU</p>
<p style="position:absolute;top:206px;left:277px;white-space:nowrap" class="ft2448">Dom0</p>
<p style="position:absolute;top:320px;left:271px;white-space:nowrap" class="ft2449"><b>TVD&#160;proxy</b></p>
<p style="position:absolute;top:258px;left:267px;white-space:nowrap" class="ft2449"><b>TVD-specific</b></p>
<p style="position:absolute;top:270px;left:277px;white-space:nowrap" class="ft2449"><b>Modules</b></p>
<p style="position:absolute;top:236px;left:263px;white-space:nowrap" class="ft2449"><b>EtherIP&#160;VLAN</b></p>
<p style="position:absolute;top:291px;left:304px;white-space:nowrap" class="ft2450"><b>…..</b></p>
<p style="position:absolute;top:287px;left:264px;white-space:nowrap" class="ft2449"><b>Policy&#160;</b></p>
<p style="position:absolute;top:298px;left:264px;white-space:nowrap" class="ft2449"><b>Engine</b></p>
<p style="position:absolute;top:258px;left:267px;white-space:nowrap" class="ft2449"><b>TVD-specific</b></p>
<p style="position:absolute;top:270px;left:277px;white-space:nowrap" class="ft2449"><b>Modules</b></p>
<p style="position:absolute;top:236px;left:263px;white-space:nowrap" class="ft2449"><b>EtherIP&#160;VLAN</b></p>
<p style="position:absolute;top:291px;left:304px;white-space:nowrap" class="ft2450"><b>…..</b></p>
<p style="position:absolute;top:287px;left:264px;white-space:nowrap" class="ft2449"><b>Policy&#160;</b></p>
<p style="position:absolute;top:298px;left:264px;white-space:nowrap" class="ft2449"><b>Engine</b></p>
<p style="position:absolute;top:327px;left:351px;white-space:nowrap" class="ft2449"><b>vNICs</b></p>
<p style="position:absolute;top:335px;left:360px;white-space:nowrap" class="ft2450"><b>…</b></p>
<p style="position:absolute;top:387px;left:279px;white-space:nowrap" class="ft2449"><b>0</b></p>
<p style="position:absolute;top:387px;left:294px;white-space:nowrap" class="ft2449"><b>TVD&#160;object&#160;</b></p>
<p style="position:absolute;top:382px;left:346px;white-space:nowrap" class="ft2451">←</p>
<p style="position:absolute;top:387px;left:362px;white-space:nowrap" class="ft2449"><b>create&#160;TVD&#160;(TVD&#160;requirements,&#160;policy&#160;model)</b></p>
<p style="position:absolute;top:404px;left:294px;white-space:nowrap" class="ft2449"><b>create&#160;TVD&#160;Proxy&#160;(Master&#160;URL)</b></p>
<p style="position:absolute;top:406px;left:279px;white-space:nowrap" class="ft2449"><b>1</b></p>
<p style="position:absolute;top:325px;left:505px;white-space:nowrap" class="ft2449"><b>0</b></p>
<p style="position:absolute;top:425px;left:279px;white-space:nowrap" class="ft2449"><b>2</b></p>
<p style="position:absolute;top:423px;left:294px;white-space:nowrap" class="ft2449"><b>connect&#160;VM&#160;to&#160;TVD&#160;(TVD&#160;object)</b></p>
<p style="position:absolute;top:335px;left:322px;white-space:nowrap" class="ft2449"><b>1</b></p>
<p style="position:absolute;top:354px;left:430px;white-space:nowrap" class="ft2449"><b>1</b></p>
<p style="position:absolute;top:292px;left:364px;white-space:nowrap" class="ft2449"><b>2</b></p>
<p style="position:absolute;top:459px;left:292px;white-space:nowrap" class="ft2411">Figure&#160;2.7:&#160;Steps&#160;in&#160;Populating&#160;a&#160;TVD</p>
<p style="position:absolute;top:522px;left:150px;white-space:nowrap" class="ft2413">requesting&#160;TVD&#160;master&#160;only&#160;if&#160;all&#160;TVD&#160;proxies&#160;said&#160;“yes”;&#160;otherwise,&#160;it&#160;returns&#160;a&#160;neg-<br/>ative&#160;reply&#160;to&#160;the&#160;requesting&#160;TVD&#160;master.&#160;The&#160;LCTC&#160;includes&#160;a&#160;list&#160;of&#160;existing&#160;TVD<br/>proxies&#160;with&#160;a&#160;positive&#160;response.&#160;Additionally,&#160;if&#160;required,&#160;the&#160;LCTC&#160;may&#160;include&#160;the<br/>attestation&#160;of&#160;the&#160;platform&#160;characteristics&#160;along&#160;with&#160;a&#160;positive&#160;response.&#160;The&#160;prepare<br/>phase&#160;concludes&#160;with&#160;the&#160;response&#160;from&#160;the&#160;LCTC.&#160;Based&#160;on&#160;the&#160;response,&#160;the&#160;request-<br/>ing&#160;TVD&#160;master&#160;can&#160;determine&#160;whether&#160;its&#160;own&#160;policies&#160;allow&#160;co-hosting&#160;with&#160;the&#160;list<br/>of&#160;existing&#160;TVD&#160;proxies&#160;on&#160;the&#160;platform&#160;and&#160;whether&#160;the&#160;platform&#160;configuration&#160;is&#160;in<br/>accordance&#160;with&#160;the&#160;TVD&#160;requirements.&#160;If&#160;that&#160;is&#160;the&#160;case,&#160;then&#160;the&#160;TVD&#160;master&#160;sends<br/>a&#160;request&#160;to&#160;the&#160;LCTC&#160;to&#160;start&#160;the&#160;TVD&#160;proxy&#160;along&#160;with&#160;its&#160;own&#160;URL.&#160;In&#160;this&#160;way,&#160;the<br/>conflict&#160;manager&#160;helps&#160;ensure&#160;that&#160;a&#160;new&#160;TVD&#160;proxy&#160;is&#160;hosted&#160;on&#160;the&#160;platform&#160;only&#160;if<br/>it&#160;is&#160;compatible&#160;with&#160;the&#160;policies&#160;of&#160;TVDs&#160;already&#160;hosted&#160;on&#160;the&#160;platform&#160;as&#160;well&#160;as<br/>with&#160;those&#160;of&#160;the&#160;new&#160;TVD.</p>
<p style="position:absolute;top:737px;left:172px;white-space:nowrap" class="ft2411">The&#160;LCTC&#160;does&#160;the&#160;actual&#160;creation&#160;of&#160;the&#160;TVD&#160;proxy,&#160;and&#160;initialises&#160;the&#160;proxy</p>
<p style="position:absolute;top:755px;left:150px;white-space:nowrap" class="ft2412">with&#160;the&#160;TVD&#160;master’s&#160;URL.&#160;Thereafter,&#160;the&#160;TVD&#160;proxy&#160;contacts&#160;the&#160;TVD&#160;master<br/>and&#160;establishes&#160;a&#160;direct&#160;secure,&#160;authenticated&#160;communication&#160;channel&#160;(using&#160;standard<br/>techniques&#160;like&#160;IPSec&#160;or&#160;TLS)&#160;with&#160;the&#160;TVD&#160;master&#160;bypassing&#160;the&#160;LCTC.&#160;The&#160;TVD<br/>proxy&#160;obtains&#160;the&#160;TVD&#160;policy&#160;and&#160;other&#160;credentials&#160;from&#160;the&#160;TVD&#160;master&#160;through&#160;the<br/>channel,&#160;and&#160;configures&#160;the&#160;networking&#160;components&#160;according&#160;to&#160;TVD&#160;policy.</p>
<p style="position:absolute;top:868px;left:150px;white-space:nowrap" class="ft2433"><b>2.3.1</b></p>
<p style="position:absolute;top:868px;left:204px;white-space:nowrap" class="ft2433"><b>Auto-deployment&#160;of&#160;TVDs</b></p>
<p style="position:absolute;top:898px;left:150px;white-space:nowrap" class="ft2413">Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#25">2.8&#160;</a>shows&#160;the&#160;steps&#160;involved&#160;in&#160;automatic&#160;deployment&#160;of&#160;secure&#160;virtual&#160;infras-<br/>tructures&#160;as&#160;TVD&#160;configurations.&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#24">2.7&#160;</a>shows&#160;the&#160;steps&#160;involved&#160;in&#160;the&#160;establish-<br/>ment&#160;and&#160;management&#160;of&#160;a&#160;single&#160;TVD.</p>
<p style="position:absolute;top:952px;left:172px;white-space:nowrap" class="ft2411">First,&#160;the&#160;virtual&#160;infrastructure&#160;topology&#160;must&#160;be&#160;decomposed&#160;into&#160;constituent</p>
<p style="position:absolute;top:970px;left:150px;white-space:nowrap" class="ft2412">TVDs,&#160;along&#160;with&#160;associated&#160;security&#160;requirements&#160;and&#160;policy&#160;model.&#160;Second,&#160;a&#160;<i>capa-<br/>bility&#160;model&#160;</i>of&#160;the&#160;physical&#160;infrastructure&#160;must&#160;be&#160;developed.&#160;Capability&#160;modelling&#160;is<br/>essentially&#160;the&#160;step&#160;of&#160;taking&#160;stock&#160;of&#160;existing&#160;mechanisms&#160;that&#160;can&#160;be&#160;directly&#160;used&#160;to<br/>satisfy&#160;the&#160;TVD&#160;security&#160;requirements.&#160;In&#160;this&#160;paper,&#160;we&#160;consider&#160;the&#160;case&#160;where&#160;both<br/>steps&#160;are&#160;done&#160;manually&#160;in&#160;an&#160;offline&#160;manner;&#160;future&#160;extensions&#160;will&#160;focus&#160;on&#160;automat-<br/>ing&#160;them&#160;and&#160;on&#160;dynamically&#160;changing&#160;the&#160;capability&#160;models&#160;based&#160;on&#160;actual&#160;changes</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft2418">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 25 -->
<a name="25"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2553{font-size:9px;font-family:Helvetica;color:#000000;}
	.ft2554{font-size:15px;font-family:FARLYM+CMMI10;color:#231f20;}
	.ft2555{font-size:15px;font-family:ONMFZM+CMR10;color:#231f20;}
	.ft2556{font-size:9px;line-height:10px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page25-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC025.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft2511">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft2511">23</p>
<p style="position:absolute;top:222px;left:481px;white-space:nowrap" class="ft2553">Security&#160;</p>
<p style="position:absolute;top:233px;left:486px;white-space:nowrap" class="ft2553">Policy</p>
<p style="position:absolute;top:276px;left:480px;white-space:nowrap" class="ft2553">Per-host&#160;</p>
<p style="position:absolute;top:287px;left:476px;white-space:nowrap" class="ft2553">Extensions</p>
<p style="position:absolute;top:329px;left:484px;white-space:nowrap" class="ft2553">Global&#160;</p>
<p style="position:absolute;top:340px;left:471px;white-space:nowrap" class="ft2553">Configuration</p>
<p style="position:absolute;top:193px;left:501px;white-space:nowrap" class="ft2556">TVD&#160;<br/>Requirements</p>
<p style="position:absolute;top:250px;left:501px;white-space:nowrap" class="ft2556">Mechanisms<br/>Required</p>
<p style="position:absolute;top:303px;left:501px;white-space:nowrap" class="ft2556">Deployment&#160;Planning&#160;<br/>&amp;&#160;Management</p>
<p style="position:absolute;top:222px;left:415px;white-space:nowrap" class="ft2553">TVD&#160;Policy</p>
<p style="position:absolute;top:232px;left:425px;white-space:nowrap" class="ft2553">Model</p>
<p style="position:absolute;top:275px;left:420px;white-space:nowrap" class="ft2553">Capability</p>
<p style="position:absolute;top:286px;left:428px;white-space:nowrap" class="ft2553">Model</p>
<p style="position:absolute;top:358px;left:397px;white-space:nowrap" class="ft2556">Revised&#160;Requirements,&#160;<br/>Policies,&#160;or&#160;Capabilities</p>
<p style="position:absolute;top:403px;left:339px;white-space:nowrap" class="ft2511">Figure&#160;2.8:&#160;Steps&#160;in&#160;Auto-Deployment&#160;of&#160;TVDs.</p>
<p style="position:absolute;top:466px;left:226px;white-space:nowrap" class="ft2511">to&#160;the&#160;capabilities.</p>
<p style="position:absolute;top:506px;left:226px;white-space:nowrap" class="ft2520"><b>Capability&#160;Modelling&#160;of&#160;the&#160;Physical&#160;Infra-structure</b></p>
<p style="position:absolute;top:534px;left:226px;white-space:nowrap" class="ft2512">Capability&#160;modelling&#160;of&#160;the&#160;physical&#160;infrastructure&#160;considers&#160;both&#160;functional&#160;and&#160;secu-<br/>rity&#160;capabilities.&#160;The&#160;functional&#160;capabilities&#160;of&#160;a&#160;host&#160;may&#160;be&#160;modelled&#160;using&#160;a&#160;function</p>
<p style="position:absolute;top:569px;left:226px;white-space:nowrap" class="ft2554">C</p>
<p style="position:absolute;top:569px;left:243px;white-space:nowrap" class="ft2555">:</p>
<p style="position:absolute;top:569px;left:251px;white-space:nowrap" class="ft2554">H</p>
<p style="position:absolute;top:569px;left:270px;white-space:nowrap" class="ft2530">←&#160;{</p>
<p style="position:absolute;top:569px;left:297px;white-space:nowrap" class="ft2554">V&#160;LAN,&#160;Ethernet,&#160;IP</p>
<p style="position:absolute;top:569px;left:437px;white-space:nowrap" class="ft2530">}</p>
<p style="position:absolute;top:570px;left:445px;white-space:nowrap" class="ft2511">,&#160;to&#160;describe&#160;whether&#160;a&#160;host&#160;has&#160;VLAN,&#160;Ethernet,</p>
<p style="position:absolute;top:587px;left:226px;white-space:nowrap" class="ft2513">or&#160;IP&#160;support.&#160;Modelling&#160;of&#160;security&#160;capabilities&#160;includes&#160;two&#160;orthogonal&#160;aspects:&#160;the<br/>set&#160;of&#160;security&#160;properties&#160;and&#160;the&#160;assurance&#160;that&#160;these&#160;properties&#160;are&#160;actually&#160;provided.<br/>Table&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#26">2.1&#160;</a>lists&#160;some&#160;examples&#160;of&#160;security&#160;properties&#160;and&#160;Table&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#27">2.2&#160;</a>gives&#160;examples&#160;of<br/>the&#160;types&#160;of&#160;evidence&#160;that&#160;can&#160;be&#160;used&#160;to&#160;support&#160;security&#160;property&#160;claims.</p>
<p style="position:absolute;top:681px;left:226px;white-space:nowrap" class="ft2520"><b>TVD&#160;Establishment&#160;and&#160;Population</b></p>
<p style="position:absolute;top:709px;left:226px;white-space:nowrap" class="ft2512">When&#160;the&#160;set&#160;of&#160;TVDs&#160;have&#160;been&#160;identified,&#160;the&#160;next&#160;step&#160;is&#160;to&#160;actually&#160;establish&#160;them.<br/>The&#160;initial&#160;step&#160;for&#160;establishing&#160;a&#160;TVD&#160;is&#160;to&#160;create&#160;the&#160;TVD&#160;master&#160;(step&#160;0&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#24">2.7)<br/></a>and&#160;initialise&#160;the&#160;master&#160;with&#160;the&#160;TVD&#160;requirements&#160;(as&#160;formalised&#160;above)&#160;and&#160;the<br/>policy&#160;model.&#160;The&#160;step&#160;involves&#160;the&#160;derivation&#160;of&#160;a&#160;comprehensive&#160;set&#160;of&#160;TVD&#160;policies,<br/>which&#160;are&#160;maintained&#160;at&#160;the&#160;TVD&#160;master.&#160;The&#160;output&#160;of&#160;the&#160;step&#160;is&#160;a&#160;TVD&#160;object&#160;that<br/>contains&#160;the&#160;TVD’s&#160;unique&#160;identifier,&#160;i.e.,&#160;the&#160;TVD&#160;master’s&#160;URL.</p>
<p style="position:absolute;top:817px;left:248px;white-space:nowrap" class="ft2511">Once&#160;the&#160;TVD&#160;master&#160;has&#160;been&#160;initialised,&#160;the&#160;TVD&#160;is&#160;ready&#160;for&#160;being&#160;populated</p>
<p style="position:absolute;top:835px;left:226px;white-space:nowrap" class="ft2512">with&#160;member&#160;entities,&#160;such&#160;as&#160;VMs.&#160;A&#160;VM&#160;becomes&#160;admitted&#160;to&#160;a&#160;TVD&#160;after&#160;the<br/>successful&#160;completion&#160;of&#160;a&#160;multi-step&#160;protocol&#160;(steps&#160;1&#160;and&#160;2&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#24">2.7)</a>.</p>
<p style="position:absolute;top:885px;left:245px;white-space:nowrap" class="ft2511">1.&#160;A&#160;local&#160;representative&#160;of&#160;the&#160;TVD,&#160;called&#160;<i>TVD&#160;proxy</i>,&#160;is&#160;created&#160;and&#160;initialised</p>
<p style="position:absolute;top:903px;left:263px;white-space:nowrap" class="ft2511">with&#160;the&#160;URL&#160;of&#160;the&#160;TVD&#160;master.</p>
<p style="position:absolute;top:933px;left:245px;white-space:nowrap" class="ft2511">2.&#160;The&#160;TVD&#160;proxy&#160;sets&#160;up&#160;a&#160;secure,&#160;authenticated&#160;channel&#160;with&#160;the&#160;TVD&#160;master</p>
<p style="position:absolute;top:951px;left:263px;white-space:nowrap" class="ft2511">using&#160;standard&#160;techniques.</p>
<p style="position:absolute;top:981px;left:245px;white-space:nowrap" class="ft2511">3.&#160;The&#160;TVD&#160;proxy&#160;indicates&#160;the&#160;security&#160;and&#160;functional&#160;capabilities&#160;of&#160;the&#160;physical</p>
<p style="position:absolute;top:999px;left:263px;white-space:nowrap" class="ft2513">machine.&#160;Using&#160;the&#160;capability&#160;model,&#160;the&#160;TVD&#160;master&#160;determines&#160;which&#160;addi-<br/>tional&#160;mechanisms&#160;must&#160;be&#160;provided&#160;at&#160;the&#160;level&#160;of&#160;the&#160;virtual&#160;infrastructure.&#160;For<br/>example,&#160;if&#160;a&#160;TVD&#160;requirements&#160;specification&#160;includes&#160;isolation&#160;and&#160;the&#160;physi-<br/>cal&#160;infrastructure&#160;does&#160;not&#160;have&#160;that&#160;capability,&#160;then&#160;special&#160;(VLAN&#160;tagging&#160;or</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft2518">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 26 -->
<a name="26"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2657{font-size:13px;font-family:Times;color:#231f20;}
	.ft2658{font-size:13px;line-height:18px;font-family:Times;color:#231f20;}
	.ft2659{font-size:13px;line-height:17px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page26-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC026.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft2611">24</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft2618">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:195px;left:253px;white-space:nowrap" class="ft2620"><b>Property</b></p>
<p style="position:absolute;top:195px;left:338px;white-space:nowrap" class="ft2620"><b>Description</b></p>
<p style="position:absolute;top:214px;left:253px;white-space:nowrap" class="ft2658">TVD&#160;Isola-<br/>tion</p>
<p style="position:absolute;top:214px;left:338px;white-space:nowrap" class="ft2657">Flow&#160;control&#160;policies&#160;in&#160;place&#160;for&#160;a&#160;TVD.</p>
<p style="position:absolute;top:251px;left:253px;white-space:nowrap" class="ft2657">Network</p>
<p style="position:absolute;top:251px;left:338px;white-space:nowrap" class="ft2659">The&#160;actual&#160;topology&#160;of&#160;a&#160;virtual&#160;network<br/>in&#160;a&#160;physical&#160;machine.</p>
<p style="position:absolute;top:287px;left:253px;white-space:nowrap" class="ft2658">Network<br/>Policy</p>
<p style="position:absolute;top:287px;left:338px;white-space:nowrap" class="ft2659">Security&#160;policies&#160;for&#160;the&#160;network,&#160;such&#160;as<br/>firewall&#160;rules&#160;and&#160;isolation&#160;rules&#160;stating<br/>which&#160;subnets&#160;can&#160;be&#160;connected.</p>
<p style="position:absolute;top:342px;left:253px;white-space:nowrap" class="ft2658">Storage&#160;Pol-<br/>icy</p>
<p style="position:absolute;top:342px;left:338px;white-space:nowrap" class="ft2659">Policies&#160;for&#160;storage&#160;security,&#160;such&#160;as<br/>whether&#160;the&#160;disks&#160;are&#160;encrypted&#160;and&#160;what<br/>VMs&#160;have&#160;permission&#160;to&#160;mount&#160;a&#160;particu-<br/>lar&#160;disk.</p>
<p style="position:absolute;top:414px;left:253px;white-space:nowrap" class="ft2658">Virtual&#160;Ma-<br/>chines</p>
<p style="position:absolute;top:414px;left:338px;white-space:nowrap" class="ft2659">The&#160;life-cycle&#160;protection&#160;mechanisms&#160;of<br/>the&#160;individual&#160;VMs,&#160;e.g.,&#160;pre-conditions<br/>for&#160;execution&#160;of&#160;a&#160;VM.</p>
<p style="position:absolute;top:468px;left:253px;white-space:nowrap" class="ft2657">Hypervisor</p>
<p style="position:absolute;top:468px;left:338px;white-space:nowrap" class="ft2657">Binary&#160;integrity&#160;of&#160;the&#160;hypervisor.</p>
<p style="position:absolute;top:487px;left:253px;white-space:nowrap" class="ft2657">Users</p>
<p style="position:absolute;top:487px;left:338px;white-space:nowrap" class="ft2658">The&#160;roles&#160;and&#160;associated&#160;users&#160;of&#160;a&#160;ma-<br/>chine,&#160;e.g.,&#160;who&#160;can&#160;assume&#160;the&#160;role&#160;of<br/>administrator&#160;of&#160;the&#160;TVD&#160;master.</p>
<p style="position:absolute;top:554px;left:190px;white-space:nowrap" class="ft2611">Table&#160;2.1:&#160;Examples&#160;of&#160;Security&#160;Properties&#160;used&#160;in&#160;Capability&#160;Modelling</p>
<p style="position:absolute;top:602px;left:187px;white-space:nowrap" class="ft2612">EtherIP)&#160;modules&#160;must&#160;be&#160;instantiated&#160;within&#160;the&#160;Dom0&#160;of&#160;physical&#160;machines<br/>hosting&#160;VMs&#160;that&#160;are&#160;part&#160;of&#160;the&#160;TVD.</p>
<p style="position:absolute;top:650px;left:168px;white-space:nowrap" class="ft2611">4.&#160;The&#160;TVD&#160;master&#160;then&#160;replies&#160;to&#160;the&#160;TVD&#160;proxy&#160;with&#160;the&#160;TVD&#160;security&#160;policy</p>
<p style="position:absolute;top:668px;left:187px;white-space:nowrap" class="ft2612">(such&#160;as&#160;flow&#160;control&#160;policies&#160;between&#160;VMs&#160;belonging&#160;to&#160;different&#160;TVDs&#160;hosted<br/>on&#160;the&#160;same&#160;physical&#160;machine)&#160;and&#160;additional&#160;mechanisms&#160;that&#160;must&#160;be&#160;provided<br/>at&#160;the&#160;virtualization&#160;level.</p>
<p style="position:absolute;top:734px;left:168px;white-space:nowrap" class="ft2611">5.&#160;The&#160;TVD&#160;proxy&#160;then&#160;instantiates&#160;and&#160;configures&#160;the&#160;required&#160;TVD-specific&#160;mod-</p>
<p style="position:absolute;top:752px;left:187px;white-space:nowrap" class="ft2612">ules&#160;(e.g.,&#160;vSwitch,&#160;VLAN&#160;tagging&#160;module,&#160;encapsulation&#160;module,&#160;VPN&#160;module,<br/>policy&#160;engine,&#160;etc.)&#160;according&#160;to&#160;the&#160;TVD&#160;policy.&#160;After&#160;this&#160;step,&#160;the&#160;physical<br/>machine&#160;is&#160;ready&#160;to&#160;host&#160;a&#160;VM&#160;belonging&#160;to&#160;the&#160;TVD.</p>
<p style="position:absolute;top:818px;left:168px;white-space:nowrap" class="ft2611">6.&#160;As&#160;shown&#160;by&#160;step&#160;2&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#24">2.7,&#160;</a>a&#160;command&#160;is&#160;issued&#160;at&#160;the&#160;VM&#160;to&#160;join&#160;the</p>
<p style="position:absolute;top:836px;left:187px;white-space:nowrap" class="ft2612">TVD&#160;(active&#160;membership&#160;model.&#160;This&#160;results&#160;in&#160;the&#160;VM&#160;contacting&#160;the&#160;TVD<br/>proxy.&#160;Based&#160;on&#160;the&#160;TVD&#160;security&#160;policies,&#160;the&#160;TVD&#160;proxy&#160;may&#160;carry&#160;out&#160;an<br/>assurance&#160;assessment&#160;of&#160;the&#160;VM&#160;(e.g.,&#160;whether&#160;the&#160;VM&#160;has&#160;all&#160;required&#160;software<br/>properly&#160;configured).&#160;Once&#160;the&#160;required&#160;verification&#160;of&#160;the&#160;VM&#160;is&#160;successful,&#160;the<br/>TVD&#160;proxy&#160;may&#160;connect&#160;the&#160;vNICs&#160;of&#160;the&#160;VM&#160;to&#160;the&#160;appropriate&#160;TVD&#160;vSwitch.<br/>At&#160;this&#160;point,&#160;the&#160;VM&#160;is&#160;part&#160;of&#160;the&#160;TVD.</p>
<p style="position:absolute;top:965px;left:150px;white-space:nowrap" class="ft2620"><b>Instantiation&#160;of&#160;the&#160;Right&#160;Networking&#160;Modules</b></p>
<p style="position:absolute;top:993px;left:150px;white-space:nowrap" class="ft2613">The&#160;TVD&#160;proxy&#160;uses&#160;the&#160;instructions&#160;given&#160;to&#160;it&#160;by&#160;the&#160;TVD&#160;master&#160;to&#160;determine&#160;the<br/>right&#160;protection&#160;mechanisms&#160;to&#160;instantiate&#160;on&#160;the&#160;local&#160;platform&#160;for&#160;the&#160;TVD&#160;network<br/>traffic,&#160;and&#160;accordingly&#160;configures&#160;the&#160;local&#160;TVD&#160;vSwitch.</p>
<p style="position:absolute;top:1047px;left:172px;white-space:nowrap" class="ft2611">Suppose&#160;that&#160;isolation&#160;of&#160;TVD&#160;traffic&#160;is&#160;a&#160;requirement.&#160;Then,&#160;VLAN&#160;tagging&#160;alone</p>
<p style="position:absolute;top:1065px;left:150px;white-space:nowrap" class="ft2611">would&#160;suffice&#160;provided&#160;the&#160;TVD&#160;spans&#160;only&#160;the&#160;LAN&#160;and&#160;the&#160;physical&#160;switches&#160;on&#160;the</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft2618">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 27 -->
<a name="27"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page27-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC027.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft2711">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft2711">25</p>
<p style="position:absolute;top:195px;left:316px;white-space:nowrap" class="ft2720"><b>Past&#160;State</b></p>
<p style="position:absolute;top:195px;left:428px;white-space:nowrap" class="ft2720"><b>Description</b></p>
<p style="position:absolute;top:214px;left:316px;white-space:nowrap" class="ft2757">Trust</p>
<p style="position:absolute;top:214px;left:428px;white-space:nowrap" class="ft2758">A&#160;user&#160;believes&#160;that&#160;an&#160;entity&#160;has&#160;certain<br/>security&#160;properties.</p>
<p style="position:absolute;top:250px;left:316px;white-space:nowrap" class="ft2757">Mutable&#160;Log</p>
<p style="position:absolute;top:250px;left:428px;white-space:nowrap" class="ft2759">The&#160;entity&#160;provides&#160;log-file&#160;evidence&#160;(e.g.,<br/>audits)&#160;that&#160;indicates&#160;that&#160;the&#160;platform<br/>provides&#160;certain&#160;properties.</p>
<p style="position:absolute;top:304px;left:316px;white-space:nowrap" class="ft2757">Immutable&#160;Logs</p>
<p style="position:absolute;top:304px;left:428px;white-space:nowrap" class="ft2758">The&#160;entity&#160;has&#160;immutable&#160;logging&#160;systems<br/>(e.g.,&#160;a&#160;TPM-quote&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#71">[36]</a>)&#160;for&#160;providing&#160;ev-<br/>idence.&#160;Since&#160;the&#160;log&#160;cannot&#160;modified&#160;by<br/>the&#160;entity&#160;itself,&#160;the&#160;resulting&#160;assurance&#160;is<br/>stronger&#160;than&#160;when&#160;mutable&#160;logs&#160;are&#160;used.</p>
<p style="position:absolute;top:396px;left:316px;white-space:nowrap" class="ft2720"><b>Present&#160;State</b></p>
<p style="position:absolute;top:396px;left:428px;white-space:nowrap" class="ft2720"><b>Description</b></p>
<p style="position:absolute;top:416px;left:316px;white-space:nowrap" class="ft2757">Evaluations</p>
<p style="position:absolute;top:416px;left:428px;white-space:nowrap" class="ft2758">Evaluation&#160;of&#160;a&#160;given&#160;state,&#160;e.g.,&#160;Common<br/>Criteria&#160;evaluations&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#70">[21]</a>.</p>
<p style="position:absolute;top:452px;left:316px;white-space:nowrap" class="ft2757">Introspection</p>
<p style="position:absolute;top:452px;left:428px;white-space:nowrap" class="ft2758">Introspection&#160;of&#160;a&#160;system&#160;by&#160;executing&#160;se-<br/>curity&#160;tests,&#160;e.g.,&#160;virus&#160;scanner.</p>
<p style="position:absolute;top:490px;left:316px;white-space:nowrap" class="ft2720"><b>Future&#160;State</b></p>
<p style="position:absolute;top:490px;left:428px;white-space:nowrap" class="ft2720"><b>Description</b></p>
<p style="position:absolute;top:510px;left:316px;white-space:nowrap" class="ft2757">Policies</p>
<p style="position:absolute;top:510px;left:428px;white-space:nowrap" class="ft2758">By&#160;providing&#160;policies&#160;and&#160;evidence&#160;of<br/>their&#160;enforcement,&#160;a&#160;system&#160;can&#160;justify<br/>claims&#160;about&#160;its&#160;future&#160;behaviour.&#160;e.g.,<br/>DRM&#160;policies&#160;and&#160;VM&#160;life-cycle&#160;protec-<br/>tion&#160;policy.</p>
<p style="position:absolute;top:599px;left:316px;white-space:nowrap" class="ft2757">Audit</p>
<p style="position:absolute;top:599px;left:428px;white-space:nowrap" class="ft2758">By&#160;guaranteeing&#160;regular&#160;audits,&#160;organisa-<br/>tions&#160;can&#160;claim&#160;that&#160;certain&#160;policies&#160;will<br/>be&#160;enforced&#160;in&#160;the&#160;future.</p>
<p style="position:absolute;top:667px;left:226px;white-space:nowrap" class="ft2711">Table&#160;2.2:&#160;Assurance&#160;for&#160;Past,&#160;Present,&#160;and&#160;Future&#160;States&#160;used&#160;in&#160;Capability&#160;Modelling</p>
<p style="position:absolute;top:715px;left:226px;white-space:nowrap" class="ft2713">LAN&#160;are&#160;VLAN-enabled&#160;(i.e.,&#160;it&#160;must&#160;support&#160;IEEE&#160;802.1Q&#160;and&#160;must&#160;be&#160;appropriately<br/>configured);&#160;in&#160;that&#160;case,&#160;a&#160;VLAN&#160;tagging&#160;module&#160;would&#160;be&#160;created&#160;and&#160;connected<br/>to&#160;the&#160;vSwitch.&#160;If&#160;the&#160;TVD&#160;spans&#160;beyond&#160;a&#160;LAN,&#160;then&#160;VLAN&#160;tagging&#160;must&#160;be&#160;used<br/>in&#160;conjunction&#160;with&#160;EtherIP&#160;encapsulation.&#160;In&#160;this&#160;case,&#160;the&#160;VLAN&#160;tagged&#160;packet&#160;is<br/>encapsulated&#160;in&#160;a&#160;new&#160;IP&#160;packet&#160;and&#160;tunnelled&#160;to&#160;the&#160;other&#160;side,&#160;where&#160;the&#160;original<br/>VLAN&#160;tagged&#160;packet&#160;is&#160;extracted&#160;and&#160;transmitted&#160;on&#160;the&#160;VLAN.&#160;If&#160;VLAN-enabled<br/>switches&#160;are&#160;not&#160;available,&#160;then&#160;EtherIP&#160;alone&#160;would&#160;suffice&#160;for&#160;isolation.</p>
<p style="position:absolute;top:840px;left:248px;white-space:nowrap" class="ft2711">By&#160;itself,&#160;EtherIP&#160;does&#160;not&#160;provide&#160;integrity&#160;or&#160;confidentiality&#160;of&#160;the&#160;packets.</p>
<p style="position:absolute;top:858px;left:226px;white-space:nowrap" class="ft2712">Hence,&#160;when&#160;those&#160;properties&#160;are&#160;required,&#160;EtherIP&#160;is&#160;suitable&#160;only&#160;on&#160;routed&#160;and<br/>trusted&#160;networks,&#160;e.g.,&#160;EtherIP&#160;would&#160;be&#160;suitable&#160;for&#160;traffic&#160;between&#160;two&#160;vSwitches<br/>hosted&#160;on&#160;different&#160;physical&#160;platforms&#160;that&#160;are&#160;not&#160;connected&#160;to&#160;the&#160;same&#160;VLAN&#160;switch<br/>in&#160;a&#160;datacenter&#160;or&#160;corporate&#160;environment.</p>
<p style="position:absolute;top:930px;left:248px;white-space:nowrap" class="ft2711">If&#160;integrity&#160;or&#160;confidentiality&#160;are&#160;required&#160;properties&#160;and&#160;the&#160;underlying&#160;network&#160;is</p>
<p style="position:absolute;top:948px;left:226px;white-space:nowrap" class="ft2712">not&#160;trusted,&#160;then&#160;IPsec&#160;is&#160;used&#160;in&#160;conjunction&#160;with&#160;EtherIP&#160;and&#160;VLAN.&#160;In&#160;that&#160;case,<br/>the&#160;TVD&#160;proxy&#160;will&#160;create&#160;the&#160;VPN&#160;module,&#160;initialise&#160;it&#160;with&#160;the&#160;VPN&#160;key&#160;obtained<br/>from&#160;the&#160;master,&#160;and&#160;connect&#160;it&#160;to&#160;the&#160;vSwitch.&#160;Since&#160;IPsec&#160;only&#160;operates&#160;on&#160;IP&#160;packets<br/>and&#160;not&#160;Ethernet&#160;or&#160;VLAN&#160;ones,&#160;double&#160;encapsulation&#160;is&#160;needed:&#160;EtherIP&#160;is&#160;used&#160;to<br/>first&#160;encapsulate&#160;the&#160;Ethernet&#160;or&#160;VLAN&#160;packets,&#160;followed&#160;by&#160;IPsec&#160;encapsulation&#160;and<br/>encryption&#160;(using&#160;the&#160;VPN&#160;key).</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft2718">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 28 -->
<a name="28"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2860{font-size:0px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page28-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC028.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft2811">26</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft2818">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:189px;left:150px;white-space:nowrap" class="ft2822"><b>2.4</b></p>
<p style="position:absolute;top:189px;left:198px;white-space:nowrap" class="ft2822"><b>Xen&#160;Hierarchical&#160;Integrity&#160;Management</b></p>
<p style="position:absolute;top:227px;left:569px;white-space:nowrap" class="ft2811">S.&#160;Cabuk&#160;(HPL)</p>
<p style="position:absolute;top:260px;left:150px;white-space:nowrap" class="ft2813">This&#160;section&#160;provides&#160;answers&#160;to&#160;two&#160;problems&#160;around&#160;VM&#160;integrity&#160;management:&#160;How<br/>can&#160;we&#160;extend&#160;the&#160;integrity&#160;measurement&#160;capabilities&#160;offered&#160;by&#160;the&#160;BMSI&#160;to&#160;help&#160;sup-<br/>port&#160;hierarchical&#160;and&#160;dynamic&#160;integrity&#160;management?&#160;How&#160;can&#160;we&#160;use&#160;these&#160;extensions<br/>to&#160;facilitate&#160;a&#160;centralised&#160;credential&#160;management&#160;service?</p>
<p style="position:absolute;top:372px;left:150px;white-space:nowrap" class="ft2833"><b>2.4.1</b></p>
<p style="position:absolute;top:372px;left:204px;white-space:nowrap" class="ft2833"><b>Our&#160;Solution</b></p>
<p style="position:absolute;top:402px;left:150px;white-space:nowrap" class="ft2813">We&#160;devise&#160;a&#160;framework&#160;called&#160;the&#160;hierarchical&#160;integrity&#160;management&#160;framework<br/>(hIMF).&#160;As&#160;illustrated&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#29">2.9,&#160;</a>hIMF&#160;sits&#160;on&#160;top&#160;of&#160;the&#160;BMSI&#160;and&#160;is&#160;comprised&#160;of<br/>two&#160;components:&#160;the&#160;integrity&#160;management&#160;interface&#160;(IMI)&#160;and&#160;the&#160;credential&#160;manage-<br/>ment&#160;service&#160;(CMS).</p>
<p style="position:absolute;top:514px;left:150px;white-space:nowrap" class="ft2820"><b>Integrity&#160;Management&#160;Interface&#160;(IMI)</b></p>
<p style="position:absolute;top:582px;left:150px;white-space:nowrap" class="ft2820"><b>BMSI&#160;LibU</b></p>
<p style="position:absolute;top:582px;left:240px;white-space:nowrap" class="ft2811">The&#160;IM&#160;interface&#160;provides&#160;functionality&#160;similar&#160;to&#160;the&#160;libU&#160;library&#160;pro-</p>
<p style="position:absolute;top:600px;left:150px;white-space:nowrap" class="ft2812">vided&#160;by&#160;the&#160;BMSI.&#160;The&#160;current&#160;BMSI&#160;libU&#160;library&#160;stores&#160;individual&#160;measurements&#160;of<br/>protection&#160;domains&#160;and&#160;provides&#160;four&#160;functions&#160;regarding&#160;the&#160;integrity&#160;management&#160;of<br/>these&#160;domains:&#160;extend,&#160;quote,&#160;seal,&#160;and&#160;unseal.</p>
<p style="position:absolute;top:668px;left:168px;white-space:nowrap" class="ft2811">1.</p>
<p style="position:absolute;top:678px;left:187px;white-space:nowrap" class="ft2860">extend</p>
<p style="position:absolute;top:668px;left:238px;white-space:nowrap" class="ft2811">Protection&#160;domains&#160;use&#160;the&#160;extend&#160;operation&#160;to&#160;report&#160;changes&#160;to&#160;their</p>
<p style="position:absolute;top:686px;left:187px;white-space:nowrap" class="ft2811">integrity.&#160;These&#160;changes&#160;are&#160;static&#160;and&#160;cannot&#160;be&#160;reverted&#160;once&#160;reported.</p>
<p style="position:absolute;top:716px;left:168px;white-space:nowrap" class="ft2811">2.</p>
<p style="position:absolute;top:726px;left:187px;white-space:nowrap" class="ft2860">quote</p>
<p style="position:absolute;top:716px;left:230px;white-space:nowrap" class="ft2811">Protection&#160;domains&#160;use&#160;the&#160;quote&#160;operation&#160;to&#160;provide&#160;a&#160;signed&#160;quote&#160;of</p>
<p style="position:absolute;top:734px;left:187px;white-space:nowrap" class="ft2812">the&#160;TCB&#160;and&#160;domain&#160;integrity&#160;measurements.&#160;TCB&#160;measurements&#160;are&#160;obtained<br/>from&#160;and&#160;signed&#160;by&#160;the&#160;underlying&#160;hardware&#160;TPM.&#160;Domain&#160;measurements&#160;are<br/>signed&#160;by&#160;the&#160;BMSI&#160;signing&#160;key.</p>
<p style="position:absolute;top:800px;left:168px;white-space:nowrap" class="ft2811">3.</p>
<p style="position:absolute;top:810px;left:187px;white-space:nowrap" class="ft2860">seal</p>
<p style="position:absolute;top:800px;left:217px;white-space:nowrap" class="ft2811">Protection&#160;domains&#160;use&#160;the&#160;seal&#160;operation&#160;to&#160;store&#160;a&#160;secret&#160;(e.g.,&#160;a&#160;crypto-</p>
<p style="position:absolute;top:818px;left:187px;white-space:nowrap" class="ft2811">graphic&#160;key)&#160;bound&#160;to&#160;a&#160;particular&#160;TCB&#160;and&#160;domain&#160;configuration.</p>
<p style="position:absolute;top:848px;left:168px;white-space:nowrap" class="ft2811">4.</p>
<p style="position:absolute;top:858px;left:187px;white-space:nowrap" class="ft2860">unseal</p>
<p style="position:absolute;top:848px;left:235px;white-space:nowrap" class="ft2811">Protection&#160;domains&#160;use&#160;the&#160;unseal&#160;operation&#160;to&#160;reveal&#160;a&#160;secret&#160;(e.g.,&#160;a</p>
<p style="position:absolute;top:866px;left:187px;white-space:nowrap" class="ft2813">cryptographic&#160;key)&#160;that&#160;is&#160;sealed&#160;to&#160;a&#160;particular&#160;TCB&#160;and&#160;domain&#160;configuration.<br/>libU&#160;returns&#160;the&#160;secret&#160;to&#160;the&#160;requesting&#160;domain&#160;if&#160;and&#160;only&#160;if&#160;the&#160;unsealing&#160;op-<br/>eration&#160;is&#160;successful&#160;(i.e,.&#160;the&#160;TCB&#160;and&#160;domain&#160;configuration&#160;is&#160;the&#160;same&#160;as<br/>the&#160;expected&#160;values).&#160;The&#160;actual&#160;unseal&#160;is&#160;performed&#160;using&#160;the&#160;hardware&#160;TPM<br/>with&#160;respect&#160;to&#160;the&#160;TCB&#160;configuration&#160;only.&#160;The&#160;additional&#160;domain&#160;configuration<br/>checks&#160;are&#160;performed&#160;by&#160;the&#160;libU&#160;in&#160;software.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft2818">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 29 -->
<a name="29"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page29-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC029.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft2911">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft2911">27</p>
<p style="position:absolute;top:386px;left:393px;white-space:nowrap" class="ft2911">Figure&#160;2.9:&#160;hIMF&#160;Architecture</p>
<p style="position:absolute;top:434px;left:226px;white-space:nowrap" class="ft2920"><b>IMI&#160;Enhancements</b></p>
<p style="position:absolute;top:434px;left:363px;white-space:nowrap" class="ft2911">IMI&#160;provides&#160;the&#160;same&#160;functions&#160;as&#160;libU&#160;with&#160;extensions&#160;that&#160;en-</p>
<p style="position:absolute;top:452px;left:226px;white-space:nowrap" class="ft2913">able&#160;tree-of-trust&#160;and&#160;dynamic&#160;measurements.&#160;In&#160;particular,&#160;IMI&#160;establishes&#160;an&#160;ancestry<br/>relation&#160;between&#160;protection&#160;domains&#160;by&#160;recording&#160;the&#160;parent&#160;domain&#160;during&#160;the&#160;child<br/>domain&#160;creation&#160;(TBD).&#160;In&#160;addition&#160;to&#160;the&#160;static&#160;registers&#160;maintained&#160;by&#160;the&#160;BMSI,&#160;IMI<br/>introduces&#160;a&#160;dynamic&#160;register&#160;per&#160;protection&#160;domain&#160;to&#160;be&#160;used&#160;for&#160;dynamic&#160;measure-<br/>ments.&#160;Integrity&#160;functions&#160;offered&#160;by&#160;the&#160;IMI&#160;is&#160;altered&#160;as&#160;follows:</p>
<p style="position:absolute;top:555px;left:245px;white-space:nowrap" class="ft2911">1.</p>
<p style="position:absolute;top:565px;left:263px;white-space:nowrap" class="ft2960">extend</p>
<p style="position:absolute;top:555px;left:314px;white-space:nowrap" class="ft2911">Protection&#160;domains&#160;use&#160;the&#160;extend&#160;operation&#160;to&#160;report&#160;changes&#160;to&#160;their</p>
<p style="position:absolute;top:573px;left:263px;white-space:nowrap" class="ft2913">integrity.&#160;These&#160;changes&#160;can&#160;be&#160;static&#160;or&#160;dynamic&#160;depending&#160;on&#160;the&#160;accompa-<br/>nying&#160;measurement&#160;policy.&#160;Static&#160;changes&#160;are&#160;reported&#160;to&#160;the&#160;static&#160;registers&#160;in<br/>the&#160;same&#160;manner&#160;as&#160;BMSI&#160;(i.e.,&#160;the&#160;underlying&#160;libU&#160;extend&#160;function&#160;is&#160;used).<br/>Dynamic&#160;changes&#160;are&#160;reported&#160;to&#160;the&#160;dynamic&#160;registers&#160;and&#160;the&#160;previous&#160;value&#160;is<br/>overwritten&#160;instead&#160;of&#160;being&#160;extended.</p>
<p style="position:absolute;top:674px;left:245px;white-space:nowrap" class="ft2911">2.</p>
<p style="position:absolute;top:684px;left:263px;white-space:nowrap" class="ft2960">quote</p>
<p style="position:absolute;top:674px;left:305px;white-space:nowrap" class="ft2911">This&#160;operation&#160;is&#160;the&#160;same&#160;as&#160;the&#160;libU&#160;quote&#160;except&#160;that&#160;the&#160;quote&#160;returns</p>
<p style="position:absolute;top:692px;left:263px;white-space:nowrap" class="ft2912">a&#160;signed&#160;quote&#160;of&#160;the&#160;TCB&#160;and&#160;the&#160;measurements&#160;of&#160;the&#160;complete&#160;branch&#160;the&#160;re-<br/>questing&#160;domain&#160;belongs&#160;to&#160;(i.e.,&#160;domain&#160;plus&#160;its&#160;predecessors).&#160;TCB&#160;measure-<br/>ments&#160;are&#160;obtained&#160;from&#160;and&#160;signed&#160;by&#160;the&#160;underlying&#160;hardware&#160;TPM.&#160;Branch<br/>measurements&#160;are&#160;signed&#160;by&#160;the&#160;IMI&#160;signing&#160;key.</p>
<p style="position:absolute;top:775px;left:245px;white-space:nowrap" class="ft2911">3.</p>
<p style="position:absolute;top:785px;left:263px;white-space:nowrap" class="ft2960">seal</p>
<p style="position:absolute;top:785px;left:296px;white-space:nowrap" class="ft2960">/</p>
<p style="position:absolute;top:785px;left:312px;white-space:nowrap" class="ft2960">unseal</p>
<p style="position:absolute;top:775px;left:360px;white-space:nowrap" class="ft2911">These&#160;operations&#160;are&#160;the&#160;same&#160;as&#160;the&#160;libU&#160;equivalents&#160;except</p>
<p style="position:absolute;top:793px;left:263px;white-space:nowrap" class="ft2913">that&#160;instead&#160;of&#160;a&#160;single&#160;domain&#160;configuration,&#160;the&#160;aggregation&#160;of&#160;a&#160;complete&#160;tree<br/>branch&#160;is&#160;used.&#160;This&#160;includes&#160;all&#160;protection&#160;domains&#160;that&#160;are&#160;the&#160;predecessors&#160;of<br/>the&#160;requesting&#160;domain.</p>
<p style="position:absolute;top:861px;left:248px;white-space:nowrap" class="ft2911">Security&#160;services&#160;are&#160;given&#160;the&#160;option&#160;of&#160;accessing&#160;the&#160;Trusted&#160;Computing&#160;exten-</p>
<p style="position:absolute;top:879px;left:226px;white-space:nowrap" class="ft2913">sions&#160;either&#160;through&#160;the&#160;BMSI&#160;or&#160;IMI.&#160;The&#160;former&#160;is&#160;used&#160;for&#160;the&#160;cases&#160;it&#160;suffices&#160;to<br/>use&#160;a&#160;static&#160;and&#160;flat&#160;integrity&#160;model.&#160;The&#160;latter&#160;is&#160;used&#160;by&#160;services&#160;(e.g.,&#160;CMS)&#160;that&#160;can<br/>benefit&#160;from&#160;a&#160;dynamic&#160;integrity&#160;hierarchy.</p>
<p style="position:absolute;top:955px;left:226px;white-space:nowrap" class="ft2920"><b>Credential&#160;Management&#160;Service&#160;(CMS)</b></p>
<p style="position:absolute;top:983px;left:226px;white-space:nowrap" class="ft2912">CMS&#160;is&#160;a&#160;security&#160;service&#160;that&#160;provides&#160;protected&#160;storage&#160;for&#160;security&#160;credentials&#160;tied<br/>to&#160;specified&#160;policies&#160;and&#160;platform&#160;plus&#160;domain/branch&#160;configurations.&#160;The&#160;main&#160;differ-<br/>ence&#160;with&#160;the&#160;underlying&#160;BMSI/IMI&#160;sealing/unsealing&#160;functions&#160;is&#160;that&#160;CMS&#160;creden-<br/>tials&#160;are&#160;never&#160;revealed&#160;to&#160;the&#160;requesting&#160;services&#160;but&#160;are&#160;always&#160;stored&#160;by&#160;the&#160;CMS<br/>securely.&#160;The&#160;CMS&#160;provides&#160;the&#160;necessary&#160;interface&#160;to&#160;allow&#160;such&#160;services&#160;access&#160;their<br/>credentials&#160;if&#160;and&#160;only&#160;if&#160;the&#160;corresponding&#160;policy&#160;and&#160;configuration&#160;is&#160;met.&#160;In&#160;this</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft2918">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 30 -->
<a name="30"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page30-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC030.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft3011">28</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft3018">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:300px;left:281px;white-space:nowrap" class="ft3011">Figure&#160;2.10:&#160;CMS&#160;as&#160;a&#160;Reference&#160;Monitor</p>
<p style="position:absolute;top:348px;left:150px;white-space:nowrap" class="ft3012">context,&#160;the&#160;CMS&#160;acts&#160;as&#160;the&#160;reference&#160;monitor&#160;that&#160;controls&#160;the&#160;access&#160;to&#160;security<br/>credentials&#160;(see&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#30">2.10)</a>.</p>
<p style="position:absolute;top:384px;left:172px;white-space:nowrap" class="ft3011">The&#160;CMS&#160;utilises&#160;the&#160;IMI&#160;or&#160;BMSI&#160;directly&#160;depending&#160;on&#160;whether&#160;the&#160;IMI&#160;integrity</p>
<p style="position:absolute;top:401px;left:150px;white-space:nowrap" class="ft3013">enhancements&#160;are&#160;needed.&#160;In&#160;either&#160;case,&#160;the&#160;main&#160;benefit&#160;of&#160;employing&#160;the&#160;CMS&#160;is<br/>the&#160;ability&#160;to&#160;perform&#160;policy&#160;and&#160;configuration&#160;checks&#160;in&#160;an&#160;on-going&#160;manner&#160;(instead<br/>of&#160;only&#160;once&#160;which&#160;is&#160;the&#160;case&#160;with&#160;non-CMS&#160;solutions).&#160;Alternatively,&#160;credential<br/>sessions&#160;can&#160;be&#160;established&#160;that&#160;allows&#160;access&#160;to&#160;the&#160;secret&#160;without&#160;re-authentication<br/>/&#160;re-validation.&#160;These&#160;sessions&#160;can&#160;expire&#160;either&#160;after&#160;a&#160;duration&#160;or&#160;if&#160;a&#160;change&#160;is&#160;re-<br/>ported&#160;to&#160;the&#160;static/dynamic&#160;register.&#160;The&#160;choice&#160;of&#160;which&#160;re-validation&#160;scheme&#160;to&#160;use<br/>is&#160;implementation&#160;dependent&#160;and&#160;will&#160;be&#160;explored&#160;further.</p>
<p style="position:absolute;top:527px;left:172px;white-space:nowrap" class="ft3011">The&#160;CMS&#160;interface&#160;is&#160;likely&#160;to&#160;involve&#160;two&#160;phases:&#160;registration&#160;and&#160;usage.&#160;In&#160;the</p>
<p style="position:absolute;top:545px;left:150px;white-space:nowrap" class="ft3013">registration&#160;phase,&#160;a&#160;credential&#160;for&#160;a&#160;protection&#160;domain&#160;is&#160;registered&#160;with&#160;the&#160;CMS&#160;using<br/>the&#160;registerCredential&#160;operation.&#160;In&#160;the&#160;usage&#160;phase,&#160;the&#160;corresponding&#160;credential&#160;can<br/>be&#160;accessed&#160;using&#160;the&#160;accessCredential&#160;operation.&#160;The&#160;specifics&#160;of&#160;these&#160;operations<br/>will&#160;be&#160;investigated&#160;further.</p>
<p style="position:absolute;top:638px;left:150px;white-space:nowrap" class="ft3020"><b>vTPM+</b></p>
<p style="position:absolute;top:667px;left:150px;white-space:nowrap" class="ft3012">This&#160;service&#160;enhances&#160;the&#160;integrity&#160;measurement&#160;capabilities&#160;of&#160;vTPMs&#160;using&#160;the&#160;hIMF.<br/>We&#160;will&#160;come&#160;back&#160;to&#160;this&#160;after&#160;the&#160;successful&#160;implementation&#160;of&#160;hIMF.</p>
<p style="position:absolute;top:725px;left:150px;white-space:nowrap" class="ft3033"><b>2.4.2</b></p>
<p style="position:absolute;top:725px;left:204px;white-space:nowrap" class="ft3033"><b>Use&#160;Cases&#160;for&#160;Dynamic&#160;Registers</b></p>
<p style="position:absolute;top:755px;left:150px;white-space:nowrap" class="ft3013">As&#160;it&#160;has&#160;created&#160;much&#160;speculation&#160;regarding&#160;usability,&#160;we&#160;use&#160;this&#160;section&#160;to&#160;describe<br/>use&#160;cases&#160;around&#160;dynamic&#160;integrity&#160;measurements.&#160;Recall&#160;that&#160;dynamic&#160;measurements<br/>are&#160;used&#160;whenever&#160;one&#160;can&#160;guarantee&#160;that,&#160;for&#160;example,&#160;a&#160;configuration&#160;change&#160;can&#160;be<br/>reversible&#160;and&#160;may&#160;not&#160;have&#160;any&#160;side&#160;or&#160;unpredictable&#160;effects&#160;on&#160;the&#160;future&#160;state&#160;of&#160;the<br/>domain.&#160;The&#160;main&#160;critique&#160;is&#160;that&#160;it&#160;would&#160;be&#160;hard&#160;to&#160;find&#160;such&#160;a&#160;use&#160;case&#160;in&#160;which&#160;a<br/>protection&#160;domain&#160;would&#160;recover&#160;from&#160;a&#160;possibly&#160;untrusted&#160;configuration.&#160;We&#160;provide<br/>the&#160;following&#160;use&#160;cases&#160;in&#160;which&#160;such&#160;arguments&#160;do&#160;not&#160;hold.&#160;Feel&#160;free&#160;to&#160;comment&#160;on<br/>and&#160;/&#160;or&#160;extend&#160;the&#160;list.</p>
<p style="position:absolute;top:921px;left:150px;white-space:nowrap" class="ft3020"><b>Digital&#160;Rights&#160;Management</b></p>
<p style="position:absolute;top:949px;left:150px;white-space:nowrap" class="ft3012">It&#160;may&#160;well&#160;be&#160;the&#160;case&#160;that&#160;a&#160;particular&#160;media&#160;provider&#160;will&#160;not&#160;want&#160;to&#160;push&#160;any<br/>video&#160;content&#160;on&#160;your&#160;computing&#160;accessory&#160;if&#160;it&#160;is&#160;plugged&#160;to&#160;a&#160;recording&#160;device.&#160;In<br/>this&#160;case,&#160;software&#160;that&#160;detects&#160;and&#160;installs&#160;the&#160;plug-and-play&#160;drivers&#160;for&#160;the&#160;recording<br/>device&#160;must&#160;be&#160;part&#160;of&#160;the&#160;static&#160;measurements.&#160;However,&#160;the&#160;state&#160;in&#160;which&#160;a&#160;recording<br/>device&#160;is&#160;detected&#160;in&#160;the&#160;system&#160;can&#160;be&#160;reported&#160;dynamically.&#160;In&#160;fact,&#160;this&#160;can&#160;be<br/>reflected&#160;in&#160;the&#160;dynamic&#160;register&#160;for&#160;the&#160;secure&#160;DRM&#160;player&#160;service.&#160;As&#160;long&#160;as&#160;the<br/>recording&#160;device&#160;is&#160;connected,&#160;no&#160;content&#160;is&#160;downloaded.&#160;Once&#160;the&#160;user&#160;unplugs&#160;the</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft3018">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 31 -->
<a name="31"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page31-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC031.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft3111">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft3111">29</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft3112">device,&#160;the&#160;dynamic&#160;register&#160;is&#160;reset&#160;and&#160;content&#160;can&#160;be&#160;pushed&#160;to&#160;the&#160;player&#160;without<br/>requiring&#160;a&#160;system&#160;restart.</p>
<p style="position:absolute;top:251px;left:226px;white-space:nowrap" class="ft3120"><b>Data-center&#160;Trust&#160;Issues</b></p>
<p style="position:absolute;top:279px;left:226px;white-space:nowrap" class="ft3112">Note&#160;that&#160;“trustworthy”&#160;is&#160;not&#160;a&#160;synonym&#160;for&#160;“secure”.&#160;A&#160;system&#160;is&#160;trusted&#160;if&#160;and<br/>only&#160;if&#160;it&#160;behaves&#160;as&#160;expected.&#160;In&#160;a&#160;data&#160;center,&#160;trusting&#160;an&#160;individual&#160;node&#160;may&#160;also<br/>correspond&#160;to&#160;trusting&#160;its&#160;performance,&#160;or&#160;its&#160;compliance&#160;to&#160;the&#160;requested&#160;QoS.&#160;In&#160;SoA,<br/>a&#160;particular&#160;service&#160;may&#160;be&#160;required&#160;to&#160;meet&#160;a&#160;certain&#160;level&#160;of&#160;performance.&#160;Services<br/>or&#160;nodes&#160;that&#160;cannot&#160;guarantee&#160;meeting&#160;the&#160;performance&#160;level&#160;may&#160;be&#160;taken&#160;out&#160;of&#160;the<br/>service&#160;pool&#160;temporarily.</p>
<p style="position:absolute;top:387px;left:248px;white-space:nowrap" class="ft3111">Consider&#160;an&#160;SoA&#160;setting&#160;that&#160;is&#160;comprised&#160;of</p>
<p style="position:absolute;top:386px;left:524px;white-space:nowrap" class="ft3154">n</p>
<p style="position:absolute;top:387px;left:537px;white-space:nowrap" class="ft3111">services&#160;distributed&#160;on&#160;m&#160;physical</p>
<p style="position:absolute;top:405px;left:226px;white-space:nowrap" class="ft3111">nodes.&#160;At&#160;any&#160;time,</p>
<p style="position:absolute;top:404px;left:356px;white-space:nowrap" class="ft3154">k</p>
<p style="position:absolute;top:405px;left:370px;white-space:nowrap" class="ft3111">of&#160;these&#160;services&#160;provides&#160;the&#160;required&#160;level&#160;of&#160;performance.</p>
<p style="position:absolute;top:423px;left:226px;white-space:nowrap" class="ft3111">That&#160;is,</p>
<p style="position:absolute;top:422px;left:276px;white-space:nowrap" class="ft3154">k</p>
<p style="position:absolute;top:423px;left:289px;white-space:nowrap" class="ft3111">of&#160;these&#160;services&#160;can&#160;be&#160;“trusted”.&#160;The&#160;remaining</p>
<p style="position:absolute;top:422px;left:593px;white-space:nowrap" class="ft3154">n</p>
<p style="position:absolute;top:422px;left:606px;white-space:nowrap" class="ft3130">−</p>
<p style="position:absolute;top:422px;left:621px;white-space:nowrap" class="ft3154">k</p>
<p style="position:absolute;top:423px;left:634px;white-space:nowrap" class="ft3111">services&#160;will&#160;have</p>
<p style="position:absolute;top:441px;left:226px;white-space:nowrap" class="ft3112">their&#160;dynamic&#160;registers&#160;altered&#160;to&#160;reflect&#160;their&#160;temporary&#160;untrusted&#160;state.&#160;Once&#160;any&#160;of<br/>these&#160;services&#160;can&#160;grab&#160;more&#160;resources&#160;on&#160;their&#160;physical&#160;node,&#160;they&#160;can&#160;report&#160;this<br/>change&#160;dynamically&#160;and&#160;rejoin&#160;the&#160;service&#160;pool.</p>
<p style="position:absolute;top:517px;left:226px;white-space:nowrap" class="ft3133"><b>2.4.3</b></p>
<p style="position:absolute;top:517px;left:280px;white-space:nowrap" class="ft3133"><b>Conclusion</b></p>
<p style="position:absolute;top:547px;left:226px;white-space:nowrap" class="ft3112">This&#160;section&#160;introduced&#160;our&#160;design&#160;of&#160;an&#160;enhanced&#160;VM&#160;integrity&#160;management&#160;frame-<br/>work&#160;that&#160;is&#160;able&#160;to&#160;handle&#160;inter-VM&#160;integrity&#160;relations&#160;and&#160;dynamic&#160;integrity&#160;mea-<br/>surements.&#160;These&#160;aspects&#160;will&#160;be&#160;valuable&#160;to&#160;virtulized&#160;platforms&#160;that&#160;require&#160;more<br/>flexibility&#160;than&#160;current&#160;Trusted&#160;Computing&#160;solutions&#160;provide.</p>
<p style="position:absolute;top:619px;left:248px;white-space:nowrap" class="ft3111">The&#160;current&#160;CC@Home&#160;scenario&#160;did&#160;not&#160;involve&#160;a&#160;use&#160;case&#160;that&#160;utilizes&#160;these&#160;in-</p>
<p style="position:absolute;top:637px;left:226px;white-space:nowrap" class="ft3112">tegrity&#160;management&#160;enhancements,&#160;hence&#160;the&#160;resulting&#160;framework&#160;was&#160;not&#160;incorpo-<br/>rated&#160;into&#160;this&#160;year’s&#160;demonstrator.&#160;We&#160;expect&#160;to&#160;finalize&#160;our&#160;implementation&#160;and<br/>employ&#160;this&#160;framework&#160;as&#160;our&#160;VM&#160;integrity&#160;management&#160;solution&#160;in&#160;the&#160;next&#160;year’s<br/>demonstrator.</p>
<p style="position:absolute;top:737px;left:226px;white-space:nowrap" class="ft3122"><b>2.5</b></p>
<p style="position:absolute;top:737px;left:274px;white-space:nowrap" class="ft3122"><b>Xen&#160;Cross-resource&#160;Policy&#160;Validation</b></p>
<p style="position:absolute;top:775px;left:470px;white-space:nowrap" class="ft3111">B.&#160;Jansen,&#160;H.&#160;Ramasamy,&#160;M.&#160;Schunter&#160;(IBM)</p>
<p style="position:absolute;top:848px;left:226px;white-space:nowrap" class="ft3133"><b>2.5.1</b></p>
<p style="position:absolute;top:848px;left:280px;white-space:nowrap" class="ft3133"><b>Introduction</b></p>
<p style="position:absolute;top:878px;left:226px;white-space:nowrap" class="ft3112">Hardware&#160;virtualization&#160;is&#160;enjoying&#160;a&#160;resurgence&#160;of&#160;interest&#160;fuelled,&#160;in&#160;part,&#160;by&#160;its&#160;cost-<br/>saving&#160;potential&#160;in&#160;utility&#160;computing,&#160;where&#160;it&#160;can&#160;help&#160;improve&#160;server&#160;utilisation,&#160;re-<br/>duce&#160;management&#160;and&#160;power&#160;costs,&#160;and&#160;control&#160;the&#160;problem&#160;of&#160;server&#160;sprawl.</p>
<p style="position:absolute;top:932px;left:248px;white-space:nowrap" class="ft3111">Even&#160;in&#160;traditional&#160;non-virtualized&#160;environments,&#160;security&#160;protection,&#160;enforcement,</p>
<p style="position:absolute;top:950px;left:226px;white-space:nowrap" class="ft3112">and&#160;verification&#160;of&#160;physical&#160;servers&#160;are&#160;non-trivial.&#160;Virtualization&#160;makes&#160;these&#160;tasks<br/>even&#160;harder.&#160;Security&#160;management&#160;of&#160;virtual&#160;servers&#160;is&#160;complicated&#160;because&#160;(1)&#160;dif-<br/>ferent&#160;virtual&#160;servers&#160;sharing&#160;the&#160;same&#160;hardware&#160;resources&#160;may&#160;be&#160;subject&#160;to&#160;different<br/>and&#160;conflicting&#160;security&#160;requirements,&#160;(2)&#160;they&#160;may&#160;not&#160;be&#160;isolated&#160;from&#160;each&#160;other<br/>in&#160;a&#160;verifiable&#160;manner,&#160;and&#160;(3)&#160;privacy&#160;requirements&#160;may&#160;dictate&#160;that&#160;data&#160;needed&#160;for<br/>verifying&#160;the&#160;integrity&#160;of&#160;one&#160;virtual&#160;server&#160;should&#160;not&#160;contain&#160;information&#160;about&#160;other<br/>virtual&#160;servers.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft3118">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 32 -->
<a name="32"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3261{font-size:10px;font-family:YAMBRK+CMMI7;color:#231f20;}
	.ft3262{font-size:15px;font-family:SOXEZO+CMSS10;color:#231f20;}
	.ft3263{font-size:10px;font-family:WPXLSL+CMSY7;color:#231f20;}
-->
</style>
<div id="page32-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC032.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft3211">30</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft3218">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:194px;left:172px;white-space:nowrap" class="ft3211">We&#160;make&#160;two&#160;main&#160;contributions.&#160;We&#160;show&#160;how&#160;to&#160;protect&#160;given&#160;security&#160;policies</p>
<p style="position:absolute;top:212px;left:150px;white-space:nowrap" class="ft3213">against&#160;modification&#160;throughout&#160;the&#160;life&#160;cycle&#160;of&#160;a&#160;virtual&#160;machine&#160;(VM).&#160;We&#160;also&#160;show<br/>how&#160;to&#160;prove&#160;compliance&#160;with&#160;given&#160;security&#160;requirements.&#160;For&#160;past&#160;compliance,&#160;we<br/>prove&#160;that&#160;the&#160;system&#160;state&#160;as&#160;reflected&#160;by&#160;log&#160;files&#160;satisfies&#160;certain&#160;conditions.&#160;For<br/>future&#160;compliance,&#160;we&#160;prove&#160;that&#160;the&#160;security&#160;policies&#160;enforced&#160;imply&#160;the&#160;given&#160;security<br/>requirements&#160;and&#160;that&#160;they&#160;cannot&#160;be&#160;modified.</p>
<p style="position:absolute;top:301px;left:172px;white-space:nowrap" class="ft3211">In&#160;making&#160;these&#160;contributions,&#160;we&#160;also&#160;generalise&#160;TPM-based&#160;integrity&#160;protection,</p>
<p style="position:absolute;top:319px;left:150px;white-space:nowrap" class="ft3212">enforcement,&#160;and&#160;verification&#160;mechanisms&#160;to&#160;cover&#160;virtual&#160;machines&#160;and&#160;pluggable<br/>devices&#160;that&#160;can&#160;be&#160;governed&#160;by&#160;arbitrary&#160;security&#160;policies,&#160;e.g.,&#160;isolation&#160;policies&#160;for<br/>secure&#160;device&#160;virtualization&#160;and&#160;migration&#160;constraints&#160;for&#160;VMs.&#160;Our&#160;mechanisms&#160;are<br/>both&#160;extensible&#160;and&#160;flexible.&#160;By&#160;<i>extensibility</i>,&#160;we&#160;mean&#160;that&#160;it&#160;is&#160;possible&#160;to&#160;guarantee<br/>compliance&#160;even&#160;if&#160;arbitrary&#160;virtual&#160;devices&#160;are&#160;attached&#160;to&#160;the&#160;VMs.&#160;<i>Flexibility&#160;</i>means<br/>that&#160;the&#160;verifier&#160;is&#160;able&#160;to&#160;specify&#160;security&#160;requirements&#160;to&#160;be&#160;evaluated&#160;against&#160;the<br/>enforced&#160;policies&#160;of&#160;the&#160;VM,&#160;virtual&#160;devices,&#160;and&#160;underlying&#160;platform&#160;that&#160;it&#160;cares<br/>about,&#160;and&#160;obtain&#160;only&#160;the&#160;information&#160;corresponding&#160;to&#160;those&#160;aspects&#160;for&#160;validation&#160;of<br/>system&#160;compliance.</p>
<p style="position:absolute;top:480px;left:172px;white-space:nowrap" class="ft3211">We&#160;describe&#160;a&#160;formal&#160;model&#160;for&#160;the&#160;generalised&#160;integrity&#160;mechanisms;&#160;based&#160;on&#160;the</p>
<p style="position:absolute;top:498px;left:150px;white-space:nowrap" class="ft3212">model,&#160;we&#160;describe&#160;an&#160;integrity&#160;architecture&#160;called&#160;PEV&#160;(which&#160;stands&#160;for&#160;protection,<br/>enforcement,&#160;and&#160;verification)&#160;and&#160;associated&#160;protocols.&#160;The&#160;architecture&#160;incorporates<br/>integrity&#160;verification&#160;and&#160;protection&#160;as&#160;part&#160;of&#160;the&#160;virtualization&#160;software&#160;while&#160;simul-<br/>taneously&#160;enhancing&#160;its&#160;policy&#160;enforcement&#160;capabilities.&#160;While&#160;the&#160;PEV&#160;architecture<br/>itself&#160;is&#160;not&#160;tied&#160;to&#160;one&#160;specific&#160;virtualization&#160;software,&#160;we&#160;describe&#160;a&#160;prototype&#160;realisa-<br/>tion&#160;of&#160;our&#160;architecture&#160;using&#160;the&#160;Xen&#160;hypervisor.</p>
<p style="position:absolute;top:606px;left:172px;white-space:nowrap" class="ft3211">We&#160;build&#160;on&#160;previous&#160;work&#160;by&#160;others&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#69">[8,&#160;10,&#160;</a><a href="Open_TC_D05.2_SecServicesPoC.html#71">29,&#160;32,&#160;</a><a href="Open_TC_D05.2_SecServicesPoC.html#69">3]&#160;</a>who&#160;have&#160;used&#160;the&#160;Trusted</p>
<p style="position:absolute;top:624px;left:150px;white-space:nowrap" class="ft3212">Platform&#160;Module&#160;(TPM)&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#71">[38]&#160;</a>to&#160;protect&#160;the&#160;integrity&#160;of&#160;the&#160;core&#160;virtual&#160;machine&#160;mon-<br/>itor&#160;(VMM)&#160;and&#160;to&#160;reliably&#160;isolate&#160;VMs.&#160;The&#160;foundation&#160;of&#160;our&#160;architecture&#160;is&#160;a&#160;small<br/>trusted&#160;computing&#160;base&#160;(TCB)&#160;that&#160;provides&#160;(1)&#160;reliable&#160;write-only&#160;logging&#160;of&#160;executa-<br/>bles&#160;and&#160;data,&#160;and&#160;(2)&#160;conditional&#160;release&#160;of&#160;secrets,&#160;i.e.,&#160;a&#160;key&#160;and&#160;a&#160;condition&#160;can&#160;be<br/>stored&#160;such&#160;that&#160;the&#160;key&#160;is&#160;released&#160;only&#160;if&#160;the&#160;log&#160;file&#160;satisfies&#160;the&#160;condition&#160;specified.</p>
<p style="position:absolute;top:754px;left:150px;white-space:nowrap" class="ft3233"><b>2.5.2</b></p>
<p style="position:absolute;top:754px;left:204px;white-space:nowrap" class="ft3233"><b>Formal&#160;Integrity&#160;Model&#160;for&#160;Virtual&#160;Machines</b></p>
<p style="position:absolute;top:784px;left:150px;white-space:nowrap" class="ft3213">Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#33">2.11&#160;</a>shows&#160;our&#160;system&#160;model&#160;for&#160;integrity&#160;management.&#160;At&#160;a&#160;high&#160;level,&#160;the<br/>system&#160;consists&#160;of&#160;hardware,&#160;the&#160;VMM,&#160;and&#160;VMs,&#160;and&#160;is&#160;configured&#160;with&#160;a&#160;policy</p>
<p style="position:absolute;top:802px;left:654px;white-space:nowrap" class="ft3254">p</p>
<p style="position:absolute;top:802px;left:662px;white-space:nowrap" class="ft3211">.</p>
<p style="position:absolute;top:820px;left:150px;white-space:nowrap" class="ft3211">At&#160;a&#160;given&#160;time</p>
<p style="position:absolute;top:820px;left:246px;white-space:nowrap" class="ft3254">t</p>
<p style="position:absolute;top:820px;left:252px;white-space:nowrap" class="ft3211">,&#160;the&#160;system&#160;has&#160;an&#160;integrity&#160;state</p>
<p style="position:absolute;top:820px;left:454px;white-space:nowrap" class="ft3254">s</p>
<p style="position:absolute;top:825px;left:461px;white-space:nowrap" class="ft3261">t</p>
<p style="position:absolute;top:820px;left:471px;white-space:nowrap" class="ft3211">and&#160;produces&#160;log&#160;data</p>
<p style="position:absolute;top:820px;left:606px;white-space:nowrap" class="ft3254">log</p>
<p style="position:absolute;top:820px;left:629px;white-space:nowrap" class="ft3211">that&#160;is</p>
<p style="position:absolute;top:838px;left:150px;white-space:nowrap" class="ft3211">computed&#160;by&#160;a&#160;function</p>
<p style="position:absolute;top:838px;left:292px;white-space:nowrap" class="ft3262">log</p>
<p style="position:absolute;top:837px;left:311px;white-space:nowrap" class="ft3255">(</p>
<p style="position:absolute;top:838px;left:316px;white-space:nowrap" class="ft3254">s</p>
<p style="position:absolute;top:843px;left:323px;white-space:nowrap" class="ft3261">t</p>
<p style="position:absolute;top:837px;left:329px;white-space:nowrap" class="ft3255">)</p>
<p style="position:absolute;top:838px;left:334px;white-space:nowrap" class="ft3211">.&#160;External&#160;to&#160;the&#160;system&#160;are&#160;an&#160;<i>audit&#160;system&#160;</i>and&#160;policies.</p>
<p style="position:absolute;top:856px;left:150px;white-space:nowrap" class="ft3211">The&#160;audit&#160;system&#160;stores&#160;log&#160;files,</p>
<p style="position:absolute;top:856px;left:349px;white-space:nowrap" class="ft3254">log</p>
<p style="position:absolute;top:855px;left:369px;white-space:nowrap" class="ft3263">∗</p>
<p style="position:absolute;top:856px;left:375px;white-space:nowrap" class="ft3211">.&#160;The&#160;contents&#160;of&#160;log&#160;files&#160;include&#160;policy&#160;updates</p>
<p style="position:absolute;top:874px;left:150px;white-space:nowrap" class="ft3213">and&#160;indicate&#160;the&#160;integrity&#160;history&#160;of&#160;the&#160;system,&#160;i.e.,&#160;how&#160;good&#160;the&#160;policy&#160;enforcement<br/>has&#160;been&#160;so&#160;far.&#160;The&#160;policies&#160;are&#160;needed&#160;for&#160;configuring&#160;the&#160;system&#160;and&#160;are&#160;useful&#160;in<br/>estimating&#160;the&#160;future&#160;integrity&#160;of&#160;the&#160;system,&#160;i.e.,&#160;how&#160;good&#160;the&#160;policy&#160;enforcement<br/>is&#160;likely&#160;to&#160;be&#160;in&#160;the&#160;future.&#160;Thus,&#160;both&#160;the&#160;audit&#160;system&#160;and&#160;policies&#160;can&#160;be&#160;used&#160;to<br/>evaluate&#160;the&#160;integrity&#160;state&#160;of&#160;the&#160;platform.</p>
<p style="position:absolute;top:964px;left:172px;white-space:nowrap" class="ft3211">Typically,&#160;a&#160;computing&#160;system&#160;consists&#160;of&#160;a&#160;large&#160;number&#160;of&#160;subsystems&#160;and&#160;com-</p>
<p style="position:absolute;top:982px;left:150px;white-space:nowrap" class="ft3212">ponents&#160;that&#160;may&#160;depend&#160;on&#160;each&#160;other,&#160;e.g.,&#160;hardware&#160;components,&#160;such&#160;as&#160;CPU&#160;and<br/>devices,&#160;and&#160;software&#160;components,&#160;such&#160;as&#160;kernel,&#160;libraries,&#160;drivers,&#160;and&#160;user&#160;appli-<br/>cations.&#160;To&#160;provide&#160;extensibility,&#160;new&#160;types&#160;of&#160;subsystems&#160;may&#160;need&#160;to&#160;be&#160;added&#160;at<br/>run-time.&#160;To&#160;provide&#160;flexibility,&#160;it&#160;is&#160;desirable&#160;that&#160;each&#160;subsystem&#160;be&#160;able&#160;to&#160;offer&#160;as-<br/>surance&#160;only&#160;about&#160;specific&#160;aspects&#160;of&#160;its&#160;behaviour&#160;(instead&#160;of&#160;its&#160;full&#160;behaviour).&#160;For<br/>example,&#160;a&#160;disk&#160;should&#160;be&#160;able&#160;to&#160;log&#160;some&#160;of&#160;its&#160;contents&#160;or&#160;just&#160;its&#160;access&#160;control&#160;list.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft3218">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 33 -->
<a name="33"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3364{font-size:11px;font-family:Helvetica;color:#000000;}
	.ft3365{font-size:7px;font-family:Helvetica;color:#000000;}
	.ft3366{font-size:7px;font-family:Helvetica;color:#000000;}
	.ft3367{font-size:9px;font-family:MEDLMS+TT1D56o00;color:#000000;}
	.ft3368{font-size:9px;font-family:KPSHBO+TT1D57o00;color:#000000;}
	.ft3369{font-size:7px;font-family:KPSHBO+TT1D58o00;color:#000000;}
	.ft3370{font-size:9px;font-family:ACHYIG+TT1D59o00;color:#000000;}
	.ft3371{font-size:9px;font-family:ACHYIG+TT1D5Ao00;color:#000000;}
	.ft3372{font-size:9px;font-family:CXOYBI+TT1D4Co00;color:#000000;}
	.ft3373{font-size:9px;font-family:RDZRPI+TT1D4Do00;color:#000000;}
	.ft3374{font-size:6px;font-family:CXOYBI+TT1D4Eo00;color:#000000;}
	.ft3375{font-size:6px;font-family:KPSHBO+TT1D4Fo00;color:#000000;}
	.ft3376{font-size:11px;font-family:Times;color:#000000;}
-->
</style>
<div id="page33-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC033.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft3311">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft3311">31</p>
<p style="position:absolute;top:269px;left:373px;white-space:nowrap" class="ft3364"><b>VMM</b></p>
<p style="position:absolute;top:234px;left:541px;white-space:nowrap" class="ft3349"><b>Audit</b></p>
<p style="position:absolute;top:243px;left:537px;white-space:nowrap" class="ft3349"><b>System</b></p>
<p style="position:absolute;top:249px;left:319px;white-space:nowrap" class="ft3365"><i>policy</i></p>
<p style="position:absolute;top:249px;left:351px;white-space:nowrap" class="ft3365"><i>request</i></p>
<p style="position:absolute;top:249px;left:389px;white-space:nowrap" class="ft3365"><i>response</i></p>
<p style="position:absolute;top:244px;left:448px;white-space:nowrap" class="ft3366">state</p>
<p style="position:absolute;top:231px;left:391px;white-space:nowrap" class="ft3364"><b>VM</b></p>
<p style="position:absolute;top:206px;left:444px;white-space:nowrap" class="ft3366">input</p>
<p style="position:absolute;top:220px;left:442px;white-space:nowrap" class="ft3366">output</p>
<p style="position:absolute;top:194px;left:480px;white-space:nowrap" class="ft3349"><b>Verifier/User</b></p>
<p style="position:absolute;top:287px;left:360px;white-space:nowrap" class="ft3364"><b>Hardware</b></p>
<p style="position:absolute;top:255px;left:542px;white-space:nowrap" class="ft3366">History</p>
<p style="position:absolute;top:262px;left:547px;white-space:nowrap" class="ft3365"><i>log*</i></p>
<p style="position:absolute;top:206px;left:489px;white-space:nowrap" class="ft3366">requirements</p>
<p style="position:absolute;top:213px;left:490px;white-space:nowrap" class="ft3366">predicate&#160;&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:209px;left:519px;white-space:nowrap" class="ft3367">Π</p>
<p style="position:absolute;top:209px;left:519px;white-space:nowrap" class="ft3367">Π</p>
<p style="position:absolute;top:246px;left:452px;white-space:nowrap" class="ft3368">s</p>
<p style="position:absolute;top:249px;left:456px;white-space:nowrap" class="ft3369">t</p>
<p style="position:absolute;top:246px;left:452px;white-space:nowrap" class="ft3368">s</p>
<p style="position:absolute;top:249px;left:456px;white-space:nowrap" class="ft3369">t</p>
<p style="position:absolute;top:208px;left:366px;white-space:nowrap" class="ft3364"><b>System</b></p>
<p style="position:absolute;top:236px;left:474px;white-space:nowrap" class="ft3370">log</p>
<p style="position:absolute;top:236px;left:488px;white-space:nowrap" class="ft3367">=</p>
<p style="position:absolute;top:236px;left:497px;white-space:nowrap" class="ft3371">log</p>
<p style="position:absolute;top:236px;left:509px;white-space:nowrap" class="ft3367">(</p>
<p style="position:absolute;top:237px;left:513px;white-space:nowrap" class="ft3368">s</p>
<p style="position:absolute;top:240px;left:517px;white-space:nowrap" class="ft3369">t</p>
<p style="position:absolute;top:236px;left:520px;white-space:nowrap" class="ft3367">)</p>
<p style="position:absolute;top:236px;left:474px;white-space:nowrap" class="ft3370">log</p>
<p style="position:absolute;top:236px;left:488px;white-space:nowrap" class="ft3367">=</p>
<p style="position:absolute;top:236px;left:497px;white-space:nowrap" class="ft3371">log</p>
<p style="position:absolute;top:236px;left:509px;white-space:nowrap" class="ft3367">(</p>
<p style="position:absolute;top:237px;left:513px;white-space:nowrap" class="ft3368">s</p>
<p style="position:absolute;top:240px;left:517px;white-space:nowrap" class="ft3369">t</p>
<p style="position:absolute;top:236px;left:520px;white-space:nowrap" class="ft3367">)</p>
<p style="position:absolute;top:324px;left:323px;white-space:nowrap" class="ft3311">Figure&#160;2.11:&#160;System&#160;Model&#160;for&#160;Integrity&#160;Management</p>
<p style="position:absolute;top:354px;left:410px;white-space:nowrap" class="ft3372">(</p>
<p style="position:absolute;top:354px;left:413px;white-space:nowrap" class="ft3373">id,&#160;type,&#160;log</p>
<p style="position:absolute;top:354px;left:458px;white-space:nowrap" class="ft3372">)</p>
<p style="position:absolute;top:354px;left:410px;white-space:nowrap" class="ft3372">(</p>
<p style="position:absolute;top:354px;left:413px;white-space:nowrap" class="ft3373">id,&#160;type,&#160;log</p>
<p style="position:absolute;top:354px;left:458px;white-space:nowrap" class="ft3372">)</p>
<p style="position:absolute;top:376px;left:362px;white-space:nowrap" class="ft3372">(</p>
<p style="position:absolute;top:376px;left:366px;white-space:nowrap" class="ft3373">id</p>
<p style="position:absolute;top:380px;left:374px;white-space:nowrap" class="ft3374">1</p>
<p style="position:absolute;top:376px;left:378px;white-space:nowrap" class="ft3373">,&#160;type</p>
<p style="position:absolute;top:380px;left:399px;white-space:nowrap" class="ft3374">1</p>
<p style="position:absolute;top:376px;left:403px;white-space:nowrap" class="ft3373">,&#160;log</p>
<p style="position:absolute;top:380px;left:418px;white-space:nowrap" class="ft3374">1</p>
<p style="position:absolute;top:376px;left:422px;white-space:nowrap" class="ft3372">)</p>
<p style="position:absolute;top:376px;left:362px;white-space:nowrap" class="ft3372">(</p>
<p style="position:absolute;top:376px;left:366px;white-space:nowrap" class="ft3373">id</p>
<p style="position:absolute;top:380px;left:374px;white-space:nowrap" class="ft3374">1</p>
<p style="position:absolute;top:376px;left:378px;white-space:nowrap" class="ft3373">,&#160;type</p>
<p style="position:absolute;top:380px;left:399px;white-space:nowrap" class="ft3374">1</p>
<p style="position:absolute;top:376px;left:403px;white-space:nowrap" class="ft3373">,&#160;log</p>
<p style="position:absolute;top:380px;left:418px;white-space:nowrap" class="ft3374">1</p>
<p style="position:absolute;top:376px;left:422px;white-space:nowrap" class="ft3372">)</p>
<p style="position:absolute;top:374px;left:455px;white-space:nowrap" class="ft3372">(</p>
<p style="position:absolute;top:374px;left:459px;white-space:nowrap" class="ft3373">id</p>
<p style="position:absolute;top:378px;left:466px;white-space:nowrap" class="ft3374">2</p>
<p style="position:absolute;top:374px;left:471px;white-space:nowrap" class="ft3373">,&#160;type</p>
<p style="position:absolute;top:378px;left:491px;white-space:nowrap" class="ft3374">2</p>
<p style="position:absolute;top:374px;left:495px;white-space:nowrap" class="ft3373">,&#160;log</p>
<p style="position:absolute;top:378px;left:511px;white-space:nowrap" class="ft3374">2</p>
<p style="position:absolute;top:374px;left:515px;white-space:nowrap" class="ft3372">)</p>
<p style="position:absolute;top:374px;left:455px;white-space:nowrap" class="ft3372">(</p>
<p style="position:absolute;top:374px;left:459px;white-space:nowrap" class="ft3373">id</p>
<p style="position:absolute;top:378px;left:466px;white-space:nowrap" class="ft3374">2</p>
<p style="position:absolute;top:374px;left:471px;white-space:nowrap" class="ft3373">,&#160;type</p>
<p style="position:absolute;top:378px;left:491px;white-space:nowrap" class="ft3374">2</p>
<p style="position:absolute;top:374px;left:495px;white-space:nowrap" class="ft3373">,&#160;log</p>
<p style="position:absolute;top:378px;left:511px;white-space:nowrap" class="ft3374">2</p>
<p style="position:absolute;top:374px;left:515px;white-space:nowrap" class="ft3372">)</p>
<p style="position:absolute;top:397px;left:335px;white-space:nowrap" class="ft3372">(</p>
<p style="position:absolute;top:397px;left:339px;white-space:nowrap" class="ft3373">id</p>
<p style="position:absolute;top:401px;left:346px;white-space:nowrap" class="ft3374">11</p>
<p style="position:absolute;top:397px;left:354px;white-space:nowrap" class="ft3373">,&#160;type</p>
<p style="position:absolute;top:401px;left:375px;white-space:nowrap" class="ft3374">11</p>
<p style="position:absolute;top:397px;left:383px;white-space:nowrap" class="ft3373">,&#160;log</p>
<p style="position:absolute;top:401px;left:398px;white-space:nowrap" class="ft3374">11</p>
<p style="position:absolute;top:397px;left:406px;white-space:nowrap" class="ft3372">)</p>
<p style="position:absolute;top:397px;left:335px;white-space:nowrap" class="ft3372">(</p>
<p style="position:absolute;top:397px;left:339px;white-space:nowrap" class="ft3373">id</p>
<p style="position:absolute;top:401px;left:346px;white-space:nowrap" class="ft3374">11</p>
<p style="position:absolute;top:397px;left:354px;white-space:nowrap" class="ft3373">,&#160;type</p>
<p style="position:absolute;top:401px;left:375px;white-space:nowrap" class="ft3374">11</p>
<p style="position:absolute;top:397px;left:383px;white-space:nowrap" class="ft3373">,&#160;log</p>
<p style="position:absolute;top:401px;left:398px;white-space:nowrap" class="ft3374">11</p>
<p style="position:absolute;top:397px;left:406px;white-space:nowrap" class="ft3372">)</p>
<p style="position:absolute;top:397px;left:442px;white-space:nowrap" class="ft3372">(</p>
<p style="position:absolute;top:397px;left:446px;white-space:nowrap" class="ft3373">id</p>
<p style="position:absolute;top:402px;left:454px;white-space:nowrap" class="ft3374">21</p>
<p style="position:absolute;top:397px;left:461px;white-space:nowrap" class="ft3373">,&#160;type</p>
<p style="position:absolute;top:402px;left:482px;white-space:nowrap" class="ft3374">21</p>
<p style="position:absolute;top:397px;left:490px;white-space:nowrap" class="ft3373">,&#160;log</p>
<p style="position:absolute;top:402px;left:505px;white-space:nowrap" class="ft3374">21</p>
<p style="position:absolute;top:397px;left:513px;white-space:nowrap" class="ft3372">)</p>
<p style="position:absolute;top:397px;left:442px;white-space:nowrap" class="ft3372">(</p>
<p style="position:absolute;top:397px;left:446px;white-space:nowrap" class="ft3373">id</p>
<p style="position:absolute;top:402px;left:454px;white-space:nowrap" class="ft3374">21</p>
<p style="position:absolute;top:397px;left:461px;white-space:nowrap" class="ft3373">,&#160;type</p>
<p style="position:absolute;top:402px;left:482px;white-space:nowrap" class="ft3374">21</p>
<p style="position:absolute;top:397px;left:490px;white-space:nowrap" class="ft3373">,&#160;log</p>
<p style="position:absolute;top:402px;left:505px;white-space:nowrap" class="ft3374">21</p>
<p style="position:absolute;top:397px;left:513px;white-space:nowrap" class="ft3372">)&#160;(</p>
<p style="position:absolute;top:397px;left:533px;white-space:nowrap" class="ft3373">id</p>
<p style="position:absolute;top:402px;left:541px;white-space:nowrap" class="ft3374">2</p>
<p style="position:absolute;top:403px;left:544px;white-space:nowrap" class="ft3375">n</p>
<p style="position:absolute;top:397px;left:549px;white-space:nowrap" class="ft3373">,&#160;type</p>
<p style="position:absolute;top:402px;left:570px;white-space:nowrap" class="ft3374">2</p>
<p style="position:absolute;top:403px;left:574px;white-space:nowrap" class="ft3375">n</p>
<p style="position:absolute;top:397px;left:579px;white-space:nowrap" class="ft3373">,&#160;log</p>
<p style="position:absolute;top:402px;left:594px;white-space:nowrap" class="ft3374">2</p>
<p style="position:absolute;top:403px;left:598px;white-space:nowrap" class="ft3375">n</p>
<p style="position:absolute;top:397px;left:603px;white-space:nowrap" class="ft3372">)</p>
<p style="position:absolute;top:397px;left:529px;white-space:nowrap" class="ft3372">(</p>
<p style="position:absolute;top:397px;left:533px;white-space:nowrap" class="ft3373">id</p>
<p style="position:absolute;top:402px;left:541px;white-space:nowrap" class="ft3374">2</p>
<p style="position:absolute;top:403px;left:544px;white-space:nowrap" class="ft3375">n</p>
<p style="position:absolute;top:397px;left:549px;white-space:nowrap" class="ft3373">,&#160;type</p>
<p style="position:absolute;top:402px;left:570px;white-space:nowrap" class="ft3374">2</p>
<p style="position:absolute;top:403px;left:574px;white-space:nowrap" class="ft3375">n</p>
<p style="position:absolute;top:397px;left:579px;white-space:nowrap" class="ft3373">,&#160;log</p>
<p style="position:absolute;top:402px;left:594px;white-space:nowrap" class="ft3374">2</p>
<p style="position:absolute;top:403px;left:598px;white-space:nowrap" class="ft3375">n</p>
<p style="position:absolute;top:397px;left:603px;white-space:nowrap" class="ft3372">)</p>
<p style="position:absolute;top:418px;left:311px;white-space:nowrap" class="ft3372">(</p>
<p style="position:absolute;top:418px;left:314px;white-space:nowrap" class="ft3373">id</p>
<p style="position:absolute;top:422px;left:322px;white-space:nowrap" class="ft3374">111</p>
<p style="position:absolute;top:418px;left:333px;white-space:nowrap" class="ft3373">,&#160;type</p>
<p style="position:absolute;top:422px;left:354px;white-space:nowrap" class="ft3374">111</p>
<p style="position:absolute;top:418px;left:365px;white-space:nowrap" class="ft3373">,&#160;log</p>
<p style="position:absolute;top:422px;left:381px;white-space:nowrap" class="ft3374">111</p>
<p style="position:absolute;top:418px;left:392px;white-space:nowrap" class="ft3372">)</p>
<p style="position:absolute;top:418px;left:311px;white-space:nowrap" class="ft3372">(</p>
<p style="position:absolute;top:418px;left:314px;white-space:nowrap" class="ft3373">id</p>
<p style="position:absolute;top:422px;left:322px;white-space:nowrap" class="ft3374">111</p>
<p style="position:absolute;top:418px;left:333px;white-space:nowrap" class="ft3373">,&#160;type</p>
<p style="position:absolute;top:422px;left:354px;white-space:nowrap" class="ft3374">111</p>
<p style="position:absolute;top:418px;left:365px;white-space:nowrap" class="ft3373">,&#160;log</p>
<p style="position:absolute;top:422px;left:381px;white-space:nowrap" class="ft3374">111</p>
<p style="position:absolute;top:418px;left:392px;white-space:nowrap" class="ft3372">)</p>
<p style="position:absolute;top:399px;left:516px;white-space:nowrap" class="ft3376">…</p>
<p style="position:absolute;top:388px;left:513px;white-space:nowrap" class="ft3376">…</p>
<p style="position:absolute;top:453px;left:383px;white-space:nowrap" class="ft3311">Figure&#160;2.12:&#160;Tree</p>
<p style="position:absolute;top:452px;left:491px;white-space:nowrap" class="ft3330">T</p>
<p style="position:absolute;top:453px;left:506px;white-space:nowrap" class="ft3311">of&#160;log&#160;entries</p>
<p style="position:absolute;top:501px;left:248px;white-space:nowrap" class="ft3311">To&#160;support&#160;the&#160;extensibility&#160;and&#160;flexibility&#160;goals,&#160;it&#160;is&#160;necessary&#160;for&#160;our&#160;integrity</p>
<p style="position:absolute;top:519px;left:226px;white-space:nowrap" class="ft3313">model&#160;to&#160;support&#160;more&#160;fine-grained&#160;notions&#160;of&#160;system&#160;integrity&#160;state&#160;and&#160;logging&#160;func-<br/>tion.&#160;For&#160;this&#160;purpose,&#160;we&#160;use&#160;a&#160;tree</p>
<p style="position:absolute;top:536px;left:448px;white-space:nowrap" class="ft3330">T</p>
<p style="position:absolute;top:537px;left:465px;white-space:nowrap" class="ft3311">(as&#160;shown&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#33">2.12)&#160;</a>for&#160;representing&#160;the</p>
<p style="position:absolute;top:555px;left:226px;white-space:nowrap" class="ft3312">log&#160;data,&#160;where&#160;each&#160;node&#160;is&#160;a&#160;triple&#160;and&#160;there&#160;is&#160;one&#160;triple&#160;for&#160;each&#160;component&#160;in&#160;the<br/>system.&#160;To&#160;keep&#160;the&#160;tree&#160;size&#160;manageable,&#160;the&#160;tree&#160;should&#160;include&#160;triples&#160;only&#160;for&#160;those<br/>components&#160;that&#160;have&#160;an&#160;impact&#160;on&#160;the&#160;system’s&#160;integrity&#160;or&#160;that&#160;are&#160;of&#160;interest&#160;from<br/>an&#160;integrity&#160;verification&#160;point&#160;of&#160;view.&#160;A&#160;triple&#160;for&#160;a&#160;component</p>
<p style="position:absolute;top:608px;left:605px;white-space:nowrap" class="ft3354">k</p>
<p style="position:absolute;top:609px;left:617px;white-space:nowrap" class="ft3311">contains&#160;an&#160;identifier</p>
<p style="position:absolute;top:626px;left:226px;white-space:nowrap" class="ft3354">id</p>
<p style="position:absolute;top:632px;left:239px;white-space:nowrap" class="ft3361">k</p>
<p style="position:absolute;top:627px;left:246px;white-space:nowrap" class="ft3311">,&#160;a&#160;component&#160;type</p>
<p style="position:absolute;top:626px;left:369px;white-space:nowrap" class="ft3354">type</p>
<p style="position:absolute;top:632px;left:397px;white-space:nowrap" class="ft3361">k</p>
<p style="position:absolute;top:627px;left:404px;white-space:nowrap" class="ft3311">,&#160;and&#160;a&#160;vector&#160;of&#160;log&#160;values</p>
<p style="position:absolute;top:626px;left:579px;white-space:nowrap" class="ft3354">log</p>
<p style="position:absolute;top:633px;left:598px;white-space:nowrap" class="ft3361">k</p>
<p style="position:absolute;top:627px;left:606px;white-space:nowrap" class="ft3311">.&#160;Sub-components&#160;are</p>
<p style="position:absolute;top:645px;left:226px;white-space:nowrap" class="ft3312">modelled&#160;as&#160;children&#160;of&#160;a&#160;node.&#160;The&#160;overall&#160;effect&#160;is&#160;that&#160;instead&#160;of&#160;a&#160;monolithic&#160;log<br/>data</p>
<p style="position:absolute;top:662px;left:256px;white-space:nowrap" class="ft3362">log</p>
<p style="position:absolute;top:662px;left:275px;white-space:nowrap" class="ft3355">(</p>
<p style="position:absolute;top:662px;left:280px;white-space:nowrap" class="ft3354">s</p>
<p style="position:absolute;top:668px;left:287px;white-space:nowrap" class="ft3361">t</p>
<p style="position:absolute;top:662px;left:293px;white-space:nowrap" class="ft3355">)</p>
<p style="position:absolute;top:663px;left:303px;white-space:nowrap" class="ft3311">(shown&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#33">2.11)</a>,&#160;the&#160;log&#160;data&#160;is&#160;contained&#160;in&#160;a&#160;tree&#160;of&#160;vectors&#160;of</p>
<p style="position:absolute;top:681px;left:226px;white-space:nowrap" class="ft3313">log&#160;values&#160;(shown&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#33">2.12)</a>.&#160;It&#160;can&#160;be&#160;extended&#160;by&#160;adding&#160;or&#160;removing&#160;children<br/>nodes.&#160;For&#160;example,&#160;the&#160;addition&#160;of&#160;a&#160;new&#160;virtual&#160;device&#160;to&#160;a&#160;VM&#160;can&#160;be&#160;easily&#160;reflected<br/>in&#160;the&#160;log&#160;tree&#160;by&#160;adding&#160;a&#160;new&#160;node&#160;as&#160;a&#160;child&#160;of&#160;the&#160;sub-tree&#160;that&#160;corresponds&#160;to&#160;the<br/>VM.</p>
<p style="position:absolute;top:752px;left:248px;white-space:nowrap" class="ft3311">The&#160;particular&#160;aspects&#160;of&#160;the&#160;system’s&#160;integrity&#160;state&#160;that&#160;is&#160;of&#160;interest&#160;to&#160;a&#160;user&#160;(or</p>
<p style="position:absolute;top:770px;left:226px;white-space:nowrap" class="ft3311">verifier)&#160;of&#160;the&#160;system&#160;is&#160;modelled&#160;using&#160;a&#160;<i>projection&#160;function</i>,</p>
<p style="position:absolute;top:770px;left:609px;white-space:nowrap" class="ft3362">p</p>
<p style="position:absolute;top:769px;left:617px;white-space:nowrap" class="ft3355">()</p>
<p style="position:absolute;top:770px;left:629px;white-space:nowrap" class="ft3311">.&#160;For&#160;a&#160;log&#160;tree</p>
<p style="position:absolute;top:769px;left:726px;white-space:nowrap" class="ft3330">T</p>
<p style="position:absolute;top:770px;left:738px;white-space:nowrap" class="ft3311">,</p>
<p style="position:absolute;top:788px;left:226px;white-space:nowrap" class="ft3362">p</p>
<p style="position:absolute;top:787px;left:234px;white-space:nowrap" class="ft3355">(</p>
<p style="position:absolute;top:787px;left:240px;white-space:nowrap" class="ft3330">T</p>
<p style="position:absolute;top:787px;left:251px;white-space:nowrap" class="ft3355">)</p>
<p style="position:absolute;top:788px;left:262px;white-space:nowrap" class="ft3311">is&#160;simply&#160;a&#160;collection&#160;of&#160;a&#160;subset&#160;of&#160;the&#160;log&#160;entries&#160;in&#160;a&#160;subset&#160;of&#160;the&#160;nodes&#160;of</p>
<p style="position:absolute;top:805px;left:226px;white-space:nowrap" class="ft3330">T</p>
<p style="position:absolute;top:806px;left:238px;white-space:nowrap" class="ft3311">.&#160;Formally,</p>
<p style="position:absolute;top:806px;left:311px;white-space:nowrap" class="ft3362">p</p>
<p style="position:absolute;top:805px;left:318px;white-space:nowrap" class="ft3355">(</p>
<p style="position:absolute;top:805px;left:324px;white-space:nowrap" class="ft3330">T</p>
<p style="position:absolute;top:805px;left:336px;white-space:nowrap" class="ft3355">)&#160;=</p>
<p style="position:absolute;top:805px;left:365px;white-space:nowrap" class="ft3330">{</p>
<p style="position:absolute;top:806px;left:372px;white-space:nowrap" class="ft3354">log</p>
<p style="position:absolute;top:806px;left:392px;white-space:nowrap" class="ft3363">′</p>
<p style="position:absolute;top:813px;left:396px;white-space:nowrap" class="ft3361">k</p>
<p style="position:absolute;top:805px;left:403px;white-space:nowrap" class="ft3330">}</p>
<p style="position:absolute;top:806px;left:411px;white-space:nowrap" class="ft3311">,&#160;where</p>
<p style="position:absolute;top:806px;left:460px;white-space:nowrap" class="ft3354">log</p>
<p style="position:absolute;top:806px;left:480px;white-space:nowrap" class="ft3363">′</p>
<p style="position:absolute;top:813px;left:484px;white-space:nowrap" class="ft3361">k</p>
<p style="position:absolute;top:805px;left:497px;white-space:nowrap" class="ft3330">∈</p>
<p style="position:absolute;top:806px;left:512px;white-space:nowrap" class="ft3354">log</p>
<p style="position:absolute;top:813px;left:532px;white-space:nowrap" class="ft3361">k</p>
<p style="position:absolute;top:806px;left:544px;white-space:nowrap" class="ft3311">and</p>
<p style="position:absolute;top:805px;left:570px;white-space:nowrap" class="ft3355">(</p>
<p style="position:absolute;top:806px;left:575px;white-space:nowrap" class="ft3354">id</p>
<p style="position:absolute;top:811px;left:588px;white-space:nowrap" class="ft3361">k</p>
<p style="position:absolute;top:806px;left:596px;white-space:nowrap" class="ft3354">,&#160;type</p>
<p style="position:absolute;top:811px;left:630px;white-space:nowrap" class="ft3361">k</p>
<p style="position:absolute;top:806px;left:637px;white-space:nowrap" class="ft3354">,&#160;log</p>
<p style="position:absolute;top:813px;left:664px;white-space:nowrap" class="ft3361">k</p>
<p style="position:absolute;top:805px;left:677px;white-space:nowrap" class="ft3330">∈&#160;T</p>
<p style="position:absolute;top:805px;left:704px;white-space:nowrap" class="ft3355">)</p>
<p style="position:absolute;top:806px;left:710px;white-space:nowrap" class="ft3354">.</p>
<p style="position:absolute;top:806px;left:718px;white-space:nowrap" class="ft3311">The</p>
<p style="position:absolute;top:824px;left:226px;white-space:nowrap" class="ft3311">integrity&#160;requirements&#160;of&#160;the&#160;user&#160;are&#160;modelled&#160;by&#160;a&#160;predicate</p>
<p style="position:absolute;top:823px;left:604px;white-space:nowrap" class="ft3355">Π</p>
<p style="position:absolute;top:824px;left:615px;white-space:nowrap" class="ft3311">,&#160;which&#160;is&#160;defined&#160;on</p>
<p style="position:absolute;top:842px;left:226px;white-space:nowrap" class="ft3311">the&#160;result&#160;of&#160;the&#160;projection&#160;function.</p>
<p style="position:absolute;top:860px;left:248px;white-space:nowrap" class="ft3311">Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#34">2.13&#160;</a>shows&#160;the&#160;concepts&#160;of&#160;generalised&#160;sealing,&#160;attestation,&#160;and&#160;privacy&#160;pro-</p>
<p style="position:absolute;top:878px;left:226px;white-space:nowrap" class="ft3311">tection&#160;in&#160;our&#160;formal&#160;model.&#160;We&#160;describe&#160;these&#160;concepts&#160;below.</p>
<p style="position:absolute;top:936px;left:226px;white-space:nowrap" class="ft3320"><b>Generalised&#160;Sealing&#160;to&#160;Protect&#160;Integrity</b></p>
<p style="position:absolute;top:964px;left:226px;white-space:nowrap" class="ft3313">A&#160;system&#160;endowed&#160;with&#160;a&#160;TPM&#160;can&#160;<i>seal&#160;</i>a&#160;data&#160;item&#160;to&#160;the&#160;TPM,&#160;i.e.,&#160;the&#160;system&#160;can&#160;en-<br/>crypt&#160;the&#160;data&#160;item&#160;and&#160;tie&#160;it&#160;to&#160;the&#160;system&#160;configuration&#160;existing&#160;at&#160;the&#160;time&#160;of&#160;sealing.<br/>The&#160;system&#160;configuration&#160;is&#160;reflected&#160;by&#160;a&#160;specified&#160;subset&#160;of&#160;Platform&#160;Configuration<br/>Register&#160;(PCR)&#160;values.&#160;The&#160;data&#160;item&#160;may&#160;be&#160;a&#160;key&#160;generated&#160;by&#160;the&#160;TPM&#160;itself&#160;or<br/>something&#160;generated&#160;outside&#160;the&#160;TPM.&#160;Decryption&#160;of&#160;the&#160;data&#160;item,&#160;called&#160;<i>unsealing</i>,<br/>is&#160;possible&#160;only&#160;when&#160;the&#160;system&#160;configuration&#160;(reflected&#160;by&#160;the&#160;same&#160;subset&#160;of&#160;PCR<br/>values)&#160;is&#160;the&#160;same&#160;as&#160;that&#160;at&#160;the&#160;time&#160;of&#160;sealing.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft3318">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 34 -->
<a name="34"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3477{font-size:10px;font-family:Helvetica;color:#000000;}
	.ft3478{font-size:8px;font-family:Helvetica;color:#000000;}
	.ft3479{font-size:8px;font-family:Symbol;color:#000000;}
	.ft3480{font-size:7px;font-family:IGJFUT+CMMI5;color:#231f20;}
	.ft3481{font-size:8px;line-height:9px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page34-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC034.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft3411">32</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft3418">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:271px;left:244px;white-space:nowrap" class="ft3477"><b>System</b></p>
<p style="position:absolute;top:222px;left:333px;white-space:nowrap" class="ft3477"><b>Attestation</b></p>
<p style="position:absolute;top:189px;left:335px;white-space:nowrap" class="ft3440">challenge&#160;c</p>
<p style="position:absolute;top:199px;left:335px;white-space:nowrap" class="ft3440">projection&#160;p</p>
<p style="position:absolute;top:219px;left:394px;white-space:nowrap" class="ft3440">p(<i>log*</i>)</p>
<p style="position:absolute;top:267px;left:293px;white-space:nowrap" class="ft3478"><i>log*</i></p>
<p style="position:absolute;top:243px;left:332px;white-space:nowrap" class="ft3477"><b>Sealing&#160;&#160;&#160;&#160;&#160;&#160;&#160;</b></p>
<p style="position:absolute;top:240px;left:398px;white-space:nowrap" class="ft3440">key&#160;sealed</p>
<p style="position:absolute;top:250px;left:407px;white-space:nowrap" class="ft3440">away</p>
<p style="position:absolute;top:264px;left:321px;white-space:nowrap" class="ft3440">key,&#160;data</p>
<p style="position:absolute;top:217px;left:510px;white-space:nowrap" class="ft3477"><b>Evaluation</b></p>
<p style="position:absolute;top:226px;left:511px;white-space:nowrap" class="ft3477"><b>Function&#160;f</b></p>
<p style="position:absolute;top:216px;left:564px;white-space:nowrap" class="ft3440">proof</p>
<p style="position:absolute;top:312px;left:441px;white-space:nowrap" class="ft3477"><b>TPM_Unseal</b></p>
<p style="position:absolute;top:273px;left:343px;white-space:nowrap" class="ft3481">projection&#160;p<br/>predicate&#160;</p>
<p style="position:absolute;top:280px;left:378px;white-space:nowrap" class="ft3479">Π</p>
<p style="position:absolute;top:309px;left:373px;white-space:nowrap" class="ft3440">p(<i>log*</i>)</p>
<p style="position:absolute;top:312px;left:407px;white-space:nowrap" class="ft3479">Π</p>
<p style="position:absolute;top:312px;left:407px;white-space:nowrap" class="ft3479">Π</p>
<p style="position:absolute;top:312px;left:407px;white-space:nowrap" class="ft3479">Π</p>
<p style="position:absolute;top:312px;left:407px;white-space:nowrap" class="ft3479">Π</p>
<p style="position:absolute;top:309px;left:422px;white-space:nowrap" class="ft3440">true</p>
<p style="position:absolute;top:311px;left:346px;white-space:nowrap" class="ft3477"><b>p</b></p>
<p style="position:absolute;top:306px;left:515px;white-space:nowrap" class="ft3440">reveal&#160;</p>
<p style="position:absolute;top:316px;left:506px;white-space:nowrap" class="ft3440">sealed&#160;key</p>
<p style="position:absolute;top:217px;left:426px;white-space:nowrap" class="ft3477"><b>Privacy&#160;</b></p>
<p style="position:absolute;top:226px;left:433px;white-space:nowrap" class="ft3477"><b>Filter</b></p>
<p style="position:absolute;top:216px;left:475px;white-space:nowrap" class="ft3440">privacy-</p>
<p style="position:absolute;top:226px;left:469px;white-space:nowrap" class="ft3440">preserving</p>
<p style="position:absolute;top:236px;left:470px;white-space:nowrap" class="ft3440">projection</p>
<p style="position:absolute;top:198px;left:431px;white-space:nowrap" class="ft3440">sub-view</p>
<p style="position:absolute;top:350px;left:226px;white-space:nowrap" class="ft3411">Figure&#160;2.13:&#160;Generalised&#160;Attestation,&#160;Sealing,&#160;and&#160;Unsealing</p>
<p style="position:absolute;top:398px;left:172px;white-space:nowrap" class="ft3411">We&#160;generalise&#160;the&#160;concept&#160;of&#160;sealing&#160;for&#160;protecting&#160;the&#160;integrity&#160;of&#160;a&#160;sensitive&#160;data</p>
<p style="position:absolute;top:416px;left:150px;white-space:nowrap" class="ft3411">item</p>
<p style="position:absolute;top:416px;left:181px;white-space:nowrap" class="ft3454">d</p>
<p style="position:absolute;top:416px;left:189px;white-space:nowrap" class="ft3411">,&#160;by&#160;making</p>
<p style="position:absolute;top:416px;left:266px;white-space:nowrap" class="ft3454">d</p>
<p style="position:absolute;top:416px;left:279px;white-space:nowrap" class="ft3411">inaccessible&#160;to&#160;the&#160;underlying&#160;system&#160;if&#160;the&#160;assurance&#160;about&#160;the</p>
<p style="position:absolute;top:434px;left:150px;white-space:nowrap" class="ft3413">system’s&#160;trustworthiness&#160;is&#160;deemed&#160;unsatisfactory&#160;by&#160;the&#160;entity&#160;that&#160;invoked&#160;sealing.<br/>We&#160;model&#160;the&#160;concept&#160;by&#160;two&#160;functions,</p>
<p style="position:absolute;top:451px;left:399px;white-space:nowrap" class="ft3462">seal</p>
<p style="position:absolute;top:452px;left:427px;white-space:nowrap" class="ft3411">and</p>
<p style="position:absolute;top:451px;left:453px;white-space:nowrap" class="ft3462">unseal</p>
<p style="position:absolute;top:452px;left:491px;white-space:nowrap" class="ft3411">.&#160;The</p>
<p style="position:absolute;top:451px;left:530px;white-space:nowrap" class="ft3462">seal</p>
<p style="position:absolute;top:452px;left:557px;white-space:nowrap" class="ft3411">operation&#160;takes&#160;as</p>
<p style="position:absolute;top:470px;left:150px;white-space:nowrap" class="ft3411">input&#160;the&#160;data&#160;item</p>
<p style="position:absolute;top:469px;left:268px;white-space:nowrap" class="ft3454">d</p>
<p style="position:absolute;top:470px;left:276px;white-space:nowrap" class="ft3411">,&#160;a&#160;projection&#160;function</p>
<p style="position:absolute;top:469px;left:415px;white-space:nowrap" class="ft3462">p</p>
<p style="position:absolute;top:469px;left:422px;white-space:nowrap" class="ft3455">()</p>
<p style="position:absolute;top:470px;left:434px;white-space:nowrap" class="ft3411">,&#160;a&#160;sealing&#160;predicate</p>
<p style="position:absolute;top:469px;left:560px;white-space:nowrap" class="ft3455">Π</p>
<p style="position:absolute;top:470px;left:571px;white-space:nowrap" class="ft3411">,&#160;and&#160;the&#160;public</p>
<p style="position:absolute;top:488px;left:150px;white-space:nowrap" class="ft3411">part</p>
<p style="position:absolute;top:487px;left:177px;white-space:nowrap" class="ft3454">K</p>
<p style="position:absolute;top:493px;left:190px;white-space:nowrap" class="ft3461">p</p>
<p style="position:absolute;top:488px;left:201px;white-space:nowrap" class="ft3411">of&#160;an&#160;encryption&#160;key</p>
<p style="position:absolute;top:487px;left:328px;white-space:nowrap" class="ft3454">K</p>
<p style="position:absolute;top:488px;left:342px;white-space:nowrap" class="ft3411">.&#160;At&#160;the&#160;time</p>
<p style="position:absolute;top:487px;left:423px;white-space:nowrap" class="ft3454">t</p>
<p style="position:absolute;top:493px;left:428px;white-space:nowrap" class="ft3461">i</p>
<p style="position:absolute;top:488px;left:437px;white-space:nowrap" class="ft3411">of&#160;executing&#160;the&#160;operation,&#160;the&#160;system</p>
<p style="position:absolute;top:506px;left:150px;white-space:nowrap" class="ft3411">state&#160;is&#160;reflected&#160;by&#160;the&#160;log&#160;tree</p>
<p style="position:absolute;top:505px;left:354px;white-space:nowrap" class="ft3430">T</p>
<p style="position:absolute;top:511px;left:362px;white-space:nowrap" class="ft3461">i</p>
<p style="position:absolute;top:506px;left:367px;white-space:nowrap" class="ft3411">,&#160;which&#160;includes&#160;knowledge&#160;of</p>
<p style="position:absolute;top:505px;left:564px;white-space:nowrap" class="ft3462">p</p>
<p style="position:absolute;top:505px;left:572px;white-space:nowrap" class="ft3455">()</p>
<p style="position:absolute;top:506px;left:589px;white-space:nowrap" class="ft3411">and</p>
<p style="position:absolute;top:505px;left:616px;white-space:nowrap" class="ft3455">Π</p>
<p style="position:absolute;top:506px;left:628px;white-space:nowrap" class="ft3411">.&#160;The</p>
<p style="position:absolute;top:524px;left:150px;white-space:nowrap" class="ft3411">operation&#160;produces&#160;an&#160;encrypted&#160;output</p>
<p style="position:absolute;top:523px;left:394px;white-space:nowrap" class="ft3454">e</p>
<p style="position:absolute;top:523px;left:406px;white-space:nowrap" class="ft3430">∈&#160;{</p>
<p style="position:absolute;top:523px;left:429px;white-space:nowrap" class="ft3455">0</p>
<p style="position:absolute;top:523px;left:437px;white-space:nowrap" class="ft3454">,</p>
<p style="position:absolute;top:523px;left:443px;white-space:nowrap" class="ft3455">1</p>
<p style="position:absolute;top:523px;left:451px;white-space:nowrap" class="ft3430">}</p>
<p style="position:absolute;top:523px;left:458px;white-space:nowrap" class="ft3463">∗</p>
<p style="position:absolute;top:524px;left:465px;white-space:nowrap" class="ft3411">,&#160;which&#160;is&#160;encrypted&#160;with&#160;respect</p>
<p style="position:absolute;top:541px;left:150px;white-space:nowrap" class="ft3411">to</p>
<p style="position:absolute;top:541px;left:165px;white-space:nowrap" class="ft3454">K</p>
<p style="position:absolute;top:546px;left:178px;white-space:nowrap" class="ft3461">p</p>
<p style="position:absolute;top:541px;left:185px;white-space:nowrap" class="ft3411">.&#160;The</p>
<p style="position:absolute;top:541px;left:220px;white-space:nowrap" class="ft3462">unseal</p>
<p style="position:absolute;top:541px;left:262px;white-space:nowrap" class="ft3411">operation&#160;invoked&#160;at&#160;time</p>
<p style="position:absolute;top:541px;left:417px;white-space:nowrap" class="ft3454">t</p>
<p style="position:absolute;top:546px;left:422px;white-space:nowrap" class="ft3461">j</p>
<p style="position:absolute;top:541px;left:432px;white-space:nowrap" class="ft3411">(where</p>
<p style="position:absolute;top:541px;left:477px;white-space:nowrap" class="ft3454">t</p>
<p style="position:absolute;top:546px;left:482px;white-space:nowrap" class="ft3461">j</p>
<p style="position:absolute;top:541px;left:493px;white-space:nowrap" class="ft3454">&gt;&#160;t</p>
<p style="position:absolute;top:546px;left:514px;white-space:nowrap" class="ft3461">i</p>
<p style="position:absolute;top:541px;left:519px;white-space:nowrap" class="ft3411">)&#160;takes&#160;as&#160;input</p>
<p style="position:absolute;top:541px;left:612px;white-space:nowrap" class="ft3454">e</p>
<p style="position:absolute;top:541px;left:622px;white-space:nowrap" class="ft3411">and&#160;the</p>
<p style="position:absolute;top:559px;left:150px;white-space:nowrap" class="ft3411">log&#160;state</p>
<p style="position:absolute;top:558px;left:204px;white-space:nowrap" class="ft3430">T</p>
<p style="position:absolute;top:564px;left:212px;white-space:nowrap" class="ft3461">j</p>
<p style="position:absolute;top:559px;left:222px;white-space:nowrap" class="ft3411">at&#160;that&#160;time.&#160;The&#160;operation&#160;outputs</p>
<p style="position:absolute;top:559px;left:434px;white-space:nowrap" class="ft3454">d</p>
<p style="position:absolute;top:559px;left:446px;white-space:nowrap" class="ft3411">if&#160;and&#160;only&#160;if&#160;the&#160;sealing&#160;predicate</p>
<p style="position:absolute;top:558px;left:654px;white-space:nowrap" class="ft3455">Π</p>
<p style="position:absolute;top:577px;left:150px;white-space:nowrap" class="ft3411">applied&#160;on</p>
<p style="position:absolute;top:577px;left:217px;white-space:nowrap" class="ft3462">p</p>
<p style="position:absolute;top:576px;left:225px;white-space:nowrap" class="ft3455">(</p>
<p style="position:absolute;top:576px;left:230px;white-space:nowrap" class="ft3430">T</p>
<p style="position:absolute;top:582px;left:239px;white-space:nowrap" class="ft3461">j</p>
<p style="position:absolute;top:576px;left:245px;white-space:nowrap" class="ft3455">)</p>
<p style="position:absolute;top:577px;left:255px;white-space:nowrap" class="ft3411">holds.&#160;A&#160;simple&#160;predicate&#160;may&#160;just&#160;compare&#160;the&#160;result&#160;of</p>
<p style="position:absolute;top:577px;left:601px;white-space:nowrap" class="ft3462">p</p>
<p style="position:absolute;top:576px;left:609px;white-space:nowrap" class="ft3455">(</p>
<p style="position:absolute;top:576px;left:615px;white-space:nowrap" class="ft3430">T</p>
<p style="position:absolute;top:582px;left:623px;white-space:nowrap" class="ft3461">j</p>
<p style="position:absolute;top:576px;left:629px;white-space:nowrap" class="ft3455">)</p>
<p style="position:absolute;top:577px;left:639px;white-space:nowrap" class="ft3411">with</p>
<p style="position:absolute;top:595px;left:150px;white-space:nowrap" class="ft3411">a&#160;reference&#160;value&#160;(e.g.,</p>
<p style="position:absolute;top:595px;left:293px;white-space:nowrap" class="ft3462">p</p>
<p style="position:absolute;top:594px;left:301px;white-space:nowrap" class="ft3455">(</p>
<p style="position:absolute;top:594px;left:306px;white-space:nowrap" class="ft3430">T</p>
<p style="position:absolute;top:600px;left:314px;white-space:nowrap" class="ft3461">i</p>
<p style="position:absolute;top:594px;left:320px;white-space:nowrap" class="ft3455">)</p>
<p style="position:absolute;top:595px;left:325px;white-space:nowrap" class="ft3411">).&#160;A&#160;more&#160;complex&#160;predicate&#160;may&#160;extract&#160;the&#160;high-level</p>
<p style="position:absolute;top:613px;left:150px;white-space:nowrap" class="ft3411">properties&#160;of&#160;the&#160;system&#160;from</p>
<p style="position:absolute;top:613px;left:329px;white-space:nowrap" class="ft3462">p</p>
<p style="position:absolute;top:612px;left:337px;white-space:nowrap" class="ft3455">(</p>
<p style="position:absolute;top:612px;left:343px;white-space:nowrap" class="ft3430">T</p>
<p style="position:absolute;top:612px;left:355px;white-space:nowrap" class="ft3455">)</p>
<p style="position:absolute;top:613px;left:364px;white-space:nowrap" class="ft3411">and&#160;compare&#160;them&#160;with&#160;desired&#160;properties&#160;(similar</p>
<p style="position:absolute;top:631px;left:150px;white-space:nowrap" class="ft3411">to&#160;property-based&#160;attestation&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#70">[24,&#160;</a><a href="Open_TC_D05.2_SecServicesPoC.html#71">27]</a>).</p>
<p style="position:absolute;top:649px;left:172px;white-space:nowrap" class="ft3411">One&#160;can&#160;easily&#160;see&#160;that&#160;our&#160;generalised&#160;sealing&#160;concept&#160;covers&#160;the&#160;special&#160;case&#160;of</p>
<p style="position:absolute;top:667px;left:150px;white-space:nowrap" class="ft3411">TPM&#160;sealing.&#160;For&#160;TPM&#160;sealing,</p>
<p style="position:absolute;top:666px;left:357px;white-space:nowrap" class="ft3430">T</p>
<p style="position:absolute;top:672px;left:365px;white-space:nowrap" class="ft3461">j</p>
<p style="position:absolute;top:667px;left:377px;white-space:nowrap" class="ft3411">simply&#160;consists&#160;of&#160;the&#160;values&#160;in&#160;the&#160;PCRs;&#160;the</p>
<p style="position:absolute;top:685px;left:150px;white-space:nowrap" class="ft3411">projection&#160;function</p>
<p style="position:absolute;top:684px;left:270px;white-space:nowrap" class="ft3462">p</p>
<p style="position:absolute;top:684px;left:278px;white-space:nowrap" class="ft3455">()</p>
<p style="position:absolute;top:685px;left:294px;white-space:nowrap" class="ft3411">specifies&#160;the&#160;subset&#160;of&#160;PCRs&#160;whose&#160;values&#160;are&#160;of&#160;interest&#160;for</p>
<p style="position:absolute;top:703px;left:150px;white-space:nowrap" class="ft3411">assessing&#160;the&#160;system&#160;trustworthiness;&#160;the&#160;sealing&#160;predicate</p>
<p style="position:absolute;top:702px;left:510px;white-space:nowrap" class="ft3455">Π</p>
<p style="position:absolute;top:703px;left:526px;white-space:nowrap" class="ft3411">simply&#160;checks&#160;whether</p>
<p style="position:absolute;top:721px;left:150px;white-space:nowrap" class="ft3411">their&#160;values&#160;at&#160;the&#160;time&#160;of&#160;unsealing&#160;are&#160;the&#160;same&#160;as&#160;at&#160;the&#160;time&#160;of&#160;sealing.</p>
<p style="position:absolute;top:779px;left:150px;white-space:nowrap" class="ft3420"><b>Generalised&#160;Attestation&#160;to&#160;Verify&#160;Integrity</b></p>
<p style="position:absolute;top:807px;left:150px;white-space:nowrap" class="ft3413">A&#160;TPM-equipped&#160;system&#160;can&#160;use&#160;the&#160;TPM&#160;to&#160;engage&#160;in&#160;a&#160;challenge-response&#160;style<br/>cryptographic&#160;protocol,&#160;called&#160;<i>attestation</i>,&#160;with&#160;a&#160;remote&#160;verifier.&#160;The&#160;protocol&#160;allows<br/>the&#160;remote&#160;verifier&#160;to&#160;query&#160;and&#160;reliably&#160;obtain&#160;the&#160;measurement&#160;values&#160;for&#160;the&#160;system<br/>stored&#160;in&#160;the&#160;PCRs&#160;of&#160;the&#160;TPM.&#160;Reliable&#160;reporting&#160;of&#160;the&#160;measurement&#160;values&#160;is&#160;due&#160;to<br/>the&#160;signing&#160;of&#160;the&#160;values&#160;by&#160;the&#160;TPM,&#160;which&#160;is&#160;trusted&#160;by&#160;the&#160;remote&#160;verifier.&#160;Based&#160;on<br/>these&#160;values,&#160;the&#160;remote&#160;verifier&#160;assesses&#160;the&#160;trustworthiness&#160;of&#160;the&#160;platform.</p>
<p style="position:absolute;top:914px;left:172px;white-space:nowrap" class="ft3411">We&#160;generalise&#160;the&#160;concept&#160;of&#160;attestation&#160;for&#160;verifying&#160;the&#160;integrity&#160;of&#160;those&#160;aspects</p>
<p style="position:absolute;top:932px;left:150px;white-space:nowrap" class="ft3412">of&#160;the&#160;system&#160;that&#160;are&#160;of&#160;interest&#160;to&#160;the&#160;verifier.&#160;For&#160;example,&#160;the&#160;verifier&#160;may&#160;be&#160;a<br/>Trusted&#160;Virtual&#160;Domain&#160;(TVD)&#160;master&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#69">[4]&#160;</a>who&#160;is&#160;interested&#160;in&#160;the&#160;number&#160;and&#160;type&#160;of<br/>VMs&#160;running&#160;on&#160;the&#160;system&#160;prior&#160;to&#160;allowing&#160;one&#160;of&#160;the&#160;VMs&#160;to&#160;join&#160;the&#160;TVD.</p>
<p style="position:absolute;top:986px;left:172px;white-space:nowrap" class="ft3411">In&#160;our&#160;model,&#160;the&#160;attestation&#160;function</p>
<p style="position:absolute;top:985px;left:407px;white-space:nowrap" class="ft3462">attest</p>
<p style="position:absolute;top:985px;left:442px;white-space:nowrap" class="ft3455">()</p>
<p style="position:absolute;top:986px;left:459px;white-space:nowrap" class="ft3411">obtains&#160;as&#160;input&#160;a&#160;challenge</p>
<p style="position:absolute;top:985px;left:636px;white-space:nowrap" class="ft3454">c</p>
<p style="position:absolute;top:986px;left:642px;white-space:nowrap" class="ft3411">,&#160;an</p>
<p style="position:absolute;top:1004px;left:150px;white-space:nowrap" class="ft3411">evaluation&#160;function</p>
<p style="position:absolute;top:1003px;left:271px;white-space:nowrap" class="ft3462">f</p>
<p style="position:absolute;top:1003px;left:277px;white-space:nowrap" class="ft3455">()</p>
<p style="position:absolute;top:1004px;left:288px;white-space:nowrap" class="ft3411">,&#160;a&#160;log&#160;file&#160;projection</p>
<p style="position:absolute;top:1003px;left:423px;white-space:nowrap" class="ft3462">p</p>
<p style="position:absolute;top:1003px;left:431px;white-space:nowrap" class="ft3455">()</p>
<p style="position:absolute;top:1004px;left:442px;white-space:nowrap" class="ft3411">,&#160;and&#160;a&#160;secret&#160;key</p>
<p style="position:absolute;top:1003px;left:556px;white-space:nowrap" class="ft3454">K</p>
<p style="position:absolute;top:1009px;left:569px;white-space:nowrap" class="ft3461">s</p>
<p style="position:absolute;top:1004px;left:575px;white-space:nowrap" class="ft3411">.&#160;The&#160;function</p>
<p style="position:absolute;top:1022px;left:150px;white-space:nowrap" class="ft3411">outputs&#160;a&#160;signed&#160;message</p>
<p style="position:absolute;top:1021px;left:305px;white-space:nowrap" class="ft3462">sign</p>
<p style="position:absolute;top:1028px;left:330px;white-space:nowrap" class="ft3461">K</p>
<p style="position:absolute;top:1034px;left:340px;white-space:nowrap" class="ft3480">s</p>
<p style="position:absolute;top:1021px;left:346px;white-space:nowrap" class="ft3455">(</p>
<p style="position:absolute;top:1021px;left:352px;white-space:nowrap" class="ft3462">f</p>
<p style="position:absolute;top:1021px;left:357px;white-space:nowrap" class="ft3455">(</p>
<p style="position:absolute;top:1021px;left:363px;white-space:nowrap" class="ft3462">p</p>
<p style="position:absolute;top:1021px;left:371px;white-space:nowrap" class="ft3455">(</p>
<p style="position:absolute;top:1021px;left:377px;white-space:nowrap" class="ft3430">T</p>
<p style="position:absolute;top:1021px;left:389px;white-space:nowrap" class="ft3455">))</p>
<p style="position:absolute;top:1021px;left:400px;white-space:nowrap" class="ft3454">,&#160;c</p>
<p style="position:absolute;top:1021px;left:413px;white-space:nowrap" class="ft3455">)</p>
<p style="position:absolute;top:1022px;left:419px;white-space:nowrap" class="ft3411">.</p>
<p style="position:absolute;top:1040px;left:172px;white-space:nowrap" class="ft3411">The&#160;attestation&#160;function&#160;is&#160;a&#160;generalisation&#160;of&#160;both&#160;binary&#160;and&#160;property-based&#160;at-</p>
<p style="position:absolute;top:1058px;left:150px;white-space:nowrap" class="ft3411">testation&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#70">[24,&#160;</a><a href="Open_TC_D05.2_SecServicesPoC.html#71">27,&#160;</a><a href="Open_TC_D05.2_SecServicesPoC.html#69">11]</a>.&#160;For&#160;binary&#160;attestation,&#160;the&#160;evaluation&#160;function</p>
<p style="position:absolute;top:1057px;left:566px;white-space:nowrap" class="ft3462">f</p>
<p style="position:absolute;top:1057px;left:572px;white-space:nowrap" class="ft3455">()</p>
<p style="position:absolute;top:1058px;left:588px;white-space:nowrap" class="ft3411">is&#160;simply&#160;the</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft3418">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 35 -->
<a name="35"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page35-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC035.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft3511">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft3511">33</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft3511">identity&#160;function,&#160;i.e.,</p>
<p style="position:absolute;top:193px;left:359px;white-space:nowrap" class="ft3562">f</p>
<p style="position:absolute;top:193px;left:365px;white-space:nowrap" class="ft3555">(</p>
<p style="position:absolute;top:193px;left:370px;white-space:nowrap" class="ft3554">x</p>
<p style="position:absolute;top:193px;left:379px;white-space:nowrap" class="ft3555">)&#160;=</p>
<p style="position:absolute;top:193px;left:405px;white-space:nowrap" class="ft3554">x</p>
<p style="position:absolute;top:194px;left:414px;white-space:nowrap" class="ft3511">,&#160;and&#160;the&#160;result&#160;of&#160;attestation&#160;is&#160;simply&#160;the&#160;signature&#160;on</p>
<p style="position:absolute;top:212px;left:226px;white-space:nowrap" class="ft3512">the&#160;result&#160;of&#160;the&#160;projection&#160;function&#160;applied&#160;on&#160;the&#160;log&#160;tree.&#160;TPM&#160;attestation&#160;is&#160;a&#160;special<br/>case&#160;of&#160;binary&#160;attestation&#160;in&#160;which</p>
<p style="position:absolute;top:229px;left:433px;white-space:nowrap" class="ft3530">T</p>
<p style="position:absolute;top:230px;left:449px;white-space:nowrap" class="ft3511">simply&#160;consists&#160;of&#160;the&#160;values&#160;in&#160;the&#160;PCRs&#160;and&#160;the</p>
<p style="position:absolute;top:247px;left:226px;white-space:nowrap" class="ft3511">projection&#160;function</p>
<p style="position:absolute;top:247px;left:345px;white-space:nowrap" class="ft3562">p</p>
<p style="position:absolute;top:246px;left:352px;white-space:nowrap" class="ft3555">()</p>
<p style="position:absolute;top:247px;left:368px;white-space:nowrap" class="ft3511">specifies&#160;a&#160;subset&#160;of&#160;PCRs.&#160;For&#160;property-based&#160;attestation,&#160;the</p>
<p style="position:absolute;top:265px;left:226px;white-space:nowrap" class="ft3511">evaluation&#160;function</p>
<p style="position:absolute;top:265px;left:346px;white-space:nowrap" class="ft3562">f</p>
<p style="position:absolute;top:264px;left:352px;white-space:nowrap" class="ft3555">()</p>
<p style="position:absolute;top:265px;left:368px;white-space:nowrap" class="ft3511">extracts&#160;high-level&#160;properties&#160;from&#160;the&#160;result&#160;of&#160;the&#160;projection</p>
<p style="position:absolute;top:283px;left:226px;white-space:nowrap" class="ft3511">function&#160;applied&#160;on&#160;the&#160;log&#160;tree.</p>
<p style="position:absolute;top:301px;left:248px;white-space:nowrap" class="ft3511">Whereas&#160;previous&#160;works&#160;such&#160;as&#160;that&#160;of&#160;Sailer&#160;<i>et&#160;al</i>.&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#71">[32]&#160;</a>provide&#160;a&#160;good&#160;way&#160;of</p>
<p style="position:absolute;top:319px;left:226px;white-space:nowrap" class="ft3512">checking&#160;the&#160;hash&#160;of&#160;software&#160;binaries,&#160;our&#160;generalised&#160;attestation&#160;enables&#160;better&#160;as-<br/>sessment&#160;of&#160;the&#160;run-time&#160;behaviour&#160;of&#160;the&#160;system.&#160;In&#160;this&#160;respect,&#160;our&#160;model&#160;has&#160;goals<br/>similar&#160;to&#160;those&#160;of&#160;Haldar&#160;<i>et&#160;al</i>.&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#69">[11]</a>.&#160;However,&#160;unlike&#160;Haldar&#160;<i>et&#160;al</i>.&#160;who&#160;focus&#160;on<br/>attesting&#160;the&#160;behaviour&#160;of&#160;a&#160;software&#160;application,&#160;our&#160;model&#160;has&#160;a&#160;focus&#160;on&#160;VMs&#160;and<br/>virtual&#160;devices.&#160;Because&#160;of&#160;their&#160;reliance&#160;on&#160;the&#160;Java&#160;virtual&#160;machine&#160;which&#160;runs&#160;on<br/>top&#160;of&#160;an&#160;operating&#160;system,&#160;their&#160;TCB&#160;includes&#160;the&#160;operating&#160;system.&#160;In&#160;contrast,&#160;our<br/>TCB&#160;includes&#160;only&#160;the&#160;VMM&#160;and&#160;underlying&#160;system&#160;layers,&#160;and&#160;is&#160;much&#160;smaller&#160;than<br/>theirs.</p>
<p style="position:absolute;top:502px;left:226px;white-space:nowrap" class="ft3520"><b>Privacy&#160;Protection&#160;by&#160;Visibility&#160;Rules</b></p>
<p style="position:absolute;top:530px;left:226px;white-space:nowrap" class="ft3513">The&#160;integrity&#160;of&#160;certain&#160;aspects&#160;of&#160;the&#160;system&#160;may&#160;be&#160;important&#160;to&#160;multiple&#160;users.&#160;Con-<br/>versely,&#160;certain&#160;aspects&#160;of&#160;the&#160;system&#160;may&#160;be&#160;confidential&#160;to&#160;one&#160;or&#160;more&#160;users.&#160;For<br/>example,&#160;the&#160;integrity&#160;of&#160;the&#160;VMM&#160;would&#160;be&#160;of&#160;interest&#160;to&#160;the&#160;users&#160;of&#160;all&#160;VMs.&#160;On&#160;the<br/>other&#160;hand,&#160;the&#160;state&#160;of&#160;a&#160;particular&#160;VM&#160;may&#160;need&#160;to&#160;be&#160;verified&#160;only&#160;by&#160;the&#160;user&#160;of&#160;that<br/>VM.&#160;To&#160;satisfy&#160;such&#160;privacy&#160;requirements,&#160;it&#160;is&#160;important&#160;that&#160;attestation&#160;and&#160;sealing<br/>be&#160;applicable&#160;on&#160;projections&#160;of&#160;the&#160;state.&#160;Furthermore,&#160;if&#160;a&#160;state&#160;that&#160;is&#160;relevant&#160;for<br/>integrity&#160;verification&#160;contains&#160;information&#160;about&#160;multiple&#160;users,&#160;it&#160;should&#160;be&#160;possible&#160;to<br/>prove&#160;integrity&#160;without&#160;revealing&#160;the&#160;actual&#160;state.</p>
<p style="position:absolute;top:674px;left:248px;white-space:nowrap" class="ft3511">To&#160;satisfy&#160;the&#160;above&#160;privacy&#160;requirements,&#160;we&#160;introduce&#160;the&#160;following&#160;notions&#160;into</p>
<p style="position:absolute;top:692px;left:226px;white-space:nowrap" class="ft3511">our&#160;formal&#160;model:</p>
<p style="position:absolute;top:720px;left:226px;white-space:nowrap" class="ft3520"><b>Privacy&#160;Requirement&#160;Specification&#160;</b>The&#160;specification&#160;defines&#160;<i>visibility&#160;constraints</i></p>
<p style="position:absolute;top:738px;left:263px;white-space:nowrap" class="ft3511">on&#160;the&#160;projection&#160;functions.&#160;Given&#160;a&#160;set&#160;of&#160;users</p>
<p style="position:absolute;top:738px;left:573px;white-space:nowrap" class="ft3554">U</p>
<p style="position:absolute;top:738px;left:590px;white-space:nowrap" class="ft3511">and&#160;a&#160;log&#160;tree,&#160;a&#160;privacy</p>
<p style="position:absolute;top:756px;left:263px;white-space:nowrap" class="ft3511">requirement&#160;specification&#160;is&#160;a&#160;function</p>
<p style="position:absolute;top:756px;left:506px;white-space:nowrap" class="ft3562">r</p>
<p style="position:absolute;top:755px;left:511px;white-space:nowrap" class="ft3555">()</p>
<p style="position:absolute;top:756px;left:529px;white-space:nowrap" class="ft3511">that&#160;assigns&#160;a&#160;subset&#160;of</p>
<p style="position:absolute;top:756px;left:679px;white-space:nowrap" class="ft3554">U</p>
<p style="position:absolute;top:756px;left:697px;white-space:nowrap" class="ft3511">to&#160;each</p>
<p style="position:absolute;top:774px;left:263px;white-space:nowrap" class="ft3512">vector&#160;element&#160;in&#160;each&#160;node&#160;of&#160;the&#160;tree.&#160;The&#160;subset&#160;assigned&#160;to&#160;a&#160;given&#160;vector<br/>element&#160;in&#160;a&#160;given&#160;node&#160;is&#160;called&#160;the&#160;access&#160;control&#160;list&#160;(ACL)&#160;for&#160;that&#160;element.<br/>Although&#160;the&#160;number&#160;of&#160;ACLs&#160;may&#160;potentially&#160;be&#160;very&#160;large,&#160;they&#160;can&#160;be&#160;imple-<br/>mented&#160;efficiently&#160;by&#160;attaching&#160;ACLs&#160;only&#160;to&#160;some&#160;nodes&#160;and&#160;vector&#160;elements<br/>and&#160;then&#160;using&#160;inheritance&#160;along&#160;the&#160;nodes&#160;and&#160;scoping&#160;rules&#160;along&#160;the&#160;vector<br/>elements&#160;for&#160;a&#160;given&#160;node&#160;to&#160;derive&#160;the&#160;actual&#160;fine-grained&#160;access&#160;permissions.</p>
<p style="position:absolute;top:893px;left:226px;white-space:nowrap" class="ft3520"><b>Projection&#160;Assessment&#160;Functions&#160;</b>The&#160;functions&#160;can&#160;determine&#160;whether&#160;projections</p>
<p style="position:absolute;top:911px;left:263px;white-space:nowrap" class="ft3511">are&#160;privacy-invasive&#160;or&#160;privacy-preserving.&#160;A&#160;projection</p>
<p style="position:absolute;top:910px;left:612px;white-space:nowrap" class="ft3562">p</p>
<p style="position:absolute;top:910px;left:620px;white-space:nowrap" class="ft3555">()</p>
<p style="position:absolute;top:911px;left:636px;white-space:nowrap" class="ft3511">applied&#160;by&#160;a&#160;user</p>
<p style="position:absolute;top:928px;left:263px;white-space:nowrap" class="ft3554">u</p>
<p style="position:absolute;top:928px;left:278px;white-space:nowrap" class="ft3530">∈</p>
<p style="position:absolute;top:928px;left:294px;white-space:nowrap" class="ft3554">U</p>
<p style="position:absolute;top:929px;left:310px;white-space:nowrap" class="ft3511">is&#160;privacy-preserving&#160;with&#160;respect&#160;to&#160;the&#160;privacy&#160;requirement&#160;specifica-</p>
<p style="position:absolute;top:947px;left:263px;white-space:nowrap" class="ft3511">tion</p>
<p style="position:absolute;top:946px;left:291px;white-space:nowrap" class="ft3562">r</p>
<p style="position:absolute;top:946px;left:296px;white-space:nowrap" class="ft3555">()</p>
<p style="position:absolute;top:947px;left:312px;white-space:nowrap" class="ft3511">if&#160;the&#160;output&#160;only&#160;contains&#160;vector&#160;elements&#160;in&#160;which</p>
<p style="position:absolute;top:946px;left:628px;white-space:nowrap" class="ft3554">u</p>
<p style="position:absolute;top:947px;left:641px;white-space:nowrap" class="ft3511">was&#160;contained&#160;in</p>
<p style="position:absolute;top:965px;left:263px;white-space:nowrap" class="ft3512">the&#160;ACL.&#160;If&#160;the&#160;projection&#160;is&#160;privacy-preserving&#160;with&#160;respect&#160;to&#160;a&#160;privacy&#160;require-<br/>ment&#160;specification</p>
<p style="position:absolute;top:982px;left:376px;white-space:nowrap" class="ft3562">r</p>
<p style="position:absolute;top:982px;left:381px;white-space:nowrap" class="ft3555">()</p>
<p style="position:absolute;top:983px;left:397px;white-space:nowrap" class="ft3511">and&#160;a&#160;user</p>
<p style="position:absolute;top:982px;left:461px;white-space:nowrap" class="ft3554">u</p>
<p style="position:absolute;top:983px;left:470px;white-space:nowrap" class="ft3511">,&#160;then&#160;the&#160;sealing&#160;or&#160;attestation&#160;using&#160;this&#160;pro-</p>
<p style="position:absolute;top:1001px;left:263px;white-space:nowrap" class="ft3512">jection&#160;automatically&#160;preserves&#160;privacy.&#160;In&#160;other&#160;words,&#160;any&#160;evaluation&#160;function<br/>for&#160;attestation&#160;or&#160;any&#160;predicate&#160;for&#160;sealing&#160;can&#160;be&#160;applied&#160;without&#160;infringing&#160;on<br/>the&#160;privacy&#160;of&#160;the&#160;users&#160;of&#160;the&#160;system.&#160;If&#160;the&#160;projection&#160;is&#160;not&#160;privacy-preserving,<br/>then&#160;it&#160;is&#160;necessary&#160;to&#160;ensure&#160;that&#160;at&#160;least&#160;the&#160;evaluation&#160;function&#160;or&#160;predicate<br/>applied&#160;after&#160;a&#160;privacy-invasive&#160;projection&#160;can&#160;hide&#160;the&#160;private&#160;data.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft3518">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 36 -->
<a name="36"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3682{font-size:11px;font-family:Helvetica;color:#000000;}
	.ft3683{font-size:11px;line-height:13px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page36-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC036.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft3611">34</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft3618">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:237px;left:337px;white-space:nowrap" class="ft3683">Central&#160;<br/>Integrity</p>
<p style="position:absolute;top:265px;left:335px;white-space:nowrap" class="ft3682">Manager</p>
<p style="position:absolute;top:206px;left:441px;white-space:nowrap" class="ft3640">Network&#160;</p>
<p style="position:absolute;top:216px;left:426px;white-space:nowrap" class="ft3640">Integrity&#160;Manager</p>
<p style="position:absolute;top:241px;left:446px;white-space:nowrap" class="ft3640">VMM&#160;</p>
<p style="position:absolute;top:250px;left:426px;white-space:nowrap" class="ft3640">Integrity&#160;Manager</p>
<p style="position:absolute;top:272px;left:441px;white-space:nowrap" class="ft3640">Devices&#160;</p>
<p style="position:absolute;top:282px;left:426px;white-space:nowrap" class="ft3640">Integrity&#160;Manager</p>
<p style="position:absolute;top:307px;left:443px;white-space:nowrap" class="ft3640">Storage</p>
<p style="position:absolute;top:316px;left:426px;white-space:nowrap" class="ft3640">Integrity&#160;Manager</p>
<p style="position:absolute;top:211px;left:244px;white-space:nowrap" class="ft3682">Attestation</p>
<p style="position:absolute;top:268px;left:253px;white-space:nowrap" class="ft3682">Sealing</p>
<p style="position:absolute;top:283px;left:247px;white-space:nowrap" class="ft3682">Unsealing</p>
<p style="position:absolute;top:194px;left:306px;white-space:nowrap" class="ft3682">TCB</p>
<p style="position:absolute;top:324px;left:341px;white-space:nowrap" class="ft3656">Predicate<br/>Evaluator</p>
<p style="position:absolute;top:371px;left:211px;white-space:nowrap" class="ft3611">Figure&#160;2.14:&#160;Architecture&#160;for&#160;Integrity&#160;Protection&#160;and&#160;Verification</p>
<p style="position:absolute;top:460px;left:150px;white-space:nowrap" class="ft3633"><b>2.5.3</b></p>
<p style="position:absolute;top:460px;left:204px;white-space:nowrap" class="ft3633"><b>The&#160;PEV&#160;Integrity&#160;Architecture</b></p>
<p style="position:absolute;top:490px;left:150px;white-space:nowrap" class="ft3612">Based&#160;on&#160;the&#160;formal&#160;model&#160;described&#160;above,&#160;we&#160;now&#160;present&#160;an&#160;architecture&#160;and&#160;associ-<br/>ated&#160;protocols&#160;for&#160;protecting,&#160;enforcing,&#160;and&#160;verifying&#160;the&#160;integrity&#160;of&#160;VMs&#160;and&#160;virtual<br/>devices.&#160;We&#160;call&#160;our&#160;architecture&#160;the&#160;PEV&#160;integrity&#160;architecture,&#160;which&#160;is&#160;shown&#160;in&#160;Fig-<br/>ure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#36">2.14.&#160;</a>It&#160;consists&#160;of&#160;a&#160;<i>central&#160;integrity&#160;manager&#160;</i>and&#160;<i>component&#160;integrity&#160;managers</i>,<br/>which&#160;are&#160;associated&#160;with&#160;individual&#160;system&#160;components&#160;such&#160;as&#160;storage,&#160;VMM,&#160;net-<br/>working,&#160;and&#160;other&#160;devices.&#160;Each&#160;component&#160;integrity&#160;manager&#160;is&#160;responsible&#160;for&#160;the<br/>part&#160;of&#160;the&#160;log&#160;tree&#160;corresponding&#160;to&#160;the&#160;component.&#160;For&#160;example,&#160;the&#160;storage&#160;integrity<br/>manager&#160;is&#160;responsible&#160;for&#160;maintaining&#160;the&#160;storage&#160;sub-tree&#160;of&#160;the&#160;system&#160;log&#160;tree</p>
<p style="position:absolute;top:614px;left:640px;white-space:nowrap" class="ft3630">T</p>
<p style="position:absolute;top:615px;left:652px;white-space:nowrap" class="ft3611">.</p>
<p style="position:absolute;top:633px;left:172px;white-space:nowrap" class="ft3611">Each&#160;log&#160;projection&#160;function&#160;is&#160;realised&#160;by&#160;a&#160;<i>master&#160;plug-in&#160;module</i>,&#160;which&#160;is&#160;ac-</p>
<p style="position:absolute;top:651px;left:150px;white-space:nowrap" class="ft3612">cessible&#160;by&#160;the&#160;central&#160;integrity&#160;manager.&#160;For&#160;each&#160;component,&#160;the&#160;aspects&#160;of&#160;the&#160;com-<br/>ponent’s&#160;integrity&#160;that&#160;are&#160;relevant&#160;for&#160;the&#160;projection&#160;function&#160;are&#160;revealed&#160;by&#160;a&#160;<i>com-<br/>ponent&#160;plug-in&#160;module</i>,&#160;which&#160;can&#160;be&#160;directly&#160;invoked&#160;by&#160;the&#160;master&#160;plug-in&#160;module.<br/>The&#160;output&#160;from&#160;the&#160;master&#160;plug-in&#160;module&#160;is&#160;the&#160;aggregate&#160;of&#160;the&#160;output&#160;from&#160;multi-<br/>ple&#160;component&#160;plug-in&#160;modules.&#160;In&#160;this&#160;way,&#160;each&#160;master&#160;plug-in&#160;module&#160;obtains&#160;state<br/>information&#160;about&#160;various&#160;aspects&#160;of&#160;the&#160;system&#160;that&#160;may&#160;be&#160;of&#160;interest&#160;to&#160;a&#160;potential<br/>verifier&#160;or&#160;user.</p>
<p style="position:absolute;top:777px;left:172px;white-space:nowrap" class="ft3611">In&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#36">2.14,&#160;</a>the&#160;master&#160;plug-in&#160;modules&#160;are&#160;shown&#160;using&#160;geometrical&#160;shapes</p>
<p style="position:absolute;top:795px;left:150px;white-space:nowrap" class="ft3612">(ovals,&#160;hexagons,&#160;triangles,&#160;and&#160;rectangles)&#160;attached&#160;to&#160;the&#160;Integrity&#160;Manager.&#160;For<br/>example,&#160;the&#160;triangular&#160;plug-in&#160;module&#160;measures&#160;certain&#160;aspects&#160;of&#160;system&#160;storage&#160;and<br/>the&#160;VMM,&#160;as&#160;indicated&#160;by&#160;the&#160;presence&#160;of&#160;triangular&#160;component&#160;plug-in&#160;modules&#160;in<br/>the&#160;Storage&#160;Integrity&#160;Manager&#160;and&#160;VMM&#160;Integrity&#160;Manager.&#160;On&#160;the&#160;other&#160;hand,&#160;the<br/>hexagonal&#160;plug-in&#160;module&#160;measures&#160;only&#160;certain&#160;aspects&#160;of&#160;system&#160;devices.&#160;Each&#160;plug-<br/>in&#160;module&#160;has&#160;a&#160;unique&#160;identifier.&#160;The&#160;mapping&#160;between&#160;each&#160;plug-in&#160;identifier&#160;and&#160;the<br/>functionality&#160;provided&#160;by&#160;the&#160;corresponding&#160;plug-in&#160;module&#160;is&#160;made&#160;publicly&#160;available<br/>(e.g.,&#160;through&#160;a&#160;naming&#160;service&#160;or&#160;a&#160;published&#160;table).</p>
<p style="position:absolute;top:978px;left:150px;white-space:nowrap" class="ft3620"><b>Sealing/Unsealing&#160;Protocol</b></p>
<p style="position:absolute;top:1006px;left:150px;white-space:nowrap" class="ft3611">At&#160;the&#160;time&#160;of&#160;sealing,&#160;the&#160;user&#160;provides&#160;at&#160;least&#160;the&#160;following&#160;inputs:</p>
<p style="position:absolute;top:1036px;left:150px;white-space:nowrap" class="ft3620"><b>Data&#160;</b>The&#160;data&#160;to&#160;be&#160;encrypted&#160;during&#160;sealing&#160;and&#160;to&#160;be&#160;revealed&#160;later&#160;only&#160;if&#160;certain</p>
<p style="position:absolute;top:1054px;left:187px;white-space:nowrap" class="ft3611">conditions&#160;are&#160;met.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft3618">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 37 -->
<a name="37"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page37-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC037.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft3711">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft3711">35</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft3720"><b>Key&#160;</b>The&#160;key&#160;whose&#160;public&#160;part&#160;is&#160;used&#160;for&#160;encrypting&#160;the&#160;data&#160;at&#160;the&#160;time&#160;of&#160;seal-</p>
<p style="position:absolute;top:212px;left:263px;white-space:nowrap" class="ft3712">ing,&#160;and&#160;whose&#160;private&#160;part&#160;is&#160;revealed&#160;only&#160;if&#160;the&#160;unseal&#160;operation&#160;completes<br/>successfully.</p>
<p style="position:absolute;top:259px;left:226px;white-space:nowrap" class="ft3720"><b>Identifier(s)&#160;of&#160;Plug-in&#160;Module(s)&#160;</b>By&#160;listing&#160;the&#160;identifiers&#160;of&#160;plug-in&#160;modules,&#160;a&#160;user</p>
<p style="position:absolute;top:277px;left:263px;white-space:nowrap" class="ft3712">can&#160;choose&#160;what&#160;aspects&#160;of&#160;the&#160;platform&#160;integrity&#160;state&#160;it&#160;is&#160;particularly&#160;interested<br/>in.</p>
<p style="position:absolute;top:325px;left:226px;white-space:nowrap" class="ft3720"><b>Predicate&#160;</b>The&#160;predicate&#160;specifies&#160;user-defined&#160;conditions&#160;for&#160;revealing&#160;the&#160;private&#160;part</p>
<p style="position:absolute;top:343px;left:263px;white-space:nowrap" class="ft3711">of&#160;the&#160;sealing&#160;key.</p>
<p style="position:absolute;top:373px;left:248px;white-space:nowrap" class="ft3711">Our&#160;sealing&#160;protocol&#160;requires&#160;the&#160;log&#160;projection&#160;functions&#160;(described&#160;in&#160;Sec-</p>
<p style="position:absolute;top:391px;left:226px;white-space:nowrap" class="ft3712">tion&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#33">2.5.2)&#160;</a>to&#160;be&#160;implemented&#160;as&#160;plug-in&#160;modules&#160;as&#160;part&#160;of&#160;the&#160;TCB.&#160;The&#160;key&#160;used&#160;for<br/>encrypting&#160;the&#160;sensitive&#160;data&#160;item&#160;is&#160;sealed&#160;away&#160;against&#160;the&#160;state&#160;of&#160;the&#160;TCB&#160;(stored<br/>in&#160;PCRs&#160;that&#160;cannot&#160;be&#160;reset)&#160;and&#160;a&#160;hash&#160;of&#160;the&#160;user-specified&#160;projection&#160;functions&#160;and<br/>sealing&#160;predicates.&#160;The&#160;latter&#160;is&#160;stored&#160;in&#160;a&#160;resettable&#160;PCR&#160;(say</p>
<p style="position:absolute;top:444px;left:602px;white-space:nowrap" class="ft3754">P&#160;CR</p>
<p style="position:absolute;top:450px;left:636px;white-space:nowrap" class="ft3761">i</p>
<p style="position:absolute;top:445px;left:642px;white-space:nowrap" class="ft3711">)&#160;by&#160;the&#160;Integrity</p>
<p style="position:absolute;top:463px;left:226px;white-space:nowrap" class="ft3712">Manager&#160;component&#160;of&#160;the&#160;TCB.&#160;That&#160;ensures&#160;that&#160;the&#160;TCB&#160;is&#160;aware&#160;of&#160;what&#160;condi-<br/>tions&#160;must&#160;be&#160;satisfied&#160;before&#160;the&#160;key&#160;can&#160;be&#160;revealed&#160;to&#160;the&#160;user.&#160;To&#160;perform&#160;the&#160;unseal<br/>operation,&#160;the&#160;TCB&#160;has&#160;to&#160;make&#160;sure&#160;that</p>
<p style="position:absolute;top:498px;left:472px;white-space:nowrap" class="ft3754">P&#160;CR</p>
<p style="position:absolute;top:503px;left:507px;white-space:nowrap" class="ft3761">i</p>
<p style="position:absolute;top:498px;left:516px;white-space:nowrap" class="ft3711">contains&#160;the&#160;hash&#160;of&#160;the&#160;user-specified</p>
<p style="position:absolute;top:516px;left:226px;white-space:nowrap" class="ft3713">projection&#160;function&#160;and&#160;sealing&#160;predicates.&#160;Then,&#160;the&#160;unseal&#160;operation&#160;reveals&#160;the&#160;key<br/>to&#160;the&#160;Integrity&#160;Manager,&#160;which&#160;checks&#160;whether&#160;the&#160;sealing&#160;predicates&#160;(evaluated&#160;on<br/>the&#160;output&#160;of&#160;the&#160;log&#160;projection&#160;function)&#160;are&#160;indeed&#160;satisfied&#160;before&#160;revealing&#160;the&#160;key<br/>to&#160;the&#160;user.</p>
<p style="position:absolute;top:588px;left:248px;white-space:nowrap" class="ft3711">The&#160;flexibility&#160;of&#160;our&#160;sealing&#160;protocol&#160;is&#160;due&#160;to&#160;the&#160;fact&#160;that&#160;arbitrarily&#160;complex</p>
<p style="position:absolute;top:606px;left:226px;white-space:nowrap" class="ft3712">conditions&#160;to&#160;reveal&#160;the&#160;sealed&#160;key&#160;can&#160;be&#160;coded&#160;as&#160;plug-in&#160;modules.&#160;The&#160;extensibility<br/>arises&#160;from&#160;the&#160;fact&#160;that&#160;new&#160;plug-in&#160;modules&#160;specifying&#160;new&#160;user-specified&#160;sealing<br/>predicates&#160;can&#160;be&#160;added&#160;to&#160;the&#160;TCB.</p>
<p style="position:absolute;top:700px;left:226px;white-space:nowrap" class="ft3720"><b>Attestation&#160;Protocol</b></p>
<p style="position:absolute;top:728px;left:226px;white-space:nowrap" class="ft3713">The&#160;flexibility&#160;of&#160;our&#160;attestation&#160;protocol&#160;relies&#160;on&#160;the&#160;verifier&#160;being&#160;able&#160;to&#160;attest&#160;the<br/>TCB&#160;and&#160;requires&#160;the&#160;log&#160;projection&#160;functions&#160;(described&#160;in&#160;Section&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#33">2.5.2)&#160;</a>to&#160;be&#160;im-<br/>plemented&#160;as&#160;plug-in&#160;modules&#160;as&#160;part&#160;of&#160;the&#160;TCB.&#160;The&#160;extensibility&#160;of&#160;our&#160;attestation<br/>protocols&#160;relies&#160;on&#160;the&#160;ability&#160;to&#160;add&#160;new&#160;plug-in&#160;modules&#160;for&#160;new&#160;aspects&#160;of&#160;the&#160;plat-<br/>form&#160;state&#160;that&#160;the&#160;verifier&#160;may&#160;be&#160;interested&#160;in&#160;knowing&#160;to&#160;evaluate&#160;the&#160;platform’s<br/>trustworthiness.</p>
<p style="position:absolute;top:835px;left:248px;white-space:nowrap" class="ft3711">The&#160;verifier&#160;which&#160;initiates&#160;the&#160;attestation&#160;protocol&#160;provides&#160;at&#160;least&#160;the&#160;following</p>
<p style="position:absolute;top:853px;left:226px;white-space:nowrap" class="ft3711">two&#160;inputs:</p>
<p style="position:absolute;top:883px;left:226px;white-space:nowrap" class="ft3720"><b>Challenge&#160;</b>The&#160;challenge&#160;ensures&#160;freshness.</p>
<p style="position:absolute;top:913px;left:226px;white-space:nowrap" class="ft3720"><b>Identifier(s)&#160;of&#160;Plug-in&#160;Module(s)&#160;</b>By&#160;listing&#160;the&#160;identifiers&#160;of&#160;plug-in&#160;modules,&#160;a&#160;ver-</p>
<p style="position:absolute;top:931px;left:263px;white-space:nowrap" class="ft3712">ifier&#160;can&#160;choose&#160;what&#160;aspects&#160;of&#160;the&#160;platform&#160;integrity&#160;state&#160;it&#160;is&#160;particularly&#160;in-<br/>terested&#160;in.</p>
<p style="position:absolute;top:1018px;left:226px;white-space:nowrap" class="ft3720"><b>Blinding&#160;For&#160;Enforcing&#160;Visibility&#160;Constraints</b></p>
<p style="position:absolute;top:1047px;left:226px;white-space:nowrap" class="ft3713">Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#38">2.15&#160;</a>shows&#160;a&#160;simple&#160;<i>blinding&#160;</i>technique&#160;that&#160;uses&#160;a&#160;commitment&#160;scheme&#160;to&#160;en-<br/>force&#160;visibility&#160;constraints&#160;on&#160;the&#160;log&#160;tree.&#160;Commitment&#160;schemes&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#69">[9]&#160;</a>are&#160;a&#160;fundamental</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft3718">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 38 -->
<a name="38"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3884{font-size:13px;font-family:Times;color:#000000;}
	.ft3885{font-size:9px;font-family:Times;color:#000000;}
	.ft3886{font-size:13px;font-family:Times;color:#ffffff;}
	.ft3887{font-size:9px;font-family:Times;color:#ffffff;}
	.ft3888{font-size:152px;font-family:Times;color:#000000;}
	.ft3889{font-size:15px;line-height:18px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page38-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC038.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft3811">36</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft3818">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:210px;left:315px;white-space:nowrap" class="ft3884"><b>N</b></p>
<p style="position:absolute;top:242px;left:277px;white-space:nowrap" class="ft3884"><b>N</b></p>
<p style="position:absolute;top:248px;left:286px;white-space:nowrap" class="ft3885"><b>1</b></p>
<p style="position:absolute;top:242px;left:345px;white-space:nowrap" class="ft3884"><b>N</b></p>
<p style="position:absolute;top:248px;left:355px;white-space:nowrap" class="ft3885"><b>2</b></p>
<p style="position:absolute;top:278px;left:245px;white-space:nowrap" class="ft3884"><b>N</b></p>
<p style="position:absolute;top:284px;left:255px;white-space:nowrap" class="ft3885"><b>11</b></p>
<p style="position:absolute;top:278px;left:307px;white-space:nowrap" class="ft3884"><b>N</b></p>
<p style="position:absolute;top:284px;left:317px;white-space:nowrap" class="ft3885"><b>12</b></p>
<p style="position:absolute;top:275px;left:524px;white-space:nowrap" class="ft3884"><b>N’</b></p>
<p style="position:absolute;top:307px;left:486px;white-space:nowrap" class="ft3884"><b>N’</b></p>
<p style="position:absolute;top:313px;left:500px;white-space:nowrap" class="ft3885"><b>1</b></p>
<p style="position:absolute;top:307px;left:554px;white-space:nowrap" class="ft3884"><b>N’</b></p>
<p style="position:absolute;top:313px;left:568px;white-space:nowrap" class="ft3885"><b>2</b></p>
<p style="position:absolute;top:343px;left:455px;white-space:nowrap" class="ft3884"><b>N’</b></p>
<p style="position:absolute;top:349px;left:468px;white-space:nowrap" class="ft3885"><b>11</b></p>
<p style="position:absolute;top:343px;left:517px;white-space:nowrap" class="ft3884"><b>N’</b></p>
<p style="position:absolute;top:349px;left:530px;white-space:nowrap" class="ft3885"><b>12</b></p>
<p style="position:absolute;top:343px;left:318px;white-space:nowrap" class="ft3886"><b>R</b></p>
<p style="position:absolute;top:375px;left:280px;white-space:nowrap" class="ft3886"><b>R</b></p>
<p style="position:absolute;top:382px;left:290px;white-space:nowrap" class="ft3887"><b>1</b></p>
<p style="position:absolute;top:375px;left:348px;white-space:nowrap" class="ft3886"><b>R</b></p>
<p style="position:absolute;top:382px;left:358px;white-space:nowrap" class="ft3887"><b>2</b></p>
<p style="position:absolute;top:411px;left:249px;white-space:nowrap" class="ft3886"><b>R</b></p>
<p style="position:absolute;top:417px;left:258px;white-space:nowrap" class="ft3887"><b>11</b></p>
<p style="position:absolute;top:411px;left:310px;white-space:nowrap" class="ft3886"><b>R</b></p>
<p style="position:absolute;top:417px;left:320px;white-space:nowrap" class="ft3887"><b>12</b></p>
<p style="position:absolute;top:180px;left:317px;white-space:nowrap" class="ft3888"></p>
<p style="position:absolute;top:105px;left:527px;white-space:nowrap" class="ft3888"></p>
<p style="position:absolute;top:151px;left:431px;white-space:nowrap" class="ft3888"></p>
<p style="position:absolute;top:448px;left:223px;white-space:nowrap" class="ft3811">Figure&#160;2.15:&#160;Enforcing&#160;Visibility&#160;Constraints&#160;on&#160;System&#160;State</p>
<p style="position:absolute;top:496px;left:150px;white-space:nowrap" class="ft3812">cryptographic&#160;primitive&#160;and&#160;generally&#160;consist&#160;of&#160;two&#160;stages,&#160;a&#160;<i>commit&#160;stage&#160;</i>and&#160;a&#160;<i>re-<br/>veal&#160;stage</i>.&#160;The&#160;first&#160;phase,&#160;called&#160;commit&#160;phase,&#160;is&#160;used&#160;to&#160;make&#160;a&#160;party&#160;<i>commit&#160;</i>to<br/>a&#160;particular&#160;value&#160;while&#160;hiding&#160;that&#160;value&#160;from&#160;another&#160;party&#160;until&#160;the&#160;second&#160;stage,<br/>called&#160;reveal&#160;stage,&#160;in&#160;which&#160;the&#160;value&#160;is&#160;<i>revealed&#160;</i>to&#160;the&#160;second&#160;party.&#160;Any&#160;commit-<br/>ment&#160;scheme&#160;guarantees&#160;that&#160;(a)&#160;the&#160;committed&#160;value&#160;cannot&#160;be&#160;obtained&#160;by&#160;the&#160;second<br/>party&#160;before&#160;the&#160;reveal&#160;stage&#160;and&#160;(b)&#160;the&#160;second&#160;party&#160;can&#160;detect&#160;whether&#160;the&#160;value<br/>revealed&#160;to&#160;her&#160;is&#160;indeed&#160;the&#160;same&#160;value&#160;that&#160;was&#160;committed&#160;to&#160;in&#160;the&#160;first&#160;stage.</p>
<p style="position:absolute;top:622px;left:172px;white-space:nowrap" class="ft3811">For&#160;simplicity,&#160;we&#160;consider&#160;blinding&#160;at&#160;the&#160;granularity&#160;of&#160;log&#160;tree&#160;nodes&#160;instead&#160;of</p>
<p style="position:absolute;top:640px;left:150px;white-space:nowrap" class="ft3811">at&#160;the&#160;granularity&#160;of&#160;log&#160;vector&#160;elements&#160;in&#160;the&#160;tree&#160;nodes,&#160;i.e.,</p>
<p style="position:absolute;top:639px;left:532px;white-space:nowrap" class="ft3862">r</p>
<p style="position:absolute;top:639px;left:537px;white-space:nowrap" class="ft3855">()</p>
<p style="position:absolute;top:640px;left:553px;white-space:nowrap" class="ft3811">assigns&#160;a&#160;subset&#160;of</p>
<p style="position:absolute;top:657px;left:150px;white-space:nowrap" class="ft3854">U</p>
<p style="position:absolute;top:658px;left:166px;white-space:nowrap" class="ft3811">to&#160;each&#160;each&#160;node&#160;of&#160;the&#160;tree.&#160;A&#160;<i>random&#160;</i>tree</p>
<p style="position:absolute;top:657px;left:442px;white-space:nowrap" class="ft3830">R</p>
<p style="position:absolute;top:658px;left:459px;white-space:nowrap" class="ft3811">is&#160;bound&#160;to&#160;the&#160;original&#160;log&#160;tree</p>
<p style="position:absolute;top:657px;left:653px;white-space:nowrap" class="ft3830">T</p>
<p style="position:absolute;top:676px;left:150px;white-space:nowrap" class="ft3811">through&#160;a&#160;<i>multi-bit&#160;commitment&#160;scheme&#160;</i>to&#160;give&#160;the&#160;blinded&#160;log&#160;tree</p>
<p style="position:absolute;top:671px;left:558px;white-space:nowrap" class="ft3855">¯</p>
<p style="position:absolute;top:675px;left:555px;white-space:nowrap" class="ft3830">T</p>
<p style="position:absolute;top:676px;left:567px;white-space:nowrap" class="ft3811">.</p>
<p style="position:absolute;top:675px;left:576px;white-space:nowrap" class="ft3830">R</p>
<p style="position:absolute;top:676px;left:592px;white-space:nowrap" class="ft3811">is&#160;a&#160;tree&#160;that</p>
<p style="position:absolute;top:694px;left:150px;white-space:nowrap" class="ft3811">has&#160;the&#160;same&#160;structure&#160;as&#160;that&#160;of</p>
<p style="position:absolute;top:693px;left:353px;white-space:nowrap" class="ft3830">T</p>
<p style="position:absolute;top:694px;left:369px;white-space:nowrap" class="ft3811">and&#160;whose&#160;nodes&#160;are&#160;random&#160;numbers.&#160;Existing</p>
<p style="position:absolute;top:712px;left:150px;white-space:nowrap" class="ft3813">commitment&#160;schemes&#160;such&#160;as&#160;the&#160;one&#160;by&#160;Damgard&#160;et&#160;al.&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#69">[5]&#160;</a>or&#160;those&#160;based&#160;on&#160;one-way<br/>hash&#160;functions&#160;can&#160;be&#160;used&#160;for&#160;this&#160;purpose.</p>
<p style="position:absolute;top:748px;left:172px;white-space:nowrap" class="ft3811">In&#160;a&#160;TPM-equipped&#160;platform,&#160;logging&#160;is&#160;done&#160;by&#160;extending&#160;the&#160;PCRs&#160;with&#160;the&#160;mea-</p>
<p style="position:absolute;top:766px;left:150px;white-space:nowrap" class="ft3811">surement&#160;values.&#160;For&#160;blinding,&#160;it&#160;is&#160;the&#160;nodes&#160;of</p>
<p style="position:absolute;top:761px;left:438px;white-space:nowrap" class="ft3855">¯</p>
<p style="position:absolute;top:765px;left:435px;white-space:nowrap" class="ft3830">T</p>
<p style="position:absolute;top:766px;left:451px;white-space:nowrap" class="ft3811">that&#160;are&#160;actually&#160;logged.&#160;This&#160;means</p>
<p style="position:absolute;top:783px;left:150px;white-space:nowrap" class="ft3811">that&#160;instead&#160;of&#160;doing&#160;the&#160;normal&#160;TPM_extend(</p>
<p style="position:absolute;top:783px;left:426px;white-space:nowrap" class="ft3854">n</p>
<p style="position:absolute;top:783px;left:435px;white-space:nowrap" class="ft3811">),&#160;a&#160;TPM_extend(</p>
<p style="position:absolute;top:783px;left:539px;white-space:nowrap" class="ft3854">r</p>
<p style="position:absolute;top:782px;left:548px;white-space:nowrap" class="ft3830">⊗</p>
<p style="position:absolute;top:783px;left:562px;white-space:nowrap" class="ft3854">n</p>
<p style="position:absolute;top:783px;left:571px;white-space:nowrap" class="ft3811">)&#160;is&#160;done,&#160;where</p>
<p style="position:absolute;top:801px;left:150px;white-space:nowrap" class="ft3854">n</p>
<p style="position:absolute;top:801px;left:163px;white-space:nowrap" class="ft3811">is&#160;a&#160;node&#160;of</p>
<p style="position:absolute;top:800px;left:237px;white-space:nowrap" class="ft3830">T</p>
<p style="position:absolute;top:801px;left:249px;white-space:nowrap" class="ft3811">,</p>
<p style="position:absolute;top:801px;left:257px;white-space:nowrap" class="ft3854">r</p>
<p style="position:absolute;top:801px;left:268px;white-space:nowrap" class="ft3811">is&#160;a&#160;node&#160;of</p>
<p style="position:absolute;top:800px;left:343px;white-space:nowrap" class="ft3830">R</p>
<p style="position:absolute;top:801px;left:355px;white-space:nowrap" class="ft3811">,&#160;and</p>
<p style="position:absolute;top:800px;left:389px;white-space:nowrap" class="ft3830">⊗</p>
<p style="position:absolute;top:801px;left:404px;white-space:nowrap" class="ft3811">denotes&#160;the&#160;commitment&#160;operation&#160;used&#160;for</p>
<p style="position:absolute;top:819px;left:150px;white-space:nowrap" class="ft3811">hiding</p>
<p style="position:absolute;top:819px;left:192px;white-space:nowrap" class="ft3854">n</p>
<p style="position:absolute;top:819px;left:204px;white-space:nowrap" class="ft3811">until&#160;the&#160;reveal&#160;stage.</p>
<p style="position:absolute;top:837px;left:172px;white-space:nowrap" class="ft3811">The&#160;privacy-preserving&#160;projection&#160;function</p>
<p style="position:absolute;top:837px;left:440px;white-space:nowrap" class="ft3862">¯</p>
<p style="position:absolute;top:837px;left:439px;white-space:nowrap" class="ft3862">p</p>
<p style="position:absolute;top:836px;left:447px;white-space:nowrap" class="ft3855">()</p>
<p style="position:absolute;top:837px;left:464px;white-space:nowrap" class="ft3811">invoked&#160;at&#160;the&#160;request&#160;of&#160;user</p>
<p style="position:absolute;top:837px;left:653px;white-space:nowrap" class="ft3854">u</p>
<p style="position:absolute;top:837px;left:662px;white-space:nowrap" class="ft3811">,</p>
<p style="position:absolute;top:855px;left:150px;white-space:nowrap" class="ft3811">reveals</p>
<p style="position:absolute;top:850px;left:197px;white-space:nowrap" class="ft3855">¯</p>
<p style="position:absolute;top:854px;left:195px;white-space:nowrap" class="ft3830">T</p>
<p style="position:absolute;top:855px;left:207px;white-space:nowrap" class="ft3811">;&#160;in&#160;addition,&#160;the&#160;function&#160;reveals&#160;the&#160;nodes&#160;in</p>
<p style="position:absolute;top:854px;left:478px;white-space:nowrap" class="ft3830">T</p>
<p style="position:absolute;top:855px;left:493px;white-space:nowrap" class="ft3811">that</p>
<p style="position:absolute;top:855px;left:519px;white-space:nowrap" class="ft3854">u</p>
<p style="position:absolute;top:855px;left:530px;white-space:nowrap" class="ft3811">is&#160;authorised&#160;to&#160;access.</p>
<p style="position:absolute;top:873px;left:150px;white-space:nowrap" class="ft3811">In&#160;other&#160;words,</p>
<p style="position:absolute;top:873px;left:246px;white-space:nowrap" class="ft3862">¯</p>
<p style="position:absolute;top:873px;left:246px;white-space:nowrap" class="ft3862">p</p>
<p style="position:absolute;top:872px;left:254px;white-space:nowrap" class="ft3855">()</p>
<p style="position:absolute;top:873px;left:270px;white-space:nowrap" class="ft3811">implements&#160;the&#160;reveal&#160;stage&#160;of&#160;the&#160;multi-bit&#160;commitment&#160;scheme.</p>
<p style="position:absolute;top:891px;left:150px;white-space:nowrap" class="ft3812">Due&#160;to&#160;the&#160;guarantees&#160;of&#160;the&#160;commitment&#160;scheme,&#160;the&#160;platform&#160;cannot&#160;invent&#160;arbitrary<br/>values&#160;for&#160;the&#160;nodes&#160;in</p>
<p style="position:absolute;top:908px;left:289px;white-space:nowrap" class="ft3830">T</p>
<p style="position:absolute;top:909px;left:304px;white-space:nowrap" class="ft3811">without&#160;being&#160;detected&#160;by&#160;the&#160;user.</p>
<p style="position:absolute;top:927px;left:172px;white-space:nowrap" class="ft3811">As&#160;a&#160;result&#160;of&#160;the&#160;blinding&#160;technique&#160;described&#160;above,&#160;any&#160;user</p>
<p style="position:absolute;top:926px;left:566px;white-space:nowrap" class="ft3854">u</p>
<p style="position:absolute;top:927px;left:579px;white-space:nowrap" class="ft3811">knows&#160;that&#160;all</p>
<p style="position:absolute;top:945px;left:150px;white-space:nowrap" class="ft3812">components&#160;that&#160;have&#160;any&#160;effect&#160;on&#160;system&#160;integrity&#160;have&#160;been&#160;taken&#160;into&#160;consideration<br/>in&#160;the&#160;system&#160;log&#160;tree;&#160;in&#160;addition,&#160;for&#160;those&#160;components&#160;that&#160;it&#160;is&#160;authorised&#160;to&#160;access,</p>
<p style="position:absolute;top:980px;left:150px;white-space:nowrap" class="ft3854">u</p>
<p style="position:absolute;top:981px;left:164px;white-space:nowrap" class="ft3811">can&#160;check&#160;whether&#160;they&#160;indeed&#160;have&#160;the&#160;acceptable&#160;configuration&#160;and&#160;state&#160;value,</p>
<p style="position:absolute;top:999px;left:150px;white-space:nowrap" class="ft3812">by&#160;comparing&#160;with&#160;its&#160;own&#160;reference&#160;values&#160;that&#160;may&#160;be&#160;provided&#160;and&#160;certified&#160;by&#160;a<br/>trusted&#160;third&#160;party.&#160;In&#160;particular,&#160;if&#160;the&#160;ACL&#160;for&#160;the&#160;root&#160;node&#160;contains&#160;all&#160;users,&#160;then<br/>any&#160;user&#160;can&#160;verify&#160;overall&#160;system&#160;integrity&#160;without&#160;knowing&#160;the&#160;exact&#160;configuration&#160;of<br/>any&#160;individual&#160;component&#160;in&#160;the&#160;system.&#160;That&#160;is&#160;because,&#160;the&#160;attestation&#160;result&#160;that</p>
<p style="position:absolute;top:1052px;left:657px;white-space:nowrap" class="ft3854">u</p>
<p style="position:absolute;top:1070px;left:150px;white-space:nowrap" class="ft3811">obtains&#160;from&#160;the&#160;platform&#160;will&#160;contain&#160;(<i>root</i>(</p>
<p style="position:absolute;top:1069px;left:420px;white-space:nowrap" class="ft3830">R</p>
<p style="position:absolute;top:1070px;left:433px;white-space:nowrap" class="ft3811">)</p>
<p style="position:absolute;top:1069px;left:442px;white-space:nowrap" class="ft3830">⊗</p>
<p style="position:absolute;top:1070px;left:458px;white-space:nowrap" class="ft3817"><i>root</i>(</p>
<p style="position:absolute;top:1069px;left:488px;white-space:nowrap" class="ft3830">T</p>
<p style="position:absolute;top:1070px;left:499px;white-space:nowrap" class="ft3811">))&#160;and&#160;<i>root</i>(</p>
<p style="position:absolute;top:1069px;left:570px;white-space:nowrap" class="ft3830">R</p>
<p style="position:absolute;top:1070px;left:582px;white-space:nowrap" class="ft3811">),&#160;from&#160;which</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft3818">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 39 -->
<a name="39"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3990{font-size:16px;font-family:Helvetica;color:#000000;}
	.ft3991{font-size:12px;font-family:Helvetica;color:#000000;}
	.ft3992{font-size:11px;line-height:12px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page39-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC039.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft3911">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft3911">37</p>
<p style="position:absolute;top:530px;left:453px;white-space:nowrap" class="ft3990"><b>Xen&#160;Hypervisor</b></p>
<p style="position:absolute;top:562px;left:380px;white-space:nowrap" class="ft3990"><b>TPM</b></p>
<p style="position:absolute;top:563px;left:443px;white-space:nowrap" class="ft3990"><b>HDD</b></p>
<p style="position:absolute;top:566px;left:536px;white-space:nowrap" class="ft3990"><b>Network</b></p>
<p style="position:absolute;top:448px;left:375px;white-space:nowrap" class="ft3964"><b>/dev/tpm</b></p>
<p style="position:absolute;top:473px;left:385px;white-space:nowrap" class="ft3964"><b>TPM</b></p>
<p style="position:absolute;top:486px;left:381px;white-space:nowrap" class="ft3964"><b>Driver</b></p>
<p style="position:absolute;top:416px;left:386px;white-space:nowrap" class="ft3964"><b>TSS</b></p>
<p style="position:absolute;top:485px;left:447px;white-space:nowrap" class="ft3964"><b>HDD&#160;</b></p>
<p style="position:absolute;top:498px;left:444px;white-space:nowrap" class="ft3964"><b>Driver</b></p>
<p style="position:absolute;top:488px;left:500px;white-space:nowrap" class="ft3964"><b>VBDB</b></p>
<p style="position:absolute;top:472px;left:464px;white-space:nowrap" class="ft3964"><b>DM&#160;Crypt</b></p>
<p style="position:absolute;top:448px;left:439px;white-space:nowrap" class="ft3964"><b>/dev/sda</b></p>
<p style="position:absolute;top:485px;left:550px;white-space:nowrap" class="ft3964"><b>Ethernet</b></p>
<p style="position:absolute;top:498px;left:556px;white-space:nowrap" class="ft3964"><b>Driver</b></p>
<p style="position:absolute;top:488px;left:611px;white-space:nowrap" class="ft3964"><b>VNDB</b></p>
<p style="position:absolute;top:472px;left:582px;white-space:nowrap" class="ft3964"><b>Bridge</b></p>
<p style="position:absolute;top:448px;left:559px;white-space:nowrap" class="ft3964"><b>brctl</b></p>
<p style="position:absolute;top:448px;left:615px;white-space:nowrap" class="ft3964"><b>eth0</b></p>
<p style="position:absolute;top:226px;left:469px;white-space:nowrap" class="ft3964"><b>Compartment</b></p>
<p style="position:absolute;top:239px;left:482px;white-space:nowrap" class="ft3964"><b>Manager</b></p>
<p style="position:absolute;top:274px;left:407px;white-space:nowrap" class="ft3964"><b>Integrity</b></p>
<p style="position:absolute;top:287px;left:406px;white-space:nowrap" class="ft3964"><b>Manager</b></p>
<p style="position:absolute;top:274px;left:550px;white-space:nowrap" class="ft3964"><b>Secure&#160;Virtual</b></p>
<p style="position:absolute;top:287px;left:546px;white-space:nowrap" class="ft3964"><b>Device&#160;Manager</b></p>
<p style="position:absolute;top:312px;left:529px;white-space:nowrap" class="ft3964"><b>vHD&#160;vNW</b></p>
<p style="position:absolute;top:312px;left:597px;white-space:nowrap" class="ft3964"><b>…</b></p>
<p style="position:absolute;top:311px;left:373px;white-space:nowrap" class="ft3964"><b>Attestation</b></p>
<p style="position:absolute;top:324px;left:376px;white-space:nowrap" class="ft3964"><b>&amp;&#160;Sealing</b></p>
<p style="position:absolute;top:337px;left:384px;white-space:nowrap" class="ft3964"><b>Plugin</b></p>
<p style="position:absolute;top:311px;left:440px;white-space:nowrap" class="ft3964"><b>Storage</b></p>
<p style="position:absolute;top:324px;left:437px;white-space:nowrap" class="ft3964"><b>Integrity</b></p>
<p style="position:absolute;top:337px;left:444px;white-space:nowrap" class="ft3964"><b>Plugin</b></p>
<p style="position:absolute;top:312px;left:629px;white-space:nowrap" class="ft3964"><b>…</b></p>
<p style="position:absolute;top:197px;left:493px;white-space:nowrap" class="ft3991"><b>Dom0</b></p>
<p style="position:absolute;top:292px;left:319px;white-space:nowrap" class="ft3992"><b>User<br/>Space</b></p>
<p style="position:absolute;top:411px;left:319px;white-space:nowrap" class="ft3992"><b>Library<br/>Space</b></p>
<p style="position:absolute;top:467px;left:319px;white-space:nowrap" class="ft3992"><b>Kernel<br/>Space</b></p>
<p style="position:absolute;top:613px;left:347px;white-space:nowrap" class="ft3911">Figure&#160;2.16:&#160;Realisation&#160;using&#160;Xen&#160;and&#160;Linux</p>
<p style="position:absolute;top:661px;left:226px;white-space:nowrap" class="ft3917"><i>root</i>(</p>
<p style="position:absolute;top:660px;left:256px;white-space:nowrap" class="ft3930">T</p>
<p style="position:absolute;top:661px;left:267px;white-space:nowrap" class="ft3911">)&#160;can&#160;be&#160;deduced&#160;and&#160;compared&#160;with&#160;the&#160;reference&#160;value&#160;at&#160;hand.</p>
<p style="position:absolute;top:679px;left:248px;white-space:nowrap" class="ft3911">Using&#160;commitment&#160;schemes&#160;for&#160;blinding&#160;suffers&#160;from&#160;the&#160;disadvantage&#160;that&#160;two</p>
<p style="position:absolute;top:697px;left:226px;white-space:nowrap" class="ft3913">colluding&#160;verifiers&#160;can&#160;learn&#160;the&#160;values&#160;revealed&#160;to&#160;the&#160;other.&#160;Alternate&#160;schemes&#160;based<br/>on&#160;zero-knowledge&#160;proofs&#160;or&#160;deniable&#160;signatures&#160;need&#160;to&#160;be&#160;investigated&#160;to&#160;overcome<br/>this&#160;disadvantage.</p>
<p style="position:absolute;top:791px;left:226px;white-space:nowrap" class="ft3933"><b>2.5.4</b></p>
<p style="position:absolute;top:791px;left:280px;white-space:nowrap" class="ft3933"><b>Realisation&#160;using&#160;Xen&#160;and&#160;Linux</b></p>
<p style="position:absolute;top:821px;left:226px;white-space:nowrap" class="ft3912">Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#39">2.16&#160;</a>shows&#160;an&#160;example&#160;implementation&#160;of&#160;our&#160;PEV&#160;architecture&#160;with&#160;the&#160;Xen<br/>hypervisor&#160;using&#160;Linux&#160;for&#160;Dom0.&#160;The&#160;main&#160;components&#160;of&#160;our&#160;implementation&#160;are<br/>the&#160;Compartment&#160;Manager,&#160;Integrity&#160;Manager,&#160;and&#160;the&#160;Secure&#160;Virtual&#160;Device&#160;Manager.<br/>All&#160;components&#160;are&#160;implemented&#160;in&#160;Dom0.&#160;The&#160;Compartment&#160;Manager&#160;is&#160;the&#160;entity<br/>controlling&#160;the&#160;complete&#160;VM&#160;management&#160;and&#160;therefore&#160;communicates&#160;directly&#160;with<br/>the&#160;hypervisor.&#160;As&#160;the&#160;sole&#160;entry&#160;point&#160;for&#160;user&#160;commands,&#160;it&#160;also&#160;orchestrates&#160;the<br/>Integrity&#160;Manager&#160;and&#160;the&#160;Secure&#160;Virtual&#160;Device&#160;Manager.</p>
<p style="position:absolute;top:947px;left:248px;white-space:nowrap" class="ft3911">The&#160;Compartment&#160;Manager&#160;has&#160;an&#160;interface</p>
<p style="position:absolute;top:947px;left:523px;white-space:nowrap" class="ft3962">getCurrentState</p>
<p style="position:absolute;top:946px;left:623px;white-space:nowrap" class="ft3955">()</p>
<p style="position:absolute;top:947px;left:640px;white-space:nowrap" class="ft3911">for&#160;obtaining&#160;the</p>
<p style="position:absolute;top:965px;left:226px;white-space:nowrap" class="ft3912">current&#160;state&#160;of&#160;the&#160;entire&#160;environment,&#160;which&#160;includes&#160;the&#160;list&#160;of&#160;active&#160;VMs,&#160;the&#160;list<br/>of&#160;users&#160;to&#160;whom&#160;the&#160;VMs&#160;belong,&#160;the&#160;amount&#160;of&#160;free&#160;memory&#160;available,&#160;etc.&#160;This<br/>interface&#160;is&#160;useful&#160;for&#160;obtaining&#160;an&#160;attestation&#160;of&#160;the&#160;state&#160;of&#160;the&#160;physical&#160;machine.&#160;The<br/>result&#160;of&#160;the</p>
<p style="position:absolute;top:1018px;left:299px;white-space:nowrap" class="ft3962">getCurrentState</p>
<p style="position:absolute;top:1018px;left:399px;white-space:nowrap" class="ft3955">()</p>
<p style="position:absolute;top:1019px;left:413px;white-space:nowrap" class="ft3911">function&#160;may&#160;not&#160;be&#160;sufficient&#160;to&#160;convince&#160;a&#160;verifier&#160;that</p>
<p style="position:absolute;top:1037px;left:226px;white-space:nowrap" class="ft3913">the&#160;VMs&#160;are&#160;in&#160;good&#160;state,&#160;but&#160;would&#160;provide&#160;information&#160;about&#160;how&#160;many&#160;and&#160;what<br/>types&#160;of&#160;VMs&#160;are&#160;currently&#160;present&#160;on&#160;the&#160;physical&#160;machine,&#160;which&#160;VMs&#160;are&#160;running,</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft3918">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 40 -->
<a name="40"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page40-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC040.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft4011">38</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft4018">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft4012">which&#160;ones&#160;are&#160;hibernating,&#160;etc.&#160;Using&#160;such&#160;information,&#160;the&#160;verifier&#160;would&#160;be&#160;able&#160;to<br/>deduce&#160;whether&#160;the&#160;physical&#160;machine&#160;is&#160;in&#160;an&#160;“acceptable”&#160;state.</p>
<p style="position:absolute;top:230px;left:172px;white-space:nowrap" class="ft4011">Table&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#40">2.3&#160;</a>shows&#160;the&#160;mapping&#160;between&#160;concepts&#160;in&#160;our&#160;formal&#160;model&#160;and&#160;how&#160;they</p>
<p style="position:absolute;top:247px;left:150px;white-space:nowrap" class="ft4013">are&#160;realised&#160;in&#160;our&#160;implementation.&#160;XSLT&#160;is&#160;a&#160;language&#160;for&#160;transforming&#160;one&#160;XML<br/>document&#160;into&#160;another&#160;XML&#160;document.&#160;We&#160;assume&#160;that&#160;the&#160;XSLT&#160;interpreter&#160;is&#160;part<br/>of&#160;the&#160;TCB.</p>
<p style="position:absolute;top:314px;left:332px;white-space:nowrap" class="ft4020"><b>Model</b></p>
<p style="position:absolute;top:314px;left:428px;white-space:nowrap" class="ft4020"><b>Xen-based&#160;Prototype</b></p>
<p style="position:absolute;top:333px;left:349px;white-space:nowrap" class="ft4011">Log</p>
<p style="position:absolute;top:333px;left:391px;white-space:nowrap" class="ft4054">s</p>
<p style="position:absolute;top:338px;left:398px;white-space:nowrap" class="ft4061">t</p>
<p style="position:absolute;top:333px;left:428px;white-space:nowrap" class="ft4011">Internal&#160;to&#160;Component</p>
<p style="position:absolute;top:351px;left:312px;white-space:nowrap" class="ft4011">Projection</p>
<p style="position:absolute;top:351px;left:391px;white-space:nowrap" class="ft4062">p</p>
<p style="position:absolute;top:350px;left:399px;white-space:nowrap" class="ft4055">()</p>
<p style="position:absolute;top:351px;left:428px;white-space:nowrap" class="ft4011">Measurement&#160;Plug-in</p>
<p style="position:absolute;top:369px;left:269px;white-space:nowrap" class="ft4011">Sealing&#160;Predicate</p>
<p style="position:absolute;top:368px;left:391px;white-space:nowrap" class="ft4055">Π</p>
<p style="position:absolute;top:369px;left:428px;white-space:nowrap" class="ft4011">XSLT&#160;style&#160;sheet</p>
<p style="position:absolute;top:387px;left:252px;white-space:nowrap" class="ft4011">Evaluation&#160;Function</p>
<p style="position:absolute;top:386px;left:391px;white-space:nowrap" class="ft4062">f</p>
<p style="position:absolute;top:386px;left:397px;white-space:nowrap" class="ft4055">()</p>
<p style="position:absolute;top:387px;left:428px;white-space:nowrap" class="ft4011">XSLT&#160;style&#160;sheet</p>
<p style="position:absolute;top:405px;left:292px;white-space:nowrap" class="ft4011">Privacy&#160;Filter</p>
<p style="position:absolute;top:405px;left:428px;white-space:nowrap" class="ft4011">XSLT&#160;style&#160;sheet</p>
<p style="position:absolute;top:452px;left:281px;white-space:nowrap" class="ft4011">Table&#160;2.3:&#160;From&#160;Model&#160;to&#160;Implementation</p>
<p style="position:absolute;top:491px;left:172px;white-space:nowrap" class="ft4011">Both&#160;the&#160;Integrity&#160;Manager&#160;and&#160;the&#160;Secure&#160;Virtual&#160;Device&#160;Manager&#160;have&#160;a&#160;plug-in</p>
<p style="position:absolute;top:509px;left:150px;white-space:nowrap" class="ft4012">design.&#160;Each&#160;plug-in&#160;module&#160;is&#160;a&#160;concrete&#160;implementation&#160;of&#160;the&#160;log&#160;projection&#160;func-<br/>tion</p>
<p style="position:absolute;top:527px;left:177px;white-space:nowrap" class="ft4062">p</p>
<p style="position:absolute;top:526px;left:185px;white-space:nowrap" class="ft4055">()</p>
<p style="position:absolute;top:527px;left:200px;white-space:nowrap" class="ft4011">which&#160;outputs&#160;an&#160;XML&#160;file.&#160;The&#160;Integrity&#160;Manager&#160;in&#160;our&#160;implementation&#160;has</p>
<p style="position:absolute;top:545px;left:150px;white-space:nowrap" class="ft4012">a&#160;Storage&#160;Integrity&#160;plug-in&#160;for&#160;measuring&#160;various&#160;disk&#160;images&#160;and&#160;files.&#160;The&#160;Integrity<br/>Manager&#160;also&#160;has&#160;an&#160;Attestation&#160;&amp;&#160;Sealing&#160;plug-in&#160;that&#160;interfaces&#160;with&#160;the&#160;TPM&#160;for&#160;per-<br/>forming&#160;our&#160;sealing&#160;and&#160;attestation&#160;protocols&#160;as&#160;well&#160;as&#160;all&#160;for&#160;invoking&#160;normal&#160;TPM<br/>operations&#160;that&#160;are&#160;needed&#160;in&#160;the&#160;plug-in&#160;context,&#160;such&#160;as&#160;TPM_Quote.&#160;The&#160;Attestation<br/>&amp;&#160;Sealing&#160;plug-in&#160;invokes&#160;normal&#160;TPM&#160;operations&#160;through&#160;the&#160;TPM&#160;Software&#160;Stack<br/>(TSS)&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#71">[40]</a>,&#160;which&#160;is&#160;the&#160;standard&#160;API&#160;for&#160;accessing&#160;the&#160;functions&#160;of&#160;the&#160;TPM.</p>
<p style="position:absolute;top:653px;left:172px;white-space:nowrap" class="ft4011">The&#160;Secure&#160;Virtual&#160;Device&#160;Manager&#160;(SVDM)&#160;is&#160;responsible&#160;for&#160;managing&#160;virtual</p>
<p style="position:absolute;top:671px;left:150px;white-space:nowrap" class="ft4013">devices&#160;such&#160;as&#160;virtual&#160;hard&#160;disks,&#160;virtual&#160;block&#160;devices,&#160;virtual&#160;network&#160;devices,&#160;and<br/>virtual&#160;TPMs.&#160;The&#160;service&#160;offered&#160;by&#160;the&#160;SVDM&#160;is&#160;realised&#160;through&#160;multiple&#160;spe-<br/>cialised&#160;low-level&#160;plugins,&#160;one&#160;for&#160;each&#160;virtual&#160;device.&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#39">2.16&#160;</a>shows&#160;two&#160;plug-ins<br/>in&#160;our&#160;Xen&#160;prototype.&#160;One&#160;is&#160;for&#160;configuring&#160;a&#160;virtual&#160;(encrypted)&#160;hard&#160;disk&#160;and&#160;the<br/>other&#160;one&#160;is&#160;for&#160;configuring&#160;the&#160;virtual&#160;network.</p>
<p style="position:absolute;top:760px;left:172px;white-space:nowrap" class="ft4011">In&#160;Dom0,&#160;secure&#160;device&#160;virtualization&#160;is&#160;implemented&#160;in&#160;the&#160;kernel&#160;space.&#160;Tasks</p>
<p style="position:absolute;top:778px;left:150px;white-space:nowrap" class="ft4012">such&#160;as&#160;configuring&#160;virtual&#160;devices&#160;are&#160;done&#160;through&#160;the&#160;SVDM&#160;in&#160;the&#160;user&#160;(or&#160;applica-<br/>tion)&#160;space.&#160;The&#160;SVDM&#160;manages&#160;devices&#160;and&#160;their&#160;security&#160;properties.&#160;For&#160;example,&#160;a<br/>secure&#160;hard&#160;disk&#160;is&#160;implemented&#160;by&#160;means&#160;of&#160;the</p>
<p style="position:absolute;top:815px;left:449px;white-space:nowrap" class="ft4046">dm-crypt</p>
<p style="position:absolute;top:814px;left:525px;white-space:nowrap" class="ft4011">loop&#160;back&#160;device.&#160;Sim-</p>
<p style="position:absolute;top:832px;left:150px;white-space:nowrap" class="ft4012">ilarly,&#160;network&#160;virtualization&#160;is&#160;done&#160;by&#160;providing&#160;virtual&#160;network&#160;cards&#160;for&#160;the&#160;guest<br/>partitions&#160;and&#160;<i>bridging&#160;</i>these&#160;virtual&#160;cards&#160;to&#160;the&#160;actual&#160;network&#160;card.&#160;Security&#160;for&#160;net-<br/>works&#160;has&#160;two&#160;aspects.&#160;Topology&#160;constraints&#160;define&#160;which&#160;guest&#160;partition&#160;is&#160;allowed<br/>to&#160;connect&#160;to&#160;which&#160;subnets.&#160;In&#160;addition,&#160;encryption&#160;requirements&#160;define&#160;which&#160;con-<br/>nections&#160;need&#160;to&#160;be&#160;encrypted.&#160;Another&#160;device,&#160;which&#160;is&#160;not&#160;shown&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#39">2.16&#160;</a>but<br/>is&#160;virtualized&#160;in&#160;a&#160;similar&#160;way,&#160;is&#160;the&#160;TPM.&#160;Each&#160;guest&#160;partition&#160;is&#160;provided&#160;with&#160;one<br/>virtual&#160;TPM&#160;instance&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#69">[3]</a>.&#160;The&#160;Integrity&#160;Manager&#160;and&#160;Compartment&#160;Manager&#160;are&#160;im-<br/>plemented&#160;in&#160;Dom0,&#160;and&#160;interface&#160;to&#160;the&#160;hypervisor&#160;and&#160;other&#160;services&#160;implemented&#160;in<br/>Dom0.</p>
<p style="position:absolute;top:993px;left:172px;white-space:nowrap" class="ft4011">Secure&#160;management&#160;of&#160;virtual&#160;devices&#160;is&#160;a&#160;complex&#160;task.&#160;There&#160;are&#160;multiple&#160;steps</p>
<p style="position:absolute;top:1011px;left:150px;white-space:nowrap" class="ft4012">involved&#160;in&#160;starting&#160;a&#160;virtual&#160;hard-disk&#160;drive.&#160;First,&#160;a&#160;policy-based&#160;check&#160;of&#160;the&#160;platform<br/>state&#160;is&#160;done.&#160;Depending&#160;on&#160;the&#160;logic&#160;implemented&#160;by&#160;the&#160;corresponding&#160;plug-in,&#160;that<br/>check&#160;may&#160;include&#160;verifying&#160;the&#160;measurements&#160;of&#160;the&#160;hypervisor,&#160;binary&#160;disk,&#160;and&#160;the<br/>Dom0&#160;image.&#160;Then,&#160;the&#160;virtual&#160;hard-disk&#160;is&#160;attached&#160;with&#160;credentials&#160;and&#160;connected</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft4018">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 41 -->
<a name="41"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page41-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC041.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft4111">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft4111">39</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft4112">to&#160;a&#160;loop&#160;device&#160;(/dev/loop).&#160;The&#160;virtual&#160;hard-disk&#160;may&#160;be&#160;encrypted,&#160;for&#160;example,<br/>with&#160;a&#160;sealing&#160;key&#160;that&#160;is&#160;made&#160;available&#160;only&#160;if&#160;the&#160;platform&#160;is&#160;in&#160;a&#160;certain&#160;state.&#160;The<br/>decryption&#160;of&#160;the&#160;virtual&#160;hard-disk&#160;image&#160;is&#160;done&#160;using&#160;the&#160;Linux&#160;hard-disk&#160;encryptor.<br/>After&#160;decryption,&#160;the&#160;device&#160;file&#160;that&#160;gives&#160;access&#160;to&#160;the&#160;decrypted&#160;image&#160;is&#160;connected<br/>to&#160;the&#160;front-end.&#160;Similar&#160;policy-based&#160;checks&#160;may&#160;be&#160;done&#160;when&#160;starting&#160;other&#160;virtual<br/>devices.&#160;For&#160;example,&#160;before&#160;starting&#160;a&#160;virtual&#160;network&#160;device,&#160;policies&#160;may&#160;stipulate<br/>that&#160;the&#160;VM&#160;must&#160;be&#160;in&#160;some&#160;acceptable&#160;state&#160;and&#160;outside&#160;firewalls&#160;must&#160;be&#160;configured<br/>correctly.</p>
<p style="position:absolute;top:378px;left:226px;white-space:nowrap" class="ft4133"><b>2.5.5</b></p>
<p style="position:absolute;top:378px;left:280px;white-space:nowrap" class="ft4133"><b>Use&#160;Cases</b></p>
<p style="position:absolute;top:408px;left:226px;white-space:nowrap" class="ft4113">In&#160;this&#160;section,&#160;we&#160;describe&#160;a&#160;few&#160;examples&#160;of&#160;how&#160;the&#160;components&#160;introduced&#160;in&#160;Sec-<br/>tion&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#39">2.5.4&#160;</a>interact&#160;for&#160;integrity&#160;protection,&#160;enforcement,&#160;and&#160;verification&#160;purposes.&#160;We<br/>assume&#160;that&#160;the&#160;core&#160;trusted&#160;computing&#160;base&#160;(including&#160;Xen&#160;and&#160;Dom0&#160;Linux)&#160;has<br/>been&#160;measured&#160;at&#160;start-up&#160;time.&#160;Additional&#160;services&#160;may&#160;need&#160;to&#160;be&#160;measured&#160;based&#160;on<br/>policy.&#160;The&#160;measurement&#160;can&#160;either&#160;be&#160;done&#160;by&#160;a&#160;trusted&#160;boot&#160;loader&#160;such&#160;as&#160;Trusted-<br/>GRUB&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#71">[34]&#160;</a>measuring&#160;the&#160;entire&#160;boot&#160;image&#160;or&#160;by&#160;a&#160;more&#160;fine-grained&#160;approach&#160;such<br/>as&#160;that&#160;proposed&#160;by&#160;Sailer&#160;<i>et&#160;al</i>.&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#71">[32]</a>.</p>
<p style="position:absolute;top:573px;left:226px;white-space:nowrap" class="ft4120"><b>TPM-based&#160;Attestation&#160;on&#160;a&#160;VM&#160;Disk</b></p>
<p style="position:absolute;top:1043px;left:331px;white-space:nowrap" class="ft4111">Figure&#160;2.17:&#160;TPM-based&#160;Attestation&#160;on&#160;a&#160;VM&#160;Disk</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft4118">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 42 -->
<a name="42"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4293{font-size:12px;font-family:Courier;color:#231f20;}
-->
</style>
<div id="page42-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC042.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft4211">40</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft4218">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:194px;left:214px;white-space:nowrap" class="ft4293">&lt;attestation-desc&gt;</p>
<p style="position:absolute;top:208px;left:229px;white-space:nowrap" class="ft4293">&lt;attestation&#160;type=&#34;tpm-based&#34;&#160;challenge=&#34;0xaded...&#34;</p>
<p style="position:absolute;top:222px;left:257px;white-space:nowrap" class="ft4293">aik=&#34;0xaada3..&#34;&gt;</p>
<p style="position:absolute;top:237px;left:243px;white-space:nowrap" class="ft4293">&lt;measurement-desc&#160;type=&#34;tpm&#34;&gt;</p>
<p style="position:absolute;top:251px;left:272px;white-space:nowrap" class="ft4293">&lt;measureTarget&#160;name=&#34;disk:/dev/sdb1&#34;</p>
<p style="position:absolute;top:265px;left:286px;white-space:nowrap" class="ft4293">dest=&#34;PCR16&#34;/&gt;</p>
<p style="position:absolute;top:279px;left:243px;white-space:nowrap" class="ft4293">&lt;/measurement-desc&gt;</p>
<p style="position:absolute;top:293px;left:243px;white-space:nowrap" class="ft4293">&lt;attestTarget&#160;name=&#34;ALLPCRS&#34;/&gt;</p>
<p style="position:absolute;top:308px;left:229px;white-space:nowrap" class="ft4293">&lt;/attestation&gt;</p>
<p style="position:absolute;top:322px;left:214px;white-space:nowrap" class="ft4293">&lt;/attestation-desc&gt;</p>
<p style="position:absolute;top:357px;left:276px;white-space:nowrap" class="ft4211">Figure&#160;2.18:&#160;Attestation&#160;Descriptor&#160;in&#160;XML</p>
<p style="position:absolute;top:405px;left:172px;white-space:nowrap" class="ft4211">Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#41">2.17&#160;</a>shows&#160;the&#160;component&#160;interactions&#160;for&#160;attesting&#160;the&#160;current&#160;state&#160;of&#160;the</p>
<p style="position:absolute;top:423px;left:150px;white-space:nowrap" class="ft4211">TCB&#160;and&#160;the&#160;status&#160;of&#160;a&#160;VM’s&#160;disk&#160;image.</p>
<p style="position:absolute;top:441px;left:172px;white-space:nowrap" class="ft4211">The&#160;user/verifier&#160;interacts&#160;with&#160;the&#160;Compartment&#160;Manager&#160;(CM)&#160;through&#160;the</p>
<p style="position:absolute;top:459px;left:150px;white-space:nowrap" class="ft4262">attestationRequest</p>
<p style="position:absolute;top:459px;left:271px;white-space:nowrap" class="ft4211">call&#160;with&#160;an&#160;<i>attestation&#160;descriptor&#160;</i>and&#160;<i>user&#160;credential&#160;</i>as&#160;param-</p>
<p style="position:absolute;top:477px;left:150px;white-space:nowrap" class="ft4211">eters&#160;(step&#160;1).</p>
<p style="position:absolute;top:495px;left:172px;white-space:nowrap" class="ft4211">The&#160;attestation&#160;descriptor&#160;is&#160;basically&#160;an&#160;XML&#160;structure&#160;that&#160;describes&#160;what&#160;the</p>
<p style="position:absolute;top:513px;left:150px;white-space:nowrap" class="ft4213">verifier&#160;needs&#160;to&#160;have&#160;attested.&#160;The&#160;attestation&#160;descriptor&#160;contains&#160;one&#160;or&#160;more&#160;<i>mea-<br/>surement&#160;descriptors</i>.&#160;Based&#160;on&#160;the&#160;measurement&#160;descriptors,&#160;the&#160;Integrity&#160;Manager<br/>(IM)&#160;knows&#160;the&#160;exact&#160;set&#160;of&#160;measurement&#160;plug-in&#160;modules&#160;to&#160;invoke.&#160;As&#160;noted&#160;be-<br/>fore,&#160;log&#160;projection&#160;functions&#160;are&#160;realised&#160;by&#160;a&#160;set&#160;of&#160;plug-in&#160;modules.&#160;The&#160;attestation<br/>descriptor&#160;is&#160;how&#160;the&#160;verifier&#160;chooses&#160;the&#160;projection&#160;function&#160;suitable&#160;for&#160;its&#160;purpose.</p>
<p style="position:absolute;top:602px;left:172px;white-space:nowrap" class="ft4211">Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#42">2.18&#160;</a>shows&#160;an&#160;example&#160;attestation&#160;descriptor&#160;as&#160;a&#160;XML&#160;structure.&#160;It&#160;contains</p>
<p style="position:absolute;top:620px;left:150px;white-space:nowrap" class="ft4211">an</p>
<p style="position:absolute;top:621px;left:167px;white-space:nowrap" class="ft4246">&lt;attestation&gt;</p>
<p style="position:absolute;top:620px;left:286px;white-space:nowrap" class="ft4211">section,&#160;which&#160;defines&#160;the&#160;type&#160;of&#160;attestation&#160;(</p>
<p style="position:absolute;top:621px;left:555px;white-space:nowrap" class="ft4246">tpm-based</p>
<p style="position:absolute;top:620px;left:636px;white-space:nowrap" class="ft4211">)&#160;and</p>
<p style="position:absolute;top:638px;left:150px;white-space:nowrap" class="ft4211">the&#160;parameters&#160;needed&#160;for&#160;attestation&#160;(the&#160;TPM&#160;Attestation&#160;Identity&#160;Key&#160;or</p>
<p style="position:absolute;top:639px;left:602px;white-space:nowrap" class="ft4246">AIK</p>
<p style="position:absolute;top:638px;left:633px;white-space:nowrap" class="ft4211">and&#160;a</p>
<p style="position:absolute;top:657px;left:150px;white-space:nowrap" class="ft4246">challenge</p>
<p style="position:absolute;top:656px;left:231px;white-space:nowrap" class="ft4211">).&#160;Nested&#160;in&#160;the&#160;attestation&#160;descriptor&#160;is&#160;a&#160;measurement&#160;descriptor,&#160;which</p>
<p style="position:absolute;top:674px;left:150px;white-space:nowrap" class="ft4211">specifies&#160;a&#160;measurement&#160;target&#160;(</p>
<p style="position:absolute;top:675px;left:347px;white-space:nowrap" class="ft4246">measureTarget</p>
<p style="position:absolute;top:674px;left:464px;white-space:nowrap" class="ft4211">)&#160;and&#160;a&#160;destination&#160;(</p>
<p style="position:absolute;top:675px;left:589px;white-space:nowrap" class="ft4246">dest</p>
<p style="position:absolute;top:674px;left:625px;white-space:nowrap" class="ft4211">).&#160;The</p>
<p style="position:absolute;top:692px;left:150px;white-space:nowrap" class="ft4213">target&#160;indicates&#160;what&#160;is&#160;to&#160;be&#160;measured&#160;(in&#160;this&#160;case,&#160;a&#160;VM&#160;disk&#160;image),&#160;whereas&#160;the<br/>destination&#160;indicates&#160;where&#160;the&#160;result&#160;should&#160;be&#160;stored&#160;(in&#160;this&#160;case,&#160;the&#160;TPM’s&#160;PCR<br/>number&#160;16).&#160;The</p>
<p style="position:absolute;top:729px;left:261px;white-space:nowrap" class="ft4246">&lt;attestTarget&gt;</p>
<p style="position:absolute;top:728px;left:391px;white-space:nowrap" class="ft4211">defines&#160;the&#160;scope&#160;of&#160;the&#160;requested&#160;attestation</p>
<p style="position:absolute;top:746px;left:150px;white-space:nowrap" class="ft4211">(in&#160;this&#160;case,&#160;all&#160;PCRs).</p>
<p style="position:absolute;top:764px;left:172px;white-space:nowrap" class="ft4211">Based&#160;on&#160;the&#160;user&#160;credential&#160;supplied,&#160;the&#160;CM&#160;checks&#160;whether&#160;the&#160;verifier&#160;has&#160;the</p>
<p style="position:absolute;top:782px;left:150px;white-space:nowrap" class="ft4213">right&#160;to&#160;request&#160;attestation&#160;of&#160;the&#160;system&#160;sub-states&#160;indicated&#160;by&#160;the&#160;attestation&#160;descrip-<br/>tor.&#160;The&#160;check&#160;is&#160;essentially&#160;a&#160;way&#160;of&#160;determining&#160;whether&#160;the&#160;requested&#160;projection&#160;is&#160;a<br/>privacy-preserving&#160;projection;&#160;hence,&#160;it&#160;is&#160;useful&#160;in&#160;enforcing&#160;privacy&#160;protection.&#160;If&#160;the<br/>check&#160;reveals&#160;that&#160;the&#160;verifier&#160;wants&#160;to&#160;have&#160;more&#160;attested&#160;than&#160;what&#160;he/she&#160;is&#160;allowed<br/>to,&#160;then&#160;the&#160;entire&#160;attestation&#160;request&#160;is&#160;denied.&#160;Otherwise,&#160;the&#160;CM&#160;forwards&#160;the&#160;request<br/>to&#160;the&#160;IM&#160;(step&#160;1.1).</p>
<p style="position:absolute;top:889px;left:172px;white-space:nowrap" class="ft4211">The&#160;IM&#160;extracts&#160;the&#160;measurement&#160;descriptor(s)&#160;from&#160;the&#160;attestation&#160;descriptor&#160;and</p>
<p style="position:absolute;top:907px;left:150px;white-space:nowrap" class="ft4213">delegates&#160;the&#160;measurement(s)&#160;to&#160;the&#160;appropriate&#160;plug-in(s).&#160;In&#160;our&#160;example,&#160;the&#160;IM<br/>invokes&#160;the</p>
<p style="position:absolute;top:925px;left:224px;white-space:nowrap" class="ft4262">measurevHD</p>
<p style="position:absolute;top:925px;left:309px;white-space:nowrap" class="ft4211">function&#160;at&#160;the&#160;Storage&#160;Integrity&#160;Plug-in&#160;(SIP)&#160;passing&#160;the</p>
<p style="position:absolute;top:943px;left:150px;white-space:nowrap" class="ft4213">measurement&#160;descriptor&#160;as&#160;a&#160;parameter&#160;(step&#160;1.1.1).&#160;The&#160;plug-in&#160;completes&#160;the&#160;re-<br/>quested&#160;measurement&#160;and&#160;returns&#160;the&#160;measurement&#160;result&#160;back&#160;to&#160;the&#160;IM&#160;(step&#160;1.1.2).<br/>Although&#160;step&#160;1.1.2&#160;might&#160;look&#160;like&#160;an&#160;unnecessary&#160;extra&#160;step,&#160;the&#160;indirection&#160;via&#160;the<br/>IM&#160;allows&#160;the&#160;measurement&#160;plug-ins&#160;to&#160;be&#160;written&#160;independent&#160;of&#160;the&#160;TPM&#160;or&#160;similar<br/>future&#160;devices&#160;that&#160;are&#160;indicated&#160;as</p>
<p style="position:absolute;top:1016px;left:360px;white-space:nowrap" class="ft4246">dest</p>
<p style="position:absolute;top:1015px;left:396px;white-space:nowrap" class="ft4211">.</p>
<p style="position:absolute;top:1033px;left:172px;white-space:nowrap" class="ft4211">The&#160;IM&#160;invokes&#160;the</p>
<p style="position:absolute;top:1032px;left:308px;white-space:nowrap" class="ft4262">wrToTPM</p>
<p style="position:absolute;top:1033px;left:380px;white-space:nowrap" class="ft4211">function&#160;at&#160;the&#160;Attestation&#160;&amp;&#160;Sealing&#160;Plugin</p>
<p style="position:absolute;top:1051px;left:150px;white-space:nowrap" class="ft4211">(ASP)&#160;with&#160;the&#160;challenge,&#160;the</p>
<p style="position:absolute;top:1052px;left:349px;white-space:nowrap" class="ft4246">AIK</p>
<p style="position:absolute;top:1051px;left:376px;white-space:nowrap" class="ft4211">,&#160;the&#160;measurement&#160;result,&#160;and&#160;the&#160;destination</p>
<p style="position:absolute;top:1069px;left:150px;white-space:nowrap" class="ft4211">PCR&#160;(step&#160;1.1.3).&#160;The&#160;actual&#160;writing&#160;of&#160;the&#160;result&#160;into&#160;the&#160;PCR&#160;happens&#160;by&#160;the</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft4218">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 43 -->
<a name="43"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page43-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC043.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft4311">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft4311">41</p>
<p style="position:absolute;top:585px;left:316px;white-space:nowrap" class="ft4311">Figure&#160;2.19:&#160;Creation&#160;of&#160;a&#160;VM&#160;with&#160;TPM-based&#160;Sealing</p>
<p style="position:absolute;top:633px;left:226px;white-space:nowrap" class="ft4362">TPM</p>
<p style="position:absolute;top:633px;left:259px;white-space:nowrap" class="ft4311">_</p>
<p style="position:absolute;top:633px;left:266px;white-space:nowrap" class="ft4362">extend</p>
<p style="position:absolute;top:633px;left:313px;white-space:nowrap" class="ft4311">operation&#160;(step&#160;1.1.3.1).&#160;Thereafter,&#160;a</p>
<p style="position:absolute;top:633px;left:556px;white-space:nowrap" class="ft4362">TPM</p>
<p style="position:absolute;top:633px;left:589px;white-space:nowrap" class="ft4311">_</p>
<p style="position:absolute;top:633px;left:597px;white-space:nowrap" class="ft4362">Quote</p>
<p style="position:absolute;top:633px;left:641px;white-space:nowrap" class="ft4311">gets&#160;created&#160;and</p>
<p style="position:absolute;top:651px;left:226px;white-space:nowrap" class="ft4311">returned&#160;to&#160;the&#160;ASP&#160;(steps&#160;1.1.3.2&#160;and&#160;1.1.3.3).&#160;The&#160;ASP&#160;wraps&#160;the</p>
<p style="position:absolute;top:651px;left:663px;white-space:nowrap" class="ft4362">TPM</p>
<p style="position:absolute;top:651px;left:696px;white-space:nowrap" class="ft4311">_</p>
<p style="position:absolute;top:651px;left:703px;white-space:nowrap" class="ft4362">Quote</p>
<p style="position:absolute;top:669px;left:226px;white-space:nowrap" class="ft4311">into&#160;an</p>
<p style="position:absolute;top:669px;left:275px;white-space:nowrap" class="ft4362">attestationResponse</p>
<p style="position:absolute;top:669px;left:406px;white-space:nowrap" class="ft4311">and&#160;returns&#160;it&#160;to&#160;the&#160;IM.&#160;The</p>
<p style="position:absolute;top:669px;left:594px;white-space:nowrap" class="ft4362">attestationResponse</p>
<p style="position:absolute;top:669px;left:725px;white-space:nowrap" class="ft4311">in-</p>
<p style="position:absolute;top:687px;left:226px;white-space:nowrap" class="ft4311">cludes&#160;not&#160;only&#160;the</p>
<p style="position:absolute;top:687px;left:349px;white-space:nowrap" class="ft4362">TPM</p>
<p style="position:absolute;top:687px;left:382px;white-space:nowrap" class="ft4311">_</p>
<p style="position:absolute;top:687px;left:390px;white-space:nowrap" class="ft4362">Quote</p>
<p style="position:absolute;top:687px;left:433px;white-space:nowrap" class="ft4311">but&#160;also&#160;the&#160;relevant&#160;log&#160;files.&#160;The&#160;IM&#160;returns&#160;the</p>
<p style="position:absolute;top:705px;left:226px;white-space:nowrap" class="ft4362">attestationResponse</p>
<p style="position:absolute;top:705px;left:355px;white-space:nowrap" class="ft4311">to&#160;the&#160;CM&#160;(step&#160;1.2),&#160;which&#160;forwards&#160;it&#160;to&#160;the&#160;verifier&#160;(step&#160;2).</p>
<p style="position:absolute;top:723px;left:248px;white-space:nowrap" class="ft4311">A&#160;verifier&#160;can&#160;check&#160;the&#160;attestation&#160;result&#160;by&#160;recomputing&#160;a&#160;hash&#160;over&#160;the&#160;attestation</p>
<p style="position:absolute;top:741px;left:226px;white-space:nowrap" class="ft4311">targets&#160;(i.e.,&#160;the&#160;relevant&#160;log&#160;files)&#160;specified&#160;in&#160;the</p>
<p style="position:absolute;top:741px;left:524px;white-space:nowrap" class="ft4362">attestationResponse</p>
<p style="position:absolute;top:741px;left:652px;white-space:nowrap" class="ft4311">and&#160;comparing</p>
<p style="position:absolute;top:759px;left:226px;white-space:nowrap" class="ft4311">the&#160;resulting&#160;hash&#160;with&#160;the&#160;hash&#160;in&#160;the&#160;PCR&#160;from&#160;the</p>
<p style="position:absolute;top:758px;left:543px;white-space:nowrap" class="ft4362">TPM</p>
<p style="position:absolute;top:759px;left:576px;white-space:nowrap" class="ft4311">_</p>
<p style="position:absolute;top:758px;left:583px;white-space:nowrap" class="ft4362">Quote</p>
<p style="position:absolute;top:759px;left:621px;white-space:nowrap" class="ft4311">.</p>
<p style="position:absolute;top:777px;left:248px;white-space:nowrap" class="ft4311">The&#160;PCR&#160;in&#160;which&#160;the&#160;measurement&#160;result&#160;is&#160;stored&#160;will&#160;be&#160;reset&#160;after&#160;the&#160;attestation</p>
<p style="position:absolute;top:795px;left:226px;white-space:nowrap" class="ft4313">process&#160;has&#160;finished.&#160;Therefore,&#160;our&#160;prototype&#160;requires&#160;a&#160;TCG&#160;1.2&#160;compliant&#160;TPM,&#160;and<br/>the</p>
<p style="position:absolute;top:814px;left:248px;white-space:nowrap" class="ft4346">dest</p>
<p style="position:absolute;top:813px;left:288px;white-space:nowrap" class="ft4311">PCR&#160;has&#160;to&#160;be</p>
<p style="position:absolute;top:812px;left:377px;white-space:nowrap" class="ft4355">16</p>
<p style="position:absolute;top:813px;left:395px;white-space:nowrap" class="ft4311">or&#160;higher.</p>
<p style="position:absolute;top:871px;left:226px;white-space:nowrap" class="ft4320"><b>(Re-)Starting&#160;a&#160;VM&#160;with&#160;TPM-based&#160;Sealing</b></p>
<p style="position:absolute;top:899px;left:226px;white-space:nowrap" class="ft4313">Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#43">2.19&#160;</a>shows&#160;the&#160;component&#160;interactions&#160;for&#160;(re-)starting&#160;a&#160;VM&#160;with&#160;a&#160;sealed&#160;disk<br/>image.&#160;In&#160;this&#160;use&#160;case,&#160;we&#160;show&#160;how&#160;to&#160;enforce&#160;a&#160;policy&#160;that&#160;specifies&#160;that&#160;the&#160;key&#160;for<br/>decrypting&#160;the&#160;disk&#160;image&#160;be&#160;revealed&#160;only&#160;after&#160;measuring&#160;the&#160;disk&#160;image&#160;and&#160;only&#160;if<br/>the&#160;measurement&#160;value&#160;written&#160;into&#160;a&#160;specified&#160;PCR&#160;matches&#160;the&#160;value&#160;against&#160;which<br/>the&#160;key&#160;was&#160;sealed.</p>
<p style="position:absolute;top:988px;left:248px;white-space:nowrap" class="ft4311">The&#160;user&#160;interacts&#160;with&#160;the&#160;CM&#160;through&#160;the</p>
<p style="position:absolute;top:988px;left:531px;white-space:nowrap" class="ft4362">startVM</p>
<p style="position:absolute;top:988px;left:588px;white-space:nowrap" class="ft4311">call&#160;to&#160;(re-)start&#160;the&#160;VM</p>
<p style="position:absolute;top:1006px;left:226px;white-space:nowrap" class="ft4313">(step&#160;1).&#160;After&#160;determining&#160;that&#160;the&#160;disk&#160;image&#160;has&#160;to&#160;be&#160;first&#160;decrypted&#160;through&#160;unseal-<br/>ing,&#160;the&#160;CM&#160;obtains&#160;the&#160;<i>sealing&#160;descriptor&#160;</i>that&#160;was&#160;given&#160;to&#160;it&#160;at&#160;the&#160;time&#160;of&#160;sealing.<br/>Like&#160;the&#160;attestation&#160;descriptor,&#160;the&#160;sealing&#160;descriptor&#160;also&#160;contains&#160;one&#160;or&#160;more&#160;mea-<br/>surement&#160;descriptors,&#160;which&#160;are&#160;used&#160;to&#160;let&#160;the&#160;IM&#160;know&#160;the&#160;exact&#160;set&#160;of&#160;measurement</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft4318">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 44 -->
<a name="44"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4494{font-size:13px;font-family:Courier;color:#231f20;}
-->
</style>
<div id="page44-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC044.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft4411">42</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft4418">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:194px;left:214px;white-space:nowrap" class="ft4494">&lt;sealing-desc&gt;</p>
<p style="position:absolute;top:211px;left:230px;white-space:nowrap" class="ft4494">&lt;sealing&#160;type=&#34;tpm-based&#34;&#160;keyid=&#34;0x01&#34;&gt;</p>
<p style="position:absolute;top:227px;left:246px;white-space:nowrap" class="ft4494">&lt;measurement-desc&#160;type=&#34;tpm&#34;&gt;</p>
<p style="position:absolute;top:243px;left:279px;white-space:nowrap" class="ft4494">&lt;measureTarget</p>
<p style="position:absolute;top:260px;left:327px;white-space:nowrap" class="ft4494">name=&#34;file:/xenimages/vm1image&#34;</p>
<p style="position:absolute;top:276px;left:327px;white-space:nowrap" class="ft4494">desc=&#34;PCR16&#34;/&gt;</p>
<p style="position:absolute;top:293px;left:246px;white-space:nowrap" class="ft4494">&lt;/measurement-desc&gt;</p>
<p style="position:absolute;top:309px;left:230px;white-space:nowrap" class="ft4494">&lt;/sealing&gt;</p>
<p style="position:absolute;top:326px;left:214px;white-space:nowrap" class="ft4494">&lt;/sealing-desc&gt;</p>
<p style="position:absolute;top:362px;left:287px;white-space:nowrap" class="ft4411">Figure&#160;2.20:&#160;Sealing&#160;Descriptor&#160;in&#160;XML</p>
<p style="position:absolute;top:410px;left:150px;white-space:nowrap" class="ft4411">plug-in&#160;modules&#160;to&#160;invoke.</p>
<p style="position:absolute;top:428px;left:172px;white-space:nowrap" class="ft4411">Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#44">2.20&#160;</a>shows&#160;an&#160;example&#160;sealing&#160;descriptor&#160;as&#160;an&#160;XML&#160;structure.&#160;It&#160;contains</p>
<p style="position:absolute;top:446px;left:150px;white-space:nowrap" class="ft4411">an</p>
<p style="position:absolute;top:446px;left:168px;white-space:nowrap" class="ft4446">&lt;sealing&gt;</p>
<p style="position:absolute;top:446px;left:253px;white-space:nowrap" class="ft4411">section,&#160;which&#160;defines&#160;the&#160;type&#160;of&#160;sealing&#160;(</p>
<p style="position:absolute;top:446px;left:509px;white-space:nowrap" class="ft4446">tpm-based</p>
<p style="position:absolute;top:446px;left:590px;white-space:nowrap" class="ft4411">)&#160;and&#160;the&#160;pa-</p>
<p style="position:absolute;top:464px;left:150px;white-space:nowrap" class="ft4412">rameters&#160;needed&#160;for&#160;unsealing&#160;(the&#160;identifier&#160;of&#160;the&#160;key&#160;protected&#160;by&#160;the&#160;TPM).&#160;Nested<br/>in&#160;the&#160;sealing&#160;descriptor&#160;there&#160;is&#160;a&#160;measurement&#160;descriptor,&#160;which&#160;specifies&#160;a&#160;measure-<br/>ment&#160;target&#160;(</p>
<p style="position:absolute;top:500px;left:227px;white-space:nowrap" class="ft4446">measureTarget</p>
<p style="position:absolute;top:499px;left:344px;white-space:nowrap" class="ft4411">)&#160;and&#160;a&#160;destination&#160;(</p>
<p style="position:absolute;top:500px;left:463px;white-space:nowrap" class="ft4446">dest</p>
<p style="position:absolute;top:499px;left:499px;white-space:nowrap" class="ft4411">).&#160;The&#160;target&#160;indicates&#160;what</p>
<p style="position:absolute;top:517px;left:150px;white-space:nowrap" class="ft4413">is&#160;to&#160;be&#160;measured&#160;(in&#160;this&#160;case,&#160;a&#160;VM&#160;disk&#160;image),&#160;whereas&#160;the&#160;destination&#160;indicates<br/>where&#160;the&#160;result&#160;should&#160;be&#160;stored&#160;(in&#160;this&#160;case,&#160;the&#160;TPM’s&#160;PCR&#160;number&#160;16).</p>
<p style="position:absolute;top:553px;left:172px;white-space:nowrap" class="ft4411">The&#160;CM&#160;calls&#160;the&#160;IM&#160;interface</p>
<p style="position:absolute;top:553px;left:358px;white-space:nowrap" class="ft4462">unsealKey</p>
<p style="position:absolute;top:553px;left:424px;white-space:nowrap" class="ft4411">(step&#160;1.1),&#160;passing&#160;the&#160;sealing&#160;descriptor</p>
<p style="position:absolute;top:571px;left:150px;white-space:nowrap" class="ft4413">as&#160;a&#160;parameter.&#160;The&#160;IM&#160;extracts&#160;the&#160;measurement&#160;descriptor&#160;from&#160;the&#160;sealing&#160;descriptor<br/>and&#160;calls&#160;the</p>
<p style="position:absolute;top:588px;left:229px;white-space:nowrap" class="ft4462">measurevHD</p>
<p style="position:absolute;top:589px;left:312px;white-space:nowrap" class="ft4411">interface&#160;of&#160;the&#160;Storage&#160;Integrity&#160;Plug-in&#160;with&#160;the&#160;measure-</p>
<p style="position:absolute;top:607px;left:150px;white-space:nowrap" class="ft4411">ment&#160;descriptor&#160;(step&#160;1.1.1).&#160;The&#160;plug-in&#160;reads&#160;the&#160;list&#160;of</p>
<p style="position:absolute;top:608px;left:509px;white-space:nowrap" class="ft4446">measureTargets</p>
<p style="position:absolute;top:607px;left:635px;white-space:nowrap" class="ft4411">,&#160;and</p>
<p style="position:absolute;top:625px;left:150px;white-space:nowrap" class="ft4412">accordingly&#160;measures&#160;the&#160;disk&#160;image.&#160;It&#160;returns&#160;a&#160;measurement&#160;result&#160;list&#160;to&#160;the&#160;IM<br/>(step&#160;1.1.2).&#160;The&#160;IM&#160;calls&#160;the&#160;Attestation&#160;&amp;&#160;Sealing&#160;Plug-in,&#160;which&#160;handles&#160;TPM-<br/>related&#160;functions&#160;(step&#160;1.1.3).&#160;The&#160;Attestation&#160;&amp;&#160;Sealing&#160;Plug-in&#160;writes&#160;the&#160;measure-<br/>ments&#160;to&#160;the&#160;TPM&#160;by&#160;invoking&#160;the&#160;TPM_Extend&#160;operation&#160;(step&#160;1.1.3.1).&#160;Furthermore,<br/>the&#160;Attestation&#160;&amp;&#160;Sealing&#160;Plug-in&#160;performs&#160;the&#160;unsealing&#160;of&#160;the&#160;key&#160;requested&#160;by&#160;in-<br/>voking&#160;the&#160;TPM_Unseal&#160;operation&#160;(step&#160;1.1.3.3).&#160;If&#160;the</p>
<p style="position:absolute;top:715px;left:486px;white-space:nowrap" class="ft4446">dest</p>
<p style="position:absolute;top:715px;left:526px;white-space:nowrap" class="ft4411">PCR&#160;value&#160;matches&#160;the</p>
<p style="position:absolute;top:732px;left:150px;white-space:nowrap" class="ft4412">value&#160;at&#160;the&#160;time&#160;of&#160;sealing,&#160;then&#160;the&#160;disk&#160;is&#160;in&#160;the&#160;desired&#160;state&#160;and&#160;the&#160;unseal&#160;oper-<br/>ation&#160;is&#160;successful&#160;(step&#160;1.1.3.4);&#160;in&#160;that&#160;case,&#160;the&#160;ASP&#160;returns&#160;a&#160;key&#160;back&#160;to&#160;the&#160;IM<br/>(step&#160;1.1.4),&#160;which&#160;in&#160;turn&#160;returns&#160;the&#160;key&#160;to&#160;the&#160;CM&#160;(step&#160;1.2).&#160;In&#160;case&#160;the&#160;unseal<br/>operation&#160;fails,&#160;the&#160;ASP&#160;would&#160;return&#160;a&#160;failure.&#160;The&#160;CM&#160;calls&#160;the&#160;SVDM&#160;function</p>
<p style="position:absolute;top:804px;left:150px;white-space:nowrap" class="ft4462">configAndUnlock</p>
<p style="position:absolute;top:803px;left:256px;white-space:nowrap" class="ft4455">()</p>
<p style="position:absolute;top:804px;left:271px;white-space:nowrap" class="ft4411">to&#160;attach&#160;and&#160;unlock&#160;the&#160;disk&#160;(steps&#160;1.3&#160;and&#160;1.4).&#160;Upon&#160;successful</p>
<p style="position:absolute;top:822px;left:150px;white-space:nowrap" class="ft4412">completion&#160;of&#160;that&#160;function,&#160;the&#160;CM&#160;instructs&#160;the&#160;Xen&#160;hypervisor&#160;to&#160;actually&#160;start&#160;the<br/>VM&#160;(steps&#160;1.5&#160;and&#160;1.6).</p>
<p style="position:absolute;top:858px;left:172px;white-space:nowrap" class="ft4411">For&#160;the&#160;sake&#160;of&#160;simplicity,&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#43">2.19&#160;</a>does&#160;not&#160;show&#160;details&#160;of&#160;key&#160;handling&#160;such</p>
<p style="position:absolute;top:876px;left:150px;white-space:nowrap" class="ft4411">as&#160;loading&#160;a&#160;sealing&#160;wrapper&#160;key&#160;into&#160;the&#160;TPM.</p>
<p style="position:absolute;top:934px;left:150px;white-space:nowrap" class="ft4420"><b>Enforcement&#160;and&#160;Compliance&#160;Proofs&#160;for&#160;Information&#160;Flow&#160;Control</b></p>
<p style="position:absolute;top:962px;left:150px;white-space:nowrap" class="ft4412">Consider,&#160;for&#160;example,&#160;the&#160;virtual&#160;network&#160;topology&#160;shown&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#45">2.21&#160;</a>with&#160;four<br/>virtual&#160;network&#160;zones.&#160;The&#160;topology&#160;shows&#160;the&#160;network&#160;of&#160;a&#160;company&#160;(which&#160;we<br/>shall&#160;call&#160;the&#160;<i>customer&#160;</i>company)&#160;connected&#160;to&#160;the&#160;Internet&#160;via&#160;a&#160;demilitarised&#160;zone<br/>(DMZ).&#160;The&#160;customer&#160;network&#160;is&#160;also&#160;connected&#160;to&#160;a&#160;<i>management&#160;network&#160;</i>that&#160;allows<br/>an&#160;outsourcing&#160;provider&#160;to&#160;manage&#160;the&#160;customer&#160;systems.&#160;The&#160;management&#160;network&#160;is<br/>not&#160;connected&#160;to&#160;the&#160;Internet.</p>
<p style="position:absolute;top:1069px;left:172px;white-space:nowrap" class="ft4411">An&#160;information&#160;flow&#160;control&#160;matrix&#160;is&#160;a&#160;simple&#160;way&#160;of&#160;formalising&#160;the&#160;system-wide</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft4418">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 45 -->
<a name="45"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4595{font-size:18px;font-family:Helvetica;color:#000000;}
	.ft4596{font-size:15px;font-family:ZUROSU+CMBX10;color:#231f20;}
-->
</style>
<div id="page45-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC045.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft4511">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft4511">43</p>
<p style="position:absolute;top:192px;left:377px;white-space:nowrap" class="ft4595">Customer</p>
<p style="position:absolute;top:209px;left:384px;white-space:nowrap" class="ft4595">Network</p>
<p style="position:absolute;top:258px;left:397px;white-space:nowrap" class="ft4595">DMZ</p>
<p style="position:absolute;top:258px;left:507px;white-space:nowrap" class="ft4595">Internet</p>
<p style="position:absolute;top:192px;left:485px;white-space:nowrap" class="ft4595">Management</p>
<p style="position:absolute;top:209px;left:505px;white-space:nowrap" class="ft4595">Network</p>
<p style="position:absolute;top:306px;left:366px;white-space:nowrap" class="ft4511">Figure&#160;2.21:&#160;Virtual&#160;Network&#160;Topology</p>
<p style="position:absolute;top:340px;left:327px;white-space:nowrap" class="ft4511">from/to</p>
<p style="position:absolute;top:339px;left:406px;white-space:nowrap" class="ft4596">Cust</p>
<p style="position:absolute;top:339px;left:441px;white-space:nowrap" class="ft4554">.</p>
<p style="position:absolute;top:339px;left:463px;white-space:nowrap" class="ft4596">DMZ</p>
<p style="position:absolute;top:339px;left:521px;white-space:nowrap" class="ft4596">Mgmt</p>
<p style="position:absolute;top:339px;left:567px;white-space:nowrap" class="ft4554">.</p>
<p style="position:absolute;top:340px;left:589px;white-space:nowrap" class="ft4520"><b>Internet</b></p>
<p style="position:absolute;top:361px;left:327px;white-space:nowrap" class="ft4596">Cust</p>
<p style="position:absolute;top:361px;left:362px;white-space:nowrap" class="ft4554">.</p>
<p style="position:absolute;top:361px;left:406px;white-space:nowrap" class="ft4511">1</p>
<p style="position:absolute;top:361px;left:463px;white-space:nowrap" class="ft4511">1</p>
<p style="position:absolute;top:361px;left:521px;white-space:nowrap" class="ft4511">1</p>
<p style="position:absolute;top:361px;left:589px;white-space:nowrap" class="ft4511">0</p>
<p style="position:absolute;top:380px;left:327px;white-space:nowrap" class="ft4596">DMZ</p>
<p style="position:absolute;top:380px;left:406px;white-space:nowrap" class="ft4511">1</p>
<p style="position:absolute;top:380px;left:463px;white-space:nowrap" class="ft4511">1</p>
<p style="position:absolute;top:380px;left:521px;white-space:nowrap" class="ft4511">0</p>
<p style="position:absolute;top:380px;left:589px;white-space:nowrap" class="ft4511">1</p>
<p style="position:absolute;top:398px;left:327px;white-space:nowrap" class="ft4596">Mgmt</p>
<p style="position:absolute;top:398px;left:372px;white-space:nowrap" class="ft4554">.</p>
<p style="position:absolute;top:398px;left:406px;white-space:nowrap" class="ft4511">1</p>
<p style="position:absolute;top:398px;left:463px;white-space:nowrap" class="ft4511">0</p>
<p style="position:absolute;top:398px;left:521px;white-space:nowrap" class="ft4511">1</p>
<p style="position:absolute;top:398px;left:589px;white-space:nowrap" class="ft4511">0</p>
<p style="position:absolute;top:417px;left:327px;white-space:nowrap" class="ft4596">Internet</p>
<p style="position:absolute;top:417px;left:406px;white-space:nowrap" class="ft4511">0</p>
<p style="position:absolute;top:417px;left:463px;white-space:nowrap" class="ft4511">1</p>
<p style="position:absolute;top:417px;left:521px;white-space:nowrap" class="ft4511">0</p>
<p style="position:absolute;top:417px;left:589px;white-space:nowrap" class="ft4511">0</p>
<p style="position:absolute;top:449px;left:383px;white-space:nowrap" class="ft4511">Figure&#160;2.22:&#160;Flow&#160;Control&#160;Matrix</p>
<p style="position:absolute;top:498px;left:226px;white-space:nowrap" class="ft4512">flow&#160;control&#160;objectives&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#69">[4]</a>.&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#45">2.22&#160;</a>shows&#160;a&#160;sample&#160;matrix&#160;for&#160;the&#160;four&#160;virtual<br/>network&#160;zones.&#160;Each&#160;matrix&#160;element&#160;represents&#160;a&#160;policy&#160;specifying&#160;the&#160;information<br/>flows&#160;permitted&#160;between&#160;a&#160;pair&#160;of&#160;network&#160;zones.&#160;The&#160;1&#160;elements&#160;along&#160;the&#160;matrix<br/>diagonal&#160;convey&#160;the&#160;fact&#160;that&#160;there&#160;is&#160;free&#160;information&#160;flow&#160;within&#160;each&#160;network&#160;zone.<br/>The&#160;0&#160;elements&#160;in&#160;the&#160;matrix&#160;are&#160;used&#160;to&#160;specify&#160;that&#160;there&#160;should&#160;be&#160;no&#160;information<br/>flow&#160;between&#160;two&#160;zones,&#160;e.g.,&#160;between&#160;the&#160;management&#160;zone&#160;and&#160;the&#160;Internet.</p>
<p style="position:absolute;top:605px;left:248px;white-space:nowrap" class="ft4511">In&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#69">[4]</a>,&#160;we&#160;described&#160;a&#160;Xen-based&#160;prototype&#160;of&#160;a&#160;secure&#160;network&#160;virtualization&#160;ar-</p>
<p style="position:absolute;top:623px;left:226px;white-space:nowrap" class="ft4513">chitecture&#160;that&#160;is&#160;based&#160;on&#160;the&#160;concept&#160;of&#160;Trusted&#160;Virtual&#160;Domains.&#160;The&#160;architecture<br/>allows&#160;arbitrary&#160;network&#160;topologies&#160;connecting&#160;VMs.&#160;For&#160;example,&#160;different&#160;VMs&#160;on<br/>the&#160;same&#160;physical&#160;infrastructure&#160;may&#160;belong&#160;to&#160;different&#160;virtual&#160;network&#160;zones.&#160;Despite<br/>this,&#160;the&#160;architecture&#160;ensures&#160;the&#160;enforcement&#160;of&#160;policy-based&#160;information&#160;flow&#160;control.<br/>We&#160;can&#160;use&#160;the&#160;architecture&#160;for&#160;enforcing&#160;the&#160;policies&#160;shown&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#45">2.22.</a></p>
<p style="position:absolute;top:731px;left:309px;white-space:nowrap" class="ft4594">&lt;flow-policy&gt;</p>
<p style="position:absolute;top:748px;left:325px;white-space:nowrap" class="ft4594">&lt;zone&#160;id=&#34;customer1&#34;&gt;</p>
<p style="position:absolute;top:764px;left:341px;white-space:nowrap" class="ft4594">&lt;permit&#160;id=&#34;mgmt-net&#34;&#160;/&gt;</p>
<p style="position:absolute;top:781px;left:341px;white-space:nowrap" class="ft4594">&lt;permit&#160;id=&#34;cust1-dmz&#34;&#160;/&gt;</p>
<p style="position:absolute;top:797px;left:325px;white-space:nowrap" class="ft4594">&lt;/zone&gt;&#160;...</p>
<p style="position:absolute;top:814px;left:309px;white-space:nowrap" class="ft4594">&lt;/flow-policy&gt;</p>
<p style="position:absolute;top:867px;left:358px;white-space:nowrap" class="ft4511">Figure&#160;2.23:&#160;Flow&#160;Control&#160;Policy&#160;in&#160;XML</p>
<p style="position:absolute;top:903px;left:248px;white-space:nowrap" class="ft4511">By&#160;combining&#160;the&#160;Xen&#160;prototypes&#160;of&#160;our&#160;PEV&#160;architecture&#160;and&#160;our&#160;secure&#160;network</p>
<p style="position:absolute;top:921px;left:226px;white-space:nowrap" class="ft4513">virtualization&#160;architecture,&#160;it&#160;is&#160;possible&#160;to&#160;validate&#160;the&#160;configuration&#160;of&#160;the&#160;virtual&#160;net-<br/>working&#160;subsystem&#160;on&#160;each&#160;host.&#160;The&#160;subsystem&#160;exports&#160;an&#160;XML&#160;version&#160;of&#160;its&#160;flow<br/>control&#160;matrix,&#160;as&#160;shown&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#45">2.23.&#160;</a>The&#160;network&#160;measurement&#160;plug-in&#160;outputs<br/>the&#160;XML&#160;structure&#160;of&#160;the&#160;flow-control&#160;policy,&#160;when&#160;invoked&#160;by&#160;the&#160;IM.&#160;By&#160;request-<br/>ing&#160;attestation&#160;of&#160;the&#160;TCB&#160;and&#160;this&#160;policy,&#160;a&#160;verifier&#160;can&#160;obtain&#160;a&#160;compliance&#160;proof<br/>for&#160;the&#160;correct&#160;configuration&#160;of&#160;the&#160;virtual&#160;networking&#160;subsystem&#160;on&#160;a&#160;given&#160;host.&#160;At<br/>the&#160;verifier,&#160;a&#160;XSLT&#160;stylesheet&#160;is&#160;used&#160;to&#160;perform&#160;further&#160;transformations&#160;on&#160;the&#160;XML<br/>file&#160;returned&#160;by&#160;the&#160;platform.&#160;The&#160;XSLT&#160;stylesheet&#160;is&#160;a&#160;concrete&#160;implementation&#160;of<br/>the&#160;evaluation&#160;function</p>
<p style="position:absolute;top:1064px;left:372px;white-space:nowrap" class="ft4562">f</p>
<p style="position:absolute;top:1064px;left:377px;white-space:nowrap" class="ft4555">()</p>
<p style="position:absolute;top:1065px;left:394px;white-space:nowrap" class="ft4511">(described&#160;in&#160;Section&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#34">2.5.2)</a>,&#160;which&#160;assesses&#160;whether&#160;the</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft4518">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 46 -->
<a name="46"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page46-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC046.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft4611">44</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft4618">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft4613">platform&#160;is&#160;trustworthy&#160;from&#160;the&#160;verifier’s&#160;point&#160;of&#160;view.&#160;The&#160;result&#160;of&#160;the&#160;evaluation<br/>function&#160;will&#160;serve&#160;to&#160;convince&#160;the&#160;verifier&#160;that&#160;the&#160;policy&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#45">2.22&#160;</a>is&#160;the&#160;actual<br/>flow-control&#160;policy&#160;as&#160;enforced&#160;by&#160;the&#160;network&#160;subsystem.&#160;If&#160;privacy&#160;is&#160;an&#160;important<br/>concern,&#160;the&#160;XML&#160;output&#160;from&#160;the&#160;plug-in&#160;modules&#160;may&#160;be&#160;first&#160;processed&#160;by&#160;an&#160;XSLT<br/>stylesheet&#160;that&#160;implements&#160;a&#160;privacy&#160;filter&#160;before&#160;passing&#160;it&#160;on&#160;to&#160;the&#160;verifier.&#160;In&#160;such&#160;a<br/>case,&#160;the&#160;stylesheet&#160;would&#160;be&#160;embedded&#160;in&#160;the&#160;platform&#160;TCB.</p>
<p style="position:absolute;top:317px;left:168px;white-space:nowrap" class="ft4694">&lt;xsl:template</p>
<p style="position:absolute;top:334px;left:184px;white-space:nowrap" class="ft4694">match=&#34;/flow-policy/zone[@id=’customer1’]&#34;&gt;</p>
<p style="position:absolute;top:350px;left:184px;white-space:nowrap" class="ft4694">&lt;xsl:choose&gt;&#160;&lt;xsl:if</p>
<p style="position:absolute;top:367px;left:216px;white-space:nowrap" class="ft4694">test=&#34;count(*[@id=’cust1-dmz’])=1</p>
<p style="position:absolute;top:383px;left:265px;white-space:nowrap" class="ft4694">and&#160;count(*[@id=’mgmt-net’])=1&#34;&gt;</p>
<p style="position:absolute;top:400px;left:216px;white-space:nowrap" class="ft4694">&lt;true&#160;/&gt;</p>
<p style="position:absolute;top:416px;left:200px;white-space:nowrap" class="ft4694">&lt;/xsl:if&gt;</p>
<p style="position:absolute;top:433px;left:184px;white-space:nowrap" class="ft4694">&lt;/xsl:choose&gt;</p>
<p style="position:absolute;top:449px;left:168px;white-space:nowrap" class="ft4694">&lt;/xsl:template&gt;</p>
<p style="position:absolute;top:503px;left:319px;white-space:nowrap" class="ft4611">Figure&#160;2.24:&#160;XSLT&#160;Condition</p>
<p style="position:absolute;top:536px;left:172px;white-space:nowrap" class="ft4611">A&#160;user&#160;can&#160;also&#160;protect&#160;sensitive&#160;information&#160;(say,&#160;an&#160;encryption&#160;key)&#160;against&#160;access</p>
<p style="position:absolute;top:554px;left:150px;white-space:nowrap" class="ft4612">by&#160;an&#160;untrusted&#160;network&#160;configuration&#160;using&#160;a&#160;two-stage&#160;procedure.&#160;The&#160;first&#160;stage&#160;is<br/>sealing,&#160;in&#160;which&#160;the&#160;user&#160;has&#160;to&#160;specify&#160;the&#160;binary&#160;configuration&#160;of&#160;the&#160;TCB&#160;and&#160;condi-<br/>tions&#160;for&#160;checking&#160;whether&#160;a&#160;given&#160;network&#160;configuration&#160;is&#160;a&#160;trusted&#160;one.&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#46">2.24<br/></a>shows&#160;an&#160;XSLT&#160;script&#160;that&#160;encodes&#160;the&#160;condition&#160;that&#160;the&#160;customer&#160;network&#160;should&#160;be<br/>directly&#160;connected&#160;only&#160;to&#160;the&#160;DMZ&#160;and&#160;the&#160;management&#160;network&#160;of&#160;the&#160;outsourcing<br/>provider,&#160;but&#160;not&#160;to&#160;any&#160;other&#160;network.&#160;The&#160;input&#160;to&#160;the&#160;XSLT&#160;script&#160;is&#160;the&#160;XML&#160;pol-<br/>icy&#160;that&#160;is&#160;output&#160;by&#160;the&#160;network&#160;measurement&#160;plug-in.&#160;The&#160;XSLT&#160;script&#160;is&#160;a&#160;concrete<br/>realisation&#160;of&#160;the&#160;user-specified&#160;predicate</p>
<p style="position:absolute;top:679px;left:402px;white-space:nowrap" class="ft4655">Π</p>
<p style="position:absolute;top:680px;left:417px;white-space:nowrap" class="ft4611">in&#160;our&#160;formal&#160;model&#160;(Section&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#32">2.5.2)</a>.&#160;The</p>
<p style="position:absolute;top:698px;left:150px;white-space:nowrap" class="ft4612">user&#160;seals&#160;the&#160;key&#160;to&#160;both&#160;the&#160;state&#160;of&#160;the&#160;TCB&#160;and&#160;the&#160;value&#160;of&#160;a&#160;resettable&#160;PCR;&#160;the<br/>latter&#160;reflects&#160;the&#160;integrity&#160;of&#160;the&#160;XSLT&#160;script&#160;and&#160;the&#160;integrity&#160;of&#160;the&#160;plug-in&#160;identifier.<br/>The&#160;second&#160;stage&#160;is&#160;unsealing,&#160;in&#160;which&#160;the&#160;IM&#160;(i)&#160;obtains&#160;the&#160;result&#160;of&#160;the&#160;plug-in,<br/>(ii)&#160;applies&#160;the&#160;result&#160;as&#160;input&#160;to&#160;the&#160;XSLT&#160;script,&#160;(iii)&#160;extends&#160;the&#160;resettable&#160;PCR&#160;with<br/>the&#160;hash&#160;of&#160;the&#160;XSLT&#160;script&#160;and&#160;the&#160;network&#160;measurement&#160;plug-in&#160;identifier,&#160;and&#160;(iv)<br/>tries&#160;to&#160;unseal&#160;the&#160;actual&#160;key.&#160;For&#160;steps&#160;(iii)&#160;and&#160;(iv),&#160;the&#160;IM&#160;invokes&#160;the&#160;Attestation<br/>&amp;&#160;Sealing&#160;Plug-in.&#160;The&#160;TPM&#160;should&#160;only&#160;reveal&#160;the&#160;key&#160;if&#160;the&#160;TCB&#160;is&#160;correct&#160;and&#160;the<br/>XSLT&#160;evaluated&#160;to</p>
<p style="position:absolute;top:824px;left:265px;white-space:nowrap" class="ft4646">&lt;true/&gt;</p>
<p style="position:absolute;top:823px;left:332px;white-space:nowrap" class="ft4611">when&#160;executed&#160;on&#160;their&#160;output.</p>
<p style="position:absolute;top:881px;left:150px;white-space:nowrap" class="ft4633"><b>2.5.6</b></p>
<p style="position:absolute;top:881px;left:204px;white-space:nowrap" class="ft4633"><b>Conclusion</b></p>
<p style="position:absolute;top:911px;left:150px;white-space:nowrap" class="ft4612">We&#160;introduced&#160;a&#160;formal&#160;model&#160;for&#160;managing&#160;the&#160;integrity&#160;of&#160;arbitrary&#160;aspects&#160;of&#160;a&#160;virtu-<br/>alized&#160;system&#160;and&#160;evaluating&#160;system&#160;compliance&#160;with&#160;respect&#160;to&#160;given&#160;security&#160;policies.<br/>Based&#160;on&#160;the&#160;model,&#160;we&#160;described&#160;an&#160;architecture,&#160;called&#160;PEV,&#160;for&#160;protecting&#160;security<br/>policies&#160;against&#160;modification,&#160;and&#160;allowing&#160;stakeholders&#160;to&#160;verify&#160;the&#160;policies&#160;actually<br/>implemented.&#160;We&#160;generalised&#160;the&#160;integrity&#160;management&#160;functions&#160;of&#160;the&#160;Trusted&#160;Plat-<br/>form&#160;Module,&#160;so&#160;that&#160;they&#160;are&#160;applicable&#160;not&#160;just&#160;for&#160;software&#160;binaries&#160;but&#160;also&#160;for<br/>checking&#160;past&#160;security&#160;compliance&#160;and&#160;enforcing&#160;security&#160;policies&#160;in&#160;the&#160;future.&#160;We<br/>described&#160;a&#160;prototype&#160;implementation&#160;of&#160;the&#160;architecture&#160;based&#160;on&#160;the&#160;Xen&#160;hypervi-<br/>sor.&#160;We&#160;also&#160;presented&#160;multiple&#160;use-cases&#160;to&#160;demonstrate&#160;the&#160;policy-enforcement&#160;and<br/>compliance-checking&#160;capabilities&#160;of&#160;our&#160;implementation.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft4618">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 47 -->
<a name="47"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page47-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC047.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft4711">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft4711">45</p>
<p style="position:absolute;top:239px;left:226px;white-space:nowrap" class="ft4722"><b>2.6</b></p>
<p style="position:absolute;top:239px;left:274px;white-space:nowrap" class="ft4722"><b>Xen&#160;Secure&#160;GUI&#160;Services</b></p>
<p style="position:absolute;top:303px;left:590px;white-space:nowrap" class="ft4711">S.&#160;Cabuk,&#160;P.&#160;Grete&#160;(HPL)</p>
<p style="position:absolute;top:329px;left:226px;white-space:nowrap" class="ft4713">This&#160;section&#160;introduces&#160;a&#160;preliminary&#160;secure&#160;GUI&#160;design&#160;on&#160;a&#160;virtualized&#160;Xen&#160;environ-<br/>ment.&#160;Part&#160;of&#160;this&#160;work&#160;is&#160;incorporated&#160;into&#160;the&#160;OpenTC&#160;demo.</p>
<p style="position:absolute;top:405px;left:226px;white-space:nowrap" class="ft4733"><b>2.6.1</b></p>
<p style="position:absolute;top:405px;left:280px;white-space:nowrap" class="ft4733"><b>An&#160;Example&#160;Secure&#160;GUI&#160;Use&#160;Case</b></p>
<p style="position:absolute;top:435px;left:226px;white-space:nowrap" class="ft4712">Desktop&#160;virtualisation&#160;is&#160;an&#160;emerging&#160;topic&#160;particularly&#160;thanks&#160;to&#160;increasing&#160;hardware<br/>virtualisation&#160;support&#160;by&#160;Intel&#160;and&#160;AMD.&#160;If&#160;different&#160;domains&#160;are&#160;running&#160;on&#160;the&#160;same<br/>physical&#160;platform,&#160;e.g.,&#160;a&#160;work&#160;environment&#160;with&#160;corporate&#160;data&#160;and&#160;a&#160;private&#160;one&#160;with<br/>games&#160;or&#160;other&#160;potentially&#160;untrusted&#160;software,&#160;it&#160;is&#160;essential&#160;that&#160;no&#160;environment&#160;has<br/>access&#160;to&#160;or&#160;has&#160;an&#160;affect&#160;on&#160;the&#160;other.&#160;This&#160;leads&#160;to&#160;the&#160;need&#160;for&#160;a&#160;secure&#160;graphical<br/>user&#160;interface&#160;(sGUI),&#160;which&#160;is&#160;capable&#160;of&#160;ensuring&#160;security&#160;and&#160;separation&#160;between<br/>standard&#160;tasks&#160;in&#160;window-based&#160;systems,&#160;such&#160;as</p>
<p style="position:absolute;top:587px;left:245px;white-space:nowrap" class="ft4711">1.&#160;keyboard/mouse&#160;input,</p>
<p style="position:absolute;top:615px;left:245px;white-space:nowrap" class="ft4711">2.&#160;copy&#160;and&#160;paste&#160;actions,</p>
<p style="position:absolute;top:643px;left:245px;white-space:nowrap" class="ft4711">3.&#160;screenshots,&#160;and</p>
<p style="position:absolute;top:671px;left:245px;white-space:nowrap" class="ft4711">4.&#160;sound.</p>
<p style="position:absolute;top:698px;left:248px;white-space:nowrap" class="ft4711">As&#160;an&#160;example&#160;requirement,&#160;it&#160;should&#160;not&#160;be&#160;possible&#160;to&#160;take&#160;screenshots&#160;of&#160;any</p>
<p style="position:absolute;top:715px;left:226px;white-space:nowrap" class="ft4711">compartment&#160;with&#160;a&#160;different&#160;trust&#160;level&#160;than&#160;the&#160;active&#160;environment.</p>
<p style="position:absolute;top:773px;left:226px;white-space:nowrap" class="ft4733"><b>2.6.2</b></p>
<p style="position:absolute;top:773px;left:280px;white-space:nowrap" class="ft4733"><b>Current&#160;State</b></p>
<p style="position:absolute;top:803px;left:226px;white-space:nowrap" class="ft4712">The&#160;current&#160;setup&#160;of&#160;the&#160;OpenTC&#160;demonstrator&#160;uses&#160;an&#160;SDL-widget-based&#160;ParaGUI<br/>interface&#160;running&#160;on&#160;top&#160;of&#160;a&#160;dom0&#160;X-server&#160;(see&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#48">2.25)</a>.&#160;This&#160;interface&#160;is&#160;only<br/>used&#160;for&#160;the&#160;graphical&#160;control&#160;of&#160;low-level&#160;guest&#160;domain&#160;management,&#160;e.g.&#160;booting,<br/>stopping&#160;the&#160;domain&#160;or&#160;displaying&#160;the&#160;type&#160;of&#160;operating&#160;system&#160;with&#160;the&#160;help&#160;of&#160;a&#160;small<br/>icon.&#160;The&#160;ParaGUI&#160;runs&#160;on&#160;top&#160;of&#160;each&#160;virtual&#160;domain&#160;that&#160;enables&#160;users&#160;to&#160;switch<br/>between&#160;the&#160;domains.&#160;Other&#160;domains,&#160;including&#160;the&#160;dom0,&#160;have&#160;their&#160;own&#160;workspace<br/>within&#160;the&#160;dom0&#160;X-server.&#160;Their&#160;desktop&#160;environment&#160;is&#160;displayed&#160;using&#160;the&#160;VNC<br/>protocol&#160;and&#160;the&#160;Xen&#160;TCP/IP&#160;network&#160;stack.&#160;The&#160;input&#160;handling&#160;is&#160;done&#160;completely<br/>by&#160;the&#160;X-server&#160;and&#160;switching&#160;between&#160;desktops&#160;of&#160;different&#160;domains&#160;is&#160;realized&#160;by<br/>simple&#160;X-server&#160;shortcuts.&#160;Furthermore&#160;the&#160;X-server&#160;talks&#160;to&#160;the&#160;graphics&#160;card&#160;with&#160;its<br/>own&#160;drivers.</p>
<p style="position:absolute;top:1001px;left:248px;white-space:nowrap" class="ft4711">This&#160;solution&#160;provides&#160;minimal&#160;security&#160;for&#160;several&#160;reasons.&#160;First,&#160;X-server&#160;has&#160;a</p>
<p style="position:absolute;top:1018px;left:226px;white-space:nowrap" class="ft4713">large&#160;code-space&#160;that&#160;needs&#160;to&#160;be&#160;trusted.&#160;Second,&#160;Dom0&#160;is&#160;given&#160;full&#160;control&#160;over&#160;all<br/>workspaces&#160;through&#160;the&#160;X-server.&#160;This&#160;latter&#160;property&#160;can&#160;allow&#160;a&#160;malicious&#160;entity&#160;to<br/>capture&#160;screenshots&#160;of&#160;other&#160;desktops&#160;with&#160;reasonable&#160;effort&#160;using&#160;X&#160;libraries.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft4718">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 48 -->
<a name="48"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page48-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC048.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft4811">46</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft4818">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:439px;left:311px;white-space:nowrap" class="ft4811">Figure&#160;2.25:&#160;sGUI&#160;Current&#160;State</p>
<p style="position:absolute;top:483px;left:150px;white-space:nowrap" class="ft4833"><b>2.6.3</b></p>
<p style="position:absolute;top:483px;left:204px;white-space:nowrap" class="ft4833"><b>Prototype&#160;Design</b></p>
<p style="position:absolute;top:513px;left:150px;white-space:nowrap" class="ft4813">Our&#160;first&#160;design&#160;for&#160;a&#160;prototype&#160;addresses&#160;the&#160;shortcomings&#160;presented&#160;in&#160;the&#160;previous<br/>section.&#160;In&#160;particular,&#160;we&#160;have&#160;enhanced&#160;the&#160;current&#160;design&#160;by:&#160;(1)&#160;reducing&#160;the&#160;size<br/>of&#160;the&#160;sGUI&#160;codebase,&#160;(2)&#160;disaggregating&#160;the&#160;sGUI&#160;into&#160;a&#160;separate&#160;domain,&#160;and&#160;(3)<br/>employing&#160;additional&#160;hardware&#160;acceleration&#160;techniques.</p>
<p style="position:absolute;top:625px;left:150px;white-space:nowrap" class="ft4820"><b>Codebase&#160;Reduction</b></p>
<p style="position:absolute;top:692px;left:150px;white-space:nowrap" class="ft4820"><b>Layout</b></p>
<p style="position:absolute;top:692px;left:210px;white-space:nowrap" class="ft4811">One&#160;problem&#160;with&#160;the&#160;current&#160;sGUI&#160;design&#160;is&#160;the&#160;size&#160;of&#160;the&#160;codebase&#160;that</p>
<p style="position:absolute;top:710px;left:150px;white-space:nowrap" class="ft4812">needs&#160;to&#160;be&#160;trusted.&#160;To&#160;address&#160;this,&#160;we&#160;remove&#160;the&#160;large&#160;X-server&#160;and&#160;implement&#160;a<br/>secure&#160;GUI&#160;(sGUI)&#160;with&#160;a&#160;trusted&#160;code&#160;base&#160;instead.&#160;This&#160;secure&#160;GUI&#160;has&#160;multiple<br/>virtual&#160;framebuffers&#160;(VFB)&#160;(the&#160;virtual&#160;equivalent&#160;of&#160;a&#160;region&#160;in&#160;memory&#160;to&#160;store&#160;the<br/>screen&#160;image)&#160;that&#160;are&#160;used&#160;directly&#160;by&#160;the&#160;desktop&#160;environment&#160;in&#160;dom0&#160;and&#160;via&#160;a<br/>memory&#160;mapping&#160;within&#160;the&#160;domUs.&#160;These&#160;VFBs&#160;can&#160;be&#160;treated&#160;as&#160;normal&#160;framebuffer<br/>devices&#160;and&#160;therefore&#160;all&#160;domains&#160;are&#160;able&#160;to&#160;run&#160;unmodified&#160;X-servers&#160;themselves&#160;or<br/>any&#160;other&#160;framebuffer-based&#160;application.</p>
<p style="position:absolute;top:836px;left:172px;white-space:nowrap" class="ft4811">The&#160;final&#160;step&#160;to&#160;display&#160;the&#160;actual&#160;screen&#160;on&#160;the&#160;monitor&#160;is&#160;a&#160;simple&#160;mapping&#160;be-</p>
<p style="position:absolute;top:853px;left:150px;white-space:nowrap" class="ft4811">tween&#160;the&#160;active&#160;VFB&#160;and&#160;the&#160;kernel&#160;framebuffer</p>
<p style="position:absolute;top:863px;left:444px;white-space:nowrap" class="ft4860">/dev/fb0</p>
<p style="position:absolute;top:853px;left:505px;white-space:nowrap" class="ft4811">.&#160;This&#160;mapping&#160;is&#160;possible,</p>
<p style="position:absolute;top:871px;left:150px;white-space:nowrap" class="ft4812">since&#160;the&#160;Xen-based&#160;environment&#160;offers&#160;the&#160;possiblity&#160;to&#160;use&#160;shared&#160;memory&#160;and&#160;no<br/>further&#160;modification&#160;to&#160;the&#160;actual&#160;screen&#160;output&#160;likewise&#160;memory&#160;content&#160;is&#160;needed&#160;to<br/>display&#160;the&#160;correct&#160;output.&#160;As&#160;illustrated&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#49">2.26,&#160;</a>the&#160;sGUI&#160;takes&#160;care&#160;of&#160;all&#160;input<br/>handling&#160;by&#160;receiving&#160;all&#160;events&#160;and&#160;forwarding&#160;them&#160;to&#160;the&#160;active&#160;domain.</p>
<p style="position:absolute;top:965px;left:150px;white-space:nowrap" class="ft4820"><b>Security&#160;analysis</b></p>
<p style="position:absolute;top:965px;left:273px;white-space:nowrap" class="ft4811">The&#160;introduction&#160;of&#160;an&#160;input&#160;management&#160;system&#160;ensures&#160;that&#160;all</p>
<p style="position:absolute;top:983px;left:150px;white-space:nowrap" class="ft4812">input&#160;actions&#160;are&#160;strictly&#160;separated&#160;between&#160;the&#160;domains.&#160;This&#160;management&#160;system<br/>receives&#160;all&#160;input&#160;events&#160;and&#160;forwards&#160;them&#160;to&#160;the&#160;active&#160;domain&#160;only.&#160;Further,&#160;the<br/>exchange&#160;of&#160;the&#160;X-server&#160;by&#160;an&#160;sGUI&#160;solution&#160;with&#160;a&#160;trusted&#160;code&#160;base&#160;results&#160;in&#160;con-<br/>siderably&#160;fewer&#160;lines&#160;of&#160;code.&#160;This&#160;improvement&#160;is&#160;the&#160;first&#160;element&#160;of&#160;shrinking&#160;the<br/>trusted&#160;code&#160;base.&#160;The&#160;graphical&#160;management&#160;is&#160;still&#160;kept&#160;in&#160;the&#160;privileged&#160;domain<br/>together&#160;with&#160;other&#160;potentially&#160;untrusted&#160;services.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft4818">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 49 -->
<a name="49"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page49-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC049.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft4911">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft4911">47</p>
<p style="position:absolute;top:488px;left:365px;white-space:nowrap" class="ft4911">Figure&#160;2.26:&#160;sGUI&#160;Codebase&#160;Reduction</p>
<p style="position:absolute;top:536px;left:226px;white-space:nowrap" class="ft4920"><b>Disaggregation</b></p>
<p style="position:absolute;top:564px;left:226px;white-space:nowrap" class="ft4920"><b>Layout</b></p>
<p style="position:absolute;top:564px;left:286px;white-space:nowrap" class="ft4911">Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#50">2.27&#160;</a>illustrates&#160;the&#160;disaggregated&#160;layout&#160;in&#160;which&#160;the&#160;complete&#160;sGUI</p>
<p style="position:absolute;top:582px;left:226px;white-space:nowrap" class="ft4913">and&#160;(kernel)&#160;graphics&#160;have&#160;moved&#160;from&#160;dom0&#160;to&#160;a&#160;separate&#160;graphics&#160;domain&#160;(domG).<br/>This&#160;new&#160;domain&#160;has&#160;direct&#160;hardware&#160;access&#160;to&#160;the&#160;graphics&#160;card&#160;and&#160;removes&#160;the&#160;con-<br/>trol&#160;from&#160;dom0.&#160;Xen&#160;is&#160;able&#160;to&#160;hide&#160;PCI&#160;devices&#160;from&#160;dom0’s&#160;Linux&#160;kernel&#160;and&#160;there-<br/>fore&#160;is&#160;able&#160;to&#160;hide&#160;the&#160;graphics&#160;card.&#160;Hiding&#160;a&#160;PCI&#160;device&#160;is&#160;realized&#160;by&#160;preventing&#160;the<br/>Linux&#160;kernel&#160;loading&#160;drivers&#160;and&#160;leaving&#160;the&#160;device&#160;unbound&#160;in&#160;the&#160;PCI&#160;backend.&#160;With<br/>this&#160;unbound&#160;graphics&#160;card,&#160;domG&#160;is&#160;able&#160;to&#160;bind&#160;the&#160;device&#160;to&#160;itself&#160;and&#160;run&#160;a&#160;kernel<br/>framebuffer&#160;with&#160;access&#160;to&#160;the&#160;graphics&#160;card&#160;memory.&#160;Mapping&#160;between&#160;the&#160;different<br/>virtual&#160;framebuffer&#160;and&#160;the&#160;kernel&#160;framebuffer&#160;is&#160;done&#160;the&#160;same&#160;way&#160;as&#160;described&#160;in&#160;the<br/>previous&#160;section.</p>
<p style="position:absolute;top:743px;left:248px;white-space:nowrap" class="ft4911">Similarly,&#160;keyboard&#160;and&#160;mouse&#160;are&#160;no&#160;longer&#160;under&#160;the&#160;control&#160;of&#160;dom0.&#160;An&#160;input</p>
<p style="position:absolute;top:761px;left:226px;white-space:nowrap" class="ft4913">manager&#160;forwards&#160;input&#160;actions&#160;to&#160;all&#160;domains,&#160;including&#160;the&#160;dom0.&#160;To&#160;this&#160;day&#160;there<br/>is&#160;no&#160;solution&#160;to&#160;binding&#160;PS/2&#160;devices&#160;to&#160;any&#160;other&#160;domain&#160;than&#160;the&#160;dom0.&#160;Simple<br/>forwarding&#160;is&#160;not&#160;sufficient&#160;with&#160;regard&#160;to&#160;security&#160;because&#160;the&#160;dom0&#160;should&#160;not&#160;control<br/>or&#160;access&#160;any&#160;input&#160;device&#160;directly.</p>
<p style="position:absolute;top:833px;left:248px;white-space:nowrap" class="ft4911">The&#160;implementation&#160;of&#160;a&#160;separate&#160;input&#160;frontend/backend&#160;will&#160;be&#160;completed&#160;in&#160;near</p>
<p style="position:absolute;top:851px;left:226px;white-space:nowrap" class="ft4912">future.&#160;Virtual&#160;input&#160;devices&#160;are&#160;already&#160;available&#160;for&#160;domains&#160;and&#160;only&#160;a&#160;proper&#160;redi-<br/>rection&#160;to&#160;another&#160;domain&#160;is&#160;lacking.&#160;For&#160;security&#160;reasons,&#160;the&#160;hypervisor&#160;console&#160;and<br/>a&#160;root&#160;console&#160;in&#160;dom0&#160;should&#160;still&#160;be&#160;available&#160;via&#160;a&#160;serial&#160;connection.</p>
<p style="position:absolute;top:926px;left:226px;white-space:nowrap" class="ft4920"><b>Security&#160;analysis</b></p>
<p style="position:absolute;top:926px;left:351px;white-space:nowrap" class="ft4911">This&#160;enhancemenent&#160;presents&#160;another&#160;level&#160;of&#160;reduction&#160;of&#160;the</p>
<p style="position:absolute;top:944px;left:226px;white-space:nowrap" class="ft4912">trusted&#160;code&#160;base.&#160;By&#160;disaggregating&#160;the&#160;privileged&#160;services&#160;from&#160;dom0,&#160;a&#160;new&#160;secure<br/>layer&#160;has&#160;been&#160;established.&#160;Further,&#160;the&#160;domG&#160;can&#160;be&#160;implemented&#160;without&#160;network<br/>support&#160;–&#160;one&#160;of&#160;the&#160;weakest&#160;points&#160;for&#160;intrusion.&#160;The&#160;main&#160;problem&#160;for&#160;both&#160;reduc-<br/>tion&#160;and&#160;disaggregation&#160;elements&#160;is&#160;the&#160;actual&#160;speed&#160;of&#160;the&#160;interface.&#160;Framebuffers&#160;and<br/>memory&#160;mapping&#160;are&#160;limited&#160;in&#160;speed&#160;and&#160;are&#160;done&#160;by&#160;the&#160;CPU.&#160;For&#160;applications&#160;that<br/>require&#160;3D&#160;graphics&#160;or&#160;a&#160;fast&#160;interface&#160;in&#160;general,&#160;this&#160;enhanced&#160;design&#160;does&#160;not&#160;pro-<br/>vide&#160;the&#160;amount&#160;of&#160;graphics&#160;power&#160;needed.&#160;One&#160;solution&#160;is&#160;using&#160;hardware&#160;accelerated<br/>graphics&#160;which&#160;is&#160;described&#160;in&#160;detail&#160;in&#160;the&#160;next&#160;section.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft4918">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 50 -->
<a name="50"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page50-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC050.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft5011">48</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft5018">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:473px;left:305px;white-space:nowrap" class="ft5011">Figure&#160;2.27:&#160;sGUI&#160;Disaggregation</p>
<p style="position:absolute;top:521px;left:150px;white-space:nowrap" class="ft5020"><b>Hardware&#160;Acceleration</b></p>
<p style="position:absolute;top:549px;left:150px;white-space:nowrap" class="ft5020"><b>Layout</b></p>
<p style="position:absolute;top:549px;left:210px;white-space:nowrap" class="ft5011">The&#160;modification&#160;of&#160;the&#160;previous&#160;design&#160;as&#160;illustrated&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#51">2.28&#160;</a>yields&#160;a</p>
<p style="position:absolute;top:567px;left:150px;white-space:nowrap" class="ft5012">hardware&#160;accelerated&#160;sGUI.&#160;The&#160;new&#160;OpenGL-based&#160;design&#160;increases&#160;the&#160;speed&#160;of&#160;the<br/>desktop&#160;and&#160;enables&#160;the&#160;user&#160;to&#160;perform&#160;graphic-intense&#160;operations&#160;securely.</p>
<p style="position:absolute;top:603px;left:172px;white-space:nowrap" class="ft5011">Every&#160;domain&#160;that&#160;requires&#160;graphical&#160;output&#160;will&#160;be&#160;extended&#160;by&#160;an&#160;OpenGLAPI</p>
<p style="position:absolute;top:621px;left:150px;white-space:nowrap" class="ft5012">as&#160;part&#160;the&#160;the&#160;X-server.&#160;This&#160;API&#160;is&#160;able&#160;to&#160;display&#160;the&#160;whole&#160;desktop&#160;using&#160;OpenGL<br/>commands.&#160;It&#160;sends&#160;the&#160;commands&#160;directly&#160;to&#160;the&#160;domain’s&#160;graphics&#160;driver,&#160;which&#160;is<br/>merely&#160;a&#160;listening&#160;client&#160;forwarding&#160;the&#160;commands&#160;to&#160;the&#160;sGUI&#160;in&#160;domG.&#160;The&#160;sGUI&#160;has<br/>a&#160;new&#160;screen&#160;multiplexing&#160;server,&#160;similar&#160;to&#160;the&#160;virtual&#160;framebuffers.&#160;It&#160;forwards&#160;the<br/>OpenGL&#160;commands&#160;from&#160;the&#160;active&#160;domain&#160;directly&#160;to&#160;the&#160;graphics&#160;card&#160;driver,&#160;which<br/>eventually&#160;makes&#160;use&#160;of&#160;hardware&#160;acceleration.&#160;The&#160;input&#160;management&#160;is&#160;handled&#160;in<br/>the&#160;same&#160;way&#160;as&#160;in&#160;the&#160;former&#160;setting.</p>
<p style="position:absolute;top:768px;left:150px;white-space:nowrap" class="ft5020"><b>Security&#160;analysis</b></p>
<p style="position:absolute;top:768px;left:274px;white-space:nowrap" class="ft5011">The&#160;OpenGL-based&#160;design&#160;offers&#160;the&#160;same&#160;level&#160;of&#160;security&#160;and</p>
<p style="position:absolute;top:786px;left:150px;white-space:nowrap" class="ft5013">trust&#160;as&#160;the&#160;previous&#160;design.&#160;The&#160;slight&#160;increase&#160;of&#160;the&#160;code&#160;base&#160;can&#160;be&#160;accepted&#160;given<br/>the&#160;additional&#160;value&#160;of&#160;hardware&#160;acceleration.</p>
<p style="position:absolute;top:844px;left:150px;white-space:nowrap" class="ft5020"><b>VMGL</b></p>
<p style="position:absolute;top:844px;left:211px;white-space:nowrap" class="ft5011">There&#160;is&#160;already&#160;a&#160;working&#160;basic&#160;implementation&#160;called&#160;VMGL2,&#160;which&#160;in-</p>
<p style="position:absolute;top:862px;left:150px;white-space:nowrap" class="ft5013">creases&#160;the&#160;speed&#160;by&#160;using&#160;native&#160;graphics&#160;card&#160;capabilites&#160;within&#160;a&#160;domU.&#160;This&#160;solu-<br/>tion&#160;yields&#160;“87%&#160;of&#160;the&#160;native&#160;speed”&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#70">[15]</a>.&#160;Unfortunately,&#160;VMGL&#160;needs&#160;an&#160;X-server<br/>at&#160;the&#160;moment&#160;to&#160;load&#160;its&#160;own&#160;OpenGL&#160;server&#160;driver.&#160;This&#160;can&#160;be&#160;solved&#160;by&#160;porting<br/>VMGL&#160;to&#160;a&#160;minimal&#160;OpenGL&#160;server&#160;such&#160;as&#160;miniglx3&#160;and&#160;enhancing&#160;miniglx&#160;with&#160;Xen<br/>support.</p>
<p style="position:absolute;top:952px;left:172px;white-space:nowrap" class="ft5011">The&#160;VMGL&#160;solution&#160;is&#160;not&#160;able&#160;to&#160;display&#160;unmodified&#160;domains,&#160;such&#160;as&#160;Windows,</p>
<p style="position:absolute;top:970px;left:150px;white-space:nowrap" class="ft5012">which&#160;had&#160;been&#160;possible&#160;with&#160;the&#160;implementation&#160;of&#160;our&#160;sGUI&#160;design.&#160;Hardware&#160;accel-<br/>eration&#160;in&#160;Windows&#160;domains&#160;is&#160;a&#160;general&#160;problem,&#160;since&#160;there&#160;is&#160;no&#160;OpenGL&#160;graphics<br/>card&#160;driver&#160;and&#160;Windows&#160;natively&#160;uses&#160;Direct3D.</p>
<p style="position:absolute;top:1023px;left:172px;white-space:nowrap" class="ft5011">In&#160;addition&#160;to&#160;this,&#160;further&#160;security&#160;features&#160;are&#160;needed&#160;within&#160;the&#160;current&#160;VMGL</p>
<p style="position:absolute;top:1041px;left:150px;white-space:nowrap" class="ft5012">solution&#160;because&#160;there&#160;is&#160;no&#160;strict&#160;separation&#160;between&#160;single&#160;domains.&#160;Every&#160;window<br/>is&#160;displayed&#160;in&#160;the&#160;X-server&#160;of&#160;dom0.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft5018">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 51 -->
<a name="51"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page51-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC051.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft5111">CHAPTER&#160;2.&#160;XEN&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft5111">49</p>
<p style="position:absolute;top:471px;left:357px;white-space:nowrap" class="ft5111">Figure&#160;2.28:&#160;sGUI&#160;Hardware&#160;Acceleration</p>
<p style="position:absolute;top:517px;left:226px;white-space:nowrap" class="ft5133"><b>2.6.4</b></p>
<p style="position:absolute;top:517px;left:280px;white-space:nowrap" class="ft5133"><b>Conclusion</b></p>
<p style="position:absolute;top:548px;left:226px;white-space:nowrap" class="ft5113">In&#160;our&#160;preliminary&#160;sGUI&#160;investigation,&#160;we&#160;have&#160;come&#160;up&#160;with&#160;sGUI&#160;designs&#160;that&#160;en-<br/>hance&#160;the&#160;security&#160;properties&#160;of&#160;the&#160;current&#160;solutions.&#160;We&#160;have&#160;included&#160;a&#160;simple&#160;ver-<br/>sion&#160;of&#160;the&#160;sGUI&#160;in&#160;the&#160;2007&#160;OpenTC&#160;demonstrator.&#160;In&#160;furture&#160;work,&#160;we&#160;will&#160;continue<br/>our&#160;work&#160;around&#160;the&#160;sGUI&#160;design&#160;(e.g.,&#160;hardware&#160;acceleration)&#160;and&#160;enhance&#160;the&#160;proto-<br/>type&#160;implementation&#160;on&#160;Xen.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft5118">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 52 -->
<a name="52"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page52-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC052.png" alt="background image"/>
<p style="position:absolute;top:295px;left:150px;white-space:nowrap" class="ft5221"><b>Chapter&#160;3</b></p>
<p style="position:absolute;top:365px;left:150px;white-space:nowrap" class="ft5219"><b>L4&#160;Security&#160;Services</b></p>
<p style="position:absolute;top:422px;left:217px;white-space:nowrap" class="ft5211">A.-R.&#160;Sadeghi,&#160;M.&#160;Wolf,&#160;C.&#160;Stüble,&#160;M.&#160;Scheibel,&#160;R.&#160;Landfermann,&#160;H.&#160;Löhr,</p>
<p style="position:absolute;top:440px;left:437px;white-space:nowrap" class="ft5211">S.&#160;Schulz,&#160;P.&#160;Stewin,&#160;M.&#160;Unger&#160;(RUB)</p>
<p style="position:absolute;top:519px;left:150px;white-space:nowrap" class="ft5222"><b>3.1</b></p>
<p style="position:absolute;top:519px;left:198px;white-space:nowrap" class="ft5222"><b>Introduction</b></p>
<p style="position:absolute;top:587px;left:271px;white-space:nowrap" class="ft5211">A.-R.&#160;Sadeghi,&#160;M.&#160;Wolf,&#160;C.&#160;Stüble,&#160;M.&#160;Scheibel,&#160;M.&#160;Unger&#160;(RUB)</p>
<p style="position:absolute;top:617px;left:150px;white-space:nowrap" class="ft5212">In&#160;this&#160;section&#160;give&#160;a&#160;short&#160;outline&#160;of&#160;the&#160;basic&#160;concepts&#160;and&#160;components&#160;of&#160;our&#160;secu-<br/>rity&#160;services,&#160;followed&#160;by&#160;a&#160;description&#160;of&#160;the&#160;implementation&#160;of&#160;these&#160;concepts&#160;and<br/>components.</p>
<p style="position:absolute;top:671px;left:172px;white-space:nowrap" class="ft5211">The&#160;general&#160;idea&#160;behind&#160;our&#160;architecture&#160;is&#160;to&#160;establish&#160;various&#160;compartments&#160;on</p>
<p style="position:absolute;top:688px;left:150px;white-space:nowrap" class="ft5212">one&#160;computing&#160;platform&#160;where&#160;each&#160;compartment&#160;can&#160;have&#160;its&#160;own&#160;security&#160;policy.<br/>The&#160;policy&#160;defines</p>
<p style="position:absolute;top:753px;left:172px;white-space:nowrap" class="ft5230">•</p>
<p style="position:absolute;top:754px;left:187px;white-space:nowrap" class="ft5212">the&#160;protection&#160;level&#160;for&#160;the&#160;data&#160;accessed&#160;and&#160;processed&#160;in&#160;a&#160;compartment&#160;as&#160;well<br/>as&#160;for&#160;the&#160;applications&#160;that&#160;run&#160;in&#160;this&#160;compartment,&#160;and</p>
<p style="position:absolute;top:801px;left:172px;white-space:nowrap" class="ft5230">•</p>
<p style="position:absolute;top:802px;left:187px;white-space:nowrap" class="ft5212">the&#160;information&#160;flow&#160;between&#160;individual&#160;compartments&#160;as&#160;well&#160;as&#160;between&#160;the<br/>compartments&#160;and&#160;external&#160;parties.</p>
<p style="position:absolute;top:850px;left:172px;white-space:nowrap" class="ft5211">The&#160;goal&#160;is&#160;that&#160;each&#160;compartment&#160;behaves&#160;as&#160;if&#160;it&#160;is&#160;a&#160;single&#160;platform&#160;separated</p>
<p style="position:absolute;top:868px;left:150px;white-space:nowrap" class="ft5212">from&#160;other&#160;compartments.&#160;Furthermore,&#160;the&#160;underlying&#160;architecture&#160;should&#160;provide<br/>channels&#160;to&#160;the&#160;corresponding&#160;compartments&#160;where&#160;the&#160;channel&#160;properties&#160;are&#160;specified<br/>by&#160;the&#160;overall&#160;security&#160;policy.</p>
<p style="position:absolute;top:962px;left:150px;white-space:nowrap" class="ft5233"><b>3.1.1</b></p>
<p style="position:absolute;top:962px;left:204px;white-space:nowrap" class="ft5233"><b>Basic&#160;Concepts</b></p>
<p style="position:absolute;top:992px;left:150px;white-space:nowrap" class="ft5212">The&#160;concepts&#160;of&#160;security&#160;services&#160;briefly&#160;sketched&#160;in&#160;the&#160;following&#160;section&#160;provide<br/>mechanisms&#160;to&#160;realise&#160;abstract&#160;concepts&#160;like,&#160;e.g.,&#160;trusted&#160;channels&#160;and&#160;trusted&#160;storage<br/>that&#160;have&#160;been&#160;defined&#160;to&#160;provide&#160;secure&#160;platforms&#160;for&#160;future&#160;applications.</p>
<p style="position:absolute;top:1117px;left:400px;white-space:nowrap" class="ft5211">50</p>
</div>
<!-- Page 53 -->
<a name="53"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft5397{font-size:10px;font-family:GNANIL+CMR7;color:#231f20;}
	.ft5398{font-size:12px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page53-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC053.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft5311">CHAPTER&#160;3.&#160;L4&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft5311">51</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft5320"><b>Terms&#160;and&#160;Definitions</b></p>
<p style="position:absolute;top:222px;left:226px;white-space:nowrap" class="ft5313">We&#160;define&#160;a&#160;<i>compartment&#160;</i>as&#160;a&#160;software&#160;component&#160;that&#160;is&#160;logically&#160;isolated&#160;from&#160;other<br/>software&#160;components.&#160;The&#160;<i>configuration&#160;</i>of&#160;a&#160;compartment&#160;unambiguously&#160;describes<br/>the&#160;compartment’s&#160;I/O&#160;behaviour&#160;based&#160;on&#160;its&#160;initial&#160;state</p>
<p style="position:absolute;top:257px;left:575px;white-space:nowrap" class="ft5354">S</p>
<p style="position:absolute;top:263px;left:584px;white-space:nowrap" class="ft5397">0</p>
<p style="position:absolute;top:257px;left:595px;white-space:nowrap" class="ft5311">and&#160;its&#160;set&#160;of&#160;state&#160;trans-</p>
<p style="position:absolute;top:275px;left:226px;white-space:nowrap" class="ft5311">actions&#160;that&#160;convey&#160;a&#160;compartment&#160;from&#160;state</p>
<p style="position:absolute;top:275px;left:507px;white-space:nowrap" class="ft5354">S</p>
<p style="position:absolute;top:280px;left:517px;white-space:nowrap" class="ft5361">i</p>
<p style="position:absolute;top:275px;left:526px;white-space:nowrap" class="ft5311">to&#160;state</p>
<p style="position:absolute;top:275px;left:575px;white-space:nowrap" class="ft5354">S</p>
<p style="position:absolute;top:280px;left:584px;white-space:nowrap" class="ft5361">i</p>
<p style="position:absolute;top:281px;left:588px;white-space:nowrap" class="ft5397">+1</p>
<p style="position:absolute;top:275px;left:604px;white-space:nowrap" class="ft5311">.&#160;Moreover,&#160;we&#160;distin-</p>
<p style="position:absolute;top:293px;left:226px;white-space:nowrap" class="ft5312">guish&#160;secure,&#160;trusted,&#160;and&#160;plain&#160;communication&#160;channels&#160;between&#160;compartments.&#160;<i>Plain<br/>channels&#160;</i>transfer&#160;data&#160;without&#160;providing&#160;any&#160;security&#160;property.&#160;<i>Secure&#160;channels&#160;</i>ensure<br/>confidentiality&#160;and&#160;integrity&#160;of&#160;the&#160;communicated&#160;data&#160;as&#160;well&#160;as&#160;the&#160;authenticity&#160;of<br/>the&#160;endpoint&#160;compartment.&#160;<i>Trusted&#160;channels&#160;</i>are&#160;secure&#160;channels&#160;that&#160;additionally&#160;val-<br/>idate&#160;the&#160;configuration&#160;of&#160;the&#160;endpoint&#160;compartment.&#160;Finally,&#160;<i>integrity&#160;</i>of&#160;information<br/>obtained&#160;from&#160;a&#160;channel&#160;or&#160;compartment&#160;is&#160;provided,&#160;if&#160;any&#160;modification&#160;is&#160;at&#160;least<br/>detectable.&#160;The&#160;<i>Trusted&#160;Computing&#160;Base&#160;</i>(TCB)&#160;consists&#160;of&#160;all&#160;security&#160;relevant&#160;com-<br/>ponents&#160;of&#160;the&#160;platform,&#160;e.g.,&#160;microkernel&#160;and&#160;security&#160;services.</p>
<p style="position:absolute;top:476px;left:226px;white-space:nowrap" class="ft5320"><b>Security&#160;Services</b></p>
<p style="position:absolute;top:504px;left:226px;white-space:nowrap" class="ft5312">These&#160;services&#160;allow&#160;applications&#160;to&#160;use&#160;enhanced&#160;security&#160;functionalities&#160;strengthened<br/>by&#160;Trusted&#160;Computing.&#160;They&#160;also&#160;mediate&#160;and&#160;monitor&#160;access&#160;to&#160;resources.&#160;Thus,<br/>they&#160;enforce&#160;isolation&#160;of&#160;compartments&#160;and&#160;control&#160;communication&#160;between&#160;processes<br/>running&#160;in&#160;different&#160;compartments.&#160;The&#160;following&#160;services&#160;are&#160;defined&#160;in&#160;our&#160;approach:</p>
<p style="position:absolute;top:583px;left:248px;white-space:nowrap" class="ft5330">•</p>
<p style="position:absolute;top:584px;left:263px;white-space:nowrap" class="ft5313"><b>Storage&#160;Manager:&#160;</b>The&#160;Storage&#160;Manager&#160;(<i>SM</i>)&#160;provides&#160;persistent&#160;storage&#160;for<br/>the&#160;other&#160;compartments&#160;while&#160;preserving&#160;<i>integrity</i>,&#160;<i>confidentiality</i>,&#160;<i>availability<br/></i>and&#160;<i>freshness&#160;</i>of&#160;the&#160;stored&#160;data.&#160;Moreover&#160;it&#160;enforces&#160;<i>strong&#160;isolation&#160;</i>by&#160;bind-<br/>ing&#160;the&#160;stored&#160;data&#160;to&#160;the&#160;compartment&#160;configuration&#160;and/or&#160;user&#160;secret<a href="Open_TC_D05.2_SecServicesPoC.html#53">s</a></p>
<p style="position:absolute;top:636px;left:701px;white-space:nowrap" class="ft5329"><a href="Open_TC_D05.2_SecServicesPoC.html#53">1</a></p>
<p style="position:absolute;top:638px;left:707px;white-space:nowrap" class="ft5311">.&#160;The</p>
<p style="position:absolute;top:656px;left:263px;white-space:nowrap" class="ft5312">Storage&#160;Manager&#160;gains&#160;access&#160;to&#160;the&#160;configuration&#160;of&#160;its&#160;clients&#160;by&#160;asking&#160;the<br/>Compartment&#160;Manager&#160;to&#160;provide&#160;the&#160;necessary&#160;information.</p>
<p style="position:absolute;top:701px;left:248px;white-space:nowrap" class="ft5330">•</p>
<p style="position:absolute;top:702px;left:263px;white-space:nowrap" class="ft5312"><b>Compartment&#160;Manager:&#160;</b>The&#160;Compartment&#160;Manager&#160;(<i>CM</i>)&#160;manages&#160;creation,<br/>update,&#160;and&#160;deletion&#160;of&#160;compartments.&#160;It&#160;controls&#160;which&#160;compartments&#160;are&#160;al-<br/>lowed&#160;to&#160;be&#160;started&#160;or&#160;stopped&#160;and&#160;by&#160;whom,&#160;thus&#160;enforces&#160;parts&#160;of&#160;the&#160;mandatory<br/>security&#160;policy.&#160;During&#160;startup&#160;of&#160;compartments,&#160;it&#160;derives&#160;their&#160;configurations<br/>to&#160;be&#160;able&#160;to&#160;offer&#160;a&#160;mapping&#160;between&#160;temporary&#160;compartment&#160;identifier<a href="Open_TC_D05.2_SecServicesPoC.html#53">s</a></p>
<p style="position:absolute;top:772px;left:710px;white-space:nowrap" class="ft5329"><a href="Open_TC_D05.2_SecServicesPoC.html#53">2</a></p>
<p style="position:absolute;top:774px;left:720px;white-space:nowrap" class="ft5311">and</p>
<p style="position:absolute;top:792px;left:263px;white-space:nowrap" class="ft5311">compartment&#160;configurations.</p>
<p style="position:absolute;top:819px;left:248px;white-space:nowrap" class="ft5330">•</p>
<p style="position:absolute;top:820px;left:263px;white-space:nowrap" class="ft5313"><b>Trust&#160;Manager:&#160;</b>The&#160;Trust&#160;Manager&#160;(<i>TM</i>)&#160;offers&#160;access&#160;to&#160;functions&#160;(e.g.,&#160;TPM<br/>functionalities)&#160;that&#160;can&#160;be&#160;used&#160;by&#160;application-level&#160;compartments&#160;to&#160;establish<br/>trusted&#160;channels&#160;between&#160;remote&#160;and&#160;local&#160;compartments&#160;or&#160;creating&#160;keys&#160;and<br/>certifying&#160;them.</p>
<p style="position:absolute;top:901px;left:248px;white-space:nowrap" class="ft5330">•</p>
<p style="position:absolute;top:902px;left:263px;white-space:nowrap" class="ft5312"><b>Secure&#160;I/O:&#160;</b>The&#160;Secure&#160;I/O&#160;(<i>SIO</i>)&#160;renders&#160;(e.g.,&#160;displays,&#160;plays,&#160;prints,&#160;etc.)<br/>content&#160;while&#160;preventing&#160;unauthorised&#160;information&#160;flow.&#160;Thus&#160;<i>SIO&#160;</i>incorporates<br/>all&#160;compartments&#160;that&#160;are&#160;responsible&#160;for&#160;secure&#160;output&#160;of&#160;content&#160;(e.g.,&#160;drivers,<br/>trusted&#160;GUI,&#160;etc.).</p>
<p style="position:absolute;top:982px;left:248px;white-space:nowrap" class="ft5311">In&#160;the&#160;following&#160;sections&#160;we&#160;explain&#160;how&#160;these&#160;services&#160;are&#160;used&#160;to&#160;provide&#160;the</p>
<p style="position:absolute;top:1000px;left:226px;white-space:nowrap" class="ft5312">necessary&#160;security&#160;properties&#160;and&#160;concepts,&#160;i.e.,&#160;privacy&#160;protection,&#160;trusted&#160;channels,<br/>trusted&#160;storage,&#160;and&#160;strong&#160;isolation.</p>
<p style="position:absolute;top:1043px;left:242px;white-space:nowrap" class="ft5331">1</p>
<p style="position:absolute;top:1046px;left:248px;white-space:nowrap" class="ft5316">Since&#160;<i>SM&#160;</i>does&#160;not&#160;provide&#160;sharing&#160;of&#160;data&#160;between&#160;compartments&#160;at&#160;the&#160;moment,&#160;it&#160;does&#160;not&#160;realise&#160;a</p>
<p style="position:absolute;top:1060px;left:226px;white-space:nowrap" class="ft5316">regular&#160;file&#160;system.</p>
<p style="position:absolute;top:1072px;left:242px;white-space:nowrap" class="ft5331">2</p>
<p style="position:absolute;top:1074px;left:247px;white-space:nowrap" class="ft5316">A&#160;compartment&#160;identifier&#160;unambiguously&#160;identifies&#160;a&#160;compartment&#160;during&#160;runtime.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft5318">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 54 -->
<a name="54"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page54-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC054.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft5411">52</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft5418">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:233px;left:150px;white-space:nowrap" class="ft5420"><b>Trusted&#160;Channels</b></p>
<p style="position:absolute;top:261px;left:150px;white-space:nowrap" class="ft5412">According&#160;to&#160;the&#160;definition&#160;above,&#160;trusted&#160;channels&#160;allow&#160;the&#160;involved&#160;communication<br/>end-points&#160;to&#160;determine&#160;their&#160;configuration&#160;and&#160;thus&#160;to&#160;derive&#160;their&#160;trustworthiness.<br/>Other&#160;integrity&#160;measurement&#160;architectures,&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#71">[30,&#160;32]&#160;</a>however,&#160;report&#160;the&#160;integrity&#160;of&#160;the<br/>whole&#160;platform&#160;configuration&#160;including&#160;<i>all&#160;</i>currently&#160;running&#160;compartments&#160;to&#160;remote<br/>parties,&#160;and&#160;thus&#160;violating&#160;user&#160;privacy.&#160;In&#160;contrast,&#160;our&#160;architecture&#160;supports&#160;to&#160;es-<br/>tablish&#160;trusted&#160;channels&#160;between&#160;single&#160;compartments&#160;without&#160;the&#160;involvement&#160;of&#160;the<br/>whole&#160;platform.&#160;This&#160;has&#160;the&#160;following&#160;advantages:</p>
<p style="position:absolute;top:416px;left:172px;white-space:nowrap" class="ft5430">•</p>
<p style="position:absolute;top:417px;left:187px;white-space:nowrap" class="ft5412"><i>Privacy:&#160;</i>A&#160;remote&#160;party&#160;only&#160;needs&#160;to&#160;know&#160;the&#160;configuration&#160;of&#160;the&#160;appropriate<br/>compartment&#160;including&#160;its&#160;TCB,&#160;and&#160;not&#160;the&#160;configuration&#160;of&#160;the&#160;whole&#160;platform.</p>
<p style="position:absolute;top:464px;left:172px;white-space:nowrap" class="ft5430">•</p>
<p style="position:absolute;top:465px;left:187px;white-space:nowrap" class="ft5413"><i>Scalability:&#160;</i>Remote&#160;parties&#160;do&#160;not&#160;have&#160;to&#160;derive&#160;the&#160;trustworthiness&#160;of&#160;all&#160;com-<br/>partments&#160;executed&#160;on&#160;top&#160;of&#160;the&#160;platform,&#160;to&#160;determine&#160;the&#160;trustworthiness&#160;of<br/>the&#160;appropriate&#160;compartment.</p>
<p style="position:absolute;top:529px;left:172px;white-space:nowrap" class="ft5430">•</p>
<p style="position:absolute;top:530px;left:187px;white-space:nowrap" class="ft5412"><i>Usability:&#160;</i>Since&#160;a&#160;compartment’s&#160;trustworthiness&#160;can&#160;be&#160;determined&#160;indepen-<br/>dently&#160;of&#160;other&#160;compartments&#160;running&#160;in&#160;parallel,&#160;the&#160;derived&#160;trustworthiness<br/>stays&#160;valid&#160;even&#160;if&#160;the&#160;user&#160;installs&#160;or&#160;modifies&#160;other&#160;compartments.</p>
<p style="position:absolute;top:596px;left:172px;white-space:nowrap" class="ft5411">Trusted&#160;channels&#160;can&#160;be&#160;established&#160;using&#160;the&#160;functions&#160;offered&#160;by&#160;the&#160;Trust&#160;Man-</p>
<p style="position:absolute;top:614px;left:150px;white-space:nowrap" class="ft5412">ager&#160;and&#160;the&#160;Compartment&#160;Manager,&#160;while&#160;the&#160;Compartment&#160;Manager,&#160;which&#160;is&#160;re-<br/>sponsible&#160;for&#160;installation&#160;and&#160;manipulation&#160;of&#160;compartments,&#160;provides&#160;the&#160;mapping<br/>from&#160;compartment&#160;identifiers&#160;into&#160;configurations.&#160;Thus,&#160;trusted&#160;channels&#160;can&#160;be&#160;es-<br/>tablished&#160;assuming&#160;that&#160;the&#160;TCB&#160;including&#160;the&#160;Compartment&#160;Manager&#160;and&#160;the&#160;Trust<br/>Manager&#160;is&#160;trustworthy.&#160;In&#160;Section&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#55">3.1.2,&#160;</a>we&#160;will&#160;explain&#160;how&#160;remote&#160;parties&#160;can&#160;de-<br/>termine&#160;the&#160;trustworthiness&#160;of&#160;the&#160;TCB.</p>
<p style="position:absolute;top:722px;left:172px;white-space:nowrap" class="ft5411">We&#160;distinguish&#160;between&#160;trusted&#160;channels&#160;between&#160;compartments&#160;running&#160;on&#160;the</p>
<p style="position:absolute;top:740px;left:150px;white-space:nowrap" class="ft5413">same&#160;platform&#160;(local&#160;trusted&#160;channels)&#160;and&#160;trusted&#160;channels&#160;between&#160;a&#160;remote&#160;and&#160;a<br/>local&#160;compartment&#160;(remote&#160;trusted&#160;channels).</p>
<p style="position:absolute;top:775px;left:172px;white-space:nowrap" class="ft5420"><b>Local&#160;Trusted&#160;Channels:&#160;</b>Since&#160;both&#160;the&#160;sender&#160;and&#160;the&#160;receiver&#160;are&#160;executed&#160;on</p>
<p style="position:absolute;top:793px;left:150px;white-space:nowrap" class="ft5413">top&#160;of&#160;the&#160;same&#160;TCB,&#160;an&#160;explicit&#160;verification&#160;of&#160;the&#160;TCB’s&#160;trustworthiness&#160;does&#160;not<br/>make&#160;sense&#160;in&#160;this&#160;case.&#160;Therefore,&#160;trusted&#160;channels&#160;can&#160;easily&#160;be&#160;established&#160;using<br/>secure&#160;channels&#160;offered&#160;by&#160;the&#160;underlying&#160;TCB,&#160;and&#160;the&#160;functions&#160;provided&#160;by&#160;the<br/>Compartment&#160;Manager:&#160;The&#160;sending&#160;compartment&#160;first&#160;requests&#160;the&#160;configuration&#160;of<br/>the&#160;destination&#160;compartment&#160;from&#160;the&#160;Compartment&#160;Manager.&#160;On&#160;successful&#160;validation<br/>that&#160;the&#160;destination&#160;configuration&#160;conforms&#160;to&#160;its&#160;security&#160;policy,&#160;the&#160;source&#160;compart-<br/>ment&#160;establishes&#160;a&#160;secure&#160;channel&#160;to&#160;the&#160;destination&#160;compartment.</p>
<p style="position:absolute;top:919px;left:172px;white-space:nowrap" class="ft5420"><b>Remote&#160;Trusted&#160;Channels:&#160;</b>The&#160;required&#160;steps&#160;to&#160;establish&#160;a&#160;remote&#160;trusted&#160;chan-</p>
<p style="position:absolute;top:937px;left:150px;white-space:nowrap" class="ft5412">nel&#160;from&#160;a&#160;remote&#160;compartment&#160;to&#160;the&#160;local&#160;compartment&#160;are&#160;as&#160;follows:&#160;If&#160;a&#160;local<br/>compartment&#160;receives&#160;a&#160;request&#160;from&#160;a&#160;remote&#160;compartment,&#160;the&#160;local&#160;compartment<br/>requests&#160;the&#160;Trust&#160;Manager&#160;to&#160;provide&#160;a&#160;credential&#160;including&#160;its&#160;own&#160;configuration.<br/>Then&#160;the&#160;Trust&#160;Manager&#160;generates&#160;the&#160;credential&#160;based&#160;on&#160;both&#160;the&#160;compartment&#160;con-<br/>figuration&#160;provided&#160;by&#160;the&#160;Compartment&#160;Manager&#160;and&#160;the&#160;configuration&#160;of&#160;the&#160;plat-<br/>form’s&#160;TCB.</p>
<p style="position:absolute;top:1027px;left:240px;white-space:nowrap" class="ft5411">The&#160;resulting&#160;credential&#160;is&#160;returned&#160;to&#160;the&#160;invoking&#160;local&#160;compartment</p>
<p style="position:absolute;top:1044px;left:150px;white-space:nowrap" class="ft5412">that&#160;forwards&#160;it&#160;to&#160;the&#160;remote&#160;compartment.&#160;That&#160;can&#160;now&#160;verify&#160;the&#160;trustworthiness&#160;of<br/>the&#160;local&#160;compartment&#160;and,&#160;on&#160;success,&#160;using&#160;the&#160;credential&#160;to&#160;open&#160;a&#160;trusted&#160;channel.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft5418">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 55 -->
<a name="55"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page55-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC055.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft5511">CHAPTER&#160;3.&#160;L4&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft5511">53</p>
<p style="position:absolute;top:552px;left:388px;white-space:nowrap" class="ft5511">Figure&#160;3.1:&#160;System&#160;Architecture</p>
<p style="position:absolute;top:600px;left:226px;white-space:nowrap" class="ft5512">This&#160;trusted&#160;channel&#160;may&#160;be&#160;set&#160;up&#160;using&#160;the&#160;VPN&#160;solution&#160;we&#160;provided&#160;(see&#160;section<br/><a href="Open_TC_D05.2_SecServicesPoC.html#62">3.1.3)</a>.</p>
<p style="position:absolute;top:676px;left:226px;white-space:nowrap" class="ft5520"><b>Trusted&#160;Storage</b></p>
<p style="position:absolute;top:704px;left:226px;white-space:nowrap" class="ft5513">Compartments&#160;running&#160;in&#160;parallel&#160;on&#160;one&#160;physical&#160;platform&#160;need&#160;a&#160;possibility&#160;to&#160;store<br/>data&#160;securely,&#160;i.e.,&#160;data&#160;of&#160;one&#160;compartment&#160;has&#160;to&#160;be&#160;kept&#160;isolated&#160;from&#160;data&#160;of&#160;an-<br/>other&#160;compartment.&#160;In&#160;our&#160;approach&#160;<i>SM&#160;</i>guarantees&#160;this&#160;isolation&#160;by&#160;providing&#160;trusted<br/>storage&#160;to&#160;the&#160;compartments.&#160;This&#160;<i>strong&#160;isolation&#160;</i>is&#160;needed&#160;to&#160;ensure&#160;certain&#160;security<br/>properties&#160;like&#160;<i>confidentiality&#160;</i>and&#160;<i>integrity</i>.&#160;Additionally&#160;the&#160;<i>SM&#160;</i>is&#160;capable&#160;to&#160;guaran-<br/>tee&#160;<i>authenticity&#160;</i>and&#160;<i>freshness</i>.</p>
<p style="position:absolute;top:852px;left:226px;white-space:nowrap" class="ft5533"><b>3.1.2</b></p>
<p style="position:absolute;top:852px;left:280px;white-space:nowrap" class="ft5533"><b>Implementation</b></p>
<p style="position:absolute;top:882px;left:226px;white-space:nowrap" class="ft5512">Our&#160;system&#160;architecture&#160;is&#160;based&#160;on&#160;security&#160;frameworks&#160;as&#160;proposed,&#160;e.g.,&#160;in&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#71">[28]</a>,<br/><a href="Open_TC_D05.2_SecServicesPoC.html#71">[31]&#160;</a>and&#160;shown&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#55">3.1.</a></p>
<p style="position:absolute;top:898px;left:407px;white-space:nowrap" class="ft5529"><a href="Open_TC_D05.2_SecServicesPoC.html#55">3</a></p>
<p style="position:absolute;top:900px;left:420px;white-space:nowrap" class="ft5511">We&#160;briefly&#160;explain&#160;each&#160;layer&#160;of&#160;our&#160;implementation,</p>
<p style="position:absolute;top:918px;left:226px;white-space:nowrap" class="ft5513">the&#160;initialisation&#160;process&#160;as&#160;well&#160;as&#160;the&#160;implementation&#160;of&#160;the&#160;core&#160;components,&#160;namely<br/>the&#160;Trust&#160;Manager&#160;and&#160;the&#160;Storage&#160;Manager.</p>
<p style="position:absolute;top:954px;left:248px;white-space:nowrap" class="ft5511">Our&#160;implementation&#160;primarily&#160;relies&#160;on&#160;a&#160;small&#160;security&#160;kernel,&#160;virtualisation&#160;tech-</p>
<p style="position:absolute;top:972px;left:226px;white-space:nowrap" class="ft5512">nology,&#160;and&#160;Trusted&#160;Computing&#160;technology.&#160;The&#160;security&#160;kernel,&#160;located&#160;as&#160;a&#160;control<br/>instance&#160;between&#160;the&#160;hardware&#160;and&#160;the&#160;application&#160;layer,&#160;implements&#160;elementary&#160;se-<br/>curity&#160;properties&#160;like&#160;trusted&#160;channels&#160;and&#160;isolation&#160;between&#160;processes.&#160;Virtualisation<br/>technology&#160;enables&#160;re-utilisation&#160;of&#160;legacy&#160;operating&#160;systems&#160;and&#160;present&#160;applications<br/>whereas&#160;Trusted&#160;Computing&#160;technology&#160;serves&#160;as&#160;root&#160;of&#160;trust.</p>
<p style="position:absolute;top:1070px;left:242px;white-space:nowrap" class="ft5531">3</p>
<p style="position:absolute;top:1073px;left:248px;white-space:nowrap" class="ft5516">This&#160;architecture&#160;has&#160;already&#160;been&#160;described&#160;in&#160;<i>WP5&#160;D05.1&#160;-&#160;Basic&#160;Security&#160;Services</i></p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft5518">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 56 -->
<a name="56"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page56-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC056.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft5611">54</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft5618">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:194px;left:172px;white-space:nowrap" class="ft5611">On&#160;top&#160;of&#160;the&#160;security&#160;kernel,&#160;a&#160;para-virtualised&#160;legacy&#160;operating&#160;system&#160;(currently</p>
<p style="position:absolute;top:212px;left:150px;white-space:nowrap" class="ft5613">Linux)&#160;including&#160;legacy&#160;applications,&#160;and&#160;the&#160;Secure&#160;I/O&#160;are&#160;executed&#160;in&#160;strongly&#160;iso-<br/>lated&#160;compartments&#160;running&#160;<i>in&#160;parallel&#160;</i>as&#160;user&#160;processes.&#160;In&#160;the&#160;following,&#160;we&#160;briefly<br/>describe&#160;each&#160;layer&#160;in&#160;more&#160;detail.</p>
<p style="position:absolute;top:305px;left:150px;white-space:nowrap" class="ft5620"><b>TC-enabled&#160;Hardware&#160;Platform:</b></p>
<p style="position:absolute;top:305px;left:375px;white-space:nowrap" class="ft5611">The&#160;hardware&#160;platform&#160;has&#160;to&#160;provide&#160;additional</p>
<p style="position:absolute;top:323px;left:150px;white-space:nowrap" class="ft5612">components&#160;as&#160;defined&#160;by&#160;the&#160;TCG&#160;in&#160;various&#160;specifications&#160;(e.g.,&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#71">[38]</a>).&#160;The&#160;central<br/>component&#160;forms&#160;a&#160;low-cost&#160;tamper-resistant&#160;cryptographic&#160;chip,&#160;called&#160;<i>Trusted&#160;Plat-<br/>form&#160;Module&#160;</i>(TPM).&#160;Currently,&#160;the&#160;TPM&#160;is&#160;implemented&#160;as&#160;a&#160;dedicated&#160;hardware&#160;chip.<br/>It&#160;offers&#160;amongst&#160;others&#160;a&#160;<i>cryptographic&#160;hash&#160;function&#160;</i>(SHA-1),&#160;a&#160;<i>cryptographic&#160;en-<br/>gine&#160;</i>(RSA)&#160;for&#160;encryption/decryption&#160;as&#160;well&#160;as&#160;signing,&#160;a&#160;hardware-based&#160;<i>Random<br/>Number&#160;Generator&#160;</i>(RNG),&#160;hardware&#160;protected&#160;<i>monotonic&#160;counters&#160;</i>as&#160;well&#160;as&#160;some<br/>amount&#160;of&#160;<i>protected&#160;storage</i>.&#160;It&#160;provides&#160;a&#160;set&#160;of&#160;registers&#160;in&#160;protected&#160;storage&#160;called<br/><i>Platform&#160;Configuration&#160;Registers&#160;</i>(PCR)&#160;that&#160;can&#160;be&#160;used&#160;to&#160;store&#160;hash&#160;values.&#160;Protec-<br/>tion&#160;mechanisms&#160;ensure&#160;that&#160;the&#160;value&#160;of&#160;a&#160;PCR&#160;can&#160;only&#160;be&#160;modified&#160;in&#160;a&#160;predefined<br/>way.&#160;The&#160;TPM&#160;is&#160;primarily&#160;used&#160;as&#160;a&#160;root&#160;of&#160;trust&#160;for&#160;platform’s&#160;integrity&#160;measure-<br/>ment&#160;and&#160;reporting.&#160;During&#160;system&#160;startup,&#160;a&#160;chain&#160;of&#160;trust&#160;is&#160;established&#160;by&#160;cryp-<br/>tographically&#160;hashing&#160;each&#160;boot&#160;stage&#160;before&#160;execution.&#160;The&#160;measurement&#160;results&#160;are<br/>stored&#160;protected&#160;in&#160;the&#160;PCRs.&#160;Based&#160;on&#160;this&#160;PCR&#160;configuration,&#160;two&#160;basic&#160;functions<br/>can&#160;be&#160;provided:&#160;<i>Remote&#160;Attestation&#160;</i>allows&#160;a&#160;TC-enabled&#160;platform&#160;to&#160;attest&#160;the&#160;current<br/>measurement&#160;and&#160;<i>Sealing</i>/<i>Binding&#160;</i>of&#160;data&#160;to&#160;a&#160;certain&#160;platform&#160;configuration.&#160;Our&#160;im-<br/>plementation&#160;uses&#160;a&#160;TPM&#160;in&#160;the&#160;present&#160;version&#160;1.2&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#71">[38]&#160;</a>since&#160;previous&#160;TPM&#160;versions<br/>cannot&#160;be&#160;used&#160;to&#160;provide&#160;fresh&#160;storage&#160;by&#160;monotonic&#160;counters.</p>
<p style="position:absolute;top:650px;left:150px;white-space:nowrap" class="ft5620"><b>Virtualisation&#160;Layer:</b></p>
<p style="position:absolute;top:650px;left:300px;white-space:nowrap" class="ft5611">The&#160;main&#160;task&#160;of&#160;the&#160;virtualisation&#160;layer&#160;is&#160;to&#160;provide&#160;an&#160;ab-</p>
<p style="position:absolute;top:668px;left:150px;white-space:nowrap" class="ft5612">straction&#160;of&#160;the&#160;underlying&#160;hardware,&#160;e.g.,&#160;CPU,&#160;interrupts,&#160;devices,&#160;and&#160;to&#160;offer&#160;an<br/>appropriate&#160;management&#160;interface.&#160;Moreover,&#160;this&#160;layer&#160;enforces&#160;an&#160;access&#160;control<br/>policy&#160;based&#160;on&#160;this&#160;resources.&#160;Device&#160;drivers&#160;and&#160;other&#160;essential&#160;operating&#160;system<br/>services,&#160;such&#160;as&#160;process&#160;management&#160;and&#160;memory&#160;management,&#160;run&#160;in&#160;isolated&#160;user-<br/>mode&#160;processes.&#160;In&#160;our&#160;implementation,&#160;we&#160;kept&#160;the&#160;interfaces&#160;between&#160;the&#160;layers<br/>generic&#160;to&#160;support&#160;also&#160;other&#160;virtualisation&#160;technologies.&#160;Thus,&#160;the&#160;interface&#160;offered<br/>by&#160;the&#160;virtualisation&#160;layer&#160;is&#160;similar&#160;to&#160;those&#160;offered&#160;by&#160;virtual&#160;machine&#160;monitors&#160;or<br/>hypervisors&#160;like&#160;sHype&#160;and&#160;Xen&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#70">[23,&#160;</a><a href="Open_TC_D05.2_SecServicesPoC.html#71">31,&#160;</a><a href="Open_TC_D05.2_SecServicesPoC.html#69">7]</a>.&#160;However,&#160;we&#160;actually&#160;decided&#160;to&#160;employ&#160;a<br/>L4-microkernel&#160;that&#160;easily&#160;allows&#160;isolation&#160;between&#160;single&#160;processes&#160;without&#160;creating<br/>a&#160;new&#160;full&#160;OS&#160;instance&#160;in&#160;each&#160;case&#160;such&#160;as&#160;when&#160;using&#160;Xen.</p>
<p style="position:absolute;top:869px;left:150px;white-space:nowrap" class="ft5620"><b>Trusted&#160;Service&#160;Layer:</b></p>
<p style="position:absolute;top:869px;left:312px;white-space:nowrap" class="ft5611">The&#160;trusted&#160;service&#160;layer,&#160;based&#160;on&#160;the&#160;PERSEUS&#160;security</p>
<p style="position:absolute;top:887px;left:150px;white-space:nowrap" class="ft5613">architecture&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#70">[22,&#160;</a><a href="Open_TC_D05.2_SecServicesPoC.html#71">26,&#160;28]</a>.&#160;It&#160;provides&#160;elementary&#160;security&#160;properties&#160;like&#160;trusted&#160;chan-<br/>nels&#160;and&#160;strong&#160;compartment&#160;isolation&#160;as&#160;well&#160;as&#160;several&#160;elementary&#160;management&#160;com-<br/>partments&#160;(e.g.,&#160;I/O&#160;access&#160;control&#160;policy)&#160;that&#160;realise&#160;security&#160;critical&#160;services&#160;inde-<br/>pendent&#160;and&#160;protected&#160;from&#160;compartments&#160;of&#160;the&#160;application&#160;layer.&#160;The&#160;main&#160;services<br/>are&#160;the&#160;Trust&#160;Manager,&#160;the&#160;User&#160;Manager,&#160;the&#160;Compartment&#160;Manager,&#160;and&#160;particularly<br/>the&#160;Storage&#160;Manager.&#160;Our&#160;implementation&#160;of&#160;the&#160;Trust&#160;Manager&#160;is&#160;based&#160;on&#160;the&#160;open-<br/>source&#160;TCG&#160;Software&#160;Stack&#160;<i>TrouSerS&#160;</i><a href="Open_TC_D05.2_SecServicesPoC.html#71">[35]</a>.</p>
<p style="position:absolute;top:1034px;left:150px;white-space:nowrap" class="ft5620"><b>Application&#160;Layer:</b></p>
<p style="position:absolute;top:1034px;left:288px;white-space:nowrap" class="ft5611">On&#160;top&#160;of&#160;the&#160;security&#160;kernel,&#160;several&#160;instances&#160;of&#160;the&#160;legacy</p>
<p style="position:absolute;top:1052px;left:150px;white-space:nowrap" class="ft5612">operating&#160;system&#160;(L4Linux)&#160;as&#160;well&#160;as&#160;security-critical&#160;applications&#160;(e.g.,&#160;Secure&#160;I/O)<br/>are&#160;executed&#160;in&#160;strongly&#160;isolated&#160;compartments&#160;such&#160;that&#160;unauthorised&#160;communication</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft5618">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 57 -->
<a name="57"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft5799{font-size:12px;font-family:Helvetica;color:#231f20;}
-->
</style>
<div id="page57-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC057.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft5711">CHAPTER&#160;3.&#160;L4&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft5711">55</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft5711">between&#160;applications&#160;or&#160;unauthorised&#160;I/O&#160;access&#160;is&#160;prevented<a href="Open_TC_D05.2_SecServicesPoC.html#57">.</a></p>
<p style="position:absolute;top:191px;left:601px;white-space:nowrap" class="ft5729"><a href="Open_TC_D05.2_SecServicesPoC.html#57">4</a></p>
<p style="position:absolute;top:194px;left:614px;white-space:nowrap" class="ft5711">The&#160;legacy&#160;operating</p>
<p style="position:absolute;top:212px;left:226px;white-space:nowrap" class="ft5712">system&#160;provides&#160;all&#160;operating&#160;system&#160;services&#160;that&#160;are&#160;not&#160;security-critical&#160;and&#160;offers<br/>users&#160;a&#160;common&#160;environment&#160;and&#160;a&#160;large&#160;set&#160;of&#160;existing&#160;applications.&#160;If&#160;a&#160;mandatory<br/>security&#160;policy&#160;requires&#160;isolation&#160;between&#160;applications&#160;of&#160;the&#160;legacy&#160;OS,&#160;they&#160;can&#160;be<br/>executed&#160;by&#160;parallel&#160;instances&#160;of&#160;the&#160;legacy&#160;operating&#160;system.</p>
<p style="position:absolute;top:305px;left:226px;white-space:nowrap" class="ft5720"><b>Secure&#160;Initialisation:</b></p>
<p style="position:absolute;top:305px;left:374px;white-space:nowrap" class="ft5711">The&#160;security&#160;of&#160;the&#160;whole&#160;architecture&#160;relies&#160;on&#160;a&#160;secure&#160;boot-</p>
<p style="position:absolute;top:323px;left:226px;white-space:nowrap" class="ft5712">strapping&#160;of&#160;the&#160;TCB.&#160;A&#160;TPM-enabled&#160;BIOS,&#160;the&#160;<i>Core&#160;Root&#160;of&#160;Trust&#160;for&#160;Measurement</i>,<br/>measures&#160;the&#160;integrity&#160;of&#160;the&#160;<i>Master&#160;Boot&#160;Record&#160;</i>(MBR),&#160;before&#160;passing&#160;control&#160;to&#160;it.<br/>A&#160;secure&#160;chain&#160;of&#160;measurements&#160;is&#160;then&#160;established:&#160;Before&#160;program&#160;code&#160;is&#160;executed<br/>it&#160;is&#160;measured&#160;by&#160;a&#160;previously&#160;measured&#160;and&#160;executed&#160;component.&#160;For&#160;this&#160;purpose,<br/>we&#160;have&#160;modified&#160;the&#160;<i>GRUB&#160;boot&#160;loade<a href="Open_TC_D05.2_SecServicesPoC.html#57">r</a></i></p>
<p style="position:absolute;top:392px;left:478px;white-space:nowrap" class="ft5729"><a href="Open_TC_D05.2_SecServicesPoC.html#57">5</a></p>
<p style="position:absolute;top:395px;left:489px;white-space:nowrap" class="ft5711">to&#160;measure&#160;the&#160;integrity&#160;of&#160;the&#160;core&#160;com-</p>
<p style="position:absolute;top:413px;left:226px;white-space:nowrap" class="ft5712">partments,&#160;i.e.,&#160;the&#160;virtualisation&#160;layer,&#160;all&#160;compartments&#160;interacting&#160;directly&#160;with&#160;the<br/>TPM&#160;–&#160;Compartment&#160;Manager,&#160;Trust&#160;Manager&#160;and&#160;Storage&#160;Manager&#160;–&#160;as&#160;well&#160;as&#160;the<br/>TPM&#160;device&#160;driver.&#160;The&#160;measurement&#160;results&#160;are&#160;securely&#160;stored&#160;in&#160;the&#160;PCRs&#160;of&#160;the<br/>TPM.&#160;All&#160;other&#160;compartments&#160;(including&#160;the&#160;legacy&#160;OS)&#160;are&#160;subsequently&#160;loaded,&#160;ver-<br/>ified,&#160;and&#160;executed&#160;by&#160;the&#160;Compartment&#160;Manager&#160;according&#160;to&#160;the&#160;effectual&#160;platform<br/>security&#160;policy.</p>
<p style="position:absolute;top:520px;left:248px;white-space:nowrap" class="ft5711">Upon&#160;completion&#160;of&#160;the&#160;secure&#160;Initialisation,&#160;an&#160;authorised&#160;compartment&#160;(such&#160;as</p>
<p style="position:absolute;top:538px;left:226px;white-space:nowrap" class="ft5713">the&#160;Trust&#160;Manager)&#160;can&#160;instruct&#160;the&#160;TPM&#160;to&#160;generate&#160;a&#160;credential&#160;for&#160;the&#160;Trusted&#160;Com-<br/>puting&#160;Base.&#160;This&#160;credential&#160;consists&#160;of&#160;all&#160;PCR&#160;values&#160;reflecting&#160;the&#160;configuration&#160;of<br/>the&#160;TCB&#160;and&#160;a&#160;key&#160;pair&#160;which&#160;is&#160;bound&#160;to&#160;these&#160;PCR&#160;values.&#160;Together&#160;with&#160;an&#160;I/O<br/>access&#160;policy&#160;management&#160;service&#160;that&#160;is&#160;of&#160;course&#160;also&#160;part&#160;of&#160;the&#160;TCB,&#160;the&#160;private<br/>key&#160;can&#160;only&#160;be&#160;used&#160;by&#160;compartments&#160;that&#160;are&#160;both&#160;part&#160;of&#160;the&#160;TCB&#160;and&#160;are&#160;authorised<br/>to&#160;access&#160;the&#160;TPM.</p>
<p style="position:absolute;top:668px;left:226px;white-space:nowrap" class="ft5720"><b>Trust&#160;Manager</b></p>
<p style="position:absolute;top:696px;left:226px;white-space:nowrap" class="ft5712">Our&#160;implementation&#160;of&#160;the&#160;Trust&#160;Manager&#160;is&#160;based&#160;on&#160;the&#160;open-source&#160;TCG&#160;Software<br/>Stack&#160;<i>TrouSerS&#160;</i><a href="Open_TC_D05.2_SecServicesPoC.html#71">[35]</a>.&#160;In&#160;order&#160;to&#160;provide&#160;remote&#160;trusted&#160;channels,&#160;the&#160;Trust&#160;Manager<br/>creates&#160;on&#160;request&#160;of&#160;a&#160;local&#160;compartment&#160;a&#160;private&#160;binding&#160;key&#160;whose&#160;usage&#160;is&#160;bound<br/>to&#160;the&#160;requesting&#160;compartment’s&#160;configuration&#160;and&#160;the&#160;configuration&#160;of&#160;the&#160;platform’s<br/>TCB&#160;(including&#160;the&#160;Trust&#160;Manager&#160;itself).&#160;The&#160;appropriate&#160;certificate&#160;of&#160;the&#160;public<br/>binding&#160;key&#160;has&#160;to&#160;be&#160;extended&#160;such&#160;that&#160;remote&#160;parties&#160;can&#160;verify&#160;both&#160;configurations.<br/>To&#160;access&#160;content&#160;that&#160;is&#160;remotely&#160;decrypted&#160;with&#160;the&#160;public&#160;binding&#160;key,&#160;the&#160;Trust<br/>Manager&#160;checks&#160;whether&#160;the&#160;configuration&#160;of&#160;the&#160;compartment&#160;that&#160;wants&#160;to&#160;use&#160;the<br/>corresponding&#160;private&#160;binding&#160;key&#160;<i>matches&#160;</i>the&#160;configuration&#160;of&#160;the&#160;compartment&#160;that<br/>has&#160;initiated&#160;the&#160;creation&#160;of&#160;that&#160;binding&#160;key.&#160;Note&#160;that,&#160;by&#160;extending&#160;this&#160;’match’<br/>function,&#160;one&#160;can&#160;easily&#160;provide&#160;property-based&#160;attestation/sealing&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#71">[27,&#160;</a><a href="Open_TC_D05.2_SecServicesPoC.html#70">25,&#160;12]&#160;</a>on&#160;top<br/>of&#160;the&#160;Trust&#160;Manager.</p>
<p style="position:absolute;top:911px;left:248px;white-space:nowrap" class="ft5711">In&#160;this&#160;section,&#160;we&#160;give&#160;a&#160;detailed&#160;description&#160;of&#160;the&#160;protocol&#160;for&#160;establishing&#160;a&#160;re-</p>
<p style="position:absolute;top:929px;left:226px;white-space:nowrap" class="ft5712">mote&#160;trusted&#160;channel.&#160;The&#160;protocol&#160;can&#160;be&#160;decomposed&#160;into&#160;three&#160;major&#160;steps,&#160;namely<br/><i>certificate&#160;generation</i>,&#160;<i>encryption&#160;of&#160;a&#160;session&#160;key</i>,&#160;and&#160;<i>decryption&#160;of&#160;the&#160;session&#160;key</i><a href="Open_TC_D05.2_SecServicesPoC.html#57">.</a></p>
<p style="position:absolute;top:944px;left:730px;white-space:nowrap" class="ft5729"><a href="Open_TC_D05.2_SecServicesPoC.html#57">6</a></p>
<p style="position:absolute;top:965px;left:248px;white-space:nowrap" class="ft5720"><b>Certificate&#160;Generation:&#160;</b>The&#160;request&#160;of&#160;the&#160;remote&#160;compartment</p>
<p style="position:absolute;top:964px;left:642px;white-space:nowrap" class="ft5754">RC</p>
<p style="position:absolute;top:965px;left:669px;white-space:nowrap" class="ft5711">for&#160;a&#160;trusted</p>
<p style="position:absolute;top:983px;left:226px;white-space:nowrap" class="ft5711">channel&#160;to&#160;the&#160;local&#160;compartment</p>
<p style="position:absolute;top:982px;left:439px;white-space:nowrap" class="ft5754">LC</p>
<p style="position:absolute;top:983px;left:467px;white-space:nowrap" class="ft5711">reaches</p>
<p style="position:absolute;top:982px;left:517px;white-space:nowrap" class="ft5754">T&#160;M</p>
<p style="position:absolute;top:983px;left:550px;white-space:nowrap" class="ft5711">via</p>
<p style="position:absolute;top:982px;left:574px;white-space:nowrap" class="ft5754">LC</p>
<p style="position:absolute;top:983px;left:596px;white-space:nowrap" class="ft5711">.&#160;After&#160;the&#160;mapping&#160;of</p>
<p style="position:absolute;top:1000px;left:226px;white-space:nowrap" class="ft5754">LC</p>
<p style="position:absolute;top:1001px;left:248px;white-space:nowrap" class="ft5711">’s&#160;compartment&#160;identifier&#160;to&#160;his&#160;actual&#160;compartment&#160;configuration</p>
<p style="position:absolute;top:1000px;left:654px;white-space:nowrap" class="ft5754">comp</p>
<p style="position:absolute;top:1001px;left:688px;white-space:nowrap" class="ft5711">-</p>
<p style="position:absolute;top:1000px;left:694px;white-space:nowrap" class="ft5754">conf</p>
<p style="position:absolute;top:1006px;left:724px;white-space:nowrap" class="ft5761">LC</p>
<p style="position:absolute;top:1027px;left:242px;white-space:nowrap" class="ft5731">4</p>
<p style="position:absolute;top:1030px;left:248px;white-space:nowrap" class="ft5716">However,&#160;covert&#160;channels&#160;are&#160;still&#160;feasible.</p>
<p style="position:absolute;top:1042px;left:242px;white-space:nowrap" class="ft5731"><a href="http://www.prosec.rub.de/trusted_grub.html">5</a></p>
<p style="position:absolute;top:1044px;left:248px;white-space:nowrap" class="ft5799"><a href="http://www.prosec.rub.de/trusted_grub.html">www.prosec.rub.de/trusted_grub.html</a></p>
<p style="position:absolute;top:1057px;left:242px;white-space:nowrap" class="ft5731">6</p>
<p style="position:absolute;top:1059px;left:248px;white-space:nowrap" class="ft5716">We&#160;also&#160;developed&#160;another&#160;approach&#160;setting&#160;up&#160;a&#160;trusted&#160;channel&#160;that&#160;provides&#160;additional&#160;security&#160;by</p>
<p style="position:absolute;top:1073px;left:226px;white-space:nowrap" class="ft5716">preserving&#160;mutual&#160;security&#160;and&#160;state-change&#160;detection&#160;(see&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#69">[2]</a>).</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft5718">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 58 -->
<a name="58"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft58100{font-size:13px;font-family:HCDXKW+CMMI9;color:#231f20;}
	.ft58101{font-size:9px;font-family:GXTWYD+CMMI6;color:#231f20;}
	.ft58102{font-size:12px;font-family:ENVRON+CMMI8;color:#231f20;}
	.ft58103{font-size:12px;line-height:14px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page58-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC058.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft5811">56</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft5818">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft5811">using</p>
<p style="position:absolute;top:193px;left:187px;white-space:nowrap" class="ft5854">CM</p>
<p style="position:absolute;top:194px;left:215px;white-space:nowrap" class="ft5811">,</p>
<p style="position:absolute;top:193px;left:224px;white-space:nowrap" class="ft5854">T&#160;M</p>
<p style="position:absolute;top:194px;left:256px;white-space:nowrap" class="ft5811">invokes&#160;the&#160;TPM&#160;to&#160;create&#160;a&#160;asymmetric&#160;binding&#160;key&#160;bound&#160;to&#160;the</p>
<p style="position:absolute;top:212px;left:150px;white-space:nowrap" class="ft5811">actual&#160;TCB&#160;configuration<a href="Open_TC_D05.2_SecServicesPoC.html#58">.</a></p>
<p style="position:absolute;top:209px;left:308px;white-space:nowrap" class="ft5829"><a href="Open_TC_D05.2_SecServicesPoC.html#58">7</a></p>
<p style="position:absolute;top:212px;left:322px;white-space:nowrap" class="ft5811">The&#160;TPM&#160;then&#160;returns&#160;the&#160;public&#160;binding&#160;key</p>
<p style="position:absolute;top:211px;left:604px;white-space:nowrap" class="ft5854">P&#160;K</p>
<p style="position:absolute;top:217px;left:628px;white-space:nowrap" class="ft5861">BIN&#160;D</p>
<p style="position:absolute;top:230px;left:150px;white-space:nowrap" class="ft5811">and&#160;the&#160;encrypted&#160;secret&#160;part</p>
<p style="position:absolute;top:229px;left:333px;white-space:nowrap" class="ft5854">SK</p>
<p style="position:absolute;top:228px;left:357px;white-space:nowrap" class="ft5863">′</p>
<p style="position:absolute;top:236px;left:356px;white-space:nowrap" class="ft5861">BIN&#160;D</p>
<p style="position:absolute;top:230px;left:399px;white-space:nowrap" class="ft5811">using&#160;TPM’s&#160;storage&#160;root&#160;key&#160;(SRK).&#160;Then</p>
<p style="position:absolute;top:247px;left:150px;white-space:nowrap" class="ft5854">T&#160;M</p>
<p style="position:absolute;top:247px;left:181px;white-space:nowrap" class="ft5811">invokes&#160;the&#160;TPM&#160;to&#160;sign&#160;over&#160;the&#160;actual&#160;TCB&#160;configuration,&#160;the&#160;binding&#160;key,&#160;and</p>
<p style="position:absolute;top:265px;left:150px;white-space:nowrap" class="ft5811">the&#160;configuration&#160;of</p>
<p style="position:absolute;top:265px;left:271px;white-space:nowrap" class="ft5854">LC</p>
<p style="position:absolute;top:265px;left:297px;white-space:nowrap" class="ft5811">using&#160;an&#160;attestation&#160;identity&#160;key&#160;(AIK)<a href="Open_TC_D05.2_SecServicesPoC.html#58">.</a></p>
<p style="position:absolute;top:263px;left:531px;white-space:nowrap" class="ft5829"><a href="Open_TC_D05.2_SecServicesPoC.html#58">8</a></p>
<p style="position:absolute;top:265px;left:540px;white-space:nowrap" class="ft5811">Finally,</p>
<p style="position:absolute;top:265px;left:589px;white-space:nowrap" class="ft5854">T&#160;M</p>
<p style="position:absolute;top:265px;left:620px;white-space:nowrap" class="ft5811">embeds</p>
<p style="position:absolute;top:283px;left:150px;white-space:nowrap" class="ft5812">the&#160;received&#160;TPM&#160;credential&#160;within&#160;an&#160;X.509&#160;certificate&#160;for&#160;use&#160;in&#160;the&#160;TLS&#160;handshake,<br/>which&#160;will&#160;be&#160;sent&#160;together&#160;with</p>
<p style="position:absolute;top:301px;left:358px;white-space:nowrap" class="ft5854">P&#160;K</p>
<p style="position:absolute;top:306px;left:383px;white-space:nowrap" class="ft5861">BIN&#160;D</p>
<p style="position:absolute;top:301px;left:425px;white-space:nowrap" class="ft5811">to</p>
<p style="position:absolute;top:301px;left:443px;white-space:nowrap" class="ft5854">RC</p>
<p style="position:absolute;top:301px;left:466px;white-space:nowrap" class="ft5811">.&#160;First,&#160;a&#160;key&#160;pair&#160;bound&#160;to&#160;the</p>
<p style="position:absolute;top:319px;left:150px;white-space:nowrap" class="ft5812">TCB&#160;configuration&#160;and&#160;an&#160;appropriate&#160;certificate&#160;about&#160;the&#160;public&#160;key&#160;are&#160;created.&#160;The<br/>certificate&#160;is&#160;an&#160;X.509&#160;certificate&#160;which&#160;includes&#160;information&#160;about&#160;the&#160;PCR&#160;values&#160;of<br/>configurations&#160;that&#160;are&#160;allowed&#160;to&#160;use&#160;the&#160;key&#160;(enforced&#160;by&#160;the&#160;TPM)&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#71">[33]</a>,&#160;and&#160;the<br/>configuration&#160;of&#160;the&#160;compartment&#160;(enforced&#160;by&#160;the&#160;Trust&#160;Manager)<a href="Open_TC_D05.2_SecServicesPoC.html#58">.</a></p>
<p style="position:absolute;top:370px;left:553px;white-space:nowrap" class="ft5829"><a href="Open_TC_D05.2_SecServicesPoC.html#58">9</a></p>
<p style="position:absolute;top:407px;left:323px;white-space:nowrap" class="ft5857">TCB&#160;configuration</p>
<p style="position:absolute;top:406px;left:427px;white-space:nowrap" class="ft58100">T&#160;CB</p>
<p style="position:absolute;top:407px;left:459px;white-space:nowrap" class="ft5857">-</p>
<p style="position:absolute;top:406px;left:464px;white-space:nowrap" class="ft58100">conf</p>
<p style="position:absolute;top:426px;left:327px;white-space:nowrap" class="ft5857">Public&#160;binding&#160;key</p>
<p style="position:absolute;top:426px;left:432px;white-space:nowrap" class="ft58100">P&#160;K</p>
<p style="position:absolute;top:430px;left:454px;white-space:nowrap" class="ft58101">BI&#160;N&#160;D</p>
<p style="position:absolute;top:445px;left:275px;white-space:nowrap" class="ft5857">Local&#160;compartment&#160;configuration</p>
<p style="position:absolute;top:444px;left:459px;white-space:nowrap" class="ft58100">comp</p>
<p style="position:absolute;top:445px;left:491px;white-space:nowrap" class="ft5857">-</p>
<p style="position:absolute;top:444px;left:495px;white-space:nowrap" class="ft58100">conf</p>
<p style="position:absolute;top:449px;left:523px;white-space:nowrap" class="ft58101">LC</p>
<p style="position:absolute;top:467px;left:361px;white-space:nowrap" class="ft5857">TPM&#160;Signature&#160;=</p>
<p style="position:absolute;top:483px;left:263px;white-space:nowrap" class="ft58100">sign</p>
<p style="position:absolute;top:487px;left:289px;white-space:nowrap" class="ft58101">AI&#160;K</p>
<p style="position:absolute;top:483px;left:317px;white-space:nowrap" class="ft5857">(</p>
<p style="position:absolute;top:483px;left:325px;white-space:nowrap" class="ft58100">T&#160;CB</p>
<p style="position:absolute;top:483px;left:357px;white-space:nowrap" class="ft5857">-</p>
<p style="position:absolute;top:483px;left:361px;white-space:nowrap" class="ft58100">conf</p>
<p style="position:absolute;top:483px;left:390px;white-space:nowrap" class="ft5857">,</p>
<p style="position:absolute;top:483px;left:397px;white-space:nowrap" class="ft58100">P&#160;K</p>
<p style="position:absolute;top:487px;left:420px;white-space:nowrap" class="ft58101">BI&#160;N&#160;D</p>
<p style="position:absolute;top:483px;left:454px;white-space:nowrap" class="ft5857">,</p>
<p style="position:absolute;top:483px;left:460px;white-space:nowrap" class="ft58100">comp</p>
<p style="position:absolute;top:483px;left:492px;white-space:nowrap" class="ft5857">-</p>
<p style="position:absolute;top:483px;left:497px;white-space:nowrap" class="ft58100">conf</p>
<p style="position:absolute;top:487px;left:524px;white-space:nowrap" class="ft58101">LC</p>
<p style="position:absolute;top:483px;left:545px;white-space:nowrap" class="ft5857">)</p>
<p style="position:absolute;top:514px;left:244px;white-space:nowrap" class="ft5811">Table&#160;3.1:&#160;Structure&#160;of&#160;the&#160;TPM&#160;credential</p>
<p style="position:absolute;top:514px;left:502px;white-space:nowrap" class="ft5854">cred</p>
<p style="position:absolute;top:519px;left:530px;white-space:nowrap" class="ft5861">BIN&#160;D</p>
<p style="position:absolute;top:514px;left:567px;white-space:nowrap" class="ft5811">.</p>
<p style="position:absolute;top:547px;left:172px;white-space:nowrap" class="ft5820"><b>Encryption&#160;of&#160;Session&#160;Key:</b></p>
<p style="position:absolute;top:547px;left:356px;white-space:nowrap" class="ft5854">RC</p>
<p style="position:absolute;top:547px;left:384px;white-space:nowrap" class="ft5811">verifies&#160;the&#160;X.509&#160;certificate&#160;signature&#160;as&#160;well</p>
<p style="position:absolute;top:565px;left:150px;white-space:nowrap" class="ft5811">as&#160;the&#160;TPM&#160;credential&#160;signature&#160;and&#160;validates&#160;the&#160;two&#160;embedded&#160;configurations</p>
<p style="position:absolute;top:565px;left:626px;white-space:nowrap" class="ft5854">T&#160;CB</p>
<p style="position:absolute;top:565px;left:661px;white-space:nowrap" class="ft5811">-</p>
<p style="position:absolute;top:582px;left:150px;white-space:nowrap" class="ft5854">conf</p>
<p style="position:absolute;top:583px;left:186px;white-space:nowrap" class="ft5811">and</p>
<p style="position:absolute;top:582px;left:211px;white-space:nowrap" class="ft5854">comp</p>
<p style="position:absolute;top:583px;left:246px;white-space:nowrap" class="ft5811">-</p>
<p style="position:absolute;top:582px;left:251px;white-space:nowrap" class="ft5854">conf</p>
<p style="position:absolute;top:588px;left:281px;white-space:nowrap" class="ft5861">LC</p>
<p style="position:absolute;top:583px;left:303px;white-space:nowrap" class="ft5811">by&#160;comparing&#160;them&#160;with&#160;reference&#160;values&#160;known&#160;to&#160;be&#160;trust-</p>
<p style="position:absolute;top:601px;left:150px;white-space:nowrap" class="ft5811">worthy.&#160;On&#160;success,</p>
<p style="position:absolute;top:600px;left:282px;white-space:nowrap" class="ft5854">RC</p>
<p style="position:absolute;top:601px;left:310px;white-space:nowrap" class="ft5811">encrypts&#160;a&#160;symmetric&#160;session&#160;key&#160;to</p>
<p style="position:absolute;top:600px;left:539px;white-space:nowrap" class="ft5854">esk</p>
<p style="position:absolute;top:601px;left:566px;white-space:nowrap" class="ft5811">using</p>
<p style="position:absolute;top:600px;left:604px;white-space:nowrap" class="ft5854">P&#160;K</p>
<p style="position:absolute;top:606px;left:628px;white-space:nowrap" class="ft5861">BIN&#160;D</p>
<p style="position:absolute;top:619px;left:150px;white-space:nowrap" class="ft5811">and&#160;acknowledges&#160;the&#160;TLS&#160;handshake&#160;with</p>
<p style="position:absolute;top:618px;left:414px;white-space:nowrap" class="ft5854">esk</p>
<p style="position:absolute;top:619px;left:436px;white-space:nowrap" class="ft5811">,&#160;that&#160;can&#160;be&#160;unbound&#160;by</p>
<p style="position:absolute;top:618px;left:588px;white-space:nowrap" class="ft5854">LC</p>
<p style="position:absolute;top:619px;left:614px;white-space:nowrap" class="ft5811">only&#160;if&#160;it</p>
<p style="position:absolute;top:637px;left:150px;white-space:nowrap" class="ft5811">provides&#160;the&#160;stated&#160;compartment&#160;and&#160;TCB&#160;configuration.</p>
<p style="position:absolute;top:655px;left:172px;white-space:nowrap" class="ft5820"><b>Decryption&#160;of&#160;Session&#160;Key:&#160;</b>Upon&#160;receipt&#160;of&#160;the&#160;encrypted&#160;session&#160;key</p>
<p style="position:absolute;top:654px;left:613px;white-space:nowrap" class="ft5854">esk</p>
<p style="position:absolute;top:655px;left:635px;white-space:nowrap" class="ft5811">,</p>
<p style="position:absolute;top:654px;left:644px;white-space:nowrap" class="ft5854">LC</p>
<p style="position:absolute;top:673px;left:150px;white-space:nowrap" class="ft5811">requests</p>
<p style="position:absolute;top:672px;left:204px;white-space:nowrap" class="ft5854">T&#160;M</p>
<p style="position:absolute;top:673px;left:235px;white-space:nowrap" class="ft5811">to&#160;unbind&#160;the&#160;session&#160;key.&#160;Therefore,</p>
<p style="position:absolute;top:672px;left:469px;white-space:nowrap" class="ft5854">T&#160;M</p>
<p style="position:absolute;top:673px;left:501px;white-space:nowrap" class="ft5811">again&#160;maps</p>
<p style="position:absolute;top:672px;left:575px;white-space:nowrap" class="ft5854">LC</p>
<p style="position:absolute;top:673px;left:597px;white-space:nowrap" class="ft5811">’s&#160;compart-</p>
<p style="position:absolute;top:691px;left:150px;white-space:nowrap" class="ft5811">ment&#160;identifier&#160;to&#160;his&#160;actual&#160;compartment&#160;configuration</p>
<p style="position:absolute;top:690px;left:489px;white-space:nowrap" class="ft5854">comp</p>
<p style="position:absolute;top:691px;left:523px;white-space:nowrap" class="ft5811">-</p>
<p style="position:absolute;top:690px;left:528px;white-space:nowrap" class="ft5854">conf</p>
<p style="position:absolute;top:696px;left:558px;white-space:nowrap" class="ft5861">LC</p>
<p style="position:absolute;top:691px;left:581px;white-space:nowrap" class="ft5811">using</p>
<p style="position:absolute;top:690px;left:617px;white-space:nowrap" class="ft5854">CM</p>
<p style="position:absolute;top:691px;left:645px;white-space:nowrap" class="ft5811">,&#160;to</p>
<p style="position:absolute;top:709px;left:150px;white-space:nowrap" class="ft5813">validate&#160;the&#160;compartment&#160;configuration&#160;stated&#160;in&#160;the&#160;certificate&#160;with&#160;the&#160;one&#160;requesting<br/>the&#160;unbind&#160;process.&#160;On&#160;success,</p>
<p style="position:absolute;top:726px;left:344px;white-space:nowrap" class="ft5854">T&#160;M</p>
<p style="position:absolute;top:726px;left:374px;white-space:nowrap" class="ft5811">invokes&#160;the&#160;TPM&#160;to&#160;unbind&#160;the&#160;session&#160;key&#160;using</p>
<p style="position:absolute;top:744px;left:150px;white-space:nowrap" class="ft5811">the&#160;encrypted&#160;private&#160;part&#160;of&#160;the&#160;binding&#160;key</p>
<p style="position:absolute;top:744px;left:424px;white-space:nowrap" class="ft5854">SK</p>
<p style="position:absolute;top:743px;left:448px;white-space:nowrap" class="ft5863">′</p>
<p style="position:absolute;top:751px;left:447px;white-space:nowrap" class="ft5861">BIN&#160;D</p>
<p style="position:absolute;top:744px;left:484px;white-space:nowrap" class="ft5811">.&#160;The&#160;TPM&#160;first&#160;compares&#160;the</p>
<p style="position:absolute;top:762px;left:150px;white-space:nowrap" class="ft5811">actual&#160;PCR&#160;values&#160;with&#160;ones</p>
<p style="position:absolute;top:762px;left:322px;white-space:nowrap" class="ft5854">SK</p>
<p style="position:absolute;top:767px;left:345px;white-space:nowrap" class="ft5861">BIN&#160;D</p>
<p style="position:absolute;top:762px;left:386px;white-space:nowrap" class="ft5811">is&#160;bound&#160;to,&#160;before&#160;returning&#160;the&#160;decrypted&#160;ses-</p>
<p style="position:absolute;top:780px;left:150px;white-space:nowrap" class="ft5811">sion&#160;key&#160;to</p>
<p style="position:absolute;top:780px;left:219px;white-space:nowrap" class="ft5854">T&#160;M</p>
<p style="position:absolute;top:780px;left:246px;white-space:nowrap" class="ft5811">.</p>
<p style="position:absolute;top:780px;left:254px;white-space:nowrap" class="ft5854">T&#160;M</p>
<p style="position:absolute;top:780px;left:284px;white-space:nowrap" class="ft5811">finally,&#160;passes&#160;the&#160;decrypted&#160;session&#160;key&#160;back&#160;to</p>
<p style="position:absolute;top:780px;left:574px;white-space:nowrap" class="ft5854">LC</p>
<p style="position:absolute;top:780px;left:600px;white-space:nowrap" class="ft5811">which&#160;uses</p>
<p style="position:absolute;top:798px;left:150px;white-space:nowrap" class="ft5813">it&#160;for&#160;the&#160;completion&#160;of&#160;the&#160;TLS&#160;handshake&#160;to&#160;establish&#160;a&#160;(one-way)&#160;TLS-based&#160;trusted<br/>channel&#160;from&#160;compartment</p>
<p style="position:absolute;top:815px;left:315px;white-space:nowrap" class="ft5854">RC</p>
<p style="position:absolute;top:816px;left:342px;white-space:nowrap" class="ft5811">to</p>
<p style="position:absolute;top:815px;left:358px;white-space:nowrap" class="ft5854">LC</p>
<p style="position:absolute;top:816px;left:380px;white-space:nowrap" class="ft5811">.</p>
<p style="position:absolute;top:834px;left:172px;white-space:nowrap" class="ft5820"><b>Performance&#160;Measurements:&#160;</b>We&#160;have&#160;implemented&#160;the&#160;described&#160;protocol&#160;and</p>
<p style="position:absolute;top:852px;left:150px;white-space:nowrap" class="ft5812">run&#160;it&#160;on&#160;TPMs&#160;of&#160;different&#160;vendors.&#160;The&#160;measurement&#160;results&#160;with&#160;maximum&#160;asym-<br/>metric&#160;key&#160;lengths&#160;(2048&#160;bits)&#160;are&#160;shown&#160;below.&#160;Note&#160;that&#160;the&#160;TPM&#160;calculations&#160;domi-<br/>nate&#160;the&#160;overall&#160;computation&#160;and&#160;network&#160;transfer&#160;times.</p>
<p style="position:absolute;top:926px;left:150px;white-space:nowrap" class="ft5820"><b>Storage&#160;Manager</b></p>
<p style="position:absolute;top:955px;left:150px;white-space:nowrap" class="ft5811">The&#160;following&#160;section&#160;describes&#160;the&#160;implementation&#160;of&#160;the&#160;Storage&#160;Manager</p>
<p style="position:absolute;top:954px;left:609px;white-space:nowrap" class="ft5854">SM</p>
<p style="position:absolute;top:955px;left:635px;white-space:nowrap" class="ft5811">,&#160;that</p>
<p style="position:absolute;top:972px;left:150px;white-space:nowrap" class="ft5812">enables&#160;other&#160;compartments&#160;to&#160;persistently&#160;bind&#160;their&#160;local&#160;states&#160;to&#160;their&#160;actual&#160;config-<br/>uration&#160;while&#160;preserving&#160;integrity,&#160;confidentiality&#160;and&#160;freshness.&#160;We&#160;first&#160;give&#160;an&#160;short</p>
<p style="position:absolute;top:1015px;left:166px;white-space:nowrap" class="ft5831">7</p>
<p style="position:absolute;top:1017px;left:171px;white-space:nowrap" class="ft5816">The&#160;actual&#160;TCB&#160;configuration</p>
<p style="position:absolute;top:1017px;left:315px;white-space:nowrap" class="ft58102">T&#160;CB</p>
<p style="position:absolute;top:1017px;left:345px;white-space:nowrap" class="ft5816">-</p>
<p style="position:absolute;top:1017px;left:348px;white-space:nowrap" class="ft58102">conf</p>
<p style="position:absolute;top:1017px;left:378px;white-space:nowrap" class="ft5816">was&#160;measured&#160;during&#160;secure&#160;Initialisation&#160;(cf.&#160;Section&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#57">3.1.2)</a>.</p>
<p style="position:absolute;top:1029px;left:166px;white-space:nowrap" class="ft5831">8</p>
<p style="position:absolute;top:1031px;left:171px;white-space:nowrap" class="ft5816">The&#160;attestation&#160;identity&#160;key&#160;(AIK)&#160;is&#160;a&#160;non-migrateable&#160;key&#160;that&#160;has&#160;been&#160;attested&#160;by&#160;a&#160;privacy-CA&#160;to</p>
<p style="position:absolute;top:1046px;left:150px;white-space:nowrap" class="ft58103">come&#160;from&#160;a&#160;TCG&#160;conform&#160;platform.&#160;An&#160;AIK&#160;(in&#160;contrast&#160;to&#160;the&#160;general&#160;signature&#160;key)&#160;can&#160;be&#160;used&#160;only&#160;to<br/>sign&#160;other&#160;TPM&#160;keys&#160;or&#160;PCR&#160;values.</p>
<p style="position:absolute;top:1072px;left:166px;white-space:nowrap" class="ft5831">9</p>
<p style="position:absolute;top:1074px;left:171px;white-space:nowrap" class="ft5816">In&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#69">[2]&#160;</a>we&#160;altered&#160;the&#160;credential&#160;creation&#160;process&#160;for&#160;performance&#160;reasons.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft5818">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 59 -->
<a name="59"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft59104{font-size:15px;font-family:MBNNOT+CMTI10;color:#231f20;}
-->
</style>
<div id="page59-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC059.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft5911">CHAPTER&#160;3.&#160;L4&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft5911">57</p>
<p style="position:absolute;top:191px;left:521px;white-space:nowrap" class="ft5957">Atmel&#160;1.1b</p>
<p style="position:absolute;top:191px;left:599px;white-space:nowrap" class="ft5957">NSC&#160;1.1b</p>
<p style="position:absolute;top:210px;left:314px;white-space:nowrap" class="ft5957">Certificate&#160;generation</p>
<p style="position:absolute;top:210px;left:521px;white-space:nowrap" class="ft5957">30&#160;–&#160;80&#160;s</p>
<p style="position:absolute;top:210px;left:599px;white-space:nowrap" class="ft5957">52&#160;–&#160;55&#160;s</p>
<p style="position:absolute;top:227px;left:315px;white-space:nowrap" class="ft5957">Session&#160;key&#160;encryption&#160;(w/o&#160;TPM)</p>
<p style="position:absolute;top:227px;left:521px;white-space:nowrap" class="ft5957">&lt;&#160;1&#160;s</p>
<p style="position:absolute;top:227px;left:599px;white-space:nowrap" class="ft5957">&lt;&#160;1&#160;s</p>
<p style="position:absolute;top:243px;left:315px;white-space:nowrap" class="ft5957">Session&#160;key&#160;decryption</p>
<p style="position:absolute;top:243px;left:521px;white-space:nowrap" class="ft5957">2&#160;–&#160;3&#160;s</p>
<p style="position:absolute;top:243px;left:599px;white-space:nowrap" class="ft5957">23&#160;–&#160;24&#160;s</p>
<p style="position:absolute;top:273px;left:303px;white-space:nowrap" class="ft5911">Table&#160;3.2:&#160;Trust&#160;Manager&#160;performance&#160;measurement&#160;results.</p>
<p style="position:absolute;top:322px;left:226px;white-space:nowrap" class="ft5912">overview&#160;and&#160;then&#160;describe&#160;the&#160;realisation&#160;of&#160;secure&#160;storage&#160;that&#160;will&#160;be&#160;extended&#160;by<br/>an&#160;additional&#160;freshness&#160;layer&#160;to&#160;provide&#160;also&#160;trusted&#160;storage.&#160;At&#160;the&#160;end&#160;of&#160;this&#160;section,<br/>we&#160;briefly&#160;describe&#160;the&#160;protocols&#160;to&#160;init</p>
<p style="position:absolute;top:357px;left:464px;white-space:nowrap" class="ft5954">SM</p>
<p style="position:absolute;top:358px;left:494px;white-space:nowrap" class="ft5911">as&#160;well&#160;as&#160;for&#160;storing&#160;to&#160;and&#160;loading&#160;from</p>
<p style="position:absolute;top:375px;left:226px;white-space:nowrap" class="ft5911">trusted&#160;storage&#160;using</p>
<p style="position:absolute;top:375px;left:354px;white-space:nowrap" class="ft5954">SM</p>
<p style="position:absolute;top:375px;left:380px;white-space:nowrap" class="ft5911">.</p>
<p style="position:absolute;top:393px;left:248px;white-space:nowrap" class="ft5917"><i>Overview:&#160;</i>The&#160;Storage&#160;Manager&#160;is&#160;invoked&#160;by&#160;a&#160;compartment&#160;to&#160;store&#160;a&#160;data&#160;object</p>
<p style="position:absolute;top:411px;left:226px;white-space:nowrap" class="ft5913">persistently&#160;preserving&#160;confidentiality&#160;and&#160;integrity&#160;–&#160;optional&#160;with&#160;additional&#160;restric-<br/>tions</p>
<p style="position:absolute;top:429px;left:259px;white-space:nowrap" class="ft5954">rest</p>
<p style="position:absolute;top:429px;left:289px;white-space:nowrap" class="ft5911">(e.g.,&#160;freshness,&#160;certain&#160;user&#160;id).</p>
<p style="position:absolute;top:429px;left:485px;white-space:nowrap" class="ft5954">SM</p>
<p style="position:absolute;top:429px;left:516px;white-space:nowrap" class="ft5911">invokes&#160;the&#160;Compartment&#160;Manager&#160;to</p>
<p style="position:absolute;top:447px;left:226px;white-space:nowrap" class="ft5913">retrieve&#160;the&#160;actual&#160;configuration&#160;of&#160;the&#160;respective&#160;compartment&#160;to&#160;bind&#160;the&#160;data&#160;object<br/>to&#160;that&#160;compartment&#160;configuration</p>
<p style="position:absolute;top:464px;left:438px;white-space:nowrap" class="ft5954">cmp</p>
<p style="position:absolute;top:465px;left:465px;white-space:nowrap" class="ft5911">-</p>
<p style="position:absolute;top:464px;left:470px;white-space:nowrap" class="ft5954">conf</p>
<p style="position:absolute;top:465px;left:502px;white-space:nowrap" class="ft5911">.</p>
<p style="position:absolute;top:464px;left:514px;white-space:nowrap" class="ft5954">SM</p>
<p style="position:absolute;top:465px;left:544px;white-space:nowrap" class="ft5911">creates/updates&#160;a&#160;metadata&#160;entry</p>
<p style="position:absolute;top:483px;left:226px;white-space:nowrap" class="ft5911">for&#160;the&#160;corresponding&#160;data&#160;object</p>
<p style="position:absolute;top:482px;left:426px;white-space:nowrap" class="ft5954">data</p>
<p style="position:absolute;top:483px;left:458px;white-space:nowrap" class="ft5911">with&#160;the&#160;data&#160;object&#160;identifier</p>
<p style="position:absolute;top:482px;left:636px;white-space:nowrap" class="ft5954">data</p>
<p style="position:absolute;top:488px;left:665px;white-space:nowrap" class="ft5961">ID</p>
<p style="position:absolute;top:483px;left:682px;white-space:nowrap" class="ft5911">,&#160;its&#160;fresh-</p>
<p style="position:absolute;top:501px;left:226px;white-space:nowrap" class="ft5911">ness&#160;detection&#160;information</p>
<p style="position:absolute;top:500px;left:389px;white-space:nowrap" class="ft5954">f</p>
<p style="position:absolute;top:501px;left:398px;white-space:nowrap" class="ft5911">,&#160;i.e.,&#160;the&#160;actual&#160;cryptographic&#160;hash&#160;value,&#160;and&#160;all&#160;relevant</p>
<p style="position:absolute;top:519px;left:226px;white-space:nowrap" class="ft5911">access&#160;restrictions</p>
<p style="position:absolute;top:518px;left:338px;white-space:nowrap" class="ft5954">res<a href="Open_TC_D05.2_SecServicesPoC.html#59">t</a></p>
<p style="position:absolute;top:516px;left:365px;white-space:nowrap" class="ft5929"><a href="Open_TC_D05.2_SecServicesPoC.html#59">10</a></p>
<p style="position:absolute;top:519px;left:380px;white-space:nowrap" class="ft5911">within&#160;its&#160;index</p>
<p style="position:absolute;top:518px;left:477px;white-space:nowrap" class="ft5954">index</p>
<p style="position:absolute;top:524px;left:514px;white-space:nowrap" class="ft5961">SM</p>
<p style="position:absolute;top:519px;left:536px;white-space:nowrap" class="ft5911">.</p>
<p style="position:absolute;top:518px;left:544px;white-space:nowrap" class="ft5954">SM</p>
<p style="position:absolute;top:519px;left:574px;white-space:nowrap" class="ft5911">extends&#160;the&#160;data&#160;object&#160;with</p>
<p style="position:absolute;top:537px;left:226px;white-space:nowrap" class="ft5911">integrity&#160;verification&#160;information,&#160;synchronises&#160;its&#160;monotonic&#160;counter</p>
<p style="position:absolute;top:536px;left:642px;white-space:nowrap" class="ft5954">cnt</p>
<p style="position:absolute;top:542px;left:663px;white-space:nowrap" class="ft5961">SM</p>
<p style="position:absolute;top:537px;left:684px;white-space:nowrap" class="ft5911">,&#160;encrypts</p>
<p style="position:absolute;top:555px;left:226px;white-space:nowrap" class="ft5911">the&#160;data&#160;object&#160;and&#160;the&#160;updated&#160;index&#160;and&#160;writes&#160;it&#160;on&#160;untrusted&#160;persistent&#160;storage&#160;using</p>
<p style="position:absolute;top:572px;left:226px;white-space:nowrap" class="ft5954">key</p>
<p style="position:absolute;top:578px;left:249px;white-space:nowrap" class="ft5961">SM</p>
<p style="position:absolute;top:573px;left:270px;white-space:nowrap" class="ft5911">.&#160;Since</p>
<p style="position:absolute;top:572px;left:317px;white-space:nowrap" class="ft5954">index</p>
<p style="position:absolute;top:578px;left:354px;white-space:nowrap" class="ft5961">SM</p>
<p style="position:absolute;top:573px;left:380px;white-space:nowrap" class="ft5911">is&#160;the&#160;base&#160;of&#160;security&#160;for</p>
<p style="position:absolute;top:572px;left:537px;white-space:nowrap" class="ft5954">SM</p>
<p style="position:absolute;top:573px;left:563px;white-space:nowrap" class="ft5911">,</p>
<p style="position:absolute;top:572px;left:571px;white-space:nowrap" class="ft5954">index</p>
<p style="position:absolute;top:578px;left:609px;white-space:nowrap" class="ft5961">SM</p>
<p style="position:absolute;top:573px;left:634px;white-space:nowrap" class="ft5911">is&#160;sealed&#160;to</p>
<p style="position:absolute;top:572px;left:705px;white-space:nowrap" class="ft5954">SM</p>
<p style="position:absolute;top:573px;left:732px;white-space:nowrap" class="ft5911">’s</p>
<p style="position:absolute;top:591px;left:226px;white-space:nowrap" class="ft5911">configuration&#160;via&#160;the&#160;sealed</p>
<p style="position:absolute;top:590px;left:392px;white-space:nowrap" class="ft5954">key</p>
<p style="position:absolute;top:596px;left:415px;white-space:nowrap" class="ft5961">SM</p>
<p style="position:absolute;top:591px;left:436px;white-space:nowrap" class="ft5911">.&#160;Thus&#160;only&#160;the&#160;same,&#160;trusted&#160;Storage&#160;Manager&#160;con-</p>
<p style="position:absolute;top:608px;left:226px;white-space:nowrap" class="ft5911">figuration&#160;is&#160;able&#160;to&#160;unseal&#160;and&#160;use&#160;the&#160;key&#160;again.&#160;On&#160;a&#160;load&#160;request,</p>
<p style="position:absolute;top:608px;left:649px;white-space:nowrap" class="ft5954">SM</p>
<p style="position:absolute;top:608px;left:679px;white-space:nowrap" class="ft5911">again&#160;uses</p>
<p style="position:absolute;top:626px;left:226px;white-space:nowrap" class="ft5912">the&#160;Compartment&#160;Manager&#160;to&#160;compare&#160;the&#160;invoking&#160;compartment&#160;configuration&#160;with<br/>the&#160;one&#160;that&#160;afore&#160;stored&#160;the&#160;respective&#160;data&#160;object.&#160;On&#160;a&#160;successful&#160;verification,</p>
<p style="position:absolute;top:644px;left:716px;white-space:nowrap" class="ft5954">SM</p>
<p style="position:absolute;top:662px;left:226px;white-space:nowrap" class="ft5912">reads&#160;and&#160;decrypts&#160;the&#160;data&#160;object&#160;from&#160;the&#160;untrusted&#160;persistent&#160;storage&#160;and&#160;verifies&#160;its<br/>integrity.&#160;Before&#160;the&#160;data&#160;object&#160;is&#160;committed&#160;to&#160;the&#160;requesting&#160;compartment,</p>
<p style="position:absolute;top:680px;left:688px;white-space:nowrap" class="ft5954">SM</p>
<p style="position:absolute;top:680px;left:717px;white-space:nowrap" class="ft5911">also</p>
<p style="position:absolute;top:698px;left:226px;white-space:nowrap" class="ft5911">verifies&#160;possibly&#160;existing&#160;additional&#160;restrictions&#160;such&#160;as&#160;freshness&#160;or&#160;a&#160;certain&#160;user&#160;id.</p>
<p style="position:absolute;top:716px;left:248px;white-space:nowrap" class="ft5917"><i>Trusted&#160;Storage:</i></p>
<p style="position:absolute;top:716px;left:354px;white-space:nowrap" class="ft5954">SM</p>
<p style="position:absolute;top:716px;left:385px;white-space:nowrap" class="ft5911">offers&#160;trusted&#160;storage&#160;to&#160;bind&#160;compartment’s&#160;data&#160;to&#160;the&#160;the</p>
<p style="position:absolute;top:734px;left:226px;white-space:nowrap" class="ft5911">origin&#160;compartment&#160;while&#160;preserving&#160;integrity&#160;and&#160;confidentiality.&#160;Therefore</p>
<p style="position:absolute;top:734px;left:686px;white-space:nowrap" class="ft5954">SM</p>
<p style="position:absolute;top:734px;left:716px;white-space:nowrap" class="ft5911">uses</p>
<p style="position:absolute;top:752px;left:226px;white-space:nowrap" class="ft5911">a&#160;cryptographic&#160;hash&#160;functio<a href="Open_TC_D05.2_SecServicesPoC.html#59">n</a></p>
<p style="position:absolute;top:750px;left:403px;white-space:nowrap" class="ft5929"><a href="Open_TC_D05.2_SecServicesPoC.html#59">11</a></p>
<p style="position:absolute;top:752px;left:417px;white-space:nowrap" class="ft5911">to&#160;calculate&#160;the&#160;data&#160;object’s&#160;hash&#160;value&#160;and&#160;a&#160;symmet-</p>
<p style="position:absolute;top:770px;left:226px;white-space:nowrap" class="ft5911">ric&#160;ciphe<a href="Open_TC_D05.2_SecServicesPoC.html#59">r</a></p>
<p style="position:absolute;top:768px;left:284px;white-space:nowrap" class="ft5929"><a href="Open_TC_D05.2_SecServicesPoC.html#59">12</a></p>
<p style="position:absolute;top:770px;left:298px;white-space:nowrap" class="ft5911">with&#160;its&#160;internal&#160;cryptographic&#160;secret</p>
<p style="position:absolute;top:769px;left:523px;white-space:nowrap" class="ft5954">key</p>
<p style="position:absolute;top:775px;left:546px;white-space:nowrap" class="ft5961">SM</p>
<p style="position:absolute;top:770px;left:571px;white-space:nowrap" class="ft5911">bound&#160;to&#160;its&#160;configuration&#160;to</p>
<p style="position:absolute;top:788px;left:226px;white-space:nowrap" class="ft5912">encrypt&#160;data&#160;objects&#160;together&#160;with&#160;their&#160;actual&#160;hash&#160;values&#160;before&#160;become&#160;written&#160;on<br/>untrusted&#160;persistent&#160;storage&#160;providing&#160;at&#160;least&#160;availability.&#160;This&#160;key&#160;in&#160;turn&#160;is&#160;sealed&#160;to<br/>the&#160;configuration&#160;of</p>
<p style="position:absolute;top:823px;left:348px;white-space:nowrap" class="ft5954">SM</p>
<p style="position:absolute;top:824px;left:378px;white-space:nowrap" class="ft5911">using&#160;functionality&#160;of&#160;the&#160;TPM&#160;so&#160;that&#160;only&#160;the&#160;same,&#160;trusted</p>
<p style="position:absolute;top:842px;left:226px;white-space:nowrap" class="ft5913">Storage&#160;Manager&#160;configuration&#160;is&#160;able&#160;to&#160;unseal&#160;and&#160;use&#160;the&#160;key&#160;again.&#160;On&#160;load,&#160;the<br/>data&#160;object&#160;becomes&#160;decrypted&#160;and&#160;verified&#160;for&#160;integrity&#160;using&#160;the&#160;appended&#160;hash&#160;value.<br/>Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#60">3.2&#160;</a>depicts&#160;our&#160;trusted&#160;storage&#160;implementation.&#160;Thus,&#160;our&#160;trusted&#160;storage&#160;com-<br/>partment&#160;basically&#160;offers&#160;two&#160;trusted&#160;channels&#160;namely</p>
<p style="position:absolute;top:895px;left:563px;white-space:nowrap" class="ft5962">load</p>
<p style="position:absolute;top:894px;left:589px;white-space:nowrap" class="ft5955">[]</p>
<p style="position:absolute;top:895px;left:603px;white-space:nowrap" class="ft5911">and</p>
<p style="position:absolute;top:895px;left:630px;white-space:nowrap" class="ft5962">store</p>
<p style="position:absolute;top:894px;left:660px;white-space:nowrap" class="ft5955">[]</p>
<p style="position:absolute;top:895px;left:673px;white-space:nowrap" class="ft5911">while&#160;itself</p>
<p style="position:absolute;top:913px;left:226px;white-space:nowrap" class="ft5911">uses&#160;two&#160;<i>untrusted&#160;</i>channels&#160;namely</p>
<p style="position:absolute;top:913px;left:446px;white-space:nowrap" class="ft5962">read</p>
<p style="position:absolute;top:912px;left:473px;white-space:nowrap" class="ft5955">[]</p>
<p style="position:absolute;top:913px;left:485px;white-space:nowrap" class="ft5911">and</p>
<p style="position:absolute;top:913px;left:511px;white-space:nowrap" class="ft5962">write</p>
<p style="position:absolute;top:912px;left:542px;white-space:nowrap" class="ft5955">[]</p>
<p style="position:absolute;top:913px;left:554px;white-space:nowrap" class="ft5911">from&#160;an&#160;untrusted&#160;storage&#160;com-</p>
<p style="position:absolute;top:931px;left:226px;white-space:nowrap" class="ft5913">partment&#160;to&#160;persistently&#160;write&#160;respectively&#160;read&#160;data&#160;while&#160;providing&#160;at&#160;least&#160;availabil-<br/>ity<a href="Open_TC_D05.2_SecServicesPoC.html#59">.</a></p>
<p style="position:absolute;top:947px;left:245px;white-space:nowrap" class="ft5929"><a href="Open_TC_D05.2_SecServicesPoC.html#59">13</a></p>
<p style="position:absolute;top:949px;left:263px;white-space:nowrap" class="ft5911">If</p>
<p style="position:absolute;top:949px;left:278px;white-space:nowrap" class="ft5954">SM</p>
<p style="position:absolute;top:949px;left:309px;white-space:nowrap" class="ft5911">receives&#160;a&#160;data&#160;object</p>
<p style="position:absolute;top:949px;left:444px;white-space:nowrap" class="ft59104">data</p>
<p style="position:absolute;top:949px;left:477px;white-space:nowrap" class="ft5911">via</p>
<p style="position:absolute;top:949px;left:500px;white-space:nowrap" class="ft5962">store</p>
<p style="position:absolute;top:948px;left:530px;white-space:nowrap" class="ft5955">[</p>
<p style="position:absolute;top:949px;left:534px;white-space:nowrap" class="ft59104">data</p>
<p style="position:absolute;top:949px;left:563px;white-space:nowrap" class="ft5954">,</p>
<p style="position:absolute;top:949px;left:570px;white-space:nowrap" class="ft59104">rest</p>
<p style="position:absolute;top:948px;left:595px;white-space:nowrap" class="ft5955">]</p>
<p style="position:absolute;top:949px;left:599px;white-space:nowrap" class="ft5911">,</p>
<p style="position:absolute;top:949px;left:608px;white-space:nowrap" class="ft5954">SM</p>
<p style="position:absolute;top:949px;left:638px;white-space:nowrap" class="ft5911">internally&#160;creates</p>
<p style="position:absolute;top:977px;left:238px;white-space:nowrap" class="ft5931">10</p>
<p style="position:absolute;top:979px;left:248px;white-space:nowrap" class="ft5916">Further&#160;access&#160;restrictions&#160;can&#160;be&#160;a&#160;certain&#160;user&#160;id,&#160;group&#160;id&#160;or&#160;date&#160;of&#160;expiry.</p>
<p style="position:absolute;top:991px;left:238px;white-space:nowrap" class="ft5931">11</p>
<p style="position:absolute;top:993px;left:248px;white-space:nowrap" class="ft5916">Our&#160;implementation&#160;uses&#160;SHA-1&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#70">[20]</a>.</p>
<p style="position:absolute;top:1006px;left:238px;white-space:nowrap" class="ft5931">12</p>
<p style="position:absolute;top:1008px;left:248px;white-space:nowrap" class="ft5916">Our&#160;implementation&#160;uses&#160;AES&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#70">[19]</a>.</p>
<p style="position:absolute;top:1020px;left:238px;white-space:nowrap" class="ft5931">13</p>
<p style="position:absolute;top:1022px;left:248px;white-space:nowrap" class="ft5916">For&#160;the&#160;realisation&#160;of&#160;availability&#160;we&#160;suggest&#160;solutions&#160;based&#160;on&#160;high&#160;redundancy,&#160;i.e.,&#160;by&#160;the&#160;utilisation</p>
<p style="position:absolute;top:1037px;left:226px;white-space:nowrap" class="ft59103">of&#160;multiple&#160;distributed&#160;storage&#160;locations&#160;(e.g.,&#160;USB&#160;sticks&#160;or&#160;online&#160;sites)&#160;assisted&#160;by&#160;an&#160;appropriate&#160;RAID<br/>system.&#160;In&#160;case&#160;of&#160;failure&#160;of&#160;a&#160;particular&#160;storage&#160;device,&#160;it&#160;is&#160;still&#160;possible&#160;to&#160;retrieve&#160;data&#160;from&#160;alternative<br/>storage&#160;mirrors.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft5918">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 60 -->
<a name="60"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft60105{font-size:10px;font-family:YSNTTQ+CMTI7;color:#231f20;}
	.ft60106{font-size:8px;font-family:WINDHK+Arial;color:#000000;}
	.ft60107{font-size:5px;font-family:GIYRNY+MSReferenceSansSerif;color:#000000;}
	.ft60108{font-size:7px;font-family:GIYRNY+MSReferenceSansSerif;color:#000000;}
	.ft60109{font-size:8px;font-family:XGQFDG+TimesNewRoman;color:#000000;}
	.ft60110{font-size:8px;font-family:GIYRNY+MSReferenceSansSerif;color:#000000;}
	.ft60111{font-size:5px;font-family:XGQFDG+TimesNewRoman;color:#000000;}
	.ft60112{font-size:7px;font-family:WINDHK+Arial;color:#000000;}
-->
</style>
<div id="page60-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC060.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft6011">58</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft6018">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft6011">or&#160;updates&#160;object’s&#160;metadat<a href="Open_TC_D05.2_SecServicesPoC.html#60">a</a></p>
<p style="position:absolute;top:191px;left:321px;white-space:nowrap" class="ft6029"><a href="Open_TC_D05.2_SecServicesPoC.html#60">14</a></p>
<p style="position:absolute;top:194px;left:336px;white-space:nowrap" class="ft6011">and&#160;calculates&#160;its&#160;hash&#160;value</p>
<p style="position:absolute;top:193px;left:510px;white-space:nowrap" class="ft60104">i</p>
<p style="position:absolute;top:194px;left:521px;white-space:nowrap" class="ft6011">to&#160;verify&#160;integrity.&#160;Then</p>
<p style="position:absolute;top:211px;left:150px;white-space:nowrap" class="ft60104">data</p>
<p style="position:absolute;top:212px;left:183px;white-space:nowrap" class="ft6011">together&#160;with</p>
<p style="position:absolute;top:211px;left:267px;white-space:nowrap" class="ft60104">i</p>
<p style="position:absolute;top:212px;left:278px;white-space:nowrap" class="ft6011">is&#160;encrypted&#160;with&#160;the&#160;internal&#160;cryptographic&#160;secret</p>
<p style="position:absolute;top:211px;left:585px;white-space:nowrap" class="ft6054">key</p>
<p style="position:absolute;top:217px;left:608px;white-space:nowrap" class="ft6061">SM</p>
<p style="position:absolute;top:212px;left:633px;white-space:nowrap" class="ft6011">using</p>
<p style="position:absolute;top:230px;left:150px;white-space:nowrap" class="ft6011">the&#160;function</p>
<p style="position:absolute;top:229px;left:227px;white-space:nowrap" class="ft60104">e</p>
<p style="position:absolute;top:229px;left:240px;white-space:nowrap" class="ft6055">:=</p>
<p style="position:absolute;top:229px;left:262px;white-space:nowrap" class="ft6062">encrypt</p>
<p style="position:absolute;top:229px;left:308px;white-space:nowrap" class="ft6055">[</p>
<p style="position:absolute;top:229px;left:312px;white-space:nowrap" class="ft60104">data</p>
<p style="position:absolute;top:229px;left:341px;white-space:nowrap" class="ft6030">||</p>
<p style="position:absolute;top:229px;left:349px;white-space:nowrap" class="ft60104">i</p>
<p style="position:absolute;top:229px;left:355px;white-space:nowrap" class="ft6055">]</p>
<p style="position:absolute;top:230px;left:364px;white-space:nowrap" class="ft6011">(to&#160;provide&#160;confidentiality).&#160;The&#160;encrypted&#160;data</p>
<p style="position:absolute;top:229px;left:657px;white-space:nowrap" class="ft60104">e</p>
<p style="position:absolute;top:247px;left:150px;white-space:nowrap" class="ft6011">will&#160;afterwards&#160;be&#160;written&#160;on&#160;untrusted&#160;storage&#160;using</p>
<p style="position:absolute;top:247px;left:477px;white-space:nowrap" class="ft60104">data</p>
<p style="position:absolute;top:253px;left:505px;white-space:nowrap" class="ft60105">ID</p>
<p style="position:absolute;top:246px;left:525px;white-space:nowrap" class="ft6055">:=</p>
<p style="position:absolute;top:247px;left:545px;white-space:nowrap" class="ft6062">write</p>
<p style="position:absolute;top:246px;left:576px;white-space:nowrap" class="ft6055">[</p>
<p style="position:absolute;top:247px;left:580px;white-space:nowrap" class="ft60104">e</p>
<p style="position:absolute;top:246px;left:588px;white-space:nowrap" class="ft6055">]</p>
<p style="position:absolute;top:247px;left:597px;white-space:nowrap" class="ft6011">that&#160;returns</p>
<p style="position:absolute;top:265px;left:150px;white-space:nowrap" class="ft6011">the&#160;object&#160;identifier</p>
<p style="position:absolute;top:265px;left:274px;white-space:nowrap" class="ft60104">data</p>
<p style="position:absolute;top:271px;left:302px;white-space:nowrap" class="ft60105">ID</p>
<p style="position:absolute;top:265px;left:318px;white-space:nowrap" class="ft6011">.&#160;Conversely,&#160;if</p>
<p style="position:absolute;top:265px;left:421px;white-space:nowrap" class="ft60104">e</p>
<p style="position:absolute;top:265px;left:434px;white-space:nowrap" class="ft6011">is&#160;read&#160;from&#160;the&#160;untrusted&#160;storage&#160;via</p>
<p style="position:absolute;top:283px;left:150px;white-space:nowrap" class="ft60104">e</p>
<p style="position:absolute;top:282px;left:163px;white-space:nowrap" class="ft6055">:=</p>
<p style="position:absolute;top:283px;left:183px;white-space:nowrap" class="ft6062">read</p>
<p style="position:absolute;top:282px;left:210px;white-space:nowrap" class="ft6055">[</p>
<p style="position:absolute;top:283px;left:214px;white-space:nowrap" class="ft60104">data</p>
<p style="position:absolute;top:288px;left:242px;white-space:nowrap" class="ft60105">ID</p>
<p style="position:absolute;top:282px;left:258px;white-space:nowrap" class="ft6055">]</p>
<p style="position:absolute;top:283px;left:266px;white-space:nowrap" class="ft6011">it&#160;will&#160;be&#160;decrypted&#160;to</p>
<p style="position:absolute;top:283px;left:403px;white-space:nowrap" class="ft60104">data</p>
<p style="position:absolute;top:283px;left:436px;white-space:nowrap" class="ft6011">and</p>
<p style="position:absolute;top:283px;left:462px;white-space:nowrap" class="ft60104">i</p>
<p style="position:absolute;top:283px;left:472px;white-space:nowrap" class="ft6011">via</p>
<p style="position:absolute;top:283px;left:494px;white-space:nowrap" class="ft6062">decrypt</p>
<p style="position:absolute;top:282px;left:540px;white-space:nowrap" class="ft6055">[</p>
<p style="position:absolute;top:283px;left:544px;white-space:nowrap" class="ft60104">e</p>
<p style="position:absolute;top:282px;left:552px;white-space:nowrap" class="ft6055">]</p>
<p style="position:absolute;top:283px;left:561px;white-space:nowrap" class="ft6011">using&#160;the&#160;internal</p>
<p style="position:absolute;top:301px;left:150px;white-space:nowrap" class="ft6011">cryptographic&#160;secret</p>
<p style="position:absolute;top:301px;left:274px;white-space:nowrap" class="ft6054">key</p>
<p style="position:absolute;top:306px;left:297px;white-space:nowrap" class="ft6061">SM</p>
<p style="position:absolute;top:301px;left:318px;white-space:nowrap" class="ft6011">.&#160;Before&#160;returning</p>
<p style="position:absolute;top:301px;left:428px;white-space:nowrap" class="ft60104">data</p>
<p style="position:absolute;top:301px;left:461px;white-space:nowrap" class="ft6011">to</p>
<p style="position:absolute;top:301px;left:476px;white-space:nowrap" class="ft6062">load</p>
<p style="position:absolute;top:300px;left:502px;white-space:nowrap" class="ft6055">[]</p>
<p style="position:absolute;top:301px;left:510px;white-space:nowrap" class="ft6011">,</p>
<p style="position:absolute;top:301px;left:517px;white-space:nowrap" class="ft6054">SM</p>
<p style="position:absolute;top:301px;left:546px;white-space:nowrap" class="ft6011">verifies&#160;the&#160;integrity</p>
<p style="position:absolute;top:319px;left:150px;white-space:nowrap" class="ft6011">of</p>
<p style="position:absolute;top:319px;left:166px;white-space:nowrap" class="ft60104">data</p>
<p style="position:absolute;top:319px;left:198px;white-space:nowrap" class="ft6011">and&#160;further&#160;access&#160;restrictions&#160;(e.g.,&#160;a&#160;certain&#160;user&#160;id)&#160;based&#160;on&#160;the&#160;correspond-</p>
<p style="position:absolute;top:337px;left:150px;white-space:nowrap" class="ft6011">ing&#160;metadata&#160;in</p>
<p style="position:absolute;top:336px;left:246px;white-space:nowrap" class="ft6054">SM</p>
<p style="position:absolute;top:337px;left:272px;white-space:nowrap" class="ft6011">’s&#160;index&#160;using&#160;the&#160;function</p>
<p style="position:absolute;top:336px;left:434px;white-space:nowrap" class="ft6062">verify</p>
<p style="position:absolute;top:336px;left:468px;white-space:nowrap" class="ft6055">[</p>
<p style="position:absolute;top:337px;left:472px;white-space:nowrap" class="ft60104">data</p>
<p style="position:absolute;top:336px;left:501px;white-space:nowrap" class="ft6054">,</p>
<p style="position:absolute;top:336px;left:508px;white-space:nowrap" class="ft6062">i</p>
<p style="position:absolute;top:336px;left:511px;white-space:nowrap" class="ft6055">]</p>
<p style="position:absolute;top:337px;left:515px;white-space:nowrap" class="ft6011">.</p>
<p style="position:absolute;top:523px;left:321px;white-space:nowrap" class="ft60106">Storage&#160;Manager</p>
<p style="position:absolute;top:453px;left:184px;white-space:nowrap" class="ft60107">Freshness</p>
<p style="position:absolute;top:482px;left:184px;white-space:nowrap" class="ft60107">Integrity</p>
<p style="position:absolute;top:510px;left:184px;white-space:nowrap" class="ft60107">Confidentiality</p>
<p style="position:absolute;top:583px;left:585px;white-space:nowrap" class="ft60108">Trusted&#160;Channel</p>
<p style="position:absolute;top:498px;left:196px;white-space:nowrap" class="ft60109">e</p>
<p style="position:absolute;top:497px;left:199px;white-space:nowrap" class="ft60110">&#160;:=&#160;encrypt[</p>
<p style="position:absolute;top:498px;left:246px;white-space:nowrap" class="ft60109">d&#160;||i</p>
<p style="position:absolute;top:497px;left:259px;white-space:nowrap" class="ft60110">]</p>
<p style="position:absolute;top:558px;left:449px;white-space:nowrap" class="ft60109">e</p>
<p style="position:absolute;top:557px;left:453px;white-space:nowrap" class="ft60110">&#160;:=&#160;read[</p>
<p style="position:absolute;top:558px;left:488px;white-space:nowrap" class="ft60109">d</p>
<p style="position:absolute;top:561px;left:492px;white-space:nowrap" class="ft60111">ID</p>
<p style="position:absolute;top:557px;left:498px;white-space:nowrap" class="ft60110">]</p>
<p style="position:absolute;top:552px;left:204px;white-space:nowrap" class="ft60109">d</p>
<p style="position:absolute;top:555px;left:208px;white-space:nowrap" class="ft60111">ID</p>
<p style="position:absolute;top:551px;left:215px;white-space:nowrap" class="ft60110">:=write[</p>
<p style="position:absolute;top:552px;left:248px;white-space:nowrap" class="ft60109">e</p>
<p style="position:absolute;top:551px;left:251px;white-space:nowrap" class="ft60110">]</p>
<p style="position:absolute;top:571px;left:591px;white-space:nowrap" class="ft60108">Plain&#160;Channel</p>
<p style="position:absolute;top:498px;left:442px;white-space:nowrap" class="ft60109">d&#160;||i</p>
<p style="position:absolute;top:497px;left:454px;white-space:nowrap" class="ft60110">&#160;:=&#160;decrypt[</p>
<p style="position:absolute;top:498px;left:502px;white-space:nowrap" class="ft60109">e</p>
<p style="position:absolute;top:497px;left:505px;white-space:nowrap" class="ft60110">]</p>
<p style="position:absolute;top:469px;left:205px;white-space:nowrap" class="ft60109">i</p>
<p style="position:absolute;top:469px;left:207px;white-space:nowrap" class="ft60110">&#160;:=&#160;hash[</p>
<p style="position:absolute;top:469px;left:244px;white-space:nowrap" class="ft60109">d</p>
<p style="position:absolute;top:469px;left:250px;white-space:nowrap" class="ft60110">]</p>
<p style="position:absolute;top:469px;left:440px;white-space:nowrap" class="ft60110">A/R&#160;:=&#160;verify[</p>
<p style="position:absolute;top:470px;left:495px;white-space:nowrap" class="ft60109">d,&#160;i</p>
<p style="position:absolute;top:469px;left:506px;white-space:nowrap" class="ft60110">]</p>
<p style="position:absolute;top:579px;left:315px;white-space:nowrap" class="ft60110">Untrusted&#160;Storage</p>
<p style="position:absolute;top:403px;left:450px;white-space:nowrap" class="ft60109">d</p>
<p style="position:absolute;top:403px;left:456px;white-space:nowrap" class="ft60110">:=&#160;load[</p>
<p style="position:absolute;top:403px;left:488px;white-space:nowrap" class="ft60109">d</p>
<p style="position:absolute;top:406px;left:492px;white-space:nowrap" class="ft60111">ID</p>
<p style="position:absolute;top:403px;left:499px;white-space:nowrap" class="ft60110">]</p>
<p style="position:absolute;top:402px;left:195px;white-space:nowrap" class="ft60109">d</p>
<p style="position:absolute;top:405px;left:199px;white-space:nowrap" class="ft60111">ID</p>
<p style="position:absolute;top:402px;left:206px;white-space:nowrap" class="ft60110">:=&#160;store[</p>
<p style="position:absolute;top:402px;left:241px;white-space:nowrap" class="ft60109">d,&#160;rest</p>
<p style="position:absolute;top:402px;left:262px;white-space:nowrap" class="ft60110">]</p>
<p style="position:absolute;top:440px;left:195px;white-space:nowrap" class="ft60109">f&#160;</p>
<p style="position:absolute;top:439px;left:199px;white-space:nowrap" class="ft60110">:=&#160;memorize[</p>
<p style="position:absolute;top:440px;left:254px;white-space:nowrap" class="ft60109">d</p>
<p style="position:absolute;top:439px;left:259px;white-space:nowrap" class="ft60110">]</p>
<p style="position:absolute;top:441px;left:440px;white-space:nowrap" class="ft60110">A/R&#160;:=&#160;verify[</p>
<p style="position:absolute;top:441px;left:495px;white-space:nowrap" class="ft60109">d,&#160;f</p>
<p style="position:absolute;top:441px;left:506px;white-space:nowrap" class="ft60110">]</p>
<p style="position:absolute;top:374px;left:328px;white-space:nowrap" class="ft60106">Compartment</p>
<p style="position:absolute;top:450px;left:279px;white-space:nowrap" class="ft60109">cmp_conf</p>
<p style="position:absolute;top:450px;left:328px;white-space:nowrap" class="ft60109">d</p>
<p style="position:absolute;top:453px;left:331px;white-space:nowrap" class="ft60111">ID</p>
<p style="position:absolute;top:450px;left:367px;white-space:nowrap" class="ft60109">f</p>
<p style="position:absolute;top:450px;left:399px;white-space:nowrap" class="ft60109">rest</p>
<p style="position:absolute;top:464px;left:285px;white-space:nowrap" class="ft60112">CP_0</p>
<p style="position:absolute;top:464px;left:321px;white-space:nowrap" class="ft60112">ID_325</p>
<p style="position:absolute;top:464px;left:358px;white-space:nowrap" class="ft60112">0x29...</p>
<p style="position:absolute;top:464px;left:397px;white-space:nowrap" class="ft60112">fresh</p>
<p style="position:absolute;top:478px;left:285px;white-space:nowrap" class="ft60112">CP_1</p>
<p style="position:absolute;top:478px;left:321px;white-space:nowrap" class="ft60112">ID_563</p>
<p style="position:absolute;top:478px;left:358px;white-space:nowrap" class="ft60112">0x10...</p>
<p style="position:absolute;top:478px;left:393px;white-space:nowrap" class="ft60112">UID&#160;=&#160;2</p>
<p style="position:absolute;top:493px;left:343px;white-space:nowrap" class="ft60109">c</p>
<p style="position:absolute;top:496px;left:347px;white-space:nowrap" class="ft60107">SM</p>
<p style="position:absolute;top:507px;left:343px;white-space:nowrap" class="ft60109">k</p>
<p style="position:absolute;top:510px;left:347px;white-space:nowrap" class="ft60107">SM</p>
<p style="position:absolute;top:435px;left:344px;white-space:nowrap" class="ft60109">i</p>
<p style="position:absolute;top:438px;left:346px;white-space:nowrap" class="ft60107">SM</p>
<p style="position:absolute;top:634px;left:259px;white-space:nowrap" class="ft6011">Figure&#160;3.2:&#160;The&#160;Storage&#160;Manager&#160;Implementation</p>
<p style="position:absolute;top:667px;left:172px;white-space:nowrap" class="ft6011">In&#160;order&#160;to&#160;provide&#160;fresh&#160;trusted&#160;storage,&#160;we&#160;enhance</p>
<p style="position:absolute;top:667px;left:501px;white-space:nowrap" class="ft6054">SM</p>
<p style="position:absolute;top:667px;left:532px;white-space:nowrap" class="ft6011">by&#160;an&#160;additional&#160;layer</p>
<p style="position:absolute;top:685px;left:150px;white-space:nowrap" class="ft6012">for&#160;managing&#160;freshness&#160;of&#160;data&#160;objects.&#160;This&#160;extension&#160;consists&#160;of&#160;a&#160;(currently&#160;ab-<br/>stract)&#160;function</p>
<p style="position:absolute;top:702px;left:245px;white-space:nowrap" class="ft6054">f</p>
<p style="position:absolute;top:702px;left:259px;white-space:nowrap" class="ft6055">:=</p>
<p style="position:absolute;top:702px;left:279px;white-space:nowrap" class="ft6062">memorise</p>
<p style="position:absolute;top:702px;left:338px;white-space:nowrap" class="ft6055">[</p>
<p style="position:absolute;top:703px;left:342px;white-space:nowrap" class="ft60104">data</p>
<p style="position:absolute;top:702px;left:371px;white-space:nowrap" class="ft6055">]</p>
<p style="position:absolute;top:703px;left:379px;white-space:nowrap" class="ft6011">that&#160;updates&#160;the&#160;internal&#160;data&#160;structure</p>
<p style="position:absolute;top:703px;left:613px;white-space:nowrap" class="ft60104">FRESH</p>
<p style="position:absolute;top:721px;left:150px;white-space:nowrap" class="ft6011">with&#160;the&#160;freshness&#160;value</p>
<p style="position:absolute;top:720px;left:296px;white-space:nowrap" class="ft6054">f</p>
<p style="position:absolute;top:721px;left:305px;white-space:nowrap" class="ft6011">.&#160;Afterwards,</p>
<p style="position:absolute;top:721px;left:387px;white-space:nowrap" class="ft60104">data</p>
<p style="position:absolute;top:721px;left:420px;white-space:nowrap" class="ft6011">will&#160;be&#160;stored&#160;persistently&#160;ensuring&#160;confi-</p>
<p style="position:absolute;top:739px;left:150px;white-space:nowrap" class="ft6011">dentiality&#160;and&#160;integrity&#160;using&#160;secure&#160;storage.&#160;On&#160;load&#160;from&#160;secure&#160;storage,&#160;the&#160;function</p>
<p style="position:absolute;top:756px;left:150px;white-space:nowrap" class="ft6062">verify</p>
<p style="position:absolute;top:756px;left:183px;white-space:nowrap" class="ft6055">[</p>
<p style="position:absolute;top:756px;left:188px;white-space:nowrap" class="ft60104">data</p>
<p style="position:absolute;top:756px;left:217px;white-space:nowrap" class="ft6054">,</p>
<p style="position:absolute;top:756px;left:224px;white-space:nowrap" class="ft6062">f</p>
<p style="position:absolute;top:756px;left:229px;white-space:nowrap" class="ft6055">]</p>
<p style="position:absolute;top:757px;left:237px;white-space:nowrap" class="ft6011">additional&#160;verifies&#160;that&#160;the&#160;received&#160;data&#160;object</p>
<p style="position:absolute;top:756px;left:516px;white-space:nowrap" class="ft60104">data</p>
<p style="position:absolute;top:757px;left:548px;white-space:nowrap" class="ft6011">is&#160;the&#160;last&#160;one&#160;being</p>
<p style="position:absolute;top:775px;left:150px;white-space:nowrap" class="ft6011">stored.</p>
<p style="position:absolute;top:793px;left:172px;white-space:nowrap" class="ft6011">To&#160;provide&#160;such&#160;freshness&#160;detection,</p>
<p style="position:absolute;top:792px;left:393px;white-space:nowrap" class="ft6054">SM</p>
<p style="position:absolute;top:793px;left:423px;white-space:nowrap" class="ft6011">uses&#160;an&#160;additional&#160;metadata&#160;field&#160;to&#160;store</p>
<p style="position:absolute;top:811px;left:150px;white-space:nowrap" class="ft6011">the&#160;cryptographic&#160;hash&#160;value</p>
<p style="position:absolute;top:810px;left:327px;white-space:nowrap" class="ft6054">Hash</p>
<p style="position:absolute;top:810px;left:364px;white-space:nowrap" class="ft6055">(</p>
<p style="position:absolute;top:810px;left:370px;white-space:nowrap" class="ft60104">data</p>
<p style="position:absolute;top:810px;left:398px;white-space:nowrap" class="ft6055">)</p>
<p style="position:absolute;top:811px;left:408px;white-space:nowrap" class="ft6011">that&#160;defines&#160;the&#160;last&#160;stored&#160;version&#160;of</p>
<p style="position:absolute;top:810px;left:633px;white-space:nowrap" class="ft60104">data</p>
<p style="position:absolute;top:811px;left:662px;white-space:nowrap" class="ft6011">.</p>
<p style="position:absolute;top:828px;left:150px;white-space:nowrap" class="ft6011">On&#160;load,</p>
<p style="position:absolute;top:828px;left:205px;white-space:nowrap" class="ft6054">SM</p>
<p style="position:absolute;top:828px;left:235px;white-space:nowrap" class="ft6011">calculates</p>
<p style="position:absolute;top:828px;left:297px;white-space:nowrap" class="ft6054">Hash</p>
<p style="position:absolute;top:827px;left:335px;white-space:nowrap" class="ft6055">(</p>
<p style="position:absolute;top:828px;left:340px;white-space:nowrap" class="ft60104">data</p>
<p style="position:absolute;top:827px;left:369px;white-space:nowrap" class="ft6055">)</p>
<p style="position:absolute;top:828px;left:379px;white-space:nowrap" class="ft6011">again&#160;and&#160;checks&#160;if&#160;it&#160;matches&#160;the&#160;hash&#160;value&#160;on</p>
<p style="position:absolute;top:846px;left:150px;white-space:nowrap" class="ft6011">last&#160;store.&#160;In&#160;order&#160;to&#160;ensure&#160;freshness&#160;of&#160;these&#160;metadata,&#160;the&#160;index&#160;of</p>
<p style="position:absolute;top:846px;left:567px;white-space:nowrap" class="ft6054">SM</p>
<p style="position:absolute;top:846px;left:597px;white-space:nowrap" class="ft6011">itself&#160;has&#160;to</p>
<p style="position:absolute;top:864px;left:150px;white-space:nowrap" class="ft6011">be&#160;stored&#160;fresh.</p>
<p style="position:absolute;top:882px;left:172px;white-space:nowrap" class="ft6011">We&#160;therefore&#160;analysed&#160;to&#160;what&#160;extend&#160;TPMs&#160;of&#160;version&#160;1.1b&#160;and&#160;1.2&#160;can&#160;be&#160;used&#160;to</p>
<p style="position:absolute;top:900px;left:150px;white-space:nowrap" class="ft6011">realise&#160;a&#160;fresh&#160;index&#160;for</p>
<p style="position:absolute;top:900px;left:294px;white-space:nowrap" class="ft6054">SM</p>
<p style="position:absolute;top:900px;left:321px;white-space:nowrap" class="ft6011">.</p>
<p style="position:absolute;top:921px;left:172px;white-space:nowrap" class="ft6030">•</p>
<p style="position:absolute;top:922px;left:187px;white-space:nowrap" class="ft6012"><i>DI-Register:&#160;</i>TPMs&#160;version&#160;1.1b&#160;provide&#160;a&#160;Data&#160;Integrity&#160;Register&#160;(DIR)&#160;that&#160;can<br/>persistently&#160;store&#160;a&#160;160&#160;bit&#160;value&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#70">[17,&#160;18]</a>.&#160;Unfortunately,&#160;access&#160;to&#160;this&#160;register&#160;is<br/>only&#160;authorised&#160;by&#160;the&#160;TPM-Owner&#160;secret&#160;implying&#160;that&#160;the&#160;TPM-Owner&#160;can&#160;al-<br/>ways&#160;perform&#160;replay&#160;attacks.&#160;The&#160;only&#160;solution&#160;would&#160;be&#160;to&#160;distribute&#160;platforms<br/>with&#160;an&#160;activated&#160;TPM&#160;and&#160;an&#160;owner&#160;authorisation&#160;secret&#160;that&#160;is&#160;unknown&#160;to&#160;the<br/>user.&#160;This&#160;solution&#160;does&#160;not&#160;conform&#160;to&#160;the&#160;TCG&#160;specification&#160;that&#160;demands&#160;that<br/>TCG-enabled&#160;platforms&#160;have&#160;to&#160;be&#160;shipped&#160;with&#160;no&#160;owner&#160;installed&#160;(see&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#71">[39]</a>,<br/>page&#160;139).</p>
<p style="position:absolute;top:1072px;left:162px;white-space:nowrap" class="ft6031">14</p>
<p style="position:absolute;top:1074px;left:171px;white-space:nowrap" class="ft6016">More&#160;details&#160;on&#160;storage&#160;metadata&#160;at&#160;the&#160;end&#160;of&#160;this&#160;section.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft6018">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 61 -->
<a name="61"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page61-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC061.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft6111">CHAPTER&#160;3.&#160;L4&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft6111">59</p>
<p style="position:absolute;top:193px;left:248px;white-space:nowrap" class="ft6130">•</p>
<p style="position:absolute;top:194px;left:263px;white-space:nowrap" class="ft6112"><i>SRK&#160;Recreation:&#160;</i>An&#160;alternative&#160;way&#160;to&#160;prevent&#160;replay&#160;attacks&#160;based&#160;on&#160;TPMs<br/>version&#160;1.1b&#160;would&#160;be&#160;to&#160;create&#160;a&#160;new&#160;Storage&#160;Root&#160;Key&#160;(SRK)&#160;before&#160;the&#160;sys-<br/>tem&#160;is&#160;shut&#160;down.&#160;Recreation&#160;of&#160;the&#160;SRK&#160;would&#160;prevent&#160;that&#160;previously&#160;created<br/>TPM&#160;encryption&#160;keys&#160;can&#160;be&#160;used&#160;any&#160;more.&#160;Unfortunately,&#160;a&#160;SRK&#160;can&#160;only<br/>be&#160;renewed&#160;by&#160;the</p>
<p style="position:absolute;top:265px;left:382px;white-space:nowrap" class="ft6162">TakeOwnership</p>
<p style="position:absolute;top:265px;left:482px;white-space:nowrap" class="ft6111">function&#160;which&#160;itself&#160;requires&#160;a&#160;previously</p>
<p style="position:absolute;top:283px;left:263px;white-space:nowrap" class="ft6162">OwnerClear</p>
<p style="position:absolute;top:283px;left:340px;white-space:nowrap" class="ft6111">that&#160;itself&#160;disables&#160;the&#160;TPM.&#160;Therefore,&#160;an&#160;online-recreation&#160;of&#160;the</p>
<p style="position:absolute;top:301px;left:263px;white-space:nowrap" class="ft6111">SRK&#160;seems&#160;to&#160;be&#160;impossible.</p>
<p style="position:absolute;top:329px;left:248px;white-space:nowrap" class="ft6130">•</p>
<p style="position:absolute;top:330px;left:263px;white-space:nowrap" class="ft6112"><i>NV-RAM:&#160;</i>TPMs&#160;version&#160;1.2&#160;provide&#160;a&#160;limited&#160;amount&#160;of&#160;non-volatile&#160;(NV-)<br/>RAM&#160;to&#160;which&#160;access&#160;is&#160;restricted&#160;to&#160;authorised&#160;entities.&#160;So-called&#160;NV-Attributes<br/>define&#160;which&#160;entities&#160;are&#160;authorised&#160;to&#160;write&#160;to&#160;and/or&#160;read&#160;from&#160;the&#160;NV-RAM.<br/>Thus,&#160;data&#160;integrity&#160;can&#160;be&#160;preserved&#160;by&#160;storing&#160;a&#160;hash&#160;value&#160;of&#160;the&#160;data&#160;into&#160;the<br/>NV-RAM&#160;and&#160;ensuring&#160;that&#160;only&#160;the&#160;Storage&#160;Manager&#160;can&#160;access&#160;the&#160;authorisa-<br/>tion&#160;secret.</p>
<p style="position:absolute;top:448px;left:248px;white-space:nowrap" class="ft6130">•</p>
<p style="position:absolute;top:449px;left:263px;white-space:nowrap" class="ft6113"><i>Secure&#160;Counter:&#160;</i>A&#160;TPM&#160;version&#160;1.2&#160;supports&#160;at&#160;least&#160;four&#160;monotonic&#160;counters.<br/>Based&#160;on&#160;this&#160;functionality,&#160;the&#160;freshness&#160;of&#160;data&#160;can&#160;be&#160;detected&#160;by&#160;securely<br/>concatenating&#160;it&#160;with&#160;the&#160;actual&#160;counter&#160;value.</p>
<p style="position:absolute;top:516px;left:248px;white-space:nowrap" class="ft6111">A&#160;result&#160;of&#160;our&#160;previous&#160;analysis&#160;we&#160;showed&#160;that&#160;TPMs&#160;version&#160;1.1b&#160;cannot&#160;be</p>
<p style="position:absolute;top:534px;left:226px;white-space:nowrap" class="ft6113">used&#160;to&#160;provide&#160;fresh&#160;storage&#160;as&#160;required&#160;to&#160;enforce&#160;stateful&#160;licenses&#160;and/or&#160;to&#160;trans-<br/>fer&#160;licenses.&#160;Therefore&#160;we&#160;decided&#160;to&#160;realise&#160;trusted&#160;storage&#160;based&#160;on&#160;the&#160;monotonic<br/>counter&#160;functionality&#160;of&#160;TPMs&#160;version&#160;1.2.</p>
<p style="position:absolute;top:588px;left:248px;white-space:nowrap" class="ft6111">A&#160;monotonic&#160;hardware&#160;counter&#160;allows&#160;us&#160;to&#160;securely&#160;maintain&#160;versioning&#160;of&#160;an</p>
<p style="position:absolute;top:606px;left:226px;white-space:nowrap" class="ft6113">arbitrary&#160;data&#160;component,&#160;by&#160;keeping&#160;a&#160;software&#160;counter&#160;synchronised&#160;with&#160;one&#160;(of<br/>four&#160;guaranteed)&#160;hardware&#160;counters&#160;of&#160;the&#160;TPM.</p>
<p style="position:absolute;top:623px;left:530px;white-space:nowrap" class="ft6154">SM</p>
<p style="position:absolute;top:624px;left:562px;white-space:nowrap" class="ft6111">manages&#160;an&#160;internal&#160;software</p>
<p style="position:absolute;top:642px;left:226px;white-space:nowrap" class="ft6111">counter&#160;that,&#160;every&#160;time</p>
<p style="position:absolute;top:641px;left:372px;white-space:nowrap" class="ft6154">SM</p>
<p style="position:absolute;top:642px;left:402px;white-space:nowrap" class="ft6111">updates&#160;its&#160;index,&#160;is&#160;incremented&#160;synchronously&#160;with&#160;the</p>
<p style="position:absolute;top:660px;left:226px;white-space:nowrap" class="ft6113">monotonic&#160;hardware&#160;counter.&#160;If&#160;both&#160;mismatch&#160;at&#160;any&#160;time,&#160;a&#160;outdated&#160;data&#160;is&#160;detected,<br/>that&#160;will&#160;be&#160;handled&#160;according&#160;to&#160;the&#160;actual&#160;security&#160;policy.</p>
<p style="position:absolute;top:696px;left:248px;white-space:nowrap" class="ft6111">However,&#160;in&#160;order&#160;to&#160;employ&#160;TPM’s&#160;monotonic&#160;counters,</p>
<p style="position:absolute;top:695px;left:595px;white-space:nowrap" class="ft6154">SM</p>
<p style="position:absolute;top:696px;left:625px;white-space:nowrap" class="ft6111">has&#160;to&#160;be&#160;initialised</p>
<p style="position:absolute;top:714px;left:226px;white-space:nowrap" class="ft6111">correctly.&#160;On&#160;the&#160;initial&#160;setup</p>
<p style="position:absolute;top:713px;left:412px;white-space:nowrap" class="ft6154">SM</p>
<p style="position:absolute;top:714px;left:443px;white-space:nowrap" class="ft6111">uses&#160;the&#160;TPM&#160;to&#160;create&#160;its&#160;internal&#160;cryptographic</p>
<p style="position:absolute;top:732px;left:226px;white-space:nowrap" class="ft6111">key</p>
<p style="position:absolute;top:731px;left:253px;white-space:nowrap" class="ft6154">key</p>
<p style="position:absolute;top:737px;left:275px;white-space:nowrap" class="ft6161">SM</p>
<p style="position:absolute;top:732px;left:302px;white-space:nowrap" class="ft6111">that&#160;then&#160;will&#160;be&#160;sealed&#160;to&#160;the&#160;actual&#160;platform&#160;configuration.&#160;To&#160;enable</p>
<p style="position:absolute;top:750px;left:226px;white-space:nowrap" class="ft6111">freshness&#160;detection&#160;and&#160;thus&#160;trusted&#160;storage,</p>
<p style="position:absolute;top:749px;left:500px;white-space:nowrap" class="ft6154">SM</p>
<p style="position:absolute;top:750px;left:531px;white-space:nowrap" class="ft6111">creates&#160;a&#160;monotonic&#160;counter</p>
<p style="position:absolute;top:749px;left:708px;white-space:nowrap" class="ft6154">cntid</p>
<p style="position:absolute;top:767px;left:226px;white-space:nowrap" class="ft6111">with&#160;a&#160;authentication</p>
<p style="position:absolute;top:767px;left:357px;white-space:nowrap" class="ft6154">auth</p>
<p style="position:absolute;top:767px;left:387px;white-space:nowrap" class="ft6111">,&#160;e.g.,&#160;a&#160;secret&#160;password.&#160;The&#160;initial&#160;setup&#160;finishes&#160;with&#160;the</p>
<p style="position:absolute;top:785px;left:226px;white-space:nowrap" class="ft6111">creation&#160;of</p>
<p style="position:absolute;top:785px;left:296px;white-space:nowrap" class="ft6154">SM</p>
<p style="position:absolute;top:785px;left:322px;white-space:nowrap" class="ft6111">’s&#160;internal&#160;metadata&#160;index</p>
<p style="position:absolute;top:785px;left:483px;white-space:nowrap" class="ft6154">index</p>
<p style="position:absolute;top:790px;left:520px;white-space:nowrap" class="ft6161">SM</p>
<p style="position:absolute;top:785px;left:546px;white-space:nowrap" class="ft6111">and&#160;the&#160;saving&#160;of&#160;the&#160;sealed&#160;key</p>
<p style="position:absolute;top:803px;left:226px;white-space:nowrap" class="ft6111">blob&#160;and&#160;the&#160;encrypted&#160;index&#160;on&#160;untrusted&#160;storage.</p>
<p style="position:absolute;top:821px;left:248px;white-space:nowrap" class="ft6111">After&#160;a&#160;platform&#160;reboot,</p>
<p style="position:absolute;top:821px;left:393px;white-space:nowrap" class="ft6154">SM</p>
<p style="position:absolute;top:821px;left:422px;white-space:nowrap" class="ft6111">reads&#160;the&#160;key&#160;blob&#160;from&#160;the&#160;untrusted&#160;storage&#160;and&#160;asks</p>
<p style="position:absolute;top:839px;left:226px;white-space:nowrap" class="ft6111">the&#160;TPM&#160;to&#160;unseal&#160;its&#160;internal&#160;key.&#160;The&#160;TPM&#160;is&#160;able&#160;to&#160;unseal</p>
<p style="position:absolute;top:839px;left:606px;white-space:nowrap" class="ft6154">key</p>
<p style="position:absolute;top:844px;left:629px;white-space:nowrap" class="ft6161">SM</p>
<p style="position:absolute;top:839px;left:654px;white-space:nowrap" class="ft6111">if&#160;the&#160;platform</p>
<p style="position:absolute;top:857px;left:226px;white-space:nowrap" class="ft6111">has&#160;the&#160;same&#160;configuration&#160;as&#160;it&#160;was&#160;at&#160;the&#160;sealing&#160;process,&#160;thus&#160;preventing&#160;a&#160;modified</p>
<p style="position:absolute;top:875px;left:226px;white-space:nowrap" class="ft6154">SM</p>
<p style="position:absolute;top:875px;left:256px;white-space:nowrap" class="ft6111">to&#160;access</p>
<p style="position:absolute;top:875px;left:313px;white-space:nowrap" class="ft6154">key</p>
<p style="position:absolute;top:880px;left:336px;white-space:nowrap" class="ft6161">SM</p>
<p style="position:absolute;top:875px;left:357px;white-space:nowrap" class="ft6111">.&#160;Then</p>
<p style="position:absolute;top:875px;left:400px;white-space:nowrap" class="ft6154">SM</p>
<p style="position:absolute;top:875px;left:430px;white-space:nowrap" class="ft6111">uses</p>
<p style="position:absolute;top:875px;left:459px;white-space:nowrap" class="ft6154">key</p>
<p style="position:absolute;top:880px;left:482px;white-space:nowrap" class="ft6161">SM</p>
<p style="position:absolute;top:875px;left:507px;white-space:nowrap" class="ft6111">to&#160;decrypt&#160;its&#160;metadata&#160;index&#160;read&#160;from</p>
<p style="position:absolute;top:893px;left:226px;white-space:nowrap" class="ft6111">the&#160;untrusted&#160;storage.&#160;Finally,</p>
<p style="position:absolute;top:893px;left:414px;white-space:nowrap" class="ft6154">SM</p>
<p style="position:absolute;top:893px;left:445px;white-space:nowrap" class="ft6111">verifies&#160;freshness&#160;of</p>
<p style="position:absolute;top:893px;left:572px;white-space:nowrap" class="ft6154">index</p>
<p style="position:absolute;top:898px;left:609px;white-space:nowrap" class="ft6161">SM</p>
<p style="position:absolute;top:893px;left:635px;white-space:nowrap" class="ft6111">by&#160;comparing&#160;the</p>
<p style="position:absolute;top:911px;left:226px;white-space:nowrap" class="ft6111">decrypted&#160;counter&#160;of</p>
<p style="position:absolute;top:910px;left:351px;white-space:nowrap" class="ft6154">index</p>
<p style="position:absolute;top:916px;left:389px;white-space:nowrap" class="ft6161">SM</p>
<p style="position:absolute;top:911px;left:413px;white-space:nowrap" class="ft6111">with&#160;the&#160;actual&#160;counter&#160;value&#160;of&#160;the&#160;corresponding&#160;TPM</p>
<p style="position:absolute;top:929px;left:226px;white-space:nowrap" class="ft6111">counter</p>
<p style="position:absolute;top:928px;left:275px;white-space:nowrap" class="ft6154">cntid</p>
<p style="position:absolute;top:929px;left:309px;white-space:nowrap" class="ft6111">.</p>
<p style="position:absolute;top:947px;left:248px;white-space:nowrap" class="ft6111">To&#160;bind&#160;a&#160;compartment’s&#160;data&#160;object&#160;persistently&#160;to&#160;its&#160;actual&#160;configuration&#160;the</p>
<p style="position:absolute;top:965px;left:226px;white-space:nowrap" class="ft6112">following&#160;has&#160;to&#160;be&#160;done:&#160;After&#160;the&#160;mapping&#160;of&#160;compartment&#160;identifier&#160;to&#160;the&#160;actual<br/>compartment&#160;configuration&#160;using</p>
<p style="position:absolute;top:982px;left:432px;white-space:nowrap" class="ft6154">CM</p>
<p style="position:absolute;top:983px;left:460px;white-space:nowrap" class="ft6111">,</p>
<p style="position:absolute;top:982px;left:469px;white-space:nowrap" class="ft6154">SM</p>
<p style="position:absolute;top:983px;left:501px;white-space:nowrap" class="ft6111">updates</p>
<p style="position:absolute;top:982px;left:552px;white-space:nowrap" class="ft6154">index</p>
<p style="position:absolute;top:988px;left:589px;white-space:nowrap" class="ft6161">SM</p>
<p style="position:absolute;top:983px;left:615px;white-space:nowrap" class="ft6111">with&#160;the&#160;correspond-</p>
<p style="position:absolute;top:1001px;left:226px;white-space:nowrap" class="ft6113">ing&#160;metadata&#160;as&#160;well&#160;as&#160;the&#160;incremented&#160;software&#160;counter&#160;to&#160;enable&#160;freshness&#160;detection<br/>for</p>
<p style="position:absolute;top:1018px;left:248px;white-space:nowrap" class="ft6154">index</p>
<p style="position:absolute;top:1023px;left:286px;white-space:nowrap" class="ft6161">SM</p>
<p style="position:absolute;top:1018px;left:307px;white-space:nowrap" class="ft6111">.&#160;Afterwards,</p>
<p style="position:absolute;top:1018px;left:395px;white-space:nowrap" class="ft6154">SM</p>
<p style="position:absolute;top:1018px;left:426px;white-space:nowrap" class="ft6111">writes&#160;both,&#160;the&#160;data&#160;objects&#160;and&#160;the&#160;updated&#160;index,</p>
<p style="position:absolute;top:1036px;left:226px;white-space:nowrap" class="ft6111">encrypted&#160;on&#160;the&#160;untrusted&#160;storage&#160;using</p>
<p style="position:absolute;top:1036px;left:478px;white-space:nowrap" class="ft6154">key</p>
<p style="position:absolute;top:1041px;left:500px;white-space:nowrap" class="ft6161">SM</p>
<p style="position:absolute;top:1036px;left:521px;white-space:nowrap" class="ft6111">.&#160;Finally,</p>
<p style="position:absolute;top:1036px;left:583px;white-space:nowrap" class="ft6154">SM</p>
<p style="position:absolute;top:1036px;left:613px;white-space:nowrap" class="ft6111">synchronises&#160;its&#160;soft-</p>
<p style="position:absolute;top:1054px;left:226px;white-space:nowrap" class="ft6112">ware&#160;counter&#160;with&#160;the&#160;TPM’s&#160;monotonic&#160;hardware&#160;counter&#160;and&#160;returns&#160;the&#160;data&#160;object<br/>identifier.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft6118">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 62 -->
<a name="62"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page62-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC062.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft6211">60</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft6218">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:194px;left:172px;white-space:nowrap" class="ft6211">Note&#160;that&#160;we&#160;assume&#160;that&#160;(i)&#160;the&#160;operations&#160;above&#160;are&#160;atomic&#160;and&#160;thus&#160;attacks&#160;can</p>
<p style="position:absolute;top:212px;left:150px;white-space:nowrap" class="ft6213">only&#160;be&#160;mounted&#160;between&#160;those&#160;operations&#160;and&#160;(ii)&#160;our&#160;attacker&#160;is&#160;able&#160;to&#160;accomplish<br/>two&#160;kinds&#160;of&#160;attacks:&#160;replay&#160;of&#160;persistently&#160;stored&#160;indexes&#160;and&#160;Denial-of-Service&#160;(DoS)<br/>attacks.&#160;These&#160;assumptions&#160;result&#160;in&#160;six&#160;attack&#160;scenarios,&#160;summarised&#160;in&#160;Table&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#62">3.3.</a></p>
<p style="position:absolute;top:281px;left:159px;white-space:nowrap" class="ft6211">Attack&#160;after</p>
<p style="position:absolute;top:281px;left:339px;white-space:nowrap" class="ft6211">Replay</p>
<p style="position:absolute;top:281px;left:454px;white-space:nowrap" class="ft6211">DoS</p>
<p style="position:absolute;top:300px;left:159px;white-space:nowrap" class="ft6211">Increment&#160;SW-Counter</p>
<p style="position:absolute;top:300px;left:318px;white-space:nowrap" class="ft6211">no&#160;persistence</p>
<p style="position:absolute;top:300px;left:425px;white-space:nowrap" class="ft6211">no&#160;persistence</p>
<p style="position:absolute;top:318px;left:159px;white-space:nowrap" class="ft6211">Save&#160;new&#160;index</p>
<p style="position:absolute;top:318px;left:334px;white-space:nowrap" class="ft6211">no&#160;effect</p>
<p style="position:absolute;top:318px;left:421px;white-space:nowrap" class="ft6211">can&#160;be&#160;detected</p>
<p style="position:absolute;top:336px;left:159px;white-space:nowrap" class="ft6211">Increment&#160;HW-Counter</p>
<p style="position:absolute;top:336px;left:325px;white-space:nowrap" class="ft6211">not&#160;possible</p>
<p style="position:absolute;top:336px;left:443px;white-space:nowrap" class="ft6211">possible</p>
<p style="position:absolute;top:367px;left:287px;white-space:nowrap" class="ft6211">Table&#160;3.3:&#160;Attacks&#160;on&#160;the&#160;store&#160;protocol.</p>
<p style="position:absolute;top:403px;left:172px;white-space:nowrap" class="ft6211">If&#160;the&#160;software&#160;counter&#160;was&#160;incremented,&#160;but&#160;the&#160;new&#160;index&#160;not&#160;yet&#160;saved,&#160;interrupt-</p>
<p style="position:absolute;top:421px;left:150px;white-space:nowrap" class="ft6212">ing&#160;the&#160;update&#160;cancels&#160;it,&#160;but&#160;has&#160;no&#160;further&#160;effect&#160;(no&#160;persistent&#160;state&#160;is&#160;changed).&#160;After<br/>saving&#160;the&#160;new&#160;index,&#160;the&#160;saved&#160;software&#160;counter&#160;mismatches&#160;the&#160;hardware&#160;counter,<br/>preventing&#160;the&#160;saved&#160;index&#160;from&#160;being&#160;loaded.&#160;Thus,&#160;denial&#160;of&#160;service&#160;can&#160;be&#160;achieved<br/>(but&#160;can&#160;be&#160;detected&#160;as&#160;an&#160;attack),&#160;but&#160;replays&#160;fail.&#160;After&#160;incrementing&#160;the&#160;hardware<br/>counter,&#160;the&#160;new&#160;index&#160;is&#160;in&#160;place.&#160;Interrupting&#160;after&#160;the&#160;update,&#160;yet&#160;before&#160;making&#160;the<br/>new&#160;index&#160;accessible&#160;merely&#160;can&#160;be&#160;used&#160;to&#160;“waste”&#160;a&#160;single&#160;use&#160;of&#160;limited-use&#160;licences<br/>but&#160;has&#160;no&#160;further&#160;implications.</p>
<p style="position:absolute;top:547px;left:172px;white-space:nowrap" class="ft6211">We&#160;complete&#160;the&#160;scenario&#160;with&#160;loading&#160;a&#160;compartment’s&#160;data&#160;object&#160;again:&#160;After</p>
<p style="position:absolute;top:565px;left:150px;white-space:nowrap" class="ft6212">the&#160;mapping&#160;of&#160;requesting&#160;compartment&#160;identifier&#160;to&#160;the&#160;actual&#160;compartment&#160;configu-<br/>ration&#160;using</p>
<p style="position:absolute;top:582px;left:225px;white-space:nowrap" class="ft6254">CM</p>
<p style="position:absolute;top:583px;left:253px;white-space:nowrap" class="ft6211">,</p>
<p style="position:absolute;top:582px;left:261px;white-space:nowrap" class="ft6254">SM</p>
<p style="position:absolute;top:583px;left:291px;white-space:nowrap" class="ft6211">reads&#160;the&#160;requested&#160;data&#160;object&#160;from&#160;untrusted&#160;storage&#160;and&#160;de-</p>
<p style="position:absolute;top:601px;left:150px;white-space:nowrap" class="ft6211">crypts&#160;it&#160;using</p>
<p style="position:absolute;top:600px;left:238px;white-space:nowrap" class="ft6254">key</p>
<p style="position:absolute;top:606px;left:261px;white-space:nowrap" class="ft6261">SM</p>
<p style="position:absolute;top:601px;left:282px;white-space:nowrap" class="ft6211">.&#160;Before&#160;returning</p>
<p style="position:absolute;top:600px;left:393px;white-space:nowrap" class="ft62104">data</p>
<p style="position:absolute;top:601px;left:426px;white-space:nowrap" class="ft6211">to&#160;the&#160;corresponding&#160;compartment,</p>
<p style="position:absolute;top:600px;left:639px;white-space:nowrap" class="ft6254">SM</p>
<p style="position:absolute;top:619px;left:150px;white-space:nowrap" class="ft6211">verifies&#160;all&#160;access&#160;restrictions&#160;(e.g.,&#160;freshness,&#160;or&#160;a&#160;certain&#160;user&#160;id)&#160;given&#160;on&#160;store&#160;via</p>
<p style="position:absolute;top:636px;left:150px;white-space:nowrap" class="ft6254">rest</p>
<p style="position:absolute;top:637px;left:180px;white-space:nowrap" class="ft6211">based&#160;on&#160;the&#160;corresponding&#160;metadata&#160;in</p>
<p style="position:absolute;top:636px;left:420px;white-space:nowrap" class="ft6254">index</p>
<p style="position:absolute;top:642px;left:458px;white-space:nowrap" class="ft6261">SM</p>
<p style="position:absolute;top:637px;left:483px;white-space:nowrap" class="ft6211">and&#160;verifies&#160;that&#160;the&#160;requesting</p>
<p style="position:absolute;top:654px;left:150px;white-space:nowrap" class="ft6211">compartment&#160;has&#160;the&#160;same&#160;configuration&#160;as&#160;it&#160;was&#160;on&#160;store.</p>
<p style="position:absolute;top:694px;left:150px;white-space:nowrap" class="ft6220"><b>Secure&#160;I/O</b></p>
<p style="position:absolute;top:722px;left:150px;white-space:nowrap" class="ft6212">The&#160;Secure&#160;I/O&#160;compartment&#160;receives&#160;protected&#160;content&#160;in&#160;plain&#160;for&#160;rendering.&#160;Thus<br/>the</p>
<p style="position:absolute;top:740px;left:174px;white-space:nowrap" class="ft6254">SIO</p>
<p style="position:absolute;top:740px;left:210px;white-space:nowrap" class="ft6211">is&#160;a&#160;security&#160;critical&#160;compartment&#160;that&#160;has&#160;to&#160;be&#160;trusted.&#160;Therefore</p>
<p style="position:absolute;top:740px;left:636px;white-space:nowrap" class="ft6254">SIO</p>
<p style="position:absolute;top:758px;left:150px;white-space:nowrap" class="ft6212">is&#160;executed&#160;in&#160;parallel,&#160;isolated&#160;from,&#160;e.g.,&#160;a&#160;legacy&#160;OS&#160;and&#160;has&#160;to&#160;be&#160;verified&#160;for<br/>trustworthiness.&#160;In&#160;order&#160;to&#160;provide&#160;a&#160;flexible&#160;efficient&#160;implementation,&#160;we&#160;used&#160;a<br/>para-virtualised&#160;Linux&#160;operating&#160;system&#160;reduced&#160;to&#160;the&#160;essential&#160;functionality&#160;to&#160;render<br/>decrypted&#160;conten<a href="Open_TC_D05.2_SecServicesPoC.html#62">t</a></p>
<p style="position:absolute;top:809px;left:258px;white-space:nowrap" class="ft6229"><a href="Open_TC_D05.2_SecServicesPoC.html#62">15</a></p>
<p style="position:absolute;top:812px;left:269px;white-space:nowrap" class="ft6211">.&#160;Moreover,&#160;our&#160;whole&#160;system&#160;architecture&#160;enforces&#160;that</p>
<p style="position:absolute;top:811px;left:621px;white-space:nowrap" class="ft6254">SIO</p>
<p style="position:absolute;top:812px;left:655px;white-space:nowrap" class="ft6211">is</p>
<p style="position:absolute;top:830px;left:150px;white-space:nowrap" class="ft6212">allowed&#160;to&#160;communicate&#160;only&#160;with&#160;devices&#160;essential&#160;for&#160;the&#160;rendering&#160;process&#160;and&#160;in<br/>turn&#160;receives&#160;communication&#160;only&#160;from&#160;the&#160;TCB&#160;so&#160;that&#160;decrypted&#160;content&#160;cannot&#160;leak<br/>into&#160;untrusted&#160;compartments.</p>
<p style="position:absolute;top:906px;left:150px;white-space:nowrap" class="ft6233"><b>3.1.3</b></p>
<p style="position:absolute;top:906px;left:204px;white-space:nowrap" class="ft6233"><b>Secure&#160;Virtual&#160;Private&#160;Network</b></p>
<p style="position:absolute;top:936px;left:150px;white-space:nowrap" class="ft6212">A&#160;prototype&#160;of&#160;a&#160;secure&#160;VPN&#160;solution,&#160;called&#160;Turaya-VPN,&#160;was&#160;implemented&#160;within<br/>the&#160;EMSCB&#160;project&#160;and&#160;is&#160;provided&#160;to&#160;the&#160;OpenTC&#160;project.</p>
<p style="position:absolute;top:994px;left:150px;white-space:nowrap" class="ft6220"><b>Overview</b></p>
<p style="position:absolute;top:1022px;left:150px;white-space:nowrap" class="ft6213">Our&#160;solution&#160;establishes&#160;a&#160;VPN&#160;by&#160;using&#160;the&#160;security&#160;services&#160;and&#160;therefore&#160;facilitates<br/>protected&#160;communication&#160;with&#160;remote&#160;compartments&#160;and&#160;entities&#160;as,&#160;e.g.,&#160;servers&#160;(web</p>
<p style="position:absolute;top:1067px;left:162px;white-space:nowrap" class="ft6231">15</p>
<p style="position:absolute;top:1069px;left:171px;white-space:nowrap" class="ft6216">Our&#160;exemplary</p>
<p style="position:absolute;top:1069px;left:246px;white-space:nowrap" class="ft62102">SIO</p>
<p style="position:absolute;top:1069px;left:274px;white-space:nowrap" class="ft6216">implementation&#160;provides&#160;rendering&#160;of&#160;several&#160;audio&#160;formats</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft6218">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 63 -->
<a name="63"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page63-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC063.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft6311">CHAPTER&#160;3.&#160;L4&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft6311">61</p>
<p style="position:absolute;top:555px;left:380px;white-space:nowrap" class="ft6311">Figure&#160;3.3:&#160;Architecture&#160;Overview</p>
<p style="position:absolute;top:618px;left:226px;white-space:nowrap" class="ft6313">servers,&#160;email&#160;servers,&#160;news&#160;servers,&#160;etc.)&#160;in&#160;a&#160;protected&#160;intranet.&#160;The&#160;solution&#160;must<br/>ensure&#160;that&#160;a&#160;user&#160;within&#160;an&#160;insecure&#160;network&#160;gets&#160;secure&#160;access&#160;to&#160;a&#160;protected&#160;area.<br/>The&#160;communication&#160;between&#160;the&#160;user&#160;and&#160;the&#160;secure&#160;area&#160;is&#160;protected&#160;by&#160;the&#160;OpenTC<br/>security&#160;platform.&#160;The&#160;secret&#160;required&#160;for&#160;establishing&#160;the&#160;connection&#160;is&#160;also&#160;managed<br/>by&#160;the&#160;platform.&#160;The&#160;user&#160;operating&#160;system&#160;has&#160;no&#160;access&#160;to&#160;the&#160;information.</p>
<p style="position:absolute;top:708px;left:248px;white-space:nowrap" class="ft6311">The&#160;bridge&#160;server&#160;is&#160;an&#160;isolated&#160;network&#160;driver.&#160;The&#160;main&#160;goal&#160;of&#160;the&#160;bridgeserver</p>
<p style="position:absolute;top:725px;left:226px;white-space:nowrap" class="ft6311">is&#160;to&#160;outsource&#160;the&#160;DMA-enabled&#160;network&#160;driver<a href="Open_TC_D05.2_SecServicesPoC.html#63">s</a></p>
<p style="position:absolute;top:723px;left:522px;white-space:nowrap" class="ft6329"><a href="Open_TC_D05.2_SecServicesPoC.html#63">16</a></p>
<p style="position:absolute;top:725px;left:537px;white-space:nowrap" class="ft6311">in&#160;an&#160;isolated&#160;component&#160;that&#160;may</p>
<p style="position:absolute;top:743px;left:226px;white-space:nowrap" class="ft6312">additionally&#160;contain&#160;virtual&#160;private&#160;network&#160;(VPN)&#160;and&#160;firewall&#160;functionality.&#160;Clients<br/>open&#160;(and&#160;close)&#160;a&#160;network&#160;device,&#160;and&#160;read&#160;from&#160;(and&#160;write&#160;to)&#160;a&#160;previously&#160;opened<br/>network&#160;device.&#160;Additionally&#160;the&#160;bridgeserver&#160;allows&#160;to&#160;enforce&#160;access&#160;control&#160;on<br/>which&#160;clients&#160;may&#160;open&#160;a&#160;network&#160;device&#160;and&#160;provides&#160;a&#160;simple&#160;management&#160;inter-<br/>face.</p>
<p style="position:absolute;top:833px;left:248px;white-space:nowrap" class="ft6311">Requirements:&#160;In&#160;the&#160;context&#160;of&#160;the&#160;OpenTC&#160;environment,&#160;a&#160;certificate-based&#160;VPN</p>
<p style="position:absolute;top:851px;left:226px;white-space:nowrap" class="ft6313">shall&#160;be&#160;implemented.&#160;The&#160;following&#160;requirements&#160;to&#160;the&#160;communication&#160;channel&#160;are<br/>made:</p>
<p style="position:absolute;top:898px;left:248px;white-space:nowrap" class="ft6330">•</p>
<p style="position:absolute;top:899px;left:263px;white-space:nowrap" class="ft6311">Integrity&#160;of&#160;the&#160;transmitted&#160;data</p>
<p style="position:absolute;top:928px;left:248px;white-space:nowrap" class="ft6330">•</p>
<p style="position:absolute;top:929px;left:263px;white-space:nowrap" class="ft6311">Confidentiality&#160;of&#160;the&#160;transmitted&#160;data</p>
<p style="position:absolute;top:959px;left:248px;white-space:nowrap" class="ft6311">In&#160;the&#160;following,&#160;we&#160;will&#160;distinguish&#160;between&#160;the&#160;user&#160;system&#160;(e.g.,&#160;Linux)&#160;and&#160;the</p>
<p style="position:absolute;top:977px;left:226px;white-space:nowrap" class="ft6312">Platform-VPN&#160;system.&#160;Both&#160;work&#160;on&#160;a&#160;host&#160;system&#160;and&#160;are&#160;managed&#160;by&#160;the&#160;OpenTC<br/>security&#160;platform.&#160;The&#160;user&#160;system&#160;is&#160;the&#160;user&#160;operating&#160;system&#160;the&#160;user&#160;interacts&#160;with.<br/>Every&#160;input&#160;(keyboard,&#160;mouse,&#160;etc.)&#160;is&#160;processed&#160;by&#160;the&#160;user&#160;system.&#160;The&#160;Platform-<br/>VPN&#160;system&#160;is&#160;executed&#160;in&#160;parallel&#160;through&#160;the&#160;security&#160;platform&#160;on&#160;the&#160;same&#160;host</p>
<p style="position:absolute;top:1057px;left:238px;white-space:nowrap" class="ft6331">16</p>
<p style="position:absolute;top:1059px;left:248px;white-space:nowrap" class="ft6316">DMA&#160;(Direct&#160;Memory&#160;Access)&#160;allows&#160;a&#160;device&#160;to&#160;access&#160;main&#160;memory&#160;directly.&#160;A&#160;malicious&#160;device</p>
<p style="position:absolute;top:1074px;left:226px;white-space:nowrap" class="ft6316">driver&#160;can&#160;misuse&#160;DMA&#160;to&#160;read&#160;out&#160;confidential&#160;data&#160;from&#160;main&#160;memory.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft6318">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 64 -->
<a name="64"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft64113{font-size:10px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page64-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC064.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft6411">62</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft6418">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:209px;left:399px;white-space:nowrap" class="ft6425">Bridgeserver-eth0</p>
<p style="position:absolute;top:221px;left:264px;white-space:nowrap" class="ft6425">Client1</p>
<p style="position:absolute;top:247px;left:252px;white-space:nowrap" class="ft6425">fd0</p>
<p style="position:absolute;top:247px;left:158px;white-space:nowrap" class="ft6425">tun0</p>
<p style="position:absolute;top:294px;left:614px;white-space:nowrap" class="ft6425">eth0</p>
<p style="position:absolute;top:439px;left:617px;white-space:nowrap" class="ft6425">wlan0</p>
<p style="position:absolute;top:247px;left:455px;white-space:nowrap" class="ft6425">fd0</p>
<p style="position:absolute;top:247px;left:549px;white-space:nowrap" class="ft6425">tun0</p>
<p style="position:absolute;top:342px;left:549px;white-space:nowrap" class="ft6425">tun1</p>
<p style="position:absolute;top:241px;left:193px;white-space:nowrap" class="ft64113"><i>TUN/TAP</i></p>
<p style="position:absolute;top:241px;left:331px;white-space:nowrap" class="ft64113"><i>String IPC</i></p>
<p style="position:absolute;top:241px;left:490px;white-space:nowrap" class="ft64113"><i>TUN/TAP</i></p>
<p style="position:absolute;top:200px;left:564px;white-space:nowrap" class="ft6425">Routing</p>
<p style="position:absolute;top:436px;left:549px;white-space:nowrap" class="ft6425">tun2</p>
<p style="position:absolute;top:247px;left:282px;white-space:nowrap" class="ft6425">IPC0</p>
<p style="position:absolute;top:247px;left:411px;white-space:nowrap" class="ft6425">IPC0</p>
<p style="position:absolute;top:315px;left:264px;white-space:nowrap" class="ft6425">Client2</p>
<p style="position:absolute;top:342px;left:252px;white-space:nowrap" class="ft6425">fd0</p>
<p style="position:absolute;top:342px;left:158px;white-space:nowrap" class="ft6425">tun1</p>
<p style="position:absolute;top:342px;left:455px;white-space:nowrap" class="ft6425">fd1</p>
<p style="position:absolute;top:336px;left:193px;white-space:nowrap" class="ft64113"><i>TUN/TAP</i></p>
<p style="position:absolute;top:336px;left:331px;white-space:nowrap" class="ft64113"><i>String IPC</i></p>
<p style="position:absolute;top:336px;left:490px;white-space:nowrap" class="ft64113"><i>TUN/TAP</i></p>
<p style="position:absolute;top:345px;left:282px;white-space:nowrap" class="ft6425">IPC0&#160;</p>
<p style="position:absolute;top:342px;left:411px;white-space:nowrap" class="ft6425">IPC1&#160;</p>
<p style="position:absolute;top:398px;left:399px;white-space:nowrap" class="ft6425">Bridgeserver-wlan0</p>
<p style="position:absolute;top:409px;left:264px;white-space:nowrap" class="ft6425">Client3</p>
<p style="position:absolute;top:436px;left:252px;white-space:nowrap" class="ft6425">fd0</p>
<p style="position:absolute;top:436px;left:158px;white-space:nowrap" class="ft6425">tun0</p>
<p style="position:absolute;top:436px;left:455px;white-space:nowrap" class="ft6425">fd0</p>
<p style="position:absolute;top:430px;left:193px;white-space:nowrap" class="ft64113"><i>TUN/TAP</i></p>
<p style="position:absolute;top:430px;left:331px;white-space:nowrap" class="ft64113"><i>String IPC</i></p>
<p style="position:absolute;top:430px;left:490px;white-space:nowrap" class="ft64113"><i>TUN/TAP</i></p>
<p style="position:absolute;top:436px;left:282px;white-space:nowrap" class="ft6425">IPC0&#160;</p>
<p style="position:absolute;top:436px;left:411px;white-space:nowrap" class="ft6425">IPC0&#160;</p>
<p style="position:absolute;top:486px;left:275px;white-space:nowrap" class="ft6425">L4Linux2</p>
<p style="position:absolute;top:386px;left:273px;white-space:nowrap" class="ft6425">L4Linux1</p>
<p style="position:absolute;top:486px;left:611px;white-space:nowrap" class="ft6425">L4Linux3</p>
<p style="position:absolute;top:522px;left:295px;white-space:nowrap" class="ft6411">Figure&#160;3.4:&#160;Bridgeserver&#160;Architecture</p>
<p style="position:absolute;top:585px;left:150px;white-space:nowrap" class="ft6412">system.&#160;Every&#160;network&#160;request&#160;of&#160;the&#160;user&#160;system&#160;is&#160;forwarded&#160;to&#160;the&#160;Platform-VPN<br/>system&#160;by&#160;the&#160;core&#160;security&#160;platform.&#160;There,&#160;the&#160;requests&#160;are&#160;classified&#160;and&#160;processed<br/>according&#160;to&#160;their&#160;security&#160;property.&#160;This&#160;can&#160;mean&#160;that&#160;the&#160;Platform-VPN&#160;system<br/>establishes&#160;a&#160;secure&#160;connection&#160;to&#160;a&#160;protected&#160;intranet&#160;gateway&#160;and&#160;the&#160;data&#160;transmitted<br/>are&#160;encrypted.</p>
<p style="position:absolute;top:696px;left:150px;white-space:nowrap" class="ft6420"><b>Design&#160;of&#160;Virtual&#160;Networking&#160;for&#160;L4</b></p>
<p style="position:absolute;top:724px;left:150px;white-space:nowrap" class="ft6413">In&#160;this&#160;section&#160;the&#160;design&#160;of&#160;the&#160;bridgeserver&#160;implementing&#160;virtual&#160;networking,&#160;which<br/>is&#160;required&#160;for&#160;the&#160;secure&#160;VPN,&#160;is&#160;described.</p>
<p style="position:absolute;top:782px;left:150px;white-space:nowrap" class="ft6420"><b>Architecture&#160;Description&#160;of&#160;the&#160;Bridge&#160;Server</b></p>
<p style="position:absolute;top:810px;left:150px;white-space:nowrap" class="ft6412">The&#160;architecture&#160;of&#160;the&#160;bridge&#160;server&#160;is&#160;illustrated&#160;in&#160;Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#64">3.4.&#160;</a>Clients&#160;and&#160;server&#160;use&#160;a<br/>Linux&#160;TUN&#160;device&#160;driver&#160;which&#160;provides&#160;a&#160;virtual&#160;network&#160;interface.&#160;Communication<br/>between&#160;client-side&#160;and&#160;server-side&#160;TUN&#160;interfaces&#160;is&#160;implemented&#160;with&#160;the&#160;L4&#160;Inter-<br/>Process-Communication&#160;(IPC)&#160;facility.</p>
<p style="position:absolute;top:904px;left:150px;white-space:nowrap" class="ft6420"><b>Implementation</b></p>
<p style="position:absolute;top:932px;left:150px;white-space:nowrap" class="ft6412">Figure&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#65">3.5&#160;</a>illustrates&#160;the&#160;client-server&#160;protocol.&#160;Client&#160;and&#160;server&#160;first&#160;initialise&#160;a&#160;virtual<br/>network&#160;device&#160;(tun&#160;device).&#160;The&#160;server&#160;task&#160;registers&#160;itself&#160;at&#160;the&#160;naming&#160;service&#160;so<br/>that&#160;the&#160;client&#160;task&#160;can&#160;do&#160;an&#160;open()-call.&#160;Upon&#160;successful&#160;completion&#160;of&#160;the&#160;open()-<br/>call,&#160;client&#160;and&#160;server&#160;maintain&#160;a&#160;mapping&#160;from&#160;each&#160;other’s&#160;thread&#160;id&#160;to&#160;their&#160;virtual<br/>local&#160;network&#160;device.&#160;Ethernet&#160;frames&#160;written&#160;to&#160;a&#160;virtual&#160;network&#160;device&#160;are&#160;then<br/>transferred&#160;via&#160;IPC&#160;to&#160;the&#160;peer&#160;task.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft6418">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 65 -->
<a name="65"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft65114{font-size:9px;font-family:Helvetica;color:#000000;}
	.ft65115{font-size:9px;line-height:11px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page65-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC065.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft6511">CHAPTER&#160;3.&#160;L4&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft6511">63</p>
<p style="position:absolute;top:223px;left:456px;white-space:nowrap" class="ft6553">open()&#160;</p>
<p style="position:absolute;top:199px;left:310px;white-space:nowrap" class="ft6553">Client</p>
<p style="position:absolute;top:197px;left:599px;white-space:nowrap" class="ft6553">Bridgeserver</p>
<p style="position:absolute;top:213px;left:309px;white-space:nowrap" class="ft65115"><i>- create tun-device<br/>- ask naming service<br/>&#160; for &#34;bridgeserver&#34;<br/>- map tun-device to server&#160;<br/>&#160; thread id<br/>- call open()<br/>- server_loop()</i></p>
<p style="position:absolute;top:213px;left:548px;white-space:nowrap" class="ft65115"><i>- create tun-devices<br/>- register main thread&#160;<br/>&#160; as &#34;bridgeserver&#34;<br/>- server_loop()<br/>- on open() call:<br/>&#160; map tun-device to client<br/>&#160; thread id</i></p>
<p style="position:absolute;top:263px;left:449px;white-space:nowrap" class="ft6553">write(frame)</p>
<p style="position:absolute;top:242px;left:449px;white-space:nowrap" class="ft6553">write(frame)</p>
<p style="position:absolute;top:325px;left:423px;white-space:nowrap" class="ft6511">Figure&#160;3.5:&#160;Protocol</p>
<p style="position:absolute;top:384px;left:226px;white-space:nowrap" class="ft6522"><b>3.2</b></p>
<p style="position:absolute;top:384px;left:274px;white-space:nowrap" class="ft6522"><b>Security&#160;Considerations&#160;for&#160;the&#160;CC@H&#160;Scenario</b></p>
<p style="position:absolute;top:422px;left:226px;white-space:nowrap" class="ft6512">In&#160;section&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#8">1.2&#160;</a>we&#160;identified&#160;threats&#160;that&#160;have&#160;to&#160;be&#160;considered&#160;for&#160;the&#160;CC@H&#160;scenario.<br/>Following&#160;we&#160;will&#160;show&#160;why&#160;and&#160;how&#160;our&#160;implementation&#160;of&#160;the&#160;security&#160;services<br/>solves&#160;or&#160;mitigates&#160;threats&#160;to&#160;the&#160;systems&#160;and&#160;the&#160;assets&#160;of&#160;their&#160;owners.&#160;But&#160;first&#160;we<br/>give&#160;a&#160;short&#160;description&#160;of&#160;the&#160;basic&#160;security&#160;concepts&#160;that&#160;are&#160;used&#160;to&#160;fulfil&#160;the&#160;security<br/>requirements&#160;of&#160;the&#160;CC@H&#160;scenario.</p>
<p style="position:absolute;top:534px;left:226px;white-space:nowrap" class="ft6533"><b>3.2.1</b></p>
<p style="position:absolute;top:534px;left:280px;white-space:nowrap" class="ft6533"><b>Basic&#160;Security&#160;Concepts</b></p>
<p style="position:absolute;top:564px;left:226px;white-space:nowrap" class="ft6520"><b>Trusted&#160;Channels</b></p>
<p style="position:absolute;top:592px;left:226px;white-space:nowrap" class="ft6512">The&#160;inter-process&#160;communication&#160;(IPC)&#160;provided&#160;by&#160;the&#160;virtualisation&#160;layer&#160;enables<br/>secure&#160;channels&#160;between&#160;local&#160;compartments&#160;that&#160;enforce&#160;confidentiality&#160;and&#160;integrity<br/>protection.&#160;To&#160;provide&#160;secure&#160;channels&#160;also&#160;between&#160;local&#160;and&#160;remote&#160;compartments,<br/>we&#160;suggest&#160;the&#160;application&#160;of&#160;common&#160;established&#160;mechanisms&#160;for&#160;communication&#160;se-<br/>curity&#160;such&#160;as&#160;SSH&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#71">[41]&#160;</a>and&#160;TLS&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#69">[6]</a>,&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#69">[2]</a>.&#160;In&#160;order&#160;to&#160;extend&#160;secure&#160;channels&#160;to&#160;trusted<br/>channels&#160;that&#160;enable&#160;a&#160;party&#160;to&#160;verify&#160;a&#160;compartment’s&#160;configuration,&#160;we&#160;have&#160;imple-<br/>mented&#160;the&#160;Trust&#160;Manager&#160;(</p>
<p style="position:absolute;top:699px;left:391px;white-space:nowrap" class="ft6554">T&#160;M</p>
<p style="position:absolute;top:700px;left:418px;white-space:nowrap" class="ft6511">)&#160;and&#160;the&#160;Compartment&#160;Manager&#160;(</p>
<p style="position:absolute;top:699px;left:619px;white-space:nowrap" class="ft6554">CM</p>
<p style="position:absolute;top:700px;left:647px;white-space:nowrap" class="ft6511">).&#160;Both&#160;together</p>
<p style="position:absolute;top:718px;left:226px;white-space:nowrap" class="ft6513">allow&#160;local&#160;and&#160;remote&#160;compartments&#160;to&#160;determine&#160;the&#160;configuration&#160;of&#160;their&#160;commu-<br/>nication&#160;contacts&#160;and&#160;thus&#160;to&#160;derive&#160;their&#160;trustworthiness.&#160;Moreover,&#160;our&#160;architecture<br/>enforces&#160;that&#160;information&#160;bound&#160;to&#160;a&#160;determined&#160;configuration&#160;cannot&#160;be&#160;accessed&#160;by&#160;an<br/>unauthorised&#160;(and&#160;potentially&#160;untrusted)&#160;configuration&#160;based&#160;on&#160;the&#160;TCG&#160;mechanisms<br/>sealing&#160;and&#160;binding.&#160;The&#160;secure&#160;Initialisation&#160;process&#160;(cf.&#160;Section&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#57">3.1.2)&#160;</a>however&#160;en-<br/>forces&#160;the&#160;trustworthiness&#160;of</p>
<p style="position:absolute;top:807px;left:399px;white-space:nowrap" class="ft6554">T&#160;M</p>
<p style="position:absolute;top:807px;left:427px;white-space:nowrap" class="ft6511">,</p>
<p style="position:absolute;top:807px;left:434px;white-space:nowrap" class="ft6554">CM</p>
<p style="position:absolute;top:807px;left:465px;white-space:nowrap" class="ft6511">and&#160;the&#160;underlying&#160;TCB.</p>
<p style="position:absolute;top:847px;left:226px;white-space:nowrap" class="ft6520"><b>Strong&#160;Isolation</b></p>
<p style="position:absolute;top:875px;left:226px;white-space:nowrap" class="ft6512">In&#160;order&#160;to&#160;strongly&#160;isolate&#160;compartments&#160;from&#160;each&#160;other,&#160;isolation&#160;at&#160;runtime&#160;as&#160;well<br/>as&#160;isolation&#160;in&#160;persistent&#160;storage&#160;is&#160;required.&#160;Runtime&#160;isolation&#160;is&#160;provided&#160;by&#160;the&#160;small<br/>virtualisation&#160;layer&#160;that&#160;implements&#160;only&#160;logical&#160;address&#160;spaces,&#160;inter-process&#160;commu-<br/>nication&#160;(IPC)&#160;and&#160;an&#160;appropriate&#160;interface&#160;to&#160;enforce&#160;an&#160;access&#160;control&#160;management<br/>for&#160;the&#160;underlying&#160;hardware.&#160;Device&#160;drivers&#160;and&#160;other&#160;essential&#160;operating&#160;system&#160;ser-<br/>vices,&#160;such&#160;as&#160;process&#160;management&#160;and&#160;memory&#160;management,&#160;run&#160;in&#160;isolated&#160;user-<br/>mode&#160;processes.&#160;Thus,&#160;the&#160;amount&#160;of&#160;code&#160;running&#160;in&#160;privileged&#160;(“ring&#160;0”)&#160;processor<br/>mode,&#160;is&#160;clearly&#160;minimised&#160;and&#160;can,&#160;in&#160;contrast&#160;to&#160;monolithic&#160;operating&#160;system&#160;ker-<br/>nels&#160;such&#160;as&#160;Linux&#160;or&#160;MS&#160;Windows,&#160;properly&#160;be&#160;verified&#160;for&#160;its&#160;correctness.&#160;Moreover,<br/>a&#160;failure&#160;in&#160;one&#160;of&#160;these&#160;services&#160;cannot&#160;directly&#160;affect&#160;the&#160;other&#160;services,&#160;especially<br/>the&#160;code&#160;running&#160;in&#160;privileged&#160;mode.&#160;Thus,&#160;malicious&#160;device&#160;drivers&#160;cannot&#160;compro-<br/>mise&#160;core&#160;operating&#160;system&#160;services&#160;as&#160;they&#160;are&#160;all&#160;executed&#160;in&#160;user-mode.&#160;Isolation&#160;in</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft6518">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 66 -->
<a name="66"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft66116{font-size:15px;line-height:18px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page66-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC066.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft6611">64</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft6618">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft6611">persistent&#160;storage&#160;is&#160;provided&#160;by&#160;our&#160;Storage&#160;Manager&#160;(</p>
<p style="position:absolute;top:193px;left:487px;white-space:nowrap" class="ft6654">SM</p>
<p style="position:absolute;top:194px;left:514px;white-space:nowrap" class="ft6611">)&#160;implementation&#160;and&#160;the</p>
<p style="position:absolute;top:212px;left:150px;white-space:nowrap" class="ft6613">usage&#160;of&#160;trusted&#160;channels.&#160;Since&#160;conventional&#160;computer&#160;architectures&#160;cannot&#160;provide<br/>a&#160;trusted&#160;channel&#160;to&#160;the&#160;persistent&#160;storage&#160;device,&#160;an&#160;adversary&#160;can&#160;always&#160;arbitrarily<br/>change&#160;the&#160;state&#160;of&#160;the&#160;storage&#160;or&#160;access&#160;the&#160;communication&#160;to&#160;and&#160;from&#160;the&#160;corre-<br/>sponding&#160;controller.&#160;We&#160;prevent&#160;such&#160;offline&#160;manipulations&#160;and&#160;replay&#160;attacks&#160;while<br/>establishing&#160;a&#160;trusted&#160;channel&#160;to</p>
<p style="position:absolute;top:283px;left:343px;white-space:nowrap" class="ft6654">SM</p>
<p style="position:absolute;top:283px;left:373px;white-space:nowrap" class="ft6611">during&#160;the&#160;secure&#160;Initialisation&#160;(cf.&#160;Section&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#57">3.1.2)</a></p>
<p style="position:absolute;top:301px;left:150px;white-space:nowrap" class="ft6611">process&#160;that&#160;enables&#160;the&#160;platform&#160;to&#160;verify&#160;the&#160;trustworthiness&#160;of</p>
<p style="position:absolute;top:301px;left:538px;white-space:nowrap" class="ft6654">SM</p>
<p style="position:absolute;top:301px;left:564px;white-space:nowrap" class="ft6611">.</p>
<p style="position:absolute;top:341px;left:150px;white-space:nowrap" class="ft6620"><b>Trusted&#160;Storage</b></p>
<p style="position:absolute;top:369px;left:150px;white-space:nowrap" class="ft6613">Our&#160;architecture&#160;provides&#160;secure&#160;storage,&#160;i.e.,&#160;storage&#160;providing&#160;integrity&#160;and&#160;confiden-<br/>tiality,&#160;using&#160;established&#160;cryptographic&#160;mechanisms.&#160;However,&#160;we&#160;improved&#160;common<br/>approaches&#160;while&#160;taking&#160;advantage&#160;of&#160;the&#160;strong&#160;isolation&#160;capability&#160;of&#160;our&#160;architec-<br/>ture&#160;that&#160;prevents&#160;the&#160;exposure&#160;of&#160;cryptographic&#160;secrets&#160;to&#160;unauthorised&#160;or&#160;malicious<br/>processes.&#160;We&#160;also&#160;extended&#160;the&#160;secure&#160;storage&#160;by&#160;a&#160;hardware-based&#160;freshness&#160;detec-<br/>tion&#160;mechanism&#160;that&#160;detects&#160;outdated&#160;persistently&#160;stored&#160;information,&#160;i.e.,&#160;information<br/>that&#160;indeed&#160;could&#160;be&#160;decrypted&#160;and&#160;verified&#160;for&#160;integrity&#160;but&#160;that&#160;was&#160;not&#160;the&#160;informa-<br/>tion&#160;written&#160;at&#160;last.&#160;Having&#160;a&#160;freshness&#160;detection&#160;mechanism&#160;for&#160;persistent&#160;storage,<br/>our&#160;architecture&#160;is&#160;able&#160;to&#160;manage&#160;for&#160;instance&#160;stateful&#160;licenses&#160;while&#160;preventing&#160;the<br/>corresponding&#160;replay&#160;attacks.&#160;In&#160;order&#160;to&#160;provide&#160;Trusted&#160;Storage,&#160;i.e.,&#160;storage&#160;that<br/>enables&#160;other&#160;compartments&#160;to&#160;persistently&#160;bind&#160;their&#160;local&#160;states&#160;to&#160;their&#160;actual&#160;config-<br/>uration&#160;while&#160;preserving&#160;integrity,&#160;confidentiality&#160;and&#160;freshness,&#160;we&#160;employ&#160;the&#160;Storage<br/>Manager&#160;(</p>
<p style="position:absolute;top:584px;left:212px;white-space:nowrap" class="ft6654">SM</p>
<p style="position:absolute;top:584px;left:238px;white-space:nowrap" class="ft6611">)&#160;together&#160;with&#160;the&#160;Compartment&#160;Manager&#160;(</p>
<p style="position:absolute;top:584px;left:501px;white-space:nowrap" class="ft6654">CM</p>
<p style="position:absolute;top:584px;left:529px;white-space:nowrap" class="ft6611">).&#160;As</p>
<p style="position:absolute;top:584px;left:564px;white-space:nowrap" class="ft6654">SM</p>
<p style="position:absolute;top:584px;left:594px;white-space:nowrap" class="ft6611">innately&#160;en-</p>
<p style="position:absolute;top:602px;left:150px;white-space:nowrap" class="ft6611">forces&#160;integrity,&#160;confidentiality&#160;and&#160;freshness,</p>
<p style="position:absolute;top:602px;left:426px;white-space:nowrap" class="ft6654">CM</p>
<p style="position:absolute;top:602px;left:458px;white-space:nowrap" class="ft6611">provides&#160;trustworthy&#160;measurement</p>
<p style="position:absolute;top:620px;left:150px;white-space:nowrap" class="ft6611">of&#160;compartments&#160;configuration&#160;used&#160;by</p>
<p style="position:absolute;top:620px;left:394px;white-space:nowrap" class="ft6654">SM</p>
<p style="position:absolute;top:620px;left:425px;white-space:nowrap" class="ft6611">to&#160;return&#160;information&#160;requested&#160;on&#160;load</p>
<p style="position:absolute;top:638px;left:150px;white-space:nowrap" class="ft6613">only&#160;to&#160;compartments&#160;with&#160;the&#160;same&#160;configuration&#160;as&#160;provided&#160;on&#160;the&#160;preceding&#160;stor-<br/>age&#160;request.&#160;The&#160;secure&#160;Initialisation&#160;(cf.&#160;Section&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#57">3.1.2)&#160;</a>however,&#160;again&#160;enforces&#160;the<br/>trustworthiness&#160;of</p>
<p style="position:absolute;top:673px;left:261px;white-space:nowrap" class="ft6654">SM</p>
<p style="position:absolute;top:674px;left:287px;white-space:nowrap" class="ft6611">,</p>
<p style="position:absolute;top:673px;left:294px;white-space:nowrap" class="ft6654">CM</p>
<p style="position:absolute;top:674px;left:326px;white-space:nowrap" class="ft6611">and&#160;the&#160;underlying&#160;TCB.&#160;Manipulation&#160;of&#160;protected&#160;stor-</p>
<p style="position:absolute;top:692px;left:150px;white-space:nowrap" class="ft6612">age&#160;is&#160;not&#160;feasible&#160;with&#160;regard&#160;to&#160;the&#160;TCG&#160;attacker&#160;model&#160;which&#160;assumes&#160;that&#160;a&#160;TPM<br/>is&#160;only&#160;vulnerable&#160;to&#160;hardware&#160;attacks<a href="Open_TC_D05.2_SecServicesPoC.html#66">.</a></p>
<p style="position:absolute;top:707px;left:381px;white-space:nowrap" class="ft6629"><a href="Open_TC_D05.2_SecServicesPoC.html#66">17</a></p>
<p style="position:absolute;top:750px;left:150px;white-space:nowrap" class="ft6633"><b>3.2.2</b></p>
<p style="position:absolute;top:750px;left:204px;white-space:nowrap" class="ft6633"><b>Facing&#160;Threats</b></p>
<p style="position:absolute;top:781px;left:150px;white-space:nowrap" class="ft6612">Now&#160;we&#160;describe&#160;how&#160;the&#160;security&#160;concepts&#160;mentioned&#160;above&#160;are&#160;used&#160;to&#160;encounter&#160;the<br/>threats&#160;enlisted&#160;in&#160;section&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#8">1.2.</a></p>
<p style="position:absolute;top:838px;left:150px;white-space:nowrap" class="ft6620"><b>Threats&#160;to&#160;the&#160;Corporation</b></p>
<p style="position:absolute;top:866px;left:150px;white-space:nowrap" class="ft66116"><b>The&#160;PC&#160;of&#160;the&#160;employee&#160;gets&#160;lost,&#160;and&#160;the&#160;finder/thief&#160;is&#160;able&#160;to&#160;read&#160;confidential<br/>corporate&#160;data&#160;stored&#160;on&#160;the&#160;computer.</b></p>
<p style="position:absolute;top:884px;left:410px;white-space:nowrap" class="ft6611">This&#160;can&#160;be&#160;prevented&#160;by&#160;sealing&#160;data&#160;using</p>
<p style="position:absolute;top:902px;left:150px;white-space:nowrap" class="ft6612">the&#160;storage&#160;manager.&#160;The&#160;data&#160;is&#160;stored&#160;bound&#160;to&#160;an&#160;authorisation&#160;secret,&#160;so&#160;the&#160;find-<br/>er/thief&#160;is&#160;not&#160;able&#160;to&#160;access&#160;the&#160;data&#160;booting&#160;up&#160;the&#160;system&#160;the&#160;normal&#160;way.&#160;This&#160;can<br/>be&#160;done&#160;by&#160;recommending&#160;authentication&#160;when&#160;the&#160;corporate&#160;compartment&#160;is&#160;started.<br/>To&#160;access&#160;the&#160;data&#160;using&#160;another&#160;computer&#160;system&#160;by,&#160;e.g.,&#160;removing&#160;the&#160;hard&#160;disk&#160;from<br/>the&#160;employee’s&#160;system&#160;is&#160;impossible&#160;because&#160;the&#160;data&#160;is&#160;stored&#160;sealed&#160;to&#160;a&#160;specific&#160;state<br/>(also&#160;hardware)&#160;and&#160;thus&#160;stays&#160;encrypted&#160;when&#160;mounted&#160;into&#160;another&#160;system.</p>
<p style="position:absolute;top:1019px;left:162px;white-space:nowrap" class="ft6631">17</p>
<p style="position:absolute;top:1021px;left:171px;white-space:nowrap" class="ft6616">TPM&#160;technology&#160;stems&#160;from&#160;smartcard&#160;technology.&#160;Some&#160;TPMs&#160;are&#160;certified&#160;according&#160;to&#160;Common</p>
<p style="position:absolute;top:1035px;left:150px;white-space:nowrap" class="ft6616">Criteria&#160;EAL&#160;4+.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft6618">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 67 -->
<a name="67"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft67117{font-size:15px;line-height:17px;font-family:Times;color:#231f20;}
-->
</style>
<div id="page67-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC067.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft6711">CHAPTER&#160;3.&#160;L4&#160;SECURITY&#160;SERVICES</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft6711">65</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft67116"><b>An&#160;attacker&#160;gains&#160;illegitimate&#160;access&#160;to&#160;the&#160;network&#160;of&#160;the&#160;corporation&#160;using&#160;its<br/>own&#160;or&#160;a&#160;employee’s&#160;computer.</b></p>
<p style="position:absolute;top:212px;left:436px;white-space:nowrap" class="ft6711">To&#160;access&#160;the&#160;companies&#160;network&#160;a&#160;certificate&#160;and&#160;a</p>
<p style="position:absolute;top:230px;left:226px;white-space:nowrap" class="ft6712">certain&#160;platform&#160;configuration&#160;are&#160;necessary.&#160;Accessing&#160;the&#160;network&#160;just&#160;having&#160;a&#160;plat-<br/>form&#160;in&#160;the&#160;right&#160;configuration&#160;thus&#160;is&#160;not&#160;sufficient.&#160;The&#160;furthermore&#160;needed&#160;certifi-<br/>cates&#160;handed&#160;out&#160;to&#160;the&#160;employees&#160;by&#160;the&#160;IT&#160;department&#160;of&#160;the&#160;company&#160;to&#160;authenticate<br/>themselves&#160;are&#160;stored&#160;sealed&#160;on&#160;a&#160;employee’s&#160;storage&#160;device&#160;(this&#160;could&#160;also&#160;be&#160;a&#160;USB<br/>stick).&#160;Their&#160;usage&#160;is&#160;only&#160;possible&#160;if&#160;a&#160;system&#160;is&#160;in&#160;a&#160;specific&#160;state&#160;and&#160;a&#160;password&#160;has<br/>been&#160;entered.&#160;Therefore&#160;an&#160;attacker&#160;is&#160;only&#160;able&#160;to&#160;access&#160;the&#160;company’s&#160;network&#160;if&#160;she<br/>gains&#160;access&#160;to&#160;an&#160;employee’s&#160;storage&#160;device&#160;as&#160;well&#160;as&#160;the&#160;proper&#160;password&#160;and&#160;fur-<br/>thermore&#160;operates&#160;a&#160;system&#160;that&#160;is&#160;in&#160;a&#160;state&#160;considered&#160;acceptable&#160;by&#160;the&#160;company’s<br/>VPN&#160;gateway.&#160;Although&#160;this&#160;may&#160;happen,&#160;the&#160;risk&#160;is&#160;small.&#160;Apart&#160;from&#160;that&#160;a&#160;rigid<br/>access&#160;control&#160;system&#160;(e.g.&#160;like&#160;in&#160;SE&#160;Linux)&#160;that&#160;regulates&#160;data&#160;access&#160;directly&#160;on&#160;the<br/>company’s&#160;servers&#160;can&#160;be&#160;used&#160;to&#160;prevent&#160;further&#160;damage.</p>
<p style="position:absolute;top:449px;left:226px;white-space:nowrap" class="ft6720"><b>Threats&#160;to&#160;the&#160;Employee</b></p>
<p style="position:absolute;top:477px;left:226px;white-space:nowrap" class="ft67116"><b>The&#160;employee’s&#160;system&#160;is&#160;altered&#160;by&#160;the&#160;installation&#160;of&#160;the&#160;corporate&#160;compartment<br/>resulting&#160;in&#160;a&#160;situation&#160;that&#160;the&#160;computer&#160;is&#160;no&#160;longer&#160;usable&#160;for&#160;private&#160;purposes<br/>because&#160;of,&#160;e.g.,&#160;restrictive&#160;security&#160;guidelines.</b></p>
<p style="position:absolute;top:512px;left:544px;white-space:nowrap" class="ft6711">The&#160;hypervisor&#160;and&#160;the&#160;security</p>
<p style="position:absolute;top:530px;left:226px;white-space:nowrap" class="ft6712">services&#160;are&#160;able&#160;to&#160;guarantee&#160;isolation&#160;between&#160;compartments&#160;to&#160;a&#160;very&#160;high&#160;degree.<br/>Therefore&#160;the&#160;user&#160;should&#160;be&#160;able&#160;to&#160;run&#160;in&#160;parallel&#160;whatever&#160;she&#160;likes.&#160;Trusted&#160;channels<br/>and&#160;the&#160;strong&#160;isolation&#160;concepts&#160;described&#160;above&#160;take&#160;care&#160;of&#160;the&#160;proper&#160;separation.<br/>But&#160;in&#160;certain&#160;circumstances&#160;like,&#160;e.g.,&#160;if&#160;the&#160;employee&#160;has&#160;to&#160;work&#160;on&#160;very&#160;sensitive<br/>data&#160;the&#160;security&#160;policy&#160;may&#160;require&#160;no&#160;untrusted&#160;compartment&#160;running&#160;in&#160;parallel&#160;to<br/>the&#160;corporate&#160;compartment.&#160;This&#160;would&#160;be&#160;enforced&#160;by&#160;the&#160;security&#160;services&#160;namely<br/>the&#160;compartment&#160;manager.&#160;However&#160;it&#160;is&#160;still&#160;possible&#160;to&#160;use&#160;untrusted&#160;compartments<br/>when&#160;the&#160;corporate&#160;compartment&#160;is&#160;not&#160;running.</p>
<p style="position:absolute;top:696px;left:226px;white-space:nowrap" class="ft67116"><b>Access&#160;to&#160;private&#160;data&#160;stored&#160;on&#160;the&#160;employee’s&#160;system&#160;may&#160;be&#160;possible&#160;for&#160;other<br/>company&#160;members,&#160;e.g.,&#160;the&#160;administrator.</b></p>
<p style="position:absolute;top:714px;left:522px;white-space:nowrap" class="ft6711">This&#160;can&#160;also&#160;be&#160;avoided&#160;by&#160;strong</p>
<p style="position:absolute;top:732px;left:226px;white-space:nowrap" class="ft6712">isolation.&#160;Data&#160;used&#160;in&#160;specific&#160;compartments&#160;can&#160;be&#160;sealed&#160;to&#160;be&#160;only&#160;usable&#160;within<br/>them.&#160;If&#160;another&#160;compartment&#160;tries&#160;to&#160;access&#160;the&#160;sealed&#160;data&#160;access&#160;will&#160;be&#160;denied.<br/>However&#160;there&#160;exists&#160;a&#160;problem&#160;concerning&#160;remote&#160;administration&#160;by&#160;the&#160;company’s<br/>IT&#160;department.&#160;In&#160;theory&#160;it&#160;would&#160;be&#160;possible&#160;for&#160;the&#160;remote&#160;administrator&#160;to&#160;alter<br/>the&#160;security&#160;policies/properties&#160;of&#160;other&#160;compartments&#160;and&#160;applications&#160;installed&#160;on&#160;the<br/>system&#160;but&#160;this&#160;can&#160;be&#160;detected&#160;by&#160;the&#160;user&#160;by&#160;letting&#160;the&#160;system&#160;attest&#160;to&#160;its&#160;state&#160;before<br/>using&#160;it&#160;for&#160;private&#160;purposes.</p>
<p style="position:absolute;top:879px;left:226px;white-space:nowrap" class="ft6720"><b>Threats&#160;to&#160;both</b></p>
<p style="position:absolute;top:907px;left:226px;white-space:nowrap" class="ft6720"><b>Direct&#160;Memory&#160;Access&#160;(DMA)</b></p>
<p style="position:absolute;top:907px;left:434px;white-space:nowrap" class="ft6711">DMA&#160;attacks&#160;can&#160;only&#160;be&#160;prevented&#160;by&#160;the&#160;underly-</p>
<p style="position:absolute;top:925px;left:226px;white-space:nowrap" class="ft6712">ing&#160;hardware&#160;platform&#160;using&#160;Intel’s&#160;or&#160;AMD’s&#160;new&#160;security&#160;extensions&#160;(cf.&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#70">[13]</a>,&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#69">[1]</a>).<br/>Without&#160;these&#160;extensions&#160;our&#160;concept&#160;of&#160;security&#160;services&#160;hinders&#160;the&#160;drivers&#160;to&#160;manip-<br/>ulate&#160;memory&#160;or&#160;kernel&#160;files&#160;directly&#160;because&#160;they&#160;do&#160;not&#160;run&#160;in&#160;kernel-mode&#160;but&#160;DMA<br/>attacks&#160;are&#160;still&#160;feasible.</p>
<p style="position:absolute;top:1018px;left:226px;white-space:nowrap" class="ft6720"><b>Illegitimately&#160;modified&#160;compartments,&#160;e.g.,&#160;Malware&#160;is&#160;installed/executed</b></p>
<p style="position:absolute;top:1018px;left:703px;white-space:nowrap" class="ft6711">An&#160;<i>of-</i></p>
<p style="position:absolute;top:1036px;left:226px;white-space:nowrap" class="ft6712"><i>fline&#160;</i>manipulation&#160;of&#160;a&#160;compartment&#160;is&#160;detected&#160;at&#160;the&#160;moment&#160;it&#160;starts&#160;up,&#160;because<br/>its&#160;data&#160;is&#160;sealed&#160;against&#160;a&#160;certain&#160;state.&#160;Thus,&#160;if&#160;it&#160;is&#160;altered&#160;while&#160;it&#160;wasn’t&#160;running<br/>access&#160;to&#160;its&#160;data&#160;will&#160;be&#160;impossible&#160;at&#160;the&#160;next&#160;startup.&#160;An&#160;<i>online&#160;</i>manipulation,&#160;e.g.,</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft6718">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 68 -->
<a name="68"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page68-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC068.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft6811">66</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft6818">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft6813">by&#160;the&#160;employee&#160;herself&#160;in&#160;turn&#160;is&#160;detected&#160;when&#160;the&#160;compartment&#160;tries&#160;to&#160;connect&#160;to<br/>the&#160;company’s&#160;network&#160;and&#160;access&#160;can&#160;be&#160;denied.&#160;But&#160;manipulating&#160;the&#160;compartment<br/>when&#160;it&#160;is&#160;running&#160;should&#160;be&#160;rendered&#160;impossible&#160;or&#160;at&#160;least&#160;very&#160;difficult&#160;by&#160;a&#160;rigid<br/>security&#160;policy&#160;that&#160;is&#160;enforced&#160;by&#160;the&#160;security&#160;services.</p>
<p style="position:absolute;top:287px;left:150px;white-space:nowrap" class="ft6820"><b>Software&#160;vulnerabilities&#160;in&#160;the&#160;hypervisor&#160;or&#160;security&#160;services</b></p>
<p style="position:absolute;top:287px;left:564px;white-space:nowrap" class="ft6811">The&#160;risk&#160;of&#160;soft-</p>
<p style="position:absolute;top:305px;left:150px;white-space:nowrap" class="ft6812">ware&#160;vulnerabilities&#160;can&#160;be&#160;mitigated&#160;by&#160;strict&#160;evaluation&#160;and&#160;certification&#160;processes<br/>with&#160;regard&#160;to&#160;those&#160;components.&#160;Because&#160;of&#160;their&#160;minimal&#160;design&#160;a&#160;thorough&#160;evalua-<br/>tion&#160;of&#160;the&#160;security&#160;services&#160;and&#160;the&#160;microkernel&#160;is&#160;possible,&#160;in&#160;contrast&#160;to&#160;the&#160;evaluation<br/>of&#160;monolithic&#160;kernels&#160;of&#160;legacy&#160;OS’s.</p>
<p style="position:absolute;top:399px;left:150px;white-space:nowrap" class="ft6820"><b>Illegitimate&#160;program&#160;execution&#160;or&#160;data&#160;usage</b></p>
<p style="position:absolute;top:399px;left:455px;white-space:nowrap" class="ft6811">The&#160;hypervisor&#160;layer&#160;of&#160;our&#160;imple-</p>
<p style="position:absolute;top:417px;left:150px;white-space:nowrap" class="ft6812">mentation&#160;of&#160;security&#160;services&#160;only&#160;offers&#160;support&#160;for&#160;rather&#160;coarse&#160;grained&#160;access&#160;con-<br/>trol.&#160;Fine&#160;grained&#160;access&#160;control&#160;mechanisms&#160;have&#160;to&#160;be&#160;provided&#160;by&#160;the&#160;corporate<br/>compartment&#160;itself.&#160;This&#160;could&#160;be&#160;achieved&#160;by&#160;using&#160;a&#160;standard&#160;configuration&#160;of,&#160;e.g.,<br/>a&#160;minimised&#160;SE&#160;Linux&#160;(cf.&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#70">[16]</a>)&#160;provided&#160;by&#160;the&#160;IT&#160;department&#160;running&#160;on&#160;top&#160;of<br/>the&#160;virtualisation&#160;layer.&#160;The&#160;configuration&#160;and&#160;state&#160;of&#160;this&#160;OS&#160;and&#160;its&#160;access&#160;control<br/>mechanisms&#160;in&#160;turn&#160;can&#160;be&#160;monitored&#160;using&#160;the&#160;security&#160;services.</p>
<p style="position:absolute;top:546px;left:150px;white-space:nowrap" class="ft6820"><b>User&#160;connects&#160;to&#160;a&#160;fake&#160;corporate&#160;server&#160;(phishing)</b></p>
<p style="position:absolute;top:546px;left:501px;white-space:nowrap" class="ft6811">Averting&#160;this&#160;threat&#160;can&#160;be</p>
<p style="position:absolute;top:564px;left:150px;white-space:nowrap" class="ft6812">achieved&#160;by&#160;using&#160;appropriate&#160;authentication&#160;methods&#160;like,&#160;e.g.,&#160;provision&#160;of&#160;a&#160;server<br/>certificate.&#160;Additionally&#160;an&#160;attestation&#160;of&#160;the&#160;VPN&#160;gateway&#160;can&#160;be&#160;required.&#160;Thus,&#160;the<br/>client&#160;is&#160;able&#160;to&#160;verify&#160;the&#160;authenticity&#160;and&#160;configuration&#160;of&#160;its&#160;counterpart&#160;(as&#160;proposed<br/>in&#160;<a href="Open_TC_D05.2_SecServicesPoC.html#69">[2]</a>).&#160;For&#160;the&#160;CC@H&#160;scenario&#160;only&#160;the&#160;usage&#160;of&#160;a&#160;server&#160;certificate&#160;is&#160;intended.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft6818">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 69 -->
<a name="69"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page69-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC069.png" alt="background image"/>
<p style="position:absolute;top:298px;left:226px;white-space:nowrap" class="ft6919"><b>Bibliography</b></p>
<p style="position:absolute;top:391px;left:233px;white-space:nowrap" class="ft6911">[1]&#160;AMD.</p>
<p style="position:absolute;top:391px;left:318px;white-space:nowrap" class="ft6911">Amd&#160;i/o&#160;virtualization&#160;technology&#160;(iommu)&#160;specification.</p>
<p style="position:absolute;top:391px;left:707px;white-space:nowrap" class="ft6911">AMD</p>
<p style="position:absolute;top:409px;left:258px;white-space:nowrap" class="ft6911">-&#160;IOMMU&#160;Architectural&#160;Specification,&#160;Feb.&#160;2007.</p>
<p style="position:absolute;top:409px;left:593px;white-space:nowrap" class="ft6911">http://www.amd.com/us-</p>
<p style="position:absolute;top:427px;left:258px;white-space:nowrap" class="ft6911">en/assets/content_type/white_papers_and_tech_docs/34434.pdf.</p>
<p style="position:absolute;top:455px;left:233px;white-space:nowrap" class="ft6911">[2]&#160;N.&#160;Asokan,&#160;Y.&#160;Gasmi,&#160;A.&#160;R.&#160;Sadeghi,&#160;P.&#160;Stewin,&#160;and&#160;M.&#160;Unger.&#160;Beyond&#160;secure</p>
<p style="position:absolute;top:473px;left:258px;white-space:nowrap" class="ft6911">channels.&#160;ACM-STC&#160;2007,&#160;June&#160;2007.</p>
<p style="position:absolute;top:502px;left:233px;white-space:nowrap" class="ft6911">[3]&#160;S.&#160;Berger,&#160;R.&#160;Cáceres,&#160;K.&#160;Goldman,&#160;R.&#160;Perez,&#160;R.&#160;Sailer,&#160;and&#160;L.&#160;van&#160;Doorn.&#160;vTPM:</p>
<p style="position:absolute;top:520px;left:258px;white-space:nowrap" class="ft6952">Virtualizing&#160;the&#160;Trusted&#160;Platform&#160;Module.&#160;In&#160;<i>Proc.&#160;15th&#160;USENIX&#160;Security&#160;Sym-<br/>posium</i>,&#160;pages&#160;21–21,&#160;2006.</p>
<p style="position:absolute;top:567px;left:233px;white-space:nowrap" class="ft6911">[4]&#160;S.&#160;Cabuk,&#160;C.&#160;Dalton,&#160;H.&#160;V.&#160;Ramasamy,&#160;and&#160;M.&#160;Schunter.&#160;Towards&#160;Automated</p>
<p style="position:absolute;top:584px;left:258px;white-space:nowrap" class="ft6989">Provisioning&#160;of&#160;Secure&#160;Virtualized&#160;Networks.&#160;In&#160;<i>Proc.&#160;14th&#160;ACM&#160;Conference&#160;on<br/>Computer&#160;and&#160;Communications&#160;Security&#160;(CCS-2007)</i>,&#160;Oct.&#160;2007.&#160;To&#160;appear.</p>
<p style="position:absolute;top:631px;left:233px;white-space:nowrap" class="ft6911">[5]&#160;I.&#160;Damgard,&#160;T.&#160;Pedersen,&#160;and&#160;B.&#160;Pfitzmann.&#160;Statistical&#160;Secrecy&#160;and&#160;Multi-Bit</p>
<p style="position:absolute;top:649px;left:258px;white-space:nowrap" class="ft6913">Commitments.&#160;<i>IEEE&#160;Transactions&#160;on&#160;Information&#160;Theory</i>,&#160;44(3):1143–1151,<br/>1998.</p>
<p style="position:absolute;top:696px;left:233px;white-space:nowrap" class="ft6911">[6]&#160;T.&#160;Dierks&#160;and&#160;C.&#160;Allen.&#160;RFC2246&#160;-&#160;the&#160;TLS&#160;protocol&#160;version&#160;1.0.</p>
<p style="position:absolute;top:695px;left:657px;white-space:nowrap" class="ft6918"><a href="http://www.ietf.org/rfc/rfc2246.txt">www.ietf.org/</a></p>
<p style="position:absolute;top:713px;left:258px;white-space:nowrap" class="ft6918"><a href="http://www.ietf.org/rfc/rfc2246.txt">rfc/rfc2246.txt</a></p>
<p style="position:absolute;top:714px;left:349px;white-space:nowrap" class="ft6911"><a href="http://www.ietf.org/rfc/rfc2246.txt">,&#160;</a>January&#160;1999.</p>
<p style="position:absolute;top:742px;left:233px;white-space:nowrap" class="ft6911">[7]&#160;B.&#160;Dragovic,&#160;K.&#160;Fraser,&#160;S.&#160;Hand,&#160;T.&#160;Harris,&#160;A.&#160;Ho,&#160;I.&#160;Pratt,&#160;A.&#160;Warfield,&#160;P.&#160;Barham,</p>
<p style="position:absolute;top:760px;left:258px;white-space:nowrap" class="ft6952">and&#160;R.&#160;Neugebauer.&#160;Xen&#160;and&#160;the&#160;art&#160;of&#160;virtualization.&#160;In&#160;<i>Proceedings&#160;of&#160;the&#160;ACM<br/>Symposium&#160;on&#160;Operating&#160;Systems&#160;Principles</i>,&#160;October&#160;2003.</p>
<p style="position:absolute;top:807px;left:233px;white-space:nowrap" class="ft6911">[8]&#160;T.&#160;Garfinkel,&#160;B.&#160;Pfaff,&#160;J.&#160;Chow,&#160;M.&#160;Rosenblum,&#160;and&#160;D.&#160;Boneh.&#160;Terra:&#160;a&#160;Vir-</p>
<p style="position:absolute;top:825px;left:258px;white-space:nowrap" class="ft6913">tual&#160;Machine-based&#160;Platform&#160;for&#160;Trusted&#160;Computing.&#160;In&#160;<i>Proc.&#160;19th&#160;ACM&#160;Sympo-<br/>sium&#160;on&#160;Operating&#160;Systems&#160;Principles&#160;(SOSP-2003)</i>,&#160;pages&#160;193–206.&#160;ACM&#160;Press,<br/>2003.</p>
<p style="position:absolute;top:889px;left:233px;white-space:nowrap" class="ft6911">[9]&#160;O.&#160;Goldreich,&#160;S.&#160;Micali,&#160;and&#160;A.&#160;Wigderson.&#160;Proofs&#160;that&#160;Yield&#160;Nothing&#160;but&#160;their</p>
<p style="position:absolute;top:907px;left:258px;white-space:nowrap" class="ft6989">Validity,&#160;or&#160;All&#160;Languages&#160;in&#160;NP&#160;have&#160;Zero-Knowledge&#160;Proof&#160;Systems.&#160;<i>Journal<br/>of&#160;the&#160;ACM</i>,&#160;38(3):690–728,&#160;1991.</p>
<p style="position:absolute;top:954px;left:226px;white-space:nowrap" class="ft6911">[10]&#160;J.&#160;Griffin,&#160;T.&#160;Jaeger,&#160;R.&#160;Perez,&#160;R.&#160;Sailer,&#160;L.&#160;V.&#160;Doorn,&#160;and&#160;R.&#160;Caceres.&#160;Trusted</p>
<p style="position:absolute;top:972px;left:258px;white-space:nowrap" class="ft6913">Virtual&#160;Domains:&#160;Toward&#160;Secure&#160;Distributed&#160;Services.&#160;In&#160;<i>Proc.&#160;1st&#160;Workshop<br/>on&#160;Hot&#160;Topics&#160;in&#160;System&#160;Dependability&#160;(Hotdep-2005)</i>,&#160;Yokohama,&#160;Japan,&#160;June<br/>2005.&#160;IEEE&#160;Press.</p>
<p style="position:absolute;top:1036px;left:226px;white-space:nowrap" class="ft6911">[11]&#160;V.&#160;Haldar,&#160;D.&#160;Chandra,&#160;and&#160;M.&#160;Franz.&#160;Semantic&#160;Remote&#160;Attestation&#160;-&#160;Virtual</p>
<p style="position:absolute;top:1054px;left:258px;white-space:nowrap" class="ft6989">Machine&#160;Directed&#160;Approach&#160;to&#160;Trusted&#160;Computing.&#160;In&#160;<i>USENIX&#160;Virtual&#160;Machine<br/>Research&#160;and&#160;Technology&#160;Symposium</i>,&#160;pages&#160;29–41,&#160;2004.</p>
<p style="position:absolute;top:1117px;left:476px;white-space:nowrap" class="ft6911">67</p>
</div>
<!-- Page 70 -->
<a name="70"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page70-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC070.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft7011">68</p>
<p style="position:absolute;top:141px;left:274px;white-space:nowrap" class="ft7018">OpenTC&#160;D05.2&#160;–&#160;Proof&#160;of&#160;Concept&#160;of&#160;the&#160;Security&#160;Services</p>
<p style="position:absolute;top:194px;left:150px;white-space:nowrap" class="ft7011">[12]&#160;V.&#160;Haldar,&#160;D.&#160;Chandra,&#160;and&#160;M.&#160;Franz.&#160;Semantic&#160;remote&#160;attestation:&#160;A&#160;virtual</p>
<p style="position:absolute;top:212px;left:182px;white-space:nowrap" class="ft7012">machine&#160;directed&#160;approach&#160;to&#160;trusted&#160;computing.&#160;In&#160;<i>USENIX&#160;Virtual&#160;Machine<br/>Research&#160;and&#160;Technology&#160;Symposium</i>,&#160;May&#160;2004.&#160;also&#160;Technical&#160;Report&#160;No.<br/>03-20,&#160;School&#160;of&#160;Information&#160;and&#160;Computer&#160;Science,&#160;University&#160;of&#160;California,<br/>Irvine;&#160;October&#160;2003.</p>
<p style="position:absolute;top:295px;left:150px;white-space:nowrap" class="ft7011">[13]&#160;Intel.&#160;Intel&#160;trusted&#160;execution&#160;technology.&#160;Intel&#160;-&#160;Technology&#160;Overview,&#160;Jan.&#160;2007.</p>
<p style="position:absolute;top:313px;left:182px;white-space:nowrap" class="ft7011">http://www.intel.com/technology/security/downloads/TrustedExec_Overview.pdf.</p>
<p style="position:absolute;top:343px;left:150px;white-space:nowrap" class="ft7011">[14]&#160;B.&#160;Jansen,&#160;H.&#160;Ramasamy,&#160;and&#160;M.&#160;Schunter.&#160;Compliance&#160;proofs&#160;and&#160;policy&#160;en-</p>
<p style="position:absolute;top:361px;left:182px;white-space:nowrap" class="ft7011">forcement&#160;for&#160;xen&#160;virtual&#160;machines.&#160;In&#160;<i>Submitted&#160;for&#160;Publication</i>,&#160;2007.</p>
<p style="position:absolute;top:391px;left:150px;white-space:nowrap" class="ft7011">[15]&#160;H.&#160;A.&#160;Lagar-Cavilla.&#160;Vmgl:&#160;Vmm-independent&#160;graphics&#160;acceleration.&#160;In&#160;<i>Xen</i></p>
<p style="position:absolute;top:409px;left:182px;white-space:nowrap" class="ft7017"><i>Summit&#160;2007</i>,&#160;2007.</p>
<p style="position:absolute;top:439px;left:150px;white-space:nowrap" class="ft7011">[16]&#160;P.&#160;Loscocco&#160;and&#160;S.&#160;Smalley.&#160;Integrating&#160;flexible&#160;support&#160;for&#160;security&#160;policies&#160;into</p>
<p style="position:absolute;top:457px;left:182px;white-space:nowrap" class="ft7013">the&#160;Linux&#160;operating&#160;system.&#160;Technical&#160;report,&#160;U.S.&#160;National&#160;Security&#160;Agency<br/>(NSA),&#160;Feb.&#160;2001.</p>
<p style="position:absolute;top:504px;left:150px;white-space:nowrap" class="ft7011">[17]&#160;R.&#160;MacDonald,&#160;S.&#160;Smith,&#160;J.&#160;Marchesini,&#160;and&#160;O.&#160;Wild.&#160;Bear:&#160;An&#160;open-source</p>
<p style="position:absolute;top:522px;left:182px;white-space:nowrap" class="ft7013">virtual&#160;secure&#160;coprocessor&#160;based&#160;on&#160;TCPA.&#160;Technical&#160;Report&#160;TR2003-471,&#160;De-<br/>partment&#160;of&#160;Computer&#160;Science,&#160;Dartmouth&#160;College,&#160;2003.</p>
<p style="position:absolute;top:570px;left:150px;white-space:nowrap" class="ft7011">[18]&#160;J.&#160;Marchesini,&#160;S.&#160;W.&#160;Smith,&#160;O.&#160;Wild,&#160;and&#160;R.&#160;MacDonald.&#160;Experimenting&#160;with&#160;TC-</p>
<p style="position:absolute;top:588px;left:182px;white-space:nowrap" class="ft7013">PA/TCG&#160;hardware,&#160;or:&#160;How&#160;I&#160;learned&#160;to&#160;stop&#160;worrying&#160;and&#160;love&#160;the&#160;bear.&#160;Techni-<br/>cal&#160;Report&#160;TR2003-476,&#160;Department&#160;of&#160;Computer&#160;Science,&#160;Dartmouth&#160;College,<br/>2003.</p>
<p style="position:absolute;top:654px;left:150px;white-space:nowrap" class="ft7011">[19]&#160;National&#160;Institute&#160;of&#160;Standards&#160;and&#160;Technology.&#160;FIPS-197:&#160;Advanced&#160;Encryp-</p>
<p style="position:absolute;top:672px;left:182px;white-space:nowrap" class="ft7011">tion&#160;Standard&#160;(AES).</p>
<p style="position:absolute;top:671px;left:321px;white-space:nowrap" class="ft7018"><a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf">http://csrc.nist.gov/publications/fips/fips197/fips-197.</a></p>
<p style="position:absolute;top:689px;left:182px;white-space:nowrap" class="ft7018"><a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf">pdf</a></p>
<p style="position:absolute;top:690px;left:203px;white-space:nowrap" class="ft7011"><a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf">,&#160;</a>November&#160;2001.</p>
<p style="position:absolute;top:720px;left:150px;white-space:nowrap" class="ft7011">[20]&#160;National&#160;Institute&#160;of&#160;Standards&#160;and&#160;Technology.</p>
<p style="position:absolute;top:720px;left:532px;white-space:nowrap" class="ft7011">FIPS-180-2:</p>
<p style="position:absolute;top:720px;left:625px;white-space:nowrap" class="ft7011">Secure</p>
<p style="position:absolute;top:737px;left:182px;white-space:nowrap" class="ft7011">Hash&#160;Standard&#160;(SHS).</p>
<p style="position:absolute;top:737px;left:364px;white-space:nowrap" class="ft7018"><a href="http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf">http://csrc.nist.gov/publications/fips/fips180-2/</a></p>
<p style="position:absolute;top:755px;left:182px;white-space:nowrap" class="ft7018"><a href="http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf">fips180-2withchangenotice.pdf</a></p>
<p style="position:absolute;top:755px;left:385px;white-space:nowrap" class="ft7011"><a href="http://csrc.nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf">,&#160;</a>August&#160;2002.</p>
<p style="position:absolute;top:785px;left:150px;white-space:nowrap" class="ft7011">[21]&#160;C.&#160;C.&#160;P.&#160;S.&#160;Organisations.&#160;Common&#160;Criteria&#160;for&#160;Information&#160;Technology&#160;Security</p>
<p style="position:absolute;top:803px;left:182px;white-space:nowrap" class="ft7013">Evaluation&#160;(version&#160;2.0).&#160;May&#160;1998,&#160;adopted&#160;by&#160;ISO/IEC&#160;as&#160;Draft&#160;International<br/>Standard&#160;DIS&#160;15408&#160;1-3.</p>
<p style="position:absolute;top:851px;left:150px;white-space:nowrap" class="ft7011">[22]&#160;B.&#160;Pfitzmann,&#160;J.&#160;Riordan,&#160;C.&#160;Stüble,&#160;M.&#160;Waidner,&#160;and&#160;A.&#160;Weber.&#160;The&#160;PERSEUS</p>
<p style="position:absolute;top:869px;left:182px;white-space:nowrap" class="ft7012">system&#160;architecture.&#160;Technical&#160;Report&#160;RZ&#160;3335&#160;(#93381),&#160;IBM&#160;Research&#160;Divi-<br/>sion,&#160;Zurich&#160;Laboratory,&#160;Apr.&#160;2001.</p>
<p style="position:absolute;top:917px;left:150px;white-space:nowrap" class="ft7011">[23]&#160;G.&#160;J.&#160;Popek&#160;and&#160;R.&#160;P.&#160;Goldberg.&#160;Formal&#160;requirements&#160;for&#160;virtualizable&#160;third&#160;gen-</p>
<p style="position:absolute;top:935px;left:182px;white-space:nowrap" class="ft7011">eration&#160;architectures.&#160;<i>Communications&#160;of&#160;the&#160;ACM</i>,&#160;17(7):412–421,&#160;1974.</p>
<p style="position:absolute;top:965px;left:150px;white-space:nowrap" class="ft7011">[24]&#160;J.&#160;Poritz,&#160;M.&#160;Schunter,&#160;E.&#160;V.&#160;Herreweghen,&#160;and&#160;M.&#160;Waidner.&#160;Property&#160;Attestation&#160;–</p>
<p style="position:absolute;top:983px;left:182px;white-space:nowrap" class="ft7012">Scalable&#160;and&#160;Privacy-friendly&#160;Security&#160;Assessment&#160;of&#160;Peer&#160;Computers.&#160;Technical<br/>Report&#160;RZ&#160;3548&#160;(#&#160;99559),&#160;IBM&#160;Research&#160;Division,&#160;May&#160;2004.</p>
<p style="position:absolute;top:1031px;left:150px;white-space:nowrap" class="ft7011">[25]&#160;J.&#160;Poritz,&#160;M.&#160;Schunter,&#160;E.&#160;Van&#160;Herreweghen,&#160;and&#160;M.&#160;Waidner.</p>
<p style="position:absolute;top:1031px;left:614px;white-space:nowrap" class="ft7011">Property</p>
<p style="position:absolute;top:1048px;left:182px;white-space:nowrap" class="ft7012">attestation—scalable&#160;and&#160;privacy-friendly&#160;security&#160;assessment&#160;of&#160;peer&#160;computers.<br/>Technical&#160;Report&#160;RZ&#160;3548,&#160;IBM&#160;Research,&#160;May&#160;2004.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft7018">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 71 -->
<a name="71"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page71-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="Open_TC_D05.2_SecServicesPoC071.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft7111">BIBLIOGRAPHY</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft7111">69</p>
<p style="position:absolute;top:194px;left:226px;white-space:nowrap" class="ft7111">[26]&#160;A.-R.&#160;Sadeghi&#160;and&#160;C.&#160;Stüble.&#160;Bridging&#160;the&#160;gap&#160;between&#160;TCPA/Palladium&#160;and</p>
<p style="position:absolute;top:212px;left:258px;white-space:nowrap" class="ft7111">personal&#160;security.&#160;Technical&#160;report,&#160;Saarland&#160;University,&#160;Germany,&#160;2003.</p>
<p style="position:absolute;top:239px;left:226px;white-space:nowrap" class="ft7111">[27]&#160;A.-R.&#160;Sadeghi&#160;and&#160;C.&#160;Stüble.&#160;Property-based&#160;Attestation&#160;for&#160;Computing&#160;Plat-</p>
<p style="position:absolute;top:257px;left:258px;white-space:nowrap" class="ft7152">forms:&#160;Caring&#160;about&#160;Properties,&#160;not&#160;Mechanisms.&#160;In&#160;<i>Proc.&#160;2004&#160;Workshop&#160;on<br/>New&#160;Security&#160;Paradigms&#160;(NSPW-2004)</i>,&#160;pages&#160;67–77.&#160;ACM&#160;Press,&#160;2005.</p>
<p style="position:absolute;top:303px;left:226px;white-space:nowrap" class="ft7111">[28]&#160;A.-R.&#160;Sadeghi,&#160;C.&#160;Stüble,&#160;and&#160;N.&#160;Pohlmann.&#160;European&#160;multilateral&#160;secure&#160;com-</p>
<p style="position:absolute;top:321px;left:258px;white-space:nowrap" class="ft7112">puting&#160;base&#160;–&#160;open&#160;trusted&#160;computing&#160;for&#160;you&#160;and&#160;me.&#160;<i>Datenschutz&#160;und&#160;Daten-<br/>sicherheit&#160;DuD</i>,&#160;28(9):548–554,&#160;2004.&#160;Verlag&#160;Friedrich&#160;Vierweg&#160;&amp;&#160;Sohn,&#160;Wies-<br/>baden.</p>
<p style="position:absolute;top:385px;left:226px;white-space:nowrap" class="ft7111">[29]&#160;R.&#160;Sailer,&#160;T.&#160;Jaeger,&#160;E.&#160;Valdez,&#160;R.&#160;Perez,&#160;S.&#160;Berger,&#160;J.&#160;L.&#160;Griffin,&#160;and&#160;L.&#160;van&#160;Doorn.</p>
<p style="position:absolute;top:403px;left:258px;white-space:nowrap" class="ft7112">Building&#160;a&#160;MAC-based&#160;security&#160;architecture&#160;for&#160;the&#160;Xen&#160;open-source&#160;hypervisor.<br/>Research&#160;Report&#160;RC23629,&#160;IBM&#160;Research&#160;Division,&#160;June&#160;2005.</p>
<p style="position:absolute;top:449px;left:226px;white-space:nowrap" class="ft7111">[30]&#160;R.&#160;Sailer,&#160;T.&#160;Jaeger,&#160;X.&#160;Zhang,&#160;and&#160;L.&#160;van&#160;Doorn.</p>
<p style="position:absolute;top:449px;left:593px;white-space:nowrap" class="ft7111">Attestation-based&#160;policy</p>
<p style="position:absolute;top:467px;left:258px;white-space:nowrap" class="ft7112">enforcement&#160;for&#160;remote&#160;access.&#160;In&#160;<i>Proceedings&#160;of&#160;the&#160;11th&#160;ACM&#160;Conference<br/>on&#160;Computer&#160;and&#160;Communications&#160;Security</i>,&#160;Washington,&#160;DC,&#160;USA,&#160;Oct.&#160;2004.<br/>ACM&#160;Press.</p>
<p style="position:absolute;top:530px;left:226px;white-space:nowrap" class="ft7111">[31]&#160;R.&#160;Sailer,&#160;E.&#160;Valdez,&#160;T.&#160;Jaeger,&#160;R.&#160;Perez,&#160;L.&#160;van&#160;Doorn,&#160;J.&#160;L.&#160;Griffin,&#160;and&#160;S.&#160;Berger.</p>
<p style="position:absolute;top:548px;left:258px;white-space:nowrap" class="ft7112">sHype:&#160;Secure&#160;hypervisor&#160;approach&#160;to&#160;trusted&#160;virtualized&#160;systems.&#160;Techn.&#160;Rep.<br/>RC23511,&#160;Feb.&#160;2005.&#160;IBM&#160;Research&#160;Division.</p>
<p style="position:absolute;top:594px;left:226px;white-space:nowrap" class="ft7111">[32]&#160;R.&#160;Sailer,&#160;X.&#160;Zhang,&#160;T.&#160;Jaeger,&#160;and&#160;L.&#160;van&#160;Doorn.&#160;Design&#160;and&#160;Implementation&#160;of&#160;a</p>
<p style="position:absolute;top:612px;left:258px;white-space:nowrap" class="ft7152">TCG-based&#160;Integrity&#160;Measurement&#160;Architecture.&#160;In&#160;<i>Proc.&#160;13th&#160;USENIX&#160;Security<br/>Symposium</i>,&#160;pages&#160;16–16.&#160;USENIX&#160;Association,&#160;Aug.&#160;2004.</p>
<p style="position:absolute;top:658px;left:226px;white-space:nowrap" class="ft7111">[33]&#160;TCG&#160;Infrastructure&#160;Workgroup.&#160;TCG&#160;infrastructure&#160;workgroup&#160;subject&#160;key&#160;attes-</p>
<p style="position:absolute;top:676px;left:258px;white-space:nowrap" class="ft7111">tation&#160;evidence&#160;extension&#160;specification&#160;version&#160;1.0&#160;revision&#160;7,&#160;June&#160;2005.</p>
<p style="position:absolute;top:704px;left:226px;white-space:nowrap" class="ft7111">[34]&#160;TrustedGRUB.</p>
<p style="position:absolute;top:703px;left:354px;white-space:nowrap" class="ft7118"><a href="http://sourceforge.net/projects/trustedgrub">http://sourceforge.net/projects/trustedgrub</a></p>
<p style="position:absolute;top:704px;left:631px;white-space:nowrap" class="ft7111"><a href="http://sourceforge.net/projects/trustedgrub">.</a></p>
<p style="position:absolute;top:732px;left:226px;white-space:nowrap" class="ft7111">[35]&#160;TrouSerS.&#160;The&#160;open-source&#160;TCG&#160;software&#160;stack.</p>
<p style="position:absolute;top:731px;left:564px;white-space:nowrap" class="ft7118"><a href="http://trousers.sourceforge.net">http://trousers.sourceforge.</a></p>
<p style="position:absolute;top:749px;left:258px;white-space:nowrap" class="ft7118"><a href="http://trousers.sourceforge.net">net</a></p>
<p style="position:absolute;top:749px;left:279px;white-space:nowrap" class="ft7111"><a href="http://trousers.sourceforge.net">.</a></p>
<p style="position:absolute;top:777px;left:226px;white-space:nowrap" class="ft7111">[36]&#160;Trusted&#160;Computing&#160;Group.</p>
<p style="position:absolute;top:777px;left:441px;white-space:nowrap" class="ft7111">TPM&#160;Main&#160;Specification&#160;v1.2,&#160;November&#160;2003.</p>
<p style="position:absolute;top:795px;left:258px;white-space:nowrap" class="ft7118"><a href="https://www.trustedcomputinggroup.org">https://www.trustedcomputinggroup.org</a></p>
<p style="position:absolute;top:795px;left:517px;white-space:nowrap" class="ft7111"><a href="https://www.trustedcomputinggroup.org">.</a></p>
<p style="position:absolute;top:823px;left:226px;white-space:nowrap" class="ft7111">[37]&#160;Trusted&#160;Computing&#160;Group.&#160;TPM&#160;v1.2&#160;Specification&#160;Changes.&#160;Trusted&#160;Comput-</p>
<p style="position:absolute;top:841px;left:258px;white-space:nowrap" class="ft7111">ing&#160;Group:</p>
<p style="position:absolute;top:840px;left:327px;white-space:nowrap" class="ft7118"><a href="https://www.trustedcomputinggroup.org/groups/tpm/TPM_1_2_Changes_final.pdf">https://www.trustedcomputinggroup.org/groups/tpm/TPM_1_2_</a></p>
<p style="position:absolute;top:858px;left:258px;white-space:nowrap" class="ft7118"><a href="https://www.trustedcomputinggroup.org/groups/tpm/TPM_1_2_Changes_final.pdf">Changes_final.pdf</a></p>
<p style="position:absolute;top:859px;left:379px;white-space:nowrap" class="ft7111"><a href="https://www.trustedcomputinggroup.org/groups/tpm/TPM_1_2_Changes_final.pdf">,&#160;</a>Oct.&#160;2003.</p>
<p style="position:absolute;top:887px;left:226px;white-space:nowrap" class="ft7111">[38]&#160;Trusted&#160;Computing&#160;Group.</p>
<p style="position:absolute;top:887px;left:465px;white-space:nowrap" class="ft7111">TPM&#160;Main&#160;Specification.</p>
<p style="position:absolute;top:886px;left:661px;white-space:nowrap" class="ft7118"><a href="https://www.trustedcomputinggroup.org">https://www.</a></p>
<p style="position:absolute;top:904px;left:258px;white-space:nowrap" class="ft7118"><a href="https://www.trustedcomputinggroup.org">trustedcomputinggroup.org</a></p>
<p style="position:absolute;top:905px;left:437px;white-space:nowrap" class="ft7111"><a href="https://www.trustedcomputinggroup.org">,&#160;</a>Feb.&#160;2005.&#160;Version&#160;1.2&#160;rev.&#160;85.</p>
<p style="position:absolute;top:933px;left:226px;white-space:nowrap" class="ft7111">[39]&#160;Trusted&#160;Computing&#160;Platform&#160;Alliance&#160;(TCPA).&#160;Main&#160;specification,&#160;Feb.&#160;2002.</p>
<p style="position:absolute;top:951px;left:258px;white-space:nowrap" class="ft7111">Version&#160;1.1b.</p>
<p style="position:absolute;top:979px;left:226px;white-space:nowrap" class="ft7111">[40]&#160;TCG&#160;Software&#160;Stack&#160;Specification.</p>
<p style="position:absolute;top:978px;left:480px;white-space:nowrap" class="ft7118"><a href="https://trustedcomputinggroup.org">https://trustedcomputinggroup.org</a></p>
<p style="position:absolute;top:979px;left:703px;white-space:nowrap" class="ft7111"><a href="https://trustedcomputinggroup.org">,&#160;</a>Aug.</p>
<p style="position:absolute;top:997px;left:258px;white-space:nowrap" class="ft7111">2006.&#160;Version&#160;1.2.</p>
<p style="position:absolute;top:1024px;left:226px;white-space:nowrap" class="ft7111">[41]&#160;T.&#160;Ylonen,&#160;T.&#160;Kivinen,&#160;M.&#160;Saarinen,&#160;T.&#160;Rinne,&#160;and&#160;S.&#160;Lehtinen.&#160;IETF&#160;draft&#160;-&#160;SSH</p>
<p style="position:absolute;top:1042px;left:258px;white-space:nowrap" class="ft7111">transport&#160;layer&#160;protocol.</p>
<p style="position:absolute;top:1042px;left:408px;white-space:nowrap" class="ft7118"><a href="http://www.openssh.org/txt/draft-ietf-secsh-transport-14.txt">www.openssh.org/txt/draft-ietf-secsh-transport-14.</a></p>
<p style="position:absolute;top:1060px;left:258px;white-space:nowrap" class="ft7118"><a href="http://www.openssh.org/txt/draft-ietf-secsh-transport-14.txt">txt</a></p>
<p style="position:absolute;top:1060px;left:274px;white-space:nowrap" class="ft7111"><a href="http://www.openssh.org/txt/draft-ietf-secsh-transport-14.txt">,&#160;</a>March&#160;2002.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft7118">OpenTC&#160;Document&#160;D05.2/V01&#160;–&#160;Final&#160;R4948/2007/11/23/OpenTC&#160;Public&#160;(PU)</p>
</div>
<hr/>
<a name="outline"></a><h1>Document Outline</h1>
<ul>
<li>D05.2-v01-SecServicesPoC.pdf
<ul>
<li>D05.2-v01-SecServicesPoC.pdf
<ul>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#7">Corporate Computing at Home Scenario Analysis</a>
<ul>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#7">Basic Setting</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#8">Threats</a></li>
</ul>
</li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#10">Xen Security Services</a>
<ul>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#10">Xen Security Services Overview and Implementation Status</a>
<ul>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#10">Overview</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#11">TVD network infrastructure</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#12">Bridge</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#12">Virtual Private Network</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#12">VM admission control</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#15">Summary</a></li>
</ul>
</li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#16">Xen Virtual Networking Devices</a>
<ul>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#16">Overview</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#17">Background</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#18">Virtual Switch</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#19">Linux Dom0 Prototype</a></li>
</ul>
</li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#21">Management of Trusted Virtual Networking Domains</a>
<ul>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#24">Auto-deployment of TVDs</a></li>
</ul>
</li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#28">Xen Hierarchical Integrity Management</a>
<ul>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#28">Our Solution</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#30">Use Cases for Dynamic Registers</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#31">Conclusion</a></li>
</ul>
</li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#31">Xen Cross-resource Policy Validation</a>
<ul>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#31">Introduction</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#32">Formal Integrity Model for Virtual Machines</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#36">The PEV Integrity Architecture</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#39">Realisation using Xen and Linux</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#41">Use Cases</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#46">Conclusion</a></li>
</ul>
</li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#47">Xen Secure GUI Services</a>
<ul>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#47">An Example Secure GUI Use Case</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#47">Current State</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#48">Prototype Design</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#51">Conclusion</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#52">L4 Security Services</a>
<ul>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#52">Introduction</a>
<ul>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#52">Basic Concepts</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#55">Implementation</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#62">Secure Virtual Private Network</a></li>
</ul>
</li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#65">Security Considerations for the CC@H Scenario</a>
<ul>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#65">Basic Security Concepts</a></li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#66">Facing Threats</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="Open_TC_D05.2_SecServicesPoC.html#68">Bibliography</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</body>
</html>
