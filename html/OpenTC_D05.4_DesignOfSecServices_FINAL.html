<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>html/OpenTC_D05.4_DesignOfSecServices_FINAL</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="generator" content="pdftohtml 0.36"/>
<meta name="date" content="2008-05-29T10:44:12+00:00"/>
<style type="text/css">
<!--
.xflip {
    -moz-transform: scaleX(-1);
    -webkit-transform: scaleX(-1);
    -o-transform: scaleX(-1);
    transform: scaleX(-1);
    filter: fliph;
}
.yflip {
    -moz-transform: scaleY(-1);
    -webkit-transform: scaleY(-1);
    -o-transform: scaleY(-1);
    transform: scaleY(-1);
    filter: flipv;
}
.xyflip {
    -moz-transform: scaleX(-1) scaleY(-1);
    -webkit-transform: scaleX(-1) scaleY(-1);
    -o-transform: scaleX(-1) scaleY(-1);
    transform: scaleX(-1) scaleY(-1);
    filter: fliph + flipv;
}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<!-- Page 1 -->
<a name="1"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft10{font-size:27px;font-family:BJLNFF+BitstreamVeraSans;color:#000000;}
	.ft11{font-size:16px;font-family:BJLNFF+BitstreamVeraSans;color:#000000;}
	.ft12{font-size:16px;font-family:BJLNGH+BitstreamVeraSans;color:#000000;}
	.ft13{font-size:10px;font-family:BJLNGH+BitstreamVeraSans;color:#000000;}
	.ft14{font-size:16px;line-height:19px;font-family:BJLNGH+BitstreamVeraSans;color:#000000;}
	.ft15{font-size:16px;line-height:19px;font-family:BJLNFF+BitstreamVeraSans;color:#000000;}
-->
</style>
<div id="page1-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL001.png" alt="background image"/>
<p style="position:absolute;top:188px;left:117px;white-space:nowrap" class="ft10"><b>D05.4 Design&#160;of&#160;the&#160;Cross-Domain&#160;Security</b></p>
<p style="position:absolute;top:219px;left:382px;white-space:nowrap" class="ft10"><b>Services</b></p>
<p style="position:absolute;top:274px;left:372px;white-space:nowrap" class="ft11"><b>(M31)&#160;May&#160;2008</b></p>
<p style="position:absolute;top:334px;left:91px;white-space:nowrap" class="ft11"><b>Project&#160;number</b></p>
<p style="position:absolute;top:334px;left:425px;white-space:nowrap" class="ft12">IST-027635</p>
<p style="position:absolute;top:359px;left:91px;white-space:nowrap" class="ft11"><b>Project&#160;acronym</b></p>
<p style="position:absolute;top:359px;left:425px;white-space:nowrap" class="ft12">Open_TC</p>
<p style="position:absolute;top:385px;left:91px;white-space:nowrap" class="ft11"><b>Project&#160;title</b></p>
<p style="position:absolute;top:385px;left:425px;white-space:nowrap" class="ft12">Open Trusted Computing</p>
<p style="position:absolute;top:411px;left:91px;white-space:nowrap" class="ft11"><b>Deliverable&#160;Type</b></p>
<p style="position:absolute;top:411px;left:425px;white-space:nowrap" class="ft12">Report&#160;</p>
<p style="position:absolute;top:454px;left:91px;white-space:nowrap" class="ft11"><b>Reference&#160;number</b></p>
<p style="position:absolute;top:454px;left:425px;white-space:nowrap" class="ft12">IST-027635&#160;/D01.2/V02&#160;Final&#160;</p>
<p style="position:absolute;top:485px;left:91px;white-space:nowrap" class="ft11"><b>Title</b></p>
<p style="position:absolute;top:476px;left:425px;white-space:nowrap" class="ft14">D05.4&#160;Design&#160;of the Cross-Domain&#160;Security<br/>Services</p>
<p style="position:absolute;top:517px;left:91px;white-space:nowrap" class="ft11"><b>WPs&#160;contributing&#160;</b></p>
<p style="position:absolute;top:517px;left:425px;white-space:nowrap" class="ft12">WP05</p>
<p style="position:absolute;top:543px;left:91px;white-space:nowrap" class="ft11"><b>Due&#160;date</b></p>
<p style="position:absolute;top:543px;left:425px;white-space:nowrap" class="ft12">May&#160;2008&#160;(M31)</p>
<p style="position:absolute;top:567px;left:91px;white-space:nowrap" class="ft11"><b>Actual&#160;submission&#160;date</b></p>
<p style="position:absolute;top:567px;left:425px;white-space:nowrap" class="ft12">May&#160;26,&#160;2008</p>
<p style="position:absolute;top:608px;left:91px;white-space:nowrap" class="ft11"><b>Responsible&#160;Organisation</b></p>
<p style="position:absolute;top:608px;left:424px;white-space:nowrap" class="ft12">IBM&#160;(Matthias&#160;Schunter)</p>
<p style="position:absolute;top:635px;left:91px;white-space:nowrap" class="ft11"><b>Authors</b></p>
<p style="position:absolute;top:631px;left:424px;white-space:nowrap" class="ft12">CUCL, HP, IBM,&#160;RUB,&#160;Polito</p>
<p style="position:absolute;top:659px;left:91px;white-space:nowrap" class="ft11"><b>Abstract</b></p>
<p style="position:absolute;top:659px;left:424px;white-space:nowrap" class="ft14">This&#160;report&#160;describes&#160;the final&#160;design&#160;of&#160;the<br/>OpenTC&#160;security services.&#160;The&#160;design will&#160;be<br/>implemented&#160;for&#160;the&#160;2008&#160;Demonstrator&#160;of&#160;a<br/>“Virtual&#160;Data Center”.</p>
<p style="position:absolute;top:881px;left:91px;white-space:nowrap" class="ft11"><b>Keywords</b></p>
<p style="position:absolute;top:871px;left:424px;white-space:nowrap" class="ft14">OpenTC, Virtualization,&#160;Trusted&#160;Computing,<br/>Security&#160;Services</p>
<p style="position:absolute;top:931px;left:92px;white-space:nowrap" class="ft11"><b>Dissemination&#160;level</b></p>
<p style="position:absolute;top:931px;left:423px;white-space:nowrap" class="ft12">Public</p>
<p style="position:absolute;top:956px;left:92px;white-space:nowrap" class="ft11"><b>Revision</b></p>
<p style="position:absolute;top:956px;left:423px;white-space:nowrap" class="ft12">V02&#160;Final</p>
<p style="position:absolute;top:1007px;left:90px;white-space:nowrap" class="ft11"><b>Instrument</b></p>
<p style="position:absolute;top:1007px;left:271px;white-space:nowrap" class="ft12">IP</p>
<p style="position:absolute;top:998px;left:452px;white-space:nowrap" class="ft15"><b>Start&#160;date&#160;of the<br/>project</b></p>
<p style="position:absolute;top:1007px;left:632px;white-space:nowrap" class="ft12">1</p>
<p style="position:absolute;top:1007px;left:643px;white-space:nowrap" class="ft13">st</p>
<p style="position:absolute;top:1007px;left:652px;white-space:nowrap" class="ft12">&#160;November&#160;2005</p>
<p style="position:absolute;top:1036px;left:90px;white-space:nowrap" class="ft11"><b>Thematic&#160;Priority</b></p>
<p style="position:absolute;top:1036px;left:271px;white-space:nowrap" class="ft12">IST</p>
<p style="position:absolute;top:1036px;left:452px;white-space:nowrap" class="ft11"><b>Duration</b></p>
<p style="position:absolute;top:1036px;left:632px;white-space:nowrap" class="ft12">42 months</p>
</div>
<!-- Page 2 -->
<a name="2"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft26{font-size:15px;font-family:BJLNGH+BitstreamVeraSans;color:#000000;}
	.ft27{font-size:16px;font-family:BJLNGH+BitstreamVeraSans;color:#0000ff;}
-->
</style>
<div id="page2-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL002.png" alt="background image"/>
<p style="position:absolute;top:87px;left:226px;white-space:nowrap" class="ft26">D05.4 Design&#160;of&#160;the Cross-Domain&#160;Security&#160;Services&#160;</p>
<p style="position:absolute;top:795px;left:85px;white-space:nowrap" class="ft22">If&#160;you&#160;need&#160;further&#160;information,&#160;please&#160;visit our&#160;website&#160;</p>
<p style="position:absolute;top:795px;left:552px;white-space:nowrap" class="ft27">www.opentc.net</p>
<p style="position:absolute;top:795px;left:687px;white-space:nowrap" class="ft22">&#160;or&#160;contact</p>
<p style="position:absolute;top:815px;left:85px;white-space:nowrap" class="ft22">the coordinator:</p>
<p style="position:absolute;top:853px;left:85px;white-space:nowrap" class="ft24">Technikon&#160;Forschungs-und&#160;Planungsgesellschaft&#160;mbH<br/>Burgplatz&#160;3a,&#160;9500&#160;Villach, AUSTRIA<br/>Tel.+43&#160;4242&#160;23355&#160;–0<br/>Fax.&#160;+43&#160;4242&#160;23355&#160;–77<br/>Email&#160;</p>
<p style="position:absolute;top:930px;left:136px;white-space:nowrap" class="ft27">coordination@opentc.net</p>
<p style="position:absolute;top:1026px;left:180px;white-space:nowrap" class="ft26">The&#160;information in this document&#160;is&#160;provided “as&#160;is”, and no guarantee</p>
<p style="position:absolute;top:1043px;left:174px;white-space:nowrap" class="ft26">or warranty is given&#160;that&#160;the information&#160;is&#160;fit&#160;for&#160;any&#160;particular&#160;purpose.</p>
<p style="position:absolute;top:1061px;left:203px;white-space:nowrap" class="ft26">The&#160;user&#160;thereof&#160;uses&#160;the information&#160;at&#160;its&#160;sole risk&#160;and&#160;liability.</p>
</div>
<!-- Page 3 -->
<a name="3"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft38{font-size:26px;font-family:Times;color:#000000;}
	.ft39{font-size:18px;font-family:Times;color:#000000;}
	.ft310{font-size:12px;font-family:Times;color:#000000;}
	.ft311{font-size:15px;font-family:Times;color:#000000;}
	.ft312{font-size:15px;font-family:Times;color:#000000;}
-->
</style>
<div id="page3-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL003.png" alt="background image"/>
<p style="position:absolute;top:508px;left:242px;white-space:nowrap" class="ft38">Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:580px;left:391px;white-space:nowrap" class="ft39">OpenTC&#160;Workpackage&#160;5</p>
<p style="position:absolute;top:577px;left:570px;white-space:nowrap" class="ft310">1</p>
<p style="position:absolute;top:622px;left:402px;white-space:nowrap" class="ft311"><i>OpenTC&#160;</i>Deliverable&#160;D05.4</p>
<p style="position:absolute;top:640px;left:331px;white-space:nowrap" class="ft312">V02&#160;–&#160;Final&#160;Revision.&#160;6505&#160;(OpenTC&#160;Public&#160;(PU))</p>
<p style="position:absolute;top:658px;left:450px;white-space:nowrap" class="ft312">2008/05/26</p>
</div>
<!-- Page 4 -->
<a name="4"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft413{font-size:26px;font-family:Helvetica;color:#000000;}
	.ft414{font-size:21px;font-family:Helvetica;color:#000000;}
	.ft415{font-size:15px;line-height:17px;font-family:Times;color:#000000;}
-->
</style>
<div id="page4-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL004.png" alt="background image"/>
<p style="position:absolute;top:189px;left:345px;white-space:nowrap" class="ft413"><b>A</b></p>
<p style="position:absolute;top:193px;left:365px;white-space:nowrap" class="ft414"><b>BSTRACT</b></p>
<p style="position:absolute;top:230px;left:150px;white-space:nowrap" class="ft415">This&#160;report&#160;describes&#160;the&#160;final&#160;design&#160;of&#160;the&#160;OpenTC&#160;security&#160;services.&#160;This&#160;design&#160;will<br/>be&#160;implemented&#160;for&#160;the&#160;2008&#160;Demonstrator&#160;of&#160;a&#160;“Virtual&#160;Data&#160;Center”.&#160;It&#160;is&#160;based&#160;on<br/>the&#160;research&#160;documented&#160;in&#160;Deliverable&#160;D05.1&#160;&#34;Basic&#160;Security&#160;Services”&#160;and&#160;D05.2<br/>“Security&#160;Services&#160;Proof&#160;of&#160;Concept”.</p>
<p style="position:absolute;top:302px;left:172px;white-space:nowrap" class="ft412">The&#160;goal&#160;of&#160;this&#160;deliverable&#160;is&#160;to&#160;describe&#160;and&#160;explain&#160;the&#160;detailed&#160;concepts&#160;and</p>
<p style="position:absolute;top:320px;left:150px;white-space:nowrap" class="ft415">design&#160;of&#160;our&#160;security&#160;services.&#160;These&#160;security&#160;services&#160;manage&#160;the&#160;security&#160;policies<br/>for&#160;our&#160;virtual&#160;machine&#160;platform&#160;and&#160;enforce&#160;them&#160;in&#160;collaboration&#160;with&#160;the&#160;underlying<br/>Xen&#160;or&#160;L4&#160;hypervisors.</p>
<p style="position:absolute;top:386px;left:278px;white-space:nowrap" class="ft413"><b>A</b></p>
<p style="position:absolute;top:390px;left:297px;white-space:nowrap" class="ft414"><b>CKNOWLEDGEMENTS</b></p>
<p style="position:absolute;top:427px;left:150px;white-space:nowrap" class="ft415">The&#160;following&#160;people&#160;were&#160;the&#160;main&#160;contributors&#160;to&#160;this&#160;report&#160;(alphabetically&#160;by&#160;or-<br/>ganisation):&#160;Theodore&#160;Hong,&#160;Eric&#160;John,&#160;Derek&#160;Murray&#160;(CUCL);&#160;Serdar&#160;Cabuk,&#160;David<br/>Plaquin&#160;(HP);&#160;Bernhard&#160;Jansen,&#160;HariGovind&#160;V.&#160;Ramasamy,&#160;Matthias&#160;Schunter&#160;(IBM);<br/>Yacine&#160;Gasmi&#160;(RUB),&#160;Ahmad-Reza&#160;Sadeghi&#160;(RUB),&#160;Patrick&#160;Stewin&#160;(RUB),&#160;Martin<br/>Unger&#160;(RUB);&#160;Gianluca&#160;Ramunno&#160;(Polito),&#160;Davide&#160;Vernizzi&#160;(Polito).&#160;We&#160;would&#160;like&#160;to<br/>thank&#160;our&#160;reviewer&#160;Peter&#160;Lipp&#160;from&#160;IAIK&#160;Graz.</p>
<p style="position:absolute;top:535px;left:172px;white-space:nowrap" class="ft412">Furthermore,&#160;we&#160;would&#160;like&#160;to&#160;thank&#160;the&#160;other&#160;members&#160;of&#160;the&#160;OpenTC&#160;project&#160;for</p>
<p style="position:absolute;top:553px;left:150px;white-space:nowrap" class="ft415">helpful&#160;discussions&#160;and&#160;valuable&#160;contributions&#160;to&#160;the&#160;research&#160;that&#160;is&#160;documented&#160;in<br/>this&#160;report.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft412">2</p>
</div>
<!-- Page 5 -->
<a name="5"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft516{font-size:37px;font-family:Times;color:#000000;}
	.ft517{font-size:15px;font-family:Times;color:#000000;}
-->
</style>
<div id="page5-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL005.png" alt="background image"/>
<p style="position:absolute;top:298px;left:226px;white-space:nowrap" class="ft516"><b>Contents</b></p>
<p style="position:absolute;top:406px;left:226px;white-space:nowrap" class="ft517"><a href=""><b>1</b></a></p>
<p style="position:absolute;top:406px;left:248px;white-space:nowrap" class="ft517"><a href=""><b>Introduction&#160;and&#160;Outline</b></a></p>
<p style="position:absolute;top:406px;left:734px;white-space:nowrap" class="ft517"><b>5</b></p>
<p style="position:absolute;top:424px;left:248px;white-space:nowrap" class="ft512"><a href="">1.1</a></p>
<p style="position:absolute;top:424px;left:283px;white-space:nowrap" class="ft512"><a href="">Introduction&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:424px;left:734px;white-space:nowrap" class="ft512">5</p>
<p style="position:absolute;top:442px;left:248px;white-space:nowrap" class="ft512"><a href="">1.2</a></p>
<p style="position:absolute;top:442px;left:283px;white-space:nowrap" class="ft512"><a href="">Outline&#160;of&#160;this&#160;Report&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:442px;left:734px;white-space:nowrap" class="ft512">6</p>
<p style="position:absolute;top:474px;left:226px;white-space:nowrap" class="ft517"><a href=""><b>2</b></a></p>
<p style="position:absolute;top:474px;left:248px;white-space:nowrap" class="ft517"><a href=""><b>Related&#160;Work</b></a></p>
<p style="position:absolute;top:474px;left:734px;white-space:nowrap" class="ft517"><b>8</b></p>
<p style="position:absolute;top:492px;left:248px;white-space:nowrap" class="ft512"><a href="">2.1</a></p>
<p style="position:absolute;top:492px;left:283px;white-space:nowrap" class="ft512"><a href="">Trusted&#160;Computing&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:492px;left:734px;white-space:nowrap" class="ft512">8</p>
<p style="position:absolute;top:510px;left:248px;white-space:nowrap" class="ft512"><a href="">2.2</a></p>
<p style="position:absolute;top:510px;left:283px;white-space:nowrap" class="ft512"><a href="">Machine&#160;Virtualization&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:510px;left:734px;white-space:nowrap" class="ft512">9</p>
<p style="position:absolute;top:528px;left:248px;white-space:nowrap" class="ft512"><a href="">2.3</a></p>
<p style="position:absolute;top:528px;left:283px;white-space:nowrap" class="ft512"><a href="">Trusted&#160;Virtual&#160;Domains&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:528px;left:727px;white-space:nowrap" class="ft512">10</p>
<p style="position:absolute;top:546px;left:248px;white-space:nowrap" class="ft512"><a href="">2.4</a></p>
<p style="position:absolute;top:546px;left:283px;white-space:nowrap" class="ft512"><a href="">Property-Based&#160;Attestation&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:546px;left:727px;white-space:nowrap" class="ft512">11</p>
<p style="position:absolute;top:564px;left:248px;white-space:nowrap" class="ft512"><a href="">2.5</a></p>
<p style="position:absolute;top:564px;left:283px;white-space:nowrap" class="ft512"><a href="">Trusted&#160;Channels&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:564px;left:727px;white-space:nowrap" class="ft512">11</p>
<p style="position:absolute;top:597px;left:226px;white-space:nowrap" class="ft517"><a href=""><b>3</b></a></p>
<p style="position:absolute;top:597px;left:248px;white-space:nowrap" class="ft517"><a href=""><b>Compliance&#160;Proofs&#160;for&#160;Xen</b></a></p>
<p style="position:absolute;top:597px;left:727px;white-space:nowrap" class="ft517"><b>12</b></p>
<p style="position:absolute;top:615px;left:248px;white-space:nowrap" class="ft512"><a href="">3.1</a></p>
<p style="position:absolute;top:615px;left:283px;white-space:nowrap" class="ft512"><a href="">Introduction&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:615px;left:727px;white-space:nowrap" class="ft512">12</p>
<p style="position:absolute;top:633px;left:248px;white-space:nowrap" class="ft512"><a href="">3.2</a></p>
<p style="position:absolute;top:633px;left:283px;white-space:nowrap" class="ft512"><a href="">Formal&#160;Integrity&#160;Model&#160;for&#160;Virtual&#160;Machines</a></p>
<p style="position:absolute;top:633px;left:566px;white-space:nowrap" class="ft512">.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:633px;left:727px;white-space:nowrap" class="ft512">13</p>
<p style="position:absolute;top:651px;left:248px;white-space:nowrap" class="ft512"><a href="">3.3</a></p>
<p style="position:absolute;top:651px;left:283px;white-space:nowrap" class="ft512"><a href="">The&#160;PEV&#160;Integrity&#160;Architecture&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:651px;left:727px;white-space:nowrap" class="ft512">16</p>
<p style="position:absolute;top:669px;left:248px;white-space:nowrap" class="ft512"><a href="">3.4</a></p>
<p style="position:absolute;top:669px;left:283px;white-space:nowrap" class="ft512"><a href="">Realization&#160;using&#160;Xen&#160;and&#160;Linux&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:669px;left:727px;white-space:nowrap" class="ft512">19</p>
<p style="position:absolute;top:687px;left:248px;white-space:nowrap" class="ft512"><a href="">3.5</a></p>
<p style="position:absolute;top:687px;left:283px;white-space:nowrap" class="ft512"><a href="">Use&#160;Cases&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:687px;left:727px;white-space:nowrap" class="ft512">21</p>
<p style="position:absolute;top:705px;left:248px;white-space:nowrap" class="ft512"><a href="">3.6</a></p>
<p style="position:absolute;top:705px;left:283px;white-space:nowrap" class="ft512"><a href="">Conclusion&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:705px;left:727px;white-space:nowrap" class="ft512">27</p>
<p style="position:absolute;top:737px;left:226px;white-space:nowrap" class="ft517"><a href=""><b>4</b></a></p>
<p style="position:absolute;top:737px;left:248px;white-space:nowrap" class="ft517"><a href=""><b>Hierarchical&#160;Integrity&#160;Management</b></a></p>
<p style="position:absolute;top:737px;left:727px;white-space:nowrap" class="ft517"><b>28</b></p>
<p style="position:absolute;top:755px;left:248px;white-space:nowrap" class="ft512"><a href="">4.1</a></p>
<p style="position:absolute;top:755px;left:283px;white-space:nowrap" class="ft512"><a href="">Introduction&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:755px;left:727px;white-space:nowrap" class="ft512">28</p>
<p style="position:absolute;top:773px;left:248px;white-space:nowrap" class="ft512"><a href="">4.2</a></p>
<p style="position:absolute;top:773px;left:283px;white-space:nowrap" class="ft512"><a href="">Design&#160;Overview&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:773px;left:727px;white-space:nowrap" class="ft512">29</p>
<p style="position:absolute;top:791px;left:248px;white-space:nowrap" class="ft512"><a href="">4.3</a></p>
<p style="position:absolute;top:791px;left:283px;white-space:nowrap" class="ft512"><a href="">Basic&#160;Integrity&#160;Management&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:791px;left:727px;white-space:nowrap" class="ft512">31</p>
<p style="position:absolute;top:809px;left:248px;white-space:nowrap" class="ft512"><a href="">4.4</a></p>
<p style="position:absolute;top:809px;left:283px;white-space:nowrap" class="ft512"><a href="">Hierarchical&#160;Integrity&#160;Management&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:809px;left:727px;white-space:nowrap" class="ft512">35</p>
<p style="position:absolute;top:827px;left:248px;white-space:nowrap" class="ft512"><a href="">4.5</a></p>
<p style="position:absolute;top:827px;left:283px;white-space:nowrap" class="ft512"><a href="">Policy&#160;Verification&#160;for&#160;Security&#160;Services&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:827px;left:727px;white-space:nowrap" class="ft512">40</p>
<p style="position:absolute;top:845px;left:248px;white-space:nowrap" class="ft512"><a href="">4.6</a></p>
<p style="position:absolute;top:845px;left:283px;white-space:nowrap" class="ft512"><a href="">Implementation&#160;in&#160;Xen&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:845px;left:727px;white-space:nowrap" class="ft512">42</p>
<p style="position:absolute;top:863px;left:248px;white-space:nowrap" class="ft512"><a href="">4.7</a></p>
<p style="position:absolute;top:863px;left:283px;white-space:nowrap" class="ft512"><a href="">Related&#160;Work&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:863px;left:727px;white-space:nowrap" class="ft512">45</p>
<p style="position:absolute;top:881px;left:248px;white-space:nowrap" class="ft512"><a href="">4.8</a></p>
<p style="position:absolute;top:881px;left:283px;white-space:nowrap" class="ft512"><a href="">Conclusions&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:881px;left:727px;white-space:nowrap" class="ft512">47</p>
<p style="position:absolute;top:914px;left:226px;white-space:nowrap" class="ft517"><a href=""><b>5</b></a></p>
<p style="position:absolute;top:914px;left:248px;white-space:nowrap" class="ft517"><a href=""><b>Trusted&#160;Channels&#160;with&#160;Remote&#160;Integrity&#160;Verification</b></a></p>
<p style="position:absolute;top:914px;left:727px;white-space:nowrap" class="ft517"><b>48</b></p>
<p style="position:absolute;top:932px;left:248px;white-space:nowrap" class="ft512"><a href="">5.1</a></p>
<p style="position:absolute;top:932px;left:283px;white-space:nowrap" class="ft512"><a href="">Motivation&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:932px;left:727px;white-space:nowrap" class="ft512">48</p>
<p style="position:absolute;top:950px;left:248px;white-space:nowrap" class="ft512"><a href="">5.2</a></p>
<p style="position:absolute;top:950px;left:283px;white-space:nowrap" class="ft512"><a href="">Requirement&#160;Analysis&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:950px;left:727px;white-space:nowrap" class="ft512">50</p>
<p style="position:absolute;top:968px;left:248px;white-space:nowrap" class="ft512"><a href="">5.3</a></p>
<p style="position:absolute;top:968px;left:283px;white-space:nowrap" class="ft512"><a href="">Basic&#160;Concept&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:968px;left:727px;white-space:nowrap" class="ft512">51</p>
<p style="position:absolute;top:986px;left:248px;white-space:nowrap" class="ft512"><a href="">5.4</a></p>
<p style="position:absolute;top:986px;left:283px;white-space:nowrap" class="ft512"><a href="">System&#160;Architecture&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:986px;left:727px;white-space:nowrap" class="ft512">51</p>
<p style="position:absolute;top:1003px;left:248px;white-space:nowrap" class="ft512"><a href="">5.5</a></p>
<p style="position:absolute;top:1003px;left:283px;white-space:nowrap" class="ft512"><a href="">Credentials,&#160;Extensions&#160;and&#160;their&#160;Usage&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:1003px;left:727px;white-space:nowrap" class="ft512">55</p>
<p style="position:absolute;top:1021px;left:248px;white-space:nowrap" class="ft512"><a href="">5.6</a></p>
<p style="position:absolute;top:1021px;left:283px;white-space:nowrap" class="ft512"><a href="">Implementing&#160;a&#160;Trusted&#160;Channel&#160;with&#160;OpenSSL</a></p>
<p style="position:absolute;top:1021px;left:588px;white-space:nowrap" class="ft512">.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:1021px;left:727px;white-space:nowrap" class="ft512">60</p>
<p style="position:absolute;top:1039px;left:248px;white-space:nowrap" class="ft512"><a href="">5.7</a></p>
<p style="position:absolute;top:1039px;left:283px;white-space:nowrap" class="ft512"><a href="">Security&#160;Considerations&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:1039px;left:727px;white-space:nowrap" class="ft512">62</p>
<p style="position:absolute;top:1057px;left:248px;white-space:nowrap" class="ft512"><a href="">5.8</a></p>
<p style="position:absolute;top:1057px;left:283px;white-space:nowrap" class="ft512"><a href="">Functional&#160;Considerations&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:1057px;left:727px;white-space:nowrap" class="ft512">63</p>
<p style="position:absolute;top:1117px;left:480px;white-space:nowrap" class="ft512">3</p>
</div>
<!-- Page 6 -->
<a name="6"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft618{font-size:15px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page6-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL006.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft612">4</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft618">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:193px;left:172px;white-space:nowrap" class="ft612"><a href="">5.9</a></p>
<p style="position:absolute;top:193px;left:207px;white-space:nowrap" class="ft612"><a href="">Summary&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:193px;left:651px;white-space:nowrap" class="ft612">64</p>
<p style="position:absolute;top:226px;left:150px;white-space:nowrap" class="ft617"><a href=""><b>6</b></a></p>
<p style="position:absolute;top:226px;left:172px;white-space:nowrap" class="ft617"><a href=""><b>Conclusion&#160;and&#160;Outlook</b></a></p>
<p style="position:absolute;top:226px;left:651px;white-space:nowrap" class="ft617"><b>65</b></p>
<p style="position:absolute;top:259px;left:150px;white-space:nowrap" class="ft617"><a href=""><b>A&#160;Some&#160;details&#160;on&#160;Trusted&#160;Channel&#160;Implementation</b></a></p>
<p style="position:absolute;top:259px;left:651px;white-space:nowrap" class="ft617"><b>66</b></p>
<p style="position:absolute;top:277px;left:172px;white-space:nowrap" class="ft612"><a href="">A.1&#160;Details&#160;of&#160;Hardware&#160;and&#160;Virtualization&#160;Layer&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:277px;left:651px;white-space:nowrap" class="ft612">66</p>
<p style="position:absolute;top:295px;left:172px;white-space:nowrap" class="ft612"><a href="">A.2&#160;Linkage&#160;of&#160;Configuration&#160;Information&#160;to&#160;Secure&#160;Channel&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:295px;left:651px;white-space:nowrap" class="ft612">69</p>
<p style="position:absolute;top:313px;left:172px;white-space:nowrap" class="ft612"><a href="">A.3&#160;State-Change&#160;Protocol&#160;Flow&#160;</a>.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.&#160;.</p>
<p style="position:absolute;top:313px;left:651px;white-space:nowrap" class="ft612">70</p>
<p style="position:absolute;top:346px;left:150px;white-space:nowrap" class="ft617"><a href=""><b>Bibliography</b></a></p>
<p style="position:absolute;top:346px;left:651px;white-space:nowrap" class="ft617"><b>71</b></p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft618">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 7 -->
<a name="7"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft719{font-size:31px;font-family:Times;color:#000000;}
	.ft720{font-size:22px;font-family:Times;color:#000000;}
	.ft721{font-size:10px;font-family:Times;color:#000000;}
	.ft722{font-size:9px;font-family:Times;color:#000000;}
-->
</style>
<div id="page7-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL007.png" alt="background image"/>
<p style="position:absolute;top:295px;left:226px;white-space:nowrap" class="ft719"><b>Chapter&#160;1</b></p>
<p style="position:absolute;top:365px;left:226px;white-space:nowrap" class="ft716"><b>Introduction&#160;and&#160;Outline</b></p>
<p style="position:absolute;top:463px;left:226px;white-space:nowrap" class="ft720"><b>1.1</b></p>
<p style="position:absolute;top:463px;left:274px;white-space:nowrap" class="ft720"><b>Introduction</b></p>
<p style="position:absolute;top:500px;left:226px;white-space:nowrap" class="ft715">Hardware&#160;virtualization&#160;is&#160;enjoying&#160;a&#160;resurgence&#160;of&#160;interest&#160;fueled&#160;in&#160;part&#160;by&#160;its&#160;cost-<br/>saving&#160;potential.&#160;By&#160;allowing&#160;multiple&#160;virtual&#160;machines&#160;to&#160;be&#160;hosted&#160;on&#160;a&#160;single&#160;phys-<br/>ical&#160;server,&#160;virtualization&#160;helps&#160;improve&#160;server&#160;utilization,&#160;reduce&#160;management&#160;and<br/>power&#160;costs,&#160;and&#160;control&#160;the&#160;problem&#160;of&#160;server&#160;sprawl.</p>
<p style="position:absolute;top:572px;left:248px;white-space:nowrap" class="ft712">A&#160;prominent&#160;example&#160;in&#160;this&#160;context&#160;is&#160;data&#160;centers.&#160;The&#160;<i>infrastructure&#160;provider</i>,</p>
<p style="position:absolute;top:590px;left:226px;white-space:nowrap" class="ft715">who&#160;owns,&#160;runs,&#160;and&#160;manages&#160;the&#160;data&#160;center,&#160;can&#160;transfer&#160;the&#160;cost&#160;savings&#160;to&#160;its&#160;cus-<br/>tomers&#160;or&#160;<i>outsourcing&#160;companies</i>,&#160;whose&#160;virtual&#160;infrastructures&#160;are&#160;hosted&#160;on&#160;the&#160;data<br/>center’s&#160;physical&#160;resources.&#160;A&#160;large&#160;number&#160;of&#160;the&#160;companies&#160;that&#160;outsource&#160;their&#160;op-<br/>erations&#160;are&#160;small&#160;and&#160;medium&#160;businesses&#160;or&#160;SMBs,&#160;which&#160;cannot&#160;afford&#160;the&#160;costs&#160;of&#160;a<br/>dedicated&#160;data&#160;center&#160;in&#160;which&#160;all&#160;the&#160;data&#160;center’s&#160;resources&#160;are&#160;used&#160;to&#160;host&#160;a&#160;single<br/>company’s&#160;IT&#160;infrastructure.&#160;Hence,&#160;the&#160;IT&#160;infrastructure&#160;belonging&#160;to&#160;multiple&#160;SMBs<br/>may&#160;be&#160;hosted&#160;inside&#160;the&#160;same&#160;data&#160;center&#160;facility.&#160;Today,&#160;even&#160;in&#160;such&#160;“shared”&#160;data<br/>centers,&#160;each&#160;run&#160;on&#160;distinct&#160;physical&#160;resources&#160;and&#160;there&#160;is&#160;no&#160;resource&#160;sharing&#160;among<br/>various&#160;customers.&#160;In&#160;this&#160;so-called&#160;<i>physical&#160;cages&#160;</i>model,&#160;the&#160;customers&#160;are&#160;physically<br/>isolated&#160;from&#160;each&#160;other&#160;in&#160;the&#160;same&#160;data&#160;center.</p>
<p style="position:absolute;top:769px;left:248px;white-space:nowrap" class="ft712">Limited&#160;trust&#160;in&#160;the&#160;security&#160;of&#160;virtual&#160;datacenters&#160;is&#160;one&#160;major&#160;reason&#160;for&#160;customers</p>
<p style="position:absolute;top:787px;left:226px;white-space:nowrap" class="ft715">not&#160;sharing&#160;physical&#160;resources.&#160;Since&#160;management&#160;is&#160;usually&#160;performed&#160;manually,&#160;ad-<br/>ministrative&#160;errors&#160;are&#160;commonplace.&#160;While&#160;this&#160;may&#160;lead&#160;to&#160;down-times&#160;in&#160;virtual<br/>datacenters&#160;used&#160;by&#160;a&#160;single&#160;customer,&#160;it&#160;can&#160;lead&#160;to&#160;information&#160;leakages&#160;to&#160;competi-<br/>tors&#160;if&#160;the&#160;datacenter&#160;is&#160;shared.&#160;Furthermore,&#160;multiple&#160;organizations&#160;will&#160;only&#160;allow<br/>sharing&#160;of&#160;physical&#160;resources&#160;if&#160;they&#160;can&#160;trust&#160;that&#160;security&#160;incidents&#160;cannot&#160;spread<br/>across&#160;the&#160;isolation&#160;boundary&#160;separating&#160;two&#160;customers.</p>
<p style="position:absolute;top:917px;left:226px;white-space:nowrap" class="ft717"><b>Security&#160;Objectives</b></p>
<p style="position:absolute;top:917px;left:366px;white-space:nowrap" class="ft712">Our&#160;main&#160;security&#160;objective&#160;is&#160;to&#160;provide&#160;isolation&#160;among&#160;dif-</p>
<p style="position:absolute;top:935px;left:226px;white-space:nowrap" class="ft712">ferent&#160;domains&#160;that&#160;is&#160;comparabl<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#7">e</a></p>
<p style="position:absolute;top:932px;left:428px;white-space:nowrap" class="ft721"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#7">1</a></p>
<p style="position:absolute;top:935px;left:437px;white-space:nowrap" class="ft712">with&#160;the&#160;isolation&#160;obtained&#160;by&#160;providing&#160;one&#160;infras-</p>
<p style="position:absolute;top:953px;left:226px;white-space:nowrap" class="ft715">tructure&#160;for&#160;each&#160;customer.&#160;In&#160;particular,&#160;we&#160;require&#160;a&#160;security&#160;architecture&#160;that&#160;protects<br/>those&#160;system&#160;components&#160;that&#160;provide&#160;the&#160;required&#160;isolation&#160;or&#160;allow&#160;to&#160;verifiably&#160;rea-<br/>son&#160;about&#160;their&#160;trustworthiness&#160;of&#160;and&#160;also&#160;of&#160;any&#160;peer&#160;endpoint&#160;(local&#160;or&#160;remote)&#160;with<br/>a&#160;domain,&#160;i.e.,&#160;whether&#160;they&#160;conforms&#160;to&#160;the&#160;underlying&#160;security&#160;policy.</p>
<p style="position:absolute;top:1024px;left:248px;white-space:nowrap" class="ft712">We&#160;achieve&#160;this&#160;by&#160;grouping&#160;VMs&#160;dispersed&#160;across&#160;multiple&#160;physical&#160;resources</p>
<p style="position:absolute;top:1042px;left:226px;white-space:nowrap" class="ft712">into&#160;a&#160;<i>virtual&#160;zone&#160;</i>in&#160;which&#160;customer-specified&#160;security&#160;requirements&#160;are&#160;automatically</p>
<p style="position:absolute;top:1069px;left:242px;white-space:nowrap" class="ft722">1</p>
<p style="position:absolute;top:1071px;left:247px;white-space:nowrap" class="ft710">Note&#160;that&#160;unlike&#160;physical&#160;isolation,&#160;we&#160;do&#160;not&#160;solve&#160;the&#160;problem&#160;of&#160;covert&#160;channels.</p>
<p style="position:absolute;top:1117px;left:480px;white-space:nowrap" class="ft712">5</p>
</div>
<!-- Page 8 -->
<a name="8"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft823{font-size:13px;font-family:EDWLKR+TTCADo00;color:#000000;}
	.ft824{font-size:9px;font-family:UFQSLH+TTCAEo00;color:#000000;}
	.ft825{font-size:14px;font-family:RDZRPI+TTCAFo00;color:#000000;}
	.ft826{font-size:13px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page8-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL008.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft812">6</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft818">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:193px;left:150px;white-space:nowrap" class="ft815">enforced.&#160;Even&#160;if&#160;VMs&#160;are&#160;migrated&#160;(say,&#160;for&#160;load-balancing&#160;purposes)&#160;the&#160;logical<br/>topology&#160;reflected&#160;by&#160;the&#160;virtual&#160;domain&#160;should&#160;remain&#160;unchanged.&#160;We&#160;deploy&#160;Trusted<br/>Computing&#160;(TC)&#160;functionality&#160;to&#160;determine&#160;the&#160;trustworthiness&#160;(assure&#160;the&#160;integrity)&#160;of<br/>the&#160;policy&#160;enforcement&#160;components.</p>
<p style="position:absolute;top:265px;left:172px;white-space:nowrap" class="ft812">Such&#160;a&#160;model&#160;would&#160;provide&#160;better&#160;flexibility,&#160;adaptability,&#160;cost&#160;savings&#160;than&#160;to-</p>
<p style="position:absolute;top:283px;left:150px;white-space:nowrap" class="ft815">day’s&#160;physical&#160;cages&#160;model&#160;while&#160;still&#160;providing&#160;the&#160;main&#160;security&#160;guarantees&#160;required<br/>for&#160;applications&#160;such&#160;as&#160;datacenters.</p>
<p style="position:absolute;top:441px;left:416px;white-space:nowrap" class="ft823">Hardware&#160;Platform</p>
<p style="position:absolute;top:416px;left:438px;white-space:nowrap" class="ft823">Hypervisor</p>
<p style="position:absolute;top:394px;left:422px;white-space:nowrap" class="ft823">Security&#160;Services</p>
<p style="position:absolute;top:342px;left:377px;white-space:nowrap" class="ft823">VM</p>
<p style="position:absolute;top:351px;left:396px;white-space:nowrap" class="ft824">A1</p>
<p style="position:absolute;top:342px;left:422px;white-space:nowrap" class="ft823">VM</p>
<p style="position:absolute;top:351px;left:441px;white-space:nowrap" class="ft824">A2</p>
<p style="position:absolute;top:343px;left:477px;white-space:nowrap" class="ft823">VM</p>
<p style="position:absolute;top:351px;left:495px;white-space:nowrap" class="ft824">A3</p>
<p style="position:absolute;top:343px;left:522px;white-space:nowrap" class="ft823">VM</p>
<p style="position:absolute;top:351px;left:540px;white-space:nowrap" class="ft824">A4</p>
<p style="position:absolute;top:428px;left:266px;white-space:nowrap" class="ft825">TVD1</p>
<p style="position:absolute;top:445px;left:261px;white-space:nowrap" class="ft825">Master</p>
<p style="position:absolute;top:431px;left:270px;white-space:nowrap" class="ft825">TVD1</p>
<p style="position:absolute;top:449px;left:264px;white-space:nowrap" class="ft825">Master</p>
<p style="position:absolute;top:435px;left:274px;white-space:nowrap" class="ft825">TVD1</p>
<p style="position:absolute;top:453px;left:269px;white-space:nowrap" class="ft825">Master</p>
<p style="position:absolute;top:369px;left:379px;white-space:nowrap" class="ft823">Proxy1</p>
<p style="position:absolute;top:372px;left:538px;white-space:nowrap" class="ft826">…</p>
<p style="position:absolute;top:369px;left:477px;white-space:nowrap" class="ft823">Proxy2</p>
<p style="position:absolute;top:588px;left:416px;white-space:nowrap" class="ft823">Hardware&#160;Platform</p>
<p style="position:absolute;top:564px;left:438px;white-space:nowrap" class="ft823">Hypervisor</p>
<p style="position:absolute;top:542px;left:422px;white-space:nowrap" class="ft823">Security&#160;Services</p>
<p style="position:absolute;top:490px;left:378px;white-space:nowrap" class="ft823">VM</p>
<p style="position:absolute;top:498px;left:396px;white-space:nowrap" class="ft824">B1</p>
<p style="position:absolute;top:490px;left:423px;white-space:nowrap" class="ft823">VM</p>
<p style="position:absolute;top:498px;left:441px;white-space:nowrap" class="ft824">B2</p>
<p style="position:absolute;top:490px;left:469px;white-space:nowrap" class="ft823">VM</p>
<p style="position:absolute;top:498px;left:487px;white-space:nowrap" class="ft824">B3</p>
<p style="position:absolute;top:490px;left:514px;white-space:nowrap" class="ft823">VM</p>
<p style="position:absolute;top:498px;left:532px;white-space:nowrap" class="ft824">B4</p>
<p style="position:absolute;top:517px;left:379px;white-space:nowrap" class="ft823">Proxy1</p>
<p style="position:absolute;top:520px;left:538px;white-space:nowrap" class="ft826">…</p>
<p style="position:absolute;top:517px;left:477px;white-space:nowrap" class="ft823">Proxy2</p>
<p style="position:absolute;top:632px;left:247px;white-space:nowrap" class="ft812">Figure&#160;1.1:&#160;TVD&#160;Architecture:&#160;High-Level&#160;Overview.</p>
<p style="position:absolute;top:705px;left:150px;white-space:nowrap" class="ft817"><b>Contribution</b></p>
<p style="position:absolute;top:705px;left:248px;white-space:nowrap" class="ft812">In&#160;this&#160;deliverable,&#160;we&#160;provide&#160;a&#160;blueprint&#160;for&#160;realizing&#160;a&#160;logical&#160;cages</p>
<p style="position:absolute;top:723px;left:150px;white-space:nowrap" class="ft815">model,&#160;in&#160;particular&#160;for&#160;virtualized&#160;data&#160;centers,&#160;based&#160;on&#160;a&#160;concept&#160;called&#160;Trusted<br/>Virtual&#160;Domains&#160;or&#160;TVDs&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#74">[11]</a>.&#160;Based&#160;on&#160;previous&#160;work,&#160;we&#160;describe&#160;a&#160;security&#160;man-<br/>agement&#160;framework&#160;that&#160;helps&#160;to&#160;realize&#160;the&#160;abstraction&#160;of&#160;TVDs&#160;by&#160;guaranteeing&#160;reli-<br/>able&#160;isolation&#160;and&#160;flow&#160;control&#160;between&#160;domain&#160;boundaries.&#160;Our&#160;framework&#160;employs<br/>networking&#160;and&#160;storage&#160;virtualization&#160;technologies&#160;as&#160;well&#160;as&#160;Trusted&#160;Computing&#160;for<br/>policy&#160;verification.&#160;Our&#160;main&#160;contributions&#160;are&#160;(1)&#160;combining&#160;these&#160;technologies&#160;to<br/>realize&#160;TVDs&#160;and&#160;(2)&#160;orchestrating&#160;them&#160;through&#160;a&#160;management&#160;framework&#160;that&#160;auto-<br/>matically&#160;enforces&#160;isolation&#160;among&#160;different&#160;zones.&#160;In&#160;particular,&#160;our&#160;solution&#160;aims&#160;at<br/>automating&#160;the&#160;verification,&#160;instantiation&#160;and&#160;deployment&#160;of&#160;the&#160;appropriate&#160;security<br/>mechanisms&#160;and&#160;virtualization&#160;technologies&#160;based&#160;on&#160;an&#160;input&#160;security&#160;model,&#160;which<br/>specifies&#160;the&#160;required&#160;level&#160;of&#160;isolation&#160;and&#160;permitted&#160;information&#160;flows.</p>
<p style="position:absolute;top:948px;left:150px;white-space:nowrap" class="ft820"><b>1.2</b></p>
<p style="position:absolute;top:948px;left:198px;white-space:nowrap" class="ft820"><b>Outline&#160;of&#160;this&#160;Report</b></p>
<p style="position:absolute;top:986px;left:150px;white-space:nowrap" class="ft815">We&#160;first&#160;survey&#160;background&#160;and&#160;related&#160;work&#160;in&#160;Chapter&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#10">2.&#160;</a>The&#160;first&#160;technical&#160;part&#160;of<br/>this&#160;report&#160;describes&#160;the&#160;integrity&#160;and&#160;assurance&#160;management&#160;of&#160;the&#160;OpenTC&#160;Security<br/>Services.&#160;This&#160;has&#160;two&#160;aspects:&#160;In&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#14">3&#160;</a>we&#160;describe&#160;how&#160;integrity&#160;statements<br/>about&#160;virtual&#160;machines&#160;can&#160;be&#160;made&#160;and&#160;how&#160;data&#160;can&#160;be&#160;bound&#160;to&#160;the&#160;integrity&#160;of&#160;a<br/>machine.&#160;We&#160;also&#160;describe&#160;how&#160;to&#160;protect&#160;the&#160;privacy&#160;of&#160;users&#160;using&#160;our&#160;system.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft818">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 9 -->
<a name="9"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page9-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL009.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft912">CHAPTER&#160;1.&#160;INTRODUCTION&#160;AND&#160;OUTLINE</p>
<p style="position:absolute;top:141px;left:734px;white-space:nowrap" class="ft912">7</p>
<p style="position:absolute;top:193px;left:248px;white-space:nowrap" class="ft912">In&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#30">4&#160;</a>we&#160;extend&#160;these&#160;results&#160;to&#160;cover&#160;hierarchical&#160;integrity&#160;management,</p>
<p style="position:absolute;top:211px;left:226px;white-space:nowrap" class="ft915">i.e.,&#160;the&#160;integrity&#160;protection&#160;of&#160;packages&#160;of&#160;multiple&#160;virtual&#160;machines&#160;and&#160;the&#160;related<br/>components.</p>
<p style="position:absolute;top:247px;left:248px;white-space:nowrap" class="ft912">The&#160;second&#160;technical&#160;part&#160;of&#160;this&#160;report&#160;covers&#160;secure&#160;channels.&#160;Chapter&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#50">5&#160;</a>describes</p>
<p style="position:absolute;top:265px;left:226px;white-space:nowrap" class="ft915">how&#160;to&#160;establish&#160;a&#160;secure&#160;channel&#160;while&#160;verifying&#160;the&#160;integrity&#160;of&#160;the&#160;peer.&#160;This&#160;allows<br/>users&#160;to&#160;not&#160;only&#160;guarantee&#160;the&#160;integrity&#160;of&#160;a&#160;given&#160;machine&#160;but&#160;also&#160;to&#160;securely&#160;connect<br/>to&#160;the&#160;machine&#160;that&#160;has&#160;been&#160;validated.</p>
<p style="position:absolute;top:319px;left:248px;white-space:nowrap" class="ft912">In&#160;Chapter&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#67">6&#160;</a>we&#160;conclude&#160;this&#160;report&#160;and&#160;point&#160;out&#160;selected&#160;open&#160;problems.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft918">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 10 -->
<a name="10"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page10-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL010.png" alt="background image"/>
<p style="position:absolute;top:295px;left:150px;white-space:nowrap" class="ft1019"><b>Chapter&#160;2</b></p>
<p style="position:absolute;top:365px;left:150px;white-space:nowrap" class="ft1016"><b>Related&#160;Work</b></p>
<p style="position:absolute;top:458px;left:150px;white-space:nowrap" class="ft1015">Virtualization&#160;and&#160;Trusted&#160;Computing&#160;have&#160;gained&#160;prominence&#160;in&#160;the&#160;past&#160;ten&#160;years<br/>as&#160;commercial&#160;interests&#160;have&#160;led&#160;to&#160;consolidating&#160;multiple&#160;virtual&#160;machines&#160;on&#160;a&#160;sin-<br/>gle&#160;physical&#160;host.&#160;Virtualization&#160;enables&#160;simple&#160;consolidation&#160;and&#160;isolation&#160;while<br/>Trusted&#160;Computing&#160;promises&#160;increased&#160;security&#160;guarantees.&#160;In&#160;this&#160;section,&#160;we&#160;in-<br/>troduce&#160;Trusted&#160;Computing&#160;technology&#160;in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#10">2.1&#160;</a>and&#160;virtualization&#160;in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#11">2.2.<br/></a>Furthermore,&#160;secure&#160;networking&#160;and&#160;other&#160;concepts&#160;applied&#160;in&#160;this&#160;report&#160;are&#160;described.</p>
<p style="position:absolute;top:594px;left:150px;white-space:nowrap" class="ft1020"><b>2.1</b></p>
<p style="position:absolute;top:594px;left:198px;white-space:nowrap" class="ft1020"><b>Trusted&#160;Computing</b></p>
<p style="position:absolute;top:632px;left:150px;white-space:nowrap" class="ft1015">Trusted&#160;Computing&#160;technology&#160;aims&#160;to&#160;provide&#160;a&#160;cryptographic&#160;guarantee&#160;of&#160;the&#160;in-<br/>tegrity&#160;of&#160;a&#160;computing&#160;platform.&#160;Arbaugh&#160;<i>et&#160;al.&#160;</i>developed&#160;AEGIS&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#74">[7]</a>,&#160;the&#160;architecture<br/>on&#160;which&#160;most&#160;subsequent&#160;Trusted&#160;Computing&#160;systems&#160;are&#160;based.&#160;AEGIS&#160;is&#160;respon-<br/>sible&#160;for&#160;introducing&#160;two&#160;fundamental&#160;concepts:&#160;the&#160;use&#160;of&#160;cryptographic&#160;hashes&#160;(in-<br/>tegrity&#160;measurements)&#160;of&#160;platform&#160;code&#160;to&#160;demonstrate&#160;integrity,&#160;and&#160;the&#160;<i>chain&#160;of&#160;trust</i>.</p>
<p style="position:absolute;top:721px;left:172px;white-space:nowrap" class="ft1012">A&#160;piece&#160;of&#160;code&#160;has&#160;integrity&#160;if&#160;it&#160;has&#160;not&#160;been&#160;changed&#160;in&#160;an&#160;unauthorized&#160;manner</p>
<p style="position:absolute;top:739px;left:150px;white-space:nowrap" class="ft1015">during&#160;a&#160;defined&#160;period&#160;of&#160;time.&#160;Any&#160;change,&#160;however&#160;small,&#160;to&#160;the&#160;code&#160;would&#160;result&#160;in<br/>a&#160;complete&#160;change&#160;in&#160;the&#160;hash&#160;value:&#160;the&#160;hash&#160;is&#160;therefore&#160;a&#160;concise&#160;means&#160;of&#160;represent-<br/>ing&#160;the&#160;code.&#160;The&#160;integrity&#160;of&#160;an&#160;entire&#160;platform&#160;can&#160;be&#160;captured&#160;by&#160;starting&#160;the&#160;boot<br/>process&#160;with&#160;a&#160;<i>core&#160;root&#160;of&#160;trust&#160;for&#160;measurement&#160;(CRTM)</i>,&#160;which&#160;might&#160;be&#160;a&#160;BIOS<br/>boot&#160;block,&#160;for&#160;example.&#160;The&#160;CRTM&#160;loads&#160;the&#160;next&#160;component&#160;in&#160;the&#160;boot&#160;process,<br/>measures&#160;(hashes)&#160;it,&#160;and&#160;stores&#160;that&#160;measurement&#160;in&#160;a&#160;secure&#160;location.&#160;That&#160;compo-<br/>nent&#160;then&#160;carries&#160;out&#160;whatever&#160;processing&#160;is&#160;necessary&#160;before&#160;loading&#160;and&#160;measuring<br/>the&#160;next&#160;component,&#160;and&#160;chaining&#160;the&#160;measurement&#160;to&#160;the&#160;secure&#160;log.&#160;This&#160;process&#160;re-<br/>peats&#160;until&#160;all&#160;trusted&#160;components&#160;are&#160;loaded.&#160;The&#160;integrity&#160;of&#160;the&#160;whole&#160;platform&#160;can<br/>then&#160;be&#160;proved&#160;by&#160;induction&#160;over&#160;the&#160;log&#160;of&#160;integrity&#160;measurements.</p>
<p style="position:absolute;top:919px;left:172px;white-space:nowrap" class="ft1012">AEGIS&#160;inspired&#160;the&#160;most&#160;common&#160;Trusted&#160;Computing&#160;architecture,&#160;which&#160;is&#160;de-</p>
<p style="position:absolute;top:936px;left:150px;white-space:nowrap" class="ft1015">fined&#160;by&#160;the&#160;Trusted&#160;Computing&#160;Group&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[74]</a>.&#160;In&#160;this&#160;architecture,&#160;every&#160;computer<br/>contains&#160;a&#160;secure&#160;co-processor,&#160;known&#160;as&#160;a&#160;Trusted&#160;Platform&#160;Module&#160;(TPM),&#160;which<br/>enables&#160;the&#160;enforcement&#160;of&#160;security&#160;policies&#160;by&#160;controlling&#160;access&#160;to&#160;cryptographic<br/>material&#160;and&#160;primitives.&#160;It&#160;also&#160;provides&#160;secure&#160;storage&#160;in&#160;the&#160;form&#160;of&#160;Platform&#160;Config-<br/>uration&#160;Registers&#160;(PCRs),&#160;which&#160;may&#160;only&#160;be&#160;reset&#160;or&#160;<i>extended</i>.&#160;Extension&#160;is&#160;used&#160;to<br/>represent&#160;an&#160;entire&#160;chain&#160;of&#160;trust&#160;in&#160;a&#160;single&#160;register,&#160;and&#160;we&#160;discuss&#160;this&#160;further&#160;in&#160;Sec-<br/>tion&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#33">4.3.&#160;</a>A&#160;secure&#160;boot-loader,&#160;such&#160;as&#160;OSLO&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#77">[38]</a>,&#160;is&#160;required&#160;to&#160;ensure&#160;that&#160;the&#160;initial<br/>state&#160;of&#160;the&#160;TPM&#160;reflects&#160;the&#160;first&#160;component&#160;that&#160;is&#160;loaded.&#160;Thereafter,&#160;all&#160;subsequent</p>
<p style="position:absolute;top:1117px;left:404px;white-space:nowrap" class="ft1012">8</p>
</div>
<!-- Page 11 -->
<a name="11"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1127{font-size:15px;font-family:CJQKFA+CMSS10;color:#000000;}
	.ft1128{font-size:15px;font-family:AOPIOY+CMR10;color:#000000;}
	.ft1129{font-size:15px;font-family:ZJCXWN+CMMI10;color:#000000;}
	.ft1130{font-size:15px;line-height:17px;font-family:Times;color:#000000;}
-->
</style>
<div id="page11-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL011.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1112">CHAPTER&#160;2.&#160;RELATED&#160;WORK</p>
<p style="position:absolute;top:141px;left:734px;white-space:nowrap" class="ft1112">9</p>
<p style="position:absolute;top:193px;left:226px;white-space:nowrap" class="ft1115">platform&#160;components,&#160;including&#160;the&#160;operating&#160;system&#160;kernel&#160;and&#160;device&#160;drivers,&#160;can&#160;be<br/>securely&#160;loaded&#160;by&#160;the&#160;preceding&#160;component.</p>
<p style="position:absolute;top:229px;left:248px;white-space:nowrap" class="ft1112">The&#160;TPM&#160;features&#160;we&#160;leverage&#160;are&#160;integrity&#160;measurement,&#160;sealing,&#160;and&#160;attestation.</p>
<p style="position:absolute;top:247px;left:226px;white-space:nowrap" class="ft1115"><i>Measurement&#160;</i>of&#160;a&#160;component&#160;involves&#160;computing&#160;the&#160;SHA-1&#160;hash&#160;of&#160;the&#160;binary&#160;code<br/>of&#160;that&#160;component.&#160;The&#160;sequence&#160;of&#160;measured&#160;values&#160;are&#160;stored&#160;in&#160;a&#160;<i>measurement&#160;log</i>,<br/>external&#160;to&#160;the&#160;TPM.&#160;<i>Sealing&#160;</i>is&#160;a&#160;TPM&#160;operation&#160;that&#160;is&#160;used&#160;to&#160;ensure&#160;that&#160;a&#160;certain<br/>data&#160;item&#160;is&#160;accessible&#160;only&#160;under&#160;platform&#160;configurations&#160;reflected&#160;by&#160;PCR&#160;values.<br/>The&#160;<i>unsealing&#160;</i>operation&#160;will&#160;reveal&#160;the&#160;data&#160;item&#160;only&#160;if&#160;the&#160;PCR&#160;values&#160;at&#160;the&#160;time&#160;of<br/>the&#160;operation&#160;match&#160;the&#160;PCR&#160;value&#160;specified&#160;at&#160;the&#160;time&#160;of&#160;sealing.&#160;<i>Attestation&#160;</i>refers<br/>to&#160;the&#160;challenge-response&#160;style&#160;cryptographic&#160;protocol&#160;for&#160;a&#160;remote&#160;verifier&#160;to&#160;query<br/>the&#160;platform&#160;measurement&#160;values&#160;recorded&#160;and&#160;for&#160;the&#160;platform&#160;to&#160;reliably&#160;report&#160;the<br/>requested&#160;values.&#160;The&#160;verifier&#160;first&#160;sends&#160;a&#160;challenge&#160;to&#160;the&#160;platform.&#160;The&#160;platform<br/>invokes&#160;the</p>
<p style="position:absolute;top:408px;left:298px;white-space:nowrap" class="ft1127">TPM</p>
<p style="position:absolute;top:409px;left:331px;white-space:nowrap" class="ft1112">_</p>
<p style="position:absolute;top:408px;left:338px;white-space:nowrap" class="ft1127">Quote</p>
<p style="position:absolute;top:409px;left:380px;white-space:nowrap" class="ft1112">command&#160;with&#160;the&#160;challenge&#160;as&#160;a&#160;parameter.&#160;The&#160;invocation</p>
<p style="position:absolute;top:427px;left:226px;white-space:nowrap" class="ft1115">also&#160;carries&#160;an&#160;indication&#160;of&#160;which&#160;PCRs&#160;are&#160;of&#160;interest.&#160;The&#160;TPM&#160;returns&#160;a&#160;signed<br/><i>quote&#160;</i>containing&#160;the&#160;challenge&#160;and&#160;the&#160;values&#160;of&#160;the&#160;specified&#160;PCRs.&#160;The&#160;TPM&#160;signs<br/>using&#160;the&#160;Attestation&#160;Identity&#160;Key&#160;(AIK),&#160;whose&#160;public&#160;key&#160;is&#160;certified&#160;by&#160;a&#160;third&#160;party<br/>that&#160;the&#160;verifier&#160;trusts.&#160;The&#160;platform&#160;then&#160;replies&#160;to&#160;the&#160;verifier&#160;with&#160;the&#160;signed&#160;quote<br/>along&#160;with&#160;log&#160;information&#160;that&#160;is&#160;necessary&#160;to&#160;reconstruct&#160;the&#160;platform’s&#160;configuration.<br/>Based&#160;on&#160;the&#160;reply,&#160;the&#160;verifier&#160;can&#160;decide&#160;whether&#160;the&#160;platform&#160;is&#160;in&#160;an&#160;acceptable&#160;state.</p>
<p style="position:absolute;top:534px;left:248px;white-space:nowrap" class="ft1112">A&#160;further&#160;consideration&#160;is&#160;the&#160;Trusted&#160;Computing&#160;Base&#160;(TCB).&#160;This&#160;term&#160;is&#160;used</p>
<p style="position:absolute;top:552px;left:226px;white-space:nowrap" class="ft1115">inconsistently&#160;in&#160;the&#160;literature,&#160;and&#160;we&#160;prefer&#160;the&#160;definition&#160;from&#160;Hohmuth&#160;<i>et&#160;al</i>,&#160;who<br/>refer&#160;to&#160;“the&#160;set&#160;of&#160;components&#160;on&#160;which&#160;a&#160;subsystem&#160;S&#160;depends&#160;as&#160;the&#160;<i>TCB&#160;of&#160;S</i>.”&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[34]<br/></a>Therefore&#160;a&#160;single&#160;platform&#160;could&#160;contain&#160;multiple&#160;TCBs,&#160;depending&#160;on&#160;the&#160;set&#160;of&#160;ap-<br/>plications&#160;that&#160;runs&#160;on&#160;it.&#160;In&#160;this&#160;work,&#160;we&#160;refer&#160;to&#160;the&#160;<i>platform&#160;TCB&#160;</i>as&#160;the&#160;set&#160;of<br/>components&#160;on&#160;which&#160;all&#160;other&#160;platform&#160;components&#160;depend,&#160;and&#160;the&#160;<i>application&#160;TCB<br/></i>as&#160;the&#160;set&#160;of&#160;components&#160;on&#160;which&#160;a&#160;particular&#160;application&#160;depends.&#160;This&#160;distinction<br/>can&#160;be&#160;illustrated&#160;by&#160;considering&#160;the&#160;following&#160;scenario.&#160;A&#160;web&#160;browser&#160;depends&#160;on<br/>HTML&#160;rendering&#160;for&#160;correct&#160;execution:&#160;therefore&#160;the&#160;rendering&#160;is&#160;in&#160;the&#160;application<br/>TCB&#160;of&#160;the&#160;browser.&#160;However&#160;(assuming&#160;a&#160;sensible&#160;implementation),&#160;the&#160;rendering<br/>could&#160;not&#160;compromise&#160;the&#160;entire&#160;platform:&#160;therefore&#160;it&#160;is&#160;not&#160;in&#160;the&#160;platform&#160;TCB.</p>
<p style="position:absolute;top:760px;left:226px;white-space:nowrap" class="ft1120"><b>2.2</b></p>
<p style="position:absolute;top:760px;left:274px;white-space:nowrap" class="ft1120"><b>Machine&#160;Virtualization</b></p>
<p style="position:absolute;top:797px;left:226px;white-space:nowrap" class="ft1115">Virtualization&#160;makes&#160;it&#160;possible&#160;to&#160;partition&#160;the&#160;resources&#160;of&#160;a&#160;computer&#160;platform&#160;–<br/>such&#160;as&#160;memory,&#160;CPU,&#160;storage,&#160;and&#160;network&#160;connections&#160;–&#160;among&#160;several&#160;<i>virtual&#160;ma-<br/>chines&#160;(VMs)</i>,&#160;which&#160;provide&#160;an&#160;interface&#160;that&#160;resembles&#160;physical&#160;hardware.&#160;A&#160;<i>virtual<br/>machine&#160;monitor&#160;(VMM)&#160;</i>runs&#160;beneath&#160;the&#160;VMs&#160;and&#160;is&#160;responsible&#160;for&#160;securely&#160;(and<br/>fairly)&#160;multiplexing&#160;access&#160;to&#160;the&#160;physical&#160;resources.&#160;In&#160;addition,&#160;to&#160;preserve&#160;isolation<br/>between&#160;the&#160;VMs,&#160;the&#160;VMM&#160;executes&#160;privileged&#160;instructions&#160;on&#160;behalf&#160;of&#160;the&#160;guest<br/>VMs.&#160;In&#160;our&#160;work,&#160;we&#160;consider&#160;an&#160;architecture&#160;whereby&#160;the&#160;VMM&#160;is&#160;the&#160;only&#160;code<br/>that&#160;runs&#160;at&#160;the&#160;highest&#160;privilege&#160;level;&#160;alternative&#160;approaches&#160;place&#160;the&#160;VMM&#160;inside&#160;a<br/>host&#160;operating&#160;system&#160;kernel&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">[58,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">70]</a>.&#160;In&#160;particular,&#160;we&#160;consider&#160;the&#160;Xen&#160;VMM&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[20]</a>.</p>
<p style="position:absolute;top:959px;left:248px;white-space:nowrap" class="ft1112">VMMs&#160;are&#160;increasingly&#160;used&#160;in&#160;the&#160;development&#160;of&#160;secure&#160;computing&#160;systems&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[15,</a></p>
<p style="position:absolute;top:977px;left:226px;white-space:nowrap" class="ft1115"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">67,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">17]</a>.&#160;The&#160;typical&#160;argument&#160;for&#160;using&#160;a&#160;VMM&#160;is&#160;that&#160;the&#160;amount&#160;of&#160;code&#160;is&#160;relatively<br/>small&#160;by&#160;comparison&#160;to&#160;a&#160;full&#160;operating&#160;system:&#160;the&#160;Xen&#160;VMM&#160;comprises&#160;approxi-<br/>mately</p>
<p style="position:absolute;top:1012px;left:272px;white-space:nowrap" class="ft1128">100</p>
<p style="position:absolute;top:1012px;left:294px;white-space:nowrap" class="ft1129">,</p>
<p style="position:absolute;top:1012px;left:301px;white-space:nowrap" class="ft1128">000</p>
<p style="position:absolute;top:1013px;left:328px;white-space:nowrap" class="ft1112">lines&#160;of&#160;code,&#160;while&#160;a&#160;recent&#160;version&#160;of&#160;the&#160;Linux&#160;kernel&#160;comprises</p>
<p style="position:absolute;top:1030px;left:226px;white-space:nowrap" class="ft1112">approximately&#160;over</p>
<p style="position:absolute;top:1029px;left:349px;white-space:nowrap" class="ft1128">6</p>
<p style="position:absolute;top:1030px;left:362px;white-space:nowrap" class="ft1112">million&#160;lines&#160;of&#160;code.&#160;The&#160;compactness&#160;of&#160;a&#160;VMM&#160;therefore</p>
<p style="position:absolute;top:1048px;left:226px;white-space:nowrap" class="ft1115">makes&#160;it&#160;more&#160;trustworthy&#160;than&#160;a&#160;monolithic&#160;kernel.&#160;It&#160;can&#160;therefore&#160;be&#160;argued&#160;that&#160;it&#160;is<br/>feasible&#160;to&#160;include&#160;a&#160;VMM&#160;inside&#160;a&#160;minimal&#160;TCB.&#160;Note&#160;that&#160;security&#160;flaws&#160;<i>within&#160;</i>a&#160;VM</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft1118">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 12 -->
<a name="12"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page12-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL012.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1212">10</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft1218">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:193px;left:150px;white-space:nowrap" class="ft1215">are&#160;not&#160;solved&#160;by&#160;a&#160;standard&#160;VMM&#160;(although&#160;specialized&#160;VMMs,&#160;such&#160;as&#160;SecVisor,&#160;do<br/>address&#160;this&#160;problem&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[67]</a>).&#160;However,&#160;the&#160;isolation&#160;properties&#160;of&#160;a&#160;VMM&#160;ensure&#160;that<br/>the&#160;compromise&#160;of&#160;one&#160;VM&#160;cannot&#160;affect&#160;another&#160;VM.&#160;Therefore,&#160;virtualization&#160;can&#160;be<br/>used&#160;to&#160;host&#160;applications&#160;from&#160;mutually&#160;distrusting&#160;organizations&#160;on&#160;the&#160;same&#160;physical<br/>machine,&#160;or&#160;to&#160;provide&#160;a&#160;sand-box&#160;for&#160;executing&#160;untrusted&#160;code.</p>
<p style="position:absolute;top:283px;left:172px;white-space:nowrap" class="ft1212">Trusted&#160;virtualization&#160;extends&#160;the&#160;concepts&#160;from&#160;Trusted&#160;Computing,&#160;such&#160;as&#160;chains</p>
<p style="position:absolute;top:301px;left:150px;white-space:nowrap" class="ft1215">of&#160;trust,&#160;into&#160;virtual&#160;machines.&#160;These&#160;can&#160;be&#160;used&#160;to&#160;attest&#160;the&#160;state&#160;of&#160;a&#160;VM&#160;to&#160;a&#160;third<br/>party&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[27]</a>,&#160;or&#160;to&#160;provide&#160;the&#160;illusion&#160;of&#160;a&#160;physical&#160;TPM&#160;to&#160;applications&#160;running&#160;within<br/>a&#160;VM&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#74">[9]</a>.</p>
<p style="position:absolute;top:355px;left:172px;white-space:nowrap" class="ft1212">To&#160;provide&#160;context&#160;for&#160;our&#160;Xen-based&#160;prototype,&#160;we&#160;familiarize&#160;the&#160;reader&#160;with&#160;the</p>
<p style="position:absolute;top:373px;left:150px;white-space:nowrap" class="ft1215">Xen&#160;VM&#160;architecture,&#160;which&#160;is&#160;shown&#160;in&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#15">3.1.&#160;</a>In&#160;Xen-speak,&#160;running&#160;instances<br/>of&#160;VMs&#160;are&#160;called&#160;<i>domains</i>.&#160;A&#160;special&#160;domain,&#160;called&#160;Dom0,&#160;is&#160;the&#160;first&#160;domain&#160;that<br/>is&#160;created.&#160;Normally,&#160;this&#160;domain&#160;controls&#160;all&#160;other&#160;domains,&#160;called&#160;user&#160;domains&#160;or<br/>DomUs.&#160;For&#160;a&#160;given&#160;physical&#160;device,&#160;the&#160;native&#160;device&#160;driver&#160;is&#160;part&#160;of&#160;at&#160;most&#160;one<br/>VM.&#160;If&#160;the&#160;device&#160;is&#160;to&#160;be&#160;shared&#160;with&#160;other&#160;VMs,&#160;then&#160;the&#160;VM&#160;with&#160;the&#160;native&#160;device<br/>driver&#160;makes&#160;the&#160;device&#160;available&#160;through&#160;<i>device&#160;channels&#160;</i>implemented&#160;using&#160;shared<br/>memory.&#160;For&#160;that&#160;purpose,&#160;the&#160;VM&#160;with&#160;the&#160;native&#160;device&#160;driver&#160;provides&#160;a&#160;<i>back-end<br/>driver</i>,&#160;and&#160;any&#160;VM&#160;that&#160;wants&#160;to&#160;share&#160;the&#160;device&#160;exports&#160;a&#160;virtual&#160;device&#160;driver&#160;called<br/>the&#160;<i>front-end&#160;driver&#160;</i>to&#160;the&#160;back-end&#160;driver.&#160;Every&#160;front-end&#160;virtual&#160;device&#160;has&#160;to&#160;be<br/>connected&#160;to&#160;a&#160;corresponding&#160;back-end&#160;virtual&#160;device;&#160;only&#160;then&#160;does&#160;the&#160;front-end&#160;de-<br/>vice&#160;become&#160;active.&#160;The&#160;mapping&#160;is&#160;many-to-one,&#160;i.e.,&#160;many&#160;front-end&#160;virtual&#160;devices,<br/>one&#160;from&#160;each&#160;user&#160;domain,&#160;may&#160;be&#160;mapped&#160;to&#160;a&#160;single&#160;back-end&#160;virtual&#160;device.</p>
<p style="position:absolute;top:616px;left:150px;white-space:nowrap" class="ft1220"><b>2.3</b></p>
<p style="position:absolute;top:616px;left:198px;white-space:nowrap" class="ft1220"><b>Trusted&#160;Virtual&#160;Domains</b></p>
<p style="position:absolute;top:654px;left:150px;white-space:nowrap" class="ft1215">A&#160;TVD&#160;is&#160;represented&#160;by&#160;a&#160;set&#160;of&#160;distributed&#160;virtual&#160;processing&#160;elements&#160;(VPE)&#160;(e.g.,<br/>virtual&#160;machines)&#160;and&#160;a&#160;communication&#160;medium&#160;interconnecting&#160;the&#160;VPEs,&#160;and&#160;pro-<br/>vides&#160;a&#160;policy&#160;and&#160;containment&#160;boundary&#160;around&#160;those&#160;VPEs.&#160;VPEs&#160;within&#160;each&#160;TVD<br/>can&#160;usually&#160;communicate&#160;freely&#160;and&#160;securely&#160;with&#160;each&#160;other.&#160;At&#160;the&#160;same&#160;time,&#160;they<br/>are&#160;sufficiently&#160;isolated&#160;from&#160;outside&#160;VPEs,&#160;including&#160;those&#160;belonging&#160;to&#160;other&#160;TVDs.<br/>Here,&#160;isolation&#160;loosely&#160;refers&#160;to&#160;the&#160;requirement&#160;that&#160;a&#160;dishonest&#160;VPE&#160;in&#160;one&#160;TVD&#160;can-<br/>not&#160;send&#160;messages&#160;to&#160;a&#160;dishonest&#160;VPE&#160;in&#160;another&#160;TVD,&#160;unless&#160;the&#160;inter-TVD&#160;policies<br/>explicitly&#160;allow&#160;such&#160;an&#160;information&#160;flow.</p>
<p style="position:absolute;top:797px;left:172px;white-space:nowrap" class="ft1212">Each&#160;TVD&#160;has&#160;an&#160;associated&#160;<i>infrastructure&#160;</i>whose&#160;purpose&#160;is&#160;to&#160;provide&#160;a&#160;unified</p>
<p style="position:absolute;top:815px;left:150px;white-space:nowrap" class="ft1215">level&#160;of&#160;security&#160;to&#160;member&#160;VPEs,&#160;while&#160;restricting&#160;the&#160;interaction&#160;with&#160;VPEs&#160;outside<br/>the&#160;TVD&#160;to&#160;pre-specified,&#160;well-defined&#160;means&#160;only.&#160;Unified&#160;security&#160;within&#160;a&#160;domain<br/>is&#160;obtained&#160;by&#160;defining&#160;and&#160;enforcing&#160;<i>membership&#160;requirements&#160;</i>that&#160;the&#160;VPEs&#160;have<br/>to&#160;satisfy&#160;before&#160;being&#160;admitted&#160;to&#160;the&#160;TVD&#160;and&#160;for&#160;retaining&#160;the&#160;membership.&#160;Each<br/>TVD&#160;defines&#160;rules&#160;regarding&#160;in-bound&#160;and&#160;out-bound&#160;network&#160;traffic.&#160;Their&#160;purpose&#160;is<br/>to&#160;restrict&#160;communication&#160;with&#160;the&#160;outside&#160;world.</p>
<p style="position:absolute;top:923px;left:172px;white-space:nowrap" class="ft1212">The&#160;concept&#160;of&#160;TVD,&#160;in&#160;the&#160;form&#160;as&#160;considered&#160;in&#160;this&#160;paper,&#160;was&#160;introduced&#160;in&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#74">[11]</a>.</p>
<p style="position:absolute;top:941px;left:150px;white-space:nowrap" class="ft1215">Later,&#160;a&#160;secure&#160;network&#160;virtualization&#160;framework&#160;was&#160;proposed&#160;in&#160;[]&#160;aiming&#160;to&#160;realize<br/>the&#160;abstraction&#160;of&#160;TVDs&#160;in&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#74">[11]</a>.&#160;The&#160;focus&#160;[]&#160;is&#160;a&#160;security-enhanced&#160;network&#160;virtual-<br/>ization,&#160;which&#160;(1)&#160;allows&#160;groups&#160;of&#160;related&#160;VMs&#160;running&#160;on&#160;separate&#160;physical&#160;machines<br/>to&#160;be&#160;connected&#160;together&#160;as&#160;though&#160;they&#160;were&#160;on&#160;their&#160;own&#160;separate&#160;network&#160;fabric,&#160;and<br/>(2)&#160;enforces&#160;cross-group&#160;security&#160;requirements&#160;such&#160;confidentiality,&#160;integrity,&#160;and&#160;flow<br/>control.&#160;However,&#160;the&#160;work&#160;in&#160;[]&#160;focuses&#160;solely&#160;on&#160;the&#160;secure&#160;network&#160;virtualization<br/>aspects&#160;rather&#160;than&#160;integrating&#160;and&#160;exploiting&#160;of&#160;trusted&#160;computing&#160;functionality.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft1218">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 13 -->
<a name="13"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page13-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL013.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1312">CHAPTER&#160;2.&#160;RELATED&#160;WORK</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft1312">11</p>
<p style="position:absolute;top:189px;left:226px;white-space:nowrap" class="ft1320"><b>2.4</b></p>
<p style="position:absolute;top:189px;left:274px;white-space:nowrap" class="ft1320"><b>Property-Based&#160;Attestation</b></p>
<p style="position:absolute;top:227px;left:226px;white-space:nowrap" class="ft1315">Integrity&#160;verification&#160;of&#160;applications&#160;and&#160;their&#160;underlying&#160;Trusted&#160;Computing&#160;Base<br/>(TCB)&#160;helps&#160;enforcing&#160;security&#160;policies&#160;in&#160;a&#160;distributed&#160;system.&#160;The&#160;TCG&#160;solution&#160;for<br/>remote&#160;integrity&#160;verification&#160;are&#160;mechanisms&#160;called&#160;remote&#160;<i>binary&#160;attestation</i>,&#160;remote<br/><i>binary&#160;binding</i>,&#160;and&#160;<i>binary&#160;sealing</i>.&#160;Loosely&#160;speaking,&#160;binary&#160;attestation&#160;and&#160;binary<br/>binding&#160;are&#160;based&#160;on&#160;a&#160;measurement&#160;of&#160;the&#160;chain&#160;of&#160;executed&#160;code&#160;using&#160;a&#160;crypto-<br/>graphic&#160;digest.&#160;This&#160;fixes&#160;and&#160;reveals&#160;the&#160;exact&#160;binaries&#160;of&#160;a&#160;platform,&#160;which&#160;is&#160;privacy<br/>invasive&#160;and&#160;limits&#160;scalability.&#160;A&#160;more&#160;general&#160;and&#160;flexible&#160;extension&#160;to&#160;the&#160;binary&#160;at-<br/>testation&#160;is&#160;<i>property-based&#160;attestation&#160;</i><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">[60,&#160;56,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#77">41]</a>:&#160;attestation&#160;should&#160;only&#160;determine<br/>whether&#160;a&#160;platform&#160;configuration&#160;or&#160;an&#160;application&#160;has&#160;a&#160;desired&#160;property.&#160;Property-<br/>based&#160;attestation/binding&#160;should&#160;determine&#160;whether&#160;the&#160;target&#160;machine&#160;to&#160;be&#160;attested<br/>fulfills&#160;certain&#160;requirements&#160;(e.g.,&#160;provides&#160;certain&#160;access&#160;control&#160;methods).&#160;This&#160;avoids<br/>revealing&#160;the&#160;concrete&#160;configuration&#160;of&#160;software&#160;and&#160;hardware&#160;components.&#160;For&#160;exam-<br/>ple,&#160;it&#160;would&#160;not&#160;matter&#160;whether&#160;Web&#160;browser</p>
<p style="position:absolute;top:441px;left:504px;white-space:nowrap" class="ft1329">A</p>
<p style="position:absolute;top:442px;left:519px;white-space:nowrap" class="ft1312">or</p>
<p style="position:absolute;top:441px;left:535px;white-space:nowrap" class="ft1329">B</p>
<p style="position:absolute;top:442px;left:550px;white-space:nowrap" class="ft1312">is&#160;used,&#160;as&#160;long&#160;as&#160;both&#160;have&#160;the</p>
<p style="position:absolute;top:460px;left:226px;white-space:nowrap" class="ft1312">same&#160;properties.</p>
<p style="position:absolute;top:478px;left:248px;white-space:nowrap" class="ft1312">Some&#160;proposals&#160;in&#160;the&#160;literature&#160;consider&#160;the&#160;protection&#160;and&#160;prove&#160;the&#160;integrity&#160;of</p>
<p style="position:absolute;top:496px;left:226px;white-space:nowrap" class="ft1315">computing&#160;platforms&#160;in&#160;the&#160;context&#160;of&#160;secure&#160;and&#160;authenticated&#160;(or&#160;trusted)&#160;boot&#160;(see,<br/>e.g.,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#74">[7]</a>,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[21]</a>,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[65]</a>,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[68]</a>,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#80">[83]</a>).&#160;A&#160;high-level&#160;protocol&#160;for&#160;property-based&#160;attestation<br/>is&#160;presented&#160;in&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">[56]</a>.&#160;The&#160;solution&#160;is&#160;based&#160;on&#160;property&#160;certificates&#160;that&#160;are&#160;used&#160;by<br/>a&#160;verification&#160;proxy&#160;to&#160;translate&#160;binary&#160;attestations&#160;into&#160;property&#160;attestations.&#160;In&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">[60]<br/></a>the&#160;authors&#160;propose&#160;and&#160;discusses&#160;several&#160;protocols&#160;and&#160;mechanisms&#160;that&#160;differ&#160;in&#160;their<br/>trust&#160;models,&#160;efficiency,&#160;and&#160;the&#160;functionality&#160;Aoffered&#160;by&#160;the&#160;trusted&#160;components.&#160;In<br/>particular,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">[60]&#160;</a>discusses&#160;how&#160;the&#160;TSS,&#160;the&#160;TPM&#160;library&#160;proposed&#160;by&#160;the&#160;TCG,&#160;can<br/>provide&#160;a&#160;property-based&#160;attestation&#160;protocol&#160;based&#160;on&#160;the&#160;existing&#160;TC&#160;hardware&#160;with-<br/>out&#160;a&#160;need&#160;to&#160;change&#160;the&#160;underlying&#160;trust&#160;model.&#160;Another&#160;refinement&#160;of&#160;this&#160;idea&#160;is<br/>proposed&#160;in&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#77">[41]</a>.&#160;Moreover,&#160;based&#160;on&#160;ideas&#160;of&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">[60]</a>,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[14]&#160;</a>proposes&#160;a&#160;cryptographic<br/>zero-knowledge&#160;protocol&#160;for&#160;anonymous&#160;property-based&#160;attestation.</p>
<p style="position:absolute;top:693px;left:248px;white-space:nowrap" class="ft1312">In&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[32]&#160;</a>the&#160;authors&#160;propose&#160;<i>semantic&#160;remote&#160;attestation&#160;</i>using&#160;language-based</p>
<p style="position:absolute;top:711px;left:226px;white-space:nowrap" class="ft1315">trusted&#160;virtual&#160;machines&#160;(VM)&#160;to&#160;remotely&#160;attest&#160;high-level&#160;program&#160;properties.&#160;The<br/>general&#160;idea&#160;is&#160;to&#160;use&#160;a&#160;trusted&#160;virtual&#160;machine&#160;(TrustedVM)&#160;that&#160;verifies&#160;the&#160;security<br/>policy&#160;of&#160;the&#160;machine&#160;that&#160;runs&#160;within&#160;the&#160;VM.</p>
<p style="position:absolute;top:765px;left:248px;white-space:nowrap" class="ft1312">In&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#77">[45]</a>,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#77">[47]&#160;</a>and&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#77">[46]&#160;</a>the&#160;authors&#160;propose&#160;a&#160;software&#160;architecture&#160;based&#160;on&#160;Linux</p>
<p style="position:absolute;top:783px;left:226px;white-space:nowrap" class="ft1315">providing&#160;attestation&#160;and&#160;binding.&#160;The&#160;architecture&#160;binds&#160;short-lifetime&#160;data&#160;(e.g.,&#160;ap-<br/>plication&#160;data)&#160;to&#160;long-lifetime&#160;data&#160;(e.g.,&#160;the&#160;Linux&#160;kernel)&#160;and&#160;allows&#160;access&#160;to&#160;that<br/>data&#160;only&#160;if&#160;the&#160;system&#160;is&#160;compatible&#160;to&#160;a&#160;security&#160;policy&#160;certified&#160;by&#160;a&#160;security&#160;admin-<br/>istrator.</p>
<p style="position:absolute;top:883px;left:226px;white-space:nowrap" class="ft1320"><b>2.5</b></p>
<p style="position:absolute;top:883px;left:274px;white-space:nowrap" class="ft1320"><b>Trusted&#160;Channels</b></p>
<p style="position:absolute;top:921px;left:226px;white-space:nowrap" class="ft1315">The&#160;standard&#160;approach&#160;for&#160;creating&#160;secure&#160;channels&#160;over&#160;the&#160;Internet&#160;is&#160;to&#160;use&#160;secu-<br/>rity&#160;protocols&#160;such&#160;as&#160;Transport&#160;Layer&#160;Security&#160;(TLS)&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[19]&#160;</a>or&#160;Internet&#160;Protocol&#160;Se-<br/>curity&#160;(IPSec)&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#77">[39]</a>,&#160;which&#160;aim&#160;at&#160;assuring&#160;confidentiality,&#160;integrity,&#160;and&#160;freshness&#160;of<br/>the&#160;transmitted&#160;data&#160;as&#160;well&#160;as&#160;authenticity&#160;of&#160;the&#160;involved&#160;endpoints.&#160;However,&#160;se-<br/>cure&#160;channels&#160;do&#160;not&#160;provide&#160;any&#160;guarantees&#160;about&#160;the&#160;integrity&#160;of&#160;the&#160;communication<br/>endpoints,&#160;which&#160;can&#160;be&#160;compromised&#160;by&#160;viruses&#160;and&#160;Trojans.&#160;Based&#160;on&#160;security&#160;archi-<br/>tectures&#160;that&#160;deploy&#160;Trusted&#160;Computing&#160;functionality,&#160;one&#160;can&#160;extend&#160;these&#160;protocols<br/>with&#160;integrity&#160;reporting&#160;mechanisms&#160;as&#160;proposed&#160;in&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[28]&#160;</a>for&#160;the&#160;case&#160;of&#160;TLS.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft1318">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 14 -->
<a name="14"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1431{font-size:37px;line-height:44px;font-family:Times;color:#000000;}
-->
</style>
<div id="page14-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL014.png" alt="background image"/>
<p style="position:absolute;top:295px;left:150px;white-space:nowrap" class="ft1419"><b>Chapter&#160;3</b></p>
<p style="position:absolute;top:365px;left:150px;white-space:nowrap" class="ft1431"><b>Policy&#160;Enforcement&#160;and<br/>Compliance&#160;Proofs&#160;for&#160;Xen<br/>Virtual&#160;Machines</b></p>
<p style="position:absolute;top:512px;left:244px;white-space:nowrap" class="ft1412">Bernhard&#160;Jansen,&#160;HariGovind&#160;V.&#160;Ramasamy,&#160;Matthias&#160;Schunter&#160;(IBM)</p>
<p style="position:absolute;top:586px;left:150px;white-space:nowrap" class="ft1420"><b>3.1</b></p>
<p style="position:absolute;top:586px;left:198px;white-space:nowrap" class="ft1420"><b>Introduction</b></p>
<p style="position:absolute;top:624px;left:150px;white-space:nowrap" class="ft1415">Hardware&#160;virtualization&#160;is&#160;enjoying&#160;a&#160;resurgence&#160;of&#160;interest&#160;fueled&#160;in&#160;part&#160;by&#160;its&#160;cost-<br/>saving&#160;potential&#160;in&#160;data&#160;centers.&#160;By&#160;allowing&#160;multiple&#160;virtual&#160;machines&#160;to&#160;be&#160;hosted<br/>on&#160;a&#160;single&#160;physical&#160;server,&#160;virtualization&#160;helps&#160;improve&#160;server&#160;utilization,&#160;reduce&#160;man-<br/>agement&#160;and&#160;power&#160;costs,&#160;and&#160;control&#160;the&#160;problem&#160;of&#160;server&#160;sprawl.</p>
<p style="position:absolute;top:696px;left:172px;white-space:nowrap" class="ft1412">We&#160;are&#160;interested&#160;in&#160;the&#160;security&#160;management&#160;of&#160;virtual&#160;machines,&#160;i.e.,&#160;the&#160;pro-</p>
<p style="position:absolute;top:714px;left:150px;white-space:nowrap" class="ft1415">tection,&#160;enforcement,&#160;and&#160;verification&#160;of&#160;the&#160;security&#160;of&#160;virtual&#160;machines.&#160;Security<br/>management&#160;is&#160;a&#160;non-trivial&#160;problem&#160;even&#160;in&#160;traditional&#160;non-virtualized&#160;environments.<br/>Security&#160;management&#160;of&#160;virtual&#160;machines&#160;(VMs)&#160;is&#160;even&#160;more&#160;complicated&#160;because&#160;the<br/>virtual&#160;machines&#160;hosted&#160;on&#160;a&#160;given&#160;physical&#160;server&#160;may&#160;belong&#160;to&#160;different&#160;virtual&#160;orga-<br/>nizations,&#160;and&#160;as&#160;a&#160;result,&#160;may&#160;have&#160;differing&#160;security&#160;requirements.&#160;Protecting&#160;a&#160;VM<br/>against&#160;security&#160;attacks&#160;may&#160;be&#160;complicated&#160;by&#160;inadequate&#160;isolation&#160;of&#160;the&#160;VM&#160;from<br/>other&#160;VMs&#160;hosted&#160;on&#160;the&#160;same&#160;server.&#160;Verifying&#160;the&#160;security&#160;of&#160;a&#160;VM&#160;may&#160;be&#160;compli-<br/>cated&#160;by&#160;confidentiality&#160;requirements,&#160;which&#160;may&#160;dictate&#160;that&#160;the&#160;information&#160;needed<br/>for&#160;verification&#160;of&#160;a&#160;VM’s&#160;configuration&#160;should&#160;not&#160;divulge&#160;configuration&#160;information<br/>of&#160;other&#160;co-hosted&#160;VMs.</p>
<p style="position:absolute;top:893px;left:172px;white-space:nowrap" class="ft1412">We&#160;address&#160;two&#160;main&#160;problems&#160;relating&#160;to&#160;security&#160;management,&#160;particularly&#160;in-</p>
<p style="position:absolute;top:911px;left:150px;white-space:nowrap" class="ft1415">tegrity&#160;management,&#160;of&#160;VMs:&#160;(1)&#160;protecting&#160;the&#160;security&#160;policies&#160;of&#160;a&#160;VM&#160;against<br/>modification&#160;throughout&#160;the&#160;VM’s&#160;life&#160;cycle,&#160;and&#160;(2)&#160;verifying&#160;that&#160;a&#160;VM&#160;is&#160;compliant<br/>with&#160;specified&#160;security&#160;requirements.&#160;We&#160;describe&#160;a&#160;formal&#160;model&#160;that&#160;generalizes&#160;in-<br/>tegrity&#160;management&#160;mechanisms&#160;based&#160;on&#160;the&#160;Trusted&#160;Platform&#160;Module&#160;(TPM)&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#80">[78]&#160;</a>to<br/>cover&#160;VMs&#160;(and&#160;their&#160;associated&#160;virtual&#160;devices)&#160;and&#160;a&#160;wider&#160;range&#160;of&#160;security&#160;policies<br/>(such&#160;as&#160;isolation&#160;policies&#160;for&#160;secure&#160;device&#160;virtualization&#160;and&#160;migration&#160;constraints&#160;for<br/>VMs).&#160;On&#160;TPM-equipped&#160;platforms,&#160;system&#160;compliance&#160;can&#160;be&#160;evaluated&#160;by&#160;checking<br/>TPM&#160;register&#160;values.&#160;Our&#160;model&#160;allows&#160;finer-grained&#160;compliance&#160;checks&#160;by&#160;handling<br/>policies&#160;that&#160;can&#160;be&#160;expressed&#160;as&#160;predicates&#160;on&#160;system&#160;log&#160;entries.&#160;Verifying&#160;compliance<br/>involves&#160;showing&#160;that&#160;the&#160;system&#160;integrity&#160;state,&#160;as&#160;reflected&#160;by&#160;secure&#160;write-only&#160;logs,</p>
<p style="position:absolute;top:1117px;left:400px;white-space:nowrap" class="ft1412">12</p>
</div>
<!-- Page 15 -->
<a name="15"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1532{font-size:10px;font-family:Helvetica;color:#000000;}
	.ft1533{font-size:15px;font-family:RMOMLG+CMSY10;color:#000000;}
-->
</style>
<div id="page15-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL015.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1512">CHAPTER&#160;3.&#160;COMPLIANCE&#160;PROOFS&#160;FOR&#160;XEN</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft1512">13</p>
<p style="position:absolute;top:193px;left:226px;white-space:nowrap" class="ft1515">satisfies&#160;certain&#160;conditions.&#160;We&#160;build&#160;on&#160;previous&#160;work&#160;by&#160;others&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[27,&#160;31,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">63,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">65,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#74">9]<br/></a>who&#160;have&#160;used&#160;the&#160;Trusted&#160;Platform&#160;Module&#160;(TPM)&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#80">[78]&#160;</a>to&#160;protect&#160;the&#160;integrity&#160;of&#160;the<br/>core&#160;virtual&#160;machine&#160;monitor&#160;(VMM)&#160;and&#160;to&#160;reliably&#160;isolate&#160;VMs.&#160;Based&#160;on&#160;the&#160;formal<br/>model,&#160;we&#160;describe&#160;an&#160;integrity&#160;architecture&#160;called&#160;PEV&#160;(which&#160;stands&#160;for&#160;protection,<br/>enforcement,&#160;and&#160;verification)&#160;and&#160;associated&#160;protocols.&#160;The&#160;architecture&#160;incorporates<br/>integrity&#160;protection&#160;and&#160;verification&#160;as&#160;part&#160;of&#160;the&#160;virtualization&#160;software&#160;itself,&#160;and&#160;at<br/>the&#160;same&#160;time&#160;enhances&#160;its&#160;policy&#160;enforcement&#160;capabilities.&#160;We&#160;describe&#160;a&#160;prototype<br/>realization&#160;of&#160;our&#160;architecture&#160;using&#160;the&#160;Xen&#160;hypervisor&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#74">[8]</a>.&#160;We&#160;demonstrate&#160;the&#160;policy<br/>enforcement&#160;and&#160;compliance&#160;checking&#160;capabilities&#160;of&#160;our&#160;prototype&#160;through&#160;multiple<br/>use&#160;cases.</p>
<p style="position:absolute;top:373px;left:248px;white-space:nowrap" class="ft1512">Our&#160;generalized&#160;integrity&#160;management&#160;mechanisms&#160;are&#160;both&#160;extensible&#160;and&#160;flexi-</p>
<p style="position:absolute;top:391px;left:226px;white-space:nowrap" class="ft1515">ble.&#160;<i>Extensibility&#160;</i>means&#160;that&#160;it&#160;is&#160;possible&#160;to&#160;guarantee&#160;compliance&#160;even&#160;if&#160;new&#160;virtual<br/>devices&#160;are&#160;attached&#160;to&#160;the&#160;VMs.&#160;<i>Flexibility&#160;</i>means&#160;that&#160;the&#160;verifier&#160;is&#160;able&#160;to&#160;spec-<br/>ify&#160;which&#160;aspects&#160;of&#160;the&#160;enforced&#160;security&#160;policies&#160;are&#160;of&#160;interest,&#160;and&#160;obtain&#160;only&#160;the<br/>information&#160;corresponding&#160;to&#160;those&#160;aspects&#160;for&#160;validation&#160;of&#160;system&#160;compliance.</p>
<p style="position:absolute;top:593px;left:438px;white-space:nowrap" class="ft1532"><b>Physical&#160;Hardware</b></p>
<p style="position:absolute;top:499px;left:321px;white-space:nowrap" class="ft1532"><b>Management&#160;</b></p>
<p style="position:absolute;top:512px;left:325px;white-space:nowrap" class="ft1532"><b>of&#160;security,&#160;</b></p>
<p style="position:absolute;top:524px;left:332px;white-space:nowrap" class="ft1532"><b>devices,&#160;</b></p>
<p style="position:absolute;top:537px;left:323px;white-space:nowrap" class="ft1532"><b>VMs,&#160;and&#160;I/O</b></p>
<p style="position:absolute;top:484px;left:339px;white-space:nowrap" class="ft1532"><b>Dom0</b></p>
<p style="position:absolute;top:541px;left:421px;white-space:nowrap" class="ft1532"><b>GuestOS</b></p>
<p style="position:absolute;top:503px;left:429px;white-space:nowrap" class="ft1532"><b>User</b></p>
<p style="position:absolute;top:516px;left:419px;white-space:nowrap" class="ft1532"><b>Software</b></p>
<p style="position:absolute;top:484px;left:420px;white-space:nowrap" class="ft1532"><b>DomU&#160;1</b></p>
<p style="position:absolute;top:541px;left:505px;white-space:nowrap" class="ft1532"><b>GuestOS</b></p>
<p style="position:absolute;top:503px;left:516px;white-space:nowrap" class="ft1532"><b>User</b></p>
<p style="position:absolute;top:516px;left:506px;white-space:nowrap" class="ft1532"><b>Software</b></p>
<p style="position:absolute;top:484px;left:507px;white-space:nowrap" class="ft1532"><b>DomU&#160;2</b></p>
<p style="position:absolute;top:541px;left:590px;white-space:nowrap" class="ft1532"><b>GuestOS</b></p>
<p style="position:absolute;top:503px;left:601px;white-space:nowrap" class="ft1532"><b>User</b></p>
<p style="position:absolute;top:516px;left:591px;white-space:nowrap" class="ft1532"><b>Software</b></p>
<p style="position:absolute;top:481px;left:592px;white-space:nowrap" class="ft1532"><b>DomU&#160;3</b></p>
<p style="position:absolute;top:570px;left:460px;white-space:nowrap" class="ft1532"><b>VMM&#160;Core</b></p>
<p style="position:absolute;top:644px;left:351px;white-space:nowrap" class="ft1512">Figure&#160;3.1:&#160;Xen&#160;virtual&#160;machine&#160;architecture</p>
<p style="position:absolute;top:726px;left:226px;white-space:nowrap" class="ft1520"><b>3.2</b></p>
<p style="position:absolute;top:726px;left:274px;white-space:nowrap" class="ft1520"><b>Formal&#160;Integrity&#160;Model&#160;for&#160;Virtual&#160;Machines</b></p>
<p style="position:absolute;top:764px;left:226px;white-space:nowrap" class="ft1515">Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#16">3.2&#160;</a>shows&#160;our&#160;system&#160;model&#160;for&#160;integrity&#160;management.&#160;At&#160;a&#160;high&#160;level,&#160;the<br/>system&#160;consists&#160;of&#160;VMs&#160;and&#160;a&#160;TCB,&#160;and&#160;is&#160;configured&#160;through&#160;policies.&#160;The&#160;TCB&#160;peri-<br/>odically&#160;logs&#160;the&#160;integrity&#160;state&#160;of&#160;the&#160;rest&#160;of&#160;the&#160;system.&#160;The&#160;log&#160;repository&#160;contains&#160;a<br/>record&#160;of&#160;the&#160;integrity&#160;history&#160;of&#160;the&#160;system,&#160;and&#160;is&#160;<i>secure&#160;write-only</i>,&#160;i.e.,&#160;log&#160;entries,<br/>once&#160;written,&#160;cannot&#160;be&#160;modified&#160;or&#160;removed&#160;by&#160;any&#160;entity&#160;in&#160;the&#160;rest&#160;of&#160;the&#160;system.<br/>The&#160;log&#160;data&#160;includes&#160;the&#160;list&#160;of&#160;software&#160;components,&#160;configuration&#160;parameters,&#160;poli-<br/>cies,&#160;and&#160;any&#160;updates&#160;to&#160;them.&#160;The&#160;log&#160;contents&#160;are&#160;useful&#160;in&#160;evaluating&#160;compliance<br/>with&#160;those&#160;security&#160;properties&#160;that&#160;can&#160;be&#160;expressed&#160;as&#160;predicates&#160;on&#160;the&#160;contents.&#160;The<br/>compliance&#160;proof&#160;involves&#160;showing&#160;that&#160;correct&#160;policies&#160;and&#160;healthy&#160;policy&#160;enforce-<br/>ment&#160;mechanisms&#160;are&#160;in&#160;place.&#160;The&#160;TCB&#160;also&#160;provides&#160;conditional&#160;release&#160;of&#160;secrets,<br/>where&#160;the&#160;condition&#160;is&#160;expressed&#160;as&#160;predicates&#160;on&#160;the&#160;log&#160;data.&#160;That&#160;allows&#160;a&#160;sensitive<br/>data&#160;item&#160;and&#160;a&#160;condition&#160;to&#160;be&#160;stored&#160;such&#160;that&#160;the&#160;data&#160;item&#160;is&#160;released&#160;only&#160;if&#160;the&#160;log<br/>data&#160;satisfies&#160;the&#160;condition&#160;specified.</p>
<p style="position:absolute;top:997px;left:248px;white-space:nowrap" class="ft1512">For&#160;flexibility&#160;and&#160;extensibility,&#160;the&#160;log&#160;data&#160;is&#160;stored&#160;in&#160;a&#160;tree&#160;structure&#160;instead</p>
<p style="position:absolute;top:1015px;left:226px;white-space:nowrap" class="ft1512">of&#160;a&#160;monolithic&#160;log&#160;file.&#160;The&#160;log&#160;tree</p>
<p style="position:absolute;top:1014px;left:458px;white-space:nowrap" class="ft1533">T</p>
<p style="position:absolute;top:1015px;left:475px;white-space:nowrap" class="ft1512">is&#160;shown&#160;in&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#16">3.3.&#160;</a>Each&#160;tree&#160;node&#160;is&#160;a</p>
<p style="position:absolute;top:1033px;left:226px;white-space:nowrap" class="ft1515">triple&#160;containing&#160;log&#160;data&#160;for&#160;one&#160;system&#160;component.&#160;To&#160;keep&#160;the&#160;tree&#160;size&#160;manageable,<br/>only&#160;those&#160;components&#160;that&#160;have&#160;an&#160;impact&#160;on&#160;the&#160;system’s&#160;integrity&#160;or&#160;those&#160;that&#160;are<br/>of&#160;interest&#160;from&#160;an&#160;integrity&#160;verification&#160;point&#160;of&#160;view&#160;are&#160;represented&#160;in&#160;the&#160;log&#160;tree.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft1518">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 16 -->
<a name="16"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1634{font-size:14px;font-family:Helvetica;color:#000000;}
	.ft1635{font-size:9px;font-family:Helvetica;color:#000000;}
	.ft1636{font-size:8px;font-family:Helvetica;color:#000000;}
	.ft1637{font-size:12px;font-family:KPSHBO+TT787o00;color:#000000;}
	.ft1638{font-size:14px;font-family:Times;color:#000000;}
	.ft1639{font-size:10px;font-family:CXOYBI+TT19BACo00;color:#000000;}
	.ft1640{font-size:10px;font-family:RDZRPI+TT19BADo00;color:#000000;}
	.ft1641{font-size:7px;font-family:CXOYBI+TT19BAEo00;color:#000000;}
	.ft1642{font-size:7px;font-family:KPSHBO+TT19BB0o00;color:#000000;}
	.ft1643{font-size:10px;font-family:DQATAM+CMMI7;color:#000000;}
	.ft1644{font-size:18px;font-family:Times;color:#000000;}
	.ft1645{font-size:9px;line-height:9px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page16-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL016.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1612">14</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft1618">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:301px;left:348px;white-space:nowrap" class="ft1634"><b>TCB</b></p>
<p style="position:absolute;top:236px;left:261px;white-space:nowrap" class="ft1635">policy</p>
<p style="position:absolute;top:260px;left:307px;white-space:nowrap" class="ft1635">log</p>
<p style="position:absolute;top:269px;left:297px;white-space:nowrap" class="ft1635">integrity</p>
<p style="position:absolute;top:279px;left:303px;white-space:nowrap" class="ft1635">state</p>
<p style="position:absolute;top:259px;left:364px;white-space:nowrap" class="ft1635">conditional</p>
<p style="position:absolute;top:269px;left:371px;white-space:nowrap" class="ft1635">release&#160;</p>
<p style="position:absolute;top:279px;left:366px;white-space:nowrap" class="ft1635">of&#160;secrets</p>
<p style="position:absolute;top:217px;left:401px;white-space:nowrap" class="ft1634"><b>VM</b></p>
<p style="position:absolute;top:282px;left:439px;white-space:nowrap" class="ft1645">sealing&#160;or&#160;<br/>attestation</p>
<p style="position:absolute;top:301px;left:445px;white-space:nowrap" class="ft1635">request</p>
<p style="position:absolute;top:320px;left:442px;white-space:nowrap" class="ft1635">response</p>
<p style="position:absolute;top:283px;left:495px;white-space:nowrap" class="ft1632"><b>User&#160;or&#160;Verifier</b></p>
<p style="position:absolute;top:300px;left:516px;white-space:nowrap" class="ft1636">integrity</p>
<p style="position:absolute;top:308px;left:507px;white-space:nowrap" class="ft1636">requirements</p>
<p style="position:absolute;top:316px;left:508px;white-space:nowrap" class="ft1636">predicate&#160;&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:311px;left:543px;white-space:nowrap" class="ft1637">Π</p>
<p style="position:absolute;top:311px;left:543px;white-space:nowrap" class="ft1637">Π</p>
<p style="position:absolute;top:195px;left:337px;white-space:nowrap" class="ft1634"><b>System</b></p>
<p style="position:absolute;top:317px;left:321px;white-space:nowrap" class="ft1635">log&#160;</p>
<p style="position:absolute;top:326px;left:308px;white-space:nowrap" class="ft1635">repository</p>
<p style="position:absolute;top:317px;left:376px;white-space:nowrap" class="ft1635">secret</p>
<p style="position:absolute;top:326px;left:368px;white-space:nowrap" class="ft1635">repository</p>
<p style="position:absolute;top:217px;left:341px;white-space:nowrap" class="ft1634"><b>VM</b></p>
<p style="position:absolute;top:217px;left:306px;white-space:nowrap" class="ft1634"><b>VM</b></p>
<p style="position:absolute;top:214px;left:369px;white-space:nowrap" class="ft1638"><b>.&#160;.&#160;.&#160;.</b></p>
<p style="position:absolute;top:382px;left:252px;white-space:nowrap" class="ft1612">Figure&#160;3.2:&#160;System&#160;model&#160;for&#160;integrity&#160;management</p>
<p style="position:absolute;top:463px;left:470px;white-space:nowrap" class="ft1610">…</p>
<p style="position:absolute;top:451px;left:465px;white-space:nowrap" class="ft1610">…</p>
<p style="position:absolute;top:411px;left:355px;white-space:nowrap" class="ft1639">(</p>
<p style="position:absolute;top:411px;left:359px;white-space:nowrap" class="ft1640">id,&#160;type,&#160;log</p>
<p style="position:absolute;top:411px;left:407px;white-space:nowrap" class="ft1639">)</p>
<p style="position:absolute;top:411px;left:355px;white-space:nowrap" class="ft1639">(</p>
<p style="position:absolute;top:411px;left:359px;white-space:nowrap" class="ft1640">id,&#160;type,&#160;log</p>
<p style="position:absolute;top:411px;left:407px;white-space:nowrap" class="ft1639">)</p>
<p style="position:absolute;top:437px;left:304px;white-space:nowrap" class="ft1639">(</p>
<p style="position:absolute;top:437px;left:308px;white-space:nowrap" class="ft1640">id</p>
<p style="position:absolute;top:442px;left:317px;white-space:nowrap" class="ft1641">1</p>
<p style="position:absolute;top:437px;left:321px;white-space:nowrap" class="ft1640">,&#160;type</p>
<p style="position:absolute;top:442px;left:343px;white-space:nowrap" class="ft1641">1</p>
<p style="position:absolute;top:437px;left:348px;white-space:nowrap" class="ft1640">,&#160;log</p>
<p style="position:absolute;top:442px;left:364px;white-space:nowrap" class="ft1641">1</p>
<p style="position:absolute;top:437px;left:369px;white-space:nowrap" class="ft1639">)</p>
<p style="position:absolute;top:437px;left:304px;white-space:nowrap" class="ft1639">(</p>
<p style="position:absolute;top:437px;left:308px;white-space:nowrap" class="ft1640">id</p>
<p style="position:absolute;top:442px;left:317px;white-space:nowrap" class="ft1641">1</p>
<p style="position:absolute;top:437px;left:321px;white-space:nowrap" class="ft1640">,&#160;type</p>
<p style="position:absolute;top:442px;left:343px;white-space:nowrap" class="ft1641">1</p>
<p style="position:absolute;top:437px;left:348px;white-space:nowrap" class="ft1640">,&#160;log</p>
<p style="position:absolute;top:442px;left:364px;white-space:nowrap" class="ft1641">1</p>
<p style="position:absolute;top:437px;left:369px;white-space:nowrap" class="ft1639">)</p>
<p style="position:absolute;top:460px;left:275px;white-space:nowrap" class="ft1639">(</p>
<p style="position:absolute;top:460px;left:279px;white-space:nowrap" class="ft1640">id</p>
<p style="position:absolute;top:464px;left:287px;white-space:nowrap" class="ft1641">11</p>
<p style="position:absolute;top:460px;left:296px;white-space:nowrap" class="ft1640">,&#160;type</p>
<p style="position:absolute;top:464px;left:318px;white-space:nowrap" class="ft1641">11</p>
<p style="position:absolute;top:460px;left:326px;white-space:nowrap" class="ft1640">,&#160;log</p>
<p style="position:absolute;top:464px;left:343px;white-space:nowrap" class="ft1641">11</p>
<p style="position:absolute;top:460px;left:351px;white-space:nowrap" class="ft1639">)</p>
<p style="position:absolute;top:460px;left:275px;white-space:nowrap" class="ft1639">(</p>
<p style="position:absolute;top:460px;left:279px;white-space:nowrap" class="ft1640">id</p>
<p style="position:absolute;top:464px;left:287px;white-space:nowrap" class="ft1641">11</p>
<p style="position:absolute;top:460px;left:296px;white-space:nowrap" class="ft1640">,&#160;type</p>
<p style="position:absolute;top:464px;left:318px;white-space:nowrap" class="ft1641">11</p>
<p style="position:absolute;top:460px;left:326px;white-space:nowrap" class="ft1640">,&#160;log</p>
<p style="position:absolute;top:464px;left:343px;white-space:nowrap" class="ft1641">11</p>
<p style="position:absolute;top:460px;left:351px;white-space:nowrap" class="ft1639">)</p>
<p style="position:absolute;top:482px;left:249px;white-space:nowrap" class="ft1639">(</p>
<p style="position:absolute;top:482px;left:253px;white-space:nowrap" class="ft1640">id</p>
<p style="position:absolute;top:487px;left:261px;white-space:nowrap" class="ft1641">111</p>
<p style="position:absolute;top:482px;left:273px;white-space:nowrap" class="ft1640">,&#160;type</p>
<p style="position:absolute;top:487px;left:296px;white-space:nowrap" class="ft1641">111</p>
<p style="position:absolute;top:482px;left:308px;white-space:nowrap" class="ft1640">,&#160;log</p>
<p style="position:absolute;top:487px;left:324px;white-space:nowrap" class="ft1641">111</p>
<p style="position:absolute;top:482px;left:337px;white-space:nowrap" class="ft1639">)</p>
<p style="position:absolute;top:482px;left:249px;white-space:nowrap" class="ft1639">(</p>
<p style="position:absolute;top:482px;left:253px;white-space:nowrap" class="ft1640">id</p>
<p style="position:absolute;top:487px;left:261px;white-space:nowrap" class="ft1641">111</p>
<p style="position:absolute;top:482px;left:273px;white-space:nowrap" class="ft1640">,&#160;type</p>
<p style="position:absolute;top:487px;left:296px;white-space:nowrap" class="ft1641">111</p>
<p style="position:absolute;top:482px;left:308px;white-space:nowrap" class="ft1640">,&#160;log</p>
<p style="position:absolute;top:487px;left:324px;white-space:nowrap" class="ft1641">111</p>
<p style="position:absolute;top:482px;left:337px;white-space:nowrap" class="ft1639">)</p>
<p style="position:absolute;top:435px;left:404px;white-space:nowrap" class="ft1639">(</p>
<p style="position:absolute;top:435px;left:408px;white-space:nowrap" class="ft1640">id</p>
<p style="position:absolute;top:440px;left:416px;white-space:nowrap" class="ft1641">2</p>
<p style="position:absolute;top:435px;left:420px;white-space:nowrap" class="ft1640">,&#160;type</p>
<p style="position:absolute;top:440px;left:443px;white-space:nowrap" class="ft1641">2</p>
<p style="position:absolute;top:435px;left:447px;white-space:nowrap" class="ft1640">,&#160;log</p>
<p style="position:absolute;top:440px;left:464px;white-space:nowrap" class="ft1641">2</p>
<p style="position:absolute;top:435px;left:468px;white-space:nowrap" class="ft1639">)</p>
<p style="position:absolute;top:435px;left:404px;white-space:nowrap" class="ft1639">(</p>
<p style="position:absolute;top:435px;left:408px;white-space:nowrap" class="ft1640">id</p>
<p style="position:absolute;top:440px;left:416px;white-space:nowrap" class="ft1641">2</p>
<p style="position:absolute;top:435px;left:420px;white-space:nowrap" class="ft1640">,&#160;type</p>
<p style="position:absolute;top:440px;left:443px;white-space:nowrap" class="ft1641">2</p>
<p style="position:absolute;top:435px;left:447px;white-space:nowrap" class="ft1640">,&#160;log</p>
<p style="position:absolute;top:440px;left:464px;white-space:nowrap" class="ft1641">2</p>
<p style="position:absolute;top:435px;left:468px;white-space:nowrap" class="ft1639">)</p>
<p style="position:absolute;top:460px;left:390px;white-space:nowrap" class="ft1639">(</p>
<p style="position:absolute;top:460px;left:394px;white-space:nowrap" class="ft1640">id</p>
<p style="position:absolute;top:465px;left:402px;white-space:nowrap" class="ft1641">21</p>
<p style="position:absolute;top:460px;left:410px;white-space:nowrap" class="ft1640">,&#160;type</p>
<p style="position:absolute;top:465px;left:433px;white-space:nowrap" class="ft1641">21</p>
<p style="position:absolute;top:460px;left:441px;white-space:nowrap" class="ft1640">,&#160;log</p>
<p style="position:absolute;top:465px;left:458px;white-space:nowrap" class="ft1641">21</p>
<p style="position:absolute;top:460px;left:466px;white-space:nowrap" class="ft1639">)</p>
<p style="position:absolute;top:460px;left:390px;white-space:nowrap" class="ft1639">(</p>
<p style="position:absolute;top:460px;left:394px;white-space:nowrap" class="ft1640">id</p>
<p style="position:absolute;top:465px;left:402px;white-space:nowrap" class="ft1641">21</p>
<p style="position:absolute;top:460px;left:410px;white-space:nowrap" class="ft1640">,&#160;type</p>
<p style="position:absolute;top:465px;left:433px;white-space:nowrap" class="ft1641">21</p>
<p style="position:absolute;top:460px;left:441px;white-space:nowrap" class="ft1640">,&#160;log</p>
<p style="position:absolute;top:465px;left:458px;white-space:nowrap" class="ft1641">21</p>
<p style="position:absolute;top:460px;left:466px;white-space:nowrap" class="ft1639">)&#160;(</p>
<p style="position:absolute;top:460px;left:487px;white-space:nowrap" class="ft1640">id</p>
<p style="position:absolute;top:465px;left:496px;white-space:nowrap" class="ft1641">2</p>
<p style="position:absolute;top:466px;left:500px;white-space:nowrap" class="ft1642">n</p>
<p style="position:absolute;top:460px;left:505px;white-space:nowrap" class="ft1640">,&#160;type</p>
<p style="position:absolute;top:465px;left:527px;white-space:nowrap" class="ft1641">2</p>
<p style="position:absolute;top:466px;left:531px;white-space:nowrap" class="ft1642">n</p>
<p style="position:absolute;top:460px;left:536px;white-space:nowrap" class="ft1640">,&#160;log</p>
<p style="position:absolute;top:465px;left:553px;white-space:nowrap" class="ft1641">2</p>
<p style="position:absolute;top:466px;left:557px;white-space:nowrap" class="ft1642">n</p>
<p style="position:absolute;top:460px;left:562px;white-space:nowrap" class="ft1639">)</p>
<p style="position:absolute;top:460px;left:484px;white-space:nowrap" class="ft1639">(</p>
<p style="position:absolute;top:460px;left:487px;white-space:nowrap" class="ft1640">id</p>
<p style="position:absolute;top:465px;left:496px;white-space:nowrap" class="ft1641">2</p>
<p style="position:absolute;top:466px;left:500px;white-space:nowrap" class="ft1642">n</p>
<p style="position:absolute;top:460px;left:505px;white-space:nowrap" class="ft1640">,&#160;type</p>
<p style="position:absolute;top:465px;left:527px;white-space:nowrap" class="ft1641">2</p>
<p style="position:absolute;top:466px;left:531px;white-space:nowrap" class="ft1642">n</p>
<p style="position:absolute;top:460px;left:536px;white-space:nowrap" class="ft1640">,&#160;log</p>
<p style="position:absolute;top:465px;left:553px;white-space:nowrap" class="ft1641">2</p>
<p style="position:absolute;top:466px;left:557px;white-space:nowrap" class="ft1642">n</p>
<p style="position:absolute;top:460px;left:562px;white-space:nowrap" class="ft1639">)</p>
<p style="position:absolute;top:533px;left:310px;white-space:nowrap" class="ft1612">Figure&#160;3.3:&#160;Tree</p>
<p style="position:absolute;top:532px;left:411px;white-space:nowrap" class="ft1633">T</p>
<p style="position:absolute;top:533px;left:426px;white-space:nowrap" class="ft1612">of&#160;log&#160;entries</p>
<p style="position:absolute;top:581px;left:150px;white-space:nowrap" class="ft1612">A&#160;triple&#160;for&#160;a&#160;component</p>
<p style="position:absolute;top:580px;left:305px;white-space:nowrap" class="ft1629">k</p>
<p style="position:absolute;top:581px;left:318px;white-space:nowrap" class="ft1612">contains&#160;an&#160;identifier</p>
<p style="position:absolute;top:580px;left:449px;white-space:nowrap" class="ft1629">id</p>
<p style="position:absolute;top:586px;left:462px;white-space:nowrap" class="ft1643">k</p>
<p style="position:absolute;top:581px;left:469px;white-space:nowrap" class="ft1612">,&#160;a&#160;component&#160;type</p>
<p style="position:absolute;top:580px;left:589px;white-space:nowrap" class="ft1629">type</p>
<p style="position:absolute;top:586px;left:617px;white-space:nowrap" class="ft1643">k</p>
<p style="position:absolute;top:581px;left:624px;white-space:nowrap" class="ft1612">,&#160;and&#160;a</p>
<p style="position:absolute;top:599px;left:150px;white-space:nowrap" class="ft1612">vector</p>
<p style="position:absolute;top:598px;left:190px;white-space:nowrap" class="ft1629">log</p>
<p style="position:absolute;top:604px;left:210px;white-space:nowrap" class="ft1643">k</p>
<p style="position:absolute;top:599px;left:220px;white-space:nowrap" class="ft1612">of&#160;log&#160;values.&#160;Sub-components&#160;are&#160;modeled&#160;as&#160;children&#160;of&#160;a&#160;node.&#160;The&#160;tree</p>
<p style="position:absolute;top:617px;left:150px;white-space:nowrap" class="ft1615">can&#160;be&#160;extended&#160;by&#160;adding&#160;or&#160;removing&#160;children&#160;nodes.&#160;For&#160;example,&#160;the&#160;addition&#160;of&#160;a<br/>new&#160;virtual&#160;device&#160;to&#160;a&#160;VM&#160;can&#160;be&#160;easily&#160;reflected&#160;in&#160;the&#160;log&#160;tree&#160;by&#160;adding&#160;a&#160;new&#160;node<br/>as&#160;a&#160;child&#160;of&#160;the&#160;sub-tree&#160;that&#160;corresponds&#160;to&#160;the&#160;VM.</p>
<p style="position:absolute;top:671px;left:172px;white-space:nowrap" class="ft1612">The&#160;integrity&#160;requirements&#160;of&#160;a&#160;user&#160;or&#160;verifier&#160;are&#160;modeled&#160;by</p>
<p style="position:absolute;top:670px;left:552px;white-space:nowrap" class="ft1628">Π(</p>
<p style="position:absolute;top:671px;left:569px;white-space:nowrap" class="ft1627">p</p>
<p style="position:absolute;top:670px;left:577px;white-space:nowrap" class="ft1628">(</p>
<p style="position:absolute;top:670px;left:582px;white-space:nowrap" class="ft1633">T</p>
<p style="position:absolute;top:670px;left:594px;white-space:nowrap" class="ft1628">))</p>
<p style="position:absolute;top:671px;left:606px;white-space:nowrap" class="ft1612">,&#160;where</p>
<p style="position:absolute;top:670px;left:654px;white-space:nowrap" class="ft1628">Π</p>
<p style="position:absolute;top:689px;left:150px;white-space:nowrap" class="ft1612">is&#160;a&#160;predicate&#160;and</p>
<p style="position:absolute;top:689px;left:258px;white-space:nowrap" class="ft1627">p</p>
<p style="position:absolute;top:688px;left:266px;white-space:nowrap" class="ft1628">()</p>
<p style="position:absolute;top:689px;left:282px;white-space:nowrap" class="ft1612">is&#160;a&#160;projection&#160;function.&#160;We&#160;introduce&#160;the&#160;notion&#160;of&#160;a&#160;<i>projection</i></p>
<p style="position:absolute;top:707px;left:150px;white-space:nowrap" class="ft1611"><i>function</i>,&#160;denoted&#160;by</p>
<p style="position:absolute;top:707px;left:279px;white-space:nowrap" class="ft1627">p</p>
<p style="position:absolute;top:706px;left:287px;white-space:nowrap" class="ft1628">()</p>
<p style="position:absolute;top:707px;left:298px;white-space:nowrap" class="ft1612">,&#160;to&#160;model&#160;the&#160;specific&#160;aspects&#160;of&#160;the&#160;system’s&#160;integrity&#160;state</p>
<p style="position:absolute;top:725px;left:150px;white-space:nowrap" class="ft1615">that&#160;is&#160;of&#160;interest&#160;to&#160;a&#160;user&#160;or&#160;verifier.&#160;For&#160;example,&#160;a&#160;verifier&#160;may&#160;be&#160;interested&#160;only&#160;in<br/>a&#160;disk’s&#160;access&#160;control&#160;list&#160;and&#160;not&#160;the&#160;actual&#160;disk&#160;contents.&#160;When&#160;applied&#160;on&#160;the&#160;log<br/>tree,&#160;the&#160;function&#160;returns&#160;a&#160;subset&#160;of&#160;the&#160;tree&#160;nodes&#160;and&#160;a&#160;subset&#160;of&#160;the&#160;vector&#160;elements<br/>from&#160;the&#160;log&#160;vector&#160;of&#160;each&#160;node.&#160;Formally,</p>
<p style="position:absolute;top:778px;left:433px;white-space:nowrap" class="ft1627">p</p>
<p style="position:absolute;top:778px;left:441px;white-space:nowrap" class="ft1628">(</p>
<p style="position:absolute;top:778px;left:447px;white-space:nowrap" class="ft1633">T</p>
<p style="position:absolute;top:778px;left:459px;white-space:nowrap" class="ft1628">)&#160;=</p>
<p style="position:absolute;top:778px;left:492px;white-space:nowrap" class="ft1633">{</p>
<p style="position:absolute;top:778px;left:499px;white-space:nowrap" class="ft1629">l</p>
<p style="position:absolute;top:784px;left:504px;white-space:nowrap" class="ft1643">k</p>
<p style="position:absolute;top:778px;left:511px;white-space:nowrap" class="ft1633">}</p>
<p style="position:absolute;top:779px;left:519px;white-space:nowrap" class="ft1612">,&#160;where</p>
<p style="position:absolute;top:778px;left:570px;white-space:nowrap" class="ft1629">l</p>
<p style="position:absolute;top:784px;left:575px;white-space:nowrap" class="ft1643">k</p>
<p style="position:absolute;top:778px;left:590px;white-space:nowrap" class="ft1633">∈</p>
<p style="position:absolute;top:778px;left:607px;white-space:nowrap" class="ft1629">log</p>
<p style="position:absolute;top:784px;left:627px;white-space:nowrap" class="ft1643">k</p>
<p style="position:absolute;top:779px;left:634px;white-space:nowrap" class="ft1612">,&#160;and</p>
<p style="position:absolute;top:796px;left:150px;white-space:nowrap" class="ft1628">(</p>
<p style="position:absolute;top:796px;left:156px;white-space:nowrap" class="ft1629">id</p>
<p style="position:absolute;top:802px;left:168px;white-space:nowrap" class="ft1643">k</p>
<p style="position:absolute;top:796px;left:176px;white-space:nowrap" class="ft1629">,&#160;type</p>
<p style="position:absolute;top:802px;left:210px;white-space:nowrap" class="ft1643">k</p>
<p style="position:absolute;top:796px;left:218px;white-space:nowrap" class="ft1629">,&#160;log</p>
<p style="position:absolute;top:802px;left:244px;white-space:nowrap" class="ft1643">k</p>
<p style="position:absolute;top:796px;left:251px;white-space:nowrap" class="ft1628">)</p>
<p style="position:absolute;top:796px;left:261px;white-space:nowrap" class="ft1633">∈&#160;T</p>
<p style="position:absolute;top:796px;left:287px;white-space:nowrap" class="ft1629">.</p>
<p style="position:absolute;top:814px;left:172px;white-space:nowrap" class="ft1612">We&#160;now&#160;use&#160;our&#160;formal&#160;model&#160;to&#160;generalize&#160;TPM-based&#160;integrity&#160;protection&#160;and</p>
<p style="position:absolute;top:832px;left:150px;white-space:nowrap" class="ft1612">verification.&#160;We&#160;also&#160;enhance&#160;our&#160;model&#160;by&#160;adding&#160;access&#160;control&#160;to&#160;the&#160;log&#160;contents.</p>
<p style="position:absolute;top:891px;left:150px;white-space:nowrap" class="ft1644"><b>3.2.1</b></p>
<p style="position:absolute;top:891px;left:204px;white-space:nowrap" class="ft1644"><b>Generalized&#160;Sealing&#160;to&#160;Protect&#160;Integrity</b></p>
<p style="position:absolute;top:921px;left:150px;white-space:nowrap" class="ft1615">A&#160;TPM-equipped&#160;system&#160;can&#160;<i>seal&#160;</i>a&#160;data&#160;item,&#160;i.e.,&#160;the&#160;system&#160;can&#160;encrypt&#160;the&#160;data&#160;item<br/>and&#160;bind&#160;it&#160;to&#160;the&#160;system&#160;configuration&#160;prevalent&#160;at&#160;the&#160;time&#160;of&#160;sealing.&#160;The&#160;system<br/>configuration&#160;is&#160;reflected&#160;by&#160;the&#160;contents&#160;of&#160;a&#160;specified&#160;subset&#160;of&#160;the&#160;TPM’s&#160;PCRs.&#160;The<br/>data&#160;item&#160;may&#160;be&#160;a&#160;key&#160;generated&#160;by&#160;the&#160;TPM&#160;itself&#160;or&#160;something&#160;generated&#160;outside&#160;the<br/>TPM.&#160;Decryption&#160;of&#160;the&#160;data&#160;item,&#160;called&#160;<i>unsealing</i>,&#160;is&#160;possible&#160;only&#160;when&#160;the&#160;system<br/>configuration&#160;(reflected&#160;by&#160;the&#160;contents&#160;of&#160;the&#160;same&#160;subset&#160;of&#160;PCRs)&#160;is&#160;the&#160;same&#160;as&#160;that<br/>at&#160;the&#160;time&#160;of&#160;sealing.</p>
<p style="position:absolute;top:1047px;left:172px;white-space:nowrap" class="ft1612">We&#160;generalize&#160;sealing&#160;for&#160;protecting&#160;the&#160;integrity&#160;of&#160;a&#160;sensitive&#160;data&#160;item</p>
<p style="position:absolute;top:1046px;left:605px;white-space:nowrap" class="ft1629">d</p>
<p style="position:absolute;top:1047px;left:616px;white-space:nowrap" class="ft1612">by&#160;mak-</p>
<p style="position:absolute;top:1065px;left:150px;white-space:nowrap" class="ft1612">ing</p>
<p style="position:absolute;top:1064px;left:175px;white-space:nowrap" class="ft1629">d</p>
<p style="position:absolute;top:1065px;left:188px;white-space:nowrap" class="ft1612">inaccessible&#160;to&#160;the&#160;system&#160;(or&#160;some&#160;component)&#160;unless&#160;specified&#160;integrity&#160;re-</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft1618">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 17 -->
<a name="17"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1746{font-size:7px;font-family:IGJFUT+CMMI5;color:#000000;}
-->
</style>
<div id="page17-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL017.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1712">CHAPTER&#160;3.&#160;COMPLIANCE&#160;PROOFS&#160;FOR&#160;XEN</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft1712">15</p>
<p style="position:absolute;top:193px;left:226px;white-space:nowrap" class="ft1712">quirements&#160;are&#160;met.&#160;We&#160;use&#160;two&#160;operations,</p>
<p style="position:absolute;top:193px;left:498px;white-space:nowrap" class="ft1727">seal</p>
<p style="position:absolute;top:193px;left:525px;white-space:nowrap" class="ft1712">and</p>
<p style="position:absolute;top:193px;left:551px;white-space:nowrap" class="ft1727">unseal</p>
<p style="position:absolute;top:193px;left:590px;white-space:nowrap" class="ft1712">,&#160;to&#160;model&#160;the&#160;concept&#160;of</p>
<p style="position:absolute;top:211px;left:226px;white-space:nowrap" class="ft1712">generalized&#160;sealing.&#160;Let</p>
<p style="position:absolute;top:210px;left:381px;white-space:nowrap" class="ft1733">T</p>
<p style="position:absolute;top:216px;left:389px;white-space:nowrap" class="ft1743">x</p>
<p style="position:absolute;top:211px;left:401px;white-space:nowrap" class="ft1712">denote&#160;the&#160;log&#160;tree&#160;at&#160;time</p>
<p style="position:absolute;top:210px;left:570px;white-space:nowrap" class="ft1729">t</p>
<p style="position:absolute;top:216px;left:575px;white-space:nowrap" class="ft1743">x</p>
<p style="position:absolute;top:211px;left:582px;white-space:nowrap" class="ft1712">.&#160;The</p>
<p style="position:absolute;top:211px;left:624px;white-space:nowrap" class="ft1727">seal</p>
<p style="position:absolute;top:211px;left:652px;white-space:nowrap" class="ft1712">operation,&#160;per-</p>
<p style="position:absolute;top:229px;left:226px;white-space:nowrap" class="ft1712">formed&#160;at&#160;time</p>
<p style="position:absolute;top:228px;left:321px;white-space:nowrap" class="ft1729">t</p>
<p style="position:absolute;top:234px;left:326px;white-space:nowrap" class="ft1743">s</p>
<p style="position:absolute;top:229px;left:332px;white-space:nowrap" class="ft1712">,&#160;takes&#160;as&#160;input&#160;the&#160;data&#160;item</p>
<p style="position:absolute;top:228px;left:512px;white-space:nowrap" class="ft1729">d</p>
<p style="position:absolute;top:229px;left:520px;white-space:nowrap" class="ft1712">,&#160;a&#160;projection&#160;function</p>
<p style="position:absolute;top:229px;left:660px;white-space:nowrap" class="ft1727">p</p>
<p style="position:absolute;top:228px;left:668px;white-space:nowrap" class="ft1728">()</p>
<p style="position:absolute;top:229px;left:679px;white-space:nowrap" class="ft1712">,&#160;a&#160;sealing</p>
<p style="position:absolute;top:247px;left:226px;white-space:nowrap" class="ft1712">predicate</p>
<p style="position:absolute;top:246px;left:285px;white-space:nowrap" class="ft1728">Π</p>
<p style="position:absolute;top:247px;left:297px;white-space:nowrap" class="ft1712">,&#160;and&#160;the&#160;public&#160;part</p>
<p style="position:absolute;top:246px;left:424px;white-space:nowrap" class="ft1729">K</p>
<p style="position:absolute;top:252px;left:437px;white-space:nowrap" class="ft1743">p</p>
<p style="position:absolute;top:247px;left:449px;white-space:nowrap" class="ft1712">of&#160;an&#160;encryption&#160;key</p>
<p style="position:absolute;top:246px;left:579px;white-space:nowrap" class="ft1729">K</p>
<p style="position:absolute;top:247px;left:593px;white-space:nowrap" class="ft1712">.&#160;The&#160;operation&#160;logs</p>
<p style="position:absolute;top:247px;left:722px;white-space:nowrap" class="ft1727">p</p>
<p style="position:absolute;top:246px;left:730px;white-space:nowrap" class="ft1728">()</p>
<p style="position:absolute;top:265px;left:226px;white-space:nowrap" class="ft1712">and</p>
<p style="position:absolute;top:264px;left:251px;white-space:nowrap" class="ft1728">Π</p>
<p style="position:absolute;top:265px;left:263px;white-space:nowrap" class="ft1712">,&#160;and&#160;encrypts</p>
<p style="position:absolute;top:264px;left:350px;white-space:nowrap" class="ft1729">d</p>
<p style="position:absolute;top:265px;left:362px;white-space:nowrap" class="ft1712">using</p>
<p style="position:absolute;top:264px;left:398px;white-space:nowrap" class="ft1729">K</p>
<p style="position:absolute;top:270px;left:411px;white-space:nowrap" class="ft1743">p</p>
<p style="position:absolute;top:265px;left:422px;white-space:nowrap" class="ft1712">to&#160;produce&#160;the&#160;encrypted&#160;output</p>
<p style="position:absolute;top:264px;left:616px;white-space:nowrap" class="ft1729">e</p>
<p style="position:absolute;top:265px;left:623px;white-space:nowrap" class="ft1712">.&#160;Thus,&#160;the&#160;contents</p>
<p style="position:absolute;top:283px;left:226px;white-space:nowrap" class="ft1712">of</p>
<p style="position:absolute;top:282px;left:242px;white-space:nowrap" class="ft1733">T</p>
<p style="position:absolute;top:288px;left:251px;white-space:nowrap" class="ft1743">s</p>
<p style="position:absolute;top:283px;left:261px;white-space:nowrap" class="ft1712">include</p>
<p style="position:absolute;top:283px;left:309px;white-space:nowrap" class="ft1727">p</p>
<p style="position:absolute;top:282px;left:317px;white-space:nowrap" class="ft1728">()</p>
<p style="position:absolute;top:283px;left:332px;white-space:nowrap" class="ft1712">and</p>
<p style="position:absolute;top:282px;left:358px;white-space:nowrap" class="ft1728">Π</p>
<p style="position:absolute;top:283px;left:369px;white-space:nowrap" class="ft1712">.&#160;The</p>
<p style="position:absolute;top:283px;left:406px;white-space:nowrap" class="ft1727">unseal</p>
<p style="position:absolute;top:283px;left:448px;white-space:nowrap" class="ft1712">operation,&#160;performed&#160;at&#160;time</p>
<p style="position:absolute;top:282px;left:624px;white-space:nowrap" class="ft1729">t</p>
<p style="position:absolute;top:288px;left:630px;white-space:nowrap" class="ft1743">u</p>
<p style="position:absolute;top:283px;left:642px;white-space:nowrap" class="ft1712">(where</p>
<p style="position:absolute;top:282px;left:687px;white-space:nowrap" class="ft1729">t</p>
<p style="position:absolute;top:288px;left:692px;white-space:nowrap" class="ft1743">u</p>
<p style="position:absolute;top:282px;left:705px;white-space:nowrap" class="ft1729">&gt;&#160;t</p>
<p style="position:absolute;top:288px;left:726px;white-space:nowrap" class="ft1743">s</p>
<p style="position:absolute;top:283px;left:733px;white-space:nowrap" class="ft1712">),</p>
<p style="position:absolute;top:301px;left:226px;white-space:nowrap" class="ft1712">takes&#160;as&#160;input</p>
<p style="position:absolute;top:300px;left:310px;white-space:nowrap" class="ft1729">e</p>
<p style="position:absolute;top:301px;left:320px;white-space:nowrap" class="ft1712">and</p>
<p style="position:absolute;top:300px;left:345px;white-space:nowrap" class="ft1733">T</p>
<p style="position:absolute;top:306px;left:353px;white-space:nowrap" class="ft1743">u</p>
<p style="position:absolute;top:301px;left:361px;white-space:nowrap" class="ft1712">,&#160;and&#160;outputs</p>
<p style="position:absolute;top:300px;left:440px;white-space:nowrap" class="ft1729">d</p>
<p style="position:absolute;top:301px;left:451px;white-space:nowrap" class="ft1712">iff&#160;the&#160;condition</p>
<p style="position:absolute;top:300px;left:550px;white-space:nowrap" class="ft1728">Π(</p>
<p style="position:absolute;top:301px;left:567px;white-space:nowrap" class="ft1727">p</p>
<p style="position:absolute;top:300px;left:574px;white-space:nowrap" class="ft1728">(</p>
<p style="position:absolute;top:300px;left:580px;white-space:nowrap" class="ft1733">T</p>
<p style="position:absolute;top:306px;left:588px;white-space:nowrap" class="ft1743">u</p>
<p style="position:absolute;top:300px;left:596px;white-space:nowrap" class="ft1728">))</p>
<p style="position:absolute;top:301px;left:611px;white-space:nowrap" class="ft1712">holds.&#160;In&#160;other&#160;words,</p>
<p style="position:absolute;top:319px;left:226px;white-space:nowrap" class="ft1712">the&#160;private&#160;part&#160;of&#160;the&#160;key</p>
<p style="position:absolute;top:318px;left:386px;white-space:nowrap" class="ft1729">K</p>
<p style="position:absolute;top:319px;left:403px;white-space:nowrap" class="ft1712">used&#160;for&#160;decrypting</p>
<p style="position:absolute;top:318px;left:525px;white-space:nowrap" class="ft1729">e</p>
<p style="position:absolute;top:319px;left:536px;white-space:nowrap" class="ft1712">is&#160;revealed&#160;iff&#160;the&#160;condition&#160;holds.</p>
<p style="position:absolute;top:337px;left:226px;white-space:nowrap" class="ft1712">Here,</p>
<p style="position:absolute;top:336px;left:263px;white-space:nowrap" class="ft1727">p</p>
<p style="position:absolute;top:336px;left:271px;white-space:nowrap" class="ft1728">()</p>
<p style="position:absolute;top:337px;left:287px;white-space:nowrap" class="ft1712">and</p>
<p style="position:absolute;top:336px;left:312px;white-space:nowrap" class="ft1728">Π</p>
<p style="position:absolute;top:337px;left:328px;white-space:nowrap" class="ft1712">are&#160;retrieved&#160;from&#160;the&#160;log.&#160;A&#160;simple&#160;sealing&#160;predicate&#160;may&#160;just&#160;com-</p>
<p style="position:absolute;top:355px;left:226px;white-space:nowrap" class="ft1712">pare&#160;the&#160;result&#160;of</p>
<p style="position:absolute;top:354px;left:330px;white-space:nowrap" class="ft1727">p</p>
<p style="position:absolute;top:354px;left:337px;white-space:nowrap" class="ft1728">(</p>
<p style="position:absolute;top:354px;left:343px;white-space:nowrap" class="ft1733">T</p>
<p style="position:absolute;top:360px;left:351px;white-space:nowrap" class="ft1743">u</p>
<p style="position:absolute;top:354px;left:359px;white-space:nowrap" class="ft1728">)</p>
<p style="position:absolute;top:355px;left:368px;white-space:nowrap" class="ft1712">with&#160;a&#160;reference&#160;value&#160;(e.g.,</p>
<p style="position:absolute;top:354px;left:537px;white-space:nowrap" class="ft1727">p</p>
<p style="position:absolute;top:354px;left:544px;white-space:nowrap" class="ft1728">(</p>
<p style="position:absolute;top:354px;left:550px;white-space:nowrap" class="ft1733">T</p>
<p style="position:absolute;top:360px;left:558px;white-space:nowrap" class="ft1743">s</p>
<p style="position:absolute;top:354px;left:565px;white-space:nowrap" class="ft1728">)</p>
<p style="position:absolute;top:355px;left:570px;white-space:nowrap" class="ft1712">).&#160;A&#160;more&#160;complex&#160;predicate</p>
<p style="position:absolute;top:373px;left:226px;white-space:nowrap" class="ft1712">may&#160;extract&#160;the&#160;high-level&#160;properties&#160;of&#160;the&#160;system&#160;from</p>
<p style="position:absolute;top:372px;left:563px;white-space:nowrap" class="ft1727">p</p>
<p style="position:absolute;top:372px;left:571px;white-space:nowrap" class="ft1728">(</p>
<p style="position:absolute;top:372px;left:576px;white-space:nowrap" class="ft1733">T</p>
<p style="position:absolute;top:378px;left:584px;white-space:nowrap" class="ft1743">u</p>
<p style="position:absolute;top:372px;left:592px;white-space:nowrap" class="ft1728">)</p>
<p style="position:absolute;top:373px;left:602px;white-space:nowrap" class="ft1712">and&#160;compare&#160;them&#160;with</p>
<p style="position:absolute;top:391px;left:226px;white-space:nowrap" class="ft1712">desired&#160;properties&#160;(similar&#160;to&#160;property-based&#160;attestation&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">[56,&#160;60]</a>).</p>
<p style="position:absolute;top:409px;left:248px;white-space:nowrap" class="ft1712">One&#160;can&#160;easily&#160;see&#160;that&#160;our&#160;generalized&#160;sealing&#160;concept&#160;covers&#160;the&#160;special&#160;case&#160;of</p>
<p style="position:absolute;top:427px;left:226px;white-space:nowrap" class="ft1712">TPM&#160;sealing.&#160;For&#160;TPM&#160;sealing,</p>
<p style="position:absolute;top:426px;left:424px;white-space:nowrap" class="ft1733">T</p>
<p style="position:absolute;top:432px;left:432px;white-space:nowrap" class="ft1743">u</p>
<p style="position:absolute;top:427px;left:444px;white-space:nowrap" class="ft1712">consists&#160;of&#160;the&#160;values&#160;in&#160;the&#160;PCRs;&#160;the&#160;projection</p>
<p style="position:absolute;top:445px;left:226px;white-space:nowrap" class="ft1712">function</p>
<p style="position:absolute;top:444px;left:280px;white-space:nowrap" class="ft1727">p</p>
<p style="position:absolute;top:444px;left:287px;white-space:nowrap" class="ft1728">()</p>
<p style="position:absolute;top:445px;left:302px;white-space:nowrap" class="ft1712">specifies&#160;the&#160;subset&#160;of&#160;PCRs&#160;whose&#160;values&#160;are&#160;of&#160;interest&#160;for&#160;assessing&#160;the</p>
<p style="position:absolute;top:463px;left:226px;white-space:nowrap" class="ft1712">system’s&#160;integrity;&#160;the&#160;sealing&#160;predicate</p>
<p style="position:absolute;top:462px;left:471px;white-space:nowrap" class="ft1728">Π</p>
<p style="position:absolute;top:463px;left:487px;white-space:nowrap" class="ft1712">checks&#160;whether&#160;their&#160;values&#160;at&#160;the&#160;time&#160;of</p>
<p style="position:absolute;top:480px;left:226px;white-space:nowrap" class="ft1712">unsealing&#160;are&#160;the&#160;same&#160;as&#160;at&#160;the&#160;time&#160;of&#160;sealing.</p>
<p style="position:absolute;top:539px;left:226px;white-space:nowrap" class="ft1744"><b>3.2.2</b></p>
<p style="position:absolute;top:539px;left:280px;white-space:nowrap" class="ft1744"><b>Generalized&#160;Attestation&#160;to&#160;Verify&#160;Integrity</b></p>
<p style="position:absolute;top:569px;left:226px;white-space:nowrap" class="ft1715">A&#160;TPM-equipped&#160;system&#160;can&#160;use&#160;the&#160;TPM&#160;to&#160;engage&#160;in&#160;a&#160;challenge-response&#160;style<br/>cryptographic&#160;protocol,&#160;called&#160;<i>attestation</i>,&#160;with&#160;a&#160;verifier.&#160;The&#160;protocol&#160;allows&#160;the&#160;ver-<br/>ifier&#160;to&#160;query&#160;and&#160;reliably&#160;obtain&#160;the&#160;measurement&#160;values&#160;for&#160;the&#160;system&#160;stored&#160;in&#160;the<br/>PCRs&#160;of&#160;the&#160;TPM.&#160;Reliable&#160;reporting&#160;of&#160;the&#160;measurement&#160;values&#160;is&#160;due&#160;to&#160;the&#160;signing<br/>of&#160;the&#160;values&#160;by&#160;the&#160;TPM,&#160;which&#160;is&#160;trusted&#160;by&#160;the&#160;verifier.&#160;Based&#160;on&#160;these&#160;values,&#160;the<br/>verifier&#160;can&#160;assesses&#160;the&#160;integrity&#160;state&#160;and&#160;the&#160;trustworthiness&#160;of&#160;the&#160;system.</p>
<p style="position:absolute;top:677px;left:248px;white-space:nowrap" class="ft1712">We&#160;generalize&#160;attestation&#160;so&#160;that&#160;the&#160;verifier&#160;can&#160;specify&#160;which&#160;aspects&#160;of&#160;the&#160;sys-</p>
<p style="position:absolute;top:695px;left:226px;white-space:nowrap" class="ft1712">tem’s&#160;integrity&#160;state&#160;are&#160;of&#160;interest&#160;to&#160;her.&#160;In&#160;our&#160;model,&#160;the&#160;attestation&#160;operation</p>
<p style="position:absolute;top:712px;left:226px;white-space:nowrap" class="ft1727">attest</p>
<p style="position:absolute;top:712px;left:262px;white-space:nowrap" class="ft1728">()</p>
<p style="position:absolute;top:713px;left:277px;white-space:nowrap" class="ft1712">obtains&#160;as&#160;input&#160;a&#160;challenge</p>
<p style="position:absolute;top:712px;left:445px;white-space:nowrap" class="ft1729">c</p>
<p style="position:absolute;top:713px;left:451px;white-space:nowrap" class="ft1712">,&#160;an&#160;attestation&#160;predicate</p>
<p style="position:absolute;top:712px;left:599px;white-space:nowrap" class="ft1728">Π</p>
<p style="position:absolute;top:713px;left:610px;white-space:nowrap" class="ft1712">,&#160;a&#160;projection&#160;function</p>
<p style="position:absolute;top:730px;left:226px;white-space:nowrap" class="ft1727">p</p>
<p style="position:absolute;top:730px;left:234px;white-space:nowrap" class="ft1728">()</p>
<p style="position:absolute;top:731px;left:245px;white-space:nowrap" class="ft1712">,&#160;and&#160;a&#160;secret&#160;key</p>
<p style="position:absolute;top:730px;left:352px;white-space:nowrap" class="ft1729">K</p>
<p style="position:absolute;top:736px;left:365px;white-space:nowrap" class="ft1743">s</p>
<p style="position:absolute;top:731px;left:371px;white-space:nowrap" class="ft1712">.&#160;The&#160;operation&#160;outputs&#160;a&#160;signed&#160;message</p>
<p style="position:absolute;top:730px;left:622px;white-space:nowrap" class="ft1727">sign</p>
<p style="position:absolute;top:737px;left:646px;white-space:nowrap" class="ft1743">K</p>
<p style="position:absolute;top:743px;left:656px;white-space:nowrap" class="ft1746">s</p>
<p style="position:absolute;top:730px;left:663px;white-space:nowrap" class="ft1728">(</p>
<p style="position:absolute;top:730px;left:669px;white-space:nowrap" class="ft1727">f</p>
<p style="position:absolute;top:730px;left:674px;white-space:nowrap" class="ft1728">(</p>
<p style="position:absolute;top:730px;left:680px;white-space:nowrap" class="ft1727">p</p>
<p style="position:absolute;top:730px;left:688px;white-space:nowrap" class="ft1728">(</p>
<p style="position:absolute;top:730px;left:694px;white-space:nowrap" class="ft1733">T</p>
<p style="position:absolute;top:730px;left:706px;white-space:nowrap" class="ft1728">))</p>
<p style="position:absolute;top:730px;left:717px;white-space:nowrap" class="ft1729">,&#160;c</p>
<p style="position:absolute;top:730px;left:730px;white-space:nowrap" class="ft1728">)</p>
<p style="position:absolute;top:731px;left:736px;white-space:nowrap" class="ft1712">.</p>
<p style="position:absolute;top:749px;left:248px;white-space:nowrap" class="ft1712">Our&#160;attestation&#160;operation&#160;is&#160;a&#160;generalization&#160;of&#160;both&#160;binary&#160;and&#160;property-based&#160;at-</p>
<p style="position:absolute;top:766px;left:226px;white-space:nowrap" class="ft1712">testation&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">[56,&#160;60,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">32]</a>.&#160;For&#160;binary&#160;attestation,&#160;the&#160;predicate</p>
<p style="position:absolute;top:765px;left:594px;white-space:nowrap" class="ft1728">Π</p>
<p style="position:absolute;top:766px;left:611px;white-space:nowrap" class="ft1712">is&#160;simply&#160;the&#160;identity</p>
<p style="position:absolute;top:784px;left:226px;white-space:nowrap" class="ft1712">function,&#160;i.e.,</p>
<p style="position:absolute;top:783px;left:312px;white-space:nowrap" class="ft1728">Π(</p>
<p style="position:absolute;top:783px;left:329px;white-space:nowrap" class="ft1729">x</p>
<p style="position:absolute;top:783px;left:338px;white-space:nowrap" class="ft1728">)&#160;=</p>
<p style="position:absolute;top:783px;left:369px;white-space:nowrap" class="ft1729">x</p>
<p style="position:absolute;top:784px;left:377px;white-space:nowrap" class="ft1712">,&#160;and&#160;the&#160;result&#160;of&#160;attestation&#160;is&#160;simply&#160;the&#160;signature&#160;on&#160;the</p>
<p style="position:absolute;top:802px;left:226px;white-space:nowrap" class="ft1715">result&#160;of&#160;the&#160;projection&#160;function&#160;applied&#160;on&#160;the&#160;log&#160;tree.&#160;TPM&#160;attestation&#160;is&#160;a&#160;special<br/>case&#160;of&#160;binary&#160;attestation&#160;in&#160;which</p>
<p style="position:absolute;top:819px;left:442px;white-space:nowrap" class="ft1733">T</p>
<p style="position:absolute;top:820px;left:459px;white-space:nowrap" class="ft1712">simply&#160;consists&#160;of&#160;the&#160;values&#160;in&#160;the&#160;PCRs&#160;and</p>
<p style="position:absolute;top:838px;left:226px;white-space:nowrap" class="ft1712">the&#160;projection&#160;function</p>
<p style="position:absolute;top:838px;left:367px;white-space:nowrap" class="ft1727">p</p>
<p style="position:absolute;top:837px;left:375px;white-space:nowrap" class="ft1728">()</p>
<p style="position:absolute;top:838px;left:390px;white-space:nowrap" class="ft1712">specifies&#160;a&#160;subset&#160;of&#160;PCRs.&#160;For&#160;property-based&#160;attestation,</p>
<p style="position:absolute;top:856px;left:226px;white-space:nowrap" class="ft1712">the&#160;predicate</p>
<p style="position:absolute;top:855px;left:306px;white-space:nowrap" class="ft1728">Π</p>
<p style="position:absolute;top:856px;left:321px;white-space:nowrap" class="ft1712">extracts&#160;high-level&#160;properties&#160;from&#160;the&#160;result&#160;of&#160;the&#160;projection&#160;function</p>
<p style="position:absolute;top:874px;left:226px;white-space:nowrap" class="ft1712">applied&#160;on&#160;the&#160;log&#160;tree.</p>
<p style="position:absolute;top:892px;left:248px;white-space:nowrap" class="ft1712">Whereas&#160;previous&#160;works&#160;such&#160;as&#160;the&#160;Integrity&#160;Measurement&#160;Architecture&#160;(IMA)</p>
<p style="position:absolute;top:910px;left:226px;white-space:nowrap" class="ft1715">of&#160;of&#160;Sailer&#160;<i>et&#160;al</i>.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[65]&#160;</a>provide&#160;a&#160;good&#160;way&#160;of&#160;checking&#160;the&#160;hash&#160;of&#160;software&#160;binaries,<br/>our&#160;generalized&#160;attestation&#160;enables&#160;better&#160;assessment&#160;of&#160;the&#160;run-time&#160;behavior&#160;of&#160;the<br/>system.&#160;In&#160;this&#160;respect,&#160;our&#160;model&#160;has&#160;goals&#160;similar&#160;to&#160;those&#160;of&#160;Haldar&#160;<i>et&#160;al</i>.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[32]</a>.&#160;How-<br/>ever,&#160;unlike&#160;Haldar&#160;<i>et&#160;al</i>.&#160;who&#160;focus&#160;on&#160;attesting&#160;the&#160;behavior&#160;of&#160;a&#160;software&#160;application,<br/>our&#160;model&#160;has&#160;a&#160;focus&#160;on&#160;VMs&#160;and&#160;virtual&#160;devices.&#160;For&#160;example,&#160;our&#160;attestation&#160;oper-<br/>ation&#160;enables&#160;a&#160;verifier&#160;to&#160;check&#160;the&#160;number&#160;and&#160;type&#160;of&#160;VMs&#160;running&#160;on&#160;the&#160;system.<br/>Because&#160;of&#160;their&#160;reliance&#160;on&#160;the&#160;Java&#160;virtual&#160;machine&#160;which&#160;runs&#160;on&#160;top&#160;of&#160;an&#160;operating<br/>system,&#160;their&#160;TCB&#160;includes&#160;the&#160;operating&#160;system.&#160;In&#160;contrast,&#160;our&#160;TCB&#160;includes&#160;only<br/>the&#160;VMM&#160;and&#160;underlying&#160;system&#160;layers,&#160;and&#160;is&#160;much&#160;smaller&#160;than&#160;theirs.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft1718">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 18 -->
<a name="18"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1847{font-size:11px;font-family:Helvetica;color:#000000;}
	.ft1848{font-size:11px;line-height:13px;font-family:Helvetica;color:#000000;}
	.ft1849{font-size:9px;line-height:10px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page18-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL018.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft1812">16</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft1818">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:238px;left:351px;white-space:nowrap" class="ft1848">Central&#160;<br/>Integrity</p>
<p style="position:absolute;top:265px;left:348px;white-space:nowrap" class="ft1847">Manager</p>
<p style="position:absolute;top:207px;left:454px;white-space:nowrap" class="ft1836">Network&#160;</p>
<p style="position:absolute;top:216px;left:440px;white-space:nowrap" class="ft1836">Integrity&#160;Manager</p>
<p style="position:absolute;top:241px;left:459px;white-space:nowrap" class="ft1836">VMM&#160;</p>
<p style="position:absolute;top:250px;left:440px;white-space:nowrap" class="ft1836">Integrity&#160;Manager</p>
<p style="position:absolute;top:272px;left:455px;white-space:nowrap" class="ft1836">Devices&#160;</p>
<p style="position:absolute;top:282px;left:440px;white-space:nowrap" class="ft1836">Integrity&#160;Manager</p>
<p style="position:absolute;top:307px;left:456px;white-space:nowrap" class="ft1836">Storage</p>
<p style="position:absolute;top:316px;left:440px;white-space:nowrap" class="ft1836">Integrity&#160;Manager</p>
<p style="position:absolute;top:211px;left:257px;white-space:nowrap" class="ft1847">Attestation</p>
<p style="position:absolute;top:268px;left:266px;white-space:nowrap" class="ft1847">Sealing</p>
<p style="position:absolute;top:283px;left:261px;white-space:nowrap" class="ft1847">Unsealing</p>
<p style="position:absolute;top:194px;left:320px;white-space:nowrap" class="ft1847">TCB</p>
<p style="position:absolute;top:324px;left:354px;white-space:nowrap" class="ft1849">Predicate<br/>Evaluator</p>
<p style="position:absolute;top:386px;left:217px;white-space:nowrap" class="ft1812">Figure&#160;3.4:&#160;Architecture&#160;for&#160;integrity&#160;protection&#160;and&#160;verification</p>
<p style="position:absolute;top:432px;left:150px;white-space:nowrap" class="ft1844"><b>3.2.3</b></p>
<p style="position:absolute;top:432px;left:204px;white-space:nowrap" class="ft1844"><b>Access&#160;Restriction</b></p>
<p style="position:absolute;top:462px;left:150px;white-space:nowrap" class="ft1830">The&#160;integrity&#160;of&#160;certain&#160;aspects&#160;of&#160;the&#160;system&#160;(such&#160;as&#160;the&#160;VMM)&#160;may&#160;be&#160;important&#160;to<br/>multiple&#160;users.&#160;Conversely,&#160;certain&#160;aspects&#160;of&#160;the&#160;system&#160;may&#160;be&#160;confidential&#160;to&#160;one<br/>or&#160;more&#160;users,&#160;e.g.,&#160;the&#160;state&#160;of&#160;a&#160;particular&#160;VM&#160;may&#160;be&#160;verified&#160;only&#160;by&#160;the&#160;users&#160;of<br/>that&#160;VM.&#160;Hence,&#160;it&#160;is&#160;important&#160;that&#160;attestation&#160;and&#160;sealing&#160;be&#160;applied&#160;not&#160;directly&#160;on<br/>the&#160;system&#160;state,&#160;but&#160;on&#160;appropriate&#160;projections&#160;of&#160;the&#160;state.&#160;Furthermore,&#160;if&#160;a&#160;state<br/>that&#160;is&#160;relevant&#160;for&#160;integrity&#160;verification&#160;contains&#160;information&#160;about&#160;multiple&#160;users,&#160;it<br/>should&#160;be&#160;possible&#160;to&#160;prove&#160;integrity&#160;without&#160;revealing&#160;the&#160;actual&#160;state.&#160;We&#160;formalize<br/>such&#160;requirements&#160;using&#160;two&#160;concepts:&#160;<i>access&#160;restriction&#160;specification&#160;</i>and&#160;<i>projection<br/>assessment&#160;function</i>.</p>
<p style="position:absolute;top:623px;left:172px;white-space:nowrap" class="ft1812">Given&#160;a&#160;set&#160;of&#160;users</p>
<p style="position:absolute;top:622px;left:303px;white-space:nowrap" class="ft1829">U</p>
<p style="position:absolute;top:623px;left:320px;white-space:nowrap" class="ft1812">and&#160;a&#160;log&#160;tree</p>
<p style="position:absolute;top:622px;left:412px;white-space:nowrap" class="ft1833">T</p>
<p style="position:absolute;top:623px;left:424px;white-space:nowrap" class="ft1812">,&#160;an&#160;access&#160;restriction&#160;is&#160;specified&#160;by&#160;a</p>
<p style="position:absolute;top:641px;left:150px;white-space:nowrap" class="ft1812">function</p>
<p style="position:absolute;top:640px;left:205px;white-space:nowrap" class="ft1827">r</p>
<p style="position:absolute;top:640px;left:211px;white-space:nowrap" class="ft1828">()</p>
<p style="position:absolute;top:641px;left:228px;white-space:nowrap" class="ft1812">that&#160;assigns&#160;a&#160;subset&#160;of</p>
<p style="position:absolute;top:640px;left:379px;white-space:nowrap" class="ft1829">U</p>
<p style="position:absolute;top:641px;left:397px;white-space:nowrap" class="ft1812">to&#160;each&#160;vector&#160;element&#160;in&#160;each&#160;node&#160;of&#160;the</p>
<p style="position:absolute;top:659px;left:150px;white-space:nowrap" class="ft1815">tree.&#160;The&#160;subset&#160;assigned&#160;to&#160;a&#160;given&#160;vector&#160;element&#160;in&#160;a&#160;given&#160;node&#160;is&#160;called&#160;the&#160;<i>access<br/>control&#160;list&#160;</i>(ACL)&#160;for&#160;that&#160;element.&#160;Despite&#160;the&#160;potentially&#160;large&#160;number&#160;of&#160;nodes&#160;in&#160;the<br/>log&#160;tree,&#160;ACLs&#160;can&#160;be&#160;efficiently&#160;implemented&#160;by&#160;attaching&#160;ACLs&#160;only&#160;to&#160;some&#160;nodes<br/>and&#160;vector&#160;elements.&#160;ACLs&#160;of&#160;children&#160;nodes&#160;may&#160;be&#160;derived&#160;through&#160;inheritance&#160;of<br/>the&#160;parent&#160;node’s&#160;ACL.&#160;Scoping&#160;rules&#160;may&#160;be&#160;used&#160;to&#160;apply&#160;an&#160;ACL&#160;to&#160;multiple&#160;vector<br/>elements&#160;of&#160;a&#160;given&#160;node.</p>
<p style="position:absolute;top:766px;left:172px;white-space:nowrap" class="ft1812">A&#160;projection&#160;assessment&#160;function&#160;can&#160;determine&#160;whether&#160;a&#160;given&#160;projection&#160;con-</p>
<p style="position:absolute;top:784px;left:150px;white-space:nowrap" class="ft1812">forms&#160;to&#160;or&#160;violates&#160;access&#160;restrictions.&#160;A&#160;projection</p>
<p style="position:absolute;top:784px;left:477px;white-space:nowrap" class="ft1827">p</p>
<p style="position:absolute;top:783px;left:485px;white-space:nowrap" class="ft1828">(</p>
<p style="position:absolute;top:783px;left:490px;white-space:nowrap" class="ft1833">T</p>
<p style="position:absolute;top:783px;left:502px;white-space:nowrap" class="ft1828">)</p>
<p style="position:absolute;top:784px;left:513px;white-space:nowrap" class="ft1812">applied&#160;by&#160;a&#160;user</p>
<p style="position:absolute;top:783px;left:623px;white-space:nowrap" class="ft1829">u</p>
<p style="position:absolute;top:783px;left:637px;white-space:nowrap" class="ft1833">∈</p>
<p style="position:absolute;top:783px;left:654px;white-space:nowrap" class="ft1829">U</p>
<p style="position:absolute;top:802px;left:150px;white-space:nowrap" class="ft1812">conforms&#160;to&#160;the&#160;access&#160;restriction&#160;specification</p>
<p style="position:absolute;top:802px;left:440px;white-space:nowrap" class="ft1827">r</p>
<p style="position:absolute;top:801px;left:445px;white-space:nowrap" class="ft1828">()</p>
<p style="position:absolute;top:802px;left:462px;white-space:nowrap" class="ft1812">if&#160;the&#160;output&#160;only&#160;contains&#160;vector</p>
<p style="position:absolute;top:820px;left:150px;white-space:nowrap" class="ft1812">elements&#160;in&#160;which</p>
<p style="position:absolute;top:819px;left:261px;white-space:nowrap" class="ft1829">u</p>
<p style="position:absolute;top:820px;left:273px;white-space:nowrap" class="ft1812">was&#160;contained&#160;in&#160;the&#160;ACL.&#160;Any&#160;predicate</p>
<p style="position:absolute;top:819px;left:521px;white-space:nowrap" class="ft1828">Π</p>
<p style="position:absolute;top:820px;left:536px;white-space:nowrap" class="ft1812">for&#160;attestation&#160;or&#160;seal-</p>
<p style="position:absolute;top:838px;left:150px;white-space:nowrap" class="ft1815">ing&#160;can&#160;be&#160;applied&#160;on&#160;such&#160;a&#160;projection&#160;without&#160;violating&#160;the&#160;access&#160;restrictions.&#160;If&#160;the<br/>projection&#160;does&#160;not&#160;conform&#160;to</p>
<p style="position:absolute;top:856px;left:337px;white-space:nowrap" class="ft1827">r</p>
<p style="position:absolute;top:855px;left:342px;white-space:nowrap" class="ft1828">()</p>
<p style="position:absolute;top:856px;left:353px;white-space:nowrap" class="ft1812">,&#160;then&#160;prior&#160;to&#160;applying&#160;the&#160;predicate,&#160;an&#160;<i>access&#160;filter</i></p>
<p style="position:absolute;top:874px;left:150px;white-space:nowrap" class="ft1812">is&#160;used&#160;to&#160;hide&#160;those&#160;parts&#160;of</p>
<p style="position:absolute;top:874px;left:324px;white-space:nowrap" class="ft1827">p</p>
<p style="position:absolute;top:873px;left:332px;white-space:nowrap" class="ft1828">(</p>
<p style="position:absolute;top:873px;left:337px;white-space:nowrap" class="ft1833">T</p>
<p style="position:absolute;top:873px;left:349px;white-space:nowrap" class="ft1828">)</p>
<p style="position:absolute;top:874px;left:359px;white-space:nowrap" class="ft1812">that</p>
<p style="position:absolute;top:873px;left:385px;white-space:nowrap" class="ft1829">u</p>
<p style="position:absolute;top:874px;left:397px;white-space:nowrap" class="ft1812">is&#160;not&#160;authorized&#160;to&#160;see.</p>
<p style="position:absolute;top:938px;left:150px;white-space:nowrap" class="ft1820"><b>3.3</b></p>
<p style="position:absolute;top:938px;left:198px;white-space:nowrap" class="ft1820"><b>The&#160;PEV&#160;Integrity&#160;Architecture</b></p>
<p style="position:absolute;top:976px;left:150px;white-space:nowrap" class="ft1815">Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#18">3.4&#160;</a>shows&#160;the&#160;PEV&#160;architecture&#160;for&#160;protecting,&#160;enforcing,&#160;and&#160;verifying&#160;the<br/>integrity&#160;of&#160;VMs&#160;and&#160;virtual&#160;devices.&#160;There&#160;is&#160;a&#160;<i>central&#160;integrity&#160;manager&#160;</i>and&#160;<i>compo-<br/>nent&#160;integrity&#160;managers&#160;</i>that&#160;are&#160;associated&#160;with&#160;individual&#160;system&#160;components&#160;such&#160;as<br/>storage,&#160;VMM,&#160;networking,&#160;and&#160;other&#160;devices.&#160;Each&#160;component&#160;integrity&#160;manager&#160;is<br/>responsible&#160;for&#160;the&#160;part&#160;of&#160;the&#160;log&#160;tree&#160;corresponding&#160;to&#160;the&#160;component.&#160;For&#160;example,<br/>the&#160;storage&#160;integrity&#160;manager&#160;is&#160;responsible&#160;for&#160;maintaining&#160;the&#160;storage&#160;sub-tree&#160;of&#160;the</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft1818">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 19 -->
<a name="19"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page19-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL019.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft1912">CHAPTER&#160;3.&#160;COMPLIANCE&#160;PROOFS&#160;FOR&#160;XEN</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft1912">17</p>
<p style="position:absolute;top:193px;left:226px;white-space:nowrap" class="ft1912">system&#160;log&#160;tree</p>
<p style="position:absolute;top:192px;left:321px;white-space:nowrap" class="ft1933">T</p>
<p style="position:absolute;top:193px;left:333px;white-space:nowrap" class="ft1912">.&#160;Hereafter,&#160;we&#160;refer&#160;to&#160;the&#160;central&#160;integrity&#160;manager&#160;as&#160;<i>the&#160;</i>Integrity</p>
<p style="position:absolute;top:211px;left:226px;white-space:nowrap" class="ft1912">Manager.</p>
<p style="position:absolute;top:229px;left:248px;white-space:nowrap" class="ft1912">The&#160;Integrity&#160;Manager&#160;has&#160;a&#160;<i>master&#160;plug-in&#160;module&#160;</i>for&#160;each&#160;log&#160;projection&#160;func-</p>
<p style="position:absolute;top:247px;left:226px;white-space:nowrap" class="ft1915">tion&#160;that&#160;needs&#160;to&#160;be&#160;implemented.&#160;The&#160;module&#160;obtains&#160;state&#160;information&#160;about&#160;various<br/>aspects&#160;of&#160;the&#160;system&#160;that&#160;may&#160;be&#160;of&#160;interest&#160;to&#160;a&#160;potential&#160;verifier&#160;or&#160;user&#160;by&#160;invoking<br/>the&#160;appropriate&#160;<i>component&#160;plug-in&#160;modules&#160;</i>and&#160;aggregating&#160;their&#160;outputs.&#160;A&#160;compo-<br/>nent&#160;plug-in&#160;module&#160;is&#160;part&#160;of&#160;the&#160;component&#160;integrity&#160;manager&#160;and&#160;reveals&#160;particular<br/>aspects&#160;of&#160;the&#160;component’s&#160;integrity&#160;that&#160;are&#160;relevant&#160;for&#160;the&#160;projection&#160;function.</p>
<p style="position:absolute;top:337px;left:248px;white-space:nowrap" class="ft1912">In&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#18">3.4,&#160;</a>the&#160;various&#160;master&#160;plug-in&#160;modules&#160;are&#160;attached&#160;to&#160;the&#160;Integrity&#160;Man-</p>
<p style="position:absolute;top:355px;left:226px;white-space:nowrap" class="ft1915">ager&#160;are&#160;shown&#160;using&#160;different&#160;geometrical&#160;shapes&#160;(ovals,&#160;hexagons,&#160;triangles,&#160;and<br/>rectangles).&#160;For&#160;example,&#160;the&#160;triangular&#160;plug-in&#160;module&#160;measures&#160;certain&#160;aspects&#160;of<br/>system&#160;storage&#160;and&#160;the&#160;VMM,&#160;as&#160;indicated&#160;by&#160;the&#160;presence&#160;of&#160;triangular&#160;component<br/>plug-in&#160;modules&#160;in&#160;the&#160;Storage&#160;Integrity&#160;Manager&#160;and&#160;VMM&#160;Integrity&#160;Manager.&#160;On<br/>the&#160;other&#160;hand,&#160;the&#160;hexagonal&#160;plug-in&#160;module&#160;measures&#160;only&#160;certain&#160;aspects&#160;of&#160;sys-<br/>tem&#160;devices.&#160;Each&#160;plug-in&#160;module&#160;has&#160;a&#160;unique&#160;identifier.&#160;The&#160;mapping&#160;between&#160;each<br/>plug-in&#160;identifier&#160;and&#160;the&#160;functionality&#160;provided&#160;by&#160;the&#160;corresponding&#160;plug-in&#160;module<br/>is&#160;made&#160;publicly&#160;available&#160;(e.g.,&#160;through&#160;a&#160;naming&#160;service&#160;or&#160;a&#160;published&#160;table).</p>
<p style="position:absolute;top:539px;left:226px;white-space:nowrap" class="ft1944"><b>3.3.1</b></p>
<p style="position:absolute;top:539px;left:280px;white-space:nowrap" class="ft1944"><b>Sealing/Unsealing&#160;Protocol</b></p>
<p style="position:absolute;top:569px;left:226px;white-space:nowrap" class="ft1912">At&#160;the&#160;time&#160;of&#160;sealing,&#160;the&#160;user&#160;provides&#160;the&#160;following&#160;inputs:</p>
<p style="position:absolute;top:599px;left:226px;white-space:nowrap" class="ft1917"><b>Data&#160;</b>The&#160;data&#160;item&#160;to&#160;be&#160;encrypted&#160;during&#160;sealing&#160;and&#160;to&#160;be&#160;revealed&#160;later&#160;only&#160;if</p>
<p style="position:absolute;top:617px;left:263px;white-space:nowrap" class="ft1912">certain&#160;conditions&#160;are&#160;met.</p>
<p style="position:absolute;top:647px;left:226px;white-space:nowrap" class="ft1917"><b>Key&#160;</b>The&#160;sealing&#160;key&#160;whose&#160;public&#160;part&#160;is&#160;used&#160;for&#160;encrypting&#160;the&#160;data&#160;at&#160;the&#160;time&#160;of</p>
<p style="position:absolute;top:665px;left:263px;white-space:nowrap" class="ft1915">sealing,&#160;and&#160;whose&#160;private&#160;part&#160;is&#160;revealed&#160;only&#160;if&#160;the&#160;unseal&#160;operation&#160;completes<br/>successfully.</p>
<p style="position:absolute;top:713px;left:226px;white-space:nowrap" class="ft1917"><b>Identifier(s)&#160;of&#160;Plug-in&#160;Module(s)&#160;</b>By&#160;listing&#160;the&#160;identifiers&#160;of&#160;plug-in&#160;modules,&#160;a&#160;user</p>
<p style="position:absolute;top:731px;left:263px;white-space:nowrap" class="ft1915">can&#160;choose&#160;what&#160;aspects&#160;of&#160;the&#160;system’s&#160;integrity&#160;state&#160;are&#160;to&#160;be&#160;checked&#160;prior&#160;to<br/>revealing&#160;the&#160;private&#160;part&#160;of&#160;the&#160;sealing&#160;key.</p>
<p style="position:absolute;top:778px;left:226px;white-space:nowrap" class="ft1917"><b>Predicate&#160;</b>The&#160;predicate&#160;specifies&#160;user-defined&#160;conditions&#160;that&#160;the&#160;system’s&#160;integrity</p>
<p style="position:absolute;top:796px;left:263px;white-space:nowrap" class="ft1915">state&#160;must&#160;satisfy&#160;at&#160;the&#160;time&#160;of&#160;unsealing&#160;in&#160;order&#160;for&#160;the&#160;private&#160;part&#160;of&#160;the<br/>sealing&#160;key&#160;to&#160;be&#160;revealed.</p>
<p style="position:absolute;top:844px;left:248px;white-space:nowrap" class="ft1912">Our&#160;sealing&#160;protocol&#160;requires&#160;the&#160;log&#160;projection&#160;functions&#160;(described&#160;in&#160;Sec-</p>
<p style="position:absolute;top:862px;left:226px;white-space:nowrap" class="ft1915">tion&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#16">3.2.1)&#160;</a>to&#160;be&#160;implemented&#160;as&#160;plug-in&#160;modules&#160;as&#160;part&#160;of&#160;the&#160;TCB.&#160;The&#160;key&#160;used<br/>for&#160;encrypting&#160;the&#160;sensitive&#160;data&#160;item&#160;is&#160;sealed&#160;away&#160;against&#160;the&#160;state&#160;of&#160;the&#160;TCB&#160;and<br/>a&#160;hash&#160;of&#160;the&#160;user-specified&#160;projection&#160;functions&#160;and&#160;sealing&#160;predicates.&#160;The&#160;Integrity<br/>Manager&#160;stores&#160;the&#160;state&#160;of&#160;the&#160;TCB&#160;in&#160;PCRs&#160;that&#160;cannot&#160;be&#160;reset&#160;and&#160;the&#160;hash&#160;in&#160;a<br/>resettable&#160;PCR&#160;(say</p>
<p style="position:absolute;top:933px;left:350px;white-space:nowrap" class="ft1929">P&#160;CR</p>
<p style="position:absolute;top:939px;left:385px;white-space:nowrap" class="ft1943">i</p>
<p style="position:absolute;top:934px;left:390px;white-space:nowrap" class="ft1912">).&#160;This&#160;ensures&#160;that&#160;the&#160;TCB&#160;is&#160;aware&#160;of&#160;the&#160;conditions&#160;to</p>
<p style="position:absolute;top:952px;left:226px;white-space:nowrap" class="ft1915">be&#160;satisfied&#160;before&#160;the&#160;key&#160;can&#160;be&#160;revealed&#160;to&#160;the&#160;user.&#160;To&#160;perform&#160;the&#160;unseal&#160;operation,<br/>the&#160;TCB&#160;has&#160;to&#160;ensure&#160;that</p>
<p style="position:absolute;top:969px;left:393px;white-space:nowrap" class="ft1929">P&#160;CR</p>
<p style="position:absolute;top:975px;left:428px;white-space:nowrap" class="ft1943">i</p>
<p style="position:absolute;top:970px;left:437px;white-space:nowrap" class="ft1912">still&#160;contains&#160;the&#160;hash&#160;of&#160;the&#160;user-specified&#160;projec-</p>
<p style="position:absolute;top:988px;left:226px;white-space:nowrap" class="ft1915">tion&#160;function&#160;and&#160;sealing&#160;predicates.&#160;Then,&#160;the&#160;unseal&#160;operation&#160;reveals&#160;the&#160;key&#160;to&#160;the<br/>Integrity&#160;Manager.&#160;The&#160;Integrity&#160;Manager&#160;then&#160;invokes&#160;the&#160;<i>predicate&#160;evaluator&#160;</i>module<br/>(Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#18">3.4)&#160;</a>to&#160;check&#160;whether&#160;the&#160;sealing&#160;predicates&#160;(evaluated&#160;on&#160;the&#160;output&#160;of&#160;the&#160;log<br/>projection&#160;function)&#160;are&#160;indeed&#160;satisfied.&#160;If&#160;that&#160;is&#160;the&#160;case,&#160;then&#160;the&#160;Integrity&#160;Manager<br/>reveals&#160;the&#160;key&#160;to&#160;the&#160;user.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft1918">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 20 -->
<a name="20"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2050{font-size:10px;font-family:Times;color:#000000;}
	.ft2051{font-size:7px;font-family:Times;color:#000000;}
	.ft2052{font-size:10px;font-family:Times;color:#ffffff;}
	.ft2053{font-size:7px;font-family:Times;color:#ffffff;}
	.ft2054{font-size:181px;font-family:Times;color:#000000;}
-->
</style>
<div id="page20-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL020.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft2012">18</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft2018">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:205px;left:326px;white-space:nowrap" class="ft2050"><b>N</b></p>
<p style="position:absolute;top:231px;left:295px;white-space:nowrap" class="ft2050"><b>N</b></p>
<p style="position:absolute;top:236px;left:303px;white-space:nowrap" class="ft2051"><b>1</b></p>
<p style="position:absolute;top:231px;left:350px;white-space:nowrap" class="ft2050"><b>N</b></p>
<p style="position:absolute;top:236px;left:357px;white-space:nowrap" class="ft2051"><b>2</b></p>
<p style="position:absolute;top:260px;left:270px;white-space:nowrap" class="ft2050"><b>N</b></p>
<p style="position:absolute;top:265px;left:278px;white-space:nowrap" class="ft2051"><b>11</b></p>
<p style="position:absolute;top:260px;left:320px;white-space:nowrap" class="ft2050"><b>N</b></p>
<p style="position:absolute;top:265px;left:327px;white-space:nowrap" class="ft2051"><b>12</b></p>
<p style="position:absolute;top:257px;left:493px;white-space:nowrap" class="ft2050"><b>N’</b></p>
<p style="position:absolute;top:283px;left:463px;white-space:nowrap" class="ft2050"><b>N’</b></p>
<p style="position:absolute;top:288px;left:474px;white-space:nowrap" class="ft2051"><b>1</b></p>
<p style="position:absolute;top:283px;left:517px;white-space:nowrap" class="ft2050"><b>N’</b></p>
<p style="position:absolute;top:288px;left:528px;white-space:nowrap" class="ft2051"><b>2</b></p>
<p style="position:absolute;top:312px;left:438px;white-space:nowrap" class="ft2050"><b>N’</b></p>
<p style="position:absolute;top:317px;left:449px;white-space:nowrap" class="ft2051"><b>11</b></p>
<p style="position:absolute;top:312px;left:487px;white-space:nowrap" class="ft2050"><b>N’</b></p>
<p style="position:absolute;top:317px;left:498px;white-space:nowrap" class="ft2051"><b>12</b></p>
<p style="position:absolute;top:312px;left:328px;white-space:nowrap" class="ft2052"><b>R</b></p>
<p style="position:absolute;top:338px;left:298px;white-space:nowrap" class="ft2052"><b>R</b></p>
<p style="position:absolute;top:343px;left:305px;white-space:nowrap" class="ft2053"><b>1</b></p>
<p style="position:absolute;top:338px;left:353px;white-space:nowrap" class="ft2052"><b>R</b></p>
<p style="position:absolute;top:343px;left:360px;white-space:nowrap" class="ft2053"><b>2</b></p>
<p style="position:absolute;top:367px;left:273px;white-space:nowrap" class="ft2052"><b>R</b></p>
<p style="position:absolute;top:372px;left:280px;white-space:nowrap" class="ft2053"><b>11</b></p>
<p style="position:absolute;top:367px;left:322px;white-space:nowrap" class="ft2052"><b>R</b></p>
<p style="position:absolute;top:372px;left:330px;white-space:nowrap" class="ft2053"><b>12</b></p>
<p style="position:absolute;top:125px;left:327px;white-space:nowrap" class="ft2054">&#160;</p>
<p style="position:absolute;top:416px;left:239px;white-space:nowrap" class="ft2012">Figure&#160;3.5:&#160;Enforcing&#160;access&#160;restrictions&#160;on&#160;system&#160;state</p>
<p style="position:absolute;top:464px;left:172px;white-space:nowrap" class="ft2012">The&#160;flexibility&#160;of&#160;our&#160;sealing&#160;protocol&#160;is&#160;due&#160;to&#160;the&#160;fact&#160;that&#160;arbitrarily&#160;complex</p>
<p style="position:absolute;top:482px;left:150px;white-space:nowrap" class="ft2015">conditions&#160;to&#160;reveal&#160;the&#160;sealed&#160;key&#160;can&#160;be&#160;coded&#160;as&#160;plug-in&#160;modules.&#160;The&#160;extensibility<br/>arises&#160;from&#160;the&#160;fact&#160;that&#160;new&#160;plug-in&#160;modules&#160;covering&#160;the&#160;integrity&#160;state&#160;of&#160;newly<br/>added&#160;VMs&#160;or&#160;virtual&#160;devices&#160;can&#160;be&#160;easily&#160;added&#160;to&#160;the&#160;TCB.</p>
<p style="position:absolute;top:576px;left:150px;white-space:nowrap" class="ft2044"><b>3.3.2</b></p>
<p style="position:absolute;top:576px;left:204px;white-space:nowrap" class="ft2044"><b>Attestation&#160;Protocol</b></p>
<p style="position:absolute;top:607px;left:150px;white-space:nowrap" class="ft2015">The&#160;verifier&#160;initiating&#160;the&#160;attestation&#160;protocol&#160;provides&#160;as&#160;input&#160;a&#160;challenge&#160;(to&#160;ensure<br/>freshness)&#160;and&#160;the&#160;identifier(s)&#160;of&#160;plug-in&#160;module(s)&#160;that&#160;are&#160;relevant&#160;to&#160;evaluating&#160;sys-<br/>tem&#160;compliance&#160;with&#160;the&#160;verifier’s&#160;integrity&#160;requirements.&#160;The&#160;flexibility&#160;of&#160;our&#160;attes-<br/>tation&#160;protocol&#160;relies&#160;on&#160;the&#160;verifier&#160;being&#160;able&#160;to&#160;attest&#160;the&#160;TCB&#160;and&#160;requires&#160;the&#160;log<br/>projection&#160;functions&#160;(described&#160;in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#16">3.2.1)&#160;</a>to&#160;be&#160;implemented&#160;as&#160;plug-in&#160;modules<br/>as&#160;part&#160;of&#160;the&#160;TCB.&#160;The&#160;extensibility&#160;of&#160;our&#160;attestation&#160;protocols&#160;relies&#160;on&#160;the&#160;ability&#160;to<br/>add&#160;new&#160;plug-in&#160;modules&#160;for&#160;new&#160;aspects&#160;of&#160;the&#160;system’s&#160;integrity&#160;state&#160;that&#160;the&#160;verifier<br/>may&#160;be&#160;interested&#160;in.</p>
<p style="position:absolute;top:791px;left:150px;white-space:nowrap" class="ft2044"><b>3.3.3</b></p>
<p style="position:absolute;top:791px;left:204px;white-space:nowrap" class="ft2044"><b>A&#160;Blinding&#160;Technique&#160;For&#160;Enforcing&#160;Access&#160;Restrictions</b></p>
<p style="position:absolute;top:821px;left:150px;white-space:nowrap" class="ft2015">Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#20">3.5&#160;</a>shows&#160;a&#160;simple&#160;<i>blinding&#160;</i>technique&#160;that&#160;uses&#160;a&#160;<i>commitment&#160;scheme&#160;</i>to&#160;enforce<br/>access&#160;restrictions&#160;on&#160;the&#160;log&#160;tree.&#160;Cryptographic&#160;commitment&#160;schemes&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[30]&#160;</a>generally<br/>consist&#160;of&#160;two&#160;phases.&#160;The&#160;first&#160;phase,&#160;called&#160;<i>commit&#160;phase</i>,&#160;is&#160;used&#160;to&#160;make&#160;a&#160;party<br/><i>commit&#160;</i>to&#160;a&#160;particular&#160;value&#160;while&#160;hiding&#160;that&#160;value&#160;from&#160;another&#160;party.&#160;It&#160;is&#160;only&#160;in&#160;the<br/>second&#160;phase,&#160;called&#160;<i>reveal&#160;phase</i>,&#160;that&#160;the&#160;value&#160;is&#160;<i>revealed&#160;</i>to&#160;the&#160;second&#160;party.&#160;Any<br/>commitment&#160;scheme&#160;guarantees&#160;that&#160;(a)&#160;the&#160;committed&#160;value&#160;cannot&#160;be&#160;obtained&#160;by&#160;the<br/>second&#160;party&#160;before&#160;the&#160;reveal&#160;phase,&#160;and&#160;(b)&#160;the&#160;second&#160;party&#160;can&#160;detect&#160;whether&#160;the<br/>value&#160;revealed&#160;is&#160;indeed&#160;the&#160;same&#160;value&#160;that&#160;was&#160;committed&#160;to&#160;in&#160;the&#160;first&#160;phase.</p>
<p style="position:absolute;top:964px;left:172px;white-space:nowrap" class="ft2012">For&#160;simplicity,&#160;we&#160;consider&#160;blinding&#160;at&#160;the&#160;granularity&#160;of&#160;log&#160;tree&#160;nodes&#160;instead&#160;of</p>
<p style="position:absolute;top:982px;left:150px;white-space:nowrap" class="ft2015">at&#160;the&#160;granularity&#160;of&#160;log&#160;vector&#160;elements&#160;in&#160;the&#160;tree&#160;nodes,&#160;i.e.,&#160;the&#160;access&#160;restriction<br/>specification</p>
<p style="position:absolute;top:1000px;left:230px;white-space:nowrap" class="ft2027">r</p>
<p style="position:absolute;top:999px;left:235px;white-space:nowrap" class="ft2028">()</p>
<p style="position:absolute;top:1000px;left:252px;white-space:nowrap" class="ft2012">assigns&#160;a&#160;subset&#160;of</p>
<p style="position:absolute;top:999px;left:371px;white-space:nowrap" class="ft2029">U</p>
<p style="position:absolute;top:1000px;left:387px;white-space:nowrap" class="ft2012">to&#160;each&#160;node&#160;of&#160;the&#160;tree.&#160;A&#160;<i>random&#160;</i>tree</p>
<p style="position:absolute;top:999px;left:638px;white-space:nowrap" class="ft2033">R</p>
<p style="position:absolute;top:1000px;left:655px;white-space:nowrap" class="ft2012">is</p>
<p style="position:absolute;top:1018px;left:150px;white-space:nowrap" class="ft2012">bound&#160;to&#160;the&#160;original&#160;log&#160;tree</p>
<p style="position:absolute;top:1017px;left:336px;white-space:nowrap" class="ft2033">T</p>
<p style="position:absolute;top:1018px;left:353px;white-space:nowrap" class="ft2012">through&#160;a&#160;<i>multi-bit&#160;commitment&#160;scheme&#160;</i>to&#160;give&#160;the</p>
<p style="position:absolute;top:1036px;left:150px;white-space:nowrap" class="ft2012">blinded&#160;log&#160;tree</p>
<p style="position:absolute;top:1031px;left:249px;white-space:nowrap" class="ft2028">¯</p>
<p style="position:absolute;top:1035px;left:246px;white-space:nowrap" class="ft2033">T</p>
<p style="position:absolute;top:1036px;left:258px;white-space:nowrap" class="ft2012">.</p>
<p style="position:absolute;top:1035px;left:266px;white-space:nowrap" class="ft2033">R</p>
<p style="position:absolute;top:1036px;left:282px;white-space:nowrap" class="ft2012">is&#160;a&#160;tree&#160;that&#160;has&#160;the&#160;same&#160;structure&#160;as&#160;that&#160;of</p>
<p style="position:absolute;top:1035px;left:549px;white-space:nowrap" class="ft2033">T</p>
<p style="position:absolute;top:1036px;left:564px;white-space:nowrap" class="ft2012">and&#160;whose&#160;nodes</p>
<p style="position:absolute;top:1054px;left:150px;white-space:nowrap" class="ft2015">are&#160;random&#160;numbers.&#160;Existing&#160;commitment&#160;schemes&#160;such&#160;as&#160;the&#160;one&#160;by&#160;Damgard&#160;et<br/>al.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[18]&#160;</a>or&#160;those&#160;based&#160;on&#160;one-way&#160;hash&#160;functions&#160;can&#160;be&#160;used&#160;for&#160;this&#160;purpose.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft2018">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 21 -->
<a name="21"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page21-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL021.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft2112">CHAPTER&#160;3.&#160;COMPLIANCE&#160;PROOFS&#160;FOR&#160;XEN</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft2112">19</p>
<p style="position:absolute;top:193px;left:248px;white-space:nowrap" class="ft2112">In&#160;a&#160;TPM-equipped&#160;system,&#160;logging&#160;is&#160;done&#160;by&#160;extending&#160;the&#160;PCRs&#160;with&#160;the&#160;mea-</p>
<p style="position:absolute;top:211px;left:226px;white-space:nowrap" class="ft2112">surement&#160;values.&#160;For&#160;blinding,&#160;it&#160;is&#160;the&#160;nodes&#160;of</p>
<p style="position:absolute;top:207px;left:540px;white-space:nowrap" class="ft2128">¯</p>
<p style="position:absolute;top:210px;left:537px;white-space:nowrap" class="ft2133">T</p>
<p style="position:absolute;top:211px;left:555px;white-space:nowrap" class="ft2112">that&#160;are&#160;actually&#160;logged.&#160;This</p>
<p style="position:absolute;top:229px;left:226px;white-space:nowrap" class="ft2112">means&#160;that&#160;instead&#160;of&#160;doing&#160;the&#160;normal</p>
<p style="position:absolute;top:229px;left:478px;white-space:nowrap" class="ft2127">TPM</p>
<p style="position:absolute;top:229px;left:511px;white-space:nowrap" class="ft2112">_</p>
<p style="position:absolute;top:229px;left:518px;white-space:nowrap" class="ft2127">extend</p>
<p style="position:absolute;top:228px;left:559px;white-space:nowrap" class="ft2128">(</p>
<p style="position:absolute;top:229px;left:565px;white-space:nowrap" class="ft2127">n</p>
<p style="position:absolute;top:228px;left:573px;white-space:nowrap" class="ft2128">)</p>
<p style="position:absolute;top:229px;left:579px;white-space:nowrap" class="ft2112">,&#160;a</p>
<p style="position:absolute;top:229px;left:602px;white-space:nowrap" class="ft2127">TPM</p>
<p style="position:absolute;top:229px;left:634px;white-space:nowrap" class="ft2112">_</p>
<p style="position:absolute;top:229px;left:642px;white-space:nowrap" class="ft2127">extend</p>
<p style="position:absolute;top:228px;left:683px;white-space:nowrap" class="ft2128">(</p>
<p style="position:absolute;top:229px;left:688px;white-space:nowrap" class="ft2127">r</p>
<p style="position:absolute;top:228px;left:697px;white-space:nowrap" class="ft2133">⊗</p>
<p style="position:absolute;top:229px;left:712px;white-space:nowrap" class="ft2127">n</p>
<p style="position:absolute;top:228px;left:720px;white-space:nowrap" class="ft2128">)</p>
<p style="position:absolute;top:229px;left:732px;white-space:nowrap" class="ft2112">is</p>
<p style="position:absolute;top:247px;left:226px;white-space:nowrap" class="ft2112">done,&#160;where</p>
<p style="position:absolute;top:246px;left:308px;white-space:nowrap" class="ft2129">n</p>
<p style="position:absolute;top:247px;left:323px;white-space:nowrap" class="ft2112">is&#160;a&#160;node&#160;of</p>
<p style="position:absolute;top:246px;left:405px;white-space:nowrap" class="ft2133">T</p>
<p style="position:absolute;top:247px;left:417px;white-space:nowrap" class="ft2112">,</p>
<p style="position:absolute;top:246px;left:427px;white-space:nowrap" class="ft2129">r</p>
<p style="position:absolute;top:247px;left:440px;white-space:nowrap" class="ft2112">is&#160;a&#160;node&#160;of</p>
<p style="position:absolute;top:246px;left:522px;white-space:nowrap" class="ft2133">R</p>
<p style="position:absolute;top:247px;left:535px;white-space:nowrap" class="ft2112">,&#160;and</p>
<p style="position:absolute;top:246px;left:573px;white-space:nowrap" class="ft2133">⊗</p>
<p style="position:absolute;top:247px;left:590px;white-space:nowrap" class="ft2112">denotes&#160;the&#160;commitment</p>
<p style="position:absolute;top:265px;left:226px;white-space:nowrap" class="ft2112">operation&#160;used&#160;for&#160;hiding</p>
<p style="position:absolute;top:264px;left:381px;white-space:nowrap" class="ft2129">n</p>
<p style="position:absolute;top:265px;left:393px;white-space:nowrap" class="ft2112">until&#160;the&#160;reveal&#160;phase.</p>
<p style="position:absolute;top:283px;left:248px;white-space:nowrap" class="ft2112">A&#160;projection&#160;function</p>
<p style="position:absolute;top:283px;left:380px;white-space:nowrap" class="ft2127">p</p>
<p style="position:absolute;top:282px;left:388px;white-space:nowrap" class="ft2128">()</p>
<p style="position:absolute;top:283px;left:403px;white-space:nowrap" class="ft2112">that&#160;conforms&#160;to&#160;the&#160;access&#160;restrictions&#160;can&#160;be&#160;realized&#160;as</p>
<p style="position:absolute;top:301px;left:226px;white-space:nowrap" class="ft2112">follows:&#160;when&#160;invoked&#160;at&#160;the&#160;request&#160;of&#160;user</p>
<p style="position:absolute;top:300px;left:498px;white-space:nowrap" class="ft2129">u</p>
<p style="position:absolute;top:301px;left:506px;white-space:nowrap" class="ft2112">,</p>
<p style="position:absolute;top:301px;left:514px;white-space:nowrap" class="ft2127">p</p>
<p style="position:absolute;top:300px;left:522px;white-space:nowrap" class="ft2128">()</p>
<p style="position:absolute;top:301px;left:537px;white-space:nowrap" class="ft2112">reveals</p>
<p style="position:absolute;top:296px;left:586px;white-space:nowrap" class="ft2128">¯</p>
<p style="position:absolute;top:300px;left:583px;white-space:nowrap" class="ft2133">T</p>
<p style="position:absolute;top:301px;left:599px;white-space:nowrap" class="ft2112">and&#160;only&#160;those&#160;nodes&#160;in</p>
<p style="position:absolute;top:318px;left:226px;white-space:nowrap" class="ft2133">T</p>
<p style="position:absolute;top:319px;left:241px;white-space:nowrap" class="ft2112">that&#160;contain</p>
<p style="position:absolute;top:318px;left:314px;white-space:nowrap" class="ft2129">u</p>
<p style="position:absolute;top:319px;left:326px;white-space:nowrap" class="ft2112">in&#160;their&#160;respective&#160;ACLs.&#160;Thus,</p>
<p style="position:absolute;top:319px;left:514px;white-space:nowrap" class="ft2127">p</p>
<p style="position:absolute;top:318px;left:522px;white-space:nowrap" class="ft2128">()</p>
<p style="position:absolute;top:319px;left:537px;white-space:nowrap" class="ft2112">implements&#160;the&#160;reveal&#160;phase&#160;of&#160;the</p>
<p style="position:absolute;top:337px;left:226px;white-space:nowrap" class="ft2112">multi-bit&#160;commitment&#160;scheme&#160;and&#160;reveals&#160;only&#160;those&#160;nodes&#160;in</p>
<p style="position:absolute;top:336px;left:607px;white-space:nowrap" class="ft2133">T</p>
<p style="position:absolute;top:337px;left:624px;white-space:nowrap" class="ft2112">that</p>
<p style="position:absolute;top:336px;left:651px;white-space:nowrap" class="ft2129">u</p>
<p style="position:absolute;top:337px;left:664px;white-space:nowrap" class="ft2112">is&#160;authorized</p>
<p style="position:absolute;top:355px;left:226px;white-space:nowrap" class="ft2115">to&#160;access.&#160;Due&#160;to&#160;the&#160;guarantees&#160;of&#160;the&#160;commitment&#160;scheme,&#160;the&#160;system&#160;cannot&#160;invent<br/>arbitrary&#160;values&#160;for&#160;the&#160;nodes&#160;in</p>
<p style="position:absolute;top:372px;left:420px;white-space:nowrap" class="ft2133">T</p>
<p style="position:absolute;top:373px;left:436px;white-space:nowrap" class="ft2112">without&#160;being&#160;detected&#160;by&#160;the&#160;user.</p>
<p style="position:absolute;top:391px;left:248px;white-space:nowrap" class="ft2112">As&#160;a&#160;result&#160;of&#160;the&#160;blinding&#160;technique&#160;described&#160;above,&#160;any&#160;user</p>
<p style="position:absolute;top:390px;left:642px;white-space:nowrap" class="ft2129">u</p>
<p style="position:absolute;top:391px;left:656px;white-space:nowrap" class="ft2112">knows&#160;that&#160;all</p>
<p style="position:absolute;top:409px;left:226px;white-space:nowrap" class="ft2115">components&#160;that&#160;have&#160;any&#160;effect&#160;on&#160;system&#160;integrity&#160;have&#160;been&#160;taken&#160;into&#160;consideration<br/>in&#160;the&#160;system&#160;log&#160;tree;&#160;in&#160;addition,&#160;for&#160;those&#160;components&#160;that&#160;it&#160;is&#160;authorized&#160;to&#160;access,</p>
<p style="position:absolute;top:444px;left:226px;white-space:nowrap" class="ft2129">u</p>
<p style="position:absolute;top:445px;left:238px;white-space:nowrap" class="ft2112">can&#160;check&#160;whether&#160;they&#160;indeed&#160;have&#160;the&#160;acceptable&#160;configuration&#160;and&#160;state&#160;value,&#160;by</p>
<p style="position:absolute;top:463px;left:226px;white-space:nowrap" class="ft2115">comparing&#160;with&#160;its&#160;own&#160;reference&#160;values&#160;that&#160;may&#160;be&#160;provided&#160;and&#160;certified&#160;by&#160;a&#160;trusted<br/>third&#160;party.&#160;In&#160;particular,&#160;if&#160;the&#160;ACL&#160;for&#160;the&#160;root&#160;node&#160;is</p>
<p style="position:absolute;top:479px;left:575px;white-space:nowrap" class="ft2129">U</p>
<p style="position:absolute;top:480px;left:591px;white-space:nowrap" class="ft2112">(i.e.,&#160;all&#160;users&#160;can&#160;access</p>
<p style="position:absolute;top:498px;left:226px;white-space:nowrap" class="ft2115">the&#160;root&#160;node),&#160;then&#160;any&#160;user&#160;can&#160;verify&#160;overall&#160;system&#160;integrity&#160;(just&#160;from&#160;the&#160;value&#160;of<br/><i>root</i>(</p>
<p style="position:absolute;top:515px;left:256px;white-space:nowrap" class="ft2133">T</p>
<p style="position:absolute;top:516px;left:267px;white-space:nowrap" class="ft2112">))&#160;without&#160;knowing&#160;the&#160;exact&#160;configuration&#160;of&#160;any&#160;individual&#160;component&#160;in&#160;the</p>
<p style="position:absolute;top:534px;left:226px;white-space:nowrap" class="ft2112">system.</p>
<p style="position:absolute;top:552px;left:248px;white-space:nowrap" class="ft2112">Our&#160;approach&#160;of&#160;using&#160;commitment&#160;schemes&#160;for&#160;blinding&#160;suffers&#160;from&#160;the&#160;disad-</p>
<p style="position:absolute;top:570px;left:226px;white-space:nowrap" class="ft2115">vantage&#160;that&#160;two&#160;colluding&#160;verifiers&#160;can&#160;learn&#160;the&#160;values&#160;revealed&#160;to&#160;the&#160;other.&#160;Alternate<br/>schemes&#160;based&#160;on&#160;zero-knowledge&#160;proofs&#160;or&#160;deniable&#160;signatures&#160;need&#160;to&#160;be&#160;investigated<br/>to&#160;overcome&#160;this&#160;disadvantage.</p>
<p style="position:absolute;top:670px;left:226px;white-space:nowrap" class="ft2120"><b>3.4</b></p>
<p style="position:absolute;top:670px;left:274px;white-space:nowrap" class="ft2120"><b>Realization&#160;using&#160;Xen&#160;and&#160;Linux</b></p>
<p style="position:absolute;top:708px;left:226px;white-space:nowrap" class="ft2115">Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#22">3.6&#160;</a>shows&#160;an&#160;example&#160;implementation&#160;of&#160;our&#160;PEV&#160;architecture&#160;with&#160;the&#160;Xen&#160;hy-<br/>pervisor&#160;using&#160;Linux&#160;for&#160;Dom0.&#160;The&#160;main&#160;components&#160;of&#160;our&#160;implementation&#160;are&#160;the<br/>Compartment&#160;Manager&#160;(CM),&#160;Integrity&#160;Manager&#160;(IM),&#160;and&#160;the&#160;Secure&#160;Virtual&#160;Device<br/>Manager&#160;(SVDM).&#160;All&#160;components&#160;are&#160;implemented&#160;in&#160;Dom0.&#160;The&#160;CM&#160;is&#160;responsi-<br/>ble&#160;for&#160;the&#160;VM&#160;life&#160;cycle&#160;management.&#160;As&#160;the&#160;sole&#160;entry&#160;point&#160;for&#160;user&#160;commands,&#160;it<br/>communicates&#160;directly&#160;with&#160;the&#160;hypervisor&#160;and&#160;orchestrates&#160;the&#160;IM&#160;and&#160;the&#160;SVDM.&#160;Ta-<br/>ble&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#22">3.1&#160;</a>shows&#160;the&#160;mapping&#160;between&#160;concepts&#160;in&#160;our&#160;formal&#160;model&#160;and&#160;their&#160;realization<br/>in&#160;our&#160;Xen&#160;prototype.&#160;XSLT&#160;is&#160;a&#160;language&#160;for&#160;transforming&#160;one&#160;XML&#160;document&#160;into<br/>another&#160;XML&#160;document&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#74">[3]</a>.&#160;We&#160;assume&#160;that&#160;the&#160;XSLT&#160;interpreter&#160;is&#160;part&#160;of&#160;the&#160;TCB.</p>
<p style="position:absolute;top:869px;left:248px;white-space:nowrap" class="ft2112">The</p>
<p style="position:absolute;top:869px;left:275px;white-space:nowrap" class="ft2127">getCurrentState</p>
<p style="position:absolute;top:868px;left:375px;white-space:nowrap" class="ft2128">()</p>
<p style="position:absolute;top:869px;left:390px;white-space:nowrap" class="ft2112">function&#160;of&#160;the&#160;CM&#160;returns&#160;the&#160;current&#160;state&#160;of&#160;the&#160;physical</p>
<p style="position:absolute;top:887px;left:226px;white-space:nowrap" class="ft2115">machine,&#160;which&#160;includes&#160;the&#160;list&#160;of&#160;hosted&#160;VMs,&#160;their&#160;status&#160;(active,&#160;suspended,&#160;or<br/>hibernating),&#160;VM&#160;ownership&#160;information&#160;(e.g.,&#160;the&#160;virtual&#160;organization&#160;to&#160;which&#160;a&#160;VM<br/>belongs),&#160;the&#160;amount&#160;of&#160;free&#160;memory&#160;available,&#160;etc.&#160;Using&#160;the&#160;result&#160;of&#160;the&#160;function,<br/>a&#160;verifier&#160;can&#160;decide&#160;whether&#160;the&#160;physical&#160;machine&#160;satisfies&#160;the&#160;integrity&#160;requirements<br/>for&#160;performing&#160;certain&#160;actions&#160;(e.g.,&#160;starting&#160;a&#160;new&#160;VM&#160;belonging&#160;to&#160;a&#160;particular&#160;virtual<br/>organization).</p>
<p style="position:absolute;top:995px;left:248px;white-space:nowrap" class="ft2112">The&#160;IM&#160;in&#160;our&#160;Xen&#160;prototype&#160;has&#160;a&#160;storage&#160;integrity&#160;plug-in&#160;(SIP)&#160;for&#160;measuring&#160;var-</p>
<p style="position:absolute;top:1013px;left:226px;white-space:nowrap" class="ft2115">ious&#160;disk&#160;images&#160;and&#160;files.&#160;The&#160;IM&#160;also&#160;has&#160;an&#160;Attestation&#160;&amp;&#160;Sealing&#160;module&#160;(ASM)<br/>that&#160;interfaces&#160;with&#160;the&#160;TPM&#160;for&#160;executing&#160;the&#160;sealing&#160;and&#160;attestation&#160;protocols&#160;(de-<br/>scribed&#160;in&#160;Sections&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#19">3.3.1&#160;</a>and&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#20">3.3.2)&#160;</a>as&#160;well&#160;as&#160;for&#160;invoking&#160;normal&#160;TPM&#160;operations,<br/>such&#160;as</p>
<p style="position:absolute;top:1066px;left:276px;white-space:nowrap" class="ft2127">TPM</p>
<p style="position:absolute;top:1066px;left:309px;white-space:nowrap" class="ft2112">_</p>
<p style="position:absolute;top:1066px;left:317px;white-space:nowrap" class="ft2127">Quote</p>
<p style="position:absolute;top:1066px;left:355px;white-space:nowrap" class="ft2112">.&#160;The&#160;ASM&#160;invokes&#160;normal&#160;TPM&#160;operations&#160;through&#160;the&#160;TPM</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft2118">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 22 -->
<a name="22"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2255{font-size:12px;font-family:Helvetica;color:#000000;}
	.ft2256{font-size:8px;font-family:Helvetica;color:#000000;}
	.ft2257{font-size:9px;font-family:Helvetica;color:#000000;}
	.ft2258{font-size:8px;line-height:9px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page22-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL022.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft2212">20</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft2218">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:561px;left:376px;white-space:nowrap" class="ft2255"><b>Xen&#160;Hypervisor</b></p>
<p style="position:absolute;top:603px;left:320px;white-space:nowrap" class="ft2255"><b>TPM</b></p>
<p style="position:absolute;top:592px;left:363px;white-space:nowrap" class="ft2255"><b>Hard&#160;Disk&#160;</b></p>
<p style="position:absolute;top:606px;left:359px;white-space:nowrap" class="ft2255"><b>Drive&#160;(HDD)</b></p>
<p style="position:absolute;top:600px;left:450px;white-space:nowrap" class="ft2255"><b>Network</b></p>
<p style="position:absolute;top:482px;left:317px;white-space:nowrap" class="ft2256"><b>/dev/tpm</b></p>
<p style="position:absolute;top:501px;left:325px;white-space:nowrap" class="ft2256"><b>TPM</b></p>
<p style="position:absolute;top:511px;left:322px;white-space:nowrap" class="ft2256"><b>Driver</b></p>
<p style="position:absolute;top:447px;left:325px;white-space:nowrap" class="ft2256"><b>TPM&#160;</b></p>
<p style="position:absolute;top:455px;left:316px;white-space:nowrap" class="ft2256"><b>Software&#160;</b></p>
<p style="position:absolute;top:463px;left:323px;white-space:nowrap" class="ft2256"><b>Stack</b></p>
<p style="position:absolute;top:513px;left:371px;white-space:nowrap" class="ft2256"><b>HDD&#160;</b></p>
<p style="position:absolute;top:522px;left:369px;white-space:nowrap" class="ft2256"><b>Driver</b></p>
<p style="position:absolute;top:500px;left:384px;white-space:nowrap" class="ft2256"><b>DM&#160;Crypt</b></p>
<p style="position:absolute;top:482px;left:365px;white-space:nowrap" class="ft2256"><b>/dev/sda</b></p>
<p style="position:absolute;top:513px;left:448px;white-space:nowrap" class="ft2256"><b>Ethernet</b></p>
<p style="position:absolute;top:522px;left:453px;white-space:nowrap" class="ft2256"><b>Driver</b></p>
<p style="position:absolute;top:511px;left:493px;white-space:nowrap" class="ft2256"><b>virtual&#160;</b></p>
<p style="position:absolute;top:519px;left:489px;white-space:nowrap" class="ft2256"><b>network&#160;</b></p>
<p style="position:absolute;top:527px;left:492px;white-space:nowrap" class="ft2256"><b>device&#160;</b></p>
<p style="position:absolute;top:536px;left:490px;white-space:nowrap" class="ft2256"><b>backend</b></p>
<p style="position:absolute;top:500px;left:472px;white-space:nowrap" class="ft2256"><b>Bridge</b></p>
<p style="position:absolute;top:482px;left:456px;white-space:nowrap" class="ft2256"><b>brctl</b></p>
<p style="position:absolute;top:482px;left:498px;white-space:nowrap" class="ft2256"><b>eth0</b></p>
<p style="position:absolute;top:316px;left:388px;white-space:nowrap" class="ft2256"><b>Compartment</b></p>
<p style="position:absolute;top:326px;left:397px;white-space:nowrap" class="ft2256"><b>Manager</b></p>
<p style="position:absolute;top:352px;left:344px;white-space:nowrap" class="ft2256"><b>Integrity</b></p>
<p style="position:absolute;top:362px;left:344px;white-space:nowrap" class="ft2256"><b>Manager</b></p>
<p style="position:absolute;top:352px;left:448px;white-space:nowrap" class="ft2256"><b>Secure&#160;Virtual</b></p>
<p style="position:absolute;top:362px;left:446px;white-space:nowrap" class="ft2256"><b>Device&#160;Manager</b></p>
<p style="position:absolute;top:376px;left:431px;white-space:nowrap" class="ft2256"><b>virtual</b></p>
<p style="position:absolute;top:385px;left:435px;white-space:nowrap" class="ft2256"><b>disk</b></p>
<p style="position:absolute;top:376px;left:497px;white-space:nowrap" class="ft2256"><b>virtual</b></p>
<p style="position:absolute;top:385px;left:502px;white-space:nowrap" class="ft2256"><b>NIC</b></p>
<p style="position:absolute;top:380px;left:318px;white-space:nowrap" class="ft2256"><b>Attestation</b></p>
<p style="position:absolute;top:390px;left:321px;white-space:nowrap" class="ft2256"><b>&amp;&#160;Sealing</b></p>
<p style="position:absolute;top:399px;left:325px;white-space:nowrap" class="ft2256"><b>Module</b></p>
<p style="position:absolute;top:380px;left:372px;white-space:nowrap" class="ft2256"><b>Storage</b></p>
<p style="position:absolute;top:390px;left:370px;white-space:nowrap" class="ft2256"><b>Integrity</b></p>
<p style="position:absolute;top:399px;left:373px;white-space:nowrap" class="ft2256"><b>Plug-in</b></p>
<p style="position:absolute;top:294px;left:406px;white-space:nowrap" class="ft2257"><b>Dom0</b></p>
<p style="position:absolute;top:365px;left:275px;white-space:nowrap" class="ft2258"><b>User<br/>Space</b></p>
<p style="position:absolute;top:455px;left:275px;white-space:nowrap" class="ft2258"><b>Library<br/>Space</b></p>
<p style="position:absolute;top:496px;left:275px;white-space:nowrap" class="ft2258"><b>Kernel<br/>Space</b></p>
<p style="position:absolute;top:511px;left:409px;white-space:nowrap" class="ft2256"><b>virtual&#160;</b></p>
<p style="position:absolute;top:519px;left:412px;white-space:nowrap" class="ft2256"><b>block</b></p>
<p style="position:absolute;top:527px;left:409px;white-space:nowrap" class="ft2256"><b>device&#160;</b></p>
<p style="position:absolute;top:536px;left:406px;white-space:nowrap" class="ft2256"><b>backend</b></p>
<p style="position:absolute;top:666px;left:274px;white-space:nowrap" class="ft2212">Figure&#160;3.6:&#160;Realization&#160;using&#160;Xen&#160;and&#160;Linux</p>
<p style="position:absolute;top:876px;left:280px;white-space:nowrap" class="ft2217"><b>Model</b></p>
<p style="position:absolute;top:876px;left:376px;white-space:nowrap" class="ft2217"><b>Xen-based&#160;Prototype</b></p>
<p style="position:absolute;top:895px;left:259px;white-space:nowrap" class="ft2212">Projection</p>
<p style="position:absolute;top:894px;left:339px;white-space:nowrap" class="ft2227">p</p>
<p style="position:absolute;top:894px;left:346px;white-space:nowrap" class="ft2228">()</p>
<p style="position:absolute;top:895px;left:376px;white-space:nowrap" class="ft2212">component&#160;measurement&#160;plug-in</p>
<p style="position:absolute;top:913px;left:265px;white-space:nowrap" class="ft2212">Predicate</p>
<p style="position:absolute;top:912px;left:339px;white-space:nowrap" class="ft2228">Π</p>
<p style="position:absolute;top:913px;left:376px;white-space:nowrap" class="ft2212">XSLT&#160;stylesheet</p>
<p style="position:absolute;top:931px;left:242px;white-space:nowrap" class="ft2212">Access&#160;Filter</p>
<p style="position:absolute;top:931px;left:376px;white-space:nowrap" class="ft2212">XSLT&#160;stylesheet</p>
<p style="position:absolute;top:978px;left:282px;white-space:nowrap" class="ft2212">Table&#160;3.1:&#160;From&#160;model&#160;to&#160;implementation</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft2218">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 23 -->
<a name="23"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page23-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL023.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft2312">CHAPTER&#160;3.&#160;COMPLIANCE&#160;PROOFS&#160;FOR&#160;XEN</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft2312">21</p>
<p style="position:absolute;top:193px;left:226px;white-space:nowrap" class="ft2315">Software&#160;Stack&#160;(TSS)&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[71]</a>,&#160;which&#160;is&#160;the&#160;standard&#160;API&#160;for&#160;accessing&#160;the&#160;functions&#160;of<br/>the&#160;TPM.</p>
<p style="position:absolute;top:229px;left:248px;white-space:nowrap" class="ft2312">The&#160;SVDM&#160;is&#160;responsible&#160;for&#160;managing&#160;virtual&#160;devices&#160;such&#160;as&#160;virtual&#160;hard&#160;disks,</p>
<p style="position:absolute;top:247px;left:226px;white-space:nowrap" class="ft2315">virtual&#160;block&#160;devices,&#160;virtual&#160;network&#160;devices,&#160;and&#160;virtual&#160;TPMs.&#160;The&#160;service&#160;offered<br/>by&#160;the&#160;SVDM&#160;is&#160;realized&#160;through&#160;multiple&#160;specialized&#160;low-level&#160;component&#160;plug-in<br/>modules,&#160;one&#160;for&#160;each&#160;virtual&#160;device.&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#22">3.6&#160;</a>shows&#160;two&#160;plug-ins&#160;in&#160;our&#160;Xen&#160;pro-<br/>totype.&#160;One&#160;is&#160;for&#160;managing&#160;the&#160;virtual&#160;(encrypted)&#160;hard&#160;disk&#160;and&#160;the&#160;other&#160;one&#160;is&#160;for<br/>managing&#160;the&#160;virtual&#160;network&#160;interface&#160;card&#160;(NIC).</p>
<p style="position:absolute;top:337px;left:248px;white-space:nowrap" class="ft2312">In&#160;Dom0,&#160;secure&#160;device&#160;virtualization&#160;is&#160;implemented&#160;in&#160;the&#160;kernel&#160;space.&#160;Tasks</p>
<p style="position:absolute;top:355px;left:226px;white-space:nowrap" class="ft2315">such&#160;as&#160;configuring&#160;virtual&#160;devices&#160;are&#160;done&#160;through&#160;the&#160;SVDM&#160;in&#160;the&#160;user&#160;(or&#160;applica-<br/>tion)&#160;space.&#160;The&#160;SVDM&#160;manages&#160;the&#160;security&#160;properties&#160;of&#160;devices.&#160;For&#160;example,&#160;a&#160;se-<br/>cure&#160;hard&#160;disk&#160;is&#160;implemented&#160;by&#160;means&#160;of&#160;the&#160;<i>DM&#160;Crypt&#160;</i>loopback&#160;device.&#160;Similarly,<br/>network&#160;virtualization&#160;is&#160;done&#160;by&#160;providing&#160;virtual&#160;NICs&#160;for&#160;the&#160;VMs&#160;and&#160;<i>bridging<br/></i>these&#160;virtual&#160;NICs&#160;to&#160;the&#160;physical&#160;NIC.&#160;Security&#160;for&#160;networks&#160;has&#160;two&#160;aspects.&#160;Topol-<br/>ogy&#160;constraints&#160;define&#160;which&#160;VM&#160;is&#160;allowed&#160;to&#160;connect&#160;to&#160;which&#160;sub-network(s).&#160;In<br/>addition,&#160;confidentiality&#160;requirements&#160;dictate&#160;which&#160;connections&#160;need&#160;to&#160;be&#160;encrypted.</p>
<p style="position:absolute;top:480px;left:248px;white-space:nowrap" class="ft2312">Secure&#160;management&#160;of&#160;virtual&#160;devices&#160;is&#160;a&#160;complex&#160;task.&#160;For&#160;example,&#160;there&#160;are</p>
<p style="position:absolute;top:498px;left:226px;white-space:nowrap" class="ft2315">multiple&#160;steps&#160;involved&#160;in&#160;starting&#160;a&#160;virtual&#160;hard-disk&#160;drive.&#160;First,&#160;a&#160;policy-based&#160;check<br/>of&#160;the&#160;state&#160;of&#160;the&#160;physical&#160;machine&#160;is&#160;done&#160;based&#160;on&#160;the&#160;results&#160;of</p>
<p style="position:absolute;top:516px;left:630px;white-space:nowrap" class="ft2327">getCurrentState</p>
<p style="position:absolute;top:515px;left:730px;white-space:nowrap" class="ft2328">()</p>
<p style="position:absolute;top:534px;left:226px;white-space:nowrap" class="ft2315">function.&#160;Depending&#160;on&#160;the&#160;logic&#160;implemented&#160;by&#160;the&#160;corresponding&#160;plug-in,&#160;that<br/>check&#160;may&#160;include&#160;verifying&#160;the&#160;measurements&#160;of&#160;the&#160;hypervisor,&#160;binary&#160;disk,&#160;and&#160;the<br/>Dom0&#160;image.&#160;Then,&#160;the&#160;virtual&#160;hard-disk&#160;is&#160;attached&#160;with&#160;credentials&#160;and&#160;connected<br/>to&#160;a&#160;loop&#160;device&#160;(/dev/loop).&#160;The&#160;virtual&#160;hard-disk&#160;may&#160;be&#160;encrypted,&#160;for&#160;example,<br/>with&#160;a&#160;sealing&#160;key&#160;that&#160;is&#160;made&#160;available&#160;only&#160;if&#160;the&#160;platform&#160;is&#160;in&#160;a&#160;certain&#160;state.&#160;The<br/>decryption&#160;of&#160;the&#160;virtual&#160;hard-disk&#160;image&#160;is&#160;done&#160;using&#160;Linux&#160;hard-disk&#160;encryption.<br/>After&#160;decryption,&#160;the&#160;device&#160;file&#160;that&#160;gives&#160;access&#160;to&#160;the&#160;decrypted&#160;image&#160;is&#160;connected<br/>to&#160;the&#160;front-end.&#160;Similar&#160;policy-based&#160;checks&#160;may&#160;be&#160;done&#160;when&#160;starting&#160;other&#160;virtual<br/>devices.&#160;For&#160;example,&#160;before&#160;starting&#160;a&#160;virtual&#160;network&#160;device,&#160;policies&#160;may&#160;stipulate<br/>that&#160;the&#160;VM&#160;must&#160;be&#160;in&#160;some&#160;acceptable&#160;state&#160;and&#160;outside&#160;firewalls&#160;must&#160;be&#160;configured<br/>correctly.</p>
<p style="position:absolute;top:777px;left:226px;white-space:nowrap" class="ft2320"><b>3.5</b></p>
<p style="position:absolute;top:777px;left:274px;white-space:nowrap" class="ft2320"><b>Use&#160;Cases</b></p>
<p style="position:absolute;top:815px;left:226px;white-space:nowrap" class="ft2330">In&#160;this&#160;section,&#160;we&#160;describe&#160;a&#160;few&#160;examples&#160;of&#160;how&#160;the&#160;components&#160;introduced&#160;in&#160;Sec-<br/>tion&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#21">3.4&#160;</a>interact&#160;for&#160;integrity&#160;protection,&#160;enforcement,&#160;and&#160;verification&#160;purposes.&#160;We<br/>assume&#160;that&#160;the&#160;core&#160;TCB&#160;(including&#160;Xen&#160;and&#160;Dom0&#160;Linux)&#160;has&#160;been&#160;measured&#160;at<br/>start-up&#160;time.&#160;Additional&#160;services&#160;may&#160;need&#160;to&#160;be&#160;measured&#160;based&#160;on&#160;policy.&#160;The&#160;mea-<br/>surement&#160;can&#160;either&#160;be&#160;done&#160;by&#160;a&#160;trusted&#160;boot&#160;loader&#160;such&#160;as&#160;TrustedGRUB&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#74">[2]&#160;</a>(which<br/>measures&#160;the&#160;entire&#160;boot&#160;image)&#160;or&#160;by&#160;a&#160;more&#160;fine-grained&#160;approach&#160;such&#160;as&#160;Sailer&#160;<i>et<br/>al</i>.’s&#160;IMA&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[65]</a>.</p>
<p style="position:absolute;top:982px;left:226px;white-space:nowrap" class="ft2344"><b>3.5.1</b></p>
<p style="position:absolute;top:982px;left:280px;white-space:nowrap" class="ft2344"><b>TPM-based&#160;Attestation&#160;on&#160;a&#160;VM&#160;Disk</b></p>
<p style="position:absolute;top:1012px;left:226px;white-space:nowrap" class="ft2315">Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#24">3.7&#160;</a>shows&#160;the&#160;component&#160;interactions&#160;for&#160;attesting&#160;the&#160;current&#160;state&#160;of&#160;the&#160;TCB<br/>and&#160;the&#160;status&#160;of&#160;a&#160;VM’s&#160;disk&#160;image.&#160;The&#160;user/verifier&#160;interacts&#160;with&#160;the&#160;CM&#160;through<br/>the</p>
<p style="position:absolute;top:1047px;left:249px;white-space:nowrap" class="ft2327">attestationRequest</p>
<p style="position:absolute;top:1048px;left:371px;white-space:nowrap" class="ft2312">call&#160;with&#160;an&#160;<i>attestation&#160;descriptor&#160;</i>and&#160;<i>user&#160;credential&#160;</i>as&#160;pa-</p>
<p style="position:absolute;top:1065px;left:226px;white-space:nowrap" class="ft2312">rameters&#160;(step&#160;1).&#160;The&#160;attestation&#160;descriptor&#160;is&#160;an&#160;XML&#160;structure&#160;that&#160;describes&#160;what</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft2318">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 24 -->
<a name="24"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2459{font-size:15px;font-family:Courier;color:#000000;}
-->
</style>
<div id="page24-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL024.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft2412">22</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft2418">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:634px;left:262px;white-space:nowrap" class="ft2412">Figure&#160;3.7:&#160;TPM-based&#160;attestation&#160;on&#160;a&#160;VM&#160;disk</p>
<p style="position:absolute;top:682px;left:150px;white-space:nowrap" class="ft2415">aspect&#160;of&#160;the&#160;system’s&#160;integrity&#160;state&#160;the&#160;verifier&#160;wants&#160;attested.&#160;In&#160;other&#160;words,&#160;the<br/>attestation&#160;descriptor&#160;is&#160;how&#160;the&#160;verifier&#160;chooses&#160;the&#160;log&#160;projection&#160;function&#160;suitable<br/>for&#160;its&#160;purpose.&#160;As&#160;described&#160;before,&#160;projection&#160;functions&#160;are&#160;realized&#160;by&#160;a&#160;set&#160;of&#160;com-<br/>ponent&#160;plug-in&#160;modules.&#160;Some&#160;of&#160;these&#160;plug-in&#160;modules&#160;are&#160;<i>measurement&#160;plug-ins</i>,<br/>which&#160;not&#160;only&#160;return&#160;the&#160;relevant&#160;integrity&#160;states&#160;of&#160;the&#160;components&#160;but&#160;are&#160;also&#160;the<br/>ones&#160;measuring&#160;their&#160;integrity&#160;states&#160;in&#160;the&#160;first&#160;place.&#160;The&#160;attestation&#160;descriptor&#160;con-<br/>tains&#160;one&#160;or&#160;more&#160;<i>measurement&#160;descriptors</i>.&#160;Based&#160;on&#160;the&#160;measurement&#160;descriptors,<br/>the&#160;IM&#160;knows&#160;the&#160;exact&#160;set&#160;of&#160;measurement&#160;plug-ins&#160;to&#160;invoke.</p>
<p style="position:absolute;top:825px;left:172px;white-space:nowrap" class="ft2412">Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#25">3.8&#160;</a>shows&#160;an&#160;example&#160;attestation&#160;descriptor&#160;as&#160;a&#160;XML&#160;structure.&#160;It&#160;contains</p>
<p style="position:absolute;top:843px;left:150px;white-space:nowrap" class="ft2412">an</p>
<p style="position:absolute;top:844px;left:170px;white-space:nowrap" class="ft2459">&lt;attestation&gt;</p>
<p style="position:absolute;top:843px;left:292px;white-space:nowrap" class="ft2412">section,&#160;which&#160;defines&#160;the&#160;type&#160;of&#160;attestation&#160;(</p>
<p style="position:absolute;top:844px;left:580px;white-space:nowrap" class="ft2459">tpm-based</p>
<p style="position:absolute;top:843px;left:661px;white-space:nowrap" class="ft2412">)</p>
<p style="position:absolute;top:861px;left:150px;white-space:nowrap" class="ft2412">and&#160;the&#160;parameters&#160;needed&#160;for&#160;attestation&#160;(the&#160;TPM&#160;Attestation&#160;Identity&#160;Key&#160;or</p>
<p style="position:absolute;top:862px;left:638px;white-space:nowrap" class="ft2459">AIK</p>
<p style="position:absolute;top:879px;left:150px;white-space:nowrap" class="ft2412">and&#160;a</p>
<p style="position:absolute;top:880px;left:186px;white-space:nowrap" class="ft2459">challenge</p>
<p style="position:absolute;top:879px;left:267px;white-space:nowrap" class="ft2412">).&#160;Nested&#160;in&#160;the&#160;attestation&#160;descriptor&#160;is&#160;a&#160;measurement&#160;descriptor,</p>
<p style="position:absolute;top:897px;left:150px;white-space:nowrap" class="ft2412">which&#160;specifies&#160;a&#160;measurement&#160;target&#160;(</p>
<p style="position:absolute;top:898px;left:384px;white-space:nowrap" class="ft2459">measureTarget</p>
<p style="position:absolute;top:897px;left:501px;white-space:nowrap" class="ft2412">)&#160;and&#160;a&#160;destination&#160;(</p>
<p style="position:absolute;top:898px;left:621px;white-space:nowrap" class="ft2459">dest</p>
<p style="position:absolute;top:897px;left:657px;white-space:nowrap" class="ft2412">).</p>
<p style="position:absolute;top:915px;left:150px;white-space:nowrap" class="ft2415">The&#160;target&#160;indicates&#160;what&#160;is&#160;to&#160;be&#160;measured&#160;(in&#160;this&#160;case,&#160;a&#160;VM&#160;disk&#160;image),&#160;whereas<br/>the&#160;destination&#160;indicates&#160;where&#160;the&#160;result&#160;should&#160;be&#160;stored&#160;(in&#160;this&#160;case,&#160;the&#160;TPM’s&#160;PCR<br/>number&#160;16).&#160;The</p>
<p style="position:absolute;top:952px;left:253px;white-space:nowrap" class="ft2459">&lt;attestTarget&gt;</p>
<p style="position:absolute;top:951px;left:382px;white-space:nowrap" class="ft2412">defines&#160;the&#160;scope&#160;of&#160;the&#160;requested&#160;attestation&#160;(in</p>
<p style="position:absolute;top:969px;left:150px;white-space:nowrap" class="ft2412">this&#160;case,&#160;all&#160;PCRs).</p>
<p style="position:absolute;top:987px;left:172px;white-space:nowrap" class="ft2412">Based&#160;on&#160;the&#160;user&#160;credential&#160;supplied,&#160;the&#160;CM&#160;checks&#160;whether&#160;the&#160;verifier&#160;has&#160;the</p>
<p style="position:absolute;top:1005px;left:150px;white-space:nowrap" class="ft2415">right&#160;to&#160;request&#160;attestation&#160;of&#160;the&#160;system&#160;sub-states&#160;indicated&#160;by&#160;the&#160;attestation&#160;descrip-<br/>tor.&#160;The&#160;check&#160;is&#160;essentially&#160;a&#160;way&#160;of&#160;determining&#160;whether&#160;the&#160;requested&#160;projection&#160;is<br/>a&#160;projection&#160;that&#160;conforms&#160;to&#160;the&#160;access&#160;restriction&#160;specification;&#160;hence,&#160;it&#160;is&#160;useful&#160;in<br/>enforcing&#160;access&#160;restriction.&#160;If&#160;the&#160;check&#160;reveals&#160;that&#160;the&#160;verifier&#160;wants&#160;to&#160;have&#160;more</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft2418">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 25 -->
<a name="25"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2560{font-size:13px;font-family:Courier;color:#000000;}
-->
</style>
<div id="page25-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL025.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft2512">CHAPTER&#160;3.&#160;COMPLIANCE&#160;PROOFS&#160;FOR&#160;XEN</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft2512">23</p>
<p style="position:absolute;top:194px;left:290px;white-space:nowrap" class="ft2560">&lt;attestation-desc&gt;</p>
<p style="position:absolute;top:211px;left:307px;white-space:nowrap" class="ft2560">&lt;attestation&#160;type=&#34;tpm-based&#34;</p>
<p style="position:absolute;top:227px;left:347px;white-space:nowrap" class="ft2560">challenge=&#34;0xaded...&#34;</p>
<p style="position:absolute;top:243px;left:347px;white-space:nowrap" class="ft2560">aik=&#34;0xaada3..&#34;&gt;</p>
<p style="position:absolute;top:260px;left:323px;white-space:nowrap" class="ft2560">&lt;measurement-desc&#160;type=&#34;tpm&#34;&gt;</p>
<p style="position:absolute;top:276px;left:355px;white-space:nowrap" class="ft2560">&lt;measureTarget&#160;name=&#34;disk:/dev/sdb1&#34;</p>
<p style="position:absolute;top:293px;left:379px;white-space:nowrap" class="ft2560">dest=&#34;PCR16&#34;/&gt;</p>
<p style="position:absolute;top:309px;left:323px;white-space:nowrap" class="ft2560">&lt;/measurement-desc&gt;</p>
<p style="position:absolute;top:326px;left:323px;white-space:nowrap" class="ft2560">&lt;attestTarget&#160;name=&#34;ALLPCRS&#34;/&gt;</p>
<p style="position:absolute;top:342px;left:307px;white-space:nowrap" class="ft2560">&lt;/attestation&gt;</p>
<p style="position:absolute;top:359px;left:290px;white-space:nowrap" class="ft2560">&lt;/attestation-desc&gt;</p>
<p style="position:absolute;top:406px;left:358px;white-space:nowrap" class="ft2512">Figure&#160;3.8:&#160;Attestation&#160;descriptor&#160;in&#160;XML</p>
<p style="position:absolute;top:454px;left:226px;white-space:nowrap" class="ft2515">attested&#160;than&#160;what&#160;he/she&#160;is&#160;allowed&#160;to,&#160;then&#160;the&#160;entire&#160;attestation&#160;request&#160;is&#160;denied.<br/>Otherwise,&#160;the&#160;CM&#160;forwards&#160;the&#160;request&#160;to&#160;the&#160;IM&#160;(step&#160;1.1).</p>
<p style="position:absolute;top:489px;left:248px;white-space:nowrap" class="ft2512">The&#160;IM&#160;extracts&#160;the&#160;measurement&#160;descriptor(s)&#160;from&#160;the&#160;attestation&#160;descriptor&#160;and</p>
<p style="position:absolute;top:507px;left:226px;white-space:nowrap" class="ft2515">delegates&#160;the&#160;measurement(s)&#160;to&#160;the&#160;appropriate&#160;plug-in(s).&#160;In&#160;our&#160;example,&#160;the&#160;IM<br/>invokes&#160;the</p>
<p style="position:absolute;top:525px;left:298px;white-space:nowrap" class="ft2527">measurevHD</p>
<p style="position:absolute;top:525px;left:382px;white-space:nowrap" class="ft2512">function&#160;at&#160;the&#160;SIP&#160;passing&#160;the&#160;measurement&#160;descriptor&#160;as&#160;a</p>
<p style="position:absolute;top:543px;left:226px;white-space:nowrap" class="ft2515">parameter&#160;(step&#160;1.1.1).&#160;The&#160;plug-in&#160;completes&#160;the&#160;requested&#160;measurement&#160;and&#160;returns<br/>the&#160;measurement&#160;result&#160;back&#160;to&#160;the&#160;IM&#160;(step&#160;1.1.2).&#160;Although&#160;step&#160;1.1.2&#160;might&#160;look&#160;like<br/>an&#160;unnecessary&#160;extra&#160;step,&#160;the&#160;indirection&#160;via&#160;the&#160;IM&#160;allows&#160;the&#160;measurement&#160;plug-ins<br/>to&#160;be&#160;written&#160;independent&#160;of&#160;the&#160;TPM&#160;or&#160;similar&#160;future&#160;devices&#160;that&#160;are&#160;indicated&#160;as</p>
<p style="position:absolute;top:616px;left:226px;white-space:nowrap" class="ft2559">dest</p>
<p style="position:absolute;top:615px;left:262px;white-space:nowrap" class="ft2512">.</p>
<p style="position:absolute;top:633px;left:248px;white-space:nowrap" class="ft2512">The&#160;IM&#160;invokes&#160;the</p>
<p style="position:absolute;top:632px;left:371px;white-space:nowrap" class="ft2527">wrToTPM</p>
<p style="position:absolute;top:633px;left:440px;white-space:nowrap" class="ft2512">function&#160;at&#160;the&#160;ASM&#160;with&#160;the&#160;challenge,&#160;the</p>
<p style="position:absolute;top:634px;left:711px;white-space:nowrap" class="ft2559">AIK</p>
<p style="position:absolute;top:633px;left:738px;white-space:nowrap" class="ft2512">,</p>
<p style="position:absolute;top:651px;left:226px;white-space:nowrap" class="ft2515">the&#160;measurement&#160;result,&#160;and&#160;the&#160;destination&#160;PCR&#160;(step&#160;1.1.3).&#160;The&#160;actual&#160;writing&#160;of&#160;the<br/>result&#160;into&#160;the&#160;PCR&#160;happens&#160;by&#160;the</p>
<p style="position:absolute;top:668px;left:441px;white-space:nowrap" class="ft2527">TPM</p>
<p style="position:absolute;top:669px;left:474px;white-space:nowrap" class="ft2512">_</p>
<p style="position:absolute;top:668px;left:481px;white-space:nowrap" class="ft2527">extend</p>
<p style="position:absolute;top:669px;left:526px;white-space:nowrap" class="ft2512">operation&#160;(step&#160;1.1.3.1).&#160;Thereafter,</p>
<p style="position:absolute;top:687px;left:226px;white-space:nowrap" class="ft2512">a</p>
<p style="position:absolute;top:686px;left:237px;white-space:nowrap" class="ft2527">TPM</p>
<p style="position:absolute;top:687px;left:270px;white-space:nowrap" class="ft2512">_</p>
<p style="position:absolute;top:686px;left:277px;white-space:nowrap" class="ft2527">Quote</p>
<p style="position:absolute;top:687px;left:320px;white-space:nowrap" class="ft2512">gets&#160;created&#160;and&#160;returned&#160;to&#160;the&#160;ASM&#160;(steps&#160;1.1.3.2&#160;and&#160;1.1.3.3).&#160;The</p>
<p style="position:absolute;top:705px;left:226px;white-space:nowrap" class="ft2512">ASM&#160;wraps&#160;the</p>
<p style="position:absolute;top:704px;left:322px;white-space:nowrap" class="ft2527">TPM</p>
<p style="position:absolute;top:705px;left:355px;white-space:nowrap" class="ft2512">_</p>
<p style="position:absolute;top:704px;left:362px;white-space:nowrap" class="ft2527">Quote</p>
<p style="position:absolute;top:705px;left:404px;white-space:nowrap" class="ft2512">into&#160;an</p>
<p style="position:absolute;top:704px;left:448px;white-space:nowrap" class="ft2527">attestationResponse</p>
<p style="position:absolute;top:705px;left:576px;white-space:nowrap" class="ft2512">and&#160;returns&#160;it&#160;to&#160;the&#160;IM.&#160;The</p>
<p style="position:absolute;top:722px;left:226px;white-space:nowrap" class="ft2527">attestationResponse</p>
<p style="position:absolute;top:723px;left:355px;white-space:nowrap" class="ft2512">includes&#160;not&#160;only&#160;the</p>
<p style="position:absolute;top:722px;left:484px;white-space:nowrap" class="ft2527">TPM</p>
<p style="position:absolute;top:723px;left:517px;white-space:nowrap" class="ft2512">_</p>
<p style="position:absolute;top:722px;left:524px;white-space:nowrap" class="ft2527">Quote</p>
<p style="position:absolute;top:723px;left:566px;white-space:nowrap" class="ft2512">but&#160;also&#160;the&#160;relevant&#160;log&#160;files.</p>
<p style="position:absolute;top:741px;left:226px;white-space:nowrap" class="ft2512">The&#160;IM&#160;returns&#160;the</p>
<p style="position:absolute;top:740px;left:342px;white-space:nowrap" class="ft2527">attestationResponse</p>
<p style="position:absolute;top:741px;left:471px;white-space:nowrap" class="ft2512">to&#160;the&#160;CM&#160;(step&#160;1.2),&#160;which&#160;forwards&#160;it&#160;to&#160;the</p>
<p style="position:absolute;top:759px;left:226px;white-space:nowrap" class="ft2512">verifier&#160;(step&#160;2).</p>
<p style="position:absolute;top:776px;left:248px;white-space:nowrap" class="ft2512">A&#160;verifier&#160;can&#160;check&#160;the&#160;attestation&#160;result&#160;by&#160;recomputing&#160;a&#160;hash&#160;over&#160;the&#160;attestation</p>
<p style="position:absolute;top:794px;left:226px;white-space:nowrap" class="ft2512">targets&#160;(i.e.,&#160;the&#160;relevant&#160;log&#160;files)&#160;specified&#160;in&#160;the</p>
<p style="position:absolute;top:794px;left:524px;white-space:nowrap" class="ft2527">attestationResponse</p>
<p style="position:absolute;top:794px;left:652px;white-space:nowrap" class="ft2512">and&#160;comparing</p>
<p style="position:absolute;top:812px;left:226px;white-space:nowrap" class="ft2512">the&#160;resulting&#160;hash&#160;with&#160;the&#160;hash&#160;in&#160;the&#160;PCR&#160;from&#160;the</p>
<p style="position:absolute;top:812px;left:543px;white-space:nowrap" class="ft2527">TPM</p>
<p style="position:absolute;top:812px;left:576px;white-space:nowrap" class="ft2512">_</p>
<p style="position:absolute;top:812px;left:583px;white-space:nowrap" class="ft2527">Quote</p>
<p style="position:absolute;top:812px;left:621px;white-space:nowrap" class="ft2512">.</p>
<p style="position:absolute;top:830px;left:248px;white-space:nowrap" class="ft2512">The&#160;PCR&#160;in&#160;which&#160;the&#160;measurement&#160;result&#160;is&#160;stored&#160;will&#160;be&#160;reset&#160;after&#160;the&#160;attestation</p>
<p style="position:absolute;top:848px;left:226px;white-space:nowrap" class="ft2515">process&#160;has&#160;finished.&#160;Therefore,&#160;our&#160;prototype&#160;requires&#160;a&#160;TCG&#160;1.2&#160;compliant&#160;TPM,&#160;and<br/>the</p>
<p style="position:absolute;top:867px;left:248px;white-space:nowrap" class="ft2559">dest</p>
<p style="position:absolute;top:866px;left:288px;white-space:nowrap" class="ft2512">PCR&#160;has&#160;to&#160;be</p>
<p style="position:absolute;top:865px;left:377px;white-space:nowrap" class="ft2528">16</p>
<p style="position:absolute;top:866px;left:395px;white-space:nowrap" class="ft2512">or&#160;higher.</p>
<p style="position:absolute;top:925px;left:226px;white-space:nowrap" class="ft2544"><b>3.5.2</b></p>
<p style="position:absolute;top:925px;left:280px;white-space:nowrap" class="ft2544"><b>(Re-)Starting&#160;a&#160;VM&#160;with&#160;TPM-based&#160;Sealing</b></p>
<p style="position:absolute;top:955px;left:226px;white-space:nowrap" class="ft2515">Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#26">3.9&#160;</a>shows&#160;the&#160;component&#160;interactions&#160;for&#160;(re-)starting&#160;a&#160;VM&#160;with&#160;a&#160;sealed&#160;disk<br/>image.&#160;In&#160;this&#160;use&#160;case,&#160;we&#160;show&#160;how&#160;to&#160;enforce&#160;a&#160;policy&#160;that&#160;specifies&#160;that&#160;the&#160;key&#160;for<br/>decrypting&#160;the&#160;disk&#160;image&#160;be&#160;revealed&#160;only&#160;after&#160;measuring&#160;the&#160;disk&#160;image&#160;and&#160;only&#160;if<br/>the&#160;measurement&#160;value&#160;written&#160;into&#160;a&#160;specified&#160;PCR&#160;matches&#160;the&#160;value&#160;against&#160;which<br/>the&#160;key&#160;was&#160;sealed.</p>
<p style="position:absolute;top:1045px;left:248px;white-space:nowrap" class="ft2512">The&#160;user&#160;interacts&#160;with&#160;the&#160;CM&#160;through&#160;the</p>
<p style="position:absolute;top:1044px;left:531px;white-space:nowrap" class="ft2527">startVM</p>
<p style="position:absolute;top:1045px;left:588px;white-space:nowrap" class="ft2512">call&#160;to&#160;(re-)start&#160;the&#160;VM</p>
<p style="position:absolute;top:1062px;left:226px;white-space:nowrap" class="ft2512">(step&#160;1).&#160;After&#160;determining&#160;that&#160;the&#160;disk&#160;image&#160;has&#160;to&#160;be&#160;first&#160;decrypted&#160;through&#160;unseal-</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft2518">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 26 -->
<a name="26"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page26-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL026.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft2612">24</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft2618">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:599px;left:245px;white-space:nowrap" class="ft2612">Figure&#160;3.9:&#160;Creation&#160;of&#160;a&#160;VM&#160;with&#160;TPM-based&#160;sealing</p>
<p style="position:absolute;top:647px;left:150px;white-space:nowrap" class="ft2615">ing,&#160;the&#160;CM&#160;obtains&#160;the&#160;<i>sealing&#160;descriptor&#160;</i>that&#160;was&#160;given&#160;to&#160;it&#160;at&#160;the&#160;time&#160;of&#160;sealing.<br/>Like&#160;the&#160;attestation&#160;descriptor,&#160;the&#160;sealing&#160;descriptor&#160;also&#160;contains&#160;one&#160;or&#160;more&#160;mea-<br/>surement&#160;descriptors,&#160;which&#160;are&#160;used&#160;to&#160;let&#160;the&#160;IM&#160;know&#160;the&#160;exact&#160;set&#160;of&#160;measurement<br/>plug-in&#160;modules&#160;to&#160;invoke.</p>
<p style="position:absolute;top:719px;left:172px;white-space:nowrap" class="ft2612">Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#27">3.10&#160;</a>shows&#160;an&#160;example&#160;sealing&#160;descriptor&#160;as&#160;an&#160;XML&#160;structure.&#160;It&#160;contains</p>
<p style="position:absolute;top:737px;left:150px;white-space:nowrap" class="ft2612">an</p>
<p style="position:absolute;top:738px;left:168px;white-space:nowrap" class="ft2659">&lt;sealing&gt;</p>
<p style="position:absolute;top:737px;left:253px;white-space:nowrap" class="ft2612">section,&#160;which&#160;defines&#160;the&#160;type&#160;of&#160;sealing&#160;(</p>
<p style="position:absolute;top:738px;left:509px;white-space:nowrap" class="ft2659">tpm-based</p>
<p style="position:absolute;top:737px;left:590px;white-space:nowrap" class="ft2612">)&#160;and&#160;the&#160;pa-</p>
<p style="position:absolute;top:755px;left:150px;white-space:nowrap" class="ft2615">rameters&#160;needed&#160;for&#160;unsealing&#160;(the&#160;identifier&#160;of&#160;the&#160;key&#160;protected&#160;by&#160;the&#160;TPM).&#160;Nested<br/>in&#160;the&#160;sealing&#160;descriptor&#160;there&#160;is&#160;a&#160;measurement&#160;descriptor,&#160;which&#160;specifies&#160;a&#160;measure-<br/>ment&#160;target&#160;(</p>
<p style="position:absolute;top:792px;left:227px;white-space:nowrap" class="ft2659">measureTarget</p>
<p style="position:absolute;top:791px;left:344px;white-space:nowrap" class="ft2612">)&#160;and&#160;a&#160;destination&#160;(</p>
<p style="position:absolute;top:792px;left:463px;white-space:nowrap" class="ft2659">dest</p>
<p style="position:absolute;top:791px;left:499px;white-space:nowrap" class="ft2612">).&#160;The&#160;target&#160;indicates&#160;what</p>
<p style="position:absolute;top:809px;left:150px;white-space:nowrap" class="ft2615">is&#160;to&#160;be&#160;measured&#160;(in&#160;this&#160;case,&#160;a&#160;VM&#160;disk&#160;image),&#160;whereas&#160;the&#160;destination&#160;indicates<br/>where&#160;the&#160;result&#160;should&#160;be&#160;stored&#160;(in&#160;this&#160;case,&#160;the&#160;TPM’s&#160;PCR&#160;number&#160;16).</p>
<p style="position:absolute;top:845px;left:172px;white-space:nowrap" class="ft2612">The&#160;CM&#160;calls&#160;the&#160;IM&#160;interface</p>
<p style="position:absolute;top:844px;left:358px;white-space:nowrap" class="ft2627">unsealKey</p>
<p style="position:absolute;top:845px;left:424px;white-space:nowrap" class="ft2612">(step&#160;1.1),&#160;passing&#160;the&#160;sealing&#160;descriptor</p>
<p style="position:absolute;top:863px;left:150px;white-space:nowrap" class="ft2615">as&#160;a&#160;parameter.&#160;The&#160;IM&#160;extracts&#160;the&#160;measurement&#160;descriptor&#160;from&#160;the&#160;sealing&#160;descrip-<br/>tor&#160;and&#160;calls&#160;the</p>
<p style="position:absolute;top:880px;left:255px;white-space:nowrap" class="ft2627">measurevHD</p>
<p style="position:absolute;top:880px;left:339px;white-space:nowrap" class="ft2612">interface&#160;of&#160;the&#160;SIP&#160;with&#160;the&#160;measurement&#160;descriptor</p>
<p style="position:absolute;top:898px;left:150px;white-space:nowrap" class="ft2612">(step&#160;1.1.1).&#160;The&#160;plug-in&#160;reads&#160;the&#160;list&#160;of</p>
<p style="position:absolute;top:899px;left:401px;white-space:nowrap" class="ft2659">measureTargets</p>
<p style="position:absolute;top:898px;left:527px;white-space:nowrap" class="ft2612">,&#160;and&#160;accordingly&#160;mea-</p>
<p style="position:absolute;top:916px;left:150px;white-space:nowrap" class="ft2615">sures&#160;the&#160;disk&#160;image.&#160;It&#160;returns&#160;a&#160;measurement&#160;result&#160;list&#160;to&#160;the&#160;IM&#160;(step&#160;1.1.2).&#160;The<br/>IM&#160;calls&#160;the&#160;ASM,&#160;which&#160;handles&#160;TPM-related&#160;functions&#160;(step&#160;1.1.3).&#160;The&#160;ASM&#160;writes<br/>the&#160;measurements&#160;to&#160;the&#160;TPM&#160;by&#160;invoking&#160;the</p>
<p style="position:absolute;top:952px;left:434px;white-space:nowrap" class="ft2627">TPM</p>
<p style="position:absolute;top:952px;left:467px;white-space:nowrap" class="ft2612">_</p>
<p style="position:absolute;top:952px;left:474px;white-space:nowrap" class="ft2627">Extend</p>
<p style="position:absolute;top:952px;left:522px;white-space:nowrap" class="ft2612">operation&#160;(step&#160;1.1.3.1).</p>
<p style="position:absolute;top:970px;left:150px;white-space:nowrap" class="ft2612">Furthermore,&#160;the&#160;ASM&#160;performs&#160;the&#160;unsealing&#160;of&#160;the&#160;key&#160;requested&#160;by&#160;invoking&#160;the</p>
<p style="position:absolute;top:988px;left:150px;white-space:nowrap" class="ft2627">TPM</p>
<p style="position:absolute;top:988px;left:183px;white-space:nowrap" class="ft2612">_</p>
<p style="position:absolute;top:988px;left:190px;white-space:nowrap" class="ft2627">Unseal</p>
<p style="position:absolute;top:988px;left:235px;white-space:nowrap" class="ft2612">operation&#160;(step&#160;1.1.3.3).&#160;If&#160;the</p>
<p style="position:absolute;top:989px;left:417px;white-space:nowrap" class="ft2659">dest</p>
<p style="position:absolute;top:988px;left:456px;white-space:nowrap" class="ft2612">PCR&#160;value&#160;matches&#160;the&#160;value&#160;at&#160;the</p>
<p style="position:absolute;top:1006px;left:150px;white-space:nowrap" class="ft2615">time&#160;of&#160;sealing,&#160;then&#160;the&#160;disk&#160;is&#160;in&#160;the&#160;desired&#160;state&#160;and&#160;the&#160;unseal&#160;operation&#160;is&#160;success-<br/>ful&#160;(step&#160;1.1.3.4);&#160;in&#160;that&#160;case,&#160;the&#160;ASM&#160;returns&#160;a&#160;key&#160;back&#160;to&#160;the&#160;IM&#160;(step&#160;1.1.4),&#160;which<br/>in&#160;turn&#160;returns&#160;the&#160;key&#160;to&#160;the&#160;CM&#160;(step&#160;1.2).&#160;In&#160;case&#160;the&#160;unseal&#160;operation&#160;fails,&#160;the&#160;ASM<br/>would&#160;return&#160;a&#160;failure.&#160;The&#160;CM&#160;calls&#160;the&#160;SVDM&#160;function</p>
<p style="position:absolute;top:1059px;left:493px;white-space:nowrap" class="ft2627">configAndUnlock</p>
<p style="position:absolute;top:1059px;left:600px;white-space:nowrap" class="ft2628">()</p>
<p style="position:absolute;top:1060px;left:615px;white-space:nowrap" class="ft2612">to&#160;attach</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft2618">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 27 -->
<a name="27"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft2761{font-size:11px;font-family:Helvetica;color:#000000;}
	.ft2762{font-size:15px;font-family:ZUROSU+CMBX10;color:#000000;}
	.ft2763{font-size:18px;line-height:21px;font-family:Times;color:#000000;}
-->
</style>
<div id="page27-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL027.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft2712">CHAPTER&#160;3.&#160;COMPLIANCE&#160;PROOFS&#160;FOR&#160;XEN</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft2712">25</p>
<p style="position:absolute;top:194px;left:290px;white-space:nowrap" class="ft2760">&lt;sealing-desc&gt;</p>
<p style="position:absolute;top:211px;left:307px;white-space:nowrap" class="ft2760">&lt;sealing&#160;type=&#34;tpm-based&#34;&#160;keyid=&#34;0x01&#34;&gt;</p>
<p style="position:absolute;top:227px;left:323px;white-space:nowrap" class="ft2760">&lt;measurement-desc&#160;type=&#34;tpm&#34;&gt;</p>
<p style="position:absolute;top:243px;left:355px;white-space:nowrap" class="ft2760">&lt;measureTarget</p>
<p style="position:absolute;top:260px;left:290px;white-space:nowrap" class="ft2760">‘‘</p>
<p style="position:absolute;top:260px;left:379px;white-space:nowrap" class="ft2760">name=&#34;file:/xenimages/vm1image&#34;</p>
<p style="position:absolute;top:276px;left:379px;white-space:nowrap" class="ft2760">desc=&#34;PCR16&#34;/&gt;</p>
<p style="position:absolute;top:293px;left:323px;white-space:nowrap" class="ft2760">&lt;/measurement-desc&gt;</p>
<p style="position:absolute;top:309px;left:307px;white-space:nowrap" class="ft2760">&lt;/sealing&gt;</p>
<p style="position:absolute;top:326px;left:290px;white-space:nowrap" class="ft2760">&lt;/sealing-desc&gt;</p>
<p style="position:absolute;top:374px;left:365px;white-space:nowrap" class="ft2712">Figure&#160;3.10:&#160;Sealing&#160;descriptor&#160;in&#160;XML</p>
<p style="position:absolute;top:422px;left:226px;white-space:nowrap" class="ft2715">and&#160;unlock&#160;the&#160;disk&#160;(steps&#160;1.3&#160;and&#160;1.4).&#160;Upon&#160;successful&#160;completion&#160;of&#160;that&#160;function,<br/>the&#160;CM&#160;instructs&#160;the&#160;Xen&#160;hypervisor&#160;to&#160;actually&#160;start&#160;the&#160;VM&#160;(steps&#160;1.5&#160;and&#160;1.6).</p>
<p style="position:absolute;top:458px;left:248px;white-space:nowrap" class="ft2712">For&#160;the&#160;sake&#160;of&#160;simplicity,&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#26">3.9&#160;</a>does&#160;not&#160;show&#160;details&#160;of&#160;key&#160;handling&#160;such&#160;as</p>
<p style="position:absolute;top:476px;left:226px;white-space:nowrap" class="ft2712">loading&#160;a&#160;sealing&#160;wrapper&#160;key&#160;into&#160;the&#160;TPM.</p>
<p style="position:absolute;top:534px;left:226px;white-space:nowrap" class="ft2744"><b>3.5.3</b></p>
<p style="position:absolute;top:534px;left:280px;white-space:nowrap" class="ft2763"><b>Enforcement&#160;and&#160;Compliance&#160;Proofs&#160;for&#160;Information&#160;Flow<br/>Control</b></p>
<p style="position:absolute;top:613px;left:398px;white-space:nowrap" class="ft2761"><b>Customer</b></p>
<p style="position:absolute;top:624px;left:402px;white-space:nowrap" class="ft2761"><b>Network</b></p>
<p style="position:absolute;top:613px;left:505px;white-space:nowrap" class="ft2761"><b>Management</b></p>
<p style="position:absolute;top:624px;left:517px;white-space:nowrap" class="ft2761"><b>Network</b></p>
<p style="position:absolute;top:711px;left:415px;white-space:nowrap" class="ft2761"><b>DMZ</b></p>
<p style="position:absolute;top:711px;left:522px;white-space:nowrap" class="ft2761"><b>Internet</b></p>
<p style="position:absolute;top:774px;left:370px;white-space:nowrap" class="ft2712">Figure&#160;3.11:&#160;Virtual&#160;network&#160;topology</p>
<p style="position:absolute;top:813px;left:248px;white-space:nowrap" class="ft2712">Consider,&#160;for&#160;example,&#160;the&#160;virtual&#160;network&#160;topology&#160;shown&#160;in&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#27">3.11&#160;</a>with</p>
<p style="position:absolute;top:831px;left:226px;white-space:nowrap" class="ft2715">four&#160;virtual&#160;network&#160;zones.&#160;The&#160;topology&#160;shows&#160;the&#160;network&#160;of&#160;a&#160;company&#160;(which&#160;we<br/>shall&#160;call&#160;the&#160;<i>customer&#160;</i>company)&#160;connected&#160;to&#160;the&#160;Internet&#160;via&#160;a&#160;demilitarized&#160;zone<br/>(DMZ).&#160;The&#160;customer&#160;network&#160;is&#160;also&#160;connected&#160;to&#160;a&#160;<i>management&#160;network&#160;</i>that&#160;allows<br/>an&#160;outsourcing&#160;provider&#160;to&#160;manage&#160;the&#160;customer&#160;systems.&#160;The&#160;management&#160;network&#160;is<br/>not&#160;connected&#160;to&#160;the&#160;Internet.</p>
<p style="position:absolute;top:933px;left:327px;white-space:nowrap" class="ft2712">from/to</p>
<p style="position:absolute;top:933px;left:406px;white-space:nowrap" class="ft2762">Cust</p>
<p style="position:absolute;top:932px;left:441px;white-space:nowrap" class="ft2729">.</p>
<p style="position:absolute;top:933px;left:463px;white-space:nowrap" class="ft2762">DMZ</p>
<p style="position:absolute;top:933px;left:521px;white-space:nowrap" class="ft2762">Mgmt</p>
<p style="position:absolute;top:932px;left:567px;white-space:nowrap" class="ft2729">.</p>
<p style="position:absolute;top:933px;left:589px;white-space:nowrap" class="ft2717"><b>Internet</b></p>
<p style="position:absolute;top:954px;left:327px;white-space:nowrap" class="ft2762">Cust</p>
<p style="position:absolute;top:953px;left:362px;white-space:nowrap" class="ft2729">.</p>
<p style="position:absolute;top:954px;left:406px;white-space:nowrap" class="ft2712">1</p>
<p style="position:absolute;top:954px;left:463px;white-space:nowrap" class="ft2712">1</p>
<p style="position:absolute;top:954px;left:521px;white-space:nowrap" class="ft2712">1</p>
<p style="position:absolute;top:954px;left:589px;white-space:nowrap" class="ft2712">0</p>
<p style="position:absolute;top:973px;left:327px;white-space:nowrap" class="ft2762">DMZ</p>
<p style="position:absolute;top:973px;left:406px;white-space:nowrap" class="ft2712">1</p>
<p style="position:absolute;top:973px;left:463px;white-space:nowrap" class="ft2712">1</p>
<p style="position:absolute;top:973px;left:521px;white-space:nowrap" class="ft2712">0</p>
<p style="position:absolute;top:973px;left:589px;white-space:nowrap" class="ft2712">1</p>
<p style="position:absolute;top:991px;left:327px;white-space:nowrap" class="ft2762">Mgmt</p>
<p style="position:absolute;top:990px;left:372px;white-space:nowrap" class="ft2729">.</p>
<p style="position:absolute;top:991px;left:406px;white-space:nowrap" class="ft2712">1</p>
<p style="position:absolute;top:991px;left:463px;white-space:nowrap" class="ft2712">0</p>
<p style="position:absolute;top:991px;left:521px;white-space:nowrap" class="ft2712">1</p>
<p style="position:absolute;top:991px;left:589px;white-space:nowrap" class="ft2712">0</p>
<p style="position:absolute;top:1010px;left:327px;white-space:nowrap" class="ft2762">Internet</p>
<p style="position:absolute;top:1010px;left:406px;white-space:nowrap" class="ft2712">0</p>
<p style="position:absolute;top:1010px;left:463px;white-space:nowrap" class="ft2712">1</p>
<p style="position:absolute;top:1010px;left:521px;white-space:nowrap" class="ft2712">0</p>
<p style="position:absolute;top:1010px;left:589px;white-space:nowrap" class="ft2712">0</p>
<p style="position:absolute;top:1057px;left:385px;white-space:nowrap" class="ft2712">Figure&#160;3.12:&#160;Flow&#160;control&#160;matrix</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft2718">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 28 -->
<a name="28"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page28-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL028.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft2812">26</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft2818">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:193px;left:172px;white-space:nowrap" class="ft2812">An&#160;information&#160;flow-control&#160;matrix&#160;is&#160;a&#160;simple&#160;way&#160;of&#160;formalizing&#160;the&#160;system-wide</p>
<p style="position:absolute;top:211px;left:150px;white-space:nowrap" class="ft2815">flow-control&#160;objectives&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[12]</a>.&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#27">3.12&#160;</a>shows&#160;a&#160;sample&#160;matrix&#160;for&#160;the&#160;four&#160;virtual<br/>network&#160;zones.&#160;Each&#160;matrix&#160;element&#160;represents&#160;a&#160;policy&#160;specifying&#160;the&#160;information<br/>flows&#160;permitted&#160;between&#160;a&#160;pair&#160;of&#160;network&#160;zones.&#160;The&#160;1&#160;elements&#160;along&#160;the&#160;matrix<br/>diagonal&#160;convey&#160;the&#160;fact&#160;that&#160;there&#160;is&#160;free&#160;information&#160;flow&#160;within&#160;each&#160;network&#160;zone.<br/>The&#160;0&#160;elements&#160;in&#160;the&#160;matrix&#160;are&#160;used&#160;to&#160;specify&#160;that&#160;there&#160;should&#160;be&#160;no&#160;information<br/>flow&#160;between&#160;two&#160;zones,&#160;e.g.,&#160;between&#160;the&#160;management&#160;zone&#160;and&#160;the&#160;Internet.</p>
<p style="position:absolute;top:319px;left:172px;white-space:nowrap" class="ft2812">In&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[12]</a>,&#160;we&#160;described&#160;a&#160;Xen-based&#160;prototype&#160;of&#160;a&#160;secure&#160;network&#160;virtualization</p>
<p style="position:absolute;top:337px;left:150px;white-space:nowrap" class="ft2815">architecture&#160;that&#160;is&#160;based&#160;on&#160;the&#160;concept&#160;of&#160;Trusted&#160;Virtual&#160;Domains.&#160;The&#160;architecture<br/>allows&#160;arbitrary&#160;network&#160;topologies&#160;connecting&#160;VMs.&#160;For&#160;example,&#160;different&#160;VMs&#160;on<br/>the&#160;same&#160;physical&#160;infrastructure&#160;may&#160;belong&#160;to&#160;different&#160;virtual&#160;network&#160;zones.&#160;Despite<br/>this,&#160;the&#160;architecture&#160;ensures&#160;the&#160;enforcement&#160;of&#160;policy-based&#160;information&#160;flow&#160;control.<br/>We&#160;can&#160;use&#160;the&#160;architecture&#160;for&#160;enforcing&#160;the&#160;policies&#160;shown&#160;in&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#27">3.12.</a></p>
<p style="position:absolute;top:443px;left:206px;white-space:nowrap" class="ft2860">&lt;flow-policy&gt;</p>
<p style="position:absolute;top:459px;left:223px;white-space:nowrap" class="ft2860">&lt;zone&#160;id=&#34;customer-net&#34;&gt;</p>
<p style="position:absolute;top:476px;left:239px;white-space:nowrap" class="ft2860">&lt;permit&#160;id=&#34;mgmt-net&#34;&#160;/&gt;</p>
<p style="position:absolute;top:492px;left:239px;white-space:nowrap" class="ft2860">&lt;permit&#160;id=&#34;dmz&#34;&#160;/&gt;</p>
<p style="position:absolute;top:508px;left:223px;white-space:nowrap" class="ft2860">&lt;/zone&gt;&#160;...</p>
<p style="position:absolute;top:525px;left:206px;white-space:nowrap" class="ft2860">&lt;/flow-policy&gt;</p>
<p style="position:absolute;top:573px;left:284px;white-space:nowrap" class="ft2812">Figure&#160;3.13:&#160;Flow&#160;control&#160;policy&#160;in&#160;XML</p>
<p style="position:absolute;top:606px;left:172px;white-space:nowrap" class="ft2812">By&#160;combining&#160;the&#160;Xen&#160;prototypes&#160;of&#160;our&#160;PEV&#160;architecture&#160;and&#160;our&#160;secure&#160;network</p>
<p style="position:absolute;top:624px;left:150px;white-space:nowrap" class="ft2815">virtualization&#160;architecture,&#160;it&#160;is&#160;possible&#160;to&#160;validate&#160;the&#160;configuration&#160;of&#160;the&#160;virtual&#160;net-<br/>working&#160;subsystem&#160;on&#160;each&#160;host.&#160;The&#160;subsystem&#160;exports&#160;an&#160;XML&#160;version&#160;of&#160;its&#160;flow-<br/>control&#160;matrix,&#160;as&#160;shown&#160;in&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#28">3.13.&#160;</a>The&#160;network&#160;measurement&#160;plug-in&#160;outputs<br/>the&#160;XML&#160;structure&#160;of&#160;the&#160;flow-control&#160;policy,&#160;when&#160;invoked&#160;by&#160;the&#160;IM.&#160;By&#160;request-<br/>ing&#160;attestation&#160;of&#160;the&#160;TCB&#160;and&#160;this&#160;policy,&#160;a&#160;verifier&#160;can&#160;obtain&#160;a&#160;compliance&#160;proof&#160;for<br/>the&#160;correct&#160;configuration&#160;of&#160;the&#160;virtual&#160;networking&#160;subsystem&#160;on&#160;a&#160;given&#160;host.&#160;At&#160;the<br/>verifier,&#160;a&#160;XSLT&#160;stylesheet&#160;is&#160;used&#160;to&#160;perform&#160;further&#160;transformations&#160;on&#160;the&#160;XML&#160;file<br/>returned&#160;by&#160;the&#160;platform.&#160;The&#160;XSLT&#160;stylesheet&#160;is&#160;a&#160;concrete&#160;implementation&#160;of&#160;the&#160;at-<br/>testation&#160;predicate</p>
<p style="position:absolute;top:766px;left:262px;white-space:nowrap" class="ft2828">Π</p>
<p style="position:absolute;top:767px;left:277px;white-space:nowrap" class="ft2812">(described&#160;in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#17">3.2.2)</a>,&#160;which&#160;assesses&#160;whether&#160;the&#160;platform</p>
<p style="position:absolute;top:785px;left:150px;white-space:nowrap" class="ft2815">is&#160;trustworthy&#160;from&#160;the&#160;verifier’s&#160;point&#160;of&#160;view.&#160;The&#160;result&#160;of&#160;the&#160;predicate&#160;will&#160;serve&#160;to<br/>convince&#160;the&#160;verifier&#160;that&#160;the&#160;policy&#160;in&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#27">3.12&#160;</a>is&#160;the&#160;actual&#160;flow-control&#160;policy&#160;as<br/>enforced&#160;by&#160;the&#160;network&#160;subsystem.&#160;If&#160;access&#160;restriction&#160;is&#160;an&#160;important&#160;concern,&#160;the<br/>XML&#160;output&#160;from&#160;the&#160;plug-in&#160;modules&#160;may&#160;be&#160;first&#160;processed&#160;by&#160;an&#160;XSLT&#160;stylesheet<br/>that&#160;implements&#160;a&#160;access&#160;filter&#160;before&#160;passing&#160;it&#160;on&#160;to&#160;the&#160;verifier.&#160;In&#160;such&#160;a&#160;case,&#160;the<br/>stylesheet&#160;would&#160;be&#160;embedded&#160;in&#160;the&#160;platform&#160;TCB.</p>
<p style="position:absolute;top:893px;left:172px;white-space:nowrap" class="ft2812">A&#160;user&#160;can&#160;also&#160;protect&#160;sensitive&#160;information&#160;(say,&#160;an&#160;encryption&#160;key)&#160;against&#160;access</p>
<p style="position:absolute;top:911px;left:150px;white-space:nowrap" class="ft2815">by&#160;an&#160;untrusted&#160;network&#160;configuration&#160;using&#160;a&#160;two-stage&#160;procedure.&#160;The&#160;first&#160;stage&#160;is<br/>sealing,&#160;in&#160;which&#160;the&#160;user&#160;has&#160;to&#160;specify&#160;the&#160;binary&#160;configuration&#160;of&#160;the&#160;TCB&#160;and&#160;condi-<br/>tions&#160;for&#160;checking&#160;whether&#160;a&#160;given&#160;network&#160;configuration&#160;is&#160;a&#160;trusted&#160;one.&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#29">3.14<br/></a>shows&#160;an&#160;XSLT&#160;script&#160;that&#160;encodes&#160;the&#160;condition&#160;that&#160;the&#160;customer&#160;network&#160;should&#160;be<br/>directly&#160;connected&#160;only&#160;to&#160;the&#160;DMZ&#160;and&#160;the&#160;management&#160;network&#160;of&#160;the&#160;outsourcing<br/>provider,&#160;but&#160;not&#160;to&#160;any&#160;other&#160;network.&#160;The&#160;input&#160;to&#160;the&#160;XSLT&#160;script&#160;is&#160;the&#160;XML&#160;pol-<br/>icy&#160;that&#160;is&#160;output&#160;by&#160;the&#160;network&#160;measurement&#160;plug-in.&#160;The&#160;XSLT&#160;script&#160;is&#160;a&#160;concrete<br/>realization&#160;of&#160;the&#160;user-specified&#160;predicate</p>
<p style="position:absolute;top:1035px;left:406px;white-space:nowrap" class="ft2828">Π</p>
<p style="position:absolute;top:1036px;left:422px;white-space:nowrap" class="ft2812">in&#160;our&#160;formal&#160;model&#160;(Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#15">3.2)</a>.&#160;The</p>
<p style="position:absolute;top:1054px;left:150px;white-space:nowrap" class="ft2815">user&#160;seals&#160;the&#160;key&#160;to&#160;both&#160;the&#160;state&#160;of&#160;the&#160;TCB&#160;and&#160;the&#160;value&#160;of&#160;a&#160;resettable&#160;PCR;&#160;the<br/>latter&#160;reflects&#160;the&#160;integrity&#160;of&#160;the&#160;XSLT&#160;script&#160;and&#160;the&#160;integrity&#160;of&#160;the&#160;plug-in&#160;identifier.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft2818">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 29 -->
<a name="29"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page29-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL029.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft2912">CHAPTER&#160;3.&#160;COMPLIANCE&#160;PROOFS&#160;FOR&#160;XEN</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft2912">27</p>
<p style="position:absolute;top:194px;left:244px;white-space:nowrap" class="ft2960">&lt;xsl:template</p>
<p style="position:absolute;top:211px;left:260px;white-space:nowrap" class="ft2960">match=&#34;/flow-policy/zone[@id=’customer-net’]&#34;&gt;</p>
<p style="position:absolute;top:227px;left:260px;white-space:nowrap" class="ft2960">&lt;xsl:choose&gt;&#160;&lt;xsl:if</p>
<p style="position:absolute;top:243px;left:292px;white-space:nowrap" class="ft2960">test=&#34;count(*[@id=’dmz’])=1</p>
<p style="position:absolute;top:260px;left:341px;white-space:nowrap" class="ft2960">and&#160;count(*[@id=’mgmt-net’])=1&#34;&gt;</p>
<p style="position:absolute;top:276px;left:292px;white-space:nowrap" class="ft2960">&lt;true&#160;/&gt;</p>
<p style="position:absolute;top:293px;left:276px;white-space:nowrap" class="ft2960">&lt;/xsl:if&gt;</p>
<p style="position:absolute;top:309px;left:260px;white-space:nowrap" class="ft2960">&lt;/xsl:choose&gt;</p>
<p style="position:absolute;top:326px;left:244px;white-space:nowrap" class="ft2960">&lt;/xsl:template&gt;</p>
<p style="position:absolute;top:374px;left:397px;white-space:nowrap" class="ft2912">Figure&#160;3.14:&#160;XSLT&#160;condition</p>
<p style="position:absolute;top:422px;left:226px;white-space:nowrap" class="ft2915">The&#160;second&#160;stage&#160;is&#160;unsealing,&#160;in&#160;which&#160;the&#160;IM&#160;(i)&#160;obtains&#160;the&#160;result&#160;of&#160;the&#160;plug-in,&#160;(ii)<br/>applies&#160;the&#160;result&#160;as&#160;input&#160;to&#160;the&#160;XSLT&#160;script,&#160;(iii)&#160;extends&#160;the&#160;resettable&#160;PCR&#160;with&#160;the<br/>hash&#160;of&#160;the&#160;XSLT&#160;script&#160;and&#160;the&#160;network&#160;measurement&#160;plug-in&#160;identifier,&#160;and&#160;(iv)&#160;tries<br/>to&#160;unseal&#160;the&#160;actual&#160;key.&#160;For&#160;steps&#160;(iii)&#160;and&#160;(iv),&#160;the&#160;IM&#160;invokes&#160;the&#160;ASM.&#160;The&#160;TPM<br/>should&#160;only&#160;reveal&#160;the&#160;key&#160;if&#160;the&#160;TCB&#160;is&#160;correct&#160;and&#160;the&#160;XSLT&#160;evaluated&#160;to</p>
<p style="position:absolute;top:494px;left:679px;white-space:nowrap" class="ft2959">&lt;true/&gt;</p>
<p style="position:absolute;top:511px;left:226px;white-space:nowrap" class="ft2912">when&#160;executed&#160;on&#160;their&#160;output.</p>
<p style="position:absolute;top:575px;left:226px;white-space:nowrap" class="ft2920"><b>3.6</b></p>
<p style="position:absolute;top:575px;left:274px;white-space:nowrap" class="ft2920"><b>Conclusion</b></p>
<p style="position:absolute;top:613px;left:226px;white-space:nowrap" class="ft2915">We&#160;introduced&#160;a&#160;formal&#160;model&#160;for&#160;managing&#160;the&#160;integrity&#160;of&#160;arbitrary&#160;aspects&#160;of&#160;a<br/>virtualized&#160;system&#160;and&#160;evaluating&#160;system&#160;compliance&#160;with&#160;respect&#160;to&#160;given&#160;security<br/>policies.&#160;Based&#160;on&#160;the&#160;model,&#160;we&#160;described&#160;an&#160;architecture,&#160;called&#160;PEV,&#160;for&#160;protecting<br/>security&#160;policies&#160;against&#160;modification,&#160;and&#160;allowing&#160;stakeholders&#160;to&#160;verify&#160;the&#160;poli-<br/>cies&#160;actually&#160;implemented.&#160;We&#160;generalized&#160;the&#160;integrity&#160;management&#160;functions&#160;of&#160;the<br/>Trusted&#160;Platform&#160;Module,&#160;so&#160;that&#160;they&#160;are&#160;applicable&#160;not&#160;just&#160;for&#160;software&#160;binaries,&#160;but<br/>also&#160;for&#160;checking&#160;security&#160;compliance&#160;and&#160;enforcing&#160;security&#160;policies.&#160;We&#160;described<br/>a&#160;prototype&#160;implementation&#160;of&#160;the&#160;architecture&#160;based&#160;on&#160;the&#160;Xen&#160;hypervisor.&#160;We&#160;also<br/>presented&#160;multiple&#160;use&#160;cases&#160;to&#160;demonstrate&#160;the&#160;policy&#160;enforcement&#160;and&#160;compliance<br/>checking&#160;capabilities&#160;of&#160;our&#160;implementation.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft2918">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 30 -->
<a name="30"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page30-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL030.png" alt="background image"/>
<p style="position:absolute;top:295px;left:150px;white-space:nowrap" class="ft3019"><b>Chapter&#160;4</b></p>
<p style="position:absolute;top:365px;left:150px;white-space:nowrap" class="ft3031"><b>Hierarchical&#160;Integrity<br/>Management&#160;for&#160;Complex<br/>Trusted&#160;Platforms</b></p>
<p style="position:absolute;top:512px;left:150px;white-space:nowrap" class="ft3012">Serdar&#160;Cabuk,&#160;David&#160;Plaquin&#160;(HP),&#160;Theodore&#160;Hong,&#160;Derek&#160;Murray,&#160;Eric&#160;John&#160;(CUCL)</p>
<p style="position:absolute;top:586px;left:150px;white-space:nowrap" class="ft3020"><b>4.1</b></p>
<p style="position:absolute;top:586px;left:198px;white-space:nowrap" class="ft3020"><b>Introduction</b></p>
<p style="position:absolute;top:624px;left:150px;white-space:nowrap" class="ft3015">Trusted&#160;Computing&#160;has&#160;been&#160;proposed&#160;as&#160;a&#160;means&#160;of&#160;providing&#160;verifiable&#160;trust&#160;in&#160;a<br/>computing&#160;platform.&#160;However,&#160;as&#160;virtualization&#160;becomes&#160;more&#160;popular&#160;and&#160;platform<br/>changes&#160;(such&#160;as&#160;security&#160;patches)&#160;occur&#160;more&#160;frequently,&#160;the&#160;established&#160;model&#160;for<br/>Trusted&#160;Computing&#160;is&#160;insufficient&#160;to&#160;cope&#160;in&#160;real-world&#160;scenarios.&#160;We&#160;therefore&#160;intro-<br/>duce&#160;an&#160;extensible&#160;integrity&#160;management&#160;framework&#160;that&#160;is&#160;better&#160;suited&#160;to&#160;deal&#160;with<br/>complicated&#160;trust&#160;dependencies&#160;and&#160;change&#160;management.</p>
<p style="position:absolute;top:732px;left:172px;white-space:nowrap" class="ft3012">The&#160;goal&#160;of&#160;Trusted&#160;Computing&#160;is&#160;to&#160;enable&#160;third&#160;parties&#160;to&#160;remotely&#160;attest&#160;and</p>
<p style="position:absolute;top:750px;left:150px;white-space:nowrap" class="ft3015">verify&#160;the&#160;configuration&#160;of&#160;a&#160;computing&#160;platform&#160;in&#160;a&#160;secure&#160;manner.&#160;Existing&#160;<i>trusted<br/>platforms&#160;</i>typically&#160;contain&#160;a&#160;component&#160;that&#160;is&#160;at&#160;least&#160;logically&#160;protected&#160;from&#160;sub-<br/>version.&#160;The&#160;implicitly&#160;trusted&#160;components&#160;of&#160;a&#160;trusted&#160;platform&#160;–&#160;in&#160;particular,&#160;the<br/>hardware&#160;Trusted&#160;Platform&#160;Module&#160;(TPM)&#160;–&#160;can&#160;be&#160;used&#160;to&#160;store&#160;integrity&#160;measure-<br/>ments,&#160;and&#160;subsequently&#160;report&#160;these&#160;to&#160;users&#160;(or&#160;remote&#160;entities)&#160;with&#160;a&#160;cryptographic<br/>guarantee&#160;of&#160;their&#160;veracity.&#160;Users&#160;can&#160;then&#160;compare&#160;the&#160;reported&#160;measurements&#160;with<br/>known&#160;or&#160;expected&#160;values,&#160;and&#160;thereby&#160;infer&#160;whether&#160;the&#160;platform&#160;is&#160;operating&#160;as&#160;ex-<br/>pected&#160;(e.g.,&#160;it&#160;is&#160;running&#160;the&#160;expected&#160;software&#160;with&#160;the&#160;expected&#160;configuration&#160;while<br/>enforcing&#160;the&#160;expected&#160;policies).</p>
<p style="position:absolute;top:911px;left:172px;white-space:nowrap" class="ft3012">Present&#160;implementations&#160;of&#160;Trusted&#160;Computing&#160;technology&#160;can&#160;take&#160;immutable</p>
<p style="position:absolute;top:929px;left:150px;white-space:nowrap" class="ft3015">snapshots&#160;of&#160;a&#160;whole&#160;platform,&#160;which&#160;can&#160;then&#160;be&#160;used&#160;as&#160;proof&#160;of&#160;trustworthi-<br/>ness&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[65,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">27,&#160;36,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">23]</a>.&#160;They&#160;do&#160;not,&#160;however,&#160;provide&#160;more&#160;granular&#160;verifications&#160;of<br/>platform&#160;components&#160;such&#160;as&#160;individual&#160;virtual&#160;machines&#160;(VMs)&#160;and&#160;applications.&#160;The<br/>platform&#160;is&#160;treated&#160;as&#160;a&#160;whole,&#160;and&#160;while&#160;it&#160;is&#160;possible&#160;to&#160;store&#160;integrity&#160;measurements<br/>of&#160;VMs&#160;and&#160;applications,&#160;the&#160;limited&#160;amount&#160;of&#160;storage&#160;in&#160;a&#160;TPM&#160;means&#160;that&#160;it&#160;is&#160;not<br/>possible&#160;to&#160;represent&#160;individual&#160;components&#160;and&#160;the&#160;dependencies&#160;between&#160;them.&#160;Fur-<br/>thermore,&#160;it&#160;is&#160;not&#160;possible&#160;to&#160;manage&#160;changes&#160;to&#160;measured&#160;components.&#160;The&#160;current<br/>scheme&#160;advocated&#160;by&#160;the&#160;Trusted&#160;Computing&#160;Group&#160;(TCG)&#160;deems&#160;all&#160;such&#160;changes<br/>to&#160;be&#160;malicious&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[74]</a>.&#160;This&#160;is&#160;certainly&#160;impractical&#160;for&#160;modern&#160;server&#160;environments,</p>
<p style="position:absolute;top:1117px;left:400px;white-space:nowrap" class="ft3012">28</p>
</div>
<!-- Page 31 -->
<a name="31"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page31-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL031.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft3112">CHAPTER&#160;4.&#160;HIERARCHICAL&#160;INTEGRITY&#160;MANAGEMENT</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft3112">29</p>
<p style="position:absolute;top:193px;left:226px;white-space:nowrap" class="ft3115">which&#160;undergo&#160;a&#160;constant&#160;bombardment&#160;of&#160;security&#160;patches&#160;and&#160;policy&#160;changes.&#160;In<br/>2007&#160;alone,&#160;Microsoft&#160;released&#160;11&#160;security&#160;related&#160;patches&#160;for&#160;the&#160;Windows&#160;operating<br/>system&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#74">[1]</a>,&#160;while&#160;a&#160;typical&#160;enterprise&#160;anti-virus&#160;application&#160;will&#160;undergo&#160;two&#160;to&#160;five<br/>updates&#160;in&#160;an&#160;average&#160;week&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#77">[48]</a>.</p>
<p style="position:absolute;top:265px;left:248px;white-space:nowrap" class="ft3112">In&#160;this&#160;paper,&#160;we&#160;introduce&#160;an&#160;extensible&#160;integrity&#160;management&#160;framework&#160;that</p>
<p style="position:absolute;top:283px;left:226px;white-space:nowrap" class="ft3115">addresses&#160;these&#160;two&#160;shortcomings.&#160;To&#160;improve&#160;integrity&#160;management,&#160;we&#160;explicitly<br/>represent&#160;integrity&#160;dependencies&#160;between&#160;platform&#160;components&#160;by&#160;giving&#160;individual<br/>registers&#160;to&#160;each&#160;component&#160;to&#160;store&#160;their&#160;integrity&#160;measurements,&#160;and&#160;chaining&#160;these<br/>components&#160;together&#160;in&#160;a&#160;dependency&#160;graph.&#160;To&#160;improve&#160;change&#160;management,&#160;we<br/>introduce&#160;a&#160;new&#160;distinction&#160;between&#160;reversible&#160;and&#160;irreversible&#160;changes&#160;to&#160;measured<br/>components.&#160;A&#160;reversible&#160;change&#160;is&#160;one&#160;that&#160;can&#160;be&#160;undone&#160;and&#160;is&#160;guaranteed&#160;not&#160;to<br/>have&#160;any&#160;permanent&#160;effects.&#160;The&#160;introduction&#160;of&#160;reversible&#160;changes&#160;allows&#160;the&#160;platform<br/>integrity&#160;to&#160;be&#160;modified&#160;temporarily,&#160;for&#160;example&#160;when&#160;a&#160;device&#160;is&#160;hot-plugged&#160;and<br/>then&#160;removed.&#160;Although&#160;the&#160;platform&#160;may&#160;no&#160;longer&#160;be&#160;considered&#160;trustworthy&#160;during<br/>the&#160;time&#160;that&#160;the&#160;change&#160;holds,&#160;its&#160;integrity&#160;can&#160;be&#160;safely&#160;restored&#160;after&#160;the&#160;change&#160;is<br/>undone.</p>
<p style="position:absolute;top:480px;left:248px;white-space:nowrap" class="ft3112">Our&#160;resulting&#160;framework&#160;gives&#160;a&#160;better&#160;understanding&#160;of&#160;a&#160;platform’s&#160;security&#160;prop-</p>
<p style="position:absolute;top:498px;left:226px;white-space:nowrap" class="ft3115">erties,&#160;which&#160;can&#160;be&#160;used&#160;in&#160;policy&#160;verification.&#160;Like&#160;existing&#160;Trusted&#160;Computing&#160;im-<br/>plementations,&#160;our&#160;services&#160;can&#160;be&#160;used&#160;to&#160;grant&#160;access&#160;to&#160;protected&#160;resources&#160;(such<br/>as&#160;encrypted&#160;storage)&#160;only&#160;when&#160;the&#160;policy&#160;is&#160;satisfied;&#160;however,&#160;unlike&#160;existing&#160;im-<br/>plementations,&#160;these&#160;policies&#160;can&#160;be&#160;more&#160;fine-grained,&#160;dynamic,&#160;and&#160;flexible.&#160;Our<br/>prototype&#160;implementation,&#160;built&#160;on&#160;the&#160;Xen&#160;virtual&#160;machine&#160;monitor&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[20]</a>,&#160;includes<br/>the&#160;integrity&#160;management&#160;framework&#160;and&#160;a&#160;credential&#160;manager&#160;service,&#160;which&#160;demon-<br/>strates&#160;the&#160;use&#160;of&#160;enhanced&#160;policy&#160;checks&#160;to&#160;control&#160;access&#160;to&#160;security&#160;credentials.</p>
<p style="position:absolute;top:624px;left:248px;white-space:nowrap" class="ft3112">The&#160;remainder&#160;of&#160;this&#160;paper&#160;is&#160;organized&#160;as&#160;follows.&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#10">2&#160;</a>provides&#160;background</p>
<p style="position:absolute;top:642px;left:226px;white-space:nowrap" class="ft3115">on&#160;Trusted&#160;Computing&#160;and&#160;virtualization.&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#31">4.2&#160;</a>outlines&#160;the&#160;motivation&#160;and&#160;high-<br/>level&#160;design&#160;for&#160;our&#160;integrity&#160;management&#160;framework.&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#33">4.3&#160;</a>presents&#160;the&#160;basic<br/>framework,&#160;which&#160;provides&#160;integrity&#160;services&#160;to&#160;individual&#160;components;&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#37">4.4<br/></a>extends&#160;this&#160;into&#160;reversible&#160;integrity&#160;changes&#160;and&#160;an&#160;explicit&#160;dependency&#160;graph,&#160;and<br/>provides&#160;use&#160;cases&#160;for&#160;this&#160;model.&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#42">4.5&#160;</a>presents&#160;some&#160;examples&#160;of&#160;security<br/>services&#160;that&#160;could&#160;make&#160;use&#160;of&#160;our&#160;framework.&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#44">4.6&#160;</a>describes&#160;our&#160;prototype<br/>implementation&#160;of&#160;the&#160;framework&#160;and&#160;the&#160;credential&#160;management&#160;service&#160;on&#160;Xen.&#160;Fi-<br/>nally,&#160;in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#47">4.7&#160;</a>we&#160;discuss&#160;related&#160;work,&#160;and&#160;in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#49">4.8&#160;</a>we&#160;draw&#160;conclusions.</p>
<p style="position:absolute;top:831px;left:226px;white-space:nowrap" class="ft3120"><b>4.2</b></p>
<p style="position:absolute;top:831px;left:274px;white-space:nowrap" class="ft3120"><b>Design&#160;Overview</b></p>
<p style="position:absolute;top:869px;left:226px;white-space:nowrap" class="ft3115">The&#160;typical&#160;design&#160;for&#160;a&#160;trusted&#160;platform&#160;comprises&#160;a&#160;hardware&#160;TPM&#160;and&#160;software&#160;in-<br/>tegrity&#160;management&#160;services.&#160;These&#160;services&#160;measure&#160;platform&#160;components,&#160;store&#160;in-<br/>tegrity&#160;measurements&#160;as&#160;immutable&#160;logs&#160;and&#160;attest&#160;these&#160;measurements&#160;to&#160;third&#160;parties.<br/>The&#160;services&#160;use&#160;the&#160;TPM&#160;to&#160;provide&#160;a&#160;link&#160;with&#160;the&#160;CRTM.&#160;In&#160;a&#160;non-virtualized&#160;plat-<br/>form,&#160;with&#160;relatively&#160;few&#160;components&#160;to&#160;be&#160;measured,&#160;this&#160;model&#160;is&#160;sufficient.&#160;How-<br/>ever,&#160;it&#160;does&#160;not&#160;scale&#160;to&#160;complex&#160;virtualized&#160;platforms&#160;that&#160;have&#160;a&#160;plethora&#160;of&#160;com-<br/>ponents&#160;and&#160;dependencies&#160;between&#160;these&#160;components.&#160;In&#160;this&#160;section,&#160;we&#160;first&#160;discuss<br/>the&#160;limitations&#160;of&#160;the&#160;existing&#160;model.&#160;We&#160;then&#160;present&#160;the&#160;high-level&#160;design&#160;goals&#160;that<br/>motivate&#160;our&#160;integrity&#160;management&#160;framework.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft3118">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 32 -->
<a name="32"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3264{font-size:12px;line-height:14px;font-family:Times;color:#000000;}
-->
</style>
<div id="page32-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL032.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft3212">30</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft3218">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:191px;left:150px;white-space:nowrap" class="ft3244"><b>4.2.1</b></p>
<p style="position:absolute;top:191px;left:204px;white-space:nowrap" class="ft3244"><b>Hardware&#160;Limitations</b></p>
<p style="position:absolute;top:222px;left:150px;white-space:nowrap" class="ft3215">Current&#160;integrity&#160;management&#160;systems&#160;typically&#160;employ&#160;the&#160;TPM&#160;as&#160;the&#160;sole&#160;repos-<br/>itory&#160;for&#160;integrity&#160;measurements&#160;(see&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#47">4.7)</a>.&#160;Unfortunately,&#160;such&#160;schemes&#160;are<br/>fundamentally&#160;limited&#160;by&#160;the&#160;hardware&#160;capabilities&#160;of&#160;a&#160;TPM:</p>
<p style="position:absolute;top:304px;left:168px;white-space:nowrap" class="ft3212">1.&#160;A&#160;TPM&#160;contains&#160;a&#160;small,&#160;limited&#160;amount&#160;of&#160;memory&#160;(PCRs).&#160;The&#160;TCG&#160;specifi-</p>
<p style="position:absolute;top:322px;left:187px;white-space:nowrap" class="ft3215">cation&#160;recommends&#160;that&#160;a&#160;TPM&#160;has&#160;at&#160;least&#160;16&#160;PCRs&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[74]</a>.&#160;Therefore,&#160;for&#160;porta-<br/>bility,&#160;we&#160;cannot&#160;assume&#160;that&#160;a&#160;TPM&#160;will&#160;have&#160;any&#160;more&#160;than&#160;16&#160;PCRs.&#160;Hence,&#160;it<br/>is&#160;not&#160;feasible&#160;to&#160;store&#160;individual&#160;measurements&#160;for&#160;a&#160;large&#160;number&#160;of&#160;virtualized<br/>platform&#160;components.</p>
<p style="position:absolute;top:405px;left:168px;white-space:nowrap" class="ft3212">2.&#160;The&#160;limited&#160;number&#160;of&#160;PCRs&#160;is&#160;typically&#160;addressed&#160;by&#160;aggregating&#160;measurements</p>
<p style="position:absolute;top:423px;left:187px;white-space:nowrap" class="ft3215">in&#160;the&#160;same&#160;register.&#160;Where&#160;two&#160;components&#160;are&#160;independent,&#160;this&#160;introduces&#160;a<br/>false&#160;dependency&#160;between&#160;them.&#160;Furthermore,&#160;the&#160;definition&#160;of&#160;the</p>
<p style="position:absolute;top:442px;left:612px;white-space:nowrap" class="ft3259">extend</p>
<p style="position:absolute;top:459px;left:187px;white-space:nowrap" class="ft3215">function&#160;introduces&#160;an&#160;artificial&#160;dependency&#160;on&#160;the&#160;order&#160;in&#160;which&#160;they&#160;are&#160;ag-<br/>gregated.</p>
<p style="position:absolute;top:506px;left:168px;white-space:nowrap" class="ft3212">3.&#160;It&#160;is&#160;not&#160;possible&#160;to&#160;reverse&#160;the&#160;inclusion&#160;of&#160;a&#160;measurement&#160;in&#160;a&#160;TPM&#160;register.</p>
<p style="position:absolute;top:524px;left:187px;white-space:nowrap" class="ft3215">Therefore,&#160;it&#160;is&#160;impossible&#160;for&#160;a&#160;platform&#160;component&#160;to&#160;report&#160;a&#160;change&#160;to&#160;its<br/>integrity&#160;(e.g.&#160;by&#160;the&#160;dynamic&#160;loading&#160;of&#160;some&#160;code,&#160;or&#160;the&#160;connection&#160;of&#160;a&#160;new<br/>device)&#160;and&#160;revert&#160;back&#160;(after&#160;unloading/disconnection).</p>
<p style="position:absolute;top:588px;left:172px;white-space:nowrap" class="ft3212">To&#160;illustrate&#160;these&#160;limitations,&#160;consider&#160;the&#160;following&#160;example.&#160;A&#160;server&#160;platform</p>
<p style="position:absolute;top:606px;left:150px;white-space:nowrap" class="ft3215">hosts&#160;tens&#160;of&#160;small&#160;VMs,&#160;each&#160;of&#160;which&#160;runs&#160;a&#160;particular&#160;service.&#160;To&#160;keep&#160;track&#160;of&#160;the<br/>platform&#160;integrity&#160;on&#160;a&#160;traditional&#160;TPM-based&#160;system,&#160;the&#160;measurements&#160;must&#160;be&#160;ag-<br/>gregated,&#160;because&#160;there&#160;are&#160;more&#160;VMs&#160;than&#160;PCRs.&#160;For&#160;example,&#160;it&#160;might&#160;be&#160;necessary<br/>to&#160;store&#160;measurements&#160;for&#160;a&#160;virtual&#160;network&#160;switch&#160;and&#160;a&#160;virtual&#160;storage&#160;manager&#160;in&#160;the<br/>same&#160;PCR,&#160;which&#160;creates&#160;a&#160;false&#160;integrity&#160;dependency&#160;between&#160;these&#160;two&#160;VMs.&#160;If&#160;a<br/>malicious&#160;change&#160;is&#160;made&#160;to&#160;the&#160;virtual&#160;network&#160;switch,&#160;and&#160;this&#160;change&#160;is&#160;reported&#160;to<br/>the&#160;appropriate&#160;PCR,&#160;the&#160;integrity&#160;of&#160;the&#160;storage&#160;manager&#160;also&#160;appears&#160;to&#160;be&#160;compro-<br/>mised.&#160;The&#160;same&#160;is&#160;true&#160;for&#160;all&#160;other&#160;VMs&#160;whose&#160;measurements&#160;are&#160;aggregated&#160;in&#160;that<br/>PCR.</p>
<p style="position:absolute;top:768px;left:172px;white-space:nowrap" class="ft3212">It&#160;would&#160;be&#160;possible&#160;to&#160;extend&#160;the&#160;set&#160;of&#160;PCRs&#160;by&#160;giving&#160;a&#160;virtual&#160;TPM&#160;to&#160;each</p>
<p style="position:absolute;top:786px;left:150px;white-space:nowrap" class="ft3215">platform&#160;component&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#74">[9]</a>.&#160;However,&#160;by&#160;allocating&#160;independent&#160;virtual&#160;PCRs&#160;to&#160;each<br/>component,&#160;it&#160;is&#160;no&#160;longer&#160;possible&#160;to&#160;represent&#160;real&#160;dependencies&#160;between&#160;compo-<br/>nent<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#32">s</a></p>
<p style="position:absolute;top:819px;left:181px;white-space:nowrap" class="ft3221"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#32">1</a></p>
<p style="position:absolute;top:822px;left:187px;white-space:nowrap" class="ft3212">.&#160;Furthermore,&#160;since&#160;the&#160;virtual&#160;TPMs&#160;emulate&#160;the&#160;behavior&#160;of&#160;a&#160;hardware&#160;TPM,</p>
<p style="position:absolute;top:839px;left:150px;white-space:nowrap" class="ft3212">it&#160;remains&#160;impossible&#160;to&#160;revert&#160;changes.</p>
<p style="position:absolute;top:898px;left:150px;white-space:nowrap" class="ft3244"><b>4.2.2</b></p>
<p style="position:absolute;top:898px;left:204px;white-space:nowrap" class="ft3244"><b>High-level&#160;Design</b></p>
<p style="position:absolute;top:928px;left:150px;white-space:nowrap" class="ft3215">It&#160;is&#160;clear&#160;that&#160;software&#160;measurement&#160;support&#160;is&#160;required&#160;to&#160;address&#160;the&#160;limitations&#160;of<br/>hardware&#160;capabilities.&#160;We&#160;refer&#160;to&#160;the&#160;set&#160;of&#160;software&#160;components&#160;that&#160;comprise&#160;the<br/>integrity&#160;framework&#160;as&#160;the&#160;<i>software&#160;root&#160;of&#160;trust&#160;for&#160;measurement&#160;(SRTM)</i>.&#160;These&#160;com-<br/>ponents&#160;are&#160;part&#160;of&#160;the&#160;platform&#160;TCB,&#160;and&#160;should&#160;be&#160;isolated&#160;from&#160;other&#160;components;<br/>for&#160;example,&#160;by&#160;virtualization.&#160;Dynamic&#160;components&#160;outside&#160;the&#160;platform&#160;TCB&#160;rely<br/>on&#160;the&#160;SRTM&#160;to&#160;store&#160;measurements&#160;on&#160;their&#160;behalf,&#160;rather&#160;than&#160;the&#160;underlying&#160;TPM.</p>
<p style="position:absolute;top:1044px;left:166px;white-space:nowrap" class="ft3222">1</p>
<p style="position:absolute;top:1046px;left:171px;white-space:nowrap" class="ft3210">Some&#160;virtual&#160;TPM&#160;designs&#160;share&#160;a&#160;fixed&#160;number&#160;of&#160;PCRs&#160;between&#160;all&#160;virtual&#160;TPMs&#160;and&#160;the&#160;hardware</p>
<p style="position:absolute;top:1060px;left:150px;white-space:nowrap" class="ft3264">TPM,&#160;and&#160;these&#160;could&#160;be&#160;used&#160;to&#160;express&#160;dependencies.&#160;However,&#160;the&#160;reliance&#160;on&#160;the&#160;hardware&#160;TPM&#160;leads<br/>to&#160;the&#160;same&#160;limitations&#160;as&#160;a&#160;single-TPM&#160;scheme.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft3218">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 33 -->
<a name="33"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3365{font-size:10px;font-family:ITPEVV+TTFF19o00;color:#000000;}
	.ft3366{font-size:7px;font-family:VRBBWM+TTFF1Ao00;color:#000000;}
-->
</style>
<div id="page33-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL033.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft3312">CHAPTER&#160;4.&#160;HIERARCHICAL&#160;INTEGRITY&#160;MANAGEMENT</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft3312">31</p>
<p style="position:absolute;top:204px;left:297px;white-space:nowrap" class="ft3365">CRTM</p>
<p style="position:absolute;top:204px;left:297px;white-space:nowrap" class="ft3365">CRTM</p>
<p style="position:absolute;top:204px;left:356px;white-space:nowrap" class="ft3365">BIOS</p>
<p style="position:absolute;top:204px;left:356px;white-space:nowrap" class="ft3365">BIOS</p>
<p style="position:absolute;top:204px;left:404px;white-space:nowrap" class="ft3365">Boot&#160;Loader</p>
<p style="position:absolute;top:204px;left:404px;white-space:nowrap" class="ft3365">Boot&#160;Loader</p>
<p style="position:absolute;top:207px;left:472px;white-space:nowrap" class="ft3365">OS&#160;Kernel</p>
<p style="position:absolute;top:207px;left:472px;white-space:nowrap" class="ft3365">OS&#160;Kernel</p>
<p style="position:absolute;top:207px;left:539px;white-space:nowrap" class="ft3365">SRTM</p>
<p style="position:absolute;top:207px;left:539px;white-space:nowrap" class="ft3365">SRTM</p>
<p style="position:absolute;top:283px;left:298px;white-space:nowrap" class="ft3365">TPM</p>
<p style="position:absolute;top:283px;left:298px;white-space:nowrap" class="ft3365">TPM</p>
<p style="position:absolute;top:200px;left:641px;white-space:nowrap" class="ft3365">Dynamic</p>
<p style="position:absolute;top:212px;left:636px;white-space:nowrap" class="ft3365">Component</p>
<p style="position:absolute;top:200px;left:641px;white-space:nowrap" class="ft3365">Dynamic</p>
<p style="position:absolute;top:212px;left:636px;white-space:nowrap" class="ft3365">Component</p>
<p style="position:absolute;top:244px;left:653px;white-space:nowrap" class="ft3365">...</p>
<p style="position:absolute;top:273px;left:641px;white-space:nowrap" class="ft3365">Dynamic</p>
<p style="position:absolute;top:284px;left:636px;white-space:nowrap" class="ft3365">Component</p>
<p style="position:absolute;top:273px;left:641px;white-space:nowrap" class="ft3365">Dynamic</p>
<p style="position:absolute;top:284px;left:636px;white-space:nowrap" class="ft3365">Component</p>
<p style="position:absolute;top:290px;left:533px;white-space:nowrap" class="ft3365">Platform&#160;TCB</p>
<p style="position:absolute;top:259px;left:312px;white-space:nowrap" class="ft3366">hashes&#160;stored</p>
<p style="position:absolute;top:239px;left:584px;white-space:nowrap" class="ft3366">hashes&#160;stored</p>
<p style="position:absolute;top:334px;left:226px;white-space:nowrap" class="ft3315">Figure&#160;4.1:&#160;The&#160;position&#160;of&#160;the&#160;SRTM&#160;within&#160;the&#160;overall&#160;integrity&#160;management&#160;frame-<br/>work.</p>
<p style="position:absolute;top:393px;left:226px;white-space:nowrap" class="ft3315">Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#33">4.1&#160;</a>illustrates&#160;the&#160;position&#160;of&#160;the&#160;SRTM&#160;within&#160;the&#160;overall&#160;integrity&#160;management<br/>framework.</p>
<p style="position:absolute;top:429px;left:248px;white-space:nowrap" class="ft3312">Our&#160;framework&#160;has&#160;the&#160;following&#160;design&#160;objectives:</p>
<p style="position:absolute;top:473px;left:226px;white-space:nowrap" class="ft3317"><b>Unlimited&#160;measurement&#160;storage&#160;</b>The&#160;framework&#160;should&#160;allow&#160;the&#160;storage&#160;of&#160;individ-</p>
<p style="position:absolute;top:491px;left:263px;white-space:nowrap" class="ft3312">ual&#160;integrity&#160;measurements&#160;for&#160;an&#160;arbitrary&#160;number&#160;of&#160;components.</p>
<p style="position:absolute;top:519px;left:226px;white-space:nowrap" class="ft3317"><b>Explicit&#160;dependency&#160;representation&#160;</b>The&#160;framework&#160;should&#160;allow&#160;the&#160;explicit&#160;and</p>
<p style="position:absolute;top:537px;left:263px;white-space:nowrap" class="ft3315">unambiguous&#160;representation&#160;of&#160;an&#160;arbitrary&#160;number&#160;of&#160;dependencies&#160;between<br/>platform&#160;components.&#160;There&#160;should&#160;be&#160;no&#160;false&#160;or&#160;artificial&#160;dependencies&#160;intro-<br/>duced&#160;by&#160;aggregation.</p>
<p style="position:absolute;top:600px;left:226px;white-space:nowrap" class="ft3317"><b>Static&#160;integrity&#160;management&#160;</b>The&#160;framework&#160;should&#160;provide&#160;a&#160;super-set&#160;of&#160;the&#160;func-</p>
<p style="position:absolute;top:618px;left:263px;white-space:nowrap" class="ft3312">tionality&#160;of&#160;a&#160;traditional&#160;TPM,&#160;with&#160;respect&#160;to&#160;static&#160;integrity.</p>
<p style="position:absolute;top:646px;left:226px;white-space:nowrap" class="ft3317"><b>Dynamic&#160;integrity&#160;management&#160;</b>The&#160;framework&#160;should&#160;enable&#160;the&#160;integrity&#160;state&#160;of</p>
<p style="position:absolute;top:664px;left:263px;white-space:nowrap" class="ft3315">a&#160;platform&#160;component&#160;to&#160;revert&#160;to&#160;a&#160;previous&#160;trusted&#160;state&#160;in&#160;a&#160;controlled&#160;and<br/>verifiable&#160;manner.</p>
<p style="position:absolute;top:710px;left:226px;white-space:nowrap" class="ft3317"><b>Link&#160;to&#160;hardware&#160;TPM&#160;</b>The&#160;software&#160;framework&#160;should&#160;be&#160;linked&#160;in&#160;a&#160;chain&#160;of&#160;trust</p>
<p style="position:absolute;top:728px;left:263px;white-space:nowrap" class="ft3315">to&#160;the&#160;hardware&#160;TPM.&#160;This&#160;can&#160;be&#160;achieved&#160;by&#160;storing&#160;the&#160;measurements&#160;for&#160;the<br/>SRTM&#160;and&#160;other&#160;static&#160;components&#160;in&#160;the&#160;platform&#160;TCB&#160;(such&#160;as&#160;the&#160;hypervisor<br/>and&#160;any&#160;physical&#160;device&#160;drivers)&#160;in&#160;the&#160;TPM.&#160;As&#160;this&#160;set&#160;of&#160;components&#160;is&#160;small<br/>and&#160;non-changing,&#160;the&#160;limitations&#160;of&#160;a&#160;hardware&#160;TPM&#160;do&#160;not&#160;come&#160;into&#160;effect.</p>
<p style="position:absolute;top:810px;left:226px;white-space:nowrap" class="ft3317"><b>Minimal&#160;TCB&#160;</b>In&#160;order&#160;to&#160;improve&#160;the&#160;trustworthiness&#160;of&#160;the&#160;framework,&#160;the&#160;SRTM</p>
<p style="position:absolute;top:828px;left:263px;white-space:nowrap" class="ft3315">and&#160;other&#160;components&#160;in&#160;the&#160;TCB&#160;should&#160;have&#160;a&#160;minimal&#160;amount&#160;of&#160;code&#160;and&#160;size<br/>of&#160;interface.&#160;This&#160;paper&#160;does&#160;not&#160;focus&#160;on&#160;minimizing&#160;the&#160;TCB,&#160;but&#160;a&#160;possible<br/>approach&#160;would&#160;involve&#160;using&#160;disaggregation&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#77">[49]</a>.</p>
<p style="position:absolute;top:892px;left:226px;white-space:nowrap" class="ft3317"><b>Platform&#160;independence&#160;</b>The&#160;framework&#160;should&#160;not&#160;be&#160;limited&#160;to&#160;a&#160;single&#160;hypervisor</p>
<p style="position:absolute;top:910px;left:263px;white-space:nowrap" class="ft3315">technology.&#160;Although&#160;the&#160;implementation&#160;(see&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#44">4.6)&#160;</a>was&#160;carried&#160;out&#160;using<br/>Xen,&#160;it&#160;should&#160;be&#160;possible&#160;to&#160;use&#160;alternative&#160;technologies,&#160;such&#160;as&#160;VMware&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[70]<br/></a>or&#160;an&#160;L4&#160;microkernel&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#77">[43]</a>.</p>
<p style="position:absolute;top:1016px;left:226px;white-space:nowrap" class="ft3320"><b>4.3</b></p>
<p style="position:absolute;top:1016px;left:274px;white-space:nowrap" class="ft3320"><b>Basic&#160;Integrity&#160;Management</b></p>
<p style="position:absolute;top:1054px;left:226px;white-space:nowrap" class="ft3315">In&#160;this&#160;section,&#160;we&#160;present&#160;a&#160;basic&#160;design&#160;for&#160;the&#160;SRTM&#160;service&#160;that&#160;we&#160;introduced<br/>earlier.&#160;This&#160;platform-independent&#160;service&#160;provides&#160;the&#160;minimal&#160;functionality&#160;needed</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft3318">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 34 -->
<a name="34"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3467{font-size:12px;font-family:Courier;color:#000000;}
	.ft3468{font-size:9px;font-family:Courier;color:#000000;}
	.ft3469{font-size:19px;font-family:DMCZLT+TT1011Eo00;color:#000000;}
	.ft3470{font-size:13px;font-family:DUCRGK+TT1011Fo00;color:#000000;}
	.ft3471{font-size:22px;font-family:KPSHBO+TT10120o00;color:#000000;}
-->
</style>
<div id="page34-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL034.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft3412">32</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft3418">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:197px;left:275px;white-space:nowrap" class="ft3467">#</p>
<p style="position:absolute;top:197px;left:358px;white-space:nowrap" class="ft3467">CCRs</p>
<p style="position:absolute;top:197px;left:275px;white-space:nowrap" class="ft3467">#</p>
<p style="position:absolute;top:197px;left:358px;white-space:nowrap" class="ft3467">CCRs</p>
<p style="position:absolute;top:250px;left:211px;white-space:nowrap" class="ft3467">CCR03</p>
<p style="position:absolute;top:252px;left:267px;white-space:nowrap" class="ft3468"><b>2f:d2:c1:42:5c:ce:9e:ce:62:50:71:22:db:43:61:25:ab:82:be:55&#160;</b></p>
<p style="position:absolute;top:350px;left:150px;white-space:nowrap" class="ft3415">Figure&#160;4.2:&#160;Basic&#160;integrity&#160;management&#160;components&#160;–&#160;Component&#160;configuration&#160;reg-<br/>ister&#160;table.</p>
<p style="position:absolute;top:629px;left:383px;white-space:nowrap" class="ft3469">VMM&#160;and&#160;Hardware</p>
<p style="position:absolute;top:567px;left:507px;white-space:nowrap" class="ft3469">BMSI</p>
<p style="position:absolute;top:403px;left:265px;white-space:nowrap" class="ft3470">Management</p>
<p style="position:absolute;top:403px;left:368px;white-space:nowrap" class="ft3470">Protected&#160;Storage</p>
<p style="position:absolute;top:403px;left:500px;white-space:nowrap" class="ft3470">Integrity</p>
<p style="position:absolute;top:481px;left:518px;white-space:nowrap" class="ft3469">BIM</p>
<p style="position:absolute;top:536px;left:446px;white-space:nowrap" class="ft3471">...</p>
<p style="position:absolute;top:526px;left:266px;white-space:nowrap" class="ft3470">Management</p>
<p style="position:absolute;top:527px;left:372px;white-space:nowrap" class="ft3470">TPM</p>
<p style="position:absolute;top:686px;left:177px;white-space:nowrap" class="ft3412">Figure&#160;4.3:&#160;Basic&#160;integrity&#160;management&#160;components&#160;–&#160;The&#160;BIM&#160;architecture.</p>
<p style="position:absolute;top:734px;left:150px;white-space:nowrap" class="ft3415">to&#160;manage&#160;the&#160;integrity&#160;of&#160;dynamic&#160;(non-TCB)&#160;platform&#160;components,&#160;which&#160;will&#160;be<br/>extended&#160;further&#160;in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#37">4.4.&#160;</a>Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#34">4.3.1&#160;</a>sets&#160;out&#160;the&#160;basic&#160;measurement&#160;model,<br/>while&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#36">4.3.2&#160;</a>describes&#160;the&#160;corresponding&#160;service&#160;architecture&#160;and&#160;interfaces.</p>
<p style="position:absolute;top:829px;left:150px;white-space:nowrap" class="ft3444"><b>4.3.1</b></p>
<p style="position:absolute;top:829px;left:204px;white-space:nowrap" class="ft3444"><b>Measurement&#160;Model</b></p>
<p style="position:absolute;top:859px;left:150px;white-space:nowrap" class="ft3415">The&#160;Basic&#160;Integrity&#160;Management&#160;(BIM)&#160;service&#160;stores&#160;static&#160;integrity&#160;measurements&#160;of<br/>dynamic&#160;components&#160;that&#160;are&#160;arranged&#160;in&#160;a&#160;flat&#160;hierarchy,&#160;such&#160;as&#160;the&#160;one&#160;shown&#160;in<br/>Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#35">4.4.&#160;</a>Each&#160;component&#160;has&#160;a&#160;single&#160;Component&#160;Configuration&#160;Register&#160;(CCR)<br/>associated&#160;with&#160;it.&#160;A&#160;CCR&#160;is&#160;analogous&#160;to&#160;a&#160;PCR&#160;and&#160;holds&#160;integrity&#160;measurements&#160;for<br/>that&#160;component.&#160;The&#160;measurements&#160;are&#160;held&#160;together&#160;in&#160;a&#160;global&#160;CCR&#160;table&#160;similar&#160;to<br/>the&#160;one&#160;depicted&#160;in&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#34">4.2.</a></p>
<p style="position:absolute;top:1006px;left:150px;white-space:nowrap" class="ft3417"><b>Static&#160;Measurements</b></p>
<p style="position:absolute;top:1034px;left:150px;white-space:nowrap" class="ft3415">The&#160;BIM&#160;measurement&#160;model&#160;mimics&#160;TPM&#160;measurement&#160;capabilities&#160;but&#160;stores&#160;in-<br/>tegrity&#160;measurements&#160;in&#160;software&#160;rather&#160;than&#160;hardware.&#160;Each&#160;registered&#160;dynamic&#160;com-<br/>ponent&#160;is&#160;assigned&#160;a&#160;BIM&#160;CCR&#160;to&#160;which&#160;its&#160;measurements&#160;are&#160;reported.&#160;This&#160;is</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft3418">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 35 -->
<a name="35"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3572{font-size:9px;font-family:MEDLMS+TT1060Ao00;color:#ffffff;}
	.ft3573{font-size:9px;font-family:QEHNHK+TT1060Bo00;color:#000000;}
	.ft3574{font-size:10px;font-family:MEDLMS+TT1060Co00;color:#000000;}
	.ft3575{font-size:9px;font-family:VNZQXL+TT1060Do00;color:#000000;}
	.ft3576{font-size:10px;font-family:MEDLMS+TT1060Fo00;color:#ffffff;}
	.ft3577{font-size:10px;font-family:MEDLMS+TT1060Fo00;color:#000000;}
	.ft3578{font-size:10px;font-family:QAKHSM+CMR7;color:#000000;}
-->
</style>
<div id="page35-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL035.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft3512">CHAPTER&#160;4.&#160;HIERARCHICAL&#160;INTEGRITY&#160;MANAGEMENT</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft3512">33</p>
<p style="position:absolute;top:192px;left:509px;white-space:nowrap" class="ft3572">CID</p>
<p style="position:absolute;top:192px;left:533px;white-space:nowrap" class="ft3572">PID</p>
<p style="position:absolute;top:206px;left:513px;white-space:nowrap" class="ft3573">0</p>
<p style="position:absolute;top:206px;left:538px;white-space:nowrap" class="ft3573">-</p>
<p style="position:absolute;top:220px;left:513px;white-space:nowrap" class="ft3573">1</p>
<p style="position:absolute;top:220px;left:537px;white-space:nowrap" class="ft3573">0</p>
<p style="position:absolute;top:234px;left:513px;white-space:nowrap" class="ft3573">2</p>
<p style="position:absolute;top:234px;left:537px;white-space:nowrap" class="ft3573">0</p>
<p style="position:absolute;top:248px;left:513px;white-space:nowrap" class="ft3573">3</p>
<p style="position:absolute;top:248px;left:537px;white-space:nowrap" class="ft3573">0</p>
<p style="position:absolute;top:192px;left:509px;white-space:nowrap" class="ft3572">CID</p>
<p style="position:absolute;top:192px;left:533px;white-space:nowrap" class="ft3572">PID</p>
<p style="position:absolute;top:206px;left:513px;white-space:nowrap" class="ft3573">0</p>
<p style="position:absolute;top:206px;left:538px;white-space:nowrap" class="ft3573">-</p>
<p style="position:absolute;top:220px;left:513px;white-space:nowrap" class="ft3573">1</p>
<p style="position:absolute;top:220px;left:537px;white-space:nowrap" class="ft3573">0</p>
<p style="position:absolute;top:234px;left:513px;white-space:nowrap" class="ft3573">2</p>
<p style="position:absolute;top:234px;left:537px;white-space:nowrap" class="ft3573">0</p>
<p style="position:absolute;top:248px;left:513px;white-space:nowrap" class="ft3573">3</p>
<p style="position:absolute;top:248px;left:537px;white-space:nowrap" class="ft3573">0</p>
<p style="position:absolute;top:189px;left:334px;white-space:nowrap" class="ft3574">1</p>
<p style="position:absolute;top:189px;left:380px;white-space:nowrap" class="ft3574">22</p>
<p style="position:absolute;top:189px;left:426px;white-space:nowrap" class="ft3574">33</p>
<p style="position:absolute;top:262px;left:423px;white-space:nowrap" class="ft3575">Platform&#160;TCB</p>
<p style="position:absolute;top:235px;left:355px;white-space:nowrap" class="ft3575">VM</p>
<p style="position:absolute;top:235px;left:402px;white-space:nowrap" class="ft3575">VM</p>
<p style="position:absolute;top:235px;left:448px;white-space:nowrap" class="ft3575">VM</p>
<p style="position:absolute;top:255px;left:334px;white-space:nowrap" class="ft3574">0</p>
<p style="position:absolute;top:230px;left:604px;white-space:nowrap" class="ft3576">00</p>
<p style="position:absolute;top:192px;left:579px;white-space:nowrap" class="ft3577">11</p>
<p style="position:absolute;top:192px;left:604px;white-space:nowrap" class="ft3577">22</p>
<p style="position:absolute;top:192px;left:629px;white-space:nowrap" class="ft3577">33</p>
<p style="position:absolute;top:304px;left:320px;white-space:nowrap" class="ft3512">Figure&#160;4.4:&#160;Simple&#160;integrity&#160;use&#160;case&#160;–&#160;a&#160;flat&#160;hierarchy.</p>
<p style="position:absolute;top:352px;left:226px;white-space:nowrap" class="ft3512">achieved&#160;by&#160;an</p>
<p style="position:absolute;top:353px;left:325px;white-space:nowrap" class="ft3559">extend</p>
<p style="position:absolute;top:352px;left:384px;white-space:nowrap" class="ft3512">operation,&#160;which&#160;stores&#160;a&#160;new&#160;measurement&#160;in&#160;a&#160;CCR&#160;by</p>
<p style="position:absolute;top:370px;left:226px;white-space:nowrap" class="ft3515">hashing&#160;it&#160;together&#160;with&#160;the&#160;current&#160;value&#160;of&#160;the&#160;CCR.&#160;Dynamic&#160;components&#160;use&#160;this<br/>operation&#160;to&#160;report&#160;ongoing&#160;measurements&#160;when&#160;their&#160;contents&#160;change.&#160;For&#160;example,<br/>a&#160;firewall&#160;service&#160;would&#160;extend&#160;its&#160;CCR&#160;if&#160;its&#160;rule-set&#160;was&#160;about&#160;to&#160;be&#160;changed.&#160;The<br/>specifics&#160;of&#160;when/how&#160;measurements&#160;are&#160;taken&#160;is&#160;component-dependent,&#160;but&#160;the&#160;logic<br/>that&#160;performs&#160;this&#160;activity&#160;must&#160;be&#160;trusted&#160;to&#160;report&#160;changes&#160;faithfully.&#160;This&#160;behavior<br/>is&#160;assured&#160;by&#160;the&#160;initial&#160;measurement&#160;of&#160;the&#160;component&#160;by&#160;the&#160;component&#160;that&#160;starts&#160;it.<br/>In&#160;the&#160;BIM&#160;model,&#160;this&#160;can&#160;only&#160;be&#160;a&#160;static&#160;(platform&#160;TCB)&#160;component.</p>
<p style="position:absolute;top:495px;left:248px;white-space:nowrap" class="ft3512">This&#160;measurement&#160;model&#160;provides&#160;better&#160;scalability&#160;than&#160;models&#160;that&#160;use&#160;the&#160;TPM</p>
<p style="position:absolute;top:513px;left:226px;white-space:nowrap" class="ft3515">as&#160;the&#160;sole&#160;repository&#160;for&#160;measurements.&#160;By&#160;using&#160;software&#160;registers,&#160;the&#160;BIM&#160;can<br/>store&#160;a&#160;virtually&#160;unlimited&#160;number&#160;of&#160;individual&#160;measurements.&#160;Hence,&#160;no&#160;aggregation<br/>is&#160;needed.&#160;However,&#160;the&#160;measurements&#160;are&#160;still&#160;accumulated&#160;and&#160;the&#160;CCRs&#160;are&#160;irre-<br/>versible.&#160;That&#160;is,&#160;recording&#160;a&#160;measurement</p>
<p style="position:absolute;top:566px;left:490px;white-space:nowrap" class="ft3529">M</p>
<p style="position:absolute;top:572px;left:505px;white-space:nowrap" class="ft3578">1</p>
<p style="position:absolute;top:567px;left:512px;white-space:nowrap" class="ft3512">,&#160;followed&#160;by&#160;a&#160;changed&#160;measurement</p>
<p style="position:absolute;top:584px;left:226px;white-space:nowrap" class="ft3529">M</p>
<p style="position:absolute;top:590px;left:241px;white-space:nowrap" class="ft3578">2</p>
<p style="position:absolute;top:585px;left:247px;white-space:nowrap" class="ft3512">,&#160;followed&#160;by</p>
<p style="position:absolute;top:584px;left:333px;white-space:nowrap" class="ft3529">M</p>
<p style="position:absolute;top:590px;left:347px;white-space:nowrap" class="ft3578">1</p>
<p style="position:absolute;top:585px;left:359px;white-space:nowrap" class="ft3512">again,&#160;results&#160;in&#160;a&#160;different&#160;value&#160;than&#160;the&#160;original&#160;recording&#160;of</p>
<p style="position:absolute;top:602px;left:226px;white-space:nowrap" class="ft3529">M</p>
<p style="position:absolute;top:608px;left:241px;white-space:nowrap" class="ft3578">1</p>
<p style="position:absolute;top:603px;left:252px;white-space:nowrap" class="ft3512">alone.&#160;Hence,&#160;components&#160;are&#160;not&#160;allowed&#160;to&#160;change&#160;in&#160;any&#160;way&#160;without&#160;perma-</p>
<p style="position:absolute;top:621px;left:226px;white-space:nowrap" class="ft3515">nent&#160;loss&#160;of&#160;integrity.&#160;Even&#160;if&#160;a&#160;change&#160;is&#160;later&#160;undone,&#160;the&#160;component&#160;cannot&#160;return<br/>to&#160;its&#160;previous&#160;trust&#160;state.&#160;In&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#37">4.4,&#160;</a>we&#160;will&#160;address&#160;this&#160;problem&#160;by&#160;employing<br/>dynamic&#160;registers&#160;for&#160;reversible&#160;measurements.</p>
<p style="position:absolute;top:714px;left:226px;white-space:nowrap" class="ft3517"><b>Simple&#160;Trust&#160;Dependency</b></p>
<p style="position:absolute;top:742px;left:226px;white-space:nowrap" class="ft3515">The&#160;BIM&#160;service&#160;implements&#160;a&#160;flat&#160;hierarchy&#160;to&#160;capture&#160;the&#160;integrity&#160;dependencies<br/>between&#160;platform&#160;components.&#160;In&#160;this&#160;model,&#160;the&#160;integrity&#160;of&#160;dynamic&#160;components<br/>solely&#160;depends&#160;on&#160;the&#160;integrity&#160;of&#160;the&#160;underlying&#160;platform&#160;TCB.&#160;We&#160;show&#160;an&#160;example<br/>flat&#160;hierarchy&#160;in&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#35">4.4.&#160;</a>The&#160;components&#160;labeled&#160;<i>one</i>,&#160;<i>two</i>,&#160;and&#160;<i>three&#160;</i>are&#160;virtual<br/>machines&#160;running&#160;directly&#160;on&#160;the&#160;trusted&#160;platform.&#160;Component&#160;<i>zero&#160;</i>is&#160;the&#160;platform<br/>TCB&#160;that&#160;includes&#160;the&#160;SRTM&#160;(in&#160;this&#160;case,&#160;the&#160;BIM&#160;service).&#160;Each&#160;VM&#160;depends&#160;only<br/>on&#160;the&#160;platform&#160;TCB&#160;underneath.&#160;If&#160;the&#160;integrity&#160;of&#160;the&#160;TCB&#160;(component&#160;<i>zero</i>)&#160;is<br/>compromised,&#160;then&#160;the&#160;integrity&#160;of&#160;all&#160;of&#160;the&#160;VMs&#160;is&#160;compromised&#160;as&#160;well.&#160;However,<br/>the&#160;VMs&#160;are&#160;independent&#160;of&#160;one&#160;another&#160;and&#160;therefore&#160;do&#160;not&#160;have&#160;a&#160;trust&#160;dependency.<br/>As&#160;an&#160;example,&#160;if&#160;the&#160;integrity&#160;of&#160;VM</p>
<p style="position:absolute;top:909px;left:449px;white-space:nowrap" class="ft3578">1</p>
<p style="position:absolute;top:904px;left:459px;white-space:nowrap" class="ft3512">is&#160;compromised,&#160;the&#160;integrity&#160;of&#160;VM</p>
<p style="position:absolute;top:909px;left:676px;white-space:nowrap" class="ft3578">2</p>
<p style="position:absolute;top:904px;left:686px;white-space:nowrap" class="ft3512">and&#160;VM</p>
<p style="position:absolute;top:909px;left:735px;white-space:nowrap" class="ft3578">3</p>
<p style="position:absolute;top:922px;left:226px;white-space:nowrap" class="ft3512">remains&#160;intact.</p>
<p style="position:absolute;top:940px;left:248px;white-space:nowrap" class="ft3512">In&#160;what&#160;follows,&#160;we&#160;depict&#160;the&#160;integrity&#160;relationships&#160;between&#160;components&#160;using</p>
<p style="position:absolute;top:958px;left:226px;white-space:nowrap" class="ft3515">a&#160;dependency&#160;graph,&#160;and&#160;represent&#160;it&#160;using&#160;a&#160;dependency&#160;table.&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#35">4.4&#160;</a>shows&#160;a<br/>simple&#160;graph&#160;and&#160;its&#160;dependency&#160;table&#160;equivalent.&#160;For&#160;example,&#160;the&#160;second&#160;row&#160;in&#160;the<br/>dependency&#160;table&#160;states&#160;that&#160;the&#160;integrity&#160;of&#160;the&#160;child&#160;component&#160;<i>one&#160;</i>(VM</p>
<p style="position:absolute;top:999px;left:677px;white-space:nowrap" class="ft3578">1</p>
<p style="position:absolute;top:994px;left:683px;white-space:nowrap" class="ft3512">)&#160;depends</p>
<p style="position:absolute;top:1011px;left:226px;white-space:nowrap" class="ft3512">on&#160;the&#160;integrity&#160;of&#160;the&#160;parent&#160;component&#160;<i>zero&#160;</i>(TCB).</p>
<p style="position:absolute;top:1029px;left:248px;white-space:nowrap" class="ft3512">In&#160;the&#160;simple&#160;BIM&#160;model,&#160;there&#160;is&#160;always&#160;a&#160;single&#160;trusted&#160;component&#160;(the&#160;plat-</p>
<p style="position:absolute;top:1047px;left:226px;white-space:nowrap" class="ft3515">form&#160;TCB)&#160;on&#160;which&#160;all&#160;other&#160;components&#160;depend.&#160;This&#160;yields&#160;the&#160;“flat&#160;hierarchy”<br/>dependency&#160;graph&#160;and&#160;table&#160;in&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#35">4.4.&#160;</a>The&#160;flat&#160;hierarchy&#160;arises,&#160;because&#160;a&#160;dynamic</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft3518">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 36 -->
<a name="36"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft3679{font-size:13px;font-family:Times;color:#000000;}
	.ft3680{font-size:13px;line-height:17px;font-family:Times;color:#000000;}
	.ft3681{font-size:15px;line-height:17px;font-family:Times;color:#000000;}
-->
</style>
<div id="page36-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL036.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft3612">34</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft3618">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:195px;left:159px;white-space:nowrap" class="ft3617"><b>Integrity</b></p>
<p style="position:absolute;top:195px;left:282px;white-space:nowrap" class="ft3617"><b>Description</b></p>
<p style="position:absolute;top:215px;left:159px;white-space:nowrap" class="ft3660">extend</p>
<p style="position:absolute;top:214px;left:282px;white-space:nowrap" class="ft3680">Takes&#160;a&#160;hash&#160;value&#160;as&#160;an&#160;argument&#160;and&#160;irreversibly&#160;extends&#160;the&#160;com-<br/>ponent&#160;CCR&#160;with&#160;that&#160;hash.</p>
<p style="position:absolute;top:251px;left:159px;white-space:nowrap" class="ft3660">quote</p>
<p style="position:absolute;top:250px;left:282px;white-space:nowrap" class="ft3680">Takes&#160;arbitrary&#160;external&#160;data&#160;(i.e.,&#160;nonce)&#160;and&#160;returns&#160;a&#160;quotation&#160;of<br/>the&#160;current&#160;TCB&#160;measurements,&#160;the&#160;nonce,&#160;and&#160;the&#160;component&#160;CCR<br/>value&#160;signed&#160;by&#160;a&#160;TPM&#160;attestation&#160;identity&#160;key&#160;(AIK).</p>
<p style="position:absolute;top:307px;left:159px;white-space:nowrap" class="ft3681"><b>Protected&#160;Stor-<br/>age</b></p>
<p style="position:absolute;top:307px;left:282px;white-space:nowrap" class="ft3617"><b>Description</b></p>
<p style="position:absolute;top:345px;left:159px;white-space:nowrap" class="ft3660">seal</p>
<p style="position:absolute;top:344px;left:282px;white-space:nowrap" class="ft3680">Takes&#160;data&#160;to&#160;be&#160;protected,&#160;seals&#160;it&#160;to&#160;the&#160;TPM&#160;binding&#160;it&#160;to&#160;current<br/>TCB&#160;and&#160;CCR&#160;measurements,&#160;and&#160;returns&#160;the&#160;sealed&#160;(encrypted)&#160;blob.</p>
<p style="position:absolute;top:381px;left:159px;white-space:nowrap" class="ft3660">unseal</p>
<p style="position:absolute;top:380px;left:282px;white-space:nowrap" class="ft3680">Takes&#160;the&#160;sealed&#160;blob&#160;and&#160;unseals&#160;and&#160;returns&#160;the&#160;data&#160;iff&#160;the&#160;integrity<br/>of&#160;the&#160;TCB&#160;and&#160;the&#160;component&#160;are&#160;verified&#160;as&#160;intact.</p>
<p style="position:absolute;top:418px;left:159px;white-space:nowrap" class="ft3617"><b>Management</b></p>
<p style="position:absolute;top:418px;left:282px;white-space:nowrap" class="ft3617"><b>Description</b></p>
<p style="position:absolute;top:439px;left:159px;white-space:nowrap" class="ft3660">register</p>
<p style="position:absolute;top:438px;left:282px;white-space:nowrap" class="ft3680">Takes&#160;the&#160;initial&#160;measurement,&#160;adds&#160;the&#160;component&#160;to&#160;the&#160;dependency<br/>table,&#160;and&#160;fills&#160;the&#160;CCR&#160;with&#160;the&#160;initial&#160;measurement.</p>
<p style="position:absolute;top:474px;left:159px;white-space:nowrap" class="ft3660">delete</p>
<p style="position:absolute;top:474px;left:282px;white-space:nowrap" class="ft3679">Deletes&#160;the&#160;component&#160;and&#160;all&#160;its&#160;sealed&#160;data.</p>
<p style="position:absolute;top:508px;left:193px;white-space:nowrap" class="ft3612">Table&#160;4.1:&#160;BIM&#160;integrity,&#160;protected&#160;storage,&#160;and&#160;management&#160;interfaces.</p>
<p style="position:absolute;top:540px;left:150px;white-space:nowrap" class="ft3615">component&#160;(such&#160;as&#160;a&#160;VM)&#160;can&#160;only&#160;be&#160;started&#160;by&#160;a&#160;trusted&#160;component.&#160;Since&#160;the&#160;TCB<br/>is&#160;static&#160;and&#160;platform-wide,&#160;it&#160;is&#160;not&#160;possible&#160;for&#160;a&#160;dynamic&#160;component&#160;to&#160;start&#160;–&#160;and<br/>hence&#160;become&#160;a&#160;parent&#160;of&#160;–&#160;another&#160;dynamic&#160;component.&#160;Therefore&#160;the&#160;BIM&#160;cannot<br/>manage,&#160;for&#160;example,&#160;the&#160;integrity&#160;of&#160;an&#160;application&#160;started&#160;within&#160;a&#160;VM.&#160;However,&#160;the<br/>BIM&#160;serves&#160;as&#160;a&#160;basis&#160;to&#160;build&#160;the&#160;hierarchical&#160;model&#160;which&#160;addresses&#160;this&#160;limitation,<br/>which&#160;is&#160;introduced&#160;in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#37">4.4.</a></p>
<p style="position:absolute;top:688px;left:150px;white-space:nowrap" class="ft3644"><b>4.3.2</b></p>
<p style="position:absolute;top:688px;left:204px;white-space:nowrap" class="ft3644"><b>The&#160;BIM&#160;Architecture</b></p>
<p style="position:absolute;top:719px;left:150px;white-space:nowrap" class="ft3612">As&#160;shown&#160;in&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#34">4.3,&#160;</a>BIM&#160;services&#160;are&#160;grouped&#160;under&#160;three&#160;interfaces:</p>
<p style="position:absolute;top:766px;left:150px;white-space:nowrap" class="ft3617"><b>Integrity&#160;interface&#160;</b>This&#160;interface&#160;provides&#160;functions&#160;to&#160;report&#160;and&#160;quote&#160;integrity</p>
<p style="position:absolute;top:784px;left:187px;white-space:nowrap" class="ft3615">measurements&#160;of&#160;dynamic&#160;(i.e.,&#160;non-TCB)&#160;components.&#160;Components&#160;use&#160;this<br/>interface&#160;to&#160;extend&#160;their&#160;register&#160;values&#160;when&#160;they&#160;detect&#160;significant&#160;changes&#160;to<br/>their&#160;measured&#160;content.&#160;A&#160;component&#160;is&#160;only&#160;allowed&#160;to&#160;alter&#160;its&#160;own&#160;register,<br/>while&#160;an&#160;integrity&#160;quote&#160;can&#160;be&#160;requested&#160;by&#160;any&#160;entity.&#160;Using&#160;the&#160;underlying<br/>TPM&#160;interface,&#160;the&#160;latter&#160;operation&#160;returns&#160;a&#160;signed&#160;integrity&#160;digest&#160;that&#160;contains<br/>the&#160;measurements&#160;of&#160;the&#160;dynamic&#160;component&#160;and&#160;the&#160;platform&#160;TCB.&#160;Using&#160;this<br/>digest,&#160;a&#160;third&#160;party&#160;can&#160;verify&#160;the&#160;complete&#160;integrity&#160;chain.</p>
<p style="position:absolute;top:922px;left:150px;white-space:nowrap" class="ft3617"><b>Protected&#160;storage&#160;interface&#160;</b>This&#160;interface&#160;provides&#160;functions&#160;to&#160;store&#160;and&#160;reveal&#160;se-</p>
<p style="position:absolute;top:940px;left:187px;white-space:nowrap" class="ft3615">crets&#160;on&#160;behalf&#160;of&#160;dynamic&#160;components.&#160;These&#160;secrets&#160;are&#160;bound&#160;to&#160;the&#160;integrity<br/>of&#160;the&#160;TCB&#160;and&#160;the&#160;owner&#160;component,&#160;i.e.,&#160;they&#160;are&#160;revealed&#160;if&#160;and&#160;only&#160;if&#160;the<br/>integrity&#160;of&#160;the&#160;component&#160;and&#160;its&#160;ancestors&#160;(in&#160;the&#160;BIM&#160;case,&#160;the&#160;platform&#160;TCB)<br/>is&#160;intact.&#160;The&#160;BIM&#160;uses&#160;the&#160;underlying&#160;TPM&#160;interface&#160;for&#160;sealing&#160;and&#160;unsealing<br/>data&#160;to&#160;and&#160;from&#160;the&#160;TPM,&#160;which&#160;automatically&#160;implies&#160;a&#160;verification&#160;check&#160;on<br/>the&#160;TCB.&#160;Verification&#160;of&#160;the&#160;component’s&#160;integrity&#160;can&#160;be&#160;done&#160;either&#160;by&#160;the&#160;BIM<br/>or&#160;delegated&#160;to&#160;a&#160;third-party&#160;verifier.&#160;Our&#160;prototype&#160;implements&#160;the&#160;former&#160;case<br/>in&#160;which&#160;the&#160;BIM&#160;needs&#160;to&#160;store&#160;the&#160;expected&#160;measurements&#160;for&#160;comparison.&#160;We</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft3618">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 37 -->
<a name="37"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page37-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL037.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft3712">CHAPTER&#160;4.&#160;HIERARCHICAL&#160;INTEGRITY&#160;MANAGEMENT</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft3712">35</p>
<p style="position:absolute;top:193px;left:263px;white-space:nowrap" class="ft3715">use&#160;the&#160;TPM&#160;sealing&#160;operation&#160;itself&#160;to&#160;do&#160;so&#160;and&#160;use&#160;the&#160;CCR&#160;values&#160;at&#160;the&#160;time<br/>of&#160;sealing&#160;as&#160;the&#160;future&#160;expected&#160;values.&#160;We&#160;concatenate&#160;these&#160;values&#160;to&#160;the&#160;se-<br/>cret&#160;and&#160;seal&#160;the&#160;whole&#160;blob.&#160;The&#160;unsealing&#160;operation&#160;at&#160;a&#160;later&#160;time&#160;returns&#160;not<br/>only&#160;the&#160;sealed&#160;secret&#160;but&#160;also&#160;the&#160;expected&#160;set&#160;of&#160;measurements&#160;that&#160;we&#160;compare<br/>to&#160;the&#160;CCR&#160;values&#160;at&#160;that&#160;time.</p>
<p style="position:absolute;top:295px;left:226px;white-space:nowrap" class="ft3717"><b>Management&#160;interface&#160;</b>This&#160;interface&#160;provides&#160;functions&#160;to&#160;register&#160;dynamic&#160;compo-</p>
<p style="position:absolute;top:313px;left:263px;white-space:nowrap" class="ft3715">nents&#160;to&#160;the&#160;framework&#160;so&#160;that&#160;their&#160;integrity&#160;can&#160;be&#160;tracked&#160;by&#160;the&#160;BIM.&#160;The&#160;BIM<br/>is&#160;a&#160;passive&#160;service,&#160;and&#160;so&#160;only&#160;registered&#160;components&#160;are&#160;tracked.&#160;As&#160;discussed<br/>in&#160;the&#160;previous&#160;sections,&#160;the&#160;initial&#160;measurement&#160;of&#160;the&#160;component&#160;is&#160;provided<br/>from&#160;outside&#160;by&#160;a&#160;trusted&#160;component&#160;that&#160;measures&#160;and&#160;initiates&#160;the&#160;component.<br/>The&#160;interface&#160;also&#160;allows&#160;the&#160;deletion&#160;of&#160;components&#160;and&#160;their&#160;sealed&#160;data.</p>
<p style="position:absolute;top:415px;left:248px;white-space:nowrap" class="ft3712">Table&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#36">4.1&#160;</a>details&#160;the&#160;individual&#160;functions&#160;provided&#160;by&#160;each&#160;interface.&#160;As&#160;shown&#160;in</p>
<p style="position:absolute;top:433px;left:226px;white-space:nowrap" class="ft3715">Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#34">4.3,&#160;</a>the&#160;BIM,&#160;in&#160;turn,&#160;makes&#160;use&#160;of&#160;the&#160;Basic&#160;Management&#160;and&#160;Security&#160;Interface<br/>(BMSI),&#160;which&#160;provides&#160;a&#160;platform-agnostic&#160;interface&#160;to&#160;the&#160;underlying&#160;hypervisor&#160;and<br/>hardware&#160;TPM.&#160;In&#160;particular,&#160;the&#160;BMSI&#160;provides&#160;functions&#160;that&#160;enable&#160;the&#160;BIM&#160;to<br/>access&#160;the&#160;TPM&#160;and&#160;establish&#160;a&#160;link&#160;to&#160;the&#160;hardware&#160;root&#160;of&#160;trust.&#160;The&#160;implementation<br/>of&#160;the&#160;BMSI&#160;is&#160;discussed&#160;in&#160;more&#160;detail&#160;in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#44">4.6.</a></p>
<p style="position:absolute;top:568px;left:226px;white-space:nowrap" class="ft3720"><b>4.4</b></p>
<p style="position:absolute;top:568px;left:274px;white-space:nowrap" class="ft3720"><b>Hierarchical&#160;Integrity&#160;Management</b></p>
<p style="position:absolute;top:606px;left:226px;white-space:nowrap" class="ft3715">In&#160;this&#160;section,&#160;we&#160;present&#160;an&#160;enhanced&#160;design&#160;for&#160;the&#160;SRTM&#160;service&#160;that&#160;we&#160;introduced<br/>in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#31">4.2.&#160;</a>This&#160;platform-independent&#160;service&#160;features&#160;dynamic&#160;measurements&#160;and<br/>a&#160;component&#160;hierarchy&#160;that&#160;we&#160;use&#160;to&#160;manage&#160;the&#160;integrity&#160;of&#160;dynamic&#160;(non-TCB)&#160;plat-<br/>form&#160;components&#160;more&#160;effectively.&#160;We&#160;describe&#160;the&#160;security&#160;model&#160;for&#160;measurements<br/>in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#37">4.4.1.&#160;</a>We&#160;describe&#160;the&#160;service&#160;architecture&#160;and&#160;interfaces&#160;in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#41">4.4.2.</a></p>
<p style="position:absolute;top:736px;left:226px;white-space:nowrap" class="ft3744"><b>4.4.1</b></p>
<p style="position:absolute;top:736px;left:280px;white-space:nowrap" class="ft3744"><b>Measurement&#160;Model</b></p>
<p style="position:absolute;top:767px;left:226px;white-space:nowrap" class="ft3715">The&#160;Hierarchical&#160;Integrity&#160;Management&#160;(HIM)&#160;service&#160;stores&#160;integrity&#160;measurements<br/>in&#160;a&#160;CCR&#160;table&#160;as&#160;illustrated&#160;in&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#34">4.2.&#160;</a>To&#160;overcome&#160;the&#160;shortcomings&#160;of&#160;the&#160;BIM<br/>model&#160;(e.g.,&#160;irreversible&#160;measurements),&#160;we&#160;have&#160;extended&#160;it&#160;by&#160;introducing&#160;two&#160;new<br/>concepts:&#160;dynamic&#160;measurements&#160;and&#160;hierarchical&#160;trust.</p>
<p style="position:absolute;top:878px;left:226px;white-space:nowrap" class="ft3717"><b>Dynamic&#160;Measurements</b></p>
<p style="position:absolute;top:906px;left:226px;white-space:nowrap" class="ft3715">The&#160;HIM&#160;measurement&#160;model&#160;enhances&#160;the&#160;BIM&#160;model&#160;in&#160;two&#160;ways.&#160;First,&#160;HIM&#160;allows<br/>multiple&#160;registers&#160;to&#160;be&#160;assigned&#160;to&#160;a&#160;single&#160;dynamic&#160;component.&#160;This&#160;way,&#160;component<br/>measurements&#160;can&#160;be&#160;tracked&#160;with&#160;better&#160;granularity.&#160;Second,&#160;HIM&#160;supports&#160;dynamic<br/>measurements&#160;that&#160;can&#160;be&#160;reported&#160;to&#160;a&#160;resettable&#160;register.&#160;This&#160;increases&#160;flexibility<br/>and&#160;allows&#160;a&#160;component&#160;to&#160;revert&#160;back&#160;to&#160;a&#160;trustworthy&#160;configuration&#160;if&#160;permitted&#160;by<br/>its&#160;change&#160;policy.</p>
<p style="position:absolute;top:1014px;left:248px;white-space:nowrap" class="ft3717"><b>Change&#160;types.&#160;</b>We&#160;distinguish&#160;two&#160;types&#160;of&#160;component&#160;changes.&#160;More&#160;specifically:</p>
<p style="position:absolute;top:1032px;left:226px;white-space:nowrap" class="ft3715">An&#160;<i>irreversible&#160;change&#160;</i>is&#160;one&#160;that&#160;requires&#160;the&#160;component&#160;to&#160;be&#160;restarted&#160;before&#160;its<br/>integrity&#160;can&#160;be&#160;re-established.&#160;Such&#160;a&#160;change&#160;is&#160;one&#160;made&#160;to&#160;the&#160;integrity-critical&#160;part<br/>of&#160;the&#160;component;&#160;that&#160;is,&#160;to&#160;the&#160;code&#160;or&#160;other&#160;data&#160;of&#160;the&#160;component&#160;that&#160;has&#160;a&#160;potential</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft3718">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 38 -->
<a name="38"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page38-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL038.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft3812">36</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft3818">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:427px;left:150px;white-space:nowrap" class="ft3815">Figure&#160;4.5:&#160;Transition&#160;diagram&#160;for&#160;component&#160;integrity&#160;states.&#160;A&#160;component&#160;in&#160;the<br/>non-critical&#160;state&#160;can&#160;be&#160;made&#160;intact&#160;by&#160;undoing&#160;dynamic&#160;changes,&#160;but&#160;the&#160;critical&#160;state<br/>can&#160;only&#160;return&#160;to&#160;the&#160;intact&#160;state&#160;by&#160;re-initialization.</p>
<p style="position:absolute;top:511px;left:150px;white-space:nowrap" class="ft3815">impact&#160;on&#160;the&#160;future&#160;ability&#160;of&#160;the&#160;component&#160;to&#160;implement&#160;its&#160;intended&#160;functionality<br/>correctly.&#160;An&#160;example&#160;of&#160;an&#160;irreversible&#160;change&#160;is&#160;a&#160;kernel&#160;loading&#160;an&#160;untrusted&#160;device<br/>driver&#160;as&#160;the&#160;driver&#160;may&#160;make&#160;a&#160;change&#160;to&#160;kernel&#160;memory&#160;that&#160;will&#160;persist&#160;even&#160;after&#160;it<br/>is&#160;unloaded.</p>
<p style="position:absolute;top:583px;left:172px;white-space:nowrap" class="ft3812">A&#160;<i>reversible&#160;change&#160;</i>is&#160;one&#160;in&#160;which&#160;the&#160;component&#160;is&#160;permitted&#160;to&#160;re-establish</p>
<p style="position:absolute;top:601px;left:150px;white-space:nowrap" class="ft3815">integrity&#160;without&#160;being&#160;completely&#160;reinitialized.&#160;Such&#160;a&#160;change&#160;is&#160;one&#160;made&#160;to&#160;a&#160;non-<br/>critical&#160;part&#160;of&#160;the&#160;component;&#160;that&#160;is,&#160;to&#160;code&#160;or&#160;other&#160;data&#160;of&#160;the&#160;component&#160;that&#160;has<br/>no&#160;direct&#160;or&#160;potential&#160;impact&#160;on&#160;the&#160;component’s&#160;future&#160;security.&#160;A&#160;component&#160;still<br/>loses&#160;its&#160;integrity&#160;if&#160;a&#160;change&#160;is&#160;made&#160;to&#160;it.&#160;However,&#160;depending&#160;on&#160;the&#160;exact&#160;nature<br/>of&#160;the&#160;change,&#160;we&#160;may&#160;permit&#160;the&#160;component&#160;to&#160;regain&#160;integrity&#160;(and&#160;therefore&#160;trust)<br/>by&#160;undoing&#160;the&#160;change&#160;and&#160;returning&#160;to&#160;its&#160;previous&#160;state.&#160;For&#160;example,&#160;changes&#160;to<br/>configuration&#160;parameters&#160;are&#160;often&#160;reversible&#160;–&#160;e.g.&#160;changing&#160;the&#160;identity&#160;certificate<br/>that&#160;a&#160;component&#160;uses.&#160;The&#160;integrity&#160;management&#160;system&#160;will&#160;need&#160;to&#160;note&#160;such&#160;a<br/>change&#160;in&#160;order&#160;to&#160;fully&#160;report&#160;the&#160;state&#160;of&#160;the&#160;platform,&#160;but&#160;the&#160;certificate&#160;may&#160;be<br/>safely&#160;changed&#160;back&#160;without&#160;causing&#160;security&#160;implications.&#160;Another&#160;example&#160;might&#160;be<br/>loading&#160;a&#160;trusted&#160;kernel&#160;module&#160;that&#160;is&#160;known&#160;not&#160;to&#160;leave&#160;any&#160;side&#160;effects&#160;after&#160;being<br/>unloaded.</p>
<p style="position:absolute;top:816px;left:172px;white-space:nowrap" class="ft3812">The&#160;categorization&#160;of&#160;a&#160;change&#160;as&#160;reversible&#160;or&#160;irreversible&#160;is&#160;component-dependent</p>
<p style="position:absolute;top:834px;left:150px;white-space:nowrap" class="ft3815">and&#160;will&#160;be&#160;set&#160;by&#160;each&#160;component’s&#160;own&#160;change-type&#160;policy.&#160;For&#160;example,&#160;a&#160;policy<br/>stating&#160;that&#160;all&#160;changes&#160;are&#160;irreversible&#160;reduces&#160;to&#160;the&#160;static&#160;measurement&#160;model.&#160;A<br/>component&#160;that&#160;permits&#160;reversible&#160;changes&#160;is&#160;referred&#160;to&#160;as&#160;a&#160;<i>dynamic&#160;component&#160;</i>(“dy-<br/>namic”&#160;because&#160;its&#160;integrity&#160;state&#160;may&#160;change&#160;multiple&#160;times).</p>
<p style="position:absolute;top:906px;left:172px;white-space:nowrap" class="ft3817"><b>Measurement&#160;reporting.&#160;</b>Recording&#160;dynamic&#160;measurements&#160;requires&#160;two&#160;mea-</p>
<p style="position:absolute;top:924px;left:150px;white-space:nowrap" class="ft3815">surement&#160;registers,&#160;a&#160;<i>static&#160;register&#160;</i>and&#160;a&#160;<i>dynamic&#160;register</i>,&#160;rather&#160;than&#160;the&#160;single&#160;reg-<br/>ister&#160;used&#160;in&#160;the&#160;static&#160;measurement&#160;model.&#160;Irreversible&#160;changes&#160;are&#160;reported&#160;to&#160;the<br/>static&#160;register&#160;in&#160;the&#160;same&#160;way&#160;as&#160;in&#160;the&#160;static&#160;measurement&#160;model;&#160;that&#160;is,&#160;the</p>
<p style="position:absolute;top:961px;left:612px;white-space:nowrap" class="ft3859">extend</p>
<p style="position:absolute;top:978px;left:150px;white-space:nowrap" class="ft3815">operation&#160;is&#160;used&#160;to&#160;combine&#160;the&#160;new&#160;measurement&#160;with&#160;the&#160;existing&#160;register&#160;value&#160;to<br/>obtain&#160;the&#160;new&#160;register&#160;value.</p>
<p style="position:absolute;top:1030px;left:313px;white-space:nowrap" class="ft3829">extend</p>
<p style="position:absolute;top:1030px;left:357px;white-space:nowrap" class="ft3828">(</p>
<p style="position:absolute;top:1030px;left:363px;white-space:nowrap" class="ft3829">R,&#160;M</p>
<p style="position:absolute;top:1030px;left:397px;white-space:nowrap" class="ft3828">)&#160;=</p>
<p style="position:absolute;top:1030px;left:423px;white-space:nowrap" class="ft3829">hash</p>
<p style="position:absolute;top:1030px;left:455px;white-space:nowrap" class="ft3828">(</p>
<p style="position:absolute;top:1030px;left:461px;white-space:nowrap" class="ft3829">R</p>
<p style="position:absolute;top:1030px;left:472px;white-space:nowrap" class="ft3833">||</p>
<p style="position:absolute;top:1030px;left:481px;white-space:nowrap" class="ft3829">M</p>
<p style="position:absolute;top:1030px;left:497px;white-space:nowrap" class="ft3828">)</p>
<p style="position:absolute;top:1058px;left:150px;white-space:nowrap" class="ft3812">where</p>
<p style="position:absolute;top:1057px;left:190px;white-space:nowrap" class="ft3829">R</p>
<p style="position:absolute;top:1058px;left:205px;white-space:nowrap" class="ft3812">is&#160;the&#160;value&#160;of&#160;the&#160;register&#160;and</p>
<p style="position:absolute;top:1057px;left:389px;white-space:nowrap" class="ft3829">M</p>
<p style="position:absolute;top:1058px;left:408px;white-space:nowrap" class="ft3812">is&#160;the&#160;measurement.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft3818">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 39 -->
<a name="39"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page39-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL039.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft3912">CHAPTER&#160;4.&#160;HIERARCHICAL&#160;INTEGRITY&#160;MANAGEMENT</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft3912">37</p>
<p style="position:absolute;top:193px;left:248px;white-space:nowrap" class="ft3912">By&#160;contrast,&#160;reversible&#160;changes&#160;are&#160;reported&#160;to&#160;the&#160;dynamic&#160;register&#160;by&#160;<i>replacing</i></p>
<p style="position:absolute;top:211px;left:226px;white-space:nowrap" class="ft3912">the&#160;previous&#160;value&#160;held&#160;in&#160;that&#160;register,&#160;using&#160;the</p>
<p style="position:absolute;top:212px;left:519px;white-space:nowrap" class="ft3959">reset</p>
<p style="position:absolute;top:211px;left:568px;white-space:nowrap" class="ft3912">operation.</p>
<p style="position:absolute;top:246px;left:426px;white-space:nowrap" class="ft3929">reset</p>
<p style="position:absolute;top:246px;left:460px;white-space:nowrap" class="ft3928">(</p>
<p style="position:absolute;top:246px;left:465px;white-space:nowrap" class="ft3929">R,&#160;M</p>
<p style="position:absolute;top:246px;left:500px;white-space:nowrap" class="ft3928">)&#160;=</p>
<p style="position:absolute;top:246px;left:525px;white-space:nowrap" class="ft3929">M</p>
<p style="position:absolute;top:273px;left:248px;white-space:nowrap" class="ft3912">We&#160;can&#160;see&#160;that&#160;attempting&#160;to&#160;reverse&#160;an&#160;irreversible&#160;change&#160;does&#160;not&#160;return&#160;the</p>
<p style="position:absolute;top:291px;left:226px;white-space:nowrap" class="ft3912">static&#160;register&#160;to&#160;its&#160;initial&#160;state:</p>
<p style="position:absolute;top:320px;left:226px;white-space:nowrap" class="ft3929">R</p>
<p style="position:absolute;top:326px;left:237px;white-space:nowrap" class="ft3943">f&#160;inal</p>
<p style="position:absolute;top:320px;left:271px;white-space:nowrap" class="ft3928">=</p>
<p style="position:absolute;top:320px;left:287px;white-space:nowrap" class="ft3929">extend</p>
<p style="position:absolute;top:320px;left:332px;white-space:nowrap" class="ft3928">(</p>
<p style="position:absolute;top:320px;left:337px;white-space:nowrap" class="ft3929">extend</p>
<p style="position:absolute;top:320px;left:382px;white-space:nowrap" class="ft3928">(</p>
<p style="position:absolute;top:320px;left:388px;white-space:nowrap" class="ft3929">R</p>
<p style="position:absolute;top:326px;left:399px;white-space:nowrap" class="ft3943">initial</p>
<p style="position:absolute;top:320px;left:435px;white-space:nowrap" class="ft3929">,&#160;M</p>
<p style="position:absolute;top:327px;left:456px;white-space:nowrap" class="ft3978">2</p>
<p style="position:absolute;top:320px;left:463px;white-space:nowrap" class="ft3928">)</p>
<p style="position:absolute;top:320px;left:468px;white-space:nowrap" class="ft3929">,&#160;M</p>
<p style="position:absolute;top:327px;left:490px;white-space:nowrap" class="ft3978">1</p>
<p style="position:absolute;top:320px;left:496px;white-space:nowrap" class="ft3928">)&#160;=</p>
<p style="position:absolute;top:320px;left:522px;white-space:nowrap" class="ft3929">hash</p>
<p style="position:absolute;top:320px;left:554px;white-space:nowrap" class="ft3928">(</p>
<p style="position:absolute;top:320px;left:560px;white-space:nowrap" class="ft3929">hash</p>
<p style="position:absolute;top:320px;left:592px;white-space:nowrap" class="ft3928">(</p>
<p style="position:absolute;top:320px;left:598px;white-space:nowrap" class="ft3929">R</p>
<p style="position:absolute;top:326px;left:609px;white-space:nowrap" class="ft3943">initial</p>
<p style="position:absolute;top:320px;left:645px;white-space:nowrap" class="ft3933">||</p>
<p style="position:absolute;top:320px;left:653px;white-space:nowrap" class="ft3929">M</p>
<p style="position:absolute;top:327px;left:668px;white-space:nowrap" class="ft3978">2</p>
<p style="position:absolute;top:320px;left:674px;white-space:nowrap" class="ft3928">)</p>
<p style="position:absolute;top:320px;left:680px;white-space:nowrap" class="ft3933">||</p>
<p style="position:absolute;top:320px;left:688px;white-space:nowrap" class="ft3929">M</p>
<p style="position:absolute;top:327px;left:703px;white-space:nowrap" class="ft3978">1</p>
<p style="position:absolute;top:320px;left:710px;white-space:nowrap" class="ft3928">)</p>
<p style="position:absolute;top:320px;left:720px;white-space:nowrap" class="ft3933">6</p>
<p style="position:absolute;top:320px;left:720px;white-space:nowrap" class="ft3928">=</p>
<p style="position:absolute;top:320px;left:735px;white-space:nowrap" class="ft3929">R</p>
<p style="position:absolute;top:326px;left:747px;white-space:nowrap" class="ft3943">initial</p>
<p style="position:absolute;top:352px;left:248px;white-space:nowrap" class="ft3912">However,&#160;reversing&#160;a&#160;reversible&#160;change&#160;<i>does&#160;</i>return&#160;the&#160;dynamic&#160;register&#160;to&#160;its&#160;initial</p>
<p style="position:absolute;top:370px;left:226px;white-space:nowrap" class="ft3912">state:</p>
<p style="position:absolute;top:417px;left:246px;white-space:nowrap" class="ft3929">R</p>
<p style="position:absolute;top:423px;left:257px;white-space:nowrap" class="ft3943">f&#160;inal</p>
<p style="position:absolute;top:417px;left:291px;white-space:nowrap" class="ft3928">=</p>
<p style="position:absolute;top:417px;left:307px;white-space:nowrap" class="ft3929">reset</p>
<p style="position:absolute;top:417px;left:340px;white-space:nowrap" class="ft3928">(</p>
<p style="position:absolute;top:417px;left:346px;white-space:nowrap" class="ft3929">reset</p>
<p style="position:absolute;top:417px;left:380px;white-space:nowrap" class="ft3928">(</p>
<p style="position:absolute;top:417px;left:385px;white-space:nowrap" class="ft3929">R</p>
<p style="position:absolute;top:423px;left:397px;white-space:nowrap" class="ft3943">initial</p>
<p style="position:absolute;top:417px;left:432px;white-space:nowrap" class="ft3929">,&#160;M</p>
<p style="position:absolute;top:424px;left:454px;white-space:nowrap" class="ft3978">2</p>
<p style="position:absolute;top:417px;left:460px;white-space:nowrap" class="ft3928">)</p>
<p style="position:absolute;top:417px;left:466px;white-space:nowrap" class="ft3929">,&#160;M</p>
<p style="position:absolute;top:424px;left:487px;white-space:nowrap" class="ft3978">1</p>
<p style="position:absolute;top:417px;left:494px;white-space:nowrap" class="ft3928">)&#160;=</p>
<p style="position:absolute;top:417px;left:520px;white-space:nowrap" class="ft3929">reset</p>
<p style="position:absolute;top:417px;left:553px;white-space:nowrap" class="ft3928">(</p>
<p style="position:absolute;top:417px;left:559px;white-space:nowrap" class="ft3929">M</p>
<p style="position:absolute;top:424px;left:573px;white-space:nowrap" class="ft3978">2</p>
<p style="position:absolute;top:417px;left:580px;white-space:nowrap" class="ft3929">,&#160;M</p>
<p style="position:absolute;top:424px;left:601px;white-space:nowrap" class="ft3978">1</p>
<p style="position:absolute;top:417px;left:608px;white-space:nowrap" class="ft3928">)&#160;=</p>
<p style="position:absolute;top:417px;left:634px;white-space:nowrap" class="ft3929">M</p>
<p style="position:absolute;top:424px;left:648px;white-space:nowrap" class="ft3978">1</p>
<p style="position:absolute;top:417px;left:659px;white-space:nowrap" class="ft3928">=</p>
<p style="position:absolute;top:417px;left:675px;white-space:nowrap" class="ft3929">R</p>
<p style="position:absolute;top:423px;left:686px;white-space:nowrap" class="ft3943">initial</p>
<p style="position:absolute;top:449px;left:248px;white-space:nowrap" class="ft3912">The&#160;exact&#160;nature&#160;of&#160;the&#160;reporting&#160;activity&#160;and&#160;the&#160;corresponding&#160;change-type&#160;policy</p>
<p style="position:absolute;top:467px;left:226px;white-space:nowrap" class="ft3915">is&#160;component-dependent.&#160;However,&#160;the&#160;logic&#160;that&#160;performs&#160;this&#160;activity&#160;must&#160;be&#160;a&#160;part<br/>of&#160;the&#160;initial&#160;measurements&#160;so&#160;that&#160;we&#160;can&#160;trust&#160;the&#160;component&#160;to&#160;report&#160;the&#160;changes&#160;to<br/>the&#160;correct&#160;register.</p>
<p style="position:absolute;top:521px;left:248px;white-space:nowrap" class="ft3917"><b>Integrity&#160;states.&#160;</b>Depending&#160;on&#160;the&#160;measurement&#160;values&#160;stored&#160;in&#160;its&#160;static&#160;and</p>
<p style="position:absolute;top:539px;left:226px;white-space:nowrap" class="ft3915">dynamic&#160;registers,&#160;a&#160;dynamic&#160;component&#160;can&#160;be&#160;in&#160;one&#160;of&#160;three&#160;local&#160;integrity&#160;states:<br/>intact,&#160;non-critical,&#160;and&#160;critical.&#160;The&#160;component&#160;is&#160;in&#160;the&#160;<i>intact&#160;state&#160;</i>if&#160;and&#160;only&#160;if&#160;the<br/>values&#160;in&#160;the&#160;static&#160;and&#160;dynamic&#160;registers&#160;are&#160;consistent&#160;with&#160;the&#160;expected&#160;measurement<br/>values.&#160;The&#160;component&#160;is&#160;in&#160;the&#160;<i>non-critical&#160;state&#160;</i>if&#160;and&#160;only&#160;if&#160;the&#160;value&#160;in&#160;the&#160;static<br/>register&#160;is&#160;consistent&#160;with&#160;the&#160;expected&#160;measurement&#160;value&#160;but&#160;the&#160;value&#160;in&#160;the&#160;dynamic<br/>register&#160;is&#160;not.&#160;In&#160;all&#160;other&#160;cases,&#160;the&#160;component&#160;is&#160;in&#160;the&#160;<i>critical&#160;state</i>.&#160;As&#160;shown&#160;in<br/>Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#38">4.5,&#160;</a>the&#160;foregoing&#160;arrangement&#160;enables&#160;a&#160;dynamic&#160;component&#160;that&#160;has&#160;only&#160;been<br/>subject&#160;to&#160;non-critical&#160;changes&#160;to&#160;be&#160;restored&#160;to&#160;the&#160;intact&#160;state.&#160;A&#160;component&#160;that&#160;is<br/>in&#160;the&#160;critical&#160;state&#160;cannot&#160;be&#160;restored&#160;to&#160;any&#160;other&#160;state&#160;unless&#160;re-initiated&#160;with&#160;an<br/>expected&#160;configuration&#160;(during&#160;which&#160;both&#160;registers&#160;are&#160;reset).</p>
<p style="position:absolute;top:718px;left:248px;white-space:nowrap" class="ft3917"><b>Security&#160;states.&#160;</b>Depending&#160;on&#160;the&#160;integrity&#160;state,&#160;a&#160;component&#160;can&#160;be&#160;in&#160;three</p>
<p style="position:absolute;top:736px;left:226px;white-space:nowrap" class="ft3915">security&#160;states:&#160;trustworthy,&#160;secure,&#160;and&#160;insecure.&#160;A&#160;component&#160;is&#160;<i>trustworthy&#160;</i>if&#160;and<br/>only&#160;if&#160;it&#160;is&#160;in&#160;intact&#160;state.&#160;A&#160;component&#160;is&#160;<i>secure&#160;</i>if&#160;and&#160;only&#160;if&#160;it&#160;is&#160;in&#160;intact&#160;or&#160;non-<br/>critical&#160;states.&#160;In&#160;all&#160;other&#160;cases,&#160;the&#160;component&#160;is&#160;deemed&#160;<i>insecure</i>.</p>
<p style="position:absolute;top:790px;left:248px;white-space:nowrap" class="ft3917"><b>Example&#160;use&#160;case&#160;for&#160;dynamic&#160;registers.&#160;</b>Digital&#160;Rights&#160;Management&#160;(DRM)&#160;ser-</p>
<p style="position:absolute;top:808px;left:226px;white-space:nowrap" class="ft3915">vices&#160;control&#160;the&#160;distribution&#160;of&#160;media&#160;content&#160;onto&#160;computing&#160;platforms.&#160;It&#160;is&#160;possible<br/>that&#160;a&#160;DRM&#160;service&#160;will&#160;not&#160;push&#160;video&#160;content&#160;to&#160;a&#160;computing&#160;accessory&#160;if,&#160;for&#160;ex-<br/>ample,&#160;an&#160;external&#160;recording&#160;device&#160;is&#160;plugged&#160;to&#160;it.&#160;In&#160;this&#160;case,&#160;software&#160;that&#160;detects<br/>and&#160;installs&#160;the&#160;plug-and-play&#160;drivers&#160;for&#160;the&#160;recording&#160;device&#160;must&#160;be&#160;part&#160;of&#160;the&#160;static<br/>measurements.&#160;However,&#160;the&#160;state&#160;in&#160;which&#160;a&#160;recording&#160;device&#160;is&#160;detected&#160;in&#160;the&#160;sys-<br/>tem&#160;can&#160;be&#160;reported&#160;dynamically.&#160;In&#160;fact,&#160;this&#160;can&#160;be&#160;reflected&#160;in&#160;the&#160;dynamic&#160;register<br/>for&#160;a&#160;secure&#160;DRM&#160;player&#160;application.&#160;As&#160;long&#160;as&#160;the&#160;recording&#160;device&#160;is&#160;connected,<br/>no&#160;content&#160;is&#160;downloaded.&#160;Once&#160;the&#160;user&#160;unplugs&#160;the&#160;device,&#160;the&#160;dynamic&#160;register&#160;is<br/>reset&#160;and&#160;content&#160;can&#160;be&#160;pushed&#160;to&#160;the&#160;player&#160;without&#160;requiring&#160;the&#160;application&#160;to&#160;be<br/>restarted.</p>
<p style="position:absolute;top:1026px;left:226px;white-space:nowrap" class="ft3917"><b>Hierarchical&#160;Trust&#160;Dependency</b></p>
<p style="position:absolute;top:1054px;left:226px;white-space:nowrap" class="ft3915">We&#160;enhance&#160;the&#160;BIM&#160;dependency&#160;model&#160;by&#160;introducing&#160;a&#160;hierarchy&#160;of&#160;trust&#160;dependen-<br/>cies&#160;that&#160;we&#160;represent&#160;as&#160;a&#160;directed&#160;acyclic&#160;graph.&#160;In&#160;such&#160;a&#160;graph,&#160;the&#160;edges&#160;indicate</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft3918">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 40 -->
<a name="40"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4082{font-size:9px;font-family:MEDLMS+TT10691o00;color:#ffffff;}
	.ft4083{font-size:9px;font-family:UFQSLH+TT10692o00;color:#000000;}
	.ft4084{font-size:10px;font-family:QEHNHK+TT10693o00;color:#000000;}
	.ft4085{font-size:9px;font-family:TWPWAV+TT10694o00;color:#000000;}
	.ft4086{font-size:10px;font-family:QEHNHK+TT10695o00;color:#000000;}
	.ft4087{font-size:10px;font-family:QEHNHK+TT10695o00;color:#ffffff;}
	.ft4088{font-size:9px;font-family:MEDLMS+TT106E8o00;color:#ffffff;}
	.ft4089{font-size:9px;font-family:ZRSKVS+TT106E9o00;color:#000000;}
	.ft4090{font-size:10px;font-family:HSAEUE+TT106EAo00;color:#000000;}
	.ft4091{font-size:9px;font-family:XGQFDG+TT106EBo00;color:#000000;}
	.ft4092{font-size:10px;font-family:HSAEUE+TT106ECo00;color:#ffffff;}
	.ft4093{font-size:10px;font-family:HSAEUE+TT106ECo00;color:#000000;}
-->
</style>
<div id="page40-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL040.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft4012">38</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft4018">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:192px;left:435px;white-space:nowrap" class="ft4082">CID</p>
<p style="position:absolute;top:192px;left:459px;white-space:nowrap" class="ft4082">PID</p>
<p style="position:absolute;top:206px;left:439px;white-space:nowrap" class="ft4083">0</p>
<p style="position:absolute;top:206px;left:464px;white-space:nowrap" class="ft4083">-</p>
<p style="position:absolute;top:220px;left:439px;white-space:nowrap" class="ft4083">1</p>
<p style="position:absolute;top:220px;left:463px;white-space:nowrap" class="ft4083">0</p>
<p style="position:absolute;top:234px;left:439px;white-space:nowrap" class="ft4083">2</p>
<p style="position:absolute;top:234px;left:463px;white-space:nowrap" class="ft4083">1</p>
<p style="position:absolute;top:248px;left:439px;white-space:nowrap" class="ft4083">3</p>
<p style="position:absolute;top:248px;left:463px;white-space:nowrap" class="ft4083">1</p>
<p style="position:absolute;top:261px;left:439px;white-space:nowrap" class="ft4083">4</p>
<p style="position:absolute;top:261px;left:463px;white-space:nowrap" class="ft4083">1</p>
<p style="position:absolute;top:192px;left:435px;white-space:nowrap" class="ft4082">CID</p>
<p style="position:absolute;top:192px;left:459px;white-space:nowrap" class="ft4082">PID</p>
<p style="position:absolute;top:206px;left:439px;white-space:nowrap" class="ft4083">0</p>
<p style="position:absolute;top:206px;left:464px;white-space:nowrap" class="ft4083">-</p>
<p style="position:absolute;top:220px;left:439px;white-space:nowrap" class="ft4083">1</p>
<p style="position:absolute;top:220px;left:463px;white-space:nowrap" class="ft4083">0</p>
<p style="position:absolute;top:234px;left:439px;white-space:nowrap" class="ft4083">2</p>
<p style="position:absolute;top:234px;left:463px;white-space:nowrap" class="ft4083">1</p>
<p style="position:absolute;top:248px;left:439px;white-space:nowrap" class="ft4083">3</p>
<p style="position:absolute;top:248px;left:463px;white-space:nowrap" class="ft4083">1</p>
<p style="position:absolute;top:261px;left:439px;white-space:nowrap" class="ft4083">4</p>
<p style="position:absolute;top:261px;left:463px;white-space:nowrap" class="ft4083">1</p>
<p style="position:absolute;top:189px;left:261px;white-space:nowrap" class="ft4084">1</p>
<p style="position:absolute;top:214px;left:307px;white-space:nowrap" class="ft4084">22</p>
<p style="position:absolute;top:261px;left:350px;white-space:nowrap" class="ft4085">Platform&#160;TCB</p>
<p style="position:absolute;top:225px;left:282px;white-space:nowrap" class="ft4085">VM</p>
<p style="position:absolute;top:235px;left:262px;white-space:nowrap" class="ft4085">Manager</p>
<p style="position:absolute;top:234px;left:314px;white-space:nowrap" class="ft4085">VM</p>
<p style="position:absolute;top:254px;left:261px;white-space:nowrap" class="ft4084">0</p>
<p style="position:absolute;top:214px;left:338px;white-space:nowrap" class="ft4084">33</p>
<p style="position:absolute;top:234px;left:344px;white-space:nowrap" class="ft4085">VM</p>
<p style="position:absolute;top:214px;left:368px;white-space:nowrap" class="ft4084">44</p>
<p style="position:absolute;top:234px;left:374px;white-space:nowrap" class="ft4085">VM</p>
<p style="position:absolute;top:230px;left:530px;white-space:nowrap" class="ft4086">1</p>
<p style="position:absolute;top:192px;left:505px;white-space:nowrap" class="ft4086">22</p>
<p style="position:absolute;top:192px;left:530px;white-space:nowrap" class="ft4086">33</p>
<p style="position:absolute;top:192px;left:555px;white-space:nowrap" class="ft4086">44</p>
<p style="position:absolute;top:266px;left:530px;white-space:nowrap" class="ft4087">00</p>
<p style="position:absolute;top:291px;left:341px;white-space:nowrap" class="ft4010">(a)&#160;Multi-level&#160;dependency.</p>
<p style="position:absolute;top:343px;left:439px;white-space:nowrap" class="ft4088">CID</p>
<p style="position:absolute;top:343px;left:464px;white-space:nowrap" class="ft4088">PID</p>
<p style="position:absolute;top:358px;left:443px;white-space:nowrap" class="ft4089">0</p>
<p style="position:absolute;top:358px;left:469px;white-space:nowrap" class="ft4089">-</p>
<p style="position:absolute;top:374px;left:443px;white-space:nowrap" class="ft4089">1</p>
<p style="position:absolute;top:374px;left:468px;white-space:nowrap" class="ft4089">0</p>
<p style="position:absolute;top:390px;left:443px;white-space:nowrap" class="ft4089">2</p>
<p style="position:absolute;top:390px;left:468px;white-space:nowrap" class="ft4089">0</p>
<p style="position:absolute;top:405px;left:443px;white-space:nowrap" class="ft4089">3</p>
<p style="position:absolute;top:405px;left:468px;white-space:nowrap" class="ft4089">1</p>
<p style="position:absolute;top:421px;left:443px;white-space:nowrap" class="ft4089">4</p>
<p style="position:absolute;top:421px;left:468px;white-space:nowrap" class="ft4089">3</p>
<p style="position:absolute;top:437px;left:443px;white-space:nowrap" class="ft4089">5</p>
<p style="position:absolute;top:437px;left:468px;white-space:nowrap" class="ft4089">2</p>
<p style="position:absolute;top:452px;left:443px;white-space:nowrap" class="ft4089">6</p>
<p style="position:absolute;top:452px;left:468px;white-space:nowrap" class="ft4089">5</p>
<p style="position:absolute;top:343px;left:439px;white-space:nowrap" class="ft4088">CID</p>
<p style="position:absolute;top:343px;left:464px;white-space:nowrap" class="ft4088">PID</p>
<p style="position:absolute;top:358px;left:443px;white-space:nowrap" class="ft4089">0</p>
<p style="position:absolute;top:358px;left:469px;white-space:nowrap" class="ft4089">-</p>
<p style="position:absolute;top:374px;left:443px;white-space:nowrap" class="ft4089">1</p>
<p style="position:absolute;top:374px;left:468px;white-space:nowrap" class="ft4089">0</p>
<p style="position:absolute;top:390px;left:443px;white-space:nowrap" class="ft4089">2</p>
<p style="position:absolute;top:390px;left:468px;white-space:nowrap" class="ft4089">0</p>
<p style="position:absolute;top:405px;left:443px;white-space:nowrap" class="ft4089">3</p>
<p style="position:absolute;top:405px;left:468px;white-space:nowrap" class="ft4089">1</p>
<p style="position:absolute;top:421px;left:443px;white-space:nowrap" class="ft4089">4</p>
<p style="position:absolute;top:421px;left:468px;white-space:nowrap" class="ft4089">3</p>
<p style="position:absolute;top:437px;left:443px;white-space:nowrap" class="ft4089">5</p>
<p style="position:absolute;top:437px;left:468px;white-space:nowrap" class="ft4089">2</p>
<p style="position:absolute;top:452px;left:443px;white-space:nowrap" class="ft4089">6</p>
<p style="position:absolute;top:452px;left:468px;white-space:nowrap" class="ft4089">5</p>
<p style="position:absolute;top:341px;left:259px;white-space:nowrap" class="ft4090">1</p>
<p style="position:absolute;top:435px;left:351px;white-space:nowrap" class="ft4091">Platform&#160;TCB</p>
<p style="position:absolute;top:407px;left:307px;white-space:nowrap" class="ft4091">VM</p>
<p style="position:absolute;top:428px;left:259px;white-space:nowrap" class="ft4090">0</p>
<p style="position:absolute;top:452px;left:537px;white-space:nowrap" class="ft4092">00</p>
<p style="position:absolute;top:381px;left:518px;white-space:nowrap" class="ft4093">33</p>
<p style="position:absolute;top:388px;left:269px;white-space:nowrap" class="ft4090">33</p>
<p style="position:absolute;top:357px;left:272px;white-space:nowrap" class="ft4090">44</p>
<p style="position:absolute;top:371px;left:274px;white-space:nowrap" class="ft4091">APP</p>
<p style="position:absolute;top:390px;left:295px;white-space:nowrap" class="ft4091">JVM</p>
<p style="position:absolute;top:417px;left:518px;white-space:nowrap" class="ft4093">11</p>
<p style="position:absolute;top:417px;left:554px;white-space:nowrap" class="ft4093">22</p>
<p style="position:absolute;top:345px;left:518px;white-space:nowrap" class="ft4093">44</p>
<p style="position:absolute;top:381px;left:553px;white-space:nowrap" class="ft4093">55</p>
<p style="position:absolute;top:346px;left:553px;white-space:nowrap" class="ft4093">66</p>
<p style="position:absolute;top:341px;left:332px;white-space:nowrap" class="ft4090">2</p>
<p style="position:absolute;top:407px;left:380px;white-space:nowrap" class="ft4091">VM</p>
<p style="position:absolute;top:388px;left:342px;white-space:nowrap" class="ft4090">55</p>
<p style="position:absolute;top:357px;left:345px;white-space:nowrap" class="ft4090">66</p>
<p style="position:absolute;top:371px;left:349px;white-space:nowrap" class="ft4091">VM</p>
<p style="position:absolute;top:390px;left:349px;white-space:nowrap" class="ft4091">VMWARE</p>
<p style="position:absolute;top:478px;left:350px;white-space:nowrap" class="ft4010">(b)&#160;Nested&#160;components.</p>
<p style="position:absolute;top:513px;left:277px;white-space:nowrap" class="ft4012">Figure&#160;4.6:&#160;Hierarchical&#160;integrity&#160;use&#160;cases.</p>
<p style="position:absolute;top:561px;left:150px;white-space:nowrap" class="ft4015">trust&#160;dependencies&#160;where&#160;the&#160;integrity&#160;of&#160;the&#160;component&#160;at&#160;the&#160;origin&#160;depends&#160;on&#160;the<br/>integrity&#160;of&#160;the&#160;component&#160;at&#160;the&#160;destination.&#160;If&#160;the&#160;integrity&#160;of&#160;the&#160;destination&#160;com-<br/>ponent&#160;is&#160;compromised,&#160;then&#160;the&#160;integrity&#160;of&#160;the&#160;origin&#160;component&#160;is&#160;always&#160;compro-<br/>mised&#160;as&#160;well.&#160;However,&#160;the&#160;reverse&#160;is&#160;not&#160;true.&#160;To&#160;illustrate&#160;these&#160;more&#160;complex&#160;trust<br/>relationships,&#160;consider&#160;the&#160;following&#160;use&#160;cases.</p>
<p style="position:absolute;top:651px;left:172px;white-space:nowrap" class="ft4012">In&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#35">4.4,&#160;</a>we&#160;see&#160;the&#160;simple&#160;flat&#160;hierarchy&#160;as&#160;previously&#160;described&#160;in&#160;Sec-</p>
<p style="position:absolute;top:668px;left:150px;white-space:nowrap" class="ft4015">tion&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#33">4.3.&#160;</a>The&#160;components&#160;labeled&#160;<i>one</i>,&#160;<i>two</i>,&#160;and&#160;<i>three&#160;</i>are&#160;virtual&#160;machines&#160;running<br/>directly&#160;on&#160;the&#160;trusted&#160;platform.&#160;Component&#160;<i>zero&#160;</i>is&#160;the&#160;platform&#160;TCB&#160;that&#160;includes&#160;the<br/>SRTM&#160;(in&#160;this&#160;case,&#160;the&#160;HIM&#160;service).&#160;Each&#160;VM&#160;depends&#160;only&#160;on&#160;the&#160;platform&#160;TCB<br/>underneath.&#160;If&#160;the&#160;integrity&#160;of&#160;the&#160;TCB&#160;(component&#160;<i>zero</i>)&#160;is&#160;compromised,&#160;then&#160;the<br/>integrity&#160;of&#160;all&#160;of&#160;the&#160;VMs&#160;is&#160;compromised&#160;as&#160;well.&#160;However,&#160;the&#160;VMs&#160;are&#160;independent<br/>of&#160;one&#160;another&#160;and&#160;therefore&#160;do&#160;not&#160;have&#160;a&#160;trust&#160;dependency.&#160;As&#160;an&#160;example,&#160;if&#160;the<br/>integrity&#160;of&#160;VM</p>
<p style="position:absolute;top:781px;left:244px;white-space:nowrap" class="ft4078">1</p>
<p style="position:absolute;top:776px;left:251px;white-space:nowrap" class="ft4012">is&#160;compromised,&#160;the&#160;integrity&#160;of&#160;VM</p>
<p style="position:absolute;top:781px;left:470px;white-space:nowrap" class="ft4078">2</p>
<p style="position:absolute;top:776px;left:480px;white-space:nowrap" class="ft4012">and&#160;VM</p>
<p style="position:absolute;top:781px;left:530px;white-space:nowrap" class="ft4078">3</p>
<p style="position:absolute;top:776px;left:540px;white-space:nowrap" class="ft4012">remains&#160;intact.</p>
<p style="position:absolute;top:794px;left:172px;white-space:nowrap" class="ft4012">Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#40">4.6(a)&#160;</a>shows&#160;a&#160;more&#160;complex&#160;multi-level&#160;dependency.&#160;Component&#160;<i>one&#160;</i>is&#160;a</p>
<p style="position:absolute;top:812px;left:150px;white-space:nowrap" class="ft4015">service&#160;that&#160;manages&#160;the&#160;life-cycle&#160;of&#160;components&#160;<i>two</i>,&#160;<i>three</i>,&#160;and&#160;<i>four</i>.&#160;All&#160;components<br/>are&#160;virtual&#160;machines.&#160;The&#160;latter&#160;VMs&#160;are&#160;independent&#160;of&#160;one&#160;another,&#160;as&#160;before,&#160;but<br/>their&#160;integrity&#160;depends&#160;on&#160;that&#160;of&#160;the&#160;domain&#160;manager,&#160;whose&#160;integrity&#160;in&#160;turn&#160;depends<br/>on&#160;the&#160;TCB.</p>
<p style="position:absolute;top:884px;left:172px;white-space:nowrap" class="ft4012">In&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#40">4.6(b),&#160;</a>we&#160;see&#160;a&#160;nested&#160;dependency&#160;relationship.&#160;Components&#160;<i>one&#160;</i>and</p>
<p style="position:absolute;top:902px;left:150px;white-space:nowrap" class="ft4015"><i>two&#160;</i>are&#160;virtual&#160;machines,&#160;which&#160;themselves&#160;contain&#160;further&#160;virtual&#160;machines:&#160;compo-<br/>nent&#160;<i>three</i>,&#160;which&#160;is&#160;a&#160;Java&#160;virtual&#160;machine,&#160;and&#160;component&#160;<i>five</i>,&#160;which&#160;is&#160;a&#160;VMware<br/>hypervisor.&#160;These&#160;nested&#160;virtual&#160;machines&#160;support&#160;guest&#160;components:&#160;component&#160;<i>four</i>,<br/>a&#160;Java&#160;application,&#160;and&#160;component&#160;<i>six</i>,&#160;a&#160;VMware&#160;guest.&#160;Within&#160;component&#160;<i>one</i>,&#160;a&#160;tra-<br/>ditional&#160;linear&#160;chain-of-trust&#160;applies:&#160;Java&#160;application&#160;depends&#160;on&#160;Java&#160;virtual&#160;machine<br/>depends&#160;on&#160;operating&#160;system.&#160;A&#160;similar&#160;chain&#160;can&#160;be&#160;found&#160;within&#160;the&#160;VMware&#160;com-<br/>ponent.&#160;However,&#160;these&#160;two&#160;chains&#160;of&#160;trust&#160;are&#160;independent&#160;of&#160;one&#160;another,&#160;and&#160;both<br/>depend&#160;ultimately&#160;on&#160;the&#160;underlying&#160;platform&#160;TCB.</p>
<p style="position:absolute;top:1045px;left:172px;white-space:nowrap" class="ft4012">Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#41">4.7&#160;</a>illustrates&#160;more&#160;complicated&#160;use&#160;cases.&#160;In&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#41">4.7(a),&#160;</a>we&#160;see&#160;a&#160;mul-</p>
<p style="position:absolute;top:1063px;left:150px;white-space:nowrap" class="ft4012">tiple&#160;dependency&#160;relationship.&#160;Component&#160;<i>five&#160;</i>is&#160;a&#160;virtual&#160;machine&#160;that&#160;uses&#160;services</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft4018">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 41 -->
<a name="41"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft4194{font-size:9px;font-family:MEDLMS+TT10740o00;color:#ffffff;}
	.ft4195{font-size:9px;font-family:RDZRPI+TT10741o00;color:#000000;}
	.ft4196{font-size:10px;font-family:UFQSLH+TT10742o00;color:#000000;}
	.ft4197{font-size:9px;font-family:LWWHKC+TT10743o00;color:#000000;}
	.ft4198{font-size:10px;font-family:UFQSLH+TT10744o00;color:#ffffff;}
	.ft4199{font-size:10px;font-family:UFQSLH+TT10744o00;color:#000000;}
	.ft41100{font-size:10px;font-family:UFQSLH+TT1078Fo00;color:#000000;}
	.ft41101{font-size:9px;font-family:TWPWAV+TT10790o00;color:#000000;}
	.ft41102{font-size:9px;font-family:MEDLMS+TT10791o00;color:#ffffff;}
	.ft41103{font-size:9px;font-family:DMCZLT+TT10792o00;color:#000000;}
	.ft41104{font-size:10px;font-family:UFQSLH+TT10793o00;color:#ffffff;}
	.ft41105{font-size:10px;font-family:UFQSLH+TT10793o00;color:#000000;}
-->
</style>
<div id="page41-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL041.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft4112">CHAPTER&#160;4.&#160;HIERARCHICAL&#160;INTEGRITY&#160;MANAGEMENT</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft4112">39</p>
<p style="position:absolute;top:192px;left:507px;white-space:nowrap" class="ft4194">CID</p>
<p style="position:absolute;top:192px;left:534px;white-space:nowrap" class="ft4194">PID</p>
<p style="position:absolute;top:206px;left:511px;white-space:nowrap" class="ft4195">0</p>
<p style="position:absolute;top:206px;left:539px;white-space:nowrap" class="ft4195">-</p>
<p style="position:absolute;top:220px;left:511px;white-space:nowrap" class="ft4195">1</p>
<p style="position:absolute;top:220px;left:538px;white-space:nowrap" class="ft4195">0</p>
<p style="position:absolute;top:233px;left:511px;white-space:nowrap" class="ft4195">2</p>
<p style="position:absolute;top:233px;left:538px;white-space:nowrap" class="ft4195">0</p>
<p style="position:absolute;top:247px;left:511px;white-space:nowrap" class="ft4195">3</p>
<p style="position:absolute;top:247px;left:538px;white-space:nowrap" class="ft4195">0</p>
<p style="position:absolute;top:261px;left:511px;white-space:nowrap" class="ft4195">4</p>
<p style="position:absolute;top:261px;left:538px;white-space:nowrap" class="ft4195">3</p>
<p style="position:absolute;top:274px;left:511px;white-space:nowrap" class="ft4195">5</p>
<p style="position:absolute;top:274px;left:529px;white-space:nowrap" class="ft4195">{1,2,4}</p>
<p style="position:absolute;top:192px;left:507px;white-space:nowrap" class="ft4194">CID</p>
<p style="position:absolute;top:192px;left:534px;white-space:nowrap" class="ft4194">PID</p>
<p style="position:absolute;top:206px;left:511px;white-space:nowrap" class="ft4195">0</p>
<p style="position:absolute;top:206px;left:539px;white-space:nowrap" class="ft4195">-</p>
<p style="position:absolute;top:220px;left:511px;white-space:nowrap" class="ft4195">1</p>
<p style="position:absolute;top:220px;left:538px;white-space:nowrap" class="ft4195">0</p>
<p style="position:absolute;top:233px;left:511px;white-space:nowrap" class="ft4195">2</p>
<p style="position:absolute;top:233px;left:538px;white-space:nowrap" class="ft4195">0</p>
<p style="position:absolute;top:247px;left:511px;white-space:nowrap" class="ft4195">3</p>
<p style="position:absolute;top:247px;left:538px;white-space:nowrap" class="ft4195">0</p>
<p style="position:absolute;top:261px;left:511px;white-space:nowrap" class="ft4195">4</p>
<p style="position:absolute;top:261px;left:538px;white-space:nowrap" class="ft4195">3</p>
<p style="position:absolute;top:274px;left:511px;white-space:nowrap" class="ft4195">5</p>
<p style="position:absolute;top:274px;left:529px;white-space:nowrap" class="ft4195">{1,2,4}</p>
<p style="position:absolute;top:190px;left:335px;white-space:nowrap" class="ft4196">5</p>
<p style="position:absolute;top:224px;left:371px;white-space:nowrap" class="ft4196">11</p>
<p style="position:absolute;top:261px;left:423px;white-space:nowrap" class="ft4197">Platform&#160;TCB</p>
<p style="position:absolute;top:234px;left:349px;white-space:nowrap" class="ft4197">VM&#160;vNET</p>
<p style="position:absolute;top:254px;left:335px;white-space:nowrap" class="ft4196">0</p>
<p style="position:absolute;top:224px;left:398px;white-space:nowrap" class="ft4196">22</p>
<p style="position:absolute;top:234px;left:398px;white-space:nowrap" class="ft4197">vSTO</p>
<p style="position:absolute;top:214px;left:424px;white-space:nowrap" class="ft4196">33</p>
<p style="position:absolute;top:224px;left:424px;white-space:nowrap" class="ft4197">vTPM</p>
<p style="position:absolute;top:235px;left:427px;white-space:nowrap" class="ft4197">MGR</p>
<p style="position:absolute;top:224px;left:454px;white-space:nowrap" class="ft4196">44</p>
<p style="position:absolute;top:234px;left:453px;white-space:nowrap" class="ft4197">vTPM</p>
<p style="position:absolute;top:268px;left:606px;white-space:nowrap" class="ft4198">00</p>
<p style="position:absolute;top:231px;left:582px;white-space:nowrap" class="ft4199">11</p>
<p style="position:absolute;top:231px;left:606px;white-space:nowrap" class="ft4199">22</p>
<p style="position:absolute;top:231px;left:630px;white-space:nowrap" class="ft4199">33</p>
<p style="position:absolute;top:198px;left:630px;white-space:nowrap" class="ft4199">44</p>
<p style="position:absolute;top:198px;left:582px;white-space:nowrap" class="ft4199">55</p>
<p style="position:absolute;top:224px;left:399px;white-space:nowrap" class="ft4196">2</p>
<p style="position:absolute;top:298px;left:418px;white-space:nowrap" class="ft4110">(a)&#160;Disaggregated&#160;services.</p>
<p style="position:absolute;top:348px;left:335px;white-space:nowrap" class="ft41100">2</p>
<p style="position:absolute;top:439px;left:424px;white-space:nowrap" class="ft41101">Platform&#160;TCB</p>
<p style="position:absolute;top:412px;left:394px;white-space:nowrap" class="ft41101">VM</p>
<p style="position:absolute;top:432px;left:335px;white-space:nowrap" class="ft41100">0</p>
<p style="position:absolute;top:394px;left:345px;white-space:nowrap" class="ft41100">33</p>
<p style="position:absolute;top:363px;left:348px;white-space:nowrap" class="ft41100">55</p>
<p style="position:absolute;top:377px;left:349px;white-space:nowrap" class="ft41101">APP</p>
<p style="position:absolute;top:396px;left:383px;white-space:nowrap" class="ft41101">JVM</p>
<p style="position:absolute;top:363px;left:373px;white-space:nowrap" class="ft41100">4</p>
<p style="position:absolute;top:377px;left:371px;white-space:nowrap" class="ft41101">vTPM</p>
<p style="position:absolute;top:391px;left:418px;white-space:nowrap" class="ft41100">11</p>
<p style="position:absolute;top:412px;left:417px;white-space:nowrap" class="ft41101">vTPM</p>
<p style="position:absolute;top:349px;left:504px;white-space:nowrap" class="ft41102">CID</p>
<p style="position:absolute;top:349px;left:539px;white-space:nowrap" class="ft41102">PID</p>
<p style="position:absolute;top:364px;left:508px;white-space:nowrap" class="ft41103">0</p>
<p style="position:absolute;top:364px;left:544px;white-space:nowrap" class="ft41103">-</p>
<p style="position:absolute;top:379px;left:508px;white-space:nowrap" class="ft41103">1</p>
<p style="position:absolute;top:379px;left:543px;white-space:nowrap" class="ft41103">0</p>
<p style="position:absolute;top:394px;left:508px;white-space:nowrap" class="ft41103">2</p>
<p style="position:absolute;top:394px;left:527px;white-space:nowrap" class="ft41103">{0,1,M(1)}</p>
<p style="position:absolute;top:410px;left:508px;white-space:nowrap" class="ft41103">3</p>
<p style="position:absolute;top:410px;left:543px;white-space:nowrap" class="ft41103">2</p>
<p style="position:absolute;top:425px;left:508px;white-space:nowrap" class="ft41103">4</p>
<p style="position:absolute;top:425px;left:543px;white-space:nowrap" class="ft41103">3</p>
<p style="position:absolute;top:440px;left:508px;white-space:nowrap" class="ft41103">5</p>
<p style="position:absolute;top:440px;left:527px;white-space:nowrap" class="ft41103">{0,4,M(4)}</p>
<p style="position:absolute;top:349px;left:504px;white-space:nowrap" class="ft41102">CID</p>
<p style="position:absolute;top:349px;left:539px;white-space:nowrap" class="ft41102">PID</p>
<p style="position:absolute;top:364px;left:508px;white-space:nowrap" class="ft41103">0</p>
<p style="position:absolute;top:364px;left:544px;white-space:nowrap" class="ft41103">-</p>
<p style="position:absolute;top:379px;left:508px;white-space:nowrap" class="ft41103">1</p>
<p style="position:absolute;top:379px;left:543px;white-space:nowrap" class="ft41103">0</p>
<p style="position:absolute;top:394px;left:508px;white-space:nowrap" class="ft41103">2</p>
<p style="position:absolute;top:394px;left:527px;white-space:nowrap" class="ft41103">{0,1,M(1)}</p>
<p style="position:absolute;top:410px;left:508px;white-space:nowrap" class="ft41103">3</p>
<p style="position:absolute;top:410px;left:543px;white-space:nowrap" class="ft41103">2</p>
<p style="position:absolute;top:425px;left:508px;white-space:nowrap" class="ft41103">4</p>
<p style="position:absolute;top:425px;left:543px;white-space:nowrap" class="ft41103">3</p>
<p style="position:absolute;top:440px;left:508px;white-space:nowrap" class="ft41103">5</p>
<p style="position:absolute;top:440px;left:527px;white-space:nowrap" class="ft41103">{0,4,M(4)}</p>
<p style="position:absolute;top:438px;left:609px;white-space:nowrap" class="ft41104">00</p>
<p style="position:absolute;top:406px;left:592px;white-space:nowrap" class="ft41105">22</p>
<p style="position:absolute;top:406px;left:629px;white-space:nowrap" class="ft41105">11</p>
<p style="position:absolute;top:350px;left:592px;white-space:nowrap" class="ft41105">55</p>
<p style="position:absolute;top:350px;left:631px;white-space:nowrap" class="ft41105">44</p>
<p style="position:absolute;top:379px;left:610px;white-space:nowrap" class="ft41105">33</p>
<p style="position:absolute;top:394px;left:346px;white-space:nowrap" class="ft41100">3</p>
<p style="position:absolute;top:468px;left:423px;white-space:nowrap" class="ft4110">(b)&#160;Virtual&#160;TPM&#160;binding.</p>
<p style="position:absolute;top:503px;left:236px;white-space:nowrap" class="ft4112">Figure&#160;4.7:&#160;More&#160;complicated&#160;use&#160;cases.&#160;Dashed&#160;lines&#160;denote&#160;implicit&#160;dependency.</p>
<p style="position:absolute;top:551px;left:226px;white-space:nowrap" class="ft4115">from&#160;components&#160;<i>one</i>,&#160;<i>two</i>,&#160;and&#160;<i>four</i>.&#160;These&#160;components&#160;are&#160;small&#160;virtual&#160;machines<br/>that&#160;provide&#160;virtual&#160;networking,&#160;virtual&#160;storage,&#160;and&#160;virtual&#160;TPM&#160;services,&#160;respectively.<br/>Further,&#160;the&#160;integrity&#160;of&#160;the&#160;virtual&#160;TPM&#160;depends&#160;on&#160;the&#160;integrity&#160;of&#160;the&#160;virtual&#160;TPM<br/>manager&#160;domain&#160;(component&#160;<i>three</i>).</p>
<p style="position:absolute;top:623px;left:248px;white-space:nowrap" class="ft4112">Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#41">4.7(b)&#160;</a>shows&#160;a&#160;similar&#160;VM&#160;grouping&#160;example&#160;which&#160;we&#160;intend&#160;to&#160;explore</p>
<p style="position:absolute;top:641px;left:226px;white-space:nowrap" class="ft4115">further&#160;in&#160;future&#160;work.&#160;In&#160;this&#160;example,&#160;we&#160;use&#160;miniature&#160;virtual&#160;TPM&#160;services&#160;to&#160;assist<br/>and&#160;enhance&#160;the&#160;integrity&#160;measurement&#160;capabilities&#160;of&#160;the&#160;framework.&#160;In&#160;this&#160;design&#160;we<br/>bind&#160;a&#160;single&#160;virtual&#160;TPM&#160;to&#160;a&#160;component&#160;(application&#160;or&#160;VM)&#160;and&#160;delegate&#160;component<br/>measurements&#160;to&#160;this&#160;virtual&#160;TPM.&#160;The&#160;virtual&#160;TPM&#160;then&#160;replaces&#160;the&#160;component&#160;CCRs<br/>to&#160;provide&#160;more&#160;granular&#160;run-time&#160;measurements&#160;for&#160;the&#160;component&#160;it&#160;is&#160;attached&#160;to.<br/>The&#160;measurements&#160;for&#160;the&#160;virtual&#160;TPM&#160;service&#160;itself&#160;is&#160;still&#160;held&#160;by&#160;its&#160;own&#160;CCRs.&#160;As<br/>an&#160;example,&#160;the&#160;integrity&#160;of&#160;component&#160;<i>two&#160;</i>now&#160;depends&#160;on&#160;the&#160;integrity&#160;of&#160;component<br/><i>one&#160;</i>(its&#160;attached&#160;virtual&#160;TPM)&#160;and&#160;the&#160;run-time&#160;measurements&#160;taken&#160;by&#160;this&#160;virtual<br/>TPM&#160;(e.g.,&#160;during&#160;authenticated&#160;VM</p>
<p style="position:absolute;top:789px;left:446px;white-space:nowrap" class="ft4178">2</p>
<p style="position:absolute;top:784px;left:457px;white-space:nowrap" class="ft4112">bootstrap).&#160;We&#160;refer&#160;to&#160;this&#160;measurement&#160;set&#160;as</p>
<p style="position:absolute;top:802px;left:226px;white-space:nowrap" class="ft4115">M(<i>one</i>).&#160;The&#160;same&#160;holds&#160;for&#160;the&#160;application&#160;component&#160;<i>five&#160;</i>and&#160;its&#160;attached&#160;virtual<br/>TPM&#160;service&#160;component&#160;<i>four</i>.&#160;The&#160;present&#160;HIM&#160;implementation&#160;does&#160;not&#160;yet&#160;support<br/>virtual&#160;TPM&#160;attachment.</p>
<p style="position:absolute;top:897px;left:226px;white-space:nowrap" class="ft4144"><b>4.4.2</b></p>
<p style="position:absolute;top:897px;left:280px;white-space:nowrap" class="ft4144"><b>The&#160;HIM&#160;Architecture</b></p>
<p style="position:absolute;top:927px;left:226px;white-space:nowrap" class="ft4115">The&#160;HIM&#160;service&#160;implements&#160;the&#160;same&#160;integrity,&#160;protected&#160;storage,&#160;and&#160;management<br/>interfaces&#160;as&#160;the&#160;BIM&#160;service&#160;as&#160;presented&#160;in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#33">4.3,&#160;</a>but&#160;with&#160;the&#160;following&#160;en-<br/>hancements.</p>
<p style="position:absolute;top:980px;left:248px;white-space:nowrap" class="ft4112">The&#160;HIM&#160;integrity&#160;interface&#160;provides&#160;an</p>
<p style="position:absolute;top:981px;left:495px;white-space:nowrap" class="ft4159">extend</p>
<p style="position:absolute;top:980px;left:553px;white-space:nowrap" class="ft4112">function&#160;that&#160;alters&#160;the&#160;value&#160;of</p>
<p style="position:absolute;top:998px;left:226px;white-space:nowrap" class="ft4115">the&#160;static&#160;CCR&#160;in&#160;the&#160;same&#160;way&#160;as&#160;the&#160;BIM&#160;equivalent.&#160;To&#160;support&#160;dynamic&#160;mea-<br/>surements,&#160;the&#160;interface&#160;also&#160;provides&#160;a</p>
<p style="position:absolute;top:1017px;left:472px;white-space:nowrap" class="ft4159">reset</p>
<p style="position:absolute;top:1016px;left:521px;white-space:nowrap" class="ft4112">function&#160;that&#160;is&#160;used&#160;to&#160;report&#160;to&#160;the</p>
<p style="position:absolute;top:1034px;left:226px;white-space:nowrap" class="ft4115">dynamic&#160;register&#160;and&#160;overwrite&#160;its&#160;value.&#160;In&#160;addition,&#160;to&#160;support&#160;hierarchical&#160;integrity<br/>dependency,&#160;the</p>
<p style="position:absolute;top:1053px;left:329px;white-space:nowrap" class="ft4159">quote</p>
<p style="position:absolute;top:1052px;left:379px;white-space:nowrap" class="ft4112">function&#160;is&#160;modified.&#160;This&#160;function&#160;now&#160;returns&#160;the&#160;aggre-</p>
<p style="position:absolute;top:1070px;left:226px;white-space:nowrap" class="ft4112">gated&#160;integrity&#160;measurements&#160;of&#160;the&#160;component&#160;in&#160;question.&#160;Specifically,&#160;the&#160;signed</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft4118">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 42 -->
<a name="42"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page42-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL042.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft4212">40</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft4218">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:193px;left:150px;white-space:nowrap" class="ft4215">quote&#160;now&#160;contains&#160;the&#160;TCB&#160;integrity&#160;measurements&#160;plus&#160;the&#160;measurements&#160;of&#160;the<br/>component&#160;and&#160;all&#160;its&#160;ancestors&#160;hashed&#160;in&#160;a&#160;single&#160;value.</p>
<p style="position:absolute;top:229px;left:172px;white-space:nowrap" class="ft4212">In&#160;the&#160;HIM&#160;protected&#160;storage&#160;interface,&#160;the</p>
<p style="position:absolute;top:230px;left:438px;white-space:nowrap" class="ft4259">seal</p>
<p style="position:absolute;top:229px;left:478px;white-space:nowrap" class="ft4212">and</p>
<p style="position:absolute;top:230px;left:505px;white-space:nowrap" class="ft4259">unseal</p>
<p style="position:absolute;top:229px;left:563px;white-space:nowrap" class="ft4212">functions&#160;are&#160;en-</p>
<p style="position:absolute;top:247px;left:150px;white-space:nowrap" class="ft4212">hanced&#160;to&#160;support&#160;component&#160;dependency&#160;and&#160;dynamic&#160;measurements.&#160;The</p>
<p style="position:absolute;top:248px;left:629px;white-space:nowrap" class="ft4259">seal</p>
<p style="position:absolute;top:265px;left:150px;white-space:nowrap" class="ft4215">function&#160;now&#160;binds&#160;the&#160;stored&#160;secret&#160;to&#160;the&#160;integrity&#160;of&#160;all&#160;the&#160;trust&#160;chains&#160;that&#160;reach<br/>the&#160;component&#160;in&#160;question&#160;from&#160;the&#160;TCB;&#160;that&#160;is,&#160;the&#160;sub-graph&#160;of&#160;all&#160;paths&#160;from&#160;that<br/>component&#160;to&#160;the&#160;root&#160;TCB.&#160;Hence&#160;the&#160;integrity&#160;state&#160;of&#160;components&#160;not&#160;on&#160;a&#160;path&#160;be-<br/>tween&#160;that&#160;component&#160;and&#160;the&#160;TCB&#160;is&#160;ignored.&#160;For&#160;example,&#160;in&#160;the&#160;nested&#160;use&#160;case&#160;in<br/>Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#40">4.6(b),&#160;</a>an&#160;integrity&#160;compromise&#160;in&#160;the&#160;VMware&#160;compartment&#160;will&#160;not&#160;affect&#160;the<br/>ability&#160;of&#160;the&#160;Java&#160;application&#160;to&#160;unseal&#160;previously&#160;sealed&#160;information,&#160;as&#160;long&#160;as&#160;the<br/>Java&#160;compartment&#160;remains&#160;intact.</p>
<p style="position:absolute;top:391px;left:172px;white-space:nowrap" class="ft4212">Lastly,&#160;the&#160;HIM&#160;management&#160;interface&#160;provides</p>
<p style="position:absolute;top:392px;left:471px;white-space:nowrap" class="ft4259">register</p>
<p style="position:absolute;top:391px;left:548px;white-space:nowrap" class="ft4212">and</p>
<p style="position:absolute;top:392px;left:575px;white-space:nowrap" class="ft4259">delete</p>
<p style="position:absolute;top:391px;left:634px;white-space:nowrap" class="ft4212">func-</p>
<p style="position:absolute;top:409px;left:150px;white-space:nowrap" class="ft4212">tions.&#160;The</p>
<p style="position:absolute;top:410px;left:221px;white-space:nowrap" class="ft4259">delete</p>
<p style="position:absolute;top:409px;left:280px;white-space:nowrap" class="ft4212">function&#160;is&#160;the&#160;same&#160;as&#160;in&#160;the&#160;BIM.&#160;However,&#160;the</p>
<p style="position:absolute;top:410px;left:594px;white-space:nowrap" class="ft4259">register</p>
<p style="position:absolute;top:427px;left:150px;white-space:nowrap" class="ft4215">function&#160;now&#160;takes&#160;a&#160;dependency&#160;list&#160;as&#160;a&#160;parameter&#160;that&#160;specifies&#160;additional&#160;ancestor<br/>components&#160;the&#160;component&#160;depends&#160;on&#160;besides&#160;the&#160;one&#160;that&#160;registers&#160;the&#160;component.</p>
<p style="position:absolute;top:509px;left:150px;white-space:nowrap" class="ft4220"><b>4.5</b></p>
<p style="position:absolute;top:509px;left:198px;white-space:nowrap" class="ft4220"><b>Policy&#160;Verification&#160;for&#160;Security&#160;Services</b></p>
<p style="position:absolute;top:546px;left:150px;white-space:nowrap" class="ft4215">In&#160;this&#160;section,&#160;we&#160;introduce&#160;example&#160;security&#160;services&#160;that&#160;leverage&#160;the&#160;HIM&#160;frame-<br/>work&#160;for&#160;policy&#160;verification&#160;and&#160;access&#160;control.&#160;Our&#160;examples&#160;include&#160;a&#160;credential<br/>management&#160;service&#160;(Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#42">4.5.1)</a>,&#160;a&#160;virtual&#160;TPM&#160;service&#160;(Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#43">4.5.2)</a>,&#160;and&#160;a&#160;vir-<br/>tual&#160;network&#160;service&#160;(Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#43">4.5.3)</a>.</p>
<p style="position:absolute;top:659px;left:150px;white-space:nowrap" class="ft4244"><b>4.5.1</b></p>
<p style="position:absolute;top:659px;left:204px;white-space:nowrap" class="ft4244"><b>Credential&#160;Management&#160;Service</b></p>
<p style="position:absolute;top:689px;left:150px;white-space:nowrap" class="ft4215">Protected&#160;storage&#160;services&#160;provide&#160;secure&#160;access&#160;to&#160;secrets&#160;that&#160;are&#160;sealed&#160;to&#160;the&#160;under-<br/>lying&#160;TPM&#160;on&#160;behalf&#160;of&#160;their&#160;owners.&#160;It&#160;is&#160;expected&#160;that&#160;these&#160;services&#160;retain&#160;control<br/>over&#160;these&#160;secrets&#160;and&#160;enforce&#160;the&#160;associated&#160;access&#160;control&#160;policies&#160;at&#160;all&#160;times.&#160;By<br/>contrast,&#160;most&#160;storage&#160;services&#160;such&#160;as&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[65]&#160;</a>and&#160;the&#160;HIM&#160;provide&#160;one-time&#160;verification,<br/>and&#160;are&#160;therefore&#160;susceptible&#160;to&#160;a&#160;time-of-check&#160;to&#160;time-of-use&#160;vulnerability.&#160;This&#160;oc-<br/>curs&#160;because&#160;these&#160;services&#160;release&#160;the&#160;stored&#160;secret&#160;to&#160;the&#160;requesting&#160;component&#160;once<br/>they&#160;verify&#160;the&#160;necessary&#160;policies&#160;(e.g.,&#160;HIM&#160;unseal&#160;successfully&#160;verifies&#160;the&#160;aggregate<br/>integrity).&#160;Once&#160;the&#160;secret&#160;is&#160;revealed,&#160;these&#160;services&#160;can&#160;no&#160;longer&#160;restrict&#160;access&#160;to&#160;it<br/>if&#160;the&#160;component&#160;undergoes&#160;a&#160;malicious&#160;change.</p>
<p style="position:absolute;top:850px;left:172px;white-space:nowrap" class="ft4212">To&#160;enable&#160;ongoing&#160;policy&#160;verification&#160;and&#160;enforcement,&#160;we&#160;designed&#160;and&#160;imple-</p>
<p style="position:absolute;top:868px;left:150px;white-space:nowrap" class="ft4215">mented&#160;a&#160;credential&#160;management&#160;service&#160;(CMS)&#160;that&#160;uses&#160;the&#160;integrity&#160;management<br/>framework&#160;to&#160;provide&#160;secure&#160;access&#160;to&#160;secrets&#160;while&#160;maintaining&#160;control&#160;at&#160;all&#160;times.<br/>Unlike&#160;the&#160;HIM&#160;unseal&#160;operation,&#160;CMS&#160;credentials&#160;are&#160;never&#160;revealed&#160;to&#160;requesting<br/>services&#160;directly&#160;but&#160;are&#160;always&#160;held&#160;securely&#160;by&#160;the&#160;CMS.&#160;In&#160;essence,&#160;the&#160;CMS&#160;is&#160;a<br/>reference&#160;monitor&#160;that&#160;mediates&#160;and&#160;provides&#160;access&#160;to&#160;secured&#160;data&#160;through&#160;a&#160;well-<br/>defined&#160;interface.</p>
<p style="position:absolute;top:976px;left:172px;white-space:nowrap" class="ft4212">The&#160;CMS&#160;interface&#160;is&#160;comprised&#160;of&#160;management&#160;and&#160;service&#160;interfaces.&#160;Compo-</p>
<p style="position:absolute;top:994px;left:150px;white-space:nowrap" class="ft4215">nents&#160;use&#160;the&#160;management&#160;interface&#160;to&#160;register&#160;component&#160;credentials&#160;with&#160;the&#160;CMS.<br/>To&#160;do&#160;so,&#160;the</p>
<p style="position:absolute;top:1013px;left:240px;white-space:nowrap" class="ft4259">register</p>
<p style="position:absolute;top:1012px;left:317px;white-space:nowrap" class="ft4212">function&#160;takes&#160;the&#160;credential&#160;as&#160;input&#160;and&#160;seals&#160;it&#160;to&#160;the</p>
<p style="position:absolute;top:1030px;left:150px;white-space:nowrap" class="ft4212">underlying&#160;TPM.&#160;The&#160;interface&#160;also&#160;provides&#160;a</p>
<p style="position:absolute;top:1030px;left:438px;white-space:nowrap" class="ft4259">discard</p>
<p style="position:absolute;top:1030px;left:506px;white-space:nowrap" class="ft4212">function&#160;which&#160;deletes&#160;the</p>
<p style="position:absolute;top:1048px;left:150px;white-space:nowrap" class="ft4215">stored&#160;credential.&#160;The&#160;service&#160;interface&#160;provides&#160;access&#160;to&#160;the&#160;credentials&#160;through&#160;a<br/>generic</p>
<p style="position:absolute;top:1066px;left:199px;white-space:nowrap" class="ft4259">access</p>
<p style="position:absolute;top:1065px;left:258px;white-space:nowrap" class="ft4212">function.&#160;We&#160;have&#160;designed&#160;this&#160;interface&#160;as&#160;an&#160;extensible&#160;plug-in</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft4218">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 43 -->
<a name="43"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page43-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL043.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft4312">CHAPTER&#160;4.&#160;HIERARCHICAL&#160;INTEGRITY&#160;MANAGEMENT</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft4312">41</p>
<p style="position:absolute;top:193px;left:226px;white-space:nowrap" class="ft4315">interface;&#160;that&#160;is,&#160;the&#160;exact&#160;nature&#160;of&#160;the&#160;interface&#160;depends&#160;on&#160;the&#160;nature&#160;of&#160;the&#160;stored<br/>credential&#160;and&#160;the&#160;type&#160;of&#160;functionality&#160;needed.&#160;For&#160;example,&#160;if&#160;the&#160;stored&#160;credentials<br/>are&#160;cryptographic&#160;keys,&#160;we&#160;offer&#160;a&#160;plug-in&#160;service&#160;that&#160;provides&#160;encryption/decryption<br/>capabilities&#160;so&#160;that&#160;components&#160;can&#160;use&#160;the&#160;interface&#160;to&#160;encrypt/decrypt&#160;data&#160;without<br/>seeing&#160;the&#160;actual&#160;key.&#160;Regardless&#160;of&#160;the&#160;functionality&#160;provided,&#160;the&#160;CMS&#160;uses&#160;the&#160;HIM<br/>to&#160;verify&#160;the&#160;aggregate&#160;integrity&#160;prior&#160;to&#160;each&#160;access&#160;to&#160;the&#160;secret.</p>
<p style="position:absolute;top:342px;left:226px;white-space:nowrap" class="ft4344"><b>4.5.2</b></p>
<p style="position:absolute;top:342px;left:280px;white-space:nowrap" class="ft4344"><b>Virtual&#160;TPM&#160;Service</b></p>
<p style="position:absolute;top:372px;left:226px;white-space:nowrap" class="ft4315">A&#160;natural&#160;extension&#160;to&#160;the&#160;CMS&#160;functionality&#160;would&#160;be&#160;to&#160;provide&#160;a&#160;miniature&#160;TPM&#160;in-<br/>terface&#160;to&#160;the&#160;various&#160;platform&#160;components,&#160;as&#160;illustrated&#160;in&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#41">4.7(b).&#160;</a>This&#160;enables<br/>these&#160;components&#160;to&#160;have&#160;a&#160;standardized&#160;interface&#160;as&#160;in&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[74]&#160;</a>to&#160;prove&#160;their&#160;integrity<br/>and&#160;provides&#160;a&#160;strong&#160;identity&#160;for&#160;each&#160;component.&#160;Such&#160;an&#160;approach&#160;has&#160;already&#160;been<br/>taken&#160;through&#160;TPM&#160;virtualization&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#74">[9]&#160;</a>which&#160;gives&#160;each&#160;VM&#160;a&#160;TPM&#160;interface&#160;imple-<br/>mented&#160;by&#160;a&#160;virtual&#160;TPM&#160;service.&#160;However,&#160;it&#160;is&#160;not&#160;yet&#160;clear&#160;what&#160;the&#160;best&#160;mechanism<br/>is&#160;for&#160;establishing&#160;a&#160;secure&#160;binding&#160;between&#160;a&#160;virtual&#160;TPM&#160;and&#160;its&#160;platform&#160;TCB.</p>
<p style="position:absolute;top:498px;left:248px;white-space:nowrap" class="ft4312">Our&#160;framework&#160;could&#160;be&#160;used&#160;to&#160;bridge&#160;the&#160;gap&#160;between&#160;virtual&#160;TPM&#160;services&#160;and</p>
<p style="position:absolute;top:515px;left:226px;white-space:nowrap" class="ft4315">the&#160;platform&#160;TCB.&#160;For&#160;example,&#160;a&#160;central&#160;trusted&#160;CMS&#160;service&#160;could&#160;be&#160;used&#160;as&#160;the<br/>single&#160;secure&#160;repository&#160;for&#160;virtual&#160;TPM&#160;keys.&#160;Access&#160;to&#160;these&#160;keys&#160;would&#160;require<br/>verification&#160;of&#160;the&#160;complete&#160;HIM&#160;integrity&#160;chain,&#160;including&#160;verification&#160;of&#160;the&#160;platform<br/>TCB.&#160;For&#160;example,&#160;to&#160;sign&#160;a&#160;quote&#160;request,&#160;a&#160;virtual&#160;TPM&#160;would&#160;use&#160;the&#160;CMS&#160;interface<br/>to&#160;gain&#160;access&#160;to&#160;its&#160;signing&#160;key.</p>
<p style="position:absolute;top:646px;left:226px;white-space:nowrap" class="ft4344"><b>4.5.3</b></p>
<p style="position:absolute;top:646px;left:280px;white-space:nowrap" class="ft4344"><b>Virtual&#160;Network&#160;Service</b></p>
<p style="position:absolute;top:676px;left:226px;white-space:nowrap" class="ft4315">Virtualization&#160;provides&#160;direct&#160;isolation&#160;of&#160;computing&#160;resources&#160;such&#160;as&#160;memory&#160;and<br/>CPU&#160;between&#160;guest&#160;operating&#160;systems&#160;on&#160;a&#160;physical&#160;platform.&#160;However,&#160;the&#160;network<br/>remains&#160;a&#160;shared&#160;resource&#160;as&#160;all&#160;traffic&#160;from&#160;guests&#160;will&#160;eventually&#160;end&#160;up&#160;on&#160;the&#160;same<br/>physical&#160;medium.&#160;Various&#160;mechanisms&#160;can&#160;be&#160;used&#160;to&#160;provide&#160;network&#160;isolation&#160;be-<br/>tween&#160;network&#160;domains,&#160;as&#160;described&#160;in&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[13]</a>.&#160;In&#160;general,&#160;encryption&#160;must&#160;be&#160;used&#160;for<br/>isolation&#160;when&#160;network&#160;traffic&#160;is&#160;delivered&#160;over&#160;an&#160;untrusted&#160;shared&#160;physical&#160;medium.</p>
<p style="position:absolute;top:784px;left:248px;white-space:nowrap" class="ft4312">Using&#160;our&#160;framework&#160;in&#160;combination&#160;with&#160;the&#160;CMS,&#160;one&#160;could&#160;design&#160;a&#160;virtual</p>
<p style="position:absolute;top:801px;left:226px;white-space:nowrap" class="ft4315">network&#160;(vNET)&#160;service&#160;which&#160;provides&#160;isolation&#160;through&#160;an&#160;encryption&#160;layer&#160;such&#160;as<br/>IPSEC.&#160;In&#160;this&#160;setting,&#160;the&#160;vNET&#160;service&#160;would&#160;store&#160;its&#160;credentials&#160;(e.g.,&#160;network&#160;en-<br/>cryption&#160;key)&#160;in&#160;the&#160;CMS,&#160;in&#160;combination&#160;with&#160;the&#160;expected&#160;CCR&#160;values&#160;of&#160;the&#160;service<br/>and&#160;any&#160;ancestor&#160;service&#160;it&#160;depends&#160;on&#160;(including&#160;any&#160;potential&#160;network&#160;configuration<br/>information).&#160;Because&#160;the&#160;key&#160;is&#160;held&#160;by&#160;the&#160;CMS&#160;and&#160;not&#160;revealed&#160;to&#160;the&#160;vNET&#160;ser-<br/>vice,&#160;any&#160;change&#160;in&#160;the&#160;integrity&#160;of&#160;the&#160;service&#160;or&#160;its&#160;ancestor&#160;components&#160;would&#160;result<br/>in&#160;the&#160;network&#160;link&#160;becoming&#160;unavailable&#160;for&#160;the&#160;VM&#160;connected&#160;to&#160;this&#160;specific&#160;vNET.<br/>As&#160;a&#160;result,&#160;the&#160;capability&#160;of&#160;a&#160;VM&#160;to&#160;communicate&#160;with&#160;its&#160;peer&#160;within&#160;a&#160;considered<br/>domain&#160;would&#160;implicitly&#160;prove&#160;its&#160;trustworthiness,&#160;which&#160;would&#160;provide&#160;continuous<br/>authentication&#160;as&#160;opposed&#160;to&#160;relying&#160;only&#160;on&#160;an&#160;initial&#160;handshake&#160;as&#160;most&#160;network&#160;au-<br/>thentication&#160;mechanisms&#160;do.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft4318">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 44 -->
<a name="44"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page44-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL044.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft4412">42</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft4418">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:189px;left:150px;white-space:nowrap" class="ft4420"><b>4.6</b></p>
<p style="position:absolute;top:189px;left:198px;white-space:nowrap" class="ft4420"><b>Implementation&#160;in&#160;Xen</b></p>
<p style="position:absolute;top:227px;left:150px;white-space:nowrap" class="ft4415">In&#160;this&#160;section,&#160;we&#160;describe&#160;a&#160;prototype&#160;implementation&#160;of&#160;the&#160;integrity&#160;management<br/>framework&#160;and&#160;the&#160;credential&#160;management&#160;service&#160;on&#160;the&#160;Xen&#160;virtual&#160;machine&#160;moni-<br/>tor&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[20]</a>.&#160;The&#160;implementation&#160;features&#160;the&#160;management&#160;and&#160;service&#160;interfaces&#160;of&#160;both.<br/>Note&#160;that&#160;although&#160;we&#160;present&#160;our&#160;implementation&#160;with&#160;Xen,&#160;the&#160;framework&#160;could<br/>equally&#160;be&#160;implemented&#160;on&#160;an&#160;alternative&#160;virtualized&#160;or&#160;microkernel-based&#160;platform<br/>(e.g.,&#160;the&#160;L4/Fiasco&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#77">[42]&#160;</a>microkernel).</p>
<p style="position:absolute;top:375px;left:150px;white-space:nowrap" class="ft4444"><b>4.6.1</b></p>
<p style="position:absolute;top:375px;left:204px;white-space:nowrap" class="ft4444"><b>Infrastructure&#160;Overview</b></p>
<p style="position:absolute;top:405px;left:150px;white-space:nowrap" class="ft4415">The&#160;various&#160;components&#160;of&#160;the&#160;integrity&#160;management&#160;framework&#160;are&#160;provided&#160;by&#160;one<br/>or&#160;more&#160;virtual&#160;machines,&#160;running&#160;on&#160;top&#160;of&#160;the&#160;Xen&#160;virtual&#160;machine&#160;monitor.&#160;The<br/>use&#160;of&#160;virtualization&#160;isolates&#160;the&#160;trusted&#160;platform&#160;from&#160;a&#160;misbehaving&#160;guest&#160;operating<br/>system,&#160;and&#160;all&#160;communication&#160;with&#160;the&#160;trusted&#160;platform&#160;passes&#160;through&#160;well-defined<br/>interfaces.&#160;Our&#160;implementation&#160;is&#160;based&#160;on&#160;Xen&#160;version&#160;3.0.4,&#160;a&#160;VMM&#160;for&#160;the&#160;IA32<br/>platform,&#160;with&#160;the&#160;VMs&#160;running&#160;a&#160;para-virtualized&#160;version&#160;of&#160;Linux&#160;2.6.18.&#160;For&#160;inter-<br/>domain&#160;communication,&#160;we&#160;employ&#160;the&#160;light-weight&#160;communication&#160;library&#160;introduced<br/>in&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#74">[5]</a>.</p>
<p style="position:absolute;top:549px;left:172px;white-space:nowrap" class="ft4412">Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#45">4.8&#160;</a>illustrates&#160;our&#160;implementation&#160;on&#160;Xen.&#160;In&#160;the&#160;present&#160;prototype,&#160;all</p>
<p style="position:absolute;top:567px;left:150px;white-space:nowrap" class="ft4415">framework&#160;components&#160;and&#160;the&#160;CMS&#160;are&#160;implemented&#160;as&#160;libraries&#160;and&#160;services&#160;run-<br/>ning&#160;in&#160;the&#160;Xen&#160;privileged&#160;management&#160;domain&#160;Dom0.&#160;However,&#160;as&#160;we&#160;have&#160;defined<br/>interfaces&#160;between&#160;each&#160;of&#160;the&#160;components,&#160;it&#160;should&#160;be&#160;straightforward&#160;to&#160;move&#160;to-<br/>wards&#160;a&#160;disaggregated&#160;approach&#160;as&#160;described&#160;in&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#77">[49]</a>.&#160;The&#160;framework&#160;components&#160;are<br/>arranged&#160;in&#160;a&#160;layered&#160;stack.&#160;At&#160;the&#160;lowest&#160;layer&#160;is&#160;the&#160;basic&#160;management&#160;and&#160;secu-<br/>rity&#160;interface&#160;(BMSI)&#160;that&#160;provides&#160;libraries&#160;for&#160;domain&#160;life-cycle&#160;management&#160;(libM),<br/>basic&#160;TPM&#160;access&#160;(libT),&#160;and&#160;integrity&#160;management&#160;(libI).&#160;At&#160;the&#160;core&#160;services&#160;layer<br/>are&#160;the&#160;integrity&#160;manager&#160;services&#160;BIM&#160;and&#160;HIM&#160;that&#160;provide&#160;basic&#160;and&#160;hierarchical<br/>integrity&#160;management,&#160;respectively.&#160;Also&#160;in&#160;this&#160;layer&#160;are&#160;the&#160;CMS&#160;and&#160;the&#160;domain<br/>management&#160;service&#160;(DMS).&#160;At&#160;the&#160;highest&#160;layer&#160;are&#160;the&#160;security&#160;services&#160;that&#160;use&#160;the<br/>framework&#160;for&#160;various&#160;purposes.&#160;The&#160;platform&#160;TCB&#160;consists&#160;of&#160;the&#160;static&#160;components<br/>up&#160;to&#160;and&#160;including&#160;the&#160;SRTM&#160;(the&#160;BMSI&#160;libraries&#160;and&#160;the&#160;integrity&#160;managers).&#160;How-<br/>ever,&#160;for&#160;simplicity,&#160;we&#160;also&#160;include&#160;the&#160;CMS&#160;in&#160;the&#160;platform&#160;TCB.&#160;The&#160;measurements<br/>of&#160;these&#160;components&#160;are&#160;reported&#160;to&#160;the&#160;underlying&#160;TPM.&#160;The&#160;application&#160;TCB&#160;consists<br/>of&#160;the&#160;platform&#160;TCB&#160;plus&#160;the&#160;security&#160;services&#160;that&#160;run&#160;on&#160;top&#160;of&#160;it.&#160;The&#160;measurements<br/>of&#160;the&#160;latter&#160;are&#160;reported&#160;to&#160;the&#160;SRTM.</p>
<p style="position:absolute;top:894px;left:150px;white-space:nowrap" class="ft4444"><b>4.6.2</b></p>
<p style="position:absolute;top:894px;left:204px;white-space:nowrap" class="ft4444"><b>Component&#160;Design</b></p>
<p style="position:absolute;top:924px;left:150px;white-space:nowrap" class="ft4415">In&#160;the&#160;present&#160;prototype,&#160;we&#160;have&#160;implemented&#160;the&#160;highlighted&#160;components&#160;depicted<br/>in&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#45">4.8,&#160;</a>namely&#160;the&#160;BMSI&#160;libraries,&#160;BIM&#160;and&#160;HIM&#160;services,&#160;CMS,&#160;and&#160;DMS.&#160;In<br/>this&#160;section,&#160;we&#160;present&#160;the&#160;details&#160;of&#160;these&#160;components&#160;including&#160;both&#160;the&#160;BIM&#160;and<br/>HIM;&#160;however,&#160;due&#160;to&#160;space&#160;constraints,&#160;we&#160;present&#160;an&#160;example&#160;use&#160;case&#160;that&#160;uses&#160;only<br/>the&#160;HIM.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft4418">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 45 -->
<a name="45"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft45106{font-size:13px;font-family:VRBBWM+TT10F6Eo00;color:#000000;}
	.ft45107{font-size:9px;font-family:JBEEIF+TT10F6Fo00;color:#000000;}
	.ft45108{font-size:9px;font-family:DUCRGK+TT10F71o00;color:#000000;-moz-transform: matrix(         0,         -1, 1.0001200144,          0, 0, 0);-webkit-transform: matrix(         0,         -1, 1.0001200144,          0, 0, 0);-o-transform: matrix(         0,         -1, 1.0001200144,          0, 0, 0);-ms-transform: matrix(         0,         -1, 1.0001200144,          0, 0, 0);-moz-transform-origin: left 75%;-webkit-transform-origin: left 75%;-o-transform-origin: left 75%;-ms-transform-origin: left 75%;}
-->
</style>
<div id="page45-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL045.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft4512">CHAPTER&#160;4.&#160;HIERARCHICAL&#160;INTEGRITY&#160;MANAGEMENT</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft4512">43</p>
<p style="position:absolute;top:663px;left:554px;white-space:nowrap" class="ft45106">BMSI</p>
<p style="position:absolute;top:640px;left:420px;white-space:nowrap" class="ft45107">libI</p>
<p style="position:absolute;top:639px;left:549px;white-space:nowrap" class="ft45107">libM</p>
<p style="position:absolute;top:639px;left:486px;white-space:nowrap" class="ft45107">libT</p>
<p style="position:absolute;top:602px;left:412px;white-space:nowrap" class="ft45107">BIM</p>
<p style="position:absolute;top:602px;left:480px;white-space:nowrap" class="ft45107">HIM</p>
<p style="position:absolute;top:560px;left:456px;white-space:nowrap" class="ft45107">CMS</p>
<p style="position:absolute;top:470px;left:408px;white-space:nowrap" class="ft45107">vNET&#160;Service</p>
<p style="position:absolute;top:482px;left:504px;white-space:nowrap" class="ft45107">vTPM&#160;Service</p>
<p style="position:absolute;top:734px;left:537px;white-space:nowrap" class="ft45106">Xen&#160;VMM</p>
<p style="position:absolute;top:768px;left:410px;white-space:nowrap" class="ft45107">TPM</p>
<p style="position:absolute;top:768px;left:410px;white-space:nowrap" class="ft45107">TPM</p>
<p style="position:absolute;top:697px;left:422px;white-space:nowrap" class="ft45107">TPM&#160;</p>
<p style="position:absolute;top:707px;left:419px;white-space:nowrap" class="ft45107">driver</p>
<p style="position:absolute;top:506px;left:375px;white-space:nowrap" class="ft45108">Se</p>
<p style="position:absolute;top:498px;left:375px;white-space:nowrap" class="ft45108">curi</p>
<p style="position:absolute;top:484px;left:375px;white-space:nowrap" class="ft45108">ty&#160;</p>
<p style="position:absolute;top:475px;left:375px;white-space:nowrap" class="ft45108">se</p>
<p style="position:absolute;top:468px;left:375px;white-space:nowrap" class="ft45108">rv</p>
<p style="position:absolute;top:461px;left:375px;white-space:nowrap" class="ft45108">ice</p>
<p style="position:absolute;top:451px;left:375px;white-space:nowrap" class="ft45108">s</p>
<p style="position:absolute;top:596px;left:374px;white-space:nowrap" class="ft45108">Core</p>
<p style="position:absolute;top:580px;left:374px;white-space:nowrap" class="ft45108">&#160;se</p>
<p style="position:absolute;top:570px;left:374px;white-space:nowrap" class="ft45108">rvic</p>
<p style="position:absolute;top:557px;left:374px;white-space:nowrap" class="ft45108">es</p>
<p style="position:absolute;top:666px;left:366px;white-space:nowrap" class="ft45108">Library&#160;&#160;laye</p>
<p style="position:absolute;top:648px;left:376px;white-space:nowrap" class="ft45108">r</p>
<p style="position:absolute;top:709px;left:366px;white-space:nowrap" class="ft45108">Dri</p>
<p style="position:absolute;top:698px;left:366px;white-space:nowrap" class="ft45108">ve</p>
<p style="position:absolute;top:690px;left:366px;white-space:nowrap" class="ft45108">r&#160;</p>
<p style="position:absolute;top:707px;left:376px;white-space:nowrap" class="ft45108">laye</p>
<p style="position:absolute;top:692px;left:376px;white-space:nowrap" class="ft45108">r</p>
<p style="position:absolute;top:450px;left:565px;white-space:nowrap" class="ft4557"><b>Dom&#160;0</b></p>
<p style="position:absolute;top:552px;left:537px;white-space:nowrap" class="ft45107">DMS</p>
<p style="position:absolute;top:813px;left:310px;white-space:nowrap" class="ft4512">Figure&#160;4.8:&#160;Illustration&#160;of&#160;the&#160;prototype&#160;in&#160;a&#160;layered&#160;stack.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft4518">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 46 -->
<a name="46"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page46-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL046.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft4612">44</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft4618">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:193px;left:150px;white-space:nowrap" class="ft4617"><b>BMSI&#160;Libraries</b></p>
<p style="position:absolute;top:222px;left:150px;white-space:nowrap" class="ft4615">The&#160;Basic&#160;Management&#160;and&#160;Security&#160;Interface&#160;(BMSI)&#160;provides&#160;a&#160;common&#160;and&#160;ex-<br/>tensible&#160;interface&#160;to&#160;the&#160;underlying&#160;hypervisor&#160;(i.e.,&#160;Xen)&#160;and&#160;the&#160;TPM.&#160;The&#160;BMSI<br/>provides&#160;libraries&#160;for&#160;domain&#160;life-cycle&#160;management&#160;(libM),&#160;basic&#160;TPM&#160;access&#160;(libT),<br/>and&#160;integrity&#160;management&#160;(libI).</p>
<p style="position:absolute;top:323px;left:150px;white-space:nowrap" class="ft4617"><b>libM&#160;</b>This&#160;library&#160;provides&#160;hypervisor-agnostic&#160;management&#160;functions&#160;to&#160;upper&#160;layers.</p>
<p style="position:absolute;top:341px;left:187px;white-space:nowrap" class="ft4615">At&#160;its&#160;lowest&#160;level,&#160;the&#160;library&#160;manages&#160;allocatable&#160;resources&#160;called&#160;<i>Protection<br/>Domains&#160;(PDs)</i>.&#160;A&#160;PD&#160;is&#160;an&#160;executable&#160;component&#160;that&#160;receives&#160;an&#160;allocation&#160;of<br/>memory&#160;and&#160;CPU&#160;cycles,&#160;and&#160;is&#160;scheduled&#160;by&#160;the&#160;hypervisor.&#160;On&#160;Xen&#160;platforms,<br/>a&#160;PD&#160;is&#160;equivalent&#160;to&#160;a&#160;Xen&#160;domain&#160;(virtual&#160;machine).&#160;In&#160;this&#160;prototype,&#160;we<br/>use&#160;libM&#160;to&#160;implement&#160;the&#160;Domain&#160;Management&#160;Service&#160;(DMS).&#160;This&#160;service<br/>manages&#160;the&#160;life-cycle&#160;of&#160;PDs&#160;and&#160;uses&#160;the&#160;integrity&#160;managers&#160;to&#160;keep&#160;track&#160;of<br/>PD&#160;integrity.&#160;We&#160;refer&#160;the&#160;reader&#160;to&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#77">[49]&#160;</a>for&#160;further&#160;details&#160;on&#160;the&#160;libM&#160;and&#160;DMS<br/>implementation.</p>
<p style="position:absolute;top:497px;left:150px;white-space:nowrap" class="ft4617"><b>libT&#160;</b>This&#160;library&#160;provides&#160;the&#160;minimal&#160;functionality&#160;to&#160;access&#160;the&#160;integrity&#160;and&#160;pro-</p>
<p style="position:absolute;top:514px;left:187px;white-space:nowrap" class="ft4615">tected&#160;storage&#160;interfaces&#160;of&#160;the&#160;TPM.&#160;Security&#160;services&#160;(e.g.,&#160;BIM&#160;and&#160;HIM)<br/>use&#160;this&#160;library&#160;to&#160;obtain&#160;a&#160;signed&#160;quotation&#160;of&#160;the&#160;TCB&#160;measurements&#160;and<br/>to&#160;seal/unseal&#160;data&#160;to/from&#160;the&#160;TPM.&#160;To&#160;do&#160;so,&#160;libT&#160;uses&#160;the&#160;TPM&#160;functions</p>
<p style="position:absolute;top:569px;left:187px;white-space:nowrap" class="ft4659">TPM_Quote()</p>
<p style="position:absolute;top:568px;left:286px;white-space:nowrap" class="ft4612">,</p>
<p style="position:absolute;top:569px;left:297px;white-space:nowrap" class="ft4659">TPM_Seal()</p>
<p style="position:absolute;top:568px;left:387px;white-space:nowrap" class="ft4612">,&#160;and</p>
<p style="position:absolute;top:569px;left:427px;white-space:nowrap" class="ft4659">TPM_Unseal()</p>
<p style="position:absolute;top:568px;left:542px;white-space:nowrap" class="ft4612">as&#160;described&#160;by&#160;the</p>
<p style="position:absolute;top:586px;left:187px;white-space:nowrap" class="ft4612">TPM&#160;specification&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[74]</a>.</p>
<p style="position:absolute;top:616px;left:150px;white-space:nowrap" class="ft4617"><b>libI&#160;</b>This&#160;library&#160;stores&#160;and&#160;provides&#160;access&#160;to&#160;the&#160;integrity&#160;measurement&#160;and&#160;depen-</p>
<p style="position:absolute;top:634px;left:187px;white-space:nowrap" class="ft4612">dency&#160;tables.&#160;The</p>
<p style="position:absolute;top:635px;left:302px;white-space:nowrap" class="ft4659">getMeasurement()</p>
<p style="position:absolute;top:634px;left:450px;white-space:nowrap" class="ft4612">function&#160;returns&#160;a&#160;measurement&#160;list</p>
<p style="position:absolute;top:652px;left:187px;white-space:nowrap" class="ft4615">that&#160;includes&#160;the&#160;integrity&#160;measurements&#160;of&#160;the&#160;component&#160;and&#160;its&#160;ancestors.<br/>In&#160;the&#160;BIM&#160;case,&#160;a&#160;single&#160;value&#160;is&#160;returned.&#160;The</p>
<p style="position:absolute;top:671px;left:486px;white-space:nowrap" class="ft4659">setMeasurement()</p>
<p style="position:absolute;top:670px;left:634px;white-space:nowrap" class="ft4612">func-</p>
<p style="position:absolute;top:688px;left:187px;white-space:nowrap" class="ft4612">tion&#160;extends&#160;the&#160;value&#160;of&#160;the&#160;component&#160;register.&#160;The</p>
<p style="position:absolute;top:689px;left:504px;white-space:nowrap" class="ft4659">resetMeasurement()</p>
<p style="position:absolute;top:706px;left:187px;white-space:nowrap" class="ft4612">function&#160;overwrites&#160;the&#160;value&#160;of&#160;the&#160;dynamic&#160;register.&#160;The</p>
<p style="position:absolute;top:707px;left:540px;white-space:nowrap" class="ft4659">addComponent()</p>
<p style="position:absolute;top:724px;left:187px;white-space:nowrap" class="ft4615">function&#160;adds&#160;an&#160;entry&#160;to&#160;the&#160;dependency&#160;table&#160;and&#160;sets&#160;its&#160;dependencies&#160;as&#160;spec-<br/>ified.&#160;It&#160;also&#160;adds&#160;an&#160;entry&#160;to&#160;the&#160;measurements&#160;table&#160;and&#160;records&#160;the&#160;initial<br/>measurements.&#160;The</p>
<p style="position:absolute;top:760px;left:309px;white-space:nowrap" class="ft4659">deleteComponent()</p>
<p style="position:absolute;top:760px;left:465px;white-space:nowrap" class="ft4612">function&#160;checks&#160;that&#160;the&#160;specified</p>
<p style="position:absolute;top:777px;left:187px;white-space:nowrap" class="ft4612">component&#160;has&#160;no&#160;successors&#160;and&#160;removes&#160;it&#160;from&#160;the&#160;table.</p>
<p style="position:absolute;top:847px;left:150px;white-space:nowrap" class="ft4617"><b>Component&#160;Interactions</b></p>
<p style="position:absolute;top:875px;left:150px;white-space:nowrap" class="ft4615">The&#160;BIM&#160;and&#160;HIM&#160;services&#160;implement&#160;the&#160;interfaces&#160;presented&#160;in&#160;Sections&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#33">4.3&#160;</a>and&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#37">4.4,<br/></a>respectively.&#160;Similarly,&#160;the&#160;CMS&#160;service&#160;implements&#160;the&#160;interfaces&#160;presented&#160;in&#160;Sec-<br/>tion&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#42">4.5.1&#160;</a>and&#160;uses&#160;a&#160;cryptographic&#160;service&#160;as&#160;a&#160;plug-in&#160;for&#160;block&#160;encryption&#160;and&#160;de-<br/>cryption.&#160;On&#160;a&#160;Xen&#160;platform,&#160;we&#160;use&#160;these&#160;services&#160;to&#160;manage&#160;the&#160;integrity&#160;of&#160;VMs<br/>and&#160;applications&#160;running&#160;on&#160;these&#160;VMs.</p>
<p style="position:absolute;top:965px;left:172px;white-space:nowrap" class="ft4612">VM&#160;integrity&#160;management&#160;is&#160;incorporated&#160;into&#160;VM&#160;life-cycle&#160;management.&#160;To&#160;as-</p>
<p style="position:absolute;top:983px;left:150px;white-space:nowrap" class="ft4615">sist&#160;both,&#160;the&#160;DMS&#160;uses&#160;the&#160;BMSI&#160;library&#160;libM&#160;and&#160;the&#160;HIM&#160;service.&#160;The&#160;VM&#160;start-up<br/>phase&#160;in&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#48">4.9&#160;</a>depicts&#160;the&#160;interaction&#160;among&#160;these&#160;components.&#160;During&#160;this&#160;phase,<br/>the&#160;DMS&#160;invokes&#160;libM,&#160;which&#160;prepares&#160;resources&#160;for&#160;the&#160;VM,&#160;measures&#160;the&#160;VM&#160;image<br/>(comprising&#160;the&#160;kernel,&#160;an&#160;optional&#160;initial&#160;ram-disk&#160;and&#160;command-line&#160;parameters),<br/>and&#160;stores&#160;the&#160;measurement&#160;in&#160;the&#160;CCR&#160;for&#160;that&#160;VM.&#160;This&#160;performs&#160;a&#160;function&#160;similar</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft4618">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 47 -->
<a name="47"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page47-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL047.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft4712">CHAPTER&#160;4.&#160;HIERARCHICAL&#160;INTEGRITY&#160;MANAGEMENT</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft4712">45</p>
<p style="position:absolute;top:193px;left:226px;white-space:nowrap" class="ft4715">to&#160;a&#160;secure&#160;boot-loader,&#160;and&#160;it&#160;is&#160;the&#160;responsibility&#160;of&#160;the&#160;kernel&#160;to&#160;measure&#160;any&#160;compo-<br/>nents&#160;which&#160;it&#160;subsequently&#160;loads.&#160;The&#160;DMS&#160;also&#160;registers&#160;the&#160;new&#160;VM&#160;with&#160;the&#160;HIM<br/>service,&#160;and&#160;configures&#160;any&#160;dependencies&#160;between&#160;the&#160;new&#160;VM&#160;and&#160;existing&#160;VMs.&#160;The<br/>HIM&#160;uses&#160;libI&#160;to&#160;store&#160;this&#160;information&#160;in&#160;the&#160;measurement&#160;and&#160;dependency&#160;tables.<br/>Following&#160;the&#160;successful&#160;completion&#160;of&#160;the&#160;above&#160;steps,&#160;the&#160;DMS&#160;starts&#160;the&#160;VM.</p>
<p style="position:absolute;top:283px;left:248px;white-space:nowrap" class="ft4712">The&#160;HIM&#160;service&#160;additionally&#160;allows&#160;applications&#160;running&#160;in&#160;VMs&#160;to&#160;be&#160;registered</p>
<p style="position:absolute;top:301px;left:226px;white-space:nowrap" class="ft4715">with&#160;the&#160;framework.&#160;The&#160;application&#160;start-up&#160;phase&#160;in&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#48">4.9&#160;</a>depicts&#160;the&#160;case&#160;in<br/>which&#160;the&#160;VM&#160;that&#160;was&#160;started&#160;in&#160;the&#160;previous&#160;phase&#160;loads&#160;and&#160;registers&#160;a&#160;DRM&#160;service<br/>with&#160;the&#160;HIM.&#160;In&#160;this&#160;case,&#160;the&#160;VM&#160;becomes&#160;an&#160;ancestor&#160;of&#160;the&#160;service&#160;and&#160;provides&#160;its<br/>initial&#160;measurements.&#160;As&#160;a&#160;result,&#160;the&#160;cumulative&#160;integrity&#160;of&#160;the&#160;service&#160;now&#160;includes<br/>the&#160;VM’s&#160;measurements&#160;as&#160;well&#160;as&#160;the&#160;platform&#160;TCB&#160;measurements.</p>
<p style="position:absolute;top:391px;left:248px;white-space:nowrap" class="ft4712">The&#160;last&#160;phase&#160;in&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#48">4.9&#160;</a>depicts&#160;a&#160;use&#160;case&#160;in&#160;which&#160;the&#160;DRM&#160;service&#160;that&#160;was</p>
<p style="position:absolute;top:409px;left:226px;white-space:nowrap" class="ft4715">started&#160;in&#160;the&#160;previous&#160;phase&#160;attempts&#160;to&#160;decrypt&#160;encrypted&#160;media&#160;content&#160;using&#160;a&#160;key<br/>that&#160;is&#160;stored&#160;on&#160;the&#160;TPM&#160;on&#160;behalf&#160;of&#160;this&#160;service.&#160;The&#160;DRM&#160;service&#160;invokes&#160;the&#160;CMS<br/>service&#160;interface&#160;to&#160;request&#160;access&#160;to&#160;this&#160;key.&#160;The&#160;CMS&#160;then&#160;invokes&#160;HIM&#160;unseal&#160;to&#160;re-<br/>trieve&#160;the&#160;key&#160;from&#160;the&#160;TPM.&#160;HIM&#160;unseals&#160;the&#160;key&#160;if&#160;and&#160;only&#160;if&#160;the&#160;underlying&#160;policies<br/>regarding&#160;the&#160;key’s&#160;release&#160;are&#160;satisfied.&#160;In&#160;this&#160;case,&#160;the&#160;key&#160;is&#160;unsealed&#160;from&#160;the&#160;TPM<br/>and&#160;returned&#160;to&#160;the&#160;CMS&#160;if&#160;the&#160;integrity&#160;of&#160;the&#160;platform&#160;TCB&#160;is&#160;intact.&#160;On&#160;receiving&#160;the<br/>key&#160;from&#160;the&#160;HIM,&#160;the&#160;CMS&#160;performs&#160;further&#160;verification.&#160;It&#160;compares&#160;the&#160;expected<br/>CCR&#160;values&#160;of&#160;the&#160;DRM&#160;service&#160;and&#160;its&#160;ancestor&#160;VM&#160;(unsealed&#160;along&#160;with&#160;the&#160;key)&#160;to<br/>the&#160;current&#160;CCR&#160;values.&#160;If&#160;the&#160;measurements&#160;match,&#160;the&#160;CMS&#160;uses&#160;its&#160;cryptographic<br/>service&#160;to&#160;decrypt&#160;the&#160;block,&#160;which&#160;is&#160;then&#160;returned&#160;to&#160;the&#160;DRM&#160;service.&#160;Note&#160;that&#160;any<br/>subsequent&#160;access&#160;requests&#160;to&#160;the&#160;key&#160;will&#160;also&#160;follow&#160;a&#160;similar&#160;verification&#160;cycle,&#160;with<br/>the&#160;exception&#160;that&#160;HIM&#160;(hence&#160;TPM)&#160;seal&#160;is&#160;omitted&#160;because&#160;the&#160;CMS&#160;caches&#160;the&#160;key<br/>internally.</p>
<p style="position:absolute;top:688px;left:226px;white-space:nowrap" class="ft4720"><b>4.7</b></p>
<p style="position:absolute;top:688px;left:274px;white-space:nowrap" class="ft4720"><b>Related&#160;Work</b></p>
<p style="position:absolute;top:726px;left:226px;white-space:nowrap" class="ft4715">Berger&#160;<i>et&#160;al.&#160;</i><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#74">[9]&#160;</a>implemented&#160;a&#160;virtual&#160;TPM&#160;infrastructure&#160;in&#160;which&#160;each&#160;virtual&#160;ma-<br/>chine&#160;is&#160;assigned&#160;its&#160;own&#160;virtual&#160;TPM&#160;that&#160;provides&#160;multiplexed&#160;access&#160;to&#160;the&#160;under-<br/>lying&#160;hardware&#160;TPM.&#160;In&#160;comparison&#160;to&#160;virtual&#160;TPMs,&#160;our&#160;work&#160;uses&#160;a&#160;single&#160;integrity<br/>management&#160;framework&#160;that&#160;encompasses&#160;all&#160;components&#160;in&#160;order&#160;to&#160;explicitly&#160;rep-<br/>resent&#160;trust&#160;dependencies&#160;between&#160;them.&#160;Our&#160;framework&#160;is&#160;complementary&#160;to&#160;virtual<br/>TPMs&#160;in&#160;that&#160;we&#160;can&#160;use&#160;virtual&#160;TPMs&#160;to&#160;gather&#160;more&#160;granular&#160;run-time&#160;measurements<br/>for&#160;our&#160;components,&#160;and&#160;can&#160;enhance&#160;virtual&#160;TPMs&#160;by&#160;providing&#160;a&#160;binding&#160;between<br/>them&#160;and&#160;the&#160;platform&#160;TCB&#160;through&#160;the&#160;use&#160;of&#160;CMS.</p>
<p style="position:absolute;top:869px;left:248px;white-space:nowrap" class="ft4712">Several&#160;systems&#160;have&#160;been&#160;previously&#160;described&#160;that&#160;use&#160;virtual&#160;machine&#160;monitors</p>
<p style="position:absolute;top:887px;left:226px;white-space:nowrap" class="ft4715">to&#160;isolate&#160;trusted&#160;and&#160;untrusted&#160;components.&#160;Terra&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[27]&#160;</a>is&#160;an&#160;architecture&#160;that&#160;uses&#160;a<br/>trusted&#160;virtual&#160;machine&#160;monitor&#160;(TVMM)&#160;to&#160;bring&#160;the&#160;security&#160;advantages&#160;of&#160;“closed<br/>box”&#160;special-purpose&#160;platforms&#160;to&#160;general-purpose&#160;computing&#160;hardware.&#160;The&#160;TVMM<br/>ensures&#160;security&#160;at&#160;the&#160;virtual&#160;machine&#160;level,&#160;isolating&#160;VMs&#160;from&#160;one&#160;another,&#160;providing<br/>hardware&#160;memory&#160;protection,&#160;and&#160;providing&#160;cryptographic&#160;mechanisms&#160;for&#160;VMs&#160;to<br/>attest&#160;their&#160;integrity&#160;to&#160;remote&#160;parties,&#160;even&#160;providing&#160;protection&#160;from&#160;tampering&#160;by<br/>the&#160;platform&#160;owner.&#160;Microsoft’s&#160;proposed&#160;Next-Generation&#160;Secure&#160;Computing&#160;Base<br/>(NGSCB&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[23]</a>)&#160;operates&#160;in&#160;a&#160;similar&#160;manner,&#160;partitioning&#160;a&#160;platform&#160;into&#160;two&#160;parts<br/>running&#160;over&#160;a&#160;virtual&#160;machine&#160;monitor:&#160;an&#160;untrusted,&#160;unmodified&#160;legacy&#160;operating<br/>system,&#160;and&#160;a&#160;trusted,&#160;high-assurance&#160;kernel&#160;called&#160;a&#160;<i>nexus</i>.&#160;Our&#160;work&#160;builds&#160;on&#160;both<br/>to&#160;examine&#160;how&#160;integrity&#160;measurements&#160;can&#160;be&#160;stored&#160;and&#160;maintained.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft4718">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 48 -->
<a name="48"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft48109{font-size:5px;font-family:Helvetica;color:#000000;}
	.ft48110{font-size:182px;font-family:Times;color:#000000;}
-->
</style>
<div id="page48-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL048.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft4812">46</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft4818">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:429px;left:239px;white-space:nowrap" class="ft48109">DMS</p>
<p style="position:absolute;top:429px;left:276px;white-space:nowrap" class="ft48109">BMSI:libM</p>
<p style="position:absolute;top:441px;left:252px;white-space:nowrap" class="ft48109">prepareVM()</p>
<p style="position:absolute;top:526px;left:257px;white-space:nowrap" class="ft48109">runVM()</p>
<p style="position:absolute;top:558px;left:249px;white-space:nowrap" class="ft48109">VM_STARTED</p>
<p style="position:absolute;top:429px;left:322px;white-space:nowrap" class="ft48109">PD:VM</p>
<p style="position:absolute;top:458px;left:281px;white-space:nowrap" class="ft48109">preparePD()</p>
<p style="position:absolute;top:429px;left:492px;white-space:nowrap" class="ft48109">HIM</p>
<p style="position:absolute;top:473px;left:382px;white-space:nowrap" class="ft48109">register()</p>
<p style="position:absolute;top:505px;left:387px;white-space:nowrap" class="ft48109">CID</p>
<p style="position:absolute;top:429px;left:529px;white-space:nowrap" class="ft48109">BMSI:libI</p>
<p style="position:absolute;top:483px;left:500px;white-space:nowrap" class="ft48109">addComponent()</p>
<p style="position:absolute;top:494px;left:513px;white-space:nowrap" class="ft48109">CID</p>
<p style="position:absolute;top:537px;left:298px;white-space:nowrap" class="ft48109">startPD()</p>
<p style="position:absolute;top:548px;left:292px;white-space:nowrap" class="ft48109">PD_STARTED</p>
<p style="position:absolute;top:429px;left:570px;white-space:nowrap" class="ft48109">BMSI:libT</p>
<p style="position:absolute;top:644px;left:530px;white-space:nowrap" class="ft48109">unseal()</p>
<p style="position:absolute;top:429px;left:618px;white-space:nowrap" class="ft48109">TPM</p>
<p style="position:absolute;top:665px;left:587px;white-space:nowrap" class="ft48109">TPM_unseal()</p>
<p style="position:absolute;top:676px;left:586px;white-space:nowrap" class="ft48109">unsealed_blob</p>
<p style="position:absolute;top:708px;left:456px;white-space:nowrap" class="ft48109">getMeasurements()</p>
<p style="position:absolute;top:718px;left:448px;white-space:nowrap" class="ft48109">componentMeasurements</p>
<p style="position:absolute;top:319px;left:204px;white-space:nowrap" class="ft48110">&#160;</p>
<p style="position:absolute;top:429px;left:360px;white-space:nowrap" class="ft48109">VM:DRMS</p>
<p style="position:absolute;top:558px;left:403px;white-space:nowrap" class="ft48109">register()</p>
<p style="position:absolute;top:601px;left:409px;white-space:nowrap" class="ft48109">CID</p>
<p style="position:absolute;top:612px;left:338px;white-space:nowrap" class="ft48109">DRMS.run()</p>
<p style="position:absolute;top:633px;left:447px;white-space:nowrap" class="ft48109">unseal()</p>
<p style="position:absolute;top:580px;left:500px;white-space:nowrap" class="ft48109">addComponent()</p>
<p style="position:absolute;top:590px;left:513px;white-space:nowrap" class="ft48109">CID</p>
<p style="position:absolute;top:527px;left:184px;white-space:nowrap" class="ft48110"></p>
<p style="position:absolute;top:516px;left:252px;white-space:nowrap" class="ft48109">VM_READY</p>
<p style="position:absolute;top:429px;left:408px;white-space:nowrap" class="ft48109">CMS</p>
<p style="position:absolute;top:429px;left:443px;white-space:nowrap" class="ft48109">CMS:Crypto</p>
<p style="position:absolute;top:622px;left:383px;white-space:nowrap" class="ft48109">access()</p>
<p style="position:absolute;top:772px;left:374px;white-space:nowrap" class="ft48109">decryptedContent</p>
<p style="position:absolute;top:686px;left:523px;white-space:nowrap" class="ft48109">unsealed_blob</p>
<p style="position:absolute;top:697px;left:439px;white-space:nowrap" class="ft48109">unsealed_blob</p>
<p style="position:absolute;top:735px;left:414px;white-space:nowrap" class="ft48109">verify()</p>
<p style="position:absolute;top:750px;left:425px;white-space:nowrap" class="ft48109">decrypt()</p>
<p style="position:absolute;top:761px;left:418px;white-space:nowrap" class="ft48109">decrypted_blob</p>
<p style="position:absolute;top:817px;left:150px;white-space:nowrap" class="ft4815">Figure&#160;4.9:&#160;Sequence&#160;diagram&#160;of&#160;interactions&#160;between&#160;the&#160;framework&#160;services&#160;for&#160;a<br/>DRM&#160;application&#160;use&#160;case.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft4818">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 49 -->
<a name="49"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page49-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL049.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft4912">CHAPTER&#160;4.&#160;HIERARCHICAL&#160;INTEGRITY&#160;MANAGEMENT</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft4912">47</p>
<p style="position:absolute;top:193px;left:248px;white-space:nowrap" class="ft4912">Sailer&#160;<i>et&#160;al.</i>’s&#160;implementation&#160;of&#160;a&#160;TCG-based&#160;integrity&#160;measurement&#160;architec-</p>
<p style="position:absolute;top:211px;left:226px;white-space:nowrap" class="ft4915">ture&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[65]&#160;</a>was&#160;one&#160;of&#160;the&#160;earliest&#160;works&#160;to&#160;demonstrate&#160;the&#160;use&#160;of&#160;a&#160;TPM&#160;to&#160;verify<br/>the&#160;integrity&#160;of&#160;a&#160;system&#160;software&#160;stack.&#160;In&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[36]</a>,&#160;Jansen&#160;<i>et&#160;al.&#160;</i>propose&#160;an&#160;architecture<br/>for&#160;protection,&#160;enforcement,&#160;and&#160;verification&#160;(PEV)&#160;of&#160;security&#160;policies&#160;based&#160;on&#160;a&#160;tree<br/>structure&#160;containing&#160;integrity&#160;log&#160;data,&#160;where&#160;each&#160;node&#160;contains&#160;the&#160;data&#160;for&#160;one&#160;com-<br/>ponent&#160;and&#160;its&#160;children&#160;contain&#160;the&#160;data&#160;for&#160;its&#160;sub-components.&#160;PEV&#160;approaches&#160;the<br/>problem&#160;of&#160;trust&#160;flexibility&#160;and&#160;extensibility&#160;by&#160;defining&#160;a&#160;generalized&#160;attestation&#160;pro-<br/>tocol.&#160;A&#160;verifier&#160;sends&#160;an&#160;attestation&#160;request&#160;containing&#160;an&#160;XML&#160;descriptor&#160;that&#160;defines<br/>a&#160;projection&#160;function&#160;returning&#160;the&#160;subset&#160;of&#160;the&#160;integrity&#160;log&#160;of&#160;interest&#160;to&#160;the&#160;verifier.<br/>Sadeghi&#160;<i>et&#160;al.&#160;</i><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">[60]&#160;</a>extend&#160;the&#160;TCG&#160;notion&#160;of&#160;trust&#160;in&#160;a&#160;different&#160;direction&#160;by&#160;proposing<br/>attestation&#160;that&#160;is&#160;not&#160;based&#160;directly&#160;on&#160;hardware/software&#160;hashes&#160;but&#160;on&#160;abstract&#160;plat-<br/>form&#160;properties.&#160;Rather&#160;than&#160;checking&#160;a&#160;large&#160;list&#160;of&#160;permitted&#160;platform&#160;configurations,<br/>their&#160;system&#160;checks&#160;whether&#160;or&#160;not&#160;a&#160;given&#160;platform&#160;possesses&#160;valid&#160;certificates&#160;attest-<br/>ing&#160;to&#160;the&#160;desired&#160;properties.&#160;Such&#160;property&#160;certificates&#160;are&#160;issued&#160;by&#160;a&#160;trusted&#160;third<br/>party&#160;that&#160;associates&#160;concrete&#160;configurations&#160;with&#160;the&#160;properties&#160;they&#160;provide.&#160;Our&#160;sys-<br/>tem&#160;differs&#160;from&#160;these&#160;in&#160;providing&#160;a&#160;more&#160;granular&#160;verification&#160;of&#160;components&#160;such&#160;as<br/>individual&#160;virtual&#160;machines&#160;and&#160;applications&#160;within&#160;a&#160;platform,&#160;representing&#160;dependen-<br/>cies&#160;among&#160;them,&#160;and&#160;managing&#160;changes&#160;to&#160;measured&#160;components.</p>
<p style="position:absolute;top:516px;left:248px;white-space:nowrap" class="ft4912">Other&#160;orthogonal&#160;previous&#160;work&#160;has&#160;explored&#160;distributed&#160;trust&#160;and&#160;mandatory&#160;ac-</p>
<p style="position:absolute;top:534px;left:226px;white-space:nowrap" class="ft4915">cess&#160;control.&#160;Griffin&#160;<i>et&#160;al.&#160;</i>investigated&#160;secure&#160;distributed&#160;services&#160;with&#160;Trusted&#160;Virtual<br/>Domains&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[31]</a>,&#160;which&#160;are&#160;intended&#160;to&#160;offload&#160;security&#160;analysis&#160;and&#160;enforcement&#160;onto&#160;a<br/>distributed&#160;infrastructure.&#160;Berger&#160;<i>et&#160;al.&#160;</i>use&#160;this&#160;abstraction&#160;in&#160;the&#160;Trusted&#160;Virtual&#160;Dat-<br/>acenter&#160;(TVDc)&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#74">[10]</a>,&#160;which&#160;shares&#160;hardware&#160;resources&#160;among&#160;virtual&#160;workloads&#160;while<br/>providing&#160;isolation&#160;with&#160;a&#160;mandatory&#160;access&#160;control&#160;policy&#160;enforced&#160;by&#160;the&#160;sHype&#160;se-<br/>curity&#160;architecture&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[64]</a>.</p>
<p style="position:absolute;top:688px;left:226px;white-space:nowrap" class="ft4920"><b>4.8</b></p>
<p style="position:absolute;top:688px;left:274px;white-space:nowrap" class="ft4920"><b>Conclusions</b></p>
<p style="position:absolute;top:726px;left:226px;white-space:nowrap" class="ft4915">In&#160;this&#160;paper,&#160;we&#160;have&#160;introduced&#160;a&#160;novel&#160;integrity&#160;management&#160;framework&#160;that&#160;im-<br/>proves&#160;on&#160;the&#160;integrity&#160;measurement&#160;and&#160;policy&#160;verification&#160;capabilities&#160;of&#160;present<br/>Trusted&#160;Computing&#160;solutions.&#160;In&#160;particular,&#160;our&#160;framework&#160;is&#160;able&#160;to&#160;cope&#160;with&#160;the<br/>proliferation&#160;of&#160;measured&#160;components&#160;and&#160;dependencies&#160;between&#160;them&#160;as&#160;well&#160;as&#160;dy-<br/>namic&#160;changes&#160;to&#160;platform&#160;components.&#160;In&#160;essence,&#160;the&#160;framework&#160;implements&#160;a&#160;small,<br/>software-based&#160;root&#160;of&#160;trust&#160;for&#160;measurement&#160;(SRTM)&#160;that&#160;provides&#160;a&#160;secure&#160;link&#160;to&#160;the<br/>core&#160;root&#160;of&#160;trust&#160;for&#160;measurement&#160;(CRTM).&#160;We&#160;have&#160;implemented&#160;our&#160;framework&#160;on<br/>the&#160;Xen&#160;virtual&#160;machine&#160;monitor&#160;and&#160;proposed&#160;several&#160;ways&#160;in&#160;which&#160;security&#160;services<br/>could&#160;take&#160;advantage&#160;of&#160;this&#160;architecture&#160;for&#160;policy&#160;verification&#160;and&#160;access&#160;control.</p>
<p style="position:absolute;top:887px;left:248px;white-space:nowrap" class="ft4912">We&#160;anticipate&#160;integrity&#160;and&#160;trust&#160;management&#160;to&#160;become&#160;especially&#160;useful&#160;for&#160;appli-</p>
<p style="position:absolute;top:905px;left:226px;white-space:nowrap" class="ft4915">cation&#160;and&#160;service&#160;level&#160;components.&#160;We&#160;will&#160;therefore&#160;continue&#160;to&#160;investigate&#160;further<br/>potential&#160;uses&#160;for&#160;our&#160;framework&#160;by&#160;user&#160;level&#160;applications.&#160;In&#160;the&#160;short&#160;term,&#160;we&#160;plan<br/>to&#160;implement&#160;CMS-aware&#160;services&#160;such&#160;as&#160;a&#160;virtual&#160;network&#160;service&#160;based&#160;on&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[13]&#160;</a>that<br/>uses&#160;the&#160;CMS&#160;to&#160;store&#160;encryption&#160;keys.&#160;The&#160;virtual&#160;TPM&#160;service&#160;is&#160;also&#160;particularly<br/>interesting.&#160;In&#160;the&#160;long&#160;term,&#160;we&#160;plan&#160;to&#160;investigate&#160;various&#160;ways&#160;of&#160;exploiting&#160;our<br/>framework&#160;to&#160;help&#160;enhance&#160;the&#160;security&#160;properties&#160;of&#160;virtual&#160;TPM&#160;services&#160;(e.g.,&#160;their<br/>binding&#160;to&#160;the&#160;platform&#160;TCB).&#160;Conversely,&#160;we&#160;plan&#160;to&#160;use&#160;virtual&#160;TPM&#160;services&#160;to&#160;help<br/>enhance&#160;the&#160;measurement&#160;capabilities&#160;of&#160;the&#160;HIM&#160;framework&#160;and&#160;provide&#160;more&#160;granu-<br/>lar&#160;run-time&#160;measurements&#160;compared&#160;to&#160;a&#160;single&#160;CCR.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft4918">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 50 -->
<a name="50"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page50-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL050.png" alt="background image"/>
<p style="position:absolute;top:295px;left:150px;white-space:nowrap" class="ft5019"><b>Chapter&#160;5</b></p>
<p style="position:absolute;top:365px;left:150px;white-space:nowrap" class="ft5031"><b>Trusted&#160;Channels&#160;with&#160;Remote<br/>Integrity&#160;Verification</b></p>
<p style="position:absolute;top:467px;left:174px;white-space:nowrap" class="ft5012">Ahmad-Reza&#160;Sadeghi&#160;(RUB),&#160;Martin&#160;Unger&#160;(RUB),&#160;Yacine&#160;Gasmi&#160;(RUB),&#160;Patrick</p>
<p style="position:absolute;top:485px;left:255px;white-space:nowrap" class="ft5012">Stewin&#160;(RUB),&#160;Gianluca&#160;Ramunno&#160;(Polito),&#160;Davide&#160;Vernizzi&#160;(Polito)</p>
<p style="position:absolute;top:564px;left:150px;white-space:nowrap" class="ft5020"><b>5.1</b></p>
<p style="position:absolute;top:564px;left:198px;white-space:nowrap" class="ft5020"><b>Motivation</b></p>
<p style="position:absolute;top:602px;left:150px;white-space:nowrap" class="ft5015">At&#160;the&#160;dawn&#160;of&#160;a&#160;new&#160;digital&#160;era&#160;where&#160;users&#160;all&#160;around&#160;the&#160;world&#160;begin&#160;to&#160;make&#160;use<br/>of&#160;services&#160;like&#160;on-line&#160;banking,&#160;e-commerce&#160;and&#160;e-government&#160;services,&#160;as&#160;well&#160;as<br/>distributed&#160;work,&#160;we&#160;are&#160;facing&#160;a&#160;problem&#160;becoming&#160;more&#160;and&#160;more&#160;apparent:&#160;The<br/>ability&#160;to&#160;enforce&#160;access&#160;control&#160;and&#160;provide&#160;secure&#160;communication&#160;is&#160;crucial&#160;to&#160;the<br/>security&#160;of&#160;many&#160;of&#160;these&#160;services.&#160;Since&#160;the&#160;usage&#160;of&#160;most&#160;of&#160;these&#160;services&#160;relies<br/>on&#160;the&#160;Internet&#160;which&#160;is&#160;a&#160;completely&#160;open&#160;medium,&#160;secure&#160;communication&#160;and&#160;access<br/>control&#160;are&#160;normally&#160;based&#160;on&#160;the&#160;establishment&#160;of&#160;secure&#160;communication&#160;channels&#160;as<br/>provided&#160;by&#160;common&#160;security&#160;protocols&#160;like&#160;TLS&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[19]&#160;</a>or&#160;Internet&#160;Protocol&#160;Security<br/>(IPSec)&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#77">[39]</a>.&#160;These&#160;protocols&#160;provide&#160;functionality&#160;to&#160;protect&#160;data&#160;during&#160;transmission<br/>between&#160;authenticated&#160;endpoints.&#160;However,&#160;these&#160;protocols&#160;do&#160;not&#160;protect&#160;from&#160;mali-<br/>cious&#160;or&#160;virus-infected&#160;endpoints.&#160;With&#160;respect&#160;to&#160;communication&#160;over&#160;the&#160;Internet&#160;the<br/>protocols&#160;themselves&#160;are&#160;rarely&#160;the&#160;target&#160;of&#160;attacks.&#160;Attackers&#160;focus&#160;on&#160;the&#160;endpoints<br/>because&#160;their&#160;security&#160;mechanisms&#160;are&#160;usually&#160;much&#160;easier&#160;to&#160;overcome.</p>
<p style="position:absolute;top:835px;left:172px;white-space:nowrap" class="ft5012">This&#160;leads&#160;to&#160;the&#160;central&#160;problem&#160;of&#160;today’s&#160;secure&#160;channel&#160;protocols:&#160;using&#160;a&#160;se-</p>
<p style="position:absolute;top:853px;left:150px;white-space:nowrap" class="ft5015">cure&#160;channel&#160;to&#160;communicate&#160;with&#160;a&#160;peer&#160;whose&#160;integrity&#160;is&#160;completely&#160;unknown&#160;opens<br/>doors&#160;for&#160;a&#160;wide&#160;range&#160;of&#160;attacks,&#160;e.g.,&#160;so&#160;called&#160;“phishing”&#160;or&#160;data&#160;theft&#160;by&#160;infiltrat-<br/>ing&#160;a&#160;platform&#160;with&#160;a&#160;Trojan.&#160;Thus,&#160;sensitive&#160;data&#160;transferred&#160;to&#160;a&#160;counterpart&#160;could<br/>be&#160;compromised&#160;as&#160;soon&#160;as&#160;it&#160;arrives,&#160;no&#160;matter&#160;how&#160;secure&#160;the&#160;protocol&#160;chosen&#160;for<br/>transmission&#160;is&#160;deemed.&#160;The&#160;conclusion&#160;is&#160;that&#160;the&#160;secure&#160;provision&#160;of&#160;digital&#160;services<br/>over&#160;the&#160;Internet&#160;is&#160;not&#160;possible&#160;without&#160;considering&#160;endpoint&#160;integrity.</p>
<p style="position:absolute;top:960px;left:172px;white-space:nowrap" class="ft5012">For&#160;this&#160;purpose&#160;some&#160;sort&#160;of&#160;information&#160;and&#160;evidence&#160;on&#160;the&#160;counterparts&#160;integrity</p>
<p style="position:absolute;top:978px;left:150px;white-space:nowrap" class="ft5015">or&#160;configuration&#160;has&#160;to&#160;be&#160;provided.&#160;This&#160;has&#160;to&#160;be&#160;done&#160;in&#160;a&#160;secure&#160;and&#160;reliable&#160;man-<br/>ner&#160;to&#160;enable&#160;the&#160;peers&#160;to&#160;judge&#160;each&#160;other’s&#160;“trustworthiness”&#160;based&#160;on&#160;information<br/>received.&#160;Reporting&#160;configuration&#160;information&#160;of&#160;a&#160;remote&#160;platform&#160;is&#160;one&#160;of&#160;the&#160;main<br/>features&#160;of&#160;Trusted&#160;Computing&#160;(TC)&#160;as&#160;proposed&#160;by&#160;the&#160;Trusted&#160;Computing&#160;Group<br/>(TCG)(<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[74]</a>).&#160;The&#160;basic&#160;idea&#160;is&#160;to&#160;securely&#160;capture&#160;configuration&#160;information&#160;or&#160;fin-<br/>gerprints&#160;of&#160;the&#160;core&#160;components&#160;of&#160;the&#160;platform&#160;(firmware&#160;and&#160;software).&#160;This&#160;infor-</p>
<p style="position:absolute;top:1117px;left:400px;white-space:nowrap" class="ft5012">48</p>
</div>
<!-- Page 51 -->
<a name="51"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page51-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL051.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft5112">CHAPTER&#160;5.&#160;TRUSTED&#160;CHANNELS&#160;WITH&#160;REMOTE&#160;INTEGRITY&#160;VERIFICATION49</p>
<p style="position:absolute;top:193px;left:226px;white-space:nowrap" class="ft5115">mation&#160;is&#160;stored&#160;in&#160;a&#160;cost-effective,&#160;tamper-resistant&#160;Trusted&#160;Platform&#160;Module&#160;(TPM).<br/>The&#160;TPM&#160;in&#160;turn&#160;is&#160;mounted&#160;on&#160;the&#160;ma-inboard&#160;of&#160;the&#160;computing&#160;platform&#160;and&#160;acts<br/>as&#160;trust&#160;anchor.&#160;It&#160;can&#160;sign&#160;gathered&#160;configuration&#160;information&#160;and&#160;report&#160;it&#160;to&#160;a&#160;re-<br/>questing&#160;party.&#160;This&#160;process&#160;is&#160;called</p>
<p style="position:absolute;top:246px;left:455px;white-space:nowrap" class="ft5129">attestation</p>
<p style="position:absolute;top:247px;left:532px;white-space:nowrap" class="ft5112">by&#160;the&#160;TCG.&#160;Additionally&#160;data&#160;can</p>
<p style="position:absolute;top:265px;left:226px;white-space:nowrap" class="ft5112">be&#160;stored&#160;bound&#160;to&#160;a&#160;specific&#160;platform&#160;configuration.&#160;The&#160;TCG&#160;calls&#160;this&#160;mechanism</p>
<p style="position:absolute;top:282px;left:226px;white-space:nowrap" class="ft5129">binding/sealing</p>
<p style="position:absolute;top:283px;left:336px;white-space:nowrap" class="ft5112">data.</p>
<p style="position:absolute;top:301px;left:248px;white-space:nowrap" class="ft5112">Thus,&#160;we&#160;chose&#160;to&#160;base&#160;our&#160;approach&#160;on&#160;the&#160;combination&#160;of&#160;TCG&#160;TC&#160;function-</p>
<p style="position:absolute;top:319px;left:226px;white-space:nowrap" class="ft5115">ality&#160;and&#160;the&#160;TLS&#160;protocol,&#160;forming&#160;a&#160;Trusted&#160;Channel.&#160;The&#160;central&#160;feature&#160;of&#160;the<br/>Trusted&#160;Channel&#160;is&#160;the&#160;capability&#160;to&#160;provide&#160;reliable&#160;evidence&#160;concerning&#160;the&#160;trust-<br/>worthiness&#160;of&#160;a&#160;communication&#160;partner.&#160;Furthermore,&#160;by&#160;means&#160;of&#160;a&#160;specific&#160;system<br/>architecture&#160;based&#160;on&#160;virtualization&#160;we&#160;are&#160;able&#160;to&#160;enforce</p>
<p style="position:absolute;top:372px;left:569px;white-space:nowrap" class="ft5129">conf&#160;identiality</p>
<p style="position:absolute;top:373px;left:672px;white-space:nowrap" class="ft5112">,</p>
<p style="position:absolute;top:372px;left:678px;white-space:nowrap" class="ft5129">integrity</p>
<p style="position:absolute;top:373px;left:738px;white-space:nowrap" class="ft5112">,</p>
<p style="position:absolute;top:390px;left:226px;white-space:nowrap" class="ft5129">authenticity</p>
<p style="position:absolute;top:391px;left:312px;white-space:nowrap" class="ft5112">and</p>
<p style="position:absolute;top:390px;left:338px;white-space:nowrap" class="ft5129">f&#160;reshness</p>
<p style="position:absolute;top:391px;left:410px;white-space:nowrap" class="ft5112">of&#160;data&#160;not&#160;only&#160;during&#160;transmission&#160;but&#160;also&#160;on&#160;the&#160;in-</p>
<p style="position:absolute;top:409px;left:226px;white-space:nowrap" class="ft5115">volved&#160;endpoints.&#160;It&#160;has&#160;to&#160;be&#160;pointed&#160;out&#160;that&#160;the&#160;linkage&#160;of&#160;configuration&#160;information<br/>provided&#160;by&#160;TC&#160;facilities&#160;to&#160;the&#160;TLS&#160;channel&#160;is&#160;crucial&#160;to&#160;prevent&#160;<i>relay&#160;attacks&#160;</i>where<br/>the&#160;configuration&#160;of&#160;a&#160;third&#160;platform,&#160;deemed&#160;trustworthy,&#160;is&#160;relayed&#160;by&#160;an&#160;attacker,<br/>acting&#160;as&#160;Man-In-The-Middle,&#160;to&#160;the&#160;counterpart,&#160;hiding&#160;the&#160;attacker’s&#160;own&#160;malicious<br/>system&#160;configuration.</p>
<p style="position:absolute;top:498px;left:248px;white-space:nowrap" class="ft5112">Linking&#160;endpoint&#160;configuration&#160;information&#160;to&#160;secure&#160;channels&#160;has&#160;been&#160;already</p>
<p style="position:absolute;top:516px;left:226px;white-space:nowrap" class="ft5115">investigated&#160;in&#160;the&#160;literature&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[29,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">69,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">62,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#77">46,&#160;37,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">16,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">52]</a>),&#160;often&#160;also&#160;combined<br/>with&#160;the&#160;TLS&#160;protocol&#160;because&#160;it&#160;is&#160;the&#160;most&#160;common&#160;possibility&#160;to&#160;provide&#160;secure<br/>communication&#160;channels.&#160;The&#160;TCG&#160;also&#160;addresses&#160;this&#160;issue&#160;in&#160;a&#160;specific&#160;work&#160;group<br/>(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[73,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#80">80]</a>).&#160;However,&#160;none&#160;of&#160;the&#160;solutions&#160;so&#160;far&#160;addresses&#160;the&#160;problem&#160;fully.&#160;In<br/>a&#160;recent&#160;approach&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[28]</a>)&#160;a&#160;protocol&#160;and&#160;a&#160;generic&#160;system&#160;architecture&#160;for&#160;establish-<br/>ing&#160;and&#160;maintaining&#160;Trusted&#160;Channels,&#160;using&#160;TC&#160;functionality&#160;and&#160;the&#160;TLS&#160;protocol,<br/>was&#160;proposed&#160;that&#160;overcomes&#160;the&#160;shortcomings&#160;identified&#160;in&#160;the&#160;previously&#160;referenced<br/>concepts.&#160;But,&#160;that&#160;approach&#160;in&#160;turn&#160;incorporates&#160;other&#160;deficiencies.&#160;Some&#160;concepts&#160;di-<br/>rectly&#160;violate&#160;the&#160;TLS&#160;specification&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[19]</a>),&#160;e.g.,&#160;by&#160;adapting&#160;specified&#160;data&#160;formats<br/>within&#160;the&#160;key&#160;exchange&#160;messages&#160;or&#160;adding&#160;data&#160;to&#160;session&#160;key&#160;computation.&#160;Fur-<br/>thermore,&#160;only&#160;a&#160;RSA&#160;key&#160;transport&#160;handshake&#160;is&#160;possible.&#160;Since&#160;the&#160;Diffie-Hellman<br/>variants&#160;of&#160;the&#160;handshake&#160;are&#160;at&#160;least&#160;as&#160;important&#160;it&#160;is&#160;crucial&#160;to&#160;provide&#160;support&#160;for<br/>them.&#160;Additionally,&#160;fundamental&#160;functional&#160;requirements&#160;like,&#160;e.g.,&#160;backwards&#160;com-<br/>patibility,&#160;technical&#160;feasibility,&#160;costs&#160;of&#160;certification&#160;processes&#160;or&#160;updates&#160;of&#160;the&#160;TCB<br/>are&#160;not&#160;taken&#160;into&#160;account.</p>
<p style="position:absolute;top:790px;left:226px;white-space:nowrap" class="ft5115"><b>Main&#160;Contribution:&#160;</b>To&#160;overcome&#160;the&#160;described&#160;shortcomings&#160;we&#160;present&#160;a&#160;new&#160;ap-<br/>proach&#160;that&#160;bases&#160;on&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[28]&#160;</a>but,&#160;in&#160;turn,&#160;respects&#160;functional&#160;requirements&#160;listed&#160;in&#160;detail<br/>in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#52">5.2.2&#160;</a>and&#160;focuses&#160;on&#160;a&#160;reference&#160;implementation&#160;to&#160;enable&#160;the&#160;deployment<br/>of&#160;our&#160;approach.</p>
<p style="position:absolute;top:866px;left:226px;white-space:nowrap" class="ft5115">Thus,&#160;our&#160;main&#160;contribution&#160;is&#160;that&#160;our&#160;concept&#160;(1)&#160;fully&#160;adheres&#160;to&#160;the&#160;TLS&#160;specifi-<br/>cation&#160;and&#160;uses&#160;existing&#160;message&#160;extension&#160;formats&#160;to&#160;convey&#160;configuration&#160;informa-<br/>tion.&#160;Thus,&#160;no&#160;time&#160;consuming&#160;and&#160;complicated&#160;specification&#160;process&#160;has&#160;to&#160;be&#160;con-<br/>ducted.&#160;This,&#160;in&#160;turn,&#160;enables&#160;a&#160;fast&#160;deployment&#160;of&#160;our&#160;solution.&#160;To&#160;further&#160;facilitate&#160;a<br/>widespread&#160;deployment&#160;we&#160;(2)&#160;designed&#160;our&#160;concept&#160;to&#160;incorporate&#160;functional&#160;require-<br/>ments&#160;like,&#160;e.g.,&#160;the&#160;possibility&#160;to&#160;update&#160;systems&#160;without&#160;the&#160;need&#160;for&#160;re-certification,<br/>backwards&#160;compatibility,&#160;performant&#160;system&#160;design&#160;as&#160;well&#160;as&#160;incurring&#160;no&#160;additional<br/>costs&#160;for&#160;the&#160;users.&#160;Apart&#160;from&#160;that&#160;(3)&#160;support&#160;for&#160;all&#160;relevant&#160;kinds&#160;of&#160;key&#160;exchange<br/>methods&#160;is&#160;provided.&#160;Furthermore,&#160;we&#160;(4)&#160;present&#160;a&#160;reference&#160;implementation&#160;of&#160;our<br/>Trusted&#160;Channel&#160;protocol&#160;and&#160;security&#160;architecture.</p>
<p style="position:absolute;top:1050px;left:226px;white-space:nowrap" class="ft5115"><b>Outline:&#160;</b>In&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#52">5.2&#160;</a>we&#160;define&#160;the&#160;properties&#160;to&#160;be&#160;provided&#160;by&#160;Trusted&#160;Channels.<br/>Then,&#160;in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#53">5.3,&#160;</a>we&#160;show&#160;the&#160;basic&#160;idea&#160;that&#160;our&#160;approach&#160;stems&#160;from,&#160;followed</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft5118">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 52 -->
<a name="52"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page52-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL052.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft5212">50</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft5218">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:193px;left:150px;white-space:nowrap" class="ft5215">by&#160;the&#160;detailed&#160;description&#160;of&#160;the&#160;security&#160;architecture&#160;and&#160;the&#160;protocol&#160;our&#160;Trusted<br/>Channel&#160;bases&#160;on&#160;in&#160;Sections&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#53">5.4&#160;</a>and&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#57">5.5.&#160;</a>Subsequently,&#160;we&#160;show&#160;our&#160;implementation<br/>of&#160;a&#160;secure&#160;TLS&#160;framework&#160;in&#160;detail&#160;in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#62">5.6.&#160;</a>Finally,&#160;in&#160;the&#160;Sections&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#64">5.7&#160;</a>and<br/><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#65">5.8,&#160;</a>we&#160;present&#160;considerations&#160;regarding&#160;the&#160;security-related&#160;as&#160;well&#160;as&#160;the&#160;functional<br/>requirements&#160;described&#160;in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#52">5.2,&#160;</a>concluded&#160;by&#160;a&#160;short&#160;Summary&#160;in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#66">5.9.</a></p>
<p style="position:absolute;top:334px;left:150px;white-space:nowrap" class="ft5220"><b>5.2</b></p>
<p style="position:absolute;top:334px;left:198px;white-space:nowrap" class="ft5220"><b>Requirement&#160;Analysis</b></p>
<p style="position:absolute;top:372px;left:150px;white-space:nowrap" class="ft5215">In&#160;this&#160;Section&#160;we&#160;define&#160;the&#160;properties&#160;of&#160;our&#160;Trusted&#160;Channel&#160;concept&#160;and&#160;derive&#160;the<br/>requirements&#160;necessary&#160;to&#160;provide&#160;those&#160;properties.<br/><b>Adversary&#160;Model</b>:&#160;The&#160;attacker&#160;may&#160;be&#160;a&#160;normal&#160;user&#160;or&#160;even&#160;the&#160;administrator&#160;of<br/>a&#160;platform,&#160;either&#160;eavesdropping&#160;the&#160;communication&#160;between&#160;two&#160;platforms&#160;or&#160;con-<br/>trolling&#160;one&#160;of&#160;the&#160;peers&#160;directly&#160;involved&#160;in&#160;the&#160;communication.&#160;He&#160;is&#160;capable&#160;to<br/>manipulate&#160;the&#160;software&#160;running&#160;on&#160;a&#160;platform,&#160;further&#160;he&#160;can&#160;eavesdrop,&#160;replace,&#160;re-<br/>play,&#160;relay&#160;or&#160;manipulate&#160;data&#160;transferred.&#160;But,&#160;we&#160;do&#160;not&#160;consider&#160;hardware&#160;attacks&#160;on<br/>any&#160;platform&#160;directly&#160;involved&#160;in&#160;the&#160;communication&#160;using&#160;a&#160;Trusted&#160;Channel.</p>
<p style="position:absolute;top:556px;left:150px;white-space:nowrap" class="ft5244"><b>5.2.1</b></p>
<p style="position:absolute;top:556px;left:208px;white-space:nowrap" class="ft5244"><b>Security&#160;Requirements</b></p>
<p style="position:absolute;top:586px;left:150px;white-space:nowrap" class="ft5215">In&#160;this&#160;paper,&#160;we&#160;adopt&#160;the&#160;security&#160;requirements&#160;presented&#160;in&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[28]&#160;</a>for&#160;a&#160;Trusted&#160;Chan-<br/>nel:</p>
<p style="position:absolute;top:644px;left:157px;white-space:nowrap" class="ft5217"><b>(SR1)&#160;Secure&#160;channel&#160;properties:&#160;</b>Integrity&#160;and&#160;confidentiality&#160;of&#160;data,&#160;freshness&#160;to</p>
<p style="position:absolute;top:662px;left:180px;white-space:nowrap" class="ft5215">prevent&#160;replay&#160;attacks,&#160;and&#160;authenticity&#160;both&#160;during&#160;transmission&#160;as&#160;well&#160;as&#160;within<br/>the&#160;endpoints&#160;have&#160;to&#160;be&#160;provided.</p>
<p style="position:absolute;top:702px;left:157px;white-space:nowrap" class="ft5217"><b>(SR2)&#160;Authentic&#160;linkage&#160;of&#160;configuration&#160;information&#160;and&#160;secure&#160;channel:&#160;</b>Au-</p>
<p style="position:absolute;top:720px;left:180px;white-space:nowrap" class="ft5215">thentic&#160;configuration&#160;information&#160;has&#160;to&#160;be&#160;delivered&#160;during&#160;the&#160;establishment&#160;and<br/>while&#160;the&#160;Trusted&#160;Channel&#160;is&#160;in&#160;place&#160;(e.g.,&#160;the&#160;system&#160;state&#160;changes).</p>
<p style="position:absolute;top:761px;left:157px;white-space:nowrap" class="ft5217"><b>(SR3)&#160;Privacy:&#160;</b>Creation&#160;and&#160;maintenance&#160;of&#160;the&#160;channel&#160;should&#160;adhere&#160;to&#160;the&#160;least</p>
<p style="position:absolute;top:778px;left:180px;white-space:nowrap" class="ft5215">information&#160;paradigm,&#160;i.e.,&#160;disclosure&#160;of&#160;a&#160;platform’s&#160;configuration&#160;information<br/>not&#160;beyond&#160;what&#160;is&#160;necessary&#160;for&#160;proper&#160;validation.&#160;Furthermore,&#160;platform&#160;con-<br/>figuration&#160;information&#160;has&#160;to&#160;be&#160;protected&#160;against&#160;disclosure&#160;to&#160;a&#160;third&#160;party.</p>
<p style="position:absolute;top:878px;left:150px;white-space:nowrap" class="ft5244"><b>5.2.2</b></p>
<p style="position:absolute;top:878px;left:204px;white-space:nowrap" class="ft5244"><b>Functional&#160;Requirements</b></p>
<p style="position:absolute;top:908px;left:150px;white-space:nowrap" class="ft5215">Looking&#160;at&#160;the&#160;wide&#160;area&#160;of&#160;application&#160;of&#160;TLS&#160;on,&#160;e.g.,&#160;servers,&#160;desktop-PCs,&#160;laptops<br/>and&#160;infrastructure&#160;devices&#160;like&#160;gateways,&#160;all&#160;with&#160;different&#160;functional&#160;needs&#160;concerning<br/>the&#160;setup&#160;of&#160;Trusted&#160;Channels,&#160;it&#160;becomes&#160;obvious&#160;that&#160;our&#160;approach&#160;has&#160;to&#160;adhere&#160;to<br/>certain&#160;functional&#160;requirements.&#160;Thus,&#160;in&#160;addition&#160;to&#160;the&#160;security-related,&#160;our&#160;approach<br/>fulfills&#160;the&#160;following&#160;functional&#160;requirements:</p>
<p style="position:absolute;top:1002px;left:157px;white-space:nowrap" class="ft5217"><b>(FR1)&#160;Fast&#160;deployment&#160;support&#160;:&#160;</b>The&#160;alterations&#160;to&#160;existing&#160;software&#160;have&#160;to&#160;be&#160;as</p>
<p style="position:absolute;top:1020px;left:180px;white-space:nowrap" class="ft5215">small&#160;as&#160;possible&#160;and&#160;additional&#160;concepts&#160;introduced&#160;should&#160;make&#160;use&#160;of&#160;and&#160;have<br/>to&#160;adhere&#160;to&#160;existing&#160;specifications.&#160;Apart&#160;from&#160;that&#160;all&#160;relevant&#160;key&#160;exchange<br/>techniques&#160;have&#160;to&#160;be&#160;supported.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft5218">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 53 -->
<a name="53"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft53111{font-size:12px;font-family:XVAODK+CMMI8;color:#000000;}
	.ft53112{font-size:12px;font-family:GXPDXR+CMR8;color:#000000;}
-->
</style>
<div id="page53-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL053.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft5312">CHAPTER&#160;5.&#160;TRUSTED&#160;CHANNELS&#160;WITH&#160;REMOTE&#160;INTEGRITY&#160;VERIFICATION51</p>
<p style="position:absolute;top:193px;left:233px;white-space:nowrap" class="ft5317"><b>(FR2)&#160;No&#160;additional&#160;costs&#160;are&#160;induced:&#160;</b>The&#160;whole&#160;approach&#160;must&#160;not&#160;incur&#160;any</p>
<p style="position:absolute;top:211px;left:256px;white-space:nowrap" class="ft5315">additional&#160;costs&#160;for&#160;users&#160;like,&#160;e.g.,&#160;for&#160;expensive&#160;hardware,&#160;software&#160;or&#160;certifica-<br/>tion.</p>
<p style="position:absolute;top:252px;left:233px;white-space:nowrap" class="ft5317"><b>(FR3)&#160;Minimal&#160;performance&#160;overhead&#160;during&#160;handshake:&#160;</b>The&#160;overhead&#160;induced</p>
<p style="position:absolute;top:270px;left:256px;white-space:nowrap" class="ft5312">by&#160;exchanging&#160;additional&#160;configuration&#160;information&#160;has&#160;to&#160;be&#160;minimal.</p>
<p style="position:absolute;top:292px;left:233px;white-space:nowrap" class="ft5317"><b>(FR4)&#160;Flexible&#160;configuration&#160;reporting:&#160;</b>It&#160;has&#160;to&#160;be&#160;possible&#160;to&#160;apply&#160;different</p>
<p style="position:absolute;top:310px;left:256px;white-space:nowrap" class="ft5315">approaches&#160;to&#160;integrity&#160;reporting&#160;(e.g.,&#160;see&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">[59]</a>)&#160;to&#160;support&#160;a&#160;multitude&#160;of&#160;differing<br/>system&#160;and&#160;use-case&#160;designs.</p>
<p style="position:absolute;top:350px;left:233px;white-space:nowrap" class="ft5317"><b>(FR5)&#160;Backwards&#160;compatibility:&#160;</b>Systems&#160;supporting&#160;the&#160;Trusted&#160;Channel&#160;ap-</p>
<p style="position:absolute;top:368px;left:256px;white-space:nowrap" class="ft5315">proach&#160;have&#160;to&#160;be&#160;able&#160;to&#160;establish&#160;conventional&#160;secure&#160;channels,&#160;e.g.,&#160;to&#160;peers<br/>that&#160;do&#160;not&#160;provide&#160;the&#160;means&#160;to&#160;create&#160;and&#160;maintain&#160;Trusted&#160;Channels.</p>
<p style="position:absolute;top:455px;left:226px;white-space:nowrap" class="ft5320"><b>5.3</b></p>
<p style="position:absolute;top:455px;left:274px;white-space:nowrap" class="ft5320"><b>Basic&#160;Concept</b></p>
<p style="position:absolute;top:493px;left:226px;white-space:nowrap" class="ft5315">The&#160;fundamental&#160;idea&#160;behind&#160;this&#160;approach&#160;consists&#160;of&#160;the&#160;fact&#160;that&#160;platforms&#160;involved<br/>in&#160;a&#160;communication&#160;comprise&#160;a&#160;small,&#160;protected&#160;base&#160;system&#160;for&#160;sensitive&#160;operations<br/>as&#160;well&#160;as&#160;application&#160;and&#160;further&#160;system&#160;code&#160;for&#160;non-critical&#160;computations.&#160;The&#160;pro-<br/>tected&#160;base&#160;system&#160;is&#160;not&#160;accessible&#160;for&#160;other&#160;code&#160;running&#160;on&#160;the&#160;platforms&#160;except<br/>over&#160;specific&#160;interfaces&#160;and&#160;thus&#160;cannot&#160;be&#160;tampered&#160;using&#160;software.&#160;Two&#160;asymmetric<br/>key&#160;pairs&#160;are&#160;held&#160;inside&#160;the&#160;base&#160;system,&#160;their&#160;usage&#160;securely&#160;bound&#160;to&#160;the&#160;base&#160;sys-<br/>tem’s&#160;configuration&#160;using&#160;TC&#160;functionality:&#160;a&#160;signature&#160;key</p>
<p style="position:absolute;top:599px;left:591px;white-space:nowrap" class="ft5329">K</p>
<p style="position:absolute;top:605px;left:604px;white-space:nowrap" class="ft5343">sign</p>
<p style="position:absolute;top:600px;left:633px;white-space:nowrap" class="ft5312">and&#160;an&#160;encryption</p>
<p style="position:absolute;top:618px;left:226px;white-space:nowrap" class="ft5312">key</p>
<p style="position:absolute;top:617px;left:251px;white-space:nowrap" class="ft5329">K</p>
<p style="position:absolute;top:623px;left:264px;white-space:nowrap" class="ft5343">enc</p>
<p style="position:absolute;top:618px;left:283px;white-space:nowrap" class="ft5312">.</p>
<p style="position:absolute;top:636px;left:248px;white-space:nowrap" class="ft5312">TLS&#160;offers&#160;key&#160;agreement&#160;or&#160;key&#160;transport&#160;schemes&#160;as&#160;options&#160;for&#160;the&#160;initial&#160;hand-</p>
<p style="position:absolute;top:654px;left:226px;white-space:nowrap" class="ft5312">shake&#160;protocol.&#160;During&#160;a&#160;Diffie-Hellman&#160;(DH)&#160;key&#160;agreement&#160;(cf.&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#54">5.1)</a></p>
<p style="position:absolute;top:653px;left:705px;white-space:nowrap" class="ft5329">K</p>
<p style="position:absolute;top:659px;left:717px;white-space:nowrap" class="ft5343">sign</p>
<p style="position:absolute;top:672px;left:226px;white-space:nowrap" class="ft5312">is&#160;used&#160;by&#160;both&#160;peers&#160;to&#160;sign&#160;configuration&#160;data&#160;(</p>
<p style="position:absolute;top:671px;left:523px;white-space:nowrap" class="ft5329">conf&#160;ig</p>
<p style="position:absolute;top:672px;left:568px;white-space:nowrap" class="ft5312">)&#160;and&#160;the&#160;public&#160;DH&#160;values<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#53">.</a></p>
<p style="position:absolute;top:670px;left:736px;white-space:nowrap" class="ft5321"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#53">1</a></p>
<p style="position:absolute;top:690px;left:226px;white-space:nowrap" class="ft5312">In&#160;a&#160;RSA&#160;key&#160;transport&#160;handshake</p>
<p style="position:absolute;top:689px;left:437px;white-space:nowrap" class="ft5329">conf&#160;ig</p>
<p style="position:absolute;top:690px;left:485px;white-space:nowrap" class="ft5312">is&#160;signed&#160;with</p>
<p style="position:absolute;top:689px;left:574px;white-space:nowrap" class="ft5329">K</p>
<p style="position:absolute;top:695px;left:586px;white-space:nowrap" class="ft5343">sign</p>
<p style="position:absolute;top:690px;left:615px;white-space:nowrap" class="ft5312">and&#160;then&#160;the</p>
<p style="position:absolute;top:689px;left:693px;white-space:nowrap" class="ft5329">K</p>
<p style="position:absolute;top:695px;left:706px;white-space:nowrap" class="ft5343">enc</p>
<p style="position:absolute;top:690px;left:729px;white-space:nowrap" class="ft5312">of</p>
<p style="position:absolute;top:708px;left:226px;white-space:nowrap" class="ft5312">the&#160;server&#160;(</p>
<p style="position:absolute;top:707px;left:293px;white-space:nowrap" class="ft5333">S</p>
<p style="position:absolute;top:708px;left:303px;white-space:nowrap" class="ft5312">)&#160;is&#160;used&#160;by&#160;the&#160;client&#160;(</p>
<p style="position:absolute;top:707px;left:440px;white-space:nowrap" class="ft5333">C</p>
<p style="position:absolute;top:708px;left:449px;white-space:nowrap" class="ft5312">)&#160;to&#160;encrypt&#160;session&#160;key&#160;material&#160;(see&#160;also&#160;Figure</p>
<p style="position:absolute;top:726px;left:226px;white-space:nowrap" class="ft5315"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#54">5.1)</a>.&#160;In&#160;both&#160;cases&#160;evidence&#160;is&#160;provided&#160;that&#160;the&#160;protected&#160;base&#160;system,&#160;whose&#160;con-<br/>figuration&#160;is&#160;included&#160;in</p>
<p style="position:absolute;top:743px;left:376px;white-space:nowrap" class="ft5329">conf&#160;ig</p>
<p style="position:absolute;top:744px;left:421px;white-space:nowrap" class="ft5312">,&#160;is&#160;in&#160;place,&#160;by&#160;providing&#160;proof&#160;of&#160;possession&#160;of&#160;the</p>
<p style="position:absolute;top:762px;left:226px;white-space:nowrap" class="ft5312">respective&#160;private&#160;parts&#160;of&#160;the&#160;keys.&#160;Subsequently,&#160;after&#160;the&#160;evaluation&#160;of&#160;the</p>
<p style="position:absolute;top:761px;left:697px;white-space:nowrap" class="ft5329">conf&#160;ig</p>
<p style="position:absolute;top:780px;left:226px;white-space:nowrap" class="ft5315">of&#160;the&#160;counterpart,&#160;the&#160;peers&#160;either&#160;trust&#160;in&#160;the&#160;other&#160;endpoint’s&#160;protected&#160;base&#160;system<br/>to&#160;enforce&#160;their&#160;security&#160;requirements&#160;or&#160;they&#160;break&#160;the&#160;connection.&#160;In&#160;any&#160;case&#160;all<br/>security&#160;sensitive&#160;information&#160;related&#160;to&#160;the&#160;channel&#160;including&#160;the&#160;session&#160;key&#160;is&#160;kept<br/>inside&#160;the&#160;protected&#160;base&#160;system&#160;and&#160;hence&#160;cannot&#160;be&#160;compromised&#160;or&#160;misused.</p>
<p style="position:absolute;top:897px;left:226px;white-space:nowrap" class="ft5320"><b>5.4</b></p>
<p style="position:absolute;top:897px;left:274px;white-space:nowrap" class="ft5320"><b>System&#160;Architecture</b></p>
<p style="position:absolute;top:935px;left:226px;white-space:nowrap" class="ft5315">Our&#160;logical&#160;system&#160;architecture&#160;is&#160;shown&#160;in&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#55">5.2.&#160;</a>It&#160;is&#160;based&#160;on&#160;security&#160;frame-<br/>works&#160;as&#160;proposed,&#160;e.g.,&#160;in&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">[61]</a>,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[64]</a>,&#160;and&#160;consists&#160;of&#160;an&#160;<i>Application</i>,&#160;<i>Trusted&#160;Service</i>,<br/><i>Virtualization&#160;</i>as&#160;well&#160;as&#160;<i>TC-enabled&#160;Hardware&#160;Layer</i>.&#160;We&#160;kept&#160;our&#160;approach&#160;generic,<br/>thus&#160;it&#160;would&#160;be&#160;possible&#160;to&#160;implement/integrate&#160;the&#160;components&#160;on&#160;common&#160;operating<br/>systems&#160;like,&#160;e.g.,&#160;Linux&#160;or&#160;Windows<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#53">.</a></p>
<p style="position:absolute;top:1004px;left:452px;white-space:nowrap" class="ft5321"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#53">2</a></p>
<p style="position:absolute;top:1034px;left:242px;white-space:nowrap" class="ft5322">1</p>
<p style="position:absolute;top:1036px;left:247px;white-space:nowrap" class="ft53111">Sig</p>
<p style="position:absolute;top:1035px;left:267px;white-space:nowrap" class="ft53112">(</p>
<p style="position:absolute;top:1036px;left:272px;white-space:nowrap" class="ft53111">m</p>
<p style="position:absolute;top:1035px;left:283px;white-space:nowrap" class="ft53112">;</p>
<p style="position:absolute;top:1036px;left:289px;white-space:nowrap" class="ft53111">k</p>
<p style="position:absolute;top:1035px;left:296px;white-space:nowrap" class="ft53112">)</p>
<p style="position:absolute;top:1036px;left:303px;white-space:nowrap" class="ft5310">denotes&#160;a&#160;signature&#160;of&#160;key</p>
<p style="position:absolute;top:1036px;left:431px;white-space:nowrap" class="ft53111">k</p>
<p style="position:absolute;top:1036px;left:441px;white-space:nowrap" class="ft5310">over&#160;data</p>
<p style="position:absolute;top:1036px;left:488px;white-space:nowrap" class="ft53111">m</p>
<p style="position:absolute;top:1036px;left:499px;white-space:nowrap" class="ft5310">.</p>
<p style="position:absolute;top:1048px;left:242px;white-space:nowrap" class="ft5322">2</p>
<p style="position:absolute;top:1050px;left:247px;white-space:nowrap" class="ft5310">If&#160;monolithic&#160;operating&#160;systems&#160;are&#160;applied&#160;some&#160;constraints&#160;have&#160;to&#160;be&#160;considered&#160;when&#160;looking&#160;at</p>
<p style="position:absolute;top:1065px;left:226px;white-space:nowrap" class="ft5310">the&#160;security&#160;of&#160;such&#160;implementations&#160;because&#160;in&#160;general&#160;they&#160;are&#160;not&#160;capable&#160;to&#160;ensure&#160;strong&#160;isolation&#160;of</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft5318">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 54 -->
<a name="54"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page54-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL054.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft5412">52</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft5418">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:379px;left:223px;white-space:nowrap" class="ft5412">Figure&#160;5.1:&#160;Key&#160;Agreement&#160;and&#160;Key&#160;Transport&#160;in&#160;our&#160;concept</p>
<p style="position:absolute;top:468px;left:150px;white-space:nowrap" class="ft5444"><b>5.4.1</b></p>
<p style="position:absolute;top:468px;left:204px;white-space:nowrap" class="ft5444"><b>Basic&#160;Definitions</b></p>
<p style="position:absolute;top:498px;left:150px;white-space:nowrap" class="ft5415">The&#160;underlying&#160;system&#160;architecture&#160;considers&#160;client-server&#160;communication&#160;where&#160;each<br/>involved&#160;endpoint&#160;may&#160;require&#160;configuration&#160;information&#160;of&#160;the&#160;other&#160;endpoint&#160;to&#160;be<br/>able&#160;to&#160;judge&#160;its&#160;trustworthiness.</p>
<p style="position:absolute;top:552px;left:172px;white-space:nowrap" class="ft5412">The&#160;evaluation&#160;of&#160;configuration&#160;information&#160;is&#160;done&#160;according&#160;to&#160;the&#160;locally&#160;ap-</p>
<p style="position:absolute;top:569px;left:150px;white-space:nowrap" class="ft5415">plied&#160;security&#160;policy.&#160;If&#160;the&#160;other&#160;endpoint’s&#160;configuration&#160;information&#160;conforms&#160;to&#160;the<br/>security&#160;policy,&#160;this&#160;endpoint&#160;is&#160;considered&#160;to&#160;be&#160;trustworthy.&#160;This&#160;security&#160;policy&#160;con-<br/>sists&#160;of&#160;a&#160;set&#160;of&#160;requirements&#160;and&#160;guidelines&#160;that&#160;have&#160;to&#160;be&#160;fulfilled&#160;by&#160;the&#160;platform<br/>configuration&#160;of&#160;the&#160;counterpart,&#160;e.g.,&#160;that&#160;an&#160;appropriate&#160;access&#160;control&#160;enforcement<br/>mechanism&#160;is&#160;in&#160;place,&#160;no&#160;malware&#160;installed,&#160;etc.</p>
<p style="position:absolute;top:659px;left:172px;white-space:nowrap" class="ft5412">The&#160;configuration&#160;of&#160;a&#160;platform&#160;is&#160;represented&#160;by&#160;a&#160;combination&#160;of&#160;credentials</p>
<p style="position:absolute;top:677px;left:150px;white-space:nowrap" class="ft5412">vouching&#160;for&#160;security&#160;relevant</p>
<p style="position:absolute;top:676px;left:341px;white-space:nowrap" class="ft5429">properties</p>
<p style="position:absolute;top:677px;left:415px;white-space:nowrap" class="ft5412">(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">[60]</a>)&#160;of&#160;the&#160;platform’s&#160;components</p>
<p style="position:absolute;top:695px;left:150px;white-space:nowrap" class="ft5415">(hardware&#160;and/or&#160;software)&#160;which&#160;are&#160;e.g.,&#160;their&#160;state,&#160;configuration&#160;and&#160;I/O&#160;behav-<br/>ior.&#160;Examples&#160;for&#160;different&#160;credentials&#160;used&#160;in&#160;our&#160;implementation&#160;are&#160;signed&#160;digital<br/>fingerprints&#160;or&#160;certificates&#160;that&#160;represent&#160;certain&#160;properties.</p>
<p style="position:absolute;top:749px;left:172px;white-space:nowrap" class="ft5412">In&#160;this&#160;context&#160;reference&#160;values&#160;represent&#160;digital&#160;fingerprints&#160;provided&#160;and&#160;signed</p>
<p style="position:absolute;top:767px;left:150px;white-space:nowrap" class="ft5415">by&#160;a&#160;Trusted&#160;Third&#160;Party&#160;(e.g.,&#160;the&#160;distributor&#160;or&#160;manufacturer&#160;of&#160;a&#160;component)&#160;that&#160;can<br/>be&#160;compared&#160;to&#160;fingerprints&#160;provided&#160;by&#160;the&#160;peer.</p>
<p style="position:absolute;top:802px;left:172px;white-space:nowrap" class="ft5412">The&#160;mechanism&#160;of&#160;deriving&#160;digital&#160;fingerprints&#160;is&#160;called</p>
<p style="position:absolute;top:801px;left:523px;white-space:nowrap" class="ft5429">measurement</p>
<p style="position:absolute;top:802px;left:615px;white-space:nowrap" class="ft5412">.&#160;In&#160;the</p>
<p style="position:absolute;top:820px;left:150px;white-space:nowrap" class="ft5415">TCG&#160;approach&#160;measuring&#160;a&#160;component&#160;means&#160;computing&#160;a&#160;hash&#160;value&#160;over&#160;its&#160;code<br/>and/or&#160;its&#160;configuration&#160;file.&#160;There&#160;exist&#160;also&#160;alternative&#160;approaches&#160;to&#160;attest&#160;to&#160;certain<br/>properties&#160;like,&#160;e.g.,&#160;Proof-Carrying-Code&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#74">[6,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">26,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#77">50,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">51]</a>)&#160;or&#160;Semantic&#160;Attestation<br/>(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[33]</a>,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">[53]</a>)&#160;but&#160;further&#160;research&#160;is&#160;needed&#160;in&#160;this&#160;field&#160;to&#160;make&#160;those&#160;concepts&#160;usable<br/>for&#160;real-world&#160;applications.</p>
<p style="position:absolute;top:910px;left:172px;white-space:nowrap" class="ft5412">The&#160;communication&#160;endpoints&#160;of&#160;our&#160;implementation&#160;operate&#160;based&#160;on&#160;components</p>
<p style="position:absolute;top:928px;left:150px;white-space:nowrap" class="ft5415">called&#160;compartments.&#160;A&#160;compartment&#160;is&#160;one&#160;or&#160;a&#160;group&#160;of&#160;software&#160;components&#160;that&#160;is<br/>logically&#160;isolated&#160;from&#160;other&#160;software&#160;components.&#160;Isolation&#160;means&#160;that&#160;a&#160;compartment<br/>can&#160;only&#160;access&#160;data&#160;of&#160;another&#160;compartment&#160;using&#160;specified&#160;interfaces&#160;provided&#160;by&#160;a<br/>controlling&#160;instance.</p>
<p style="position:absolute;top:1000px;left:172px;white-space:nowrap" class="ft5412">The&#160;set&#160;of&#160;all&#160;security&#160;critical&#160;components&#160;of&#160;a&#160;platform&#160;responsible&#160;for&#160;preserving</p>
<p style="position:absolute;top:1018px;left:150px;white-space:nowrap" class="ft5415">its&#160;trustworthiness&#160;is&#160;called&#160;<i>Trusted&#160;Computing&#160;Base&#160;</i>(TCB)&#160;in&#160;analogy&#160;to&#160;the&#160;protected<br/>base&#160;system&#160;mentioned&#160;in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#53">5.3.&#160;</a>The&#160;TCB&#160;is&#160;<i>considered&#160;trustworthy&#160;by&#160;definition</i></p>
<p style="position:absolute;top:1064px;left:150px;white-space:nowrap" class="ft5410">processes&#160;and&#160;corresponding&#160;data.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft5418">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 55 -->
<a name="55"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page55-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL055.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft5512">CHAPTER&#160;5.&#160;TRUSTED&#160;CHANNELS&#160;WITH&#160;REMOTE&#160;INTEGRITY&#160;VERIFICATION53</p>
<p style="position:absolute;top:433px;left:360px;white-space:nowrap" class="ft5512">Figure&#160;5.2:&#160;Layered&#160;Logical&#160;Architecture</p>
<p style="position:absolute;top:481px;left:226px;white-space:nowrap" class="ft5515">because&#160;it&#160;is&#160;kept&#160;protected&#160;against&#160;software&#160;attacks&#160;and&#160;ideally&#160;was&#160;analyzed&#160;with<br/>respect&#160;to&#160;a&#160;certain&#160;security&#160;evaluation&#160;scheme&#160;(e.g.,&#160;Common&#160;Criteria).&#160;Thus,&#160;the<br/>main&#160;goal&#160;of&#160;our&#160;system&#160;design&#160;is&#160;to&#160;keep&#160;the&#160;TCB&#160;as&#160;small&#160;as&#160;possible&#160;to&#160;avoid&#160;known<br/>problems&#160;and&#160;vulnerabilities&#160;arising&#160;along&#160;with&#160;code&#160;complexity.</p>
<p style="position:absolute;top:594px;left:226px;white-space:nowrap" class="ft5544"><b>5.4.2</b></p>
<p style="position:absolute;top:594px;left:280px;white-space:nowrap" class="ft5544"><b>The&#160;different&#160;Layers&#160;of&#160;the&#160;Architecture</b></p>
<p style="position:absolute;top:624px;left:226px;white-space:nowrap" class="ft5515">In&#160;this&#160;section&#160;we&#160;present&#160;the&#160;different&#160;layers&#160;(cf.&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#55">5.2)&#160;</a>we&#160;need&#160;for&#160;the&#160;realization<br/>of&#160;our&#160;approach.</p>
<p style="position:absolute;top:682px;left:226px;white-space:nowrap" class="ft5515"><b>TC-enabled&#160;Hardware&#160;Layer</b>:&#160;We&#160;assume&#160;that&#160;the&#160;reader&#160;is&#160;familiar&#160;with&#160;the&#160;TC<br/>concept&#160;of&#160;the&#160;TCG&#160;and&#160;fundamental&#160;virtualization&#160;concepts&#160;and&#160;thus&#160;keep&#160;this&#160;section<br/>covering&#160;these&#160;topics&#160;short&#160;and&#160;refer&#160;to&#160;Appendix&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#68">A.1&#160;</a>for&#160;further&#160;reading.</p>
<p style="position:absolute;top:740px;left:226px;white-space:nowrap" class="ft5515">The&#160;hardware&#160;layer&#160;has&#160;to&#160;offer&#160;TC&#160;extensions&#160;that&#160;are&#160;conform&#160;to&#160;the&#160;relevant&#160;TCG<br/>specifications&#160;(e.g.,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[74]</a>).&#160;This&#160;essentially&#160;means&#160;that&#160;it&#160;comprises&#160;a&#160;TPM&#160;offering<br/>basic&#160;cryptographic&#160;functionality&#160;and&#160;a&#160;small&#160;amount&#160;of&#160;protected&#160;storage&#160;to&#160;store&#160;im-<br/>portant&#160;keys&#160;and&#160;measurements&#160;taken.</p>
<p style="position:absolute;top:816px;left:226px;white-space:nowrap" class="ft5515"><b>Virtualization&#160;Layer</b>:&#160;The&#160;virtualization&#160;layer&#160;offers&#160;and&#160;mediates&#160;access&#160;to&#160;cen-<br/>tral&#160;hardware&#160;components&#160;like,&#160;e.g.,&#160;CPU&#160;and&#160;MMU&#160;(Memory&#160;Management&#160;Unit).<br/>These&#160;tasks&#160;can&#160;be&#160;performed&#160;by&#160;many&#160;kinds&#160;of&#160;virtualization&#160;techniques,&#160;namely&#160;hy-<br/>pervisors,&#160;microkernels&#160;or&#160;a&#160;monolithic&#160;OS&#160;running&#160;a&#160;virtualization&#160;application,&#160;e.g.,<br/>VMware&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#80">[81]</a>).&#160;As&#160;already&#160;mentioned&#160;we&#160;aim&#160;for&#160;a&#160;small&#160;TCB&#160;and&#160;thus&#160;do&#160;not<br/>consider&#160;the&#160;last&#160;option&#160;although&#160;it&#160;could&#160;also&#160;be&#160;used.</p>
<p style="position:absolute;top:929px;left:226px;white-space:nowrap" class="ft5515"><b>Trusted&#160;Service&#160;Layer</b>:&#160;This&#160;layer&#160;consists&#160;of&#160;security&#160;services&#160;and&#160;provides&#160;interfaces<br/>to&#160;the&#160;Application&#160;Layer.&#160;These&#160;interfaces&#160;allow&#160;applications&#160;to&#160;use&#160;enhanced&#160;security<br/>functionality&#160;strengthened&#160;by&#160;Trusted&#160;Computing.&#160;It&#160;also&#160;mediates&#160;and&#160;monitors&#160;access<br/>to&#160;virtualized&#160;hardware&#160;resources.&#160;The&#160;following&#160;services&#160;are&#160;the&#160;main&#160;components&#160;of<br/>the&#160;TCB&#160;in&#160;our&#160;approach<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#55">:</a></p>
<p style="position:absolute;top:998px;left:379px;white-space:nowrap" class="ft5521"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#55">3</a></p>
<p style="position:absolute;top:1046px;left:242px;white-space:nowrap" class="ft5522">3</p>
<p style="position:absolute;top:1049px;left:247px;white-space:nowrap" class="ft5510">Some&#160;components,&#160;namely&#160;Storage&#160;Manager,&#160;Compartment&#160;Manager&#160;and&#160;Trust&#160;Manager&#160;have&#160;been</p>
<p style="position:absolute;top:1063px;left:226px;white-space:nowrap" class="ft5510">developed&#160;within&#160;the&#160;OpenTC&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">[54,&#160;</a><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#77">40]</a>)&#160;and&#160;EMSCB&#160;(see&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[25]</a>)&#160;projects.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft5518">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 56 -->
<a name="56"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft56113{font-size:15px;font-family:NSKDZS+CMTI10;color:#000000;}
	.ft56114{font-size:10px;font-family:QTKPFE+CMTI7;color:#000000;}
	.ft56115{font-size:12px;font-family:MRVGFB+CMTI8;color:#000000;}
	.ft56116{font-size:9px;font-family:QTKPFE+CMTI7;color:#000000;}
	.ft56117{font-size:12px;font-family:WPLJEU+CMSY8;color:#000000;}
-->
</style>
<div id="page56-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL056.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft5612">54</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft5618">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:192px;left:157px;white-space:nowrap" class="ft5633">•</p>
<p style="position:absolute;top:193px;left:172px;white-space:nowrap" class="ft5615"><i>Trust&#160;Manager&#160;</i>(TM)&#160;provides&#160;functionality&#160;used&#160;for&#160;establishing&#160;Trusted&#160;Chan-<br/>nels.&#160;To&#160;be&#160;able&#160;to&#160;provide&#160;this&#160;functionality</p>
<p style="position:absolute;top:211px;left:453px;white-space:nowrap" class="ft56113">TM</p>
<p style="position:absolute;top:211px;left:485px;white-space:nowrap" class="ft5612">bundles&#160;multiple&#160;calls&#160;to&#160;the</p>
<p style="position:absolute;top:229px;left:172px;white-space:nowrap" class="ft5615">TPM&#160;into&#160;a&#160;simple&#160;API&#160;for&#160;calling&#160;instances.&#160;It&#160;enables&#160;callers&#160;to&#160;create&#160;com-<br/>plete&#160;certificates&#160;including&#160;measurements&#160;and&#160;bound&#160;keys.&#160;Additionally,&#160;it&#160;offers<br/>functionality&#160;to&#160;bind/unbind,&#160;seal/unseal&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[74]</a>)&#160;these&#160;keys&#160;to&#160;specific&#160;platform<br/>configurations&#160;or&#160;to&#160;report&#160;current&#160;measurement&#160;values&#160;stored&#160;inside&#160;the&#160;TPM.<br/>The&#160;keys&#160;used&#160;to&#160;set&#160;up&#160;and&#160;attest&#160;in&#160;the&#160;Trusted&#160;Channel&#160;concept&#160;are&#160;computed<br/>and&#160;held&#160;by&#160;the</p>
<p style="position:absolute;top:319px;left:266px;white-space:nowrap" class="ft56113">TM</p>
<p style="position:absolute;top:319px;left:293px;white-space:nowrap" class="ft5612">.&#160;They&#160;never&#160;leave&#160;the&#160;TCB.&#160;The&#160;session&#160;keys&#160;of&#160;the&#160;TLS&#160;ses-</p>
<p style="position:absolute;top:337px;left:172px;white-space:nowrap" class="ft5612">sions&#160;are&#160;computed&#160;in&#160;a&#160;special&#160;component&#160;of&#160;the</p>
<p style="position:absolute;top:336px;left:476px;white-space:nowrap" class="ft56113">TM</p>
<p style="position:absolute;top:337px;left:503px;white-space:nowrap" class="ft5612">:&#160;the</p>
<p style="position:absolute;top:336px;left:535px;white-space:nowrap" class="ft56113">TLS&#160;backend</p>
<p style="position:absolute;top:337px;left:621px;white-space:nowrap" class="ft5612">.&#160;This</p>
<p style="position:absolute;top:355px;left:172px;white-space:nowrap" class="ft5612">component&#160;represents&#160;the&#160;back-end&#160;of&#160;the</p>
<p style="position:absolute;top:354px;left:438px;white-space:nowrap" class="ft56113">TLS&#160;frontend</p>
<p style="position:absolute;top:355px;left:533px;white-space:nowrap" class="ft5612">doing&#160;the&#160;actual&#160;en-</p>
<p style="position:absolute;top:373px;left:172px;white-space:nowrap" class="ft5615">cryption&#160;and&#160;decryption&#160;of&#160;the&#160;data&#160;packets.&#160;Furthermore,&#160;TM&#160;allocates&#160;memory<br/>for&#160;transferred&#160;data&#160;and&#160;controls&#160;access&#160;to&#160;it&#160;according&#160;to&#160;an&#160;application&#160;security<br/>policy&#160;held&#160;by&#160;the</p>
<p style="position:absolute;top:408px;left:283px;white-space:nowrap" class="ft5629">P&#160;olicy&#160;M&#160;anager</p>
<p style="position:absolute;top:408px;left:397px;white-space:nowrap" class="ft56113">PM</p>
<p style="position:absolute;top:409px;left:423px;white-space:nowrap" class="ft5612">.</p>
<p style="position:absolute;top:426px;left:157px;white-space:nowrap" class="ft5633">•</p>
<p style="position:absolute;top:426px;left:172px;white-space:nowrap" class="ft56113">TLS&#160;frontend</p>
<p style="position:absolute;top:427px;left:265px;white-space:nowrap" class="ft5612">is&#160;the&#160;front-end&#160;to&#160;the</p>
<p style="position:absolute;top:426px;left:397px;white-space:nowrap" class="ft56113">TLS&#160;backend</p>
<p style="position:absolute;top:427px;left:487px;white-space:nowrap" class="ft5612">within</p>
<p style="position:absolute;top:426px;left:529px;white-space:nowrap" class="ft56113">TM</p>
<p style="position:absolute;top:427px;left:555px;white-space:nowrap" class="ft5612">.&#160;It&#160;is&#160;responsible</p>
<p style="position:absolute;top:445px;left:172px;white-space:nowrap" class="ft5615">for&#160;setting&#160;up&#160;TLS&#160;connections&#160;and&#160;doing&#160;the&#160;message&#160;formatting,&#160;interpretation<br/>and&#160;creation.</p>
<p style="position:absolute;top:460px;left:254px;white-space:nowrap" class="ft5621"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#56">4</a></p>
<p style="position:absolute;top:479px;left:157px;white-space:nowrap" class="ft5633">•</p>
<p style="position:absolute;top:480px;left:172px;white-space:nowrap" class="ft5615"><i>Compartment&#160;Manager&#160;</i>(CM)&#160;measures&#160;compartments&#160;when&#160;starting&#160;them.&#160;To<br/>differentiate&#160;client&#160;compartments,</p>
<p style="position:absolute;top:498px;left:377px;white-space:nowrap" class="ft56113">CM</p>
<p style="position:absolute;top:498px;left:407px;white-space:nowrap" class="ft5612">assigns&#160;a&#160;unique&#160;ID&#160;to&#160;every&#160;compartment</p>
<p style="position:absolute;top:516px;left:172px;white-space:nowrap" class="ft5612">(</p>
<p style="position:absolute;top:516px;left:177px;white-space:nowrap" class="ft56113">compID</p>
<p style="position:absolute;top:516px;left:229px;white-space:nowrap" class="ft5612">).&#160;The&#160;compartment’s&#160;configuration&#160;is&#160;appended&#160;together&#160;with&#160;its&#160;ID&#160;in</p>
<p style="position:absolute;top:534px;left:172px;white-space:nowrap" class="ft5612">a&#160;<i>Configuration&#160;Data&#160;Structure&#160;</i>(CDS).</p>
<p style="position:absolute;top:534px;left:416px;white-space:nowrap" class="ft56113">CM</p>
<p style="position:absolute;top:534px;left:447px;white-space:nowrap" class="ft5612">takes&#160;care&#160;of&#160;keeping</p>
<p style="position:absolute;top:534px;left:582px;white-space:nowrap" class="ft56113">CDS</p>
<p style="position:absolute;top:534px;left:620px;white-space:nowrap" class="ft5612">secure</p>
<p style="position:absolute;top:552px;left:172px;white-space:nowrap" class="ft5612">(inside&#160;the&#160;TCB)&#160;and&#160;providing&#160;it&#160;to&#160;other&#160;TCB&#160;components.</p>
<p style="position:absolute;top:552px;left:556px;white-space:nowrap" class="ft56113">CM</p>
<p style="position:absolute;top:552px;left:588px;white-space:nowrap" class="ft5612">also&#160;acts&#160;as</p>
<p style="position:absolute;top:570px;left:172px;white-space:nowrap" class="ft5615">root&#160;for&#160;a&#160;set&#160;of&#160;<i>monitoring&#160;agents&#160;</i>each&#160;one&#160;running&#160;in&#160;a&#160;different&#160;compartment<br/>keeping&#160;track&#160;of&#160;code&#160;execution.&#160;Thus,&#160;every&#160;change&#160;in&#160;the&#160;configuration&#160;of&#160;a<br/>running&#160;compartment&#160;will&#160;be&#160;reported&#160;by&#160;one&#160;of&#160;these&#160;clients&#160;back&#160;to&#160;the</p>
<p style="position:absolute;top:606px;left:606px;white-space:nowrap" class="ft56113">CM</p>
<p style="position:absolute;top:606px;left:636px;white-space:nowrap" class="ft5612">that</p>
<p style="position:absolute;top:624px;left:172px;white-space:nowrap" class="ft5615">stores&#160;them&#160;and&#160;in&#160;turn&#160;reports&#160;the&#160;measurements&#160;taken&#160;to&#160;other&#160;instances&#160;like,<br/>e.g.,&#160;the</p>
<p style="position:absolute;top:641px;left:223px;white-space:nowrap" class="ft56113">TM</p>
<p style="position:absolute;top:642px;left:250px;white-space:nowrap" class="ft5612"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#56">.</a></p>
<p style="position:absolute;top:640px;left:254px;white-space:nowrap" class="ft5621"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#56">5</a></p>
<p style="position:absolute;top:659px;left:157px;white-space:nowrap" class="ft5633">•</p>
<p style="position:absolute;top:660px;left:172px;white-space:nowrap" class="ft5615"><i>Policy&#160;Manager&#160;</i>(PM)&#160;stores&#160;platform&#160;and&#160;application&#160;policies&#160;and&#160;provides&#160;them<br/>to&#160;other&#160;components&#160;of&#160;the&#160;TCB&#160;when&#160;needed<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#56">.</a></p>
<p style="position:absolute;top:675px;left:452px;white-space:nowrap" class="ft5621"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#56">6</a></p>
<p style="position:absolute;top:695px;left:157px;white-space:nowrap" class="ft5633">•</p>
<p style="position:absolute;top:696px;left:172px;white-space:nowrap" class="ft5615"><i>Storage&#160;Manager&#160;</i>(SM)&#160;handles&#160;persistent&#160;data&#160;storing&#160;for&#160;the&#160;different&#160;compart-<br/>ments.&#160;It&#160;can&#160;encrypt&#160;keys&#160;and&#160;data&#160;using&#160;the</p>
<p style="position:absolute;top:713px;left:447px;white-space:nowrap" class="ft5629">non</p>
<p style="position:absolute;top:713px;left:476px;white-space:nowrap" class="ft5633">−</p>
<p style="position:absolute;top:713px;left:490px;white-space:nowrap" class="ft5629">migratable</p>
<p style="position:absolute;top:713px;left:567px;white-space:nowrap" class="ft56113">K</p>
<p style="position:absolute;top:719px;left:578px;white-space:nowrap" class="ft56114">storage</p>
<p style="position:absolute;top:714px;left:622px;white-space:nowrap" class="ft5612">that&#160;is</p>
<p style="position:absolute;top:732px;left:172px;white-space:nowrap" class="ft5612">bound&#160;to&#160;the&#160;complete&#160;TCB<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#56">.</a></p>
<p style="position:absolute;top:729px;left:340px;white-space:nowrap" class="ft5621"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#56">7</a></p>
<p style="position:absolute;top:732px;left:349px;white-space:nowrap" class="ft5612">Every&#160;compartment&#160;owns&#160;some&#160;storage&#160;(e.g.&#160;a&#160;hard-</p>
<p style="position:absolute;top:750px;left:172px;white-space:nowrap" class="ft5615">disk&#160;partition)&#160;that&#160;is&#160;bound&#160;to&#160;this&#160;compartment&#160;by&#160;encrypting&#160;the&#160;data&#160;stored<br/>using</p>
<p style="position:absolute;top:767px;left:209px;white-space:nowrap" class="ft56113">K</p>
<p style="position:absolute;top:772px;left:220px;white-space:nowrap" class="ft56114">compID</p>
<p style="position:absolute;top:767px;left:264px;white-space:nowrap" class="ft5612">.&#160;Thus,&#160;no&#160;other&#160;compartment&#160;is&#160;able&#160;to&#160;access&#160;this&#160;compartments</p>
<p style="position:absolute;top:785px;left:172px;white-space:nowrap" class="ft5612">storage&#160;unless&#160;this&#160;is&#160;explicitly&#160;allowed&#160;by&#160;the&#160;security&#160;policy.</p>
<p style="position:absolute;top:802px;left:157px;white-space:nowrap" class="ft5633">•</p>
<p style="position:absolute;top:803px;left:172px;white-space:nowrap" class="ft5615"><i>Proxy&#160;</i>is&#160;a&#160;small&#160;proxy&#160;server&#160;that&#160;acts&#160;as&#160;endpoint&#160;for&#160;the&#160;TLS&#160;connection&#160;and&#160;is<br/>configured&#160;by</p>
<p style="position:absolute;top:821px;left:259px;white-space:nowrap" class="ft56113">TM</p>
<p style="position:absolute;top:821px;left:285px;white-space:nowrap" class="ft5612">.</p>
<p style="position:absolute;top:838px;left:157px;white-space:nowrap" class="ft5633">•</p>
<p style="position:absolute;top:839px;left:172px;white-space:nowrap" class="ft5615"><i>TPM&#160;Software&#160;Stack&#160;</i>(TSS)&#160;presents&#160;an&#160;API&#160;to&#160;access&#160;TPM&#160;functionality.&#160;This<br/>component&#160;is&#160;defined&#160;in&#160;the&#160;according&#160;TCG&#160;specifications&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#80">[75]</a>).&#160;In&#160;our&#160;im-<br/>plementation&#160;we&#160;used</p>
<p style="position:absolute;top:874px;left:306px;white-space:nowrap" class="ft5629">T&#160;rouSerS</p>
<p style="position:absolute;top:875px;left:378px;white-space:nowrap" class="ft5612">(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">[57]</a>).</p>
<p style="position:absolute;top:902px;left:150px;white-space:nowrap" class="ft5615">For&#160;direct&#160;communication&#160;between&#160;processes,&#160;IPC&#160;(Inter-Process&#160;Communication)<br/>functionality&#160;are&#160;used.&#160;Additionally,&#160;virtual&#160;Ethernet&#160;connections&#160;are&#160;applied&#160;for&#160;inter-<br/>compartment&#160;communication.&#160;For&#160;our&#160;implementation&#160;we&#160;chose&#160;to&#160;offer&#160;two&#160;possibili-<br/>ties&#160;to&#160;use&#160;the&#160;Trusted&#160;Channel:&#160;either&#160;directly&#160;by&#160;using&#160;the</p>
<p style="position:absolute;top:955px;left:500px;white-space:nowrap" class="ft56113">TLS&#160;frontend</p>
<p style="position:absolute;top:956px;left:593px;white-space:nowrap" class="ft5612">or&#160;indirectly</p>
<p style="position:absolute;top:983px;left:166px;white-space:nowrap" class="ft5622">4</p>
<p style="position:absolute;top:985px;left:171px;white-space:nowrap" class="ft5610">For&#160;a&#160;more&#160;detailed&#160;view&#160;on&#160;the&#160;TLS&#160;components&#160;and&#160;their&#160;implementation&#160;see&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#62">5.6.</a></p>
<p style="position:absolute;top:997px;left:166px;white-space:nowrap" class="ft5622">5</p>
<p style="position:absolute;top:999px;left:171px;white-space:nowrap" class="ft5610">The&#160;Integrity&#160;Measurement&#160;Architecture&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[65]</a>)&#160;that&#160;was&#160;designed&#160;by&#160;IBM&#160;Research&#160;shows&#160;how&#160;this</p>
<p style="position:absolute;top:1013px;left:150px;white-space:nowrap" class="ft5610">can&#160;be&#160;done.</p>
<p style="position:absolute;top:1026px;left:166px;white-space:nowrap" class="ft5622">6</p>
<p style="position:absolute;top:1028px;left:171px;white-space:nowrap" class="ft5610">This&#160;component&#160;is&#160;not&#160;implemented&#160;yet,&#160;for&#160;the&#160;prototype&#160;we&#160;applied&#160;fixed&#160;policies.</p>
<p style="position:absolute;top:1040px;left:166px;white-space:nowrap" class="ft5622">7</p>
<p style="position:absolute;top:1042px;left:171px;white-space:nowrap" class="ft56115">K</p>
<p style="position:absolute;top:1046px;left:181px;white-space:nowrap" class="ft56116">storage</p>
<p style="position:absolute;top:1042px;left:218px;white-space:nowrap" class="ft5610">represents&#160;the</p>
<p style="position:absolute;top:1042px;left:287px;white-space:nowrap" class="ft56111">Storage&#160;Root&#160;Key</p>
<p style="position:absolute;top:1042px;left:390px;white-space:nowrap" class="ft5610">(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[74]</a>)&#160;that&#160;is&#160;kept&#160;inside&#160;the&#160;TPM&#160;as&#160;root&#160;for&#160;the&#160;whole</p>
<p style="position:absolute;top:1056px;left:150px;white-space:nowrap" class="ft5610">key&#160;infrastructure.&#160;This&#160;key&#160;is&#160;labeled</p>
<p style="position:absolute;top:1056px;left:336px;white-space:nowrap" class="ft56111">non</p>
<p style="position:absolute;top:1056px;left:361px;white-space:nowrap" class="ft56117">−</p>
<p style="position:absolute;top:1056px;left:374px;white-space:nowrap" class="ft56111">migratable</p>
<p style="position:absolute;top:1056px;left:435px;white-space:nowrap" class="ft5610">.&#160;That&#160;means&#160;the&#160;key’s&#160;private&#160;part&#160;never&#160;leaves</p>
<p style="position:absolute;top:1071px;left:150px;white-space:nowrap" class="ft5610">the&#160;TPM.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft5618">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 57 -->
<a name="57"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page57-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL057.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft5712">CHAPTER&#160;5.&#160;TRUSTED&#160;CHANNELS&#160;WITH&#160;REMOTE&#160;INTEGRITY&#160;VERIFICATION55</p>
<p style="position:absolute;top:193px;left:226px;white-space:nowrap" class="ft5712">by&#160;using&#160;a&#160;proxy&#160;server&#160;that&#160;in&#160;turn&#160;includes&#160;this</p>
<p style="position:absolute;top:193px;left:516px;white-space:nowrap" class="ft57113">TLS&#160;frontend</p>
<p style="position:absolute;top:193px;left:606px;white-space:nowrap" class="ft5712">.&#160;The&#160;second&#160;one&#160;is&#160;es-</p>
<p style="position:absolute;top:211px;left:226px;white-space:nowrap" class="ft5712">pecially&#160;useful&#160;for&#160;the&#160;“transparent”&#160;deployment&#160;of&#160;Trusted&#160;Channels<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#57">.</a></p>
<p style="position:absolute;top:209px;left:643px;white-space:nowrap" class="ft5721"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#57">8</a></p>
<p style="position:absolute;top:234px;left:226px;white-space:nowrap" class="ft5715"><b>Application&#160;Layer</b>:&#160;The&#160;application&#160;layer&#160;consists&#160;of&#160;different&#160;compartments&#160;and&#160;ap-<br/>plications.&#160;This&#160;may&#160;be&#160;whole&#160;operating&#160;systems&#160;or&#160;specific&#160;applications&#160;running&#160;di-<br/>rectly&#160;on&#160;the&#160;hypervisor/microkernel.</p>
<p style="position:absolute;top:338px;left:226px;white-space:nowrap" class="ft5720"><b>5.5</b></p>
<p style="position:absolute;top:338px;left:274px;white-space:nowrap" class="ft5720"><b>Credentials,&#160;Extensions&#160;and&#160;their&#160;Usage</b></p>
<p style="position:absolute;top:376px;left:226px;white-space:nowrap" class="ft5715">In&#160;this&#160;section&#160;we&#160;show&#160;which&#160;credentials&#160;and&#160;extensions&#160;we&#160;defined&#160;to&#160;adapt&#160;the&#160;nor-<br/>mal&#160;TLS&#160;handshake&#160;to&#160;our&#160;approach.</p>
<p style="position:absolute;top:412px;left:248px;white-space:nowrap" class="ft5712">The&#160;new&#160;credentials&#160;are&#160;necessary&#160;to&#160;bind&#160;the&#160;TLS&#160;channel&#160;to&#160;the&#160;endpoints&#160;whose</p>
<p style="position:absolute;top:430px;left:226px;white-space:nowrap" class="ft5715">configuration&#160;is&#160;reported&#160;and&#160;to&#160;be&#160;capable&#160;to&#160;prove&#160;that&#160;a&#160;certain&#160;TCB&#160;is&#160;in&#160;place<br/>without&#160;interaction&#160;with&#160;the&#160;TPM&#160;every&#160;time&#160;a&#160;Trusted&#160;Channel&#160;is&#160;set&#160;up.&#160;Otherwise,<br/>this&#160;would&#160;result&#160;in&#160;a&#160;significant&#160;performance&#160;loss,&#160;especially&#160;in&#160;connection&#160;with&#160;server<br/>systems.&#160;Additionally,&#160;we&#160;want&#160;to&#160;be&#160;able&#160;to&#160;change&#160;the&#160;TCB&#160;configuration&#160;without<br/>requesting&#160;a&#160;new&#160;TLS&#160;certificate&#160;every&#160;time&#160;this&#160;is&#160;done.&#160;This&#160;would&#160;not&#160;be&#160;possible<br/>if&#160;a&#160;non-migrateable&#160;key&#160;was&#160;used&#160;during&#160;the&#160;handshake&#160;because&#160;resealing&#160;such&#160;keys<br/>to&#160;a&#160;different&#160;TCB&#160;is&#160;not&#160;permitted.&#160;Therefore,&#160;we&#160;present&#160;a&#160;procedure&#160;that&#160;allows&#160;the<br/>update&#160;of&#160;the&#160;TCB&#160;without&#160;compromising&#160;the&#160;TLS&#160;keys&#160;and&#160;thus&#160;preserves&#160;the&#160;validity<br/>of&#160;the&#160;TLS&#160;certificate.</p>
<p style="position:absolute;top:591px;left:248px;white-space:nowrap" class="ft5712">The&#160;introduced&#160;extensions&#160;are&#160;necessary&#160;to&#160;trigger&#160;and&#160;negotiate&#160;the&#160;exchange&#160;of</p>
<p style="position:absolute;top:609px;left:226px;white-space:nowrap" class="ft5712">configuration&#160;information&#160;as&#160;well&#160;as&#160;for&#160;the&#160;transport&#160;of&#160;the&#160;additional&#160;data.</p>
<p style="position:absolute;top:668px;left:226px;white-space:nowrap" class="ft5744"><b>5.5.1</b></p>
<p style="position:absolute;top:668px;left:280px;white-space:nowrap" class="ft5744"><b>Keys&#160;and&#160;Certificates</b></p>
<p style="position:absolute;top:720px;left:226px;white-space:nowrap" class="ft5717"><b>Binding&#160;Key&#160;(</b></p>
<p style="position:absolute;top:720px;left:319px;white-space:nowrap" class="ft57113">K</p>
<p style="position:absolute;top:725px;left:331px;white-space:nowrap" class="ft57114">SKAE</p>
<p style="position:absolute;top:720px;left:366px;white-space:nowrap" class="ft5717"><b>)&#160;and&#160;SKAE:&#160;</b>The</p>
<p style="position:absolute;top:719px;left:489px;white-space:nowrap" class="ft5729">non</p>
<p style="position:absolute;top:719px;left:520px;white-space:nowrap" class="ft5733">−</p>
<p style="position:absolute;top:719px;left:536px;white-space:nowrap" class="ft5729">migratable</p>
<p style="position:absolute;top:720px;left:615px;white-space:nowrap" class="ft5712">asymmetric&#160;key&#160;pair</p>
<p style="position:absolute;top:738px;left:226px;white-space:nowrap" class="ft57113">K</p>
<p style="position:absolute;top:743px;left:238px;white-space:nowrap" class="ft57114">SKAE</p>
<p style="position:absolute;top:738px;left:277px;white-space:nowrap" class="ft5712">(</p>
<p style="position:absolute;top:738px;left:282px;white-space:nowrap" class="ft57113">PK</p>
<p style="position:absolute;top:743px;left:303px;white-space:nowrap" class="ft57114">SKAE</p>
<p style="position:absolute;top:738px;left:339px;white-space:nowrap" class="ft5712">,</p>
<p style="position:absolute;top:738px;left:346px;white-space:nowrap" class="ft57113">SK</p>
<p style="position:absolute;top:743px;left:366px;white-space:nowrap" class="ft57114">SKAE</p>
<p style="position:absolute;top:738px;left:402px;white-space:nowrap" class="ft5712">)&#160;is&#160;created&#160;after&#160;an&#160;Attestation&#160;Identity&#160;Key&#160;(</p>
<p style="position:absolute;top:738px;left:670px;white-space:nowrap" class="ft57113">K</p>
<p style="position:absolute;top:743px;left:682px;white-space:nowrap" class="ft57114">AIK</p>
<p style="position:absolute;top:738px;left:707px;white-space:nowrap" class="ft5712"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#57">)</a></p>
<p style="position:absolute;top:736px;left:712px;white-space:nowrap" class="ft5721"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#57">9</a></p>
<p style="position:absolute;top:738px;left:722px;white-space:nowrap" class="ft5712">has</p>
<p style="position:absolute;top:756px;left:226px;white-space:nowrap" class="ft5712">been&#160;installed.&#160;Its&#160;private&#160;part</p>
<p style="position:absolute;top:756px;left:407px;white-space:nowrap" class="ft57113">SK</p>
<p style="position:absolute;top:761px;left:427px;white-space:nowrap" class="ft57114">SKAE</p>
<p style="position:absolute;top:756px;left:467px;white-space:nowrap" class="ft5712">is&#160;sealed&#160;to&#160;a&#160;specific&#160;TCB&#160;using</p>
<p style="position:absolute;top:756px;left:665px;white-space:nowrap" class="ft57113">K</p>
<p style="position:absolute;top:761px;left:677px;white-space:nowrap" class="ft57114">storage</p>
<p style="position:absolute;top:756px;left:720px;white-space:nowrap" class="ft5712">and</p>
<p style="position:absolute;top:774px;left:226px;white-space:nowrap" class="ft5730">never&#160;leaves&#160;the&#160;TPM&#160;unencrypted&#160;(see&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#58">5.3)</a>.&#160;We&#160;make&#160;use&#160;of&#160;the&#160;<i>Subject&#160;Key<br/>Attestation&#160;Evidence&#160;</i>(</p>
<p style="position:absolute;top:792px;left:363px;white-space:nowrap" class="ft57113">SKAE</p>
<p style="position:absolute;top:792px;left:406px;white-space:nowrap" class="ft5712">)&#160;as&#160;proposed&#160;by&#160;the&#160;TCG&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[72]</a>).</p>
<p style="position:absolute;top:792px;left:633px;white-space:nowrap" class="ft57113">SKAE</p>
<p style="position:absolute;top:792px;left:680px;white-space:nowrap" class="ft5712">can&#160;vouch</p>
<p style="position:absolute;top:810px;left:226px;white-space:nowrap" class="ft5712">that</p>
<p style="position:absolute;top:810px;left:252px;white-space:nowrap" class="ft57113">K</p>
<p style="position:absolute;top:815px;left:264px;white-space:nowrap" class="ft57114">SKAE</p>
<p style="position:absolute;top:810px;left:303px;white-space:nowrap" class="ft5712">was&#160;created&#160;by&#160;a&#160;<i>Trusted&#160;Platform&#160;</i>that&#160;conforms&#160;to&#160;the&#160;TCG&#160;specification</p>
<p style="position:absolute;top:828px;left:226px;white-space:nowrap" class="ft5712">(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[74]</a>)&#160;and&#160;that&#160;a&#160;certain&#160;TCB&#160;configuration&#160;has&#160;to&#160;be&#160;in&#160;place&#160;during&#160;release.</p>
<p style="position:absolute;top:850px;left:226px;white-space:nowrap" class="ft5717"><b>Bound&#160;Encryption&#160;Key&#160;(</b></p>
<p style="position:absolute;top:850px;left:381px;white-space:nowrap" class="ft57113">K</p>
<p style="position:absolute;top:855px;left:392px;white-space:nowrap" class="ft57114">enc</p>
<p style="position:absolute;top:850px;left:412px;white-space:nowrap" class="ft5717"><b>)&#160;and&#160;Bound&#160;Signature&#160;Key&#160;(</b></p>
<p style="position:absolute;top:850px;left:592px;white-space:nowrap" class="ft57113">K</p>
<p style="position:absolute;top:855px;left:603px;white-space:nowrap" class="ft57114">sign</p>
<p style="position:absolute;top:850px;left:627px;white-space:nowrap" class="ft5717"><b>):&#160;</b>We&#160;introduce&#160;the</p>
<p style="position:absolute;top:868px;left:226px;white-space:nowrap" class="ft5712">asymmetric&#160;key&#160;pair&#160;<i>Bound&#160;Encryption&#160;Key&#160;</i>(BEK)</p>
<p style="position:absolute;top:868px;left:538px;white-space:nowrap" class="ft57113">K</p>
<p style="position:absolute;top:873px;left:550px;white-space:nowrap" class="ft57114">enc</p>
<p style="position:absolute;top:868px;left:573px;white-space:nowrap" class="ft5712">(</p>
<p style="position:absolute;top:868px;left:579px;white-space:nowrap" class="ft57113">PK</p>
<p style="position:absolute;top:873px;left:600px;white-space:nowrap" class="ft57114">enc</p>
<p style="position:absolute;top:868px;left:620px;white-space:nowrap" class="ft5712">,</p>
<p style="position:absolute;top:868px;left:628px;white-space:nowrap" class="ft57113">SK</p>
<p style="position:absolute;top:873px;left:648px;white-space:nowrap" class="ft57114">enc</p>
<p style="position:absolute;top:868px;left:667px;white-space:nowrap" class="ft5712">)&#160;and&#160;<i>Bound</i></p>
<p style="position:absolute;top:886px;left:226px;white-space:nowrap" class="ft5711"><i>Signature&#160;Key&#160;</i>(BSK)</p>
<p style="position:absolute;top:886px;left:359px;white-space:nowrap" class="ft57113">K</p>
<p style="position:absolute;top:891px;left:370px;white-space:nowrap" class="ft57114">sign</p>
<p style="position:absolute;top:886px;left:398px;white-space:nowrap" class="ft5712">(</p>
<p style="position:absolute;top:886px;left:403px;white-space:nowrap" class="ft57113">PK</p>
<p style="position:absolute;top:891px;left:424px;white-space:nowrap" class="ft57114">sign</p>
<p style="position:absolute;top:886px;left:448px;white-space:nowrap" class="ft5712">,</p>
<p style="position:absolute;top:886px;left:456px;white-space:nowrap" class="ft57113">SK</p>
<p style="position:absolute;top:891px;left:476px;white-space:nowrap" class="ft57114">sign</p>
<p style="position:absolute;top:886px;left:499px;white-space:nowrap" class="ft5712">),&#160;that&#160;are&#160;considered&#160;long-lived&#160;and&#160;us-</p>
<p style="position:absolute;top:904px;left:226px;white-space:nowrap" class="ft5715">able&#160;for&#160;all&#160;client&#160;compartments&#160;that&#160;wish&#160;to&#160;establish&#160;a&#160;Trusted&#160;Channel&#160;to&#160;a&#160;remote<br/>party.&#160;They&#160;are&#160;created&#160;and&#160;sealed&#160;by</p>
<p style="position:absolute;top:921px;left:448px;white-space:nowrap" class="ft57113">TM</p>
<p style="position:absolute;top:922px;left:477px;white-space:nowrap" class="ft5712">using</p>
<p style="position:absolute;top:921px;left:512px;white-space:nowrap" class="ft57113">K</p>
<p style="position:absolute;top:927px;left:524px;white-space:nowrap" class="ft57114">storage</p>
<p style="position:absolute;top:922px;left:566px;white-space:nowrap" class="ft5712">at&#160;any&#160;time&#160;before&#160;the&#160;Trusted</p>
<p style="position:absolute;top:940px;left:226px;white-space:nowrap" class="ft5712">Channel&#160;is&#160;set&#160;up.&#160;Then</p>
<p style="position:absolute;top:939px;left:376px;white-space:nowrap" class="ft57113">PK</p>
<p style="position:absolute;top:945px;left:398px;white-space:nowrap" class="ft57114">enc</p>
<p style="position:absolute;top:940px;left:422px;white-space:nowrap" class="ft5712">and</p>
<p style="position:absolute;top:939px;left:448px;white-space:nowrap" class="ft57113">PK</p>
<p style="position:absolute;top:945px;left:470px;white-space:nowrap" class="ft57114">sign</p>
<p style="position:absolute;top:940px;left:497px;white-space:nowrap" class="ft5712">are&#160;included&#160;in&#160;a&#160;specific&#160;<i>TLS&#160;certificate</i></p>
<p style="position:absolute;top:958px;left:226px;white-space:nowrap" class="ft5712">(</p>
<p style="position:absolute;top:957px;left:231px;white-space:nowrap" class="ft57113">cert</p>
<p style="position:absolute;top:963px;left:255px;white-space:nowrap" class="ft57114">TCLS</p>
<p style="position:absolute;top:958px;left:289px;white-space:nowrap" class="ft5712">).&#160;The</p>
<p style="position:absolute;top:957px;left:333px;white-space:nowrap" class="ft57113">cert</p>
<p style="position:absolute;top:963px;left:357px;white-space:nowrap" class="ft57114">TCLS</p>
<p style="position:absolute;top:958px;left:396px;white-space:nowrap" class="ft5712">of</p>
<p style="position:absolute;top:957px;left:413px;white-space:nowrap" class="ft5733">S</p>
<p style="position:absolute;top:958px;left:428px;white-space:nowrap" class="ft5712">will&#160;likely&#160;be&#160;signed&#160;by&#160;a&#160;CA&#160;like&#160;e.g.&#160;Verisign.&#160;In</p>
<p style="position:absolute;top:985px;left:242px;white-space:nowrap" class="ft5722">8</p>
<p style="position:absolute;top:987px;left:247px;white-space:nowrap" class="ft5710">“Transparent”&#160;deployment&#160;means&#160;that&#160;applications&#160;running&#160;in&#160;client&#160;compartments&#160;are&#160;not&#160;involved&#160;in</p>
<p style="position:absolute;top:1001px;left:226px;white-space:nowrap" class="ft5764">setting&#160;up&#160;the&#160;Trusted&#160;Channel.&#160;This&#160;is&#160;instead&#160;triggered&#160;by&#160;the&#160;platform&#160;or&#160;the&#160;application&#160;policy&#160;kept&#160;by<br/>the</p>
<p style="position:absolute;top:1015px;left:244px;white-space:nowrap" class="ft57115">PM</p>
<p style="position:absolute;top:1015px;left:266px;white-space:nowrap" class="ft5710">,&#160;e.g.,&#160;during&#160;the&#160;installation&#160;of&#160;the&#160;TCB&#160;or&#160;the&#160;application&#160;itself.</p>
<p style="position:absolute;top:1028px;left:242px;white-space:nowrap" class="ft5722">9</p>
<p style="position:absolute;top:1030px;left:247px;white-space:nowrap" class="ft5710">This&#160;is&#160;a&#160;specific&#160;signing&#160;key&#160;defined&#160;in&#160;the&#160;TCG&#160;specifications&#160;that&#160;can&#160;be&#160;used&#160;to&#160;authenticate&#160;a&#160;user</p>
<p style="position:absolute;top:1044px;left:226px;white-space:nowrap" class="ft5764">and/or&#160;his&#160;system.&#160;It&#160;is&#160;kept&#160;securely&#160;inside&#160;the&#160;TPM&#160;and&#160;can&#160;only&#160;be&#160;used&#160;for&#160;signing&#160;stored&#160;measurement<br/>values&#160;or&#160;certifying&#160;other&#160;non-migratable&#160;keys&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[74]</a>).</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft5718">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 58 -->
<a name="58"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft58118{font-size:15px;font-family:MQXFAO+CMTT10;color:#000000;}
	.ft58119{font-size:12px;font-family:Times;color:#000000;}
-->
</style>
<div id="page58-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL058.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft5812">56</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft5818">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:323px;left:318px;white-space:nowrap" class="ft5812">Figure&#160;5.3:&#160;The&#160;key&#160;hierarchy</p>
<p style="position:absolute;top:372px;left:150px;white-space:nowrap" class="ft5812">contrast&#160;the</p>
<p style="position:absolute;top:371px;left:224px;white-space:nowrap" class="ft58113">cert</p>
<p style="position:absolute;top:376px;left:249px;white-space:nowrap" class="ft58114">TCLS</p>
<p style="position:absolute;top:372px;left:287px;white-space:nowrap" class="ft5812">of</p>
<p style="position:absolute;top:371px;left:304px;white-space:nowrap" class="ft5833">C</p>
<p style="position:absolute;top:372px;left:317px;white-space:nowrap" class="ft5812">could&#160;also&#160;be&#160;self-signed&#160;by</p>
<p style="position:absolute;top:371px;left:491px;white-space:nowrap" class="ft5833">C</p>
<p style="position:absolute;top:372px;left:500px;white-space:nowrap" class="ft5812">.&#160;But,&#160;if</p>
<p style="position:absolute;top:371px;left:554px;white-space:nowrap" class="ft5833">C</p>
<p style="position:absolute;top:372px;left:567px;white-space:nowrap" class="ft5812">wants&#160;to&#160;be&#160;able</p>
<p style="position:absolute;top:389px;left:150px;white-space:nowrap" class="ft5812">to&#160;attest&#160;to&#160;its&#160;state,&#160;some&#160;kind&#160;of</p>
<p style="position:absolute;top:389px;left:356px;white-space:nowrap" class="ft58113">cert</p>
<p style="position:absolute;top:394px;left:380px;white-space:nowrap" class="ft58114">TCLS</p>
<p style="position:absolute;top:389px;left:419px;white-space:nowrap" class="ft5812">is&#160;needed&#160;during&#160;for&#160;the&#160;TLS&#160;handshake.</p>
<p style="position:absolute;top:407px;left:150px;white-space:nowrap" class="ft58113">SK</p>
<p style="position:absolute;top:412px;left:170px;white-space:nowrap" class="ft58114">enc</p>
<p style="position:absolute;top:407px;left:193px;white-space:nowrap" class="ft5812">and</p>
<p style="position:absolute;top:407px;left:218px;white-space:nowrap" class="ft58113">SK</p>
<p style="position:absolute;top:412px;left:238px;white-space:nowrap" class="ft58114">sign</p>
<p style="position:absolute;top:407px;left:265px;white-space:nowrap" class="ft5812">are&#160;loaded&#160;during&#160;the&#160;start&#160;of&#160;the&#160;platform&#160;and&#160;kept&#160;inside&#160;the&#160;TCB.</p>
<p style="position:absolute;top:430px;left:150px;white-space:nowrap" class="ft5812">We&#160;need</p>
<p style="position:absolute;top:429px;left:208px;white-space:nowrap" class="ft58113">K</p>
<p style="position:absolute;top:435px;left:220px;white-space:nowrap" class="ft58114">SKAE</p>
<p style="position:absolute;top:430px;left:260px;white-space:nowrap" class="ft5812">to&#160;authenticate</p>
<p style="position:absolute;top:429px;left:355px;white-space:nowrap" class="ft58113">K</p>
<p style="position:absolute;top:435px;left:366px;white-space:nowrap" class="ft58114">enc</p>
<p style="position:absolute;top:430px;left:391px;white-space:nowrap" class="ft5812">and</p>
<p style="position:absolute;top:429px;left:418px;white-space:nowrap" class="ft58113">K</p>
<p style="position:absolute;top:435px;left:429px;white-space:nowrap" class="ft58114">sign</p>
<p style="position:absolute;top:430px;left:453px;white-space:nowrap" class="ft5812"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#58">:</a></p>
<p style="position:absolute;top:427px;left:457px;white-space:nowrap" class="ft5821"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#58">10</a></p>
<p style="position:absolute;top:430px;left:475px;white-space:nowrap" class="ft5812">By&#160;signing</p>
<p style="position:absolute;top:429px;left:547px;white-space:nowrap" class="ft58113">PK</p>
<p style="position:absolute;top:435px;left:569px;white-space:nowrap" class="ft58114">enc</p>
<p style="position:absolute;top:430px;left:594px;white-space:nowrap" class="ft5812">and</p>
<p style="position:absolute;top:429px;left:621px;white-space:nowrap" class="ft58113">PK</p>
<p style="position:absolute;top:435px;left:642px;white-space:nowrap" class="ft58114">sign</p>
<p style="position:absolute;top:448px;left:150px;white-space:nowrap" class="ft5812">using</p>
<p style="position:absolute;top:447px;left:188px;white-space:nowrap" class="ft58113">SK</p>
<p style="position:absolute;top:453px;left:208px;white-space:nowrap" class="ft58114">SKAE</p>
<p style="position:absolute;top:448px;left:249px;white-space:nowrap" class="ft5812">we&#160;provide&#160;evidence&#160;that</p>
<p style="position:absolute;top:447px;left:410px;white-space:nowrap" class="ft58113">SK</p>
<p style="position:absolute;top:453px;left:430px;white-space:nowrap" class="ft58114">enc</p>
<p style="position:absolute;top:448px;left:455px;white-space:nowrap" class="ft5812">and</p>
<p style="position:absolute;top:447px;left:482px;white-space:nowrap" class="ft58113">SK</p>
<p style="position:absolute;top:453px;left:502px;white-space:nowrap" class="ft58114">sign</p>
<p style="position:absolute;top:448px;left:531px;white-space:nowrap" class="ft5812">are&#160;kept&#160;secure&#160;inside</p>
<p style="position:absolute;top:466px;left:150px;white-space:nowrap" class="ft5812">the&#160;same&#160;TCB<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#58">.</a></p>
<p style="position:absolute;top:463px;left:242px;white-space:nowrap" class="ft5821"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#58">11</a></p>
<p style="position:absolute;top:466px;left:259px;white-space:nowrap" class="ft5812">To&#160;use</p>
<p style="position:absolute;top:465px;left:305px;white-space:nowrap" class="ft58113">K</p>
<p style="position:absolute;top:471px;left:316px;white-space:nowrap" class="ft58114">AIK</p>
<p style="position:absolute;top:466px;left:347px;white-space:nowrap" class="ft5812">directly&#160;for&#160;this&#160;purpose&#160;is&#160;not&#160;allowed&#160;by&#160;the&#160;TCG</p>
<p style="position:absolute;top:483px;left:150px;white-space:nowrap" class="ft5812">specification.&#160;Thus,&#160;the&#160;usage&#160;of</p>
<p style="position:absolute;top:483px;left:354px;white-space:nowrap" class="ft58113">K</p>
<p style="position:absolute;top:488px;left:366px;white-space:nowrap" class="ft58114">SKAE</p>
<p style="position:absolute;top:483px;left:406px;white-space:nowrap" class="ft5812">indirectly&#160;vouches&#160;that&#160;a&#160;certain&#160;TCB&#160;is&#160;in</p>
<p style="position:absolute;top:501px;left:150px;white-space:nowrap" class="ft5812">place.&#160;Therefore,&#160;the</p>
<p style="position:absolute;top:502px;left:277px;white-space:nowrap" class="ft58118">TPM</p>
<p style="position:absolute;top:501px;left:301px;white-space:nowrap" class="ft5812">_</p>
<p style="position:absolute;top:502px;left:308px;white-space:nowrap" class="ft58118">Sign</p>
<p style="position:absolute;top:500px;left:340px;white-space:nowrap" class="ft5828">()</p>
<p style="position:absolute;top:501px;left:354px;white-space:nowrap" class="ft5812">function&#160;is&#160;applied&#160;to&#160;sign</p>
<p style="position:absolute;top:501px;left:511px;white-space:nowrap" class="ft58113">K</p>
<p style="position:absolute;top:506px;left:523px;white-space:nowrap" class="ft58114">enc</p>
<p style="position:absolute;top:501px;left:542px;white-space:nowrap" class="ft5812">’s&#160;and</p>
<p style="position:absolute;top:501px;left:580px;white-space:nowrap" class="ft58113">K</p>
<p style="position:absolute;top:506px;left:592px;white-space:nowrap" class="ft58114">sign</p>
<p style="position:absolute;top:501px;left:615px;white-space:nowrap" class="ft5812">’s&#160;public</p>
<p style="position:absolute;top:519px;left:150px;white-space:nowrap" class="ft5812">parts&#160;with</p>
<p style="position:absolute;top:519px;left:213px;white-space:nowrap" class="ft58113">SK</p>
<p style="position:absolute;top:524px;left:233px;white-space:nowrap" class="ft58114">SKAE</p>
<p style="position:absolute;top:519px;left:268px;white-space:nowrap" class="ft5812">.&#160;This&#160;is&#160;done&#160;when</p>
<p style="position:absolute;top:519px;left:390px;white-space:nowrap" class="ft58113">TM</p>
<p style="position:absolute;top:519px;left:420px;white-space:nowrap" class="ft5812">is&#160;initialized.</p>
<p style="position:absolute;top:583px;left:150px;white-space:nowrap" class="ft5844"><b>5.5.2</b></p>
<p style="position:absolute;top:583px;left:204px;white-space:nowrap" class="ft5844"><b>TCB&#160;Update&#160;Management</b></p>
<p style="position:absolute;top:613px;left:150px;white-space:nowrap" class="ft5815">It&#160;has&#160;to&#160;be&#160;possible&#160;to&#160;update&#160;the&#160;TCB&#160;without&#160;requiring&#160;a&#160;new&#160;TLS&#160;certificate.&#160;The<br/>problem&#160;here&#160;is&#160;that&#160;a&#160;system&#160;in&#160;an&#160;updated&#160;state&#160;(and&#160;its&#160;peer)&#160;has&#160;to&#160;be&#160;able&#160;to&#160;judge<br/>the&#160;former&#160;state,&#160;because&#160;otherwise</p>
<p style="position:absolute;top:648px;left:365px;white-space:nowrap" class="ft58113">K</p>
<p style="position:absolute;top:653px;left:377px;white-space:nowrap" class="ft58114">enc</p>
<p style="position:absolute;top:649px;left:400px;white-space:nowrap" class="ft5812">and</p>
<p style="position:absolute;top:648px;left:426px;white-space:nowrap" class="ft58113">K</p>
<p style="position:absolute;top:653px;left:438px;white-space:nowrap" class="ft58114">sign</p>
<p style="position:absolute;top:649px;left:465px;white-space:nowrap" class="ft5812">may&#160;have&#160;been&#160;compromised&#160;and</p>
<p style="position:absolute;top:666px;left:150px;white-space:nowrap" class="ft5812">a&#160;new&#160;certificate&#160;is&#160;needed.&#160;To&#160;be&#160;able&#160;to&#160;do&#160;this&#160;we&#160;keep&#160;a&#160;secure</p>
<p style="position:absolute;top:666px;left:567px;white-space:nowrap" class="ft58113">changelog</p>
<p style="position:absolute;top:666px;left:630px;white-space:nowrap" class="ft5812">.&#160;The</p>
<p style="position:absolute;top:684px;left:150px;white-space:nowrap" class="ft58113">changelog</p>
<p style="position:absolute;top:684px;left:217px;white-space:nowrap" class="ft5812">holds&#160;the&#160;name&#160;and&#160;hash&#160;value&#160;of&#160;the&#160;component&#160;that&#160;has&#160;been&#160;updated&#160;or</p>
<p style="position:absolute;top:702px;left:150px;white-space:nowrap" class="ft5815">replaced.&#160;Additionally&#160;it&#160;contains&#160;a&#160;link&#160;to&#160;a&#160;certificate&#160;by&#160;a&#160;trusted&#160;third&#160;party&#160;(e.g.,<br/>the&#160;manufacturer)&#160;that&#160;vouches&#160;for&#160;these&#160;values.&#160;If&#160;a&#160;completely&#160;new&#160;component&#160;is<br/>installed&#160;without&#160;replacing&#160;or&#160;updating&#160;an&#160;old&#160;one,&#160;this&#160;is&#160;stored&#160;in&#160;the&#160;same&#160;form&#160;but<br/>marked&#160;as&#160;new.</p>
<p style="position:absolute;top:774px;left:172px;white-space:nowrap" class="ft5812">The&#160;update&#160;process&#160;begins&#160;with&#160;unsealing</p>
<p style="position:absolute;top:774px;left:443px;white-space:nowrap" class="ft58113">SK</p>
<p style="position:absolute;top:779px;left:463px;white-space:nowrap" class="ft58114">sign</p>
<p style="position:absolute;top:774px;left:493px;white-space:nowrap" class="ft5812">and</p>
<p style="position:absolute;top:774px;left:521px;white-space:nowrap" class="ft58113">SK</p>
<p style="position:absolute;top:779px;left:541px;white-space:nowrap" class="ft58114">enc</p>
<p style="position:absolute;top:774px;left:561px;white-space:nowrap" class="ft5812">.</p>
<p style="position:absolute;top:774px;left:578px;white-space:nowrap" class="ft5812">Then&#160;the&#160;new</p>
<p style="position:absolute;top:792px;left:150px;white-space:nowrap" class="ft58113">package</p>
<p style="position:absolute;top:790px;left:204px;white-space:nowrap" class="ft5821"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#58">12</a></p>
<p style="position:absolute;top:792px;left:218px;white-space:nowrap" class="ft5812">is&#160;downloaded&#160;from&#160;a&#160;trustworthy&#160;entity&#160;together&#160;with</p>
<p style="position:absolute;top:792px;left:539px;white-space:nowrap" class="ft58113">cert</p>
<p style="position:absolute;top:797px;left:563px;white-space:nowrap" class="ft58114">update</p>
<p style="position:absolute;top:792px;left:602px;white-space:nowrap" class="ft5812">containing</p>
<p style="position:absolute;top:810px;left:150px;white-space:nowrap" class="ft5812">the&#160;hash&#160;value&#160;of&#160;the&#160;component&#160;after&#160;installation.&#160;Then</p>
<p style="position:absolute;top:809px;left:498px;white-space:nowrap" class="ft58113">TM</p>
<p style="position:absolute;top:810px;left:530px;white-space:nowrap" class="ft5812">computes&#160;the&#160;foreseen</p>
<p style="position:absolute;top:828px;left:150px;white-space:nowrap" class="ft5815">configuration&#160;of&#160;the&#160;platform&#160;after&#160;the&#160;installation&#160;using&#160;the&#160;hash&#160;value&#160;comprised&#160;in<br/>the&#160;certificate&#160;replacing&#160;the&#160;values&#160;of&#160;the&#160;updated&#160;component&#160;in&#160;the</p>
<p style="position:absolute;top:845px;left:548px;white-space:nowrap" class="ft58113">CDS</p>
<p style="position:absolute;top:846px;left:584px;white-space:nowrap" class="ft5812">and&#160;it&#160;updates</p>
<p style="position:absolute;top:863px;left:150px;white-space:nowrap" class="ft58113">changelog</p>
<p style="position:absolute;top:864px;left:213px;white-space:nowrap" class="ft5812">.&#160;Subsequently</p>
<p style="position:absolute;top:863px;left:309px;white-space:nowrap" class="ft58113">SK</p>
<p style="position:absolute;top:869px;left:328px;white-space:nowrap" class="ft58114">sign</p>
<p style="position:absolute;top:864px;left:356px;white-space:nowrap" class="ft5812">and</p>
<p style="position:absolute;top:863px;left:382px;white-space:nowrap" class="ft58113">SK</p>
<p style="position:absolute;top:869px;left:402px;white-space:nowrap" class="ft58114">enc</p>
<p style="position:absolute;top:864px;left:426px;white-space:nowrap" class="ft5812">are&#160;sealed&#160;to&#160;this&#160;state&#160;and&#160;the&#160;resulting</p>
<p style="position:absolute;top:882px;left:150px;white-space:nowrap" class="ft5812">encrypted&#160;keys&#160;stored&#160;by</p>
<p style="position:absolute;top:881px;left:305px;white-space:nowrap" class="ft58113">TM</p>
<p style="position:absolute;top:882px;left:332px;white-space:nowrap" class="ft5812">.&#160;In&#160;a&#160;last&#160;step&#160;the&#160;new</p>
<p style="position:absolute;top:881px;left:477px;white-space:nowrap" class="ft58113">package</p>
<p style="position:absolute;top:882px;left:532px;white-space:nowrap" class="ft5812">is&#160;installed.&#160;After&#160;this</p>
<p style="position:absolute;top:900px;left:150px;white-space:nowrap" class="ft5812">process&#160;the&#160;platform&#160;has&#160;to&#160;be&#160;rebooted&#160;to&#160;let&#160;the&#160;changes&#160;take&#160;effect.</p>
<p style="position:absolute;top:941px;left:162px;white-space:nowrap" class="ft5822">10</p>
<p style="position:absolute;top:943px;left:171px;white-space:nowrap" class="ft5810">It&#160;would&#160;also&#160;be&#160;possible&#160;to&#160;use</p>
<p style="position:absolute;top:943px;left:328px;white-space:nowrap" class="ft58115">K</p>
<p style="position:absolute;top:947px;left:338px;white-space:nowrap" class="ft58116">SKAE</p>
<p style="position:absolute;top:943px;left:372px;white-space:nowrap" class="ft5810">instead&#160;of</p>
<p style="position:absolute;top:943px;left:423px;white-space:nowrap" class="ft58115">K</p>
<p style="position:absolute;top:947px;left:433px;white-space:nowrap" class="ft58116">sign</p>
<p style="position:absolute;top:943px;left:456px;white-space:nowrap" class="ft5810">for&#160;signing&#160;during&#160;the&#160;handshake.&#160;But&#160;then</p>
<p style="position:absolute;top:957px;left:150px;white-space:nowrap" class="ft5810">the&#160;involvement&#160;of&#160;the&#160;TPM&#160;every&#160;time&#160;a&#160;Trusted&#160;Channel&#160;is&#160;set&#160;up&#160;would&#160;be&#160;necessary.</p>
<p style="position:absolute;top:970px;left:162px;white-space:nowrap" class="ft5822">11</p>
<p style="position:absolute;top:972px;left:171px;white-space:nowrap" class="ft5810">The&#160;TCB&#160;must&#160;check&#160;<i>digest&#160;at&#160;creation&#160;</i>and&#160;<i>digest&#160;at&#160;release&#160;</i>of&#160;the&#160;stored&#160;key&#160;data&#160;objects&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#80">[76,</a></p>
<p style="position:absolute;top:986px;left:150px;white-space:nowrap" class="ft5810">p.89])&#160;before&#160;signing&#160;it&#160;with</p>
<p style="position:absolute;top:986px;left:287px;white-space:nowrap" class="ft58115">SK</p>
<p style="position:absolute;top:990px;left:304px;white-space:nowrap" class="ft58116">SKAE</p>
<p style="position:absolute;top:986px;left:338px;white-space:nowrap" class="ft5810">to&#160;be&#160;sure&#160;that&#160;they&#160;were&#160;not&#160;compromised&#160;by&#160;a&#160;former&#160;TCB.</p>
<p style="position:absolute;top:999px;left:162px;white-space:nowrap" class="ft5822">12</p>
<p style="position:absolute;top:1001px;left:171px;white-space:nowrap" class="ft5810">This&#160;may&#160;be&#160;considered&#160;like&#160;a&#160;package&#160;structure&#160;as&#160;it&#160;is&#160;used&#160;by&#160;several&#160;Linux&#160;distributions,&#160;e.g.,&#160;rpm&#160;or</p>
<p style="position:absolute;top:1015px;left:150px;white-space:nowrap" class="ft5810">deb.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft5818">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 59 -->
<a name="59"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page59-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL059.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft5912">CHAPTER&#160;5.&#160;TRUSTED&#160;CHANNELS&#160;WITH&#160;REMOTE&#160;INTEGRITY&#160;VERIFICATION57</p>
<p style="position:absolute;top:191px;left:226px;white-space:nowrap" class="ft5944"><b>5.5.3</b></p>
<p style="position:absolute;top:191px;left:280px;white-space:nowrap" class="ft5944"><b>Extensions&#160;used&#160;in&#160;the&#160;TLS&#160;handshake</b></p>
<p style="position:absolute;top:244px;left:226px;white-space:nowrap" class="ft5917"><b>TLS&#160;message&#160;extensions&#160;</b>(cf.</p>
<p style="position:absolute;top:244px;left:454px;white-space:nowrap" class="ft5912"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[24]</a>):</p>
<p style="position:absolute;top:243px;left:508px;white-space:nowrap" class="ft5929">Attestation&#160;Extension</p>
<p style="position:absolute;top:244px;left:676px;white-space:nowrap" class="ft5912">(AExt)&#160;or</p>
<p style="position:absolute;top:261px;left:226px;white-space:nowrap" class="ft5929">State&#160;Change&#160;Extension</p>
<p style="position:absolute;top:262px;left:410px;white-space:nowrap" class="ft5912">(SCExt)&#160;are&#160;transmitted&#160;within&#160;the</p>
<p style="position:absolute;top:261px;left:646px;white-space:nowrap" class="ft59113">ClientHello</p>
<p style="position:absolute;top:262px;left:729px;white-space:nowrap" class="ft5912">or</p>
<p style="position:absolute;top:279px;left:226px;white-space:nowrap" class="ft59113">ServerHello</p>
<p style="position:absolute;top:280px;left:306px;white-space:nowrap" class="ft5912">messages.&#160;The&#160;first&#160;one&#160;is&#160;used&#160;in&#160;the&#160;initial&#160;handshake&#160;to&#160;negotiate&#160;which</p>
<p style="position:absolute;top:298px;left:226px;white-space:nowrap" class="ft5912">side&#160;(</p>
<p style="position:absolute;top:297px;left:260px;white-space:nowrap" class="ft5933">C</p>
<p style="position:absolute;top:298px;left:273px;white-space:nowrap" class="ft5912">and/or</p>
<p style="position:absolute;top:297px;left:315px;white-space:nowrap" class="ft5933">S</p>
<p style="position:absolute;top:298px;left:325px;white-space:nowrap" class="ft5912">)&#160;has&#160;to&#160;attest&#160;to&#160;its&#160;state,&#160;the&#160;type&#160;of&#160;attestation&#160;and&#160;state-monitoring</p>
<p style="position:absolute;top:316px;left:226px;white-space:nowrap" class="ft5912">supported&#160;or&#160;if&#160;privacy&#160;of&#160;attestation&#160;information&#160;is&#160;desired.</p>
<p style="position:absolute;top:315px;left:592px;white-space:nowrap" class="ft59113">SCExt</p>
<p style="position:absolute;top:316px;left:639px;white-space:nowrap" class="ft5912">is&#160;used&#160;to&#160;inform</p>
<p style="position:absolute;top:334px;left:226px;white-space:nowrap" class="ft5915">the&#160;peer&#160;of&#160;a&#160;state&#160;change&#160;on&#160;the&#160;counterpart&#160;and&#160;to&#160;transport&#160;configuration&#160;data&#160;in&#160;a<br/>re-handshake&#160;(cf.&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#62">5.5.6)</a>.&#160;This&#160;re-handshake&#160;is&#160;triggered&#160;when&#160;a&#160;state&#160;change<br/>occurs&#160;on&#160;any&#160;side&#160;and&#160;if&#160;the&#160;corresponding&#160;state&#160;monitoring&#160;option&#160;was&#160;selected&#160;in</p>
<p style="position:absolute;top:387px;left:226px;white-space:nowrap" class="ft59113">AExt</p>
<p style="position:absolute;top:388px;left:261px;white-space:nowrap" class="ft5912">.</p>
<p style="position:absolute;top:410px;left:226px;white-space:nowrap" class="ft5917"><b>Additional&#160;handshake&#160;message</b>:&#160;To&#160;convey&#160;configuration&#160;information&#160;additional</p>
<p style="position:absolute;top:427px;left:226px;white-space:nowrap" class="ft59113">SupplementalData</p>
<p style="position:absolute;top:428px;left:349px;white-space:nowrap" class="ft5912">extension&#160;messages&#160;are&#160;used&#160;(see&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[66]</a>).&#160;They&#160;include&#160;the</p>
<p style="position:absolute;top:427px;left:695px;white-space:nowrap" class="ft59113">SKAE</p>
<p style="position:absolute;top:428px;left:738px;white-space:nowrap" class="ft5912">,</p>
<p style="position:absolute;top:446px;left:226px;white-space:nowrap" class="ft5912">keys,&#160;a&#160;diges<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#59">t</a></p>
<p style="position:absolute;top:443px;left:307px;white-space:nowrap" class="ft5921"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#59">13</a></p>
<p style="position:absolute;top:446px;left:321px;white-space:nowrap" class="ft5912">of&#160;the&#160;nonces&#160;sent&#160;in&#160;the&#160;TLS&#160;Hello&#160;messages&#160;and</p>
<p style="position:absolute;top:445px;left:622px;white-space:nowrap" class="ft5929">properties</p>
<p style="position:absolute;top:446px;left:694px;white-space:nowrap" class="ft5912">depend-</p>
<p style="position:absolute;top:464px;left:226px;white-space:nowrap" class="ft5912">ing&#160;on&#160;what&#160;kind&#160;of&#160;attestation&#160;and&#160;key&#160;exchange&#160;was&#160;chosen.&#160;Furthermore,&#160;a&#160;Signature</p>
<p style="position:absolute;top:481px;left:226px;white-space:nowrap" class="ft59113">Sig</p>
<p style="position:absolute;top:487px;left:246px;white-space:nowrap" class="ft59114">aD</p>
<p style="position:absolute;top:482px;left:267px;white-space:nowrap" class="ft5912">over&#160;the&#160;attestation&#160;data&#160;(</p>
<p style="position:absolute;top:481px;left:418px;white-space:nowrap" class="ft59113">aD</p>
<p style="position:absolute;top:482px;left:438px;white-space:nowrap" class="ft5912">)&#160;is&#160;appended:</p>
<p style="position:absolute;top:525px;left:252px;white-space:nowrap" class="ft59113">nonceSD</p>
<p style="position:absolute;top:524px;left:314px;white-space:nowrap" class="ft5933">←</p>
<p style="position:absolute;top:524px;left:333px;white-space:nowrap" class="ft5929">digest</p>
<p style="position:absolute;top:525px;left:373px;white-space:nowrap" class="ft5912">(</p>
<p style="position:absolute;top:525px;left:378px;white-space:nowrap" class="ft59113">nonce</p>
<p style="position:absolute;top:523px;left:417px;white-space:nowrap" class="ft59114">C</p>
<p style="position:absolute;top:532px;left:416px;white-space:nowrap" class="ft59114">TPM</p>
<p style="position:absolute;top:525px;left:446px;white-space:nowrap" class="ft5912">,</p>
<p style="position:absolute;top:525px;left:450px;white-space:nowrap" class="ft59113">nonce</p>
<p style="position:absolute;top:523px;left:488px;white-space:nowrap" class="ft59114">S</p>
<p style="position:absolute;top:532px;left:487px;white-space:nowrap" class="ft59114">TPM</p>
<p style="position:absolute;top:525px;left:517px;white-space:nowrap" class="ft5912">)</p>
<p style="position:absolute;top:543px;left:252px;white-space:nowrap" class="ft59113">Sig</p>
<p style="position:absolute;top:548px;left:272px;white-space:nowrap" class="ft59114">BSEK</p>
<p style="position:absolute;top:542px;left:311px;white-space:nowrap" class="ft5933">←</p>
<p style="position:absolute;top:542px;left:330px;white-space:nowrap" class="ft5929">sign</p>
<p style="position:absolute;top:543px;left:359px;white-space:nowrap" class="ft5912">(digest(</p>
<p style="position:absolute;top:543px;left:404px;white-space:nowrap" class="ft59113">PK</p>
<p style="position:absolute;top:548px;left:426px;white-space:nowrap" class="ft59114">enc</p>
<p style="position:absolute;top:543px;left:445px;white-space:nowrap" class="ft5912">,</p>
<p style="position:absolute;top:543px;left:453px;white-space:nowrap" class="ft59113">PK</p>
<p style="position:absolute;top:548px;left:474px;white-space:nowrap" class="ft59114">sign</p>
<p style="position:absolute;top:543px;left:498px;white-space:nowrap" class="ft5912">);</p>
<p style="position:absolute;top:543px;left:510px;white-space:nowrap" class="ft59113">SK</p>
<p style="position:absolute;top:548px;left:530px;white-space:nowrap" class="ft59114">SKAE</p>
<p style="position:absolute;top:543px;left:566px;white-space:nowrap" class="ft5912">)</p>
<p style="position:absolute;top:561px;left:252px;white-space:nowrap" class="ft59113">properties</p>
<p style="position:absolute;top:561px;left:320px;white-space:nowrap" class="ft5912">:=</p>
<p style="position:absolute;top:560px;left:337px;white-space:nowrap" class="ft5933">{</p>
<p style="position:absolute;top:561px;left:348px;white-space:nowrap" class="ft59113">CDS</p>
<p style="position:absolute;top:561px;left:380px;white-space:nowrap" class="ft5912">,</p>
<p style="position:absolute;top:560px;left:387px;white-space:nowrap" class="ft5929">certif&#160;icates</p>
<p style="position:absolute;top:561px;left:467px;white-space:nowrap" class="ft5912">,</p>
<p style="position:absolute;top:560px;left:474px;white-space:nowrap" class="ft5929">ref&#160;erence&#160;values</p>
<p style="position:absolute;top:561px;left:587px;white-space:nowrap" class="ft5912">,</p>
<p style="position:absolute;top:561px;left:594px;white-space:nowrap" class="ft59113">changelog</p>
<p style="position:absolute;top:560px;left:661px;white-space:nowrap" class="ft5933">}</p>
<p style="position:absolute;top:579px;left:252px;white-space:nowrap" class="ft59113">aD</p>
<p style="position:absolute;top:579px;left:276px;white-space:nowrap" class="ft5912">:=</p>
<p style="position:absolute;top:578px;left:292px;white-space:nowrap" class="ft5933">{</p>
<p style="position:absolute;top:579px;left:303px;white-space:nowrap" class="ft59113">SKAE</p>
<p style="position:absolute;top:579px;left:346px;white-space:nowrap" class="ft5912">,</p>
<p style="position:absolute;top:579px;left:354px;white-space:nowrap" class="ft59113">PK</p>
<p style="position:absolute;top:584px;left:375px;white-space:nowrap" class="ft59114">SKAE</p>
<p style="position:absolute;top:579px;left:411px;white-space:nowrap" class="ft5912">,</p>
<p style="position:absolute;top:579px;left:418px;white-space:nowrap" class="ft59113">Sig</p>
<p style="position:absolute;top:584px;left:438px;white-space:nowrap" class="ft59114">BSEK</p>
<p style="position:absolute;top:579px;left:474px;white-space:nowrap" class="ft5912">,</p>
<p style="position:absolute;top:579px;left:481px;white-space:nowrap" class="ft59113">nonceSD</p>
<p style="position:absolute;top:579px;left:540px;white-space:nowrap" class="ft5912">,</p>
<p style="position:absolute;top:579px;left:547px;white-space:nowrap" class="ft59113">properties</p>
<p style="position:absolute;top:578px;left:616px;white-space:nowrap" class="ft5933">}</p>
<p style="position:absolute;top:596px;left:252px;white-space:nowrap" class="ft59113">Sig</p>
<p style="position:absolute;top:602px;left:272px;white-space:nowrap" class="ft59114">aD</p>
<p style="position:absolute;top:596px;left:293px;white-space:nowrap" class="ft5933">←</p>
<p style="position:absolute;top:596px;left:311px;white-space:nowrap" class="ft5929">sign</p>
<p style="position:absolute;top:597px;left:340px;white-space:nowrap" class="ft5912">(</p>
<p style="position:absolute;top:596px;left:345px;white-space:nowrap" class="ft59113">aD</p>
<p style="position:absolute;top:597px;left:365px;white-space:nowrap" class="ft5912">;</p>
<p style="position:absolute;top:596px;left:373px;white-space:nowrap" class="ft59113">SK</p>
<p style="position:absolute;top:602px;left:393px;white-space:nowrap" class="ft59114">sign</p>
<p style="position:absolute;top:597px;left:416px;white-space:nowrap" class="ft5912">)</p>
<p style="position:absolute;top:647px;left:226px;white-space:nowrap" class="ft5915">Apart&#160;from&#160;our&#160;approach&#160;also&#160;other&#160;concepts&#160;of&#160;attestation&#160;are&#160;supported.&#160;If,&#160;e.g.,&#160;the<br/>TCG&#160;attestation&#160;mechanism&#160;should&#160;be&#160;used,&#160;a&#160;digest&#160;of</p>
<p style="position:absolute;top:664px;left:560px;white-space:nowrap" class="ft59113">nonceSD</p>
<p style="position:absolute;top:665px;left:619px;white-space:nowrap" class="ft5912">,</p>
<p style="position:absolute;top:664px;left:626px;white-space:nowrap" class="ft59113">PK</p>
<p style="position:absolute;top:670px;left:648px;white-space:nowrap" class="ft59114">enc</p>
<p style="position:absolute;top:665px;left:671px;white-space:nowrap" class="ft5912">and</p>
<p style="position:absolute;top:664px;left:697px;white-space:nowrap" class="ft59113">PK</p>
<p style="position:absolute;top:670px;left:718px;white-space:nowrap" class="ft59114">sign</p>
<p style="position:absolute;top:683px;left:226px;white-space:nowrap" class="ft5912">is&#160;given&#160;as&#160;external&#160;data&#160;to&#160;the</p>
<p style="position:absolute;top:684px;left:413px;white-space:nowrap" class="ft59118">TPM</p>
<p style="position:absolute;top:683px;left:436px;white-space:nowrap" class="ft5912">_</p>
<p style="position:absolute;top:684px;left:444px;white-space:nowrap" class="ft59118">Quote</p>
<p style="position:absolute;top:682px;left:483px;white-space:nowrap" class="ft5928">()</p>
<p style="position:absolute;top:683px;left:498px;white-space:nowrap" class="ft5912">function&#160;of&#160;the&#160;TPM&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[74]</a>).</p>
<p style="position:absolute;top:682px;left:691px;white-space:nowrap" class="ft59113">aD</p>
<p style="position:absolute;top:683px;left:716px;white-space:nowrap" class="ft5912">then</p>
<p style="position:absolute;top:701px;left:226px;white-space:nowrap" class="ft5912">contains&#160;the&#160;following&#160;values:</p>
<p style="position:absolute;top:743px;left:252px;white-space:nowrap" class="ft59113">properties</p>
<p style="position:absolute;top:748px;left:315px;white-space:nowrap" class="ft59114">TCG</p>
<p style="position:absolute;top:743px;left:348px;white-space:nowrap" class="ft5912">:=</p>
<p style="position:absolute;top:742px;left:365px;white-space:nowrap" class="ft5933">{</p>
<p style="position:absolute;top:743px;left:377px;white-space:nowrap" class="ft59113">CDS</p>
<p style="position:absolute;top:743px;left:409px;white-space:nowrap" class="ft5912">,</p>
<p style="position:absolute;top:743px;left:418px;white-space:nowrap" class="ft59113">TPM</p>
<p style="position:absolute;top:743px;left:454px;white-space:nowrap" class="ft5912">_</p>
<p style="position:absolute;top:743px;left:462px;white-space:nowrap" class="ft59113">Quote</p>
<p style="position:absolute;top:743px;left:502px;white-space:nowrap" class="ft5912">,</p>
<p style="position:absolute;top:742px;left:511px;white-space:nowrap" class="ft5929">certif&#160;icates</p>
<p style="position:absolute;top:743px;left:590px;white-space:nowrap" class="ft5912">,</p>
<p style="position:absolute;top:742px;left:598px;white-space:nowrap" class="ft5929">ref&#160;erence&#160;values</p>
<p style="position:absolute;top:743px;left:712px;white-space:nowrap" class="ft5912">,</p>
<p style="position:absolute;top:761px;left:252px;white-space:nowrap" class="ft59113">changelog</p>
<p style="position:absolute;top:760px;left:319px;white-space:nowrap" class="ft5933">}</p>
<p style="position:absolute;top:778px;left:252px;white-space:nowrap" class="ft59113">aD</p>
<p style="position:absolute;top:784px;left:271px;white-space:nowrap" class="ft59114">TCG</p>
<p style="position:absolute;top:779px;left:303px;white-space:nowrap" class="ft5912">:=</p>
<p style="position:absolute;top:778px;left:319px;white-space:nowrap" class="ft5933">{</p>
<p style="position:absolute;top:778px;left:330px;white-space:nowrap" class="ft59113">nonceSD</p>
<p style="position:absolute;top:779px;left:389px;white-space:nowrap" class="ft5912">,</p>
<p style="position:absolute;top:778px;left:397px;white-space:nowrap" class="ft59113">properties</p>
<p style="position:absolute;top:778px;left:465px;white-space:nowrap" class="ft5933">}</p>
<p style="position:absolute;top:796px;left:252px;white-space:nowrap" class="ft59113">Sig</p>
<p style="position:absolute;top:802px;left:272px;white-space:nowrap" class="ft59114">aD</p>
<p style="position:absolute;top:796px;left:293px;white-space:nowrap" class="ft5933">←</p>
<p style="position:absolute;top:796px;left:311px;white-space:nowrap" class="ft5929">sign</p>
<p style="position:absolute;top:797px;left:340px;white-space:nowrap" class="ft5912">(</p>
<p style="position:absolute;top:796px;left:345px;white-space:nowrap" class="ft59113">aD</p>
<p style="position:absolute;top:802px;left:364px;white-space:nowrap" class="ft59114">TCG</p>
<p style="position:absolute;top:797px;left:393px;white-space:nowrap" class="ft5912">;</p>
<p style="position:absolute;top:796px;left:400px;white-space:nowrap" class="ft59113">SK</p>
<p style="position:absolute;top:802px;left:420px;white-space:nowrap" class="ft59114">sign</p>
<p style="position:absolute;top:797px;left:444px;white-space:nowrap" class="ft5912">)</p>
<p style="position:absolute;top:847px;left:226px;white-space:nowrap" class="ft5912">In&#160;case</p>
<p style="position:absolute;top:846px;left:276px;white-space:nowrap" class="ft5929">privacy</p>
<p style="position:absolute;top:847px;left:332px;white-space:nowrap" class="ft5912">of&#160;attestation&#160;information&#160;is&#160;desired&#160;by&#160;one&#160;of&#160;the&#160;communication</p>
<p style="position:absolute;top:865px;left:226px;white-space:nowrap" class="ft5912">partners,&#160;no</p>
<p style="position:absolute;top:864px;left:303px;white-space:nowrap" class="ft59113">SupplementalData</p>
<p style="position:absolute;top:865px;left:426px;white-space:nowrap" class="ft5912">messages&#160;are&#160;sent&#160;within&#160;the&#160;first&#160;handshake.&#160;Thus,</p>
<p style="position:absolute;top:883px;left:226px;white-space:nowrap" class="ft5915">a&#160;second&#160;handshake&#160;is&#160;performed&#160;directly&#160;after&#160;the&#160;first&#160;one&#160;to&#160;exchange&#160;attestation<br/>information&#160;encrypted&#160;using&#160;the&#160;session&#160;key&#160;negotiated&#160;in&#160;the&#160;previous&#160;handshake&#160;(see<br/><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[66]</a>).</p>
<p style="position:absolute;top:982px;left:226px;white-space:nowrap" class="ft5944"><b>5.5.4</b></p>
<p style="position:absolute;top:982px;left:280px;white-space:nowrap" class="ft5944"><b>Trusted&#160;Initialization</b></p>
<p style="position:absolute;top:1012px;left:226px;white-space:nowrap" class="ft5915">To&#160;be&#160;able&#160;to&#160;attest&#160;to&#160;a&#160;platform’s&#160;configuration,&#160;its&#160;hard-&#160;and&#160;software&#160;components<br/>have&#160;to&#160;be&#160;measured&#160;reliably&#160;and&#160;those&#160;measurements&#160;have&#160;to&#160;be&#160;stored&#160;securely.&#160;An</p>
<p style="position:absolute;top:1057px;left:238px;white-space:nowrap" class="ft5922">13</p>
<p style="position:absolute;top:1059px;left:247px;white-space:nowrap" class="ft5910">The&#160;term&#160;digest&#160;stands&#160;for&#160;a&#160;SHA1&#160;message&#160;digest&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[22]</a>).</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft5918">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 60 -->
<a name="60"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page60-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL060.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft6012">58</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft6018">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:351px;left:163px;white-space:nowrap" class="ft6012">Figure&#160;5.4:&#160;Initial&#160;Interaction&#160;with&#160;TPM&#160;to&#160;retrieve&#160;necessary&#160;keys&#160;and&#160;credentials</p>
<p style="position:absolute;top:399px;left:150px;white-space:nowrap" class="ft6030">ongoing&#160;measurement&#160;process&#160;is&#160;effected&#160;originating&#160;from&#160;the&#160;<i>Core&#160;Root&#160;of&#160;Trust&#160;for<br/>Measuremen<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#60">t</a></i></p>
<p style="position:absolute;top:415px;left:231px;white-space:nowrap" class="ft6021"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#60">14</a></p>
<p style="position:absolute;top:417px;left:245px;white-space:nowrap" class="ft6012">that&#160;initiates&#160;the&#160;measurement&#160;process&#160;up&#160;to&#160;the&#160;Application&#160;Layer.&#160;Ev-</p>
<p style="position:absolute;top:435px;left:150px;white-space:nowrap" class="ft6015">ery&#160;component&#160;that&#160;has&#160;to&#160;be&#160;loaded&#160;during&#160;the&#160;boot&#160;process&#160;is&#160;measured&#160;before&#160;passing<br/>control&#160;over&#160;to&#160;it.&#160;Consequently,&#160;a&#160;<i>Chain&#160;of&#160;Trust&#160;</i>(CoT)&#160;is&#160;established&#160;and&#160;the&#160;TCB&#160;is<br/>measured&#160;reliably.&#160;These&#160;measurements&#160;consisting&#160;of&#160;hash&#160;values&#160;over&#160;loaded&#160;code&#160;are<br/>stored&#160;inside&#160;the&#160;TPM&#160;and&#160;represent&#160;the&#160;<i>static&#160;configuration&#160;</i>in&#160;our&#160;approach&#160;because&#160;it<br/>must&#160;be&#160;only&#160;modifiable&#160;with&#160;a&#160;following&#160;reboot.&#160;After&#160;the&#160;boot&#160;process&#160;platform&#160;moni-<br/>toring&#160;is&#160;conducted&#160;by</p>
<p style="position:absolute;top:524px;left:285px;white-space:nowrap" class="ft60113">CM</p>
<p style="position:absolute;top:525px;left:311px;white-space:nowrap" class="ft6012">.</p>
<p style="position:absolute;top:524px;left:319px;white-space:nowrap" class="ft60113">CDS</p>
<p style="position:absolute;top:525px;left:355px;white-space:nowrap" class="ft6012">that&#160;reflects&#160;the&#160;platform&#160;configuration&#160;is&#160;maintained</p>
<p style="position:absolute;top:543px;left:150px;white-space:nowrap" class="ft6012">by</p>
<p style="position:absolute;top:542px;left:169px;white-space:nowrap" class="ft60113">CM</p>
<p style="position:absolute;top:543px;left:195px;white-space:nowrap" class="ft6012">.&#160;The&#160;configuration&#160;of&#160;compartments&#160;that&#160;run&#160;above&#160;the&#160;TCB&#160;represent&#160;the&#160;<i>dy-</i></p>
<p style="position:absolute;top:561px;left:150px;white-space:nowrap" class="ft6015"><i>namic&#160;configuration&#160;</i>because&#160;we&#160;allow&#160;state&#160;changes&#160;to&#160;happen.&#160;In&#160;our&#160;approach&#160;the<br/>CoT&#160;is&#160;initially&#160;built-up&#160;until&#160;the&#160;TCB&#160;is&#160;loaded&#160;and&#160;running.&#160;To&#160;be&#160;able&#160;to&#160;provide<br/>support&#160;for&#160;Trusted&#160;Channels&#160;a&#160;random&#160;generator,&#160;seeded&#160;using</p>
<p style="position:absolute;top:597px;left:537px;white-space:nowrap" class="ft60118">TPM</p>
<p style="position:absolute;top:596px;left:561px;white-space:nowrap" class="ft6012">_</p>
<p style="position:absolute;top:597px;left:568px;white-space:nowrap" class="ft60118">GetRandom</p>
<p style="position:absolute;top:595px;left:639px;white-space:nowrap" class="ft6028">()</p>
<p style="position:absolute;top:596px;left:655px;white-space:nowrap" class="ft6012">at</p>
<p style="position:absolute;top:614px;left:150px;white-space:nowrap" class="ft6012">boot-time,&#160;provides&#160;random</p>
<p style="position:absolute;top:614px;left:323px;white-space:nowrap" class="ft60113">rd</p>
<p style="position:absolute;top:619px;left:336px;white-space:nowrap" class="ft60114">TPM</p>
<p style="position:absolute;top:614px;left:366px;white-space:nowrap" class="ft6012">.&#160;After&#160;the&#160;system&#160;has&#160;booted-up&#160;and&#160;the&#160;TCB&#160;is</p>
<p style="position:absolute;top:632px;left:150px;white-space:nowrap" class="ft6012">in&#160;place,</p>
<p style="position:absolute;top:632px;left:205px;white-space:nowrap" class="ft60113">TM</p>
<p style="position:absolute;top:632px;left:236px;white-space:nowrap" class="ft6012">unseals</p>
<p style="position:absolute;top:632px;left:284px;white-space:nowrap" class="ft60113">K</p>
<p style="position:absolute;top:637px;left:296px;white-space:nowrap" class="ft60114">enc</p>
<p style="position:absolute;top:632px;left:319px;white-space:nowrap" class="ft6012">and</p>
<p style="position:absolute;top:632px;left:345px;white-space:nowrap" class="ft60113">K</p>
<p style="position:absolute;top:637px;left:357px;white-space:nowrap" class="ft60114">sign</p>
<p style="position:absolute;top:632px;left:384px;white-space:nowrap" class="ft6012">and&#160;signs&#160;their&#160;public&#160;parts&#160;with</p>
<p style="position:absolute;top:632px;left:582px;white-space:nowrap" class="ft60113">SK</p>
<p style="position:absolute;top:637px;left:602px;white-space:nowrap" class="ft60114">SKAE</p>
<p style="position:absolute;top:632px;left:641px;white-space:nowrap" class="ft6012">(see</p>
<p style="position:absolute;top:650px;left:150px;white-space:nowrap" class="ft6012">Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#60">5.4)</a>.</p>
<p style="position:absolute;top:650px;left:227px;white-space:nowrap" class="ft60113">TM</p>
<p style="position:absolute;top:650px;left:258px;white-space:nowrap" class="ft6012">now&#160;holds</p>
<p style="position:absolute;top:650px;left:324px;white-space:nowrap" class="ft60113">rd</p>
<p style="position:absolute;top:655px;left:337px;white-space:nowrap" class="ft60114">TPM</p>
<p style="position:absolute;top:650px;left:368px;white-space:nowrap" class="ft6012">,</p>
<p style="position:absolute;top:650px;left:376px;white-space:nowrap" class="ft60113">K</p>
<p style="position:absolute;top:648px;left:390px;white-space:nowrap" class="ft60114">C</p>
<p style="position:absolute;top:657px;left:388px;white-space:nowrap" class="ft60114">enc</p>
<p style="position:absolute;top:650px;left:407px;white-space:nowrap" class="ft6012">,</p>
<p style="position:absolute;top:650px;left:415px;white-space:nowrap" class="ft60113">K</p>
<p style="position:absolute;top:648px;left:429px;white-space:nowrap" class="ft60114">C</p>
<p style="position:absolute;top:657px;left:427px;white-space:nowrap" class="ft60114">sign</p>
<p style="position:absolute;top:650px;left:450px;white-space:nowrap" class="ft6012">,</p>
<p style="position:absolute;top:650px;left:458px;white-space:nowrap" class="ft60113">PK</p>
<p style="position:absolute;top:648px;left:482px;white-space:nowrap" class="ft60114">C</p>
<p style="position:absolute;top:657px;left:480px;white-space:nowrap" class="ft60114">SKAE</p>
<p style="position:absolute;top:650px;left:520px;white-space:nowrap" class="ft6012">and</p>
<p style="position:absolute;top:650px;left:546px;white-space:nowrap" class="ft60113">Sig</p>
<p style="position:absolute;top:655px;left:566px;white-space:nowrap" class="ft60114">BSEK</p>
<p style="position:absolute;top:650px;left:601px;white-space:nowrap" class="ft6012">.&#160;Now,&#160;the</p>
<p style="position:absolute;top:668px;left:150px;white-space:nowrap" class="ft6012">system&#160;is&#160;initialized&#160;and&#160;ready&#160;to&#160;build&#160;up&#160;a&#160;Remote&#160;Trusted&#160;Channel.&#160;Subsequently,</p>
<p style="position:absolute;top:685px;left:150px;white-space:nowrap" class="ft60113">CM</p>
<p style="position:absolute;top:686px;left:180px;white-space:nowrap" class="ft6012">extends&#160;the&#160;CoT&#160;when&#160;a&#160;client&#160;compartment&#160;is&#160;loaded&#160;that&#160;runs&#160;on&#160;top&#160;of&#160;the&#160;TCB.</p>
<p style="position:absolute;top:745px;left:150px;white-space:nowrap" class="ft6044"><b>5.5.5</b></p>
<p style="position:absolute;top:745px;left:204px;white-space:nowrap" class="ft6044"><b>Adapted&#160;TLS&#160;Handshake</b></p>
<p style="position:absolute;top:775px;left:150px;white-space:nowrap" class="ft6015">In&#160;this&#160;Section&#160;we&#160;describe&#160;the&#160;linkage&#160;of&#160;integrity&#160;reporting&#160;to&#160;the&#160;TLS&#160;protocol.&#160;We<br/>designed&#160;our&#160;approach&#160;to&#160;be&#160;able&#160;to&#160;use&#160;all&#160;common&#160;TLS&#160;key&#160;exchange&#160;types&#160;like&#160;DH-<br/>RSA,&#160;RSA,&#160;DHE-RSA&#160;and&#160;DH-anon&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[19]</a>).&#160;In&#160;the&#160;following&#160;example&#160;the&#160;RSA&#160;key<br/>exchange&#160;will&#160;be&#160;applied&#160;in&#160;a&#160;mutual&#160;attestation&#160;scenario&#160;without&#160;need&#160;for&#160;privacy<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#60">.</a></p>
<p style="position:absolute;top:826px;left:642px;white-space:nowrap" class="ft6021"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#60">15</a></p>
<p style="position:absolute;top:869px;left:150px;white-space:nowrap" class="ft6017"><b>Negotiating&#160;Security&#160;Parameters:&#160;</b>To&#160;setup&#160;a&#160;Trusted&#160;Channel&#160;the</p>
<p style="position:absolute;top:868px;left:552px;white-space:nowrap" class="ft60113">TLS&#160;frontend</p>
<p style="position:absolute;top:869px;left:645px;white-space:nowrap" class="ft6012">(cf.</p>
<p style="position:absolute;top:887px;left:150px;white-space:nowrap" class="ft6015">Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#55">5.4.2)&#160;</a>requests&#160;the&#160;start&#160;of&#160;its&#160;back-end.&#160;Then&#160;the&#160;two&#160;parties&#160;involved&#160;in&#160;the<br/>communication&#160;negotiate&#160;the&#160;attributes&#160;of&#160;the&#160;Trusted&#160;Channel&#160;they&#160;want&#160;to&#160;establish<br/>(see&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#61">5.5)</a>.&#160;Those&#160;attributes&#160;are.&#160;e.g.,&#160;the&#160;cipher-suite&#160;that&#160;will&#160;be&#160;used&#160;or&#160;details<br/>concerning&#160;the&#160;configuration&#160;data&#160;that&#160;is&#160;exchanged.&#160;The</p>
<p style="position:absolute;top:940px;left:491px;white-space:nowrap" class="ft60113">TM</p>
<p style="position:absolute;top:941px;left:521px;white-space:nowrap" class="ft6012">on&#160;each&#160;side&#160;is&#160;responsi-</p>
<p style="position:absolute;top:958px;left:150px;white-space:nowrap" class="ft6012">ble&#160;for&#160;composing&#160;the</p>
<p style="position:absolute;top:958px;left:282px;white-space:nowrap" class="ft60113">AExt</p>
<p style="position:absolute;top:958px;left:319px;white-space:nowrap" class="ft6012">and&#160;fetching</p>
<p style="position:absolute;top:958px;left:396px;white-space:nowrap" class="ft60113">nonce</p>
<p style="position:absolute;top:956px;left:434px;white-space:nowrap" class="ft60114">C</p>
<p style="position:absolute;top:965px;left:433px;white-space:nowrap" class="ft60114">TPM</p>
<p style="position:absolute;top:958px;left:466px;white-space:nowrap" class="ft6012">from</p>
<p style="position:absolute;top:958px;left:499px;white-space:nowrap" class="ft60113">rd</p>
<p style="position:absolute;top:956px;left:513px;white-space:nowrap" class="ft60114">C</p>
<p style="position:absolute;top:965px;left:512px;white-space:nowrap" class="ft60114">TPM</p>
<p style="position:absolute;top:958px;left:542px;white-space:nowrap" class="ft6012">.&#160;Therefore,</p>
<p style="position:absolute;top:958px;left:616px;white-space:nowrap" class="ft60113">TM</p>
<p style="position:absolute;top:958px;left:645px;white-space:nowrap" class="ft6012">has</p>
<p style="position:absolute;top:976px;left:150px;white-space:nowrap" class="ft6015">to&#160;take&#160;care&#160;that&#160;the&#160;channel&#160;set-up&#160;respects&#160;platform&#160;and&#160;application&#160;policy&#160;provided<br/>by</p>
<p style="position:absolute;top:994px;left:168px;white-space:nowrap" class="ft60113">PM</p>
<p style="position:absolute;top:994px;left:195px;white-space:nowrap" class="ft6012">.</p>
<p style="position:absolute;top:1021px;left:162px;white-space:nowrap" class="ft6022">14</p>
<p style="position:absolute;top:1024px;left:171px;white-space:nowrap" class="ft6010">This&#160;is&#160;a&#160;small&#160;piece&#160;of&#160;code&#160;initiating&#160;the&#160;measurement&#160;process&#160;at&#160;the&#160;very&#160;beginning&#160;of&#160;the&#160;boot&#160;process.</p>
<p style="position:absolute;top:1038px;left:150px;white-space:nowrap" class="ft6010">Usually,&#160;this&#160;code&#160;is&#160;located&#160;within&#160;the&#160;BIOS.</p>
<p style="position:absolute;top:1050px;left:162px;white-space:nowrap" class="ft6022">15</p>
<p style="position:absolute;top:1052px;left:171px;white-space:nowrap" class="ft6010">Examples&#160;using&#160;different&#160;key&#160;exchange&#160;types&#160;are&#160;described&#160;in&#160;a&#160;technical&#160;report&#160;available&#160;at</p>
<p style="position:absolute;top:1067px;left:150px;white-space:nowrap" class="ft6067"><a href="http://www.trust.rub.de">http://www.trust.rub.de</a></p>
<p style="position:absolute;top:1066px;left:315px;white-space:nowrap" class="ft6010"><a href="http://www.trust.rub.de">.</a></p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft6018">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 61 -->
<a name="61"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page61-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL061.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft6112">CHAPTER&#160;5.&#160;TRUSTED&#160;CHANNELS&#160;WITH&#160;REMOTE&#160;INTEGRITY&#160;VERIFICATION59</p>
<p style="position:absolute;top:491px;left:343px;white-space:nowrap" class="ft6112">Figure&#160;5.5:&#160;Adapted&#160;TLS&#160;with&#160;Attestation&#160;Data</p>
<p style="position:absolute;top:539px;left:226px;white-space:nowrap" class="ft6115"><b>Configuration&#160;Exchange:&#160;</b>Every&#160;side&#160;provides&#160;evidence&#160;related&#160;to&#160;its&#160;configuration<br/>and&#160;integrity.&#160;On&#160;each&#160;side</p>
<p style="position:absolute;top:557px;left:396px;white-space:nowrap" class="ft61113">SupplementalData</p>
<p style="position:absolute;top:557px;left:520px;white-space:nowrap" class="ft6112">messages&#160;are&#160;composed&#160;for&#160;this&#160;pur-</p>
<p style="position:absolute;top:575px;left:226px;white-space:nowrap" class="ft6112">pose.&#160;Thus,&#160;the</p>
<p style="position:absolute;top:575px;left:325px;white-space:nowrap" class="ft61113">TM</p>
<p style="position:absolute;top:575px;left:356px;white-space:nowrap" class="ft6112">fetches&#160;platform&#160;credentials&#160;as&#160;well&#160;as&#160;those&#160;related&#160;to</p>
<p style="position:absolute;top:575px;left:690px;white-space:nowrap" class="ft61113">compID</p>
<p style="position:absolute;top:593px;left:226px;white-space:nowrap" class="ft6112">from&#160;storage&#160;using</p>
<p style="position:absolute;top:592px;left:343px;white-space:nowrap" class="ft61113">SM</p>
<p style="position:absolute;top:593px;left:372px;white-space:nowrap" class="ft6112">(cf.&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#55">5.4.2)</a>.&#160;The</p>
<p style="position:absolute;top:592px;left:519px;white-space:nowrap" class="ft61113">CM</p>
<p style="position:absolute;top:593px;left:550px;white-space:nowrap" class="ft6112">provides&#160;the&#160;current</p>
<p style="position:absolute;top:592px;left:674px;white-space:nowrap" class="ft61113">CDS</p>
<p style="position:absolute;top:593px;left:706px;white-space:nowrap" class="ft6112">.&#160;Fur-</p>
<p style="position:absolute;top:611px;left:226px;white-space:nowrap" class="ft6112">thermore,</p>
<p style="position:absolute;top:610px;left:289px;white-space:nowrap" class="ft61113">TM</p>
<p style="position:absolute;top:611px;left:320px;white-space:nowrap" class="ft6112">computes</p>
<p style="position:absolute;top:610px;left:382px;white-space:nowrap" class="ft61113">nonceSD</p>
<p style="position:absolute;top:611px;left:445px;white-space:nowrap" class="ft6112">and&#160;puts&#160;all&#160;those&#160;elements&#160;into&#160;the</p>
<p style="position:absolute;top:610px;left:664px;white-space:nowrap" class="ft61113">aD</p>
<p style="position:absolute;top:611px;left:689px;white-space:nowrap" class="ft6112">structure</p>
<p style="position:absolute;top:629px;left:226px;white-space:nowrap" class="ft6112">and&#160;signs&#160;it&#160;using</p>
<p style="position:absolute;top:628px;left:334px;white-space:nowrap" class="ft61113">SK</p>
<p style="position:absolute;top:634px;left:354px;white-space:nowrap" class="ft61114">sign</p>
<p style="position:absolute;top:629px;left:377px;white-space:nowrap" class="ft6112">.</p>
<p style="position:absolute;top:651px;left:226px;white-space:nowrap" class="ft6115"><b>Configuration&#160;Validation:&#160;</b>In&#160;this&#160;step&#160;every&#160;side&#160;evaluates&#160;the&#160;configuration&#160;of&#160;the<br/>counterpart.&#160;Therefore,&#160;the&#160;data&#160;received&#160;inside&#160;the</p>
<p style="position:absolute;top:669px;left:551px;white-space:nowrap" class="ft61113">SupplementalData</p>
<p style="position:absolute;top:669px;left:676px;white-space:nowrap" class="ft6112">message&#160;is</p>
<p style="position:absolute;top:687px;left:226px;white-space:nowrap" class="ft6112">analyzed&#160;and&#160;verified&#160;by</p>
<p style="position:absolute;top:687px;left:386px;white-space:nowrap" class="ft61113">TM</p>
<p style="position:absolute;top:687px;left:412px;white-space:nowrap" class="ft6112">.&#160;First,&#160;the</p>
<p style="position:absolute;top:687px;left:490px;white-space:nowrap" class="ft61113">SKAE</p>
<p style="position:absolute;top:687px;left:540px;white-space:nowrap" class="ft6112">is&#160;evaluated&#160;using&#160;either&#160;the&#160;op-</p>
<p style="position:absolute;top:705px;left:226px;white-space:nowrap" class="ft6112">tional</p>
<p style="position:absolute;top:705px;left:265px;white-space:nowrap" class="ft61113">cert</p>
<p style="position:absolute;top:710px;left:290px;white-space:nowrap" class="ft61114">SKAE</p>
<p style="position:absolute;top:705px;left:331px;white-space:nowrap" class="ft6112">or</p>
<p style="position:absolute;top:704px;left:348px;white-space:nowrap" class="ft6129">ref&#160;erence&#160;values</p>
<p style="position:absolute;top:705px;left:469px;white-space:nowrap" class="ft6112">and&#160;additional</p>
<p style="position:absolute;top:704px;left:561px;white-space:nowrap" class="ft6129">certif&#160;icates</p>
<p style="position:absolute;top:705px;left:645px;white-space:nowrap" class="ft6112">provided&#160;by&#160;the</p>
<p style="position:absolute;top:723px;left:226px;white-space:nowrap" class="ft6112">peer&#160;and/or&#160;trusted&#160;third&#160;parties.&#160;Subsequently,</p>
<p style="position:absolute;top:723px;left:525px;white-space:nowrap" class="ft61113">CDS</p>
<p style="position:absolute;top:723px;left:563px;white-space:nowrap" class="ft6112">is&#160;verified&#160;the&#160;same&#160;way&#160;and</p>
<p style="position:absolute;top:740px;left:226px;white-space:nowrap" class="ft61113">nonceSD</p>
<p style="position:absolute;top:738px;left:285px;white-space:nowrap" class="ft61114">S</p>
<p style="position:absolute;top:741px;left:299px;white-space:nowrap" class="ft6112">is&#160;compared&#160;to</p>
<p style="position:absolute;top:740px;left:396px;white-space:nowrap" class="ft61113">nonceSD</p>
<p style="position:absolute;top:738px;left:455px;white-space:nowrap" class="ft61114">C</p>
<p style="position:absolute;top:741px;left:466px;white-space:nowrap" class="ft6112">.&#160;Finally,</p>
<p style="position:absolute;top:740px;left:531px;white-space:nowrap" class="ft61113">Sig</p>
<p style="position:absolute;top:746px;left:550px;white-space:nowrap" class="ft61114">BSEK</p>
<p style="position:absolute;top:741px;left:592px;white-space:nowrap" class="ft6112">and</p>
<p style="position:absolute;top:740px;left:619px;white-space:nowrap" class="ft61113">Sig</p>
<p style="position:absolute;top:746px;left:638px;white-space:nowrap" class="ft61114">aD</p>
<p style="position:absolute;top:741px;left:661px;white-space:nowrap" class="ft6112">are&#160;inspected</p>
<p style="position:absolute;top:759px;left:226px;white-space:nowrap" class="ft6112">by</p>
<p style="position:absolute;top:758px;left:246px;white-space:nowrap" class="ft61113">TM</p>
<p style="position:absolute;top:759px;left:276px;white-space:nowrap" class="ft6112">using</p>
<p style="position:absolute;top:758px;left:313px;white-space:nowrap" class="ft61113">PK</p>
<p style="position:absolute;top:764px;left:335px;white-space:nowrap" class="ft61114">SKAE</p>
<p style="position:absolute;top:759px;left:375px;white-space:nowrap" class="ft6112">and</p>
<p style="position:absolute;top:758px;left:401px;white-space:nowrap" class="ft61113">PK</p>
<p style="position:absolute;top:764px;left:423px;white-space:nowrap" class="ft61114">sign</p>
<p style="position:absolute;top:759px;left:450px;white-space:nowrap" class="ft6112">of&#160;the&#160;counterpart.&#160;The</p>
<p style="position:absolute;top:758px;left:596px;white-space:nowrap" class="ft61113">cert</p>
<p style="position:absolute;top:764px;left:620px;white-space:nowrap" class="ft61114">TCLS</p>
<p style="position:absolute;top:759px;left:659px;white-space:nowrap" class="ft6112">is&#160;checked&#160;by</p>
<p style="position:absolute;top:777px;left:226px;white-space:nowrap" class="ft6115">the&#160;standard&#160;TLS&#160;software.&#160;If&#160;any&#160;signature&#160;check&#160;or&#160;configuration&#160;verification&#160;fails,<br/>communication&#160;is&#160;aborted&#160;issuing&#160;a&#160;corresponding&#160;TLS&#160;alert&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[19]</a>).&#160;The&#160;platform<br/>policy&#160;could&#160;allow&#160;the&#160;evaluation&#160;of&#160;the&#160;configuration&#160;evidence&#160;reported&#160;by&#160;the&#160;peer&#160;to<br/>be&#160;shifted&#160;or&#160;extended&#160;beyond&#160;the&#160;initial&#160;handshake.&#160;In&#160;some&#160;circumstances&#160;this&#160;may<br/>be&#160;desirable&#160;to&#160;further&#160;increase&#160;performance&#160;of&#160;the&#160;channel&#160;setup.</p>
<p style="position:absolute;top:871px;left:226px;white-space:nowrap" class="ft6117"><b>Computation&#160;of&#160;the&#160;Session&#160;Key:&#160;</b>The</p>
<p style="position:absolute;top:870px;left:475px;white-space:nowrap" class="ft6133">C</p>
<p style="position:absolute;top:871px;left:489px;white-space:nowrap" class="ft6112">sends&#160;random&#160;key&#160;material&#160;(</p>
<p style="position:absolute;top:871px;left:662px;white-space:nowrap" class="ft61113">rd</p>
<p style="position:absolute;top:876px;left:675px;white-space:nowrap" class="ft61114">SeK</p>
<p style="position:absolute;top:871px;left:699px;white-space:nowrap" class="ft6112">)&#160;taken</p>
<p style="position:absolute;top:889px;left:226px;white-space:nowrap" class="ft6112">from</p>
<p style="position:absolute;top:888px;left:259px;white-space:nowrap" class="ft61113">rd</p>
<p style="position:absolute;top:886px;left:274px;white-space:nowrap" class="ft61114">C</p>
<p style="position:absolute;top:896px;left:273px;white-space:nowrap" class="ft61114">TPM</p>
<p style="position:absolute;top:889px;left:307px;white-space:nowrap" class="ft6112">and&#160;encrypted&#160;using</p>
<p style="position:absolute;top:888px;left:432px;white-space:nowrap" class="ft61113">PK</p>
<p style="position:absolute;top:886px;left:456px;white-space:nowrap" class="ft61114">S</p>
<p style="position:absolute;top:895px;left:454px;white-space:nowrap" class="ft61114">enc</p>
<p style="position:absolute;top:889px;left:478px;white-space:nowrap" class="ft6112">representing&#160;the</p>
<p style="position:absolute;top:888px;left:578px;white-space:nowrap" class="ft6129">P&#160;reM&#160;asterSecret</p>
<p style="position:absolute;top:889px;left:702px;white-space:nowrap" class="ft6112">(PMS)</p>
<p style="position:absolute;top:907px;left:226px;white-space:nowrap" class="ft6112">to&#160;the&#160;server&#160;inside&#160;the</p>
<p style="position:absolute;top:906px;left:368px;white-space:nowrap" class="ft61113">ClientKeyExchange</p>
<p style="position:absolute;top:907px;left:500px;white-space:nowrap" class="ft6112">message.&#160;Furthermore,&#160;with&#160;the&#160;follow-</p>
<p style="position:absolute;top:925px;left:226px;white-space:nowrap" class="ft6112">ing</p>
<p style="position:absolute;top:924px;left:250px;white-space:nowrap" class="ft61113">CertificateVerify</p>
<p style="position:absolute;top:925px;left:363px;white-space:nowrap" class="ft6112">message&#160;the&#160;possession&#160;of</p>
<p style="position:absolute;top:924px;left:527px;white-space:nowrap" class="ft61113">SK</p>
<p style="position:absolute;top:922px;left:549px;white-space:nowrap" class="ft61114">C</p>
<p style="position:absolute;top:931px;left:547px;white-space:nowrap" class="ft61114">sign</p>
<p style="position:absolute;top:925px;left:575px;white-space:nowrap" class="ft6112">is&#160;proven,&#160;as&#160;well&#160;as</p>
<p style="position:absolute;top:924px;left:704px;white-space:nowrap" class="ft61113">rd</p>
<p style="position:absolute;top:930px;left:717px;white-space:nowrap" class="ft61114">SeK</p>
<p style="position:absolute;top:943px;left:226px;white-space:nowrap" class="ft6115">authenticated&#160;by&#160;signing&#160;a&#160;digest&#160;over&#160;all&#160;previously&#160;exchanged&#160;handshake&#160;messages<br/>(</p>
<p style="position:absolute;top:960px;left:231px;white-space:nowrap" class="ft6129">prev</p>
<p style="position:absolute;top:961px;left:260px;white-space:nowrap" class="ft6112">).&#160;The&#160;server&#160;in&#160;turn&#160;proves&#160;possession&#160;of</p>
<p style="position:absolute;top:960px;left:527px;white-space:nowrap" class="ft61113">SK</p>
<p style="position:absolute;top:958px;left:550px;white-space:nowrap" class="ft61114">S</p>
<p style="position:absolute;top:967px;left:547px;white-space:nowrap" class="ft61114">enc</p>
<p style="position:absolute;top:961px;left:572px;white-space:nowrap" class="ft6112">by&#160;decrypting&#160;PMS.&#160;Subse-</p>
<p style="position:absolute;top:978px;left:226px;white-space:nowrap" class="ft6112">quently,&#160;the&#160;Session&#160;Key&#160;(</p>
<p style="position:absolute;top:978px;left:391px;white-space:nowrap" class="ft61113">SeK</p>
<p style="position:absolute;top:978px;left:420px;white-space:nowrap" class="ft6112">)&#160;is&#160;derived&#160;from&#160;the&#160;same</p>
<p style="position:absolute;top:977px;left:592px;white-space:nowrap" class="ft6129">master&#160;secret</p>
<p style="position:absolute;top:978px;left:691px;white-space:nowrap" class="ft6112">(</p>
<p style="position:absolute;top:978px;left:696px;white-space:nowrap" class="ft61113">ms</p>
<p style="position:absolute;top:978px;left:716px;white-space:nowrap" class="ft6112">)&#160;on</p>
<p style="position:absolute;top:996px;left:226px;white-space:nowrap" class="ft6112">both&#160;peers&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[19,&#160;</a>p.24]).&#160;Finally,&#160;key&#160;exchange&#160;and&#160;handshake&#160;are&#160;finalized&#160;by&#160;the</p>
<p style="position:absolute;top:1014px;left:226px;white-space:nowrap" class="ft61113">ChangeCipherSpec</p>
<p style="position:absolute;top:1014px;left:351px;white-space:nowrap" class="ft6112">protocol&#160;and&#160;final</p>
<p style="position:absolute;top:1014px;left:460px;white-space:nowrap" class="ft61113">Finished</p>
<p style="position:absolute;top:1014px;left:520px;white-space:nowrap" class="ft6112">messages.&#160;These</p>
<p style="position:absolute;top:1014px;left:625px;white-space:nowrap" class="ft61113">Finished</p>
<p style="position:absolute;top:1014px;left:685px;white-space:nowrap" class="ft6112">messages</p>
<p style="position:absolute;top:1032px;left:226px;white-space:nowrap" class="ft6112">are&#160;already&#160;encrypted&#160;using</p>
<p style="position:absolute;top:1032px;left:394px;white-space:nowrap" class="ft61113">SeK</p>
<p style="position:absolute;top:1032px;left:423px;white-space:nowrap" class="ft6112">,&#160;thus,&#160;a&#160;failure&#160;in&#160;key&#160;exchange&#160;would&#160;be&#160;noticed&#160;(cf.</p>
<p style="position:absolute;top:1050px;left:226px;white-space:nowrap" class="ft6112"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[19,&#160;</a>p.51]).</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft6118">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 62 -->
<a name="62"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft62120{font-size:10px;font-family:CNTUYP+CMSY7;color:#000000;}
-->
</style>
<div id="page62-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL062.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft6212">60</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft6218">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:315px;left:299px;white-space:nowrap" class="ft6212">Figure&#160;5.6:&#160;OpenSSL&#160;enhancements</p>
<p style="position:absolute;top:404px;left:150px;white-space:nowrap" class="ft6244"><b>5.5.6</b></p>
<p style="position:absolute;top:404px;left:204px;white-space:nowrap" class="ft6244"><b>State&#160;Change</b></p>
<p style="position:absolute;top:434px;left:150px;white-space:nowrap" class="ft6215">In&#160;case&#160;the&#160;parties&#160;agreed&#160;on&#160;state&#160;change&#160;notification&#160;during&#160;the&#160;initial&#160;handshake&#160;the<br/>following&#160;procedure&#160;takes&#160;place:&#160;A&#160;state&#160;change&#160;on&#160;one&#160;platform&#160;is&#160;noticed&#160;by</p>
<p style="position:absolute;top:451px;left:616px;white-space:nowrap" class="ft62113">CM</p>
<p style="position:absolute;top:452px;left:646px;white-space:nowrap" class="ft6212">(an</p>
<p style="position:absolute;top:470px;left:150px;white-space:nowrap" class="ft6212">efficient&#160;monitoring&#160;agent&#160;assumed,&#160;cf.&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#55">5.4.2)</a>.</p>
<p style="position:absolute;top:469px;left:492px;white-space:nowrap" class="ft62113">TM</p>
<p style="position:absolute;top:470px;left:524px;white-space:nowrap" class="ft6212">can&#160;block&#160;access&#160;to&#160;the</p>
<p style="position:absolute;top:487px;left:150px;white-space:nowrap" class="ft62113">SeK</p>
<p style="position:absolute;top:488px;left:183px;white-space:nowrap" class="ft6212">and/or&#160;instruct</p>
<p style="position:absolute;top:487px;left:275px;white-space:nowrap" class="ft62113">SM</p>
<p style="position:absolute;top:488px;left:303px;white-space:nowrap" class="ft6212">to&#160;restrict&#160;access&#160;to&#160;data&#160;belonging&#160;to&#160;the&#160;session&#160;depending</p>
<p style="position:absolute;top:505px;left:150px;white-space:nowrap" class="ft6212">on&#160;the&#160;security&#160;policy&#160;of&#160;the&#160;application.&#160;Both&#160;sides&#160;are&#160;notified&#160;using</p>
<p style="position:absolute;top:505px;left:577px;white-space:nowrap" class="ft62113">HelloRequest</p>
<p style="position:absolute;top:505px;left:662px;white-space:nowrap" class="ft6212">,</p>
<p style="position:absolute;top:523px;left:150px;white-space:nowrap" class="ft62113">ClientHello</p>
<p style="position:absolute;top:523px;left:228px;white-space:nowrap" class="ft6212">and</p>
<p style="position:absolute;top:523px;left:253px;white-space:nowrap" class="ft62113">ServerHello</p>
<p style="position:absolute;top:523px;left:330px;white-space:nowrap" class="ft6212">,&#160;respectively.&#160;The&#160;updated</p>
<p style="position:absolute;top:523px;left:494px;white-space:nowrap" class="ft62113">CDS</p>
<p style="position:absolute;top:522px;left:527px;white-space:nowrap" class="ft62120">′</p>
<p style="position:absolute;top:523px;left:535px;white-space:nowrap" class="ft6212">for&#160;validating&#160;the&#160;new</p>
<p style="position:absolute;top:541px;left:150px;white-space:nowrap" class="ft6212">configuration&#160;is&#160;securely&#160;transmitted&#160;to&#160;the&#160;counterpart&#160;encrypted&#160;using</p>
<p style="position:absolute;top:541px;left:576px;white-space:nowrap" class="ft62113">SeK</p>
<p style="position:absolute;top:541px;left:608px;white-space:nowrap" class="ft6212">(since&#160;the</p>
<p style="position:absolute;top:559px;left:150px;white-space:nowrap" class="ft6212">Trusted&#160;Channel&#160;is&#160;still&#160;in&#160;place&#160;between&#160;the&#160;involved&#160;TCBs)&#160;and&#160;included&#160;in</p>
<p style="position:absolute;top:559px;left:619px;white-space:nowrap" class="ft62113">SCExt</p>
<p style="position:absolute;top:559px;left:662px;white-space:nowrap" class="ft6212">.</p>
<p style="position:absolute;top:577px;left:150px;white-space:nowrap" class="ft6215">Subsequently,&#160;a&#160;TLS&#160;resume&#160;message&#160;flow&#160;takes&#160;place&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[19]</a>).&#160;After&#160;the&#160;short&#160;TLS<br/>resume&#160;handshake&#160;the&#160;new&#160;session&#160;key</p>
<p style="position:absolute;top:595px;left:386px;white-space:nowrap" class="ft62113">SeK</p>
<p style="position:absolute;top:594px;left:415px;white-space:nowrap" class="ft62120">′</p>
<p style="position:absolute;top:595px;left:424px;white-space:nowrap" class="ft6212">is&#160;computed&#160;and&#160;the&#160;communication&#160;can</p>
<p style="position:absolute;top:613px;left:150px;white-space:nowrap" class="ft6215">continue,&#160;or&#160;the&#160;channel&#160;is&#160;torn-down&#160;because&#160;the&#160;requirements&#160;of&#160;the&#160;security&#160;policy<br/>of&#160;the&#160;peer&#160;are&#160;not&#160;fulfilled&#160;any&#160;longer&#160;(for&#160;details&#160;see&#160;Appendix&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#72">A.3)</a>.</p>
<p style="position:absolute;top:695px;left:150px;white-space:nowrap" class="ft6220"><b>5.6</b></p>
<p style="position:absolute;top:695px;left:198px;white-space:nowrap" class="ft6220"><b>Implementing&#160;a&#160;Trusted&#160;Channel&#160;with&#160;OpenSSL</b></p>
<p style="position:absolute;top:733px;left:150px;white-space:nowrap" class="ft6215">To&#160;implement&#160;a&#160;TLS-based&#160;Trusted&#160;Channel,&#160;we&#160;chose&#160;OpenSSL&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">[55]&#160;</a>as&#160;basis:&#160;this&#160;is<br/>a&#160;multi-platform&#160;and&#160;widespread&#160;software&#160;toolkit&#160;implementing&#160;cryptographic&#160;opera-<br/>tions.&#160;It&#160;consists&#160;of&#160;two&#160;shared&#160;libraries&#160;(</p>
<p style="position:absolute;top:769px;left:392px;white-space:nowrap" class="ft6259">libssl</p>
<p style="position:absolute;top:769px;left:450px;white-space:nowrap" class="ft6212">and</p>
<p style="position:absolute;top:769px;left:475px;white-space:nowrap" class="ft6259">libcrypto</p>
<p style="position:absolute;top:769px;left:556px;white-space:nowrap" class="ft6212">)&#160;implementing&#160;all</p>
<p style="position:absolute;top:787px;left:150px;white-space:nowrap" class="ft6212">OpenSSL&#160;features&#160;and&#160;a&#160;console&#160;command&#160;(</p>
<p style="position:absolute;top:787px;left:418px;white-space:nowrap" class="ft6259">openssl</p>
<p style="position:absolute;top:787px;left:481px;white-space:nowrap" class="ft6212">)&#160;wrapping&#160;them.&#160;The&#160;libraries</p>
<p style="position:absolute;top:804px;left:150px;white-space:nowrap" class="ft6212">can&#160;also&#160;be&#160;directly&#160;used&#160;by&#160;generic&#160;applications.</p>
<p style="position:absolute;top:822px;left:172px;white-space:nowrap" class="ft6212">We&#160;identified&#160;three&#160;different&#160;areas&#160;where&#160;OpenSSL&#160;needs&#160;enhancements:&#160;TLS&#160;ex-</p>
<p style="position:absolute;top:840px;left:150px;white-space:nowrap" class="ft6215">tension&#160;support,&#160;TC&#160;management&#160;and&#160;TC&#160;engine.&#160;These&#160;are&#160;represented&#160;in&#160;figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#62">5.6:<br/></a>the&#160;standard&#160;OpenSSL&#160;libraries&#160;and&#160;the&#160;first&#160;two&#160;enhancements&#160;together&#160;with&#160;a&#160;portion<br/>of&#160;the&#160;TC&#160;engine&#160;form&#160;the</p>
<p style="position:absolute;top:876px;left:310px;white-space:nowrap" class="ft62113">TLS&#160;frontend</p>
<p style="position:absolute;top:876px;left:403px;white-space:nowrap" class="ft6212">while&#160;the&#160;core&#160;of&#160;the&#160;engine&#160;implements&#160;the</p>
<p style="position:absolute;top:894px;left:150px;white-space:nowrap" class="ft62113">TLS&#160;backend</p>
<p style="position:absolute;top:894px;left:236px;white-space:nowrap" class="ft6212">.&#160;The&#160;implementation&#160;has&#160;been&#160;tested&#160;using&#160;a&#160;Proof&#160;of&#160;Concept&#160;proto-</p>
<p style="position:absolute;top:912px;left:150px;white-space:nowrap" class="ft6212">type.</p>
<p style="position:absolute;top:935px;left:150px;white-space:nowrap" class="ft6215"><b>TLS&#160;extensions</b>:&#160;The&#160;development&#160;version&#160;of&#160;OpenSSL&#160;(0.9.9x)&#160;includes&#160;support&#160;for<br/>the&#160;extensions&#160;to</p>
<p style="position:absolute;top:952px;left:259px;white-space:nowrap" class="ft62113">ClientHello</p>
<p style="position:absolute;top:952px;left:338px;white-space:nowrap" class="ft6212">and</p>
<p style="position:absolute;top:952px;left:365px;white-space:nowrap" class="ft62113">ServerHello</p>
<p style="position:absolute;top:952px;left:447px;white-space:nowrap" class="ft6212">messages&#160;defined&#160;in&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[19]&#160;</a>which&#160;are</p>
<p style="position:absolute;top:970px;left:150px;white-space:nowrap" class="ft6215">hard-coded.&#160;We&#160;implemented&#160;a&#160;mechanism&#160;to&#160;easily&#160;add&#160;generic&#160;user-defined&#160;exten-<br/>sions&#160;to&#160;these&#160;messages.&#160;The&#160;new&#160;extensions&#160;are&#160;handled&#160;through&#160;callback&#160;functions<br/>implemented&#160;and&#160;registered&#160;by&#160;the&#160;calling&#160;application&#160;or&#160;library.&#160;This&#160;mechanism&#160;has<br/>then&#160;been&#160;used&#160;to&#160;implement&#160;the&#160;Hello&#160;extensions</p>
<p style="position:absolute;top:1024px;left:461px;white-space:nowrap" class="ft62113">AExt</p>
<p style="position:absolute;top:1024px;left:501px;white-space:nowrap" class="ft6212">and</p>
<p style="position:absolute;top:1024px;left:527px;white-space:nowrap" class="ft62113">SCExt</p>
<p style="position:absolute;top:1024px;left:575px;white-space:nowrap" class="ft6212">that&#160;trigger&#160;the</p>
<p style="position:absolute;top:1042px;left:150px;white-space:nowrap" class="ft6212">delivery&#160;of&#160;the</p>
<p style="position:absolute;top:1042px;left:240px;white-space:nowrap" class="ft62113">SupplementalData</p>
<p style="position:absolute;top:1042px;left:363px;white-space:nowrap" class="ft6212">handshake&#160;message&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[66]</a>.&#160;Not&#160;originally&#160;supported</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft6218">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 63 -->
<a name="63"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page63-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL063.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft6312">CHAPTER&#160;5.&#160;TRUSTED&#160;CHANNELS&#160;WITH&#160;REMOTE&#160;INTEGRITY&#160;VERIFICATION61</p>
<p style="position:absolute;top:351px;left:367px;white-space:nowrap" class="ft6312">Figure&#160;5.7:&#160;Proof&#160;of&#160;Concept&#160;prototype</p>
<p style="position:absolute;top:399px;left:226px;white-space:nowrap" class="ft6315">by&#160;OpenSSL,&#160;this&#160;is&#160;a&#160;new&#160;hard-coded&#160;message&#160;added&#160;to&#160;carry&#160;the&#160;proper&#160;attestation<br/>data.&#160;All&#160;enhancements&#160;are&#160;implemented&#160;as&#160;patches&#160;to&#160;source&#160;code&#160;of</p>
<p style="position:absolute;top:418px;left:642px;white-space:nowrap" class="ft6359">libssl</p>
<p style="position:absolute;top:417px;left:699px;white-space:nowrap" class="ft6312">library.</p>
<p style="position:absolute;top:440px;left:226px;white-space:nowrap" class="ft6315"><b>TC&#160;management&#160;module</b>:&#160;This&#160;is&#160;a&#160;completely&#160;new&#160;module&#160;that&#160;contains&#160;the&#160;logic&#160;of<br/>the&#160;TC-specific&#160;operations.&#160;Indeed&#160;it&#160;deals&#160;with&#160;all&#160;operations&#160;bound&#160;to&#160;the&#160;attestation-<br/>related&#160;extensions.&#160;It&#160;also&#160;handles&#160;the&#160;parsing&#160;and&#160;the&#160;validation&#160;of&#160;the&#160;credentials<br/>received&#160;during&#160;the&#160;handshake&#160;(</p>
<p style="position:absolute;top:493px;left:419px;white-space:nowrap" class="ft63113">PK</p>
<p style="position:absolute;top:498px;left:441px;white-space:nowrap" class="ft63114">AIK</p>
<p style="position:absolute;top:494px;left:466px;white-space:nowrap" class="ft6312">,</p>
<p style="position:absolute;top:493px;left:474px;white-space:nowrap" class="ft63113">PK</p>
<p style="position:absolute;top:498px;left:496px;white-space:nowrap" class="ft63114">sign</p>
<p style="position:absolute;top:494px;left:524px;white-space:nowrap" class="ft6312">and</p>
<p style="position:absolute;top:493px;left:550px;white-space:nowrap" class="ft63113">PK</p>
<p style="position:absolute;top:498px;left:571px;white-space:nowrap" class="ft63114">enc</p>
<p style="position:absolute;top:494px;left:591px;white-space:nowrap" class="ft6312">)&#160;and&#160;it&#160;manages&#160;the&#160;val-</p>
<p style="position:absolute;top:512px;left:226px;white-space:nowrap" class="ft6315">idation&#160;of&#160;the&#160;attestation&#160;data.&#160;To&#160;perform&#160;some&#160;of&#160;these&#160;operations,&#160;the&#160;TC&#160;engine&#160;is<br/>also&#160;used.&#160;Finally&#160;it&#160;provides&#160;the&#160;application&#160;with&#160;an&#160;interface&#160;to&#160;set&#160;up&#160;the&#160;Trusted<br/>Channel.</p>
<p style="position:absolute;top:570px;left:226px;white-space:nowrap" class="ft6317"><b>TC&#160;engine</b>:</p>
<p style="position:absolute;top:570px;left:316px;white-space:nowrap" class="ft6312">We&#160;implemented&#160;an&#160;OpenSSL&#160;engine&#160;split&#160;into&#160;two&#160;parts.</p>
<p style="position:absolute;top:570px;left:718px;white-space:nowrap" class="ft6312">The</p>
<p style="position:absolute;top:587px;left:226px;white-space:nowrap" class="ft63113">TLS&#160;frontend</p>
<p style="position:absolute;top:588px;left:321px;white-space:nowrap" class="ft6312">runs&#160;in&#160;the&#160;application&#160;(or&#160;proxy)&#160;memory&#160;space&#160;and&#160;it&#160;is&#160;the&#160;actual</p>
<p style="position:absolute;top:606px;left:226px;white-space:nowrap" class="ft6312">engine&#160;module&#160;loaded&#160;by&#160;OpenSSL.&#160;The</p>
<p style="position:absolute;top:605px;left:474px;white-space:nowrap" class="ft63113">TLS&#160;backend</p>
<p style="position:absolute;top:606px;left:564px;white-space:nowrap" class="ft6312">is&#160;the&#160;core&#160;of&#160;the&#160;engine&#160;actu-</p>
<p style="position:absolute;top:624px;left:226px;white-space:nowrap" class="ft6315">ally&#160;implementing&#160;the&#160;functions&#160;needed&#160;by&#160;TLS&#160;protocol,&#160;it&#160;is&#160;part&#160;of&#160;the&#160;TCB&#160;and&#160;it<br/>runs&#160;in&#160;a&#160;different&#160;compartment.</p>
<p style="position:absolute;top:664px;left:226px;white-space:nowrap" class="ft6312">When&#160;the&#160;library&#160;implementing&#160;TLS&#160;(</p>
<p style="position:absolute;top:665px;left:454px;white-space:nowrap" class="ft6359">libssl</p>
<p style="position:absolute;top:664px;left:508px;white-space:nowrap" class="ft6312">)&#160;needs&#160;to&#160;use&#160;one&#160;of&#160;the&#160;functions&#160;pro-</p>
<p style="position:absolute;top:682px;left:226px;white-space:nowrap" class="ft6315">vided&#160;by&#160;the&#160;engine,&#160;it&#160;invokes&#160;the&#160;front-end&#160;engine’s&#160;registered&#160;functions.&#160;The&#160;front-<br/>end&#160;does&#160;not&#160;implement&#160;the&#160;cryptographic&#160;functions,&#160;therefore&#160;it&#160;forwards&#160;the&#160;requests<br/>over&#160;a&#160;communication&#160;channel&#160;to&#160;the&#160;back-end&#160;which&#160;handles&#160;them.</p>
<p style="position:absolute;top:740px;left:226px;white-space:nowrap" class="ft6315"><b>Proof&#160;of&#160;Concept&#160;prototype&#160;</b>We&#160;built&#160;a&#160;Proof&#160;of&#160;Concept&#160;prototype&#160;of&#160;the&#160;OpenSSL<br/>split&#160;based&#160;on&#160;Xen,&#160;whose&#160;architecture&#160;is&#160;represented&#160;in&#160;Figure&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#63">5.7.&#160;</a>The&#160;back-end&#160;of&#160;the<br/>TC&#160;engine&#160;runs&#160;in&#160;Domain0,&#160;the&#160;Xen&#160;privileged&#160;domain,&#160;and&#160;implements&#160;the&#160;features&#160;of<br/>the&#160;Trust&#160;Manager.&#160;It&#160;uses&#160;TrouSerS,&#160;an&#160;open&#160;source&#160;TCG&#160;Software&#160;Stack&#160;(TSS)&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#80">[75]</a>,<br/>to&#160;access&#160;the&#160;TPM&#160;capabilities.&#160;The&#160;communication&#160;channel&#160;between</p>
<p style="position:absolute;top:811px;left:652px;white-space:nowrap" class="ft63113">TLS&#160;frontend</p>
<p style="position:absolute;top:830px;left:226px;white-space:nowrap" class="ft6312">and</p>
<p style="position:absolute;top:829px;left:252px;white-space:nowrap" class="ft63113">TLS&#160;backend</p>
<p style="position:absolute;top:830px;left:342px;white-space:nowrap" class="ft6312">is&#160;currently&#160;a&#160;TCP-based&#160;protocol.&#160;The&#160;back-end&#160;of&#160;the&#160;TC&#160;engine</p>
<p style="position:absolute;top:848px;left:226px;white-space:nowrap" class="ft6315">can&#160;be&#160;decomposed&#160;in:&#160;(1)&#160;server-side&#160;stub,&#160;the&#160;endpoint&#160;for&#160;the&#160;communication&#160;with<br/>the&#160;front-end,&#160;(2)&#160;the&#160;Trusted&#160;Platform&#160;Agent&#160;(TPA<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#63">)</a></p>
<p style="position:absolute;top:863px;left:532px;white-space:nowrap" class="ft6321"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#63">16</a></p>
<p style="position:absolute;top:866px;left:546px;white-space:nowrap" class="ft6312">in&#160;charge&#160;of&#160;dealing&#160;with&#160;the&#160;life-</p>
<p style="position:absolute;top:884px;left:226px;white-space:nowrap" class="ft6315">cycle&#160;management&#160;of&#160;all&#160;credentials&#160;and&#160;implementing&#160;a&#160;minimal&#160;Storage&#160;Manager&#160;and<br/>(3)&#160;a&#160;software&#160;engine&#160;that&#160;performs&#160;all&#160;cryptographic&#160;operations&#160;during&#160;the&#160;handshake<br/>and&#160;the&#160;TLS&#160;session&#160;(we&#160;chose&#160;to&#160;use&#160;the&#160;OpenSSL&#160;library</p>
<p style="position:absolute;top:920px;left:581px;white-space:nowrap" class="ft6359">libcrypto</p>
<p style="position:absolute;top:919px;left:662px;white-space:nowrap" class="ft6312">).</p>
<p style="position:absolute;top:942px;left:226px;white-space:nowrap" class="ft6312">The&#160;verification&#160;of&#160;the&#160;attestation&#160;data&#160;carried&#160;through&#160;the</p>
<p style="position:absolute;top:941px;left:569px;white-space:nowrap" class="ft63113">SupplementalData</p>
<p style="position:absolute;top:942px;left:691px;white-space:nowrap" class="ft6312">message</p>
<p style="position:absolute;top:960px;left:226px;white-space:nowrap" class="ft6315">is&#160;a&#160;task&#160;under&#160;control&#160;of&#160;the&#160;application&#160;via&#160;TC&#160;management&#160;library:&#160;it&#160;can&#160;be&#160;directly<br/>performed&#160;by&#160;the&#160;application&#160;or&#160;delegated&#160;to&#160;the&#160;TPA.</p>
<p style="position:absolute;top:1024px;left:238px;white-space:nowrap" class="ft6322">16</p>
<p style="position:absolute;top:1026px;left:247px;white-space:nowrap" class="ft6310">TPA&#160;is&#160;a&#160;component&#160;developed&#160;within&#160;the&#160;OpenTC&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">[54]&#160;</a>project</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft6318">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 64 -->
<a name="64"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page64-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL064.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft6412">62</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft6418">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:189px;left:150px;white-space:nowrap" class="ft6420"><b>5.7</b></p>
<p style="position:absolute;top:189px;left:198px;white-space:nowrap" class="ft6420"><b>Security&#160;Considerations</b></p>
<p style="position:absolute;top:227px;left:150px;white-space:nowrap" class="ft6415">Here&#160;we&#160;do&#160;a&#160;short&#160;reevaluation&#160;of&#160;the&#160;security&#160;requirements&#160;adopted&#160;from&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[28]&#160;</a>and<br/>presented&#160;in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#52">5.2.1&#160;</a>with&#160;regard&#160;to&#160;our&#160;new&#160;approach.</p>
<p style="position:absolute;top:285px;left:157px;white-space:nowrap" class="ft6417"><b>(SR1)&#160;Secure&#160;channel&#160;properties:&#160;</b>TLS&#160;provides&#160;secure&#160;channel&#160;properties&#160;during</p>
<p style="position:absolute;top:303px;left:180px;white-space:nowrap" class="ft6415">transmission&#160;over&#160;insecure&#160;networks.&#160;On&#160;the&#160;endpoints&#160;the&#160;TCB&#160;offers&#160;those&#160;prop-<br/>erties.&#160;Confidentiality&#160;and&#160;integrity&#160;are&#160;provided&#160;by&#160;trusted&#160;initialization,&#160;isolation<br/>of&#160;the&#160;TCB&#160;and&#160;platform&#160;monitoring.&#160;The&#160;TCB&#160;also&#160;takes&#160;care&#160;of&#160;authenticity&#160;and<br/>freshness&#160;by&#160;securely&#160;storing&#160;nonces&#160;and&#160;session&#160;keys.&#160;As&#160;a&#160;result&#160;of&#160;platform<br/>monitoring&#160;every&#160;manipulation&#160;of&#160;a&#160;compartment&#160;is&#160;noticed&#160;and&#160;access&#160;to&#160;sensi-<br/>tive&#160;data&#160;can&#160;be&#160;barred&#160;if&#160;necessary&#160;to&#160;ensure&#160;the&#160;security&#160;properties.&#160;Furthermore,<br/>SM&#160;provides&#160;trusted&#160;storage&#160;that&#160;can&#160;preserve&#160;secure&#160;channel&#160;properties&#160;in&#160;case<br/>that&#160;data&#160;is&#160;stored&#160;persistently.</p>
<p style="position:absolute;top:451px;left:157px;white-space:nowrap" class="ft6417"><b>(SR2)&#160;Authentic&#160;linkage&#160;of&#160;configuration&#160;information&#160;and&#160;secure&#160;channel:&#160;</b>Au-</p>
<p style="position:absolute;top:469px;left:180px;white-space:nowrap" class="ft6412">thenticity&#160;of&#160;communication&#160;is&#160;guaranteed&#160;by&#160;providing&#160;the</p>
<p style="position:absolute;top:469px;left:537px;white-space:nowrap" class="ft64113">cert</p>
<p style="position:absolute;top:474px;left:561px;white-space:nowrap" class="ft64114">TCLS</p>
<p style="position:absolute;top:469px;left:598px;white-space:nowrap" class="ft6412">that&#160;is&#160;used</p>
<p style="position:absolute;top:487px;left:180px;white-space:nowrap" class="ft6415">to&#160;authenticate&#160;the&#160;endpoints&#160;(cf.&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#60">5.5.5)</a>.&#160;The&#160;secure&#160;linkage&#160;of&#160;con-<br/>figuration&#160;information&#160;to&#160;the&#160;endpoints&#160;is&#160;verified&#160;by&#160;evaluating&#160;the</p>
<p style="position:absolute;top:504px;left:600px;white-space:nowrap" class="ft64113">SKAE</p>
<p style="position:absolute;top:505px;left:648px;white-space:nowrap" class="ft6412">(or</p>
<p style="position:absolute;top:522px;left:180px;white-space:nowrap" class="ft64113">cert</p>
<p style="position:absolute;top:528px;left:204px;white-space:nowrap" class="ft64114">SKAE</p>
<p style="position:absolute;top:523px;left:240px;white-space:nowrap" class="ft6412">),</p>
<p style="position:absolute;top:522px;left:252px;white-space:nowrap" class="ft64113">Sig</p>
<p style="position:absolute;top:528px;left:272px;white-space:nowrap" class="ft64114">BSEK</p>
<p style="position:absolute;top:523px;left:311px;white-space:nowrap" class="ft6412">and</p>
<p style="position:absolute;top:522px;left:336px;white-space:nowrap" class="ft64113">Sig</p>
<p style="position:absolute;top:528px;left:356px;white-space:nowrap" class="ft64114">aD</p>
<p style="position:absolute;top:523px;left:373px;white-space:nowrap" class="ft6412">.</p>
<p style="position:absolute;top:545px;left:180px;white-space:nowrap" class="ft6412">We&#160;assume&#160;a&#160;secure&#160;as&#160;well&#160;as&#160;specification&#160;conformant&#160;creation&#160;of</p>
<p style="position:absolute;top:545px;left:577px;white-space:nowrap" class="ft64113">K</p>
<p style="position:absolute;top:550px;left:588px;white-space:nowrap" class="ft64114">storage</p>
<p style="position:absolute;top:545px;left:631px;white-space:nowrap" class="ft6412">(Stor-</p>
<p style="position:absolute;top:563px;left:180px;white-space:nowrap" class="ft6412">age&#160;Root&#160;Key)&#160;and</p>
<p style="position:absolute;top:562px;left:295px;white-space:nowrap" class="ft6429">AIK</p>
<p style="position:absolute;top:563px;left:328px;white-space:nowrap" class="ft6412">.&#160;We&#160;further&#160;assume&#160;that&#160;a&#160;TCB&#160;whose&#160;configuration&#160;has</p>
<p style="position:absolute;top:581px;left:180px;white-space:nowrap" class="ft6415">been&#160;evaluated&#160;by&#160;the&#160;counterpart&#160;is&#160;able&#160;to&#160;reliably&#160;transfer&#160;configuration&#160;infor-<br/>mation&#160;related&#160;to&#160;the&#160;client&#160;compartments&#160;and&#160;takes&#160;care&#160;of&#160;the&#160;secure&#160;storage&#160;and<br/>application&#160;of&#160;the&#160;keys&#160;used&#160;within&#160;the&#160;handshake.&#160;A&#160;possibility&#160;for&#160;the&#160;retrieval<br/>of&#160;CA&#160;keys&#160;for&#160;verification&#160;of&#160;signatures&#160;is&#160;also&#160;anticipated.</p>
<p style="position:absolute;top:657px;left:180px;white-space:nowrap" class="ft6415">After&#160;a&#160;successful&#160;evaluation&#160;of&#160;the&#160;credentials&#160;transferred&#160;the&#160;following&#160;state-<br/>ments&#160;can&#160;be&#160;made:&#160;All&#160;keys&#160;are&#160;bound&#160;to&#160;the&#160;same&#160;TCB.&#160;This&#160;TCB&#160;is&#160;specified<br/>by&#160;measurement&#160;values&#160;incorporated&#160;in</p>
<p style="position:absolute;top:693px;left:427px;white-space:nowrap" class="ft64113">SKAE</p>
<p style="position:absolute;top:693px;left:470px;white-space:nowrap" class="ft6412">.&#160;Thus,&#160;the</p>
<p style="position:absolute;top:692px;left:546px;white-space:nowrap" class="ft6429">properties</p>
<p style="position:absolute;top:693px;left:620px;white-space:nowrap" class="ft6412">and&#160;the</p>
<p style="position:absolute;top:710px;left:180px;white-space:nowrap" class="ft6429">Changelog</p>
<p style="position:absolute;top:711px;left:255px;white-space:nowrap" class="ft6412">sent&#160;have&#160;to&#160;originate&#160;from&#160;this&#160;TCB&#160;because</p>
<p style="position:absolute;top:711px;left:527px;white-space:nowrap" class="ft64113">SK</p>
<p style="position:absolute;top:716px;left:547px;white-space:nowrap" class="ft64114">sign</p>
<p style="position:absolute;top:711px;left:574px;white-space:nowrap" class="ft6412">is&#160;sealed&#160;to&#160;this</p>
<p style="position:absolute;top:729px;left:180px;white-space:nowrap" class="ft6412">TCB&#160;and&#160;signed&#160;by</p>
<p style="position:absolute;top:729px;left:305px;white-space:nowrap" class="ft64113">SK</p>
<p style="position:absolute;top:734px;left:325px;white-space:nowrap" class="ft64114">SKAE</p>
<p style="position:absolute;top:729px;left:360px;white-space:nowrap" class="ft6412">.&#160;Hence,&#160;key&#160;material&#160;sent&#160;to</p>
<p style="position:absolute;top:728px;left:546px;white-space:nowrap" class="ft6433">S</p>
<p style="position:absolute;top:729px;left:561px;white-space:nowrap" class="ft6412">necessary&#160;for&#160;the</p>
<p style="position:absolute;top:747px;left:180px;white-space:nowrap" class="ft6412">computation&#160;of&#160;the&#160;session&#160;key</p>
<p style="position:absolute;top:747px;left:377px;white-space:nowrap" class="ft64113">SeK</p>
<p style="position:absolute;top:747px;left:411px;white-space:nowrap" class="ft6412">is&#160;only&#160;available&#160;to&#160;this&#160;specific&#160;TCB&#160;be-</p>
<p style="position:absolute;top:765px;left:180px;white-space:nowrap" class="ft6412">cause</p>
<p style="position:absolute;top:765px;left:218px;white-space:nowrap" class="ft64113">SK</p>
<p style="position:absolute;top:770px;left:238px;white-space:nowrap" class="ft64114">enc</p>
<p style="position:absolute;top:765px;left:262px;white-space:nowrap" class="ft6412">is&#160;also&#160;sealed&#160;to&#160;this&#160;TCB&#160;and&#160;signed&#160;by</p>
<p style="position:absolute;top:765px;left:514px;white-space:nowrap" class="ft64113">SK</p>
<p style="position:absolute;top:770px;left:534px;white-space:nowrap" class="ft64114">SKAE</p>
<p style="position:absolute;top:765px;left:570px;white-space:nowrap" class="ft6412">.&#160;The</p>
<p style="position:absolute;top:765px;left:609px;white-space:nowrap" class="ft64113">Finished</p>
<p style="position:absolute;top:783px;left:180px;white-space:nowrap" class="ft6412">message&#160;that&#160;is&#160;already&#160;encrypted&#160;using</p>
<p style="position:absolute;top:782px;left:422px;white-space:nowrap" class="ft64113">SeK</p>
<p style="position:absolute;top:783px;left:455px;white-space:nowrap" class="ft6412">assures&#160;authentication&#160;of&#160;endpoints</p>
<p style="position:absolute;top:801px;left:180px;white-space:nowrap" class="ft6415">and&#160;linkage&#160;of&#160;configuration&#160;information&#160;to&#160;the&#160;Trusted&#160;Channel&#160;(for&#160;details&#160;see<br/>Appendix&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#70">A.2)</a>.</p>
<p style="position:absolute;top:841px;left:180px;white-space:nowrap" class="ft64113">SeK</p>
<p style="position:absolute;top:841px;left:209px;white-space:nowrap" class="ft6412">,</p>
<p style="position:absolute;top:841px;left:218px;white-space:nowrap" class="ft64113">K</p>
<p style="position:absolute;top:846px;left:230px;white-space:nowrap" class="ft64114">sign</p>
<p style="position:absolute;top:841px;left:258px;white-space:nowrap" class="ft6412">and</p>
<p style="position:absolute;top:841px;left:285px;white-space:nowrap" class="ft64113">K</p>
<p style="position:absolute;top:846px;left:296px;white-space:nowrap" class="ft64114">enc</p>
<p style="position:absolute;top:841px;left:321px;white-space:nowrap" class="ft6412">are&#160;kept&#160;inside&#160;the&#160;TCB&#160;during&#160;the&#160;whole&#160;session.&#160;Due</p>
<p style="position:absolute;top:859px;left:180px;white-space:nowrap" class="ft6415">to&#160;the&#160;strong&#160;isolation&#160;property&#160;of&#160;the&#160;TCB&#160;those&#160;keys&#160;cannot&#160;be&#160;disclosed&#160;to<br/>compartments&#160;running&#160;on&#160;the&#160;same&#160;TCB&#160;or&#160;to&#160;other&#160;platforms.&#160;Relay&#160;attacks<br/>as&#160;well&#160;as&#160;attacks&#160;to&#160;obtain&#160;any&#160;keys&#160;establishing&#160;the&#160;Trusted&#160;Channel&#160;are&#160;not<br/>feasible&#160;assumed&#160;that&#160;no&#160;hardware&#160;attacks&#160;are&#160;applied&#160;because&#160;the&#160;TPM&#160;is&#160;only<br/>considered&#160;secure&#160;against&#160;software&#160;attacks.&#160;Thus,&#160;the&#160;disclosure&#160;of&#160;keys&#160;like</p>
<p style="position:absolute;top:930px;left:634px;white-space:nowrap" class="ft64113">K</p>
<p style="position:absolute;top:936px;left:646px;white-space:nowrap" class="ft64114">enc</p>
<p style="position:absolute;top:949px;left:180px;white-space:nowrap" class="ft6415">is&#160;very&#160;unlikely&#160;to&#160;happen&#160;but&#160;as&#160;a&#160;fallback&#160;mechanism&#160;revocation&#160;lists&#160;have&#160;to&#160;be<br/>maintained.</p>
<p style="position:absolute;top:989px;left:157px;white-space:nowrap" class="ft6417"><b>(SR3)&#160;Privacy:&#160;</b>With&#160;regard&#160;to&#160;configuration&#160;data&#160;transmitted&#160;we&#160;decided&#160;to&#160;provide</p>
<p style="position:absolute;top:1007px;left:180px;white-space:nowrap" class="ft6415">a&#160;possibility&#160;to&#160;send&#160;it&#160;encrypted&#160;to&#160;protect&#160;potentially&#160;sensitive&#160;data&#160;(see&#160;Sec-<br/>tion&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#59">5.5.3)</a>.&#160;Only&#160;the&#160;configuration&#160;of&#160;TCB&#160;and&#160;the&#160;TLS&#160;client&#160;compartments&#160;is<br/>reported&#160;to&#160;the&#160;peer&#160;keeping&#160;the&#160;information&#160;disclosed&#160;to&#160;the&#160;other&#160;platform&#160;as<br/>minimal&#160;as&#160;possible,&#160;in&#160;contrast&#160;to&#160;other&#160;approaches&#160;where&#160;the&#160;configuration&#160;of</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft6418">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 65 -->
<a name="65"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page65-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL065.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft6512">CHAPTER&#160;5.&#160;TRUSTED&#160;CHANNELS&#160;WITH&#160;REMOTE&#160;INTEGRITY&#160;VERIFICATION63</p>
<p style="position:absolute;top:193px;left:256px;white-space:nowrap" class="ft6515">all&#160;components&#160;running&#160;on&#160;a&#160;platform&#160;is&#160;disclosed.&#160;Furthermore,&#160;every&#160;commu-<br/>nication&#160;partner&#160;can&#160;assess&#160;the&#160;trustworthiness&#160;of&#160;its&#160;counterpart&#160;and&#160;thus,&#160;make<br/>a&#160;judgment&#160;on&#160;whether&#160;it&#160;will&#160;treat&#160;personal&#160;information&#160;according&#160;to&#160;its&#160;security<br/>policy.</p>
<p style="position:absolute;top:316px;left:226px;white-space:nowrap" class="ft6520"><b>5.8</b></p>
<p style="position:absolute;top:316px;left:274px;white-space:nowrap" class="ft6520"><b>Functional&#160;Considerations</b></p>
<p style="position:absolute;top:354px;left:226px;white-space:nowrap" class="ft6515">To&#160;meet&#160;these&#160;functional&#160;requirements&#160;enlisted&#160;in&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#52">5.2.2&#160;</a>the&#160;following&#160;measures<br/>have&#160;been&#160;taken:</p>
<p style="position:absolute;top:412px;left:233px;white-space:nowrap" class="ft6517"><b>(FR1)&#160;Fast&#160;deployment&#160;possible:&#160;</b>To&#160;make&#160;a&#160;fast&#160;and&#160;wide-area&#160;deployment&#160;of&#160;our</p>
<p style="position:absolute;top:430px;left:256px;white-space:nowrap" class="ft6515">approach&#160;possible&#160;we&#160;decided&#160;to&#160;adapt&#160;TLS&#160;as&#160;a&#160;commonly&#160;used&#160;protocol&#160;to&#160;sup-<br/>port&#160;the&#160;exchange&#160;of&#160;endpoint&#160;configuration&#160;information.&#160;Furthermore&#160;we&#160;took&#160;an<br/>existing&#160;implementation&#160;(OpenSSL)&#160;of&#160;the&#160;TLS&#160;specification&#160;and&#160;adapted&#160;it&#160;to&#160;our<br/>needs.&#160;So&#160;the&#160;effort&#160;that&#160;has&#160;to&#160;be&#160;put&#160;into&#160;the&#160;implementation&#160;of&#160;our&#160;approach&#160;was<br/>moderate&#160;and&#160;will&#160;presumably&#160;be&#160;moderate&#160;for&#160;other&#160;existing&#160;TLS&#160;implementa-<br/>tions.&#160;Additionally,&#160;we&#160;only&#160;applied&#160;mechanisms&#160;and&#160;concepts&#160;already&#160;defined&#160;in<br/>existing&#160;specifications&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[72]</a>,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[74]</a>,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#80">[77]</a>,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#80">[76]</a>,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#80">[75]</a>,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[24]</a>,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[19]</a>,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[66]</a>).&#160;Thus,&#160;it&#160;is<br/>not&#160;necessary&#160;to&#160;go&#160;through&#160;a&#160;time-consuming&#160;specification&#160;process.&#160;Last&#160;but&#160;not<br/>least&#160;our&#160;new&#160;concept&#160;is&#160;able&#160;to&#160;support&#160;all&#160;common&#160;key&#160;exchange&#160;methods&#160;ap-<br/>plied&#160;within&#160;the&#160;TLS&#160;handshake.&#160;This&#160;is&#160;important&#160;keeping&#160;in&#160;mind&#160;that&#160;different<br/>key&#160;exchange&#160;methods&#160;are&#160;used&#160;in&#160;different&#160;scenarios.</p>
<p style="position:absolute;top:632px;left:233px;white-space:nowrap" class="ft6517"><b>(FR2)&#160;No&#160;additional&#160;costs&#160;are&#160;induced:&#160;</b>For&#160;the&#160;implementation&#160;of&#160;our&#160;concept</p>
<p style="position:absolute;top:649px;left:256px;white-space:nowrap" class="ft6515">we&#160;used&#160;commercial&#160;of-the-shelf&#160;hardware.&#160;Thus,&#160;no&#160;expensive&#160;cryptographic<br/>hardware&#160;is&#160;necessary.&#160;Only&#160;Open&#160;Source&#160;Software&#160;was&#160;used&#160;for&#160;the&#160;realization<br/>of&#160;the&#160;software&#160;part.&#160;The&#160;resulting&#160;code&#160;is&#160;available&#160;without&#160;charge&#160;and&#160;incurs<br/>no&#160;additional&#160;license&#160;costs&#160;for&#160;the&#160;user.&#160;In&#160;contrast&#160;to&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[28]&#160;</a>we&#160;also&#160;decoupled<br/>TLS&#160;certificates&#160;from&#160;the&#160;platform&#160;configuration&#160;information.&#160;This&#160;is&#160;an&#160;important<br/>issue&#160;because&#160;on&#160;the&#160;one&#160;hand&#160;re-certification&#160;of&#160;the&#160;TLS&#160;endpoint&#160;and&#160;its&#160;keys&#160;is<br/>expensive&#160;but&#160;on&#160;the&#160;other&#160;hand&#160;we&#160;want&#160;the&#160;keys&#160;to&#160;be&#160;securely&#160;bound&#160;to&#160;a&#160;specific<br/>platform&#160;configuration&#160;to&#160;be&#160;able&#160;to&#160;prove&#160;that&#160;they&#160;have&#160;not&#160;been&#160;compromised.<br/>We&#160;solved&#160;that&#160;problem&#160;by&#160;introducing&#160;a&#160;TCB&#160;update&#160;mechanism&#160;(cf.&#160;section<br/><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#57">5.5.1)&#160;</a>that&#160;enables&#160;the&#160;underlying&#160;TCB&#160;to&#160;be&#160;updated&#160;without&#160;losing&#160;track&#160;of&#160;the<br/>states&#160;the&#160;platform&#160;went&#160;through<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#65">.</a></p>
<p style="position:absolute;top:826px;left:452px;white-space:nowrap" class="ft6521"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#65">17</a></p>
<p style="position:absolute;top:829px;left:467px;white-space:nowrap" class="ft6512">This&#160;can&#160;be&#160;done&#160;by&#160;evaluating&#160;the</p>
<p style="position:absolute;top:828px;left:675px;white-space:nowrap" class="ft65113">changelog</p>
<p style="position:absolute;top:829px;left:738px;white-space:nowrap" class="ft6512">.</p>
<p style="position:absolute;top:847px;left:256px;white-space:nowrap" class="ft6515">Thus,&#160;it&#160;is&#160;always&#160;possible&#160;to&#160;verify&#160;if&#160;the&#160;keys&#160;may&#160;have&#160;been&#160;compromised&#160;by&#160;a<br/>previous&#160;insecure&#160;configuration&#160;of&#160;the&#160;platform&#160;and&#160;the&#160;peer&#160;can&#160;choose&#160;whether<br/>to&#160;trust&#160;or&#160;not&#160;to&#160;trust&#160;in&#160;the&#160;keys&#160;included&#160;in&#160;the&#160;TLS&#160;certificate.</p>
<p style="position:absolute;top:905px;left:233px;white-space:nowrap" class="ft6517"><b>(FR3)&#160;Minimal&#160;performance&#160;overhead&#160;during&#160;handshake:&#160;</b>To&#160;be&#160;able&#160;to&#160;have&#160;fast</p>
<p style="position:absolute;top:923px;left:256px;white-space:nowrap" class="ft6515">response&#160;times&#160;during&#160;the&#160;handshake&#160;we&#160;do&#160;not&#160;rely&#160;on&#160;the&#160;direct&#160;usage&#160;of&#160;the<br/>TPM.&#160;This&#160;would&#160;induce&#160;too&#160;much&#160;overhead&#160;since&#160;the&#160;TPM&#160;is&#160;only&#160;connected<br/>to&#160;an&#160;LPC-Bus&#160;that&#160;has&#160;only&#160;limited&#160;bandwidth&#160;and&#160;its&#160;processing&#160;power&#160;is&#160;also<br/>very&#160;restricted.&#160;So&#160;we&#160;decided&#160;to&#160;involve&#160;the&#160;TPM&#160;only&#160;at&#160;the&#160;initialization&#160;of&#160;the<br/>system&#160;to&#160;be&#160;sure&#160;that&#160;the&#160;TCB&#160;is&#160;well&#160;configured.&#160;From&#160;then&#160;on&#160;all&#160;functionality<br/>are&#160;provided&#160;by&#160;TCB&#160;software&#160;components.&#160;Measurements&#160;are&#160;stored&#160;and&#160;reported<br/>by&#160;those&#160;components,&#160;they&#160;keep&#160;track&#160;of&#160;the&#160;platform&#160;state&#160;and&#160;provide&#160;secure</p>
<p style="position:absolute;top:1057px;left:238px;white-space:nowrap" class="ft6522">17</p>
<p style="position:absolute;top:1060px;left:247px;white-space:nowrap" class="ft6510">In&#160;a&#160;microkernel&#160;approach&#160;for&#160;example&#160;the&#160;configuration&#160;of&#160;the&#160;TCB&#160;will&#160;change&#160;rather&#160;rarely&#160;while&#160;the</p>
<p style="position:absolute;top:1074px;left:226px;white-space:nowrap" class="ft6510">TCB&#160;of&#160;monolithic&#160;systems&#160;like&#160;Windows&#160;OS&#160;may&#160;change&#160;frequently.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft6518">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 66 -->
<a name="66"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page66-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL066.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft6612">64</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft6618">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:193px;left:180px;white-space:nowrap" class="ft6615">encryption&#160;and&#160;decryption&#160;routines.&#160;Thus,&#160;even&#160;in&#160;a&#160;server&#160;environment&#160;that&#160;has<br/>to&#160;be&#160;able&#160;to&#160;set&#160;up&#160;many&#160;TLS&#160;connections&#160;in&#160;a&#160;short&#160;period,&#160;fast&#160;response&#160;times<br/>are&#160;ensured.</p>
<p style="position:absolute;top:252px;left:157px;white-space:nowrap" class="ft6617"><b>(FR4)&#160;Flexible&#160;configuration&#160;reporting:&#160;</b>By&#160;incorporating&#160;the&#160;possibility&#160;to&#160;trans-</p>
<p style="position:absolute;top:270px;left:180px;white-space:nowrap" class="ft6615">fer&#160;whatever&#160;properties&#160;(e.g.,&#160;see&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#78">[59]</a>)&#160;one&#160;may&#160;want&#160;to&#160;provide,&#160;e.g.,&#160;certificates,<br/>hash&#160;values,&#160;signed&#160;configuration&#160;files&#160;or&#160;other&#160;credentials,&#160;we&#160;ensured&#160;interoper-<br/>ability&#160;with&#160;any&#160;existing&#160;attestation&#160;concept&#160;and&#160;safeguard&#160;forward&#160;compatibility<br/>of&#160;our&#160;concept.&#160;Thus,&#160;we&#160;exemplary&#160;showed&#160;that&#160;the&#160;TCG&#160;approach&#160;to&#160;use&#160;a</p>
<p style="position:absolute;top:342px;left:180px;white-space:nowrap" class="ft66118">TPM</p>
<p style="position:absolute;top:341px;left:204px;white-space:nowrap" class="ft6612">_</p>
<p style="position:absolute;top:342px;left:211px;white-space:nowrap" class="ft66118">Quote</p>
<p style="position:absolute;top:340px;left:250px;white-space:nowrap" class="ft6628">()</p>
<p style="position:absolute;top:341px;left:265px;white-space:nowrap" class="ft6612">(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#80">[77,&#160;</a>p.160])&#160;result&#160;as&#160;way&#160;to&#160;transfer&#160;configuration&#160;information</p>
<p style="position:absolute;top:359px;left:180px;white-space:nowrap" class="ft6612">is&#160;also&#160;usable&#160;within&#160;our&#160;approach&#160;(see&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#60">5.5.5)</a>.</p>
<p style="position:absolute;top:382px;left:157px;white-space:nowrap" class="ft6617"><b>(FR5)&#160;Backwards&#160;compatibility:&#160;</b>To&#160;be&#160;sure&#160;that&#160;also&#160;peers&#160;only&#160;supporting&#160;the</p>
<p style="position:absolute;top:400px;left:180px;white-space:nowrap" class="ft6615">normal&#160;TLS&#160;handshake&#160;can&#160;communicate&#160;with&#160;systems&#160;that&#160;use&#160;our&#160;concept,&#160;we<br/>kept&#160;the&#160;TLS&#160;certificate&#160;in&#160;its&#160;traditional&#160;form&#160;and&#160;used&#160;only&#160;TLS&#160;extensions&#160;to<br/>provide&#160;a&#160;Trusted&#160;Channel.&#160;Those&#160;extensions&#160;are&#160;per&#160;definition&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[24,&#160;</a>p.3])<br/>ignored&#160;if&#160;they&#160;are&#160;not&#160;supported.&#160;Thus,&#160;the&#160;peer&#160;that&#160;theoretically&#160;would&#160;support<br/>attestation&#160;extensions&#160;has&#160;to&#160;decide&#160;whether&#160;to&#160;continue&#160;with&#160;setting&#160;up&#160;a&#160;common<br/>TLS&#160;secure&#160;channel&#160;for&#160;a&#160;given&#160;purpose&#160;or&#160;breaking&#160;the&#160;connection&#160;for&#160;the&#160;reason<br/>of&#160;insufficient&#160;security.&#160;Furthermore&#160;we&#160;kept&#160;the&#160;whole&#160;implementation&#160;separated<br/>from&#160;the&#160;application&#160;layer&#160;offering&#160;a&#160;transparent&#160;usage&#160;of&#160;the&#160;Trusted&#160;Channel.<br/>Thus,&#160;applications&#160;do&#160;not&#160;have&#160;to&#160;be&#160;adapted&#160;to&#160;make&#160;use&#160;of&#160;our&#160;concept.</p>
<p style="position:absolute;top:612px;left:150px;white-space:nowrap" class="ft6620"><b>5.9</b></p>
<p style="position:absolute;top:612px;left:198px;white-space:nowrap" class="ft6620"><b>Summary</b></p>
<p style="position:absolute;top:649px;left:150px;white-space:nowrap" class="ft6615">In&#160;this&#160;paper&#160;we&#160;presented&#160;a&#160;security&#160;architecture&#160;as&#160;well&#160;as&#160;an&#160;adaptation&#160;of&#160;the&#160;TLS<br/>protocol&#160;to&#160;provide&#160;a&#160;Trusted&#160;Channel&#160;that&#160;combines&#160;the&#160;security&#160;features&#160;of&#160;a&#160;secure<br/>channel&#160;with&#160;the&#160;ability&#160;to&#160;reliably&#160;determine&#160;the&#160;trustworthiness&#160;of&#160;the&#160;communication<br/>endpoints.</p>
<p style="position:absolute;top:721px;left:172px;white-space:nowrap" class="ft6612">After&#160;a&#160;detailed&#160;description&#160;of&#160;our&#160;design&#160;and&#160;its&#160;implementation&#160;we&#160;showed&#160;that</p>
<p style="position:absolute;top:739px;left:150px;white-space:nowrap" class="ft6615">our&#160;approach&#160;is&#160;able&#160;to&#160;meet&#160;the&#160;strict&#160;requirements&#160;set&#160;in&#160;the&#160;beginning.&#160;By&#160;meeting<br/>these&#160;requirements&#160;we&#160;are&#160;able&#160;to&#160;provide&#160;a&#160;means&#160;to&#160;fight&#160;off&#160;many&#160;threats&#160;to&#160;today’s<br/>and&#160;tomorrows&#160;distributed&#160;applications&#160;with&#160;a&#160;concept&#160;that&#160;is&#160;deployable&#160;for&#160;the&#160;short-<br/>term.</p>
<p style="position:absolute;top:811px;left:172px;white-space:nowrap" class="ft6612">In&#160;a&#160;next&#160;step&#160;we&#160;plan&#160;to&#160;adapt&#160;IPsec&#160;to&#160;provide&#160;Trusted&#160;Channels&#160;in&#160;connection</p>
<p style="position:absolute;top:829px;left:150px;white-space:nowrap" class="ft6615">with&#160;our&#160;security&#160;architecture&#160;and&#160;we&#160;work&#160;on&#160;an&#160;implementation&#160;of&#160;a&#160;run-time&#160;integrity<br/>measurement&#160;agent.&#160;A&#160;formal&#160;security&#160;analysis&#160;of&#160;the&#160;presented&#160;protocol&#160;is&#160;subject&#160;to<br/>future&#160;work&#160;as&#160;well&#160;as&#160;the&#160;adaption&#160;of&#160;other&#160;protocols,&#160;e.g.,&#160;SSH,&#160;to&#160;fit&#160;the&#160;needs&#160;of&#160;a<br/>Trusted&#160;Channel.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft6618">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 67 -->
<a name="67"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page67-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL067.png" alt="background image"/>
<p style="position:absolute;top:295px;left:226px;white-space:nowrap" class="ft6719"><b>Chapter&#160;6</b></p>
<p style="position:absolute;top:365px;left:226px;white-space:nowrap" class="ft6716"><b>Conclusion&#160;and&#160;Outlook</b></p>
<p style="position:absolute;top:422px;left:591px;white-space:nowrap" class="ft6712">Matthias&#160;Schunter&#160;(IBM)</p>
<p style="position:absolute;top:455px;left:248px;white-space:nowrap" class="ft6712">In&#160;this&#160;report,&#160;we&#160;have&#160;described&#160;the&#160;OpenTC&#160;Security&#160;Services.&#160;These&#160;service</p>
<p style="position:absolute;top:473px;left:226px;white-space:nowrap" class="ft6715">are&#160;the&#160;foundation&#160;for&#160;enforcing&#160;policies&#160;for&#160;Xen-based&#160;Hypervisors.&#160;In&#160;addition,&#160;the<br/>trusted&#160;channels&#160;allow&#160;L4&#160;machines&#160;to&#160;validate&#160;Xen&#160;machines&#160;and&#160;vice&#160;versa.</p>
<p style="position:absolute;top:509px;left:248px;white-space:nowrap" class="ft6712">These&#160;building&#160;blocks&#160;are&#160;currently&#160;used&#160;to&#160;build&#160;a&#160;secure&#160;virtual&#160;datacenter.&#160;This</p>
<p style="position:absolute;top:527px;left:226px;white-space:nowrap" class="ft6715">datacenter&#160;reliably&#160;and&#160;verifiable&#160;isolates&#160;customer&#160;from&#160;each&#160;other&#160;while&#160;guaranteeing<br/>proper&#160;policy&#160;enforcement&#160;for&#160;each&#160;customer.</p>
<p style="position:absolute;top:1117px;left:476px;white-space:nowrap" class="ft6712">65</p>
</div>
<!-- Page 68 -->
<a name="68"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft68121{font-size:9px;font-family:GBYOJQ+CMMI6;color:#000000;}
	.ft68122{font-size:9px;font-family:EAHSJV+CMR6;color:#000000;}
	.ft68123{font-size:12px;font-family:UABXEI+CMSS8;color:#000000;}
-->
</style>
<div id="page68-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL068.png" alt="background image"/>
<p style="position:absolute;top:295px;left:150px;white-space:nowrap" class="ft6819"><b>Appendix&#160;A</b></p>
<p style="position:absolute;top:365px;left:150px;white-space:nowrap" class="ft6831"><b>Some&#160;details&#160;on&#160;Trusted<br/>Channel&#160;Implementation</b></p>
<p style="position:absolute;top:507px;left:150px;white-space:nowrap" class="ft6820"><b>A.1</b></p>
<p style="position:absolute;top:507px;left:203px;white-space:nowrap" class="ft6820"><b>Details&#160;of&#160;Hardware&#160;and&#160;Virtualization&#160;Layer</b></p>
<p style="position:absolute;top:546px;left:150px;white-space:nowrap" class="ft6844"><b>A.1.1</b></p>
<p style="position:absolute;top:546px;left:208px;white-space:nowrap" class="ft6844"><b>TC-enabled&#160;Hardware&#160;Layer</b></p>
<p style="position:absolute;top:576px;left:150px;white-space:nowrap" class="ft6815">The&#160;hardware&#160;platform&#160;has&#160;to&#160;provide&#160;additional&#160;components&#160;as&#160;defined&#160;by&#160;the&#160;TCG<br/>in&#160;various&#160;specifications&#160;(e.g.,&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[74]</a>).&#160;The&#160;central&#160;component&#160;forms&#160;the&#160;TPM&#160;which&#160;is<br/>currently&#160;implemented&#160;as&#160;a&#160;dedicated&#160;hardware&#160;chip.&#160;It&#160;offers&#160;amongst&#160;others&#160;some<br/>amount&#160;of&#160;<i>protected&#160;storage</i>.&#160;It&#160;provides&#160;a&#160;set&#160;of&#160;registers&#160;in&#160;protected&#160;storage&#160;called<br/><i>Platform&#160;Configuration&#160;Registers&#160;</i>(PCR)&#160;that&#160;can&#160;be&#160;used&#160;to&#160;store&#160;hash&#160;values.&#160;Protec-<br/>tion&#160;mechanisms&#160;ensure&#160;that&#160;the&#160;value&#160;of&#160;a&#160;PCR&#160;can&#160;only&#160;be&#160;modified&#160;in&#160;a&#160;predefined<br/>wa<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#68">y</a></p>
<p style="position:absolute;top:681px;left:175px;white-space:nowrap" class="ft6821"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#68">1</a></p>
<p style="position:absolute;top:684px;left:185px;white-space:nowrap" class="ft6812">(see&#160;also&#160;Section&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#59">5.5.4)</a>.&#160;Protected&#160;storage&#160;is&#160;also&#160;used&#160;to&#160;store&#160;certain&#160;security</p>
<p style="position:absolute;top:702px;left:150px;white-space:nowrap" class="ft6812">sensitive&#160;keys,&#160;e.g.,&#160;<i>Attestation&#160;Identity&#160;Keys&#160;</i>(AIK).&#160;An</p>
<p style="position:absolute;top:701px;left:492px;white-space:nowrap" class="ft68113">AIK</p>
<p style="position:absolute;top:702px;left:527px;white-space:nowrap" class="ft6812">is&#160;<i>non-migratable</i>,&#160;i.e.,</p>
<p style="position:absolute;top:720px;left:150px;white-space:nowrap" class="ft6815">its&#160;private&#160;part&#160;never&#160;leaves&#160;the&#160;TPM’s&#160;protected&#160;storage&#160;and&#160;can&#160;only&#160;be&#160;applied&#160;for<br/>signing&#160;data&#160;(e.g.,&#160;via&#160;the</p>
<p style="position:absolute;top:739px;left:308px;white-space:nowrap" class="ft68118">TPM</p>
<p style="position:absolute;top:738px;left:332px;white-space:nowrap" class="ft6812">_</p>
<p style="position:absolute;top:739px;left:339px;white-space:nowrap" class="ft68118">Quote</p>
<p style="position:absolute;top:737px;left:379px;white-space:nowrap" class="ft6828">()</p>
<p style="position:absolute;top:738px;left:395px;white-space:nowrap" class="ft6812">command)&#160;that&#160;originates&#160;from&#160;the&#160;TPM&#160;(cf.</p>
<p style="position:absolute;top:756px;left:150px;white-space:nowrap" class="ft6812"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#79">[74,&#160;</a>p.18]).&#160;An&#160;AIK&#160;certificate</p>
<p style="position:absolute;top:755px;left:336px;white-space:nowrap" class="ft68113">cert</p>
<p style="position:absolute;top:761px;left:361px;white-space:nowrap" class="ft68114">AIK</p>
<p style="position:absolute;top:756px;left:390px;white-space:nowrap" class="ft6812">can&#160;be&#160;obtained&#160;from&#160;a&#160;<i>Certification&#160;Authority</i></p>
<p style="position:absolute;top:773px;left:150px;white-space:nowrap" class="ft6830">(CA)&#160;that&#160;vouches&#160;for&#160;the&#160;mentioned&#160;AIK&#160;properties.&#160;Furthermore&#160;the&#160;TPM&#160;provides<br/>functionalities&#160;such&#160;as&#160;<i>binding&#160;</i>and&#160;<i>sealing&#160;</i>that&#160;allow&#160;to&#160;cryptographically&#160;<i>relate/bind<br/></i>data&#160;to&#160;a&#160;certain&#160;platform&#160;configuration,&#160;which&#160;is&#160;reflected&#160;by&#160;a&#160;subset&#160;of&#160;PCR&#160;values.</p>
<p style="position:absolute;top:850px;left:150px;white-space:nowrap" class="ft6844"><b>A.1.2</b></p>
<p style="position:absolute;top:850px;left:208px;white-space:nowrap" class="ft6844"><b>Virtualization&#160;Layer</b></p>
<p style="position:absolute;top:880px;left:150px;white-space:nowrap" class="ft6815">The&#160;Virtualization&#160;Layer&#160;is&#160;part&#160;of&#160;the&#160;TCB&#160;and&#160;consists&#160;of&#160;a&#160;hypervisor/microkernel.<br/>We&#160;used&#160;the&#160;Xen&#160;hypervisor&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#80">[82]</a>)&#160;and&#160;the&#160;L4&#160;microkernel&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#77">[44]</a>)&#160;for&#160;our&#160;imple-<br/>mentation.</p>
<p style="position:absolute;top:934px;left:172px;white-space:nowrap" class="ft6812">The&#160;hypervisor/microkernel&#160;provides&#160;and&#160;mediates&#160;access&#160;to&#160;hardware&#160;components</p>
<p style="position:absolute;top:952px;left:150px;white-space:nowrap" class="ft6830">of&#160;the&#160;platform&#160;by&#160;presenting&#160;virtualized&#160;instances&#160;of&#160;these&#160;components&#160;to&#160;the&#160;upper<br/>layers.&#160;By&#160;providing&#160;virtual&#160;memory&#160;that&#160;solely&#160;directs&#160;memory&#160;accesses&#160;to&#160;logical<br/>address&#160;spaces,&#160;interfaces&#160;for&#160;access&#160;control&#160;mechanisms&#160;and&#160;monitored&#160;<i>Inter&#160;Process<br/>Communication&#160;</i>(IPC)&#160;the&#160;virtualization&#160;layer&#160;guarantees&#160;separation&#160;of&#160;compartments</p>
<p style="position:absolute;top:1033px;left:166px;white-space:nowrap" class="ft6822">1</p>
<p style="position:absolute;top:1034px;left:175px;white-space:nowrap" class="ft68115">PCR</p>
<p style="position:absolute;top:1039px;left:202px;white-space:nowrap" class="ft68121">i</p>
<p style="position:absolute;top:1039px;left:206px;white-space:nowrap" class="ft68122">+1</p>
<p style="position:absolute;top:1034px;left:225px;white-space:nowrap" class="ft68117">←</p>
<p style="position:absolute;top:1035px;left:242px;white-space:nowrap" class="ft68123">Hash</p>
<p style="position:absolute;top:1034px;left:268px;white-space:nowrap" class="ft68112">(</p>
<p style="position:absolute;top:1034px;left:273px;white-space:nowrap" class="ft68115">PCR</p>
<p style="position:absolute;top:1039px;left:301px;white-space:nowrap" class="ft68121">i</p>
<p style="position:absolute;top:1034px;left:305px;white-space:nowrap" class="ft68117">|</p>
<p style="position:absolute;top:1034px;left:309px;white-space:nowrap" class="ft68111">x</p>
<p style="position:absolute;top:1034px;left:316px;white-space:nowrap" class="ft68112">)</p>
<p style="position:absolute;top:1035px;left:321px;white-space:nowrap" class="ft6810">,&#160;with&#160;old&#160;register&#160;value</p>
<p style="position:absolute;top:1034px;left:438px;white-space:nowrap" class="ft68115">PCR</p>
<p style="position:absolute;top:1039px;left:466px;white-space:nowrap" class="ft68121">i</p>
<p style="position:absolute;top:1035px;left:471px;white-space:nowrap" class="ft6810">,&#160;new&#160;register&#160;value</p>
<p style="position:absolute;top:1034px;left:568px;white-space:nowrap" class="ft68115">PCR</p>
<p style="position:absolute;top:1039px;left:595px;white-space:nowrap" class="ft68121">i</p>
<p style="position:absolute;top:1039px;left:599px;white-space:nowrap" class="ft68122">+1</p>
<p style="position:absolute;top:1035px;left:614px;white-space:nowrap" class="ft6810">,&#160;and&#160;input</p>
<p style="position:absolute;top:1049px;left:150px;white-space:nowrap" class="ft68111">x</p>
<p style="position:absolute;top:1049px;left:160px;white-space:nowrap" class="ft6810">(e.g.,&#160;a&#160;SHA-1&#160;hash&#160;value).&#160;This&#160;process&#160;is&#160;called&#160;<i>extending&#160;</i>a&#160;PCR.</p>
<p style="position:absolute;top:1117px;left:400px;white-space:nowrap" class="ft6812">66</p>
</div>
<!-- Page 69 -->
<a name="69"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft69124{font-size:12px;line-height:14px;font-family:Times;color:#000000;}
-->
</style>
<div id="page69-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL069.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft6912">APPENDIX&#160;A.&#160;SOME&#160;DETAILS&#160;ON&#160;TRUSTED&#160;CHANNEL&#160;IMPLEMENTATION67</p>
<p style="position:absolute;top:193px;left:226px;white-space:nowrap" class="ft6912">(<i>runtime&#160;isolation</i>)<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#69">.</a></p>
<p style="position:absolute;top:191px;left:343px;white-space:nowrap" class="ft6921"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#69">2</a></p>
<p style="position:absolute;top:193px;left:356px;white-space:nowrap" class="ft6912">The&#160;code&#160;of&#160;the&#160;TCB&#160;resides&#160;in&#160;a&#160;protected&#160;memory&#160;region&#160;and</p>
<p style="position:absolute;top:211px;left:226px;white-space:nowrap" class="ft6915">is&#160;only&#160;accessible&#160;to&#160;higher&#160;layers&#160;by&#160;using&#160;specific&#160;interfaces.&#160;Additionally,&#160;only&#160;the<br/>hypervisor/microkernel&#160;runs&#160;in&#160;kernel&#160;mode.&#160;All&#160;device&#160;drivers&#160;and&#160;compartments&#160;in<br/>turn&#160;run&#160;in&#160;user&#160;mode<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#69">.</a></p>
<p style="position:absolute;top:245px;left:360px;white-space:nowrap" class="ft6921"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#69">3</a></p>
<p style="position:absolute;top:247px;left:372px;white-space:nowrap" class="ft6912">Thus,&#160;separation&#160;from&#160;software&#160;layers&#160;operating&#160;on&#160;top&#160;of&#160;the</p>
<p style="position:absolute;top:265px;left:226px;white-space:nowrap" class="ft6912">virtualization&#160;layer&#160;is&#160;also&#160;guaranteed.</p>
<p style="position:absolute;top:292px;left:242px;white-space:nowrap" class="ft6922">2</p>
<p style="position:absolute;top:294px;left:247px;white-space:nowrap" class="ft69119"><i>Direct&#160;Memory&#160;Access&#160;</i>(DMA)&#160;is&#160;not&#160;considered&#160;here.&#160;To&#160;protect&#160;against&#160;attacks&#160;misusing&#160;DMA&#160;new</p>
<p style="position:absolute;top:309px;left:226px;white-space:nowrap" class="ft69124">security&#160;concepts&#160;like&#160;<i>Intel&#160;Trusted&#160;Execution&#160;Technology&#160;</i>(TXT,&#160;cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#76">[35]</a>)&#160;or&#160;<i>AMD&#160;I/O&#160;Virtualization&#160;Tech-<br/>nology</i>,&#160;(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#74">[4]</a>)&#160;have&#160;to&#160;be&#160;applied.</p>
<p style="position:absolute;top:335px;left:242px;white-space:nowrap" class="ft6922">3</p>
<p style="position:absolute;top:337px;left:247px;white-space:nowrap" class="ft6910">On&#160;top&#160;of&#160;the&#160;Xen&#160;hypervisor&#160;the&#160;kernels&#160;of&#160;the&#160;guest&#160;OSs&#160;run&#160;in&#160;ring&#160;1.&#160;Everything&#160;else&#160;in&#160;ring&#160;3.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft6918">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 70 -->
<a name="70"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page70-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL070.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft7012">68</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft7018">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft7018">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 71 -->
<a name="71"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft71125{font-size:10px;font-family:CNBRYC+CMTT8;color:#000000;}
	.ft71126{font-size:22px;line-height:26px;font-family:Times;color:#000000;}
-->
</style>
<div id="page71-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL071.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft7112">APPENDIX&#160;A.&#160;SOME&#160;DETAILS&#160;ON&#160;TRUSTED&#160;CHANNEL&#160;IMPLEMENTATION69</p>
<p style="position:absolute;top:189px;left:226px;white-space:nowrap" class="ft7120"><b>A.2</b></p>
<p style="position:absolute;top:189px;left:279px;white-space:nowrap" class="ft71126"><b>Linkage&#160;of&#160;Configuration&#160;Information&#160;to&#160;Secure<br/>Channel</b></p>
<p style="position:absolute;top:270px;left:252px;white-space:nowrap" class="ft7112">As&#160;an&#160;Example&#160;we&#160;show&#160;the&#160;evaluation&#160;steps&#160;for&#160;the&#160;client&#160;side:</p>
<p style="position:absolute;top:305px;left:252px;white-space:nowrap" class="ft7112">Client&#160;holds&#160;:=</p>
<p style="position:absolute;top:304px;left:350px;white-space:nowrap" class="ft7133">{</p>
<p style="position:absolute;top:305px;left:357px;white-space:nowrap" class="ft71113">PK</p>
<p style="position:absolute;top:303px;left:381px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:312px;left:379px;white-space:nowrap" class="ft71114">enc</p>
<p style="position:absolute;top:305px;left:398px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:305px;left:408px;white-space:nowrap" class="ft71113">PK</p>
<p style="position:absolute;top:303px;left:432px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:312px;left:429px;white-space:nowrap" class="ft71114">sign</p>
<p style="position:absolute;top:305px;left:453px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:305px;left:462px;white-space:nowrap" class="ft71113">cert</p>
<p style="position:absolute;top:303px;left:488px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:312px;left:487px;white-space:nowrap" class="ft71114">TCLS</p>
<p style="position:absolute;top:305px;left:521px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:305px;left:530px;white-space:nowrap" class="ft71113">changelog</p>
<p style="position:absolute;top:303px;left:593px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:305px;left:602px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:305px;left:612px;white-space:nowrap" class="ft71113">cert</p>
<p style="position:absolute;top:303px;left:638px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:312px;left:636px;white-space:nowrap" class="ft71114">AIK</p>
<p style="position:absolute;top:305px;left:661px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:305px;left:671px;white-space:nowrap" class="ft71113">CDS</p>
<p style="position:absolute;top:303px;left:703px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:305px;left:712px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:324px;left:315px;white-space:nowrap" class="ft7129">ref&#160;erence&#160;values</p>
<p style="position:absolute;top:325px;left:432px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:325px;left:444px;white-space:nowrap" class="ft71113">SeK</p>
<p style="position:absolute;top:325px;left:473px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:325px;left:485px;white-space:nowrap" class="ft71113">nonce</p>
<p style="position:absolute;top:323px;left:524px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:332px;left:523px;white-space:nowrap" class="ft71114">TPM</p>
<p style="position:absolute;top:325px;left:553px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:325px;left:565px;white-space:nowrap" class="ft71113">nonce</p>
<p style="position:absolute;top:323px;left:603px;white-space:nowrap" class="ft71114">C</p>
<p style="position:absolute;top:332px;left:602px;white-space:nowrap" class="ft71114">TPM</p>
<p style="position:absolute;top:325px;left:633px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:325px;left:645px;white-space:nowrap" class="ft71113">nonceSD</p>
<p style="position:absolute;top:323px;left:703px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:325px;left:712px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:343px;left:252px;white-space:nowrap" class="ft71113">Sig</p>
<p style="position:absolute;top:341px;left:273px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:350px;left:272px;white-space:nowrap" class="ft71114">aD</p>
<p style="position:absolute;top:342px;left:293px;white-space:nowrap" class="ft7133">}</p>
<p style="position:absolute;top:379px;left:252px;white-space:nowrap" class="ft7112">(i)</p>
<p style="position:absolute;top:397px;left:252px;white-space:nowrap" class="ft71113">cert</p>
<p style="position:absolute;top:394px;left:278px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:404px;left:276px;white-space:nowrap" class="ft71114">TCLS</p>
<p style="position:absolute;top:397px;left:310px;white-space:nowrap" class="ft7112">:=</p>
<p style="position:absolute;top:396px;left:327px;white-space:nowrap" class="ft7133">{</p>
<p style="position:absolute;top:397px;left:338px;white-space:nowrap" class="ft71113">PK</p>
<p style="position:absolute;top:394px;left:361px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:404px;left:359px;white-space:nowrap" class="ft71114">enc</p>
<p style="position:absolute;top:397px;left:379px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:397px;left:386px;white-space:nowrap" class="ft71113">PK</p>
<p style="position:absolute;top:394px;left:410px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:404px;left:408px;white-space:nowrap" class="ft71114">sign</p>
<p style="position:absolute;top:397px;left:431px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:397px;left:439px;white-space:nowrap" class="ft71113">SigCA</p>
<p style="position:absolute;top:402px;left:480px;white-space:nowrap" class="ft71114">BSEK</p>
<p style="position:absolute;top:396px;left:519px;white-space:nowrap" class="ft7133">}</p>
<p style="position:absolute;top:416px;left:252px;white-space:nowrap" class="ft7129">eval</p>
<p style="position:absolute;top:416px;left:283px;white-space:nowrap" class="ft7128">:</p>
<p style="position:absolute;top:416px;left:291px;white-space:nowrap" class="ft7129">digest</p>
<p style="position:absolute;top:416px;left:331px;white-space:nowrap" class="ft7128">(</p>
<p style="position:absolute;top:417px;left:337px;white-space:nowrap" class="ft71113">cert</p>
<p style="position:absolute;top:414px;left:363px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:424px;left:361px;white-space:nowrap" class="ft71114">TCLS</p>
<p style="position:absolute;top:416px;left:399px;white-space:nowrap" class="ft7128">)&#160;==</p>
<p style="position:absolute;top:417px;left:436px;white-space:nowrap" class="ft71113">dec</p>
<p style="position:absolute;top:416px;left:458px;white-space:nowrap" class="ft7128">(</p>
<p style="position:absolute;top:417px;left:464px;white-space:nowrap" class="ft71113">SigCA</p>
<p style="position:absolute;top:422px;left:505px;white-space:nowrap" class="ft71114">BSEK</p>
<p style="position:absolute;top:416px;left:544px;white-space:nowrap" class="ft7128">;</p>
<p style="position:absolute;top:416px;left:551px;white-space:nowrap" class="ft7129">P&#160;K</p>
<p style="position:absolute;top:422px;left:576px;white-space:nowrap" class="ft7143">CA</p>
<p style="position:absolute;top:416px;left:595px;white-space:nowrap" class="ft7128">)</p>
<p style="position:absolute;top:434px;left:252px;white-space:nowrap" class="ft7133">⇒&#160;S</p>
<p style="position:absolute;top:435px;left:284px;white-space:nowrap" class="ft7117"><b>authenticated</b></p>
<p style="position:absolute;top:471px;left:252px;white-space:nowrap" class="ft7112">(ii)</p>
<p style="position:absolute;top:488px;left:252px;white-space:nowrap" class="ft71113">SeK</p>
<p style="position:absolute;top:489px;left:285px;white-space:nowrap" class="ft7112">is&#160;verified&#160;by&#160;the</p>
<p style="position:absolute;top:488px;left:388px;white-space:nowrap" class="ft71113">Finished</p>
<p style="position:absolute;top:489px;left:448px;white-space:nowrap" class="ft7112">message</p>
<p style="position:absolute;top:506px;left:252px;white-space:nowrap" class="ft7133">⇒</p>
<p style="position:absolute;top:506px;left:271px;white-space:nowrap" class="ft71113">SeK</p>
<p style="position:absolute;top:504px;left:300px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:507px;left:312px;white-space:nowrap" class="ft7112">==</p>
<p style="position:absolute;top:506px;left:333px;white-space:nowrap" class="ft71113">SeK</p>
<p style="position:absolute;top:504px;left:362px;white-space:nowrap" class="ft71114">C</p>
<p style="position:absolute;top:524px;left:252px;white-space:nowrap" class="ft7133">⇒</p>
<p style="position:absolute;top:524px;left:271px;white-space:nowrap" class="ft71113">SeK</p>
<p style="position:absolute;top:525px;left:303px;white-space:nowrap" class="ft7117"><b>authenticated</b></p>
<p style="position:absolute;top:542px;left:252px;white-space:nowrap" class="ft7133">⇒</p>
<p style="position:absolute;top:542px;left:271px;white-space:nowrap" class="ft71113">ms</p>
<p style="position:absolute;top:540px;left:290px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:543px;left:303px;white-space:nowrap" class="ft7112">==</p>
<p style="position:absolute;top:542px;left:323px;white-space:nowrap" class="ft71113">ms</p>
<p style="position:absolute;top:540px;left:343px;white-space:nowrap" class="ft71114">C</p>
<p style="position:absolute;top:560px;left:252px;white-space:nowrap" class="ft7133">⇒</p>
<p style="position:absolute;top:560px;left:375px;white-space:nowrap" class="ft7128">(</p>
<p style="position:absolute;top:561px;left:381px;white-space:nowrap" class="ft71118">rdSessionKey</p>
<p style="position:absolute;top:560px;left:476px;white-space:nowrap" class="ft7129">,</p>
<p style="position:absolute;top:561px;left:482px;white-space:nowrap" class="ft71118">nonce</p>
<p style="position:absolute;top:559px;left:522px;white-space:nowrap" class="ft71125">C</p>
<p style="position:absolute;top:560px;left:527px;white-space:nowrap" class="ft7129">,</p>
<p style="position:absolute;top:561px;left:534px;white-space:nowrap" class="ft71118">nonce</p>
<p style="position:absolute;top:559px;left:573px;white-space:nowrap" class="ft71125">S</p>
<p style="position:absolute;top:560px;left:579px;white-space:nowrap" class="ft7128">)</p>
<p style="position:absolute;top:556px;left:585px;white-space:nowrap" class="ft71125">C</p>
<p style="position:absolute;top:561px;left:699px;white-space:nowrap" class="ft7112">==</p>
<p style="position:absolute;top:579px;left:252px;white-space:nowrap" class="ft7128">(</p>
<p style="position:absolute;top:581px;left:258px;white-space:nowrap" class="ft71118">rdSessionKey</p>
<p style="position:absolute;top:579px;left:353px;white-space:nowrap" class="ft7129">,</p>
<p style="position:absolute;top:581px;left:359px;white-space:nowrap" class="ft71118">nonce</p>
<p style="position:absolute;top:578px;left:399px;white-space:nowrap" class="ft71125">C</p>
<p style="position:absolute;top:579px;left:404px;white-space:nowrap" class="ft7129">,</p>
<p style="position:absolute;top:581px;left:411px;white-space:nowrap" class="ft71118">nonce</p>
<p style="position:absolute;top:578px;left:450px;white-space:nowrap" class="ft71125">S</p>
<p style="position:absolute;top:579px;left:456px;white-space:nowrap" class="ft7128">)</p>
<p style="position:absolute;top:576px;left:462px;white-space:nowrap" class="ft71125">S</p>
<p style="position:absolute;top:599px;left:252px;white-space:nowrap" class="ft7133">⇒</p>
<p style="position:absolute;top:599px;left:271px;white-space:nowrap" class="ft7128">(</p>
<p style="position:absolute;top:601px;left:276px;white-space:nowrap" class="ft71118">nonce</p>
<p style="position:absolute;top:598px;left:316px;white-space:nowrap" class="ft71125">C</p>
<p style="position:absolute;top:599px;left:322px;white-space:nowrap" class="ft7129">,</p>
<p style="position:absolute;top:601px;left:328px;white-space:nowrap" class="ft71118">nonce</p>
<p style="position:absolute;top:598px;left:368px;white-space:nowrap" class="ft71125">S</p>
<p style="position:absolute;top:599px;left:374px;white-space:nowrap" class="ft7128">)</p>
<p style="position:absolute;top:596px;left:380px;white-space:nowrap" class="ft71125">C</p>
<p style="position:absolute;top:600px;left:390px;white-space:nowrap" class="ft7112">==</p>
<p style="position:absolute;top:599px;left:410px;white-space:nowrap" class="ft7128">(</p>
<p style="position:absolute;top:601px;left:416px;white-space:nowrap" class="ft71118">nonce</p>
<p style="position:absolute;top:598px;left:456px;white-space:nowrap" class="ft71125">C</p>
<p style="position:absolute;top:599px;left:462px;white-space:nowrap" class="ft7129">,</p>
<p style="position:absolute;top:601px;left:469px;white-space:nowrap" class="ft71118">nonce</p>
<p style="position:absolute;top:598px;left:508px;white-space:nowrap" class="ft71125">S</p>
<p style="position:absolute;top:599px;left:514px;white-space:nowrap" class="ft7128">)</p>
<p style="position:absolute;top:596px;left:520px;white-space:nowrap" class="ft71125">S</p>
<p style="position:absolute;top:617px;left:252px;white-space:nowrap" class="ft7133">⇒</p>
<p style="position:absolute;top:618px;left:271px;white-space:nowrap" class="ft7117"><b>freshness&#160;of</b></p>
<p style="position:absolute;top:617px;left:349px;white-space:nowrap" class="ft71113">SeK</p>
<p style="position:absolute;top:618px;left:382px;white-space:nowrap" class="ft7117"><b>ensured</b></p>
<p style="position:absolute;top:635px;left:252px;white-space:nowrap" class="ft7133">⇒</p>
<p style="position:absolute;top:637px;left:271px;white-space:nowrap" class="ft71118">rdSessionKey</p>
<p style="position:absolute;top:634px;left:365px;white-space:nowrap" class="ft71125">C</p>
<p style="position:absolute;top:636px;left:375px;white-space:nowrap" class="ft7112">==</p>
<p style="position:absolute;top:637px;left:395px;white-space:nowrap" class="ft71118">rdSessionKey</p>
<p style="position:absolute;top:634px;left:489px;white-space:nowrap" class="ft71125">S</p>
<p style="position:absolute;top:636px;left:499px;white-space:nowrap" class="ft7112">==</p>
<p style="position:absolute;top:637px;left:520px;white-space:nowrap" class="ft71118">rdSessionKey</p>
<p style="position:absolute;top:653px;left:252px;white-space:nowrap" class="ft7133">⇒</p>
<p style="position:absolute;top:655px;left:275px;white-space:nowrap" class="ft71118">rdSessionKey</p>
<p style="position:absolute;top:653px;left:383px;white-space:nowrap" class="ft7128">==</p>
<p style="position:absolute;top:653px;left:420px;white-space:nowrap" class="ft7129">dec</p>
<p style="position:absolute;top:653px;left:441px;white-space:nowrap" class="ft7128">(</p>
<p style="position:absolute;top:653px;left:447px;white-space:nowrap" class="ft7129">enc</p>
<p style="position:absolute;top:653px;left:469px;white-space:nowrap" class="ft7128">(</p>
<p style="position:absolute;top:655px;left:475px;white-space:nowrap" class="ft71118">rdSessionKey</p>
<p style="position:absolute;top:653px;left:569px;white-space:nowrap" class="ft7128">;</p>
<p style="position:absolute;top:653px;left:576px;white-space:nowrap" class="ft7129">P&#160;K</p>
<p style="position:absolute;top:651px;left:601px;white-space:nowrap" class="ft7143">S</p>
<p style="position:absolute;top:660px;left:600px;white-space:nowrap" class="ft7143">enc</p>
<p style="position:absolute;top:653px;left:619px;white-space:nowrap" class="ft7128">);</p>
<p style="position:absolute;top:653px;left:632px;white-space:nowrap" class="ft7129">SK</p>
<p style="position:absolute;top:651px;left:656px;white-space:nowrap" class="ft7143">S</p>
<p style="position:absolute;top:660px;left:654px;white-space:nowrap" class="ft7143">enc</p>
<p style="position:absolute;top:653px;left:673px;white-space:nowrap" class="ft7128">)&#160;==</p>
<p style="position:absolute;top:673px;left:252px;white-space:nowrap" class="ft71118">rdSessionKey</p>
<p style="position:absolute;top:689px;left:252px;white-space:nowrap" class="ft7133">⇒&#160;S</p>
<p style="position:absolute;top:690px;left:284px;white-space:nowrap" class="ft7117"><b>proved&#160;possession&#160;of</b></p>
<p style="position:absolute;top:689px;left:418px;white-space:nowrap" class="ft71113">SK</p>
<p style="position:absolute;top:687px;left:440px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:696px;left:438px;white-space:nowrap" class="ft71114">enc</p>
<p style="position:absolute;top:726px;left:252px;white-space:nowrap" class="ft7112">(iii):</p>
<p style="position:absolute;top:743px;left:252px;white-space:nowrap" class="ft71113">aD</p>
<p style="position:absolute;top:741px;left:272px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:743px;left:285px;white-space:nowrap" class="ft7112">:=</p>
<p style="position:absolute;top:742px;left:301px;white-space:nowrap" class="ft7133">{</p>
<p style="position:absolute;top:743px;left:312px;white-space:nowrap" class="ft71113">SKAE</p>
<p style="position:absolute;top:741px;left:355px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:743px;left:364px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:743px;left:372px;white-space:nowrap" class="ft71113">PK</p>
<p style="position:absolute;top:741px;left:395px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:750px;left:393px;white-space:nowrap" class="ft71114">SKAE</p>
<p style="position:absolute;top:743px;left:429px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:743px;left:436px;white-space:nowrap" class="ft71113">Sig</p>
<p style="position:absolute;top:741px;left:457px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:750px;left:456px;white-space:nowrap" class="ft71114">BSEK</p>
<p style="position:absolute;top:743px;left:491px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:743px;left:499px;white-space:nowrap" class="ft71113">nonceSD</p>
<p style="position:absolute;top:741px;left:558px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:743px;left:566px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:743px;left:574px;white-space:nowrap" class="ft71113">CDS</p>
<p style="position:absolute;top:741px;left:606px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:743px;left:615px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:743px;left:622px;white-space:nowrap" class="ft71113">changelog</p>
<p style="position:absolute;top:741px;left:685px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:742px;left:698px;white-space:nowrap" class="ft7133">}</p>
<p style="position:absolute;top:760px;left:252px;white-space:nowrap" class="ft7129">eval</p>
<p style="position:absolute;top:760px;left:283px;white-space:nowrap" class="ft7128">:</p>
<p style="position:absolute;top:760px;left:291px;white-space:nowrap" class="ft7129">digest</p>
<p style="position:absolute;top:760px;left:331px;white-space:nowrap" class="ft7128">(</p>
<p style="position:absolute;top:761px;left:337px;white-space:nowrap" class="ft71113">aD</p>
<p style="position:absolute;top:759px;left:357px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:760px;left:370px;white-space:nowrap" class="ft7128">)</p>
<p style="position:absolute;top:760px;left:380px;white-space:nowrap" class="ft7133">←</p>
<p style="position:absolute;top:761px;left:399px;white-space:nowrap" class="ft71113">dec</p>
<p style="position:absolute;top:760px;left:420px;white-space:nowrap" class="ft7128">(</p>
<p style="position:absolute;top:761px;left:426px;white-space:nowrap" class="ft71113">Sig</p>
<p style="position:absolute;top:759px;left:447px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:768px;left:446px;white-space:nowrap" class="ft71114">aD</p>
<p style="position:absolute;top:760px;left:467px;white-space:nowrap" class="ft7128">;</p>
<p style="position:absolute;top:760px;left:474px;white-space:nowrap" class="ft7129">P&#160;K</p>
<p style="position:absolute;top:759px;left:499px;white-space:nowrap" class="ft7143">S</p>
<p style="position:absolute;top:768px;left:498px;white-space:nowrap" class="ft7143">sign</p>
<p style="position:absolute;top:760px;left:522px;white-space:nowrap" class="ft7128">)</p>
<p style="position:absolute;top:780px;left:252px;white-space:nowrap" class="ft7133">⇒&#160;S</p>
<p style="position:absolute;top:781px;left:284px;white-space:nowrap" class="ft7117"><b>proved&#160;possession&#160;of</b></p>
<p style="position:absolute;top:781px;left:418px;white-space:nowrap" class="ft71113">SK</p>
<p style="position:absolute;top:779px;left:440px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:788px;left:438px;white-space:nowrap" class="ft71114">sign</p>
<p style="position:absolute;top:800px;left:252px;white-space:nowrap" class="ft7129">eval</p>
<p style="position:absolute;top:800px;left:283px;white-space:nowrap" class="ft7128">:</p>
<p style="position:absolute;top:800px;left:291px;white-space:nowrap" class="ft7129">digest</p>
<p style="position:absolute;top:800px;left:331px;white-space:nowrap" class="ft7128">(</p>
<p style="position:absolute;top:801px;left:337px;white-space:nowrap" class="ft71113">PK</p>
<p style="position:absolute;top:799px;left:361px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:808px;left:359px;white-space:nowrap" class="ft71114">enc</p>
<p style="position:absolute;top:800px;left:382px;white-space:nowrap" class="ft7129">,</p>
<p style="position:absolute;top:801px;left:386px;white-space:nowrap" class="ft71113">PK</p>
<p style="position:absolute;top:799px;left:410px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:808px;left:408px;white-space:nowrap" class="ft71114">sign</p>
<p style="position:absolute;top:800px;left:435px;white-space:nowrap" class="ft7128">)</p>
<p style="position:absolute;top:800px;left:445px;white-space:nowrap" class="ft7133">←</p>
<p style="position:absolute;top:801px;left:464px;white-space:nowrap" class="ft71113">dec</p>
<p style="position:absolute;top:800px;left:485px;white-space:nowrap" class="ft7128">(</p>
<p style="position:absolute;top:801px;left:491px;white-space:nowrap" class="ft71113">SigCA</p>
<p style="position:absolute;top:806px;left:533px;white-space:nowrap" class="ft71114">BSEK</p>
<p style="position:absolute;top:800px;left:572px;white-space:nowrap" class="ft7128">;</p>
<p style="position:absolute;top:800px;left:579px;white-space:nowrap" class="ft7129">P&#160;K</p>
<p style="position:absolute;top:806px;left:603px;white-space:nowrap" class="ft7143">CA</p>
<p style="position:absolute;top:800px;left:622px;white-space:nowrap" class="ft7128">)</p>
<p style="position:absolute;top:820px;left:252px;white-space:nowrap" class="ft7133">⇒</p>
<p style="position:absolute;top:821px;left:271px;white-space:nowrap" class="ft71113">aD</p>
<p style="position:absolute;top:818px;left:291px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:821px;left:303px;white-space:nowrap" class="ft7117"><b>authenticated&#160;to&#160;be&#160;from</b></p>
<p style="position:absolute;top:820px;left:464px;white-space:nowrap" class="ft7133">S</p>
<p style="position:absolute;top:838px;left:252px;white-space:nowrap" class="ft7129">eval</p>
<p style="position:absolute;top:838px;left:283px;white-space:nowrap" class="ft7128">:</p>
<p style="position:absolute;top:838px;left:291px;white-space:nowrap" class="ft71113">nonceSD</p>
<p style="position:absolute;top:836px;left:350px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:838px;left:362px;white-space:nowrap" class="ft7133">←</p>
<p style="position:absolute;top:838px;left:381px;white-space:nowrap" class="ft7129">digest</p>
<p style="position:absolute;top:839px;left:422px;white-space:nowrap" class="ft7112">(</p>
<p style="position:absolute;top:838px;left:427px;white-space:nowrap" class="ft71113">nonce</p>
<p style="position:absolute;top:836px;left:465px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:846px;left:464px;white-space:nowrap" class="ft71114">TPM</p>
<p style="position:absolute;top:839px;left:494px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:838px;left:501px;white-space:nowrap" class="ft71113">nonce</p>
<p style="position:absolute;top:836px;left:540px;white-space:nowrap" class="ft71114">C</p>
<p style="position:absolute;top:846px;left:539px;white-space:nowrap" class="ft71114">TPM</p>
<p style="position:absolute;top:839px;left:569px;white-space:nowrap" class="ft7112">)</p>
<p style="position:absolute;top:856px;left:252px;white-space:nowrap" class="ft7133">⇒</p>
<p style="position:absolute;top:857px;left:271px;white-space:nowrap" class="ft7117"><b>freshness&#160;of</b></p>
<p style="position:absolute;top:856px;left:349px;white-space:nowrap" class="ft71113">aD</p>
<p style="position:absolute;top:854px;left:369px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:857px;left:382px;white-space:nowrap" class="ft7117"><b>verified</b></p>
<p style="position:absolute;top:874px;left:252px;white-space:nowrap" class="ft71113">SKAE</p>
<p style="position:absolute;top:872px;left:295px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:875px;left:304px;white-space:nowrap" class="ft7112">:=</p>
<p style="position:absolute;top:874px;left:345px;white-space:nowrap" class="ft7133">{</p>
<p style="position:absolute;top:874px;left:382px;white-space:nowrap" class="ft71113">Sig</p>
<p style="position:absolute;top:872px;left:403px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:882px;left:402px;white-space:nowrap" class="ft71114">SKAE</p>
<p style="position:absolute;top:875px;left:437px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:876px;left:477px;white-space:nowrap" class="ft71118">TPM</p>
<p style="position:absolute;top:875px;left:500px;white-space:nowrap" class="ft7112">_</p>
<p style="position:absolute;top:876px;left:508px;white-space:nowrap" class="ft71118">CERTIFY</p>
<p style="position:absolute;top:875px;left:563px;white-space:nowrap" class="ft7112">_</p>
<p style="position:absolute;top:876px;left:570px;white-space:nowrap" class="ft71118">INFO2</p>
<p style="position:absolute;top:873px;left:610px;white-space:nowrap" class="ft71125">S</p>
<p style="position:absolute;top:875px;left:616px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:874px;left:655px;white-space:nowrap" class="ft71113">PK</p>
<p style="position:absolute;top:872px;left:679px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:882px;left:676px;white-space:nowrap" class="ft71114">SKAE</p>
<p style="position:absolute;top:875px;left:712px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:892px;left:252px;white-space:nowrap" class="ft7129">ref&#160;erence&#160;values</p>
<p style="position:absolute;top:892px;left:365px;white-space:nowrap" class="ft7133">}</p>
<p style="position:absolute;top:910px;left:252px;white-space:nowrap" class="ft7129">eval</p>
<p style="position:absolute;top:910px;left:283px;white-space:nowrap" class="ft7128">:</p>
<p style="position:absolute;top:910px;left:291px;white-space:nowrap" class="ft7129">digest</p>
<p style="position:absolute;top:910px;left:331px;white-space:nowrap" class="ft7128">(</p>
<p style="position:absolute;top:910px;left:337px;white-space:nowrap" class="ft71113">SKAE</p>
<p style="position:absolute;top:908px;left:380px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:910px;left:393px;white-space:nowrap" class="ft7128">)</p>
<p style="position:absolute;top:910px;left:402px;white-space:nowrap" class="ft7133">←</p>
<p style="position:absolute;top:910px;left:422px;white-space:nowrap" class="ft71113">dec</p>
<p style="position:absolute;top:910px;left:443px;white-space:nowrap" class="ft7128">(</p>
<p style="position:absolute;top:910px;left:449px;white-space:nowrap" class="ft71113">Sig</p>
<p style="position:absolute;top:908px;left:470px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:918px;left:469px;white-space:nowrap" class="ft71114">SKAE</p>
<p style="position:absolute;top:910px;left:508px;white-space:nowrap" class="ft7128">;</p>
<p style="position:absolute;top:910px;left:515px;white-space:nowrap" class="ft7129">P&#160;K</p>
<p style="position:absolute;top:908px;left:540px;white-space:nowrap" class="ft7143">S</p>
<p style="position:absolute;top:918px;left:539px;white-space:nowrap" class="ft7143">AIK</p>
<p style="position:absolute;top:910px;left:566px;white-space:nowrap" class="ft7128">)</p>
<p style="position:absolute;top:928px;left:252px;white-space:nowrap" class="ft7133">⇒</p>
<p style="position:absolute;top:928px;left:271px;white-space:nowrap" class="ft71113">SKAE</p>
<p style="position:absolute;top:926px;left:314px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:929px;left:326px;white-space:nowrap" class="ft7117"><b>authenticated</b></p>
<p style="position:absolute;top:946px;left:252px;white-space:nowrap" class="ft71113">cert</p>
<p style="position:absolute;top:944px;left:278px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:953px;left:276px;white-space:nowrap" class="ft71114">AIK</p>
<p style="position:absolute;top:947px;left:301px;white-space:nowrap" class="ft7112">:=</p>
<p style="position:absolute;top:946px;left:318px;white-space:nowrap" class="ft7133">{</p>
<p style="position:absolute;top:946px;left:329px;white-space:nowrap" class="ft71113">PK</p>
<p style="position:absolute;top:944px;left:353px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:953px;left:351px;white-space:nowrap" class="ft71114">AIK</p>
<p style="position:absolute;top:947px;left:376px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:946px;left:384px;white-space:nowrap" class="ft71113">SigCA</p>
<p style="position:absolute;top:944px;left:425px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:953px;left:425px;white-space:nowrap" class="ft71114">AIK</p>
<p style="position:absolute;top:946px;left:454px;white-space:nowrap" class="ft7133">}</p>
<p style="position:absolute;top:964px;left:252px;white-space:nowrap" class="ft7129">eval</p>
<p style="position:absolute;top:964px;left:283px;white-space:nowrap" class="ft7128">:</p>
<p style="position:absolute;top:964px;left:291px;white-space:nowrap" class="ft7129">digest</p>
<p style="position:absolute;top:964px;left:331px;white-space:nowrap" class="ft7128">(</p>
<p style="position:absolute;top:964px;left:337px;white-space:nowrap" class="ft71113">cert</p>
<p style="position:absolute;top:962px;left:363px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:971px;left:361px;white-space:nowrap" class="ft71114">AIK</p>
<p style="position:absolute;top:964px;left:390px;white-space:nowrap" class="ft7128">)</p>
<p style="position:absolute;top:964px;left:400px;white-space:nowrap" class="ft7133">←</p>
<p style="position:absolute;top:964px;left:419px;white-space:nowrap" class="ft71113">dec</p>
<p style="position:absolute;top:964px;left:441px;white-space:nowrap" class="ft7128">(</p>
<p style="position:absolute;top:964px;left:447px;white-space:nowrap" class="ft71113">SigCA</p>
<p style="position:absolute;top:962px;left:488px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:971px;left:488px;white-space:nowrap" class="ft71114">AIK</p>
<p style="position:absolute;top:964px;left:517px;white-space:nowrap" class="ft7128">;</p>
<p style="position:absolute;top:964px;left:524px;white-space:nowrap" class="ft7129">P&#160;K</p>
<p style="position:absolute;top:970px;left:549px;white-space:nowrap" class="ft7143">CA</p>
<p style="position:absolute;top:964px;left:568px;white-space:nowrap" class="ft7128">)</p>
<p style="position:absolute;top:981px;left:252px;white-space:nowrap" class="ft7133">⇒</p>
<p style="position:absolute;top:982px;left:271px;white-space:nowrap" class="ft71113">K</p>
<p style="position:absolute;top:980px;left:284px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:989px;left:282px;white-space:nowrap" class="ft71114">AIK</p>
<p style="position:absolute;top:982px;left:311px;white-space:nowrap" class="ft7117"><b>authenticated</b></p>
<p style="position:absolute;top:999px;left:252px;white-space:nowrap" class="ft7133">⇒</p>
<p style="position:absolute;top:1000px;left:271px;white-space:nowrap" class="ft7117"><b>TCB&#160;of</b></p>
<p style="position:absolute;top:999px;left:321px;white-space:nowrap" class="ft7133">S</p>
<p style="position:absolute;top:1000px;left:335px;white-space:nowrap" class="ft7117"><b>is&#160;in&#160;the&#160;state&#160;included&#160;in</b></p>
<p style="position:absolute;top:1000px;left:497px;white-space:nowrap" class="ft71113">SKAE</p>
<p style="position:absolute;top:998px;left:540px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:1000px;left:552px;white-space:nowrap" class="ft7117"><b>when</b></p>
<p style="position:absolute;top:1000px;left:590px;white-space:nowrap" class="ft71113">SK</p>
<p style="position:absolute;top:998px;left:612px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:1007px;left:610px;white-space:nowrap" class="ft71114">SKAE</p>
<p style="position:absolute;top:1000px;left:649px;white-space:nowrap" class="ft7117"><b>is&#160;used</b></p>
<p style="position:absolute;top:1017px;left:252px;white-space:nowrap" class="ft7129">eval</p>
<p style="position:absolute;top:1017px;left:283px;white-space:nowrap" class="ft7128">:</p>
<p style="position:absolute;top:1017px;left:291px;white-space:nowrap" class="ft7129">digest</p>
<p style="position:absolute;top:1017px;left:331px;white-space:nowrap" class="ft7128">(</p>
<p style="position:absolute;top:1018px;left:337px;white-space:nowrap" class="ft71113">PK</p>
<p style="position:absolute;top:1016px;left:361px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:1025px;left:359px;white-space:nowrap" class="ft71114">sign</p>
<p style="position:absolute;top:1018px;left:382px;white-space:nowrap" class="ft7112">,</p>
<p style="position:absolute;top:1018px;left:389px;white-space:nowrap" class="ft71113">PK</p>
<p style="position:absolute;top:1016px;left:413px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:1025px;left:411px;white-space:nowrap" class="ft71114">enc</p>
<p style="position:absolute;top:1017px;left:434px;white-space:nowrap" class="ft7128">)</p>
<p style="position:absolute;top:1017px;left:444px;white-space:nowrap" class="ft7133">←</p>
<p style="position:absolute;top:1018px;left:463px;white-space:nowrap" class="ft71113">dec</p>
<p style="position:absolute;top:1017px;left:485px;white-space:nowrap" class="ft7128">(</p>
<p style="position:absolute;top:1018px;left:490px;white-space:nowrap" class="ft71113">Sig</p>
<p style="position:absolute;top:1016px;left:512px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:1025px;left:510px;white-space:nowrap" class="ft71114">BSEK</p>
<p style="position:absolute;top:1017px;left:550px;white-space:nowrap" class="ft7128">;</p>
<p style="position:absolute;top:1017px;left:556px;white-space:nowrap" class="ft7129">P&#160;K</p>
<p style="position:absolute;top:1016px;left:582px;white-space:nowrap" class="ft7143">S</p>
<p style="position:absolute;top:1025px;left:581px;white-space:nowrap" class="ft7143">SKAE</p>
<p style="position:absolute;top:1017px;left:618px;white-space:nowrap" class="ft7128">)</p>
<p style="position:absolute;top:1037px;left:252px;white-space:nowrap" class="ft7133">⇒</p>
<p style="position:absolute;top:1038px;left:272px;white-space:nowrap" class="ft7117"><b>TCB&#160;of</b></p>
<p style="position:absolute;top:1037px;left:325px;white-space:nowrap" class="ft7133">S</p>
<p style="position:absolute;top:1038px;left:340px;white-space:nowrap" class="ft7117"><b>is&#160;in&#160;the&#160;state&#160;included&#160;in</b></p>
<p style="position:absolute;top:1038px;left:509px;white-space:nowrap" class="ft71113">SKAE</p>
<p style="position:absolute;top:1036px;left:552px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:1038px;left:566px;white-space:nowrap" class="ft7117"><b>because</b></p>
<p style="position:absolute;top:1038px;left:621px;white-space:nowrap" class="ft71113">PK</p>
<p style="position:absolute;top:1036px;left:645px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:1045px;left:642px;white-space:nowrap" class="ft71114">sign</p>
<p style="position:absolute;top:1038px;left:666px;white-space:nowrap" class="ft7117"><b>,</b></p>
<p style="position:absolute;top:1038px;left:675px;white-space:nowrap" class="ft71113">PK</p>
<p style="position:absolute;top:1036px;left:698px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:1045px;left:696px;white-space:nowrap" class="ft71114">enc</p>
<p style="position:absolute;top:1058px;left:252px;white-space:nowrap" class="ft7117"><b>were&#160;signed&#160;by</b></p>
<p style="position:absolute;top:1058px;left:354px;white-space:nowrap" class="ft71113">SK</p>
<p style="position:absolute;top:1055px;left:376px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:1065px;left:373px;white-space:nowrap" class="ft71114">SKAE</p>
<p style="position:absolute;top:1058px;left:414px;white-space:nowrap" class="ft7117"><b>and&#160;a&#160;state&#160;change&#160;of&#160;the&#160;TCB&#160;is&#160;only&#160;possible</b></p>
<p style="position:absolute;top:1076px;left:252px;white-space:nowrap" class="ft7117"><b>with&#160;a&#160;following&#160;reboot&#160;and&#160;the&#160;creation&#160;of&#160;a&#160;new</b></p>
<p style="position:absolute;top:1076px;left:566px;white-space:nowrap" class="ft71113">Sig</p>
<p style="position:absolute;top:1073px;left:587px;white-space:nowrap" class="ft71114">S</p>
<p style="position:absolute;top:1083px;left:586px;white-space:nowrap" class="ft71114">BSEK</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft7118">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 72 -->
<a name="72"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft72127{font-size:10px;font-family:Times;color:#000000;}
	.ft72128{font-size:9px;font-family:Times;color:#000000;}
	.ft72129{font-size:9px;font-family:CNTUYP+CMSY6;color:#000000;}
-->
</style>
<div id="page72-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL072.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft7212">70</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft7218">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:189px;left:150px;white-space:nowrap" class="ft7220"><b>A.3</b></p>
<p style="position:absolute;top:189px;left:203px;white-space:nowrap" class="ft7220"><b>State-Change&#160;Protocol&#160;Flow</b></p>
<p style="position:absolute;top:227px;left:150px;white-space:nowrap" class="ft7212">To&#160;be&#160;able&#160;to&#160;transfer&#160;information&#160;about&#160;a&#160;state&#160;change&#160;we&#160;defined</p>
<p style="position:absolute;top:226px;left:552px;white-space:nowrap" class="ft72113">SCExt</p>
<p style="position:absolute;top:227px;left:599px;white-space:nowrap" class="ft7212">that&#160;carries</p>
<p style="position:absolute;top:245px;left:150px;white-space:nowrap" class="ft7212">encrypted&#160;configuration&#160;information<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#72">.</a></p>
<p style="position:absolute;top:242px;left:371px;white-space:nowrap" class="ft7221"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#72">4</a></p>
<p style="position:absolute;top:245px;left:381px;white-space:nowrap" class="ft7212">In&#160;the&#160;following&#160;we&#160;present&#160;the&#160;protocol&#160;flow&#160;in</p>
<p style="position:absolute;top:263px;left:150px;white-space:nowrap" class="ft7212">case&#160;of&#160;a&#160;state&#160;change&#160;on</p>
<p style="position:absolute;top:262px;left:302px;white-space:nowrap" class="ft7233">S</p>
<p style="position:absolute;top:263px;left:312px;white-space:nowrap" class="ft7212">.&#160;State&#160;changes&#160;on</p>
<p style="position:absolute;top:262px;left:424px;white-space:nowrap" class="ft7233">C</p>
<p style="position:absolute;top:263px;left:437px;white-space:nowrap" class="ft7212">are&#160;managed&#160;accordingly.</p>
<p style="position:absolute;top:285px;left:150px;white-space:nowrap" class="ft7217"><b>Notifying&#160;State&#160;Change:&#160;</b>If&#160;the&#160;monitoring&#160;component&#160;of</p>
<p style="position:absolute;top:285px;left:498px;white-space:nowrap" class="ft72113">CM</p>
<p style="position:absolute;top:283px;left:525px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:285px;left:537px;white-space:nowrap" class="ft7212">detects&#160;a&#160;state&#160;change</p>
<p style="position:absolute;top:303px;left:150px;white-space:nowrap" class="ft7212">within&#160;an&#160;involved&#160;compartment,</p>
<p style="position:absolute;top:303px;left:360px;white-space:nowrap" class="ft72113">CDS</p>
<p style="position:absolute;top:300px;left:392px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:303px;left:407px;white-space:nowrap" class="ft7212">is&#160;updated&#160;to</p>
<p style="position:absolute;top:303px;left:493px;white-space:nowrap" class="ft72113">CDS</p>
<p style="position:absolute;top:302px;left:525px;white-space:nowrap" class="ft72120">′</p>
<p style="position:absolute;top:300px;left:529px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:303px;left:543px;white-space:nowrap" class="ft7212">by</p>
<p style="position:absolute;top:303px;left:564px;white-space:nowrap" class="ft72113">CM</p>
<p style="position:absolute;top:300px;left:591px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:303px;left:600px;white-space:nowrap" class="ft7212">.</p>
<p style="position:absolute;top:303px;left:614px;white-space:nowrap" class="ft72113">TM</p>
<p style="position:absolute;top:300px;left:641px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:303px;left:655px;white-space:nowrap" class="ft7212">is</p>
<p style="position:absolute;top:321px;left:150px;white-space:nowrap" class="ft7212">notified&#160;that&#160;a&#160;state&#160;change&#160;occurred.&#160;As&#160;consequence</p>
<p style="position:absolute;top:321px;left:495px;white-space:nowrap" class="ft72113">TM</p>
<p style="position:absolute;top:318px;left:521px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:321px;left:536px;white-space:nowrap" class="ft7212">can&#160;restrict&#160;access&#160;to</p>
<p style="position:absolute;top:339px;left:150px;white-space:nowrap" class="ft72113">SeK</p>
<p style="position:absolute;top:339px;left:184px;white-space:nowrap" class="ft7212">and&#160;data&#160;belonging&#160;to</p>
<p style="position:absolute;top:339px;left:325px;white-space:nowrap" class="ft72113">sessionID</p>
<p style="position:absolute;top:339px;left:395px;white-space:nowrap" class="ft7212">depending&#160;on&#160;the&#160;security&#160;policy&#160;of&#160;the&#160;ap-</p>
<p style="position:absolute;top:357px;left:150px;white-space:nowrap" class="ft7212">plication.&#160;Thus,&#160;access&#160;to&#160;data&#160;could&#160;be&#160;barred&#160;to</p>
<p style="position:absolute;top:356px;left:472px;white-space:nowrap" class="ft72113">compID</p>
<p style="position:absolute;top:357px;left:524px;white-space:nowrap" class="ft7212">.&#160;Then</p>
<p style="position:absolute;top:356px;left:576px;white-space:nowrap" class="ft72113">TM</p>
<p style="position:absolute;top:354px;left:602px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:357px;left:617px;white-space:nowrap" class="ft7212">issues&#160;a</p>
<p style="position:absolute;top:375px;left:150px;white-space:nowrap" class="ft7212">command&#160;to&#160;trigger</p>
<p style="position:absolute;top:374px;left:272px;white-space:nowrap" class="ft72113">TLS</p>
<p style="position:absolute;top:375px;left:302px;white-space:nowrap" class="ft7212">_</p>
<p style="position:absolute;top:374px;left:310px;white-space:nowrap" class="ft72113">frontend</p>
<p style="position:absolute;top:372px;left:365px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:375px;left:378px;white-space:nowrap" class="ft7212">to&#160;send&#160;a</p>
<p style="position:absolute;top:374px;left:435px;white-space:nowrap" class="ft72113">HelloRequest</p>
<p style="position:absolute;top:375px;left:523px;white-space:nowrap" class="ft7212">indicating&#160;that&#160;some&#160;re-</p>
<p style="position:absolute;top:393px;left:150px;white-space:nowrap" class="ft7212">handshake&#160;is&#160;necessary.&#160;As&#160;reaction&#160;to&#160;the</p>
<p style="position:absolute;top:392px;left:410px;white-space:nowrap" class="ft72113">HelloRequest</p>
<p style="position:absolute;top:393px;left:499px;white-space:nowrap" class="ft7212">the</p>
<p style="position:absolute;top:392px;left:521px;white-space:nowrap" class="ft72113">TLS</p>
<p style="position:absolute;top:393px;left:551px;white-space:nowrap" class="ft7212">_</p>
<p style="position:absolute;top:392px;left:559px;white-space:nowrap" class="ft72113">frontend</p>
<p style="position:absolute;top:390px;left:615px;white-space:nowrap" class="ft72114">C</p>
<p style="position:absolute;top:393px;left:630px;white-space:nowrap" class="ft7212">issues</p>
<p style="position:absolute;top:411px;left:150px;white-space:nowrap" class="ft7212">a</p>
<p style="position:absolute;top:410px;left:160px;white-space:nowrap" class="ft72113">ClientHello</p>
<p style="position:absolute;top:411px;left:239px;white-space:nowrap" class="ft7212">message&#160;that&#160;comprises</p>
<p style="position:absolute;top:410px;left:384px;white-space:nowrap" class="ft72113">sessionID</p>
<p style="position:absolute;top:411px;left:448px;white-space:nowrap" class="ft7212">,</p>
<p style="position:absolute;top:410px;left:456px;white-space:nowrap" class="ft72113">nonce</p>
<p style="position:absolute;top:410px;left:494px;white-space:nowrap" class="ft72120">′</p>
<p style="position:absolute;top:408px;left:498px;white-space:nowrap" class="ft72114">C</p>
<p style="position:absolute;top:411px;left:513px;white-space:nowrap" class="ft7212">and&#160;an</p>
<p style="position:absolute;top:410px;left:557px;white-space:nowrap" class="ft72113">SCExt</p>
<p style="position:absolute;top:408px;left:599px;white-space:nowrap" class="ft72114">C</p>
<p style="position:absolute;top:411px;left:614px;white-space:nowrap" class="ft7212">included</p>
<p style="position:absolute;top:429px;left:150px;white-space:nowrap" class="ft7212">in&#160;the</p>
<p style="position:absolute;top:428px;left:189px;white-space:nowrap" class="ft72113">hello</p>
<p style="position:absolute;top:429px;left:220px;white-space:nowrap" class="ft7212">_</p>
<p style="position:absolute;top:428px;left:228px;white-space:nowrap" class="ft72113">ext</p>
<p style="position:absolute;top:429px;left:248px;white-space:nowrap" class="ft7212">_</p>
<p style="position:absolute;top:428px;left:256px;white-space:nowrap" class="ft72113">list</p>
<p style="position:absolute;top:426px;left:276px;white-space:nowrap" class="ft72114">C</p>
<p style="position:absolute;top:429px;left:292px;white-space:nowrap" class="ft7212">to&#160;inform</p>
<p style="position:absolute;top:428px;left:354px;white-space:nowrap" class="ft7233">S</p>
<p style="position:absolute;top:429px;left:368px;white-space:nowrap" class="ft7212">that&#160;no&#160;state&#160;change&#160;occurred&#160;on</p>
<p style="position:absolute;top:428px;left:570px;white-space:nowrap" class="ft7233">C</p>
<p style="position:absolute;top:429px;left:579px;white-space:nowrap" class="ft7212"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#72">.</a></p>
<p style="position:absolute;top:426px;left:583px;white-space:nowrap" class="ft7221"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#72">5</a></p>
<p style="position:absolute;top:429px;left:589px;white-space:nowrap" class="ft7212"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#72">.</a></p>
<p style="position:absolute;top:428px;left:600px;white-space:nowrap" class="ft72113">TM</p>
<p style="position:absolute;top:426px;left:626px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:429px;left:640px;white-space:nowrap" class="ft7212">asks</p>
<p style="position:absolute;top:446px;left:150px;white-space:nowrap" class="ft72113">CM</p>
<p style="position:absolute;top:444px;left:176px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:447px;left:189px;white-space:nowrap" class="ft7212">for</p>
<p style="position:absolute;top:446px;left:210px;white-space:nowrap" class="ft72113">CDS</p>
<p style="position:absolute;top:446px;left:242px;white-space:nowrap" class="ft72120">′</p>
<p style="position:absolute;top:444px;left:246px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:447px;left:255px;white-space:nowrap" class="ft7212">.&#160;Subsequently,</p>
<p style="position:absolute;top:446px;left:350px;white-space:nowrap" class="ft72113">TM</p>
<p style="position:absolute;top:444px;left:376px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:447px;left:389px;white-space:nowrap" class="ft7212">composes</p>
<p style="position:absolute;top:446px;left:452px;white-space:nowrap" class="ft72113">properties</p>
<p style="position:absolute;top:446px;left:516px;white-space:nowrap" class="ft72120">′</p>
<p style="position:absolute;top:444px;left:520px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:447px;left:529px;white-space:nowrap" class="ft7212">.</p>
<p style="position:absolute;top:488px;left:176px;white-space:nowrap" class="ft72113">properties</p>
<p style="position:absolute;top:488px;left:240px;white-space:nowrap" class="ft72120">′</p>
<p style="position:absolute;top:489px;left:244px;white-space:nowrap" class="ft7212">:=&#160;This&#160;data&#160;structure&#160;comprises&#160;the</p>
<p style="position:absolute;top:488px;left:466px;white-space:nowrap" class="ft72113">CDS</p>
<p style="position:absolute;top:488px;left:498px;white-space:nowrap" class="ft72120">′</p>
<p style="position:absolute;top:489px;left:502px;white-space:nowrap" class="ft7212">,&#160;additional&#160;certificates</p>
<p style="position:absolute;top:507px;left:264px;white-space:nowrap" class="ft7212">and/or&#160;links&#160;to&#160;reference&#160;values&#160;for&#160;the&#160;evaluation&#160;of</p>
<p style="position:absolute;top:506px;left:580px;white-space:nowrap" class="ft72113">CDS</p>
<p style="position:absolute;top:506px;left:612px;white-space:nowrap" class="ft72120">′</p>
<p style="position:absolute;top:507px;left:616px;white-space:nowrap" class="ft7212">.</p>
<p style="position:absolute;top:555px;left:150px;white-space:nowrap" class="ft7212">Then</p>
<p style="position:absolute;top:555px;left:185px;white-space:nowrap" class="ft72113">TM</p>
<p style="position:absolute;top:553px;left:211px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:555px;left:224px;white-space:nowrap" class="ft7212">creates</p>
<p style="position:absolute;top:555px;left:270px;white-space:nowrap" class="ft72113">Sig</p>
<p style="position:absolute;top:553px;left:291px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:563px;left:290px;white-space:nowrap" class="ft72114">stateChange</p>
<p style="position:absolute;top:555px;left:360px;white-space:nowrap" class="ft7212">by&#160;signing&#160;a&#160;digest&#160;of&#160;the&#160;nonces&#160;and</p>
<p style="position:absolute;top:555px;left:588px;white-space:nowrap" class="ft72113">properties</p>
<p style="position:absolute;top:554px;left:653px;white-space:nowrap" class="ft72120">′</p>
<p style="position:absolute;top:553px;left:656px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:576px;left:150px;white-space:nowrap" class="ft7212">using</p>
<p style="position:absolute;top:575px;left:186px;white-space:nowrap" class="ft72113">SK</p>
<p style="position:absolute;top:573px;left:208px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:582px;left:206px;white-space:nowrap" class="ft72114">sign</p>
<p style="position:absolute;top:576px;left:229px;white-space:nowrap" class="ft7212">.</p>
<p style="position:absolute;top:622px;left:176px;white-space:nowrap" class="ft72113">Sig</p>
<p style="position:absolute;top:627px;left:195px;white-space:nowrap" class="ft72114">stateChange</p>
<p style="position:absolute;top:621px;left:266px;white-space:nowrap" class="ft7233">←</p>
<p style="position:absolute;top:622px;left:285px;white-space:nowrap" class="ft72113">sign</p>
<p style="position:absolute;top:621px;left:312px;white-space:nowrap" class="ft7228">(</p>
<p style="position:absolute;top:622px;left:318px;white-space:nowrap" class="ft72113">digest</p>
<p style="position:absolute;top:621px;left:356px;white-space:nowrap" class="ft7228">(</p>
<p style="position:absolute;top:622px;left:362px;white-space:nowrap" class="ft72113">nonce</p>
<p style="position:absolute;top:621px;left:401px;white-space:nowrap" class="ft72120">′</p>
<p style="position:absolute;top:619px;left:404px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:622px;left:413px;white-space:nowrap" class="ft7212">,</p>
<p style="position:absolute;top:622px;left:420px;white-space:nowrap" class="ft72113">nonce</p>
<p style="position:absolute;top:621px;left:459px;white-space:nowrap" class="ft72120">′</p>
<p style="position:absolute;top:619px;left:462px;white-space:nowrap" class="ft72114">C</p>
<p style="position:absolute;top:622px;left:473px;white-space:nowrap" class="ft7212">,</p>
<p style="position:absolute;top:622px;left:481px;white-space:nowrap" class="ft72113">properties</p>
<p style="position:absolute;top:621px;left:545px;white-space:nowrap" class="ft72120">′</p>
<p style="position:absolute;top:619px;left:549px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:621px;left:562px;white-space:nowrap" class="ft7228">);</p>
<p style="position:absolute;top:621px;left:574px;white-space:nowrap" class="ft7229">SK</p>
<p style="position:absolute;top:627px;left:597px;white-space:nowrap" class="ft7243">sign</p>
<p style="position:absolute;top:621px;left:621px;white-space:nowrap" class="ft7228"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#72">)</a></p>
<p style="position:absolute;top:620px;left:627px;white-space:nowrap" class="ft72127"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#72"><i>a</i></a></p>
<p style="position:absolute;top:650px;left:192px;white-space:nowrap" class="ft72128"><i>a</i></p>
<p style="position:absolute;top:652px;left:197px;white-space:nowrap" class="ft7210">In&#160;case&#160;of&#160;a&#160;state&#160;change&#160;on</p>
<p style="position:absolute;top:651px;left:332px;white-space:nowrap" class="ft72117">C</p>
<p style="position:absolute;top:652px;left:342px;white-space:nowrap" class="ft7210">only</p>
<p style="position:absolute;top:652px;left:366px;white-space:nowrap" class="ft72115">nonce</p>
<p style="position:absolute;top:651px;left:399px;white-space:nowrap" class="ft72129">′</p>
<p style="position:absolute;top:650px;left:402px;white-space:nowrap" class="ft72116">C</p>
<p style="position:absolute;top:652px;left:415px;white-space:nowrap" class="ft7210">is&#160;included.</p>
<p style="position:absolute;top:700px;left:150px;white-space:nowrap" class="ft7212">In&#160;the&#160;next&#160;step</p>
<p style="position:absolute;top:700px;left:245px;white-space:nowrap" class="ft72113">SCExt</p>
<p style="position:absolute;top:697px;left:288px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:700px;left:300px;white-space:nowrap" class="ft7212">is&#160;composed&#160;and&#160;given&#160;to</p>
<p style="position:absolute;top:700px;left:455px;white-space:nowrap" class="ft72113">TLS</p>
<p style="position:absolute;top:700px;left:485px;white-space:nowrap" class="ft7212">_</p>
<p style="position:absolute;top:700px;left:493px;white-space:nowrap" class="ft72113">frontend</p>
<p style="position:absolute;top:697px;left:549px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:700px;left:557px;white-space:nowrap" class="ft7212">.</p>
<p style="position:absolute;top:742px;left:176px;white-space:nowrap" class="ft72113">SCExt</p>
<p style="position:absolute;top:742px;left:218px;white-space:nowrap" class="ft7212">:=</p>
<p style="position:absolute;top:741px;left:235px;white-space:nowrap" class="ft7233">{</p>
<p style="position:absolute;top:742px;left:242px;white-space:nowrap" class="ft72113">Sig</p>
<p style="position:absolute;top:747px;left:262px;white-space:nowrap" class="ft72114">stateChange</p>
<p style="position:absolute;top:742px;left:328px;white-space:nowrap" class="ft7212">,</p>
<p style="position:absolute;top:742px;left:336px;white-space:nowrap" class="ft72113">properties</p>
<p style="position:absolute;top:741px;left:400px;white-space:nowrap" class="ft72120">′</p>
<p style="position:absolute;top:741px;left:408px;white-space:nowrap" class="ft7233">}</p>
<p style="position:absolute;top:795px;left:150px;white-space:nowrap" class="ft72113">TLS</p>
<p style="position:absolute;top:795px;left:180px;white-space:nowrap" class="ft7212">_</p>
<p style="position:absolute;top:795px;left:188px;white-space:nowrap" class="ft72113">frontend</p>
<p style="position:absolute;top:793px;left:243px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:795px;left:258px;white-space:nowrap" class="ft7212">sends&#160;the&#160;same</p>
<p style="position:absolute;top:795px;left:357px;white-space:nowrap" class="ft72113">sessionID</p>
<p style="position:absolute;top:795px;left:427px;white-space:nowrap" class="ft7212">as</p>
<p style="position:absolute;top:794px;left:446px;white-space:nowrap" class="ft7233">C</p>
<p style="position:absolute;top:795px;left:454px;white-space:nowrap" class="ft7212">,</p>
<p style="position:absolute;top:795px;left:464px;white-space:nowrap" class="ft72113">nonce</p>
<p style="position:absolute;top:794px;left:503px;white-space:nowrap" class="ft72120">′</p>
<p style="position:absolute;top:793px;left:506px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:795px;left:521px;white-space:nowrap" class="ft7212">and</p>
<p style="position:absolute;top:795px;left:548px;white-space:nowrap" class="ft72113">SCExt</p>
<p style="position:absolute;top:793px;left:591px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:795px;left:606px;white-space:nowrap" class="ft7212">indicating</p>
<p style="position:absolute;top:813px;left:150px;white-space:nowrap" class="ft7212">that&#160;its&#160;state&#160;has&#160;changed&#160;using</p>
<p style="position:absolute;top:813px;left:339px;white-space:nowrap" class="ft72113">ServerHello</p>
<p style="position:absolute;top:813px;left:416px;white-space:nowrap" class="ft7212">.&#160;Now</p>
<p style="position:absolute;top:812px;left:458px;white-space:nowrap" class="ft7233">C</p>
<p style="position:absolute;top:813px;left:471px;white-space:nowrap" class="ft7212">is&#160;aware&#160;that&#160;this&#160;is&#160;not&#160;a&#160;normal</p>
<p style="position:absolute;top:831px;left:150px;white-space:nowrap" class="ft7212">resume&#160;message&#160;exchange&#160;and</p>
<p style="position:absolute;top:831px;left:337px;white-space:nowrap" class="ft72113">Sig</p>
<p style="position:absolute;top:829px;left:358px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:838px;left:357px;white-space:nowrap" class="ft72114">stateChange</p>
<p style="position:absolute;top:831px;left:424px;white-space:nowrap" class="ft7212">,</p>
<p style="position:absolute;top:831px;left:431px;white-space:nowrap" class="ft72113">properties</p>
<p style="position:absolute;top:830px;left:496px;white-space:nowrap" class="ft72120">′</p>
<p style="position:absolute;top:829px;left:499px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:831px;left:512px;white-space:nowrap" class="ft7212">sent&#160;within</p>
<p style="position:absolute;top:831px;left:582px;white-space:nowrap" class="ft72113">SCExt</p>
<p style="position:absolute;top:829px;left:625px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:831px;left:638px;white-space:nowrap" class="ft7212">have</p>
<p style="position:absolute;top:849px;left:150px;white-space:nowrap" class="ft7212">to&#160;be&#160;evaluated.</p>
<p style="position:absolute;top:872px;left:150px;white-space:nowrap" class="ft7217"><b>Updating&#160;Session&#160;Key:</b></p>
<p style="position:absolute;top:871px;left:301px;white-space:nowrap" class="ft72113">nonce</p>
<p style="position:absolute;top:871px;left:340px;white-space:nowrap" class="ft72120">′</p>
<p style="position:absolute;top:869px;left:343px;white-space:nowrap" class="ft72114">C</p>
<p style="position:absolute;top:872px;left:358px;white-space:nowrap" class="ft7212">and</p>
<p style="position:absolute;top:871px;left:384px;white-space:nowrap" class="ft72113">nonce</p>
<p style="position:absolute;top:871px;left:423px;white-space:nowrap" class="ft72120">′</p>
<p style="position:absolute;top:869px;left:426px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:872px;left:440px;white-space:nowrap" class="ft7212">are&#160;mingled&#160;with&#160;the&#160;existing</p>
<p style="position:absolute;top:871px;left:620px;white-space:nowrap" class="ft72113">SeK</p>
<p style="position:absolute;top:872px;left:654px;white-space:nowrap" class="ft7212">to</p>
<p style="position:absolute;top:890px;left:150px;white-space:nowrap" class="ft7212">form</p>
<p style="position:absolute;top:889px;left:183px;white-space:nowrap" class="ft72113">SeK</p>
<p style="position:absolute;top:889px;left:211px;white-space:nowrap" class="ft72120">′</p>
<p style="position:absolute;top:890px;left:219px;white-space:nowrap" class="ft7212">(cf.&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[19]</a>).&#160;This&#160;is&#160;done&#160;on&#160;both&#160;sides,&#160;i.e.,&#160;also&#160;on</p>
<p style="position:absolute;top:889px;left:516px;white-space:nowrap" class="ft7233">S</p>
<p style="position:absolute;top:890px;left:530px;white-space:nowrap" class="ft7212">where&#160;the&#160;state&#160;change</p>
<p style="position:absolute;top:908px;left:150px;white-space:nowrap" class="ft7212">occurred.&#160;This&#160;is&#160;necessary&#160;to&#160;get</p>
<p style="position:absolute;top:907px;left:354px;white-space:nowrap" class="ft72113">SeK</p>
<p style="position:absolute;top:907px;left:382px;white-space:nowrap" class="ft72120">′</p>
<p style="position:absolute;top:908px;left:390px;white-space:nowrap" class="ft7212">on&#160;both&#160;sides.&#160;If&#160;the&#160;new&#160;state&#160;does&#160;not&#160;satisfy</p>
<p style="position:absolute;top:926px;left:150px;white-space:nowrap" class="ft7215">the&#160;security&#160;policy&#160;of&#160;the&#160;application,&#160;all&#160;data&#160;exchanged&#160;until&#160;this&#160;very&#160;moment&#160;and<br/>the&#160;corresponding</p>
<p style="position:absolute;top:943px;left:262px;white-space:nowrap" class="ft72113">SeK</p>
<p style="position:absolute;top:943px;left:294px;white-space:nowrap" class="ft7212">are&#160;treated&#160;depending&#160;on&#160;that&#160;policy,&#160;that&#160;means,&#160;data&#160;is&#160;either</p>
<p style="position:absolute;top:961px;left:150px;white-space:nowrap" class="ft7212">deleted&#160;on&#160;both&#160;sides&#160;by</p>
<p style="position:absolute;top:961px;left:306px;white-space:nowrap" class="ft72113">TM</p>
<p style="position:absolute;top:959px;left:333px;white-space:nowrap" class="ft72114">C</p>
<p style="position:absolute;top:961px;left:349px;white-space:nowrap" class="ft7212">and</p>
<p style="position:absolute;top:961px;left:376px;white-space:nowrap" class="ft72113">TM</p>
<p style="position:absolute;top:959px;left:403px;white-space:nowrap" class="ft72114">S</p>
<p style="position:absolute;top:961px;left:417px;white-space:nowrap" class="ft7212">or&#160;stored&#160;with&#160;the&#160;help&#160;of</p>
<p style="position:absolute;top:961px;left:581px;white-space:nowrap" class="ft72113">SM</p>
<p style="position:absolute;top:959px;left:606px;white-space:nowrap" class="ft72114">C</p>
<p style="position:absolute;top:961px;left:622px;white-space:nowrap" class="ft7212">as&#160;well</p>
<p style="position:absolute;top:987px;left:166px;white-space:nowrap" class="ft7222">4</p>
<p style="position:absolute;top:989px;left:171px;white-space:nowrap" class="ft7210">One&#160;could&#160;also&#160;add&#160;an&#160;additional</p>
<p style="position:absolute;top:989px;left:337px;white-space:nowrap" class="ft72115">SupplementalData</p>
<p style="position:absolute;top:989px;left:443px;white-space:nowrap" class="ft7210">message&#160;to&#160;transfer&#160;configuration&#160;information</p>
<p style="position:absolute;top:1003px;left:150px;white-space:nowrap" class="ft7210">in&#160;the&#160;resume&#160;handshake&#160;but&#160;we&#160;aimed&#160;at&#160;easy&#160;implementation&#160;and&#160;thus&#160;we&#160;chose&#160;to&#160;use</p>
<p style="position:absolute;top:1003px;left:581px;white-space:nowrap" class="ft72115">ClientHello</p>
<p style="position:absolute;top:1003px;left:648px;white-space:nowrap" class="ft7210">and</p>
<p style="position:absolute;top:1017px;left:150px;white-space:nowrap" class="ft72115">ServerHello</p>
<p style="position:absolute;top:1017px;left:220px;white-space:nowrap" class="ft7210">extensions&#160;for&#160;that&#160;purpose.&#160;But&#160;if&#160;the&#160;amount&#160;of&#160;configuration&#160;information&#160;that&#160;has&#160;to&#160;be</p>
<p style="position:absolute;top:1031px;left:150px;white-space:nowrap" class="ft7210">transferred&#160;is&#160;against&#160;our&#160;assumptions&#160;big,&#160;this&#160;possibility&#160;has&#160;to&#160;be&#160;considered.</p>
<p style="position:absolute;top:1044px;left:166px;white-space:nowrap" class="ft7222">5</p>
<p style="position:absolute;top:1046px;left:171px;white-space:nowrap" class="ft7210">In&#160;this&#160;scenario&#160;we&#160;want&#160;the&#160;server&#160;to&#160;provide&#160;information&#160;the&#160;client&#160;did&#160;not&#160;request&#160;explicitly&#160;in&#160;its</p>
<p style="position:absolute;top:1060px;left:150px;white-space:nowrap" class="ft7264">extension&#160;and&#160;this&#160;is&#160;not&#160;yet&#160;clearly&#160;specified.&#160;But&#160;in&#160;the&#160;TLS&#160;extension&#160;specification&#160;this&#160;issue&#160;is&#160;already<br/>mentioned&#160;(see&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#75">[24,&#160;</a>p.6])</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft7218">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 73 -->
<a name="73"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page73-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL073.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft7312">APPENDIX&#160;A.&#160;SOME&#160;DETAILS&#160;ON&#160;TRUSTED&#160;CHANNEL&#160;IMPLEMENTATION71</p>
<p style="position:absolute;top:193px;left:226px;white-space:nowrap" class="ft7312">as</p>
<p style="position:absolute;top:193px;left:243px;white-space:nowrap" class="ft73113">SM</p>
<p style="position:absolute;top:191px;left:267px;white-space:nowrap" class="ft73114">S</p>
<p style="position:absolute;top:193px;left:276px;white-space:nowrap" class="ft7312">,&#160;respectively<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#73">.</a></p>
<p style="position:absolute;top:191px;left:359px;white-space:nowrap" class="ft7321"><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#73">6</a></p>
<p style="position:absolute;top:193px;left:371px;white-space:nowrap" class="ft7312">Alternatively,&#160;access&#160;to&#160;this&#160;data&#160;may&#160;still&#160;be&#160;possible&#160;or&#160;only</p>
<p style="position:absolute;top:211px;left:226px;white-space:nowrap" class="ft7312">somehow&#160;restricted,&#160;but&#160;no&#160;further&#160;data&#160;is&#160;sent&#160;by&#160;the&#160;counterpart.</p>
<p style="position:absolute;top:234px;left:226px;white-space:nowrap" class="ft7312">Finally,&#160;the</p>
<p style="position:absolute;top:234px;left:301px;white-space:nowrap" class="ft73113">ChangeCipherSpec</p>
<p style="position:absolute;top:234px;left:427px;white-space:nowrap" class="ft7312">protocol&#160;is&#160;used&#160;to&#160;inform&#160;the&#160;endpoints&#160;that</p>
<p style="position:absolute;top:234px;left:708px;white-space:nowrap" class="ft73113">SeK</p>
<p style="position:absolute;top:233px;left:737px;white-space:nowrap" class="ft73120">′</p>
<p style="position:absolute;top:252px;left:226px;white-space:nowrap" class="ft7312">has&#160;to&#160;be&#160;used&#160;from&#160;now&#160;on.</p>
<p style="position:absolute;top:251px;left:404px;white-space:nowrap" class="ft73113">SeK</p>
<p style="position:absolute;top:252px;left:437px;white-space:nowrap" class="ft7312">is&#160;deleted&#160;by</p>
<p style="position:absolute;top:251px;left:518px;white-space:nowrap" class="ft73113">TM</p>
<p style="position:absolute;top:249px;left:544px;white-space:nowrap" class="ft73114">S</p>
<p style="position:absolute;top:252px;left:557px;white-space:nowrap" class="ft7312">and</p>
<p style="position:absolute;top:251px;left:583px;white-space:nowrap" class="ft73113">TM</p>
<p style="position:absolute;top:249px;left:610px;white-space:nowrap" class="ft73114">C</p>
<p style="position:absolute;top:252px;left:621px;white-space:nowrap" class="ft7312">.&#160;In&#160;the&#160;last&#160;step&#160;the</p>
<p style="position:absolute;top:269px;left:226px;white-space:nowrap" class="ft73113">Finished</p>
<p style="position:absolute;top:270px;left:286px;white-space:nowrap" class="ft7312">message&#160;is&#160;sent&#160;to&#160;check&#160;if&#160;the&#160;state&#160;change&#160;was&#160;handled&#160;properly.</p>
<p style="position:absolute;top:1072px;left:242px;white-space:nowrap" class="ft7322">6</p>
<p style="position:absolute;top:1074px;left:247px;white-space:nowrap" class="ft7310">The&#160;data&#160;is&#160;stored&#160;bound&#160;to&#160;the&#160;previous&#160;state&#160;considered&#160;acceptable&#160;if&#160;recommended&#160;by&#160;the&#160;application.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft7318">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 74 -->
<a name="74"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page74-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL074.png" alt="background image"/>
<p style="position:absolute;top:298px;left:150px;white-space:nowrap" class="ft7416"><b>Bibliography</b></p>
<p style="position:absolute;top:391px;left:157px;white-space:nowrap" class="ft7412">[1]&#160;Microsoft&#160;security&#160;advisories&#160;archive.</p>
<p style="position:absolute;top:392px;left:441px;white-space:nowrap" class="ft7459"><a href="http://www.microsoft.com/technet/security/advisory/archive.mspx">http://www.microsoft.com/</a></p>
<p style="position:absolute;top:410px;left:182px;white-space:nowrap" class="ft7459"><a href="http://www.microsoft.com/technet/security/advisory/archive.mspx">technet/security/advisory/archive.mspx</a></p>
<p style="position:absolute;top:409px;left:523px;white-space:nowrap" class="ft7412"><a href="http://www.microsoft.com/technet/security/advisory/archive.mspx">.</a></p>
<p style="position:absolute;top:439px;left:157px;white-space:nowrap" class="ft7412">[2]&#160;TrustedGRUB.</p>
<p style="position:absolute;top:439px;left:276px;white-space:nowrap" class="ft7459"><a href="http://sourceforge.net/projects/trustedgrub">http://sourceforge.net/projects/trustedgrub</a></p>
<p style="position:absolute;top:439px;left:662px;white-space:nowrap" class="ft7412"><a href="http://sourceforge.net/projects/trustedgrub">.</a></p>
<p style="position:absolute;top:469px;left:157px;white-space:nowrap" class="ft7412">[3]&#160;XSLT&#160;Transformations.</p>
<p style="position:absolute;top:469px;left:329px;white-space:nowrap" class="ft7459"><a href="http://www.w3.org/TR/xslt">http://www.w3.org/TR/xslt</a></p>
<p style="position:absolute;top:469px;left:553px;white-space:nowrap" class="ft7412"><a href="http://www.w3.org/TR/xslt">.</a></p>
<p style="position:absolute;top:498px;left:157px;white-space:nowrap" class="ft7412">[4]&#160;Advanced&#160;Micro&#160;Devices,&#160;Inc.</p>
<p style="position:absolute;top:498px;left:395px;white-space:nowrap" class="ft7412">IOMMU&#160;Architectural&#160;Specification.</p>
<p style="position:absolute;top:498px;left:642px;white-space:nowrap" class="ft7412">Ad-</p>
<p style="position:absolute;top:516px;left:182px;white-space:nowrap" class="ft7412">vanced&#160;Micro&#160;Devices,&#160;Inc.:</p>
<p style="position:absolute;top:517px;left:378px;white-space:nowrap" class="ft7459"><a href="http://www.amd.com/us-en/assets/content_type/white_papers_and_tech_docs/34434.pdf">http://www.amd.com/us-en/assets/</a></p>
<p style="position:absolute;top:535px;left:182px;white-space:nowrap" class="ft7459"><a href="http://www.amd.com/us-en/assets/content_type/white_papers_and_tech_docs/34434.pdf">content_type/white_papers_and_tech_docs/34434.pdf</a></p>
<p style="position:absolute;top:534px;left:622px;white-space:nowrap" class="ft7412"><a href="http://www.amd.com/us-en/assets/content_type/white_papers_and_tech_docs/34434.pdf">,</a></p>
<p style="position:absolute;top:534px;left:640px;white-space:nowrap" class="ft7412">Feb.</p>
<p style="position:absolute;top:552px;left:182px;white-space:nowrap" class="ft7412">2007.&#160;PID&#160;34434&#160;Rev&#160;1.20.</p>
<p style="position:absolute;top:582px;left:157px;white-space:nowrap" class="ft7412">[5]&#160;M.&#160;J.&#160;Anderson,&#160;M.&#160;Moffie,&#160;and&#160;C.&#160;I.&#160;Dalton.&#160;Towards&#160;trustworthy&#160;virtualisation</p>
<p style="position:absolute;top:600px;left:182px;white-space:nowrap" class="ft7415">environments:&#160;Xen&#160;library&#160;os&#160;security&#160;service&#160;infrastructure.&#160;Research&#160;report,&#160;HP<br/>Labs,&#160;Bristol,&#160;UK,&#160;2007.</p>
<p style="position:absolute;top:648px;left:157px;white-space:nowrap" class="ft7412">[6]&#160;A.&#160;W.&#160;Appel&#160;and&#160;E.&#160;W.&#160;Felten.&#160;Models&#160;for&#160;security&#160;policies&#160;in&#160;proof-carrying</p>
<p style="position:absolute;top:666px;left:182px;white-space:nowrap" class="ft7412">code.&#160;Technical&#160;report,&#160;Dept.&#160;of&#160;Computer&#160;Science&#160;Princeton&#160;University,&#160;2001.</p>
<p style="position:absolute;top:684px;left:182px;white-space:nowrap" class="ft7459"><a href="ftp://ftp.cs.princeton.edu/techreports/2001/636.pdf">ftp://ftp.cs.princeton.edu/techreports/2001/636.pdf</a></p>
<p style="position:absolute;top:684px;left:640px;white-space:nowrap" class="ft7412"><a href="ftp://ftp.cs.princeton.edu/techreports/2001/636.pdf">.</a></p>
<p style="position:absolute;top:714px;left:157px;white-space:nowrap" class="ft7412">[7]&#160;W.&#160;A.&#160;Arbaugh,&#160;D.&#160;J.&#160;Farber,&#160;and&#160;J.&#160;M.&#160;Smith.&#160;A&#160;secure&#160;and&#160;reliable&#160;bootstrap</p>
<p style="position:absolute;top:732px;left:182px;white-space:nowrap" class="ft7415">architecture.&#160;In&#160;<i>Proceedings&#160;of&#160;the&#160;IEEE&#160;Symposium&#160;on&#160;Research&#160;in&#160;Security<br/>and&#160;Privacy</i>,&#160;pages&#160;65–71,&#160;Oakland,&#160;CA,&#160;May&#160;1997.&#160;IEEE&#160;Computer&#160;Society,<br/>Technical&#160;Committee&#160;on&#160;Security&#160;and&#160;Privacy,&#160;IEEE&#160;Computer&#160;Society&#160;Press.</p>
<p style="position:absolute;top:797px;left:157px;white-space:nowrap" class="ft7412">[8]&#160;P.&#160;T.&#160;Barham,&#160;B.&#160;Dragovic,&#160;K.&#160;Fraser,&#160;S.&#160;Hand,&#160;T.&#160;L.&#160;Harris,&#160;A.&#160;Ho,&#160;R.&#160;Neuge-</p>
<p style="position:absolute;top:815px;left:182px;white-space:nowrap" class="ft7415">bauer,&#160;I.&#160;Pratt,&#160;and&#160;A.&#160;Warfield.&#160;Xen&#160;and&#160;the&#160;Art&#160;of&#160;Virtualization.&#160;In&#160;<i>Proc.&#160;19th<br/>ACM&#160;Symposium&#160;on&#160;Operating&#160;Systems&#160;Principles&#160;(SOSP-2003)</i>,&#160;pages&#160;164–177,<br/>October&#160;2003.</p>
<p style="position:absolute;top:881px;left:157px;white-space:nowrap" class="ft7412">[9]&#160;S.&#160;Berger,&#160;R.&#160;Cáceres,&#160;K.&#160;Goldman,&#160;R.&#160;Perez,&#160;R.&#160;Sailer,&#160;and&#160;L.&#160;van&#160;Doorn.&#160;vTPM:</p>
<p style="position:absolute;top:899px;left:182px;white-space:nowrap" class="ft7430">Virtualizing&#160;the&#160;Trusted&#160;Platform&#160;Module.&#160;In&#160;<i>Proc.&#160;15th&#160;USENIX&#160;Security&#160;Sym-<br/>posium</i>,&#160;pages&#160;21–21,&#160;Aug.&#160;2006.</p>
<p style="position:absolute;top:947px;left:150px;white-space:nowrap" class="ft7412">[10]&#160;S.&#160;Berger,&#160;R.&#160;Cáceres,&#160;D.&#160;Pendarakis,&#160;R.&#160;Sailer,&#160;E.&#160;Valdez,&#160;R.&#160;Perez,&#160;W.&#160;Schild-</p>
<p style="position:absolute;top:965px;left:182px;white-space:nowrap" class="ft7415">hauer,&#160;and&#160;D.&#160;Srinivasan.&#160;Tvdc:&#160;Managing&#160;security&#160;in&#160;the&#160;trusted&#160;virtual&#160;data-<br/>center.&#160;Technical&#160;Report&#160;RC24441&#160;(W0711-219),&#160;IBM&#160;Research&#160;Division,&#160;Nov.<br/>2007.</p>
<p style="position:absolute;top:1030px;left:150px;white-space:nowrap" class="ft7412">[11]&#160;A.&#160;Bussani,&#160;J.&#160;L.&#160;Griffin,&#160;B.&#160;Jansen,&#160;K.&#160;Julisch,&#160;G.&#160;Karjoth,&#160;H.&#160;Maruyama,</p>
<p style="position:absolute;top:1048px;left:182px;white-space:nowrap" class="ft7415">M.&#160;Nakamura,&#160;R.&#160;Perez,&#160;M.&#160;Schunter,&#160;A.&#160;Tanner,&#160;L.&#160;van&#160;Doorn,&#160;E.&#160;V.&#160;Her-<br/>reweghen,&#160;M.&#160;Waidner,&#160;and&#160;S.&#160;Yoshihama.&#160;Trusted&#160;Virtual&#160;Domains:&#160;Secure</p>
<p style="position:absolute;top:1117px;left:400px;white-space:nowrap" class="ft7412">72</p>
</div>
<!-- Page 75 -->
<a name="75"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page75-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL075.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft7512">BIBLIOGRAPHY</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft7512">73</p>
<p style="position:absolute;top:193px;left:258px;white-space:nowrap" class="ft7515">Foundation&#160;for&#160;Business&#160;and&#160;IT&#160;Services.&#160;Research&#160;Report&#160;RC&#160;23792,&#160;IBM&#160;Re-<br/>search,&#160;Nov.&#160;2005.</p>
<p style="position:absolute;top:240px;left:226px;white-space:nowrap" class="ft7512">[12]&#160;S.&#160;Cabuk,&#160;C.&#160;Dalton,&#160;H.&#160;V.&#160;Ramasamy,&#160;and&#160;M.&#160;Schunter.&#160;Towards&#160;Automated</p>
<p style="position:absolute;top:258px;left:258px;white-space:nowrap" class="ft7530">Provisioning&#160;of&#160;Secure&#160;Virtualized&#160;Networks.&#160;In&#160;<i>Proc.&#160;14th&#160;ACM&#160;Conference&#160;on<br/>Computer&#160;and&#160;Communications&#160;Security&#160;(CCS-2007)</i>,&#160;pages&#160;235–245,&#160;Oct.&#160;2007.</p>
<p style="position:absolute;top:305px;left:226px;white-space:nowrap" class="ft7512">[13]&#160;S.&#160;Cabuk&#160;and&#160;D.&#160;Plaquin.&#160;Security&#160;Services&#160;Management&#160;Interface&#160;(SSMI).&#160;In-</p>
<p style="position:absolute;top:323px;left:258px;white-space:nowrap" class="ft7512">terface&#160;document,&#160;HP&#160;Labs,&#160;Bristol,&#160;UK,&#160;2007.</p>
<p style="position:absolute;top:352px;left:226px;white-space:nowrap" class="ft7512">[14]&#160;L.&#160;Chen,&#160;R.&#160;Landfermann,&#160;H.&#160;Loehr,&#160;M.&#160;Rohe,&#160;A.-R.&#160;Sadeghi,&#160;and&#160;C.&#160;Stüble.&#160;A</p>
<p style="position:absolute;top:370px;left:258px;white-space:nowrap" class="ft7515">protocol&#160;for&#160;property-based&#160;attestation.&#160;In&#160;<i>STC&#160;’06:&#160;Proceedings&#160;of&#160;the&#160;first&#160;ACM<br/>workshop&#160;on&#160;Scalable&#160;trusted&#160;computing</i>,&#160;New&#160;York,&#160;NY,&#160;USA,&#160;Nov.&#160;2006.&#160;ACM<br/>Press.</p>
<p style="position:absolute;top:435px;left:226px;white-space:nowrap" class="ft7512">[15]&#160;P.&#160;M.&#160;Chen&#160;and&#160;B.&#160;D.&#160;Noble.&#160;When&#160;Virtual&#160;is&#160;Better&#160;than&#160;Real.&#160;In&#160;<i>Proceedings&#160;of</i></p>
<p style="position:absolute;top:453px;left:258px;white-space:nowrap" class="ft7515"><i>HotOS-VIII:&#160;8th&#160;Workshop&#160;on&#160;Hot&#160;Topics&#160;in&#160;Operating&#160;Systems</i>,&#160;pages&#160;133–138,<br/>May&#160;2001.</p>
<p style="position:absolute;top:500px;left:226px;white-space:nowrap" class="ft7512">[16]&#160;D.&#160;Chess,&#160;J.&#160;Dyer,&#160;N.&#160;Itoi,&#160;J.&#160;Kravitz,&#160;E.&#160;Palmer,&#160;R.&#160;Perez,&#160;and&#160;S.&#160;Smith.&#160;Us-</p>
<p style="position:absolute;top:518px;left:258px;white-space:nowrap" class="ft7512">ing&#160;trusted&#160;co-servers&#160;to&#160;enhance&#160;security&#160;of&#160;web&#160;interaction.</p>
<p style="position:absolute;top:518px;left:659px;white-space:nowrap" class="ft7512">United&#160;States</p>
<p style="position:absolute;top:536px;left:258px;white-space:nowrap" class="ft7512">Patent&#160;7,194,759:</p>
<p style="position:absolute;top:536px;left:374px;white-space:nowrap" class="ft7559"><a href="http://www.freepatentsonline.com/7194759.html">http://www.freepatentsonline.com/7194759.</a></p>
<p style="position:absolute;top:554px;left:258px;white-space:nowrap" class="ft7559"><a href="http://www.freepatentsonline.com/7194759.html">html</a></p>
<p style="position:absolute;top:554px;left:294px;white-space:nowrap" class="ft7512"><a href="http://www.freepatentsonline.com/7194759.html">,&#160;</a>Mar.&#160;2007.</p>
<p style="position:absolute;top:582px;left:226px;white-space:nowrap" class="ft7512">[17]&#160;J.&#160;Criswell,&#160;A.&#160;Lenharth,&#160;D.&#160;Dhurjati,&#160;and&#160;V.&#160;Adve.&#160;Secure&#160;virtual&#160;architecture:</p>
<p style="position:absolute;top:600px;left:258px;white-space:nowrap" class="ft7530">A&#160;safe&#160;execution&#160;environment&#160;for&#160;commodity&#160;operating&#160;systems.&#160;In&#160;<i>SOSP&#160;’07:<br/>Proceedings&#160;of&#160;twenty-first&#160;ACM&#160;SIGOPS&#160;symposium&#160;on&#160;Operating&#160;systems&#160;prin-<br/>ciples</i>,&#160;pages&#160;351–366,&#160;New&#160;York,&#160;NY,&#160;USA,&#160;2007.&#160;ACM.</p>
<p style="position:absolute;top:665px;left:226px;white-space:nowrap" class="ft7512">[18]&#160;I.&#160;B.&#160;Damgård,&#160;T.&#160;P.&#160;Pedersen,&#160;and&#160;B.&#160;Pfitzmann.&#160;Statistical&#160;Secrecy&#160;and&#160;Multi-</p>
<p style="position:absolute;top:683px;left:258px;white-space:nowrap" class="ft7515">Bit&#160;Commitments.&#160;<i>IEEE&#160;Transactions&#160;on&#160;Information&#160;Theory</i>,&#160;44(3):1143–1151,<br/>1998.</p>
<p style="position:absolute;top:730px;left:226px;white-space:nowrap" class="ft7512">[19]&#160;T.&#160;Dierks&#160;and&#160;E.&#160;Rescorla.&#160;The&#160;Transport&#160;Layer&#160;Security&#160;(TLS)&#160;Protocol&#160;Ver-</p>
<p style="position:absolute;top:748px;left:258px;white-space:nowrap" class="ft7512">sion&#160;1.1.&#160;Internet&#160;Engineering&#160;Task&#160;Force:</p>
<p style="position:absolute;top:749px;left:526px;white-space:nowrap" class="ft7559"><a href="http://www.ietf.org/rfc/rfc4346.txt">http://www.ietf.org/rfc/</a></p>
<p style="position:absolute;top:767px;left:258px;white-space:nowrap" class="ft7559"><a href="http://www.ietf.org/rfc/rfc4346.txt">rfc4346.txt</a></p>
<p style="position:absolute;top:766px;left:357px;white-space:nowrap" class="ft7512"><a href="http://www.ietf.org/rfc/rfc4346.txt">,&#160;</a>Apr.&#160;2006.&#160;Network&#160;Working&#160;Group&#160;RFC&#160;4346.</p>
<p style="position:absolute;top:795px;left:226px;white-space:nowrap" class="ft7512">[20]&#160;B.&#160;Dragovic,&#160;K.&#160;Fraser,&#160;S.&#160;Hand,&#160;T.&#160;Harris,&#160;A.&#160;Ho,&#160;I.&#160;Pratt,&#160;A.&#160;Warfield,&#160;P.&#160;Barham,</p>
<p style="position:absolute;top:813px;left:258px;white-space:nowrap" class="ft7530">and&#160;R.&#160;Neugebauer.&#160;Xen&#160;and&#160;the&#160;art&#160;of&#160;virtualization.&#160;In&#160;<i>Proceedings&#160;of&#160;the&#160;ACM<br/>Symposium&#160;on&#160;Operating&#160;Systems&#160;Principles</i>,&#160;October&#160;2003.</p>
<p style="position:absolute;top:860px;left:226px;white-space:nowrap" class="ft7512">[21]&#160;J.&#160;Dyer,&#160;M.&#160;Lindemann,&#160;R.&#160;Perez,&#160;R.&#160;Sailer,&#160;L.&#160;van&#160;Doorn,&#160;S.&#160;W.&#160;Smith,&#160;and</p>
<p style="position:absolute;top:878px;left:258px;white-space:nowrap" class="ft7515">S.&#160;Weingart.&#160;Building&#160;the&#160;IBM&#160;4758&#160;Secure&#160;Coprocessor.&#160;<i>IEEE&#160;Computer</i>,<br/>34(10):57–66,&#160;2001.</p>
<p style="position:absolute;top:925px;left:226px;white-space:nowrap" class="ft7512">[22]&#160;D.&#160;Eastlake&#160;and&#160;P.&#160;Jones.&#160;US&#160;Secure&#160;Hash&#160;Algorithm&#160;1&#160;(SHA1).&#160;Internet&#160;En-</p>
<p style="position:absolute;top:943px;left:258px;white-space:nowrap" class="ft7512">gineering&#160;Task&#160;Force:</p>
<p style="position:absolute;top:943px;left:397px;white-space:nowrap" class="ft7559"><a href="http://tools.ietf.org/html/rfc3174">http://tools.ietf.org/html/rfc3174</a></p>
<p style="position:absolute;top:943px;left:702px;white-space:nowrap" class="ft7512"><a href="http://tools.ietf.org/html/rfc3174">,&#160;</a>Sept.</p>
<p style="position:absolute;top:960px;left:258px;white-space:nowrap" class="ft7512">2001.&#160;Network&#160;Working&#160;Group.</p>
<p style="position:absolute;top:989px;left:226px;white-space:nowrap" class="ft7512">[23]&#160;P.&#160;England,&#160;B.&#160;Lampson,&#160;J.&#160;Manferdelli,&#160;and&#160;B.&#160;Willman.&#160;A&#160;trusted&#160;open&#160;platform.</p>
<p style="position:absolute;top:1007px;left:258px;white-space:nowrap" class="ft7511"><i>Computer</i>,&#160;36(7):55–62,&#160;2003.</p>
<p style="position:absolute;top:1036px;left:226px;white-space:nowrap" class="ft7512">[24]&#160;S.&#160;B.-W.&#160;et&#160;al.&#160;Transport&#160;Layer&#160;Security&#160;(TLS)&#160;Extensions.&#160;Internet&#160;Engineer-</p>
<p style="position:absolute;top:1054px;left:258px;white-space:nowrap" class="ft7512">ing&#160;Task&#160;Force:</p>
<p style="position:absolute;top:1055px;left:356px;white-space:nowrap" class="ft7559"><a href="http://www.ietf.org/rfc/rfc4366.txt">http://www.ietf.org/rfc/rfc4366.txt</a></p>
<p style="position:absolute;top:1054px;left:670px;white-space:nowrap" class="ft7512"><a href="http://www.ietf.org/rfc/rfc4366.txt">,&#160;</a>Apr.&#160;2006.</p>
<p style="position:absolute;top:1072px;left:258px;white-space:nowrap" class="ft7512">Network&#160;Working&#160;Group&#160;RFC&#160;4366.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft7518">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 76 -->
<a name="76"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page76-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL076.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft7612">74</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft7618">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:193px;left:150px;white-space:nowrap" class="ft7612">[25]&#160;European&#160;Multilaterally&#160;Secure&#160;Computing&#160;Base&#160;(EMSCB)&#160;Project.&#160;Towards</p>
<p style="position:absolute;top:211px;left:182px;white-space:nowrap" class="ft7612">Trustworthy&#160;Systems&#160;with&#160;Open&#160;Standards&#160;and&#160;Trusted&#160;Computing,&#160;2008.</p>
<p style="position:absolute;top:230px;left:182px;white-space:nowrap" class="ft7659"><a href="http://www.emscb.de">http://www.emscb.de</a></p>
<p style="position:absolute;top:229px;left:353px;white-space:nowrap" class="ft7612"><a href="http://www.emscb.de">.</a></p>
<p style="position:absolute;top:259px;left:150px;white-space:nowrap" class="ft7612">[26]&#160;M.&#160;Franz,&#160;D.&#160;Chandra,&#160;A.&#160;Gal,&#160;V.&#160;Haldar,&#160;C.&#160;W.&#160;Probst,&#160;F.&#160;Reig,&#160;and&#160;N.&#160;Wang.</p>
<p style="position:absolute;top:277px;left:182px;white-space:nowrap" class="ft7630">A&#160;portable&#160;virtual&#160;machine&#160;target&#160;for&#160;proof-carrying&#160;code.&#160;<i>Journal&#160;of&#160;Science<br/>of&#160;Computer&#160;Programming</i>,&#160;57(3):275–294,&#160;sep&#160;2005.</p>
<p style="position:absolute;top:295px;left:522px;white-space:nowrap" class="ft7659"><a href="http://www2.imm.dtu.dk/pubdb/p.php?4740">http://www2.imm.</a></p>
<p style="position:absolute;top:313px;left:182px;white-space:nowrap" class="ft7659"><a href="http://www2.imm.dtu.dk/pubdb/p.php?4740">dtu.dk/pubdb/p.php?4740</a></p>
<p style="position:absolute;top:312px;left:388px;white-space:nowrap" class="ft7612"><a href="http://www2.imm.dtu.dk/pubdb/p.php?4740">.</a></p>
<p style="position:absolute;top:342px;left:150px;white-space:nowrap" class="ft7612">[27]&#160;T.&#160;Garfinkel,&#160;B.&#160;Pfaff,&#160;J.&#160;Chow,&#160;M.&#160;Rosenblum,&#160;and&#160;D.&#160;Boneh.&#160;Terra:&#160;a&#160;virtual</p>
<p style="position:absolute;top:360px;left:182px;white-space:nowrap" class="ft7630">machine-based&#160;platform&#160;for&#160;trusted&#160;computing.&#160;In&#160;<i>ACM&#160;Symposium&#160;on&#160;Operating<br/>Systems&#160;Principles&#160;(ASOSP)</i>,&#160;pages&#160;193–206.&#160;ACM&#160;Press,&#160;2003.</p>
<p style="position:absolute;top:407px;left:150px;white-space:nowrap" class="ft7612">[28]&#160;Y.&#160;Gasmi,&#160;A.-R.&#160;Sadeghi,&#160;P.&#160;Stewin,&#160;M.&#160;Unger,&#160;and&#160;N.&#160;Asokan.&#160;Beyond&#160;secure</p>
<p style="position:absolute;top:425px;left:182px;white-space:nowrap" class="ft7630">channels.&#160;In&#160;<i>STC&#160;’07:&#160;Proceedings&#160;of&#160;the&#160;second&#160;ACM&#160;workshop&#160;on&#160;Scalable<br/>trusted&#160;computing</i>,&#160;pages&#160;30–40.&#160;ACM&#160;Press,&#160;2007.</p>
<p style="position:absolute;top:472px;left:150px;white-space:nowrap" class="ft7612">[29]&#160;K.&#160;Goldman,&#160;R.&#160;Perez,&#160;and&#160;R.&#160;Sailer.&#160;Linking&#160;remote&#160;attestation&#160;to&#160;secure&#160;tun-</p>
<p style="position:absolute;top:490px;left:182px;white-space:nowrap" class="ft7630">nel&#160;endpoints.&#160;In&#160;<i>STC&#160;’06:&#160;Proceedings&#160;of&#160;the&#160;first&#160;ACM&#160;workshop&#160;on&#160;Scalable<br/>trusted&#160;computing</i>,&#160;pages&#160;21–24,&#160;New&#160;York,&#160;NY,&#160;USA,&#160;Nov.&#160;2006.&#160;ACM&#160;Press.</p>
<p style="position:absolute;top:537px;left:150px;white-space:nowrap" class="ft7612">[30]&#160;O.&#160;Goldreich,&#160;S.&#160;Micali,&#160;and&#160;A.&#160;Wigderson.&#160;Proofs&#160;that&#160;Yield&#160;Nothing&#160;but&#160;their</p>
<p style="position:absolute;top:555px;left:182px;white-space:nowrap" class="ft7630">Validity,&#160;or&#160;All&#160;Languages&#160;in&#160;NP&#160;have&#160;Zero-Knowledge&#160;Proof&#160;Systems.&#160;<i>Journal<br/>of&#160;the&#160;ACM</i>,&#160;38(3):690–728,&#160;1991.</p>
<p style="position:absolute;top:603px;left:150px;white-space:nowrap" class="ft7612">[31]&#160;J.&#160;Griffin,&#160;T.&#160;Jaeger,&#160;R.&#160;Perez,&#160;R.&#160;Sailer,&#160;L.&#160;V.&#160;Doorn,&#160;and&#160;R.&#160;Caceres.&#160;Trusted</p>
<p style="position:absolute;top:621px;left:182px;white-space:nowrap" class="ft7615">Virtual&#160;Domains:&#160;Toward&#160;Secure&#160;Distributed&#160;Services.&#160;In&#160;<i>Proc.&#160;1st&#160;Workshop<br/>on&#160;Hot&#160;Topics&#160;in&#160;System&#160;Dependability&#160;(Hotdep-2005)</i>,&#160;Yokohama,&#160;Japan,&#160;June<br/>2005.&#160;IEEE&#160;Press.</p>
<p style="position:absolute;top:686px;left:150px;white-space:nowrap" class="ft7612">[32]&#160;V.&#160;Haldar,&#160;D.&#160;Chandra,&#160;and&#160;M.&#160;Franz.&#160;Semantic&#160;Remote&#160;Attestation&#160;-&#160;virtual</p>
<p style="position:absolute;top:704px;left:182px;white-space:nowrap" class="ft7615">machine&#160;directed&#160;approach&#160;to&#160;Trusted&#160;Computing.&#160;In&#160;<i>USENIX&#160;Virtual&#160;Machine<br/>Research&#160;and&#160;Technology&#160;Symposium</i>,&#160;pages&#160;29–41,&#160;2004.&#160;also&#160;Technical&#160;Report<br/>No.&#160;03-20,&#160;School&#160;of&#160;Information&#160;and&#160;Computer&#160;Science,&#160;University&#160;of&#160;Califor-<br/>nia,&#160;Irvine.</p>
<p style="position:absolute;top:787px;left:150px;white-space:nowrap" class="ft7612">[33]&#160;V.&#160;Haldar,&#160;D.&#160;Chandra,&#160;and&#160;M.&#160;Franz.&#160;Semantic&#160;remote&#160;attestation:&#160;a&#160;virtual</p>
<p style="position:absolute;top:805px;left:182px;white-space:nowrap" class="ft7615">machine&#160;directed&#160;approach&#160;to&#160;trusted&#160;computing.&#160;In&#160;<i>VM’04:&#160;Proceedings&#160;of&#160;the<br/>3rd&#160;conference&#160;on&#160;Virtual&#160;Machine&#160;Research&#160;And&#160;Technology&#160;Symposium</i>,&#160;pages<br/>3–3,&#160;Berkeley,&#160;CA,&#160;USA,&#160;2004.&#160;USENIX&#160;Association.</p>
<p style="position:absolute;top:870px;left:150px;white-space:nowrap" class="ft7612">[34]&#160;M.&#160;Hohmuth,&#160;M.&#160;Peter,&#160;H.&#160;Härtig,&#160;and&#160;J.&#160;S.&#160;Shapiro.&#160;Reducing&#160;TCB&#160;size&#160;by&#160;using</p>
<p style="position:absolute;top:888px;left:182px;white-space:nowrap" class="ft7615">untrusted&#160;components:&#160;Small&#160;kernels&#160;versus&#160;virtual-machine&#160;monitors.&#160;In&#160;<i>Pro-<br/>ceedings&#160;of&#160;the&#160;11th&#160;ACM&#160;SIGOPS&#160;European&#160;workshop:&#160;beyond&#160;the&#160;PC</i>.&#160;ACM<br/>Press&#160;New&#160;York,&#160;NY,&#160;USA,&#160;2004.</p>
<p style="position:absolute;top:953px;left:150px;white-space:nowrap" class="ft7612">[35]&#160;Intel&#160;Corporation.&#160;Intel&#160;Trusted&#160;Execution&#160;Technology&#160;–&#160;Preliminary&#160;Architecture</p>
<p style="position:absolute;top:971px;left:182px;white-space:nowrap" class="ft7612">Specification.&#160;Intel.com:</p>
<p style="position:absolute;top:972px;left:334px;white-space:nowrap" class="ft7659"><a href="http://download.intel.com/technology/security/downloads/31516803.pdf">http://download.intel.com/technology/</a></p>
<p style="position:absolute;top:990px;left:182px;white-space:nowrap" class="ft7659"><a href="http://download.intel.com/technology/security/downloads/31516803.pdf">security/downloads/31516803.pdf</a></p>
<p style="position:absolute;top:989px;left:460px;white-space:nowrap" class="ft7612"><a href="http://download.intel.com/technology/security/downloads/31516803.pdf">,&#160;</a>Nov.&#160;2006.&#160;Preliminary&#160;Architec-</p>
<p style="position:absolute;top:1007px;left:182px;white-space:nowrap" class="ft7612">ture&#160;Specification&#160;and&#160;Enabling&#160;Considerations.</p>
<p style="position:absolute;top:1036px;left:150px;white-space:nowrap" class="ft7612">[36]&#160;B.&#160;Jansen,&#160;H.&#160;Ramasamy,&#160;and&#160;M.&#160;Schunter.&#160;Flexible&#160;integrity&#160;protection&#160;an&#160;ver-</p>
<p style="position:absolute;top:1054px;left:182px;white-space:nowrap" class="ft7630">ification&#160;architecture&#160;for&#160;virtual&#160;machine&#160;monitors.&#160;In&#160;<i>The&#160;Second&#160;Workshop&#160;on<br/>Advances&#160;in&#160;Trusted&#160;Computing</i>,&#160;Tokyo,&#160;Japan,&#160;November&#160;2006.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft7618">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 77 -->
<a name="77"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page77-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL077.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft7712">BIBLIOGRAPHY</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft7712">75</p>
<p style="position:absolute;top:193px;left:226px;white-space:nowrap" class="ft7712">[37]&#160;S.&#160;Jiang,&#160;S.&#160;Smith,&#160;and&#160;K.&#160;Minami.&#160;Securing&#160;Web&#160;Servers&#160;against&#160;Insider&#160;Attack.</p>
<p style="position:absolute;top:211px;left:258px;white-space:nowrap" class="ft7730">In&#160;<i>ACSAC&#160;’01:&#160;Proceedings&#160;of&#160;the&#160;17th&#160;Annual&#160;Computer&#160;Security&#160;Applications<br/>Conference</i>,&#160;page&#160;265,&#160;Washington,&#160;DC,&#160;USA,&#160;2001.&#160;IEEE&#160;Computer&#160;Society.</p>
<p style="position:absolute;top:259px;left:226px;white-space:nowrap" class="ft7712">[38]&#160;B.&#160;Kauer.&#160;OSLO:&#160;Improving&#160;the&#160;security&#160;of&#160;Trusted&#160;Computing.&#160;In&#160;<i>Proceedings</i></p>
<p style="position:absolute;top:277px;left:258px;white-space:nowrap" class="ft7711"><i>of&#160;the&#160;16th&#160;USENIX&#160;Security&#160;Symposium</i>.&#160;USENIX&#160;Association,&#160;2007.</p>
<p style="position:absolute;top:307px;left:226px;white-space:nowrap" class="ft7712">[39]&#160;S.&#160;Kent&#160;and&#160;K.&#160;Seo.&#160;Security&#160;Architecture&#160;for&#160;the&#160;Internet&#160;Protocol.&#160;Internet&#160;En-</p>
<p style="position:absolute;top:325px;left:258px;white-space:nowrap" class="ft7712">gineering&#160;Task&#160;Force:</p>
<p style="position:absolute;top:326px;left:393px;white-space:nowrap" class="ft7759"><a href="http://www.ietf.org/rfc/rfc4301.txt">http://www.ietf.org/rfc/rfc4301.txt</a></p>
<p style="position:absolute;top:325px;left:706px;white-space:nowrap" class="ft7712"><a href="http://www.ietf.org/rfc/rfc4301.txt">,&#160;</a>Dec.</p>
<p style="position:absolute;top:343px;left:258px;white-space:nowrap" class="ft7712">2005.&#160;Network&#160;Working&#160;Group&#160;RFC&#160;4346.&#160;Obsoletes:&#160;RCF2401.</p>
<p style="position:absolute;top:373px;left:226px;white-space:nowrap" class="ft7712">[40]&#160;D.&#160;Kuhlmann,&#160;R.&#160;Landfermann,&#160;H.&#160;Ramasamy,&#160;M.&#160;Schunter,&#160;G.&#160;Ramunno,&#160;and</p>
<p style="position:absolute;top:391px;left:258px;white-space:nowrap" class="ft7715">D.&#160;Vernizzi.&#160;An&#160;Open&#160;Trusted&#160;Computing&#160;Architecture&#160;-&#160;Secure&#160;virtual&#160;machines<br/>enabling&#160;user-defined&#160;policy&#160;enforcement,&#160;2006.</p>
<p style="position:absolute;top:410px;left:580px;white-space:nowrap" class="ft7759"><a href="http://www.opentc.net/images/otc_architecture_high_level_overview.pdf">http://www.opentc.</a></p>
<p style="position:absolute;top:427px;left:258px;white-space:nowrap" class="ft7759"><a href="http://www.opentc.net/images/otc_architecture_high_level_overview.pdf">net/images/otc_architecture_high_level_overview.pdf</a></p>
<p style="position:absolute;top:427px;left:716px;white-space:nowrap" class="ft7712"><a href="http://www.opentc.net/images/otc_architecture_high_level_overview.pdf">.</a></p>
<p style="position:absolute;top:457px;left:226px;white-space:nowrap" class="ft7712">[41]&#160;U.&#160;Kühn,&#160;M.&#160;Selhorst,&#160;and&#160;C.&#160;Stüble.&#160;Property-Based&#160;Attestation&#160;and&#160;Sealing</p>
<p style="position:absolute;top:474px;left:258px;white-space:nowrap" class="ft7712">with&#160;Commonly&#160;Available&#160;Hard-&#160;and&#160;Software.&#160;In&#160;<i>ACM-STC</i>,&#160;2007.</p>
<p style="position:absolute;top:504px;left:226px;white-space:nowrap" class="ft7712">[42]&#160;The&#160;Fiasco&#160;micro-kernel,</p>
<p style="position:absolute;top:504px;left:440px;white-space:nowrap" class="ft7712">2004.</p>
<p style="position:absolute;top:504px;left:506px;white-space:nowrap" class="ft7712">Available&#160;from</p>
<p style="position:absolute;top:505px;left:616px;white-space:nowrap" class="ft7759"><a href="http://os.inf.tu-dresden.de/fiasco/">http://os.inf.</a></p>
<p style="position:absolute;top:523px;left:258px;white-space:nowrap" class="ft7759"><a href="http://os.inf.tu-dresden.de/fiasco/">tu-dresden.de/fiasco/</a></p>
<p style="position:absolute;top:522px;left:447px;white-space:nowrap" class="ft7712"><a href="http://os.inf.tu-dresden.de/fiasco/">.</a></p>
<p style="position:absolute;top:552px;left:226px;white-space:nowrap" class="ft7712">[43]&#160;J.&#160;Liedtke.&#160;On</p>
<p style="position:absolute;top:551px;left:353px;white-space:nowrap" class="ft7729">µ</p>
<p style="position:absolute;top:552px;left:362px;white-space:nowrap" class="ft7712">-kernel&#160;construction.&#160;In&#160;<i>Proceedings&#160;of&#160;the&#160;15th&#160;ACM&#160;Sympo-</i></p>
<p style="position:absolute;top:570px;left:258px;white-space:nowrap" class="ft7715"><i>sium&#160;on&#160;Operating&#160;System&#160;Principles&#160;(SOSP)</i>,&#160;pages&#160;237–250,&#160;Copper&#160;Mountain<br/>Resort,&#160;CO,&#160;December&#160;1995.</p>
<p style="position:absolute;top:618px;left:226px;white-space:nowrap" class="ft7712">[44]&#160;J.&#160;Liedtke.&#160;Towards&#160;real&#160;micro-kernels.&#160;<i>Communications&#160;of&#160;the&#160;ACM</i>,&#160;39(9),</p>
<p style="position:absolute;top:636px;left:258px;white-space:nowrap" class="ft7712">1996.</p>
<p style="position:absolute;top:666px;left:226px;white-space:nowrap" class="ft7712">[45]&#160;R.&#160;MacDonald,&#160;S.&#160;Smith,&#160;J.&#160;Marchesini,&#160;and&#160;O.&#160;Wild.&#160;Bear:&#160;An&#160;open-source</p>
<p style="position:absolute;top:684px;left:258px;white-space:nowrap" class="ft7715">virtual&#160;secure&#160;coprocessor&#160;based&#160;on&#160;TCPA.&#160;Technical&#160;Report&#160;TR2003-471,&#160;De-<br/>partment&#160;of&#160;Computer&#160;Science,&#160;Dartmouth&#160;College,&#160;2003.</p>
<p style="position:absolute;top:732px;left:226px;white-space:nowrap" class="ft7712">[46]&#160;J.&#160;Marchesini,&#160;S.&#160;Smith,&#160;O.&#160;Wild,&#160;A.&#160;Barsamian,&#160;and&#160;J.&#160;Stabiner.&#160;Open-source</p>
<p style="position:absolute;top:750px;left:258px;white-space:nowrap" class="ft7730">applications&#160;of&#160;TCPA&#160;hardware.&#160;In&#160;<i>20th&#160;Annual&#160;Computer&#160;Security&#160;Applications<br/>Conference</i>.&#160;ACM,&#160;Dec.&#160;2004.</p>
<p style="position:absolute;top:797px;left:226px;white-space:nowrap" class="ft7712">[47]&#160;J.&#160;Marchesini,&#160;S.&#160;W.&#160;Smith,&#160;O.&#160;Wild,&#160;and&#160;R.&#160;MacDonald.&#160;Experimenting&#160;with&#160;TC-</p>
<p style="position:absolute;top:815px;left:258px;white-space:nowrap" class="ft7715">PA/TCG&#160;hardware,&#160;or:&#160;How&#160;I&#160;learned&#160;to&#160;stop&#160;worrying&#160;and&#160;love&#160;the&#160;bear.&#160;Techni-<br/>cal&#160;Report&#160;TR2003-476,&#160;Department&#160;of&#160;Computer&#160;Science,&#160;Dartmouth&#160;College,<br/>2003.</p>
<p style="position:absolute;top:881px;left:226px;white-space:nowrap" class="ft7712">[48]&#160;A.&#160;Marx.&#160;Outbreak&#160;response&#160;times:&#160;Putting&#160;AV&#160;to&#160;the&#160;test.</p>
<p style="position:absolute;top:882px;left:643px;white-space:nowrap" class="ft7759"><a href="http://www.avtest.org">http://www.</a></p>
<p style="position:absolute;top:900px;left:258px;white-space:nowrap" class="ft7759"><a href="http://www.avtest.org">avtest.org</a></p>
<p style="position:absolute;top:899px;left:348px;white-space:nowrap" class="ft7712"><a href="http://www.avtest.org">,&#160;</a>2004.</p>
<p style="position:absolute;top:929px;left:226px;white-space:nowrap" class="ft7712">[49]&#160;D.&#160;G.&#160;Murray,&#160;G.&#160;Milos,&#160;and&#160;S.&#160;Hand.&#160;Improving&#160;Xen&#160;security&#160;through&#160;disag-</p>
<p style="position:absolute;top:947px;left:258px;white-space:nowrap" class="ft7730">gregation.&#160;In&#160;<i>Proceedings&#160;of&#160;the&#160;ACM&#160;conference&#160;on&#160;Virtual&#160;Execution&#160;Environ-<br/>ments</i>,&#160;March&#160;2008.</p>
<p style="position:absolute;top:994px;left:226px;white-space:nowrap" class="ft7712">[50]&#160;G.&#160;C.&#160;Necula.&#160;Proof-carrying&#160;code.&#160;In&#160;<i>Conference&#160;Record&#160;of&#160;POPL&#160;’97:&#160;The</i></p>
<p style="position:absolute;top:1012px;left:258px;white-space:nowrap" class="ft7730"><i>24th&#160;ACM&#160;SIGPLAN-SIGACT&#160;Symposium&#160;on&#160;Principles&#160;of&#160;Programming&#160;Lan-<br/>guages</i>,&#160;pages&#160;106–119,&#160;Paris,&#160;France,&#160;jan&#160;1997.</p>
<p style="position:absolute;top:1031px;left:553px;white-space:nowrap" class="ft7759"><a href="citeseer.ist.psu.edu/article/necula97proofcarrying.html">citeseer.ist.psu.edu/</a></p>
<p style="position:absolute;top:1049px;left:258px;white-space:nowrap" class="ft7759"><a href="citeseer.ist.psu.edu/article/necula97proofcarrying.html">article/necula97proofcarrying.html</a></p>
<p style="position:absolute;top:1048px;left:563px;white-space:nowrap" class="ft7712"><a href="citeseer.ist.psu.edu/article/necula97proofcarrying.html">.</a></p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft7718">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 78 -->
<a name="78"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page78-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL078.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft7812">76</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft7818">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:193px;left:150px;white-space:nowrap" class="ft7812">[51]&#160;G.&#160;C.&#160;Necula.&#160;A&#160;scalable&#160;architecture&#160;for&#160;proof-carrying&#160;code.&#160;In&#160;<i>FLOPS&#160;’01:</i></p>
<p style="position:absolute;top:211px;left:182px;white-space:nowrap" class="ft7830"><i>Proceedings&#160;of&#160;the&#160;5th&#160;International&#160;Symposium&#160;on&#160;Functional&#160;and&#160;Logic&#160;Pro-<br/>gramming</i>,&#160;pages&#160;21–39,&#160;London,&#160;UK,&#160;2001.&#160;Springer-Verlag.</p>
<p style="position:absolute;top:259px;left:150px;white-space:nowrap" class="ft7812">[52]&#160;Ned&#160;M.&#160;Smith.</p>
<p style="position:absolute;top:259px;left:296px;white-space:nowrap" class="ft7812">System&#160;and&#160;method&#160;for&#160;combining&#160;user&#160;and&#160;platform&#160;au-</p>
<p style="position:absolute;top:277px;left:182px;white-space:nowrap" class="ft7812">thentication&#160;in&#160;negotiated&#160;channel&#160;security&#160;protocols.</p>
<p style="position:absolute;top:277px;left:536px;white-space:nowrap" class="ft7812">United&#160;States&#160;Patent</p>
<p style="position:absolute;top:295px;left:182px;white-space:nowrap" class="ft7812">Application&#160;20050216736:</p>
<p style="position:absolute;top:296px;left:370px;white-space:nowrap" class="ft7859"><a href="http://www.freepatentsonline.com/20050216736.html">http://www.freepatentsonline.com/</a></p>
<p style="position:absolute;top:314px;left:182px;white-space:nowrap" class="ft7859"><a href="http://www.freepatentsonline.com/20050216736.html">20050216736.html</a></p>
<p style="position:absolute;top:313px;left:326px;white-space:nowrap" class="ft7812"><a href="http://www.freepatentsonline.com/20050216736.html">,&#160;</a>Sept.&#160;2005.</p>
<p style="position:absolute;top:343px;left:150px;white-space:nowrap" class="ft7812">[53]&#160;J.&#160;Nick&#160;L.&#160;Petroni,&#160;T.&#160;Fraser,&#160;A.&#160;Walters,&#160;and&#160;W.&#160;A.&#160;Arbaugh.&#160;An&#160;architecture&#160;for</p>
<p style="position:absolute;top:361px;left:182px;white-space:nowrap" class="ft7830">specification-based&#160;detection&#160;of&#160;semantic&#160;integrity&#160;violations&#160;in&#160;kernel&#160;dynamic<br/>data.&#160;In&#160;<i>USENIX-SS’06:&#160;Proceedings&#160;of&#160;the&#160;15th&#160;conference&#160;on&#160;USENIX&#160;Security<br/>Symposium</i>,&#160;pages&#160;20–20,&#160;Berkeley,&#160;CA,&#160;USA,&#160;2006.&#160;USENIX&#160;Association.</p>
<p style="position:absolute;top:427px;left:150px;white-space:nowrap" class="ft7812">[54]&#160;Open&#160;Trusted&#160;Computing&#160;(OpenTC)&#160;Project.&#160;The&#160;OpenTC&#160;Project&#160;Homepage,</p>
<p style="position:absolute;top:445px;left:182px;white-space:nowrap" class="ft7812">2008.</p>
<p style="position:absolute;top:445px;left:221px;white-space:nowrap" class="ft7859"><a href="http://www.opentc.net/">http://www.opentc.net/</a></p>
<p style="position:absolute;top:445px;left:418px;white-space:nowrap" class="ft7812"><a href="http://www.opentc.net/">.</a></p>
<p style="position:absolute;top:474px;left:150px;white-space:nowrap" class="ft7812">[55]&#160;OpenSSL&#160;Project.&#160;The&#160;OpenSSL&#160;Project&#160;Homepage,&#160;2007.</p>
<p style="position:absolute;top:475px;left:567px;white-space:nowrap" class="ft7859"><a href="http://www.openssl.org/">http://www.</a></p>
<p style="position:absolute;top:493px;left:182px;white-space:nowrap" class="ft7859"><a href="http://www.openssl.org/">openssl.org/</a></p>
<p style="position:absolute;top:492px;left:290px;white-space:nowrap" class="ft7812"><a href="http://www.openssl.org/">.</a></p>
<p style="position:absolute;top:522px;left:150px;white-space:nowrap" class="ft7812">[56]&#160;J.&#160;Poritz,&#160;M.&#160;Schunter,&#160;E.&#160;Van&#160;Herreweghen,&#160;and&#160;M.&#160;Waidner.</p>
<p style="position:absolute;top:522px;left:614px;white-space:nowrap" class="ft7812">Property</p>
<p style="position:absolute;top:540px;left:182px;white-space:nowrap" class="ft7815">attestation—scalable&#160;and&#160;privacy-friendly&#160;security&#160;assessment&#160;of&#160;peer&#160;computers.<br/>Technical&#160;Report&#160;RZ&#160;3548,&#160;IBM&#160;Research,&#160;May&#160;2004.</p>
<p style="position:absolute;top:588px;left:150px;white-space:nowrap" class="ft7812">[57]&#160;T.&#160;Project.&#160;TrouSerS&#160;-&#160;The&#160;open-source&#160;TCG&#160;Software&#160;Stack,&#160;2008.</p>
<p style="position:absolute;top:589px;left:603px;white-space:nowrap" class="ft7859"><a href="http://trousers.sourceforge.net/">http://</a></p>
<p style="position:absolute;top:607px;left:182px;white-space:nowrap" class="ft7859"><a href="http://trousers.sourceforge.net/">trousers.sourceforge.net/</a></p>
<p style="position:absolute;top:606px;left:406px;white-space:nowrap" class="ft7812"><a href="http://trousers.sourceforge.net/">.</a></p>
<p style="position:absolute;top:636px;left:150px;white-space:nowrap" class="ft7812">[58]&#160;Qumranet.</p>
<p style="position:absolute;top:636px;left:273px;white-space:nowrap" class="ft7812">KVM:&#160;Kernel-based&#160;virtualization&#160;driver.</p>
<p style="position:absolute;top:637px;left:567px;white-space:nowrap" class="ft7859"><a href="http://kvm.qumranet.com">http://kvm.</a></p>
<p style="position:absolute;top:655px;left:182px;white-space:nowrap" class="ft7859"><a href="http://kvm.qumranet.com">qumranet.com</a></p>
<p style="position:absolute;top:654px;left:290px;white-space:nowrap" class="ft7812"><a href="http://kvm.qumranet.com">,&#160;</a>2006.</p>
<p style="position:absolute;top:684px;left:150px;white-space:nowrap" class="ft7812">[59]&#160;A.-R.&#160;Sadeghi&#160;and&#160;C.&#160;Stüble.&#160;Property-based&#160;attestation&#160;for&#160;computing&#160;platforms:</p>
<p style="position:absolute;top:702px;left:182px;white-space:nowrap" class="ft7815">caring&#160;about&#160;properties,&#160;not&#160;mechanisms.&#160;In&#160;<i>NSPW&#160;’04:&#160;Proceedings&#160;of&#160;the&#160;2004<br/>workshop&#160;on&#160;New&#160;security&#160;paradigms</i>,&#160;pages&#160;67–77,&#160;New&#160;York,&#160;NY,&#160;USA,&#160;2004.<br/>ACM&#160;Press.</p>
<p style="position:absolute;top:767px;left:150px;white-space:nowrap" class="ft7812">[60]&#160;A.-R.&#160;Sadeghi&#160;and&#160;C.&#160;Stüble.&#160;Property-based&#160;Attestation&#160;for&#160;Computing&#160;Plat-</p>
<p style="position:absolute;top:785px;left:182px;white-space:nowrap" class="ft7830">forms:&#160;Caring&#160;about&#160;Properties,&#160;not&#160;Mechanisms.&#160;In&#160;<i>Proc.&#160;2004&#160;Workshop&#160;on<br/>New&#160;Security&#160;Paradigms&#160;(NSPW-2004)</i>,&#160;pages&#160;67–77.&#160;ACM&#160;Press,&#160;2005.</p>
<p style="position:absolute;top:833px;left:150px;white-space:nowrap" class="ft7812">[61]&#160;A.-R.&#160;Sadeghi,&#160;C.&#160;Stüble,&#160;and&#160;N.&#160;Pohlmann.&#160;European&#160;multilateral&#160;secure&#160;com-</p>
<p style="position:absolute;top:851px;left:182px;white-space:nowrap" class="ft7815">puting&#160;base&#160;–&#160;open&#160;trusted&#160;computing&#160;for&#160;you&#160;and&#160;me.&#160;<i>Datenschutz&#160;und&#160;Daten-<br/>sicherheit&#160;DuD</i>,&#160;28(9):548–554,&#160;2004.&#160;Verlag&#160;Friedrich&#160;Vierweg&#160;&amp;&#160;Sohn,&#160;Wies-<br/>baden.</p>
<p style="position:absolute;top:917px;left:150px;white-space:nowrap" class="ft7812">[62]&#160;A.-R.&#160;Sadeghi,&#160;C.&#160;Stüble,&#160;M.&#160;Wolf,&#160;N.&#160;Asokan,&#160;and&#160;J.-E.&#160;Ekberg.&#160;Enabling&#160;Fairer</p>
<p style="position:absolute;top:935px;left:182px;white-space:nowrap" class="ft7815">Digital&#160;Rights&#160;Management&#160;with&#160;Trusted&#160;Computing,&#160;2007.&#160;To&#160;be&#160;presented&#160;at<br/>ISC07,&#160;Information&#160;Security&#160;Conference&#160;2007.</p>
<p style="position:absolute;top:983px;left:150px;white-space:nowrap" class="ft7812">[63]&#160;R.&#160;Sailer,&#160;T.&#160;Jaeger,&#160;E.&#160;Valdez,&#160;R.&#160;Caceres,&#160;R.&#160;Perez,&#160;S.&#160;Berger,&#160;J.&#160;L.&#160;Griffin,</p>
<p style="position:absolute;top:1001px;left:182px;white-space:nowrap" class="ft7830">and&#160;L.&#160;van&#160;Doorn.&#160;Building&#160;a&#160;MAC-Based&#160;Security&#160;Architecture&#160;for&#160;the&#160;Xen<br/>Open-Source&#160;Hypervisor.&#160;In&#160;<i>Proc.&#160;21st&#160;Annual&#160;Computer&#160;Security&#160;Applications<br/>Conference&#160;(ACSAC-2005)</i>,&#160;pages&#160;276–285,&#160;2005.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft7818">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 79 -->
<a name="79"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page79-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL079.png" alt="background image"/>
<p style="position:absolute;top:141px;left:226px;white-space:nowrap" class="ft7912">BIBLIOGRAPHY</p>
<p style="position:absolute;top:141px;left:727px;white-space:nowrap" class="ft7912">77</p>
<p style="position:absolute;top:193px;left:226px;white-space:nowrap" class="ft7912">[64]&#160;R.&#160;Sailer,&#160;E.&#160;Valdez,&#160;T.&#160;Jaeger,&#160;R.&#160;Perez,&#160;L.&#160;van&#160;Doorn,&#160;J.&#160;L.&#160;Griffin,&#160;and&#160;S.&#160;Berger.</p>
<p style="position:absolute;top:211px;left:258px;white-space:nowrap" class="ft7915">sHype:&#160;Secure&#160;hypervisor&#160;approach&#160;to&#160;trusted&#160;virtualized&#160;systems.&#160;Techn.&#160;Rep.<br/>RC23511,&#160;Feb.&#160;2005.&#160;IBM&#160;Research&#160;Division.</p>
<p style="position:absolute;top:259px;left:226px;white-space:nowrap" class="ft7912">[65]&#160;R.&#160;Sailer,&#160;X.&#160;Zhang,&#160;T.&#160;Jaeger,&#160;and&#160;L.&#160;van&#160;Doorn.&#160;Design&#160;and&#160;implementation</p>
<p style="position:absolute;top:277px;left:258px;white-space:nowrap" class="ft7915">of&#160;a&#160;TCG-based&#160;integrity&#160;measurement&#160;architecture.&#160;In&#160;<i>SSYM’04:&#160;Proceedings<br/>of&#160;the&#160;13th&#160;conference&#160;on&#160;USENIX&#160;Security&#160;Symposium</i>,&#160;pages&#160;16–16,&#160;Berkeley,<br/>CA,&#160;USA,&#160;2004.&#160;USENIX&#160;Association.</p>
<p style="position:absolute;top:343px;left:226px;white-space:nowrap" class="ft7912">[66]&#160;S.&#160;Santesson.&#160;TLS&#160;Handshake&#160;Message&#160;for&#160;Supplemental&#160;Data.&#160;IETF&#160;RFC&#160;4680,</p>
<p style="position:absolute;top:361px;left:258px;white-space:nowrap" class="ft7912">Sept.&#160;2006.</p>
<p style="position:absolute;top:362px;left:332px;white-space:nowrap" class="ft7959"><a href="http://tools.ietf.org/html/rfc4680">http://tools.ietf.org/html/rfc4680</a></p>
<p style="position:absolute;top:361px;left:636px;white-space:nowrap" class="ft7912"><a href="http://tools.ietf.org/html/rfc4680">.</a></p>
<p style="position:absolute;top:391px;left:226px;white-space:nowrap" class="ft7912">[67]&#160;A.&#160;Seshadri,&#160;M.&#160;Luk,&#160;N.&#160;Qu,&#160;and&#160;A.&#160;Perrig.&#160;Secvisor:&#160;A&#160;tiny&#160;hypervisor&#160;to&#160;provide</p>
<p style="position:absolute;top:409px;left:258px;white-space:nowrap" class="ft7915">lifetime&#160;kernel&#160;code&#160;integrity&#160;for&#160;commodity&#160;OSes.&#160;In&#160;<i>SOSP&#160;’07:&#160;Proceedings<br/>of&#160;twenty-first&#160;ACM&#160;SIGOPS&#160;symposium&#160;on&#160;Operating&#160;systems&#160;principles</i>,&#160;pages<br/>335–350,&#160;New&#160;York,&#160;NY,&#160;USA,&#160;2007.&#160;ACM.</p>
<p style="position:absolute;top:474px;left:226px;white-space:nowrap" class="ft7912">[68]&#160;S.&#160;W.&#160;Smith.&#160;Outbound&#160;authentication&#160;for&#160;programmable&#160;secure&#160;coprocessors.</p>
<p style="position:absolute;top:492px;left:258px;white-space:nowrap" class="ft7915">In&#160;D.&#160;Gollmann,&#160;G.&#160;Karjoth,&#160;and&#160;M.&#160;Waidner,&#160;editors,&#160;<i>Proceedings&#160;of&#160;the&#160;Seven-<br/>thEuropean&#160;Symposium&#160;on&#160;Research&#160;in&#160;Computer&#160;Security&#160;(ESORICS)</i>,&#160;volume<br/>2502&#160;of&#160;<i>Lecture&#160;Notes&#160;in&#160;Computer&#160;Science</i>,&#160;pages&#160;72–89,&#160;Zurich,&#160;Switzerland,<br/>Oct.&#160;2002.&#160;Springer-Verlag,&#160;Berlin&#160;Germany.</p>
<p style="position:absolute;top:576px;left:226px;white-space:nowrap" class="ft7912">[69]&#160;F.&#160;Stumpf,&#160;O.&#160;Tafreschi,&#160;P.&#160;Röder,&#160;and&#160;C.&#160;Eckert.&#160;A&#160;robust&#160;Integrity&#160;Reporting</p>
<p style="position:absolute;top:594px;left:258px;white-space:nowrap" class="ft7930">Protocol&#160;for&#160;Remote&#160;Attestation.&#160;In&#160;<i>Proceedings&#160;of&#160;the&#160;Second&#160;Workshop&#160;on<br/>Advances&#160;in&#160;Trusted&#160;Computing&#160;(WATC&#160;’06&#160;Fall),&#160;Tokyo</i>,&#160;Dec.&#160;2006.</p>
<p style="position:absolute;top:642px;left:226px;white-space:nowrap" class="ft7912">[70]&#160;J.&#160;Sugerman,&#160;G.&#160;Venkitachalam,&#160;and&#160;B.-H.&#160;Lim.&#160;Virtualizing&#160;I/O&#160;devices&#160;on</p>
<p style="position:absolute;top:660px;left:258px;white-space:nowrap" class="ft7915">VMware&#160;workstation’s&#160;hosted&#160;virtual&#160;machine&#160;monitor.&#160;In&#160;<i>Proceedings&#160;of&#160;the<br/>General&#160;Track:&#160;2002&#160;USENIX&#160;Annual&#160;Technical&#160;Conference</i>,&#160;pages&#160;1–14,&#160;Berke-<br/>ley,&#160;CA,&#160;USA,&#160;2001.&#160;USENIX&#160;Association.</p>
<p style="position:absolute;top:726px;left:226px;white-space:nowrap" class="ft7912">[71]&#160;TCG.</p>
<p style="position:absolute;top:726px;left:339px;white-space:nowrap" class="ft7912">TCG</p>
<p style="position:absolute;top:726px;left:385px;white-space:nowrap" class="ft7912">Software</p>
<p style="position:absolute;top:726px;left:456px;white-space:nowrap" class="ft7912">Stack</p>
<p style="position:absolute;top:726px;left:506px;white-space:nowrap" class="ft7912">Specification.</p>
<p style="position:absolute;top:726px;left:634px;white-space:nowrap" class="ft7959"><a href="https://www.trustedcomputinggroup.org/specs/TSS/">https://www.</a></p>
<p style="position:absolute;top:744px;left:258px;white-space:nowrap" class="ft7959"><a href="https://www.trustedcomputinggroup.org/specs/TSS/">trustedcomputinggroup.org/specs/TSS/</a></p>
<p style="position:absolute;top:744px;left:581px;white-space:nowrap" class="ft7912"><a href="https://www.trustedcomputinggroup.org/specs/TSS/">,&#160;</a>Aug.&#160;2006.</p>
<p style="position:absolute;top:744px;left:696px;white-space:nowrap" class="ft7912">Version</p>
<p style="position:absolute;top:761px;left:258px;white-space:nowrap" class="ft7912">1.2.</p>
<p style="position:absolute;top:791px;left:226px;white-space:nowrap" class="ft7912">[72]&#160;TCG&#160;Infrastructure&#160;Working&#160;Group&#160;(IWG).</p>
<p style="position:absolute;top:791px;left:572px;white-space:nowrap" class="ft7912">TCG&#160;Infrastructure&#160;Work-</p>
<p style="position:absolute;top:809px;left:258px;white-space:nowrap" class="ft7912">group&#160;Subject&#160;Key&#160;Attestation&#160;Evidence&#160;Extension.</p>
<p style="position:absolute;top:809px;left:620px;white-space:nowrap" class="ft7912">Trusted&#160;Computing</p>
<p style="position:absolute;top:827px;left:258px;white-space:nowrap" class="ft7912">Group:</p>
<p style="position:absolute;top:828px;left:311px;white-space:nowrap" class="ft7959"><a href="https://www.trustedcomputinggroup.org/specs/IWG/IWG_SKAE_Extension_1-00.pdf">https://www.trustedcomputinggroup.org/specs/IWG/</a></p>
<p style="position:absolute;top:846px;left:258px;white-space:nowrap" class="ft7959"><a href="https://www.trustedcomputinggroup.org/specs/IWG/IWG_SKAE_Extension_1-00.pdf">IWG_SKAE_Extension_1-00.pdf</a></p>
<p style="position:absolute;top:845px;left:501px;white-space:nowrap" class="ft7912"><a href="https://www.trustedcomputinggroup.org/specs/IWG/IWG_SKAE_Extension_1-00.pdf">,&#160;</a>June&#160;2005.&#160;Specification&#160;Version&#160;1.0</p>
<p style="position:absolute;top:863px;left:258px;white-space:nowrap" class="ft7912">Revision&#160;7.</p>
<p style="position:absolute;top:893px;left:226px;white-space:nowrap" class="ft7912">[73]&#160;TCG&#160;Infrastructure&#160;Working&#160;Group&#160;(IWG).</p>
<p style="position:absolute;top:893px;left:561px;white-space:nowrap" class="ft7912">TCG&#160;Infrastructure&#160;Working</p>
<p style="position:absolute;top:911px;left:258px;white-space:nowrap" class="ft7915">Group&#160;Reference&#160;Architecture&#160;for&#160;Interoperability&#160;(Part&#160;I).&#160;Trusted&#160;Computing<br/>Group:</p>
<p style="position:absolute;top:930px;left:311px;white-space:nowrap" class="ft7959"><a href="https://www.trustedcomputinggroup.org/specs/IWG/IWG_Architecture_v1_0_r1.pdf">https://www.trustedcomputinggroup.org/specs/IWG/</a></p>
<p style="position:absolute;top:948px;left:258px;white-space:nowrap" class="ft7959"><a href="https://www.trustedcomputinggroup.org/specs/IWG/IWG_Architecture_v1_0_r1.pdf">IWG_Architecture_v1_0_r1.pdf</a></p>
<p style="position:absolute;top:947px;left:509px;white-space:nowrap" class="ft7912"><a href="https://www.trustedcomputinggroup.org/specs/IWG/IWG_Architecture_v1_0_r1.pdf">,&#160;</a>June&#160;2005.&#160;Specification&#160;Version&#160;1.0</p>
<p style="position:absolute;top:965px;left:258px;white-space:nowrap" class="ft7912">Revision&#160;1.</p>
<p style="position:absolute;top:994px;left:226px;white-space:nowrap" class="ft7912">[74]&#160;Trusted&#160;Computing&#160;Group.</p>
<p style="position:absolute;top:994px;left:464px;white-space:nowrap" class="ft7912">TCG&#160;Specification&#160;Architecture&#160;Overview.</p>
<p style="position:absolute;top:1012px;left:258px;white-space:nowrap" class="ft7912">Trusted&#160;Computing&#160;Group:</p>
<p style="position:absolute;top:1013px;left:437px;white-space:nowrap" class="ft7959"><a href="https://www.trustedcomputinggroup.org/groups/TCG_1_3_Architecture_Overview.pdf">https://www.trustedcomputinggroup.</a></p>
<p style="position:absolute;top:1031px;left:258px;white-space:nowrap" class="ft7959"><a href="https://www.trustedcomputinggroup.org/groups/TCG_1_3_Architecture_Overview.pdf">org/groups/TCG_1_3_Architecture_Overview.pdf</a></p>
<p style="position:absolute;top:1030px;left:653px;white-space:nowrap" class="ft7912"><a href="https://www.trustedcomputinggroup.org/groups/TCG_1_3_Architecture_Overview.pdf">,&#160;</a>Mar.&#160;2003.</p>
<p style="position:absolute;top:1048px;left:258px;white-space:nowrap" class="ft7912">Specification&#160;Revision&#160;1.3&#160;28th&#160;March&#160;2007.</p>
<p style="position:absolute;top:1117px;left:226px;white-space:nowrap" class="ft7918">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<!-- Page 80 -->
<a name="80"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page80-div" style="position:relative;width:892px;height:1263px;">
<img width="892" height="1263" src="OpenTC_D05.4_DesignOfSecServices_FINAL080.png" alt="background image"/>
<p style="position:absolute;top:141px;left:150px;white-space:nowrap" class="ft8012">78</p>
<p style="position:absolute;top:141px;left:240px;white-space:nowrap" class="ft8018">OpenTC&#160;D05.4&#160;–&#160;Design&#160;of&#160;the&#160;Cross-Domain&#160;Security&#160;Services</p>
<p style="position:absolute;top:193px;left:150px;white-space:nowrap" class="ft8012">[75]&#160;Trusted&#160;Computing&#160;Group.&#160;TCG&#160;Software&#160;Stack&#160;(TSS)&#160;Specification&#160;Version&#160;1.2.</p>
<p style="position:absolute;top:211px;left:182px;white-space:nowrap" class="ft8012">Trusted&#160;Computing&#160;Group:</p>
<p style="position:absolute;top:212px;left:361px;white-space:nowrap" class="ft8059"><a href="https://www.trustedcomputinggroup.org/specs/TSS/TSS_Version_1.2_Level_1_FINAL.pdf">https://www.trustedcomputinggroup.</a></p>
<p style="position:absolute;top:230px;left:182px;white-space:nowrap" class="ft8059"><a href="https://www.trustedcomputinggroup.org/specs/TSS/TSS_Version_1.2_Level_1_FINAL.pdf">org/specs/TSS/TSS_Version_1.2_Level_1_FINAL.pdf</a></p>
<p style="position:absolute;top:229px;left:604px;white-space:nowrap" class="ft8012"><a href="https://www.trustedcomputinggroup.org/specs/TSS/TSS_Version_1.2_Level_1_FINAL.pdf">,</a></p>
<p style="position:absolute;top:229px;left:642px;white-space:nowrap" class="ft8012">Jan.</p>
<p style="position:absolute;top:247px;left:182px;white-space:nowrap" class="ft8012">2006.&#160;Specification&#160;Version&#160;1.2&#160;Level&#160;1&#160;Final.</p>
<p style="position:absolute;top:277px;left:150px;white-space:nowrap" class="ft8012">[76]&#160;Trusted&#160;Computing&#160;Group.</p>
<p style="position:absolute;top:277px;left:384px;white-space:nowrap" class="ft8012">TCG&#160;TPM&#160;Main&#160;Part&#160;2&#160;TPM&#160;Structures.</p>
<p style="position:absolute;top:295px;left:182px;white-space:nowrap" class="ft8012">Trusted&#160;Computing&#160;Group:</p>
<p style="position:absolute;top:296px;left:361px;white-space:nowrap" class="ft8059"><a href="https://www.trustedcomputinggroup.org/specs/TPM/Main_Part2_Rev94.zip">https://www.trustedcomputinggroup.</a></p>
<p style="position:absolute;top:314px;left:182px;white-space:nowrap" class="ft8059"><a href="https://www.trustedcomputinggroup.org/specs/TPM/Main_Part2_Rev94.zip">org/specs/TPM/Main_Part2_Rev94.zip</a></p>
<p style="position:absolute;top:313px;left:487px;white-space:nowrap" class="ft8012"><a href="https://www.trustedcomputinggroup.org/specs/TPM/Main_Part2_Rev94.zip">,&#160;</a>Mar.&#160;2006.</p>
<p style="position:absolute;top:313px;left:587px;white-space:nowrap" class="ft8012">Specification</p>
<p style="position:absolute;top:331px;left:182px;white-space:nowrap" class="ft8012">Version&#160;1.2&#160;Level&#160;2&#160;Revision&#160;94.</p>
<p style="position:absolute;top:361px;left:150px;white-space:nowrap" class="ft8012">[77]&#160;Trusted&#160;Computing&#160;Group.&#160;TCG&#160;TPM&#160;Main&#160;Part&#160;3&#160;Commands.&#160;Trusted&#160;Com-</p>
<p style="position:absolute;top:379px;left:182px;white-space:nowrap" class="ft8012">puting&#160;Group:</p>
<p style="position:absolute;top:380px;left:271px;white-space:nowrap" class="ft8059"><a href="https://www.trustedcomputinggroup.org/specs/TPM/mainP3Commandsrev103.zip">https://www.trustedcomputinggroup.org/specs/</a></p>
<p style="position:absolute;top:398px;left:182px;white-space:nowrap" class="ft8059"><a href="https://www.trustedcomputinggroup.org/specs/TPM/mainP3Commandsrev103.zip">TPM/mainP3Commandsrev103.zip</a></p>
<p style="position:absolute;top:397px;left:433px;white-space:nowrap" class="ft8012"><a href="https://www.trustedcomputinggroup.org/specs/TPM/mainP3Commandsrev103.zip">,&#160;</a>July&#160;2007.&#160;Specification&#160;Version&#160;1.2</p>
<p style="position:absolute;top:415px;left:182px;white-space:nowrap" class="ft8012">Level&#160;2&#160;Revision&#160;103.</p>
<p style="position:absolute;top:445px;left:150px;white-space:nowrap" class="ft8012">[78]&#160;Trusted&#160;Computing&#160;Group&#160;(TCG).</p>
<p style="position:absolute;top:445px;left:415px;white-space:nowrap" class="ft8012">TCG&#160;TPM&#160;specification&#160;version&#160;1.2&#160;re-</p>
<p style="position:absolute;top:463px;left:182px;white-space:nowrap" class="ft8012">vision&#160;103.</p>
<p style="position:absolute;top:463px;left:271px;white-space:nowrap" class="ft8059"><a href="https://www.trustedcomputinggroup.org/specs/TPM/">https://www.trustedcomputinggroup.org/specs/</a></p>
<p style="position:absolute;top:481px;left:182px;white-space:nowrap" class="ft8059"><a href="https://www.trustedcomputinggroup.org/specs/TPM/">TPM/</a></p>
<p style="position:absolute;top:480px;left:218px;white-space:nowrap" class="ft8012"><a href="https://www.trustedcomputinggroup.org/specs/TPM/">,&#160;</a>July&#160;2007.&#160;See&#160;also&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#80">[79]&#160;</a>and</p>
<p style="position:absolute;top:481px;left:414px;white-space:nowrap" class="ft8059"><a href="http://www.trustedcomputing.org/">http://www.trustedcomputing.</a></p>
<p style="position:absolute;top:499px;left:182px;white-space:nowrap" class="ft8059"><a href="http://www.trustedcomputing.org/">org/</a></p>
<p style="position:absolute;top:498px;left:218px;white-space:nowrap" class="ft8012"><a href="http://www.trustedcomputing.org/">.</a></p>
<p style="position:absolute;top:528px;left:150px;white-space:nowrap" class="ft8012">[79]&#160;Trusted&#160;Computing&#160;Platform&#160;Alliance&#160;(TCPA).&#160;Main&#160;specification&#160;version&#160;1.1b.</p>
<p style="position:absolute;top:547px;left:182px;white-space:nowrap" class="ft8059"><a href="https://www.trustedcomputinggroup.org/specs/TPM/">https://www.trustedcomputinggroup.org/specs/TPM/</a></p>
<p style="position:absolute;top:546px;left:613px;white-space:nowrap" class="ft8012"><a href="https://www.trustedcomputinggroup.org/specs/TPM/">,&#160;</a>Febru-</p>
<p style="position:absolute;top:564px;left:182px;white-space:nowrap" class="ft8012">ary&#160;2002.&#160;See&#160;also&#160;<a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#80">[78]&#160;</a>and</p>
<p style="position:absolute;top:565px;left:351px;white-space:nowrap" class="ft8059"><a href="http://www.trustedcomputing.org/">http://www.trustedcomputing.org/</a></p>
<p style="position:absolute;top:564px;left:638px;white-space:nowrap" class="ft8012"><a href="http://www.trustedcomputing.org/">.</a></p>
<p style="position:absolute;top:594px;left:150px;white-space:nowrap" class="ft8012">[80]&#160;Trusted&#160;Network&#160;Connect&#160;Work&#160;Group.&#160;TCG&#160;Trusted&#160;Network&#160;Connect&#160;TNC</p>
<p style="position:absolute;top:612px;left:182px;white-space:nowrap" class="ft8012">Architecture&#160;for&#160;Interoperability.&#160;Trusted&#160;Computing&#160;Group:</p>
<p style="position:absolute;top:613px;left:558px;white-space:nowrap" class="ft8059"><a href="https://www.trustedcomputinggroup.org/specs/TNC/TNC_Architecture_v1_2_r4.pdf">https://www.</a></p>
<p style="position:absolute;top:631px;left:182px;white-space:nowrap" class="ft8059"><a href="https://www.trustedcomputinggroup.org/specs/TNC/TNC_Architecture_v1_2_r4.pdf">trustedcomputinggroup.org/specs/TNC/TNC_Architecture_</a></p>
<p style="position:absolute;top:649px;left:182px;white-space:nowrap" class="ft8059"><a href="https://www.trustedcomputinggroup.org/specs/TNC/TNC_Architecture_v1_2_r4.pdf">v1_2_r4.pdf</a></p>
<p style="position:absolute;top:648px;left:281px;white-space:nowrap" class="ft8012"><a href="https://www.trustedcomputinggroup.org/specs/TNC/TNC_Architecture_v1_2_r4.pdf">,&#160;</a>May&#160;2007.&#160;Specification&#160;Version&#160;1.2&#160;Revision&#160;4.</p>
<p style="position:absolute;top:678px;left:150px;white-space:nowrap" class="ft8012">[81]&#160;VMware&#160;In.&#160;VMware&#160;Virtualization&#160;Software,&#160;2008.</p>
<p style="position:absolute;top:679px;left:504px;white-space:nowrap" class="ft8059"><a href="http://www.vmware.com/">http://www.vmware.</a></p>
<p style="position:absolute;top:697px;left:182px;white-space:nowrap" class="ft8059"><a href="http://www.vmware.com/">com/</a></p>
<p style="position:absolute;top:696px;left:218px;white-space:nowrap" class="ft8012"><a href="http://www.vmware.com/">.</a></p>
<p style="position:absolute;top:726px;left:150px;white-space:nowrap" class="ft8012">[82]&#160;Xen&#160;Community.&#160;The&#160;Xen&#160;Hypervisor&#160;Open&#160;Source&#160;Project&#160;Homepage,&#160;2007.</p>
<p style="position:absolute;top:744px;left:182px;white-space:nowrap" class="ft8059"><a href="http://www.xen.org/">http://www.xen.org/</a></p>
<p style="position:absolute;top:744px;left:353px;white-space:nowrap" class="ft8012"><a href="http://www.xen.org/">.</a></p>
<p style="position:absolute;top:773px;left:150px;white-space:nowrap" class="ft8012">[83]&#160;B.&#160;S.&#160;Yee.&#160;<i>Using&#160;Secure&#160;Coprocessors</i>.&#160;PhD&#160;thesis,&#160;School&#160;of&#160;Computer&#160;Science,</p>
<p style="position:absolute;top:791px;left:182px;white-space:nowrap" class="ft8012">Carnegie&#160;Mellon&#160;University,&#160;May&#160;1994.&#160;CMU-CS-94-149.</p>
<p style="position:absolute;top:1117px;left:150px;white-space:nowrap" class="ft8018">OpenTC&#160;Document&#160;D05.4/V02&#160;–&#160;Final&#160;R6505/2008/05/26/OpenTC&#160;Public&#160;(PU)</p>
</div>
<hr/>
<a name="outline"></a><h1>Document Outline</h1>
<ul>
<li>Kopie von otc_D05.4_DesignOfSecServices_004_20080529.pdf
<ul>
<li>Kopie von otc_D05.4_DesignOfSecServices_003_20080529.pdf
<ul>
<li>otc_D05.4_DesignOfSecServices_002_20080528.pdf
<ul>
<li>otc_D05.4_DesignOfSecServices_002_20080528.pdf
<ul>
<li>Introduction and Outline
<ul>
<li>Introduction</li>
<li>Outline of this Report</li>
</ul>
</li>
<li>Related Work
<ul>
<li>Trusted Computing</li>
<li>Machine Virtualization</li>
<li>Trusted Virtual Domains</li>
<li>Property-Based Attestation</li>
<li>Trusted Channels</li>
</ul>
</li>
<li>Compliance Proofs for Xen
<ul>
<li>Introduction</li>
<li>Formal Integrity Model for Virtual Machines</li>
<li>The PEV Integrity Architecture</li>
<li>Realization using Xen and Linux</li>
<li>Use Cases</li>
<li>Conclusion</li>
</ul>
</li>
<li>Hierarchical Integrity Management
<ul>
<li>Introduction</li>
<li>Design Overview</li>
<li>Basic Integrity Management</li>
<li>Hierarchical Integrity Management</li>
<li>Policy Verification for Security Services</li>
<li>Implementation in Xen</li>
<li>Related Work</li>
<li>Conclusions</li>
</ul>
</li>
<li>Trusted Channels with Remote Integrity Verification
<ul>
<li>Motivation</li>
<li>Requirement Analysis</li>
<li>Basic Concept</li>
<li>System Architecture</li>
<li>Credentials, Extensions and their Usage</li>
<li>Implementing a Trusted Channel with OpenSSL&#160;</li>
<li>Security Considerations</li>
<li>Functional Considerations</li>
<li>Summary</li>
</ul>
</li>
<li>Conclusion and Outlook</li>
<li>Some details on Trusted Channel Implementation
<ul>
<li>Details of Hardware and Virtualization Layer</li>
<li>Linkage of Configuration Information to Secure Channel</li>
<li>State-Change Protocol Flow</li>
</ul>
</li>
<li>Bibliography</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Kopie (2) von otc_D05.4_DesignOfSecServices_003_20080529.pdf
<ul>
<li>otc_D05.4_DesignOfSecServices_002_20080528.pdf
<ul>
<li>otc_D05.4_DesignOfSecServices_002_20080528.pdf
<ul>
<li>Introduction and Outline
<ul>
<li>Introduction</li>
<li>Outline of this Report</li>
</ul>
</li>
<li>Related Work
<ul>
<li>Trusted Computing</li>
<li>Machine Virtualization</li>
<li>Trusted Virtual Domains</li>
<li>Property-Based Attestation</li>
<li>Trusted Channels</li>
</ul>
</li>
<li>Compliance Proofs for Xen
<ul>
<li>Introduction</li>
<li>Formal Integrity Model for Virtual Machines</li>
<li>The PEV Integrity Architecture</li>
<li>Realization using Xen and Linux</li>
<li>Use Cases</li>
<li>Conclusion</li>
</ul>
</li>
<li>Hierarchical Integrity Management
<ul>
<li>Introduction</li>
<li>Design Overview</li>
<li>Basic Integrity Management</li>
<li>Hierarchical Integrity Management</li>
<li>Policy Verification for Security Services</li>
<li>Implementation in Xen</li>
<li>Related Work</li>
<li>Conclusions</li>
</ul>
</li>
<li>Trusted Channels with Remote Integrity Verification
<ul>
<li>Motivation</li>
<li>Requirement Analysis</li>
<li>Basic Concept</li>
<li>System Architecture</li>
<li>Credentials, Extensions and their Usage</li>
<li>Implementing a Trusted Channel with OpenSSL&#160;</li>
<li>Security Considerations</li>
<li>Functional Considerations</li>
<li>Summary</li>
</ul>
</li>
<li>Conclusion and Outlook</li>
<li>Some details on Trusted Channel Implementation
<ul>
<li>Details of Hardware and Virtualization Layer</li>
<li>Linkage of Configuration Information to Secure Channel</li>
<li>State-Change Protocol Flow</li>
</ul>
</li>
<li>Bibliography</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Kopie von otc_D05.4_DesignOfSecServices_001_20080528.pdf
<ul>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#7">Introduction and Outline</a>
<ul>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#7">Introduction</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#8">Outline of this Report</a></li>
</ul>
</li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#10">Related Work</a>
<ul>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#10">Trusted Computing</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#11">Machine Virtualization</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#12">Trusted Virtual Domains</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#13">Property-Based Attestation</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#13">Trusted Channels</a></li>
</ul>
</li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#14">Compliance Proofs for Xen</a>
<ul>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#14">Introduction</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#15">Formal Integrity Model for Virtual Machines</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#18">The PEV Integrity Architecture</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#21">Realization using Xen and Linux</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#23">Use Cases</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#29">Conclusion</a></li>
</ul>
</li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#30">Hierarchical Integrity Management</a>
<ul>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#30">Introduction</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#31">Design Overview</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#33">Basic Integrity Management</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#37">Hierarchical Integrity Management</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#42">Policy Verification for Security Services</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#44">Implementation in Xen</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#47">Related Work</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#49">Conclusions</a></li>
</ul>
</li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#50">Trusted Channels with Remote Integrity Verification</a>
<ul>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#50">Motivation</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#52">Requirement Analysis</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#53">Basic Concept</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#53">System Architecture</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#57">Credentials, Extensions and their Usage</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#62">Implementing a Trusted Channel with OpenSSL&#160;</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#64">Security Considerations</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#65">Functional Considerations</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#66">Summary</a></li>
</ul>
</li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#67">Conclusion and Outlook</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#68">Some details on Trusted Channel Implementation</a>
<ul>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#68">Details of Hardware and Virtualization Layer</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#70">Linkage of Configuration Information to Secure Channel</a></li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#72">State-Change Protocol Flow</a></li>
</ul>
</li>
<li><a href="OpenTC_D05.4_DesignOfSecServices_FINAL.html#72">Bibliography</a></li>
</ul>
</li>
</ul>
</body>
</html>
