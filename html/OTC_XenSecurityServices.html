<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
<title>html/OTC_XenSecurityServices</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="generator" content="pdftohtml 0.36"/>
<meta name="date" content="2006-08-21T17:36:51+00:00"/>
<style type="text/css">
<!--
.xflip {
    -moz-transform: scaleX(-1);
    -webkit-transform: scaleX(-1);
    -o-transform: scaleX(-1);
    transform: scaleX(-1);
    filter: fliph;
}
.yflip {
    -moz-transform: scaleY(-1);
    -webkit-transform: scaleY(-1);
    -o-transform: scaleY(-1);
    transform: scaleY(-1);
    filter: flipv;
}
.xyflip {
    -moz-transform: scaleX(-1) scaleY(-1);
    -webkit-transform: scaleX(-1) scaleY(-1);
    -o-transform: scaleX(-1) scaleY(-1);
    transform: scaleX(-1) scaleY(-1);
    filter: fliph + flipv;
}
-->
</style>
</head>
<body bgcolor="#A0A0A0" vlink="blue" link="blue">
<!-- Page 1 -->
<a name="1"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft10{font-size:26px;font-family:MTFBGH+CMR17;color:#231f20;}
	.ft11{font-size:18px;font-family:UCYRWS+CMR12;color:#231f20;}
	.ft12{font-size:18px;font-family:RNOWCO+CMSY10;color:#231f20;}
	.ft13{font-size:18px;font-family:UXEWMP+CMTT12;color:#231f20;}
	.ft14{font-size:22px;font-family:MUYCVK+CMBX12;color:#000000;}
	.ft15{font-size:15px;font-family:XPRQEY+CMR10;color:#000000;}
	.ft16{font-size:15px;font-family:XPRQEY+CMR10;color:#231f20;}
	.ft17{font-size:15px;line-height:17px;font-family:XPRQEY+CMR10;color:#000000;}
-->
</style>
<div id="page1-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="OTC_XenSecurityServices001.png" alt="background image"/>
<p style="position:absolute;top:149px;left:140px;white-space:nowrap" class="ft10">Flexible&#160;Integrity&#160;Protection&#160;and&#160;Verification&#160;Architecture&#160;for</p>
<p style="position:absolute;top:182px;left:324px;white-space:nowrap" class="ft10">Virtual&#160;Machine&#160;Monitors</p>
<p style="position:absolute;top:232px;left:195px;white-space:nowrap" class="ft11">Bernhard&#160;Jansen,&#160;HariGovind&#160;V.&#160;Ramasamy,&#160;and&#160;Matthias&#160;Schunter</p>
<p style="position:absolute;top:253px;left:331px;white-space:nowrap" class="ft11">IBM&#160;Zurich&#160;Research&#160;Laboratory</p>
<p style="position:absolute;top:274px;left:331px;white-space:nowrap" class="ft11">CH-8803&#160;RÂ¨uschlikon,&#160;Switzerland</p>
<p style="position:absolute;top:295px;left:292px;white-space:nowrap" class="ft11">Email:</p>
<p style="position:absolute;top:295px;left:350px;white-space:nowrap" class="ft12"><i>{</i></p>
<p style="position:absolute;top:295px;left:359px;white-space:nowrap" class="ft13">bja,&#160;hvr,&#160;mts</p>
<p style="position:absolute;top:295px;left:479px;white-space:nowrap" class="ft12"><i>}</i></p>
<p style="position:absolute;top:295px;left:488px;white-space:nowrap" class="ft13">@zurich.ibm.com</p>
<p style="position:absolute;top:350px;left:108px;white-space:nowrap" class="ft14">Abstract</p>
<p style="position:absolute;top:388px;left:108px;white-space:nowrap" class="ft17">Lack&#160;of&#160;security&#160;of&#160;virtual&#160;machines&#160;and&#160;lack&#160;of&#160;trust<br/>into&#160;correct&#160;execution&#160;of&#160;virtualization&#160;engines&#160;is&#160;a<br/>major&#160;concern&#160;that&#160;is&#160;limiting&#160;the&#160;broad&#160;adoption&#160;of<br/>virtual&#160;machine&#160;technology.&#160;In&#160;this&#160;paper,&#160;we&#160;look<br/>at&#160;ways&#160;of&#160;improving&#160;virtual&#160;machine&#160;(VM)&#160;secu-<br/>rity,&#160;specifically&#160;in&#160;the&#160;context&#160;of&#160;integrity&#160;of&#160;VMs,<br/>by&#160;adding&#160;scalable&#160;trusted&#160;computing&#160;concepts&#160;to&#160;a<br/>virtual&#160;machine&#160;infrastructure.&#160;We&#160;describe&#160;methods<br/>for&#160;doing&#160;integrity&#160;measurement&#160;recording,&#160;and&#160;re-<br/>porting&#160;for&#160;VMs.&#160;We&#160;place&#160;particular&#160;emphasis&#160;on<br/>how&#160;those&#160;methods&#160;can&#160;be&#160;made&#160;extensible&#160;and&#160;flex-<br/>ible&#160;with&#160;the&#160;goal&#160;of&#160;obtaining&#160;a&#160;generic&#160;attestation<br/>and&#160;sealing&#160;framework&#160;for&#160;VMs.</p>
<p style="position:absolute;top:647px;left:108px;white-space:nowrap" class="ft14">1</p>
<p style="position:absolute;top:647px;left:144px;white-space:nowrap" class="ft14">Introduction</p>
<p style="position:absolute;top:686px;left:108px;white-space:nowrap" class="ft17">The&#160;concept&#160;of&#160;hardware&#160;virtualization&#160;has&#160;witnessed<br/>a&#160;resurgence&#160;of&#160;interest.&#160;A&#160;key&#160;application&#160;of&#160;virtu-<br/>alization&#160;is&#160;utility&#160;computing&#160;in&#160;which&#160;virtualization<br/>can&#160;help&#160;significantly&#160;improve&#160;server&#160;utilization,&#160;con-<br/>trol&#160;the&#160;problem&#160;of&#160;server&#160;sprawl,&#160;and&#160;thereby&#160;reduce<br/>management&#160;and&#160;space&#160;costs.&#160;Virtualization&#160;also&#160;en-<br/>ables&#160;a&#160;wide&#160;variety&#160;of&#160;other&#160;applications&#160;such&#160;as&#160;se-<br/>cure&#160;sandboxing&#160;of&#160;malicious&#160;content.&#160;Virtual&#160;ma-<br/>chine&#160;monitors&#160;(VMMs)&#160;such&#160;as&#160;Xen&#160;[</p>
<p style="position:absolute;top:829px;left:352px;white-space:nowrap" class="ft16">1</p>
<p style="position:absolute;top:829px;left:360px;white-space:nowrap" class="ft15">]&#160;and&#160;VMware</p>
<p style="position:absolute;top:847px;left:108px;white-space:nowrap" class="ft15">ESX&#160;[</p>
<p style="position:absolute;top:847px;left:148px;white-space:nowrap" class="ft16">2</p>
<p style="position:absolute;top:847px;left:155px;white-space:nowrap" class="ft15">]&#160;can&#160;host&#160;one&#160;or&#160;multiple&#160;instances&#160;of&#160;tradi-</p>
<p style="position:absolute;top:865px;left:108px;white-space:nowrap" class="ft17">tional&#160;operating&#160;systems&#160;(such&#160;as&#160;Linux&#160;and&#160;Win-<br/>dows&#160;XP)&#160;in&#160;parallel&#160;on&#160;a&#160;single&#160;platform.&#160;Current<br/>state-of-the-art&#160;VMMs&#160;provides&#160;elementary&#160;isolation,<br/>resource&#160;sharing,&#160;and&#160;policy&#160;enforcement&#160;properties.<br/>Each&#160;OS&#160;instance&#160;executes&#160;inside&#160;a&#160;separate&#160;compart-<br/>ment&#160;called&#160;a&#160;virtual&#160;machine&#160;(VM).</p>
<p style="position:absolute;top:973px;left:123px;white-space:nowrap" class="ft15">Lack&#160;of&#160;security&#160;of&#160;virtual&#160;machines&#160;and&#160;lack&#160;of</p>
<p style="position:absolute;top:991px;left:108px;white-space:nowrap" class="ft17">trust&#160;in&#160;the&#160;correct&#160;execution&#160;of&#160;virtualization&#160;en-<br/>gines&#160;is&#160;a&#160;major&#160;concern&#160;that&#160;is&#160;limiting&#160;the&#160;broad<br/>adoption&#160;of&#160;virtual&#160;machine&#160;technology.</p>
<p style="position:absolute;top:1026px;left:395px;white-space:nowrap" class="ft15">Perhaps,</p>
<p style="position:absolute;top:1044px;left:108px;white-space:nowrap" class="ft17">nowhere&#160;is&#160;this&#160;concern&#160;more&#160;evident&#160;than&#160;in&#160;data<br/>centers&#160;where&#160;virtual&#160;machines&#160;belonging&#160;to&#160;multiple</p>
<p style="position:absolute;top:356px;left:466px;white-space:nowrap" class="ft17">(perhaps,&#160;competing)&#160;companies&#160;are&#160;to&#160;be&#160;hosted&#160;on<br/>the&#160;same&#160;physical&#160;infrastructure.</p>
<p style="position:absolute;top:391px;left:481px;white-space:nowrap" class="ft15">The&#160;following&#160;ways&#160;can&#160;be&#160;used&#160;to&#160;provide&#160;better</p>
<p style="position:absolute;top:409px;left:466px;white-space:nowrap" class="ft15">security&#160;of&#160;virtual&#160;machines:</p>
<p style="position:absolute;top:436px;left:477px;white-space:nowrap" class="ft16">1.</p>
<p style="position:absolute;top:436px;left:496px;white-space:nowrap" class="ft17">At&#160;the&#160;virtualization&#160;software&#160;level,&#160;the&#160;policy<br/>enforcement&#160;capabilities&#160;of&#160;the&#160;virtual&#160;machine<br/>monitor&#160;itself&#160;can&#160;be&#160;significantly&#160;improved&#160;to<br/>allow&#160;enforcement&#160;of&#160;more&#160;stringent&#160;and&#160;fine-<br/>grained&#160;security&#160;policies&#160;[</p>
<p style="position:absolute;top:508px;left:662px;white-space:nowrap" class="ft16">3</p>
<p style="position:absolute;top:508px;left:670px;white-space:nowrap" class="ft15">].</p>
<p style="position:absolute;top:536px;left:477px;white-space:nowrap" class="ft16">2.</p>
<p style="position:absolute;top:536px;left:496px;white-space:nowrap" class="ft17">Implement&#160;sound&#160;policy&#160;management&#160;and&#160;en-<br/>forcement&#160;of&#160;information&#160;flow&#160;constraints.&#160;One<br/>example&#160;are&#160;virtual&#160;firewalls.</p>
<p style="position:absolute;top:600px;left:477px;white-space:nowrap" class="ft16">3.</p>
<p style="position:absolute;top:600px;left:496px;white-space:nowrap" class="ft17">Increasing&#160;security&#160;of&#160;virtualized&#160;devices.&#160;One<br/>example&#160;is&#160;secure&#160;virtualized&#160;storage.</p>
<p style="position:absolute;top:646px;left:477px;white-space:nowrap" class="ft16">4.</p>
<p style="position:absolute;top:646px;left:496px;white-space:nowrap" class="ft17">Integrate&#160;integrity&#160;validation&#160;and&#160;protection<br/>mechanisms&#160;into&#160;the&#160;virtual&#160;machine&#160;monitor.<br/>This&#160;means&#160;that&#160;customers&#160;can&#160;validate&#160;the&#160;in-<br/>tegrity&#160;of&#160;the&#160;virtual&#160;machine&#160;monitor&#160;and&#160;its<br/>essential&#160;services.</p>
<p style="position:absolute;top:745px;left:466px;white-space:nowrap" class="ft17">In&#160;this&#160;paper,&#160;we&#160;look&#160;at&#160;the&#160;aforementioned&#160;ways&#160;of<br/>improving&#160;VM&#160;security,&#160;specifically&#160;in&#160;the&#160;context&#160;of<br/>integrity&#160;of&#160;VMs,&#160;by&#160;adding&#160;scalable&#160;trusted&#160;comput-<br/>ing&#160;concepts&#160;to&#160;a&#160;virtual&#160;machine&#160;infrastructure.&#160;We<br/>are&#160;interested&#160;in&#160;enhancing&#160;the&#160;security&#160;of&#160;the&#160;virtu-<br/>alization&#160;layer&#160;by&#160;establishing&#160;finer-grained&#160;trust&#160;do-<br/>mains&#160;and&#160;offering&#160;methods&#160;for&#160;external&#160;stake-holders<br/>to&#160;verify,&#160;using&#160;Trusted&#160;Computing&#160;(TC),&#160;the&#160;in-<br/>tegrity&#160;of&#160;the&#160;virtualization&#160;software&#160;layer&#160;and&#160;its<br/>associated&#160;policies.&#160;Complementing&#160;those&#160;methods<br/>would&#160;be&#160;a&#160;new&#160;layer&#160;of&#160;enforcement&#160;mechanisms&#160;ap-<br/>propriate&#160;for&#160;guiding&#160;the&#160;behavior&#160;of&#160;the&#160;virtualiza-<br/>tion&#160;software&#160;layer&#160;and&#160;hosted&#160;operating&#160;system&#160;in-<br/>stances.&#160;These&#160;enforcement&#160;mechanisms&#160;are&#160;what&#160;we<br/>call&#160;âsecurity&#160;servicesâ&#160;and&#160;are&#160;the&#160;focus&#160;of&#160;this&#160;pa-<br/>per.&#160;Other&#160;recent&#160;works&#160;(such&#160;as&#160;[</p>
<p style="position:absolute;top:1013px;left:700px;white-space:nowrap" class="ft16">4</p>
<p style="position:absolute;top:1013px;left:707px;white-space:nowrap" class="ft15">,</p>
<p style="position:absolute;top:1013px;left:714px;white-space:nowrap" class="ft16">5</p>
<p style="position:absolute;top:1013px;left:722px;white-space:nowrap" class="ft15">,</p>
<p style="position:absolute;top:1013px;left:728px;white-space:nowrap" class="ft16">3</p>
<p style="position:absolute;top:1013px;left:736px;white-space:nowrap" class="ft15">,</p>
<p style="position:absolute;top:1013px;left:743px;white-space:nowrap" class="ft16">6</p>
<p style="position:absolute;top:1013px;left:750px;white-space:nowrap" class="ft15">,</p>
<p style="position:absolute;top:1013px;left:757px;white-space:nowrap" class="ft16">7</p>
<p style="position:absolute;top:1013px;left:764px;white-space:nowrap" class="ft15">])&#160;have</p>
<p style="position:absolute;top:1031px;left:466px;white-space:nowrap" class="ft17">also&#160;taken&#160;the&#160;approach&#160;of&#160;combining&#160;Trusted&#160;Com-<br/>puting&#160;(TC)&#160;[</p>
<p style="position:absolute;top:1049px;left:554px;white-space:nowrap" class="ft16">8</p>
<p style="position:absolute;top:1049px;left:562px;white-space:nowrap" class="ft15">]&#160;and&#160;hardware&#160;virtualization&#160;concepts</p>
<p style="position:absolute;top:1067px;left:466px;white-space:nowrap" class="ft15">for&#160;improving&#160;security.</p>
</div>
<!-- Page 2 -->
<a name="2"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft28{font-size:18px;font-family:MUYCVK+CMBX12;color:#000000;}
	.ft29{font-size:15px;font-family:UWEYSG+CMTI10;color:#000000;}
	.ft210{font-size:10px;font-family:Helvetica;color:#000000;}
	.ft211{font-size:18px;line-height:20px;font-family:MUYCVK+CMBX12;color:#000000;}
-->
</style>
<div id="page2-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="OTC_XenSecurityServices002.png" alt="background image"/>
<p style="position:absolute;top:110px;left:123px;white-space:nowrap" class="ft25">Integrity&#160;measurement,&#160;recording,&#160;and&#160;reporting</p>
<p style="position:absolute;top:128px;left:108px;white-space:nowrap" class="ft27">are&#160;among&#160;the&#160;most&#160;important&#160;features&#160;of&#160;a&#160;TPM-<br/>equipped&#160;platform.&#160;Those&#160;features&#160;enable&#160;a&#160;verifier<br/>to&#160;check&#160;whether&#160;the&#160;platform&#160;is&#160;in&#160;a&#160;trustworthy<br/>state.&#160;What&#160;constitutes&#160;a&#160;trustworthy&#160;state&#160;is&#160;left&#160;to<br/>the&#160;discretion&#160;of&#160;the&#160;verifier.&#160;While&#160;integrity&#160;man-<br/>agement&#160;has&#160;been&#160;explored&#160;for&#160;single&#160;operating&#160;sys-<br/>tems,&#160;we&#160;describe&#160;methods&#160;for&#160;doing&#160;integrity&#160;mea-<br/>surement,&#160;recording,&#160;and&#160;reporting&#160;for&#160;virtual&#160;ma-<br/>chine&#160;monitors&#160;hosting&#160;multiple&#160;VMs.&#160;We&#160;place&#160;par-<br/>ticular&#160;emphasis&#160;on&#160;how&#160;those&#160;methods&#160;can&#160;be&#160;made<br/>extensible&#160;and&#160;flexible&#160;with&#160;the&#160;goal&#160;of&#160;obtaining&#160;a<br/>generic&#160;attestation&#160;and&#160;sealing&#160;framework&#160;for&#160;VMs.<br/>By&#160;extensibility,&#160;we&#160;mean&#160;that&#160;it&#160;should&#160;be&#160;possible<br/>to&#160;provide&#160;integrity&#160;functions&#160;even&#160;if&#160;the&#160;virtual&#160;ma-<br/>chines&#160;included&#160;arbitrary&#160;virtual&#160;devices.&#160;Flexibility<br/>means&#160;that&#160;the&#160;verifier&#160;should&#160;be&#160;able&#160;to&#160;specify&#160;what<br/>aspects&#160;of&#160;a&#160;virtual&#160;machineâs&#160;integrity&#160;it&#160;is&#160;interested<br/>in.</p>
<p style="position:absolute;top:477px;left:108px;white-space:nowrap" class="ft24">2</p>
<p style="position:absolute;top:477px;left:144px;white-space:nowrap" class="ft24">Background</p>
<p style="position:absolute;top:516px;left:108px;white-space:nowrap" class="ft28">2.1</p>
<p style="position:absolute;top:516px;left:154px;white-space:nowrap" class="ft28">Trusted&#160;Computing</p>
<p style="position:absolute;top:546px;left:108px;white-space:nowrap" class="ft25">A&#160;TPM&#160;is&#160;a&#160;hardware&#160;implementation&#160;of&#160;multiple</p>
<p style="position:absolute;top:564px;left:108px;white-space:nowrap" class="ft29"><i>roots-of-trust</i></p>
<p style="position:absolute;top:564px;left:192px;white-space:nowrap" class="ft25">,&#160;each&#160;for&#160;a&#160;different&#160;intended&#160;purpose.</p>
<p style="position:absolute;top:582px;left:108px;white-space:nowrap" class="ft27">e.g.,&#160;root&#160;of&#160;trust&#160;for&#160;reporting,&#160;root&#160;of&#160;trust&#160;for&#160;mea-<br/>surement,&#160;and&#160;root&#160;of&#160;trust&#160;for&#160;storage.&#160;The&#160;spec-<br/>ification&#160;of&#160;the&#160;TPM&#160;is&#160;given&#160;by&#160;the&#160;Trusted&#160;Com-<br/>puting&#160;Group&#160;(TCG)&#160;[</p>
<p style="position:absolute;top:635px;left:257px;white-space:nowrap" class="ft26">8</p>
<p style="position:absolute;top:635px;left:264px;white-space:nowrap" class="ft25">].&#160;Each&#160;root&#160;of&#160;trust&#160;enables</p>
<p style="position:absolute;top:653px;left:108px;white-space:nowrap" class="ft27">parties,&#160;both&#160;local&#160;and&#160;remote,&#160;to&#160;place&#160;trust&#160;on&#160;a<br/>TPM-equipped&#160;platform&#160;that&#160;the&#160;platform&#160;will&#160;be-<br/>have&#160;as&#160;expected&#160;for&#160;the&#160;intended&#160;purpose.&#160;By&#160;defi-<br/>nition,&#160;the&#160;parties&#160;trust&#160;each&#160;root-of-trust,&#160;and&#160;there-<br/>fore,&#160;it&#160;is&#160;essential&#160;that&#160;the&#160;root-of-trust&#160;always&#160;be-<br/>haves&#160;as&#160;expected.&#160;Given&#160;that&#160;requirement,&#160;a&#160;hard-<br/>ware&#160;root-of-trustâespecially&#160;one&#160;that&#160;is&#160;completely<br/>protected&#160;from&#160;software&#160;attacks&#160;and&#160;tamper-evident<br/>against&#160;physical&#160;attacks,&#160;as&#160;required&#160;by&#160;the&#160;TPM<br/>specificationâis&#160;better&#160;than&#160;a&#160;software-only&#160;root-of-<br/>trust&#160;because&#160;of&#160;the&#160;inherent&#160;difficulty&#160;of&#160;validating<br/>the&#160;software&#160;that&#160;provides&#160;the&#160;root-of-trust&#160;in&#160;the&#160;first<br/>place.</p>
<p style="position:absolute;top:886px;left:123px;white-space:nowrap" class="ft25">The&#160;TPM&#160;has&#160;Platform&#160;Configuration&#160;Registers</p>
<p style="position:absolute;top:904px;left:108px;white-space:nowrap" class="ft27">(PCRs),&#160;which&#160;are&#160;160-bit&#160;registers&#160;useful&#160;for&#160;storing<br/>platform&#160;integrity&#160;measurements.&#160;The&#160;values&#160;stored<br/>in&#160;PCRs&#160;are&#160;essential&#160;for&#160;TPM&#160;functions&#160;like&#160;attesta-<br/>tion&#160;and&#160;sealing.&#160;The&#160;TPM&#160;specification&#160;requires&#160;the<br/>first&#160;16&#160;PCRs&#160;to&#160;be&#160;non-resettable.&#160;The&#160;values&#160;stored<br/>in&#160;those&#160;registers&#160;can&#160;only&#160;be</p>
<p style="position:absolute;top:994px;left:301px;white-space:nowrap" class="ft29"><i>extended</i></p>
<p style="position:absolute;top:994px;left:357px;white-space:nowrap" class="ft25">.&#160;The&#160;contents</p>
<p style="position:absolute;top:1012px;left:108px;white-space:nowrap" class="ft27">of&#160;other&#160;PCRs&#160;can&#160;be&#160;changed&#160;only&#160;by&#160;the&#160;reset&#160;or<br/>extension&#160;operations.&#160;The&#160;extension&#160;operation&#160;takes<br/>an&#160;input&#160;value&#160;and&#160;a&#160;PCR&#160;as&#160;input&#160;arguments,&#160;and<br/>replaces&#160;the&#160;contents&#160;of&#160;the&#160;PCR&#160;with&#160;a&#160;SHA-1&#160;hash</p>
<p style="position:absolute;top:216px;left:593px;white-space:nowrap" class="ft210"><b>Physical&#160;Hardware</b></p>
<p style="position:absolute;top:126px;left:481px;white-space:nowrap" class="ft210"><b>Management&#160;</b></p>
<p style="position:absolute;top:138px;left:485px;white-space:nowrap" class="ft210"><b>of&#160;security,&#160;</b></p>
<p style="position:absolute;top:150px;left:492px;white-space:nowrap" class="ft210"><b>devices,&#160;</b></p>
<p style="position:absolute;top:162px;left:483px;white-space:nowrap" class="ft210"><b>VMs,&#160;and&#160;I/O</b></p>
<p style="position:absolute;top:111px;left:498px;white-space:nowrap" class="ft210"><b>Dom0</b></p>
<p style="position:absolute;top:166px;left:577px;white-space:nowrap" class="ft210"><b>GuestOS</b></p>
<p style="position:absolute;top:130px;left:585px;white-space:nowrap" class="ft210"><b>User</b></p>
<p style="position:absolute;top:142px;left:575px;white-space:nowrap" class="ft210"><b>Software</b></p>
<p style="position:absolute;top:111px;left:576px;white-space:nowrap" class="ft210"><b>DomU&#160;1</b></p>
<p style="position:absolute;top:166px;left:658px;white-space:nowrap" class="ft210"><b>GuestOS</b></p>
<p style="position:absolute;top:130px;left:668px;white-space:nowrap" class="ft210"><b>User</b></p>
<p style="position:absolute;top:142px;left:658px;white-space:nowrap" class="ft210"><b>Software</b></p>
<p style="position:absolute;top:111px;left:659px;white-space:nowrap" class="ft210"><b>DomU&#160;2</b></p>
<p style="position:absolute;top:166px;left:739px;white-space:nowrap" class="ft210"><b>GuestOS</b></p>
<p style="position:absolute;top:130px;left:750px;white-space:nowrap" class="ft210"><b>User</b></p>
<p style="position:absolute;top:142px;left:740px;white-space:nowrap" class="ft210"><b>Software</b></p>
<p style="position:absolute;top:109px;left:741px;white-space:nowrap" class="ft210"><b>DomU&#160;3</b></p>
<p style="position:absolute;top:194px;left:614px;white-space:nowrap" class="ft210"><b>VMM&#160;Core</b></p>
<p style="position:absolute;top:249px;left:493px;white-space:nowrap" class="ft26">Figure&#160;1:&#160;Xen&#160;Virtual&#160;Machine&#160;Architecture</p>
<p style="position:absolute;top:296px;left:466px;white-space:nowrap" class="ft27">of&#160;the&#160;string&#160;representing&#160;the&#160;concatenation&#160;of&#160;the&#160;old<br/>PCR&#160;contents&#160;and&#160;the&#160;input&#160;value.</p>
<p style="position:absolute;top:332px;left:481px;white-space:nowrap" class="ft25">The&#160;TPM&#160;features&#160;that&#160;we&#160;leverage&#160;in&#160;this&#160;pa-</p>
<p style="position:absolute;top:349px;left:466px;white-space:nowrap" class="ft27">per&#160;are&#160;integrity&#160;measurement,&#160;recording,&#160;attesta-<br/>tion,&#160;and&#160;sealing.&#160;âMeasurementâ&#160;of&#160;a&#160;component&#160;in-<br/>volves&#160;computing&#160;the&#160;SHA-1&#160;hash&#160;of&#160;the&#160;binary&#160;code<br/>of&#160;that&#160;component.&#160;The&#160;sequence&#160;of&#160;measured&#160;val-<br/>ues&#160;are&#160;stored&#160;in&#160;a</p>
<p style="position:absolute;top:421px;left:594px;white-space:nowrap" class="ft29"><i>measurement&#160;log</i></p>
<p style="position:absolute;top:421px;left:703px;white-space:nowrap" class="ft25">,&#160;external&#160;to&#160;the</p>
<p style="position:absolute;top:439px;left:466px;white-space:nowrap" class="ft27">TPM.&#160;âRecordingâ&#160;a&#160;measurement&#160;involves&#160;extend-<br/>ing&#160;a&#160;PCR&#160;with&#160;the&#160;hash.&#160;âAttestationâ&#160;refers&#160;to<br/>the&#160;challenge-response&#160;style&#160;cryptographic&#160;protocol<br/>for&#160;a&#160;remote&#160;party&#160;to&#160;query&#160;the&#160;recorded&#160;platform<br/>measurement&#160;values&#160;and&#160;for&#160;the&#160;platform&#160;to&#160;reliably<br/>report&#160;the&#160;requested&#160;values.&#160;âSealingâ&#160;is&#160;a&#160;TPM&#160;oper-<br/>ation&#160;that&#160;is&#160;used&#160;to&#160;ensure&#160;that&#160;a&#160;certain&#160;data&#160;item<br/>is&#160;accessible&#160;only&#160;under&#160;platform&#160;configurations&#160;re-<br/>flected&#160;by&#160;PCR&#160;values.&#160;The&#160;âunsealingâ&#160;operation<br/>will&#160;reveal&#160;the&#160;data&#160;item&#160;only&#160;if&#160;the&#160;PCR&#160;values&#160;at<br/>the&#160;time&#160;of&#160;the&#160;operation&#160;match&#160;the&#160;specified&#160;PCR<br/>value&#160;at&#160;the&#160;time&#160;of&#160;sealing.</p>
<p style="position:absolute;top:676px;left:466px;white-space:nowrap" class="ft28">2.2</p>
<p style="position:absolute;top:676px;left:512px;white-space:nowrap" class="ft211">Virtual&#160;Machine&#160;Monitors&#160;and<br/>Xen</p>
<p style="position:absolute;top:727px;left:466px;white-space:nowrap" class="ft27">Virtualization&#160;is&#160;a&#160;technology&#160;that&#160;allows&#160;abstract-<br/>ing&#160;away&#160;the&#160;real&#160;hardware&#160;configuration&#160;of&#160;a&#160;sys-<br/>tem&#160;and&#160;allows&#160;multiple&#160;virtual&#160;machines,&#160;each&#160;run-<br/>ning&#160;its&#160;own&#160;operating&#160;system&#160;and&#160;applications,&#160;to<br/>be&#160;hosted&#160;on&#160;a&#160;single&#160;physical&#160;machine.&#160;Virtual&#160;com-<br/>puting&#160;involves&#160;using&#160;a&#160;layer&#160;of&#160;software,&#160;called&#160;the<br/>Virtual&#160;Machine&#160;Monitor&#160;(VMM),&#160;between&#160;the&#160;phys-<br/>ical&#160;hardware&#160;and&#160;the&#160;operating&#160;system&#160;to&#160;provide<br/>the&#160;illusion&#160;of&#160;a&#160;real&#160;physical&#160;machine&#160;to&#160;the&#160;op-<br/>erating&#160;system.&#160;The&#160;VMM&#160;does&#160;this&#160;by&#160;emulating<br/>the&#160;physical&#160;machine&#160;in&#160;software.&#160;The&#160;operating&#160;sys-<br/>tems&#160;running&#160;in&#160;the&#160;virtual&#160;machines&#160;are&#160;called</p>
<p style="position:absolute;top:924px;left:777px;white-space:nowrap" class="ft29"><i>guest</i></p>
<p style="position:absolute;top:942px;left:466px;white-space:nowrap" class="ft27">operating&#160;systems.&#160;Depending&#160;on&#160;how&#160;the&#160;emula-<br/>tion&#160;is&#160;done,&#160;changes&#160;may&#160;or&#160;may&#160;not&#160;be&#160;required<br/>to&#160;the&#160;guest&#160;operating&#160;systems.&#160;Some&#160;VMMs&#160;like<br/>VMware&#160;ESX&#160;and&#160;Xen&#160;V3&#160;can&#160;leverage&#160;recently&#160;in-<br/>troduced&#160;processor&#160;virtualization&#160;support&#160;and&#160;do&#160;not<br/>require&#160;any&#160;change&#160;to&#160;be&#160;made&#160;to&#160;the&#160;guest&#160;operat-<br/>ing&#160;systems.&#160;Without&#160;processor&#160;support,&#160;changes&#160;to<br/>the&#160;guest&#160;operating&#160;system&#160;are&#160;required&#160;(e.g.,&#160;Xen</p>
<p style="position:absolute;top:1112px;left:455px;white-space:nowrap" class="ft26">2</p>
</div>
<!-- Page 3 -->
<a name="3"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft312{font-size:10px;font-family:RLVJOC+CMR7;color:#000000;}
	.ft313{font-size:15px;font-family:VGAMQG+CMBX10;color:#231f20;}
	.ft314{font-size:9px;font-family:XUYCFZ+CMR6;color:#231f20;}
	.ft315{font-size:12px;font-family:WPEVIW+CMR8;color:#231f20;}
	.ft316{font-size:15px;font-family:QOKGGX+CMMI10;color:#000000;}
	.ft317{font-size:10px;font-family:DPFNMB+CMMI7;color:#000000;}
	.ft318{font-size:15px;font-family:ZLEXIB+CMSS10;color:#000000;}
-->
</style>
<div id="page3-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="OTC_XenSecurityServices003.png" alt="background image"/>
<p style="position:absolute;top:110px;left:108px;white-space:nowrap" class="ft35">para-virtualization&#160;[</p>
<p style="position:absolute;top:110px;left:239px;white-space:nowrap" class="ft36">1</p>
<p style="position:absolute;top:110px;left:247px;white-space:nowrap" class="ft35">]).&#160;The&#160;OS&#160;and&#160;applications&#160;of</p>
<p style="position:absolute;top:128px;left:108px;white-space:nowrap" class="ft37">a&#160;VM&#160;run&#160;upon&#160;the&#160;VMâs&#160;own&#160;virtual&#160;resources&#160;(vir-<br/>tual&#160;CPU,&#160;virtual&#160;NIC,&#160;virtual&#160;RAM,&#160;virtual&#160;disks,<br/>etc.).&#160;The&#160;VMM&#160;maps&#160;the&#160;virtual&#160;resources&#160;to&#160;the<br/>physical&#160;resources&#160;and&#160;also&#160;manages&#160;access&#160;to&#160;the&#160;in-<br/>put/output&#160;devices.</p>
<p style="position:absolute;top:218px;left:123px;white-space:nowrap" class="ft35">Although&#160;we&#160;present&#160;our&#160;overall&#160;design&#160;for&#160;the&#160;se-</p>
<p style="position:absolute;top:236px;left:108px;white-space:nowrap" class="ft35">curity&#160;services&#160;in&#160;generic&#160;terms,&#160;in&#160;Section</p>
<p style="position:absolute;top:236px;left:404px;white-space:nowrap" class="ft36">5.5</p>
<p style="position:absolute;top:236px;left:423px;white-space:nowrap" class="ft35">,&#160;we</p>
<p style="position:absolute;top:254px;left:108px;white-space:nowrap" class="ft37">describe&#160;the&#160;concrete&#160;realization&#160;of&#160;our&#160;design&#160;in&#160;the<br/>context&#160;of&#160;the&#160;Xen&#160;VMM&#160;or&#160;the&#160;Xen&#160;hypervisor.</p>
<p style="position:absolute;top:270px;left:445px;white-space:nowrap" class="ft312">1</p>
<p style="position:absolute;top:290px;left:108px;white-space:nowrap" class="ft37">Hence,&#160;we&#160;briefly&#160;mention&#160;the&#160;Xen&#160;virtual&#160;machine<br/>architecture&#160;here&#160;(Figure</p>
<p style="position:absolute;top:308px;left:278px;white-space:nowrap" class="ft36">1</p>
<p style="position:absolute;top:308px;left:285px;white-space:nowrap" class="ft35">).&#160;In&#160;Xen-speak,&#160;running</p>
<p style="position:absolute;top:325px;left:108px;white-space:nowrap" class="ft35">instances&#160;of&#160;virtual&#160;machines&#160;are&#160;called</p>
<p style="position:absolute;top:325px;left:373px;white-space:nowrap" class="ft39"><i>domains</i></p>
<p style="position:absolute;top:325px;left:428px;white-space:nowrap" class="ft35">.&#160;A</p>
<p style="position:absolute;top:343px;left:108px;white-space:nowrap" class="ft37">special&#160;domain,&#160;called&#160;Dom0&#160;or&#160;domain&#160;zero,&#160;is&#160;the<br/>first&#160;domain&#160;that&#160;is&#160;created.&#160;This&#160;domain&#160;controls<br/>all&#160;other&#160;domains,&#160;called&#160;user&#160;domains&#160;or&#160;DomUs.<br/>For&#160;a&#160;given&#160;physical&#160;device,&#160;the&#160;native&#160;device&#160;driver<br/>is&#160;part&#160;of&#160;at&#160;most&#160;one&#160;VM.&#160;If&#160;the&#160;device&#160;is&#160;to&#160;be<br/>shared&#160;with&#160;other&#160;VMs,&#160;then&#160;the&#160;VM&#160;with&#160;the&#160;native<br/>device&#160;driver&#160;makes&#160;the&#160;device&#160;available&#160;through</p>
<p style="position:absolute;top:451px;left:432px;white-space:nowrap" class="ft39"><i>de-</i></p>
<p style="position:absolute;top:469px;left:108px;white-space:nowrap" class="ft39"><i>vice&#160;channels</i></p>
<p style="position:absolute;top:469px;left:197px;white-space:nowrap" class="ft35">implemented&#160;using&#160;shared&#160;memory.&#160;For</p>
<p style="position:absolute;top:487px;left:108px;white-space:nowrap" class="ft37">that&#160;purpose,&#160;the&#160;VM&#160;with&#160;the&#160;native&#160;device&#160;driver<br/>provides&#160;a</p>
<p style="position:absolute;top:505px;left:177px;white-space:nowrap" class="ft39"><i>back-end&#160;driver</i></p>
<p style="position:absolute;top:505px;left:282px;white-space:nowrap" class="ft35">and&#160;any&#160;VM&#160;that&#160;wants&#160;to</p>
<p style="position:absolute;top:523px;left:108px;white-space:nowrap" class="ft37">share&#160;the&#160;device&#160;exports&#160;a&#160;virtual&#160;device&#160;driver&#160;called<br/>the</p>
<p style="position:absolute;top:541px;left:134px;white-space:nowrap" class="ft39"><i>front-end&#160;driver</i></p>
<p style="position:absolute;top:541px;left:244px;white-space:nowrap" class="ft35">to&#160;the&#160;back-end&#160;driver.</p>
<p style="position:absolute;top:584px;left:108px;white-space:nowrap" class="ft34">3</p>
<p style="position:absolute;top:584px;left:144px;white-space:nowrap" class="ft34">Integrity</p>
<p style="position:absolute;top:584px;left:261px;white-space:nowrap" class="ft34">Management</p>
<p style="position:absolute;top:584px;left:422px;white-space:nowrap" class="ft34">for</p>
<p style="position:absolute;top:611px;left:144px;white-space:nowrap" class="ft34">Virtual&#160;Machines</p>
<p style="position:absolute;top:650px;left:108px;white-space:nowrap" class="ft37">In&#160;todayâs&#160;virtualized&#160;environments&#160;integrity&#160;man-<br/>agement&#160;of&#160;virtual&#160;machines&#160;is&#160;an&#160;important&#160;chal-<br/>lenge.</p>
<p style="position:absolute;top:686px;left:163px;white-space:nowrap" class="ft35">Integrity&#160;management&#160;includes&#160;protection,</p>
<p style="position:absolute;top:703px;left:108px;white-space:nowrap" class="ft37">measurement,&#160;reporting,&#160;and&#160;verification&#160;of&#160;the&#160;in-<br/>tegrity&#160;of&#160;virtual&#160;machines,&#160;In&#160;a&#160;traditional&#160;(non-<br/>virtualized)&#160;server&#160;environment,&#160;users&#160;today&#160;are&#160;con-<br/>vinced&#160;that&#160;their&#160;servers&#160;are&#160;trustworthy&#160;by</p>
<p style="position:absolute;top:787px;left:122px;white-space:nowrap" class="ft313">â</p>
<p style="position:absolute;top:787px;left:138px;white-space:nowrap" class="ft35">Running&#160;the&#160;servers&#160;themselves,</p>
<p style="position:absolute;top:817px;left:122px;white-space:nowrap" class="ft313">â</p>
<p style="position:absolute;top:817px;left:138px;white-space:nowrap" class="ft37">Asking&#160;a&#160;provider&#160;to&#160;guarantee&#160;full&#160;control&#160;over<br/>the&#160;server&#160;(i.e.,&#160;a&#160;root&#160;login,&#160;a&#160;dedicated&#160;cage&#160;in<br/>a&#160;larger&#160;data&#160;center,&#160;or&#160;a&#160;dedicated&#160;data&#160;center),</p>
<p style="position:absolute;top:883px;left:122px;white-space:nowrap" class="ft313">â</p>
<p style="position:absolute;top:883px;left:138px;white-space:nowrap" class="ft37">Asking&#160;a&#160;provider&#160;to&#160;provide&#160;log&#160;files&#160;and&#160;other<br/>evidence&#160;that&#160;allows&#160;the&#160;user&#160;to&#160;heuristically&#160;val-<br/>idate&#160;critical&#160;installations,&#160;or</p>
<p style="position:absolute;top:949px;left:122px;white-space:nowrap" class="ft313">â</p>
<p style="position:absolute;top:949px;left:138px;white-space:nowrap" class="ft35">Performing&#160;regular&#160;audits&#160;of&#160;the&#160;hosted&#160;servers.</p>
<p style="position:absolute;top:978px;left:108px;white-space:nowrap" class="ft37">While&#160;many&#160;of&#160;the&#160;above&#160;concepts&#160;used&#160;for&#160;managing<br/>integrity&#160;of&#160;machines&#160;in&#160;non-virtualized&#160;server&#160;envi-<br/>ronments&#160;will&#160;also&#160;be&#160;applicable&#160;for&#160;virtual&#160;servers,</p>
<p style="position:absolute;top:1042px;left:125px;white-space:nowrap" class="ft314">1</p>
<p style="position:absolute;top:1043px;left:131px;white-space:nowrap" class="ft315">Another&#160;virtual&#160;machine&#160;monitor&#160;that&#160;we&#160;envision&#160;to&#160;use</p>
<p style="position:absolute;top:1057px;left:108px;white-space:nowrap" class="ft315">is&#160;Fiasco&#160;[9].</p>
<p style="position:absolute;top:110px;left:466px;white-space:nowrap" class="ft37">integrity&#160;management&#160;in&#160;a&#160;virtualized&#160;environment<br/>is&#160;even&#160;more&#160;difficult&#160;due&#160;to&#160;the&#160;unique&#160;security<br/>and&#160;privacy&#160;challenges&#160;that&#160;arise&#160;in&#160;such&#160;an&#160;environ-<br/>ment.&#160;Users&#160;would&#160;like&#160;to&#160;be&#160;convinced&#160;that&#160;virtual<br/>servers&#160;are&#160;as&#160;secure&#160;as&#160;physical&#160;servers.&#160;However,<br/>that&#160;is&#160;non-trivial&#160;since&#160;the&#160;security&#160;of&#160;virtual&#160;servers<br/>depends&#160;not&#160;only&#160;on&#160;the&#160;server&#160;configuration,&#160;but<br/>also&#160;on&#160;the&#160;security&#160;of&#160;the&#160;virtual&#160;machine&#160;monitor<br/>(VMM)&#160;and&#160;its&#160;services&#160;and&#160;the&#160;ability&#160;to&#160;guarantee<br/>an&#160;acceptable&#160;degree&#160;of&#160;non-interference&#160;and&#160;isolation<br/>among&#160;virtual&#160;machines.&#160;In&#160;addition&#160;to&#160;being&#160;able<br/>to&#160;prove&#160;security&#160;to&#160;one&#160;user,&#160;an&#160;important&#160;privacy<br/>requirement&#160;is&#160;a&#160;guarantee&#160;that&#160;this&#160;proof&#160;does&#160;not<br/>yield&#160;information&#160;about&#160;other&#160;users&#160;on&#160;the&#160;VMM.&#160;In<br/>particular,&#160;when&#160;competing&#160;customers&#160;are&#160;co-hosted<br/>on&#160;the&#160;same&#160;physical&#160;hardware,&#160;no&#160;âvirtual&#160;cagesâ&#160;ex-<br/>ist&#160;today&#160;that&#160;can&#160;guarantee&#160;their&#160;verifiable&#160;isolation.<br/>In&#160;order&#160;to&#160;provide&#160;such&#160;guarantees,&#160;several&#160;aspects<br/>of&#160;the&#160;VMM&#160;need&#160;to&#160;be&#160;verifiable&#160;and&#160;protected:</p>
<p style="position:absolute;top:462px;left:480px;white-space:nowrap" class="ft313">â</p>
<p style="position:absolute;top:462px;left:496px;white-space:nowrap" class="ft37">The&#160;virtual&#160;machine&#160;monitor&#160;(VMM)&#160;software<br/>needs&#160;to&#160;be&#160;designed&#160;to&#160;satisfy&#160;the&#160;security&#160;re-<br/>quirements&#160;of&#160;a&#160;customer.</p>
<p style="position:absolute;top:527px;left:480px;white-space:nowrap" class="ft313">â</p>
<p style="position:absolute;top:527px;left:496px;white-space:nowrap" class="ft37">The&#160;software&#160;running&#160;on&#160;the&#160;machine&#160;needs&#160;to<br/>correspond&#160;to&#160;a&#160;correct&#160;installation&#160;of&#160;a&#160;given<br/>virtual&#160;machine&#160;monitor.</p>
<p style="position:absolute;top:593px;left:480px;white-space:nowrap" class="ft313">â</p>
<p style="position:absolute;top:593px;left:496px;white-space:nowrap" class="ft37">The&#160;policies&#160;and&#160;configuration&#160;files&#160;used&#160;by&#160;the<br/>VMM&#160;should&#160;guarantee&#160;the&#160;security&#160;require-<br/>ments&#160;of&#160;the&#160;customer.&#160;In&#160;addition,&#160;the&#160;policies<br/>should&#160;prevent&#160;unauthorized&#160;modification&#160;of&#160;the<br/>software.</p>
<p style="position:absolute;top:693px;left:466px;white-space:nowrap" class="ft37">We&#160;now&#160;introduce&#160;concepts&#160;that&#160;show&#160;how&#160;to&#160;verify<br/>and&#160;protect&#160;the&#160;VMM&#160;installation&#160;and&#160;policies.&#160;The<br/>first&#160;item&#160;listed&#160;above,&#160;dealing&#160;with&#160;the&#160;writing&#160;cor-<br/>rect&#160;software&#160;is&#160;well-studied&#160;in&#160;the&#160;context&#160;of&#160;formal<br/>methods&#160;and&#160;out&#160;of&#160;the&#160;scope&#160;of&#160;this&#160;paper.</p>
<p style="position:absolute;top:804px;left:466px;white-space:nowrap" class="ft38">3.1</p>
<p style="position:absolute;top:804px;left:512px;white-space:nowrap" class="ft38">Virtual&#160;Machine&#160;Monitor&#160;Model</p>
<p style="position:absolute;top:834px;left:466px;white-space:nowrap" class="ft37">We&#160;now&#160;introduce&#160;an&#160;abstract&#160;notion&#160;of&#160;VMMs<br/>(shown&#160;in&#160;Figure</p>
<p style="position:absolute;top:852px;left:589px;white-space:nowrap" class="ft36">2</p>
<p style="position:absolute;top:852px;left:597px;white-space:nowrap" class="ft35">)&#160;that&#160;we&#160;later&#160;use&#160;for&#160;describ-</p>
<p style="position:absolute;top:870px;left:466px;white-space:nowrap" class="ft37">ing&#160;our&#160;security&#160;concepts&#160;for&#160;virtual&#160;machines.&#160;The<br/>VMM&#160;is&#160;configured&#160;by&#160;a&#160;policy</p>
<p style="position:absolute;top:888px;left:675px;white-space:nowrap" class="ft316"><i>p</i></p>
<p style="position:absolute;top:888px;left:682px;white-space:nowrap" class="ft35">.&#160;At&#160;a&#160;given&#160;time</p>
<p style="position:absolute;top:888px;left:800px;white-space:nowrap" class="ft316"><i>t</i></p>
<p style="position:absolute;top:888px;left:806px;white-space:nowrap" class="ft35">,</p>
<p style="position:absolute;top:906px;left:466px;white-space:nowrap" class="ft35">a&#160;VMM&#160;has&#160;a&#160;state</p>
<p style="position:absolute;top:906px;left:599px;white-space:nowrap" class="ft316"><i>s</i></p>
<p style="position:absolute;top:912px;left:606px;white-space:nowrap" class="ft317"><i>t</i></p>
<p style="position:absolute;top:906px;left:617px;white-space:nowrap" class="ft35">and&#160;produces&#160;log&#160;data</p>
<p style="position:absolute;top:906px;left:768px;white-space:nowrap" class="ft316"><i>l</i></p>
<p style="position:absolute;top:912px;left:772px;white-space:nowrap" class="ft317"><i>t</i></p>
<p style="position:absolute;top:906px;left:783px;white-space:nowrap" class="ft35">that</p>
<p style="position:absolute;top:924px;left:466px;white-space:nowrap" class="ft35">is&#160;computed&#160;by&#160;a&#160;function</p>
<p style="position:absolute;top:924px;left:644px;white-space:nowrap" class="ft318">log</p>
<p style="position:absolute;top:924px;left:662px;white-space:nowrap" class="ft35">(</p>
<p style="position:absolute;top:924px;left:668px;white-space:nowrap" class="ft316"><i>s</i></p>
<p style="position:absolute;top:930px;left:675px;white-space:nowrap" class="ft317"><i>t</i></p>
<p style="position:absolute;top:924px;left:680px;white-space:nowrap" class="ft35">).</p>
<p style="position:absolute;top:924px;left:698px;white-space:nowrap" class="ft316"><i>s</i></p>
<p style="position:absolute;top:930px;left:705px;white-space:nowrap" class="ft317"><i>t</i></p>
<p style="position:absolute;top:924px;left:715px;white-space:nowrap" class="ft35">reflects&#160;the&#160;in-</p>
<p style="position:absolute;top:942px;left:466px;white-space:nowrap" class="ft35">tegrity&#160;of&#160;the&#160;VMM&#160;at&#160;time</p>
<p style="position:absolute;top:942px;left:660px;white-space:nowrap" class="ft316"><i>t</i></p>
<p style="position:absolute;top:942px;left:665px;white-space:nowrap" class="ft35">.&#160;The&#160;state&#160;can&#160;often</p>
<p style="position:absolute;top:960px;left:466px;white-space:nowrap" class="ft35">be&#160;decomposed&#160;into&#160;a&#160;software&#160;state</p>
<p style="position:absolute;top:960px;left:715px;white-space:nowrap" class="ft316"><i>w</i></p>
<p style="position:absolute;top:966px;left:726px;white-space:nowrap" class="ft317"><i>t</i></p>
<p style="position:absolute;top:960px;left:737px;white-space:nowrap" class="ft35">and&#160;a&#160;data</p>
<p style="position:absolute;top:978px;left:466px;white-space:nowrap" class="ft35">state</p>
<p style="position:absolute;top:978px;left:505px;white-space:nowrap" class="ft316"><i>d</i></p>
<p style="position:absolute;top:984px;left:513px;white-space:nowrap" class="ft317"><i>t</i></p>
<p style="position:absolute;top:978px;left:518px;white-space:nowrap" class="ft35">.&#160;Since&#160;truthful&#160;reporting&#160;of&#160;the&#160;state&#160;of&#160;a</p>
<p style="position:absolute;top:996px;left:466px;white-space:nowrap" class="ft37">compromised&#160;VMM&#160;cannot&#160;be&#160;expected,&#160;log&#160;files&#160;and<br/>policies&#160;(that&#160;are&#160;external&#160;to&#160;the&#160;VMM&#160;and&#160;cannot<br/>be&#160;modified&#160;by&#160;the&#160;VMM)&#160;are&#160;used&#160;for&#160;approximat-<br/>ing&#160;the&#160;actual&#160;security.&#160;While&#160;the&#160;log&#160;file&#160;history&#160;gives<br/>an&#160;indication&#160;of&#160;past&#160;security,&#160;security&#160;policies&#160;enable</p>
<p style="position:absolute;top:1112px;left:455px;white-space:nowrap" class="ft36">3</p>
</div>
<!-- Page 4 -->
<a name="4"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft419{font-size:19px;font-family:Helvetica;color:#000000;}
	.ft420{font-size:15px;font-family:Helvetica;color:#000000;}
	.ft421{font-size:12px;font-family:Helvetica;color:#000000;}
	.ft422{font-size:12px;font-family:Helvetica;color:#000000;}
	.ft423{font-size:11px;font-family:Helvetica;color:#000000;}
	.ft424{font-size:28px;font-family:Helvetica;color:#000000;}
	.ft425{font-size:15px;font-family:Times;color:#000000;}
	.ft426{font-size:11px;font-family:Times;color:#000000;}
	.ft427{font-size:10px;font-family:RMXWST+CMSY7;color:#000000;}
	.ft428{font-size:15px;font-family:RNOWCO+CMSY10;color:#000000;}
	.ft429{font-size:7px;font-family:XUMOYH+CMMI5;color:#000000;}
	.ft430{font-size:15px;line-height:17px;font-family:XPRQEY+CMR10;color:#231f20;}
	.ft431{font-size:12px;line-height:14px;font-family:WPEVIW+CMR8;color:#231f20;}
-->
</style>
<div id="page4-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="OTC_XenSecurityServices004.png" alt="background image"/>
<p style="position:absolute;top:209px;left:211px;white-space:nowrap" class="ft419"><b>VMM</b></p>
<p style="position:absolute;top:222px;left:374px;white-space:nowrap" class="ft420"><b>Audit</b></p>
<p style="position:absolute;top:237px;left:366px;white-space:nowrap" class="ft420"><b>System</b></p>
<p style="position:absolute;top:222px;left:313px;white-space:nowrap" class="ft421"><i>log</i></p>
<p style="position:absolute;top:217px;left:136px;white-space:nowrap" class="ft421"><i>policy</i></p>
<p style="position:absolute;top:176px;left:175px;white-space:nowrap" class="ft421"><i>request</i></p>
<p style="position:absolute;top:176px;left:239px;white-space:nowrap" class="ft421"><i>response</i></p>
<p style="position:absolute;top:237px;left:194px;white-space:nowrap" class="ft422">state</p>
<p style="position:absolute;top:119px;left:186px;white-space:nowrap" class="ft419"><b>VM</b></p>
<p style="position:absolute;top:124px;left:196px;white-space:nowrap" class="ft419"><b>VM</b></p>
<p style="position:absolute;top:128px;left:205px;white-space:nowrap" class="ft419"><b>VM</b></p>
<p style="position:absolute;top:133px;left:214px;white-space:nowrap" class="ft419"><b>VM</b></p>
<p style="position:absolute;top:138px;left:224px;white-space:nowrap" class="ft419"><b>VM</b></p>
<p style="position:absolute;top:142px;left:233px;white-space:nowrap" class="ft419"><b>VM</b></p>
<p style="position:absolute;top:129px;left:294px;white-space:nowrap" class="ft421"><i>input</i></p>
<p style="position:absolute;top:152px;left:290px;white-space:nowrap" class="ft421"><i>output</i></p>
<p style="position:absolute;top:141px;left:376px;white-space:nowrap" class="ft420"><b>User</b></p>
<p style="position:absolute;top:282px;left:190px;white-space:nowrap" class="ft419"><b>Hardware</b></p>
<p style="position:absolute;top:256px;left:374px;white-space:nowrap" class="ft422">History</p>
<p style="position:absolute;top:268px;left:383px;white-space:nowrap" class="ft421"><i>log*</i></p>
<p style="position:absolute;top:160px;left:360px;white-space:nowrap" class="ft423">requirements</p>
<p style="position:absolute;top:173px;left:361px;white-space:nowrap" class="ft423">predicate&#160;&#160;&#160;&#160;&#160;</p>
<p style="position:absolute;top:236px;left:234px;white-space:nowrap" class="ft424">}</p>
<p style="position:absolute;top:236px;left:245px;white-space:nowrap" class="ft425">log(s</p>
<p style="position:absolute;top:243px;left:277px;white-space:nowrap" class="ft426">t</p>
<p style="position:absolute;top:236px;left:283px;white-space:nowrap" class="ft425">)</p>
<p style="position:absolute;top:166px;left:410px;white-space:nowrap" class="ft425">Î </p>
<p style="position:absolute;top:241px;left:200px;white-space:nowrap" class="ft425">s</p>
<p style="position:absolute;top:247px;left:208px;white-space:nowrap" class="ft426">t</p>
<p style="position:absolute;top:321px;left:108px;white-space:nowrap" class="ft430">Figure&#160;2:&#160;Integrity&#160;Model&#160;for&#160;Virtual&#160;Machine&#160;Mon-<br/>itors</p>
<p style="position:absolute;top:384px;left:108px;white-space:nowrap" class="ft47">extrapolation&#160;of&#160;future&#160;security&#160;guarantees.&#160;The&#160;se-<br/>ries&#160;of&#160;log&#160;entries&#160;is&#160;collected&#160;by&#160;an&#160;independent&#160;audit<br/>system&#160;in&#160;an&#160;audit&#160;log</p>
<p style="position:absolute;top:420px;left:265px;white-space:nowrap" class="ft416"><i>log</i></p>
<p style="position:absolute;top:418px;left:284px;white-space:nowrap" class="ft427"><i>â</i></p>
<p style="position:absolute;top:420px;left:291px;white-space:nowrap" class="ft45">.&#160;The&#160;software&#160;provides</p>
<p style="position:absolute;top:438px;left:108px;white-space:nowrap" class="ft45">installation&#160;integrity&#160;if</p>
<p style="position:absolute;top:438px;left:262px;white-space:nowrap" class="ft416"><i>w</i></p>
<p style="position:absolute;top:444px;left:272px;white-space:nowrap" class="ft412">0</p>
<p style="position:absolute;top:438px;left:284px;white-space:nowrap" class="ft45">=</p>
<p style="position:absolute;top:438px;left:301px;white-space:nowrap" class="ft416"><i>w</i></p>
<p style="position:absolute;top:438px;left:317px;white-space:nowrap" class="ft45">for&#160;some&#160;installation</p>
<p style="position:absolute;top:456px;left:108px;white-space:nowrap" class="ft45">software</p>
<p style="position:absolute;top:456px;left:169px;white-space:nowrap" class="ft416"><i>w</i></p>
<p style="position:absolute;top:456px;left:180px;white-space:nowrap" class="ft45">,&#160;where</p>
<p style="position:absolute;top:456px;left:238px;white-space:nowrap" class="ft416"><i>t</i></p>
<p style="position:absolute;top:456px;left:251px;white-space:nowrap" class="ft45">=&#160;0&#160;indicates&#160;the&#160;installation</p>
<p style="position:absolute;top:474px;left:108px;white-space:nowrap" class="ft45">time.&#160;Each&#160;user</p>
<p style="position:absolute;top:474px;left:218px;white-space:nowrap" class="ft416"><i>u</i></p>
<p style="position:absolute;top:474px;left:231px;white-space:nowrap" class="ft45">has&#160;a&#160;set&#160;of&#160;security&#160;requirements</p>
<p style="position:absolute;top:492px;left:108px;white-space:nowrap" class="ft47">that&#160;are&#160;modeled&#160;by&#160;predicates.&#160;A&#160;software&#160;provides<br/>integrity&#160;if&#160;a&#160;user-defined&#160;predicate&#160;Î (</p>
<p style="position:absolute;top:509px;left:359px;white-space:nowrap" class="ft416"><i>s</i></p>
<p style="position:absolute;top:509px;left:366px;white-space:nowrap" class="ft45">)&#160;is&#160;satisfied.</p>
<p style="position:absolute;top:549px;left:108px;white-space:nowrap" class="ft48">3.2</p>
<p style="position:absolute;top:549px;left:154px;white-space:nowrap" class="ft411">Generalized&#160;Sealing&#160;to&#160;Protect&#160;In-<br/>tegrity</p>
<p style="position:absolute;top:600px;left:108px;white-space:nowrap" class="ft49"><i>Model:</i></p>
<p style="position:absolute;top:600px;left:160px;white-space:nowrap" class="ft45">The&#160;concept&#160;of&#160;sealing&#160;can&#160;be&#160;used&#160;to&#160;make</p>
<p style="position:absolute;top:618px;left:108px;white-space:nowrap" class="ft45">a&#160;data&#160;item</p>
<p style="position:absolute;top:618px;left:196px;white-space:nowrap" class="ft416"><i>d</i></p>
<p style="position:absolute;top:618px;left:211px;white-space:nowrap" class="ft45">inaccessible&#160;if&#160;the&#160;VMM&#160;state&#160;does</p>
<p style="position:absolute;top:636px;left:108px;white-space:nowrap" class="ft47">not&#160;provide&#160;sufficient&#160;integrity.&#160;It&#160;can&#160;be&#160;modeled<br/>by&#160;two&#160;functions</p>
<p style="position:absolute;top:654px;left:225px;white-space:nowrap" class="ft418">seal</p>
<p style="position:absolute;top:654px;left:254px;white-space:nowrap" class="ft45">and</p>
<p style="position:absolute;top:654px;left:284px;white-space:nowrap" class="ft418">unseal</p>
<p style="position:absolute;top:654px;left:323px;white-space:nowrap" class="ft45">.&#160;The</p>
<p style="position:absolute;top:654px;left:369px;white-space:nowrap" class="ft418">seal</p>
<p style="position:absolute;top:654px;left:398px;white-space:nowrap" class="ft45">function</p>
<p style="position:absolute;top:672px;left:108px;white-space:nowrap" class="ft45">done&#160;at&#160;time</p>
<p style="position:absolute;top:672px;left:196px;white-space:nowrap" class="ft416"><i>t</i></p>
<p style="position:absolute;top:678px;left:202px;white-space:nowrap" class="ft417"><i>i</i></p>
<p style="position:absolute;top:672px;left:212px;white-space:nowrap" class="ft45">takes&#160;as&#160;input&#160;the&#160;data&#160;item</p>
<p style="position:absolute;top:672px;left:403px;white-space:nowrap" class="ft416"><i>d</i></p>
<p style="position:absolute;top:672px;left:411px;white-space:nowrap" class="ft45">,&#160;a&#160;log</p>
<p style="position:absolute;top:689px;left:108px;white-space:nowrap" class="ft45">projection&#160;function</p>
<p style="position:absolute;top:689px;left:237px;white-space:nowrap" class="ft418">p</p>
<p style="position:absolute;top:689px;left:244px;white-space:nowrap" class="ft45">(),&#160;a&#160;predicate&#160;Î ,&#160;and</p>
<p style="position:absolute;top:689px;left:390px;white-space:nowrap" class="ft416"><i>K</i></p>
<p style="position:absolute;top:696px;left:402px;white-space:nowrap" class="ft417"><i>p</i></p>
<p style="position:absolute;top:689px;left:414px;white-space:nowrap" class="ft45">which</p>
<p style="position:absolute;top:707px;left:108px;white-space:nowrap" class="ft45">is&#160;the&#160;public&#160;part&#160;of&#160;an&#160;encryption&#160;key</p>
<p style="position:absolute;top:707px;left:355px;white-space:nowrap" class="ft416"><i>K</i></p>
<p style="position:absolute;top:707px;left:368px;white-space:nowrap" class="ft45">.&#160;It&#160;produces</p>
<p style="position:absolute;top:725px;left:108px;white-space:nowrap" class="ft45">an&#160;encrypted&#160;output</p>
<p style="position:absolute;top:725px;left:253px;white-space:nowrap" class="ft416"><i>e</i></p>
<p style="position:absolute;top:725px;left:268px;white-space:nowrap" class="ft428"><i>â&#160;{</i></p>
<p style="position:absolute;top:725px;left:293px;white-space:nowrap" class="ft45">0</p>
<p style="position:absolute;top:725px;left:300px;white-space:nowrap" class="ft416"><i>,</i></p>
<p style="position:absolute;top:725px;left:307px;white-space:nowrap" class="ft45">1</p>
<p style="position:absolute;top:725px;left:314px;white-space:nowrap" class="ft428"><i>}</i></p>
<p style="position:absolute;top:724px;left:322px;white-space:nowrap" class="ft427"><i>â</i></p>
<p style="position:absolute;top:725px;left:336px;white-space:nowrap" class="ft45">that&#160;is&#160;encrypted</p>
<p style="position:absolute;top:743px;left:108px;white-space:nowrap" class="ft45">with&#160;respect&#160;to</p>
<p style="position:absolute;top:743px;left:213px;white-space:nowrap" class="ft416"><i>K</i></p>
<p style="position:absolute;top:749px;left:226px;white-space:nowrap" class="ft417"><i>p</i></p>
<p style="position:absolute;top:743px;left:233px;white-space:nowrap" class="ft45">.&#160;The&#160;log&#160;projection&#160;function</p>
<p style="position:absolute;top:743px;left:432px;white-space:nowrap" class="ft418">p</p>
<p style="position:absolute;top:743px;left:440px;white-space:nowrap" class="ft45">()</p>
<p style="position:absolute;top:761px;left:108px;white-space:nowrap" class="ft45">takes&#160;the&#160;log</p>
<p style="position:absolute;top:761px;left:196px;white-space:nowrap" class="ft416"><i>l</i></p>
<p style="position:absolute;top:767px;left:201px;white-space:nowrap" class="ft417"><i>t</i></p>
<p style="position:absolute;top:771px;left:205px;white-space:nowrap" class="ft429"><i>i</i></p>
<p style="position:absolute;top:761px;left:216px;white-space:nowrap" class="ft45">as&#160;input&#160;and&#160;outputs&#160;a&#160;subset&#160;of</p>
<p style="position:absolute;top:761px;left:433px;white-space:nowrap" class="ft416"><i>l</i></p>
<p style="position:absolute;top:767px;left:437px;white-space:nowrap" class="ft417"><i>t</i></p>
<p style="position:absolute;top:771px;left:442px;white-space:nowrap" class="ft429"><i>i</i></p>
<p style="position:absolute;top:761px;left:447px;white-space:nowrap" class="ft45">.</p>
<p style="position:absolute;top:779px;left:108px;white-space:nowrap" class="ft45">The</p>
<p style="position:absolute;top:779px;left:140px;white-space:nowrap" class="ft418">unseal</p>
<p style="position:absolute;top:779px;left:185px;white-space:nowrap" class="ft45">function&#160;done&#160;at&#160;time</p>
<p style="position:absolute;top:779px;left:339px;white-space:nowrap" class="ft416"><i>t</i></p>
<p style="position:absolute;top:785px;left:344px;white-space:nowrap" class="ft417"><i>j</i></p>
<p style="position:absolute;top:779px;left:357px;white-space:nowrap" class="ft45">takes&#160;as&#160;input</p>
<p style="position:absolute;top:797px;left:108px;white-space:nowrap" class="ft416"><i>e</i></p>
<p style="position:absolute;top:797px;left:122px;white-space:nowrap" class="ft45">and&#160;the&#160;log</p>
<p style="position:absolute;top:797px;left:208px;white-space:nowrap" class="ft416"><i>l</i></p>
<p style="position:absolute;top:803px;left:213px;white-space:nowrap" class="ft417"><i>t</i></p>
<p style="position:absolute;top:807px;left:217px;white-space:nowrap" class="ft429"><i>j</i></p>
<p style="position:absolute;top:797px;left:231px;white-space:nowrap" class="ft45">and&#160;outputs</p>
<p style="position:absolute;top:797px;left:319px;white-space:nowrap" class="ft416"><i>d</i></p>
<p style="position:absolute;top:797px;left:335px;white-space:nowrap" class="ft45">iff&#160;Î (</p>
<p style="position:absolute;top:797px;left:372px;white-space:nowrap" class="ft418">p</p>
<p style="position:absolute;top:797px;left:379px;white-space:nowrap" class="ft45">(</p>
<p style="position:absolute;top:797px;left:385px;white-space:nowrap" class="ft416"><i>l</i></p>
<p style="position:absolute;top:803px;left:390px;white-space:nowrap" class="ft417"><i>t</i></p>
<p style="position:absolute;top:807px;left:394px;white-space:nowrap" class="ft429"><i>j</i></p>
<p style="position:absolute;top:797px;left:401px;white-space:nowrap" class="ft45">))&#160;=&#160;1.</p>
<p style="position:absolute;top:815px;left:108px;white-space:nowrap" class="ft47">A&#160;simple&#160;implementation&#160;of&#160;the&#160;predicate&#160;Î &#160;would<br/>compare&#160;an&#160;input</p>
<p style="position:absolute;top:833px;left:228px;white-space:nowrap" class="ft416"><i>x</i></p>
<p style="position:absolute;top:833px;left:242px;white-space:nowrap" class="ft45">to</p>
<p style="position:absolute;top:833px;left:260px;white-space:nowrap" class="ft418">p</p>
<p style="position:absolute;top:833px;left:268px;white-space:nowrap" class="ft45">(</p>
<p style="position:absolute;top:833px;left:274px;white-space:nowrap" class="ft416"><i>l</i></p>
<p style="position:absolute;top:839px;left:278px;white-space:nowrap" class="ft417"><i>t</i></p>
<p style="position:absolute;top:843px;left:283px;white-space:nowrap" class="ft429"><i>i</i></p>
<p style="position:absolute;top:833px;left:288px;white-space:nowrap" class="ft45">),&#160;i.e.,&#160;Î (</p>
<p style="position:absolute;top:833px;left:348px;white-space:nowrap" class="ft416"><i>x</i></p>
<p style="position:absolute;top:833px;left:357px;white-space:nowrap" class="ft45">)&#160;:</p>
<p style="position:absolute;top:833px;left:375px;white-space:nowrap" class="ft416"><i>x</i></p>
<p style="position:absolute;top:833px;left:388px;white-space:nowrap" class="ft45">=</p>
<p style="position:absolute;top:833px;left:404px;white-space:nowrap" class="ft418">p</p>
<p style="position:absolute;top:833px;left:411px;white-space:nowrap" class="ft45">(</p>
<p style="position:absolute;top:833px;left:417px;white-space:nowrap" class="ft416"><i>l</i></p>
<p style="position:absolute;top:839px;left:422px;white-space:nowrap" class="ft417"><i>t</i></p>
<p style="position:absolute;top:843px;left:426px;white-space:nowrap" class="ft429"><i>i</i></p>
<p style="position:absolute;top:833px;left:432px;white-space:nowrap" class="ft45">).</p>
<p style="position:absolute;top:851px;left:123px;white-space:nowrap" class="ft45">Assuming&#160;the&#160;audit&#160;system&#160;is&#160;correct,&#160;one&#160;possible</p>
<p style="position:absolute;top:869px;left:108px;white-space:nowrap" class="ft47">implementation&#160;of&#160;sealing&#160;and&#160;unsealing&#160;is&#160;as&#160;follows.<br/>During</p>
<p style="position:absolute;top:887px;left:157px;white-space:nowrap" class="ft418">seal</p>
<p style="position:absolute;top:887px;left:180px;white-space:nowrap" class="ft45">(),</p>
<p style="position:absolute;top:887px;left:199px;white-space:nowrap" class="ft416"><i>K</i></p>
<p style="position:absolute;top:893px;left:212px;white-space:nowrap" class="ft417"><i>p</i></p>
<p style="position:absolute;top:887px;left:219px;white-space:nowrap" class="ft45">(</p>
<p style="position:absolute;top:887px;left:225px;white-space:nowrap" class="ft418">p</p>
<p style="position:absolute;top:887px;left:233px;white-space:nowrap" class="ft45">()</p>
<p style="position:absolute;top:887px;left:244px;white-space:nowrap" class="ft416"><i>,</i></p>
<p style="position:absolute;top:887px;left:251px;white-space:nowrap" class="ft45">Î </p>
<p style="position:absolute;top:887px;left:262px;white-space:nowrap" class="ft416"><i>,&#160;s</i></p>
<p style="position:absolute;top:887px;left:276px;white-space:nowrap" class="ft45">)&#160;is&#160;obtained&#160;using&#160;the&#160;state</p>
<p style="position:absolute;top:905px;left:108px;white-space:nowrap" class="ft416"><i>s</i></p>
<p style="position:absolute;top:905px;left:115px;white-space:nowrap" class="ft45">.&#160;On</p>
<p style="position:absolute;top:905px;left:154px;white-space:nowrap" class="ft418">unseal</p>
<p style="position:absolute;top:905px;left:192px;white-space:nowrap" class="ft45">(),&#160;the&#160;audit&#160;system&#160;decrypts&#160;this&#160;mes-</p>
<p style="position:absolute;top:923px;left:108px;white-space:nowrap" class="ft45">sage&#160;using&#160;its&#160;secret&#160;key</p>
<p style="position:absolute;top:923px;left:272px;white-space:nowrap" class="ft416"><i>K</i></p>
<p style="position:absolute;top:929px;left:285px;white-space:nowrap" class="ft417"><i>s</i></p>
<p style="position:absolute;top:923px;left:297px;white-space:nowrap" class="ft45">and&#160;outputs&#160;the&#160;state</p>
<p style="position:absolute;top:923px;left:445px;white-space:nowrap" class="ft416"><i>s</i></p>
<p style="position:absolute;top:941px;left:108px;white-space:nowrap" class="ft45">iff&#160;Î (</p>
<p style="position:absolute;top:941px;left:143px;white-space:nowrap" class="ft418">p</p>
<p style="position:absolute;top:941px;left:151px;white-space:nowrap" class="ft45">(</p>
<p style="position:absolute;top:941px;left:156px;white-space:nowrap" class="ft416"><i>l</i></p>
<p style="position:absolute;top:947px;left:161px;white-space:nowrap" class="ft417"><i>t</i></p>
<p style="position:absolute;top:951px;left:165px;white-space:nowrap" class="ft429"><i>j</i></p>
<p style="position:absolute;top:941px;left:172px;white-space:nowrap" class="ft45">)).</p>
<p style="position:absolute;top:958px;left:123px;white-space:nowrap" class="ft45">The&#160;predicate&#160;Î &#160;models&#160;the&#160;various&#160;criteria&#160;for&#160;as-</p>
<p style="position:absolute;top:976px;left:108px;white-space:nowrap" class="ft47">sessing&#160;trustworthiness&#160;of&#160;the&#160;platform.&#160;This&#160;can&#160;be<br/>a&#160;simple&#160;predicate&#160;that&#160;compares&#160;configurations&#160;such<br/>as&#160;the&#160;input&#160;startup&#160;config&#160;with&#160;a&#160;fixed&#160;configuration<br/>at&#160;hibernation&#160;time.&#160;More&#160;complex&#160;predicates&#160;could<br/>evaluate&#160;certain&#160;properties&#160;such&#160;as&#160;whether&#160;only&#160;cer-<br/>tified&#160;or&#160;well-known&#160;software&#160;are&#160;being&#160;used&#160;[</p>
<p style="position:absolute;top:1066px;left:404px;white-space:nowrap" class="ft46">10</p>
<p style="position:absolute;top:1066px;left:419px;white-space:nowrap" class="ft45">,</p>
<p style="position:absolute;top:1066px;left:425px;white-space:nowrap" class="ft46">11</p>
<p style="position:absolute;top:1066px;left:440px;white-space:nowrap" class="ft45">].</p>
<p style="position:absolute;top:110px;left:481px;white-space:nowrap" class="ft49"><i>Usage:</i></p>
<p style="position:absolute;top:110px;left:537px;white-space:nowrap" class="ft45">An&#160;important&#160;application&#160;of&#160;the&#160;sealing</p>
<p style="position:absolute;top:128px;left:466px;white-space:nowrap" class="ft47">function&#160;in&#160;integrity&#160;management&#160;would&#160;be&#160;to&#160;make<br/>inaccessible&#160;certain&#160;secrets&#160;if&#160;the&#160;integrity&#160;of&#160;the&#160;plat-<br/>form&#160;is&#160;not&#160;guaranteed.&#160;An&#160;example&#160;usage&#160;is&#160;to&#160;seal<br/>data&#160;to&#160;a&#160;software.&#160;The&#160;usage&#160;can&#160;be&#160;implemented&#160;by<br/>a&#160;projection</p>
<p style="position:absolute;top:200px;left:550px;white-space:nowrap" class="ft418">p</p>
<p style="position:absolute;top:200px;left:558px;white-space:nowrap" class="ft45">()&#160;that&#160;derives&#160;the&#160;software&#160;state&#160;from</p>
<p style="position:absolute;top:218px;left:466px;white-space:nowrap" class="ft45">the&#160;log</p>
<p style="position:absolute;top:218px;left:516px;white-space:nowrap" class="ft416"><i>l</i></p>
<p style="position:absolute;top:224px;left:520px;white-space:nowrap" class="ft417"><i>t</i></p>
<p style="position:absolute;top:228px;left:525px;white-space:nowrap" class="ft429"><i>i</i></p>
<p style="position:absolute;top:218px;left:535px;white-space:nowrap" class="ft45">(assuming&#160;that&#160;the&#160;log&#160;file&#160;reliably&#160;reflects</p>
<p style="position:absolute;top:236px;left:466px;white-space:nowrap" class="ft45">the&#160;software&#160;[</p>
<p style="position:absolute;top:236px;left:558px;white-space:nowrap" class="ft46">6</p>
<p style="position:absolute;top:236px;left:566px;white-space:nowrap" class="ft45">]).&#160;If&#160;the&#160;software&#160;state&#160;at&#160;the&#160;time</p>
<p style="position:absolute;top:254px;left:466px;white-space:nowrap" class="ft45">of&#160;sealing&#160;is</p>
<p style="position:absolute;top:254px;left:549px;white-space:nowrap" class="ft416"><i>w</i></p>
<p style="position:absolute;top:254px;left:565px;white-space:nowrap" class="ft45">=</p>
<p style="position:absolute;top:254px;left:582px;white-space:nowrap" class="ft418">f</p>
<p style="position:absolute;top:254px;left:587px;white-space:nowrap" class="ft45">(</p>
<p style="position:absolute;top:254px;left:593px;white-space:nowrap" class="ft416"><i>l</i></p>
<p style="position:absolute;top:260px;left:597px;white-space:nowrap" class="ft417"><i>t</i></p>
<p style="position:absolute;top:264px;left:602px;white-space:nowrap" class="ft429"><i>i</i></p>
<p style="position:absolute;top:254px;left:607px;white-space:nowrap" class="ft45">)&#160;and&#160;the&#160;software&#160;state&#160;at&#160;the</p>
<p style="position:absolute;top:272px;left:466px;white-space:nowrap" class="ft45">time&#160;of&#160;unsealing&#160;is</p>
<p style="position:absolute;top:272px;left:598px;white-space:nowrap" class="ft416"><i>w</i></p>
<p style="position:absolute;top:270px;left:609px;white-space:nowrap" class="ft427"><i>0</i></p>
<p style="position:absolute;top:272px;left:617px;white-space:nowrap" class="ft45">=</p>
<p style="position:absolute;top:272px;left:633px;white-space:nowrap" class="ft418">f</p>
<p style="position:absolute;top:272px;left:639px;white-space:nowrap" class="ft45">(</p>
<p style="position:absolute;top:272px;left:644px;white-space:nowrap" class="ft416"><i>l</i></p>
<p style="position:absolute;top:278px;left:649px;white-space:nowrap" class="ft417"><i>t</i></p>
<p style="position:absolute;top:282px;left:653px;white-space:nowrap" class="ft429"><i>j</i></p>
<p style="position:absolute;top:272px;left:660px;white-space:nowrap" class="ft45">),&#160;then&#160;the&#160;predicate&#160;Î </p>
<p style="position:absolute;top:290px;left:466px;white-space:nowrap" class="ft45">would&#160;be&#160;defined&#160;as&#160;Î (</p>
<p style="position:absolute;top:290px;left:621px;white-space:nowrap" class="ft416"><i>w</i></p>
<p style="position:absolute;top:288px;left:632px;white-space:nowrap" class="ft427"><i>0</i></p>
<p style="position:absolute;top:290px;left:637px;white-space:nowrap" class="ft45">)&#160;iff</p>
<p style="position:absolute;top:290px;left:667px;white-space:nowrap" class="ft416"><i>w</i></p>
<p style="position:absolute;top:288px;left:678px;white-space:nowrap" class="ft427"><i>0</i></p>
<p style="position:absolute;top:290px;left:688px;white-space:nowrap" class="ft45">=</p>
<p style="position:absolute;top:290px;left:706px;white-space:nowrap" class="ft416"><i>w</i></p>
<p style="position:absolute;top:290px;left:717px;white-space:nowrap" class="ft45">.&#160;Another&#160;ex-</p>
<p style="position:absolute;top:308px;left:466px;white-space:nowrap" class="ft47">ample&#160;usage&#160;would&#160;be&#160;to&#160;seal&#160;a&#160;hard&#160;disk&#160;to&#160;a&#160;VMM.<br/>In&#160;this&#160;case,&#160;the&#160;software&#160;is&#160;the&#160;VMM.&#160;The&#160;secret&#160;is<br/>a&#160;key&#160;that&#160;is&#160;used&#160;to&#160;decrypt&#160;the&#160;hard&#160;disk.</p>
<p style="position:absolute;top:361px;left:481px;white-space:nowrap" class="ft49"><i>Special&#160;Case&#160;-&#160;Trusted&#160;Platform&#160;Module:</i></p>
<p style="position:absolute;top:361px;left:746px;white-space:nowrap" class="ft45">The&#160;TPM</p>
<p style="position:absolute;top:379px;left:466px;white-space:nowrap" class="ft47">implements&#160;the&#160;special&#160;case&#160;where&#160;log&#160;entries&#160;are&#160;re-<br/>stricted&#160;to&#160;storing&#160;hash-values&#160;in&#160;a&#160;limited&#160;number&#160;of<br/>platform&#160;configuration&#160;registers&#160;(PCR).&#160;The&#160;log&#160;file<br/>projection</p>
<p style="position:absolute;top:433px;left:538px;white-space:nowrap" class="ft418">p</p>
<p style="position:absolute;top:433px;left:546px;white-space:nowrap" class="ft45">()&#160;is&#160;defined&#160;as&#160;a&#160;subset&#160;of&#160;the&#160;PCR&#160;in-</p>
<p style="position:absolute;top:451px;left:466px;white-space:nowrap" class="ft45">dices</p>
<p style="position:absolute;top:451px;left:503px;white-space:nowrap" class="ft428"><i>{</i></p>
<p style="position:absolute;top:451px;left:511px;white-space:nowrap" class="ft45">1</p>
<p style="position:absolute;top:451px;left:518px;white-space:nowrap" class="ft416"><i>,&#160;...,&#160;n</i></p>
<p style="position:absolute;top:451px;left:553px;white-space:nowrap" class="ft428"><i>}</i></p>
<p style="position:absolute;top:451px;left:561px;white-space:nowrap" class="ft45">.&#160;The&#160;integrity&#160;predicate&#160;is&#160;defined&#160;as</p>
<p style="position:absolute;top:469px;left:466px;white-space:nowrap" class="ft45">a&#160;desired&#160;PCR&#160;value&#160;for&#160;each&#160;register&#160;in&#160;this&#160;subset.</p>
<p style="position:absolute;top:508px;left:466px;white-space:nowrap" class="ft48">3.3</p>
<p style="position:absolute;top:508px;left:512px;white-space:nowrap" class="ft411">Generalized&#160;Attestation&#160;to&#160;Prove<br/>Integrity</p>
<p style="position:absolute;top:559px;left:466px;white-space:nowrap" class="ft49"><i>Model:</i></p>
<p style="position:absolute;top:559px;left:521px;white-space:nowrap" class="ft45">Attestation&#160;aims&#160;at&#160;convincing&#160;a&#160;user&#160;that</p>
<p style="position:absolute;top:577px;left:466px;white-space:nowrap" class="ft47">the&#160;state&#160;of&#160;the&#160;machine&#160;is&#160;as&#160;expected.&#160;That&#160;is&#160;done<br/>by&#160;signing&#160;a&#160;projection&#160;of&#160;the&#160;log&#160;file</p>
<p style="position:absolute;top:595px;left:726px;white-space:nowrap" class="ft416"><i>log</i></p>
<p style="position:absolute;top:593px;left:745px;white-space:nowrap" class="ft427"><i>â</i></p>
<p style="position:absolute;top:595px;left:752px;white-space:nowrap" class="ft45">.&#160;In&#160;our</p>
<p style="position:absolute;top:613px;left:466px;white-space:nowrap" class="ft47">model,&#160;the&#160;log&#160;file&#160;contains&#160;a&#160;list&#160;of&#160;all&#160;log&#160;entries.<br/>An&#160;attestation&#160;function</p>
<p style="position:absolute;top:631px;left:627px;white-space:nowrap" class="ft418">attest</p>
<p style="position:absolute;top:631px;left:668px;white-space:nowrap" class="ft45">obtains&#160;a&#160;challenge</p>
<p style="position:absolute;top:631px;left:799px;white-space:nowrap" class="ft416"><i>c</i></p>
<p style="position:absolute;top:631px;left:806px;white-space:nowrap" class="ft45">,</p>
<p style="position:absolute;top:649px;left:466px;white-space:nowrap" class="ft45">a&#160;function</p>
<p style="position:absolute;top:649px;left:536px;white-space:nowrap" class="ft418">f</p>
<p style="position:absolute;top:649px;left:542px;white-space:nowrap" class="ft45">()&#160;(that&#160;we&#160;describe&#160;below),&#160;a&#160;log&#160;file&#160;pro-</p>
<p style="position:absolute;top:667px;left:466px;white-space:nowrap" class="ft45">jection</p>
<p style="position:absolute;top:667px;left:514px;white-space:nowrap" class="ft418">p</p>
<p style="position:absolute;top:667px;left:522px;white-space:nowrap" class="ft45">(),&#160;and&#160;a&#160;secret&#160;key</p>
<p style="position:absolute;top:667px;left:651px;white-space:nowrap" class="ft416"><i>K</i></p>
<p style="position:absolute;top:673px;left:664px;white-space:nowrap" class="ft417"><i>s</i></p>
<p style="position:absolute;top:667px;left:675px;white-space:nowrap" class="ft45">and&#160;outputs&#160;a&#160;signed</p>
<p style="position:absolute;top:685px;left:466px;white-space:nowrap" class="ft45">message</p>
<p style="position:absolute;top:685px;left:524px;white-space:nowrap" class="ft418">sign</p>
<p style="position:absolute;top:692px;left:548px;white-space:nowrap" class="ft417"><i>K</i></p>
<p style="position:absolute;top:696px;left:558px;white-space:nowrap" class="ft429"><i>s</i></p>
<p style="position:absolute;top:685px;left:565px;white-space:nowrap" class="ft45">(</p>
<p style="position:absolute;top:685px;left:571px;white-space:nowrap" class="ft418">f</p>
<p style="position:absolute;top:685px;left:576px;white-space:nowrap" class="ft45">(</p>
<p style="position:absolute;top:685px;left:582px;white-space:nowrap" class="ft418">p</p>
<p style="position:absolute;top:685px;left:590px;white-space:nowrap" class="ft45">(</p>
<p style="position:absolute;top:685px;left:596px;white-space:nowrap" class="ft416"><i>log</i></p>
<p style="position:absolute;top:683px;left:615px;white-space:nowrap" class="ft427"><i>â</i></p>
<p style="position:absolute;top:685px;left:622px;white-space:nowrap" class="ft45">))</p>
<p style="position:absolute;top:685px;left:634px;white-space:nowrap" class="ft416"><i>,&#160;c</i></p>
<p style="position:absolute;top:685px;left:647px;white-space:nowrap" class="ft45">).</p>
<p style="position:absolute;top:703px;left:481px;white-space:nowrap" class="ft49"><i>Usage:</i></p>
<p style="position:absolute;top:703px;left:534px;white-space:nowrap" class="ft45">Attestation&#160;can&#160;be&#160;used&#160;in&#160;two&#160;ways:</p>
<p style="position:absolute;top:703px;left:790px;white-space:nowrap" class="ft49"><i>Bi-</i></p>
<p style="position:absolute;top:721px;left:466px;white-space:nowrap" class="ft49"><i>nary&#160;attestation</i></p>
<p style="position:absolute;top:721px;left:579px;white-space:nowrap" class="ft45">signs&#160;a&#160;subset&#160;of&#160;the&#160;log&#160;file.&#160;This</p>
<p style="position:absolute;top:739px;left:466px;white-space:nowrap" class="ft45">means&#160;that&#160;the&#160;function</p>
<p style="position:absolute;top:739px;left:631px;white-space:nowrap" class="ft418">f</p>
<p style="position:absolute;top:739px;left:637px;white-space:nowrap" class="ft45">()&#160;is&#160;the&#160;identity&#160;function,</p>
<p style="position:absolute;top:757px;left:466px;white-space:nowrap" class="ft45">i.e.,</p>
<p style="position:absolute;top:757px;left:495px;white-space:nowrap" class="ft418">f</p>
<p style="position:absolute;top:757px;left:501px;white-space:nowrap" class="ft45">(</p>
<p style="position:absolute;top:757px;left:507px;white-space:nowrap" class="ft416"><i>x</i></p>
<p style="position:absolute;top:757px;left:515px;white-space:nowrap" class="ft45">)&#160;=</p>
<p style="position:absolute;top:757px;left:542px;white-space:nowrap" class="ft416"><i>x</i></p>
<p style="position:absolute;top:757px;left:551px;white-space:nowrap" class="ft45">.&#160;It&#160;enables&#160;the&#160;user&#160;to&#160;obtain&#160;a&#160;signed</p>
<p style="position:absolute;top:774px;left:466px;white-space:nowrap" class="ft47">subset&#160;of&#160;the&#160;log&#160;file&#160;and&#160;requires&#160;the&#160;user&#160;to&#160;locally<br/>assess&#160;its&#160;trustworthiness.</p>
<p style="position:absolute;top:792px;left:641px;white-space:nowrap" class="ft49"><i>Property-based&#160;attestation</i></p>
<p style="position:absolute;top:810px;left:466px;white-space:nowrap" class="ft45">[</p>
<p style="position:absolute;top:810px;left:471px;white-space:nowrap" class="ft46">10</p>
<p style="position:absolute;top:810px;left:486px;white-space:nowrap" class="ft45">,</p>
<p style="position:absolute;top:810px;left:492px;white-space:nowrap" class="ft46">11</p>
<p style="position:absolute;top:810px;left:507px;white-space:nowrap" class="ft45">,</p>
<p style="position:absolute;top:810px;left:513px;white-space:nowrap" class="ft46">12</p>
<p style="position:absolute;top:810px;left:528px;white-space:nowrap" class="ft45">]&#160;allows&#160;the&#160;user&#160;to&#160;only&#160;obtain&#160;the&#160;results</p>
<p style="position:absolute;top:828px;left:466px;white-space:nowrap" class="ft47">of&#160;function&#160;evaluations&#160;on&#160;the&#160;log&#160;file.&#160;For&#160;example,<br/>a&#160;user&#160;can&#160;specify&#160;what&#160;software</p>
<p style="position:absolute;top:846px;left:684px;white-space:nowrap" class="ft416"><i>w</i></p>
<p style="position:absolute;top:852px;left:695px;white-space:nowrap" class="ft412">1</p>
<p style="position:absolute;top:846px;left:702px;white-space:nowrap" class="ft416"><i>,&#160;w</i></p>
<p style="position:absolute;top:852px;left:719px;white-space:nowrap" class="ft412">2</p>
<p style="position:absolute;top:846px;left:726px;white-space:nowrap" class="ft416"><i>,&#160;...</i></p>
<p style="position:absolute;top:846px;left:750px;white-space:nowrap" class="ft45">he&#160;deems</p>
<p style="position:absolute;top:864px;left:466px;white-space:nowrap" class="ft45">acceptable&#160;and&#160;define&#160;the&#160;function</p>
<p style="position:absolute;top:864px;left:696px;white-space:nowrap" class="ft418">f</p>
<p style="position:absolute;top:864px;left:702px;white-space:nowrap" class="ft45">()&#160;to&#160;assess&#160;from</p>
<p style="position:absolute;top:882px;left:466px;white-space:nowrap" class="ft47">the&#160;log&#160;file&#160;whether&#160;any&#160;other&#160;software&#160;was&#160;executed.<br/>Similarly,</p>
<p style="position:absolute;top:900px;left:534px;white-space:nowrap" class="ft418">f</p>
<p style="position:absolute;top:900px;left:539px;white-space:nowrap" class="ft45">()&#160;can&#160;be&#160;used&#160;to&#160;extract&#160;certain&#160;policies</p>
<p style="position:absolute;top:918px;left:466px;white-space:nowrap" class="ft47">or&#160;evaluate&#160;other&#160;conditions.&#160;Attestation&#160;can&#160;be&#160;used<br/>to&#160;convince&#160;a&#160;user&#160;of&#160;the&#160;integrity&#160;of&#160;the&#160;machine</p>
<p style="position:absolute;top:934px;left:782px;white-space:nowrap" class="ft412">2</p>
<p style="position:absolute;top:936px;left:788px;white-space:nowrap" class="ft45">.&#160;It</p>
<p style="position:absolute;top:954px;left:466px;white-space:nowrap" class="ft47">can&#160;also&#160;be&#160;used&#160;to&#160;validate&#160;the&#160;integrity&#160;of&#160;machines<br/>when&#160;connecting&#160;to&#160;a&#160;network&#160;(cf.&#160;Ciscoâs&#160;Network<br/>Admission&#160;Control).</p>
<p style="position:absolute;top:1018px;left:483px;white-space:nowrap" class="ft414">2</p>
<p style="position:absolute;top:1019px;left:489px;white-space:nowrap" class="ft415">Note&#160;that&#160;this&#160;usually&#160;requires&#160;that&#160;the&#160;user&#160;has&#160;a&#160;inde-</p>
<p style="position:absolute;top:1034px;left:466px;white-space:nowrap" class="ft431">pendent&#160;computing&#160;device&#160;to&#160;do&#160;this&#160;verification.&#160;One&#160;example<br/>is&#160;a&#160;customer&#160;verifying&#160;a&#160;data&#160;center.</p>
<p style="position:absolute;top:1112px;left:455px;white-space:nowrap" class="ft46">4</p>
</div>
<!-- Page 5 -->
<a name="5"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft532{font-size:14px;font-family:Times;color:#000000;}
	.ft533{font-size:10px;font-family:Times;color:#000000;}
-->
</style>
<div id="page5-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="OTC_XenSecurityServices005.png" alt="background image"/>
<p style="position:absolute;top:108px;left:211px;white-space:nowrap" class="ft532">(id,&#160;type,&#160;log)</p>
<p style="position:absolute;top:145px;left:115px;white-space:nowrap" class="ft532">(id</p>
<p style="position:absolute;top:151px;left:132px;white-space:nowrap" class="ft533">1</p>
<p style="position:absolute;top:145px;left:138px;white-space:nowrap" class="ft532">,&#160;type</p>
<p style="position:absolute;top:151px;left:170px;white-space:nowrap" class="ft533">1</p>
<p style="position:absolute;top:145px;left:176px;white-space:nowrap" class="ft532">,&#160;log</p>
<p style="position:absolute;top:151px;left:200px;white-space:nowrap" class="ft533">1</p>
<p style="position:absolute;top:145px;left:206px;white-space:nowrap" class="ft532">)</p>
<p style="position:absolute;top:145px;left:277px;white-space:nowrap" class="ft532">(id</p>
<p style="position:absolute;top:151px;left:294px;white-space:nowrap" class="ft533">2</p>
<p style="position:absolute;top:145px;left:301px;white-space:nowrap" class="ft532">,&#160;type</p>
<p style="position:absolute;top:151px;left:332px;white-space:nowrap" class="ft533">2</p>
<p style="position:absolute;top:145px;left:339px;white-space:nowrap" class="ft532">,&#160;log</p>
<p style="position:absolute;top:151px;left:363px;white-space:nowrap" class="ft533">2</p>
<p style="position:absolute;top:145px;left:369px;white-space:nowrap" class="ft532">)</p>
<p style="position:absolute;top:168px;left:143px;white-space:nowrap" class="ft532">(id</p>
<p style="position:absolute;top:174px;left:160px;white-space:nowrap" class="ft533">11</p>
<p style="position:absolute;top:168px;left:172px;white-space:nowrap" class="ft532">,&#160;type</p>
<p style="position:absolute;top:174px;left:204px;white-space:nowrap" class="ft533">11</p>
<p style="position:absolute;top:168px;left:215px;white-space:nowrap" class="ft532">,&#160;log</p>
<p style="position:absolute;top:174px;left:239px;white-space:nowrap" class="ft533">11</p>
<p style="position:absolute;top:168px;left:251px;white-space:nowrap" class="ft532">)</p>
<p style="position:absolute;top:164px;left:322px;white-space:nowrap" class="ft532">(id</p>
<p style="position:absolute;top:170px;left:339px;white-space:nowrap" class="ft533">21</p>
<p style="position:absolute;top:164px;left:351px;white-space:nowrap" class="ft532">,&#160;type</p>
<p style="position:absolute;top:170px;left:383px;white-space:nowrap" class="ft533">21</p>
<p style="position:absolute;top:164px;left:394px;white-space:nowrap" class="ft532">,&#160;log</p>
<p style="position:absolute;top:170px;left:418px;white-space:nowrap" class="ft533">21</p>
<p style="position:absolute;top:164px;left:430px;white-space:nowrap" class="ft532">)</p>
<p style="position:absolute;top:205px;left:322px;white-space:nowrap" class="ft532">(id</p>
<p style="position:absolute;top:211px;left:339px;white-space:nowrap" class="ft533">2n</p>
<p style="position:absolute;top:205px;left:352px;white-space:nowrap" class="ft532">,&#160;type</p>
<p style="position:absolute;top:211px;left:384px;white-space:nowrap" class="ft533">2n</p>
<p style="position:absolute;top:205px;left:397px;white-space:nowrap" class="ft532">,&#160;log</p>
<p style="position:absolute;top:211px;left:421px;white-space:nowrap" class="ft533">2n</p>
<p style="position:absolute;top:205px;left:434px;white-space:nowrap" class="ft532">)</p>
<p style="position:absolute;top:174px;left:322px;white-space:nowrap" class="ft532">...</p>
<p style="position:absolute;top:243px;left:185px;white-space:nowrap" class="ft56">Figure&#160;3:&#160;Trees&#160;of&#160;log&#160;entries</p>
<p style="position:absolute;top:290px;left:123px;white-space:nowrap" class="ft59"><i>Special&#160;Case&#160;-&#160;Trusted&#160;Platform&#160;Module:</i></p>
<p style="position:absolute;top:290px;left:403px;white-space:nowrap" class="ft55">For&#160;the</p>
<p style="position:absolute;top:308px;left:108px;white-space:nowrap" class="ft55">TPM,</p>
<p style="position:absolute;top:308px;left:152px;white-space:nowrap" class="ft518">f</p>
<p style="position:absolute;top:308px;left:157px;white-space:nowrap" class="ft55">()&#160;is&#160;the&#160;identity&#160;function&#160;and</p>
<p style="position:absolute;top:308px;left:357px;white-space:nowrap" class="ft518">p</p>
<p style="position:absolute;top:308px;left:365px;white-space:nowrap" class="ft55">()&#160;is&#160;specified</p>
<p style="position:absolute;top:326px;left:108px;white-space:nowrap" class="ft57">by&#160;a&#160;subset&#160;of&#160;the&#160;PCRs.&#160;The&#160;attestation&#160;token&#160;is&#160;a<br/>signed&#160;message&#160;containing&#160;the&#160;challenge&#160;and&#160;a&#160;subset<br/>of&#160;the&#160;PCRs.</p>
<p style="position:absolute;top:401px;left:108px;white-space:nowrap" class="ft58">3.4</p>
<p style="position:absolute;top:401px;left:154px;white-space:nowrap" class="ft58">Extensibility&#160;and&#160;Flexibility</p>
<p style="position:absolute;top:432px;left:108px;white-space:nowrap" class="ft57">The&#160;model&#160;that&#160;we&#160;have&#160;described&#160;so&#160;far&#160;is&#160;too&#160;sim-<br/>plistic&#160;for&#160;the&#160;real-world.&#160;In&#160;practice,&#160;a&#160;VMM&#160;consists<br/>of&#160;a&#160;large&#160;number&#160;of&#160;subsystems&#160;and&#160;components&#160;that<br/>depend&#160;on&#160;each&#160;other.&#160;Examples&#160;include&#160;hardware<br/>components&#160;such&#160;as&#160;CPU&#160;and&#160;devices,&#160;software&#160;com-<br/>ponents&#160;such&#160;as&#160;kernel,&#160;libraries,&#160;drivers,&#160;and&#160;user<br/>applications.&#160;In&#160;order&#160;to&#160;provide&#160;extensibility,&#160;new<br/>types&#160;of&#160;subsystems&#160;need&#160;to&#160;be&#160;added&#160;at&#160;run-time.<br/>Furthermore,&#160;it&#160;is&#160;desirable&#160;to&#160;have&#160;each&#160;subsystem<br/>be&#160;able&#160;to&#160;log&#160;and&#160;attest&#160;to&#160;arbitrary&#160;aspects&#160;of&#160;its<br/>behavior.&#160;A&#160;disk,&#160;for&#160;example,&#160;should&#160;be&#160;able&#160;to&#160;selec-<br/>tively&#160;log&#160;its&#160;contents,&#160;its&#160;access&#160;control&#160;list,&#160;or&#160;other<br/>aspects&#160;that&#160;need&#160;to&#160;be&#160;configurable&#160;by&#160;the&#160;policy.</p>
<p style="position:absolute;top:665px;left:123px;white-space:nowrap" class="ft55">It&#160;is&#160;clear&#160;that&#160;in&#160;reality,&#160;it&#160;is&#160;difficult&#160;to&#160;justify&#160;a</p>
<p style="position:absolute;top:683px;left:108px;white-space:nowrap" class="ft57">single&#160;notion&#160;of&#160;a&#160;state&#160;or&#160;a&#160;single&#160;logging&#160;function.<br/>A&#160;more&#160;flexible&#160;alternative&#160;is&#160;to&#160;represent&#160;the&#160;state<br/>by&#160;a&#160;tree&#160;of&#160;triples&#160;(see&#160;Figure</p>
<p style="position:absolute;top:718px;left:311px;white-space:nowrap" class="ft56">3</p>
<p style="position:absolute;top:718px;left:318px;white-space:nowrap" class="ft55">),&#160;one&#160;triple&#160;for&#160;each</p>
<p style="position:absolute;top:736px;left:108px;white-space:nowrap" class="ft57">component.&#160;Each&#160;triple&#160;contains&#160;an&#160;identifier,&#160;a&#160;com-<br/>ponent&#160;type</p>
<p style="position:absolute;top:754px;left:189px;white-space:nowrap" class="ft516"><i>type</i></p>
<p style="position:absolute;top:754px;left:217px;white-space:nowrap" class="ft55">,&#160;and&#160;a&#160;vector&#160;of&#160;log&#160;values</p>
<p style="position:absolute;top:754px;left:392px;white-space:nowrap" class="ft516"><i>log</i></p>
<p style="position:absolute;top:754px;left:411px;white-space:nowrap" class="ft55">.&#160;Sub-</p>
<p style="position:absolute;top:772px;left:108px;white-space:nowrap" class="ft57">components&#160;are&#160;modeled&#160;as&#160;children&#160;of&#160;a&#160;node.&#160;The<br/>overall&#160;effect&#160;is&#160;that&#160;the&#160;log&#160;data&#160;is&#160;contained&#160;in&#160;a<br/>hierarchy&#160;of&#160;vectors&#160;of&#160;log&#160;values.&#160;It&#160;can&#160;be&#160;extended<br/>by&#160;adding&#160;or&#160;removing&#160;children&#160;nodes.&#160;Adding&#160;a&#160;de-<br/>vice&#160;is,&#160;for&#160;example,&#160;reflected&#160;by&#160;adding&#160;a&#160;new&#160;type<br/>of&#160;child&#160;to&#160;the&#160;sub-tree&#160;of</p>
<p style="position:absolute;top:862px;left:280px;white-space:nowrap" class="ft516"><i>type</i></p>
<p style="position:absolute;top:862px;left:312px;white-space:nowrap" class="ft55">device.</p>
<p style="position:absolute;top:880px;left:123px;white-space:nowrap" class="ft55">Note&#160;that&#160;while&#160;log&#160;files&#160;are&#160;represented&#160;by&#160;trees,</p>
<p style="position:absolute;top:898px;left:108px;white-space:nowrap" class="ft57">we&#160;now&#160;have&#160;to&#160;define&#160;how&#160;to&#160;apply&#160;attestation&#160;and<br/>sealing&#160;to&#160;these</p>
<p style="position:absolute;top:916px;left:214px;white-space:nowrap" class="ft59"><i>log&#160;trees</i></p>
<p style="position:absolute;top:916px;left:267px;white-space:nowrap" class="ft55">.&#160;Sealing&#160;and&#160;attestation&#160;re-</p>
<p style="position:absolute;top:934px;left:108px;white-space:nowrap" class="ft57">quire&#160;a&#160;projection&#160;and&#160;a&#160;predicate.&#160;For&#160;a&#160;log&#160;trees,<br/>the&#160;projection&#160;function</p>
<p style="position:absolute;top:952px;left:265px;white-space:nowrap" class="ft518">p</p>
<p style="position:absolute;top:952px;left:273px;white-space:nowrap" class="ft55">()&#160;is&#160;simply&#160;a&#160;subset&#160;of&#160;the</p>
<p style="position:absolute;top:970px;left:108px;white-space:nowrap" class="ft57">nodes&#160;of&#160;the&#160;tree,&#160;and&#160;for&#160;each&#160;of&#160;those&#160;nodes&#160;in&#160;the<br/>subset,&#160;a&#160;subset&#160;of&#160;the&#160;log&#160;entries.&#160;The&#160;predicate&#160;Î <br/>is&#160;then&#160;defined&#160;on</p>
<p style="position:absolute;top:1005px;left:229px;white-space:nowrap" class="ft516"><i>p</i></p>
<p style="position:absolute;top:1005px;left:237px;white-space:nowrap" class="ft55">.</p>
<p style="position:absolute;top:108px;left:466px;white-space:nowrap" class="ft58">3.5</p>
<p style="position:absolute;top:108px;left:512px;white-space:nowrap" class="ft58">Privacy&#160;Protection</p>
<p style="position:absolute;top:138px;left:466px;white-space:nowrap" class="ft57">The&#160;integrity&#160;of&#160;certain&#160;sub-states&#160;can&#160;be&#160;essential<br/>to&#160;multiple&#160;users.&#160;Conversely,&#160;sub-states&#160;can&#160;be&#160;pri-<br/>vate&#160;to&#160;one&#160;or&#160;more&#160;users.&#160;For&#160;example,&#160;while&#160;the<br/>integrity&#160;of&#160;the&#160;VMM&#160;core&#160;would&#160;be&#160;of&#160;interest&#160;to&#160;all<br/>users,&#160;the&#160;state&#160;of&#160;a&#160;particular&#160;VM&#160;should&#160;be&#160;visible<br/>only&#160;to&#160;the&#160;user&#160;of&#160;that&#160;VM.&#160;In&#160;order&#160;to&#160;satisfy&#160;these<br/>privacy&#160;requirements,&#160;we&#160;have&#160;to&#160;introduce</p>
<p style="position:absolute;top:245px;left:759px;white-space:nowrap" class="ft59"><i>blinding</i></p>
<p style="position:absolute;top:263px;left:466px;white-space:nowrap" class="ft57">into&#160;our&#160;integrity&#160;architecture.&#160;In&#160;other&#160;words,&#160;it&#160;is<br/>important&#160;that&#160;attestation&#160;and&#160;sealing&#160;can&#160;be&#160;done&#160;on<br/>projections&#160;of&#160;the&#160;state,&#160;i.e.,&#160;subsets&#160;of&#160;the&#160;state.&#160;Fur-<br/>thermore,&#160;if&#160;a&#160;state&#160;is&#160;relevant&#160;for&#160;integrity&#160;while&#160;con-<br/>taining&#160;information&#160;about&#160;multiple&#160;users,&#160;it&#160;should&#160;be<br/>possible&#160;to&#160;prove&#160;integrity&#160;without&#160;revealing&#160;the&#160;ac-<br/>tual&#160;state.&#160;For&#160;that&#160;purpose,&#160;it&#160;is&#160;necessary&#160;to&#160;have<br/>(1)&#160;a&#160;privacy&#160;requirements&#160;model&#160;that&#160;defines&#160;visibil-<br/>ity&#160;constraints&#160;or&#160;the&#160;requirements&#160;on&#160;the&#160;projection<br/>functions,&#160;(2)&#160;privacy-preserving&#160;projections&#160;that&#160;sat-<br/>isfy&#160;those&#160;requirements,&#160;(3)&#160;a&#160;means&#160;of&#160;identifying<br/>whether&#160;a&#160;projection&#160;is&#160;potentially&#160;privacy-invasive,<br/>and&#160;(4)&#160;a&#160;way&#160;of&#160;ensuring&#160;that&#160;the&#160;predicate&#160;applied<br/>after&#160;a&#160;privacy-invasive&#160;projection&#160;can&#160;hide&#160;the&#160;pri-<br/>vate&#160;data</p>
<p style="position:absolute;top:513px;left:527px;white-space:nowrap" class="ft512">3</p>
<p style="position:absolute;top:514px;left:534px;white-space:nowrap" class="ft55">.</p>
<p style="position:absolute;top:532px;left:481px;white-space:nowrap" class="ft55">Given&#160;a&#160;set&#160;of&#160;users</p>
<p style="position:absolute;top:532px;left:613px;white-space:nowrap" class="ft516"><i>U</i></p>
<p style="position:absolute;top:532px;left:630px;white-space:nowrap" class="ft55">and&#160;a&#160;log&#160;tree,&#160;a&#160;privacy&#160;re-</p>
<p style="position:absolute;top:550px;left:466px;white-space:nowrap" class="ft55">quirements&#160;specification&#160;is&#160;a&#160;function</p>
<p style="position:absolute;top:550px;left:716px;white-space:nowrap" class="ft518">r</p>
<p style="position:absolute;top:550px;left:721px;white-space:nowrap" class="ft55">(</p>
<p style="position:absolute;top:550px;left:727px;white-space:nowrap" class="ft516"><i>t</i></p>
<p style="position:absolute;top:550px;left:732px;white-space:nowrap" class="ft55">)hat&#160;assigns</p>
<p style="position:absolute;top:568px;left:466px;white-space:nowrap" class="ft55">a&#160;subset&#160;of</p>
<p style="position:absolute;top:568px;left:547px;white-space:nowrap" class="ft516"><i>U</i></p>
<p style="position:absolute;top:568px;left:565px;white-space:nowrap" class="ft55">to&#160;each&#160;vector&#160;element&#160;in&#160;each&#160;node</p>
<p style="position:absolute;top:586px;left:466px;white-space:nowrap" class="ft57">of&#160;the&#160;tree.&#160;The&#160;subset&#160;assigned&#160;to&#160;a&#160;given&#160;vector<br/>element&#160;in&#160;a&#160;given&#160;node&#160;is&#160;called&#160;the&#160;access&#160;control<br/>list&#160;(ACL)&#160;for&#160;that&#160;element.&#160;Although&#160;the&#160;number<br/>of&#160;ACLs&#160;may&#160;be&#160;potentially&#160;very&#160;large,&#160;they&#160;can&#160;be<br/>efficiently&#160;implemented&#160;by&#160;attaching&#160;ACLs&#160;only&#160;to<br/>some&#160;nodes&#160;and&#160;vector&#160;elements&#160;and&#160;then&#160;using&#160;in-<br/>heritance&#160;along&#160;the&#160;nodes&#160;and&#160;scoping&#160;rules&#160;along&#160;the<br/>vector&#160;elements&#160;for&#160;a&#160;given&#160;node&#160;to&#160;derive&#160;the&#160;actual<br/>fine-grained&#160;access&#160;permissions.</p>
<p style="position:absolute;top:748px;left:481px;white-space:nowrap" class="ft55">A&#160;projection</p>
<p style="position:absolute;top:748px;left:572px;white-space:nowrap" class="ft518">p</p>
<p style="position:absolute;top:748px;left:579px;white-space:nowrap" class="ft55">()&#160;applied&#160;by&#160;a&#160;user</p>
<p style="position:absolute;top:748px;left:720px;white-space:nowrap" class="ft516"><i>u</i></p>
<p style="position:absolute;top:748px;left:735px;white-space:nowrap" class="ft528"><i>â</i></p>
<p style="position:absolute;top:748px;left:752px;white-space:nowrap" class="ft516"><i>U</i></p>
<p style="position:absolute;top:748px;left:770px;white-space:nowrap" class="ft55">is&#160;pri-</p>
<p style="position:absolute;top:765px;left:466px;white-space:nowrap" class="ft57">vacy&#160;protecting&#160;with&#160;respect&#160;to&#160;a&#160;privacy&#160;require-<br/>ments&#160;specification</p>
<p style="position:absolute;top:783px;left:599px;white-space:nowrap" class="ft518">r</p>
<p style="position:absolute;top:783px;left:605px;white-space:nowrap" class="ft55">()&#160;iff&#160;the&#160;output&#160;only&#160;contains</p>
<p style="position:absolute;top:801px;left:466px;white-space:nowrap" class="ft55">vector&#160;elements&#160;where</p>
<p style="position:absolute;top:801px;left:616px;white-space:nowrap" class="ft516"><i>u</i></p>
<p style="position:absolute;top:801px;left:630px;white-space:nowrap" class="ft55">was&#160;contained&#160;in&#160;the&#160;access</p>
<p style="position:absolute;top:819px;left:466px;white-space:nowrap" class="ft55">control&#160;list.</p>
<p style="position:absolute;top:837px;left:481px;white-space:nowrap" class="ft55">If&#160;the&#160;projection&#160;is&#160;privacy&#160;preserving&#160;with&#160;respect</p>
<p style="position:absolute;top:855px;left:466px;white-space:nowrap" class="ft55">to&#160;a&#160;privacy&#160;requirements&#160;specification</p>
<p style="position:absolute;top:855px;left:721px;white-space:nowrap" class="ft518">r</p>
<p style="position:absolute;top:855px;left:727px;white-space:nowrap" class="ft55">()&#160;and&#160;a&#160;user</p>
<p style="position:absolute;top:873px;left:466px;white-space:nowrap" class="ft516"><i>u</i></p>
<p style="position:absolute;top:873px;left:475px;white-space:nowrap" class="ft55">,&#160;then&#160;the&#160;sealing&#160;or&#160;attestation&#160;using&#160;this&#160;projec-</p>
<p style="position:absolute;top:891px;left:466px;white-space:nowrap" class="ft57">tion&#160;is&#160;automatically&#160;preserving&#160;privacy.&#160;This&#160;means<br/>that&#160;any&#160;evaluation&#160;function&#160;(for&#160;attestation)&#160;and&#160;any<br/>predicate&#160;(for&#160;sealing)&#160;can&#160;be&#160;applied&#160;without&#160;infring-<br/>ing&#160;on&#160;the&#160;privacy&#160;of&#160;the&#160;users&#160;of&#160;the&#160;system.</p>
<p style="position:absolute;top:963px;left:481px;white-space:nowrap" class="ft55">If&#160;the&#160;projection&#160;is&#160;not&#160;privacy&#160;preserving,&#160;we&#160;re-</p>
<p style="position:absolute;top:981px;left:466px;white-space:nowrap" class="ft57">quire&#160;that&#160;the&#160;function&#160;and&#160;predicate&#160;need&#160;to&#160;be&#160;mu-<br/>tually&#160;agreed&#160;upon.&#160;Examples&#160;for&#160;such&#160;agreed&#160;upon</p>
<p style="position:absolute;top:1026px;left:483px;white-space:nowrap" class="ft514">3</p>
<p style="position:absolute;top:1027px;left:489px;white-space:nowrap" class="ft515">Note&#160;that&#160;the&#160;result&#160;of&#160;any&#160;predicate&#160;applied&#160;af-</p>
<p style="position:absolute;top:1042px;left:466px;white-space:nowrap" class="ft531">ter&#160;a&#160;privacy-preserving&#160;projection&#160;will&#160;always&#160;be&#160;privacy-<br/>preserving.</p>
<p style="position:absolute;top:1112px;left:455px;white-space:nowrap" class="ft56">5</p>
</div>
<!-- Page 6 -->
<a name="6"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft634{font-size:9px;font-family:Helvetica;color:#000000;}
	.ft635{font-size:11px;font-family:Helvetica;color:#000000;}
	.ft636{font-size:9px;font-family:VWXURN+Helvetica-Narrow;color:#000000;}
	.ft637{font-size:14px;font-family:Helvetica;color:#000000;}
	.ft638{font-size:22px;line-height:26px;font-family:MUYCVK+CMBX12;color:#000000;}
-->
</style>
<div id="page6-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="OTC_XenSecurityServices006.png" alt="background image"/>
<p style="position:absolute;top:191px;left:200px;white-space:nowrap" class="ft634">Secure&#160;Device&#160;Virtualization&#160;Services</p>
<p style="position:absolute;top:109px;left:115px;white-space:nowrap" class="ft635"><b>VMM&#160;Security&#160;Services&#160;</b></p>
<p style="position:absolute;top:153px;left:237px;white-space:nowrap" class="ft636">User&#160;&#160;</p>
<p style="position:absolute;top:163px;left:219px;white-space:nowrap" class="ft636">Security&#160;Manager</p>
<p style="position:absolute;top:206px;left:359px;white-space:nowrap" class="ft636">Network&#160;Security&#160;</p>
<p style="position:absolute;top:216px;left:373px;white-space:nowrap" class="ft636">Manager</p>
<p style="position:absolute;top:153px;left:139px;white-space:nowrap" class="ft636">Compartment</p>
<p style="position:absolute;top:163px;left:131px;white-space:nowrap" class="ft636">Security&#160;Manager</p>
<p style="position:absolute;top:206px;left:282px;white-space:nowrap" class="ft636">Storage&#160;Security&#160;</p>
<p style="position:absolute;top:216px;left:295px;white-space:nowrap" class="ft636">Manager</p>
<p style="position:absolute;top:206px;left:217px;white-space:nowrap" class="ft636">Trusted&#160;</p>
<p style="position:absolute;top:216px;left:207px;white-space:nowrap" class="ft636">User&#160;Interface</p>
<p style="position:absolute;top:207px;left:138px;white-space:nowrap" class="ft636">Crypto&#160;&amp;&#160;TPM</p>
<p style="position:absolute;top:217px;left:147px;white-space:nowrap" class="ft636">Services</p>
<p style="position:absolute;top:135px;left:223px;white-space:nowrap" class="ft634">Security&#160;Management&#160;Services</p>
<p style="position:absolute;top:153px;left:307px;white-space:nowrap" class="ft636">Integrity&#160;&#160;</p>
<p style="position:absolute;top:163px;left:307px;white-space:nowrap" class="ft636">Manager</p>
<p style="position:absolute;top:253px;left:205px;white-space:nowrap" class="ft637"><b>Hardware&#160;&amp;&#160;VMM&#160;Core</b></p>
<p style="position:absolute;top:151px;left:361px;white-space:nowrap" class="ft636">Security&#160;Policy&#160;&#160;</p>
<p style="position:absolute;top:162px;left:376px;white-space:nowrap" class="ft636">Manager</p>
<p style="position:absolute;top:286px;left:180px;white-space:nowrap" class="ft66">Figure&#160;4:&#160;System&#160;Architecture</p>
<p style="position:absolute;top:334px;left:108px;white-space:nowrap" class="ft67">functions&#160;can&#160;be&#160;âsoftware&#160;certified&#160;by&#160;a&#160;given&#160;list&#160;of<br/>certifiers.â</p>
<p style="position:absolute;top:395px;left:108px;white-space:nowrap" class="ft64">4</p>
<p style="position:absolute;top:395px;left:144px;white-space:nowrap" class="ft64">Security</p>
<p style="position:absolute;top:395px;left:254px;white-space:nowrap" class="ft64">System</p>
<p style="position:absolute;top:395px;left:354px;white-space:nowrap" class="ft64">Architec-</p>
<p style="position:absolute;top:422px;left:144px;white-space:nowrap" class="ft64">ture</p>
<p style="position:absolute;top:461px;left:108px;white-space:nowrap" class="ft67">To&#160;provide&#160;the&#160;broader&#160;context&#160;of&#160;the&#160;work&#160;described<br/>in&#160;this&#160;paper,&#160;we&#160;list&#160;the&#160;essential&#160;security&#160;services<br/>for&#160;a&#160;VMM&#160;(Figure</p>
<p style="position:absolute;top:496px;left:249px;white-space:nowrap" class="ft66">4</p>
<p style="position:absolute;top:496px;left:257px;white-space:nowrap" class="ft65">)&#160;in&#160;this&#160;section</p>
<p style="position:absolute;top:495px;left:366px;white-space:nowrap" class="ft612">4</p>
<p style="position:absolute;top:496px;left:373px;white-space:nowrap" class="ft65">.&#160;The&#160;flex-</p>
<p style="position:absolute;top:514px;left:108px;white-space:nowrap" class="ft67">ible,&#160;extensible,&#160;and&#160;policy-based&#160;integrity&#160;manage-<br/>ment&#160;that&#160;is&#160;focus&#160;of&#160;this&#160;paper&#160;is&#160;just&#160;one&#160;of&#160;the&#160;sub-<br/>systems&#160;among&#160;the&#160;security&#160;services&#160;that&#160;are&#160;needed<br/>in&#160;a&#160;VMM.</p>
<p style="position:absolute;top:586px;left:123px;white-space:nowrap" class="ft65">The&#160;system&#160;is&#160;built&#160;upon&#160;the&#160;foundation&#160;of&#160;the</p>
<p style="position:absolute;top:604px;left:108px;white-space:nowrap" class="ft67">hardware&#160;root&#160;of&#160;trust&#160;offered&#160;by&#160;the&#160;Trusted&#160;Plat-<br/>form&#160;Module&#160;(TPM).&#160;The&#160;architecture&#160;leverages&#160;the<br/>recent&#160;advances&#160;in&#160;hardware&#160;virtualization&#160;such&#160;as<br/>virtualization&#160;support&#160;in&#160;the&#160;CPU&#160;offered&#160;in&#160;latest<br/>chips&#160;from&#160;Intel&#160;and&#160;AMD.&#160;The&#160;hardware&#160;layer&#160;in-<br/>cludes&#160;one&#160;of&#160;these&#160;chips&#160;and&#160;the&#160;TPM.&#160;Just&#160;above<br/>the&#160;hardware&#160;layer&#160;is&#160;a&#160;trusted&#160;virtualization&#160;layer<br/>(denoted&#160;by&#160;VMM&#160;core&#160;in&#160;Figure</p>
<p style="position:absolute;top:730px;left:331px;white-space:nowrap" class="ft66">4</p>
<p style="position:absolute;top:730px;left:338px;white-space:nowrap" class="ft65">)&#160;with&#160;strong&#160;iso-</p>
<p style="position:absolute;top:748px;left:108px;white-space:nowrap" class="ft67">lation&#160;properties&#160;(among&#160;virtual&#160;machines)&#160;and&#160;well-<br/>defined&#160;interfaces&#160;to&#160;the&#160;TPM.&#160;Above&#160;the&#160;VMM&#160;core<br/>are&#160;the&#160;security&#160;services.</p>
<p style="position:absolute;top:801px;left:123px;white-space:nowrap" class="ft65">The&#160;security&#160;services&#160;can&#160;be&#160;structured&#160;in&#160;two</p>
<p style="position:absolute;top:819px;left:108px;white-space:nowrap" class="ft67">types:&#160;secure&#160;device&#160;virtualization&#160;services&#160;and&#160;se-<br/>curity&#160;management&#160;services.&#160;Secure&#160;device&#160;virtual-<br/>ization&#160;provides&#160;security-enhanced&#160;virtualization&#160;of<br/>devices.&#160;Examples&#160;include&#160;secure&#160;storage,&#160;secure&#160;vir-<br/>tual&#160;network&#160;topologies&#160;[</p>
<p style="position:absolute;top:891px;left:271px;white-space:nowrap" class="ft66">5</p>
<p style="position:absolute;top:891px;left:279px;white-space:nowrap" class="ft65">],&#160;virtualized&#160;TPMs&#160;[</p>
<p style="position:absolute;top:891px;left:417px;white-space:nowrap" class="ft66">7</p>
<p style="position:absolute;top:891px;left:424px;white-space:nowrap" class="ft65">],&#160;or</p>
<p style="position:absolute;top:909px;left:108px;white-space:nowrap" class="ft65">trusted&#160;user&#160;interfaces&#160;[</p>
<p style="position:absolute;top:909px;left:270px;white-space:nowrap" class="ft66">14</p>
<p style="position:absolute;top:909px;left:285px;white-space:nowrap" class="ft65">].&#160;Security&#160;management</p>
<p style="position:absolute;top:927px;left:108px;white-space:nowrap" class="ft67">services&#160;maintain&#160;a&#160;unified&#160;view&#160;on&#160;overall&#160;security<br/>guarantees.&#160;This&#160;can&#160;be&#160;security&#160;guarantees&#160;that<br/>cover&#160;multiple&#160;devices&#160;(e.g.,&#160;data&#160;on&#160;a&#160;disk&#160;being<br/>stored&#160;in&#160;a&#160;TPM)&#160;or&#160;else&#160;security&#160;guarantees&#160;of&#160;the<br/>VMM&#160;core.&#160;The&#160;security&#160;management&#160;services&#160;are<br/>subdivided&#160;into&#160;compartment&#160;security&#160;services,&#160;user</p>
<p style="position:absolute;top:1044px;left:125px;white-space:nowrap" class="ft614">4</p>
<p style="position:absolute;top:1045px;left:131px;white-space:nowrap" class="ft615">This&#160;security&#160;architecture&#160;is&#160;one&#160;component&#160;of&#160;the&#160;secure</p>
<p style="position:absolute;top:1060px;left:108px;white-space:nowrap" class="ft615">VMM&#160;as&#160;developed&#160;by&#160;the&#160;OpenTC&#160;project&#160;[13].</p>
<p style="position:absolute;top:110px;left:466px;white-space:nowrap" class="ft67">security&#160;services,&#160;and&#160;integrity&#160;services.&#160;Compart-<br/>ment&#160;services&#160;track&#160;individual&#160;virtual&#160;machines&#160;and<br/>their&#160;(local)&#160;security&#160;properties.&#160;User&#160;services&#160;main-<br/>tain&#160;users&#160;and&#160;their&#160;preferences.&#160;The&#160;user&#160;services<br/>also&#160;comprise&#160;a&#160;trusted&#160;user&#160;interface.&#160;In&#160;this&#160;paper,<br/>we&#160;focus&#160;on&#160;the&#160;integrity&#160;services.&#160;The&#160;integrity&#160;ser-<br/>vices&#160;maintain&#160;overall&#160;integrity&#160;guarantees&#160;so&#160;that,<br/>for&#160;example,&#160;a&#160;verifier&#160;can&#160;validate&#160;several&#160;devices,<br/>its&#160;own&#160;user&#160;virtual&#160;machine,&#160;and&#160;the&#160;integrity&#160;of&#160;the<br/>VMM&#160;core.</p>
<p style="position:absolute;top:290px;left:481px;white-space:nowrap" class="ft65">In&#160;order&#160;to&#160;enforce&#160;certain&#160;security&#160;guarantees&#160;on</p>
<p style="position:absolute;top:308px;left:466px;white-space:nowrap" class="ft67">the&#160;VMM&#160;core,&#160;the&#160;security&#160;services&#160;configure&#160;the<br/>VMM&#160;core&#160;using&#160;policies.&#160;An&#160;example&#160;of&#160;such&#160;poli-<br/>cies&#160;are&#160;the&#160;sHype&#160;device&#160;access&#160;control&#160;policies&#160;that<br/>can&#160;be&#160;loaded&#160;at&#160;boot-time&#160;[</p>
<p style="position:absolute;top:361px;left:659px;white-space:nowrap" class="ft66">3</p>
<p style="position:absolute;top:361px;left:666px;white-space:nowrap" class="ft65">].&#160;Above&#160;the&#160;security</p>
<p style="position:absolute;top:379px;left:466px;white-space:nowrap" class="ft67">services&#160;layer&#160;are&#160;virtual&#160;machines,&#160;each&#160;running&#160;their<br/>own&#160;guest&#160;operating&#160;systems&#160;and&#160;applications.</p>
<p style="position:absolute;top:441px;left:466px;white-space:nowrap" class="ft64">5</p>
<p style="position:absolute;top:441px;left:503px;white-space:nowrap" class="ft638">Component-Level&#160;Design&#160;of<br/>the&#160;VMM&#160;Security&#160;Services<br/>Layer</p>
<p style="position:absolute;top:534px;left:466px;white-space:nowrap" class="ft68">5.1</p>
<p style="position:absolute;top:534px;left:512px;white-space:nowrap" class="ft68">Overview</p>
<p style="position:absolute;top:564px;left:466px;white-space:nowrap" class="ft65">The&#160;VMM&#160;security&#160;services&#160;layer&#160;(Figure</p>
<p style="position:absolute;top:564px;left:738px;white-space:nowrap" class="ft66">4</p>
<p style="position:absolute;top:564px;left:745px;white-space:nowrap" class="ft65">)&#160;provides</p>
<p style="position:absolute;top:582px;left:466px;white-space:nowrap" class="ft67">functions&#160;such&#160;as&#160;compartment&#160;security&#160;management,<br/>integrity&#160;services&#160;management,&#160;user&#160;security&#160;man-<br/>agement,&#160;and&#160;secure&#160;device&#160;virtualization&#160;that&#160;are<br/>needed&#160;to&#160;enforce&#160;the&#160;security&#160;policies.&#160;We&#160;first&#160;pro-<br/>vide&#160;an&#160;overview&#160;of&#160;these&#160;functions&#160;before&#160;describing<br/>the&#160;components&#160;that&#160;are&#160;part&#160;of&#160;the&#160;integrity&#160;man-<br/>agement&#160;subsystem&#160;in&#160;more&#160;detail.</p>
<p style="position:absolute;top:707px;left:481px;white-space:nowrap" class="ft65">The&#160;Compartment&#160;Security&#160;Manager&#160;deals&#160;with</p>
<p style="position:absolute;top:725px;left:466px;white-space:nowrap" class="ft67">the&#160;life-cycle&#160;management&#160;of&#160;compartments&#160;(i.e.,<br/>VMs)&#160;and&#160;tracks&#160;the&#160;security&#160;policies&#160;and&#160;other&#160;con-<br/>text&#160;(such&#160;as&#160;integrity&#160;constraints,&#160;permissions,&#160;and<br/>global&#160;identifiers)&#160;associated&#160;with&#160;each&#160;compartment.<br/>The&#160;Compartment&#160;Security&#160;Manager&#160;can&#160;be&#160;used&#160;to<br/>prove&#160;selected&#160;security&#160;properties&#160;to&#160;peers.&#160;The&#160;User<br/>Security&#160;Manager&#160;manages&#160;the&#160;users&#160;of&#160;the&#160;system<br/>and&#160;enables&#160;authentication&#160;of&#160;individual&#160;users&#160;and<br/>their&#160;associated&#160;roles.&#160;The&#160;Integrity&#160;Services&#160;Man-<br/>ager&#160;maintains&#160;the&#160;integrity&#160;of&#160;the&#160;system.&#160;An&#160;im-<br/>portant&#160;contribution&#160;to&#160;scalability&#160;for&#160;trusted&#160;com-<br/>puting&#160;is&#160;the&#160;focus&#160;on&#160;security&#160;properties&#160;for&#160;trust<br/>management&#160;[</p>
<p style="position:absolute;top:940px;left:557px;white-space:nowrap" class="ft66">10</p>
<p style="position:absolute;top:940px;left:572px;white-space:nowrap" class="ft65">,</p>
<p style="position:absolute;top:940px;left:577px;white-space:nowrap" class="ft66">11</p>
<p style="position:absolute;top:940px;left:592px;white-space:nowrap" class="ft65">,</p>
<p style="position:absolute;top:940px;left:597px;white-space:nowrap" class="ft66">12</p>
<p style="position:absolute;top:940px;left:612px;white-space:nowrap" class="ft65">].&#160;Instead&#160;of&#160;verifying&#160;integrity</p>
<p style="position:absolute;top:958px;left:466px;white-space:nowrap" class="ft67">by&#160;means&#160;of&#160;cryptographic&#160;checksums,&#160;we&#160;use&#160;higher-<br/>level&#160;properties&#160;such&#160;as&#160;user&#160;roles,&#160;machine&#160;types,&#160;or<br/>trust&#160;domains&#160;to&#160;determine&#160;trust.&#160;This&#160;is&#160;done&#160;by<br/>first&#160;using&#160;checksums&#160;to&#160;verify&#160;the&#160;core&#160;security&#160;ser-<br/>vices&#160;and&#160;then&#160;use&#160;these&#160;security&#160;services&#160;to&#160;evaluate<br/>the&#160;desired&#160;security&#160;properties&#160;[</p>
<p style="position:absolute;top:1048px;left:674px;white-space:nowrap" class="ft66">10</p>
<p style="position:absolute;top:1048px;left:689px;white-space:nowrap" class="ft65">,</p>
<p style="position:absolute;top:1048px;left:695px;white-space:nowrap" class="ft66">11</p>
<p style="position:absolute;top:1048px;left:710px;white-space:nowrap" class="ft65">].&#160;Only&#160;if&#160;these</p>
<p style="position:absolute;top:1066px;left:466px;white-space:nowrap" class="ft65">properties&#160;are&#160;satisfied,&#160;certain&#160;actions&#160;such&#160;as&#160;un-</p>
<p style="position:absolute;top:1112px;left:455px;white-space:nowrap" class="ft66">6</p>
</div>
<!-- Page 7 -->
<a name="7"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft739{font-size:7px;font-family:Helvetica;color:#000000;}
	.ft740{font-size:7px;line-height:8px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page7-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="OTC_XenSecurityServices007.png" alt="background image"/>
<p style="position:absolute;top:523px;left:568px;white-space:nowrap" class="ft739"><b>DiskImage</b></p>
<p style="position:absolute;top:516px;left:526px;white-space:nowrap" class="ft739"><b>Partion</b></p>
<p style="position:absolute;top:514px;left:629px;white-space:nowrap" class="ft739"><b>physDisk</b></p>
<p style="position:absolute;top:264px;left:593px;white-space:nowrap" class="ft739"><b>svHDPlugin</b></p>
<p style="position:absolute;top:274px;left:591px;white-space:nowrap" class="ft739"><b>ID</b></p>
<p style="position:absolute;top:291px;left:591px;white-space:nowrap" class="ft740"><b>chooseHD()<br/>configureHD()<br/>derigisterHD()</b></p>
<p style="position:absolute;top:341px;left:595px;white-space:nowrap" class="ft739"><b>vHardDisk</b></p>
<p style="position:absolute;top:351px;left:579px;white-space:nowrap" class="ft740"><b>ID<br/>Size<br/>encryption<br/>key</b></p>
<p style="position:absolute;top:393px;left:579px;white-space:nowrap" class="ft740"><b>getSize()<br/>getEncryptionMode()<br/>setKey()<br/>decrypt()<br/>attach()<br/>detach()<br/>deleteKey()<br/>read()<br/>write()</b></p>
<p style="position:absolute;top:320px;left:615px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:330px;left:615px;white-space:nowrap" class="ft739"><b>0..n</b></p>
<p style="position:absolute;top:320px;left:615px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:330px;left:615px;white-space:nowrap" class="ft739"><b>0..n</b></p>
<p style="position:absolute;top:492px;left:578px;white-space:nowrap" class="ft739"><b>Disk</b></p>
<p style="position:absolute;top:471px;left:586px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:480px;left:575px;white-space:nowrap" class="ft739"><b>0..n</b></p>
<p style="position:absolute;top:471px;left:586px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:480px;left:575px;white-space:nowrap" class="ft739"><b>0..n</b></p>
<p style="position:absolute;top:194px;left:367px;white-space:nowrap" class="ft739"><b>Measurement</b></p>
<p style="position:absolute;top:204px;left:364px;white-space:nowrap" class="ft740"><b>measuredObject<br/>result</b></p>
<p style="position:absolute;top:193px;left:252px;white-space:nowrap" class="ft739"><b>MeasurementDescriptor</b></p>
<p style="position:absolute;top:203px;left:257px;white-space:nowrap" class="ft740"><b>Owner<br/>type</b></p>
<p style="position:absolute;top:213px;left:343px;white-space:nowrap" class="ft739"><b>1..n</b></p>
<p style="position:absolute;top:213px;left:334px;white-space:nowrap" class="ft739"><b>1&#160;1..n</b></p>
<p style="position:absolute;top:213px;left:334px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:250px;left:352px;white-space:nowrap" class="ft739"><b>SealingDescriptor</b></p>
<p style="position:absolute;top:260px;left:357px;white-space:nowrap" class="ft740"><b>sealingType<br/>sealingValue<br/>sealingOP</b></p>
<p style="position:absolute;top:249px;left:256px;white-space:nowrap" class="ft739"><b>AttestationDescriptor</b></p>
<p style="position:absolute;top:259px;left:255px;white-space:nowrap" class="ft740"><b>verifierKey<br/>targetAIK<br/>challange&#160;:&#160;Challange<br/>attestType</b></p>
<p style="position:absolute;top:117px;left:316px;white-space:nowrap" class="ft739"><b>AttestationResult</b></p>
<p style="position:absolute;top:126px;left:282px;white-space:nowrap" class="ft740"><b>TPMAttestResult&#160;:&#160;TPMQuote<br/>HypAttestResult&#160;:&#160;AttestationDescriptor<br/>Signature&#160;:&#160;Signature</b></p>
<p style="position:absolute;top:210px;left:567px;white-space:nowrap" class="ft739"><b>SecureVirtualDevicePlugin</b></p>
<p style="position:absolute;top:220px;left:573px;white-space:nowrap" class="ft739"><b>ID</b></p>
<p style="position:absolute;top:237px;left:573px;white-space:nowrap" class="ft739"><b>getCapabilities()</b></p>
<p style="position:absolute;top:112px;left:565px;white-space:nowrap" class="ft739"><b>SecureVirtualDeviceManager</b></p>
<p style="position:absolute;top:122px;left:570px;white-space:nowrap" class="ft739"><b>ID</b></p>
<p style="position:absolute;top:139px;left:570px;white-space:nowrap" class="ft740"><b>registerPlugin()<br/>getID()<br/>configAndUnlockDisk()<br/>getCapabilities()<br/>deregisterDisk()</b></p>
<p style="position:absolute;top:186px;left:616px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:198px;left:616px;white-space:nowrap" class="ft739"><b>1..n</b></p>
<p style="position:absolute;top:186px;left:616px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:198px;left:616px;white-space:nowrap" class="ft739"><b>1..n</b></p>
<p style="position:absolute;top:113px;left:449px;white-space:nowrap" class="ft739"><b>CompartmentManager</b></p>
<p style="position:absolute;top:123px;left:433px;white-space:nowrap" class="ft739"><b>ID</b></p>
<p style="position:absolute;top:140px;left:433px;white-space:nowrap" class="ft740"><b>createVM()<br/>getID()<br/>hibernateVM()<br/>migrateVM()<br/>listVMs()<br/>stopVM()<br/>resumeVM()<br/>attest()<br/>initialize()<br/>deriveAllowedAttestationPieces()</b></p>
<p style="position:absolute;top:158px;left:558px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:161px;left:549px;white-space:nowrap" class="ft739"><b>1&#160;1</b></p>
<p style="position:absolute;top:161px;left:549px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:342px;left:361px;white-space:nowrap" class="ft739"><b>EnforcementResult</b></p>
<p style="position:absolute;top:352px;left:365px;white-space:nowrap" class="ft739"><b>Key&#160;:&#160;Key</b></p>
<p style="position:absolute;top:411px;left:465px;white-space:nowrap" class="ft739"><b>TPMAttestion</b></p>
<p style="position:absolute;top:429px;left:469px;white-space:nowrap" class="ft739"><b>attestTPM()</b></p>
<p style="position:absolute;top:404px;left:255px;white-space:nowrap" class="ft739"><b>TPMSealing</b></p>
<p style="position:absolute;top:423px;left:260px;white-space:nowrap" class="ft740"><b>seal()<br/>unseal()<br/>sealCurr()</b></p>
<p style="position:absolute;top:248px;left:443px;white-space:nowrap" class="ft739"><b>IntegrityServicesManager</b></p>
<p style="position:absolute;top:258px;left:448px;white-space:nowrap" class="ft739"><b>ID</b></p>
<p style="position:absolute;top:274px;left:448px;white-space:nowrap" class="ft740"><b>registerPlugin()<br/>getID()<br/>enforcePolicy()<br/>checkPolicy()<br/>requestAttestation()</b></p>
<p style="position:absolute;top:237px;left:490px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:227px;left:490px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:237px;left:490px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:227px;left:490px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:332px;left:426px;white-space:nowrap" class="ft739"><b>0..n</b></p>
<p style="position:absolute;top:320px;left:442px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:332px;left:426px;white-space:nowrap" class="ft739"><b>0..n</b></p>
<p style="position:absolute;top:320px;left:442px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:486px;left:336px;white-space:nowrap" class="ft739"><b>ConfigurationMeasurement</b></p>
<p style="position:absolute;top:505px;left:341px;white-space:nowrap" class="ft740"><b>measureConfig()<br/>measureStatus()</b></p>
<p style="position:absolute;top:470px;left:456px;white-space:nowrap" class="ft739"><b>UserMeasurement</b></p>
<p style="position:absolute;top:488px;left:460px;white-space:nowrap" class="ft739"><b>measureUser()</b></p>
<p style="position:absolute;top:343px;left:457px;white-space:nowrap" class="ft739"><b>AttestationService</b></p>
<p style="position:absolute;top:353px;left:461px;white-space:nowrap" class="ft739"><b>ID</b></p>
<p style="position:absolute;top:370px;left:461px;white-space:nowrap" class="ft739"><b>attest()</b></p>
<p style="position:absolute;top:398px;left:490px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:383px;left:490px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:398px;left:490px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:383px;left:490px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:320px;left:490px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:332px;left:490px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:320px;left:490px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:332px;left:490px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:325px;left:251px;white-space:nowrap" class="ft739"><b>SealingService</b></p>
<p style="position:absolute;top:335px;left:255px;white-space:nowrap" class="ft739"><b>ID</b></p>
<p style="position:absolute;top:352px;left:255px;white-space:nowrap" class="ft740"><b>seal()<br/>unseal()<br/>sealCurr()</b></p>
<p style="position:absolute;top:380px;left:279px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:394px;left:279px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:380px;left:279px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:394px;left:279px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:286px;left:434px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:324px;left:329px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:286px;left:434px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:324px;left:329px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:477px;left:254px;white-space:nowrap" class="ft739"><b>StorageMeasurement</b></p>
<p style="position:absolute;top:495px;left:259px;white-space:nowrap" class="ft740"><b>measureStorage()<br/>measureFile()<br/>opname()</b></p>
<p style="position:absolute;top:400px;left:346px;white-space:nowrap" class="ft739"><b>MeasurementService</b></p>
<p style="position:absolute;top:410px;left:350px;white-space:nowrap" class="ft739"><b>ID</b></p>
<p style="position:absolute;top:427px;left:350px;white-space:nowrap" class="ft739"><b>measure()</b></p>
<p style="position:absolute;top:474px;left:386px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:439px;left:385px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:474px;left:386px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:439px;left:385px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:457px;left:461px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:436px;left:426px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:457px;left:461px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:436px;left:426px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:390px;left:333px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:375px;left:307px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:390px;left:333px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:375px;left:307px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:465px;left:331px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:440px;left:359px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:465px;left:331px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:440px;left:359px;white-space:nowrap" class="ft739"><b>1</b></p>
<p style="position:absolute;top:560px;left:223px;white-space:nowrap" class="ft76">Figure&#160;5:&#160;Component-Level&#160;Design&#160;of&#160;the&#160;VMM&#160;Security&#160;Services&#160;Layer</p>
<p style="position:absolute;top:608px;left:108px;white-space:nowrap" class="ft77">sealing&#160;a&#160;key&#160;or&#160;performing&#160;a&#160;transaction&#160;with&#160;a&#160;peer<br/>are&#160;performed.&#160;The&#160;consequence&#160;is&#160;that&#160;a&#160;verifier&#160;only<br/>needs&#160;to&#160;define&#160;security&#160;properties&#160;to&#160;be&#160;satisfied&#160;and<br/>no&#160;longer&#160;needs&#160;to&#160;track&#160;individual&#160;software&#160;config-<br/>urations&#160;that&#160;are&#160;deemed&#160;trustworthy.&#160;The&#160;Security<br/>Policy&#160;Manager&#160;deals&#160;with&#160;the&#160;creation,&#160;access&#160;man-<br/>agement,&#160;and&#160;storage&#160;of&#160;local&#160;and&#160;global&#160;policies&#160;for<br/>the&#160;VMs,&#160;virtual&#160;devices,&#160;and&#160;other&#160;security&#160;services.</p>
<p style="position:absolute;top:751px;left:123px;white-space:nowrap" class="ft75">Virtualized&#160;devices&#160;can&#160;include&#160;any&#160;device&#160;that&#160;can</p>
<p style="position:absolute;top:769px;left:108px;white-space:nowrap" class="ft77">be&#160;made&#160;to&#160;support&#160;virtualization.&#160;Secure&#160;storage<br/>provide&#160;virtual&#160;partitions&#160;with&#160;integrity&#160;and&#160;confi-<br/>dentiality.&#160;Virtual&#160;networks&#160;can&#160;provide&#160;mutually<br/>isolated&#160;virtual&#160;network&#160;topologies&#160;and&#160;secure&#160;trans-<br/>port&#160;[</p>
<p style="position:absolute;top:841px;left:146px;white-space:nowrap" class="ft76">5</p>
<p style="position:absolute;top:841px;left:154px;white-space:nowrap" class="ft75">].&#160;The&#160;implementation&#160;of&#160;trusted&#160;user&#160;inter-</p>
<p style="position:absolute;top:859px;left:108px;white-space:nowrap" class="ft77">faces&#160;depends&#160;on&#160;the&#160;environment.&#160;A&#160;simple&#160;solu-<br/>tion&#160;that&#160;is&#160;sufficient&#160;for&#160;reliably&#160;selecting&#160;a&#160;compart-<br/>ment&#160;can&#160;be&#160;implemented&#160;by&#160;a&#160;secure&#160;hot-key&#160;that&#160;is<br/>caught&#160;by&#160;a&#160;virtualized&#160;keyboard&#160;driver&#160;[</p>
<p style="position:absolute;top:913px;left:368px;white-space:nowrap" class="ft76">13</p>
<p style="position:absolute;top:913px;left:383px;white-space:nowrap" class="ft75">].&#160;Another</p>
<p style="position:absolute;top:931px;left:108px;white-space:nowrap" class="ft77">alternative&#160;is&#160;a&#160;multi-compartment&#160;graphical&#160;user&#160;in-<br/>terface&#160;that&#160;assigns&#160;a&#160;distinguishable&#160;window&#160;to&#160;each<br/>compartment.&#160;An&#160;third&#160;option&#160;are&#160;remote&#160;user&#160;inter-<br/>faces&#160;such&#160;as&#160;a&#160;secure&#160;shell&#160;management&#160;console&#160;or<br/>remotely&#160;accessible&#160;management&#160;service.</p>
<p style="position:absolute;top:1020px;left:123px;white-space:nowrap" class="ft75">If&#160;fast&#160;policy&#160;enforcement&#160;is&#160;critical&#160;for&#160;perfor-</p>
<p style="position:absolute;top:1038px;left:108px;white-space:nowrap" class="ft77">mance,&#160;then&#160;the&#160;enforcement&#160;of&#160;certain&#160;policies&#160;may<br/>be&#160;done&#160;at&#160;the&#160;virtualization&#160;layers&#160;instead&#160;of&#160;at&#160;the</p>
<p style="position:absolute;top:608px;left:466px;white-space:nowrap" class="ft75">security&#160;services&#160;layer&#160;[</p>
<p style="position:absolute;top:608px;left:615px;white-space:nowrap" class="ft76">3</p>
<p style="position:absolute;top:608px;left:622px;white-space:nowrap" class="ft75">].&#160;For&#160;example,&#160;a&#160;policy&#160;deci-</p>
<p style="position:absolute;top:626px;left:466px;white-space:nowrap" class="ft77">sion&#160;whether&#160;a&#160;certain&#160;network&#160;card&#160;can&#160;be&#160;assigned<br/>to&#160;a&#160;newly&#160;created&#160;virtual&#160;machine&#160;can&#160;easily&#160;be&#160;done<br/>outside&#160;the&#160;Xen&#160;hypervisor&#160;since&#160;it&#160;is&#160;usually&#160;not&#160;per-<br/>formance&#160;critical.&#160;On&#160;the&#160;other&#160;hand,&#160;access&#160;decisions<br/>for&#160;shared&#160;resources&#160;are&#160;performance-critical&#160;and&#160;may<br/>be&#160;executed&#160;in&#160;the&#160;VMM&#160;core.</p>
<p style="position:absolute;top:733px;left:481px;white-space:nowrap" class="ft75">Figure</p>
<p style="position:absolute;top:733px;left:529px;white-space:nowrap" class="ft76">5</p>
<p style="position:absolute;top:733px;left:541px;white-space:nowrap" class="ft75">shows&#160;the&#160;component-level&#160;design&#160;for&#160;the</p>
<p style="position:absolute;top:751px;left:466px;white-space:nowrap" class="ft77">integrity&#160;management&#160;subsystem&#160;of&#160;the&#160;security&#160;ser-<br/>vices&#160;layer.&#160;The&#160;subsystem&#160;implements&#160;the&#160;concepts<br/>introduced&#160;in&#160;Section</p>
<p style="position:absolute;top:787px;left:616px;white-space:nowrap" class="ft76">3</p>
<p style="position:absolute;top:787px;left:623px;white-space:nowrap" class="ft75">.&#160;Compared&#160;to&#160;Figure</p>
<p style="position:absolute;top:787px;left:781px;white-space:nowrap" class="ft76">4</p>
<p style="position:absolute;top:787px;left:789px;white-space:nowrap" class="ft75">,&#160;it</p>
<p style="position:absolute;top:805px;left:466px;white-space:nowrap" class="ft77">shows&#160;the&#160;design&#160;at&#160;the&#160;next&#160;level&#160;of&#160;detail,&#160;depicting<br/>the&#160;individual&#160;components&#160;that&#160;make&#160;up&#160;the&#160;subsys-<br/>tem&#160;and&#160;the&#160;interfaces&#160;the&#160;components&#160;expose.&#160;We<br/>now&#160;describe&#160;these&#160;components.&#160;For&#160;secure&#160;virtual<br/>device&#160;management,&#160;we&#160;focus&#160;on&#160;one&#160;type&#160;of&#160;device,<br/>namely&#160;secure&#160;virtual&#160;harddisks.</p>
<p style="position:absolute;top:934px;left:466px;white-space:nowrap" class="ft78">5.2</p>
<p style="position:absolute;top:934px;left:512px;white-space:nowrap" class="ft78">Compartment&#160;Manager</p>
<p style="position:absolute;top:964px;left:466px;white-space:nowrap" class="ft75">At&#160;the&#160;top&#160;level,&#160;there&#160;is&#160;the</p>
<p style="position:absolute;top:964px;left:684px;white-space:nowrap" class="ft79"><i>compartment&#160;man-</i></p>
<p style="position:absolute;top:982px;left:466px;white-space:nowrap" class="ft79"><i>ager</i></p>
<p style="position:absolute;top:982px;left:501px;white-space:nowrap" class="ft75">(CM)&#160;which&#160;is&#160;the&#160;central&#160;instrumentation&#160;and</p>
<p style="position:absolute;top:1000px;left:466px;white-space:nowrap" class="ft77">orchestration&#160;point.&#160;It&#160;is&#160;the&#160;CM&#160;with&#160;which&#160;the<br/>user&#160;and&#160;the&#160;verifier&#160;directly&#160;interact&#160;with.</p>
<p style="position:absolute;top:1018px;left:784px;white-space:nowrap" class="ft75">The</p>
<p style="position:absolute;top:1036px;left:466px;white-space:nowrap" class="ft77">CM,&#160;as&#160;the&#160;name&#160;indicates,&#160;deals&#160;with&#160;anything<br/>related&#160;to&#160;compartments&#160;of&#160;VMs,&#160;including&#160;opera-</p>
<p style="position:absolute;top:1112px;left:455px;white-space:nowrap" class="ft76">7</p>
</div>
<!-- Page 8 -->
<a name="8"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page8-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="OTC_XenSecurityServices008.png" alt="background image"/>
<p style="position:absolute;top:110px;left:108px;white-space:nowrap" class="ft87">tions&#160;such&#160;as&#160;creating,&#160;hibernating,&#160;migrating,&#160;stop-<br/>ping,&#160;and&#160;attesting&#160;VMs.&#160;It&#160;also&#160;has&#160;an&#160;interface</p>
<p style="position:absolute;top:146px;left:108px;white-space:nowrap" class="ft818">getCurrentState</p>
<p style="position:absolute;top:146px;left:208px;white-space:nowrap" class="ft85">()&#160;for&#160;obtaining&#160;the&#160;current&#160;state&#160;of</p>
<p style="position:absolute;top:164px;left:108px;white-space:nowrap" class="ft87">the&#160;whole&#160;environment&#160;(including&#160;the&#160;list&#160;of&#160;active<br/>VMs,&#160;list&#160;of&#160;users&#160;to&#160;whom&#160;the&#160;VMs&#160;belong,&#160;how<br/>much&#160;free&#160;memory&#160;is&#160;available,&#160;etc.).&#160;An&#160;example<br/>usage&#160;of&#160;that&#160;interface&#160;would&#160;be&#160;a&#160;state&#160;measure-<br/>ment&#160;service&#160;invoking&#160;the&#160;interface&#160;for&#160;attestation<br/>purposes,&#160;i.e.,&#160;for&#160;attesting&#160;the&#160;state&#160;of&#160;the&#160;physical<br/>machine.&#160;Note&#160;that&#160;the</p>
<p style="position:absolute;top:272px;left:280px;white-space:nowrap" class="ft818">getCurrentState</p>
<p style="position:absolute;top:272px;left:379px;white-space:nowrap" class="ft85">()&#160;function</p>
<p style="position:absolute;top:290px;left:108px;white-space:nowrap" class="ft87">would&#160;not&#160;tell&#160;the&#160;state&#160;measurement&#160;service&#160;whether<br/>the&#160;VMs&#160;are&#160;in&#160;good&#160;state&#160;or&#160;not,&#160;but&#160;would&#160;give&#160;in-<br/>formation&#160;about&#160;how&#160;many&#160;and&#160;what&#160;types&#160;of&#160;VMs<br/>are&#160;currently&#160;present&#160;on&#160;the&#160;physical&#160;machine,&#160;which<br/>VMs&#160;are&#160;running,&#160;which&#160;ones&#160;are&#160;hibernating,&#160;etc.<br/>Using&#160;such&#160;information,&#160;the&#160;state&#160;measurement&#160;ser-<br/>vice&#160;itself&#160;would&#160;have&#160;to&#160;deduce&#160;whether&#160;the&#160;physical<br/>machine&#160;is&#160;in&#160;an&#160;âacceptableâ&#160;state&#160;or&#160;not.&#160;The&#160;CM<br/>also&#160;has&#160;a</p>
<p style="position:absolute;top:433px;left:179px;white-space:nowrap" class="ft818">getID</p>
<p style="position:absolute;top:433px;left:213px;white-space:nowrap" class="ft85">()&#160;interface&#160;which&#160;can&#160;be&#160;invoked&#160;to</p>
<p style="position:absolute;top:451px;left:108px;white-space:nowrap" class="ft87">obtain&#160;the&#160;unique&#160;identifier&#160;of&#160;the&#160;CM.&#160;Such&#160;a&#160;func-<br/>tion&#160;would&#160;be&#160;useful,&#160;for&#160;example,&#160;in&#160;a&#160;data&#160;center&#160;en-<br/>vironment&#160;in&#160;which&#160;multiple&#160;physical&#160;machines&#160;and,<br/>hence,&#160;multiple&#160;CMs&#160;would&#160;have&#160;to&#160;be&#160;coordinated.<br/>The</p>
<p style="position:absolute;top:523px;left:140px;white-space:nowrap" class="ft818">readConfig</p>
<p style="position:absolute;top:523px;left:207px;white-space:nowrap" class="ft85">()&#160;interface&#160;of&#160;the&#160;CM&#160;is&#160;used&#160;inter-</p>
<p style="position:absolute;top:541px;left:108px;white-space:nowrap" class="ft87">nally&#160;when&#160;the&#160;CM&#160;is&#160;requested&#160;to&#160;create&#160;a&#160;new&#160;VM.<br/>The</p>
<p style="position:absolute;top:559px;left:139px;white-space:nowrap" class="ft818">attest</p>
<p style="position:absolute;top:559px;left:175px;white-space:nowrap" class="ft85">()&#160;interface&#160;of&#160;the&#160;CM&#160;offers&#160;a&#160;generic&#160;at-</p>
<p style="position:absolute;top:576px;left:108px;white-space:nowrap" class="ft87">testation&#160;call&#160;with&#160;an&#160;attestation&#160;descriptor&#160;(describ-<br/>ing&#160;what&#160;should&#160;be&#160;attested)&#160;as&#160;the&#160;parameter.&#160;The<br/>function&#160;is&#160;just&#160;a&#160;proxy&#160;function&#160;since&#160;it&#160;just&#160;calls&#160;the</p>
<p style="position:absolute;top:630px;left:108px;white-space:nowrap" class="ft818">requestAttestation</p>
<p style="position:absolute;top:630px;left:222px;white-space:nowrap" class="ft85">()&#160;function&#160;of&#160;the&#160;Integrity&#160;Services</p>
<p style="position:absolute;top:648px;left:108px;white-space:nowrap" class="ft85">Manager&#160;(ISM),&#160;which&#160;is&#160;described&#160;below.</p>
<p style="position:absolute;top:666px;left:123px;white-space:nowrap" class="ft85">The</p>
<p style="position:absolute;top:666px;left:157px;white-space:nowrap" class="ft818">createVM</p>
<p style="position:absolute;top:666px;left:218px;white-space:nowrap" class="ft85">()&#160;function&#160;of&#160;the&#160;CM&#160;is&#160;invoked</p>
<p style="position:absolute;top:684px;left:108px;white-space:nowrap" class="ft87">when&#160;a&#160;user&#160;wants&#160;a&#160;new&#160;VM&#160;to&#160;be&#160;created.&#160;The<br/>VM&#160;configuration&#160;data,&#160;in&#160;the&#160;form&#160;of&#160;a&#160;config&#160;ob-<br/>ject&#160;or&#160;file,&#160;is&#160;passed&#160;as&#160;parameter&#160;to&#160;the&#160;function.<br/>The&#160;combination&#160;of&#160;the&#160;User&#160;Security&#160;Manager&#160;and<br/>the&#160;policies&#160;stored&#160;in&#160;the&#160;Security&#160;Policy&#160;Manager<br/>(shown&#160;in&#160;Figure</p>
<p style="position:absolute;top:774px;left:224px;white-space:nowrap" class="ft86">4</p>
<p style="position:absolute;top:774px;left:232px;white-space:nowrap" class="ft85">,&#160;but&#160;not&#160;in&#160;Figure</p>
<p style="position:absolute;top:774px;left:360px;white-space:nowrap" class="ft86">5</p>
<p style="position:absolute;top:774px;left:368px;white-space:nowrap" class="ft85">)&#160;are&#160;used&#160;to</p>
<p style="position:absolute;top:792px;left:108px;white-space:nowrap" class="ft87">check&#160;what&#160;VM-related&#160;functions&#160;the&#160;user&#160;is&#160;autho-<br/>rized&#160;to&#160;request.&#160;For&#160;this&#160;purpose,&#160;the</p>
<p style="position:absolute;top:810px;left:377px;white-space:nowrap" class="ft818">checkUser</p>
<p style="position:absolute;top:810px;left:440px;white-space:nowrap" class="ft85">()</p>
<p style="position:absolute;top:828px;left:108px;white-space:nowrap" class="ft87">function&#160;of&#160;the&#160;user&#160;manager&#160;is&#160;invoked&#160;by&#160;the&#160;config-<br/>uration&#160;manager.&#160;The&#160;function&#160;takes&#160;a&#160;user&#160;name&#160;and<br/>some&#160;specified&#160;input&#160;policy&#160;as&#160;parameters,&#160;and&#160;checks<br/>whether&#160;the&#160;userâs&#160;requested&#160;operation&#160;is&#160;compatible<br/>with&#160;that&#160;policy.&#160;An&#160;example&#160;input&#160;policy&#160;may&#160;say<br/>that&#160;any&#160;user&#160;can&#160;create&#160;a&#160;VM,&#160;but&#160;only&#160;users&#160;A&#160;and<br/>C&#160;can&#160;create&#160;a&#160;particular&#160;kind&#160;of&#160;VM&#160;(say,&#160;a&#160;VM&#160;of<br/>an&#160;automobile&#160;company).&#160;To&#160;retrieve&#160;a&#160;certain&#160;pol-<br/>icy&#160;from&#160;the&#160;Security&#160;Policy&#160;Manager,&#160;the&#160;CM&#160;calls</p>
<p style="position:absolute;top:989px;left:108px;white-space:nowrap" class="ft818">getPolicy</p>
<p style="position:absolute;top:989px;left:170px;white-space:nowrap" class="ft85">with&#160;a&#160;policy&#160;identifier&#160;as&#160;an&#160;argument,</p>
<p style="position:absolute;top:108px;left:466px;white-space:nowrap" class="ft88">5.3</p>
<p style="position:absolute;top:108px;left:512px;white-space:nowrap" class="ft88">Integrity&#160;Services&#160;Manager</p>
<p style="position:absolute;top:138px;left:466px;white-space:nowrap" class="ft87">The&#160;Integrity&#160;Services&#160;Manager&#160;(ISM)&#160;is&#160;responsi-<br/>ble&#160;for&#160;sealing,&#160;measurement,&#160;and&#160;attestation.&#160;These<br/>services&#160;are&#160;implemented&#160;using&#160;multiple&#160;specialized<br/>low-level&#160;plug-ins.&#160;These&#160;plugins&#160;implement&#160;the&#160;ex-<br/>tensibility&#160;concept&#160;outlined&#160;in&#160;Section</p>
<p style="position:absolute;top:210px;left:725px;white-space:nowrap" class="ft86">3.4</p>
<p style="position:absolute;top:210px;left:744px;white-space:nowrap" class="ft85">.&#160;Distinct</p>
<p style="position:absolute;top:227px;left:466px;white-space:nowrap" class="ft87">plug-ins&#160;are&#160;used&#160;for&#160;various&#160;devices&#160;for&#160;separation&#160;of<br/>concerns&#160;and&#160;for&#160;easy&#160;extensibility.&#160;At&#160;system&#160;startup<br/>time,&#160;any&#160;available&#160;plug-in&#160;will&#160;register&#160;its&#160;capabili-<br/>ties&#160;with&#160;the&#160;ISM&#160;using&#160;the</p>
<p style="position:absolute;top:281px;left:651px;white-space:nowrap" class="ft818">registerPlugin</p>
<p style="position:absolute;top:281px;left:736px;white-space:nowrap" class="ft85">()&#160;function.</p>
<p style="position:absolute;top:299px;left:481px;white-space:nowrap" class="ft85">There&#160;are&#160;two&#160;kinds&#160;of&#160;attestation:&#160;TPM-based</p>
<p style="position:absolute;top:317px;left:466px;white-space:nowrap" class="ft85">attestation&#160;(implemented&#160;by&#160;the</p>
<p style="position:absolute;top:317px;left:682px;white-space:nowrap" class="ft818">HardwareAttestation</p>
<p style="position:absolute;top:335px;left:466px;white-space:nowrap" class="ft85">component&#160;shown&#160;in&#160;Figure</p>
<p style="position:absolute;top:335px;left:677px;white-space:nowrap" class="ft86">5</p>
<p style="position:absolute;top:335px;left:685px;white-space:nowrap" class="ft85">)&#160;and&#160;hypervisor-</p>
<p style="position:absolute;top:353px;left:466px;white-space:nowrap" class="ft85">based</p>
<p style="position:absolute;top:353px;left:531px;white-space:nowrap" class="ft85">attestation</p>
<p style="position:absolute;top:353px;left:629px;white-space:nowrap" class="ft85">(implemented</p>
<p style="position:absolute;top:353px;left:746px;white-space:nowrap" class="ft85">by</p>
<p style="position:absolute;top:353px;left:789px;white-space:nowrap" class="ft85">the</p>
<p style="position:absolute;top:371px;left:466px;white-space:nowrap" class="ft818">HypervisorAttestation</p>
<p style="position:absolute;top:371px;left:622px;white-space:nowrap" class="ft85">component;</p>
<p style="position:absolute;top:371px;left:726px;white-space:nowrap" class="ft85">omitted</p>
<p style="position:absolute;top:371px;left:798px;white-space:nowrap" class="ft85">in</p>
<p style="position:absolute;top:389px;left:466px;white-space:nowrap" class="ft85">Figure</p>
<p style="position:absolute;top:389px;left:517px;white-space:nowrap" class="ft86">5</p>
<p style="position:absolute;top:389px;left:525px;white-space:nowrap" class="ft85">).</p>
<p style="position:absolute;top:389px;left:553px;white-space:nowrap" class="ft85">In&#160;both&#160;cases,&#160;the&#160;signatures&#160;on&#160;the</p>
<p style="position:absolute;top:407px;left:466px;white-space:nowrap" class="ft818">attestationResult</p>
<p style="position:absolute;top:407px;left:585px;white-space:nowrap" class="ft85">is&#160;made&#160;by&#160;the&#160;TPM.&#160;TPM-</p>
<p style="position:absolute;top:425px;left:466px;white-space:nowrap" class="ft87">attestation&#160;(sometimes&#160;called&#160;binary&#160;attestation)<br/>is&#160;the&#160;traditional&#160;form&#160;of&#160;attestation&#160;specified&#160;by<br/>the&#160;Trusted&#160;Computing&#160;Group&#160;(TCG).&#160;It&#160;involves<br/>obtaining&#160;an&#160;incremental,&#160;cryptographic&#160;hash&#160;chain<br/>based&#160;on&#160;the&#160;hashes&#160;of&#160;the&#160;binaries&#160;of&#160;the&#160;boot&#160;load-<br/>ers,&#160;OS,&#160;and&#160;applications&#160;running&#160;on&#160;the&#160;physical<br/>machine.&#160;The&#160;hash&#160;chain&#160;is&#160;stored&#160;in&#160;one&#160;of&#160;the<br/>Platform&#160;Configuration&#160;Registers&#160;(PCRs)&#160;of&#160;the<br/>TPM&#160;chip.&#160;The&#160;verifier&#160;component&#160;at&#160;an&#160;external<br/>stake-holder&#160;can&#160;then&#160;remotely&#160;verify&#160;the&#160;execution<br/>state&#160;of&#160;the&#160;platform&#160;either&#160;using&#160;a&#160;reference&#160;value&#160;or<br/>based&#160;on&#160;a&#160;policy&#160;(as&#160;described&#160;above).&#160;Hypervisor-<br/>based&#160;attestation&#160;assumes&#160;that&#160;the&#160;hypervisor&#160;is&#160;part<br/>of&#160;the&#160;TCB.&#160;The&#160;trustworthiness&#160;of&#160;the&#160;hypervisor<br/>can&#160;be&#160;checked&#160;by&#160;a&#160;remote&#160;party&#160;by&#160;obtaining&#160;a<br/>signed&#160;TPM&#160;attestation&#160;for&#160;the&#160;hypervisor&#160;as&#160;well.<br/>For&#160;hypervisor-based&#160;attestation,&#160;the&#160;attestation<br/>description&#160;is&#160;given&#160;to&#160;the&#160;hypervisor&#160;in&#160;text&#160;form<br/>through&#160;the</p>
<p style="position:absolute;top:748px;left:552px;white-space:nowrap" class="ft818">AttestationDescriptor</p>
<p style="position:absolute;top:748px;left:692px;white-space:nowrap" class="ft85">data&#160;object.&#160;The</p>
<p style="position:absolute;top:765px;left:466px;white-space:nowrap" class="ft87">description&#160;specifies&#160;(in&#160;a&#160;considerably&#160;more&#160;flexible<br/>manner&#160;compared&#160;to&#160;TPM-based&#160;attestation)&#160;what<br/>needs&#160;to&#160;be&#160;attested.&#160;The&#160;hypervisor&#160;then&#160;obtains<br/>those&#160;attestations.&#160;With&#160;respect&#160;to&#160;our&#160;model&#160;in<br/>Section</p>
<p style="position:absolute;top:837px;left:524px;white-space:nowrap" class="ft86">3</p>
<p style="position:absolute;top:837px;left:531px;white-space:nowrap" class="ft85">,&#160;the</p>
<p style="position:absolute;top:837px;left:578px;white-space:nowrap" class="ft818">AttestationDescriptor</p>
<p style="position:absolute;top:837px;left:721px;white-space:nowrap" class="ft85">identifies&#160;the</p>
<p style="position:absolute;top:855px;left:466px;white-space:nowrap" class="ft87">projection&#160;of&#160;the&#160;overall&#160;system&#160;data&#160;that&#160;shall<br/>be&#160;attested.</p>
<p style="position:absolute;top:873px;left:565px;white-space:nowrap" class="ft85">If&#160;the</p>
<p style="position:absolute;top:873px;left:614px;white-space:nowrap" class="ft818">HypervisorAttestation</p>
<p style="position:absolute;top:873px;left:758px;white-space:nowrap" class="ft85">is&#160;used,</p>
<p style="position:absolute;top:891px;left:466px;white-space:nowrap" class="ft87">then&#160;property-based&#160;attestation&#160;can&#160;be&#160;realized&#160;by<br/>implementing&#160;(in&#160;the</p>
<p style="position:absolute;top:909px;left:611px;white-space:nowrap" class="ft818">HypervisorAttestation</p>
<p style="position:absolute;top:909px;left:753px;white-space:nowrap" class="ft85">class)&#160;an</p>
<p style="position:absolute;top:927px;left:466px;white-space:nowrap" class="ft87">attestation&#160;evaluation&#160;function&#160;that&#160;translates&#160;the<br/>system&#160;state&#160;into&#160;a&#160;statement&#160;of&#160;properties&#160;about<br/>the&#160;system.</p>
<p style="position:absolute;top:981px;left:481px;white-space:nowrap" class="ft85">The&#160;sealing&#160;services&#160;of&#160;the&#160;ISM&#160;is&#160;provided&#160;through</p>
<p style="position:absolute;top:999px;left:466px;white-space:nowrap" class="ft85">the</p>
<p style="position:absolute;top:999px;left:492px;white-space:nowrap" class="ft818">SealingServicesPlugin</p>
<p style="position:absolute;top:999px;left:626px;white-space:nowrap" class="ft85">.&#160;Just&#160;like&#160;attestation,&#160;there</p>
<p style="position:absolute;top:1017px;left:466px;white-space:nowrap" class="ft87">are&#160;two&#160;types&#160;of&#160;sealing:&#160;hardware-based&#160;sealing&#160;(or<br/>TPM-based&#160;sealing)&#160;and&#160;hypervisor-based&#160;sealing.<br/>Note&#160;that&#160;to&#160;keep&#160;the&#160;figure&#160;readable,&#160;only&#160;the&#160;for-</p>
<p style="position:absolute;top:1112px;left:455px;white-space:nowrap" class="ft86">8</p>
</div>
<!-- Page 9 -->
<a name="9"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft941{font-size:9px;font-family:Times;color:#000000;}
	.ft942{font-size:11px;font-family:Times;color:#000000;}
	.ft943{font-size:7px;font-family:Times;color:#000000;}
	.ft944{font-size:8px;font-family:Times;color:#000000;}
	.ft945{font-size:15px;font-family:NOTHKP+CMTT10;color:#000000;}
	.ft946{font-size:9px;line-height:11px;font-family:Times;color:#000000;}
	.ft947{font-size:8px;line-height:9px;font-family:Times;color:#000000;}
-->
</style>
<div id="page9-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="OTC_XenSecurityServices009.png" alt="background image"/>
<p style="position:absolute;top:376px;left:453px;white-space:nowrap" class="ft941">Xen&#160;Hypervisor</p>
<p style="position:absolute;top:303px;left:584px;white-space:nowrap" class="ft946">Kernel&#160;<br/>space</p>
<p style="position:absolute;top:116px;left:243px;white-space:nowrap" class="ft941">&#160;</p>
<p style="position:absolute;top:115px;left:245px;white-space:nowrap" class="ft942">Dom0</p>
<p style="position:absolute;top:112px;left:681px;white-space:nowrap" class="ft942">&#160;DomU</p>
<p style="position:absolute;top:265px;left:315px;white-space:nowrap" class="ft941">TSS</p>
<p style="position:absolute;top:299px;left:249px;white-space:nowrap" class="ft943">/proc/xen/privcmd</p>
<p style="position:absolute;top:300px;left:635px;white-space:nowrap" class="ft943">/dev/sda</p>
<p style="position:absolute;top:265px;left:265px;white-space:nowrap" class="ft941">BMI</p>
<p style="position:absolute;top:119px;left:359px;white-space:nowrap" class="ft941">Compartment</p>
<p style="position:absolute;top:131px;left:367px;white-space:nowrap" class="ft941">Manager</p>
<p style="position:absolute;top:143px;left:478px;white-space:nowrap" class="ft941">Secure&#160;virtual&#160;</p>
<p style="position:absolute;top:154px;left:474px;white-space:nowrap" class="ft941">Device&#160;Manager</p>
<p style="position:absolute;top:246px;left:584px;white-space:nowrap" class="ft946">Library&#160;<br/>space</p>
<p style="position:absolute;top:112px;left:584px;white-space:nowrap" class="ft946">Application<br/>space</p>
<p style="position:absolute;top:350px;left:637px;white-space:nowrap" class="ft944">VBDF</p>
<p style="position:absolute;top:350px;left:665px;white-space:nowrap" class="ft944">VNDF</p>
<p style="position:absolute;top:350px;left:694px;white-space:nowrap" class="ft944">vTPMF</p>
<p style="position:absolute;top:421px;left:398px;white-space:nowrap" class="ft941">HDD</p>
<p style="position:absolute;top:421px;left:311px;white-space:nowrap" class="ft941">TPM</p>
<p style="position:absolute;top:349px;left:305px;white-space:nowrap" class="ft944">TPM&#160;Driver</p>
<p style="position:absolute;top:299px;left:308px;white-space:nowrap" class="ft943">/dev/tpm</p>
<p style="position:absolute;top:418px;left:506px;white-space:nowrap" class="ft941">Network</p>
<p style="position:absolute;top:184px;left:344px;white-space:nowrap" class="ft941">Sealing</p>
<p style="position:absolute;top:196px;left:339px;white-space:nowrap" class="ft941">&#160;Manager</p>
<p style="position:absolute;top:205px;left:392px;white-space:nowrap" class="ft941">vTPM</p>
<p style="position:absolute;top:217px;left:386px;white-space:nowrap" class="ft941">&#160;Manager</p>
<p style="position:absolute;top:349px;left:354px;white-space:nowrap" class="ft944">vTPMB</p>
<p style="position:absolute;top:349px;left:460px;white-space:nowrap" class="ft944">VBDB</p>
<p style="position:absolute;top:321px;left:427px;white-space:nowrap" class="ft944">dm-crypt</p>
<p style="position:absolute;top:349px;left:388px;white-space:nowrap" class="ft944">HDD&#160;Driver</p>
<p style="position:absolute;top:298px;left:396px;white-space:nowrap" class="ft943">/dev/sda</p>
<p style="position:absolute;top:349px;left:583px;white-space:nowrap" class="ft944">VNDB</p>
<p style="position:absolute;top:322px;left:547px;white-space:nowrap" class="ft944">bridge</p>
<p style="position:absolute;top:349px;left:504px;white-space:nowrap" class="ft944">HDD&#160;Driver</p>
<p style="position:absolute;top:299px;left:517px;white-space:nowrap" class="ft943">eth0</p>
<p style="position:absolute;top:299px;left:552px;white-space:nowrap" class="ft943">brctl</p>
<p style="position:absolute;top:175px;left:449px;white-space:nowrap" class="ft941">vTPM</p>
<p style="position:absolute;top:175px;left:481px;white-space:nowrap" class="ft941">vHD</p>
<p style="position:absolute;top:175px;left:508px;white-space:nowrap" class="ft941">vNW</p>
<p style="position:absolute;top:175px;left:542px;white-space:nowrap" class="ft941">...</p>
<p style="position:absolute;top:300px;left:670px;white-space:nowrap" class="ft943">eth0</p>
<p style="position:absolute;top:300px;left:692px;white-space:nowrap" class="ft943">/dev/tpm</p>
<p style="position:absolute;top:140px;left:256px;white-space:nowrap" class="ft941">Security</p>
<p style="position:absolute;top:151px;left:258px;white-space:nowrap" class="ft941">&#160;Policy</p>
<p style="position:absolute;top:163px;left:254px;white-space:nowrap" class="ft941">Manager</p>
<p style="position:absolute;top:410px;left:576px;white-space:nowrap" class="ft947">vTPMB&#160;=&#160;vTPM&#160;Backend<br/>vTPMF&#160;&#160;=&#160;vTPM&#160;Frontend<br/>VBDB&#160;&#160;&#160;=&#160;Virtual&#160;Block&#160;Device&#160;Backend<br/>VBDF&#160;&#160;&#160;=&#160;Virtual&#160;Block&#160;Device&#160;Frontend<br/>VNDB&#160;&#160;=&#160;Virtual&#160;Network&#160;Device&#160;Backend<br/>VNDF&#160;&#160;=&#160;Virtual&#160;Network&#160;Device&#160;Frontend</p>
<p style="position:absolute;top:492px;left:319px;white-space:nowrap" class="ft96">Figure&#160;6:&#160;Realization&#160;using&#160;Xen&#160;and&#160;Linux</p>
<p style="position:absolute;top:540px;left:108px;white-space:nowrap" class="ft95">mer&#160;is&#160;depicted&#160;in&#160;in&#160;Figure</p>
<p style="position:absolute;top:540px;left:303px;white-space:nowrap" class="ft96">5</p>
<p style="position:absolute;top:540px;left:310px;white-space:nowrap" class="ft95">.&#160;Both&#160;types&#160;of&#160;seal-</p>
<p style="position:absolute;top:558px;left:108px;white-space:nowrap" class="ft97">ing&#160;can&#160;be&#160;used&#160;to&#160;make&#160;a&#160;key&#160;available&#160;only&#160;when<br/>certain&#160;conditions&#160;are&#160;satisfied.&#160;However,&#160;of&#160;the&#160;two<br/>types&#160;of&#160;sealing,&#160;hypervisor-based&#160;sealing&#160;is&#160;consid-<br/>erably&#160;more&#160;flexible.&#160;The&#160;main&#160;limitation&#160;of&#160;TPM-<br/>based&#160;sealing&#160;is&#160;that&#160;not&#160;a&#160;whole&#160;lot&#160;can&#160;be&#160;stored<br/>in&#160;the&#160;PCRs&#160;of&#160;the&#160;TPM.&#160;Only&#160;one&#160;state&#160;may&#160;be<br/>specified&#160;for&#160;unsealing&#160;in&#160;TPM-based&#160;sealing,&#160;as&#160;op-<br/>posed&#160;to&#160;saying&#160;âany&#160;of&#160;these</p>
<p style="position:absolute;top:683px;left:305px;white-space:nowrap" class="ft916"><i>x</i></p>
<p style="position:absolute;top:683px;left:318px;white-space:nowrap" class="ft95">states&#160;is&#160;acceptableâ</p>
<p style="position:absolute;top:701px;left:108px;white-space:nowrap" class="ft97">for&#160;unsealing.&#160;This&#160;is&#160;a&#160;serious&#160;limitation&#160;when&#160;at-<br/>testing&#160;different&#160;software&#160;that&#160;may&#160;be&#160;loaded&#160;in&#160;dif-<br/>ferent&#160;sequences.&#160;In&#160;hypervisor-based&#160;sealing,&#160;many<br/>acceptable&#160;states&#160;(i.e.,&#160;reference&#160;values)&#160;for&#160;unsealing<br/>may&#160;be&#160;specified.&#160;The&#160;reference&#160;values&#160;are&#160;stored&#160;in<br/>a</p>
<p style="position:absolute;top:791px;left:121px;white-space:nowrap" class="ft918">SealingValuesStorage</p>
<p style="position:absolute;top:791px;left:259px;white-space:nowrap" class="ft95">and&#160;the&#160;corresponding&#160;sealed</p>
<p style="position:absolute;top:809px;left:108px;white-space:nowrap" class="ft95">keys&#160;are&#160;stored&#160;in&#160;a</p>
<p style="position:absolute;top:809px;left:233px;white-space:nowrap" class="ft918">KeyStorage</p>
<p style="position:absolute;top:809px;left:304px;white-space:nowrap" class="ft95">.&#160;Reference&#160;values&#160;may</p>
<p style="position:absolute;top:827px;left:108px;white-space:nowrap" class="ft95">also&#160;be&#160;provided&#160;as&#160;parameters&#160;to&#160;functions&#160;such&#160;as</p>
<p style="position:absolute;top:845px;left:108px;white-space:nowrap" class="ft918">createVM</p>
<p style="position:absolute;top:845px;left:169px;white-space:nowrap" class="ft95">.&#160;Hypervisor-based&#160;sealing&#160;can&#160;also&#160;be&#160;used</p>
<p style="position:absolute;top:863px;left:108px;white-space:nowrap" class="ft97">to&#160;seal&#160;a&#160;key&#160;for&#160;resuming&#160;a&#160;VM&#160;to&#160;a&#160;specific&#160;user,<br/>i.e.,&#160;only&#160;the&#160;specified&#160;user&#160;can&#160;unseal&#160;the&#160;VM.&#160;As&#160;in<br/>hypervisor-based&#160;attestation,&#160;hypervisor-based&#160;seal-<br/>ing&#160;assumes&#160;that&#160;the&#160;hypervisor&#160;is&#160;part&#160;of&#160;the&#160;TCB.</p>
<p style="position:absolute;top:956px;left:108px;white-space:nowrap" class="ft98">5.4</p>
<p style="position:absolute;top:956px;left:154px;white-space:nowrap" class="ft98">Virtual&#160;Device&#160;Management</p>
<p style="position:absolute;top:986px;left:108px;white-space:nowrap" class="ft97">The&#160;Secure&#160;Virtual&#160;Device&#160;Manager&#160;(SVDM)&#160;is&#160;re-<br/>sponsible&#160;for&#160;managing&#160;virtual&#160;devices&#160;such&#160;as&#160;vir-<br/>tual&#160;HDDs,&#160;virtual&#160;block&#160;devices,&#160;virtual&#160;network&#160;de-<br/>vices,&#160;and&#160;virtual&#160;TPMs.&#160;The&#160;service&#160;offered&#160;by&#160;the<br/>SVDM&#160;is&#160;realized&#160;through&#160;multiple&#160;specialized&#160;low-</p>
<p style="position:absolute;top:540px;left:466px;white-space:nowrap" class="ft95">level&#160;plug-ins,&#160;one&#160;for&#160;each&#160;virtual&#160;device.&#160;Figure</p>
<p style="position:absolute;top:540px;left:803px;white-space:nowrap" class="ft96">5</p>
<p style="position:absolute;top:558px;left:466px;white-space:nowrap" class="ft97">shows&#160;one&#160;such&#160;plug-in,&#160;the&#160;secure&#160;virtual&#160;hard&#160;disk<br/>plug-in&#160;(</p>
<p style="position:absolute;top:576px;left:524px;white-space:nowrap" class="ft918">svHDPlugin</p>
<p style="position:absolute;top:576px;left:598px;white-space:nowrap" class="ft95">).&#160;We&#160;describe&#160;more&#160;about&#160;this</p>
<p style="position:absolute;top:594px;left:466px;white-space:nowrap" class="ft97">plug-in&#160;below&#160;in&#160;the&#160;context&#160;of&#160;a&#160;Xen-&#160;and&#160;Linux-<br/>based&#160;implementation.</p>
<p style="position:absolute;top:651px;left:466px;white-space:nowrap" class="ft98">5.5</p>
<p style="position:absolute;top:651px;left:512px;white-space:nowrap" class="ft98">Realization&#160;using&#160;Xen&#160;and&#160;Linux</p>
<p style="position:absolute;top:681px;left:466px;white-space:nowrap" class="ft95">Figure</p>
<p style="position:absolute;top:681px;left:513px;white-space:nowrap" class="ft96">6</p>
<p style="position:absolute;top:681px;left:525px;white-space:nowrap" class="ft95">shows&#160;an&#160;example&#160;implementation&#160;of&#160;our&#160;se-</p>
<p style="position:absolute;top:699px;left:466px;white-space:nowrap" class="ft97">curity&#160;services&#160;design&#160;in&#160;Xen&#160;using&#160;Linux&#160;for&#160;Dom0.<br/>The&#160;Xen&#160;hypervisor&#160;provides&#160;the&#160;physical&#160;devices&#160;to<br/>Dom0&#160;(Xenâs&#160;management&#160;domain).&#160;In&#160;Xen&#160;termi-<br/>nology,&#160;a&#160;front-end&#160;virtual&#160;device&#160;is&#160;one&#160;that&#160;is&#160;as-<br/>sociated&#160;with&#160;a&#160;user&#160;domain&#160;and&#160;a&#160;back-end&#160;virtual<br/>device&#160;is&#160;present&#160;only&#160;in&#160;Dom0.&#160;Every&#160;front-end&#160;vir-<br/>tual&#160;device&#160;has&#160;to&#160;be&#160;connected&#160;to&#160;a&#160;corresponding<br/>back-end&#160;virtual&#160;device;&#160;only&#160;then&#160;does&#160;the&#160;front-end<br/>device&#160;become&#160;active.&#160;The&#160;mapping&#160;is&#160;many-to-one,<br/>i.e.,&#160;many&#160;front-end&#160;virtual&#160;devices,&#160;one&#160;from&#160;each<br/>user&#160;domain,&#160;may&#160;be&#160;mapped&#160;to&#160;a&#160;single&#160;back-end<br/>virtual&#160;device.</p>
<p style="position:absolute;top:914px;left:481px;white-space:nowrap" class="ft95">In&#160;Dom0,&#160;secure&#160;device&#160;virtualization&#160;is&#160;imple-</p>
<p style="position:absolute;top:932px;left:466px;white-space:nowrap" class="ft97">mented&#160;in&#160;the&#160;kernel&#160;space.&#160;Tasks&#160;such&#160;as&#160;config-<br/>uring&#160;of&#160;the&#160;virtual&#160;devices&#160;would&#160;be&#160;done&#160;through<br/>the&#160;secure&#160;virtual&#160;device&#160;manager&#160;in&#160;the&#160;user&#160;(or&#160;ap-<br/>plication)&#160;space.&#160;For&#160;example,&#160;a&#160;secure&#160;harddisk&#160;is<br/>implemented&#160;by&#160;means&#160;of&#160;the</p>
<p style="position:absolute;top:1004px;left:661px;white-space:nowrap" class="ft945">dm-crypt</p>
<p style="position:absolute;top:1004px;left:728px;white-space:nowrap" class="ft95">loopback&#160;de-</p>
<p style="position:absolute;top:1022px;left:466px;white-space:nowrap" class="ft97">vice.&#160;Similarly,&#160;the&#160;network&#160;is&#160;virtualized&#160;by&#160;provid-<br/>ing&#160;virtual&#160;network&#160;cards&#160;for&#160;the&#160;guest&#160;partitions&#160;that<br/>can&#160;then&#160;be&#160;bridged&#160;to&#160;the&#160;actual&#160;network&#160;card.&#160;Se-</p>
<p style="position:absolute;top:1112px;left:455px;white-space:nowrap" class="ft96">9</p>
</div>
<!-- Page 10 -->
<a name="10"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page10-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="OTC_XenSecurityServices010.png" alt="background image"/>
<p style="position:absolute;top:110px;left:108px;white-space:nowrap" class="ft107">curity&#160;for&#160;networks&#160;has&#160;two&#160;aspects.&#160;Topology&#160;con-<br/>straints&#160;define&#160;what&#160;guest&#160;is&#160;allowed&#160;to&#160;connect&#160;to<br/>what&#160;subnets.&#160;In&#160;addition,&#160;encryption&#160;requirements<br/>define&#160;what&#160;connections&#160;need&#160;to&#160;be&#160;encrypted.&#160;An-<br/>other&#160;virtualized&#160;device&#160;is&#160;a&#160;virtual&#160;TPM&#160;that&#160;pro-<br/>vides&#160;one&#160;virtual&#160;TPM&#160;instance&#160;to&#160;each&#160;of&#160;the&#160;guest<br/>partitions&#160;[</p>
<p style="position:absolute;top:218px;left:180px;white-space:nowrap" class="ft106">7</p>
<p style="position:absolute;top:218px;left:188px;white-space:nowrap" class="ft105">].&#160;The&#160;virtual&#160;device&#160;manager&#160;maintains</p>
<p style="position:absolute;top:236px;left:108px;white-space:nowrap" class="ft107">the&#160;devices&#160;and&#160;their&#160;security&#160;properties.&#160;The&#160;in-<br/>tegrity&#160;and&#160;compartment&#160;are&#160;implemented&#160;in&#160;Dom0<br/>and&#160;interface&#160;to&#160;the&#160;hypervisor&#160;as&#160;well&#160;as&#160;the&#160;other<br/>services&#160;implemented&#160;in&#160;Dom0.</p>
<p style="position:absolute;top:308px;left:123px;white-space:nowrap" class="ft105">Secure&#160;management&#160;of&#160;virtual&#160;devices&#160;is&#160;a&#160;complex</p>
<p style="position:absolute;top:325px;left:108px;white-space:nowrap" class="ft107">task.&#160;For&#160;example,&#160;consider&#160;the&#160;steps&#160;involved&#160;in<br/>starting&#160;a&#160;virtual&#160;HDD.&#160;First,&#160;a&#160;policy-based&#160;check&#160;of<br/>the&#160;platform&#160;state&#160;is&#160;done.&#160;That&#160;may&#160;include&#160;verify-<br/>ing&#160;the&#160;measurements&#160;of&#160;the&#160;hypervisor,&#160;binary&#160;disk,<br/>and&#160;the&#160;Dom0&#160;image.&#160;Then,&#160;the&#160;virtual&#160;HD&#160;is&#160;at-<br/>tached&#160;with&#160;credentials&#160;and&#160;connected&#160;with&#160;a&#160;loop&#160;de-<br/>vice&#160;(/dev/loop).&#160;The&#160;virtual&#160;HD&#160;may&#160;be&#160;encrypted,<br/>for&#160;example,&#160;with&#160;a&#160;sealing&#160;key&#160;that&#160;is&#160;made&#160;available<br/>only&#160;if&#160;the&#160;platform&#160;is&#160;in&#160;a&#160;certain&#160;state.&#160;The&#160;decryp-<br/>tion&#160;of&#160;the&#160;virtual&#160;HD&#160;image&#160;is&#160;done&#160;using&#160;the&#160;Linux<br/>HD&#160;encryptor.&#160;After&#160;decryption,&#160;the&#160;device&#160;file&#160;which<br/>gives&#160;access&#160;to&#160;the&#160;decrypted&#160;image&#160;is&#160;connected&#160;to<br/>the&#160;front&#160;end.&#160;Similar&#160;policy-based&#160;checks&#160;may&#160;be<br/>done&#160;when&#160;starting&#160;other&#160;virtual&#160;devices.&#160;For&#160;exam-<br/>ple,&#160;before&#160;starting&#160;a&#160;virtual&#160;network&#160;device,&#160;policies<br/>may&#160;stipulate&#160;that&#160;the&#160;VM&#160;must&#160;be&#160;in&#160;some&#160;accept-<br/>able&#160;state&#160;and&#160;outside&#160;firewalls&#160;must&#160;be&#160;configured<br/>correctly.</p>
<p style="position:absolute;top:674px;left:108px;white-space:nowrap" class="ft104">6</p>
<p style="position:absolute;top:674px;left:144px;white-space:nowrap" class="ft1038">Detailed&#160;Component&#160;Interac-<br/>tions</p>
<p style="position:absolute;top:739px;left:108px;white-space:nowrap" class="ft107">In&#160;this&#160;section,&#160;we&#160;describe&#160;two&#160;examples&#160;of&#160;how<br/>the&#160;components&#160;introduced&#160;in&#160;Section</p>
<p style="position:absolute;top:757px;left:368px;white-space:nowrap" class="ft106">5</p>
<p style="position:absolute;top:757px;left:382px;white-space:nowrap" class="ft105">interact&#160;to</p>
<p style="position:absolute;top:775px;left:108px;white-space:nowrap" class="ft107">achieve&#160;high-level&#160;security&#160;functionality.&#160;The&#160;inter-<br/>actions&#160;are&#160;structured&#160;as&#160;use&#160;cases.&#160;We&#160;assume&#160;that<br/>the&#160;core&#160;trusted&#160;computing&#160;base&#160;(including&#160;Xen&#160;and<br/>Dom0&#160;Linux)&#160;has&#160;been&#160;measured</p>
<p style="position:absolute;top:827px;left:328px;white-space:nowrap" class="ft1012">5</p>
<p style="position:absolute;top:829px;left:341px;white-space:nowrap" class="ft105">at&#160;start-up&#160;time.</p>
<p style="position:absolute;top:847px;left:108px;white-space:nowrap" class="ft107">Additional&#160;services&#160;may&#160;need&#160;to&#160;be&#160;measured&#160;based<br/>on&#160;policy.&#160;The&#160;step&#160;numbers&#160;in&#160;the&#160;description&#160;below<br/>relate&#160;to&#160;the&#160;steps&#160;shown&#160;in&#160;the&#160;interaction&#160;diagrams,<br/>Figures</p>
<p style="position:absolute;top:901px;left:161px;white-space:nowrap" class="ft106">7</p>
<p style="position:absolute;top:901px;left:174px;white-space:nowrap" class="ft105">and</p>
<p style="position:absolute;top:901px;left:208px;white-space:nowrap" class="ft106">8</p>
<p style="position:absolute;top:901px;left:215px;white-space:nowrap" class="ft105">.</p>
<p style="position:absolute;top:940px;left:108px;white-space:nowrap" class="ft108">6.1</p>
<p style="position:absolute;top:940px;left:154px;white-space:nowrap" class="ft1011">TPM-based&#160;Attestation&#160;to&#160;the<br/>current&#160;state&#160;of&#160;the&#160;Hypervisor</p>
<p style="position:absolute;top:991px;left:108px;white-space:nowrap" class="ft105">Figure</p>
<p style="position:absolute;top:991px;left:154px;white-space:nowrap" class="ft106">7</p>
<p style="position:absolute;top:991px;left:165px;white-space:nowrap" class="ft105">shows&#160;the&#160;component&#160;interactions&#160;for&#160;attest-</p>
<p style="position:absolute;top:1009px;left:108px;white-space:nowrap" class="ft105">ing&#160;the&#160;current&#160;state&#160;of&#160;the&#160;TCB&#160;and&#160;the&#160;hypervisor</p>
<p style="position:absolute;top:1036px;left:125px;white-space:nowrap" class="ft1014">5</p>
<p style="position:absolute;top:1038px;left:131px;white-space:nowrap" class="ft1015">This&#160;can&#160;either&#160;be&#160;done&#160;by&#160;a&#160;trusted&#160;boot&#160;loader&#160;such&#160;as</p>
<p style="position:absolute;top:1052px;left:108px;white-space:nowrap" class="ft1031">TrustedGrub&#160;measuring&#160;the&#160;whole&#160;boot&#160;image&#160;or&#160;else&#160;by&#160;a&#160;more<br/>fine-grained&#160;approach&#160;such&#160;as&#160;that&#160;proposed&#160;by&#160;Sailer&#160;et&#160;al.&#160;[6].</p>
<p style="position:absolute;top:110px;left:466px;white-space:nowrap" class="ft107">status&#160;information&#160;(such&#160;as&#160;which&#160;VMs&#160;are&#160;running<br/>on&#160;the&#160;physical&#160;machine,&#160;how&#160;much&#160;memory&#160;is&#160;avail-<br/>able,&#160;etc.).</p>
<p style="position:absolute;top:164px;left:481px;white-space:nowrap" class="ft105">The</p>
<p style="position:absolute;top:164px;left:526px;white-space:nowrap" class="ft105">verifier</p>
<p style="position:absolute;top:164px;left:590px;white-space:nowrap" class="ft105">directly</p>
<p style="position:absolute;top:164px;left:659px;white-space:nowrap" class="ft105">interacts</p>
<p style="position:absolute;top:164px;left:734px;white-space:nowrap" class="ft105">only</p>
<p style="position:absolute;top:164px;left:781px;white-space:nowrap" class="ft105">with</p>
<p style="position:absolute;top:182px;left:466px;white-space:nowrap" class="ft105">the&#160;CM&#160;through&#160;the</p>
<p style="position:absolute;top:182px;left:637px;white-space:nowrap" class="ft1018">attest</p>
<p style="position:absolute;top:182px;left:673px;white-space:nowrap" class="ft105">()&#160;call&#160;passing&#160;an</p>
<p style="position:absolute;top:200px;left:466px;white-space:nowrap" class="ft1018">AttestationDescriptor</p>
<p style="position:absolute;top:200px;left:613px;white-space:nowrap" class="ft105">and&#160;a</p>
<p style="position:absolute;top:200px;left:672px;white-space:nowrap" class="ft1018">UserCredential</p>
<p style="position:absolute;top:200px;left:776px;white-space:nowrap" class="ft105">as&#160;a</p>
<p style="position:absolute;top:218px;left:466px;white-space:nowrap" class="ft105">parameter.</p>
<p style="position:absolute;top:218px;left:557px;white-space:nowrap" class="ft105">The&#160;credential&#160;gets&#160;verified&#160;and&#160;the</p>
<p style="position:absolute;top:236px;left:466px;white-space:nowrap" class="ft107">CM&#160;checks&#160;whether&#160;the&#160;verifier&#160;is&#160;allowed&#160;to&#160;do<br/>the&#160;requested&#160;attestation&#160;or&#160;not&#160;(not&#160;shown&#160;in<br/>Figure</p>
<p style="position:absolute;top:272px;left:514px;white-space:nowrap" class="ft106">7</p>
<p style="position:absolute;top:272px;left:521px;white-space:nowrap" class="ft105">).</p>
<p style="position:absolute;top:272px;left:538px;white-space:nowrap" class="ft1018">AttestationDescriptor</p>
<p style="position:absolute;top:272px;left:676px;white-space:nowrap" class="ft105">is&#160;a&#160;data&#160;object&#160;that</p>
<p style="position:absolute;top:290px;left:466px;white-space:nowrap" class="ft107">describes&#160;what&#160;the&#160;verifier&#160;wants&#160;to&#160;have&#160;attested.<br/>Essentially,&#160;the&#160;object&#160;provides&#160;the&#160;log&#160;file&#160;projection<br/>function</p>
<p style="position:absolute;top:325px;left:528px;white-space:nowrap" class="ft1018">p</p>
<p style="position:absolute;top:325px;left:536px;white-space:nowrap" class="ft105">()&#160;described&#160;in&#160;Section</p>
<p style="position:absolute;top:325px;left:701px;white-space:nowrap" class="ft106">3.3</p>
<p style="position:absolute;top:325px;left:720px;white-space:nowrap" class="ft105">.</p>
<p style="position:absolute;top:325px;left:741px;white-space:nowrap" class="ft105">It&#160;consists</p>
<p style="position:absolute;top:343px;left:466px;white-space:nowrap" class="ft105">of&#160;one&#160;or&#160;more</p>
<p style="position:absolute;top:343px;left:589px;white-space:nowrap" class="ft1018">MeasurementDescriptors</p>
<p style="position:absolute;top:343px;left:742px;white-space:nowrap" class="ft105">,&#160;each&#160;of</p>
<p style="position:absolute;top:361px;left:466px;white-space:nowrap" class="ft107">which&#160;describe&#160;what&#160;things&#160;have&#160;to&#160;be&#160;measured.<br/>The&#160;CM&#160;checks&#160;whether&#160;the&#160;verifier&#160;is&#160;allowed&#160;to<br/>access&#160;all&#160;the&#160;parts&#160;the&#160;verifier&#160;wants&#160;to&#160;attested<br/>by&#160;calling&#160;the</p>
<p style="position:absolute;top:415px;left:572px;white-space:nowrap" class="ft1018">deriveAllowedAttestationPieces</p>
<p style="position:absolute;top:415px;left:766px;white-space:nowrap" class="ft105">().</p>
<p style="position:absolute;top:415px;left:800px;white-space:nowrap" class="ft105">If</p>
<p style="position:absolute;top:433px;left:466px;white-space:nowrap" class="ft107">the&#160;check&#160;reveals&#160;that&#160;the&#160;verifier&#160;wants&#160;to&#160;have<br/>more&#160;attested&#160;that&#160;what&#160;he/she&#160;is&#160;allowed,&#160;then<br/>the&#160;whole&#160;attestation&#160;request&#160;is&#160;denied.&#160;Otherwise,<br/>the&#160;CM&#160;forwards&#160;the&#160;request&#160;to&#160;the&#160;ISM&#160;(step&#160;3),<br/>which&#160;forwards&#160;it&#160;to&#160;the</p>
<p style="position:absolute;top:505px;left:635px;white-space:nowrap" class="ft1018">AttestationService</p>
<p style="position:absolute;top:505px;left:754px;white-space:nowrap" class="ft105">(step&#160;4),</p>
<p style="position:absolute;top:523px;left:466px;white-space:nowrap" class="ft105">which,&#160;in&#160;turn,&#160;invokes&#160;the</p>
<p style="position:absolute;top:523px;left:682px;white-space:nowrap" class="ft1018">MeasurementService</p>
<p style="position:absolute;top:541px;left:466px;white-space:nowrap" class="ft105">(step&#160;5).</p>
<p style="position:absolute;top:541px;left:565px;white-space:nowrap" class="ft105">The</p>
<p style="position:absolute;top:541px;left:605px;white-space:nowrap" class="ft1018">MeasurementService</p>
<p style="position:absolute;top:541px;left:747px;white-space:nowrap" class="ft105">calls&#160;the</p>
<p style="position:absolute;top:559px;left:466px;white-space:nowrap" class="ft1018">ConfigurationMeasurement</p>
<p style="position:absolute;top:559px;left:646px;white-space:nowrap" class="ft105">module&#160;(step&#160;6)&#160;which</p>
<p style="position:absolute;top:576px;left:466px;white-space:nowrap" class="ft107">retrieves&#160;the&#160;current&#160;state&#160;information&#160;for&#160;the<br/>list&#160;of&#160;VMs&#160;by&#160;calling</p>
<p style="position:absolute;top:594px;left:633px;white-space:nowrap" class="ft1018">getCurrentXenState</p>
<p style="position:absolute;top:594px;left:757px;white-space:nowrap" class="ft105">()&#160;(step</p>
<p style="position:absolute;top:612px;left:466px;white-space:nowrap" class="ft107">7)&#160;of&#160;the&#160;CM.&#160;The&#160;CM&#160;obtains&#160;that&#160;informa-<br/>tion&#160;from&#160;the&#160;VMM&#160;(steps&#160;8â11)&#160;and&#160;passes&#160;that<br/>information&#160;to&#160;the</p>
<p style="position:absolute;top:648px;left:602px;white-space:nowrap" class="ft1018">ConfigurationMeasurement</p>
<p style="position:absolute;top:648px;left:778px;white-space:nowrap" class="ft105">com-</p>
<p style="position:absolute;top:666px;left:466px;white-space:nowrap" class="ft105">ponent&#160;through&#160;the</p>
<p style="position:absolute;top:666px;left:602px;white-space:nowrap" class="ft1018">Stateinfo</p>
<p style="position:absolute;top:666px;left:664px;white-space:nowrap" class="ft105">object&#160;(step&#160;12).&#160;The</p>
<p style="position:absolute;top:684px;left:466px;white-space:nowrap" class="ft1018">ConfigurationMeasurement</p>
<p style="position:absolute;top:684px;left:657px;white-space:nowrap" class="ft105">component</p>
<p style="position:absolute;top:684px;left:751px;white-space:nowrap" class="ft105">measures</p>
<p style="position:absolute;top:702px;left:466px;white-space:nowrap" class="ft105">the</p>
<p style="position:absolute;top:702px;left:496px;white-space:nowrap" class="ft1018">Stateinfo</p>
<p style="position:absolute;top:702px;left:561px;white-space:nowrap" class="ft105">object&#160;and&#160;passes&#160;the&#160;result&#160;in&#160;the</p>
<p style="position:absolute;top:720px;left:466px;white-space:nowrap" class="ft1018">Measurement</p>
<p style="position:absolute;top:720px;left:555px;white-space:nowrap" class="ft105">object&#160;to&#160;the</p>
<p style="position:absolute;top:720px;left:645px;white-space:nowrap" class="ft1018">MeasurementService</p>
<p style="position:absolute;top:720px;left:778px;white-space:nowrap" class="ft105">(step</p>
<p style="position:absolute;top:738px;left:466px;white-space:nowrap" class="ft105">13).</p>
<p style="position:absolute;top:738px;left:513px;white-space:nowrap" class="ft105">Thereafter,&#160;the</p>
<p style="position:absolute;top:738px;left:628px;white-space:nowrap" class="ft1018">AttestationService</p>
<p style="position:absolute;top:738px;left:751px;white-space:nowrap" class="ft105">calls&#160;the</p>
<p style="position:absolute;top:756px;left:466px;white-space:nowrap" class="ft1018">attestTPM</p>
<p style="position:absolute;top:756px;left:535px;white-space:nowrap" class="ft105">()&#160;of&#160;the</p>
<p style="position:absolute;top:756px;left:594px;white-space:nowrap" class="ft1018">TPMAttestation</p>
<p style="position:absolute;top:756px;left:701px;white-space:nowrap" class="ft105">component&#160;(step</p>
<p style="position:absolute;top:774px;left:466px;white-space:nowrap" class="ft107">15)&#160;to&#160;complete&#160;the&#160;attestation&#160;process.&#160;The&#160;next<br/>steps&#160;are&#160;writing&#160;the&#160;generated&#160;measurement&#160;hashes<br/>into&#160;a&#160;PCR&#160;by&#160;calling</p>
<p style="position:absolute;top:810px;left:608px;white-space:nowrap" class="ft1018">TPM&#160;extend</p>
<p style="position:absolute;top:810px;left:687px;white-space:nowrap" class="ft105">()&#160;and&#160;generating&#160;a</p>
<p style="position:absolute;top:828px;left:466px;white-space:nowrap" class="ft105">quote&#160;by&#160;calling</p>
<p style="position:absolute;top:828px;left:573px;white-space:nowrap" class="ft1018">TPM&#160;Quote</p>
<p style="position:absolute;top:828px;left:650px;white-space:nowrap" class="ft105">().&#160;The</p>
<p style="position:absolute;top:828px;left:702px;white-space:nowrap" class="ft1018">AttestationResult</p>
<p style="position:absolute;top:845px;left:466px;white-space:nowrap" class="ft105">consists&#160;of&#160;quote&#160;and&#160;the</p>
<p style="position:absolute;top:845px;left:641px;white-space:nowrap" class="ft1018">AttestationDescriptor</p>
<p style="position:absolute;top:845px;left:781px;white-space:nowrap" class="ft105">with</p>
<p style="position:absolute;top:863px;left:466px;white-space:nowrap" class="ft107">the&#160;results&#160;of&#160;the&#160;different&#160;attestation&#160;targets.&#160;A&#160;ver-<br/>ifier&#160;can&#160;verify&#160;the&#160;integrity&#160;of&#160;the&#160;attestation&#160;result<br/>by&#160;recomputing&#160;a&#160;hash&#160;over&#160;the&#160;attestation&#160;targets<br/>specified&#160;in&#160;the</p>
<p style="position:absolute;top:917px;left:572px;white-space:nowrap" class="ft1018">AttestationResult</p>
<p style="position:absolute;top:917px;left:686px;white-space:nowrap" class="ft105">and&#160;comparing&#160;the</p>
<p style="position:absolute;top:935px;left:466px;white-space:nowrap" class="ft107">resulting&#160;hash&#160;with&#160;the&#160;hash&#160;in&#160;the&#160;PCR&#160;from&#160;the<br/>quote.&#160;The&#160;PCR&#160;in&#160;which&#160;the</p>
<p style="position:absolute;top:953px;left:685px;white-space:nowrap" class="ft1018">AttestationResult</p>
<p style="position:absolute;top:953px;left:800px;white-space:nowrap" class="ft105">is</p>
<p style="position:absolute;top:971px;left:466px;white-space:nowrap" class="ft107">stored&#160;gets&#160;reset&#160;after&#160;the&#160;attestation&#160;process&#160;has<br/>finished.&#160;Therefore,&#160;we&#160;need&#160;a&#160;TPM&#160;that&#160;implements<br/>the&#160;TCG&#160;version&#160;1.2&#160;specification&#160;and&#160;the&#160;PCR<br/>index&#160;for&#160;storing&#160;the</p>
<p style="position:absolute;top:1025px;left:603px;white-space:nowrap" class="ft1018">AttestationResult</p>
<p style="position:absolute;top:1025px;left:716px;white-space:nowrap" class="ft105">hash&#160;has&#160;to&#160;be</p>
<p style="position:absolute;top:1043px;left:466px;white-space:nowrap" class="ft105">less&#160;than&#160;15.</p>
<p style="position:absolute;top:1112px;left:452px;white-space:nowrap" class="ft106">10</p>
</div>
<!-- Page 11 -->
<a name="11"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1148{font-size:9px;font-family:Helvetica;color:#000000;}
	.ft1149{font-size:9px;line-height:10px;font-family:Helvetica;color:#000000;}
-->
</style>
<div id="page11-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="OTC_XenSecurityServices011.png" alt="background image"/>
<p style="position:absolute;top:150px;left:118px;white-space:nowrap" class="ft1148"><b>Ve&#160;rifier</b></p>
<p style="position:absolute;top:150px;left:118px;white-space:nowrap" class="ft1148"><b>Ve&#160;rifier</b></p>
<p style="position:absolute;top:150px;left:172px;white-space:nowrap" class="ft1148"><b>Compartme&#160;nt&#160;</b></p>
<p style="position:absolute;top:160px;left:184px;white-space:nowrap" class="ft1148"><b>Manage&#160;r</b></p>
<p style="position:absolute;top:150px;left:172px;white-space:nowrap" class="ft1148"><b>Compartme&#160;nt&#160;</b></p>
<p style="position:absolute;top:160px;left:184px;white-space:nowrap" class="ft1148"><b>Manage&#160;r</b></p>
<p style="position:absolute;top:150px;left:270px;white-space:nowrap" class="ft1148"><b>VMM&#160;Core</b></p>
<p style="position:absolute;top:150px;left:270px;white-space:nowrap" class="ft1148"><b>VMM&#160;Core</b></p>
<p style="position:absolute;top:150px;left:351px;white-space:nowrap" class="ft1148"><b>Inte&#160;grity&#160;Services&#160;</b></p>
<p style="position:absolute;top:160px;left:373px;white-space:nowrap" class="ft1148"><b>Manager</b></p>
<p style="position:absolute;top:150px;left:351px;white-space:nowrap" class="ft1148"><b>Inte&#160;grity&#160;Services&#160;</b></p>
<p style="position:absolute;top:160px;left:373px;white-space:nowrap" class="ft1148"><b>Manager</b></p>
<p style="position:absolute;top:150px;left:455px;white-space:nowrap" class="ft1148"><b>Attestation</b></p>
<p style="position:absolute;top:160px;left:463px;white-space:nowrap" class="ft1148"><b>Serv&#160;ice</b></p>
<p style="position:absolute;top:150px;left:455px;white-space:nowrap" class="ft1148"><b>Attestation</b></p>
<p style="position:absolute;top:160px;left:463px;white-space:nowrap" class="ft1148"><b>Serv&#160;ice</b></p>
<p style="position:absolute;top:150px;left:539px;white-space:nowrap" class="ft1148"><b>TPM&#160;</b></p>
<p style="position:absolute;top:160px;left:525px;white-space:nowrap" class="ft1148"><b>Attestation</b></p>
<p style="position:absolute;top:150px;left:539px;white-space:nowrap" class="ft1148"><b>TPM&#160;</b></p>
<p style="position:absolute;top:160px;left:525px;white-space:nowrap" class="ft1148"><b>Attestation</b></p>
<p style="position:absolute;top:150px;left:596px;white-space:nowrap" class="ft1148"><b>M&#160;easureme&#160;nt&#160;</b></p>
<p style="position:absolute;top:160px;left:612px;white-space:nowrap" class="ft1148"><b>Se&#160;rvice</b></p>
<p style="position:absolute;top:150px;left:596px;white-space:nowrap" class="ft1148"><b>M&#160;easureme&#160;nt&#160;</b></p>
<p style="position:absolute;top:160px;left:612px;white-space:nowrap" class="ft1148"><b>Se&#160;rvice</b></p>
<p style="position:absolute;top:150px;left:689px;white-space:nowrap" class="ft1149"><b>Configuration<br/>Measurement</b></p>
<p style="position:absolute;top:150px;left:689px;white-space:nowrap" class="ft1149"><b>Configuration<br/>Measurement</b></p>
<p style="position:absolute;top:150px;left:780px;white-space:nowrap" class="ft1148"><b>TPM</b></p>
<p style="position:absolute;top:150px;left:780px;white-space:nowrap" class="ft1148"><b>TPM</b></p>
<p style="position:absolute;top:175px;left:109px;white-space:nowrap" class="ft1148"><b>1:&#160;atte&#160;st&#160;(AttestationDescriptor,&#160;Use&#160;rCredential)</b></p>
<p style="position:absolute;top:516px;left:120px;white-space:nowrap" class="ft1148"><b>23:&#160;AttestationResult</b></p>
<p style="position:absolute;top:210px;left:148px;white-space:nowrap" class="ft1148"><b>3:&#160;reque&#160;stAttestation&#160;(AttestationDescriptor)</b></p>
<p style="position:absolute;top:498px;left:251px;white-space:nowrap" class="ft1148"><b>22:&#160;AttestationRe&#160;sult</b></p>
<p style="position:absolute;top:223px;left:399px;white-space:nowrap" class="ft1148"><b>4:&#160;attest&#160;(AttestationDescriptor)</b></p>
<p style="position:absolute;top:236px;left:485px;white-space:nowrap" class="ft1148"><b>5:&#160;measure&#160;(MeasurementDescriptor)</b></p>
<p style="position:absolute;top:250px;left:634px;white-space:nowrap" class="ft1148"><b>6:&#160;measureStatus&#160;(Measureme&#160;nt)</b></p>
<p style="position:absolute;top:355px;left:635px;white-space:nowrap" class="ft1148"><b>13:&#160;Me&#160;asure&#160;ment</b></p>
<p style="position:absolute;top:366px;left:491px;white-space:nowrap" class="ft1148"><b>14:&#160;MeasurementDescriptor</b></p>
<p style="position:absolute;top:382px;left:456px;white-space:nowrap" class="ft1148"><b>15:&#160;attestTPM&#160;(AttestationDescriptor)</b></p>
<p style="position:absolute;top:398px;left:598px;white-space:nowrap" class="ft1148"><b>16:&#160;TPM_extend(TPM&#160;_Measure&#160;ment)</b></p>
<p style="position:absolute;top:412px;left:643px;white-space:nowrap" class="ft1148"><b>17:&#160;Boolean</b></p>
<p style="position:absolute;top:263px;left:381px;white-space:nowrap" class="ft1148"><b>7:&#160;getCurrentXenState&#160;()</b></p>
<p style="position:absolute;top:340px;left:408px;white-space:nowrap" class="ft1148"><b>12:&#160;StateInfo</b></p>
<p style="position:absolute;top:425px;left:598px;white-space:nowrap" class="ft1148"><b>18:&#160;TPM_Quote(Challange,&#160;Key)</b></p>
<p style="position:absolute;top:438px;left:638px;white-space:nowrap" class="ft1148"><b>19:&#160;TPMQuote</b></p>
<p style="position:absolute;top:454px;left:450px;white-space:nowrap" class="ft1148"><b>20:&#160;Atte&#160;stationRe&#160;sult</b></p>
<p style="position:absolute;top:468px;left:361px;white-space:nowrap" class="ft1148"><b>21:&#160;Atte&#160;stationResult</b></p>
<p style="position:absolute;top:282px;left:219px;white-space:nowrap" class="ft1148"><b>8:&#160;getInfo&#160;(&#160;)</b></p>
<p style="position:absolute;top:297px;left:214px;white-space:nowrap" class="ft1148"><b>9:&#160;Hype&#160;rvisorEnvInfo</b></p>
<p style="position:absolute;top:312px;left:209px;white-space:nowrap" class="ft1148"><b>10:&#160;getListOfVMs&#160;(&#160;)</b></p>
<p style="position:absolute;top:329px;left:228px;white-space:nowrap" class="ft1148"><b>11:&#160;String</b></p>
<p style="position:absolute;top:188px;left:207px;white-space:nowrap" class="ft1148"><b>2:&#160;derive&#160;AllowedAttestationPiece&#160;s&#160;(&#160;)</b></p>
<p style="position:absolute;top:589px;left:349px;white-space:nowrap" class="ft116">Figure&#160;7:&#160;TPM-based&#160;Attestation</p>
<p style="position:absolute;top:695px;left:110px;white-space:nowrap" class="ft1148"><b>Compartment&#160;</b></p>
<p style="position:absolute;top:705px;left:122px;white-space:nowrap" class="ft1148"><b>M&#160;anager</b></p>
<p style="position:absolute;top:695px;left:110px;white-space:nowrap" class="ft1148"><b>Compartment&#160;</b></p>
<p style="position:absolute;top:705px;left:122px;white-space:nowrap" class="ft1148"><b>M&#160;anager</b></p>
<p style="position:absolute;top:695px;left:216px;white-space:nowrap" class="ft1148"><b>Integrity&#160;</b></p>
<p style="position:absolute;top:705px;left:196px;white-space:nowrap" class="ft1148"><b>ServicesM&#160;anager</b></p>
<p style="position:absolute;top:695px;left:216px;white-space:nowrap" class="ft1148"><b>Integrity&#160;</b></p>
<p style="position:absolute;top:705px;left:196px;white-space:nowrap" class="ft1148"><b>ServicesM&#160;anager</b></p>
<p style="position:absolute;top:695px;left:311px;white-space:nowrap" class="ft1148"><b>Sealing&#160;</b></p>
<p style="position:absolute;top:705px;left:312px;white-space:nowrap" class="ft1148"><b>Se&#160;rvice</b></p>
<p style="position:absolute;top:695px;left:311px;white-space:nowrap" class="ft1148"><b>Sealing&#160;</b></p>
<p style="position:absolute;top:705px;left:312px;white-space:nowrap" class="ft1148"><b>Se&#160;rvice</b></p>
<p style="position:absolute;top:695px;left:380px;white-space:nowrap" class="ft1148"><b>TPM&#160;</b></p>
<p style="position:absolute;top:705px;left:374px;white-space:nowrap" class="ft1148"><b>Sealing</b></p>
<p style="position:absolute;top:695px;left:380px;white-space:nowrap" class="ft1148"><b>TPM&#160;</b></p>
<p style="position:absolute;top:705px;left:374px;white-space:nowrap" class="ft1148"><b>Sealing</b></p>
<p style="position:absolute;top:695px;left:431px;white-space:nowrap" class="ft1148"><b>M&#160;easurement&#160;</b></p>
<p style="position:absolute;top:705px;left:446px;white-space:nowrap" class="ft1148"><b>Service</b></p>
<p style="position:absolute;top:695px;left:431px;white-space:nowrap" class="ft1148"><b>M&#160;easurement&#160;</b></p>
<p style="position:absolute;top:705px;left:446px;white-space:nowrap" class="ft1148"><b>Service</b></p>
<p style="position:absolute;top:695px;left:539px;white-space:nowrap" class="ft1148"><b>Storage&#160;</b></p>
<p style="position:absolute;top:705px;left:527px;white-space:nowrap" class="ft1148"><b>M&#160;easurement</b></p>
<p style="position:absolute;top:695px;left:539px;white-space:nowrap" class="ft1148"><b>Storage&#160;</b></p>
<p style="position:absolute;top:705px;left:527px;white-space:nowrap" class="ft1148"><b>M&#160;easurement</b></p>
<p style="position:absolute;top:695px;left:618px;white-space:nowrap" class="ft1148"><b>vHardDisk</b></p>
<p style="position:absolute;top:695px;left:618px;white-space:nowrap" class="ft1148"><b>vHardDisk</b></p>
<p style="position:absolute;top:695px;left:693px;white-space:nowrap" class="ft1148"><b>TPM</b></p>
<p style="position:absolute;top:695px;left:693px;white-space:nowrap" class="ft1148"><b>TPM</b></p>
<p style="position:absolute;top:695px;left:741px;white-space:nowrap" class="ft1148"><b>SecureVirtual&#160;</b></p>
<p style="position:absolute;top:705px;left:737px;white-space:nowrap" class="ft1148"><b>Device&#160;Manage&#160;r</b></p>
<p style="position:absolute;top:695px;left:741px;white-space:nowrap" class="ft1148"><b>SecureVirtual&#160;</b></p>
<p style="position:absolute;top:705px;left:737px;white-space:nowrap" class="ft1148"><b>Device&#160;Manage&#160;r</b></p>
<p style="position:absolute;top:719px;left:145px;white-space:nowrap" class="ft1148"><b>1:&#160;enforcePolicy&#160;(Policy)</b></p>
<p style="position:absolute;top:733px;left:241px;white-space:nowrap" class="ft1148"><b>2:&#160;unseal&#160;(SealingDescriptor)</b></p>
<p style="position:absolute;top:745px;left:333px;white-space:nowrap" class="ft1148"><b>3:&#160;me&#160;asure&#160;&#160;(M&#160;easurementDescriptor)</b></p>
<p style="position:absolute;top:759px;left:471px;white-space:nowrap" class="ft1148"><b>4:&#160;measureStorage&#160;(Measurement)</b></p>
<p style="position:absolute;top:772px;left:578px;white-space:nowrap" class="ft1148"><b>5:&#160;read&#160;(&#160;)</b></p>
<p style="position:absolute;top:787px;left:584px;white-space:nowrap" class="ft1148"><b>6:&#160;Byte</b></p>
<p style="position:absolute;top:798px;left:474px;white-space:nowrap" class="ft1148"><b>7:&#160;Me&#160;asureme&#160;nt</b></p>
<p style="position:absolute;top:811px;left:336px;white-space:nowrap" class="ft1148"><b>8:&#160;Me&#160;asureme&#160;ntDe&#160;scriptor</b></p>
<p style="position:absolute;top:913px;left:267px;white-space:nowrap" class="ft1148"><b>15:&#160;Key</b></p>
<p style="position:absolute;top:826px;left:334px;white-space:nowrap" class="ft1148"><b>9:&#160;unseal&#160;(&#160;)</b></p>
<p style="position:absolute;top:900px;left:344px;white-space:nowrap" class="ft1148"><b>14:&#160;Key</b></p>
<p style="position:absolute;top:869px;left:507px;white-space:nowrap" class="ft1148"><b>12:&#160;TPM&#160;_unseal(&#160;)</b></p>
<p style="position:absolute;top:881px;left:531px;white-space:nowrap" class="ft1148"><b>13:&#160;Ke&#160;y</b></p>
<p style="position:absolute;top:837px;left:465px;white-space:nowrap" class="ft1148"><b>10:&#160;TPM_exte&#160;nd(TPM_Measure&#160;ment)</b></p>
<p style="position:absolute;top:852px;left:521px;white-space:nowrap" class="ft1148"><b>11:&#160;Boole&#160;an</b></p>
<p style="position:absolute;top:927px;left:125px;white-space:nowrap" class="ft1148"><b>16:&#160;Enforceme&#160;ntRe&#160;sult</b></p>
<p style="position:absolute;top:941px;left:366px;white-space:nowrap" class="ft1148"><b>17:&#160;configAndUnlockDisk&#160;(De&#160;viceConfig)</b></p>
<p style="position:absolute;top:956px;left:431px;white-space:nowrap" class="ft1148"><b>18:&#160;Boolean</b></p>
<p style="position:absolute;top:1029px;left:285px;white-space:nowrap" class="ft116">Figure&#160;8:&#160;Creation&#160;of&#160;a&#160;VM&#160;with&#160;TPM-based&#160;Sealing</p>
<p style="position:absolute;top:1112px;left:452px;white-space:nowrap" class="ft116">11</p>
</div>
<!-- Page 12 -->
<a name="12"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}	.ft1250{font-size:15px;line-height:17px;font-family:UWEYSG+CMTI10;color:#000000;}
-->
</style>
<div id="page12-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="OTC_XenSecurityServices012.png" alt="background image"/>
<p style="position:absolute;top:108px;left:108px;white-space:nowrap" class="ft128">6.2</p>
<p style="position:absolute;top:108px;left:154px;white-space:nowrap" class="ft1211">Creation&#160;of&#160;a&#160;VM&#160;with&#160;TPM-<br/>based&#160;Sealing</p>
<p style="position:absolute;top:159px;left:108px;white-space:nowrap" class="ft125">Figure</p>
<p style="position:absolute;top:159px;left:159px;white-space:nowrap" class="ft126">8</p>
<p style="position:absolute;top:159px;left:175px;white-space:nowrap" class="ft125">shows&#160;how&#160;a&#160;VM&#160;with&#160;a&#160;sealed&#160;disk&#160;is</p>
<p style="position:absolute;top:177px;left:108px;white-space:nowrap" class="ft127">(re)started.&#160;Suppose&#160;the&#160;policy&#160;specifies&#160;that&#160;the&#160;vir-<br/>tual&#160;hard&#160;disk&#160;has&#160;to&#160;be&#160;measured&#160;to&#160;obtain&#160;the&#160;key<br/>for&#160;unsealing&#160;the&#160;VM.&#160;Suppose&#160;further&#160;that&#160;the&#160;policy<br/>specifies&#160;that&#160;the&#160;TPM&#160;should&#160;reveal&#160;the&#160;key&#160;only&#160;if<br/>the&#160;measurement&#160;value&#160;written&#160;into&#160;a&#160;specified&#160;PCR<br/>matches&#160;the&#160;value&#160;against&#160;which&#160;the&#160;key&#160;was&#160;sealed.</p>
<p style="position:absolute;top:284px;left:123px;white-space:nowrap" class="ft125">To&#160;enforce&#160;the&#160;above&#160;policy,&#160;the&#160;CM&#160;calls&#160;the&#160;ISM</p>
<p style="position:absolute;top:302px;left:108px;white-space:nowrap" class="ft125">interface</p>
<p style="position:absolute;top:302px;left:169px;white-space:nowrap" class="ft1218">enforcepolicy</p>
<p style="position:absolute;top:302px;left:250px;white-space:nowrap" class="ft125">()&#160;(step&#160;1).&#160;The</p>
<p style="position:absolute;top:302px;left:359px;white-space:nowrap" class="ft1218">SealingService</p>
<p style="position:absolute;top:302px;left:447px;white-space:nowrap" class="ft125">,</p>
<p style="position:absolute;top:320px;left:108px;white-space:nowrap" class="ft125">which&#160;gets&#160;called&#160;by&#160;the&#160;ISM,&#160;extracts&#160;the</p>
<p style="position:absolute;top:338px;left:108px;white-space:nowrap" class="ft1218">MeasurementsDescriptor</p>
<p style="position:absolute;top:338px;left:272px;white-space:nowrap" class="ft125">from&#160;the</p>
<p style="position:absolute;top:338px;left:343px;white-space:nowrap" class="ft1218">SealingDescriptor</p>
<p style="position:absolute;top:356px;left:108px;white-space:nowrap" class="ft125">(step&#160;2).</p>
<p style="position:absolute;top:356px;left:201px;white-space:nowrap" class="ft125">Then,&#160;the</p>
<p style="position:absolute;top:356px;left:288px;white-space:nowrap" class="ft1218">SealingService</p>
<p style="position:absolute;top:356px;left:390px;white-space:nowrap" class="ft125">calls&#160;the</p>
<p style="position:absolute;top:374px;left:108px;white-space:nowrap" class="ft1218">MeasurementService</p>
<p style="position:absolute;top:374px;left:240px;white-space:nowrap" class="ft125">(step&#160;3)&#160;which&#160;measures&#160;the&#160;vir-</p>
<p style="position:absolute;top:392px;left:108px;white-space:nowrap" class="ft125">tual&#160;disk&#160;by&#160;calling</p>
<p style="position:absolute;top:392px;left:245px;white-space:nowrap" class="ft1218">measureStorage</p>
<p style="position:absolute;top:392px;left:343px;white-space:nowrap" class="ft125">()&#160;(step&#160;4).&#160;Af-</p>
<p style="position:absolute;top:410px;left:108px;white-space:nowrap" class="ft125">ter&#160;retrieving&#160;the&#160;measurements&#160;(steps&#160;5â8),&#160;the</p>
<p style="position:absolute;top:428px;left:108px;white-space:nowrap" class="ft1218">SealingService</p>
<p style="position:absolute;top:428px;left:203px;white-space:nowrap" class="ft125">component&#160;invokes&#160;the</p>
<p style="position:absolute;top:428px;left:362px;white-space:nowrap" class="ft1218">unseal</p>
<p style="position:absolute;top:428px;left:400px;white-space:nowrap" class="ft125">()&#160;func-</p>
<p style="position:absolute;top:446px;left:108px;white-space:nowrap" class="ft125">tion&#160;of&#160;the</p>
<p style="position:absolute;top:446px;left:193px;white-space:nowrap" class="ft1218">TPMSealing</p>
<p style="position:absolute;top:446px;left:279px;white-space:nowrap" class="ft125">component&#160;to&#160;unseal&#160;the</p>
<p style="position:absolute;top:464px;left:108px;white-space:nowrap" class="ft125">key&#160;(step&#160;9).&#160;The</p>
<p style="position:absolute;top:464px;left:241px;white-space:nowrap" class="ft1218">TPMSealing</p>
<p style="position:absolute;top:464px;left:326px;white-space:nowrap" class="ft125">component&#160;invokes</p>
<p style="position:absolute;top:482px;left:108px;white-space:nowrap" class="ft125">the&#160;(</p>
<p style="position:absolute;top:482px;left:141px;white-space:nowrap" class="ft1218">TPM&#160;Extend</p>
<p style="position:absolute;top:482px;left:222px;white-space:nowrap" class="ft125">())&#160;function&#160;of&#160;the&#160;TPM&#160;(step&#160;10)</p>
<p style="position:absolute;top:499px;left:108px;white-space:nowrap" class="ft125">and&#160;if&#160;successful,&#160;tries&#160;to&#160;unseal&#160;the&#160;key&#160;through&#160;the</p>
<p style="position:absolute;top:517px;left:108px;white-space:nowrap" class="ft1218">TPM&#160;Unseal</p>
<p style="position:absolute;top:517px;left:187px;white-space:nowrap" class="ft125">()&#160;function&#160;(step&#160;12).&#160;For&#160;simplicity,&#160;Fig-</p>
<p style="position:absolute;top:535px;left:108px;white-space:nowrap" class="ft125">ure</p>
<p style="position:absolute;top:535px;left:137px;white-space:nowrap" class="ft126">8</p>
<p style="position:absolute;top:535px;left:152px;white-space:nowrap" class="ft125">does&#160;not&#160;show&#160;details&#160;of&#160;key&#160;handling&#160;such</p>
<p style="position:absolute;top:553px;left:108px;white-space:nowrap" class="ft127">as&#160;loading&#160;a&#160;sealing&#160;wrapper&#160;key&#160;into&#160;the&#160;TPM.&#160;If<br/>the&#160;measurement&#160;matches,&#160;the</p>
<p style="position:absolute;top:571px;left:320px;white-space:nowrap" class="ft1218">TPMSealing</p>
<p style="position:absolute;top:571px;left:404px;white-space:nowrap" class="ft125">compo-</p>
<p style="position:absolute;top:589px;left:108px;white-space:nowrap" class="ft125">nent&#160;returns&#160;the&#160;key&#160;(steps&#160;14â16).&#160;The&#160;CM&#160;calls</p>
<p style="position:absolute;top:607px;left:108px;white-space:nowrap" class="ft1218">configAndUnlockDisk</p>
<p style="position:absolute;top:607px;left:242px;white-space:nowrap" class="ft125">()&#160;to&#160;attach&#160;and&#160;unlock&#160;the&#160;disk</p>
<p style="position:absolute;top:625px;left:108px;white-space:nowrap" class="ft125">(step&#160;17).</p>
<p style="position:absolute;top:669px;left:108px;white-space:nowrap" class="ft124">7</p>
<p style="position:absolute;top:669px;left:144px;white-space:nowrap" class="ft124">Conclusion</p>
<p style="position:absolute;top:707px;left:108px;white-space:nowrap" class="ft127">In&#160;this&#160;paper&#160;we&#160;have&#160;described&#160;a&#160;flexible&#160;and&#160;exten-<br/>sible&#160;integrity&#160;management&#160;architecture&#160;for&#160;virtual<br/>machine&#160;monitors.&#160;The&#160;architecture&#160;allows&#160;to&#160;mea-<br/>sure&#160;arbitrary&#160;portions&#160;of&#160;the&#160;system&#160;and&#160;to&#160;use&#160;these<br/>measurements&#160;for&#160;sealing&#160;and&#160;attestation.&#160;We&#160;have<br/>furthermore&#160;described&#160;a&#160;unified&#160;model&#160;and&#160;approach<br/>to&#160;property-based&#160;and&#160;binary&#160;attestation&#160;and&#160;sealing.<br/>The&#160;core&#160;idea&#160;is&#160;that&#160;the&#160;verifier&#160;can&#160;specify&#160;whether<br/>he&#160;wants&#160;to&#160;obtain&#160;raw&#160;log&#160;data&#160;or&#160;output&#160;of&#160;certain<br/>security&#160;evaluations&#160;of&#160;the&#160;log.&#160;We&#160;also&#160;described&#160;how<br/>the&#160;design&#160;can&#160;be&#160;realized&#160;in&#160;the&#160;context&#160;of&#160;the&#160;Xen<br/>hypervisor.</p>
<p style="position:absolute;top:922px;left:123px;white-space:nowrap" class="ft125">It&#160;should&#160;be&#160;noted&#160;that&#160;trusted&#160;computing&#160;is&#160;no&#160;sil-</p>
<p style="position:absolute;top:940px;left:108px;white-space:nowrap" class="ft127">ver&#160;bullet&#160;for&#160;improving&#160;security&#160;in&#160;virtualized&#160;envi-<br/>ronments.&#160;A&#160;party&#160;interacting&#160;with&#160;a&#160;TPM-equipped<br/>platform&#160;can&#160;verify&#160;the&#160;integrity&#160;of&#160;the&#160;platform,&#160;and<br/>thereby&#160;assess&#160;the&#160;amount&#160;of&#160;confidence&#160;and&#160;trust<br/>that&#160;can&#160;be&#160;placed&#160;on&#160;the&#160;interaction&#160;with&#160;the&#160;plat-<br/>form.&#160;Building&#160;software&#160;that&#160;warrants&#160;sufficient&#160;trust<br/>is&#160;an&#160;ongoing&#160;independent&#160;research&#160;challenge.</p>
<p style="position:absolute;top:1066px;left:123px;white-space:nowrap" class="ft125">We&#160;have&#160;implemented&#160;parts&#160;of&#160;the&#160;design&#160;in&#160;the</p>
<p style="position:absolute;top:110px;left:466px;white-space:nowrap" class="ft127">context&#160;of&#160;the&#160;Xen&#160;hypervisor.&#160;The&#160;design&#160;and&#160;the<br/>implementation&#160;is&#160;still&#160;work&#160;in&#160;progress.&#160;As&#160;a&#160;con-<br/>sequence,&#160;we&#160;expect&#160;future&#160;improvements&#160;based&#160;on<br/>lessons&#160;learned&#160;during&#160;a&#160;complete&#160;implementation.</p>
<p style="position:absolute;top:208px;left:466px;white-space:nowrap" class="ft124">Acknowledgments</p>
<p style="position:absolute;top:246px;left:466px;white-space:nowrap" class="ft127">This&#160;article&#160;is&#160;based&#160;on&#160;input&#160;by&#160;many&#160;members&#160;of<br/>the&#160;OpenTC&#160;project&#160;consortium.&#160;We&#160;would&#160;like&#160;to<br/>thank&#160;in&#160;particular&#160;David&#160;Plaquin&#160;for&#160;discussions&#160;on<br/>the&#160;Xen&#160;kernel&#160;interfaces&#160;and&#160;Ahmad&#160;Sadeghi&#160;and<br/>Chris&#160;StÂ¨</p>
<p style="position:absolute;top:318px;left:522px;white-space:nowrap" class="ft125">uble&#160;for&#160;discussions&#160;on&#160;different&#160;approaches</p>
<p style="position:absolute;top:336px;left:466px;white-space:nowrap" class="ft127">property-based&#160;attestation&#160;and&#160;sealing.&#160;This&#160;work<br/>has&#160;been&#160;partially&#160;funded&#160;by&#160;the&#160;EC&#160;as&#160;part&#160;of&#160;the<br/>OpenTC&#160;project&#160;[</p>
<p style="position:absolute;top:372px;left:582px;white-space:nowrap" class="ft126">13</p>
<p style="position:absolute;top:372px;left:597px;white-space:nowrap" class="ft125">]&#160;(ref.&#160;nr.&#160;027635).&#160;It&#160;is&#160;the&#160;work</p>
<p style="position:absolute;top:389px;left:466px;white-space:nowrap" class="ft127">of&#160;the&#160;authors&#160;alone&#160;and&#160;may&#160;not&#160;reflect&#160;the&#160;opinion<br/>of&#160;the&#160;whole&#160;project.</p>
<p style="position:absolute;top:451px;left:466px;white-space:nowrap" class="ft124">References</p>
<p style="position:absolute;top:489px;left:474px;white-space:nowrap" class="ft126">[1]</p>
<p style="position:absolute;top:489px;left:497px;white-space:nowrap" class="ft127">P.&#160;Barham,&#160;B.&#160;Dragovic,&#160;K.&#160;Fraser,&#160;S.&#160;Hand,<br/>T.&#160;Harris,&#160;A.&#160;Ho,&#160;R.&#160;Neugebauer,&#160;I.&#160;Pratt,&#160;and<br/>A.&#160;Warfield,&#160;âXen&#160;and&#160;the&#160;art&#160;of&#160;virtualiza-<br/>tion,â&#160;in</p>
<p style="position:absolute;top:543px;left:563px;white-space:nowrap" class="ft129"><i>SOSP&#160;â03:&#160;Proceedings&#160;of&#160;the&#160;nine-</i></p>
<p style="position:absolute;top:561px;left:497px;white-space:nowrap" class="ft1250"><i>teenth&#160;ACM&#160;symposium&#160;on&#160;Operating&#160;systems<br/>principles</i></p>
<p style="position:absolute;top:579px;left:560px;white-space:nowrap" class="ft125">.</p>
<p style="position:absolute;top:579px;left:582px;white-space:nowrap" class="ft125">New&#160;York,&#160;NY,&#160;USA:&#160;ACM&#160;Press,</p>
<p style="position:absolute;top:597px;left:497px;white-space:nowrap" class="ft125">2003,&#160;pp.&#160;164â177.</p>
<p style="position:absolute;top:627px;left:474px;white-space:nowrap" class="ft126">[2]</p>
<p style="position:absolute;top:627px;left:497px;white-space:nowrap" class="ft125">âVMware&#160;ESX&#160;Server:</p>
<p style="position:absolute;top:627px;left:685px;white-space:nowrap" class="ft125">Platform&#160;for&#160;vir-</p>
<p style="position:absolute;top:644px;left:497px;white-space:nowrap" class="ft125">tualizing&#160;servers,&#160;storage&#160;and&#160;networking,â</p>
<p style="position:absolute;top:662px;left:497px;white-space:nowrap" class="ft126">http://www.vmware.com/pdf/esx&#160;datasheet.pdf</p>
<p style="position:absolute;top:662px;left:813px;white-space:nowrap" class="ft125">.</p>
<p style="position:absolute;top:692px;left:474px;white-space:nowrap" class="ft126">[3]</p>
<p style="position:absolute;top:692px;left:497px;white-space:nowrap" class="ft127">R.&#160;Sailer,&#160;T.&#160;Jaeger,&#160;E.&#160;Valdez,&#160;R.&#160;Perez,<br/>S.&#160;Berger,&#160;J.&#160;L.&#160;Griffin,&#160;and&#160;L.&#160;van&#160;Doorn,<br/>âBuilding&#160;a&#160;MAC-based&#160;security&#160;architecture&#160;for<br/>the&#160;Xen&#160;open-source&#160;hypervisor,â&#160;IBM&#160;Research<br/>Division,&#160;Research&#160;Report&#160;RC23629,&#160;June&#160;2005.</p>
<p style="position:absolute;top:793px;left:474px;white-space:nowrap" class="ft126">[4]</p>
<p style="position:absolute;top:793px;left:497px;white-space:nowrap" class="ft127">T.&#160;Garfinkel,&#160;B.&#160;Pfaff,&#160;J.&#160;Chow,&#160;M.&#160;Rosen-<br/>blum,&#160;and&#160;D.&#160;Boneh,&#160;âTerra:&#160;a&#160;virtual&#160;machine-<br/>based&#160;platform&#160;for&#160;trusted&#160;computing,â&#160;in</p>
<p style="position:absolute;top:829px;left:775px;white-space:nowrap" class="ft129"><i>ACM</i></p>
<p style="position:absolute;top:847px;left:497px;white-space:nowrap" class="ft1250"><i>Symposium&#160;on&#160;Operating&#160;Systems&#160;Principles<br/>(SOSP)</i></p>
<p style="position:absolute;top:865px;left:548px;white-space:nowrap" class="ft125">.&#160;ACM&#160;Press,&#160;2003,&#160;pp.&#160;193â206.</p>
<p style="position:absolute;top:894px;left:474px;white-space:nowrap" class="ft126">[5]</p>
<p style="position:absolute;top:894px;left:497px;white-space:nowrap" class="ft127">J.&#160;Griffin,&#160;T.&#160;Jaeger,&#160;R.&#160;Perez,&#160;R.&#160;Sailer,&#160;L.&#160;V.<br/>Doorn,&#160;and&#160;R.&#160;Caceres,&#160;âTrusted&#160;Virtual&#160;Do-<br/>mains:&#160;Toward&#160;secure&#160;distributed&#160;services,â&#160;in</p>
<p style="position:absolute;top:948px;left:497px;white-space:nowrap" class="ft1250"><i>Proc.&#160;of&#160;the&#160;First&#160;Workshop&#160;on&#160;Hot&#160;Topics&#160;in<br/>System&#160;Dependability&#160;(Hotdep05)</i></p>
<p style="position:absolute;top:966px;left:716px;white-space:nowrap" class="ft125">.</p>
<p style="position:absolute;top:966px;left:738px;white-space:nowrap" class="ft125">Yokohama,</p>
<p style="position:absolute;top:984px;left:497px;white-space:nowrap" class="ft125">Japan:&#160;IEEE&#160;Press,&#160;June&#160;2005.</p>
<p style="position:absolute;top:1013px;left:474px;white-space:nowrap" class="ft126">[6]</p>
<p style="position:absolute;top:1013px;left:497px;white-space:nowrap" class="ft127">R.&#160;Sailer,&#160;L.&#160;van&#160;Doorn,&#160;and&#160;J.&#160;Ward,&#160;âDesign<br/>and&#160;implementation&#160;of&#160;a&#160;TCG-based&#160;integrity<br/>measurement&#160;architecture,â&#160;IBM&#160;Research&#160;Di-<br/>vision,&#160;Tech.&#160;Rep.&#160;RC23064,&#160;Jan.&#160;2004.</p>
<p style="position:absolute;top:1112px;left:452px;white-space:nowrap" class="ft126">12</p>
</div>
<!-- Page 13 -->
<a name="13"></a>
<style type="text/css">
<!--
	p {margin: 0; padding: 0;}-->
</style>
<div id="page13-div" style="position:relative;width:918px;height:1188px;">
<img width="918" height="1188" src="OTC_XenSecurityServices013.png" alt="background image"/>
<p style="position:absolute;top:110px;left:115px;white-space:nowrap" class="ft136">[7]</p>
<p style="position:absolute;top:110px;left:139px;white-space:nowrap" class="ft137">S.&#160;Berger,&#160;R.&#160;CÂ´aceres,&#160;K.&#160;Goldman,&#160;R.&#160;Perez,<br/>R.&#160;Sailer,&#160;and&#160;L.&#160;van&#160;Doorn,&#160;âvTPM:&#160;Virtualiz-<br/>ing&#160;the&#160;Trusted&#160;Platform&#160;Module,â&#160;in</p>
<p style="position:absolute;top:146px;left:398px;white-space:nowrap" class="ft139"><i>Proceed-</i></p>
<p style="position:absolute;top:164px;left:139px;white-space:nowrap" class="ft139"><i>ings&#160;of&#160;the&#160;15th&#160;USENIX&#160;Security&#160;Symposium</i></p>
<p style="position:absolute;top:164px;left:447px;white-space:nowrap" class="ft135">,</p>
<p style="position:absolute;top:182px;left:139px;white-space:nowrap" class="ft135">2006,&#160;to&#160;appear.</p>
<p style="position:absolute;top:212px;left:115px;white-space:nowrap" class="ft136">[8]</p>
<p style="position:absolute;top:212px;left:139px;white-space:nowrap" class="ft135">The</p>
<p style="position:absolute;top:212px;left:183px;white-space:nowrap" class="ft135">Trusted</p>
<p style="position:absolute;top:212px;left:251px;white-space:nowrap" class="ft135">Computing</p>
<p style="position:absolute;top:212px;left:342px;white-space:nowrap" class="ft135">Group,</p>
<p style="position:absolute;top:212px;left:409px;white-space:nowrap" class="ft135">âTPM</p>
<p style="position:absolute;top:230px;left:139px;white-space:nowrap" class="ft135">version</p>
<p style="position:absolute;top:230px;left:207px;white-space:nowrap" class="ft135">1.2</p>
<p style="position:absolute;top:230px;left:248px;white-space:nowrap" class="ft135">specification,â</p>
<p style="position:absolute;top:230px;left:367px;white-space:nowrap" class="ft135">Oct.</p>
<p style="position:absolute;top:230px;left:417px;white-space:nowrap" class="ft135">2003,</p>
<p style="position:absolute;top:248px;left:139px;white-space:nowrap" class="ft136">http://www.trustedcomputinggroup.org</p>
<p style="position:absolute;top:248px;left:400px;white-space:nowrap" class="ft135">.</p>
<p style="position:absolute;top:278px;left:115px;white-space:nowrap" class="ft136">[9]</p>
<p style="position:absolute;top:278px;left:139px;white-space:nowrap" class="ft135">âFiasco</p>
<p style="position:absolute;top:278px;left:359px;white-space:nowrap" class="ft135">micro-kernel,â</p>
<p style="position:absolute;top:296px;left:139px;white-space:nowrap" class="ft136">http://os.inf.tu-dresden.de/fiasco/</p>
<p style="position:absolute;top:296px;left:364px;white-space:nowrap" class="ft135">.</p>
<p style="position:absolute;top:325px;left:108px;white-space:nowrap" class="ft136">[10]</p>
<p style="position:absolute;top:325px;left:139px;white-space:nowrap" class="ft137">J.&#160;Poritz,&#160;M.&#160;Schunter,&#160;E.&#160;V.&#160;Herreweghen,&#160;and<br/>M.&#160;Waidner,&#160;âProperty&#160;attestation&#160;â&#160;scalable<br/>and&#160;privacy-friendly&#160;security&#160;assessment&#160;of&#160;peer<br/>computers,â&#160;IBM&#160;Research&#160;Division,&#160;Tech.&#160;Rep.<br/>RZ&#160;3548&#160;(#&#160;99559),&#160;05/10/2004&#160;2004.</p>
<p style="position:absolute;top:427px;left:108px;white-space:nowrap" class="ft136">[11]</p>
<p style="position:absolute;top:427px;left:139px;white-space:nowrap" class="ft135">A.-R.&#160;Sadeghi&#160;and&#160;C.&#160;StÂ¨</p>
<p style="position:absolute;top:427px;left:306px;white-space:nowrap" class="ft135">uble,&#160;âProperty-based</p>
<p style="position:absolute;top:445px;left:139px;white-space:nowrap" class="ft135">attestation&#160;for&#160;computing&#160;platforms:</p>
<p style="position:absolute;top:445px;left:412px;white-space:nowrap" class="ft135">caring</p>
<p style="position:absolute;top:463px;left:139px;white-space:nowrap" class="ft135">about&#160;properties,&#160;not&#160;mechanisms,â&#160;in</p>
<p style="position:absolute;top:463px;left:407px;white-space:nowrap" class="ft139"><i>NSPW</i></p>
<p style="position:absolute;top:481px;left:139px;white-space:nowrap" class="ft1350"><i>â04:&#160;Proceedings&#160;of&#160;the&#160;2004&#160;workshop&#160;on&#160;New<br/>security&#160;paradigms</i></p>
<p style="position:absolute;top:499px;left:259px;white-space:nowrap" class="ft135">.&#160;New&#160;York,&#160;NY,&#160;USA:&#160;ACM</p>
<p style="position:absolute;top:517px;left:139px;white-space:nowrap" class="ft135">Press,&#160;2005,&#160;pp.&#160;67â77.</p>
<p style="position:absolute;top:547px;left:108px;white-space:nowrap" class="ft136">[12]</p>
<p style="position:absolute;top:547px;left:139px;white-space:nowrap" class="ft137">V.&#160;Haldar,&#160;D.&#160;Chandra,&#160;and&#160;M.&#160;Franz,&#160;âSe-<br/>mantic&#160;Remote&#160;Attestation&#160;-&#160;virtual&#160;machine&#160;di-<br/>rected&#160;approach&#160;to&#160;Trusted&#160;Computing,â&#160;in</p>
<p style="position:absolute;top:582px;left:424px;white-space:nowrap" class="ft139"><i>Vir-</i></p>
<p style="position:absolute;top:600px;left:139px;white-space:nowrap" class="ft1350"><i>tual&#160;Machine&#160;Research&#160;and&#160;Technology&#160;Sympo-<br/>sium</i></p>
<p style="position:absolute;top:618px;left:170px;white-space:nowrap" class="ft135">,&#160;2004,&#160;pp.&#160;29â41.</p>
<p style="position:absolute;top:648px;left:108px;white-space:nowrap" class="ft136">[13]</p>
<p style="position:absolute;top:648px;left:139px;white-space:nowrap" class="ft135">âThe</p>
<p style="position:absolute;top:648px;left:188px;white-space:nowrap" class="ft135">OpenTC</p>
<p style="position:absolute;top:648px;left:262px;white-space:nowrap" class="ft135">Consortium</p>
<p style="position:absolute;top:648px;left:354px;white-space:nowrap" class="ft135">Home</p>
<p style="position:absolute;top:648px;left:409px;white-space:nowrap" class="ft135">Page,â</p>
<p style="position:absolute;top:666px;left:139px;white-space:nowrap" class="ft135">http://www.opentc.net.</p>
<p style="position:absolute;top:696px;left:108px;white-space:nowrap" class="ft136">[14]</p>
<p style="position:absolute;top:696px;left:139px;white-space:nowrap" class="ft137">A.&#160;Pfitzmann,&#160;B.&#160;Pfitzmann,&#160;M.&#160;Schunter,&#160;and<br/>M.&#160;Waidner,&#160;âTrusting&#160;Mobile&#160;User&#160;Devices&#160;and<br/>Security&#160;Modules,â</p>
<p style="position:absolute;top:732px;left:267px;white-space:nowrap" class="ft139"><i>Computer</i></p>
<p style="position:absolute;top:732px;left:331px;white-space:nowrap" class="ft135">,&#160;vol.&#160;30,&#160;no.&#160;2,&#160;pp.</p>
<p style="position:absolute;top:750px;left:139px;white-space:nowrap" class="ft135">61â68,&#160;1997.</p>
<p style="position:absolute;top:1112px;left:452px;white-space:nowrap" class="ft136">13</p>
</div>
</body>
</html>
